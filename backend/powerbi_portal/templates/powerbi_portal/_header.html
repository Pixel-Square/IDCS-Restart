{% load static %}
<!-- Google Fonts: Inter -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<style>
  /* ‚îÄ‚îÄ Design Tokens ‚îÄ‚îÄ */
  :root{
    --bg:#F8F9FA;
    --surface:#FFFFFF;
    --surface-2:#F1F5F9;
    --border:#E2E8F0;
    --border-focus:#F5C518;
    --gold:#F5C518;
    --gold-dark:#D4930A;
    --gold-mid:#E5A500;
    --gold-tint:rgba(245,197,24,0.10);
    --gold-tint-hover:rgba(245,197,24,0.18);
    --slate:#1E293B;
    --slate-mid:#475569;
    --slate-light:#64748B;
    --text:#1E293B;
    --text-muted:#64748B;
    --text-subtle:#94A3B8;
    --danger:#EF4444;
    --danger-tint:#FEF2F2;
    --success:#22C55E;
    --shadow-sm:0 1px 3px rgba(0,0,0,0.07),0 1px 2px rgba(0,0,0,0.04);
    --shadow:0 4px 16px rgba(0,0,0,0.08),0 1px 3px rgba(0,0,0,0.04);
    --shadow-lg:0 12px 32px rgba(0,0,0,0.10),0 4px 12px rgba(0,0,0,0.05);
    --radius:12px;
    --radius-sm:8px;
    --radius-xs:6px;
    --sidebar-w:240px;
  }

  /* ‚îÄ‚îÄ Reset & Base ‚îÄ‚îÄ */
  *{box-sizing:border-box}
  body{font-family:'Inter','Segoe UI',Arial,sans-serif;background:var(--bg);margin:0;padding:0;min-height:100vh;color:var(--text);font-size:14px;line-height:1.6}

  /* ‚îÄ‚îÄ Top Navigation Bar ‚îÄ‚îÄ */
  .header{
    background:var(--surface);
    border-bottom:1px solid var(--border);
    padding:0 28px;
    height:60px;
    display:flex;align-items:center;justify-content:space-between;
    position:sticky;top:0;z-index:100;
    box-shadow:0 1px 8px rgba(0,0,0,0.06)
  }
  .header-left,.header-right{display:flex;align-items:center;gap:14px}
  .logo-text{
    font-size:17px;font-weight:700;color:var(--slate);letter-spacing:-0.3px;
    display:flex;align-items:center;gap:10px;text-decoration:none
  }
  .logo-img{height:36px;width:auto;display:block;flex-shrink:0}
  .header-center{flex-grow:1;padding:0 24px}
  .user-chip{
    display:flex;align-items:center;gap:8px;
    background:var(--surface-2);border:1px solid var(--border);
    padding:6px 14px 6px 10px;border-radius:20px;
    font-size:13px;font-weight:500;color:var(--slate-mid)
  }
  .user-avatar{
    width:26px;height:26px;border-radius:50%;
    background:linear-gradient(135deg,var(--gold) 0%,var(--gold-mid) 100%);
    display:flex;align-items:center;justify-content:center;
    font-size:11px;font-weight:700;color:var(--slate);flex-shrink:0
  }
  .logout-btn{
    background:linear-gradient(135deg,var(--gold) 0%,var(--gold-mid) 100%);
    color:var(--slate);padding:8px 18px;border-radius:20px;
    text-decoration:none;font-size:13px;font-weight:600;
    transition:all 0.2s;box-shadow:var(--shadow-sm);border:none;cursor:pointer
  }
  .logout-btn:hover{transform:translateY(-1px);box-shadow:0 4px 14px rgba(213,148,10,0.35)}

  .notif-btn{
    display:inline-flex;align-items:center;gap:8px;
    padding:8px 12px;border-radius:20px;
    background:var(--surface);border:1px solid var(--border);
    color:var(--slate-mid);text-decoration:none;font-weight:600;font-size:13px;
    box-shadow:var(--shadow-sm);transition:all 0.15s
  }
  .notif-btn:hover{background:var(--surface-2);border-color:rgba(245,197,24,0.5);color:var(--slate)}
  .notif-badge{
    display:inline-flex;align-items:center;justify-content:center;
    min-width:18px;height:18px;padding:0 6px;
    border-radius:999px;
    background:rgba(239,68,68,0.12);
    color:#B91C1C;
    border:1px solid rgba(239,68,68,0.28);
    font-size:11px;font-weight:800;line-height:1
  }

  /* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
  .container{max-width:1400px;margin:0 auto;padding:28px 28px 28px calc(28px + var(--sidebar-w))}
  .container-full{max-width:none;margin:0;padding:28px 0 28px var(--sidebar-w)}

  /* ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ */
  .sidebar{
    position:fixed;left:0;top:60px;
    width:var(--sidebar-w);
    height:calc(100vh - 60px);
    background:var(--surface);
    border-right:1px solid var(--border);
    padding:16px 14px;
    overflow:auto;
  }
  .side-section{margin-top:6px;margin-bottom:10px}
  .side-label{font-size:10px;font-weight:800;text-transform:uppercase;letter-spacing:1px;color:var(--text-subtle);margin:10px 10px 8px}
  .side-link{
    display:flex;align-items:center;gap:10px;
    padding:10px 10px;
    border-radius:10px;
    color:var(--slate-mid);
    text-decoration:none;
    font-weight:600;
    transition:background 0.15s,color 0.15s,border-color 0.15s;
    border:1px solid transparent;
  }
  .side-link:hover{background:var(--gold-tint);color:var(--slate);border-color:rgba(245,197,24,0.25)}
  .side-ic{width:26px;height:26px;border-radius:8px;background:var(--surface-2);border:1px solid var(--border);display:flex;align-items:center;justify-content:center;font-size:14px;flex-shrink:0}
  .side-badge{margin-left:auto}

  /* ‚îÄ‚îÄ Cards ‚îÄ‚îÄ */
  .card{
    background:var(--surface);border:1px solid var(--border);
    border-radius:var(--radius);padding:24px;margin-bottom:20px;
    box-shadow:var(--shadow)
  }
  .card-header{
    display:flex;justify-content:space-between;align-items:center;
    margin-bottom:18px;padding-bottom:14px;
    border-bottom:2px solid var(--gold-tint)
  }
  .card-header-accent{border-bottom-color:var(--gold)}

  /* ‚îÄ‚îÄ Typography ‚îÄ‚îÄ */
  h1{margin:0;font-size:22px;color:#1E293B;font-weight:700;letter-spacing:-0.3px}
  h2{margin:0 0 16px 0;font-size:17px;color:#1E293B;font-weight:700}
  h3{margin:0 0 10px 0;font-size:14px;color:#475569;font-weight:600}
  .page-title{font-size:24px;font-weight:700;color:#1E293B;margin-bottom:4px;letter-spacing:-0.4px;line-height:1.2}
  .page-subtitle{color:#64748B;font-size:14px;margin-bottom:28px;margin-top:4px}

  /* ‚îÄ‚îÄ Buttons ‚îÄ‚îÄ */
  .btn{
    display:inline-flex;align-items:center;gap:6px;
    padding:9px 18px;
    background:linear-gradient(135deg,var(--gold) 0%,var(--gold-mid) 100%);
    color:var(--slate);border:none;border-radius:var(--radius-sm);
    text-decoration:none;font-weight:600;font-size:13px;cursor:pointer;
    transition:all 0.2s;box-shadow:var(--shadow-sm);white-space:nowrap
  }
  .btn:hover{transform:translateY(-1px);box-shadow:0 4px 14px rgba(213,148,10,0.28)}
  .btn:active{transform:translateY(0)}
  .btn-secondary{
    background:var(--surface);color:var(--slate-mid);
    border:1px solid var(--border);
    box-shadow:var(--shadow-sm)
  }
  .btn-secondary:hover{background:var(--surface-2);border-color:var(--gold);color:var(--slate);box-shadow:var(--shadow-sm)}
  .btn-danger{background:linear-gradient(135deg,#EF4444 0%,#DC2626 100%);color:#fff;box-shadow:0 1px 3px rgba(239,68,68,0.25)}
  .btn-danger:hover{box-shadow:0 4px 14px rgba(239,68,68,0.30)}
  .btn-ghost{background:transparent;color:var(--gold-dark);border:1px solid var(--gold);box-shadow:none}
  .btn-ghost:hover{background:var(--gold-tint)}
  .btn-small{padding:6px 12px;font-size:12px;border-radius:var(--radius-xs)}
  .btn-icon{padding:7px;border-radius:var(--radius-xs);gap:0}

  /* ‚îÄ‚îÄ Utility ‚îÄ‚îÄ */
  .muted{color:#64748B;font-size:13px}
  .subtle{color:#94A3B8;font-size:12px}
  .link{color:#1D4ED8;text-decoration:none;font-weight:500}
  .link:hover{text-decoration:underline;color:#1E40AF}
  .text-center{text-align:center}
  .flex{display:flex}.flex-col{flex-direction:column}
  .items-center{align-items:center}.justify-between{justify-content:space-between}
  .gap-2{gap:8px}.gap-3{gap:12px}.gap-4{gap:16px}
  .mt-1{margin-top:6px}.mt-2{margin-top:12px}.mt-3{margin-top:18px}.mt-4{margin-top:24px}
  .mb-1{margin-bottom:6px}.mb-2{margin-bottom:12px}.mb-3{margin-bottom:18px}
  .p-badge{display:inline-block;width:32px;height:32px;border-radius:50%;background:var(--gold-tint);color:var(--gold-dark);font-weight:700;font-size:13px;display:inline-flex;align-items:center;justify-content:center}

  /* ‚îÄ‚îÄ Badges ‚îÄ‚îÄ */
  .badge{display:inline-flex;align-items:center;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:0.5px}
  .badge-leader{background:linear-gradient(135deg,var(--gold) 0%,var(--gold-mid) 100%);color:var(--slate)}
  .badge-co-leader{background:#FEF3C7;color:#92400E;border:1px solid #FCD34D}
  .badge-member{background:var(--surface-2);color:var(--slate-mid);border:1px solid var(--border)}
  .badge-primary{background:#EFF6FF;color:#1D4ED8;border:1px solid #BFDBFE}

  /* ‚îÄ‚îÄ Tables ‚îÄ‚îÄ */
  table{width:100%;border-collapse:collapse;margin-top:8px}
  th,td{padding:11px 14px;text-align:left;border-bottom:1px solid var(--border)}
  th{background:var(--surface-2);color:var(--slate-mid);font-weight:600;font-size:11px;text-transform:uppercase;letter-spacing:0.6px}
  td{color:var(--text);font-size:13px}
  tbody tr:hover{background:var(--gold-tint)}
  tbody tr:last-child td{border-bottom:none}

  /* ‚îÄ‚îÄ Grid ‚îÄ‚îÄ */
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px;margin-top:16px}
  .grid-card{
    background:var(--surface);border:1px solid var(--border);
    border-radius:var(--radius);padding:20px;
    transition:all 0.2s;box-shadow:var(--shadow-sm)
  }
  .grid-card:hover{transform:translateY(-2px);box-shadow:var(--shadow-lg);border-color:rgba(245,197,24,0.4)}

  /* ‚îÄ‚îÄ Forms ‚îÄ‚îÄ */
  input,select,textarea{
    padding:9px 12px;border:1.5px solid var(--border);border-radius:var(--radius-sm);
    font-size:13px;width:100%;box-sizing:border-box;
    background:var(--surface);color:var(--text);
    font-family:'Inter','Segoe UI',sans-serif;transition:border-color 0.15s,box-shadow 0.15s
  }
  input:focus,select:focus,textarea:focus{
    outline:none;border-color:var(--gold);
    box-shadow:0 0 0 3px rgba(245,197,24,0.15)
  }
  label{display:block;margin-bottom:5px;font-weight:600;color:var(--slate-mid);font-size:12px;text-transform:uppercase;letter-spacing:0.4px}
  .form-row{margin-bottom:16px}
  .form-hint{font-size:11px;color:var(--text-subtle);margin-top:4px}

  /* ‚îÄ‚îÄ Inline Text ‚îÄ‚îÄ */
  code{background:#F8FAFC;color:#D4930A;padding:3px 7px;border-radius:4px;border:1px solid #E2E8F0;font-size:12px;font-family:'Consolas','Courier New',monospace}

  /* ‚îÄ‚îÄ Section Dividers ‚îÄ‚îÄ */
  .section-label{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px;color:#64748B;margin-bottom:8px;margin-top:4px}
  hr.divider{border:none;border-top:1px solid var(--border);margin:20px 0}

  /* ‚îÄ‚îÄ Empty States ‚îÄ‚îÄ */
  .empty-state{text-align:center;padding:40px 20px;color:var(--text-muted)}
  .empty-state-icon{font-size:36px;margin-bottom:12px}

  /* ‚îÄ‚îÄ Alert/Messages ‚îÄ‚îÄ */
  .alert{padding:12px 16px;border-radius:var(--radius-sm);margin-bottom:16px;font-size:13px}
  .alert-success{background:#F0FDF4;color:#166534;border:1px solid #BBF7D0}
  .alert-error{background:var(--danger-tint);color:#991B1B;border:1px solid #FECACA}
  .alert-warning{background:#FFFBEB;color:#92400E;border:1px solid #FCD34D}
  .alert-info{background:#EFF6FF;color:#1E40AF;border:1px solid #BFDBFE}
</style>

<div class="header">
  <div class="header-left">
    <a href="/powerbi/dashboard/" class="logo-text">
      <img src="{% static 'powerbi_portal/bilogo.png' %}" alt="BI Portal" class="logo-img" />
      BI Portal
    </a>
  </div>
  <div class="header-right">
    <div class="user-chip">
      <div class="user-avatar">{{ user.username|first|upper }}</div>
      {{ user.username }}
    </div>
    <a class="notif-btn" href="/powerbi/notifications/" title="Notifications">
      üîî
      {% if powerbi_notifications_count and powerbi_notifications_count|add:0 > 0 %}
        <span class="notif-badge">{{ powerbi_notifications_count }}</span>
      {% endif %}
    </a>
    <a class="logout-btn" href="/powerbi/logout/">Sign out</a>
  </div>
</div>

<aside class="sidebar">
  <div class="side-section">
    <div class="side-label">Sections</div>
    <a class="side-link" href="/powerbi/dashboard/">
      <span class="side-ic">üèÅ</span>
      Dashboard
    </a>
    <a class="side-link" href="/powerbi/components/">
      <span class="side-ic">üß©</span>
      Components
    </a>
    <a class="side-link" href="/powerbi/sheets/">
      <span class="side-ic">üìã</span>
      Sheets
    </a>
    <a class="side-link" href="/powerbi/collaboration/">
      <span class="side-ic">ü§ù</span>
      Rooms
    </a>
    <a class="side-link" href="/powerbi/notifications/">
      <span class="side-ic">üîî</span>
      Notifications
      {% if powerbi_notifications_count and powerbi_notifications_count|add:0 > 0 %}
        <span class="notif-badge side-badge">{{ powerbi_notifications_count }}</span>
      {% endif %}
    </a>
    <a class="side-link" href="/powerbi/profile/">
      <span class="side-ic">üë§</span>
      Profile
    </a>
  </div>
</aside>

{% if messages %}
  <div style="padding:14px 28px 0 calc(28px + var(--sidebar-w))">
    {% for message in messages %}
      <div class="alert alert-{{ message.tags|default:'info' }}">{{ message }}</div>
    {% endfor %}
  </div>
{% endif %}
