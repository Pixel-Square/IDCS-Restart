var mY=Object.defineProperty;var gY=(e,t,r)=>t in e?mY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ti=(e,t,r)=>gY(e,typeof t!="symbol"?t+"":t,r);function xY(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var cMe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function af(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var iF={exports:{}},Jw={},aF={exports:{}},pi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q1=Symbol.for("react.element"),yY=Symbol.for("react.portal"),bY=Symbol.for("react.fragment"),vY=Symbol.for("react.strict_mode"),wY=Symbol.for("react.profiler"),SY=Symbol.for("react.provider"),_Y=Symbol.for("react.context"),kY=Symbol.for("react.forward_ref"),jY=Symbol.for("react.suspense"),AY=Symbol.for("react.memo"),NY=Symbol.for("react.lazy"),fT=Symbol.iterator;function CY(e){return e===null||typeof e!="object"?null:(e=fT&&e[fT]||e["@@iterator"],typeof e=="function"?e:null)}var sF={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},oF=Object.assign,lF={};function Ym(e,t,r){this.props=e,this.context=t,this.refs=lF,this.updater=r||sF}Ym.prototype.isReactComponent={};Ym.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ym.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function cF(){}cF.prototype=Ym.prototype;function pN(e,t,r){this.props=e,this.context=t,this.refs=lF,this.updater=r||sF}var mN=pN.prototype=new cF;mN.constructor=pN;oF(mN,Ym.prototype);mN.isPureReactComponent=!0;var hT=Array.isArray,uF=Object.prototype.hasOwnProperty,gN={current:null},dF={key:!0,ref:!0,__self:!0,__source:!0};function fF(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)uF.call(t,n)&&!dF.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:q1,type:e,key:s,ref:o,props:i,_owner:gN.current}}function EY(e,t){return{$$typeof:q1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function xN(e){return typeof e=="object"&&e!==null&&e.$$typeof===q1}function TY(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var pT=/\/+/g;function g5(e,t){return typeof e=="object"&&e!==null&&e.key!=null?TY(""+e.key):t.toString(36)}function Nv(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case q1:case yY:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+g5(o,0):n,hT(i)?(r="",e!=null&&(r=e.replace(pT,"$&/")+"/"),Nv(i,t,r,"",function(u){return u})):i!=null&&(xN(i)&&(i=EY(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(pT,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",hT(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+g5(s,l);o+=Nv(s,t,r,c,i)}else if(c=CY(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+g5(s,l++),o+=Nv(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ib(e,t,r){if(e==null)return e;var n=[],i=0;return Nv(e,n,"","",function(s){return t.call(r,s,i++)}),n}function PY(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ll={current:null},Cv={transition:null},OY={ReactCurrentDispatcher:ll,ReactCurrentBatchConfig:Cv,ReactCurrentOwner:gN};function hF(){throw Error("act(...) is not supported in production builds of React.")}pi.Children={map:ib,forEach:function(e,t,r){ib(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return ib(e,function(){t++}),t},toArray:function(e){return ib(e,function(t){return t})||[]},only:function(e){if(!xN(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};pi.Component=Ym;pi.Fragment=bY;pi.Profiler=wY;pi.PureComponent=pN;pi.StrictMode=vY;pi.Suspense=jY;pi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OY;pi.act=hF;pi.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=oF({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=gN.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)uF.call(t,c)&&!dF.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:q1,type:e.type,key:i,ref:s,props:n,_owner:o}};pi.createContext=function(e){return e={$$typeof:_Y,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:SY,_context:e},e.Consumer=e};pi.createElement=fF;pi.createFactory=function(e){var t=fF.bind(null,e);return t.type=e,t};pi.createRef=function(){return{current:null}};pi.forwardRef=function(e){return{$$typeof:kY,render:e}};pi.isValidElement=xN;pi.lazy=function(e){return{$$typeof:NY,_payload:{_status:-1,_result:e},_init:PY}};pi.memo=function(e,t){return{$$typeof:AY,type:e,compare:t===void 0?null:t}};pi.startTransition=function(e){var t=Cv.transition;Cv.transition={};try{e()}finally{Cv.transition=t}};pi.unstable_act=hF;pi.useCallback=function(e,t){return ll.current.useCallback(e,t)};pi.useContext=function(e){return ll.current.useContext(e)};pi.useDebugValue=function(){};pi.useDeferredValue=function(e){return ll.current.useDeferredValue(e)};pi.useEffect=function(e,t){return ll.current.useEffect(e,t)};pi.useId=function(){return ll.current.useId()};pi.useImperativeHandle=function(e,t,r){return ll.current.useImperativeHandle(e,t,r)};pi.useInsertionEffect=function(e,t){return ll.current.useInsertionEffect(e,t)};pi.useLayoutEffect=function(e,t){return ll.current.useLayoutEffect(e,t)};pi.useMemo=function(e,t){return ll.current.useMemo(e,t)};pi.useReducer=function(e,t,r){return ll.current.useReducer(e,t,r)};pi.useRef=function(e){return ll.current.useRef(e)};pi.useState=function(e){return ll.current.useState(e)};pi.useSyncExternalStore=function(e,t,r){return ll.current.useSyncExternalStore(e,t,r)};pi.useTransition=function(){return ll.current.useTransition()};pi.version="18.3.1";aF.exports=pi;var x=aF.exports;const hn=af(x),pF=xY({__proto__:null,default:hn},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MY=x,LY=Symbol.for("react.element"),RY=Symbol.for("react.fragment"),BY=Object.prototype.hasOwnProperty,FY=MY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,IY={key:!0,ref:!0,__self:!0,__source:!0};function mF(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)BY.call(t,n)&&!IY.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:LY,type:e,key:s,ref:o,props:i,_owner:FY.current}}Jw.Fragment=RY;Jw.jsx=mF;Jw.jsxs=mF;iF.exports=Jw;var a=iF.exports,gF={exports:{}},sc={},xF={exports:{}},yF={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(U,G){var re=U.length;U.push(G);e:for(;0<re;){var X=re-1>>>1,C=U[X];if(0<i(C,G))U[X]=G,U[re]=C,re=X;else break e}}function r(U){return U.length===0?null:U[0]}function n(U){if(U.length===0)return null;var G=U[0],re=U.pop();if(re!==G){U[0]=re;e:for(var X=0,C=U.length,K=C>>>1;X<K;){var V=2*(X+1)-1,R=U[V],J=V+1,q=U[J];if(0>i(R,re))J<C&&0>i(q,R)?(U[X]=q,U[J]=re,X=J):(U[X]=R,U[V]=re,X=V);else if(J<C&&0>i(q,re))U[X]=q,U[J]=re,X=J;else break e}}return G}function i(U,G){var re=U.sortIndex-G.sortIndex;return re!==0?re:U.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,h=3,p=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var G=r(u);G!==null;){if(G.callback===null)n(u);else if(G.startTime<=U)n(u),G.sortIndex=G.expirationTime,t(c,G);else break;G=r(u)}}function S(U){if(g=!1,w(U),!m)if(r(c)!==null)m=!0,se(k);else{var G=r(u);G!==null&&de(S,G.startTime-U)}}function k(U,G){m=!1,g&&(g=!1,b(L),L=-1),p=!0;var re=h;try{for(w(G),f=r(c);f!==null&&(!(f.expirationTime>G)||U&&!E());){var X=f.callback;if(typeof X=="function"){f.callback=null,h=f.priorityLevel;var C=X(f.expirationTime<=G);G=e.unstable_now(),typeof C=="function"?f.callback=C:f===r(c)&&n(c),w(G)}else n(c);f=r(c)}if(f!==null)var K=!0;else{var V=r(u);V!==null&&de(S,V.startTime-G),K=!1}return K}finally{f=null,h=re,p=!1}}var j=!1,A=null,L=-1,P=5,B=-1;function E(){return!(e.unstable_now()-B<P)}function T(){if(A!==null){var U=e.unstable_now();B=U;var G=!0;try{G=A(!0,U)}finally{G?F():(j=!1,A=null)}}else j=!1}var F;if(typeof v=="function")F=function(){v(T)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,z=W.port2;W.port1.onmessage=T,F=function(){z.postMessage(null)}}else F=function(){y(T,0)};function se(U){A=U,j||(j=!0,F())}function de(U,G){L=y(function(){U(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_continueExecution=function(){m||p||(m=!0,se(k))},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var G=3;break;default:G=h}var re=h;h=G;try{return U()}finally{h=re}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(U,G){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var re=h;h=U;try{return G()}finally{h=re}},e.unstable_scheduleCallback=function(U,G,re){var X=e.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?X+re:X):re=X,U){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=re+C,U={id:d++,callback:G,priorityLevel:U,startTime:re,expirationTime:C,sortIndex:-1},re>X?(U.sortIndex=re,t(u,U),r(c)===null&&U===r(u)&&(g?(b(L),L=-1):g=!0,de(S,re-X))):(U.sortIndex=C,t(c,U),m||p||(m=!0,se(k))),U},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(U){var G=h;return function(){var re=h;h=G;try{return U.apply(this,arguments)}finally{h=re}}}})(yF);xF.exports=yF;var DY=xF.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $Y=x,tc=DY;function rn(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bF=new Set,zx={};function D0(e,t){jm(e,t),jm(e+"Capture",t)}function jm(e,t){for(zx[e]=t,e=0;e<t.length;e++)bF.add(t[e])}var qd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nj=Object.prototype.hasOwnProperty,UY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mT={},gT={};function zY(e){return Nj.call(gT,e)?!0:Nj.call(mT,e)?!1:UY.test(e)?gT[e]=!0:(mT[e]=!0,!1)}function WY(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qY(e,t,r,n){if(t===null||typeof t>"u"||WY(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function cl(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var mo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){mo[e]=new cl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];mo[t]=new cl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){mo[e]=new cl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){mo[e]=new cl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){mo[e]=new cl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){mo[e]=new cl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){mo[e]=new cl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){mo[e]=new cl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){mo[e]=new cl(e,5,!1,e.toLowerCase(),null,!1,!1)});var yN=/[\-:]([a-z])/g;function bN(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(yN,bN);mo[t]=new cl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(yN,bN);mo[t]=new cl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(yN,bN);mo[t]=new cl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){mo[e]=new cl(e,1,!1,e.toLowerCase(),null,!1,!1)});mo.xlinkHref=new cl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){mo[e]=new cl(e,1,!1,e.toLowerCase(),null,!0,!0)});function vN(e,t,r,n){var i=mo.hasOwnProperty(t)?mo[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(qY(t,r,i,n)&&(r=null),n||i===null?zY(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var sf=$Y.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ab=Symbol.for("react.element"),$p=Symbol.for("react.portal"),Up=Symbol.for("react.fragment"),wN=Symbol.for("react.strict_mode"),Cj=Symbol.for("react.profiler"),vF=Symbol.for("react.provider"),wF=Symbol.for("react.context"),SN=Symbol.for("react.forward_ref"),Ej=Symbol.for("react.suspense"),Tj=Symbol.for("react.suspense_list"),_N=Symbol.for("react.memo"),Mf=Symbol.for("react.lazy"),SF=Symbol.for("react.offscreen"),xT=Symbol.iterator;function Og(e){return e===null||typeof e!="object"?null:(e=xT&&e[xT]||e["@@iterator"],typeof e=="function"?e:null)}var Ma=Object.assign,x5;function ox(e){if(x5===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);x5=t&&t[1]||""}return`
`+x5+e}var y5=!1;function b5(e,t){if(!e||y5)return"";y5=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{y5=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?ox(e):""}function HY(e){switch(e.tag){case 5:return ox(e.type);case 16:return ox("Lazy");case 13:return ox("Suspense");case 19:return ox("SuspenseList");case 0:case 2:case 15:return e=b5(e.type,!1),e;case 11:return e=b5(e.type.render,!1),e;case 1:return e=b5(e.type,!0),e;default:return""}}function Pj(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Up:return"Fragment";case $p:return"Portal";case Cj:return"Profiler";case wN:return"StrictMode";case Ej:return"Suspense";case Tj:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case wF:return(e.displayName||"Context")+".Consumer";case vF:return(e._context.displayName||"Context")+".Provider";case SN:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _N:return t=e.displayName||null,t!==null?t:Pj(e.type)||"Memo";case Mf:t=e._payload,e=e._init;try{return Pj(e(t))}catch{}}return null}function VY(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pj(t);case 8:return t===wN?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function oh(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _F(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function GY(e){var t=_F(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function sb(e){e._valueTracker||(e._valueTracker=GY(e))}function kF(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=_F(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function i2(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Oj(e,t){var r=t.checked;return Ma({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function yT(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=oh(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function jF(e,t){t=t.checked,t!=null&&vN(e,"checked",t,!1)}function Mj(e,t){jF(e,t);var r=oh(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Lj(e,t.type,r):t.hasOwnProperty("defaultValue")&&Lj(e,t.type,oh(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function bT(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Lj(e,t,r){(t!=="number"||i2(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var lx=Array.isArray;function am(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+oh(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Rj(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(rn(91));return Ma({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function vT(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(rn(92));if(lx(r)){if(1<r.length)throw Error(rn(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:oh(r)}}function AF(e,t){var r=oh(t.value),n=oh(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function wT(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function NF(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bj(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?NF(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ob,CF=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ob=ob||document.createElement("div"),ob.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ob.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Wx(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var yx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},KY=["Webkit","ms","Moz","O"];Object.keys(yx).forEach(function(e){KY.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),yx[t]=yx[e]})});function EF(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||yx.hasOwnProperty(e)&&yx[e]?(""+t).trim():t+"px"}function TF(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=EF(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var YY=Ma({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fj(e,t){if(t){if(YY[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(rn(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(rn(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(rn(61))}if(t.style!=null&&typeof t.style!="object")throw Error(rn(62))}}function Ij(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Dj=null;function kN(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $j=null,sm=null,om=null;function ST(e){if(e=G1(e)){if(typeof $j!="function")throw Error(rn(280));var t=e.stateNode;t&&(t=nS(t),$j(e.stateNode,e.type,t))}}function PF(e){sm?om?om.push(e):om=[e]:sm=e}function OF(){if(sm){var e=sm,t=om;if(om=sm=null,ST(e),t)for(e=0;e<t.length;e++)ST(t[e])}}function MF(e,t){return e(t)}function LF(){}var v5=!1;function RF(e,t,r){if(v5)return e(t,r);v5=!0;try{return MF(e,t,r)}finally{v5=!1,(sm!==null||om!==null)&&(LF(),OF())}}function qx(e,t){var r=e.stateNode;if(r===null)return null;var n=nS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(rn(231,t,typeof r));return r}var Uj=!1;if(qd)try{var Mg={};Object.defineProperty(Mg,"passive",{get:function(){Uj=!0}}),window.addEventListener("test",Mg,Mg),window.removeEventListener("test",Mg,Mg)}catch{Uj=!1}function XY(e,t,r,n,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var bx=!1,a2=null,s2=!1,zj=null,QY={onError:function(e){bx=!0,a2=e}};function JY(e,t,r,n,i,s,o,l,c){bx=!1,a2=null,XY.apply(QY,arguments)}function ZY(e,t,r,n,i,s,o,l,c){if(JY.apply(this,arguments),bx){if(bx){var u=a2;bx=!1,a2=null}else throw Error(rn(198));s2||(s2=!0,zj=u)}}function $0(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function BF(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function _T(e){if($0(e)!==e)throw Error(rn(188))}function eX(e){var t=e.alternate;if(!t){if(t=$0(e),t===null)throw Error(rn(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return _T(i),e;if(s===n)return _T(i),t;s=s.sibling}throw Error(rn(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(rn(189))}}if(r.alternate!==n)throw Error(rn(190))}if(r.tag!==3)throw Error(rn(188));return r.stateNode.current===r?e:t}function FF(e){return e=eX(e),e!==null?IF(e):null}function IF(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=IF(e);if(t!==null)return t;e=e.sibling}return null}var DF=tc.unstable_scheduleCallback,kT=tc.unstable_cancelCallback,tX=tc.unstable_shouldYield,rX=tc.unstable_requestPaint,ts=tc.unstable_now,nX=tc.unstable_getCurrentPriorityLevel,jN=tc.unstable_ImmediatePriority,$F=tc.unstable_UserBlockingPriority,o2=tc.unstable_NormalPriority,iX=tc.unstable_LowPriority,UF=tc.unstable_IdlePriority,Zw=null,Zu=null;function aX(e){if(Zu&&typeof Zu.onCommitFiberRoot=="function")try{Zu.onCommitFiberRoot(Zw,e,void 0,(e.current.flags&128)===128)}catch{}}var uu=Math.clz32?Math.clz32:lX,sX=Math.log,oX=Math.LN2;function lX(e){return e>>>=0,e===0?32:31-(sX(e)/oX|0)|0}var lb=64,cb=4194304;function cx(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function l2(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=cx(l):(s&=o,s!==0&&(n=cx(s)))}else o=r&~i,o!==0?n=cx(o):s!==0&&(n=cx(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-uu(t),i=1<<r,n|=e[r],t&=~i;return n}function cX(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function uX(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-uu(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=cX(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Wj(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function zF(){var e=lb;return lb<<=1,!(lb&4194240)&&(lb=64),e}function w5(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function H1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-uu(t),e[t]=r}function dX(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-uu(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function AN(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-uu(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var qi=0;function WF(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var qF,NN,HF,VF,GF,qj=!1,ub=[],Yf=null,Xf=null,Qf=null,Hx=new Map,Vx=new Map,Ff=[],fX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jT(e,t){switch(e){case"focusin":case"focusout":Yf=null;break;case"dragenter":case"dragleave":Xf=null;break;case"mouseover":case"mouseout":Qf=null;break;case"pointerover":case"pointerout":Hx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Vx.delete(t.pointerId)}}function Lg(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=G1(t),t!==null&&NN(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function hX(e,t,r,n,i){switch(t){case"focusin":return Yf=Lg(Yf,e,t,r,n,i),!0;case"dragenter":return Xf=Lg(Xf,e,t,r,n,i),!0;case"mouseover":return Qf=Lg(Qf,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Hx.set(s,Lg(Hx.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Vx.set(s,Lg(Vx.get(s)||null,e,t,r,n,i)),!0}return!1}function KF(e){var t=qh(e.target);if(t!==null){var r=$0(t);if(r!==null){if(t=r.tag,t===13){if(t=BF(r),t!==null){e.blockedOn=t,GF(e.priority,function(){HF(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Ev(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Hj(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Dj=n,r.target.dispatchEvent(n),Dj=null}else return t=G1(r),t!==null&&NN(t),e.blockedOn=r,!1;t.shift()}return!0}function AT(e,t,r){Ev(e)&&r.delete(t)}function pX(){qj=!1,Yf!==null&&Ev(Yf)&&(Yf=null),Xf!==null&&Ev(Xf)&&(Xf=null),Qf!==null&&Ev(Qf)&&(Qf=null),Hx.forEach(AT),Vx.forEach(AT)}function Rg(e,t){e.blockedOn===t&&(e.blockedOn=null,qj||(qj=!0,tc.unstable_scheduleCallback(tc.unstable_NormalPriority,pX)))}function Gx(e){function t(i){return Rg(i,e)}if(0<ub.length){Rg(ub[0],e);for(var r=1;r<ub.length;r++){var n=ub[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Yf!==null&&Rg(Yf,e),Xf!==null&&Rg(Xf,e),Qf!==null&&Rg(Qf,e),Hx.forEach(t),Vx.forEach(t),r=0;r<Ff.length;r++)n=Ff[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ff.length&&(r=Ff[0],r.blockedOn===null);)KF(r),r.blockedOn===null&&Ff.shift()}var lm=sf.ReactCurrentBatchConfig,c2=!0;function mX(e,t,r,n){var i=qi,s=lm.transition;lm.transition=null;try{qi=1,CN(e,t,r,n)}finally{qi=i,lm.transition=s}}function gX(e,t,r,n){var i=qi,s=lm.transition;lm.transition=null;try{qi=4,CN(e,t,r,n)}finally{qi=i,lm.transition=s}}function CN(e,t,r,n){if(c2){var i=Hj(e,t,r,n);if(i===null)P5(e,t,n,u2,r),jT(e,n);else if(hX(i,e,t,r,n))n.stopPropagation();else if(jT(e,n),t&4&&-1<fX.indexOf(e)){for(;i!==null;){var s=G1(i);if(s!==null&&qF(s),s=Hj(e,t,r,n),s===null&&P5(e,t,n,u2,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else P5(e,t,n,null,r)}}var u2=null;function Hj(e,t,r,n){if(u2=null,e=kN(n),e=qh(e),e!==null)if(t=$0(e),t===null)e=null;else if(r=t.tag,r===13){if(e=BF(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return u2=e,null}function YF(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nX()){case jN:return 1;case $F:return 4;case o2:case iX:return 16;case UF:return 536870912;default:return 16}default:return 16}}var Uf=null,EN=null,Tv=null;function XF(){if(Tv)return Tv;var e,t=EN,r=t.length,n,i="value"in Uf?Uf.value:Uf.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return Tv=i.slice(e,1<n?1-n:void 0)}function Pv(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function db(){return!0}function NT(){return!1}function oc(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?db:NT,this.isPropagationStopped=NT,this}return Ma(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=db)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=db)},persist:function(){},isPersistent:db}),t}var Xm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},TN=oc(Xm),V1=Ma({},Xm,{view:0,detail:0}),xX=oc(V1),S5,_5,Bg,eS=Ma({},V1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:PN,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bg&&(Bg&&e.type==="mousemove"?(S5=e.screenX-Bg.screenX,_5=e.screenY-Bg.screenY):_5=S5=0,Bg=e),S5)},movementY:function(e){return"movementY"in e?e.movementY:_5}}),CT=oc(eS),yX=Ma({},eS,{dataTransfer:0}),bX=oc(yX),vX=Ma({},V1,{relatedTarget:0}),k5=oc(vX),wX=Ma({},Xm,{animationName:0,elapsedTime:0,pseudoElement:0}),SX=oc(wX),_X=Ma({},Xm,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kX=oc(_X),jX=Ma({},Xm,{data:0}),ET=oc(jX),AX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},CX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function EX(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=CX[e])?!!t[e]:!1}function PN(){return EX}var TX=Ma({},V1,{key:function(e){if(e.key){var t=AX[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Pv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?NX[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:PN,charCode:function(e){return e.type==="keypress"?Pv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Pv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),PX=oc(TX),OX=Ma({},eS,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),TT=oc(OX),MX=Ma({},V1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:PN}),LX=oc(MX),RX=Ma({},Xm,{propertyName:0,elapsedTime:0,pseudoElement:0}),BX=oc(RX),FX=Ma({},eS,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),IX=oc(FX),DX=[9,13,27,32],ON=qd&&"CompositionEvent"in window,vx=null;qd&&"documentMode"in document&&(vx=document.documentMode);var $X=qd&&"TextEvent"in window&&!vx,QF=qd&&(!ON||vx&&8<vx&&11>=vx),PT=" ",OT=!1;function JF(e,t){switch(e){case"keyup":return DX.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZF(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var zp=!1;function UX(e,t){switch(e){case"compositionend":return ZF(t);case"keypress":return t.which!==32?null:(OT=!0,PT);case"textInput":return e=t.data,e===PT&&OT?null:e;default:return null}}function zX(e,t){if(zp)return e==="compositionend"||!ON&&JF(e,t)?(e=XF(),Tv=EN=Uf=null,zp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return QF&&t.locale!=="ko"?null:t.data;default:return null}}var WX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function MT(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!WX[e.type]:t==="textarea"}function eI(e,t,r,n){PF(n),t=d2(t,"onChange"),0<t.length&&(r=new TN("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var wx=null,Kx=null;function qX(e){dI(e,0)}function tS(e){var t=Hp(e);if(kF(t))return e}function HX(e,t){if(e==="change")return t}var tI=!1;if(qd){var j5;if(qd){var A5="oninput"in document;if(!A5){var LT=document.createElement("div");LT.setAttribute("oninput","return;"),A5=typeof LT.oninput=="function"}j5=A5}else j5=!1;tI=j5&&(!document.documentMode||9<document.documentMode)}function RT(){wx&&(wx.detachEvent("onpropertychange",rI),Kx=wx=null)}function rI(e){if(e.propertyName==="value"&&tS(Kx)){var t=[];eI(t,Kx,e,kN(e)),RF(qX,t)}}function VX(e,t,r){e==="focusin"?(RT(),wx=t,Kx=r,wx.attachEvent("onpropertychange",rI)):e==="focusout"&&RT()}function GX(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return tS(Kx)}function KX(e,t){if(e==="click")return tS(t)}function YX(e,t){if(e==="input"||e==="change")return tS(t)}function XX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var mu=typeof Object.is=="function"?Object.is:XX;function Yx(e,t){if(mu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Nj.call(t,i)||!mu(e[i],t[i]))return!1}return!0}function BT(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function FT(e,t){var r=BT(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=BT(r)}}function nI(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?nI(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function iI(){for(var e=window,t=i2();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=i2(e.document)}return t}function MN(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function QX(e){var t=iI(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&nI(r.ownerDocument.documentElement,r)){if(n!==null&&MN(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=FT(r,s);var o=FT(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var JX=qd&&"documentMode"in document&&11>=document.documentMode,Wp=null,Vj=null,Sx=null,Gj=!1;function IT(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Gj||Wp==null||Wp!==i2(n)||(n=Wp,"selectionStart"in n&&MN(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Sx&&Yx(Sx,n)||(Sx=n,n=d2(Vj,"onSelect"),0<n.length&&(t=new TN("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Wp)))}function fb(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var qp={animationend:fb("Animation","AnimationEnd"),animationiteration:fb("Animation","AnimationIteration"),animationstart:fb("Animation","AnimationStart"),transitionend:fb("Transition","TransitionEnd")},N5={},aI={};qd&&(aI=document.createElement("div").style,"AnimationEvent"in window||(delete qp.animationend.animation,delete qp.animationiteration.animation,delete qp.animationstart.animation),"TransitionEvent"in window||delete qp.transitionend.transition);function rS(e){if(N5[e])return N5[e];if(!qp[e])return e;var t=qp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in aI)return N5[e]=t[r];return e}var sI=rS("animationend"),oI=rS("animationiteration"),lI=rS("animationstart"),cI=rS("transitionend"),uI=new Map,DT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yh(e,t){uI.set(e,t),D0(t,[e])}for(var C5=0;C5<DT.length;C5++){var E5=DT[C5],ZX=E5.toLowerCase(),eQ=E5[0].toUpperCase()+E5.slice(1);yh(ZX,"on"+eQ)}yh(sI,"onAnimationEnd");yh(oI,"onAnimationIteration");yh(lI,"onAnimationStart");yh("dblclick","onDoubleClick");yh("focusin","onFocus");yh("focusout","onBlur");yh(cI,"onTransitionEnd");jm("onMouseEnter",["mouseout","mouseover"]);jm("onMouseLeave",["mouseout","mouseover"]);jm("onPointerEnter",["pointerout","pointerover"]);jm("onPointerLeave",["pointerout","pointerover"]);D0("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));D0("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));D0("onBeforeInput",["compositionend","keypress","textInput","paste"]);D0("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));D0("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));D0("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ux="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),tQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(ux));function $T(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,ZY(n,t,void 0,e),e.currentTarget=null}function dI(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;$T(i,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;$T(i,l,u),s=c}}}if(s2)throw e=zj,s2=!1,zj=null,e}function ua(e,t){var r=t[Jj];r===void 0&&(r=t[Jj]=new Set);var n=e+"__bubble";r.has(n)||(fI(t,e,2,!1),r.add(n))}function T5(e,t,r){var n=0;t&&(n|=4),fI(r,e,n,t)}var hb="_reactListening"+Math.random().toString(36).slice(2);function Xx(e){if(!e[hb]){e[hb]=!0,bF.forEach(function(r){r!=="selectionchange"&&(tQ.has(r)||T5(r,!1,e),T5(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[hb]||(t[hb]=!0,T5("selectionchange",!1,t))}}function fI(e,t,r,n){switch(YF(t)){case 1:var i=mX;break;case 4:i=gX;break;default:i=CN}r=i.bind(null,t,r,e),i=void 0,!Uj||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function P5(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=qh(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}RF(function(){var u=s,d=kN(r),f=[];e:{var h=uI.get(e);if(h!==void 0){var p=TN,m=e;switch(e){case"keypress":if(Pv(r)===0)break e;case"keydown":case"keyup":p=PX;break;case"focusin":m="focus",p=k5;break;case"focusout":m="blur",p=k5;break;case"beforeblur":case"afterblur":p=k5;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=CT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=bX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=LX;break;case sI:case oI:case lI:p=SX;break;case cI:p=BX;break;case"scroll":p=xX;break;case"wheel":p=IX;break;case"copy":case"cut":case"paste":p=kX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=TT}var g=(t&4)!==0,y=!g&&e==="scroll",b=g?h!==null?h+"Capture":null:h;g=[];for(var v=u,w;v!==null;){w=v;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,b!==null&&(S=qx(v,b),S!=null&&g.push(Qx(v,S,w)))),y)break;v=v.return}0<g.length&&(h=new p(h,m,null,r,d),f.push({event:h,listeners:g}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Dj&&(m=r.relatedTarget||r.fromElement)&&(qh(m)||m[Hd]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(m=r.relatedTarget||r.toElement,p=u,m=m?qh(m):null,m!==null&&(y=$0(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(p=null,m=u),p!==m)){if(g=CT,S="onMouseLeave",b="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=TT,S="onPointerLeave",b="onPointerEnter",v="pointer"),y=p==null?h:Hp(p),w=m==null?h:Hp(m),h=new g(S,v+"leave",p,r,d),h.target=y,h.relatedTarget=w,S=null,qh(d)===u&&(g=new g(b,v+"enter",m,r,d),g.target=w,g.relatedTarget=y,S=g),y=S,p&&m)t:{for(g=p,b=m,v=0,w=g;w;w=fp(w))v++;for(w=0,S=b;S;S=fp(S))w++;for(;0<v-w;)g=fp(g),v--;for(;0<w-v;)b=fp(b),w--;for(;v--;){if(g===b||b!==null&&g===b.alternate)break t;g=fp(g),b=fp(b)}g=null}else g=null;p!==null&&UT(f,h,p,g,!1),m!==null&&y!==null&&UT(f,y,m,g,!0)}}e:{if(h=u?Hp(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var k=HX;else if(MT(h))if(tI)k=YX;else{k=GX;var j=VX}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(k=KX);if(k&&(k=k(e,u))){eI(f,k,r,d);break e}j&&j(e,h,u),e==="focusout"&&(j=h._wrapperState)&&j.controlled&&h.type==="number"&&Lj(h,"number",h.value)}switch(j=u?Hp(u):window,e){case"focusin":(MT(j)||j.contentEditable==="true")&&(Wp=j,Vj=u,Sx=null);break;case"focusout":Sx=Vj=Wp=null;break;case"mousedown":Gj=!0;break;case"contextmenu":case"mouseup":case"dragend":Gj=!1,IT(f,r,d);break;case"selectionchange":if(JX)break;case"keydown":case"keyup":IT(f,r,d)}var A;if(ON)e:{switch(e){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else zp?JF(e,r)&&(L="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(L="onCompositionStart");L&&(QF&&r.locale!=="ko"&&(zp||L!=="onCompositionStart"?L==="onCompositionEnd"&&zp&&(A=XF()):(Uf=d,EN="value"in Uf?Uf.value:Uf.textContent,zp=!0)),j=d2(u,L),0<j.length&&(L=new ET(L,e,null,r,d),f.push({event:L,listeners:j}),A?L.data=A:(A=ZF(r),A!==null&&(L.data=A)))),(A=$X?UX(e,r):zX(e,r))&&(u=d2(u,"onBeforeInput"),0<u.length&&(d=new ET("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=A))}dI(f,t)})}function Qx(e,t,r){return{instance:e,listener:t,currentTarget:r}}function d2(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=qx(e,r),s!=null&&n.unshift(Qx(e,s,i)),s=qx(e,t),s!=null&&n.push(Qx(e,s,i))),e=e.return}return n}function fp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function UT(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=qx(r,s),c!=null&&o.unshift(Qx(r,c,l))):i||(c=qx(r,s),c!=null&&o.push(Qx(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var rQ=/\r\n?/g,nQ=/\u0000|\uFFFD/g;function zT(e){return(typeof e=="string"?e:""+e).replace(rQ,`
`).replace(nQ,"")}function pb(e,t,r){if(t=zT(t),zT(e)!==t&&r)throw Error(rn(425))}function f2(){}var Kj=null,Yj=null;function Xj(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Qj=typeof setTimeout=="function"?setTimeout:void 0,iQ=typeof clearTimeout=="function"?clearTimeout:void 0,WT=typeof Promise=="function"?Promise:void 0,aQ=typeof queueMicrotask=="function"?queueMicrotask:typeof WT<"u"?function(e){return WT.resolve(null).then(e).catch(sQ)}:Qj;function sQ(e){setTimeout(function(){throw e})}function O5(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Gx(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Gx(t)}function Jf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function qT(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Qm=Math.random().toString(36).slice(2),Gu="__reactFiber$"+Qm,Jx="__reactProps$"+Qm,Hd="__reactContainer$"+Qm,Jj="__reactEvents$"+Qm,oQ="__reactListeners$"+Qm,lQ="__reactHandles$"+Qm;function qh(e){var t=e[Gu];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Hd]||r[Gu]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=qT(e);e!==null;){if(r=e[Gu])return r;e=qT(e)}return t}e=r,r=e.parentNode}return null}function G1(e){return e=e[Gu]||e[Hd],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Hp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(rn(33))}function nS(e){return e[Jx]||null}var Zj=[],Vp=-1;function bh(e){return{current:e}}function pa(e){0>Vp||(e.current=Zj[Vp],Zj[Vp]=null,Vp--)}function aa(e,t){Vp++,Zj[Vp]=e.current,e.current=t}var lh={},Io=bh(lh),_l=bh(!1),f0=lh;function Am(e,t){var r=e.type.contextTypes;if(!r)return lh;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function kl(e){return e=e.childContextTypes,e!=null}function h2(){pa(_l),pa(Io)}function HT(e,t,r){if(Io.current!==lh)throw Error(rn(168));aa(Io,t),aa(_l,r)}function hI(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(rn(108,VY(e)||"Unknown",i));return Ma({},r,n)}function p2(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||lh,f0=Io.current,aa(Io,e),aa(_l,_l.current),!0}function VT(e,t,r){var n=e.stateNode;if(!n)throw Error(rn(169));r?(e=hI(e,t,f0),n.__reactInternalMemoizedMergedChildContext=e,pa(_l),pa(Io),aa(Io,e)):pa(_l),aa(_l,r)}var Cd=null,iS=!1,M5=!1;function pI(e){Cd===null?Cd=[e]:Cd.push(e)}function cQ(e){iS=!0,pI(e)}function vh(){if(!M5&&Cd!==null){M5=!0;var e=0,t=qi;try{var r=Cd;for(qi=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Cd=null,iS=!1}catch(i){throw Cd!==null&&(Cd=Cd.slice(e+1)),DF(jN,vh),i}finally{qi=t,M5=!1}}return null}var Gp=[],Kp=0,m2=null,g2=0,Tc=[],Pc=0,h0=null,Od=1,Md="";function Bh(e,t){Gp[Kp++]=g2,Gp[Kp++]=m2,m2=e,g2=t}function mI(e,t,r){Tc[Pc++]=Od,Tc[Pc++]=Md,Tc[Pc++]=h0,h0=e;var n=Od;e=Md;var i=32-uu(n)-1;n&=~(1<<i),r+=1;var s=32-uu(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Od=1<<32-uu(t)+i|r<<i|n,Md=s+e}else Od=1<<s|r<<i|n,Md=e}function LN(e){e.return!==null&&(Bh(e,1),mI(e,1,0))}function RN(e){for(;e===m2;)m2=Gp[--Kp],Gp[Kp]=null,g2=Gp[--Kp],Gp[Kp]=null;for(;e===h0;)h0=Tc[--Pc],Tc[Pc]=null,Md=Tc[--Pc],Tc[Pc]=null,Od=Tc[--Pc],Tc[Pc]=null}var Zl=null,Xl=null,Sa=!1,iu=null;function gI(e,t){var r=Mc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function GT(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Zl=e,Xl=Jf(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Zl=e,Xl=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=h0!==null?{id:Od,overflow:Md}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Mc(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Zl=e,Xl=null,!0):!1;default:return!1}}function e4(e){return(e.mode&1)!==0&&(e.flags&128)===0}function t4(e){if(Sa){var t=Xl;if(t){var r=t;if(!GT(e,t)){if(e4(e))throw Error(rn(418));t=Jf(r.nextSibling);var n=Zl;t&&GT(e,t)?gI(n,r):(e.flags=e.flags&-4097|2,Sa=!1,Zl=e)}}else{if(e4(e))throw Error(rn(418));e.flags=e.flags&-4097|2,Sa=!1,Zl=e}}}function KT(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Zl=e}function mb(e){if(e!==Zl)return!1;if(!Sa)return KT(e),Sa=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xj(e.type,e.memoizedProps)),t&&(t=Xl)){if(e4(e))throw xI(),Error(rn(418));for(;t;)gI(e,t),t=Jf(t.nextSibling)}if(KT(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(rn(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Xl=Jf(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Xl=null}}else Xl=Zl?Jf(e.stateNode.nextSibling):null;return!0}function xI(){for(var e=Xl;e;)e=Jf(e.nextSibling)}function Nm(){Xl=Zl=null,Sa=!1}function BN(e){iu===null?iu=[e]:iu.push(e)}var uQ=sf.ReactCurrentBatchConfig;function Fg(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(rn(309));var n=r.stateNode}if(!n)throw Error(rn(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(rn(284));if(!r._owner)throw Error(rn(290,e))}return e}function gb(e,t){throw e=Object.prototype.toString.call(t),Error(rn(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function YT(e){var t=e._init;return t(e._payload)}function yI(e){function t(b,v){if(e){var w=b.deletions;w===null?(b.deletions=[v],b.flags|=16):w.push(v)}}function r(b,v){if(!e)return null;for(;v!==null;)t(b,v),v=v.sibling;return null}function n(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function i(b,v){return b=rh(b,v),b.index=0,b.sibling=null,b}function s(b,v,w){return b.index=w,e?(w=b.alternate,w!==null?(w=w.index,w<v?(b.flags|=2,v):w):(b.flags|=2,v)):(b.flags|=1048576,v)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,v,w,S){return v===null||v.tag!==6?(v=$5(w,b.mode,S),v.return=b,v):(v=i(v,w),v.return=b,v)}function c(b,v,w,S){var k=w.type;return k===Up?d(b,v,w.props.children,S,w.key):v!==null&&(v.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Mf&&YT(k)===v.type)?(S=i(v,w.props),S.ref=Fg(b,v,w),S.return=b,S):(S=Iv(w.type,w.key,w.props,null,b.mode,S),S.ref=Fg(b,v,w),S.return=b,S)}function u(b,v,w,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=U5(w,b.mode,S),v.return=b,v):(v=i(v,w.children||[]),v.return=b,v)}function d(b,v,w,S,k){return v===null||v.tag!==7?(v=t0(w,b.mode,S,k),v.return=b,v):(v=i(v,w),v.return=b,v)}function f(b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=$5(""+v,b.mode,w),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ab:return w=Iv(v.type,v.key,v.props,null,b.mode,w),w.ref=Fg(b,null,v),w.return=b,w;case $p:return v=U5(v,b.mode,w),v.return=b,v;case Mf:var S=v._init;return f(b,S(v._payload),w)}if(lx(v)||Og(v))return v=t0(v,b.mode,w,null),v.return=b,v;gb(b,v)}return null}function h(b,v,w,S){var k=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return k!==null?null:l(b,v,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ab:return w.key===k?c(b,v,w,S):null;case $p:return w.key===k?u(b,v,w,S):null;case Mf:return k=w._init,h(b,v,k(w._payload),S)}if(lx(w)||Og(w))return k!==null?null:d(b,v,w,S,null);gb(b,w)}return null}function p(b,v,w,S,k){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(w)||null,l(v,b,""+S,k);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ab:return b=b.get(S.key===null?w:S.key)||null,c(v,b,S,k);case $p:return b=b.get(S.key===null?w:S.key)||null,u(v,b,S,k);case Mf:var j=S._init;return p(b,v,w,j(S._payload),k)}if(lx(S)||Og(S))return b=b.get(w)||null,d(v,b,S,k,null);gb(v,S)}return null}function m(b,v,w,S){for(var k=null,j=null,A=v,L=v=0,P=null;A!==null&&L<w.length;L++){A.index>L?(P=A,A=null):P=A.sibling;var B=h(b,A,w[L],S);if(B===null){A===null&&(A=P);break}e&&A&&B.alternate===null&&t(b,A),v=s(B,v,L),j===null?k=B:j.sibling=B,j=B,A=P}if(L===w.length)return r(b,A),Sa&&Bh(b,L),k;if(A===null){for(;L<w.length;L++)A=f(b,w[L],S),A!==null&&(v=s(A,v,L),j===null?k=A:j.sibling=A,j=A);return Sa&&Bh(b,L),k}for(A=n(b,A);L<w.length;L++)P=p(A,b,L,w[L],S),P!==null&&(e&&P.alternate!==null&&A.delete(P.key===null?L:P.key),v=s(P,v,L),j===null?k=P:j.sibling=P,j=P);return e&&A.forEach(function(E){return t(b,E)}),Sa&&Bh(b,L),k}function g(b,v,w,S){var k=Og(w);if(typeof k!="function")throw Error(rn(150));if(w=k.call(w),w==null)throw Error(rn(151));for(var j=k=null,A=v,L=v=0,P=null,B=w.next();A!==null&&!B.done;L++,B=w.next()){A.index>L?(P=A,A=null):P=A.sibling;var E=h(b,A,B.value,S);if(E===null){A===null&&(A=P);break}e&&A&&E.alternate===null&&t(b,A),v=s(E,v,L),j===null?k=E:j.sibling=E,j=E,A=P}if(B.done)return r(b,A),Sa&&Bh(b,L),k;if(A===null){for(;!B.done;L++,B=w.next())B=f(b,B.value,S),B!==null&&(v=s(B,v,L),j===null?k=B:j.sibling=B,j=B);return Sa&&Bh(b,L),k}for(A=n(b,A);!B.done;L++,B=w.next())B=p(A,b,L,B.value,S),B!==null&&(e&&B.alternate!==null&&A.delete(B.key===null?L:B.key),v=s(B,v,L),j===null?k=B:j.sibling=B,j=B);return e&&A.forEach(function(T){return t(b,T)}),Sa&&Bh(b,L),k}function y(b,v,w,S){if(typeof w=="object"&&w!==null&&w.type===Up&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ab:e:{for(var k=w.key,j=v;j!==null;){if(j.key===k){if(k=w.type,k===Up){if(j.tag===7){r(b,j.sibling),v=i(j,w.props.children),v.return=b,b=v;break e}}else if(j.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Mf&&YT(k)===j.type){r(b,j.sibling),v=i(j,w.props),v.ref=Fg(b,j,w),v.return=b,b=v;break e}r(b,j);break}else t(b,j);j=j.sibling}w.type===Up?(v=t0(w.props.children,b.mode,S,w.key),v.return=b,b=v):(S=Iv(w.type,w.key,w.props,null,b.mode,S),S.ref=Fg(b,v,w),S.return=b,b=S)}return o(b);case $p:e:{for(j=w.key;v!==null;){if(v.key===j)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){r(b,v.sibling),v=i(v,w.children||[]),v.return=b,b=v;break e}else{r(b,v);break}else t(b,v);v=v.sibling}v=U5(w,b.mode,S),v.return=b,b=v}return o(b);case Mf:return j=w._init,y(b,v,j(w._payload),S)}if(lx(w))return m(b,v,w,S);if(Og(w))return g(b,v,w,S);gb(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(r(b,v.sibling),v=i(v,w),v.return=b,b=v):(r(b,v),v=$5(w,b.mode,S),v.return=b,b=v),o(b)):r(b,v)}return y}var Cm=yI(!0),bI=yI(!1),x2=bh(null),y2=null,Yp=null,FN=null;function IN(){FN=Yp=y2=null}function DN(e){var t=x2.current;pa(x2),e._currentValue=t}function r4(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function cm(e,t){y2=e,FN=Yp=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(yl=!0),e.firstContext=null)}function Fc(e){var t=e._currentValue;if(FN!==e)if(e={context:e,memoizedValue:t,next:null},Yp===null){if(y2===null)throw Error(rn(308));Yp=e,y2.dependencies={lanes:0,firstContext:e}}else Yp=Yp.next=e;return t}var Hh=null;function $N(e){Hh===null?Hh=[e]:Hh.push(e)}function vI(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,$N(t)):(r.next=i.next,i.next=r),t.interleaved=r,Vd(e,n)}function Vd(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Lf=!1;function UN(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function wI(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Id(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Zf(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,wi&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Vd(e,r)}return i=n.interleaved,i===null?(t.next=t,$N(n)):(t.next=i.next,i.next=t),n.interleaved=t,Vd(e,r)}function Ov(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,AN(e,r)}}function XT(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function b2(e,t,r,n){var i=e.updateQueue;Lf=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,d=u=c=null,l=s;do{var h=l.lane,p=l.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,g=l;switch(h=t,p=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(p,f,h);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,h=typeof m=="function"?m.call(p,f,h):m,h==null)break e;f=Ma({},f,h);break e;case 2:Lf=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,h=i.effects,h===null?i.effects=[l]:h.push(l))}else p={eventTime:p,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=p,c=f):d=d.next=p,o|=h;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;h=l,l=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);m0|=o,e.lanes=o,e.memoizedState=f}}function QT(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(rn(191,i));i.call(n)}}}var K1={},ed=bh(K1),Zx=bh(K1),e1=bh(K1);function Vh(e){if(e===K1)throw Error(rn(174));return e}function zN(e,t){switch(aa(e1,t),aa(Zx,e),aa(ed,K1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Bj(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Bj(t,e)}pa(ed),aa(ed,t)}function Em(){pa(ed),pa(Zx),pa(e1)}function SI(e){Vh(e1.current);var t=Vh(ed.current),r=Bj(t,e.type);t!==r&&(aa(Zx,e),aa(ed,r))}function WN(e){Zx.current===e&&(pa(ed),pa(Zx))}var Ca=bh(0);function v2(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var L5=[];function qN(){for(var e=0;e<L5.length;e++)L5[e]._workInProgressVersionPrimary=null;L5.length=0}var Mv=sf.ReactCurrentDispatcher,R5=sf.ReactCurrentBatchConfig,p0=0,Oa=null,Cs=null,Ws=null,w2=!1,_x=!1,t1=0,dQ=0;function vo(){throw Error(rn(321))}function HN(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!mu(e[r],t[r]))return!1;return!0}function VN(e,t,r,n,i,s){if(p0=s,Oa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Mv.current=e===null||e.memoizedState===null?mQ:gQ,e=r(n,i),_x){s=0;do{if(_x=!1,t1=0,25<=s)throw Error(rn(301));s+=1,Ws=Cs=null,t.updateQueue=null,Mv.current=xQ,e=r(n,i)}while(_x)}if(Mv.current=S2,t=Cs!==null&&Cs.next!==null,p0=0,Ws=Cs=Oa=null,w2=!1,t)throw Error(rn(300));return e}function GN(){var e=t1!==0;return t1=0,e}function Wu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ws===null?Oa.memoizedState=Ws=e:Ws=Ws.next=e,Ws}function Ic(){if(Cs===null){var e=Oa.alternate;e=e!==null?e.memoizedState:null}else e=Cs.next;var t=Ws===null?Oa.memoizedState:Ws.next;if(t!==null)Ws=t,Cs=e;else{if(e===null)throw Error(rn(310));Cs=e,e={memoizedState:Cs.memoizedState,baseState:Cs.baseState,baseQueue:Cs.baseQueue,queue:Cs.queue,next:null},Ws===null?Oa.memoizedState=Ws=e:Ws=Ws.next=e}return Ws}function r1(e,t){return typeof t=="function"?t(e):t}function B5(e){var t=Ic(),r=t.queue;if(r===null)throw Error(rn(311));r.lastRenderedReducer=e;var n=Cs,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((p0&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Oa.lanes|=d,m0|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,mu(n,t.memoizedState)||(yl=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Oa.lanes|=s,m0|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function F5(e){var t=Ic(),r=t.queue;if(r===null)throw Error(rn(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);mu(s,t.memoizedState)||(yl=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function _I(){}function kI(e,t){var r=Oa,n=Ic(),i=t(),s=!mu(n.memoizedState,i);if(s&&(n.memoizedState=i,yl=!0),n=n.queue,KN(NI.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Ws!==null&&Ws.memoizedState.tag&1){if(r.flags|=2048,n1(9,AI.bind(null,r,n,i,t),void 0,null),Ks===null)throw Error(rn(349));p0&30||jI(r,t,i)}return i}function jI(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Oa.updateQueue,t===null?(t={lastEffect:null,stores:null},Oa.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function AI(e,t,r,n){t.value=r,t.getSnapshot=n,CI(t)&&EI(e)}function NI(e,t,r){return r(function(){CI(t)&&EI(e)})}function CI(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!mu(e,r)}catch{return!0}}function EI(e){var t=Vd(e,1);t!==null&&du(t,e,1,-1)}function JT(e){var t=Wu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r1,lastRenderedState:e},t.queue=e,e=e.dispatch=pQ.bind(null,Oa,e),[t.memoizedState,e]}function n1(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Oa.updateQueue,t===null?(t={lastEffect:null,stores:null},Oa.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function TI(){return Ic().memoizedState}function Lv(e,t,r,n){var i=Wu();Oa.flags|=e,i.memoizedState=n1(1|t,r,void 0,n===void 0?null:n)}function aS(e,t,r,n){var i=Ic();n=n===void 0?null:n;var s=void 0;if(Cs!==null){var o=Cs.memoizedState;if(s=o.destroy,n!==null&&HN(n,o.deps)){i.memoizedState=n1(t,r,s,n);return}}Oa.flags|=e,i.memoizedState=n1(1|t,r,s,n)}function ZT(e,t){return Lv(8390656,8,e,t)}function KN(e,t){return aS(2048,8,e,t)}function PI(e,t){return aS(4,2,e,t)}function OI(e,t){return aS(4,4,e,t)}function MI(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function LI(e,t,r){return r=r!=null?r.concat([e]):null,aS(4,4,MI.bind(null,t,e),r)}function YN(){}function RI(e,t){var r=Ic();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&HN(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function BI(e,t){var r=Ic();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&HN(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function FI(e,t,r){return p0&21?(mu(r,t)||(r=zF(),Oa.lanes|=r,m0|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,yl=!0),e.memoizedState=r)}function fQ(e,t){var r=qi;qi=r!==0&&4>r?r:4,e(!0);var n=R5.transition;R5.transition={};try{e(!1),t()}finally{qi=r,R5.transition=n}}function II(){return Ic().memoizedState}function hQ(e,t,r){var n=th(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},DI(e))$I(t,r);else if(r=vI(e,t,r,n),r!==null){var i=el();du(r,e,n,i),UI(r,t,n)}}function pQ(e,t,r){var n=th(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(DI(e))$I(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,mu(l,o)){var c=t.interleaved;c===null?(i.next=i,$N(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=vI(e,t,i,n),r!==null&&(i=el(),du(r,e,n,i),UI(r,t,n))}}function DI(e){var t=e.alternate;return e===Oa||t!==null&&t===Oa}function $I(e,t){_x=w2=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function UI(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,AN(e,r)}}var S2={readContext:Fc,useCallback:vo,useContext:vo,useEffect:vo,useImperativeHandle:vo,useInsertionEffect:vo,useLayoutEffect:vo,useMemo:vo,useReducer:vo,useRef:vo,useState:vo,useDebugValue:vo,useDeferredValue:vo,useTransition:vo,useMutableSource:vo,useSyncExternalStore:vo,useId:vo,unstable_isNewReconciler:!1},mQ={readContext:Fc,useCallback:function(e,t){return Wu().memoizedState=[e,t===void 0?null:t],e},useContext:Fc,useEffect:ZT,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Lv(4194308,4,MI.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Lv(4194308,4,e,t)},useInsertionEffect:function(e,t){return Lv(4,2,e,t)},useMemo:function(e,t){var r=Wu();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Wu();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=hQ.bind(null,Oa,e),[n.memoizedState,e]},useRef:function(e){var t=Wu();return e={current:e},t.memoizedState=e},useState:JT,useDebugValue:YN,useDeferredValue:function(e){return Wu().memoizedState=e},useTransition:function(){var e=JT(!1),t=e[0];return e=fQ.bind(null,e[1]),Wu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Oa,i=Wu();if(Sa){if(r===void 0)throw Error(rn(407));r=r()}else{if(r=t(),Ks===null)throw Error(rn(349));p0&30||jI(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,ZT(NI.bind(null,n,s,e),[e]),n.flags|=2048,n1(9,AI.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Wu(),t=Ks.identifierPrefix;if(Sa){var r=Md,n=Od;r=(n&~(1<<32-uu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=t1++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=dQ++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},gQ={readContext:Fc,useCallback:RI,useContext:Fc,useEffect:KN,useImperativeHandle:LI,useInsertionEffect:PI,useLayoutEffect:OI,useMemo:BI,useReducer:B5,useRef:TI,useState:function(){return B5(r1)},useDebugValue:YN,useDeferredValue:function(e){var t=Ic();return FI(t,Cs.memoizedState,e)},useTransition:function(){var e=B5(r1)[0],t=Ic().memoizedState;return[e,t]},useMutableSource:_I,useSyncExternalStore:kI,useId:II,unstable_isNewReconciler:!1},xQ={readContext:Fc,useCallback:RI,useContext:Fc,useEffect:KN,useImperativeHandle:LI,useInsertionEffect:PI,useLayoutEffect:OI,useMemo:BI,useReducer:F5,useRef:TI,useState:function(){return F5(r1)},useDebugValue:YN,useDeferredValue:function(e){var t=Ic();return Cs===null?t.memoizedState=e:FI(t,Cs.memoizedState,e)},useTransition:function(){var e=F5(r1)[0],t=Ic().memoizedState;return[e,t]},useMutableSource:_I,useSyncExternalStore:kI,useId:II,unstable_isNewReconciler:!1};function ru(e,t){if(e&&e.defaultProps){t=Ma({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function n4(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Ma({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var sS={isMounted:function(e){return(e=e._reactInternals)?$0(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=el(),i=th(e),s=Id(n,i);s.payload=t,r!=null&&(s.callback=r),t=Zf(e,s,i),t!==null&&(du(t,e,i,n),Ov(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=el(),i=th(e),s=Id(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Zf(e,s,i),t!==null&&(du(t,e,i,n),Ov(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=el(),n=th(e),i=Id(r,n);i.tag=2,t!=null&&(i.callback=t),t=Zf(e,i,n),t!==null&&(du(t,e,n,r),Ov(t,e,n))}};function e8(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!Yx(r,n)||!Yx(i,s):!0}function zI(e,t,r){var n=!1,i=lh,s=t.contextType;return typeof s=="object"&&s!==null?s=Fc(s):(i=kl(t)?f0:Io.current,n=t.contextTypes,s=(n=n!=null)?Am(e,i):lh),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=sS,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function t8(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&sS.enqueueReplaceState(t,t.state,null)}function i4(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},UN(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Fc(s):(s=kl(t)?f0:Io.current,i.context=Am(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(n4(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&sS.enqueueReplaceState(i,i.state,null),b2(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Tm(e,t){try{var r="",n=t;do r+=HY(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function I5(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function a4(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var yQ=typeof WeakMap=="function"?WeakMap:Map;function WI(e,t,r){r=Id(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){k2||(k2=!0,m4=n),a4(e,t)},r}function qI(e,t,r){r=Id(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){a4(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){a4(e,t),typeof n!="function"&&(eh===null?eh=new Set([this]):eh.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function r8(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new yQ;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=OQ.bind(null,e,t,r),t.then(e,e))}function n8(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function i8(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Id(-1,1),t.tag=2,Zf(r,t,1))),r.lanes|=1),e)}var bQ=sf.ReactCurrentOwner,yl=!1;function Yo(e,t,r,n){t.child=e===null?bI(t,null,r,n):Cm(t,e.child,r,n)}function a8(e,t,r,n,i){r=r.render;var s=t.ref;return cm(t,i),n=VN(e,t,r,n,s,i),r=GN(),e!==null&&!yl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gd(e,t,i)):(Sa&&r&&LN(t),t.flags|=1,Yo(e,t,n,i),t.child)}function s8(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!n3(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,HI(e,t,s,n,i)):(e=Iv(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Yx,r(o,n)&&e.ref===t.ref)return Gd(e,t,i)}return t.flags|=1,e=rh(s,n),e.ref=t.ref,e.return=t,t.child=e}function HI(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Yx(s,n)&&e.ref===t.ref)if(yl=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(yl=!0);else return t.lanes=e.lanes,Gd(e,t,i)}return s4(e,t,r,n,i)}function VI(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},aa(Qp,ql),ql|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,aa(Qp,ql),ql|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,aa(Qp,ql),ql|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,aa(Qp,ql),ql|=n;return Yo(e,t,i,r),t.child}function GI(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function s4(e,t,r,n,i){var s=kl(r)?f0:Io.current;return s=Am(t,s),cm(t,i),r=VN(e,t,r,n,s,i),n=GN(),e!==null&&!yl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Gd(e,t,i)):(Sa&&n&&LN(t),t.flags|=1,Yo(e,t,r,i),t.child)}function o8(e,t,r,n,i){if(kl(r)){var s=!0;p2(t)}else s=!1;if(cm(t,i),t.stateNode===null)Rv(e,t),zI(t,r,n),i4(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Fc(u):(u=kl(r)?f0:Io.current,u=Am(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&t8(t,o,n,u),Lf=!1;var h=t.memoizedState;o.state=h,b2(t,n,o,i),c=t.memoizedState,l!==n||h!==c||_l.current||Lf?(typeof d=="function"&&(n4(t,r,d,n),c=t.memoizedState),(l=Lf||e8(t,r,l,n,h,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,wI(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:ru(t.type,l),o.props=u,f=t.pendingProps,h=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Fc(c):(c=kl(r)?f0:Io.current,c=Am(t,c));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||h!==c)&&t8(t,o,n,c),Lf=!1,h=t.memoizedState,o.state=h,b2(t,n,o,i);var m=t.memoizedState;l!==f||h!==m||_l.current||Lf?(typeof p=="function"&&(n4(t,r,p,n),m=t.memoizedState),(u=Lf||e8(t,r,u,n,h,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return o4(e,t,r,n,s,i)}function o4(e,t,r,n,i,s){GI(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&VT(t,r,!1),Gd(e,t,s);n=t.stateNode,bQ.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Cm(t,e.child,null,s),t.child=Cm(t,null,l,s)):Yo(e,t,l,s),t.memoizedState=n.state,i&&VT(t,r,!0),t.child}function KI(e){var t=e.stateNode;t.pendingContext?HT(e,t.pendingContext,t.pendingContext!==t.context):t.context&&HT(e,t.context,!1),zN(e,t.containerInfo)}function l8(e,t,r,n,i){return Nm(),BN(i),t.flags|=256,Yo(e,t,r,n),t.child}var l4={dehydrated:null,treeContext:null,retryLane:0};function c4(e){return{baseLanes:e,cachePool:null,transitions:null}}function YI(e,t,r){var n=t.pendingProps,i=Ca.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),aa(Ca,i&1),e===null)return t4(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cS(o,n,0,null),e=t0(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=c4(r),t.memoizedState=l4,e):XN(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return vQ(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=rh(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=rh(l,s):(s=t0(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?c4(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=l4,n}return s=e.child,e=s.sibling,n=rh(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function XN(e,t){return t=cS({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function xb(e,t,r,n){return n!==null&&BN(n),Cm(t,e.child,null,r),e=XN(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function vQ(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=I5(Error(rn(422))),xb(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=cS({mode:"visible",children:n.children},i,0,null),s=t0(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Cm(t,e.child,null,o),t.child.memoizedState=c4(o),t.memoizedState=l4,s);if(!(t.mode&1))return xb(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(rn(419)),n=I5(s,n,void 0),xb(e,t,o,n)}if(l=(o&e.childLanes)!==0,yl||l){if(n=Ks,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Vd(e,i),du(n,e,i,-1))}return r3(),n=I5(Error(rn(421))),xb(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=MQ.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Xl=Jf(i.nextSibling),Zl=t,Sa=!0,iu=null,e!==null&&(Tc[Pc++]=Od,Tc[Pc++]=Md,Tc[Pc++]=h0,Od=e.id,Md=e.overflow,h0=t),t=XN(t,n.children),t.flags|=4096,t)}function c8(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),r4(e.return,t,r)}function D5(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function XI(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Yo(e,t,n.children,r),n=Ca.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&c8(e,r,t);else if(e.tag===19)c8(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(aa(Ca,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&v2(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),D5(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&v2(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}D5(t,!0,r,null,s);break;case"together":D5(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Rv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gd(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),m0|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(rn(153));if(t.child!==null){for(e=t.child,r=rh(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=rh(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function wQ(e,t,r){switch(t.tag){case 3:KI(t),Nm();break;case 5:SI(t);break;case 1:kl(t.type)&&p2(t);break;case 4:zN(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;aa(x2,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(aa(Ca,Ca.current&1),t.flags|=128,null):r&t.child.childLanes?YI(e,t,r):(aa(Ca,Ca.current&1),e=Gd(e,t,r),e!==null?e.sibling:null);aa(Ca,Ca.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return XI(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),aa(Ca,Ca.current),n)break;return null;case 22:case 23:return t.lanes=0,VI(e,t,r)}return Gd(e,t,r)}var QI,u4,JI,ZI;QI=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};u4=function(){};JI=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Vh(ed.current);var s=null;switch(r){case"input":i=Oj(e,i),n=Oj(e,n),s=[];break;case"select":i=Ma({},i,{value:void 0}),n=Ma({},n,{value:void 0}),s=[];break;case"textarea":i=Rj(e,i),n=Rj(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=f2)}Fj(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(zx.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(zx.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ua("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};ZI=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ig(e,t){if(!Sa)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function wo(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function SQ(e,t,r){var n=t.pendingProps;switch(RN(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wo(t),null;case 1:return kl(t.type)&&h2(),wo(t),null;case 3:return n=t.stateNode,Em(),pa(_l),pa(Io),qN(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(mb(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,iu!==null&&(y4(iu),iu=null))),u4(e,t),wo(t),null;case 5:WN(t);var i=Vh(e1.current);if(r=t.type,e!==null&&t.stateNode!=null)JI(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(rn(166));return wo(t),null}if(e=Vh(ed.current),mb(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Gu]=t,n[Jx]=s,e=(t.mode&1)!==0,r){case"dialog":ua("cancel",n),ua("close",n);break;case"iframe":case"object":case"embed":ua("load",n);break;case"video":case"audio":for(i=0;i<ux.length;i++)ua(ux[i],n);break;case"source":ua("error",n);break;case"img":case"image":case"link":ua("error",n),ua("load",n);break;case"details":ua("toggle",n);break;case"input":yT(n,s),ua("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ua("invalid",n);break;case"textarea":vT(n,s),ua("invalid",n)}Fj(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&pb(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&pb(n.textContent,l,e),i=["children",""+l]):zx.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ua("scroll",n)}switch(r){case"input":sb(n),bT(n,s,!0);break;case"textarea":sb(n),wT(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=f2)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=NF(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Gu]=t,e[Jx]=n,QI(e,t,!1,!1),t.stateNode=e;e:{switch(o=Ij(r,n),r){case"dialog":ua("cancel",e),ua("close",e),i=n;break;case"iframe":case"object":case"embed":ua("load",e),i=n;break;case"video":case"audio":for(i=0;i<ux.length;i++)ua(ux[i],e);i=n;break;case"source":ua("error",e),i=n;break;case"img":case"image":case"link":ua("error",e),ua("load",e),i=n;break;case"details":ua("toggle",e),i=n;break;case"input":yT(e,n),i=Oj(e,n),ua("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=Ma({},n,{value:void 0}),ua("invalid",e);break;case"textarea":vT(e,n),i=Rj(e,n),ua("invalid",e);break;default:i=n}Fj(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?TF(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&CF(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Wx(e,c):typeof c=="number"&&Wx(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(zx.hasOwnProperty(s)?c!=null&&s==="onScroll"&&ua("scroll",e):c!=null&&vN(e,s,c,o))}switch(r){case"input":sb(e),bT(e,n,!1);break;case"textarea":sb(e),wT(e);break;case"option":n.value!=null&&e.setAttribute("value",""+oh(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?am(e,!!n.multiple,s,!1):n.defaultValue!=null&&am(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=f2)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return wo(t),null;case 6:if(e&&t.stateNode!=null)ZI(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(rn(166));if(r=Vh(e1.current),Vh(ed.current),mb(t)){if(n=t.stateNode,r=t.memoizedProps,n[Gu]=t,(s=n.nodeValue!==r)&&(e=Zl,e!==null))switch(e.tag){case 3:pb(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&pb(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Gu]=t,t.stateNode=n}return wo(t),null;case 13:if(pa(Ca),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Sa&&Xl!==null&&t.mode&1&&!(t.flags&128))xI(),Nm(),t.flags|=98560,s=!1;else if(s=mb(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(rn(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(rn(317));s[Gu]=t}else Nm(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;wo(t),s=!1}else iu!==null&&(y4(iu),iu=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ca.current&1?Ps===0&&(Ps=3):r3())),t.updateQueue!==null&&(t.flags|=4),wo(t),null);case 4:return Em(),u4(e,t),e===null&&Xx(t.stateNode.containerInfo),wo(t),null;case 10:return DN(t.type._context),wo(t),null;case 17:return kl(t.type)&&h2(),wo(t),null;case 19:if(pa(Ca),s=t.memoizedState,s===null)return wo(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)Ig(s,!1);else{if(Ps!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=v2(e),o!==null){for(t.flags|=128,Ig(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return aa(Ca,Ca.current&1|2),t.child}e=e.sibling}s.tail!==null&&ts()>Pm&&(t.flags|=128,n=!0,Ig(s,!1),t.lanes=4194304)}else{if(!n)if(e=v2(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ig(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Sa)return wo(t),null}else 2*ts()-s.renderingStartTime>Pm&&r!==1073741824&&(t.flags|=128,n=!0,Ig(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ts(),t.sibling=null,r=Ca.current,aa(Ca,n?r&1|2:r&1),t):(wo(t),null);case 22:case 23:return t3(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?ql&1073741824&&(wo(t),t.subtreeFlags&6&&(t.flags|=8192)):wo(t),null;case 24:return null;case 25:return null}throw Error(rn(156,t.tag))}function _Q(e,t){switch(RN(t),t.tag){case 1:return kl(t.type)&&h2(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Em(),pa(_l),pa(Io),qN(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return WN(t),null;case 13:if(pa(Ca),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(rn(340));Nm()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pa(Ca),null;case 4:return Em(),null;case 10:return DN(t.type._context),null;case 22:case 23:return t3(),null;case 24:return null;default:return null}}var yb=!1,Po=!1,kQ=typeof WeakSet=="function"?WeakSet:Set,Cn=null;function Xp(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Wa(e,t,n)}else r.current=null}function d4(e,t,r){try{r()}catch(n){Wa(e,t,n)}}var u8=!1;function jQ(e,t){if(Kj=c2,e=iI(),MN(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var p;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(p=f.firstChild)!==null;)h=f,f=p;for(;;){if(f===e)break t;if(h===r&&++u===i&&(l=o),h===s&&++d===n&&(c=o),(p=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=p}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Yj={focusedElem:e,selectionRange:r},c2=!1,Cn=t;Cn!==null;)if(t=Cn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Cn=e;else for(;Cn!==null;){t=Cn;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,b=t.stateNode,v=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:ru(t.type,g),y);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(rn(163))}}catch(S){Wa(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,Cn=e;break}Cn=t.return}return m=u8,u8=!1,m}function kx(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&d4(t,r,s)}i=i.next}while(i!==n)}}function oS(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function f4(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function eD(e){var t=e.alternate;t!==null&&(e.alternate=null,eD(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Gu],delete t[Jx],delete t[Jj],delete t[oQ],delete t[lQ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function tD(e){return e.tag===5||e.tag===3||e.tag===4}function d8(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||tD(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function h4(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=f2));else if(n!==4&&(e=e.child,e!==null))for(h4(e,t,r),e=e.sibling;e!==null;)h4(e,t,r),e=e.sibling}function p4(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(p4(e,t,r),e=e.sibling;e!==null;)p4(e,t,r),e=e.sibling}var lo=null,nu=!1;function jf(e,t,r){for(r=r.child;r!==null;)rD(e,t,r),r=r.sibling}function rD(e,t,r){if(Zu&&typeof Zu.onCommitFiberUnmount=="function")try{Zu.onCommitFiberUnmount(Zw,r)}catch{}switch(r.tag){case 5:Po||Xp(r,t);case 6:var n=lo,i=nu;lo=null,jf(e,t,r),lo=n,nu=i,lo!==null&&(nu?(e=lo,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):lo.removeChild(r.stateNode));break;case 18:lo!==null&&(nu?(e=lo,r=r.stateNode,e.nodeType===8?O5(e.parentNode,r):e.nodeType===1&&O5(e,r),Gx(e)):O5(lo,r.stateNode));break;case 4:n=lo,i=nu,lo=r.stateNode.containerInfo,nu=!0,jf(e,t,r),lo=n,nu=i;break;case 0:case 11:case 14:case 15:if(!Po&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&d4(r,t,o),i=i.next}while(i!==n)}jf(e,t,r);break;case 1:if(!Po&&(Xp(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Wa(r,t,l)}jf(e,t,r);break;case 21:jf(e,t,r);break;case 22:r.mode&1?(Po=(n=Po)||r.memoizedState!==null,jf(e,t,r),Po=n):jf(e,t,r);break;default:jf(e,t,r)}}function f8(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new kQ),t.forEach(function(n){var i=LQ.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function Jc(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:lo=l.stateNode,nu=!1;break e;case 3:lo=l.stateNode.containerInfo,nu=!0;break e;case 4:lo=l.stateNode.containerInfo,nu=!0;break e}l=l.return}if(lo===null)throw Error(rn(160));rD(s,o,i),lo=null,nu=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Wa(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)nD(t,e),t=t.sibling}function nD(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Jc(t,e),Cu(e),n&4){try{kx(3,e,e.return),oS(3,e)}catch(g){Wa(e,e.return,g)}try{kx(5,e,e.return)}catch(g){Wa(e,e.return,g)}}break;case 1:Jc(t,e),Cu(e),n&512&&r!==null&&Xp(r,r.return);break;case 5:if(Jc(t,e),Cu(e),n&512&&r!==null&&Xp(r,r.return),e.flags&32){var i=e.stateNode;try{Wx(i,"")}catch(g){Wa(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&jF(i,s),Ij(l,o);var u=Ij(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?TF(i,f):d==="dangerouslySetInnerHTML"?CF(i,f):d==="children"?Wx(i,f):vN(i,d,f,u)}switch(l){case"input":Mj(i,s);break;case"textarea":AF(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?am(i,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?am(i,!!s.multiple,s.defaultValue,!0):am(i,!!s.multiple,s.multiple?[]:"",!1))}i[Jx]=s}catch(g){Wa(e,e.return,g)}}break;case 6:if(Jc(t,e),Cu(e),n&4){if(e.stateNode===null)throw Error(rn(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Wa(e,e.return,g)}}break;case 3:if(Jc(t,e),Cu(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Gx(t.containerInfo)}catch(g){Wa(e,e.return,g)}break;case 4:Jc(t,e),Cu(e);break;case 13:Jc(t,e),Cu(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(ZN=ts())),n&4&&f8(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Po=(u=Po)||d,Jc(t,e),Po=u):Jc(t,e),Cu(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Cn=e,d=e.child;d!==null;){for(f=Cn=d;Cn!==null;){switch(h=Cn,p=h.child,h.tag){case 0:case 11:case 14:case 15:kx(4,h,h.return);break;case 1:Xp(h,h.return);var m=h.stateNode;if(typeof m.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Wa(n,r,g)}}break;case 5:Xp(h,h.return);break;case 22:if(h.memoizedState!==null){p8(f);continue}}p!==null?(p.return=h,Cn=p):p8(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=EF("display",o))}catch(g){Wa(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){Wa(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Jc(t,e),Cu(e),n&4&&f8(e);break;case 21:break;default:Jc(t,e),Cu(e)}}function Cu(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(tD(r)){var n=r;break e}r=r.return}throw Error(rn(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Wx(i,""),n.flags&=-33);var s=d8(e);p4(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=d8(e);h4(e,l,o);break;default:throw Error(rn(161))}}catch(c){Wa(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function AQ(e,t,r){Cn=e,iD(e)}function iD(e,t,r){for(var n=(e.mode&1)!==0;Cn!==null;){var i=Cn,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||yb;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Po;l=yb;var u=Po;if(yb=o,(Po=c)&&!u)for(Cn=i;Cn!==null;)o=Cn,c=o.child,o.tag===22&&o.memoizedState!==null?m8(i):c!==null?(c.return=o,Cn=c):m8(i);for(;s!==null;)Cn=s,iD(s),s=s.sibling;Cn=i,yb=l,Po=u}h8(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Cn=s):h8(e)}}function h8(e){for(;Cn!==null;){var t=Cn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Po||oS(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Po)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ru(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&QT(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}QT(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Gx(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(rn(163))}Po||t.flags&512&&f4(t)}catch(h){Wa(t,t.return,h)}}if(t===e){Cn=null;break}if(r=t.sibling,r!==null){r.return=t.return,Cn=r;break}Cn=t.return}}function p8(e){for(;Cn!==null;){var t=Cn;if(t===e){Cn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Cn=r;break}Cn=t.return}}function m8(e){for(;Cn!==null;){var t=Cn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{oS(4,t)}catch(c){Wa(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){Wa(t,i,c)}}var s=t.return;try{f4(t)}catch(c){Wa(t,s,c)}break;case 5:var o=t.return;try{f4(t)}catch(c){Wa(t,o,c)}}}catch(c){Wa(t,t.return,c)}if(t===e){Cn=null;break}var l=t.sibling;if(l!==null){l.return=t.return,Cn=l;break}Cn=t.return}}var NQ=Math.ceil,_2=sf.ReactCurrentDispatcher,QN=sf.ReactCurrentOwner,Rc=sf.ReactCurrentBatchConfig,wi=0,Ks=null,ps=null,po=0,ql=0,Qp=bh(0),Ps=0,i1=null,m0=0,lS=0,JN=0,jx=null,xl=null,ZN=0,Pm=1/0,Nd=null,k2=!1,m4=null,eh=null,bb=!1,zf=null,j2=0,Ax=0,g4=null,Bv=-1,Fv=0;function el(){return wi&6?ts():Bv!==-1?Bv:Bv=ts()}function th(e){return e.mode&1?wi&2&&po!==0?po&-po:uQ.transition!==null?(Fv===0&&(Fv=zF()),Fv):(e=qi,e!==0||(e=window.event,e=e===void 0?16:YF(e.type)),e):1}function du(e,t,r,n){if(50<Ax)throw Ax=0,g4=null,Error(rn(185));H1(e,r,n),(!(wi&2)||e!==Ks)&&(e===Ks&&(!(wi&2)&&(lS|=r),Ps===4&&If(e,po)),jl(e,n),r===1&&wi===0&&!(t.mode&1)&&(Pm=ts()+500,iS&&vh()))}function jl(e,t){var r=e.callbackNode;uX(e,t);var n=l2(e,e===Ks?po:0);if(n===0)r!==null&&kT(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&kT(r),t===1)e.tag===0?cQ(g8.bind(null,e)):pI(g8.bind(null,e)),aQ(function(){!(wi&6)&&vh()}),r=null;else{switch(WF(n)){case 1:r=jN;break;case 4:r=$F;break;case 16:r=o2;break;case 536870912:r=UF;break;default:r=o2}r=fD(r,aD.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function aD(e,t){if(Bv=-1,Fv=0,wi&6)throw Error(rn(327));var r=e.callbackNode;if(um()&&e.callbackNode!==r)return null;var n=l2(e,e===Ks?po:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=A2(e,n);else{t=n;var i=wi;wi|=2;var s=oD();(Ks!==e||po!==t)&&(Nd=null,Pm=ts()+500,e0(e,t));do try{TQ();break}catch(l){sD(e,l)}while(!0);IN(),_2.current=s,wi=i,ps!==null?t=0:(Ks=null,po=0,t=Ps)}if(t!==0){if(t===2&&(i=Wj(e),i!==0&&(n=i,t=x4(e,i))),t===1)throw r=i1,e0(e,0),If(e,n),jl(e,ts()),r;if(t===6)If(e,n);else{if(i=e.current.alternate,!(n&30)&&!CQ(i)&&(t=A2(e,n),t===2&&(s=Wj(e),s!==0&&(n=s,t=x4(e,s))),t===1))throw r=i1,e0(e,0),If(e,n),jl(e,ts()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(rn(345));case 2:Fh(e,xl,Nd);break;case 3:if(If(e,n),(n&130023424)===n&&(t=ZN+500-ts(),10<t)){if(l2(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){el(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Qj(Fh.bind(null,e,xl,Nd),t);break}Fh(e,xl,Nd);break;case 4:if(If(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-uu(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=ts()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*NQ(n/1960))-n,10<n){e.timeoutHandle=Qj(Fh.bind(null,e,xl,Nd),n);break}Fh(e,xl,Nd);break;case 5:Fh(e,xl,Nd);break;default:throw Error(rn(329))}}}return jl(e,ts()),e.callbackNode===r?aD.bind(null,e):null}function x4(e,t){var r=jx;return e.current.memoizedState.isDehydrated&&(e0(e,t).flags|=256),e=A2(e,t),e!==2&&(t=xl,xl=r,t!==null&&y4(t)),e}function y4(e){xl===null?xl=e:xl.push.apply(xl,e)}function CQ(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!mu(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function If(e,t){for(t&=~JN,t&=~lS,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-uu(t),n=1<<r;e[r]=-1,t&=~n}}function g8(e){if(wi&6)throw Error(rn(327));um();var t=l2(e,0);if(!(t&1))return jl(e,ts()),null;var r=A2(e,t);if(e.tag!==0&&r===2){var n=Wj(e);n!==0&&(t=n,r=x4(e,n))}if(r===1)throw r=i1,e0(e,0),If(e,t),jl(e,ts()),r;if(r===6)throw Error(rn(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Fh(e,xl,Nd),jl(e,ts()),null}function e3(e,t){var r=wi;wi|=1;try{return e(t)}finally{wi=r,wi===0&&(Pm=ts()+500,iS&&vh())}}function g0(e){zf!==null&&zf.tag===0&&!(wi&6)&&um();var t=wi;wi|=1;var r=Rc.transition,n=qi;try{if(Rc.transition=null,qi=1,e)return e()}finally{qi=n,Rc.transition=r,wi=t,!(wi&6)&&vh()}}function t3(){ql=Qp.current,pa(Qp)}function e0(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,iQ(r)),ps!==null)for(r=ps.return;r!==null;){var n=r;switch(RN(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&h2();break;case 3:Em(),pa(_l),pa(Io),qN();break;case 5:WN(n);break;case 4:Em();break;case 13:pa(Ca);break;case 19:pa(Ca);break;case 10:DN(n.type._context);break;case 22:case 23:t3()}r=r.return}if(Ks=e,ps=e=rh(e.current,null),po=ql=t,Ps=0,i1=null,JN=lS=m0=0,xl=jx=null,Hh!==null){for(t=0;t<Hh.length;t++)if(r=Hh[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Hh=null}return e}function sD(e,t){do{var r=ps;try{if(IN(),Mv.current=S2,w2){for(var n=Oa.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}w2=!1}if(p0=0,Ws=Cs=Oa=null,_x=!1,t1=0,QN.current=null,r===null||r.return===null){Ps=1,i1=t,ps=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=po,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=n8(o);if(p!==null){p.flags&=-257,i8(p,o,l,s,t),p.mode&1&&r8(s,u,t),t=p,c=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}else{if(!(t&1)){r8(s,u,t),r3();break e}c=Error(rn(426))}}else if(Sa&&l.mode&1){var y=n8(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),i8(y,o,l,s,t),BN(Tm(c,l));break e}}s=c=Tm(c,l),Ps!==4&&(Ps=2),jx===null?jx=[s]:jx.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var b=WI(s,c,t);XT(s,b);break e;case 1:l=c;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(eh===null||!eh.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=qI(s,l,t);XT(s,S);break e}}s=s.return}while(s!==null)}cD(r)}catch(k){t=k,ps===r&&r!==null&&(ps=r=r.return);continue}break}while(!0)}function oD(){var e=_2.current;return _2.current=S2,e===null?S2:e}function r3(){(Ps===0||Ps===3||Ps===2)&&(Ps=4),Ks===null||!(m0&268435455)&&!(lS&268435455)||If(Ks,po)}function A2(e,t){var r=wi;wi|=2;var n=oD();(Ks!==e||po!==t)&&(Nd=null,e0(e,t));do try{EQ();break}catch(i){sD(e,i)}while(!0);if(IN(),wi=r,_2.current=n,ps!==null)throw Error(rn(261));return Ks=null,po=0,Ps}function EQ(){for(;ps!==null;)lD(ps)}function TQ(){for(;ps!==null&&!tX();)lD(ps)}function lD(e){var t=dD(e.alternate,e,ql);e.memoizedProps=e.pendingProps,t===null?cD(e):ps=t,QN.current=null}function cD(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=_Q(r,t),r!==null){r.flags&=32767,ps=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ps=6,ps=null;return}}else if(r=SQ(r,t,ql),r!==null){ps=r;return}if(t=t.sibling,t!==null){ps=t;return}ps=t=e}while(t!==null);Ps===0&&(Ps=5)}function Fh(e,t,r){var n=qi,i=Rc.transition;try{Rc.transition=null,qi=1,PQ(e,t,r,n)}finally{Rc.transition=i,qi=n}return null}function PQ(e,t,r,n){do um();while(zf!==null);if(wi&6)throw Error(rn(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(rn(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(dX(e,s),e===Ks&&(ps=Ks=null,po=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||bb||(bb=!0,fD(o2,function(){return um(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Rc.transition,Rc.transition=null;var o=qi;qi=1;var l=wi;wi|=4,QN.current=null,jQ(e,r),nD(r,e),QX(Yj),c2=!!Kj,Yj=Kj=null,e.current=r,AQ(r),rX(),wi=l,qi=o,Rc.transition=s}else e.current=r;if(bb&&(bb=!1,zf=e,j2=i),s=e.pendingLanes,s===0&&(eh=null),aX(r.stateNode),jl(e,ts()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(k2)throw k2=!1,e=m4,m4=null,e;return j2&1&&e.tag!==0&&um(),s=e.pendingLanes,s&1?e===g4?Ax++:(Ax=0,g4=e):Ax=0,vh(),null}function um(){if(zf!==null){var e=WF(j2),t=Rc.transition,r=qi;try{if(Rc.transition=null,qi=16>e?16:e,zf===null)var n=!1;else{if(e=zf,zf=null,j2=0,wi&6)throw Error(rn(331));var i=wi;for(wi|=4,Cn=e.current;Cn!==null;){var s=Cn,o=s.child;if(Cn.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(Cn=u;Cn!==null;){var d=Cn;switch(d.tag){case 0:case 11:case 15:kx(8,d,s)}var f=d.child;if(f!==null)f.return=d,Cn=f;else for(;Cn!==null;){d=Cn;var h=d.sibling,p=d.return;if(eD(d),d===u){Cn=null;break}if(h!==null){h.return=p,Cn=h;break}Cn=p}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}Cn=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Cn=o;else e:for(;Cn!==null;){if(s=Cn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:kx(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,Cn=b;break e}Cn=s.return}}var v=e.current;for(Cn=v;Cn!==null;){o=Cn;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,Cn=w;else e:for(o=v;Cn!==null;){if(l=Cn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:oS(9,l)}}catch(k){Wa(l,l.return,k)}if(l===o){Cn=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,Cn=S;break e}Cn=l.return}}if(wi=i,vh(),Zu&&typeof Zu.onPostCommitFiberRoot=="function")try{Zu.onPostCommitFiberRoot(Zw,e)}catch{}n=!0}return n}finally{qi=r,Rc.transition=t}}return!1}function x8(e,t,r){t=Tm(r,t),t=WI(e,t,1),e=Zf(e,t,1),t=el(),e!==null&&(H1(e,1,t),jl(e,t))}function Wa(e,t,r){if(e.tag===3)x8(e,e,r);else for(;t!==null;){if(t.tag===3){x8(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(eh===null||!eh.has(n))){e=Tm(r,e),e=qI(t,e,1),t=Zf(t,e,1),e=el(),t!==null&&(H1(t,1,e),jl(t,e));break}}t=t.return}}function OQ(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=el(),e.pingedLanes|=e.suspendedLanes&r,Ks===e&&(po&r)===r&&(Ps===4||Ps===3&&(po&130023424)===po&&500>ts()-ZN?e0(e,0):JN|=r),jl(e,t)}function uD(e,t){t===0&&(e.mode&1?(t=cb,cb<<=1,!(cb&130023424)&&(cb=4194304)):t=1);var r=el();e=Vd(e,t),e!==null&&(H1(e,t,r),jl(e,r))}function MQ(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),uD(e,r)}function LQ(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(rn(314))}n!==null&&n.delete(t),uD(e,r)}var dD;dD=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||_l.current)yl=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return yl=!1,wQ(e,t,r);yl=!!(e.flags&131072)}else yl=!1,Sa&&t.flags&1048576&&mI(t,g2,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Rv(e,t),e=t.pendingProps;var i=Am(t,Io.current);cm(t,r),i=VN(null,t,n,e,i,r);var s=GN();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,kl(n)?(s=!0,p2(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,UN(t),i.updater=sS,t.stateNode=i,i._reactInternals=t,i4(t,n,e,r),t=o4(null,t,n,!0,s,r)):(t.tag=0,Sa&&s&&LN(t),Yo(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Rv(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=BQ(n),e=ru(n,e),i){case 0:t=s4(null,t,n,e,r);break e;case 1:t=o8(null,t,n,e,r);break e;case 11:t=a8(null,t,n,e,r);break e;case 14:t=s8(null,t,n,ru(n.type,e),r);break e}throw Error(rn(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ru(n,i),s4(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ru(n,i),o8(e,t,n,i,r);case 3:e:{if(KI(t),e===null)throw Error(rn(387));n=t.pendingProps,s=t.memoizedState,i=s.element,wI(e,t),b2(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Tm(Error(rn(423)),t),t=l8(e,t,n,r,i);break e}else if(n!==i){i=Tm(Error(rn(424)),t),t=l8(e,t,n,r,i);break e}else for(Xl=Jf(t.stateNode.containerInfo.firstChild),Zl=t,Sa=!0,iu=null,r=bI(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Nm(),n===i){t=Gd(e,t,r);break e}Yo(e,t,n,r)}t=t.child}return t;case 5:return SI(t),e===null&&t4(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Xj(n,i)?o=null:s!==null&&Xj(n,s)&&(t.flags|=32),GI(e,t),Yo(e,t,o,r),t.child;case 6:return e===null&&t4(t),null;case 13:return YI(e,t,r);case 4:return zN(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Cm(t,null,n,r):Yo(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ru(n,i),a8(e,t,n,i,r);case 7:return Yo(e,t,t.pendingProps,r),t.child;case 8:return Yo(e,t,t.pendingProps.children,r),t.child;case 12:return Yo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,aa(x2,n._currentValue),n._currentValue=o,s!==null)if(mu(s.value,o)){if(s.children===i.children&&!_l.current){t=Gd(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=Id(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),r4(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(rn(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),r4(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Yo(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,cm(t,r),i=Fc(i),n=n(i),t.flags|=1,Yo(e,t,n,r),t.child;case 14:return n=t.type,i=ru(n,t.pendingProps),i=ru(n.type,i),s8(e,t,n,i,r);case 15:return HI(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ru(n,i),Rv(e,t),t.tag=1,kl(n)?(e=!0,p2(t)):e=!1,cm(t,r),zI(t,n,i),i4(t,n,i,r),o4(null,t,n,!0,e,r);case 19:return XI(e,t,r);case 22:return VI(e,t,r)}throw Error(rn(156,t.tag))};function fD(e,t){return DF(e,t)}function RQ(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(e,t,r,n){return new RQ(e,t,r,n)}function n3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function BQ(e){if(typeof e=="function")return n3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===SN)return 11;if(e===_N)return 14}return 2}function rh(e,t){var r=e.alternate;return r===null?(r=Mc(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Iv(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")n3(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Up:return t0(r.children,i,s,t);case wN:o=8,i|=8;break;case Cj:return e=Mc(12,r,t,i|2),e.elementType=Cj,e.lanes=s,e;case Ej:return e=Mc(13,r,t,i),e.elementType=Ej,e.lanes=s,e;case Tj:return e=Mc(19,r,t,i),e.elementType=Tj,e.lanes=s,e;case SF:return cS(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case vF:o=10;break e;case wF:o=9;break e;case SN:o=11;break e;case _N:o=14;break e;case Mf:o=16,n=null;break e}throw Error(rn(130,e==null?e:typeof e,""))}return t=Mc(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function t0(e,t,r,n){return e=Mc(7,e,n,t),e.lanes=r,e}function cS(e,t,r,n){return e=Mc(22,e,n,t),e.elementType=SF,e.lanes=r,e.stateNode={isHidden:!1},e}function $5(e,t,r){return e=Mc(6,e,null,t),e.lanes=r,e}function U5(e,t,r){return t=Mc(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function FQ(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=w5(0),this.expirationTimes=w5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=w5(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function i3(e,t,r,n,i,s,o,l,c){return e=new FQ(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Mc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},UN(s),e}function IQ(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$p,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function hD(e){if(!e)return lh;e=e._reactInternals;e:{if($0(e)!==e||e.tag!==1)throw Error(rn(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(kl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(rn(171))}if(e.tag===1){var r=e.type;if(kl(r))return hI(e,r,t)}return t}function pD(e,t,r,n,i,s,o,l,c){return e=i3(r,n,!0,e,i,s,o,l,c),e.context=hD(null),r=e.current,n=el(),i=th(r),s=Id(n,i),s.callback=t??null,Zf(r,s,i),e.current.lanes=i,H1(e,i,n),jl(e,n),e}function uS(e,t,r,n){var i=t.current,s=el(),o=th(i);return r=hD(r),t.context===null?t.context=r:t.pendingContext=r,t=Id(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Zf(i,t,o),e!==null&&(du(e,i,o,s),Ov(e,i,o)),o}function N2(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function y8(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function a3(e,t){y8(e,t),(e=e.alternate)&&y8(e,t)}function DQ(){return null}var mD=typeof reportError=="function"?reportError:function(e){console.error(e)};function s3(e){this._internalRoot=e}dS.prototype.render=s3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(rn(409));uS(e,t,null,null)};dS.prototype.unmount=s3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;g0(function(){uS(null,e,null,null)}),t[Hd]=null}};function dS(e){this._internalRoot=e}dS.prototype.unstable_scheduleHydration=function(e){if(e){var t=VF();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ff.length&&t!==0&&t<Ff[r].priority;r++);Ff.splice(r,0,e),r===0&&KF(e)}};function o3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function fS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function b8(){}function $Q(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=N2(o);s.call(u)}}var o=pD(t,n,e,0,null,!1,!1,"",b8);return e._reactRootContainer=o,e[Hd]=o.current,Xx(e.nodeType===8?e.parentNode:e),g0(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=N2(c);l.call(u)}}var c=i3(e,0,!1,null,null,!1,!1,"",b8);return e._reactRootContainer=c,e[Hd]=c.current,Xx(e.nodeType===8?e.parentNode:e),g0(function(){uS(t,c,r,n)}),c}function hS(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=N2(o);l.call(c)}}uS(t,o,e,i)}else o=$Q(r,t,e,i,n);return N2(o)}qF=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=cx(t.pendingLanes);r!==0&&(AN(t,r|1),jl(t,ts()),!(wi&6)&&(Pm=ts()+500,vh()))}break;case 13:g0(function(){var n=Vd(e,1);if(n!==null){var i=el();du(n,e,1,i)}}),a3(e,1)}};NN=function(e){if(e.tag===13){var t=Vd(e,134217728);if(t!==null){var r=el();du(t,e,134217728,r)}a3(e,134217728)}};HF=function(e){if(e.tag===13){var t=th(e),r=Vd(e,t);if(r!==null){var n=el();du(r,e,t,n)}a3(e,t)}};VF=function(){return qi};GF=function(e,t){var r=qi;try{return qi=e,t()}finally{qi=r}};$j=function(e,t,r){switch(t){case"input":if(Mj(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=nS(n);if(!i)throw Error(rn(90));kF(n),Mj(n,i)}}}break;case"textarea":AF(e,r);break;case"select":t=r.value,t!=null&&am(e,!!r.multiple,t,!1)}};MF=e3;LF=g0;var UQ={usingClientEntryPoint:!1,Events:[G1,Hp,nS,PF,OF,e3]},Dg={findFiberByHostInstance:qh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zQ={bundleType:Dg.bundleType,version:Dg.version,rendererPackageName:Dg.rendererPackageName,rendererConfig:Dg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:sf.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=FF(e),e===null?null:e.stateNode},findFiberByHostInstance:Dg.findFiberByHostInstance||DQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vb.isDisabled&&vb.supportsFiber)try{Zw=vb.inject(zQ),Zu=vb}catch{}}sc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UQ;sc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!o3(t))throw Error(rn(200));return IQ(e,t,null,r)};sc.createRoot=function(e,t){if(!o3(e))throw Error(rn(299));var r=!1,n="",i=mD;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=i3(e,1,!1,null,null,r,!1,n,i),e[Hd]=t.current,Xx(e.nodeType===8?e.parentNode:e),new s3(t)};sc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(rn(188)):(e=Object.keys(e).join(","),Error(rn(268,e)));return e=FF(t),e=e===null?null:e.stateNode,e};sc.flushSync=function(e){return g0(e)};sc.hydrate=function(e,t,r){if(!fS(t))throw Error(rn(200));return hS(null,e,t,!0,r)};sc.hydrateRoot=function(e,t,r){if(!o3(e))throw Error(rn(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=mD;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=pD(t,null,e,1,r??null,i,!1,s,o),e[Hd]=t.current,Xx(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new dS(t)};sc.render=function(e,t,r){if(!fS(t))throw Error(rn(200));return hS(null,e,t,!1,r)};sc.unmountComponentAtNode=function(e){if(!fS(e))throw Error(rn(40));return e._reactRootContainer?(g0(function(){hS(null,null,e,!1,function(){e._reactRootContainer=null,e[Hd]=null})}),!0):!1};sc.unstable_batchedUpdates=e3;sc.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!fS(r))throw Error(rn(200));if(e==null||e._reactInternals===void 0)throw Error(rn(38));return hS(e,t,r,!1,n)};sc.version="18.3.1-next-f1338f8080-20240426";function gD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gD)}catch(e){console.error(e)}}gD(),gF.exports=sc;var Y1=gF.exports,xD,v8=Y1;xD=v8.createRoot,v8.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function a1(){return a1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a1.apply(this,arguments)}var Wf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Wf||(Wf={}));const w8="popstate";function WQ(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:o,hash:l}=n.location;return b4("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:C2(i)}return HQ(t,r,null,e)}function ss(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function l3(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function qQ(){return Math.random().toString(36).substr(2,8)}function S8(e,t){return{usr:e.state,key:e.key,idx:t}}function b4(e,t,r,n){return r===void 0&&(r=null),a1({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Jm(t):t,{state:r,key:t&&t.key||n||qQ()})}function C2(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Jm(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function HQ(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,l=Wf.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(a1({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){l=Wf.Pop;let y=d(),b=y==null?null:y-u;u=y,c&&c({action:l,location:g.location,delta:b})}function h(y,b){l=Wf.Push;let v=b4(g.location,y,b);u=d()+1;let w=S8(v,u),S=g.createHref(v);try{o.pushState(w,"",S)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(S)}s&&c&&c({action:l,location:g.location,delta:1})}function p(y,b){l=Wf.Replace;let v=b4(g.location,y,b);u=d();let w=S8(v,u),S=g.createHref(v);o.replaceState(w,"",S),s&&c&&c({action:l,location:g.location,delta:0})}function m(y){let b=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof y=="string"?y:C2(y);return v=v.replace(/ $/,"%20"),ss(b,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,b)}let g={get action(){return l},get location(){return e(i,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(w8,f),c=y,()=>{i.removeEventListener(w8,f),c=null}},createHref(y){return t(i,y)},createURL:m,encodeLocation(y){let b=m(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:h,replace:p,go(y){return o.go(y)}};return g}var _8;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(_8||(_8={}));function VQ(e,t,r){return r===void 0&&(r="/"),GQ(e,t,r)}function GQ(e,t,r,n){let i=typeof t=="string"?Jm(t):t,s=c3(i.pathname||"/",r);if(s==null)return null;let o=yD(e);KQ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=sJ(s);l=nJ(o[c],u)}return l}function yD(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,l)=>{let c={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(ss(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=nh([n,c.relativePath]),d=r.concat(c);s.children&&s.children.length>0&&(ss(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),yD(s.children,t,d,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:tJ(u,s.index),routesMeta:d})};return e.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let c of bD(s.path))i(s,o,c)}),t}function bD(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=bD(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function KQ(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:rJ(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const YQ=/^:[\w-]+$/,XQ=3,QQ=2,JQ=1,ZQ=10,eJ=-2,k8=e=>e==="*";function tJ(e,t){let r=e.split("/"),n=r.length;return r.some(k8)&&(n+=eJ),t&&(n+=QQ),r.filter(i=>!k8(i)).reduce((i,s)=>i+(YQ.test(s)?XQ:s===""?JQ:ZQ),n)}function rJ(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function nJ(e,t,r){let{routesMeta:n}=e,i={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",f=iJ({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:nh([s,f.pathname]),pathnameBase:dJ(nh([s,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(s=nh([s,f.pathnameBase]))}return o}function iJ(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=aJ(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:p}=d;if(h==="*"){let g=l[f]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const m=l[f];return p&&!m?u[h]=void 0:u[h]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:e}}function aJ(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),l3(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function sJ(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return l3(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function c3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const oJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lJ=e=>oJ.test(e);function cJ(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?Jm(e):e,s;if(r)if(lJ(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),l3(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=j8(r.substring(1),"/"):s=j8(r,t)}else s=t;return{pathname:s,search:fJ(n),hash:hJ(i)}}function j8(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function z5(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function uJ(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function u3(e,t){let r=uJ(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function d3(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=Jm(e):(i=a1({},e),ss(!i.pathname||!i.pathname.includes("?"),z5("?","pathname","search",i)),ss(!i.pathname||!i.pathname.includes("#"),z5("#","pathname","hash",i)),ss(!i.search||!i.search.includes("#"),z5("#","search","hash",i)));let s=e===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;i.pathname=h.join("/")}l=f>=0?t[f]:"/"}let c=cJ(i,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const nh=e=>e.join("/").replace(/\/\/+/g,"/"),dJ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),fJ=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,hJ=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function pJ(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const vD=["post","put","patch","delete"];new Set(vD);const mJ=["get",...vD];new Set(mJ);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s1.apply(this,arguments)}const f3=x.createContext(null),gJ=x.createContext(null),wh=x.createContext(null),pS=x.createContext(null),of=x.createContext({outlet:null,matches:[],isDataRoute:!1}),wD=x.createContext(null);function xJ(e,t){let{relative:r}=t===void 0?{}:t;Zm()||ss(!1);let{basename:n,navigator:i}=x.useContext(wh),{hash:s,pathname:o,search:l}=_D(e,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:nh([n,o])),i.createHref({pathname:c,search:l,hash:s})}function Zm(){return x.useContext(pS)!=null}function ul(){return Zm()||ss(!1),x.useContext(pS).location}function SD(e){x.useContext(wh).static||x.useLayoutEffect(e)}function go(){let{isDataRoute:e}=x.useContext(of);return e?TJ():yJ()}function yJ(){Zm()||ss(!1);let e=x.useContext(f3),{basename:t,future:r,navigator:n}=x.useContext(wh),{matches:i}=x.useContext(of),{pathname:s}=ul(),o=JSON.stringify(u3(i,r.v7_relativeSplatPath)),l=x.useRef(!1);return SD(()=>{l.current=!0}),x.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let f=d3(u,JSON.parse(o),s,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:nh([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,o,s,e])}function U0(){let{matches:e}=x.useContext(of),t=e[e.length-1];return t?t.params:{}}function _D(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=x.useContext(wh),{matches:i}=x.useContext(of),{pathname:s}=ul(),o=JSON.stringify(u3(i,n.v7_relativeSplatPath));return x.useMemo(()=>d3(e,JSON.parse(o),s,r==="path"),[e,o,s,r])}function bJ(e,t){return vJ(e,t)}function vJ(e,t,r,n){Zm()||ss(!1);let{navigator:i}=x.useContext(wh),{matches:s}=x.useContext(of),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=ul(),d;if(t){var f;let y=typeof t=="string"?Jm(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||ss(!1),d=y}else d=u;let h=d.pathname||"/",p=h;if(c!=="/"){let y=c.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=VQ(e,{pathname:p}),g=jJ(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:nh([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:nh([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return t&&g?x.createElement(pS.Provider,{value:{location:s1({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Wf.Pop}},g):g}function wJ(){let e=EJ(),t=pJ(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:i},r):null,null)}const SJ=x.createElement(wJ,null);class _J extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?x.createElement(of.Provider,{value:this.props.routeContext},x.createElement(wD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function kJ(e){let{routeContext:t,match:r,children:n}=e,i=x.useContext(f3);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(of.Provider,{value:t},n)}function jJ(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let d=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||ss(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:p}=r,m=f.route.loader&&h[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||m){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,h)=>{let p,m=!1,g=null,y=null;r&&(p=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||SJ,c&&(u<0&&h===0?(PJ("route-fallback"),m=!0,y=null):u===h&&(m=!0,y=f.route.hydrateFallbackElement||null)));let b=t.concat(o.slice(0,h+1)),v=()=>{let w;return p?w=g:m?w=y:f.route.Component?w=x.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=d,x.createElement(kJ,{match:f,routeContext:{outlet:d,matches:b,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?x.createElement(_J,{location:r.location,revalidation:r.revalidation,component:g,error:p,children:v(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):v()},null)}var kD=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(kD||{}),jD=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(jD||{});function AJ(e){let t=x.useContext(f3);return t||ss(!1),t}function NJ(e){let t=x.useContext(gJ);return t||ss(!1),t}function CJ(e){let t=x.useContext(of);return t||ss(!1),t}function AD(e){let t=CJ(),r=t.matches[t.matches.length-1];return r.route.id||ss(!1),r.route.id}function EJ(){var e;let t=x.useContext(wD),r=NJ(),n=AD();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function TJ(){let{router:e}=AJ(kD.UseNavigateStable),t=AD(jD.UseNavigateStable),r=x.useRef(!1);return SD(()=>{r.current=!0}),x.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,s1({fromRouteId:t},s)))},[e,t])}const A8={};function PJ(e,t,r){A8[e]||(A8[e]=!0)}function OJ(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Jp(e){let{to:t,replace:r,state:n,relative:i}=e;Zm()||ss(!1);let{future:s,static:o}=x.useContext(wh),{matches:l}=x.useContext(of),{pathname:c}=ul(),u=go(),d=d3(t,u3(l,s.v7_relativeSplatPath),c,i==="path"),f=JSON.stringify(d);return x.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:i}),[u,f,i,r,n]),null}function ni(e){ss(!1)}function MJ(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Wf.Pop,navigator:s,static:o=!1,future:l}=e;Zm()&&ss(!1);let c=t.replace(/^\/*/,"/"),u=x.useMemo(()=>({basename:c,navigator:s,static:o,future:s1({v7_relativeSplatPath:!1},l)}),[c,l,s,o]);typeof n=="string"&&(n=Jm(n));let{pathname:d="/",search:f="",hash:h="",state:p=null,key:m="default"}=n,g=x.useMemo(()=>{let y=c3(d,c);return y==null?null:{location:{pathname:y,search:f,hash:h,state:p,key:m},navigationType:i}},[c,d,f,h,p,m,i]);return g==null?null:x.createElement(wh.Provider,{value:u},x.createElement(pS.Provider,{children:r,value:g}))}function v4(e){let{children:t,location:r}=e;return bJ(w4(t),r)}new Promise(()=>{});function w4(e,t){t===void 0&&(t=[]);let r=[];return x.Children.forEach(e,(n,i)=>{if(!x.isValidElement(n))return;let s=[...t,i];if(n.type===x.Fragment){r.push.apply(r,w4(n.props.children,s));return}n.type!==ni&&ss(!1),!n.props.index||!n.props.children||ss(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=w4(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function S4(){return S4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S4.apply(this,arguments)}function LJ(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function RJ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function BJ(e,t){return e.button===0&&(!t||t==="_self")&&!RJ(e)}function _4(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function FJ(e,t){let r=_4(e);return t&&t.forEach((n,i)=>{r.has(i)||t.getAll(i).forEach(s=>{r.append(i,s)})}),r}const IJ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],DJ="6";try{window.__reactRouterVersion=DJ}catch{}const $J="startTransition",N8=pF[$J];function UJ(e){let{basename:t,children:r,future:n,window:i}=e,s=x.useRef();s.current==null&&(s.current=WQ({window:i,v5Compat:!0}));let o=s.current,[l,c]=x.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=x.useCallback(f=>{u&&N8?N8(()=>c(f)):c(f)},[c,u]);return x.useLayoutEffect(()=>o.listen(d),[o,d]),x.useEffect(()=>OJ(n),[n]),x.createElement(MJ,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const zJ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",WJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,es=x.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,h=LJ(t,IJ),{basename:p}=x.useContext(wh),m,g=!1;if(typeof u=="string"&&WJ.test(u)&&(m=u,zJ))try{let w=new URL(window.location.href),S=u.startsWith("//")?new URL(w.protocol+u):new URL(u),k=c3(S.pathname,p);S.origin===w.origin&&k!=null?u=k+S.search+S.hash:g=!0}catch{}let y=xJ(u,{relative:i}),b=qJ(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:i,viewTransition:f});function v(w){n&&n(w),w.defaultPrevented||b(w)}return x.createElement("a",S4({},h,{href:m||y,onClick:g||s?n:v,ref:r,target:c}))});var C8;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(C8||(C8={}));var E8;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(E8||(E8={}));function qJ(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:l}=t===void 0?{}:t,c=go(),u=ul(),d=_D(e,{relative:o});return x.useCallback(f=>{if(BJ(f,r)){f.preventDefault();let h=n!==void 0?n:C2(u)===C2(d);c(e,{replace:h,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[u,c,d,n,i,r,e,s,o,l])}function HJ(e){let t=x.useRef(_4(e)),r=x.useRef(!1),n=ul(),i=x.useMemo(()=>FJ(n.search,r.current?null:t.current),[n.search]),s=go(),o=x.useCallback((l,c)=>{const u=_4(typeof l=="function"?l(i):l);r.current=!0,s("?"+u,c)},[s,i]);return[i,o]}function ND(e,t){return function(){return e.apply(t,arguments)}}const{toString:VJ}=Object.prototype,{getPrototypeOf:h3}=Object,{iterator:mS,toStringTag:CD}=Symbol,gS=(e=>t=>{const r=VJ.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),bu=e=>(e=e.toLowerCase(),t=>gS(t)===e),xS=e=>t=>typeof t===e,{isArray:eg}=Array,Om=xS("undefined");function X1(e){return e!==null&&!Om(e)&&e.constructor!==null&&!Om(e.constructor)&&Al(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ED=bu("ArrayBuffer");function GJ(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&ED(e.buffer),t}const KJ=xS("string"),Al=xS("function"),TD=xS("number"),Q1=e=>e!==null&&typeof e=="object",YJ=e=>e===!0||e===!1,Dv=e=>{if(gS(e)!=="object")return!1;const t=h3(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(CD in e)&&!(mS in e)},XJ=e=>{if(!Q1(e)||X1(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},QJ=bu("Date"),JJ=bu("File"),ZJ=bu("Blob"),eZ=bu("FileList"),tZ=e=>Q1(e)&&Al(e.pipe),rZ=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Al(e.append)&&((t=gS(e))==="formdata"||t==="object"&&Al(e.toString)&&e.toString()==="[object FormData]"))},nZ=bu("URLSearchParams"),[iZ,aZ,sZ,oZ]=["ReadableStream","Request","Response","Headers"].map(bu),lZ=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function J1(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,i;if(typeof e!="object"&&(e=[e]),eg(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{if(X1(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(n=0;n<o;n++)l=s[n],t.call(null,e[l],l,e)}}function PD(e,t){if(X1(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,i;for(;n-- >0;)if(i=r[n],t===i.toLowerCase())return i;return null}const Gh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,OD=e=>!Om(e)&&e!==Gh;function k4(){const{caseless:e,skipUndefined:t}=OD(this)&&this||{},r={},n=(i,s)=>{const o=e&&PD(r,s)||s;Dv(r[o])&&Dv(i)?r[o]=k4(r[o],i):Dv(i)?r[o]=k4({},i):eg(i)?r[o]=i.slice():(!t||!Om(i))&&(r[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&J1(arguments[i],n);return r}const cZ=(e,t,r,{allOwnKeys:n}={})=>(J1(t,(i,s)=>{r&&Al(i)?e[s]=ND(i,r):e[s]=i},{allOwnKeys:n}),e),uZ=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),dZ=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},fZ=(e,t,r,n)=>{let i,s,o;const l={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&h3(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},hZ=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},pZ=e=>{if(!e)return null;if(eg(e))return e;let t=e.length;if(!TD(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},mZ=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&h3(Uint8Array)),gZ=(e,t)=>{const n=(e&&e[mS]).call(e);let i;for(;(i=n.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},xZ=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},yZ=bu("HTMLFormElement"),bZ=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),T8=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),vZ=bu("RegExp"),MD=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};J1(r,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(n[s]=o||i)}),Object.defineProperties(e,n)},wZ=e=>{MD(e,(t,r)=>{if(Al(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Al(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},SZ=(e,t)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return eg(e)?n(e):n(String(e).split(t)),r},_Z=()=>{},kZ=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function jZ(e){return!!(e&&Al(e.append)&&e[CD]==="FormData"&&e[mS])}const AZ=e=>{const t=new Array(10),r=(n,i)=>{if(Q1(n)){if(t.indexOf(n)>=0)return;if(X1(n))return n;if(!("toJSON"in n)){t[i]=n;const s=eg(n)?[]:{};return J1(n,(o,l)=>{const c=r(o,i+1);!Om(c)&&(s[l]=c)}),t[i]=void 0,s}}return n};return r(e,0)},NZ=bu("AsyncFunction"),CZ=e=>e&&(Q1(e)||Al(e))&&Al(e.then)&&Al(e.catch),LD=((e,t)=>e?setImmediate:t?((r,n)=>(Gh.addEventListener("message",({source:i,data:s})=>{i===Gh&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),Gh.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Al(Gh.postMessage)),EZ=typeof queueMicrotask<"u"?queueMicrotask.bind(Gh):typeof process<"u"&&process.nextTick||LD,TZ=e=>e!=null&&Al(e[mS]),gr={isArray:eg,isArrayBuffer:ED,isBuffer:X1,isFormData:rZ,isArrayBufferView:GJ,isString:KJ,isNumber:TD,isBoolean:YJ,isObject:Q1,isPlainObject:Dv,isEmptyObject:XJ,isReadableStream:iZ,isRequest:aZ,isResponse:sZ,isHeaders:oZ,isUndefined:Om,isDate:QJ,isFile:JJ,isBlob:ZJ,isRegExp:vZ,isFunction:Al,isStream:tZ,isURLSearchParams:nZ,isTypedArray:mZ,isFileList:eZ,forEach:J1,merge:k4,extend:cZ,trim:lZ,stripBOM:uZ,inherits:dZ,toFlatObject:fZ,kindOf:gS,kindOfTest:bu,endsWith:hZ,toArray:pZ,forEachEntry:gZ,matchAll:xZ,isHTMLForm:yZ,hasOwnProperty:T8,hasOwnProp:T8,reduceDescriptors:MD,freezeMethods:wZ,toObjectSet:SZ,toCamelCase:bZ,noop:_Z,toFiniteNumber:kZ,findKey:PD,global:Gh,isContextDefined:OD,isSpecCompliantForm:jZ,toJSONObject:AZ,isAsyncFn:NZ,isThenable:CZ,setImmediate:LD,asap:EZ,isIterable:TZ};function ai(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}gr.inherits(ai,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:gr.toJSONObject(this.config),code:this.code,status:this.status}}});const RD=ai.prototype,BD={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{BD[e]={value:e}});Object.defineProperties(ai,BD);Object.defineProperty(RD,"isAxiosError",{value:!0});ai.from=(e,t,r,n,i,s)=>{const o=Object.create(RD);gr.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return ai.call(o,l,c,r,n,i),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const PZ=null;function j4(e){return gr.isPlainObject(e)||gr.isArray(e)}function FD(e){return gr.endsWith(e,"[]")?e.slice(0,-2):e}function P8(e,t,r){return e?e.concat(t).map(function(i,s){return i=FD(i),!r&&s?"["+i+"]":i}).join(r?".":""):t}function OZ(e){return gr.isArray(e)&&!e.some(j4)}const MZ=gr.toFlatObject(gr,{},null,function(t){return/^is[A-Z]/.test(t)});function yS(e,t,r){if(!gr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=gr.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!gr.isUndefined(y[g])});const n=r.metaTokens,i=r.visitor||d,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&gr.isSpecCompliantForm(t);if(!gr.isFunction(i))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(gr.isDate(m))return m.toISOString();if(gr.isBoolean(m))return m.toString();if(!c&&gr.isBlob(m))throw new ai("Blob is not supported. Use a Buffer instead.");return gr.isArrayBuffer(m)||gr.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,g,y){let b=m;if(m&&!y&&typeof m=="object"){if(gr.endsWith(g,"{}"))g=n?g:g.slice(0,-2),m=JSON.stringify(m);else if(gr.isArray(m)&&OZ(m)||(gr.isFileList(m)||gr.endsWith(g,"[]"))&&(b=gr.toArray(m)))return g=FD(g),b.forEach(function(w,S){!(gr.isUndefined(w)||w===null)&&t.append(o===!0?P8([g],S,s):o===null?g:g+"[]",u(w))}),!1}return j4(m)?!0:(t.append(P8(y,g,s),u(m)),!1)}const f=[],h=Object.assign(MZ,{defaultVisitor:d,convertValue:u,isVisitable:j4});function p(m,g){if(!gr.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(m),gr.forEach(m,function(b,v){(!(gr.isUndefined(b)||b===null)&&i.call(t,b,gr.isString(v)?v.trim():v,g,h))===!0&&p(b,g?g.concat(v):[v])}),f.pop()}}if(!gr.isObject(e))throw new TypeError("data must be an object");return p(e),t}function O8(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function p3(e,t){this._pairs=[],e&&yS(e,this,t)}const ID=p3.prototype;ID.append=function(t,r){this._pairs.push([t,r])};ID.toString=function(t){const r=t?function(n){return t.call(this,n,O8)}:O8;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function LZ(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function DD(e,t,r){if(!t)return e;const n=r&&r.encode||LZ;gr.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(t,r):s=gr.isURLSearchParams(t)?t.toString():new p3(t,r).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class M8{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){gr.forEach(this.handlers,function(n){n!==null&&t(n)})}}const $D={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},RZ=typeof URLSearchParams<"u"?URLSearchParams:p3,BZ=typeof FormData<"u"?FormData:null,FZ=typeof Blob<"u"?Blob:null,IZ={isBrowser:!0,classes:{URLSearchParams:RZ,FormData:BZ,Blob:FZ},protocols:["http","https","file","blob","url","data"]},m3=typeof window<"u"&&typeof document<"u",A4=typeof navigator=="object"&&navigator||void 0,DZ=m3&&(!A4||["ReactNative","NativeScript","NS"].indexOf(A4.product)<0),$Z=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",UZ=m3&&window.location.href||"http://localhost",zZ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:m3,hasStandardBrowserEnv:DZ,hasStandardBrowserWebWorkerEnv:$Z,navigator:A4,origin:UZ},Symbol.toStringTag,{value:"Module"})),Lo={...zZ,...IZ};function WZ(e,t){return yS(e,new Lo.classes.URLSearchParams,{visitor:function(r,n,i,s){return Lo.isNode&&gr.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function qZ(e){return gr.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function HZ(e){const t={},r=Object.keys(e);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],t[s]=e[s];return t}function UD(e){function t(r,n,i,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&gr.isArray(i)?i.length:o,c?(gr.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!l):((!i[o]||!gr.isObject(i[o]))&&(i[o]=[]),t(r,n,i[o],s)&&gr.isArray(i[o])&&(i[o]=HZ(i[o])),!l)}if(gr.isFormData(e)&&gr.isFunction(e.entries)){const r={};return gr.forEachEntry(e,(n,i)=>{t(qZ(n),i,r,0)}),r}return null}function VZ(e,t,r){if(gr.isString(e))try{return(t||JSON.parse)(e),gr.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Z1={transitional:$D,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=gr.isObject(t);if(s&&gr.isHTMLForm(t)&&(t=new FormData(t)),gr.isFormData(t))return i?JSON.stringify(UD(t)):t;if(gr.isArrayBuffer(t)||gr.isBuffer(t)||gr.isStream(t)||gr.isFile(t)||gr.isBlob(t)||gr.isReadableStream(t))return t;if(gr.isArrayBufferView(t))return t.buffer;if(gr.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return WZ(t,this.formSerializer).toString();if((l=gr.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return yS(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),VZ(t)):t}],transformResponse:[function(t){const r=this.transitional||Z1.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(gr.isResponse(t)||gr.isReadableStream(t))return t;if(t&&gr.isString(t)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?ai.from(l,ai.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Lo.classes.FormData,Blob:Lo.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};gr.forEach(["delete","get","head","post","put","patch"],e=>{Z1.headers[e]={}});const GZ=gr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),KZ=e=>{const t={};let r,n,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||t[r]&&GZ[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},L8=Symbol("internals");function $g(e){return e&&String(e).trim().toLowerCase()}function $v(e){return e===!1||e==null?e:gr.isArray(e)?e.map($v):String(e)}function YZ(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const XZ=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function W5(e,t,r,n,i){if(gr.isFunction(n))return n.call(this,t,r);if(i&&(t=r),!!gr.isString(t)){if(gr.isString(n))return t.indexOf(n)!==-1;if(gr.isRegExp(n))return n.test(t)}}function QZ(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function JZ(e,t){const r=gr.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(i,s,o){return this[n].call(this,t,i,s,o)},configurable:!0})})}let Nl=class{constructor(t){t&&this.set(t)}set(t,r,n){const i=this;function s(l,c,u){const d=$g(c);if(!d)throw new Error("header name must be a non-empty string");const f=gr.findKey(i,d);(!f||i[f]===void 0||u===!0||u===void 0&&i[f]!==!1)&&(i[f||c]=$v(l))}const o=(l,c)=>gr.forEach(l,(u,d)=>s(u,d,c));if(gr.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(gr.isString(t)&&(t=t.trim())&&!XZ(t))o(KZ(t),r);else if(gr.isObject(t)&&gr.isIterable(t)){let l={},c,u;for(const d of t){if(!gr.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?gr.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=$g(t),t){const n=gr.findKey(this,t);if(n){const i=this[n];if(!r)return i;if(r===!0)return YZ(i);if(gr.isFunction(r))return r.call(this,i,n);if(gr.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=$g(t),t){const n=gr.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||W5(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let i=!1;function s(o){if(o=$g(o),o){const l=gr.findKey(n,o);l&&(!r||W5(n,n[l],l,r))&&(delete n[l],i=!0)}}return gr.isArray(t)?t.forEach(s):s(t),i}clear(t){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!t||W5(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const r=this,n={};return gr.forEach(this,(i,s)=>{const o=gr.findKey(n,s);if(o){r[o]=$v(i),delete r[s];return}const l=t?QZ(s):String(s).trim();l!==s&&delete r[s],r[l]=$v(i),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return gr.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=t&&gr.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(i=>n.set(i)),n}static accessor(t){const n=(this[L8]=this[L8]={accessors:{}}).accessors,i=this.prototype;function s(o){const l=$g(o);n[l]||(JZ(i,o),n[l]=!0)}return gr.isArray(t)?t.forEach(s):s(t),this}};Nl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);gr.reduceDescriptors(Nl.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});gr.freezeMethods(Nl);function q5(e,t){const r=this||Z1,n=t||r,i=Nl.from(n.headers);let s=n.data;return gr.forEach(e,function(l){s=l.call(r,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function zD(e){return!!(e&&e.__CANCEL__)}function tg(e,t,r){ai.call(this,e??"canceled",ai.ERR_CANCELED,t,r),this.name="CanceledError"}gr.inherits(tg,ai,{__CANCEL__:!0});function WD(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new ai("Request failed with status code "+r.status,[ai.ERR_BAD_REQUEST,ai.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function ZZ(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function eee(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[s];o||(o=u),r[i]=c,n[i]=u;let f=s,h=0;for(;f!==i;)h+=r[f++],f=f%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),u-o<t)return;const p=d&&u-d;return p?Math.round(h*1e3/p):void 0}}function tee(e,t){let r=0,n=1e3/t,i,s;const o=(u,d=Date.now())=>{r=d,i=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?o(u,d):(i=u,s||(s=setTimeout(()=>{s=null,o(i)},n-f)))},()=>i&&o(i)]}const E2=(e,t,r=3)=>{let n=0;const i=eee(50,250);return tee(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-n,u=i(c),d=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},R8=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},B8=e=>(...t)=>gr.asap(()=>e(...t)),ree=Lo.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Lo.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Lo.origin),Lo.navigator&&/(msie|trident)/i.test(Lo.navigator.userAgent)):()=>!0,nee=Lo.hasStandardBrowserEnv?{write(e,t,r,n,i,s,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];gr.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),gr.isString(n)&&l.push(`path=${n}`),gr.isString(i)&&l.push(`domain=${i}`),s===!0&&l.push("secure"),gr.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function iee(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function aee(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function qD(e,t,r){let n=!iee(t);return e&&(n||r==!1)?aee(e,t):t}const F8=e=>e instanceof Nl?{...e}:e;function x0(e,t){t=t||{};const r={};function n(u,d,f,h){return gr.isPlainObject(u)&&gr.isPlainObject(d)?gr.merge.call({caseless:h},u,d):gr.isPlainObject(d)?gr.merge({},d):gr.isArray(d)?d.slice():d}function i(u,d,f,h){if(gr.isUndefined(d)){if(!gr.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function s(u,d){if(!gr.isUndefined(d))return n(void 0,d)}function o(u,d){if(gr.isUndefined(d)){if(!gr.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function l(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>i(F8(u),F8(d),f,!0)};return gr.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||i,h=f(e[d],t[d],d);gr.isUndefined(h)&&f!==l||(r[d]=h)}),r}const HD=e=>{const t=x0({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=Nl.from(o),t.url=DD(qD(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),gr.isFormData(r)){if(Lo.hasStandardBrowserEnv||Lo.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(gr.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&o.set(d,f)})}}if(Lo.hasStandardBrowserEnv&&(n&&gr.isFunction(n)&&(n=n(t)),n||n!==!1&&ree(t.url))){const c=i&&s&&nee.read(s);c&&o.set(i,c)}return t},see=typeof XMLHttpRequest<"u",oee=see&&function(e){return new Promise(function(r,n){const i=HD(e);let s=i.data;const o=Nl.from(i.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=i,d,f,h,p,m;function g(){p&&p(),m&&m(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function b(){if(!y)return;const w=Nl.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),k={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:w,config:e,request:y};WD(function(A){r(A),g()},function(A){n(A),g()},k),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(n(new ai("Request aborted",ai.ECONNABORTED,e,y)),y=null)},y.onerror=function(S){const k=S&&S.message?S.message:"Network Error",j=new ai(k,ai.ERR_NETWORK,e,y);j.event=S||null,n(j),y=null},y.ontimeout=function(){let S=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const k=i.transitional||$D;i.timeoutErrorMessage&&(S=i.timeoutErrorMessage),n(new ai(S,k.clarifyTimeoutError?ai.ETIMEDOUT:ai.ECONNABORTED,e,y)),y=null},s===void 0&&o.setContentType(null),"setRequestHeader"in y&&gr.forEach(o.toJSON(),function(S,k){y.setRequestHeader(k,S)}),gr.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),l&&l!=="json"&&(y.responseType=i.responseType),u&&([h,m]=E2(u,!0),y.addEventListener("progress",h)),c&&y.upload&&([f,p]=E2(c),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",p)),(i.cancelToken||i.signal)&&(d=w=>{y&&(n(!w||w.type?new tg(null,e,y):w),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const v=ZZ(i.url);if(v&&Lo.protocols.indexOf(v)===-1){n(new ai("Unsupported protocol "+v+":",ai.ERR_BAD_REQUEST,e));return}y.send(s||null)})},lee=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,i;const s=function(u){if(!i){i=!0,l();const d=u instanceof Error?u:this.reason;n.abort(d instanceof ai?d:new tg(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,s(new ai(`timeout ${t} of ms exceeded`,ai.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>gr.asap(l),c}},cee=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,i;for(;n<r;)i=n+t,yield e.slice(n,i),n=i},uee=async function*(e,t){for await(const r of dee(e))yield*cee(r,t)},dee=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},I8=(e,t,r,n)=>{const i=uee(e,t);let s=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await i.next();if(u){l(),c.close();return}let f=d.byteLength;if(r){let h=s+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),i.return()}},{highWaterMark:2})},D8=64*1024,{isFunction:wb}=gr,fee=(({Request:e,Response:t})=>({Request:e,Response:t}))(gr.global),{ReadableStream:$8,TextEncoder:U8}=gr.global,z8=(e,...t)=>{try{return!!e(...t)}catch{return!1}},hee=e=>{e=gr.merge.call({skipUndefined:!0},fee,e);const{fetch:t,Request:r,Response:n}=e,i=t?wb(t):typeof fetch=="function",s=wb(r),o=wb(n);if(!i)return!1;const l=i&&wb($8),c=i&&(typeof U8=="function"?(m=>g=>m.encode(g))(new U8):async m=>new Uint8Array(await new r(m).arrayBuffer())),u=s&&l&&z8(()=>{let m=!1;const g=new r(Lo.origin,{body:new $8,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!g}),d=o&&l&&z8(()=>gr.isReadableStream(new n("").body)),f={stream:d&&(m=>m.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!f[m]&&(f[m]=(g,y)=>{let b=g&&g[m];if(b)return b.call(g);throw new ai(`Response type '${m}' is not supported`,ai.ERR_NOT_SUPPORT,y)})});const h=async m=>{if(m==null)return 0;if(gr.isBlob(m))return m.size;if(gr.isSpecCompliantForm(m))return(await new r(Lo.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(gr.isArrayBufferView(m)||gr.isArrayBuffer(m))return m.byteLength;if(gr.isURLSearchParams(m)&&(m=m+""),gr.isString(m))return(await c(m)).byteLength},p=async(m,g)=>{const y=gr.toFiniteNumber(m.getContentLength());return y??h(g)};return async m=>{let{url:g,method:y,data:b,signal:v,cancelToken:w,timeout:S,onDownloadProgress:k,onUploadProgress:j,responseType:A,headers:L,withCredentials:P="same-origin",fetchOptions:B}=HD(m),E=t||fetch;A=A?(A+"").toLowerCase():"text";let T=lee([v,w&&w.toAbortSignal()],S),F=null;const W=T&&T.unsubscribe&&(()=>{T.unsubscribe()});let z;try{if(j&&u&&y!=="get"&&y!=="head"&&(z=await p(L,b))!==0){let X=new r(g,{method:"POST",body:b,duplex:"half"}),C;if(gr.isFormData(b)&&(C=X.headers.get("content-type"))&&L.setContentType(C),X.body){const[K,V]=R8(z,E2(B8(j)));b=I8(X.body,D8,K,V)}}gr.isString(P)||(P=P?"include":"omit");const se=s&&"credentials"in r.prototype,de={...B,signal:T,method:y.toUpperCase(),headers:L.normalize().toJSON(),body:b,duplex:"half",credentials:se?P:void 0};F=s&&new r(g,de);let U=await(s?E(F,B):E(g,de));const G=d&&(A==="stream"||A==="response");if(d&&(k||G&&W)){const X={};["status","statusText","headers"].forEach(R=>{X[R]=U[R]});const C=gr.toFiniteNumber(U.headers.get("content-length")),[K,V]=k&&R8(C,E2(B8(k),!0))||[];U=new n(I8(U.body,D8,K,()=>{V&&V(),W&&W()}),X)}A=A||"text";let re=await f[gr.findKey(f,A)||"text"](U,m);return!G&&W&&W(),await new Promise((X,C)=>{WD(X,C,{data:re,headers:Nl.from(U.headers),status:U.status,statusText:U.statusText,config:m,request:F})})}catch(se){throw W&&W(),se&&se.name==="TypeError"&&/Load failed|fetch/i.test(se.message)?Object.assign(new ai("Network Error",ai.ERR_NETWORK,m,F),{cause:se.cause||se}):ai.from(se,se&&se.code,m,F)}}},pee=new Map,VD=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:i}=t,s=[n,i,r];let o=s.length,l=o,c,u,d=pee;for(;l--;)c=s[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:hee(t)),d=u;return u};VD();const g3={http:PZ,xhr:oee,fetch:{get:VD}};gr.forEach(g3,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const W8=e=>`- ${e}`,mee=e=>gr.isFunction(e)||e===null||e===!1;function gee(e,t){e=gr.isArray(e)?e:[e];const{length:r}=e;let n,i;const s={};for(let o=0;o<r;o++){n=e[o];let l;if(i=n,!mee(n)&&(i=g3[(l=String(n)).toLowerCase()],i===void 0))throw new ai(`Unknown adapter '${l}'`);if(i&&(gr.isFunction(i)||(i=i.get(t))))break;s[l||"#"+o]=i}if(!i){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(W8).join(`
`):" "+W8(o[0]):"as no adapter specified";throw new ai("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i}const GD={getAdapter:gee,adapters:g3};function H5(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new tg(null,e)}function q8(e){return H5(e),e.headers=Nl.from(e.headers),e.data=q5.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),GD.getAdapter(e.adapter||Z1.adapter,e)(e).then(function(n){return H5(e),n.data=q5.call(e,e.transformResponse,n),n.headers=Nl.from(n.headers),n},function(n){return zD(n)||(H5(e),n&&n.response&&(n.response.data=q5.call(e,e.transformResponse,n.response),n.response.headers=Nl.from(n.response.headers))),Promise.reject(n)})}const KD="1.13.2",bS={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{bS[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const H8={};bS.transitional=function(t,r,n){function i(s,o){return"[Axios v"+KD+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,l)=>{if(t===!1)throw new ai(i(o," has been removed"+(r?" in "+r:"")),ai.ERR_DEPRECATED);return r&&!H8[o]&&(H8[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};bS.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function xee(e,t,r){if(typeof e!="object")throw new ai("options must be an object",ai.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const s=n[i],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new ai("option "+s+" must be "+c,ai.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ai("Unknown option "+s,ai.ERR_BAD_OPTION)}}const Uv={assertOptions:xee,validators:bS},Eu=Uv.validators;let r0=class{constructor(t){this.defaults=t||{},this.interceptors={request:new M8,response:new M8}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=x0(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&Uv.assertOptions(n,{silentJSONParsing:Eu.transitional(Eu.boolean),forcedJSONParsing:Eu.transitional(Eu.boolean),clarifyTimeoutError:Eu.transitional(Eu.boolean)},!1),i!=null&&(gr.isFunction(i)?r.paramsSerializer={serialize:i}:Uv.assertOptions(i,{encode:Eu.function,serialize:Eu.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Uv.assertOptions(r,{baseUrl:Eu.spelling("baseURL"),withXsrfToken:Eu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&gr.merge(s.common,s[r.method]);s&&gr.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),r.headers=Nl.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,f=0,h;if(!c){const m=[q8.bind(this),void 0];for(m.unshift(...l),m.push(...u),h=m.length,d=Promise.resolve(r);f<h;)d=d.then(m[f++],m[f++]);return d}h=l.length;let p=r;for(;f<h;){const m=l[f++],g=l[f++];try{p=m(p)}catch(y){g.call(this,y);break}}try{d=q8.call(this,p)}catch(m){return Promise.reject(m)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=x0(this.defaults,t);const r=qD(t.baseURL,t.url,t.allowAbsoluteUrls);return DD(r,t.params,t.paramsSerializer)}};gr.forEach(["delete","get","head","options"],function(t){r0.prototype[t]=function(r,n){return this.request(x0(n||{},{method:t,url:r,data:(n||{}).data}))}});gr.forEach(["post","put","patch"],function(t){function r(n){return function(s,o,l){return this.request(x0(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}r0.prototype[t]=r(),r0.prototype[t+"Form"]=r(!0)});let yee=class YD{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(l=>{n.subscribe(l),s=l}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},t(function(s,o,l){n.reason||(n.reason=new tg(s,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new YD(function(i){t=i}),cancel:t}}};function bee(e){return function(r){return e.apply(null,r)}}function vee(e){return gr.isObject(e)&&e.isAxiosError===!0}const N4={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(N4).forEach(([e,t])=>{N4[t]=e});function XD(e){const t=new r0(e),r=ND(r0.prototype.request,t);return gr.extend(r,r0.prototype,t,{allOwnKeys:!0}),gr.extend(r,t,null,{allOwnKeys:!0}),r.create=function(i){return XD(x0(e,i))},r}const La=XD(Z1);La.Axios=r0;La.CanceledError=tg;La.CancelToken=yee;La.isCancel=zD;La.VERSION=KD;La.toFormData=yS;La.AxiosError=ai;La.Cancel=La.CanceledError;La.all=function(t){return Promise.all(t)};La.spread=bee;La.isAxiosError=vee;La.mergeConfig=x0;La.AxiosHeaders=Nl;La.formToJSON=e=>UD(gr.isHTMLForm(e)?new FormData(e):e);La.getAdapter=GD.getAdapter;La.HttpStatusCode=N4;La.default=La;const{Axios:fMe,AxiosError:hMe,CanceledError:pMe,isCancel:mMe,CancelToken:gMe,VERSION:xMe,all:yMe,Cancel:bMe,isAxiosError:vMe,spread:wMe,toFormData:SMe,AxiosHeaders:C4,HttpStatusCode:_Me,formToJSON:kMe,getAdapter:jMe,mergeConfig:AMe}=La;function wee(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const QD=`${wee()}/api/accounts/`,tl=La.create({baseURL:QD});let V5=!1,E4=[];function See(e){E4.push(e)}function _ee(e){E4.forEach(t=>t(e)),E4=[]}async function kee(){const e=localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await La.post(`${QD}token/refresh/`,{refresh:e}),{access:r,refresh:n}=t.data;return r&&localStorage.setItem("access",r),n&&localStorage.setItem("refresh",n),r}tl.interceptors.response.use(e=>e,async e=>{const t=e.config;if(e.response&&e.response.status===401&&!t._retry){if(t._retry=!0,V5)return new Promise(r=>{See(n=>{const i=t.headers??{};i.Authorization=`Bearer ${n}`,t.headers=new C4(i),r(tl(t))})});V5=!0;try{const r=await kee();_ee(r);const n=t.headers??{};return n.Authorization=`Bearer ${r}`,t.headers=new C4(n),tl(t)}catch(r){return x3(),Promise.reject(r)}finally{V5=!1}}return Promise.reject(e)});async function JD(e,t){const r=await tl.post("token/",{identifier:e,password:t}),{access:n,refresh:i}=r.data;localStorage.setItem("access",n),localStorage.setItem("refresh",i);try{await y0()}catch{}return r.data}function x3(){localStorage.removeItem("access"),localStorage.removeItem("refresh"),localStorage.removeItem("roles"),localStorage.removeItem("permissions"),localStorage.removeItem("me")}tl.interceptors.request.use(e=>{const t=localStorage.getItem("access");if(t){const r=e.headers??{};r.Authorization=`Bearer ${t}`,e.headers=new C4(r)}return e});async function y0(){if(!localStorage.getItem("access"))throw new Error("no access token");const r=(await tl.get("me/")).data;try{localStorage.setItem("roles",JSON.stringify(r.roles||[])),localStorage.setItem("permissions",JSON.stringify(r.permissions||[])),localStorage.setItem("me",JSON.stringify(r||null))}catch{}return r}function ZD(){try{const e=localStorage.getItem("me");return e?JSON.parse(e):null}catch{return null}}function e9(){var t;const e=ZD();return!!((t=e==null?void 0:e.profile)!=null&&t.mobile_verified)}async function as(){var e;if(e9())return!0;try{const t=await y0();return!!((e=t==null?void 0:t.profile)!=null&&e.mobile_verified)}catch{return!1}}async function t9(e){return(await tl.post("mobile/request-otp/",{mobile_number:e})).data}async function r9(e,t){return(await tl.post("mobile/verify-otp/",{mobile_number:e,otp:t})).data}const jee=Object.freeze(Object.defineProperty({__proto__:null,apiClient:tl,ensureMobileVerified:as,getCachedMe:ZD,getMe:y0,isMobileVerifiedCached:e9,login:JD,logout:x3,requestMobileOtp:t9,verifyMobileOtp:r9},Symbol.toStringTag,{value:"Module"})),Aee="/assets/idcs-logo-Ci6ccowJ.png";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n9=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nee=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cee=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=e=>{const t=Cee(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Eee={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tee=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pee=x.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...l},c)=>x.createElement("svg",{ref:c,...Eee,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:n9("lucide",i),...!s&&!Tee(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,d])=>x.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=(e,t)=>{const r=x.forwardRef(({className:n,...i},s)=>x.createElement(Pee,{ref:s,iconNode:t,className:n9(`lucide-${Nee(V8(e))}`,`lucide-${e}`,n),...i}));return r.displayName=V8(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oee=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Nx=qn("bell",Oee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mee=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ms=qn("book-open",Mee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lee=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Ree=qn("briefcase",Lee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bee=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],Fee=qn("building",Bee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iee=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],T4=qn("calendar-clock",Iee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],xs=qn("calendar",Dee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ee=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Uee=qn("check",$ee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zee=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Wee=qn("chevron-down",zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],td=qn("circle-alert",qee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hee=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],y3=qn("circle-check-big",Hee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],qf=qn("circle-check",Vee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gee=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Kee=qn("circle-user-round",Gee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],b3=qn("circle-x",Yee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xee=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],T2=qn("clipboard-list",Xee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qee=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],rc=qn("clock",Qee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jee=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],P4=qn("download",Jee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zee=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ete=qn("eye-off",Zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tte=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],i9=qn("eye",tte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rte=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],nte=qn("file-spreadsheet",rte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ite=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ate=qn("file-text",ite);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ste=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ote=qn("funnel",ste);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lte=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],ey=qn("graduation-cap",lte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cte=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],O4=qn("grid-3x3",cte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ute=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],P2=qn("house",ute);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dte=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ku=qn("loader-circle",dte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fte=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],hte=qn("lock-open",fte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pte=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],n0=qn("lock",pte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mte=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],gte=qn("log-in",mte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xte=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],yte=qn("log-out",xte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bte=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],v3=qn("mail",bte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vte=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],wte=qn("menu",vte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ste=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],G8=qn("panels-top-left",Ste);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _te=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],kte=qn("phone",_te);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jte=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Mm=qn("plus",jte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ate=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],O2=qn("refresh-cw",Ate);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nte=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],nd=qn("save",Nte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cte=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],Ete=qn("school",Cte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tte=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Pte=qn("send",Tte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ote=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Mte=qn("shield",Ote);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lte=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],ch=qn("square-pen",Lte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rte=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],o1=qn("trash-2",Rte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bte=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Fte=qn("trending-up",Bte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ite=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],M2=qn("upload",Ite);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dte=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],zv=qn("user-check",Dte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $te=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Ute=qn("user-plus",$te);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Wte=qn("user-x",zte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qte=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],z0=qn("user",qte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ys=qn("users",Hte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vte=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],gu=qn("x",Vte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gte=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Kte=qn("zoom-in",Gte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yte=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Xte=qn("zoom-out",Yte),a9=x.createContext(void 0);function Qte({children:e}){const[t,r]=x.useState(()=>typeof window<"u"?window.innerWidth<1024:!0),n=()=>r(i=>!i);return a.jsx(a9.Provider,{value:{collapsed:t,toggle:n,setCollapsed:r},children:e})}function w3(){const e=x.useContext(a9);if(!e)throw new Error("useSidebar must be used within SidebarProvider");return e}function s9({user:e}){const t=go(),n=ul().pathname==="/login",{collapsed:i,toggle:s}=w3(),o=()=>{x3(),t("/login")};return a.jsx("nav",{className:"bg-white shadow-md border-b border-gray-200 fixed top-0 left-0 right-0 z-40 overflow-x-hidden",children:a.jsx("div",{className:"px-4 max-w-full",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:s,"aria-label":"Toggle sidebar",children:i?a.jsx(wte,{className:"h-6 w-6"}):a.jsx(gu,{className:"h-6 w-6"})}),a.jsx(es,{to:"/dashboard",className:"flex items-center gap-3 group",children:a.jsx("img",{src:Aee,alt:"IDCS Logo",className:"h-12 w-12 object-contain transition-transform duration-200 group-hover:scale-110",onError:l=>{l.currentTarget.style.display="none"}})})]}),a.jsx("div",{className:"flex items-center gap-3",children:e?a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"hidden sm:block",children:a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-semibold text-sm",children:e.username.charAt(0).toUpperCase()})}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.username})]})}),a.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg font-medium transition-colors",children:[a.jsx(yte,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]}):n?a.jsxs(es,{to:"/",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[a.jsx(P2,{className:"h-4 w-4"}),a.jsx("span",{children:"Home"})]}):a.jsxs(es,{to:"/login",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[a.jsx(gte,{className:"h-4 w-4"}),a.jsx("span",{children:"Login"})]})})]})})})}function o9(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const Jte=o9();let G5=!1,Ug=null;async function Zte(){return G5&&Ug||(G5=!0,Ug=(async()=>{try{const e=window.localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await fetch(`${Jte}/api/accounts/token/refresh/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})});if(!t.ok)throw window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh"),new Error("refresh failed");const r=await t.json();return r.access&&window.localStorage.setItem("access",r.access),r.refresh&&window.localStorage.setItem("refresh",r.refresh),r.access}finally{G5=!1,Ug=null}})()),Ug}async function yr(e,t={},r=!0){const n=window.localStorage.getItem("access"),i=t.body instanceof FormData,s=Object.assign({},t.headers||{});i||(s["Content-Type"]="application/json"),n?s.Authorization=`Bearer ${n}`:console.warn("No access token found in localStorage");let o=e;try{typeof e=="string"&&e.startsWith("/api")&&(o=`${o9()}${e}`)}catch{}const l=await fetch(o,{...t,headers:s});if(l.status===400){const c=await l.text();console.error("400 Bad Request:",{url:o,token:n,response:c})}if(l.status===401||l.status===403){let c="";try{c=await l.text()}catch{}const u={};try{l.headers.forEach((d,f)=>{u[f]=d})}catch{}console.error("Auth error from fetchWithAuth",{url:String(o),status:l.status,requestHeaders:s,responseHeaders:u,token:n,responseText:c})}if(l.status!==401||!r)return l;try{const c=await Zte(),u=Object.assign({},t.headers||{});return i||(u["Content-Type"]="application/json"),u.Authorization=`Bearer ${c}`,fetch(o,{...t,headers:u})}catch(c){try{window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh")}catch{}console.error("Token refresh failed:",c);try{typeof window<"u"&&setTimeout(()=>{try{window.location.href="/login"}catch{}},50)}catch{}return l}}async function ere(e=""){const t=e?`${e}/api/accounts/dashboard/`:"/api/accounts/dashboard/",r=await yr(t,{method:"GET"});if(!r.ok){const n=await r.text();throw new Error(`Dashboard fetch failed: ${r.status} ${n}`)}return r.json()}function tre(e=""){const[t,r]=x.useState(null),[n,i]=x.useState(!0),[s,o]=x.useState(null),l=x.useCallback(async()=>{i(!0),o(null);try{const c=await ere(e);r(c)}catch(c){o(c)}finally{i(!1)}},[e]);return x.useEffect(()=>{l()},[l]),{data:t,loading:n,error:s,refresh:l}}const rre="modulepreload",nre=function(e){return"/"+e},K8={},dm=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=nre(c),c in K8)return;K8[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":rre,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};async function lc(){var t;const e=`${yn()}/api/academics/my-teaching-assignments/`;try{return(await tl.get(e)).data}catch(r){if(((t=r==null?void 0:r.response)==null?void 0:t.status)===401)return[];throw r}}function yn(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}function ii(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}async function S3(e,t,r){const n=`${yn()}/api/obe/iqac/reset/${encodeURIComponent(String(e))}/${encodeURIComponent(String(t))}`;return(await tl.post(n,{teaching_assignment_id:r})).data}async function l9(e){var i;const t=`${yn()}/api/obe/iqac/reset-notifications`,r=e?{teaching_assignment_id:e}:{};return((i=(await tl.get(t,{params:r})).data)==null?void 0:i.notifications)||[]}async function c9(e){const t=`${yn()}/api/obe/iqac/reset-notifications/dismiss`;return(await tl.post(t,{notification_ids:e})).data}async function ire(){try{const e=yn(),t=localStorage.getItem("refresh");if(!t)return null;const r=await La.post(`${e}/api/accounts/token/refresh/`,{refresh:t}),{access:n,refresh:i}=r.data||{};return n&&localStorage.setItem("access",n),i&&localStorage.setItem("refresh",i),n||null}catch{try{(await dm(()=>Promise.resolve().then(()=>jee),void 0)).logout()}catch{}return null}}async function sa(e,t){const r={"Content-Type":"application/json",...(t==null?void 0:t.headers)||{},...ii()},n={...t||{},headers:r};let i=await fetch(e,n);if(i.status!==401)return i;const s=await ire();if(!s)return i;const o={...n.headers,Authorization:`Bearer ${s}`},l={...n,headers:o};return i=await fetch(e,l),i}async function vS(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await sa(i,{method:"GET"});return s.status===401?{assessment:e,subject_code:String(t),teaching_assignment_id:typeof r=="number"?r:null,academic_year:null,section_name:null,exists:!1,is_published:!1,published_blocked:!1,mark_entry_blocked:!1,mark_manager_locked:!1,mark_entry_unblocked_until:null,mark_manager_unlocked_until:null,entry_open:!1,mark_manager_editable:!0,updated_at:null}:(s.ok||await Sn(s,"Mark table lock fetch failed"),s.json())}async function are(e){const t=await fm(e);return Array.isArray(t==null?void 0:t.enabled_assessments)?t.enabled_assessments.map(r=>String(r).trim().toLowerCase()).filter(Boolean):[]}async function fm(e){const t=`${yn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,r=await sa(t,{method:"GET"});if(r.status===401||r.status===404)return{enabled_assessments:[],meta:{locked:!1,can_edit:!1}};r.ok||await Sn(r,"Failed to fetch enabled assessments");const n=await r.json();return{enabled_assessments:Array.isArray(n==null?void 0:n.enabled_assessments)?n.enabled_assessments.map(i=>String(i).trim().toLowerCase()).filter(Boolean):[],meta:(n==null?void 0:n.meta)||void 0}}async function sre(e,t){const r=`${yn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await sa(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await Sn(n,"Failed to save enabled assessments");const i=await n.json();return Array.isArray(i==null?void 0:i.enabled_assessments)?i.enabled_assessments:[]}async function u9(e,t){const r=`${yn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await sa(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await Sn(n,"Failed to save enabled assessments");const i=await n.json();return{enabled_assessments:Array.isArray(i==null?void 0:i.enabled_assessments)?i.enabled_assessments:[],meta:(i==null?void 0:i.meta)||void 0}}async function d9(e){const t=`${yn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/request-edit/`,r=await sa(t,{method:"POST",body:JSON.stringify({})});if(r.status===401)throw new Error("Authentication required");return r.ok||await Sn(r,"Failed to request edit approval"),r.json()}async function wS(e,t){const r=t?`?academic_year_id=${encodeURIComponent(String(t))}`:"",n=`${yn()}/api/academics/special-courses/${encodeURIComponent(String(e))}/enabled_assessments/${r}`,i=await sa(n,{method:"GET"});if(i.status===401)throw new Error("Authentication required");i.ok||await Sn(i,"Failed to fetch enabled assessments");const s=await i.json();return(Array.isArray(s==null?void 0:s.enabled_assessments)?s.enabled_assessments:[]).map(l=>String(l).trim().toLowerCase()).filter(Boolean)}async function uh(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}/confirm-mark-manager${n}`,s=await sa(i,{method:"POST",body:JSON.stringify({})});if(s.status===401)throw new Error("Authentication required");return s.ok||await Sn(s,"Mark Manager confirm failed"),s.json()}async function _3(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/publish-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.status===401?{assessment:e,subject_code:String(t),publish_allowed:!1,allowed_by_due:!1,allowed_by_approval:!1,global_override_active:!1,global_is_open:null,allowed_by_global:null,due_at:null,now:null,remaining_seconds:null,approval_until:null,academic_year:null,teaching_assignment_id:typeof r=="number"?r:null}:(s.ok||await Sn(s,"Publish window fetch failed"),s.json())}async function l1(e,t,r,n){const i=[`scope=${encodeURIComponent(String(r))}`];n&&i.push(`teaching_assignment_id=${encodeURIComponent(String(n))}`);const s=i.length?`?${i.join("&")}`:"",o=`${yn()}/api/obe/edit-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${s}`,l=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return l.status===401?{assessment:e,subject_code:String(t),scope:r,allowed_by_approval:!1,approval_until:null,now:null,academic_year:null,teaching_assignment_id:typeof n=="number"?n:null}:(l.ok||await Sn(l,"Edit window fetch failed"),l.json())}async function dx(e,t){const r=[];e!=null&&e.length&&r.push(`semester_ids=${encodeURIComponent(e.join(","))}`),t!=null&&t.length&&r.push(`assessments=${encodeURIComponent(t.join(","))}`);const n=r.length?`?${r.join("&")}`:"",i=`${yn()}/api/obe/global-publish-controls${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.ok||await Sn(s,"Global publish controls fetch failed"),s.json()}async function M4(e){const t=`${yn()}/api/obe/global-publish-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await Sn(r,"Bulk set global publish controls failed"),r.json()}async function f9(e){const t=`${yn()}/api/obe/global-publish-controls/bulk-reset`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await Sn(r,"Bulk reset global publish controls failed"),r.json()}async function h9(){const e=`${yn()}/api/obe/semesters`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return t.ok||await Sn(t,"Semesters fetch failed"),t.json()}async function Wv(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${yn()}/api/obe/assessment-controls${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});if(!n.ok){if(n.status===404)throw new Error(`Assessment controls endpoint not found (404).

URL requested:
${r}

This usually means your frontend is calling an older backend that does not include /api/obe/assessment-controls.
- Deploy/restart the updated backend OR
- Set VITE_API_BASE to the backend instance that has the new endpoints.`);await Sn(n,"Assessment controls fetch failed")}return n.json()}async function L4(e){const t=`${yn()}/api/obe/assessment-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});if(!r.ok){if(r.status===404)throw new Error(`Assessment controls bulk-set endpoint not found (404).

URL requested:
${t}

Your backend is missing /api/obe/assessment-controls/bulk-set. Deploy/restart the updated backend or point VITE_API_BASE to the correct server.`);await Sn(r,"Bulk set assessment controls failed")}return r.json()}async function R4(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${yn()}/api/obe/due-schedules${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return n.ok||await Sn(n,"Due schedules fetch failed"),n.json()}async function p9(e){const t=`?semester_ids=${encodeURIComponent(e.join(","))}`,r=`${yn()}/api/obe/due-schedule-subjects${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return n.ok||await Sn(n,"Due schedule subjects fetch failed"),n.json()}async function ore(e){const t=`${yn()}/api/obe/due-schedule-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await Sn(r,"Due schedule save failed"),r.json()}async function m9(e){const t=`${yn()}/api/obe/due-schedule-bulk-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await Sn(r,"Due schedule bulk save failed"),r.json()}async function g9(e){const t=`${yn()}/api/obe/due-schedule-bulk-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await Sn(r,"Due schedule bulk delete failed"),r.json()}function x9(e){if(Array.isArray(e))return{marks:e.map(r=>Number(r)).filter(r=>Number.isFinite(r))};if(e&&typeof e=="object"){const r=(Array.isArray(e.marks)?e.marks:[]).map(o=>Number(o)).filter(o=>Number.isFinite(o)),n=Array.isArray(e.cos)?e.cos:void 0,i=n?n.map(o=>{if(typeof o=="string")return o;const l=Number(o);return Number.isFinite(l)?l:""}):void 0,s={marks:r};return i&&(s.cos=i.filter(o=>o!=="")),s}return{marks:[]}}async function ih(e){const t=[];t.push(`class_type=${encodeURIComponent(String(e.class_type||"").trim())}`),e.question_paper_type&&t.push(`question_paper_type=${encodeURIComponent(String(e.question_paper_type||"").trim())}`),t.push(`exam=${encodeURIComponent(String(e.exam||"").trim())}`);const r=t.length?`?${t.join("&")}`:"",n=`${yn()}/api/obe/iqac/qp-pattern${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});i.ok||await Sn(i,"QP pattern fetch failed");const s=await i.json(),o=x9(s==null?void 0:s.pattern);return{class_type:String((s==null?void 0:s.class_type)||""),question_paper_type:(s==null?void 0:s.question_paper_type)==null?null:String(s.question_paper_type),exam:(()=>{const l=String((s==null?void 0:s.exam)||"CIA").trim().toUpperCase();return l==="MODEL"?"MODEL":l==="CIA1"?"CIA1":l==="CIA2"?"CIA2":"CIA"})(),pattern:o,updated_at:(s==null?void 0:s.updated_at)??null,updated_by:typeof(s==null?void 0:s.updated_by)=="number"?s.updated_by:null}}async function y9(e){var o,l;const t=`${yn()}/api/obe/iqac/qp-pattern/save`,r={class_type:String(e.class_type||"").trim(),question_paper_type:e.question_paper_type?String(e.question_paper_type||"").trim():null,exam:e.exam,pattern:{marks:Array.isArray((o=e.pattern)==null?void 0:o.marks)?e.pattern.marks:[],cos:Array.isArray((l=e.pattern)==null?void 0:l.cos)?e.pattern.cos:void 0}},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(r)});n.ok||await Sn(n,"QP pattern save failed");const i=await n.json(),s=x9(i==null?void 0:i.pattern);return{class_type:String((i==null?void 0:i.class_type)||""),question_paper_type:(i==null?void 0:i.question_paper_type)==null?null:String(i.question_paper_type),exam:(()=>{const c=String((i==null?void 0:i.exam)||"CIA").trim().toUpperCase();return c==="MODEL"?"MODEL":c==="CIA1"?"CIA1":c==="CIA2"?"CIA2":"CIA"})(),pattern:s,updated_at:(i==null?void 0:i.updated_at)??null,updated_by:typeof(i==null?void 0:i.updated_by)=="number"?i.updated_by:null}}async function SS(){const e=`${yn()}/api/obe/iqac/cqi-config`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});t.ok||await Sn(t,"CQI config fetch failed");const r=await t.json();return{options:Array.isArray(r==null?void 0:r.options)?r.options:[],divider:Number.isFinite(Number(r==null?void 0:r.divider))?Number(r==null?void 0:r.divider):2,multiplier:Number.isFinite(Number(r==null?void 0:r.multiplier))?Number(r==null?void 0:r.multiplier):.15,updated_at:(r==null?void 0:r.updated_at)??null,updated_by:typeof(r==null?void 0:r.updated_by)=="number"?r.updated_by:null}}async function b9(e){const t=`${yn()}/api/obe/iqac/cqi-config/save`,r={options:Array.isArray(e.options)?e.options:[],divider:Number.isFinite(Number(e.divider))?Number(e.divider):2,multiplier:Number.isFinite(Number(e.multiplier))?Number(e.multiplier):.15},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(r)});return n.ok||await Sn(n,"CQI config save failed"),n.json()}async function lre(e){const t=`${yn()}/api/obe/due-schedule-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await Sn(r,"Due schedule delete failed"),r.json()}async function Sh(e){const t=`${yn()}/api/obe/publish-request`,r=await sa(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await Sn(r,"Publish request failed"),r.json()}async function nl(e){const t=`${yn()}/api/obe/edit-request`,r=await sa(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await Sn(r,"Edit request failed"),r.json()}function il(e){var o,l,c,u,d;const t=e||{},r=`Edit request ID: ${typeof t.id=="number"?t.id:""}`;if((String(t.routed_to||"IQAC").trim().toUpperCase()==="HOD"?"HOD":"IQAC")==="HOD"){const f=String(((o=t.department)==null?void 0:o.short_name)||((l=t.department)==null?void 0:l.name)||((c=t.department)==null?void 0:c.code)||"").trim(),h=String(((u=t.hod)==null?void 0:u.name)||((d=t.hod)==null?void 0:d.username)||"").trim(),p=f&&h?`Sent to: ${f} HOD, ${h}`:"Sent to: HOD";return`${r}
${p}`}const s=String(t.routing_warning||"").trim();return s?`${r}
Sent to: IQAC
Note: ${s}`:`${r}
Sent to: IQAC`}function al(e,t="Request failed"){var i,s;const r=String((e==null?void 0:e.message)||"").trim();if(r)return r;const n=String(((s=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:s.detail)||"").trim();return n||t}async function Lm(e){const t=[];t.push(`assessment=${encodeURIComponent(String(e.assessment))}`),t.push(`subject_code=${encodeURIComponent(String(e.subject_code))}`),t.push(`scope=${encodeURIComponent(String(e.scope))}`),typeof e.teaching_assignment_id=="number"&&t.push(`teaching_assignment_id=${encodeURIComponent(String(e.teaching_assignment_id))}`);const r=t.length?`?${t.join("&")}`:"",n=`${yn()}/api/obe/edit-requests/my-latest${r}`,i=await sa(n,{method:"GET"});return i.status===401?{result:null}:(i.ok||await Sn(i,"My edit request status fetch failed"),i.json())}async function v9(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${yn()}/api/obe/edit-requests/pending${t}`,n=await sa(r,{method:"GET"});return n.status===401?{results:[]}:(n.ok||await Sn(n,"Pending edit requests fetch failed"),n.json())}async function w9(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${yn()}/api/obe/edit-requests/hod/pending${t}`,n=await sa(r,{method:"GET"});return n.status===401?{results:[]}:(n.ok||await Sn(n,"HOD pending edit requests fetch failed"),n.json())}async function S9(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`),e!=null&&e.scope&&n.push(`scope=${encodeURIComponent(e.scope)}`);const i=n.length?`?${n.join("&")}`:"",s=`${yn()}/api/obe/edit-requests/history${i}`,o=await sa(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await Sn(o,"Edit requests history fetch failed"),o.json())}async function _S(){const e=`${yn()}/api/obe/iqac/class-type-weights`,t=await sa(e,{method:"GET"});if(t.status===401)throw new Error("Authentication required to fetch class-type weights");t.ok||await Sn(t,"Fetch class-type weights failed");const r=await t.json();return(r==null?void 0:r.results)||{}}async function _9(e){const t=`${yn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}`,r=await sa(t,{method:"GET"});if(r.status===401)throw new Error("Authentication required");return r.ok||await Sn(r,"Failed to fetch internal mark mapping"),r.json()}async function k9(e,t){const r=`${yn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}/save`,n=await sa(r,{method:"POST",body:JSON.stringify({mapping:t})});if(n.status===401)throw new Error("Authentication required");return n.ok||await Sn(n,"Failed to save internal mark mapping"),n.json()}async function cre(e){const t=`${yn()}/api/obe/iqac/class-type-weights/save`,r=await sa(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");r.ok||await Sn(r,"Save class-type weights failed");const n=await r.json();return(n==null?void 0:n.results)||{}}async function ure(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${yn()}/api/obe/edit-requests/pending-count${t}`,n=await sa(r,{method:"GET"});return n.status===401?{pending:0}:(n.ok||await Sn(n,"Pending edit requests count fetch failed"),n.json())}async function dre(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${yn()}/api/obe/edit-requests/hod/pending-count${t}`,n=await sa(r,{method:"GET"});return n.status===401?{pending:0}:(n.ok||await Sn(n,"HOD pending edit requests count fetch failed"),n.json())}async function j9(e,t=120){const r=`${yn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({window_minutes:t})});return n.ok||await Sn(n,"Approve edit request failed"),n.json()}async function A9(e){const t=`${yn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()}});return r.ok||await Sn(r,"Reject edit request failed"),r.json()}async function N9(e){const t=`${yn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/hod-approve`,r=await sa(t,{method:"POST"});return r.ok||await Sn(r,"HOD approve/forward failed"),r.json()}async function C9(e){const t=`${yn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/hod-reject`,r=await sa(t,{method:"POST"});return r.ok||await Sn(r,"HOD reject failed"),r.json()}async function fre(){const e=`${yn()}/api/obe/publish-requests/pending`,t=await sa(e,{method:"GET"});return t.status===401?{results:[]}:(t.ok||await Sn(t,"Pending requests fetch failed"),t.json())}async function hre(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`);const i=n.length?`?${n.join("&")}`:"",s=`${yn()}/api/obe/publish-requests/history${i}`,o=await sa(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await Sn(o,"History requests fetch failed"),o.json())}async function B4(){const e=`${yn()}/api/obe/publish-requests/pending-count`,t=await sa(e,{method:"GET"});return t.status===401?{pending:0}:(t.ok||await Sn(t,"Pending requests count fetch failed"),t.json())}async function pre(e,t=120){const r=`${yn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({window_minutes:t})});return n.ok||await Sn(n,"Approve request failed"),n.json()}async function mre(e){const t=`${yn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()}});return r.ok||await Sn(r,"Reject request failed"),r.json()}async function Sn(e,t){const r=await e.text();try{const n=String(r??"").replace(/^\uFEFF/,"").trim(),i=JSON.parse(n),s=(i==null?void 0:i.detail)||t,o=Array.isArray(i==null?void 0:i.how_to_fix)?`
How to fix:
- ${i.how_to_fix.join(`
- `)}`:"",l=Array.isArray(i==null?void 0:i.errors)?`
Errors:
- ${i.errors.join(`
- `)}`:"",c=new Error(`${s}${o}${l}`);throw c.status=e.status,c.body=i,c}catch{const n=new Error(`${t}: ${e.status} ${r}`);throw n.status=e.status,n.bodyText=r,n}}async function ei(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await sa(i,{method:"GET"});return s.status===401?{subject:{code:String(t),name:""},draft:null,updated_at:null,updated_by:null}:(s.ok||await Sn(s,"Draft fetch failed"),s.json())}async function Mi(e,t,r){const n=`${yn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}`,i=await sa(n,{method:"PUT",body:JSON.stringify({data:r})});if(i.status===401)throw new Error("Authentication required");return i.ok||await Sn(i,"Draft save failed"),i.json()}async function rg(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${yn()}/api/obe/ssa1-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return i.ok||await Sn(i,"SSA1 published fetch failed"),i.json()}async function E9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/ssa1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await Sn(s,"SSA1 publish failed"),s.json()}async function kS(e){const t=`${yn()}/api/obe/review1-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return r.ok||await Sn(r,"Review 1 published fetch failed"),r.json()}async function T9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/review1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await Sn(s,"Review 1 publish failed"),s.json()}async function ty(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${yn()}/api/obe/ssa2-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return i.ok||await Sn(i,"SSA2 published fetch failed"),i.json()}async function P9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/ssa2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await Sn(s,"SSA2 publish failed"),s.json()}async function jS(e){const t=`${yn()}/api/obe/review2-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return r.ok||await Sn(r,"Review 2 published fetch failed"),r.json()}async function O9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/review2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await Sn(s,"Review 2 publish failed"),s.json()}async function AS(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${yn()}/api/obe/formative1-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return i.ok||await Sn(i,"Formative1 published fetch failed"),i.json()}async function gre(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/formative1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await Sn(s,"Formative1 publish failed"),s.json()}async function b0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/${encodeURIComponent(e)}-published/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.ok||await Sn(s,`${e} published fetch failed`),s.json()}async function M9(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${yn()}/api/obe/${encodeURIComponent(e)}-publish/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:r})});return o.ok||await Sn(o,`${e} publish failed`),o.json()}async function ho(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/lab-published-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.ok||await Sn(s,"Lab published sheet fetch failed"),s.json()}async function k3(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${yn()}/api/obe/lab-publish-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:r})});return o.ok||await Sn(o,"Lab publish failed"),o.json()}async function ry(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${yn()}/api/obe/cia1-published-sheet/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return i.ok||await Sn(i,"CIA1 published sheet fetch failed"),i.json()}async function xre(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/cia1-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await Sn(s,"CIA1 publish failed"),s.json()}async function Rm(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${yn()}/api/obe/model-published-sheet/${encodeURIComponent(e)}${r}`;try{const i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});if(i.ok)return i.json();if(i.status===404){const s=await ho("model",e,t);return{subject:s.subject,data:s.data}}await Sn(i,"MODEL published sheet fetch failed")}catch(i){throw i}}async function L9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/model-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await Sn(s,"MODEL publish failed"),s.json()}async function v0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${yn()}/api/obe/${encodeURIComponent(e)}-published-sheet/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.ok||await Sn(s,`${e} published sheet fetch failed`),s.json()}async function R9(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${yn()}/api/obe/${encodeURIComponent(e)}-publish-sheet/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:r})});return o.ok||await Sn(o,`${e} publish failed`),o.json()}async function B9(e,t,r){const n=(c,u=1200)=>{const d=String(c||""),p=d.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||d.replace(/\s+/g," ").trim();return p.length<=u?p:p.slice(0,u)+" (truncated)"},i=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",s=`${yn()}/api/obe/${encodeURIComponent(e)}-marks/${encodeURIComponent(t)}${i}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}}});if(!l.ok){const c=await l.text();try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`${e.toUpperCase()} roster fetch failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"";throw new Error(`${d}${f}`)}catch{const u=n(c);throw new Error(`${e.toUpperCase()} roster fetch failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}}return l.json()}async function yre(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},i=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in",s=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",o=`${i}/api/obe/cia1-marks/${encodeURIComponent(e)}${s}`,l=window.localStorage.getItem("access"),c=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}}});if(!c.ok){const u=await c.text();try{const d=JSON.parse(u),f=(d==null?void 0:d.detail)||`CIA1 roster fetch failed: ${c.status}`,h=Array.isArray(d==null?void 0:d.how_to_fix)?`
How to fix:
- ${d.how_to_fix.join(`
- `)}`:"";throw new Error(`${f}${h}`)}catch{const d=r(u);throw new Error(`CIA1 roster fetch failed: ${c.status}
${d||"Server returned a non-JSON error response."}`)}}return c.json()}async function bre(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},s=`${typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in"}/api/obe/cia1-marks/${encodeURIComponent(e)}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}},body:JSON.stringify({marks:t})}),c=await l.text();if(!l.ok)try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`CIA1 save failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"",h=Array.isArray(u==null?void 0:u.errors)?`
Errors:
- ${u.errors.join(`
- `)}`:"";throw new Error(`${d}${f}${h}`)}catch{const u=r(c);throw new Error(`CIA1 save failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}return JSON.parse(c)}const Y8=Object.freeze(Object.defineProperty({__proto__:null,approveEditRequest:j9,approvePublishRequest:pre,bulkDeleteDueSchedule:g9,bulkResetGlobalPublishControls:f9,bulkSetAssessmentControls:L4,bulkSetGlobalPublishControls:M4,bulkUpsertDueSchedule:m9,confirmMarkManagerLock:uh,createEditRequest:nl,createPublishRequest:Sh,deleteDueSchedule:lre,dismissResetNotifications:c9,fetchAssessmentControls:Wv,fetchCia1Marks:yre,fetchCiaMarks:B9,fetchClassTypeWeights:_S,fetchDraft:ei,fetchDueScheduleSubjects:p9,fetchDueSchedules:R4,fetchEditRequestsHistory:S9,fetchEditWindow:l1,fetchGlobalPublishControls:dx,fetchHodPendingEditRequestCount:dre,fetchHodPendingEditRequests:w9,fetchInternalMarkMapping:_9,fetchIqacCqiConfig:SS,fetchIqacQpPattern:ih,fetchMarkTableLockStatus:vS,fetchMyLatestEditRequest:Lm,fetchMyTeachingAssignments:lc,fetchObeSemesters:h9,fetchPendingEditRequestCount:ure,fetchPendingEditRequests:v9,fetchPendingPublishRequestCount:B4,fetchPendingPublishRequests:fre,fetchPublishRequestsHistory:hre,fetchPublishWindow:_3,fetchPublishedCia1Sheet:ry,fetchPublishedCiaSheet:v0,fetchPublishedFormative:b0,fetchPublishedFormative1:AS,fetchPublishedLabSheet:ho,fetchPublishedModelSheet:Rm,fetchPublishedReview1:kS,fetchPublishedReview2:jS,fetchPublishedSsa1:rg,fetchPublishedSsa2:ty,fetchResetNotifications:l9,fetchSpecialCourseEnabledAssessments:wS,fetchTeachingAssignmentEnabledAssessments:are,fetchTeachingAssignmentEnabledAssessmentsInfo:fm,formatApiErrorMessage:al,formatEditRequestSentMessage:il,hodApproveEditRequest:N9,hodRejectEditRequest:C9,iqacResetAssessment:S3,publishCia1Sheet:xre,publishCiaSheet:R9,publishFormative:M9,publishFormative1:gre,publishLabSheet:k3,publishModelSheet:L9,publishReview1:T9,publishReview2:O9,publishSsa1:E9,publishSsa2:P9,rejectEditRequest:A9,rejectPublishRequest:mre,requestTeachingAssignmentEnabledAssessmentsEdit:d9,saveCia1Marks:bre,saveDraft:Mi,setTeachingAssignmentEnabledAssessments:sre,setTeachingAssignmentEnabledAssessmentsInfo:u9,upsertClassTypeWeights:cre,upsertDueSchedule:ore,upsertInternalMarkMapping:k9,upsertIqacCqiConfig:b9,upsertIqacQpPattern:y9},Symbol.toStringTag,{value:"Module"})),vre={profile:z0,curriculum_master:ms,assigned_subjects:ms,department_curriculum:G8,elective_import:M2,student_curriculum_view:O4,home:P2,hod_advisors:ys,hod_teaching:ms,advisor_students:ey,mentor_assign:ys,timetable_templates:xs,timetable_assignments:xs,student_timetable:xs,staff_timetable:xs,student_attendance:T2,my_mentees:ys,period_attendance:T2,obe:ms,obe_master:ms,obe_due_dates:T4,obe_requests:Nx,hod_obe_requests:Nx,academic_controller:G8,notifications:Nx};function wre({baseUrl:e=""}){const{data:t,loading:r,error:n}=tre(e),i=ul(),{collapsed:s,toggle:o}=w3(),[l,c]=x.useState(0),[u,d]=x.useState({}),h=((t==null?void 0:t.permissions)||[]).map(k=>String(k||"").toLowerCase()).includes("obe.master.manage");if(x.useEffect(()=>{let k=!0;const j=window.localStorage.getItem("access");if(!h||!j)return c(0),()=>{k=!1};(async()=>{try{const L=await B4();if(!k)return;c(Number(L.pending||0))}catch{}})();const A=window.setInterval(()=>{(async()=>{try{const L=await B4();if(!k)return;c(Number(L.pending||0))}catch{}})()},3e4);return()=>{k=!1,window.clearInterval(A)}},[h]),x.useEffect(()=>{i.pathname.startsWith("/academic")&&d(k=>({...k,academic:!0}))},[i.pathname]),x.useEffect(()=>{i.pathname.startsWith("/iqac/academic-controller")&&d(k=>({...k,academic_controller:!0}))},[i.pathname]),r)return a.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:a.jsx("div",{className:"p-6 flex items-center justify-center h-full",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(n)return a.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:a.jsx("div",{className:"p-6 text-red-600 text-sm",children:"Error loading sidebar"})});if(!t)return null;const p=t.entry_points||{},m=[],g=(t.permissions||[]).map(k=>(k||"").toString().toLowerCase()),y=(t.roles||[]).map(k=>(k||"").toString().toUpperCase()),b=t.flags||{},v=y.includes("IQAC");return p.curriculum_master&&(g.some(k=>k.includes("curriculum"))||p.curriculum_master)&&m.push({key:"curriculum_master",label:"Curriculum Master",to:"/curriculum/master"}),p.department_curriculum&&(g.some(k=>k.includes("curriculum"))||p.department_curriculum)&&m.push({key:"department_curriculum",label:"Department Curriculum",to:"/curriculum/department"}),g.includes("curriculum.import_elective_choices")&&m.push({key:"elective_import",label:"Elective Import",to:"/curriculum/elective-import"}),p.hod_advisors&&(y.includes("HOD")||g.includes("academics.assign_advisor"))&&m.push({key:"hod_advisors",label:"Advisor Assign",to:"/hod/advisors"}),p.hod_teaching&&(y.includes("ADVISOR")||g.includes("academics.assign_teaching"))&&m.push({key:"hod_teaching",label:"Teaching Assign",to:"/advisor/teaching"}),(!!(p!=null&&p.hod_obe_requests)||y.includes("HOD"))&&m.push({key:"hod_obe_requests",label:"HOD: OBE Requests",to:"/hod/obe-requests"}),p.advisor_students&&(y.includes("ADVISOR")||g.includes("academics.view_my_students"))&&m.push({key:"advisor_students",label:"My Students",to:"/advisor/students"}),(y.includes("ADVISOR")||g.includes("academics.assign_mentor"))&&m.push({key:"mentor_assign",label:"Mentor Assign",to:"/advisor/mentor"}),p.student_curriculum_view&&g.some(k=>k.includes("curriculum"))&&m.push({key:"student_curriculum_view",label:"My Curriculum",to:"/curriculum/student"}),(b.can_manage_timetable_templates||g.includes("timetable.manage_templates"))&&p.timetable_templates&&m.push({key:"timetable_templates",label:"IQAC: Timetable Templates",to:"/iqac/timetable"}),(!!b.can_assign_timetable||g.includes("timetable.assign")||y.includes("ADVISOR"))&&p.timetable_assignments&&m.push({key:"timetable_assignments",label:"Timetable Assignments",to:"/advisor/timetable"}),b.can_view_timetable&&b.is_student&&g.includes("timetable.view")&&m.push({key:"student_timetable",label:"My Timetable",to:"/student/timetable"}),b.can_view_timetable&&b.is_staff&&g.includes("timetable.view")&&m.push({key:"staff_timetable",label:"My Timetable (Staff)",to:"/staff/timetable"}),b.is_student&&m.push({key:"student_attendance",label:"My Attendance",to:"/student/attendance"}),b.is_staff&&(g.includes("academics.view_assigned_subjects")||y.includes("HOD"))&&m.push({key:"assigned_subjects",label:"Assigned Subjects",to:"/staff/assigned-subjects"}),b.is_staff&&g.includes("academics.view_mentees")&&m.push({key:"my_mentees",label:"My Mentees",to:"/staff/mentees"}),b.is_staff&&(g.includes("academics.mark_attendance")||y.includes("HOD")||y.includes("ADVISOR"))&&m.push({key:"period_attendance",label:"Mark Attendance",to:"/staff/period-attendance"}),b.is_staff&&(g.includes("academics.view_all_attendance")||g.includes("academics.view_attendance_overall")||g.includes("academics.view_all_departments")||g.includes("academics.view_department_attendance")||g.includes("academics.view_class_attendance")||g.includes("academics.view_section_attendance"))&&m.push({key:"attendance_analytics",label:"Attendance Analytics",to:"/staff/analytics"}),m.unshift({key:"profile",label:"Profile",to:"/profile"}),v&&m.push({key:"notifications",label:"Notifications",to:"/notifications"}),b.is_staff&&!m.some(k=>k.key==="academic")&&m.push({key:"academic",label:"Academic",to:"/academic"}),v&&!m.some(k=>k.key==="academic_controller")&&m.push({key:"academic_controller",label:"Academic Controller",to:"/iqac/academic-controller"}),h&&!v&&!m.some(k=>k.key==="obe_due_dates")&&m.push({key:"obe_due_dates",label:"OBE: Due Dates",to:"/obe/master/due-dates"}),h&&!m.some(k=>k.key==="obe_requests")&&m.push({key:"obe_requests",label:"OBE: Requests",to:"/obe/master/requests"}),a.jsxs(a.Fragment,{children:[!s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:o}),a.jsxs("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 overflow-y-auto ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:[a.jsx("div",{className:"hidden"}),a.jsx("nav",{className:"py-6",children:a.jsxs("ul",{className:"space-y-2 px-3",children:[a.jsx("li",{children:a.jsxs(es,{to:"/dashboard",className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${i.pathname==="/dashboard"?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(P2,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),a.jsx("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:"Dashboard"})]})}),m.map(k=>{const j=vre[k.key]||z0,A=i.pathname.startsWith(k.to);return a.jsxs("li",{className:"relative",children:[a.jsxs(es,{to:k.to,className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${A?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o(),k.key==="academic"&&d(L=>({...L,academic:!L.academic})),k.key==="academic_controller"&&d(L=>({...L,academic_controller:!L.academic_controller}))},children:[a.jsx(j,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),a.jsxs("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:[k.label,k.key==="obe_requests"&&l>0?a.jsx("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-medium rounded-full bg-red-600 text-white",children:l}):null]})]}),k.key==="academic"&&h&&u.academic?a.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[a.jsx("li",{children:a.jsxs(es,{to:"/academic?tab=obe_master",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/academic")&&new URLSearchParams(i.search).get("tab")==="obe_master"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(ms,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE Master"})]})}),v?null:a.jsx("li",{children:a.jsxs(es,{to:"/academic?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/academic")&&new URLSearchParams(i.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(T4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE: Due Dates"})]})})]}):null,k.key==="academic_controller"&&u.academic_controller?a.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=dashboard",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="dashboard"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(P2,{className:"w-4 h-4"})," ",a.jsx("span",{children:"Dashboard"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=qp",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="qp"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(O4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"QP"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(T4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE Due Dates"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=courses",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="courses"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(O4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"Courses"})]})})]}):null]},k.key)})]})})]})]})}const Sre=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function _re({editingCell:e,periods:t,assignmentMap:r,specialName:n,setSpecialName:i,selectedSpecialId:s,setSelectedSpecialId:o,specialTimetables:l,specialDate:c,setSpecialDate:u,curriculum:d,currentSectionRegulation:f,editingCurriculumId:h,setEditingCurriculumId:p,customSubjectText:m,setCustomSubjectText:g,editingAvailableBatches:y,setEditingAvailableBatches:b,editingBatchId:v,setEditingBatchId:w,isCustomAssignment:S,setIsCustomAssignment:k,customAssignmentText:j,setCustomAssignmentText:A,selectedStaffId:L,setSelectedStaffId:P,staffList:B,sectionId:E,shortLabel:T,loadBatchesForCurriculum:F,handleDeleteSpecialEntry:W,handleDeleteAssignment:z,handleUpdateAssignment:se,handleAssign:de,loadTimetable:U,setShowCellPopup:G,customSubjectOptions:re,setEditingCell:X,fetchWithAuth:C}){if(!e)return null;const K=e.day,V=e.periodId,R=r[K]&&r[K][V]||[],J=t.find(q=>q.id===V)||{};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4 flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-3 text-white",children:[a.jsx(xs,{className:"h-5 w-5"}),a.jsxs("h3",{className:"text-lg font-semibold",children:["Day ",K,"  ",J.label||`${J.start_time||""} - ${J.end_time||""}`]})]}),a.jsx("button",{onClick:()=>{G(!1),X(null)},className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-1.5 transition-colors",children:a.jsx(gu,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(ms,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Existing Assignments"})]}),R.length===0?a.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[a.jsx(td,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:"No assignment yet"})]}):a.jsx("div",{className:"space-y-3",children:R.map(q=>{var Y;return a.jsxs("div",{className:`rounded-lg p-4 border-2 ${q.is_special?"bg-amber-50 border-amber-200":"bg-blue-50 border-blue-200"}`,children:[a.jsxs("div",{className:"font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(ms,{className:"h-4 w-4"}),q.is_special?q.timetable_name||"Special":T(q.curriculum_row||q.subject_text),q.is_special&&a.jsxs("span",{className:"text-amber-600 text-sm",children:[" ",T(q.curriculum_row||q.subject_text)]})]}),a.jsxs("div",{className:"text-sm text-gray-700 mt-2 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3.5 w-3.5"}),((Y=q.staff)==null?void 0:Y.username)||"",q.subject_batch?`  Batch: ${q.subject_batch.name}`:""]}),q.is_special&&a.jsxs("div",{className:"text-xs text-amber-700 mt-2 flex items-center gap-1",children:[a.jsx(xs,{className:"h-3.5 w-3.5"}),"Date: ",q.date||"","  ",J.label||`${J.start_time||""}${J.start_time&&J.end_time?" - ":""}${J.end_time||""}`]}),a.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[a.jsxs("button",{onClick:async()=>{var le,O;const Q=((le=q.curriculum_row)==null?void 0:le.id)||null,ie=((O=q.subject_batch)==null?void 0:O.id)||null;if(p(Q),w(ie),Q){const H=await F(Q);if(ie&&!H.find(ae=>ae.id===ie))try{const ae=await C(`/api/academics/subject-batches/${ie}/`);if(ae.ok){const I=await ae.json();b(Z=>Z.find(pe=>pe.id===I.id)?Z:[...Z,I])}}catch(ae){console.error("failed to load existing batch",ae)}}else if(ie)try{const H=await C(`/api/academics/subject-batches/${ie}/`);if(H.ok){const ae=await H.json();b(I=>I.find(Z=>Z.id===ae.id)?I:[...I,ae])}}catch(H){console.error("failed to load existing batch",H)}},className:"px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-1",children:[a.jsx(ch,{className:"h-3.5 w-3.5"}),"Edit"]}),a.jsxs("button",{onClick:()=>{q.is_special?W(q.id):z(q.id)},className:"px-3 py-1.5 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors flex items-center gap-1",children:[a.jsx(o1,{className:"h-3.5 w-3.5"}),"Delete"]}),a.jsxs("button",{onClick:async()=>{if(!h)return alert("Select new subject from right panel then click Update");const Q={};h&&(Q.curriculum_row=h),v!==null&&(Q.subject_batch_id=v),await se(q.id,Q)},className:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors flex items-center gap-1",children:[a.jsx(nd,{className:"h-3.5 w-3.5"}),"Update"]})]})]},q.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Mm,{className:"h-5 w-5 text-green-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Assign / Edit"})]}),a.jsxs("div",{className:"space-y-4 bg-gray-50 rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Type"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{k(!1),A(""),P(null)},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${S?"bg-white text-gray-700 border-gray-300 hover:border-indigo-300":"bg-indigo-600 text-white border-indigo-600"}`,children:"From Curriculum"}),a.jsx("button",{onClick:()=>{k(!0),p(null),w(null),b([])},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${S?"bg-indigo-600 text-white border-indigo-600":"bg-white text-gray-700 border-gray-300 hover:border-indigo-300"}`,children:"Custom Subject"})]})]}),S?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject Name"}),a.jsxs("select",{value:j||"",onChange:q=>A(q.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select custom subject"}),re.map(q=>a.jsx("option",{value:q.label,children:q.label},q.value))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Staff (optional)"}),a.jsxs("select",{value:L||"",onChange:q=>P(Number(q.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select staff (optional)"}),B.map(q=>a.jsx("option",{value:q.id,children:(()=>{var le,O,H;const Y=((le=q.user)==null?void 0:le.first_name)||"",Q=((O=q.user)==null?void 0:O.last_name)||"";return`${Y} ${Q}`.trim()||((H=q.user)==null?void 0:H.username)||q.staff_id})()},q.id))]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),a.jsxs("select",{value:h||"",onChange:async q=>{const Y=Number(q.target.value)||null;p(Y),w(null),Y?await F(Y):b([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select subject"}),d.filter(q=>!(f!=null&&f.code)||q.regulation===f.code).map(q=>a.jsxs("option",{value:q.id,children:[q.course_code,"  ",q.course_name]},q.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),a.jsxs("select",{value:v||"",onChange:q=>w(Number(q.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select batch (optional)"}),y.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]})]})]}),a.jsxs("button",{onClick:async()=>{if(S){if(!j.trim())return alert("Subject name is required");await de(K,V)}else{if(!h)return alert("Select a subject");await de(K,V,h)}G(!1),X(null)},className:"w-full px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx(Mm,{className:"h-4 w-4"}),"Assign to Period"]})]}),a.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(td,{className:"h-5 w-5 text-amber-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Mark Special Period"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a date-specific override for this period."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Special timetable"}),a.jsxs("select",{value:s??"",onChange:q=>o(q.target.value?Number(q.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"Create new"}),l.map(q=>a.jsxs("option",{value:q.id,children:[q.name," ",q.is_active?"":"(inactive)"]},q.id))]}),!s&&a.jsx("input",{placeholder:"Name for new special timetable",value:n,onChange:q=>{q.preventDefault(),i(q.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"},"special-name-input")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Date"}),a.jsx("input",{type:"date",value:c||"",onChange:q=>u(q.target.value||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),a.jsxs("select",{value:h??"",onChange:q=>{const Y=Number(q.target.value)||null;p(Y),g(""),w(null),Y&&Y!==-1&&F(Y).catch(console.error)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"-- choose from section subjects --"}),d.filter(q=>!(f!=null&&f.code)||q.regulation===f.code).map(q=>a.jsxs("option",{value:q.id,children:[q.course_code,"  ",q.course_name]},q.id)),a.jsx("option",{value:"-1",children:"Custom text"})]}),h===-1&&a.jsxs("select",{value:m||"",onChange:q=>{q.preventDefault(),g(q.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"-- choose custom subject --"}),re.map(q=>a.jsx("option",{value:q.label,children:q.label},q.value))]},"custom-subject-input")]}),y&&y.length>0&&h&&h!==-1&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),a.jsxs("select",{value:v||"",onChange:q=>w(Number(q.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"None"}),y.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]})]}),a.jsxs("button",{onClick:async()=>{if(!c)return alert("Select a date");try{let q=s;if(!q){const ie=n||`Special - ${c}`,le=await C("/api/timetable/special-timetables/",{method:"POST",body:JSON.stringify({name:ie,section:E,is_active:!0})});if(!le.ok){const H=await le.text();return alert("Failed to create special timetable: "+H)}q=(await le.json()).id}const Y={timetable_id:q,timetable:q,date:c,period_id:V,period:V};h&&h!==-1&&(Y.curriculum_row=h),h===-1&&m&&(Y.subject_text=m),v&&(Y.subject_batch_id=v);const Q=await C("/api/timetable/special-entries/",{method:"POST",body:JSON.stringify(Y)});if(!Q.ok){const ie=await Q.text();return alert("Failed to create special entry: "+ie)}alert("Special period created"),await U(),G(!1),X(null)}catch(q){console.error(q),alert("Failed to create special entry")}},className:"w-full px-4 py-2.5 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx(td,{className:"h-4 w-4"}),"Mark Special Period"]})]})]})]})]})})]})})}function kre(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState([]),[S,k]=x.useState(null),[j,A]=x.useState(null),[L,P]=x.useState([]),[B,E]=x.useState(null),[T,F]=x.useState(!1),[W,z]=x.useState(new Date().toISOString().slice(0,10)),[se,de]=x.useState([]),[U,G]=x.useState(null),[re,X]=x.useState(""),[C,K]=x.useState(""),[V,R]=x.useState([]),[J,q]=x.useState(!1),[Y,Q]=x.useState(""),[ie,le]=x.useState(null),[O,H]=x.useState([]);x.useEffect(()=>{yr("/api/academics/my-students/").then(Xe=>Xe.ok?Xe.json():[]).then(Xe=>{const nt=(Xe.results||[]).map(Ne=>({id:Ne.section_id,name:Ne.section_name,batch:Ne.batch,batch_regulation:Ne.batch_regulation,department_id:Ne.department_id}));t(nt),!o&&nt.length>0&&(l(nt[0].id),u(nt[0].department_id),f(nt[0].batch_regulation))}),yr("/api/timetable/templates/").then(Xe=>Xe.json()).then(Xe=>{const nt=Xe||[];n(nt);const Ne=nt.find(be=>be.is_active)||nt[0];Ne&&(p(Ne.id),s(Ne.periods||[]))}),yr("/api/academics/custom-subjects/").then(Xe=>Xe.ok?Xe.json():{results:[]}).then(Xe=>R(Xe.results||[])).catch(Xe=>console.error("Failed to load custom subjects",Xe))},[]),x.useEffect(()=>{if(o){const Xe=e.find(nt=>nt.id===o);Xe&&f(Xe.batch_regulation),yr(`/api/timetable/curriculum-for-section/?section_id=${o}`).then(nt=>nt.json()).then(nt=>g(nt.results||[])),ae(),yr(`/api/timetable/section/${o}/subjects-staff/`).then(nt=>nt.ok?nt.json():[]).then(nt=>w(nt.results||[])),yr(`/api/timetable/special-timetables/?section_id=${o}`).then(nt=>nt.ok?nt.json():[]).then(nt=>de(nt.results||[])),c&&yr(`/api/academics/advisor-staff/?department=${c}`).then(nt=>nt.ok?nt.json():[]).then(nt=>H(nt.results||nt||[]))}},[o,c]);async function ae(){if(o)try{const Xe=await yr(`/api/timetable/section/${o}/timetable/`);if(!Xe.ok)return;const nt=await Xe.json();b(nt.results||[])}catch(Xe){console.error("loadTimetable failed",Xe)}}const I={};for(const Xe of y){const nt=Xe.day;I[nt]=I[nt]||{};for(const Ne of Xe.assignments||[])I[nt][Ne.period_id]=I[nt][Ne.period_id]||[],I[nt][Ne.period_id].push(Ne)}function Z(Xe){if(!Xe)return"";if(typeof Xe=="string"){const be=Xe.trim();return be.length<=12?be:be.slice(0,12)+""}if(Xe.course_code)return Xe.course_code;const nt=Xe.course_name||Xe.course||Xe.subject_text||"",Ne=String(nt).trim();return Ne.length<=12?Ne:Ne.split(" ").map(be=>be[0]).slice(0,3).join("")||Ne.slice(0,12)}function pe(Xe){const nt=new Date,Ne=nt.getDay(),be=new Date(nt),fe=Ne===0?-6:1-Ne;be.setDate(nt.getDate()+fe);const ge=new Date(be);return ge.setDate(be.getDate()+(Xe-1)),ge.toISOString().slice(0,10)}async function Oe(Xe,nt,Ne){if(!o)return alert("Section is required");const be={period_id:nt,day:Xe,section_id:o};if(J){if(!Y.trim())return alert("Subject name is required");be.subject_text=Y.trim(),ie&&(be.staff_id=ie)}else{if(!Ne)return alert("Select a curriculum row first");be.curriculum_row=Ne,B&&(be.subject_batch_id=B)}const fe=await yr("/api/timetable/assignments/",{method:"POST",body:JSON.stringify(be)});if(!fe.ok){const ge=await fe.text();return alert("Failed: "+ge)}A(null),P([]),E(null),Q(""),le(null),await ae()}async function Ae(Xe){if(P([]),!Xe)return[];try{const nt=await yr(`/api/academics/subject-batches/?curriculum_row_id=${Xe}&page_size=0&include_all=1`);if(nt.ok){const Ne=await nt.json(),be=Ne.results||Ne||[];return P(be),be}}catch(nt){console.error("loadBatches failed",nt)}return[]}function ke(Xe,nt){if(nt.is_break||nt.is_lunch)return a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:nt.label||(nt.is_break?"Break":"Lunch")})});const Ne=I[Xe]&&I[Xe][nt.id];return a.jsx("div",{children:Ne&&Ne.length?a.jsx("div",{className:"space-y-2",children:Ne.map((be,fe)=>a.jsxs("div",{className:`rounded-lg p-2.5 cursor-pointer transition-all hover:shadow-md ${be.is_special?"bg-amber-50 border border-amber-200 hover:border-amber-300":"bg-blue-50 border border-blue-200 hover:border-blue-300"}`,onClick:()=>{k({day:Xe,periodId:nt.id}),z(pe(Xe)),F(!0)},children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[a.jsx(ms,{className:"h-3 w-3"}),be.is_special?be.timetable_name||"Special":Z(be.curriculum_row||be.subject_text),be.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",Z(be.curriculum_row||be.subject_text)]})]}),a.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3 w-3"}),"Staff: ",(()=>{if(!be.staff)return"";const ge=be.staff.first_name||"",lt=be.staff.last_name||"";return`${ge} ${lt}`.trim()||be.staff.username||""})(),be.subject_batch?`  Batch: ${be.subject_batch.name}`:""]})]},fe))}):a.jsxs("div",{className:"py-4 text-gray-400 text-sm cursor-pointer hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-all flex items-center justify-center gap-1",onClick:()=>{k({day:Xe,periodId:nt.id}),z(pe(Xe)),F(!0)},children:[a.jsx(Mm,{className:"h-4 w-4"}),"Click to assign"]})})}async function _e(Xe){if(Xe&&confirm("Delete this assignment?"))try{const nt=await yr(`/api/timetable/assignments/${Xe}/`,{method:"DELETE"});if(!nt.ok){const Ne=await nt.text();return alert("Failed: "+Ne)}await ae()}catch(nt){console.error(nt),alert("Delete failed")}}async function De(Xe){if(!Xe||!confirm("Delete this special period?"))return;let nt=String(Xe);nt.startsWith("special-")&&(nt=nt.replace("special-",""));const Ne=Number(nt);if(!Ne)return alert("Invalid special entry id");try{const be=await yr(`/api/timetable/special-entries/${Ne}/`,{method:"DELETE"});if(!be.ok){const fe=await be.text();return alert("Failed: "+fe)}await ae()}catch(be){console.error(be),alert("Delete failed")}}async function We(Xe,nt){if(Xe)try{const Ne=await yr(`/api/timetable/assignments/${Xe}/`,{method:"PATCH",body:JSON.stringify(nt)});if(!Ne.ok){const be=await Ne.text();return alert("Failed: "+be)}await ae(),F(!1),k(null)}catch(Ne){console.error(Ne),alert("Update failed")}}const _t=(()=>{if(!(d!=null&&d.code))return[];const Xe=m.filter(be=>be.regulation===d.code),nt=new Map;return v.forEach(be=>{be.id&&be.staff&&nt.set(be.id,be.staff)}),Xe.map(be=>({...be,staff:nt.get(be.id)||""}))})();return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(xs,{className:"h-7 w-7 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Timetable Editor"}),a.jsx("p",{className:"text-gray-600",children:"Manage class schedules and assignments"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ey,{className:"h-4 w-4 text-indigo-600"}),a.jsx("span",{className:"font-semibold text-indigo-900",children:(e.find(Xe=>Xe.id===o)||{name:"Section"}).name})]})}),d&&a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-lg border border-emerald-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ms,{className:"h-4 w-4 text-emerald-600"}),a.jsxs("span",{className:"font-semibold text-emerald-900",children:["Regulation: ",d.code]})]})}),h&&a.jsx("div",{className:"px-4 py-2 bg-gray-50 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(rc,{className:"h-4 w-4 text-gray-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:(r.find(Xe=>Xe.id===h)||{name:"Template"}).name})]})})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 mb-6 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(rc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[120px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),i.map(Xe=>a.jsxs("th",{className:"px-4 py-3 min-w-[160px]",children:[a.jsx("div",{className:"text-sm font-bold text-indigo-700",children:Xe.label||`Period ${Xe.index||""}`}),a.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:Xe.start_time?`${Xe.start_time}${Xe.end_time?" - "+Xe.end_time:""}`:Xe.is_break?"Break":""})]},Xe.id))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:Sre.map((Xe,nt)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:Xe}),i.map(Ne=>{const be=S&&S.day===nt+1&&S.periodId===Ne.id;return a.jsx("td",{className:`px-4 py-3 align-top ${be?"bg-indigo-50 border-2 border-indigo-300 shadow-md":""}`,children:ke(nt+1,Ne)},Ne.id)})]},Xe))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"h-5 w-5 text-indigo-600"}),a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Subjects & Staff Reference",d&&a.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(Regulation: ",d.code,")"]})]})]})}),a.jsx("div",{className:"overflow-x-auto max-h-96",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Staff"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:_t.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:2,className:"px-6 py-8 text-center",children:[a.jsx(ms,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:d?`No subjects found for regulation ${d.code}`:"No subjects found"})]})}):_t.map(Xe=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-3 text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ms,{className:"h-4 w-4 text-indigo-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:Xe.course_code?`${Xe.course_code}  ${Xe.course_name}`:Xe.course_name}),Xe.class_type&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Xe.class_type," ",Xe.is_elective?" Elective":""]})]})]})}),a.jsx("td",{className:"px-6 py-3 text-sm text-gray-700",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"h-4 w-4 text-gray-500"}),a.jsx("span",{className:Xe.staff===""?"text-gray-400 italic":"",children:Xe.staff}),Xe.staff===""&&a.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Not Assigned"})]})})]},String(Xe.id)))})]})})]})]}),T?a.jsx(_re,{editingCell:S,periods:i,assignmentMap:I,specialName:re,setSpecialName:X,selectedSpecialId:U,setSelectedSpecialId:G,specialTimetables:se,specialDate:W,setSpecialDate:z,curriculum:m,currentSectionRegulation:d,editingCurriculumId:j,setEditingCurriculumId:A,customSubjectText:C,setCustomSubjectText:K,editingAvailableBatches:L,setEditingAvailableBatches:P,editingBatchId:B,setEditingBatchId:E,isCustomAssignment:J,setIsCustomAssignment:q,customAssignmentText:Y,setCustomAssignmentText:Q,selectedStaffId:ie,setSelectedStaffId:le,staffList:O,sectionId:o,shortLabel:Z,loadBatchesForCurriculum:Ae,handleDeleteSpecialEntry:De,handleDeleteAssignment:_e,handleUpdateAssignment:We,handleAssign:Oe,loadTimetable:ae,setShowCellPopup:F,setEditingCell:k,fetchWithAuth:yr,customSubjectOptions:V}):null]})}function jre(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[i,s]=x.useState(!1),[o,l]=x.useState({name:"",description:"",parity:"BOTH",is_public:!1,is_active:!1}),[c,u]=x.useState([]),[d,f]=x.useState({name:"",parity:"ODD",is_active:!1}),[h,p]=x.useState({index:1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""}),[m,g]=x.useState(null),[y,b]=x.useState({});x.useEffect(()=>{v()},[]),x.useEffect(()=>{w()},[]);async function v(){s(!0);try{const E=await yr("/api/timetable/templates/");if(!E.ok)throw new Error(await E.text());const T=await E.json(),F=Array.isArray(T)?T:T.results||T;if(t(F||[]),F&&F.length){const W=F.find(z=>z.is_active)||F[0];n(W);try{const z=W&&W.periods||[],se=z.length?Math.max(...z.map(de=>Number(de.index||de.position||0))):0;p(de=>({...de,index:Number(se)+1}))}catch{}}}catch(E){console.error(E),alert("Failed to load templates")}finally{s(!1)}}async function w(){try{const E=await yr("/api/academics/academic-years/");if(!E.ok)throw new Error(await E.text());const T=await E.json(),F=Array.isArray(T)?T:T.results||T;u(F||[])}catch(E){console.error(E)}}async function S(){try{const E=await yr("/api/academics/academic-years/",{method:"POST",body:JSON.stringify(d)});if(!E.ok)throw new Error(await E.text());await w(),f({name:"",parity:"ODD",is_active:!1})}catch(E){console.error(E),alert("Failed to create academic year: "+String(E))}}async function k(E,T){try{const F=await yr(`/api/academics/academic-years/${E}/`,{method:"PATCH",body:JSON.stringify({is_active:T})});if(!F.ok)throw new Error(await F.text());await w(),await v()}catch(F){console.error(F),alert("Failed to update academic year: "+String(F))}}async function j(){if(!r)return alert("Select a template first");try{const E={...h,template:r.id},T=await yr("/api/timetable/slots/",{method:"POST",body:JSON.stringify(E)});if(!T.ok)throw new Error(await T.text());await v(),p({index:h.index+1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""})}catch(E){console.error(E),alert("Failed to add slot: "+String(E))}}async function A(E){if(confirm("Delete this period?"))try{const T=await yr(`/api/timetable/slots/${E}/`,{method:"DELETE"});if(!T.ok)throw new Error(await T.text());await v()}catch(T){console.error(T),alert("Failed to delete slot: "+String(T))}}function L(E){g(E.id),b({...E})}function P(){g(null),b({})}async function B(){if(!(!m||!y))try{const E=await yr(`/api/timetable/slots/${m}/`,{method:"PATCH",body:JSON.stringify(y)});if(!E.ok)throw new Error(await E.text());await v(),g(null),b({})}catch(E){console.error(E),alert("Failed to update slot: "+String(E))}}return a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[a.jsx("span",{className:"p-3 bg-indigo-100 rounded-xl",children:a.jsxs("svg",{width:"28",height:"28",fill:"none",viewBox:"0 0 48 48",children:[a.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),a.jsx("path",{d:"M16 24h16M16 32h16M16 16h16",stroke:"#6366f1",strokeWidth:"2",strokeLinecap:"round"})]})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"IQAC  Timetable Templates"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage timetable templates and periods."})]})]}),i&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),"Loading templates..."]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(xs,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Academic Years"})]}),a.jsxs("div",{className:"space-y-3 mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",placeholder:"e.g. 2025-26",value:d.name,onChange:E=>f({...d,name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parity"}),a.jsxs("select",{value:d.parity,onChange:E=>f({...d,parity:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"ODD",children:"Odd"}),a.jsx("option",{value:"EVEN",children:"Even"})]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"activate",checked:d.is_active,onChange:E=>f({...d,is_active:E.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"activate",className:"ml-2 text-sm text-gray-700",children:"Activate on create"})]}),a.jsx("button",{onClick:S,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Create Academic Year"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Existing Years"}),a.jsx("div",{className:"space-y-2",children:c.map(E=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium text-gray-900",children:[E.name," ",E.parity&&`(${E.parity})`,E.is_active&&a.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:"Active"})]})}),a.jsx("button",{onClick:()=>k(E.id,!E.is_active),className:`px-3 py-1 text-xs font-medium rounded-lg transition-colors ${E.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:E.is_active?"Deactivate":"Activate"})]},E.id))})]})]})}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[a.jsx(rc,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Template Management"})]}),!r&&a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(rc,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"Select a template to manage its periods."})]}),r&&a.jsxs("div",{children:[a.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:r.name}),a.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-full",children:r.parity}),r.is_active&&a.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"Active"})]}),r.description&&a.jsx("p",{className:"text-gray-600",children:r.description})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"text-lg font-medium text-gray-900 mb-3",children:"Periods"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse border border-gray-200 rounded-lg",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:[a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Label"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Start Time"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"End Time"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white",children:(r.periods||[]).map(E=>a.jsx("tr",{className:"hover:bg-gray-50",children:m===E.id?a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"text",value:y.label||"",onChange:T=>b({...y,label:T.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Label"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"time",value:y.start_time||"",onChange:T=>b({...y,start_time:T.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"time",value:y.end_time||"",onChange:T=>b({...y,end_time:T.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"flex items-center text-xs",children:[a.jsx("input",{type:"checkbox",checked:y.is_break||!1,onChange:T=>b({...y,is_break:T.target.checked,is_lunch:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Break"]}),a.jsxs("label",{className:"flex items-center text-xs",children:[a.jsx("input",{type:"checkbox",checked:y.is_lunch||!1,onChange:T=>b({...y,is_lunch:T.target.checked,is_break:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Lunch"]})]})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:B,className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Save Changes",children:a.jsx(nd,{className:"w-4 h-4"})}),a.jsx("button",{onClick:P,className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",title:"Cancel Edit",children:a.jsx(gu,{className:"w-4 h-4"})})]})})]}):a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.label||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.start_time||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.end_time||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm",children:E.is_break?a.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"Break"}):E.is_lunch?a.jsx("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full",children:"Lunch"}):a.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Period"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>L(E),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Period",children:a.jsx(ch,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>A(E.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Period",children:a.jsx(o1,{className:"w-4 h-4"})})]})})]})},E.id))})]})})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Mm,{className:"w-5 h-5 text-green-600"}),a.jsx("h5",{className:"text-lg font-medium text-gray-900",children:"Add New Period"})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Index"}),a.jsx("input",{type:"number",value:h.index,onChange:E=>p({...h,index:Number(E.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),a.jsx("input",{type:"time",value:h.start_time,onChange:E=>p({...h,start_time:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),a.jsx("input",{type:"time",value:h.end_time,onChange:E=>p({...h,end_time:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),a.jsx("input",{type:"text",placeholder:"Period 1, Break, etc.",value:h.label,onChange:E=>p({...h,label:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:h.is_break,onChange:E=>p({...h,is_break:E.target.checked,is_lunch:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Break Period"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:h.is_lunch,onChange:E=>p({...h,is_lunch:E.target.checked,is_break:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Lunch Period"})]})]}),a.jsxs("button",{onClick:j,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center gap-2",children:[a.jsx(Mm,{className:"w-4 h-4"}),"Add Period"]})]})]})]})})]})]})}function F9(){var k,j,A,L,P;const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState({}),[d,f]=x.useState({}),[h,p]=x.useState(null);async function m(){t(!0),n(null);try{const[B,E]=await Promise.all([v9(),S9({statuses:["APPROVED","REJECTED"],limit:200})]),T=Array.isArray(B==null?void 0:B.results)?B.results:[],F=Array.isArray(E==null?void 0:E.results)?E.results:[];s(T),l(F),u(W=>{const z={...W};for(const se of T)z[se.id]==null&&(z[se.id]=120);return z})}catch(B){n((B==null?void 0:B.message)||"Failed to load requests")}finally{t(!1)}}x.useEffect(()=>{m()},[]);const g=x.useMemo(()=>[...i].sort((B,E)=>String(E.requested_at||"").localeCompare(String(B.requested_at||""))),[i]),y=x.useMemo(()=>[...o].sort((B,E)=>String(E.reviewed_at||E.requested_at||"").localeCompare(String(B.reviewed_at||B.requested_at||""))),[o]);function b(B){const E=String(B||"").trim();if(!E)return"?";const T=E.split(/\s+/g).filter(Boolean);return T.length===1?T[0].slice(0,2).toUpperCase():(T[0][0]+T[T.length-1][0]).toUpperCase()}function v(B){if(!B)return"";const E=new Date(B);return Number.isNaN(E.getTime())?String(B):E.toLocaleString()}async function w(B){const E=Number(c[B]??120);f(T=>({...T,[B]:!0})),n(null);try{await j9(B,Number.isFinite(E)?E:120),await m()}catch(T){n((T==null?void 0:T.message)||"Approve failed")}finally{f(T=>({...T,[B]:!1}))}}async function S(B){f(E=>({...E,[B]:!0})),n(null);try{await A9(B),await m()}catch(E){n((E==null?void 0:E.message)||"Reject failed")}finally{f(E=>({...E,[B]:!1}))}}return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:20},children:[a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:20},children:[a.jsx(rc,{size:24,color:"#9a3412"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:24,fontWeight:950,color:"#111827"},children:"OBE Edit Requests"}),a.jsx("div",{style:{color:"#6b7280",fontSize:14},children:"Manage pending requests for Mark Entry and Mark Manager edits from faculty"})]}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:a.jsxs("button",{className:"obe-btn obe-btn-secondary",onClick:m,disabled:e,children:[a.jsx(O2,{size:16,style:{marginRight:6}}),e?"Refreshing":"Refresh"]})})]}),r?a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:12,borderRadius:12,marginBottom:20},children:[a.jsx(b3,{size:16,style:{marginRight:8,verticalAlign:"middle"}}),r]}):null,a.jsxs("div",{style:{display:"grid",gap:18},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"Answered Now"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",g.length,")"]})]}),g.length===0?a.jsxs("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:[a.jsx(y3,{size:34,color:"#10b981",style:{marginBottom:8}}),a.jsx("div",{children:"No pending requests"})]}):a.jsx("div",{style:{display:"grid",gap:10},children:g.map(B=>{var W,z,se;const E=!!d[B.id],T=String(((W=B.staff)==null?void 0:W.name)||((z=B.staff)==null?void 0:z.username)||"Unknown"),F=(se=B.staff)==null?void 0:se.department;return a.jsxs("div",{onClick:()=>p({kind:"pending",item:B}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#fff7ed",border:"1px solid #fed7aa",display:"grid",placeItems:"center",fontWeight:950,color:"#9a3412"},children:b(T)}),a.jsxs("div",{style:{flex:1,minWidth:220},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:T}),F?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",F]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[B.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:B.subject_name||B.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",B.assessment.toUpperCase(),"  ",v(B.requested_at)]})]}),a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsxs("div",{style:{background:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:800,whiteSpace:"nowrap"},children:[a.jsx(rc,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"Pending"]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},onClick:de=>de.stopPropagation(),children:[a.jsx("input",{type:"number",value:c[B.id]??120,onChange:de=>u(U=>({...U,[B.id]:Number(de.target.value)})),min:1,max:1440,style:{width:82,padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:10},disabled:E,title:"Window minutes"}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>w(B.id),disabled:E,children:E?"Approving":"Approve"}),a.jsx("button",{className:"obe-btn obe-btn-danger",onClick:()=>S(B.id),disabled:E,children:E?"Rejecting":"Reject"})]})]})]},B.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"History"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",y.length,")"]})]}),y.length===0?a.jsx("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:a.jsx("div",{children:"No reviewed requests yet"})}):a.jsx("div",{style:{display:"grid",gap:10},children:y.map(B=>{var de,U,G;const E=String(((de=B.staff)==null?void 0:de.name)||((U=B.staff)==null?void 0:U.username)||"Unknown"),T=(G=B.staff)==null?void 0:G.department,F=B.status==="APPROVED",W=F?"#ecfdf5":"#fef2f2",z=F?"#065f46":"#991b1b",se=F?"#10b98133":"#ef444433";return a.jsxs("div",{onClick:()=>p({kind:"history",item:B}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#f9fafb",border:"1px solid #e5e7eb",display:"grid",placeItems:"center",fontWeight:950,color:"#111827"},children:b(E)}),a.jsxs("div",{style:{flex:1,minWidth:220},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:E}),T?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",T]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[B.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:B.subject_name||B.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",B.assessment.toUpperCase(),"  Reviewed ",v(B.reviewed_at)]})]}),a.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:a.jsx("div",{style:{background:W,color:z,border:`1px solid ${se}`,padding:"4px 10px",borderRadius:999,fontSize:12,fontWeight:900,whiteSpace:"nowrap"},children:F?"Approved":"Rejected"})})]},B.id)})})]})]}),h?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>p(null),children:a.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:16},onClick:B=>B.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Request Details"}),a.jsx("div",{style:{marginLeft:"auto"},children:a.jsx("button",{className:"obe-btn",onClick:()=>p(null),children:"Close"})})]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#f9fafb"},children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"160px 1fr",rowGap:8,columnGap:10,fontSize:13},children:[a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Status"}),a.jsx("div",{style:{color:"#111827",fontWeight:900},children:h.item.status}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Staff"}),a.jsxs("div",{style:{color:"#111827",fontWeight:900},children:[String(((k=h.item.staff)==null?void 0:k.name)||((j=h.item.staff)==null?void 0:j.username)||"Unknown"),(A=h.item.staff)!=null&&A.department?a.jsxs("span",{style:{color:"#6b7280",fontWeight:700},children:["  ",h.item.staff.department]}):null]}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Subject"}),a.jsxs("div",{style:{color:"#111827"},children:[a.jsx("span",{style:{fontWeight:900},children:h.item.subject_code}),"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:h.item.subject_name||h.item.subject_code})]}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Assessment"}),a.jsx("div",{style:{color:"#111827",fontWeight:900},children:h.item.assessment.toUpperCase()}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Requested At"}),a.jsx("div",{style:{color:"#111827"},children:v(h.item.requested_at)}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reason"}),a.jsx("div",{style:{color:"#111827",whiteSpace:"pre-wrap"},children:h.item.reason||""}),"reviewed_at"in h.item?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed At"}),a.jsx("div",{style:{color:"#111827"},children:v(h.item.reviewed_at)}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed By"}),a.jsx("div",{style:{color:"#111827"},children:String(((L=h.item.reviewed_by)==null?void 0:L.name)||((P=h.item.reviewed_by)==null?void 0:P.username)||"")}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Approved Until"}),a.jsx("div",{style:{color:"#111827"},children:v(h.item.approved_until)})]}):null]})})]})}):null]})}const X8=[1,2,3,4,5,6,7,8],Are=["THEORY","LAB","TCPL","TCPR","PRACTICAL","PROJECT","AUDIT","SPECIAL"],Af={THEORY:"Theory",LAB:"Lab",TCPL:"TCPL",TCPR:"TCPR",PRACTICAL:"Practical",PROJECT:"Project",AUDIT:"Audit",SPECIAL:"Special"},Nre=["ssa1","formative1","cia1","ssa2","formative2","cia2","model"],Cre=["ssa1","review1","cia1","ssa2","review2","cia2","model"],Ere=["cia1","cia2","model"],Tre=["cia1","cia2","model"],Pre=["review1","review2","model"],Q8=["ssa1","formative1","cia1","ssa2","formative2","cia2"],Tu=["ssa1","review1","formative1","cia1","ssa2","review2","formative2","cia2","model"];function J8(e){var l;const{controls:t,semesterIds:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const i=new Set(r.map(c=>Number(c))),s=new Map;for(const c of t||[]){const u=Number((l=c==null?void 0:c.semester)==null?void 0:l.id);if(!Number.isFinite(u)||!i.has(u))continue;const d=String((c==null?void 0:c.assessment)||"").trim().toLowerCase();d&&s.set(`${u}::${d}`,!!(c!=null&&c.is_open))}const o=new Set;for(const c of r)for(const u of n){const d=`${Number(c)}::${String(u).toLowerCase()}`;if(!s.has(d))o.add("ON");else{const f=!!s.get(d);o.add(f?"UNLIMITED":"OFF")}}return o.size===1?Array.from(o)[0]:"MIXED"}function Ore(e,t){if(e==="LAB")return Ere;if(e==="TCPR")return Cre;if(e==="PRACTICAL")return Tre;if(e==="PROJECT")return Pre;if(e==="SPECIAL"){const r=[];for(const o of t){const l=Array.isArray(o==null?void 0:o.enabled_assessments)?o.enabled_assessments:[];for(const c of l)r.push(String(c||"").trim().toLowerCase())}const n=F4(r).filter(Boolean);if(!n.length)return[];const i=new Set(Q8),s=[];for(const o of Q8)n.includes(String(o))&&s.push(o);for(const o of n)i.has(o)&&!s.includes(o)&&s.push(o);return s}return Nre}function Z8(e,t){if(e==="TCPL"){if(t==="formative1")return"LAB 1";if(t==="formative2")return"LAB 2"}if(e==="LAB"){if(t==="cia1")return"CIA 1 LAB";if(t==="cia2")return"CIA 2 LAB";if(t==="model")return"MODEL LAB"}if(e==="PRACTICAL"){if(t==="cia1")return"CIA 1 Review";if(t==="cia2")return"CIA 2 Review";if(t==="model")return"MODEL Review"}return e==="PROJECT"&&t==="model"?"MODEL Review":t==="ssa1"?"SSA1":t==="ssa2"?"SSA2":t==="review1"?"Review 1":t==="review2"?"Review 2":t==="formative1"?"Formative 1":t==="formative2"?"Formative 2":t==="cia1"?"CIA 1":t==="cia2"?"CIA 2":t==="model"?"MODEL":String(t).toUpperCase()}function Mre(e){const t=String(e||"").trim().toUpperCase();return t==="THEORY"?"THEORY":t==="LAB"?"LAB":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t==="PRACTICAL"?"PRACTICAL":t==="PROJECT"?"PROJECT":t==="AUDIT"?"AUDIT":t==="SPECIAL"?"SPECIAL":"THEORY"}function Lre(e,t){const r=String(e||"").trim(),n=String(t||"").trim();return!r||!n?null:`${r}T${n}:00`}function F4(e){const t=new Set,r=[];for(const n of e)t.has(n)||(t.add(n),r.push(n));return r}function Rre(e){const{controls:t,subjectCodes:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const i=new Map;for(const l of t||[]){const c=String(l.subject_code||"").trim(),u=String(l.assessment||"").trim().toLowerCase();!c||!u||i.set(`${c}::${u}`,{is_open:!!l.is_open,is_enabled:!!l.is_enabled})}let s=0,o=0;for(const l of r)for(const c of n){const u=`${l}::${String(c).toLowerCase()}`,d=i.get(u);(d?!!d.is_open:!0)?s+=1:o+=1}return s>0&&o>0?"MIXED":o>0?"READONLY":"EDITABLE"}function j3(){const[e,t]=x.useState([]),[r,n]=x.useState(1),[i,s]=x.useState({}),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[h,p]=x.useState([]),[m,g]=x.useState("THEORY"),[y,b]=x.useState([]),[v,w]=x.useState(""),[S,k]=x.useState(""),[j,A]=x.useState(!1),[L,P]=x.useState(null),[B,E]=x.useState(null),T=x.useCallback(le=>({padding:"8px 12px",borderRadius:8,border:le?"1px solid #10b981":"1px solid #e5e7eb",background:le?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer",whiteSpace:"nowrap"}),[]);x.useEffect(()=>{let le=!0;return(async()=>{try{const O=await h9(),H=Array.isArray(O==null?void 0:O.results)?O.results:[];if(!le)return;const ae=H.map(I=>({id:Number(I.id),number:(I==null?void 0:I.number)===null||typeof(I==null?void 0:I.number)>"u"?null:Number(I.number)})).filter(I=>Number.isFinite(I.id));ae.sort((I,Z)=>Number(I.number??9999)-Number(Z.number??9999)||I.id-Z.id),t(ae)}catch(O){if(!le)return;E((O==null?void 0:O.message)||"Failed to load semesters")}})(),()=>{le=!1}},[]);const F=x.useMemo(()=>{const le=new Map;for(const O of e){const H=O.number;typeof H=="number"&&Number.isFinite(H)&&le.set(H,O.id)}return le},[e]),W=F.get(r)??null,z=x.useMemo(()=>{const le=[];for(const O of X8){const H=F.get(O);H&&le.push(H)}return le},[F]);x.useEffect(()=>{let le=!0;return(async()=>{try{if(!z.length)return;const O=await dx(z,Tu);if(!le)return;p(Array.isArray(O==null?void 0:O.results)?O.results:[])}catch{}})(),()=>{le=!1}},[z.join(",")]);const se=x.useCallback(async()=>{A(!0),P(null),E(null);try{if(!W){s({}),l([]),u([]),f([]),P(`Semester ${r} is not available in the database.`);return}const[le,O,H,ae]=await Promise.all([p9([W]),R4([W]),Wv([W]),dx([W],Tu)]),I=(le==null?void 0:le.subjects_by_semester)||{},Z=Array.isArray(O==null?void 0:O.results)?O.results:[];s(I),l(Z),u(Array.isArray(H==null?void 0:H.results)?H.results:[]),f(Array.isArray(ae==null?void 0:ae.results)?ae.results:[])}catch(le){E((le==null?void 0:le.message)||"Failed to load semester data")}finally{A(!1)}},[W,r,m]);x.useEffect(()=>{se()},[se]);const de=x.useMemo(()=>{if(!W)return[];const le=(i==null?void 0:i[String(W)])||[];return(Array.isArray(le)?le:[]).filter(O=>O&&O.subject_code)},[i,W]),U=x.useMemo(()=>Are.slice(),[]);x.useEffect(()=>{U.includes(m)||g(U[0]||"THEORY")},[U.join("|")]);const G=x.useMemo(()=>de.filter(le=>Mre(le==null?void 0:le.class_type)===m),[de,m]),re=x.useMemo(()=>F4(G.map(le=>String(le.subject_code||"").trim()).filter(Boolean)),[G]),X=x.useMemo(()=>F4(de.map(le=>String(le.subject_code||"").trim()).filter(Boolean)),[de]),C=x.useMemo(()=>Ore(m,G),[m,G]);x.useEffect(()=>{var Z;const le=C;if(!le.length){b([]);return}if(!W){b(le);return}const O=new Set(re),H=new Map;for(const pe of c||[]){const Oe=String(pe.subject_code||"").trim();if(!O.has(Oe))continue;const Ae=String(pe.assessment||"").trim().toLowerCase();Ae&&H.set(Ae,!!pe.is_enabled)}const ae=new Set;for(const pe of o||[])pe!=null&&pe.is_active&&(!((Z=pe==null?void 0:pe.semester)!=null&&Z.id)||Number(pe.semester.id)!==Number(W)||O.has(String(pe.subject_code||"").trim())&&ae.add(String(pe.assessment||"").trim().toLowerCase()));const I=le.filter(pe=>{const Oe=String(pe).toLowerCase();return H.has(Oe)?!!H.get(Oe):ae.has(Oe)});b(I)},[W,m,c,o,C,re]);const K=x.useMemo(()=>Rre({controls:c,subjectCodes:re,assessments:y}),[c,re,y]),V=x.useMemo(()=>W?J8({controls:d,semesterIds:[W],assessments:Tu}):"MIXED",[d,W]),R=x.useMemo(()=>z.length?J8({controls:h,semesterIds:z,assessments:Tu}):"MIXED",[h,z.join(",")]),J=x.useCallback(async(le,O)=>{A(!0),P(null),E(null);try{const H=O==="ALL"?z:W?[W]:[];if(!H.length)throw new Error("No semester ids available for this action.");if(le==="ON"?await f9({semester_ids:H,assessments:Tu}):le==="OFF"?await M4({semester_ids:H,assessments:Tu,is_open:!1}):await M4({semester_ids:H,assessments:Tu,is_open:!0}),W){const ae=await dx([W],Tu);f(Array.isArray(ae==null?void 0:ae.results)?ae.results:[])}if(z.length){const ae=await dx(z,Tu);p(Array.isArray(ae==null?void 0:ae.results)?ae.results:[])}P(`${O==="ALL"?"All Semesters":`SEM ${r}`}: Publish set to ${le==="ON"?"On (Timed)":le==="OFF"?"Off (Locked)":"Unlimited (No Time Limit)"}.`)}catch(H){E((H==null?void 0:H.message)||"Publish toggle failed")}finally{A(!1)}},[z,W,r]),q=x.useCallback(async le=>{const O=!y.includes(le),H=y;b(ae=>O?[...ae,le]:ae.filter(I=>I!==le)),A(!0),P(null),E(null);try{if(!W)throw new Error(`Semester ${r} is not available in the database.`);if(!re.length)throw new Error(`No courses found for SEM ${r} (${Af[m]}).`);await L4({semester_id:W,subject_codes:re,assessments:[le],is_enabled:O}),O||await g9({semester_id:W,subject_codes:re,assessments:[le]});const[ae,I]=await Promise.all([Wv([W]),R4([W])]);u(Array.isArray(ae==null?void 0:ae.results)?ae.results:[]),l(Array.isArray(I==null?void 0:I.results)?I.results:[]),P(`SEM ${r}  ${Af[m]}: ${Z8(m,le)} ${O?"enabled":"disabled"}.`)}catch(ae){b(H),E((ae==null?void 0:ae.message)||"Update failed")}finally{A(!1)}},[y,W,r,m,re]),Y=x.useCallback(async()=>{A(!0),P(null),E(null);try{if(!W)throw new Error(`Semester ${r} is not available in the database.`);if(!X.length)throw new Error(`No courses found for SEM ${r}.`);if(V!=="ON")throw new Error(V==="OFF"?"Publish is OFF (Locked). Set Publish to ON to use a timer.":V==="UNLIMITED"?"Publish is UNLIMITED (No Time Limit). Set Publish to ON to use a due-date timer.":"Publish mode is MIXED. Set a single Publish mode first.");const le=Lre(v,S);if(!le)throw new Error("Select Due Date and Due Time");await m9({semester_id:W,subject_codes:X,assessments:Tu,due_at:le}),P(`SEM ${r}: Timer applied to all class types.`),await se()}catch(le){E((le==null?void 0:le.message)||"Save failed")}finally{A(!1)}},[W,r,X,v,S,se,V]),Q=x.useCallback(async le=>{A(!0),P(null),E(null);try{if(!W)throw new Error(`Semester ${r} is not available in the database.`);if(!y.length)throw new Error("Select at least one exam/assessment");if(!re.length)throw new Error(`No courses found for SEM ${r} (${Af[m]}).`);await L4({semester_id:W,subject_codes:re,assessments:y,is_open:le});const O=await Wv([W]);u(Array.isArray(O==null?void 0:O.results)?O.results:[]),P(`SEM ${r}  ${Af[m]}: ${le?"Editable":"Read-only"}`)}catch(O){E((O==null?void 0:O.message)||"Lock toggle failed")}finally{A(!1)}},[W,r,y,m,re]),ie=le=>{const O=le==="THIS"?V:R,H=le==="THIS"&&R==="OFF",ae=j||le==="ALL"&&!z.length||H;return a.jsxs("div",{className:`pub3${ae?" pub3--disabled":""}`,title:H?"Locked by Common Publish (Off)":void 0,children:[a.jsx("button",{className:`pub3__btn pub3__btn--off${O==="OFF"?" pub3__btn--active":""}`,onClick:()=>void J("OFF",le),disabled:ae,children:"Off"}),a.jsx("button",{className:`pub3__btn pub3__btn--on${O==="ON"?" pub3__btn--active":""}`,onClick:()=>void J("ON",le),disabled:ae,children:"On"}),a.jsx("button",{className:`pub3__btn pub3__btn--unlimited${O==="UNLIMITED"?" pub3__btn--active":""}`,onClick:()=>void J("UNLIMITED",le),disabled:ae,children:"Unlimited"})]})};return a.jsxs("main",{style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#f3f4f6"},children:[a.jsx("style",{children:`
        /*  Neon 3-state publish switch  */
        .pub3 {
          display: inline-flex;
          border-radius: 999px;
          background: #0f172a;
          padding: 4px;
          gap: 3px;
          box-shadow: 0 0 0 1px #1e293b, 0 4px 12px rgba(0,0,0,0.55);
        }
        .pub3--disabled { opacity: 0.4; pointer-events: none; }
        .pub3__btn {
          padding: 8px 18px;
          border-radius: 999px;
          border: none;
          font-weight: 900;
          font-size: 13px;
          cursor: pointer;
          background: transparent;
          color: #64748b;
          transition: background 0.35s cubic-bezier(0.65,0,0.35,1),
                      color 0.35s cubic-bezier(0.65,0,0.35,1),
                      box-shadow 0.35s cubic-bezier(0.65,0,0.35,1);
          letter-spacing: 0.02em;
          min-width: 64px;
        }
        .pub3__btn:disabled { cursor: not-allowed; }
        .pub3__btn--off.pub3__btn--active {
          background: #450a0a;
          color: #fca5a5;
          box-shadow: 0 0 6px #ef4444, 0 0 18px #ef444455, inset 0 0 8px #ef444418;
        }
        .pub3__btn--on.pub3__btn--active {
          background: #052e16;
          color: #86efac;
          box-shadow: 0 0 6px #22c55e, 0 0 18px #22c55e55, inset 0 0 8px #22c55e18;
        }
        .pub3__btn--unlimited.pub3__btn--active {
          background: #1e3a8a;
          color: #93c5fd;
          box-shadow: 0 0 6px #3b82f6, 0 0 18px #3b82f655, inset 0 0 8px #3b82f618;
        }
      `}),a.jsxs("div",{style:{padding:20,maxWidth:1100,margin:"0 auto"},children:[a.jsx("div",{className:"welcome",style:{marginBottom:18},children:a.jsxs("div",{className:"welcome-left",children:[a.jsx("h2",{className:"welcome-title",style:{fontSize:22,marginBottom:2},children:"OBE Master  Lock & Timer Controls"}),a.jsx("div",{className:"welcome-sub",children:"Common Publish  Semester  Publish & Timer  Class Type  Exams"})]})}),B&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:B}),L&&a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:L}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"16px 20px",marginBottom:16,display:"flex",alignItems:"center",gap:20,flexWrap:"wrap"},children:[a.jsxs("div",{style:{flex:"0 0 auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:14,marginBottom:4,color:"#111827"},children:"Common Publish  All Semesters"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Applies the same publish mode to every semester at once."})]}),a.jsxs("div",{style:{flex:"1 1 auto",display:"flex",alignItems:"center",gap:14,flexWrap:"wrap"},children:[ie("ALL"),a.jsx("span",{style:{fontSize:13,fontWeight:700,color:R==="OFF"?"#991b1b":R==="ON"?"#065f46":R==="UNLIMITED"?"#1e40af":"#6b7280"},children:R==="OFF"?"All Locked":R==="ON"?"All Timer-based":R==="UNLIMITED"?"All Unlimited":"Mixed"})]})]}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"14px 18px",marginBottom:0,borderBottomLeftRadius:0,borderBottomRightRadius:0,borderBottom:"2px solid #10b981"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:10,textTransform:"uppercase",letterSpacing:1},children:"Select Semester"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:X8.map(le=>a.jsxs("button",{disabled:j,onClick:()=>n(le),style:T(le===r),children:["SEM ",le]},le))})]}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderTop:0,borderRadius:14,borderTopLeftRadius:0,borderTopRightRadius:0,padding:"18px 20px",marginBottom:16},children:[a.jsxs("div",{style:{display:"flex",gap:18,alignItems:"center",flexWrap:"wrap",marginBottom:18,paddingBottom:16,borderBottom:"1px solid #f3f4f6"},children:[a.jsxs("div",{style:{flex:"0 0 auto"},children:[a.jsxs("div",{style:{fontWeight:900,fontSize:13,marginBottom:6,color:"#111827"},children:["Publish  SEM ",r]}),ie("THIS")]}),R==="OFF"?a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px 16px",borderRadius:10,background:"#fef2f2",border:"1px solid #fecaca",color:"#991b1b",fontWeight:800,fontSize:13},children:[a.jsx("span",{style:{fontSize:16},children:""})," Locked  Common Publish is Off"]}):V==="ON"?a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",flex:"1 1 auto"},children:[a.jsx("input",{type:"date",value:v,onChange:le=>w(le.target.value),disabled:j,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),a.jsx("input",{type:"time",value:S,onChange:le=>k(le.target.value),disabled:j,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),a.jsx("button",{onClick:()=>void Y(),disabled:j,className:"obe-btn obe-btn-primary",style:{padding:"9px 16px",borderRadius:8,fontWeight:900,fontSize:13},children:j?"Saving":`Apply Timer  SEM ${r}`}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["All ",X.length," subjects  all class types"]})]}):V==="UNLIMITED"?a.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#eff6ff",color:"#1e40af",fontWeight:800,border:"1px solid #bfdbfe",fontSize:13},children:" No Time Limit  always open"}):V==="OFF"?a.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#fef2f2",color:"#991b1b",fontWeight:800,border:"1px solid #fecaca",fontSize:13},children:" This semester locked"}):null]}),a.jsxs("div",{style:{marginBottom:14},children:[a.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Class Type"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:U.map(le=>a.jsx("button",{disabled:j,onClick:()=>g(le),style:T(le===m),children:Af[le]},le))}),a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:[G.length," course",G.length!==1?"s":""," in SEM ",r,"  ",Af[m]]})]}),a.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:"14px 16px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,flexWrap:"wrap",gap:8},children:[a.jsxs("div",{style:{fontWeight:900,fontSize:14,color:"#111827"},children:["SEM ",r,"  ",Af[m]," Exams"]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Mark Entry Mode:"}),a.jsxs("div",{style:{display:"inline-flex",border:"1px solid #e5e7eb",borderRadius:999,overflow:"hidden",background:"#fff"},children:[a.jsx("button",{onClick:()=>void Q(!1),disabled:j||!y.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:K==="READONLY"?"#fee2e2":"#fff",color:K==="READONLY"?"#991b1b":"#374151",minWidth:100},children:"Read-only"}),a.jsx("button",{onClick:()=>void Q(!0),disabled:j||!y.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:K==="EDITABLE"?"#dcfce7":"#fff",color:K==="EDITABLE"?"#065f46":"#374151",minWidth:90},children:"Editable"})]})]})]}),C.length?a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:C.map(le=>a.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center",fontSize:13,padding:"8px 14px",borderRadius:10,border:`2px solid ${y.includes(le)?"#10b981":"#e5e7eb"}`,background:y.includes(le)?"#ecfdf5":"#fff",color:y.includes(le)?"#065f46":"#374151",cursor:"pointer",userSelect:"none",fontWeight:700},children:[a.jsx("input",{type:"checkbox",checked:y.includes(le),onChange:()=>void q(le),disabled:j,style:{accentColor:"#10b981",width:15,height:15}}),Z8(m,le)]},le))}):a.jsxs("div",{style:{color:"#6b7280",fontSize:13,padding:"8px 0"},children:["No exams configured for ",Af[m],"."]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Uncheck an exam to hide it from staff (message-only). Selected exams also control the Mark Entry Mode lever above."})]})]})]})]})}const lf="https://db.krgi.co.in";async function Kd(){const e=await yr(`${lf}/api/curriculum/master/`);if(!e.ok)throw new Error("Failed to fetch masters");return e.json()}async function Bre(e){const t=await yr(`${lf}/api/curriculum/master/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function Fre(e,t){const r=await yr(`${lf}/api/curriculum/master/${e}/`,{method:"PATCH",body:JSON.stringify(t)});try{if(!r.ok){const n=r.headers.get("content-type");if(n&&n.includes("application/json")){const i=await r.json();throw new Error(i.detail||"An error occurred")}else throw new Error(await r.text())}return r.json()}catch(n){throw console.error("Error in updateMaster:",n),n}}async function bl(){const e=await yr(`${lf}/api/curriculum/department/`);if(!e.ok)throw new Error("Failed to fetch dept rows");return e.json()}async function A3(e){const t=await yr(`${lf}/api/curriculum/department/${encodeURIComponent(String(e))}/`);if(!t.ok)throw new Error("Failed to fetch dept row");return t.json()}async function hm(e){const t=new URLSearchParams;e!=null&&e.department_id&&t.set("department_id",String(e.department_id)),e!=null&&e.regulation&&t.set("regulation",e.regulation),e!=null&&e.semester&&t.set("semester",String(e.semester));const r=`${lf}/api/curriculum/elective/?${t.toString()}`,n=await yr(r);if(!n.ok)throw new Error("Failed to fetch electives");return n.json()}async function Ire(e){const t=await yr(`${lf}/api/curriculum/elective/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function Dre(e,t){const r=await yr(`${lf}/api/curriculum/department/${e}/`,{method:"PATCH",body:JSON.stringify(t)});if(!r.ok)throw new Error(await r.text());return r.json()}async function $re(e,t){const r=await yr(`${lf}/api/curriculum/department/${e}/approve/`,{method:"POST",body:JSON.stringify({action:t})});if(!r.ok)throw new Error(await r.text());return r.json()}function zg(e){return String(e||"").trim()}function Ure(){const e=go(),[t,r]=x.useState([]),[n,i]=x.useState(!0),[s,o]=x.useState(null),[l,c]=x.useState("");x.useEffect(()=>{let f=!0;return(async()=>{try{const h=await bl();if(!f)return;r(Array.isArray(h)?h:[]),o(null)}catch(h){if(!f)return;r([]),o((h==null?void 0:h.message)||"Failed to load courses")}finally{f&&i(!1)}})(),()=>{f=!1}},[]);const u=x.useMemo(()=>{const f=new Map;for(const h of t||[]){const p=zg(h.course_code);if(!p)continue;const m={course_code:p,course_name:zg(h.course_name),class_type:zg(h.class_type)||null,question_paper_type:zg(h.question_paper_type)||null},g=f.get(p);if(!g){f.set(p,m);continue}const y=b=>(b.course_name?1:0)+(b.class_type?1:0)+(b.question_paper_type?1:0)+(String(b.question_paper_type||"").trim().toUpperCase()&&String(b.question_paper_type||"").trim().toUpperCase()!=="QP1"?1:0);y(m)>y(g)&&f.set(p,m)}return Array.from(f.values()).sort((h,p)=>h.course_code.localeCompare(p.course_code))},[t]),d=x.useMemo(()=>{const f=zg(l).toLowerCase();return f?u.filter(h=>`${h.course_code} ${h.course_name}`.toLowerCase().includes(f)):u},[u,l]);return n?a.jsx("div",{style:{color:"#6b7280"},children:"Loading courses"}):s?a.jsx("div",{style:{color:"#b91c1c"},children:s}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"Courses"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Search and open a course to view sections and staff mappings."})]}),a.jsxs("div",{style:{minWidth:280},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Search"}),a.jsx("input",{value:l,onChange:f=>c(f.target.value),placeholder:"Course code or name",className:"obe-input"})]})]}),d.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No courses found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:12},children:d.map(f=>a.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:8},children:[a.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:f.course_code}),a.jsx("div",{style:{color:"#374151",fontWeight:700},children:f.course_name||""}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[f.class_type?`Class type: ${f.class_type}`:"",f.question_paper_type?`    QP: ${f.question_paper_type}`:""]}),a.jsx("div",{style:{marginTop:6},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>e(`/iqac/academic-controller/course/${encodeURIComponent(f.course_code)}`),children:"Open"})})]},f.course_code))})]})}function zre(){var L;const e=x.useMemo(()=>[{key:"THEORY_QP1",label:"Theory QP 1",class_type:"THEORY",question_paper_type:"QP1"},{key:"THEORY_QP2",label:"Theory QP 2",class_type:"THEORY",question_paper_type:"QP2"},{key:"TCPR",label:"TCPR",class_type:"TCPR"},{key:"TCPL",label:"TCPL",class_type:"TCPL"},{key:"LAB",label:"LAB",class_type:"LAB"}],[]),[t,r]=x.useState(((L=e[0])==null?void 0:L.key)||""),n=x.useMemo(()=>e.find(P=>P.key===t)||null,[e,t]),[i,s]=x.useState("CIA1"),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(!1),[m,g]=x.useState(!1),[y,b]=x.useState(null),v=x.useMemo(()=>{const P=(n==null?void 0:n.class_type)||"THEORY",B=(n==null?void 0:n.question_paper_type)||null;return{class_type:P,question_paper_type:B,exam:i}},[n,i]);x.useEffect(()=>{let P=!1;async function B(){var E,T;u(null),f(null),p(!0),b(null);try{const F=await ih(v);if(P)return;const W=Array.isArray((E=F==null?void 0:F.pattern)==null?void 0:E.marks)?F.pattern.marks:[],z=Array.isArray((T=F==null?void 0:F.pattern)==null?void 0:T.cos)?F.pattern.cos:[],se=W.map((de,U)=>({marks:String(de),co:z[U]==null?"":String(z[U])}));l(se),b((F==null?void 0:F.updated_at)??null)}catch(F){if(P)return;f(String((F==null?void 0:F.message)||F||"Failed to load pattern.")),l([])}finally{P||p(!1)}}return B(),()=>{P=!0}},[v]);const w=()=>{l(P=>[...P,{marks:"",co:i==="CIA2"?"3":"1"}])},S=P=>{l(B=>B.filter((E,T)=>T!==P))},k=(P,B)=>{l(E=>{const T=[...E],F=T[P]||{marks:"",co:""};return T[P]={...F,marks:B},T})},j=(P,B)=>{l(E=>{const T=[...E],F=T[P]||{marks:"",co:""};return T[P]={...F,co:B},T})},A=async()=>{u(null),f(null);try{const P=o.map(W=>({marks:String(W.marks??"").trim(),co:String((W==null?void 0:W.co)??"").trim()}));if(P.length&&P.some(W=>!W.marks||!W.co)){f("Enter marks and CO for all rows (or delete empty rows).");return}for(const W of P){const z=Number(W.marks);if(!Number.isFinite(z)||z<0){f("Marks must be a non-negative number.");return}}const B=W=>{const z=String(W||"").trim();if(!z)return"";if(z==="both")return"both";if(z==="1&2")return 12;if(z==="3&4")return 34;const se=Number(z);return Number.isFinite(se)?Math.trunc(se):""};g(!0);const E=P.map(W=>Number(W.marks)),T=P.map(W=>B(W.co)).filter(W=>W!=="");if(T.length!==E.length){f("CO values must be valid for all rows.");return}const F=await y9({class_type:v.class_type,question_paper_type:v.question_paper_type,exam:v.exam,pattern:{marks:E,cos:T}});b((F==null?void 0:F.updated_at)??null),u("Saved.")}catch(P){f((P==null?void 0:P.message)||"Save failed.")}finally{g(!1)}};return a.jsxs("div",{children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"QP"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Select the QP/class type option."})]}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:e.map(P=>{const B=P.key===t;return a.jsx("button",{onClick:()=>r(P.key),className:B?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:P.label},P.key)})}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:["CIA1","CIA2","MODEL"].map(P=>{const B=i===P;return a.jsx("button",{onClick:()=>s(P),className:B?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:P==="CIA1"?"CIA 1":P==="CIA2"?"CIA 2":"MODEL"},P)})}),n?a.jsxs("div",{className:"obe-card",style:{padding:12},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:800,marginBottom:6},children:"Selected"}),a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:n.label}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#374151"},children:["Class type: ",a.jsx("strong",{children:n.class_type}),n.question_paper_type?a.jsxs(a.Fragment,{children:[" "," QP: ",a.jsx("strong",{children:n.question_paper_type})]}):null," "," Exam: ",a.jsx("strong",{children:i==="CIA1"?"CIA 1":i==="CIA2"?"CIA 2":"MODEL"})]}),h?a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Loading saved pattern"}):y?a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:["Last saved: ",new Date(y).toLocaleString()]}):null]}):null,a.jsxs("div",{className:"obe-card",style:{padding:12,marginTop:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"baseline",flexWrap:"wrap",marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:"QP Pattern"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[i==="CIA1"?"CIA 1":i==="CIA2"?"CIA 2":"MODEL","  ",(n==null?void 0:n.label)||t]})]}),d?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:d}):null,c?a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:10},children:c}):null,a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"S.No"}),a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"Marks"}),a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"CO"}),a.jsx("th",{style:{width:120,borderBottom:"1px solid #e5e7eb"}})]})}),a.jsx("tbody",{children:o.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,style:{padding:10,color:"#6b7280"},children:"No questions yet. Click + to add."})}):o.map((P,B)=>a.jsxs("tr",{children:[a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6",fontWeight:800},children:B+1}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsx("input",{className:"obe-input",type:"number",min:0,step:"0.5",value:P.marks,onChange:E=>k(B,E.target.value),placeholder:"Marks",style:{maxWidth:160}})}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsxs("select",{className:"obe-input",value:String((P==null?void 0:P.co)??""),onChange:E=>j(B,E.target.value),style:{maxWidth:160},children:[a.jsx("option",{value:"",children:"Select"}),i==="MODEL"?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"})]}):i==="CIA2"?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"3&4",children:"3&4"})]}):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"1&2",children:"1&2"})]})]})}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsx("button",{type:"button",className:"obe-btn obe-btn-danger",onClick:()=>S(B),children:"Delete"})})]},B))})]})}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:12},children:[a.jsx("button",{type:"button",className:"obe-btn obe-btn-secondary",onClick:w,children:"+"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",onClick:A,disabled:m,children:m?"Saving":"Save"})]})]})]})}const Zp=["Theory","Lab","Tcpl","Tcpr","Practical","Project","Audit","Special"];function ti(e){return String(e??"").trim().toUpperCase()}function N3(e){const t=ti(e);return t?!!(t==="LAB"||t==="L"||t.startsWith("LAB")||t.includes("LAB")||t.includes("PRACTICAL")||t.includes("PRACT")):!1}function Wre(e){return ti(e)==="SPECIAL"}function Jn(e){try{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}}function Gn(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch{}}function Pu(e){try{window.localStorage.removeItem(e)}catch{}}const qu=[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],qre=["THEORY","TCPR","TCPL","LAB","AUDIT","PRACTICAL","SPECIAL"],K5=6,Hre=64;function Vre(e){const t=ti(e);return t==="THEORY"?"Theory":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""}function I9(e){const t=Array.isArray(e)?[...e]:[...qu];for(;t.length<17;)t.push("");return t.slice(0,17)}function eP(e,t,r,n){const i=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(i)||i<=0||!c)return[0,0,0];const u=Math.round(i*(s||0)/c*100)/100,d=Math.round(i*(o||0)/c*100)/100,f=Math.round(i*(l||0)/c*100)/100;return[u,d,f]}function Y5(e,t){let r=Array.isArray(e)?[...e]:[...qu];if(r.length===13){const[n,i,s]=eP(r[0]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5),[o,l,c]=eP(r[1]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5);r=[n,i,s,o,l,c,...r.slice(2)]}return r=I9(r),r}function Gre(e){const t=ti(e);if(t==="LAB"||t==="PRACTICAL")return[{header:"CO1",cols:[{label:"CIA 1",index:1}]},{header:"CO2",cols:[{label:"CIA 1",index:4}]},{header:"CO3",cols:[{label:"CIA 2",index:7}]},{header:"CO4",cols:[{label:"CIA 2",index:10}]},{header:"ME",cols:[{label:"MODEL",index:16}]}];const r=o=>t==="TCPR"?o===1||o===2?"Review 1":"Review 2":t==="TCPL"?o===1||o===2?"LAB 1":"LAB 2":o===1||o===2?"Formative 1":"Formative 2",n=o=>o===1||o===2?"CIA 1":"CIA 2",i=o=>o===1||o===2?"SSA 1":"SSA 2",s=(o,l)=>({header:`CO${o}`,cols:[{label:i(o),index:l},{label:n(o),index:l+1},{label:r(o),index:l+2}]});return[s(1,0),s(2,3),s(3,6),s(4,9),{header:"ME",cols:[{label:"CO1",index:12},{label:"CO2",index:13},{label:"CO3",index:14},{label:"CO4",index:15},{label:"CO5",index:16}]}]}function Kre(){const[e,t]=x.useState({}),[r,n]=x.useState(!1),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(null);x.useEffect(()=>{n(!0),l(null),(async()=>{const p=()=>{const g={};for(const y of Zp){const b=ti(String(y));let v=1.5,w=3,S=2.5;b==="TCPL"?(v=1,w=3.25,S=3.5):b==="TCPR"?(v=1,w=3.25,S=4):b==="LAB"&&(v=1,w=1,S=1);let k=[...qu];if(b==="THEORY")k=[...qu];else if(b==="TCPL"){k=[];for(let j=0;j<4;j++)k.push(v,w,S);k.push(3,3,3,3,7)}else if(b==="TCPR"){k=[];for(let j=0;j<4;j++)k.push(v,w,S);k.push(3,3,3,3,10)}g[b]={ssa1:v,cia1:w,formative1:S,internal_mark_weights:k}}return g.THEORY||(g.THEORY={ssa1:1.5,cia1:3,formative1:2.5,internal_mark_weights:[...qu]}),g},m=g=>{const y=p();if(!g||typeof g!="object")return y;const b={...y},v=Array.from(new Set([...Zp.map(S=>ti(String(S))),"THEORY"])),w=g.THEORY??g.Theory??g.theory??null;w&&typeof w=="object"&&(g.THEORY=w);for(const S of v){const k=g[S]??g[String(S)]??g[String(S).toUpperCase()]??null;if(!k||typeof k!="object")continue;const j=Array.isArray(k.internal_mark_weights)?k.internal_mark_weights:null,A={ssa1:k.ssa1??b[S].ssa1,cia1:k.cia1??b[S].cia1,formative1:k.formative1??b[S].formative1};b[S]={ssa1:A.ssa1,cia1:A.cia1,formative1:A.formative1,internal_mark_weights:Y5(j&&j.length?j:b[S].internal_mark_weights,A)}}return b};try{const y=await(await dm(()=>Promise.resolve().then(()=>Y8),void 0)).fetchClassTypeWeights(),b=m(y);t(b);return}catch{}try{const g=Jn("iqac_class_type_weights"),y=m(g);t(y)}catch{const g=p();t(g)}finally{n(!1)}})().finally(()=>n(!1))},[]);const d=(p,m,g)=>{t(y=>({...y,[p]:{...y[p],[m]:g}}))},f=(p,m,g)=>{t(y=>{const b=y[p]||{ssa1:"",cia1:"",formative1:"",internal_mark_weights:[...qu]},v=Array.isArray(b.internal_mark_weights)?[...b.internal_mark_weights]:[...qu];for(;v.length<17;)v.push("");return v[m]=g,{...y,[p]:{...b,internal_mark_weights:v}}})},h=async()=>{s(!0),l(null),u(null);try{const p={},m=Array.from(new Set([...Zp.map(y=>ti(String(y))),"THEORY"]));for(const y of m){const b=e[y]??e[y.toLowerCase()]??e[y.toUpperCase()]??{},v=Y5(Array.isArray(b==null?void 0:b.internal_mark_weights)?b.internal_mark_weights:qu,{ssa1:b==null?void 0:b.ssa1,cia1:b==null?void 0:b.cia1,formative1:b==null?void 0:b.formative1});p[y]={ssa1:Number(b==null?void 0:b.ssa1)||0,cia1:Number(b==null?void 0:b.cia1)||0,formative1:Number(b==null?void 0:b.formative1)||0,internal_mark_weights:I9(v).map((w,S)=>{const k=Number(w);return Number.isFinite(k)?k:qu[S]??0})}}p.THEORY||(p.THEORY=p.THEORY||null);let g=!1;try{await(await dm(()=>Promise.resolve().then(()=>Y8),void 0)).upsertClassTypeWeights(p),g=!0}catch{Gn("iqac_class_type_weights",p)}t(p),u(g?"Weights saved to server successfully.":"Saved locally (backend not reachable).")}catch(p){l((p==null?void 0:p.message)||"Failed to save weights")}finally{s(!1)}};return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:24},children:[a.jsx("h2",{children:"Class Type Weights"}),a.jsx("p",{children:"Set the weights for each class type. These weights are IQAC-controlled and are not editable by staff."}),r?a.jsx("div",{children:"Loading..."}):a.jsxs("form",{onSubmit:p=>{p.preventDefault(),h()},children:[a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"CO Attainment Weights"}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Used in CO Attainment (SSA/CIA/Formative blend)."})]}),a.jsx("div",{style:{overflowX:"auto",marginBottom:24},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Class Type"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"SSA1"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"CIA1"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Formative1"})]})}),a.jsx("tbody",{children:Zp.map(p=>{var y,b,v;const m=ti(String(p)),g=String(p).charAt(0).toUpperCase()+String(p).slice(1);return a.jsxs("tr",{children:[a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:g}),a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:a.jsx("input",{type:"number",step:"0.1",value:((y=e[m])==null?void 0:y.ssa1)??"",onChange:w=>d(m,"ssa1",w.target.value),required:!0})}),a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:a.jsx("input",{type:"number",step:"0.1",value:((b=e[m])==null?void 0:b.cia1)??"",onChange:w=>d(m,"cia1",w.target.value),required:!0})}),a.jsxs("td",{style:{border:"1px solid #ccc",padding:8},children:[a.jsx("input",{type:"number",step:"0.1",value:((v=e[m])==null?void 0:v.formative1)??"",onChange:w=>d(m,"formative1",w.target.value),required:!0}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:m==="TCPL"?"Lab":m==="TCPR"?"Review":"Formative"})]})]},m)})})]})}),a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Internal Mark Weightage"}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Inputs are mapped exactly to class-type exam assignments used in Internal Mark calculation."})]}),a.jsx("div",{style:{marginBottom:24},children:qre.map(p=>{const m=ti(String(p)),g=e[m],y=Y5(Array.isArray(g==null?void 0:g.internal_mark_weights)?g.internal_mark_weights:qu,g),b=Gre(m),v=b.flatMap(w=>w.cols);return a.jsxs("div",{style:{marginBottom:18,overflowX:"auto"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:8},children:Vre(m)}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:b.map(w=>a.jsx("th",{colSpan:w.cols.length,style:{border:"1px solid #ccc",padding:K5,textAlign:"center",whiteSpace:"nowrap",fontSize:13},children:w.header},w.header))}),a.jsx("tr",{children:v.map(w=>a.jsx("th",{style:{border:"1px solid #ccc",padding:K5,textAlign:"center",whiteSpace:"nowrap",fontSize:12},children:w.label},`${w.label}_${w.index}`))})]}),a.jsx("tbody",{children:a.jsx("tr",{children:v.map(w=>a.jsx("td",{style:{border:"1px solid #ccc",padding:K5,textAlign:"center"},children:a.jsx("input",{type:"number",step:"0.1",value:y[w.index]??"",onChange:S=>f(m,w.index,S.target.value),required:!0,style:{width:Hre}})},w.index))})})]})]},m)})}),a.jsx("button",{type:"submit",disabled:i,style:{padding:"8px 18px",fontWeight:700},children:i?"Saving...":"Save"}),o&&a.jsx("div",{style:{color:"red",marginTop:12},children:o}),c&&a.jsx("div",{style:{color:"green",marginTop:12},children:c})]})]})}const X5=[{id:"cia1_co1_co2",label:"CIA 1",cos:["CO1","CO2"],assessment:"cia1"},{id:"cia2_co3_co4",label:"CIA 2",cos:["CO3","CO4"],assessment:"cia2"},{id:"model_co1_co2_co3_co4_co5",label:"MODEL",cos:["CO1","CO2","CO3","CO4","CO5"],assessment:"model"},{id:"model_co3_co4_co5",label:"MODEL",cos:["CO3","CO4","CO5"],assessment:"model"},{id:"model_co5",label:"MODEL",cos:["CO5"],assessment:"model"}];function tP(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?"cia1_co1_co2":t==="cia2_co3_co4"?"cia2_co3_co4":t==="model_co1_co2_co3_co4_co5"?"model_co1_co2_co3_co4_co5":t==="model_co3_co4_co5"?"model_co3_co4_co5":t==="model_co5"?"model_co5":null}function Q5(e){const t=new Set,r={cia1_co1_co2:"CIA 1",cia2_co3_co4:"CIA 2",model_co1_co2_co3_co4_co5:"MODEL",model_co3_co4_co5:"MODEL",model_co5:"MODEL"},n=Array.isArray(e)?e:[];for(const i of n){if(typeof i=="string"){const s=tP(i);s&&t.add(s);continue}if(i&&typeof i=="object"){const s=tP(i.id);if(!s)continue;t.add(s);const o=String(i.name||"").trim();o&&(r[s]=o)}}return{selected:t,names:r}}function Yre({isOpen:e,onClose:t,onSave:r,currentSelection:n}){const i=Q5(n.options),[s,o]=x.useState(i.selected),[l,c]=x.useState(i.names),[u,d]=x.useState(Number(n.divider)||2),[f,h]=x.useState(Number(n.multiplier)||.15),[p,m]=x.useState("");x.useEffect(()=>{const v=Q5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),h(Number(n.multiplier)||.15),m("")},[n,e]);const g=v=>{const w=new Set(s);if(w.has(v))w.delete(v),o(w),m("");else{const S=X5.find(k=>k.id===v);if(S){const k=new Set;w.forEach(L=>{const P=X5.find(B=>B.id===L);P&&P.cos.forEach(B=>k.add(B))});const A=S.cos.filter(L=>k.has(L));if(A.length>0){m(`Cannot select this option: ${A.join(", ")} already selected in another option. Only one option per CO is allowed.`);return}w.add(v),o(w),m("")}}},y=()=>{const v=Number(u),w=Number(f);if(!Number.isFinite(v)||v<=0){m("Divider must be a number greater than 0.");return}if(!Number.isFinite(w)||w<0){m("Multiplier must be a number greater than or equal to 0.");return}m("");const S=Array.from(s).map(k=>({id:k,name:String((l==null?void 0:l[k])||"").trim()||void 0}));r({options:S,divider:v,multiplier:w}),t()},b=()=>{m("");const v=Q5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),h(Number(n.multiplier)||.15),t()};return e?a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:b,children:a.jsxs("div",{style:{backgroundColor:"white",borderRadius:12,padding:24,maxWidth:500,width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},onClick:v=>v.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[a.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:"CQI Editor"}),a.jsx("button",{onClick:b,style:{background:"transparent",border:"none",fontSize:24,cursor:"pointer",color:"#64748b",padding:0,width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),a.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:20},children:"Select when to show the CQI buttons. Multiple options can be selected as long as COs don't overlap."}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL<58 Divider"}),a.jsx("input",{type:"number",value:String(u),onChange:v=>d(Number(v.target.value)),className:"obe-input",min:.1,step:.1})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL58 Multiplier"}),a.jsx("input",{type:"number",value:String(f),onChange:v=>h(Number(v.target.value)),className:"obe-input",min:0,step:.01})]})]}),p&&a.jsx("div",{style:{padding:12,marginBottom:16,backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,color:"#b91c1c",fontSize:13},children:p}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12,marginBottom:24},children:X5.map(v=>a.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:12,padding:16,border:"2px solid",borderColor:s.has(v.id)?"#3b82f6":"#e2e8f0",borderRadius:8,cursor:"pointer",backgroundColor:s.has(v.id)?"#eff6ff":"white",transition:"all 0.2s"},children:[a.jsx("input",{type:"checkbox",checked:s.has(v.id),onChange:()=>g(v.id),style:{marginTop:3,width:18,height:18,cursor:"pointer"}}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12,marginBottom:6},children:[a.jsxs("div",{style:{fontWeight:600,color:"#0f172a"},children:[v.label," - ",v.cos.join(" and ")]}),a.jsxs("div",{style:{minWidth:190},children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Display name"}),a.jsx("input",{type:"text",value:String((l==null?void 0:l[v.id])||v.label),onChange:w=>{const S=String(w.target.value||"");c(k=>({...k,[v.id]:S}))},className:"obe-input",style:{padding:8},placeholder:v.label})]})]}),a.jsxs("div",{style:{fontSize:13,color:"#64748b"},children:["Show CQI button after ",v.label," exam"]})]})]},v.id))}),a.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[a.jsx("button",{onClick:b,className:"obe-btn",style:{minWidth:80},children:"Cancel"}),a.jsx("button",{onClick:y,className:"obe-btn obe-btn-primary",style:{minWidth:80},children:"Save"})]})]})}):null}function Xre(){const e={options:[],divider:2,multiplier:.15},[t,r]=x.useState(!1),[n,i]=x.useState(e),[s,o]=x.useState(!1);x.useEffect(()=>{let c=!0;return o(!0),SS().then(u=>{c&&i({options:Array.isArray(u.options)?u.options:[],divider:Number.isFinite(Number(u.divider))?Number(u.divider):2,multiplier:Number.isFinite(Number(u.multiplier))?Number(u.multiplier):.15})}).catch(()=>{}).finally(()=>{c&&o(!1)}),()=>{c=!1}},[]);const l=async c=>{i(c);try{await b9({options:Array.isArray(c.options)?c.options:[],divider:c.divider,multiplier:c.multiplier}),window.alert("CQI configuration saved.")}catch{window.alert("Failed to save CQI configuration.")}};return a.jsxs("div",{style:{padding:18},children:[a.jsx("h3",{style:{marginTop:0},children:"CQI Editor"}),a.jsx("div",{style:{color:"#6b7280",marginBottom:12},children:"Edit global CQI defaults for courses."}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>r(!0),disabled:s,children:s?"Loading":"Open CQI Editor"})}),a.jsx(Yre,{isOpen:t,onClose:()=>r(!1),onSave:l,currentSelection:n})]})}function Oc(e){return String(e??"").toLowerCase().replace(/[^a-z0-9]+/g,"").trim()}function Qre(){return{}}const Bm=["Technical magazine","Journal paper reading","Real time problems","Case study","Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition","Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment","Active Projects","Journal Preparation"];function Jre(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const W0=Jre(),L2="obe_assessment_master_config_cache";async function q0(e,t){const r=e.headers.get("content-type")||"";try{if(r.includes("application/json")){const s=await e.json(),o=(s==null?void 0:s.detail)||(s==null?void 0:s.message);if(o)return`${t}: ${o}`}}catch{}if(e.status===401)return`${t}: Authentication required. Please login.`;if(e.status===403)return`${t}: Permission required.`;if(e.status===404)return`${t}: No CDAP found for this course yet. Upload the Excel to create one.`;let n="";try{n=await e.text()}catch{}const i=(n||"").trim();return i&&!i.startsWith("<")?`${t}: ${i}`:`${t}: Server returned ${e.status}.`}async function D9(e,t){const r=typeof t=="number"?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${W0}/api/obe/cdap-revision/${encodeURIComponent(e)}${r}`,i=await yr(n,{method:"GET"});if(!i.ok){const s=await q0(i,"CDAP revision fetch failed");throw new Error(s)}return i.json()}async function I4(e,t){const r=typeof t=="number"?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${W0}/api/obe/articulation-matrix/${encodeURIComponent(e)}${r}`,i=await yr(n,{method:"GET"});if(!i.ok){const s=await q0(i,"Articulation Matrix fetch failed");throw new Error(s)}return i.json()}async function $9(e){const t=(e==null?void 0:e.subjectId)||(e==null?void 0:e.subject_id);if(!t)throw new Error("subjectId is required to save CDAP revision");const r=e==null?void 0:e.teaching_assignment_id,n=typeof r=="number"?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${W0}/api/obe/cdap-revision/${encodeURIComponent(t)}${n}`,s=await yr(i,{method:"PUT",body:JSON.stringify(e)});if(!s.ok){const o=await q0(s,"CDAP revision save failed");throw new Error(o)}return s.json()}async function C3(){const e=`${W0}/api/obe/active-learning-mapping`,t=await yr(e,{method:"GET"});if(!t.ok){try{const i=window.localStorage.getItem(L2);if(i){const s=JSON.parse(i);if(s&&typeof s=="object")return s}}catch{}const n=await q0(t,"Active learning mapping fetch failed");throw new Error(n)}const r=await t.json();return(r==null?void 0:r.mapping)||{}}async function U9(e){const t=`${W0}/api/obe/active-learning-mapping`,r=await yr(t,{method:"PUT",body:JSON.stringify({mapping:e})});if(!r.ok){const i=await q0(r,"Active learning mapping save failed");throw new Error(i)}const n=await r.json();return(n==null?void 0:n.mapping)||{}}async function vu(){const e=`${W0}/api/obe/assessment-master-config`,t=await yr(e,{method:"GET"});if(!t.ok){try{const s=window.localStorage.getItem(L2);if(s){const o=JSON.parse(s);if(o&&typeof o=="object")return o}}catch{}const i=await q0(t,"Assessment master config fetch failed");throw new Error(i)}const r=await t.json(),n=(r==null?void 0:r.config)||{};try{window.localStorage.setItem(L2,JSON.stringify(n))}catch{}return n}async function Zre(e){const t=`${W0}/api/obe/assessment-master-config`,r=await yr(t,{method:"PUT",body:JSON.stringify({config:e})});if(!r.ok){const s=await q0(r,"Assessment master config save failed");throw new Error(s)}const n=await r.json(),i=(n==null?void 0:n.config)||{};try{window.localStorage.setItem(L2,JSON.stringify(i))}catch{}return i}function ene(e,t=3e4){const r=window.setInterval(()=>e(),t);return()=>window.clearInterval(r)}const Lp=Array.from({length:11},(e,t)=>`PO${t+1}`);function tne(){const e={};for(const t of Bm)e[Oc(t)]=Array(Lp.length).fill(!1);return e}function rne(){const[e,t]=x.useState(tne),[r,n]=x.useState(!0),[i,s]=x.useState(!1),[o,l]=x.useState(null);x.useEffect(()=>{let d=!0;return n(!0),C3().then(f=>{d&&t(h=>{const p={...h};for(const m of Bm){const g=Oc(m),y=f==null?void 0:f[g];Array.isArray(y)&&y.length===Lp.length&&(p[g]=y)}return p})}).catch(()=>{}).finally(()=>{d&&n(!1)}),()=>{d=!1}},[]);function c(d,f){const h=Oc(d);t(p=>{const m=p[h]?[...p[h]]:Array(Lp.length).fill(!1);return m[f]=!m[f],{...p,[h]:m}}),l(null)}async function u(){s(!0),l(null);try{await U9(e),l(" Saved  changes are now active for all courses.")}catch(d){l(`Save failed: ${(d==null?void 0:d.message)||"Unknown error"}`)}finally{s(!1)}}return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0},children:"Active Learning  PO Mapping (Global)"}),a.jsxs("p",{style:{color:"#6b7280",marginTop:4,marginBottom:0,fontSize:13},children:["For each active-learning activity, tick which POs it contributes to. These settings apply to"," ",a.jsx("strong",{children:"all courses"})," immediately after saving."]})]}),a.jsx("button",{onClick:u,disabled:i||r,style:{padding:"8px 18px",borderRadius:8,background:i||r?"#d1fae5":"#10b981",color:"#fff",border:"none",fontWeight:700,cursor:i||r?"default":"pointer",whiteSpace:"nowrap"},children:i?"Saving":"Save Global Mapping"})]}),o&&a.jsx("div",{style:{marginBottom:10,padding:"8px 12px",borderRadius:6,background:o.startsWith("")?"#ecfdf5":"#fef2f2",color:o.startsWith("")?"#065f46":"#991b1b",fontSize:13},children:o}),r?a.jsx("div",{style:{color:"#6b7280",padding:16},children:"Loading global mapping"}):a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",fontSize:13,minWidth:700,width:"100%"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:"8px 10px",border:"1px solid #e5e7eb",minWidth:220},children:"Active Learning Activity"}),Lp.map(d=>a.jsx("th",{style:{padding:"6px 8px",border:"1px solid #e5e7eb",textAlign:"center",minWidth:46},children:d},d))]})}),a.jsx("tbody",{children:Bm.map((d,f)=>{const h=Oc(d),p=e[h]??Array(Lp.length).fill(!1);return a.jsxs("tr",{style:{background:f%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{padding:"7px 10px",border:"1px solid #e5e7eb",fontWeight:500},children:d}),Lp.map((m,g)=>a.jsx("td",{style:{padding:"4px",border:"1px solid #e5e7eb",textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!p[g],onChange:()=>c(d,g),style:{cursor:"pointer",width:16,height:16}})},g))]},d)})})]})})]})}function nne(){const e=ul(),t=go(),n=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"dashboard",[i,s]=x.useState(n);x.useEffect(()=>{const l=new URLSearchParams(e.search).get("tab");l&&l!==i&&s(l)},[e.search]);const o=[{key:"dashboard",label:"Dashboard"},{key:"weights",label:"Weights"},{key:"active_learning",label:"Active Learning Mapping"},{key:"due_dates",label:"OBE Due Dates"},{key:"courses",label:"Courses"},{key:"qp",label:"QP"},{key:"cqi",label:"CQI Editor"}];return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic Controller"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"IQAC tools for OBE oversight."})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18,flexWrap:"wrap"},children:o.map(l=>a.jsx("button",{onClick:()=>{s(l.key),t(`/iqac/academic-controller?tab=${encodeURIComponent(l.key)}`)},style:{padding:"8px 12px",borderRadius:8,border:i===l.key?"1px solid #10b981":"1px solid #e5e7eb",background:i===l.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:l.label},l.key))}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i==="dashboard"&&a.jsx("div",{style:{color:"#6b7280"},children:"Dashboard coming soon."}),i==="weights"&&a.jsx(Kre,{}),i==="active_learning"&&a.jsx(rne,{}),i==="due_dates"&&a.jsx(j3,{}),i==="courses"&&a.jsx(Ure,{}),i==="qp"&&a.jsx(zre,{}),i==="cqi"&&a.jsx(Xre,{})]})]})}const ine="https://db.krgi.co.in",ane=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":ine;async function R2(e){const t=encodeURIComponent(String(e||"").trim()),r=await yr(`${ane}/api/academics/iqac/course-teaching/${t}/`);if(!r.ok)throw new Error("Failed to fetch course teaching map");const n=await r.json();if(Array.isArray(n))return n;const i=n==null?void 0:n.results;return Array.isArray(i)?i:[]}function sne(){var m;const{courseCode:e}=U0(),t=go(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),[n,i]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(!0),[u,d]=x.useState(null);x.useEffect(()=>{let g=!0;return(async()=>{if(r)try{const[y,b]=await Promise.all([R2(r),bl()]);if(!g)return;i(Array.isArray(y)?y:[]),o(Array.isArray(b)?b:[]),d(null)}catch(y){if(!g)return;i([]),d((y==null?void 0:y.message)||"Failed to load course mapping")}finally{g&&c(!1)}})(),()=>{g=!1}},[r]);const f=((m=n[0])==null?void 0:m.course_name)||r,h=x.useMemo(()=>{const g=new Map;for(const b of n||[]){const v=String((b==null?void 0:b.section_name)||"").trim()||"Section",w=b!=null&&b.academic_year?String(b.academic_year):null,S=`${v}__${w||""}`,k=g.get(S);k?k.items.push(b):g.set(S,{section_name:v,academic_year:w,items:[b]})}const y=Array.from(g.values());y.sort((b,v)=>{const w=b.section_name.localeCompare(v.section_name);return w!==0?w:String(b.academic_year||"").localeCompare(String(v.academic_year||""))});for(const b of y)b.items.sort((v,w)=>{var j,A,L,P;const S=String(((j=v.staff)==null?void 0:j.name)||((A=v.staff)==null?void 0:A.username)||"").trim(),k=String(((L=w.staff)==null?void 0:L.name)||((P=w.staff)==null?void 0:P.username)||"").trim();return S.localeCompare(k)});return y},[n]);async function p(g){if(!g||!window.confirm("Resetting this course will delete all entered exam data for this teaching assignment. This cannot be undone. Proceed?"))return;const b=["ssa1","review1","ssa2","review2","cia1","cia2","formative1","formative2","model"];try{for(const w of b)try{await S3(w,r,g)}catch(S){console.warn("reset assessment failed",w,S)}c(!0);const v=await R2(r);i(Array.isArray(v)?v:[]),d(null),window.alert("Reset completed.")}catch(v){window.alert("Reset failed: "+((v==null?void 0:v.message)||String(v)))}finally{c(!1)}}return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:r}),a.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:f}),a.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Sections and staff mapping."})]}),a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"}),a.jsx("button",{className:"obe-btn",onClick:()=>t(`/obe/course/${encodeURIComponent(r)}`),children:"Open OBE (faculty view)"})]})]}),l?a.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):null,u?a.jsx("div",{style:{color:"#b91c1c"},children:u}):null,!l&&!u&&n.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No active teaching assignments found for this course."}):null,!l&&!u&&n.length>0?a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:h.map(g=>a.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:g.section_name}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:g.academic_year||""})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:10},children:g.items.map(y=>{var b,v;return a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:10,background:"#fff",display:"flex",flexDirection:"column",gap:8},children:[a.jsx("div",{style:{color:"#111827",fontWeight:800},children:((b=y.staff)==null?void 0:b.name)||((v=y.staff)==null?void 0:v.username)||""}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[y.section_name?`Section: ${y.section_name}`:"",y.academic_year?`    AY: ${y.academic_year}`:"",(()=>{var S,k;const w=(s||[]).find(j=>String((j==null?void 0:j.course_code)||"").trim().toUpperCase()===r.toUpperCase());return w?`    Dept: ${((S=w.department)==null?void 0:S.name)||((k=w.department)==null?void 0:k.code)||""}    Sem: ${w.semester||""}`:""})()]}),a.jsxs("div",{style:{marginTop:2,display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/marks/${encodeURIComponent(String(y.teaching_assignment_id))}`),children:"Open Mark Entry"}),a.jsx("button",{className:"obe-btn",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/obe/${encodeURIComponent(String(y.teaching_assignment_id))}/marks`),children:"Open OBE (view-only)"}),a.jsx("button",{className:"obe-btn",onClick:()=>p(Number(y.teaching_assignment_id)),children:"Reset Course"})]})]},String(y.teaching_assignment_id))})})]},`${g.section_name}__${g.academic_year||""}`))}):null]})}async function qc(e){const t=`/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/students/`,r=(i,s=800)=>{const o=String(i||""),u=o.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||o.replace(/\s+/g," ").trim();return u.length<=s?u:u.slice(0,s)+" (truncated)"},n=await yr(t,{method:"GET"});if(!n.ok){const i=await n.text();throw new Error(`Roster fetch failed: ${n.status}
${r(i)}`)}return n.json()}function one(e,t){if(!e)return null;const r=new Date(e).getTime();if(!Number.isFinite(r))return null;const n=t?new Date(t).getTime():Date.now();return Number.isFinite(n)?Math.floor((r-n)/1e3):null}function ng(e){if(e==null)return"";const t=Math.max(0,Math.floor(e)),r=Math.floor(t/3600),n=Math.floor(t%3600/60),i=t%60;return r>0?`${r}h ${String(n).padStart(2,"0")}m`:`${n}m ${String(i).padStart(2,"0")}s`}function H0(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:i}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),[f,h]=x.useState(null),p=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),m=async y=>{if(!t||!r)return;const b=!!(y!=null&&y.silent);b||c(!0),b||d(null);try{const v=await _3(t,r,n);o(v);const w=v.remaining_seconds??one(v.due_at,v.now);h(w)}catch(v){d((v==null?void 0:v.message)||"Failed to check publish window")}finally{b||c(!1)}};x.useEffect(()=>{o(null),h(null),m()},[p]),x.useEffect(()=>{if((i==null?void 0:i.poll)===!1)return;const y=window.setInterval(()=>{m({silent:!0})},3e4);return()=>window.clearInterval(y)},[p,i==null?void 0:i.poll]),x.useEffect(()=>{if(f==null||f<=0)return;const y=window.setInterval(()=>{h(b=>b==null?b:b<=0?0:b-1)},1e3);return()=>window.clearInterval(y)},[f]);const g=(s==null?void 0:s.publish_allowed)??!0;return{data:s,loading:l,error:u,remainingSeconds:f,publishAllowed:g,refresh:m}}function nc(e){const{assessment:t,subjectCode:r,scope:n,teachingAssignmentId:i,options:s}=e,[o,l]=x.useState(null),[c,u]=x.useState(!1),[d,f]=x.useState(null),h=x.useMemo(()=>`${t}|${r}|${n}|${i||""}`,[t,r,n,i]),p=async m=>{if(!t||!r||!n)return;const g=!!(m!=null&&m.silent);g||u(!0),g||f(null);try{const y=await l1(t,r,n,i);l(y)}catch(y){f((y==null?void 0:y.message)||"Failed to check edit window")}finally{g||u(!1)}};return x.useEffect(()=>{l(null),p()},[h]),x.useEffect(()=>{if((s==null?void 0:s.poll)===!1)return;const m=window.setInterval(()=>{p({silent:!0})},3e4);return()=>window.clearInterval(m)},[h,s==null?void 0:s.poll]),{data:o,loading:c,error:d,refresh:p}}function V0(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:i}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),f=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),h=async p=>{if(!t||!r)return;const m=!!(p!=null&&p.silent);m||c(!0),m||d(null);try{const g=await vS(t,r,n);o(g)}catch(g){d((g==null?void 0:g.message)||"Failed to load lock status")}finally{m||c(!1)}};return x.useEffect(()=>{o(null),h()},[f]),x.useEffect(()=>{if((i==null?void 0:i.poll)===!1)return;const p=window.setInterval(()=>{h({silent:!0})},3e4);return()=>window.clearInterval(p)},[f,i==null?void 0:i.poll]),{data:s,loading:l,error:u,refresh:h}}const lne=24*60*60*1e3;function cne(e){if(!e||String(e.status||"").toUpperCase()!=="PENDING"||!e.is_active)return null;const r=e.requested_at?new Date(String(e.requested_at)).getTime():0;if(!r||!Number.isFinite(r))return null;const n=r+lne;return Number.isFinite(n)?n:null}function G0(e){const{enabled:t,assessment:r,subjectCode:n,scope:i,teachingAssignmentId:s}=e,[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(!1),h=x.useMemo(()=>c?c>Date.now():!1,[c]),p=async m=>{if(!t||!r||!n||!i)return;const g=!!(m!=null&&m.silent);g||f(!0);try{const y=await Lm({assessment:r,subject_code:String(n),scope:i,teaching_assignment_id:s}),b=(y==null?void 0:y.result)??null;l(b),u(cne(b))}catch{l(null),u(null)}finally{g||f(!1)}};return x.useEffect(()=>{if(!t){l(null),u(null);return}p({silent:!0});const m=window.setInterval(()=>{p({silent:!0})},6e4);return()=>window.clearInterval(m)},[t,r,n,i,s]),{latest:o,pending:h,pendingUntilMs:c,loading:d,refresh:p,setPendingUntilMs:u}}function K0(e){x.useEffect(()=>{if(!e||typeof document>"u")return;const t=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=t}},[e])}function une({size:e=22}){return a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,focusable:"false",children:[a.jsx("path",{d:"M7 10V8a5 5 0 0 1 10 0v2",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"}),a.jsx("path",{d:"M6.5 10h11A2.5 2.5 0 0 1 20 12.5v6A2.5 2.5 0 0 1 17.5 21h-11A2.5 2.5 0 0 1 4 18.5v-6A2.5 2.5 0 0 1 6.5 10Z",fill:"#F3F4F6",stroke:"#111827",strokeWidth:"1.2"}),a.jsx("path",{d:"M12 14.2v2.6",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"})]})}function ig({locked:e,title:t,subtitle:r,children:n}){return e?a.jsxs("div",{style:{position:"relative"},children:[a.jsx("div",{style:{position:"sticky",top:0,left:0,right:0,zIndex:10,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",background:"#ffffff",border:"2px solid #fde68a",borderRadius:12,padding:"12px 16px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[a.jsx("div",{style:{width:36,height:36,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #fde68a",flex:"0 0 auto"},children:a.jsx(une,{size:20})}),a.jsxs("div",{style:{minWidth:0,flex:1},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827",fontSize:14},children:t||"Locked by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:r||"Publishing is turned OFF globally for this assessment."})]})]})}),a.jsx("div",{style:{filter:"brightness(0.97)",pointerEvents:"none",userSelect:"none"},children:n})]}):a.jsx(a.Fragment,{children:n})}function ag({children:e}){const t={minHeight:"100vh",background:"linear-gradient(180deg, #f0f9ff 0%, #ffffff 65%)",padding:"18px 14px"},r={maxWidth:1400,margin:"0 auto"},n={border:"1px solid rgba(15,23,42,0.08)",borderRadius:16,background:"rgba(255,255,255,0.88)",boxShadow:"0 12px 30px rgba(15,23,42,0.08)",padding:16,backdropFilter:"blur(10px)",overflowX:"auto",minWidth:0};return a.jsx("div",{style:t,children:a.jsx("div",{style:{...r,...n},children:e})})}function gs(e){return typeof document>"u"?a.jsx(a.Fragment,{children:e.children}):Y1.createPortal(a.jsx(a.Fragment,{children:e.children}),document.body)}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var B2={};B2.version="0.18.5";var z9=1252,dne=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],E3={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},T3=function(e){dne.indexOf(e)!=-1&&(z9=E3[0]=e)};function fne(){T3(1252)}var lu=function(e){T3(e)};function P3(){lu(1200),fne()}function rP(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function hne(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function W9(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var fx=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?hne(e.slice(2)):t==254&&r==255?W9(e.slice(2)):t==65279?e.slice(1):e},Sb=function(t){return String.fromCharCode(t)},nP=function(t){return String.fromCharCode(t)},c1,Hf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function u1(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),t+=Hf.charAt(s)+Hf.charAt(o)+Hf.charAt(l)+Hf.charAt(c);return t}function ic(e){var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Hf.indexOf(e.charAt(u++)),o=Hf.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=Hf.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Hf.indexOf(e.charAt(u++)),i=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var fi=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),cf=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function dh(e){return fi?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function iP(e){return fi?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gl=function(t){return fi?cf(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function NS(e){if(typeof ArrayBuffer>"u")return Gl(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function _h(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function pne(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function O3(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return O3(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Hs=fi?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:cf(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function mne(e){for(var t=[],r=0,n=e.length+250,i=dh(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=dh(65535),n=65530)}return t.push(i.slice(0,r)),Hs(t)}var rl=/\u0000/g,hx=/[\u0001-\u0006]/g;function pm(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function cu(e,t){var r=""+e;return r.length>=t?r:qa("0",t-r.length)+r}function M3(e,t){var r=""+e;return r.length>=t?r:qa(" ",t-r.length)+r}function F2(e,t){var r=""+e;return r.length>=t?r:r+qa(" ",t-r.length)}function gne(e,t){var r=""+Math.round(e);return r.length>=t?r:qa("0",t-r.length)+r}function xne(e,t){var r=""+e;return r.length>=t?r:qa("0",t-r.length)+r}var aP=Math.pow(2,32);function hp(e,t){if(e>aP||e<-aP)return gne(e,t);var r=Math.round(e);return xne(r,t)}function I2(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var sP=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],J5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function yne(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Vn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},oP={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bne={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function D2(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(i);u<t&&(f=Math.floor(i),l=f*o+s,d=f*u+c,!(i-f<5e-8));)i=1/(i-f),s=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var h=Math.floor(n*l/d);return[h,n*l-h*d,d]}function Kh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=jne(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}var q9=new Date(1899,11,31,0,0,0),vne=q9.getTime(),wne=new Date(1900,2,1,0,0,0);function H9(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=wne&&(r+=24*60*60*1e3),(r-(vne+(e.getTimezoneOffset()-q9.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function L3(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Sne(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function _ne(e){var t=e<0?12:11,r=L3(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function kne(e){var t=L3(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function d1(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=_ne(e):t===10?r=e.toFixed(10).substr(0,12):r=kne(e),L3(Sne(r.toUpperCase()))}function w0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):d1(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Dc(14,H9(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function jne(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Ane(e,t,r,n){var i="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return J5[r.m-1][1];case 5:return J5[r.m-1][0];default:return J5[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return sP[r.q][0];default:return sP[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?cu(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=cu(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?cu(c,u):"";return d}function Vf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var V9=/%/g;function Nne(e,t,r){var n=t.replace(V9,""),i=t.length-n.length;return Dd(e,n,r*Math.pow(10,2*i))+qa("%",i)}function Cne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Dd(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function G9(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+G9(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var K9=/# (\?+)( ?)\/( ?)(\d+)/;function Ene(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?qa(" ",e[1].length+1+e[4].length):M3(o,e[1].length)+e[2]+"/"+e[3]+cu(l,e[4].length))}function Tne(e,t,r){return r+(t===0?"":""+t)+qa(" ",e[1].length+2+e[4].length)}var Y9=/^#*0*\.([0#]+)/,X9=/\).*[0#]/,Q9=/\(###\) ###\\?-####/;function Xo(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function lP(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function cP(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Pne(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function One(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Sc(e,t,r){if(e.charCodeAt(0)===40&&!t.match(X9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Sc("n",n,r):"("+Sc("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Cne(e,t,r);if(t.indexOf("%")!==-1)return Nne(e,t,r);if(t.indexOf("E")!==-1)return G9(t,r);if(t.charCodeAt(0)===36)return"$"+Sc(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+hp(c,t.length);if(t.match(/^[#?]+$/))return i=hp(r,0),i==="0"&&(i=""),i.length>t.length?i:Xo(t.substr(0,t.length-i.length))+i;if(s=t.match(K9))return Ene(s,c,u);if(t.match(/^#+0+$/))return u+hp(c,t.length-t.indexOf("0"));if(s=t.match(Y9))return i=lP(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Xo(s[1])).replace(/\.$/,"."+Xo(s[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+qa("0",Xo(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+lP(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Vf(hp(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Sc(e,t,-r):Vf(""+(Math.floor(r)+Pne(r,s[1].length)))+"."+cu(cP(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Sc(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=pm(Sc(e,t.replace(/[\\-]/g,""),r)),o=0,pm(pm(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(Q9))return i=Sc(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=D2(c,Math.pow(10,o)-1,!1),i=""+u,d=Dd("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=F2(l[2],o),d.length<s[4].length&&(d=Xo(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=D2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?M3(l[1],o)+s[2]+"/"+s[3]+F2(l[2],o):qa(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=hp(r,0),t.length<=i.length?i:Xo(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,h=t.length-i.length-f;return Xo(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=cP(r,s[1].length),r<0?"-"+Sc(e,t,-r):Vf(One(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?cu(0,3-m.length):"")+m})+"."+cu(o,s[1].length);switch(t){case"###,##0.00":return Sc(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Vf(hp(c,0));return p!=="0"?u+p:"";case"###,###.00":return Sc(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Sc(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Mne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Dd(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Lne(e,t,r){var n=t.replace(V9,""),i=t.length-n.length;return Dd(e,n,r*Math.pow(10,2*i))+qa("%",i)}function J9(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+J9(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Du(e,t,r){if(e.charCodeAt(0)===40&&!t.match(X9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Du("n",n,r):"("+Du("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Mne(e,t,r);if(t.indexOf("%")!==-1)return Lne(e,t,r);if(t.indexOf("E")!==-1)return J9(t,r);if(t.charCodeAt(0)===36)return"$"+Du(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+cu(c,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Xo(t.substr(0,t.length-i.length))+i;if(s=t.match(K9))return Tne(s,c,u);if(t.match(/^#+0+$/))return u+cu(c,t.length-t.indexOf("0"));if(s=t.match(Y9))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Xo(s[1])).replace(/\.$/,"."+Xo(s[1])),i=i.replace(/\.(\d*)$/,function(m,g){return"."+g+qa("0",Xo(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Vf(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Du(e,t,-r):Vf(""+r)+"."+qa("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Du(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=pm(Du(e,t.replace(/[\\-]/g,""),r)),o=0,pm(pm(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(Q9))return i=Du(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=D2(c,Math.pow(10,o)-1,!1),i=""+u,d=Dd("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=F2(l[2],o),d.length<s[4].length&&(d=Xo(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=D2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?M3(l[1],o)+s[2]+"/"+s[3]+F2(l[2],o):qa(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Xo(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,h=t.length-i.length-f;return Xo(t.substr(0,f)+i+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Du(e,t,-r):Vf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?cu(0,3-m.length):"")+m})+"."+cu(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Vf(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Du(e,t.slice(0,t.lastIndexOf(".")),r)+Xo(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Dd(e,t,r){return(r|0)===r?Du(e,t,r):Sc(e,t,r)}function Rne(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var Z9=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function sg(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":I2(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(Z9))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Bne(e,t,r,n){for(var i=[],s="",o=0,l="",c="t",u,d,f,h="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!I2(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++o;break;case"\\":var p=e.charAt(++o),m=p==="("||p===")"?p:"t";i[i.length]={t:m,v:p},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Kh(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Kh(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=h),i[i.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var g={t:l,v:l};if(u==null&&(u=Kh(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",h="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,h="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",o+=5,h="h"):(g.t="t",++o),u==null&&g.t==="T")return"";i[i.length]=g,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Z9)){if(u==null&&(u=Kh(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",sg(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var y=0,b=0,v;for(o=i.length-1,c="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=h,c="h",y<1&&(y=1);break;case"s":(v=i[o].v.match(/\.0+$/))&&(b=Math.max(b,v[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=i[o].t;break;case"m":c==="s"&&(i[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[o].v.match(/[Hh]/)&&(y=1),y<2&&i[o].v.match(/[Mm]/)&&(y=2),y<3&&i[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",S;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Ane(i[o].t.charCodeAt(0),i[o].v,u,b),i[o].t="t";break;case"n":case"?":for(S=o+1;i[S]!=null&&((l=i[S].t)==="?"||l==="D"||(l===" "||l==="t")&&i[S+1]!=null&&(i[S+1].t==="?"||i[S+1].t==="t"&&i[S+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[S].v==="/"||i[S].v===" "&&i[S+1]!=null&&i[S+1].t=="?"));)i[o].v+=i[S].v,i[S]={v:"",t:";"},++S;w+=i[o].v,o=S-1;break;case"G":i[o].t="t",i[o].v=w0(t,r);break}var k="",j,A;if(w.length>0){w.charCodeAt(0)==40?(j=t<0&&w.charCodeAt(0)===45?-t:t,A=Dd("n",w,j)):(j=t<0&&n>1?-t:t,A=Dd("n",w,j),j<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),S=A.length-1;var L=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){L=o;break}var P=i.length;if(L===i.length&&A.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(S>=i[o].v.length-1?(S-=i[o].v.length,i[o].v=A.substr(S+1,i[o].v.length)):S<0?i[o].v="":(i[o].v=A.substr(0,S+1),S=-1),i[o].t="t",P=o);S>=0&&P<i.length&&(i[P].v=A.substr(0,S+1)+i[P].v)}else if(L!==i.length&&A.indexOf("E")===-1){for(S=A.indexOf(".")-1,o=L;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")-1:i[o].v.length-1,k=i[o].v.substr(d+1);d>=0;--d)S>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(k=A.charAt(S--)+k);i[o].v=k,i[o].t="t",P=o}for(S>=0&&P<i.length&&(i[P].v=A.substr(0,S+1)+i[P].v),S=A.indexOf(".")+1,o=L;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==L)){for(d=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")+1:0,k=i[o].v.substr(0,d);d<i[o].v.length;++d)S<A.length&&(k+=A.charAt(S++));i[o].v=k,i[o].t="t",P=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(j=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=Dd(i[o].t,i[o].v,j),i[o].t="t");var B="";for(o=0;o!==i.length;++o)i[o]!=null&&(B+=i[o].v);return B}var uP=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function dP(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Fne(e,t){var r=Rne(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(uP),l=r[1].match(uP);return dP(t,o)?[n,r[0]]:dP(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Dc(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Vn)[e],n==null&&(n=r.table&&r.table[oP[e]]||Vn[oP[e]]),n==null&&(n=bne[e]||"General");break}if(I2(n,0))return w0(t,r);t instanceof Date&&(t=H9(t,r.date1904));var i=Fne(n,t);if(I2(i[1]))return w0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Bne(i[1],t,r,i[0])}function $d(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Vn[r]==null){t<0&&(t=r);continue}if(Vn[r]==e){t=r;break}}t<0&&(t=391)}return Vn[t]=e,t}function CS(e){for(var t=0;t!=392;++t)e[t]!==void 0&&$d(e[t],t)}function og(){Vn=yne()}var Ine={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},e$=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Dne(e){var t=typeof e=="number"?Vn[e]:e;return t=t.replace(e$,"(\\d+)"),new RegExp("^"+t+"$")}function $ne(e,t,r){var n=-1,i=-1,s=-1,o=-1,l=-1,c=-1;(t.match(e$)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":o=p;break;case"s":c=p;break;case"m":o>=0?l=p:i=p;break}}),c>=0&&l==-1&&i>=0&&(l=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&i==-1&&s==-1?d:u+"T"+d}var Une=function(){var e={};e.version="1.2.0";function t(){for(var A=0,L=new Array(256),P=0;P!=256;++P)A=P,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,L[P]=A;return typeof Int32Array<"u"?new Int32Array(L):L}var r=t();function n(A){var L=0,P=0,B=0,E=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)E[B]=A[B];for(B=0;B!=256;++B)for(P=A[B],L=256+B;L<4096;L+=256)P=E[L]=P>>>8^A[P&255];var T=[];for(B=1;B!=16;++B)T[B-1]=typeof Int32Array<"u"?E.subarray(B*256,B*256+256):E.slice(B*256,B*256+256);return T}var i=n(r),s=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],f=i[6],h=i[7],p=i[8],m=i[9],g=i[10],y=i[11],b=i[12],v=i[13],w=i[14];function S(A,L){for(var P=L^-1,B=0,E=A.length;B<E;)P=P>>>8^r[(P^A.charCodeAt(B++))&255];return~P}function k(A,L){for(var P=L^-1,B=A.length-15,E=0;E<B;)P=w[A[E++]^P&255]^v[A[E++]^P>>8&255]^b[A[E++]^P>>16&255]^y[A[E++]^P>>>24]^g[A[E++]]^m[A[E++]]^p[A[E++]]^h[A[E++]]^f[A[E++]]^d[A[E++]]^u[A[E++]]^c[A[E++]]^l[A[E++]]^o[A[E++]]^s[A[E++]]^r[A[E++]];for(B+=15;E<B;)P=P>>>8^r[(P^A[E++])&255];return~P}function j(A,L){for(var P=L^-1,B=0,E=A.length,T=0,F=0;B<E;)T=A.charCodeAt(B++),T<128?P=P>>>8^r[(P^T)&255]:T<2048?(P=P>>>8^r[(P^(192|T>>6&31))&255],P=P>>>8^r[(P^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,F=A.charCodeAt(B++)&1023,P=P>>>8^r[(P^(240|T>>8&7))&255],P=P>>>8^r[(P^(128|T>>2&63))&255],P=P>>>8^r[(P^(128|F>>6&15|(T&3)<<4))&255],P=P>>>8^r[(P^(128|F&63))&255]):(P=P>>>8^r[(P^(224|T>>12&15))&255],P=P>>>8^r[(P^(128|T>>6&63))&255],P=P>>>8^r[(P^(128|T&63))&255]);return~P}return e.table=r,e.bstr=S,e.buf=k,e.str=j,e}(),zn=function(){var t={};t.version="1.2.1";function r(ne,ce){for(var te=ne.split("/"),ue=ce.split("/"),Ee=0,je=0,gt=Math.min(te.length,ue.length);Ee<gt;++Ee){if(je=te[Ee].length-ue[Ee].length)return je;if(te[Ee]!=ue[Ee])return te[Ee]<ue[Ee]?-1:1}return te.length-ue.length}function n(ne){if(ne.charAt(ne.length-1)=="/")return ne.slice(0,-1).indexOf("/")===-1?ne:n(ne.slice(0,-1));var ce=ne.lastIndexOf("/");return ce===-1?ne:ne.slice(0,ce+1)}function i(ne){if(ne.charAt(ne.length-1)=="/")return i(ne.slice(0,-1));var ce=ne.lastIndexOf("/");return ce===-1?ne:ne.slice(ce+1)}function s(ne,ce){typeof ce=="string"&&(ce=new Date(ce));var te=ce.getHours();te=te<<6|ce.getMinutes(),te=te<<5|ce.getSeconds()>>>1,ne.write_shift(2,te);var ue=ce.getFullYear()-1980;ue=ue<<4|ce.getMonth()+1,ue=ue<<5|ce.getDate(),ne.write_shift(2,ue)}function o(ne){var ce=ne.read_shift(2)&65535,te=ne.read_shift(2)&65535,ue=new Date,Ee=te&31;te>>>=5;var je=te&15;te>>>=4,ue.setMilliseconds(0),ue.setFullYear(te+1980),ue.setMonth(je-1),ue.setDate(Ee);var gt=ce&31;ce>>>=5;var Qe=ce&63;return ce>>>=6,ue.setHours(ce),ue.setMinutes(Qe),ue.setSeconds(gt<<1),ue}function l(ne){uo(ne,0);for(var ce={},te=0;ne.l<=ne.length-4;){var ue=ne.read_shift(2),Ee=ne.read_shift(2),je=ne.l+Ee,gt={};switch(ue){case 21589:te=ne.read_shift(1),te&1&&(gt.mtime=ne.read_shift(4)),Ee>5&&(te&2&&(gt.atime=ne.read_shift(4)),te&4&&(gt.ctime=ne.read_shift(4))),gt.mtime&&(gt.mt=new Date(gt.mtime*1e3));break}ne.l=je,ce[ue]=gt}return ce}var c;function u(){return c||(c={})}function d(ne,ce){if(ne[0]==80&&ne[1]==75)return xr(ne,ce);if((ne[0]|32)==109&&(ne[1]|32)==105)return Ce(ne,ce);if(ne.length<512)throw new Error("CFB file size "+ne.length+" < 512");var te=3,ue=512,Ee=0,je=0,gt=0,Qe=0,Fe=0,$e=[],st=ne.slice(0,512);uo(st,0);var Wt=f(st);switch(te=Wt[0],te){case 3:ue=512;break;case 4:ue=4096;break;case 0:if(Wt[1]==0)return xr(ne,ce);default:throw new Error("Major Version: Expected 3 or 4 saw "+te)}ue!==512&&(st=ne.slice(0,ue),uo(st,28));var qt=ne.slice(0,ue);h(st,te);var ht=st.read_shift(4,"i");if(te===3&&ht!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ht);st.l+=4,gt=st.read_shift(4,"i"),st.l+=4,st.chk("00100000","Mini Stream Cutoff Size: "),Qe=st.read_shift(4,"i"),Ee=st.read_shift(4,"i"),Fe=st.read_shift(4,"i"),je=st.read_shift(4,"i");for(var Ut=-1,Gt=0;Gt<109&&(Ut=st.read_shift(4,"i"),!(Ut<0));++Gt)$e[Gt]=Ut;var cr=p(ne,ue);y(Fe,je,cr,ue,$e);var ir=v(cr,gt,$e,ue);ir[gt].name="!Directory",Ee>0&&Qe!==F&&(ir[Qe].name="!MiniFAT"),ir[$e[0]].name="!FAT",ir.fat_addrs=$e,ir.ssz=ue;var Fr={},dn=[],vr=[],Lt=[];w(gt,ir,cr,dn,Ee,Fr,vr,Qe),m(vr,Lt,dn),dn.shift();var Gr={FileIndex:vr,FullPaths:Lt};return ce&&ce.raw&&(Gr.raw={header:qt,sectors:cr}),Gr}function f(ne){if(ne[ne.l]==80&&ne[ne.l+1]==75)return[0,0];ne.chk(W,"Header Signature: "),ne.l+=16;var ce=ne.read_shift(2,"u");return[ne.read_shift(2,"u"),ce]}function h(ne,ce){var te=9;switch(ne.l+=2,te=ne.read_shift(2)){case 9:if(ce!=3)throw new Error("Sector Shift: Expected 9 saw "+te);break;case 12:if(ce!=4)throw new Error("Sector Shift: Expected 12 saw "+te);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+te)}ne.chk("0600","Mini Sector Shift: "),ne.chk("000000000000","Reserved: ")}function p(ne,ce){for(var te=Math.ceil(ne.length/ce)-1,ue=[],Ee=1;Ee<te;++Ee)ue[Ee-1]=ne.slice(Ee*ce,(Ee+1)*ce);return ue[te-1]=ne.slice(te*ce),ue}function m(ne,ce,te){for(var ue=0,Ee=0,je=0,gt=0,Qe=0,Fe=te.length,$e=[],st=[];ue<Fe;++ue)$e[ue]=st[ue]=ue,ce[ue]=te[ue];for(;Qe<st.length;++Qe)ue=st[Qe],Ee=ne[ue].L,je=ne[ue].R,gt=ne[ue].C,$e[ue]===ue&&(Ee!==-1&&$e[Ee]!==Ee&&($e[ue]=$e[Ee]),je!==-1&&$e[je]!==je&&($e[ue]=$e[je])),gt!==-1&&($e[gt]=ue),Ee!==-1&&ue!=$e[ue]&&($e[Ee]=$e[ue],st.lastIndexOf(Ee)<Qe&&st.push(Ee)),je!==-1&&ue!=$e[ue]&&($e[je]=$e[ue],st.lastIndexOf(je)<Qe&&st.push(je));for(ue=1;ue<Fe;++ue)$e[ue]===ue&&(je!==-1&&$e[je]!==je?$e[ue]=$e[je]:Ee!==-1&&$e[Ee]!==Ee&&($e[ue]=$e[Ee]));for(ue=1;ue<Fe;++ue)if(ne[ue].type!==0){if(Qe=ue,Qe!=$e[Qe])do Qe=$e[Qe],ce[ue]=ce[Qe]+"/"+ce[ue];while(Qe!==0&&$e[Qe]!==-1&&Qe!=$e[Qe]);$e[ue]=-1}for(ce[0]+="/",ue=1;ue<Fe;++ue)ne[ue].type!==2&&(ce[ue]+="/")}function g(ne,ce,te){for(var ue=ne.start,Ee=ne.size,je=[],gt=ue;te&&Ee>0&&gt>=0;)je.push(ce.slice(gt*T,gt*T+T)),Ee-=T,gt=zh(te,gt*4);return je.length===0?_r(0):Hs(je).slice(0,ne.size)}function y(ne,ce,te,ue,Ee){var je=F;if(ne===F){if(ce!==0)throw new Error("DIFAT chain shorter than expected")}else if(ne!==-1){var gt=te[ne],Qe=(ue>>>2)-1;if(!gt)return;for(var Fe=0;Fe<Qe&&(je=zh(gt,Fe*4))!==F;++Fe)Ee.push(je);y(zh(gt,ue-4),ce-1,te,ue,Ee)}}function b(ne,ce,te,ue,Ee){var je=[],gt=[];Ee||(Ee=[]);var Qe=ue-1,Fe=0,$e=0;for(Fe=ce;Fe>=0;){Ee[Fe]=!0,je[je.length]=Fe,gt.push(ne[Fe]);var st=te[Math.floor(Fe*4/ue)];if($e=Fe*4&Qe,ue<4+$e)throw new Error("FAT boundary crossed: "+Fe+" 4 "+ue);if(!ne[st])break;Fe=zh(ne[st],$e)}return{nodes:je,data:_P([gt])}}function v(ne,ce,te,ue){var Ee=ne.length,je=[],gt=[],Qe=[],Fe=[],$e=ue-1,st=0,Wt=0,qt=0,ht=0;for(st=0;st<Ee;++st)if(Qe=[],qt=st+ce,qt>=Ee&&(qt-=Ee),!gt[qt]){Fe=[];var Ut=[];for(Wt=qt;Wt>=0;){Ut[Wt]=!0,gt[Wt]=!0,Qe[Qe.length]=Wt,Fe.push(ne[Wt]);var Gt=te[Math.floor(Wt*4/ue)];if(ht=Wt*4&$e,ue<4+ht)throw new Error("FAT boundary crossed: "+Wt+" 4 "+ue);if(!ne[Gt]||(Wt=zh(ne[Gt],ht),Ut[Wt]))break}je[qt]={nodes:Qe,data:_P([Fe])}}return je}function w(ne,ce,te,ue,Ee,je,gt,Qe){for(var Fe=0,$e=ue.length?2:0,st=ce[ne].data,Wt=0,qt=0,ht;Wt<st.length;Wt+=128){var Ut=st.slice(Wt,Wt+128);uo(Ut,64),qt=Ut.read_shift(2),ht=U3(Ut,0,qt-$e),ue.push(ht);var Gt={name:ht,type:Ut.read_shift(1),color:Ut.read_shift(1),L:Ut.read_shift(4,"i"),R:Ut.read_shift(4,"i"),C:Ut.read_shift(4,"i"),clsid:Ut.read_shift(16),state:Ut.read_shift(4,"i"),start:0,size:0},cr=Ut.read_shift(2)+Ut.read_shift(2)+Ut.read_shift(2)+Ut.read_shift(2);cr!==0&&(Gt.ct=S(Ut,Ut.l-8));var ir=Ut.read_shift(2)+Ut.read_shift(2)+Ut.read_shift(2)+Ut.read_shift(2);ir!==0&&(Gt.mt=S(Ut,Ut.l-8)),Gt.start=Ut.read_shift(4,"i"),Gt.size=Ut.read_shift(4,"i"),Gt.size<0&&Gt.start<0&&(Gt.size=Gt.type=0,Gt.start=F,Gt.name=""),Gt.type===5?(Fe=Gt.start,Ee>0&&Fe!==F&&(ce[Fe].name="!StreamData")):Gt.size>=4096?(Gt.storage="fat",ce[Gt.start]===void 0&&(ce[Gt.start]=b(te,Gt.start,ce.fat_addrs,ce.ssz)),ce[Gt.start].name=Gt.name,Gt.content=ce[Gt.start].data.slice(0,Gt.size)):(Gt.storage="minifat",Gt.size<0?Gt.size=0:Fe!==F&&Gt.start!==F&&ce[Fe]&&(Gt.content=g(Gt,ce[Fe].data,(ce[Qe]||{}).data))),Gt.content&&uo(Gt.content,0),je[ht]=Gt,gt.push(Gt)}}function S(ne,ce){return new Date((Vl(ne,ce+4)/1e7*Math.pow(2,32)+Vl(ne,ce)/1e7-11644473600)*1e3)}function k(ne,ce){return u(),d(c.readFileSync(ne),ce)}function j(ne,ce){var te=ce&&ce.type;switch(te||fi&&Buffer.isBuffer(ne)&&(te="buffer"),te||"base64"){case"file":return k(ne,ce);case"base64":return d(Gl(ic(ne)),ce);case"binary":return d(Gl(ne),ce)}return d(ne,ce)}function A(ne,ce){var te=ce||{},ue=te.root||"Root Entry";if(ne.FullPaths||(ne.FullPaths=[]),ne.FileIndex||(ne.FileIndex=[]),ne.FullPaths.length!==ne.FileIndex.length)throw new Error("inconsistent CFB structure");ne.FullPaths.length===0&&(ne.FullPaths[0]=ue+"/",ne.FileIndex[0]={name:ue,type:5}),te.CLSID&&(ne.FileIndex[0].clsid=te.CLSID),L(ne)}function L(ne){var ce="Sh33tJ5";if(!zn.find(ne,"/"+ce)){var te=_r(4);te[0]=55,te[1]=te[3]=50,te[2]=54,ne.FileIndex.push({name:ce,type:2,content:te,size:4,L:69,R:69,C:69}),ne.FullPaths.push(ne.FullPaths[0]+ce),P(ne)}}function P(ne,ce){A(ne);for(var te=!1,ue=!1,Ee=ne.FullPaths.length-1;Ee>=0;--Ee){var je=ne.FileIndex[Ee];switch(je.type){case 0:ue?te=!0:(ne.FileIndex.pop(),ne.FullPaths.pop());break;case 1:case 2:case 5:ue=!0,isNaN(je.R*je.L*je.C)&&(te=!0),je.R>-1&&je.L>-1&&je.R==je.L&&(te=!0);break;default:te=!0;break}}if(!(!te&&!ce)){var gt=new Date(1987,1,19),Qe=0,Fe=Object.create?Object.create(null):{},$e=[];for(Ee=0;Ee<ne.FullPaths.length;++Ee)Fe[ne.FullPaths[Ee]]=!0,ne.FileIndex[Ee].type!==0&&$e.push([ne.FullPaths[Ee],ne.FileIndex[Ee]]);for(Ee=0;Ee<$e.length;++Ee){var st=n($e[Ee][0]);ue=Fe[st],ue||($e.push([st,{name:i(st).replace("/",""),type:1,clsid:se,ct:gt,mt:gt,content:null}]),Fe[st]=!0)}for($e.sort(function(ht,Ut){return r(ht[0],Ut[0])}),ne.FullPaths=[],ne.FileIndex=[],Ee=0;Ee<$e.length;++Ee)ne.FullPaths[Ee]=$e[Ee][0],ne.FileIndex[Ee]=$e[Ee][1];for(Ee=0;Ee<$e.length;++Ee){var Wt=ne.FileIndex[Ee],qt=ne.FullPaths[Ee];if(Wt.name=i(qt).replace("/",""),Wt.L=Wt.R=Wt.C=-(Wt.color=1),Wt.size=Wt.content?Wt.content.length:0,Wt.start=0,Wt.clsid=Wt.clsid||se,Ee===0)Wt.C=$e.length>1?1:-1,Wt.size=0,Wt.type=5;else if(qt.slice(-1)=="/"){for(Qe=Ee+1;Qe<$e.length&&n(ne.FullPaths[Qe])!=qt;++Qe);for(Wt.C=Qe>=$e.length?-1:Qe,Qe=Ee+1;Qe<$e.length&&n(ne.FullPaths[Qe])!=n(qt);++Qe);Wt.R=Qe>=$e.length?-1:Qe,Wt.type=1}else n(ne.FullPaths[Ee+1]||"")==n(qt)&&(Wt.R=Ee+1),Wt.type=2}}}function B(ne,ce){var te=ce||{};if(te.fileType=="mad")return It(ne,te);switch(P(ne),te.fileType){case"zip":return Xr(ne,te)}var ue=function(ht){for(var Ut=0,Gt=0,cr=0;cr<ht.FileIndex.length;++cr){var ir=ht.FileIndex[cr];if(ir.content){var Fr=ir.content.length;Fr>0&&(Fr<4096?Ut+=Fr+63>>6:Gt+=Fr+511>>9)}}for(var dn=ht.FullPaths.length+3>>2,vr=Ut+7>>3,Lt=Ut+127>>7,Gr=vr+Gt+dn+Lt,bn=Gr+127>>7,or=bn<=109?0:Math.ceil((bn-109)/127);Gr+bn+or+127>>7>bn;)or=++bn<=109?0:Math.ceil((bn-109)/127);var kr=[1,or,bn,Lt,dn,Gt,Ut,0];return ht.FileIndex[0].size=Ut<<6,kr[7]=(ht.FileIndex[0].start=kr[0]+kr[1]+kr[2]+kr[3]+kr[4]+kr[5])+(kr[6]+7>>3),kr}(ne),Ee=_r(ue[7]<<9),je=0,gt=0;{for(je=0;je<8;++je)Ee.write_shift(1,z[je]);for(je=0;je<8;++je)Ee.write_shift(2,0);for(Ee.write_shift(2,62),Ee.write_shift(2,3),Ee.write_shift(2,65534),Ee.write_shift(2,9),Ee.write_shift(2,6),je=0;je<3;++je)Ee.write_shift(2,0);for(Ee.write_shift(4,0),Ee.write_shift(4,ue[2]),Ee.write_shift(4,ue[0]+ue[1]+ue[2]+ue[3]-1),Ee.write_shift(4,0),Ee.write_shift(4,4096),Ee.write_shift(4,ue[3]?ue[0]+ue[1]+ue[2]-1:F),Ee.write_shift(4,ue[3]),Ee.write_shift(-4,ue[1]?ue[0]-1:F),Ee.write_shift(4,ue[1]),je=0;je<109;++je)Ee.write_shift(-4,je<ue[2]?ue[1]+je:-1)}if(ue[1])for(gt=0;gt<ue[1];++gt){for(;je<236+gt*127;++je)Ee.write_shift(-4,je<ue[2]?ue[1]+je:-1);Ee.write_shift(-4,gt===ue[1]-1?F:gt+1)}var Qe=function(ht){for(gt+=ht;je<gt-1;++je)Ee.write_shift(-4,je+1);ht&&(++je,Ee.write_shift(-4,F))};for(gt=je=0,gt+=ue[1];je<gt;++je)Ee.write_shift(-4,de.DIFSECT);for(gt+=ue[2];je<gt;++je)Ee.write_shift(-4,de.FATSECT);Qe(ue[3]),Qe(ue[4]);for(var Fe=0,$e=0,st=ne.FileIndex[0];Fe<ne.FileIndex.length;++Fe)st=ne.FileIndex[Fe],st.content&&($e=st.content.length,!($e<4096)&&(st.start=gt,Qe($e+511>>9)));for(Qe(ue[6]+7>>3);Ee.l&511;)Ee.write_shift(-4,de.ENDOFCHAIN);for(gt=je=0,Fe=0;Fe<ne.FileIndex.length;++Fe)st=ne.FileIndex[Fe],st.content&&($e=st.content.length,!(!$e||$e>=4096)&&(st.start=gt,Qe($e+63>>6)));for(;Ee.l&511;)Ee.write_shift(-4,de.ENDOFCHAIN);for(je=0;je<ue[4]<<2;++je){var Wt=ne.FullPaths[je];if(!Wt||Wt.length===0){for(Fe=0;Fe<17;++Fe)Ee.write_shift(4,0);for(Fe=0;Fe<3;++Fe)Ee.write_shift(4,-1);for(Fe=0;Fe<12;++Fe)Ee.write_shift(4,0);continue}st=ne.FileIndex[je],je===0&&(st.start=st.size?st.start-1:F);var qt=je===0&&te.root||st.name;if($e=2*(qt.length+1),Ee.write_shift(64,qt,"utf16le"),Ee.write_shift(2,$e),Ee.write_shift(1,st.type),Ee.write_shift(1,st.color),Ee.write_shift(-4,st.L),Ee.write_shift(-4,st.R),Ee.write_shift(-4,st.C),st.clsid)Ee.write_shift(16,st.clsid,"hex");else for(Fe=0;Fe<4;++Fe)Ee.write_shift(4,0);Ee.write_shift(4,st.state||0),Ee.write_shift(4,0),Ee.write_shift(4,0),Ee.write_shift(4,0),Ee.write_shift(4,0),Ee.write_shift(4,st.start),Ee.write_shift(4,st.size),Ee.write_shift(4,0)}for(je=1;je<ne.FileIndex.length;++je)if(st=ne.FileIndex[je],st.size>=4096)if(Ee.l=st.start+1<<9,fi&&Buffer.isBuffer(st.content))st.content.copy(Ee,Ee.l,0,st.size),Ee.l+=st.size+511&-512;else{for(Fe=0;Fe<st.size;++Fe)Ee.write_shift(1,st.content[Fe]);for(;Fe&511;++Fe)Ee.write_shift(1,0)}for(je=1;je<ne.FileIndex.length;++je)if(st=ne.FileIndex[je],st.size>0&&st.size<4096)if(fi&&Buffer.isBuffer(st.content))st.content.copy(Ee,Ee.l,0,st.size),Ee.l+=st.size+63&-64;else{for(Fe=0;Fe<st.size;++Fe)Ee.write_shift(1,st.content[Fe]);for(;Fe&63;++Fe)Ee.write_shift(1,0)}if(fi)Ee.l=Ee.length;else for(;Ee.l<Ee.length;)Ee.write_shift(1,0);return Ee}function E(ne,ce){var te=ne.FullPaths.map(function(Fe){return Fe.toUpperCase()}),ue=te.map(function(Fe){var $e=Fe.split("/");return $e[$e.length-(Fe.slice(-1)=="/"?2:1)]}),Ee=!1;ce.charCodeAt(0)===47?(Ee=!0,ce=te[0].slice(0,-1)+ce):Ee=ce.indexOf("/")!==-1;var je=ce.toUpperCase(),gt=Ee===!0?te.indexOf(je):ue.indexOf(je);if(gt!==-1)return ne.FileIndex[gt];var Qe=!je.match(hx);for(je=je.replace(rl,""),Qe&&(je=je.replace(hx,"!")),gt=0;gt<te.length;++gt)if((Qe?te[gt].replace(hx,"!"):te[gt]).replace(rl,"")==je||(Qe?ue[gt].replace(hx,"!"):ue[gt]).replace(rl,"")==je)return ne.FileIndex[gt];return null}var T=64,F=-2,W="d0cf11e0a1b11ae1",z=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:W,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function U(ne,ce,te){u();var ue=B(ne,te);c.writeFileSync(ce,ue)}function G(ne){for(var ce=new Array(ne.length),te=0;te<ne.length;++te)ce[te]=String.fromCharCode(ne[te]);return ce.join("")}function re(ne,ce){var te=B(ne,ce);switch(ce&&ce.type||"buffer"){case"file":return u(),c.writeFileSync(ce.filename,te),te;case"binary":return typeof te=="string"?te:G(te);case"base64":return u1(typeof te=="string"?te:G(te));case"buffer":if(fi)return Buffer.isBuffer(te)?te:cf(te);case"array":return typeof te=="string"?Gl(te):te}return te}var X;function C(ne){try{var ce=ne.InflateRaw,te=new ce;if(te._processChunk(new Uint8Array([3,0]),te._finishFlushFlag),te.bytesRead)X=ne;else throw new Error("zlib does not expose bytesRead")}catch(ue){console.error("cannot use native zlib: "+(ue.message||ue))}}function K(ne,ce){if(!X)return qr(ne,ce);var te=X.InflateRaw,ue=new te,Ee=ue._processChunk(ne.slice(ne.l),ue._finishFlushFlag);return ne.l+=ue.bytesRead,Ee}function V(ne){return X?X.deflateRawSync(ne):fe(ne)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Y(ne){var ce=(ne<<1|ne<<11)&139536|(ne<<5|ne<<15)&558144;return(ce>>16|ce>>8|ce)&255}for(var Q=typeof Uint8Array<"u",ie=Q?new Uint8Array(256):[],le=0;le<256;++le)ie[le]=Y(le);function O(ne,ce){var te=ie[ne&255];return ce<=8?te>>>8-ce:(te=te<<8|ie[ne>>8&255],ce<=16?te>>>16-ce:(te=te<<8|ie[ne>>16&255],te>>>24-ce))}function H(ne,ce){var te=ce&7,ue=ce>>>3;return(ne[ue]|(te<=6?0:ne[ue+1]<<8))>>>te&3}function ae(ne,ce){var te=ce&7,ue=ce>>>3;return(ne[ue]|(te<=5?0:ne[ue+1]<<8))>>>te&7}function I(ne,ce){var te=ce&7,ue=ce>>>3;return(ne[ue]|(te<=4?0:ne[ue+1]<<8))>>>te&15}function Z(ne,ce){var te=ce&7,ue=ce>>>3;return(ne[ue]|(te<=3?0:ne[ue+1]<<8))>>>te&31}function pe(ne,ce){var te=ce&7,ue=ce>>>3;return(ne[ue]|(te<=1?0:ne[ue+1]<<8))>>>te&127}function Oe(ne,ce,te){var ue=ce&7,Ee=ce>>>3,je=(1<<te)-1,gt=ne[Ee]>>>ue;return te<8-ue||(gt|=ne[Ee+1]<<8-ue,te<16-ue)||(gt|=ne[Ee+2]<<16-ue,te<24-ue)||(gt|=ne[Ee+3]<<24-ue),gt&je}function Ae(ne,ce,te){var ue=ce&7,Ee=ce>>>3;return ue<=5?ne[Ee]|=(te&7)<<ue:(ne[Ee]|=te<<ue&255,ne[Ee+1]=(te&7)>>8-ue),ce+3}function ke(ne,ce,te){var ue=ce&7,Ee=ce>>>3;return te=(te&1)<<ue,ne[Ee]|=te,ce+1}function _e(ne,ce,te){var ue=ce&7,Ee=ce>>>3;return te<<=ue,ne[Ee]|=te&255,te>>>=8,ne[Ee+1]=te,ce+8}function De(ne,ce,te){var ue=ce&7,Ee=ce>>>3;return te<<=ue,ne[Ee]|=te&255,te>>>=8,ne[Ee+1]=te&255,ne[Ee+2]=te>>>8,ce+16}function We(ne,ce){var te=ne.length,ue=2*te>ce?2*te:ce+5,Ee=0;if(te>=ce)return ne;if(fi){var je=iP(ue);if(ne.copy)ne.copy(je);else for(;Ee<ne.length;++Ee)je[Ee]=ne[Ee];return je}else if(Q){var gt=new Uint8Array(ue);if(gt.set)gt.set(ne);else for(;Ee<te;++Ee)gt[Ee]=ne[Ee];return gt}return ne.length=ue,ne}function Ct(ne){for(var ce=new Array(ne),te=0;te<ne;++te)ce[te]=0;return ce}function _t(ne,ce,te){var ue=1,Ee=0,je=0,gt=0,Qe=0,Fe=ne.length,$e=Q?new Uint16Array(32):Ct(32);for(je=0;je<32;++je)$e[je]=0;for(je=Fe;je<te;++je)ne[je]=0;Fe=ne.length;var st=Q?new Uint16Array(Fe):Ct(Fe);for(je=0;je<Fe;++je)$e[Ee=ne[je]]++,ue<Ee&&(ue=Ee),st[je]=0;for($e[0]=0,je=1;je<=ue;++je)$e[je+16]=Qe=Qe+$e[je-1]<<1;for(je=0;je<Fe;++je)Qe=ne[je],Qe!=0&&(st[je]=$e[Qe+16]++);var Wt=0;for(je=0;je<Fe;++je)if(Wt=ne[je],Wt!=0)for(Qe=O(st[je],ue)>>ue-Wt,gt=(1<<ue+4-Wt)-1;gt>=0;--gt)ce[Qe|gt<<Wt]=Wt&15|je<<4;return ue}var Xe=Q?new Uint16Array(512):Ct(512),nt=Q?new Uint16Array(32):Ct(32);if(!Q){for(var Ne=0;Ne<512;++Ne)Xe[Ne]=0;for(Ne=0;Ne<32;++Ne)nt[Ne]=0}(function(){for(var ne=[],ce=0;ce<32;ce++)ne.push(5);_t(ne,nt,32);var te=[];for(ce=0;ce<=143;ce++)te.push(8);for(;ce<=255;ce++)te.push(9);for(;ce<=279;ce++)te.push(7);for(;ce<=287;ce++)te.push(8);_t(te,Xe,288)})();var be=function(){for(var ce=Q?new Uint8Array(32768):[],te=0,ue=0;te<q.length-1;++te)for(;ue<q[te+1];++ue)ce[ue]=te;for(;ue<32768;++ue)ce[ue]=29;var Ee=Q?new Uint8Array(259):[];for(te=0,ue=0;te<J.length-1;++te)for(;ue<J[te+1];++ue)Ee[ue]=te;function je(Qe,Fe){for(var $e=0;$e<Qe.length;){var st=Math.min(65535,Qe.length-$e),Wt=$e+st==Qe.length;for(Fe.write_shift(1,+Wt),Fe.write_shift(2,st),Fe.write_shift(2,~st&65535);st-- >0;)Fe[Fe.l++]=Qe[$e++]}return Fe.l}function gt(Qe,Fe){for(var $e=0,st=0,Wt=Q?new Uint16Array(32768):[];st<Qe.length;){var qt=Math.min(65535,Qe.length-st);if(qt<10){for($e=Ae(Fe,$e,+(st+qt==Qe.length)),$e&7&&($e+=8-($e&7)),Fe.l=$e/8|0,Fe.write_shift(2,qt),Fe.write_shift(2,~qt&65535);qt-- >0;)Fe[Fe.l++]=Qe[st++];$e=Fe.l*8;continue}$e=Ae(Fe,$e,+(st+qt==Qe.length)+2);for(var ht=0;qt-- >0;){var Ut=Qe[st];ht=(ht<<5^Ut)&32767;var Gt=-1,cr=0;if((Gt=Wt[ht])&&(Gt|=st&-32768,Gt>st&&(Gt-=32768),Gt<st))for(;Qe[Gt+cr]==Qe[st+cr]&&cr<250;)++cr;if(cr>2){Ut=Ee[cr],Ut<=22?$e=_e(Fe,$e,ie[Ut+1]>>1)-1:(_e(Fe,$e,3),$e+=5,_e(Fe,$e,ie[Ut-23]>>5),$e+=3);var ir=Ut<8?0:Ut-4>>2;ir>0&&(De(Fe,$e,cr-J[Ut]),$e+=ir),Ut=ce[st-Gt],$e=_e(Fe,$e,ie[Ut]>>3),$e-=3;var Fr=Ut<4?0:Ut-2>>1;Fr>0&&(De(Fe,$e,st-Gt-q[Ut]),$e+=Fr);for(var dn=0;dn<cr;++dn)Wt[ht]=st&32767,ht=(ht<<5^Qe[st])&32767,++st;qt-=cr-1}else Ut<=143?Ut=Ut+48:$e=ke(Fe,$e,1),$e=_e(Fe,$e,ie[Ut]),Wt[ht]=st&32767,++st}$e=_e(Fe,$e,0)-1}return Fe.l=($e+7)/8|0,Fe.l}return function(Fe,$e){return Fe.length<8?je(Fe,$e):gt(Fe,$e)}}();function fe(ne){var ce=_r(50+Math.floor(ne.length*1.1)),te=be(ne,ce);return ce.slice(0,te)}var ge=Q?new Uint16Array(32768):Ct(32768),lt=Q?new Uint16Array(32768):Ct(32768),He=Q?new Uint16Array(128):Ct(128),mt=1,wt=1;function Pt(ne,ce){var te=Z(ne,ce)+257;ce+=5;var ue=Z(ne,ce)+1;ce+=5;var Ee=I(ne,ce)+4;ce+=4;for(var je=0,gt=Q?new Uint8Array(19):Ct(19),Qe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Fe=1,$e=Q?new Uint8Array(8):Ct(8),st=Q?new Uint8Array(8):Ct(8),Wt=gt.length,qt=0;qt<Ee;++qt)gt[R[qt]]=je=ae(ne,ce),Fe<je&&(Fe=je),$e[je]++,ce+=3;var ht=0;for($e[0]=0,qt=1;qt<=Fe;++qt)st[qt]=ht=ht+$e[qt-1]<<1;for(qt=0;qt<Wt;++qt)(ht=gt[qt])!=0&&(Qe[qt]=st[ht]++);var Ut=0;for(qt=0;qt<Wt;++qt)if(Ut=gt[qt],Ut!=0){ht=ie[Qe[qt]]>>8-Ut;for(var Gt=(1<<7-Ut)-1;Gt>=0;--Gt)He[ht|Gt<<Ut]=Ut&7|qt<<3}var cr=[];for(Fe=1;cr.length<te+ue;)switch(ht=He[pe(ne,ce)],ce+=ht&7,ht>>>=3){case 16:for(je=3+H(ne,ce),ce+=2,ht=cr[cr.length-1];je-- >0;)cr.push(ht);break;case 17:for(je=3+ae(ne,ce),ce+=3;je-- >0;)cr.push(0);break;case 18:for(je=11+pe(ne,ce),ce+=7;je-- >0;)cr.push(0);break;default:cr.push(ht),Fe<ht&&(Fe=ht);break}var ir=cr.slice(0,te),Fr=cr.slice(te);for(qt=te;qt<286;++qt)ir[qt]=0;for(qt=ue;qt<30;++qt)Fr[qt]=0;return mt=_t(ir,ge,286),wt=_t(Fr,lt,30),ce}function bt(ne,ce){if(ne[0]==3&&!(ne[1]&3))return[dh(ce),2];for(var te=0,ue=0,Ee=iP(ce||1<<18),je=0,gt=Ee.length>>>0,Qe=0,Fe=0;!(ue&1);){if(ue=ae(ne,te),te+=3,ue>>>1)ue>>1==1?(Qe=9,Fe=5):(te=Pt(ne,te),Qe=mt,Fe=wt);else{te&7&&(te+=8-(te&7));var $e=ne[te>>>3]|ne[(te>>>3)+1]<<8;if(te+=32,$e>0)for(!ce&&gt<je+$e&&(Ee=We(Ee,je+$e),gt=Ee.length);$e-- >0;)Ee[je++]=ne[te>>>3],te+=8;continue}for(;;){!ce&&gt<je+32767&&(Ee=We(Ee,je+32767),gt=Ee.length);var st=Oe(ne,te,Qe),Wt=ue>>>1==1?Xe[st]:ge[st];if(te+=Wt&15,Wt>>>=4,!(Wt>>>8&255))Ee[je++]=Wt;else{if(Wt==256)break;Wt-=257;var qt=Wt<8?0:Wt-4>>2;qt>5&&(qt=0);var ht=je+J[Wt];qt>0&&(ht+=Oe(ne,te,qt),te+=qt),st=Oe(ne,te,Fe),Wt=ue>>>1==1?nt[st]:lt[st],te+=Wt&15,Wt>>>=4;var Ut=Wt<4?0:Wt-2>>1,Gt=q[Wt];for(Ut>0&&(Gt+=Oe(ne,te,Ut),te+=Ut),!ce&&gt<ht&&(Ee=We(Ee,ht+100),gt=Ee.length);je<ht;)Ee[je]=Ee[je-Gt],++je}}}return ce?[Ee,te+7>>>3]:[Ee.slice(0,je),te+7>>>3]}function qr(ne,ce){var te=ne.slice(ne.l||0),ue=bt(te,ce);return ne.l+=ue[1],ue[0]}function Tt(ne,ce){if(ne)typeof console<"u"&&console.error(ce);else throw new Error(ce)}function xr(ne,ce){var te=ne;uo(te,0);var ue=[],Ee=[],je={FileIndex:ue,FullPaths:Ee};A(je,{root:ce.root});for(var gt=te.length-4;(te[gt]!=80||te[gt+1]!=75||te[gt+2]!=5||te[gt+3]!=6)&&gt>=0;)--gt;te.l=gt+4,te.l+=4;var Qe=te.read_shift(2);te.l+=6;var Fe=te.read_shift(4);for(te.l=Fe,gt=0;gt<Qe;++gt){te.l+=20;var $e=te.read_shift(4),st=te.read_shift(4),Wt=te.read_shift(2),qt=te.read_shift(2),ht=te.read_shift(2);te.l+=8;var Ut=te.read_shift(4),Gt=l(te.slice(te.l+Wt,te.l+Wt+qt));te.l+=Wt+qt+ht;var cr=te.l;te.l=Ut+4,Zr(te,$e,st,je,Gt),te.l=cr}return je}function Zr(ne,ce,te,ue,Ee){ne.l+=2;var je=ne.read_shift(2),gt=ne.read_shift(2),Qe=o(ne);if(je&8257)throw new Error("Unsupported ZIP encryption");for(var Fe=ne.read_shift(4),$e=ne.read_shift(4),st=ne.read_shift(4),Wt=ne.read_shift(2),qt=ne.read_shift(2),ht="",Ut=0;Ut<Wt;++Ut)ht+=String.fromCharCode(ne[ne.l++]);if(qt){var Gt=l(ne.slice(ne.l,ne.l+qt));(Gt[21589]||{}).mt&&(Qe=Gt[21589].mt),((Ee||{})[21589]||{}).mt&&(Qe=Ee[21589].mt)}ne.l+=qt;var cr=ne.slice(ne.l,ne.l+$e);switch(gt){case 8:cr=K(ne,st);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+gt)}var ir=!1;je&8&&(Fe=ne.read_shift(4),Fe==134695760&&(Fe=ne.read_shift(4),ir=!0),$e=ne.read_shift(4),st=ne.read_shift(4)),$e!=ce&&Tt(ir,"Bad compressed size: "+ce+" != "+$e),st!=te&&Tt(ir,"Bad uncompressed size: "+te+" != "+st),Ot(ue,ht,cr,{unsafe:!0,mt:Qe})}function Xr(ne,ce){var te=ce||{},ue=[],Ee=[],je=_r(1),gt=te.compression?8:0,Qe=0,Fe=0,$e=0,st=0,Wt=0,qt=ne.FullPaths[0],ht=qt,Ut=ne.FileIndex[0],Gt=[],cr=0;for(Fe=1;Fe<ne.FullPaths.length;++Fe)if(ht=ne.FullPaths[Fe].slice(qt.length),Ut=ne.FileIndex[Fe],!(!Ut.size||!Ut.content||ht=="Sh33tJ5")){var ir=st,Fr=_r(ht.length);for($e=0;$e<ht.length;++$e)Fr.write_shift(1,ht.charCodeAt($e)&127);Fr=Fr.slice(0,Fr.l),Gt[Wt]=Une.buf(Ut.content,0);var dn=Ut.content;gt==8&&(dn=V(dn)),je=_r(30),je.write_shift(4,67324752),je.write_shift(2,20),je.write_shift(2,Qe),je.write_shift(2,gt),Ut.mt?s(je,Ut.mt):je.write_shift(4,0),je.write_shift(-4,Gt[Wt]),je.write_shift(4,dn.length),je.write_shift(4,Ut.content.length),je.write_shift(2,Fr.length),je.write_shift(2,0),st+=je.length,ue.push(je),st+=Fr.length,ue.push(Fr),st+=dn.length,ue.push(dn),je=_r(46),je.write_shift(4,33639248),je.write_shift(2,0),je.write_shift(2,20),je.write_shift(2,Qe),je.write_shift(2,gt),je.write_shift(4,0),je.write_shift(-4,Gt[Wt]),je.write_shift(4,dn.length),je.write_shift(4,Ut.content.length),je.write_shift(2,Fr.length),je.write_shift(2,0),je.write_shift(2,0),je.write_shift(2,0),je.write_shift(2,0),je.write_shift(4,0),je.write_shift(4,ir),cr+=je.l,Ee.push(je),cr+=Fr.length,Ee.push(Fr),++Wt}return je=_r(22),je.write_shift(4,101010256),je.write_shift(2,0),je.write_shift(2,0),je.write_shift(2,Wt),je.write_shift(2,Wt),je.write_shift(4,cr),je.write_shift(4,st),je.write_shift(2,0),Hs([Hs(ue),Hs(Ee),je])}var Br={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Vr(ne,ce){if(ne.ctype)return ne.ctype;var te=ne.name||"",ue=te.match(/\.([^\.]+)$/);return ue&&Br[ue[1]]||ce&&(ue=(te=ce).match(/[\.\\]([^\.\\])+$/),ue&&Br[ue[1]])?Br[ue[1]]:"application/octet-stream"}function An(ne){for(var ce=u1(ne),te=[],ue=0;ue<ce.length;ue+=76)te.push(ce.slice(ue,ue+76));return te.join(`\r
`)+`\r
`}function Yr(ne){var ce=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function($e){var st=$e.charCodeAt(0).toString(16).toUpperCase();return"="+(st.length==1?"0"+st:st)});ce=ce.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ce.charAt(0)==`
`&&(ce="=0D"+ce.slice(1)),ce=ce.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var te=[],ue=ce.split(`\r
`),Ee=0;Ee<ue.length;++Ee){var je=ue[Ee];if(je.length==0){te.push("");continue}for(var gt=0;gt<je.length;){var Qe=76,Fe=je.slice(gt,gt+Qe);Fe.charAt(Qe-1)=="="?Qe--:Fe.charAt(Qe-2)=="="?Qe-=2:Fe.charAt(Qe-3)=="="&&(Qe-=3),Fe=je.slice(gt,gt+Qe),gt+=Qe,gt<je.length&&(Fe+="="),te.push(Fe)}}return te.join(`\r
`)}function Ln(ne){for(var ce=[],te=0;te<ne.length;++te){for(var ue=ne[te];te<=ne.length&&ue.charAt(ue.length-1)=="=";)ue=ue.slice(0,ue.length-1)+ne[++te];ce.push(ue)}for(var Ee=0;Ee<ce.length;++Ee)ce[Ee]=ce[Ee].replace(/[=][0-9A-Fa-f]{2}/g,function(je){return String.fromCharCode(parseInt(je.slice(1),16))});return Gl(ce.join(`\r
`))}function Me(ne,ce,te){for(var ue="",Ee="",je="",gt,Qe=0;Qe<10;++Qe){var Fe=ce[Qe];if(!Fe||Fe.match(/^\s*$/))break;var $e=Fe.match(/^(.*?):\s*([^\s].*)$/);if($e)switch($e[1].toLowerCase()){case"content-location":ue=$e[2].trim();break;case"content-type":je=$e[2].trim();break;case"content-transfer-encoding":Ee=$e[2].trim();break}}switch(++Qe,Ee.toLowerCase()){case"base64":gt=Gl(ic(ce.slice(Qe).join("")));break;case"quoted-printable":gt=Ln(ce.slice(Qe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ee)}var st=Ot(ne,ue.slice(te.length),gt,{unsafe:!0});je&&(st.ctype=je)}function Ce(ne,ce){if(G(ne.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var te=ce&&ce.root||"",ue=(fi&&Buffer.isBuffer(ne)?ne.toString("binary"):G(ne)).split(`\r
`),Ee=0,je="";for(Ee=0;Ee<ue.length;++Ee)if(je=ue[Ee],!!/^Content-Location:/i.test(je)&&(je=je.slice(je.indexOf("file")),te||(te=je.slice(0,je.lastIndexOf("/")+1)),je.slice(0,te.length)!=te))for(;te.length>0&&(te=te.slice(0,te.length-1),te=te.slice(0,te.lastIndexOf("/")+1),je.slice(0,te.length)!=te););var gt=(ue[1]||"").match(/boundary="(.*?)"/);if(!gt)throw new Error("MAD cannot find boundary");var Qe="--"+(gt[1]||""),Fe=[],$e=[],st={FileIndex:Fe,FullPaths:$e};A(st);var Wt,qt=0;for(Ee=0;Ee<ue.length;++Ee){var ht=ue[Ee];ht!==Qe&&ht!==Qe+"--"||(qt++&&Me(st,ue.slice(Wt,Ee),te),Wt=Ee)}return st}function It(ne,ce){var te=ce||{},ue=te.boundary||"SheetJS";ue="------="+ue;for(var Ee=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ue.slice(2)+'"',"","",""],je=ne.FullPaths[0],gt=je,Qe=ne.FileIndex[0],Fe=1;Fe<ne.FullPaths.length;++Fe)if(gt=ne.FullPaths[Fe].slice(je.length),Qe=ne.FileIndex[Fe],!(!Qe.size||!Qe.content||gt=="Sh33tJ5")){gt=gt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(cr){return"_x"+cr.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(cr){return"_u"+cr.charCodeAt(0).toString(16)+"_"});for(var $e=Qe.content,st=fi&&Buffer.isBuffer($e)?$e.toString("binary"):G($e),Wt=0,qt=Math.min(1024,st.length),ht=0,Ut=0;Ut<=qt;++Ut)(ht=st.charCodeAt(Ut))>=32&&ht<128&&++Wt;var Gt=Wt>=qt*4/5;Ee.push(ue),Ee.push("Content-Location: "+(te.root||"file:///C:/SheetJS/")+gt),Ee.push("Content-Transfer-Encoding: "+(Gt?"quoted-printable":"base64")),Ee.push("Content-Type: "+Vr(Qe,gt)),Ee.push(""),Ee.push(Gt?Yr(st):An(st))}return Ee.push(ue+`--\r
`),Ee.join(`\r
`)}function ft(ne){var ce={};return A(ce,ne),ce}function Ot(ne,ce,te,ue){var Ee=ue&&ue.unsafe;Ee||A(ne);var je=!Ee&&zn.find(ne,ce);if(!je){var gt=ne.FullPaths[0];ce.slice(0,gt.length)==gt?gt=ce:(gt.slice(-1)!="/"&&(gt+="/"),gt=(gt+ce).replace("//","/")),je={name:i(ce),type:2},ne.FileIndex.push(je),ne.FullPaths.push(gt),Ee||zn.utils.cfb_gc(ne)}return je.content=te,je.size=te?te.length:0,ue&&(ue.CLSID&&(je.clsid=ue.CLSID),ue.mt&&(je.mt=ue.mt),ue.ct&&(je.ct=ue.ct)),je}function er(ne,ce){A(ne);var te=zn.find(ne,ce);if(te){for(var ue=0;ue<ne.FileIndex.length;++ue)if(ne.FileIndex[ue]==te)return ne.FileIndex.splice(ue,1),ne.FullPaths.splice(ue,1),!0}return!1}function hr(ne,ce,te){A(ne);var ue=zn.find(ne,ce);if(ue){for(var Ee=0;Ee<ne.FileIndex.length;++Ee)if(ne.FileIndex[Ee]==ue)return ne.FileIndex[Ee].name=i(te),ne.FullPaths[Ee]=te,!0}return!1}function Tr(ne){P(ne,!0)}return t.find=E,t.read=j,t.parse=d,t.write=re,t.writeFile=U,t.utils={cfb_new:ft,cfb_add:Ot,cfb_del:er,cfb_mov:hr,cfb_gc:Tr,ReadShift:Cx,CheckField:S$,prep_blob:uo,bconcat:Hs,use_zlib:C,_deflateRaw:fe,_inflateRaw:qr,consts:de},t}();function zne(e){return typeof e=="string"?NS(e):Array.isArray(e)?pne(e):e}function ny(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=NS(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Yu(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([zne(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=_h(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Wne(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ga(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function fP(e,t){for(var r=[],n=Ga(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function ES(e){for(var t=[],r=Ga(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function TS(e){for(var t=[],r=Ga(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function qne(e){for(var t=[],r=Ga(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var $2=new Date(1899,11,30,0,0,0);function Os(e,t){var r=e.getTime(),n=$2.getTime()+(e.getTimezoneOffset()-$2.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var t$=new Date,Hne=$2.getTime()+(t$.getTimezoneOffset()-$2.getTimezoneOffset())*6e4,hP=t$.getTimezoneOffset();function PS(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Hne),t.getTimezoneOffset()!==hP&&t.setTime(t.getTime()+(t.getTimezoneOffset()-hP)*6e4),t}function Vne(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var pP=new Date("2017-02-19T19:06:09.000Z"),r$=isNaN(pP.getFullYear())?new Date("2/19/17"):pP,Gne=r$.getFullYear()==2017;function ma(e,t){var r=new Date(e);if(Gne)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(r$.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function S0(e,t){if(fi&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Yu(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Yu(W9(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Yu(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Yu(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function ga(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ga(e[r]));return t}function qa(e,t){for(var r="";r.length<t;)r+=e;return r}function fu(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Kne=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fm(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Kne.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Yne=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(i),o.push(s[l]);return o}}();function n$(e){return e?e.content&&e.type?S0(e.content,!0):e.data?fx(e.data):e.asNodeBuffer&&fi?fx(e.asNodeBuffer().toString("binary")):e.asBinary?fx(e.asBinary()):e._data&&e._data.getContent?fx(S0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function i$(e){if(!e)return null;if(e.data)return rP(e.data);if(e.asNodeBuffer&&fi)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?rP(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Xne(e){return e&&e.name.slice(-4)===".bin"?i$(e):n$(e)}function Cc(e,t){for(var r=e.FullPaths||Ga(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function R3(e,t){var r=Cc(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function fs(e,t,r){if(!r)return Xne(R3(e,t));if(!t)return null;try{return fs(e,t)}catch{return null}}function Kl(e,t,r){if(!r)return n$(R3(e,t));if(!t)return null;try{return Kl(e,t)}catch{return null}}function Qne(e,t,r){return i$(R3(e,t))}function mP(e){for(var t=e.FullPaths||Ga(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function ui(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return fi?n=cf(r):n=mne(r),zn.utils.cfb_add(e,t,n)}zn.utils.cfb_add(e,t,r)}else e.file(t,r)}function B3(){return zn.utils.cfb_new()}function a$(e,t){switch(t.type){case"base64":return zn.read(e,{type:"base64"});case"binary":return zn.read(e,{type:"binary"});case"buffer":case"array":return zn.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function px(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var ls=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Jne=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,gP=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Zne=/<[^>]*>/g,Uo=ls.match(gP)?gP:Zne,eie=/<\w*:/,tie=/<(\/?)\w+:/;function Xn(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(Jne),l=0,c="",u=0,d="",f="",h=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(h=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+h,f.length-h),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var p=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[p]&&d.slice(l-3,l)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function cd(e){return e.replace(tie,"<$1")}var s$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},F3=ES(s$),Si=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(l,c){return s$[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),I3=/[&<>'"]/g,rie=/[\u0000-\u0008\u000b-\u001f]/g;function Wi(e){var t=e+"";return t.replace(I3,function(r){return F3[r]}).replace(rie,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function xP(e){return Wi(e).replace(/ /g,"_x0020_")}var o$=/[\u0000-\u001f]/g;function D3(e){var t=e+"";return t.replace(I3,function(r){return F3[r]}).replace(/\n/g,"<br/>").replace(o$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function nie(e){var t=e+"";return t.replace(I3,function(r){return F3[r]}).replace(o$,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var yP=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function iie(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function fa(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Z5(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function bP(e){var t=dh(2*e.length),r,n,i=1,s=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function vP(e){return cf(e,"binary").toString("utf8")}var _b="foo bar baz",Ki=fi&&(vP(_b)==Z5(_b)&&vP||bP(_b)==Z5(_b)&&bP)||Z5,Yu=fi?function(e){return cf(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},f1=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),l$=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),aie=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),sie=/<\/?(?:vt:)?variant>/g,oie=/<(?:vt:)([^>]*)>([\s\S]*)</;function wP(e,t){var r=Xn(e),n=e.match(aie(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(sie,"").match(oie);o&&i.push({v:Ki(o[2]),t:o[1]})}),i}var c$=/(^\s|\s$|\n)/;function fo(e,t){return"<"+e+(t.match(c$)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function h1(e){return Ga(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ln(e,t,r){return"<"+e+(r!=null?h1(r):"")+(t!=null?(t.match(c$)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function D4(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function lie(e,t){switch(typeof e){case"string":var r=ln("vt:lpwstr",Wi(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ln((e|0)==e?"vt:i4":"vt:r8",Wi(String(e)));case"boolean":return ln("vt:bool",e?"true":"false")}if(e instanceof Date)return ln("vt:filetime",D4(e));throw new Error("Unable to serialize "+e)}function $3(e){if(fi&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ki(_h(O3(e)));throw new Error("Bad input format: expected Buffer or string")}var p1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ts={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Y0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Hl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function cie(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function uie(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var SP=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},_P=fi?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:cf(t)})):SP(e)}:SP,kP=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Ld(e,i)));return n.join("").replace(rl,"")},U3=fi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(rl,""):kP(e,t,r)}:kP,jP=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},u$=fi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):jP(e,t,r)}:jP,AP=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Rp(e,i)));return n.join("")},iy=fi?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):AP(t,r,n)}:AP,d$=function(e,t){var r=Vl(e,t);return r>0?iy(e,t+4,t+4+r-1):""},f$=d$,h$=function(e,t){var r=Vl(e,t);return r>0?iy(e,t+4,t+4+r-1):""},p$=h$,m$=function(e,t){var r=2*Vl(e,t);return r>0?iy(e,t+4,t+4+r-1):""},g$=m$,x$=function(t,r){var n=Vl(t,r);return n>0?U3(t,r+4,r+4+n):""},y$=x$,b$=function(e,t){var r=Vl(e,t);return r>0?iy(e,t+4,t+4+r):""},v$=b$,w$=function(e,t){return cie(e,t)},U2=w$,z3=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};fi&&(f$=function(t,r){if(!Buffer.isBuffer(t))return d$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},p$=function(t,r){if(!Buffer.isBuffer(t))return h$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},g$=function(t,r){if(!Buffer.isBuffer(t))return m$(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},y$=function(t,r){if(!Buffer.isBuffer(t))return x$(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},v$=function(t,r){if(!Buffer.isBuffer(t))return b$(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},U2=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):w$(t,r)},z3=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Rp=function(e,t){return e[t]},Ld=function(e,t){return e[t+1]*256+e[t]},die=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Vl=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},zh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},fie=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Cx(e,t){var r="",n,i,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,fi&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ld(this,u)),u+=2;e*=2;break;case"utf8":r=iy(this,this.l,this.l+e);break;case"utf16le":e*=2,r=U3(this,this.l,this.l+e);break;case"wstr":return Cx.call(this,e,"dbcs");case"lpstr-ansi":r=f$(this,this.l),e=4+Vl(this,this.l);break;case"lpstr-cp":r=p$(this,this.l),e=4+Vl(this,this.l);break;case"lpwstr":r=g$(this,this.l),e=4+2*Vl(this,this.l);break;case"lpp4":e=4+Vl(this,this.l),r=y$(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Vl(this,this.l),r=v$(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Rp(this,this.l+e++))!==0;)s.push(Sb(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Ld(this,this.l+e))!==0;)s.push(Sb(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Rp(this,u),this.l=u+1,l=Cx.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Sb(Ld(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Rp(this,u),this.l=u+1,l=Cx.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(Sb(Rp(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Rp(this,this.l),this.l++,n;case 2:return n=(t==="i"?die:Ld)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?zh:fie)(this,this.l),this.l+=4,n):(i=Vl(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=U2(this,this.l):i=U2([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=u$(this,this.l,e);break}}return this.l+=e,r}var hie=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},pie=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},mie=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function gie(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)mie(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,hie(this,t,this.l);break;case 8:if(n=8,r==="f"){uie(this,t,this.l);break}case 16:break;case-4:n=4,pie(this,t,this.l);break}return this.l+=n,this}function S$(e,t){var r=u$(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function uo(e,t){e.l=t,e.read_shift=Cx,e.chk=S$,e.write_shift=gie}function Do(e,t){e.l+=t}function _r(e){var t=dh(e);return uo(t,0),t}function uf(e,t,r){if(e){var n,i,s;uo(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=v1[l]||v1[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;c=e.l+s;var d=u.f&&u.f(e,s,r);if(e.l=c,t(d,u,l))return}}}function Cl(){var e=[],t=fi?256:2048,r=function(u){var d=_r(u);return uo(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Hs(e)},l=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function Dr(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=v1[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&z3(r)&&e.push(r)}}function Ex(e,t,r){var n=ga(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function NP(e,t,r){var n=ga(e);return n.s=Ex(n.s,t.s,r),n.e=Ex(n.e,t.s,r),n}function Tx(e,t){if(e.cRel&&e.c<0)for(e=ga(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ga(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Yn(e);return!e.cRel&&e.cRel!=null&&(r=bie(r)),!e.rRel&&e.rRel!=null&&(r=xie(r)),r}function ek(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ea(e.s.c)+":"+(e.e.cRel?"":"$")+Ea(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+os(e.s.r)+":"+(e.e.rRel?"":"$")+os(e.e.r):Tx(e.s,t.biff)+":"+Tx(e.e,t.biff)}function W3(e){return parseInt(yie(e),10)-1}function os(e){return""+(e+1)}function xie(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function yie(e){return e.replace(/\$(\d+)$/,"$1")}function q3(e){for(var t=vie(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ea(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function bie(e){return e.replace(/^([A-Z])/,"$$$1")}function vie(e){return e.replace(/^\$([A-Z])/,"$1")}function wie(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ta(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Yn(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function El(e){var t=e.indexOf(":");return t==-1?{s:Ta(e),e:Ta(e)}:{s:Ta(e.slice(0,t)),e:Ta(e.slice(t+1))}}function si(e,t){return typeof t>"u"||typeof t=="number"?si(e.s,e.e):(typeof e!="string"&&(e=Yn(e)),typeof t!="string"&&(t=Yn(t)),e==t?e:e+":"+t)}function _i(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function CP(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Dc(e.z,r?Os(t):t)}catch{}try{return e.w=Dc((e.XF||{}).numFmtId||(r?14:0),r?Os(t):t)}catch{return""+t}}function Yd(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?df[e.v]||e.v:t==null?CP(e,e.v):CP(e,t))}function kh(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function _$(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ta(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=_i(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var p={v:t[f][h]},m=o+f,g=l+h;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))p=t[f][h];else if(Array.isArray(p.v)&&(p.f=t[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Vn[14],n.cellDates?(p.t="d",p.w=Dc(p.z,Os(p.v))):(p.t="n",p.v=Os(p.v),p.w=Dc(p.z,p.v))):p.t="s";if(i)s[m]||(s[m]=[]),s[m][g]&&s[m][g].z&&(p.z=s[m][g].z),s[m][g]=p;else{var y=Yn({c:g,r:m});s[y]&&s[y].z&&(p.z=s[y].z),s[y]=p}}}return u.s.c<1e7&&(s["!ref"]=si(u)),s}function lg(e,t){return _$(null,e,t)}function Sie(e){return e.read_shift(4,"i")}function hu(e,t){return t||(t=_r(4)),t.write_shift(4,e),t}function Bo(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Vs(e,t){var r=!1;return t==null&&(r=!0,t=_r(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function _ie(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function kie(e,t){return t||(t=_r(4)),t.write_shift(2,0),t.write_shift(2,0),t}function H3(e,t){var r=e.l,n=e.read_shift(1),i=Bo(e),s=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(_ie(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function jie(e,t){var r=!1;return t==null&&(r=!0,t=_r(15+4*e.t.length)),t.write_shift(1,0),Vs(e.t,t),r?t.slice(0,t.l):t}var Aie=H3;function Nie(e,t){var r=!1;return t==null&&(r=!0,t=_r(23+4*e.t.length)),t.write_shift(1,1),Vs(e.t,t),t.write_shift(4,1),kie({},t),r?t.slice(0,t.l):t}function Hc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function X0(e,t){return t==null&&(t=_r(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Q0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function J0(e,t){return t==null&&(t=_r(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Cie=Bo,k$=Vs;function V3(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function z2(e,t){var r=!1;return t==null&&(r=!0,t=_r(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Eie=Bo,$4=V3,G3=z2;function K3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?U2([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):zh(t,0)>>2;return r?i/100:i}function j$(e,t){t==null&&(t=_r(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function A$(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Tie(e,t){return t||(t=_r(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Z0=A$,cg=Tie;function Ro(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _0(e,t){return(t||_r(8)).write_shift(8,e,"f")}function Pie(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=i0[i];u&&(t.rgb=g1(u));break;case 2:t.rgb=g1([o,l,c]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function W2(e,t){if(t||(t=_r(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Oie(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Mie(e,t){t||(t=_r(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function N$(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Lie(e){return N$(e,1)}function Rie(e){return N$(e,2)}var Y3=2,gl=3,kb=11,EP=12,q2=19,jb=64,Bie=65,Fie=71,Iie=4108,Die=4126,Us=80,C$=81,$ie=[Us,C$],U4={1:{n:"CodePage",t:Y3},2:{n:"Category",t:Us},3:{n:"PresentationFormat",t:Us},4:{n:"ByteCount",t:gl},5:{n:"LineCount",t:gl},6:{n:"ParagraphCount",t:gl},7:{n:"SlideCount",t:gl},8:{n:"NoteCount",t:gl},9:{n:"HiddenCount",t:gl},10:{n:"MultimediaClipCount",t:gl},11:{n:"ScaleCrop",t:kb},12:{n:"HeadingPairs",t:Iie},13:{n:"TitlesOfParts",t:Die},14:{n:"Manager",t:Us},15:{n:"Company",t:Us},16:{n:"LinksUpToDate",t:kb},17:{n:"CharacterCount",t:gl},19:{n:"SharedDoc",t:kb},22:{n:"HyperlinksChanged",t:kb},23:{n:"AppVersion",t:gl,p:"version"},24:{n:"DigSig",t:Bie},26:{n:"ContentType",t:Us},27:{n:"ContentStatus",t:Us},28:{n:"Language",t:Us},29:{n:"Version",t:Us},255:{},2147483648:{n:"Locale",t:q2},2147483651:{n:"Behavior",t:q2},1919054434:{}},z4={1:{n:"CodePage",t:Y3},2:{n:"Title",t:Us},3:{n:"Subject",t:Us},4:{n:"Author",t:Us},5:{n:"Keywords",t:Us},6:{n:"Comments",t:Us},7:{n:"Template",t:Us},8:{n:"LastAuthor",t:Us},9:{n:"RevNumber",t:Us},10:{n:"EditTime",t:jb},11:{n:"LastPrinted",t:jb},12:{n:"CreatedDate",t:jb},13:{n:"ModifiedDate",t:jb},14:{n:"PageCount",t:gl},15:{n:"WordCount",t:gl},16:{n:"CharCount",t:gl},17:{n:"Thumbnail",t:Fie},18:{n:"Application",t:Us},19:{n:"DocSecurity",t:gl},255:{},2147483648:{n:"Locale",t:q2},2147483651:{n:"Behavior",t:q2},1919054434:{}},TP={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Uie=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function zie(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Wie=zie([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),i0=ga(Wie),df={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},E$={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},W4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ab={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function X3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function qie(e){var t=X3();if(!e||!e.match)return t;var r={};if((e.match(Uo)||[]).forEach(function(n){var i=Xn(n);switch(i[0].replace(eie,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[W4[i.ContentType]]!==void 0&&t[W4[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Ts.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function T$(e,t){var r=qne(W4),n=[],i;n[n.length]=ls,n[n.length]=ln("Types",null,{xmlns:Ts.CT,"xmlns:xsd":Ts.xsd,"xmlns:xsi":Ts.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ln("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(i=e[c][0],n[n.length]=ln("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ab[c][t.bookType]||Ab[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ln("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ab[c][t.bookType]||Ab[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ln("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var hi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function m1(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Px(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Uo)||[]).forEach(function(i){var s=Xn(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:px(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function mm(e){var t=[ls,ln("Relationships",null,{xmlns:Ts.RELS})];return Ga(e["!id"]).forEach(function(r){t[t.length]=ln("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function $i(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[hi.HLINK,hi.XPATH,hi.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var Hie="application/vnd.oasis.opendocument.spreadsheet";function Vie(e,t){for(var r=$3(e),n,i;n=p1.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Xn(n[0],!1),i.path=="/"&&i.type!==Hie)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Gie(e){var t=[ls];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function PP(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Kie(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Yie(e){var t=[ls];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(PP(e[r][0],e[r][1])),t.push(Kie("",e[r][0]));return t.push(PP("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function P$(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+B2.version+"</meta:generator></office:meta></office:document-meta>"}var Bc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Xie=function(){for(var e=new Array(Bc.length),t=0;t<Bc.length;++t){var r=Bc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function O$(e){var t={};e=Ki(e);for(var r=0;r<Bc.length;++r){var n=Bc[r],i=e.match(Xie[r]);i!=null&&i.length>0&&(t[n[1]]=Si(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=ma(t[n[1]]))}return t}function tk(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Wi(t),n[n.length]=r?ln(e,t,r):fo(e,t))}function M$(e,t){var r=t||{},n=[ls,ln("cp:coreProperties",null,{"xmlns:cp":Ts.CORE_PROPS,"xmlns:dc":Ts.dc,"xmlns:dcterms":Ts.dcterms,"xmlns:dcmitype":Ts.dcmitype,"xmlns:xsi":Ts.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&tk("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:D4(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&tk("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:D4(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Bc.length;++s){var o=Bc[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&tk(o[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var a0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],L$=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function R$(e,t,r,n){var i=[];if(typeof e=="string")i=wP(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(d){return{v:d}}));var o=typeof t=="string"?wP(t,n).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(c=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function Qie(e,t,r){var n={};return t||(t={}),e=Ki(e),a0.forEach(function(i){var s=(e.match(f1(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=Si(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&R$(n.HeadingPairs,n.TitlesOfParts,t,r),t}function B$(e){var t=[],r=ln;return e||(e={}),e.Application="SheetJS",t[t.length]=ls,t[t.length]=ln("Properties",null,{xmlns:Ts.EXT_PROPS,"xmlns:vt":Ts.vt}),a0.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Wi(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Wi(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Jie=/<[^>]+>[^<]*/g;function Zie(e,t){var r={},n="",i=e.match(Jie);if(i)for(var s=0;s!=i.length;++s){var o=i[s],l=Xn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Si(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Si(d);break;case"bool":r[n]=fa(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=ma(d);break;case"cy":case"error":r[n]=Si(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function F$(e){var t=[ls,ln("Properties",null,{xmlns:Ts.CUST_PROPS,"xmlns:vt":Ts.vt})];if(!e)return t.join("");var r=1;return Ga(e).forEach(function(i){++r,t[t.length]=ln("property",lie(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Wi(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var q4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rk;function eae(e,t,r){rk||(rk=ES(q4)),t=rk[t]||t,e[t]=r}function tae(e,t){var r=[];return Ga(q4).map(function(n){for(var i=0;i<Bc.length;++i)if(Bc[i][1]==n)return Bc[i];for(i=0;i<a0.length;++i)if(a0[i][1]==n)return a0[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(fo(q4[n[1]]||n[1],i))}}),ln("DocumentProperties",r.join(""),{xmlns:Hl.o})}function rae(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Ga(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<Bc.length;++o)if(s==Bc[o][1])return;for(o=0;o<a0.length;++o)if(s==a0[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),i.push(ln(xP(s),l,{"dt:dt":c}))}}),t&&Ga(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(ln(xP(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Hl.o+'">'+i.join("")+"</"+n+">"}function Q3(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function nae(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=_r(8);return o.write_shift(4,n),o.write_shift(4,i),o}function I$(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function D$(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function $$(e,t,r){return t===31?D$(e):I$(e,t,r)}function H4(e,t,r){return $$(e,t,r===!1?0:4)}function iae(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return $$(e,t,0)}function aae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(rl,""),e.l-i&2&&(e.l+=2)}return r}function sae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(rl,"");return r}function oae(e){var t=e.l,r=H2(e,C$);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=H2(e,gl);return[r,n]}function lae(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(oae(e));return r}function OP(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(rl,"").replace(hx,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function U$(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function cae(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function H2(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==EP&&n!==t&&$ie.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===EP?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return I$(e,n,4).replace(rl,"");case 31:return D$(e);case 64:return Q3(e);case 65:return U$(e);case 71:return cae(e);case 80:return H4(e,n,!s.raw).replace(rl,"");case 81:return iae(e,n).replace(rl,"");case 4108:return lae(e);case 4126:case 4127:return n==4127?aae(e):sae(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function MP(e,t){var r=_r(4),n=_r(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=_r(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=nae(t);break;case 31:case 80:for(n=_r(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Hs([r,n])}function LP(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=i;++o){var d=e.read_shift(4),f=e.read_shift(4);s[o]=[d,f+r]}s.sort(function(v,w){return v[1]-w[1]});var h={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var p=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],p=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],p=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(p=!1,e.l=s[o][1]),p)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var m=t[s[o][0]];if(h[m.n]=H2(e,m.t,{raw:!0}),m.p==="version"&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(h[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:lu(l=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(s[o][0]===1){if(l=h.CodePage=H2(e,Y3),lu(l),c!==-1){var g=e.l;e.l=s[c][1],u=OP(e,l),e.l=g}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}u=OP(e,l)}else{var y=u[s[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=U$(e);break;case 30:e.l+=4,b=H4(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=H4(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=Za(e,4);break;case 64:e.l+=4,b=ma(Q3(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[y]=b}}return e.l=r+n,h}var z$=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function uae(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function RP(e,t,r){var n=_r(8),i=[],s=[],o=8,l=0,c=_r(8),u=_r(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),o+=8+c.length,!t){u=_r(8),u.write_shift(4,0),i.unshift(u);var d=[_r(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=_r(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Hs(d),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(z$.indexOf(e[l][0])>-1||L$.indexOf(e[l][0])>-1)&&e[l][1]!=null){var h=e[l][1],p=0;if(t){p=+t[e[l][0]];var m=r[p];if(m.p=="version"&&typeof h=="string"){var g=h.split(".");h=(+g[0]<<16)+(+g[1]||0)}c=MP(m.t,h)}else{var y=uae(h);y==-1&&(y=31,h=String(h)),c=MP(y,h)}s.push(c),u=_r(8),u.write_shift(4,t?p:2+l),i.push(u),o+=8+c.length}var b=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,b),b+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Hs([n].concat(i).concat(s))}function BP(e,t,r){var n=e.content;if(!n)return{};uo(n,0);var i,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==zn.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=LP(n,t),h={SystemIdentifier:u};for(var p in f)h[p]=f[p];if(h.FMTID=s,i===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=LP(n,null)}catch{}for(p in m)h[p]=m[p];return h.FMTID=[s,o],h}function FP(e,t,r,n,i,s){var o=_r(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,zn.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var c=RP(e,r,n);if(l.push(c),i){var u=RP(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Hs(l)}function Nf(e,t){return e.read_shift(t),null}function dae(e,t){t||(t=_r(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function fae(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Za(e,t){return e.read_shift(t)===1}function Qo(e,t){return t||(t=_r(2)),t.write_shift(2,+!!e),t}function hs(e){return e.read_shift(2,"u")}function Ec(e,t){return t||(t=_r(2)),t.write_shift(2,e),t}function W$(e,t){return fae(e,t,hs)}function hae(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function q$(e,t,r){return r||(r=_r(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ay(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function pae(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,l,c={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=l),c.t=d,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function mae(e){var t=e.t||"",r=_r(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=_r(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Hs(i)}function k0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function sy(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):k0(e,n,r)}function ep(e,t,r){if(r.biff>5)return sy(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function H$(e,t,r){return r||(r=_r(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function gae(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function xae(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(rl,"");return n&&(e.l+=24),i}function yae(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(rl,"");return r+o}function bae(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return xae(e);case"0303000000000000c000000000000046":return yae(e);default:throw new Error("Unsupported Moniker "+r)}}function Nb(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(rl,""):"";return r}function IP(e,t){t||(t=_r(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function vae(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,l,c,u="",d,f;i&16&&(s=Nb(e,r-e.l)),i&128&&(o=Nb(e,r-e.l)),(i&257)===257&&(l=Nb(e,r-e.l)),(i&257)===1&&(c=bae(e,r-e.l)),i&8&&(u=Nb(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(f=Q3(e)),e.l=r;var h=o||l||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),i&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return d&&(p.guid=d),f&&(p.time=f),s&&(p.Tooltip=s),p}function wae(e){var t=_r(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),IP(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&IP(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function V$(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function G$(e,t){var r=V$(e);return r[3]=0,r}function ud(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function j0(e,t,r,n){return n||(n=_r(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Sae(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function _ae(e,t,r){return t===0?"":ep(e,t,r)}function kae(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function K$(e){var t=e.read_shift(2),r=K3(e);return[t,r]}function jae(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=ay(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function OS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function Y$(e,t){return t||(t=_r(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function X$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var Aae=X$;function Q$(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Nae(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Cae(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function So(e){e.l+=2,e.l+=e.read_shift(2)}var Eae={0:So,4:So,5:So,6:So,7:Cae,8:So,9:So,10:So,11:So,12:So,13:Nae,14:So,15:So,16:So,17:So,18:So,19:So,20:So,21:Q$};function Tae(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(Eae[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Cb(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function J3(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=_r(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Pae(e,t){return t===0||e.read_shift(2),1200}function Oae(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=ep(e,0,r);return e.read_shift(t+n-e.l),i}function Mae(e,t){var r=!t||t.biff==8,n=_r(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Lae(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Rae(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=ay(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function Bae(e,t){var r=!t||t.biff>=8?2:1,n=_r(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Fae(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(pae(e));return s.Count=n,s.Unique=i,s}function Iae(e,t){var r=_r(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=mae(e[i]);var s=Hs([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function Dae(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function $ae(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Uae(e){var t=Sae(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function zae(e){return e.read_shift(2),e.read_shift(4)}function DP(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function Wae(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function qae(){var e=_r(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Hae(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Vae(e){var t=_r(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Gae(){}function Kae(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ay(e,0,r),n}function Yae(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=_r(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function Xae(e){var t=ud(e);return t.isst=e.read_shift(4),t}function Qae(e,t,r,n){var i=_r(10);return j0(e,t,n,i),i.write_shift(4,r),i}function Jae(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=ud(e);r.biff==2&&e.l++;var s=sy(e,n-e.l,r);return i.val=s,i}function Zae(e,t,r,n,i){var s=!i||i.biff==8,o=_r(8+ +s+(1+s)*r.length);return j0(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function ese(e,t,r){var n=e.read_shift(2),i=ep(e,0,r);return[n,i]}function tse(e,t,r,n){var i=r&&r.biff==5;n||(n=_r(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var rse=ep;function $P(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c}}}function nse(e,t){var r=t.biff==8||!t.biff?4:2,n=_r(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function ise(e){var t=e.read_shift(2),r=e.read_shift(2),n=K$(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function ase(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(K$(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function sse(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function ose(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return i.patternType=Uie[l>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function lse(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=ose(e,t,n.fStyle,r),n}function UP(e,t,r,n){var i=r&&r.biff==5;n||(n=_r(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function cse(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function use(e){var t=_r(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function zP(e,t,r){var n=ud(e);(r.biff==2||t==9)&&++e.l;var i=hae(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function dse(e,t,r,n,i,s){var o=_r(8);return j0(e,t,n,o),q$(r,s,o),o}function fse(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ud(e),i=Ro(e);return n.val=i,n}function hse(e,t,r,n){var i=_r(14);return j0(e,t,n,i),_0(r,i),i}var WP=_ae;function pse(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=k0(e,s),l=[];n>e.l;)l.push(sy(e));return[s,i,o,l]}function qP(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=jae(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var mse=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function HP(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=k0(e,o,r);i&32&&(u=mse[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||l===0||!(d>0)?[]:Tue(e,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function J$(e,t,r){if(r.biff<8)return gse(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(kae(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function gse(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ay(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function xse(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=k0(e,n,r),o=k0(e,i,r);return[s,o]}function yse(e,t,r){var n=X$(e);e.l++;var i=e.read_shift(1);return t-=8,[Pue(e,t,r),i,n]}function VP(e,t,r){var n=Aae(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Cue(e,t,r)]}function bse(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function vse(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=ep(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,s]}}function wse(e,t,r){return vse(e,t,r)}function Sse(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(OS(e));return r}function _se(e){var t=_r(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Y$(e[r],t);return t}function kse(e,t,r){if(r&&r.biff<8)return Ase(e,t,r);var n=Q$(e),i=Tae(e,t-22,n[1]);return{cmo:n,ft:i}}var jse={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Ase(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((jse[n]||Do)(e,t,r)),{cmo:[i,n,s],ft:o}}function Nse(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=gae(e,6,r);var l=e.read_shift(2);e.read_shift(2),hs(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=k0(e,e.lens[u+1]-e.lens[u]-1);if(i+=f,i.length>=(d?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function Cse(e,t){var r=OS(e);e.l+=16;var n=vae(e,t-24);return[r,n]}function Ese(e){var t=_r(24),r=Ta(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Hs([t,wae(e[1])])}function Tse(e,t){e.read_shift(2);var r=OS(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(rl,""),[r,n]}function Pse(e){var t=e[1].Tooltip,r=_r(10+2*(t.length+1));r.write_shift(2,2048);var n=Ta(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function Ose(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=TP[r]||r,r=e.read_shift(2),t[1]=TP[r]||r,t}function Mse(e){return e||(e=_r(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Lse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(G$(e));return r}function Rse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(G$(e));return r}function Bse(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Z$(e,t,r){if(!r.cellStyles)return Do(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Fse(e,t){var r=_r(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Ise(e,t){var r={};return t<32||(e.l+=16,r.header=Ro(e),r.footer=Ro(e),e.l+=2),r}function Dse(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function $se(e){for(var t=_r(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Use=ud,zse=W$,Wse=sy;function qse(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function Hse(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ud(e);++e.l;var i=ep(e,t-7,r);return n.t="str",n.val=i,n}function Vse(e){var t=ud(e);++e.l;var r=Ro(e);return t.t="n",t.val=r,t}function Gse(e,t,r){var n=_r(15);return uy(n,e,t),n.write_shift(8,r,"f"),n}function Kse(e){var t=ud(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Yse(e,t,r){var n=_r(9);return uy(n,e,t),n.write_shift(2,r),n}function Xse(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Qse(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Jse(e,t,r){var n=e.l+t,i=ud(e),s=e.read_shift(2),o=k0(e,s,r);return e.l=n,i.t="str",i.val=o,i}var Zse=[2,3,48,49,131,139,140,245],V4=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ES({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=dh(1);switch(c.type){case"base64":d=Gl(ic(l));break;case"binary":d=Gl(l);break;case"buffer":case"array":d=l;break}uo(d,0);var f=d.read_shift(1),h=!!(f&136),p=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=d.read_shift(2));var b=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var w=[],S={},k=Math.min(d.length,f==2?521:y-10-(p?264:0)),j=m?32:11;d.l<k&&d[d.l]!=13;)switch(S={},S.name=c1.utils.decode(v,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,S.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(S.offset=d.read_shift(4)),S.len=d.read_shift(1),f==2&&(S.offset=d.read_shift(2)),S.dec=d.read_shift(1),S.name.length&&w.push(S),f!=2&&(d.l+=m?13:14),S.type){case"B":(!p||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var A=0,L=0;for(u[0]=[],L=0;L!=w.length;++L)u[0][L]=w[L].name;for(;g-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++A]=[],L=0,L=0;L!=w.length;++L){var P=d.slice(d.l,d.l+w[L].len);d.l+=w[L].len,uo(P,0);var B=c1.utils.decode(v,P);switch(w[L].type){case"C":B.trim().length&&(u[A][L]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[A][L]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[A][L]=B;break;case"F":u[A][L]=parseFloat(B.trim());break;case"+":case"I":u[A][L]=m?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[A][L]=!0;break;case"N":case"F":u[A][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[A][L]="##MEMO##"+(m?parseInt(B.trim(),10):P.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[A][L]=+B||0);break;case"@":u[A][L]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[A][L]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[A][L]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][L]=-P.read_shift(-8,"f");break;case"B":if(p&&w[L].len==8){u[A][L]=P.read_shift(8,"f");break}case"G":case"P":P.l+=w[L].len;break;case"0":if(w[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[L].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=lg(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function i(l,c){try{return kh(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&lu(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Cl(),f=K2(l,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),m=l["!cols"]||[],g=0,y=0,b=0,v=1;for(g=0;g<h.length;++g){if(((m[g]||{}).DBF||{}).name){h[g]=m[g].DBF.name,++b;continue}if(h[g]!=null){if(++b,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(y=0;y<1024;++y)if(h.indexOf(h[g]+"_"+y)==-1){h[g]+="_"+y;break}}}}var w=_i(l["!ref"]),S=[],k=[],j=[];for(g=0;g<=w.e.c-w.s.c;++g){var A="",L="",P=0,B=[];for(y=0;y<p.length;++y)p[y][g]!=null&&B.push(p[y][g]);if(B.length==0||h[g]==null){S[g]="?";continue}for(y=0;y<B.length;++y){switch(typeof B[y]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=B[y]instanceof Date?"D":"C";break;default:L="C"}P=Math.max(P,String(B[y]).length),A=A&&A!=L?"C":L}P>250&&(P=250),L=((m[g]||{}).DBF||{}).type,L=="C"&&m[g].DBF.len>P&&(P=m[g].DBF.len),A=="B"&&L=="N"&&(A="N",j[g]=m[g].DBF.dec,P=m[g].DBF.len),k[g]=A=="C"||L=="N"?P:s[A]||0,v+=k[g],S[g]=A}var E=d.next(32);for(E.write_shift(4,318902576),E.write_shift(4,p.length),E.write_shift(2,296+32*b),E.write_shift(2,v),g=0;g<4;++g)E.write_shift(4,0);for(E.write_shift(4,0|(+t[z9]||3)<<8),g=0,y=0;g<h.length;++g)if(h[g]!=null){var T=d.next(32),F=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,F,"sbcs"),T.write_shift(1,S[g]=="?"?"C":S[g],"sbcs"),T.write_shift(4,y),T.write_shift(1,k[g]||s[S[g]]||0),T.write_shift(1,j[g]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),y+=k[g]||s[S[g]]||0}var W=d.next(264);for(W.write_shift(4,13),g=0;g<65;++g)W.write_shift(4,0);for(g=0;g<p.length;++g){var z=d.next(v);for(z.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(S[y]){case"L":z.write_shift(1,p[g][y]==null?63:p[g][y]?84:70);break;case"B":z.write_shift(8,p[g][y]||0,"f");break;case"N":var se="0";for(typeof p[g][y]=="number"&&(se=p[g][y].toFixed(j[y]||0)),b=0;b<k[y]-se.length;++b)z.write_shift(1,32);z.write_shift(1,se,"sbcs");break;case"D":p[g][y]?(z.write_shift(4,("0000"+p[g][y].getFullYear()).slice(-4),"sbcs"),z.write_shift(2,("00"+(p[g][y].getMonth()+1)).slice(-2),"sbcs"),z.write_shift(2,("00"+p[g][y].getDate()).slice(-2),"sbcs")):z.write_shift(8,"00000000","sbcs");break;case"C":var de=String(p[g][y]!=null?p[g][y]:"").slice(0,k[y]);for(z.write_shift(1,de,"sbcs"),b=0;b<k[y]-de.length;++b)z.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),eU=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ga(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var m=e[p];return typeof m=="number"?nP(m):m},n=function(h,p,m){var g=p.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?h:nP(g)};e["|"]=254;function i(h,p){switch(p.type){case"base64":return s(ic(h),p);case"binary":return s(h,p);case"buffer":return s(fi&&Buffer.isBuffer(h)?h.toString("binary"):_h(h),p);case"array":return s(S0(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var m=h.split(/[\n\r]+/),g=-1,y=-1,b=0,v=0,w=[],S=[],k=null,j={},A=[],L=[],P=[],B=0,E;for(+p.codepage>=0&&lu(+p.codepage);b!==m.length;++b){B=0;var T=m[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),F=T.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),W=F[0],z;if(T.length>0)switch(W){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&S.push(T.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,de=!1,U=!1,G=!1,re=-1,X=-1;for(v=1;v<F.length;++v)switch(F[v].charAt(0)){case"A":break;case"X":y=parseInt(F[v].slice(1))-1,de=!0;break;case"Y":for(g=parseInt(F[v].slice(1))-1,de||(y=0),E=w.length;E<=g;++E)w[E]=[];break;case"K":z=F[v].slice(1),z.charAt(0)==='"'?z=z.slice(1,z.length-1):z==="TRUE"?z=!0:z==="FALSE"?z=!1:isNaN(fu(z))?isNaN(Fm(z).getDate())||(z=ma(z)):(z=fu(z),k!==null&&sg(k)&&(z=PS(z))),se=!0;break;case"E":G=!0;var C=gm(F[v].slice(1),{r:g,c:y});w[g][y]=[w[g][y],C];break;case"S":U=!0,w[g][y]=[w[g][y],"S5S"];break;case"G":break;case"R":re=parseInt(F[v].slice(1))-1;break;case"C":X=parseInt(F[v].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}if(se&&(w[g][y]&&w[g][y].length==2?w[g][y][0]=z:w[g][y]=z,k=null),U){if(G)throw new Error("SYLK shared formula cannot have own formula");var K=re>-1&&w[re][X];if(!K||!K[1])throw new Error("SYLK shared formula cannot find base");w[g][y][1]=yU(K[1],{r:g-re,c:y-X})}break;case"F":var V=0;for(v=1;v<F.length;++v)switch(F[v].charAt(0)){case"X":y=parseInt(F[v].slice(1))-1,++V;break;case"Y":for(g=parseInt(F[v].slice(1))-1,E=w.length;E<=g;++E)w[E]=[];break;case"M":B=parseInt(F[v].slice(1))/20;break;case"F":break;case"G":break;case"P":k=S[parseInt(F[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=F[v].slice(1).split(" "),E=parseInt(P[0],10);E<=parseInt(P[1],10);++E)B=parseInt(P[2],10),L[E-1]=B===0?{hidden:!0}:{wch:B},fh(L[E-1]);break;case"C":y=parseInt(F[v].slice(1))-1,L[y]||(L[y]={});break;case"R":g=parseInt(F[v].slice(1))-1,A[g]||(A[g]={}),B>0?(A[g].hpt=B,A[g].hpx=Dm(B)):B===0&&(A[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}V<1&&(k=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+T)}}return A.length>0&&(j["!rows"]=A),L.length>0&&(j["!cols"]=L),p&&p.sheetRows&&(w=w.slice(0,p.sheetRows)),[w,j]}function o(h,p){var m=i(h,p),g=m[0],y=m[1],b=lg(g,p);return Ga(y).forEach(function(v){b[v]=y[v]}),b}function l(h,p){return kh(o(h,p),p)}function c(h,p,m,g){var y="C;Y"+(m+1)+";X"+(g+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+iC(h.f,{r:m,c:g}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(h,p){p.forEach(function(m,g){var y="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?y+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=x1(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=y1(m.wpx)),typeof m.wch=="number"&&(y+=Math.round(m.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function d(h,p){p.forEach(function(m,g){var y="F;";m.hidden?y+="M0;":m.hpt?y+="M"+20*m.hpt+";":m.hpx&&(y+="M"+20*b1(m.hpx)+";"),y.length>2&&h.push(y+"R"+(g+1))})}function f(h,p){var m=["ID;PWXL;N;E"],g=[],y=_i(h["!ref"]),b,v=Array.isArray(h),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),h["!cols"]&&u(m,h["!cols"]),h["!rows"]&&d(m,h["!rows"]),m.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var k=y.s.c;k<=y.e.c;++k){var j=Yn({r:S,c:k});b=v?(h[S]||[])[k]:h[j],!(!b||b.v==null&&(!b.f||b.F))&&g.push(c(b,h,S,k))}return m.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),tU=function(){function e(s,o){switch(o.type){case"base64":return t(ic(s),o);case"binary":return t(s,o);case"buffer":return t(fi&&Buffer.isBuffer(s)?s.toString("binary"):_h(s),o);case"array":return t(S0(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=l[d].trim().split(","),p=h[0],m=h[1];++d;for(var g=l[d]||"";(g.match(/["]/g)||[]).length&1&&d<l.length-1;)g+=`
`+l[++d];switch(g=g.trim(),+p){case-1:if(g==="BOT"){f[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][u]=!0:g==="FALSE"?f[c][u]=!1:isNaN(fu(m))?isNaN(Fm(m).getDate())?f[c][u]=m:f[c][u]=ma(m):f[c][u]=fu(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return lg(e(s,o),o)}function n(s,o){return kh(r(s,o),o)}var i=function(){var s=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=_i(c["!ref"]),f,h=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var g=Yn({r:p,c:m});if(f=h?(c[p]||[])[m]:c[g],!f){o(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Dc(f.z||Vn[14],Os(ma(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,v=u.join(b);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),rU=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),m=-1,g=-1,y=0,b=[];y!==p.length;++y){var v=p[y].trim().split(":");if(v[0]==="cell"){var w=Ta(v[1]);if(b.length<=w.r)for(m=b.length;m<=w.r;++m)b[m]||(b[m]=[]);switch(m=w.r,g=w.c,v[2]){case"t":b[m][g]=e(v[3]);break;case"v":b[m][g]=+v[3];break;case"vtf":var S=v[v.length-1];case"vtc":switch(v[3]){case"nl":b[m][g]=!!+v[4];break;default:b[m][g]=+v[4];break}v[2]=="vtf"&&(b[m][g]=[b[m][g],S])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function n(f,h){return lg(r(f,h),h)}function i(f,h){return kh(n(f,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],m,g="",y=El(f["!ref"]),b=Array.isArray(f),v=y.s.r;v<=y.e.r;++v)for(var w=y.s.c;w<=y.e.c;++w)if(g=Yn({r:v,c:w}),m=b?(f[v]||[])[w]:f[g],!(!m||m.v==null||m.t==="z")){switch(p=["cell",g,"t"],m.t){case"s":case"str":p.push(t(m.v));break;case"n":m.f?(p[2]="vtf",p[3]="n",p[4]=m.v,p[5]=t(m.f)):(p[2]="v",p[3]=m.v);break;case"b":p[2]="vt"+(m.f?"f":"c"),p[3]="nl",p[4]=m.v?"1":"0",p[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var S=Os(ma(m.v));p[2]="vtc",p[3]="nd",p[4]=""+S,p[5]=m.w||Dc(m.z||Vn[14],S);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Im=function(){function e(d,f,h,p,m){m.raw?f[h][p]=d:d===""||(d==="TRUE"?f[h][p]=!0:d==="FALSE"?f[h][p]=!1:isNaN(fu(d))?isNaN(Fm(d).getDate())?f[h][p]=d:f[h][p]=ma(d):f[h][p]=fu(d))}function t(d,f){var h=f||{},p=[];if(!d||d.length===0)return p;for(var m=d.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var y=10,b=0,v=0;v<=g;++v)b=m[v].indexOf(" "),b==-1?b=m[v].length:b++,y=Math.max(y,b);for(v=0;v<=g;++v){p[v]=[];var w=0;for(e(m[v].slice(0,y).trim(),p,v,w,h),w=1;w<=(m[v].length-y)/10+1;++w)e(m[v].slice(y+(w-1)*10,y+w*10).trim(),p,v,w,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var f={},h=!1,p=0,m=0;p<d.length;++p)(m=d.charCodeAt(p))==34?h=!h:!h&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p]);if(!m.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&m.push([f[p],p])}return m.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[m.pop()[1]]||44}function s(d,f){var h=f||{},p="",m=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=i(d.slice(0,1024)):h&&h.FS?p=h.FS:p=i(d.slice(0,1024));var y=0,b=0,v=0,w=0,S=0,k=p.charCodeAt(0),j=!1,A=0,L=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=h.dateNF!=null?Dne(h.dateNF):null;function B(){var E=d.slice(w,S),T={};if(E.charAt(0)=='"'&&E.charAt(E.length-1)=='"'&&(E=E.slice(1,-1).replace(/""/g,'"')),E.length===0)T.t="z";else if(h.raw)T.t="s",T.v=E;else if(E.trim().length===0)T.t="s",T.v=E;else if(E.charCodeAt(0)==61)E.charCodeAt(1)==34&&E.charCodeAt(E.length-1)==34?(T.t="s",T.v=E.slice(2,-1).replace(/""/g,'"')):pce(E)?(T.t="n",T.f=E.slice(1)):(T.t="s",T.v=E);else if(E=="TRUE")T.t="b",T.v=!0;else if(E=="FALSE")T.t="b",T.v=!1;else if(!isNaN(v=fu(E)))T.t="n",h.cellText!==!1&&(T.w=E),T.v=v;else if(!isNaN(Fm(E).getDate())||P&&E.match(P)){T.z=h.dateNF||Vn[14];var F=0;P&&E.match(P)&&(E=$ne(E,h.dateNF,E.match(P)||[]),F=1),h.cellDates?(T.t="d",T.v=ma(E,F)):(T.t="n",T.v=Os(ma(E,F))),h.cellText!==!1&&(T.w=Dc(T.z,T.v instanceof Date?Os(T.v):T.v)),h.cellNF||delete T.z}else T.t="s",T.v=E;if(T.t=="z"||(h.dense?(m[y]||(m[y]=[]),m[y][b]=T):m[Yn({c:b,r:y})]=T),w=S+1,L=d.charCodeAt(w),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),A==k)++b;else if(b=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;S<d.length;++S)switch(A=d.charCodeAt(S)){case 34:L===34&&(j=!j);break;case k:case 10:case 13:if(!j&&B())break e;break}return S-w>0&&B(),m["!ref"]=si(g),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):lg(t(d,f),f)}function l(d,f){var h="",p=f.type=="string"?[0,0,0,0]:fC(d,f);switch(f.type){case"base64":h=ic(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof c1<"u"||(h=fi&&Buffer.isBuffer(d)?d.toString("binary"):_h(d));break;case"array":h=S0(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Ki(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Ki(h):f.type=="binary"&&typeof c1<"u",h.slice(0,19)=="socialcalc:version:"?rU.to_sheet(f.type=="string"?h:Ki(h),f):o(h,f)}function c(d,f){return kh(l(d,f),f)}function u(d){for(var f=[],h=_i(d["!ref"]),p,m=Array.isArray(d),g=h.s.r;g<=h.e.r;++g){for(var y=[],b=h.s.c;b<=h.e.c;++b){var v=Yn({r:g,c:b});if(p=m?(d[g]||[])[b]:d[v],!p||p.v==null){y.push("          ");continue}for(var w=(p.w||(Yd(p),p.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(b===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function eoe(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=eU.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Im.to_workbook(e,t)}}var s0=function(){function e(C,K,V){if(C){uo(C,C.l||0);for(var R=V.Enum||re;C.l<C.length;){var J=C.read_shift(2),q=R[J]||R[65535],Y=C.read_shift(2),Q=C.l+Y,ie=q.f&&q.f(C,Y,V);if(C.l=Q,K(ie,q,J))return}}}function t(C,K){switch(K.type){case"base64":return r(Gl(ic(C)),K);case"binary":return r(Gl(C),K);case"buffer":case"array":return r(C,K)}throw"Unsupported type "+K.type}function r(C,K){if(!C)return C;var V=K||{},R=V.dense?[]:{},J="Sheet1",q="",Y=0,Q={},ie=[],le=[],O={s:{r:0,c:0},e:{r:0,c:0}},H=V.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)V.Enum=re,e(C,function(pe,Oe,Ae){switch(Ae){case 0:V.vers=pe,pe>=4096&&(V.qpro=!0);break;case 6:O=pe;break;case 204:pe&&(q=pe);break;case 222:q=pe;break;case 15:case 51:V.qpro||(pe[1].v=pe[1].v.slice(1));case 13:case 14:case 16:Ae==14&&(pe[2]&112)==112&&(pe[2]&15)>1&&(pe[2]&15)<15&&(pe[1].z=V.dateNF||Vn[14],V.cellDates&&(pe[1].t="d",pe[1].v=PS(pe[1].v))),V.qpro&&pe[3]>Y&&(R["!ref"]=si(O),Q[J]=R,ie.push(J),R=V.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},Y=pe[3],J=q||"Sheet"+(Y+1),q="");var ke=V.dense?(R[pe[0].r]||[])[pe[0].c]:R[Yn(pe[0])];if(ke){ke.t=pe[1].t,ke.v=pe[1].v,pe[1].z!=null&&(ke.z=pe[1].z),pe[1].f!=null&&(ke.f=pe[1].f);break}V.dense?(R[pe[0].r]||(R[pe[0].r]=[]),R[pe[0].r][pe[0].c]=pe[1]):R[Yn(pe[0])]=pe[1];break}},V);else if(C[2]==26||C[2]==14)V.Enum=X,C[2]==14&&(V.qpro=!0,C.l=0),e(C,function(pe,Oe,Ae){switch(Ae){case 204:J=pe;break;case 22:pe[1].v=pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(pe[3]>Y&&(R["!ref"]=si(O),Q[J]=R,ie.push(J),R=V.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},Y=pe[3],J="Sheet"+(Y+1)),H>0&&pe[0].r>=H)break;V.dense?(R[pe[0].r]||(R[pe[0].r]=[]),R[pe[0].r][pe[0].c]=pe[1]):R[Yn(pe[0])]=pe[1],O.e.c<pe[0].c&&(O.e.c=pe[0].c),O.e.r<pe[0].r&&(O.e.r=pe[0].r);break;case 27:pe[14e3]&&(le[pe[14e3][0]]=pe[14e3][1]);break;case 1537:le[pe[0]]=pe[1],pe[0]==Y&&(J=pe[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(R["!ref"]=si(O),Q[q||J]=R,ie.push(q||J),!le.length)return{SheetNames:ie,Sheets:Q};for(var ae={},I=[],Z=0;Z<le.length;++Z)Q[ie[Z]]?(I.push(le[Z]||ie[Z]),ae[le[Z]]=Q[le[Z]]||Q[ie[Z]]):(I.push(le[Z]),ae[le[Z]]={"!ref":"A1"});return{SheetNames:I,Sheets:ae}}function n(C,K){var V=K||{};if(+V.codepage>=0&&lu(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Cl(),J=_i(C["!ref"]),q=Array.isArray(C),Y=[];un(R,0,s(1030)),un(R,6,c(J));for(var Q=Math.min(J.e.r,8191),ie=J.s.r;ie<=Q;++ie)for(var le=os(ie),O=J.s.c;O<=J.e.c;++O){ie===J.s.r&&(Y[O]=Ea(O));var H=Y[O]+le,ae=q?(C[ie]||[])[O]:C[H];if(!(!ae||ae.t=="z"))if(ae.t=="n")(ae.v|0)==ae.v&&ae.v>=-32768&&ae.v<=32767?un(R,13,p(ie,O,ae.v)):un(R,14,g(ie,O,ae.v));else{var I=Yd(ae);un(R,15,f(ie,O,I.slice(0,239)))}}return un(R,1),R.end()}function i(C,K){var V=K||{};if(+V.codepage>=0&&lu(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Cl();un(R,0,o(C));for(var J=0,q=0;J<C.SheetNames.length;++J)(C.Sheets[C.SheetNames[J]]||{})["!ref"]&&un(R,27,G(C.SheetNames[J],q++));var Y=0;for(J=0;J<C.SheetNames.length;++J){var Q=C.Sheets[C.SheetNames[J]];if(!(!Q||!Q["!ref"])){for(var ie=_i(Q["!ref"]),le=Array.isArray(Q),O=[],H=Math.min(ie.e.r,8191),ae=ie.s.r;ae<=H;++ae)for(var I=os(ae),Z=ie.s.c;Z<=ie.e.c;++Z){ae===ie.s.r&&(O[Z]=Ea(Z));var pe=O[Z]+I,Oe=le?(Q[ae]||[])[Z]:Q[pe];if(!(!Oe||Oe.t=="z"))if(Oe.t=="n")un(R,23,B(ae,Z,Y,Oe.v));else{var Ae=Yd(Oe);un(R,22,A(ae,Z,Y,Ae.slice(0,239)))}}++Y}}return un(R,1),R.end()}function s(C){var K=_r(2);return K.write_shift(2,C),K}function o(C){var K=_r(26);K.write_shift(2,4096),K.write_shift(2,4),K.write_shift(4,0);for(var V=0,R=0,J=0,q=0;q<C.SheetNames.length;++q){var Y=C.SheetNames[q],Q=C.Sheets[Y];if(!(!Q||!Q["!ref"])){++J;var ie=El(Q["!ref"]);V<ie.e.r&&(V=ie.e.r),R<ie.e.c&&(R=ie.e.c)}}return V>8191&&(V=8191),K.write_shift(2,V),K.write_shift(1,J),K.write_shift(1,R),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(1,1),K.write_shift(1,2),K.write_shift(4,0),K.write_shift(4,0),K}function l(C,K,V){var R={s:{c:0,r:0},e:{c:0,r:0}};return K==8&&V.qpro?(R.s.c=C.read_shift(1),C.l++,R.s.r=C.read_shift(2),R.e.c=C.read_shift(1),C.l++,R.e.r=C.read_shift(2),R):(R.s.c=C.read_shift(2),R.s.r=C.read_shift(2),K==12&&V.qpro&&(C.l+=2),R.e.c=C.read_shift(2),R.e.r=C.read_shift(2),K==12&&V.qpro&&(C.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function c(C){var K=_r(8);return K.write_shift(2,C.s.c),K.write_shift(2,C.s.r),K.write_shift(2,C.e.c),K.write_shift(2,C.e.r),K}function u(C,K,V){var R=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(R[0].c=C.read_shift(1),R[3]=C.read_shift(1),R[0].r=C.read_shift(2),C.l+=2):(R[2]=C.read_shift(1),R[0].c=C.read_shift(2),R[0].r=C.read_shift(2)),R}function d(C,K,V){var R=C.l+K,J=u(C,K,V);if(J[1].t="s",V.vers==20768){C.l++;var q=C.read_shift(1);return J[1].v=C.read_shift(q,"utf8"),J}return V.qpro&&C.l++,J[1].v=C.read_shift(R-C.l,"cstr"),J}function f(C,K,V){var R=_r(7+V.length);R.write_shift(1,255),R.write_shift(2,K),R.write_shift(2,C),R.write_shift(1,39);for(var J=0;J<R.length;++J){var q=V.charCodeAt(J);R.write_shift(1,q>=128?95:q)}return R.write_shift(1,0),R}function h(C,K,V){var R=u(C,K,V);return R[1].v=C.read_shift(2,"i"),R}function p(C,K,V){var R=_r(7);return R.write_shift(1,255),R.write_shift(2,K),R.write_shift(2,C),R.write_shift(2,V,"i"),R}function m(C,K,V){var R=u(C,K,V);return R[1].v=C.read_shift(8,"f"),R}function g(C,K,V){var R=_r(13);return R.write_shift(1,255),R.write_shift(2,K),R.write_shift(2,C),R.write_shift(8,V,"f"),R}function y(C,K,V){var R=C.l+K,J=u(C,K,V);if(J[1].v=C.read_shift(8,"f"),V.qpro)C.l=R;else{var q=C.read_shift(2);S(C.slice(C.l,C.l+q),J),C.l+=q}return J}function b(C,K,V){var R=K&32768;return K&=-32769,K=(R?C:0)+(K>=8192?K-16384:K),(R?"":"$")+(V?Ea(K):os(K))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(C,K){uo(C,0);for(var V=[],R=0,J="",q="",Y="",Q="";C.l<C.length;){var ie=C[C.l++];switch(ie){case 0:V.push(C.read_shift(8,"f"));break;case 1:q=b(K[0].c,C.read_shift(2),!0),J=b(K[0].r,C.read_shift(2),!1),V.push(q+J);break;case 2:{var le=b(K[0].c,C.read_shift(2),!0),O=b(K[0].r,C.read_shift(2),!1);q=b(K[0].c,C.read_shift(2),!0),J=b(K[0].r,C.read_shift(2),!1),V.push(le+O+":"+q+J)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(C.read_shift(2));break;case 6:{for(var H="";ie=C[C.l++];)H+=String.fromCharCode(ie);V.push('"'+H.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:Q=V.pop(),Y=V.pop(),V.push(["AND","OR"][ie-20]+"("+Y+","+Q+")");break;default:if(ie<32&&w[ie])Q=V.pop(),Y=V.pop(),V.push(Y+w[ie]+Q);else if(v[ie]){if(R=v[ie][1],R==69&&(R=C[C.l++]),R>V.length){console.error("WK1 bad formula parse 0x"+ie.toString(16)+":|"+V.join("|")+"|");return}var ae=V.slice(-R);V.length-=R,V.push(v[ie][0]+"("+ae.join(",")+")")}else return ie<=7?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=24?console.error("WK1 unsupported op "+ie.toString(16)):ie<=30?console.error("WK1 invalid opcode "+ie.toString(16)):ie<=115?console.error("WK1 unsupported function opcode "+ie.toString(16)):console.error("WK1 unrecognized opcode "+ie.toString(16))}}V.length==1?K[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function k(C){var K=[{c:0,r:0},{t:"n",v:0},0];return K[0].r=C.read_shift(2),K[3]=C[C.l++],K[0].c=C[C.l++],K}function j(C,K){var V=k(C);return V[1].t="s",V[1].v=C.read_shift(K-4,"cstr"),V}function A(C,K,V,R){var J=_r(6+R.length);J.write_shift(2,C),J.write_shift(1,V),J.write_shift(1,K),J.write_shift(1,39);for(var q=0;q<R.length;++q){var Y=R.charCodeAt(q);J.write_shift(1,Y>=128?95:Y)}return J.write_shift(1,0),J}function L(C,K){var V=k(C);V[1].v=C.read_shift(2);var R=V[1].v>>1;if(V[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return V[1].v=R,V}function P(C,K){var V=k(C),R=C.read_shift(4),J=C.read_shift(4),q=C.read_shift(2);if(q==65535)return R===0&&J===3221225472?(V[1].t="e",V[1].v=15):R===0&&J===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var Y=q&32768;return q=(q&32767)-16446,V[1].v=(1-Y*2)*(J*Math.pow(2,q+32)+R*Math.pow(2,q)),V}function B(C,K,V,R){var J=_r(14);if(J.write_shift(2,C),J.write_shift(1,V),J.write_shift(1,K),R==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var q=0,Y=0,Q=0,ie=0;return R<0&&(q=1,R=-R),Y=Math.log2(R)|0,R/=Math.pow(2,Y-31),ie=R>>>0,ie&2147483648||(R/=2,++Y,ie=R>>>0),R-=ie,ie|=2147483648,ie>>>=0,R*=Math.pow(2,32),Q=R>>>0,J.write_shift(4,Q),J.write_shift(4,ie),Y+=16383+(q?32768:0),J.write_shift(2,Y),J}function E(C,K){var V=P(C);return C.l+=K-14,V}function T(C,K){var V=k(C),R=C.read_shift(4);return V[1].v=R>>6,V}function F(C,K){var V=k(C),R=C.read_shift(8,"f");return V[1].v=R,V}function W(C,K){var V=F(C);return C.l+=K-10,V}function z(C,K){return C[C.l+K-1]==0?C.read_shift(K,"cstr"):""}function se(C,K){var V=C[C.l++];V>K-1&&(V=K-1);for(var R="";R.length<V;)R+=String.fromCharCode(C[C.l++]);return R}function de(C,K,V){if(!(!V.qpro||K<21)){var R=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var J=C.read_shift(K-21,"cstr");return[R,J]}}function U(C,K){for(var V={},R=C.l+K;C.l<R;){var J=C.read_shift(2);if(J==14e3){for(V[J]=[0,""],V[J][0]=C.read_shift(2);C[C.l];)V[J][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return V}function G(C,K){var V=_r(5+C.length);V.write_shift(2,14e3),V.write_shift(2,K);for(var R=0;R<C.length;++R){var J=C.charCodeAt(R);V[V.l++]=J>127?95:J}return V[V.l++]=0,V}var re={0:{n:"BOF",f:hs},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:z},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},X={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:E},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:U},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:W},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function toe(e){var t={},r=e.match(Uo),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Xn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=E3[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var roe=function(){var e=f1("t"),t=f1("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:Si(o[1])},c=s.match(t);return c&&(l.s=toe(c[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),noe=function(){var t=/(\r\n|\n)/g;function r(i,s,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),ioe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,aoe=/<(?:\w+:)?r>/,soe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Z3(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Si(Ki(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ki(e),r&&(n.h=D3(n.t))):e.match(aoe)&&(n.r=Ki(e),n.t=Si(Ki((e.replace(soe,"").match(ioe)||[]).join("").replace(Uo,""))),r&&(n.h=noe(roe(n.r)))),n):{t:""}}var ooe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,loe=/<(?:\w+:)?(?:si|sstItem)>/g,coe=/<\/(?:\w+:)?(?:si|sstItem)>/;function uoe(e,t){var r=[],n="";if(!e)return r;var i=e.match(ooe);if(i){n=i[2].replace(loe,"").split(coe);for(var s=0;s!=n.length;++s){var o=Z3(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=Xn(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var doe=/^\s|\s$|[\t\n\r]/;function nU(e,t){if(!t.bookSST)return"";var r=[ls];r[r.length]=ln("sst",null,{xmlns:Y0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(doe)&&(s+=' xml:space="preserve"'),s+=">"+Wi(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function foe(e){return[e.read_shift(4),e.read_shift(4)]}function hoe(e,t){var r=[],n=!1;return uf(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function poe(e,t){return t||(t=_r(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var moe=jie;function goe(e){var t=Cl();Dr(t,159,poe(e));for(var r=0;r<e.length;++r)Dr(t,19,moe(e[r]));return Dr(t,160),t.end()}function iU(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ud(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function xoe(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ud(e,4),t.U=Ud(e,4),t.W=Ud(e,4),t}function yoe(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function boe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(yoe(e));return t}function voe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function woe(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ud(e,4),t.U=Ud(e,4),t.W=Ud(e,4),t}function Soe(e){var t=woe(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function aU(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function sU(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function _oe(e){var t=Ud(e);switch(t.Minor){case 2:return[t.Minor,koe(e)];case 3:return[t.Minor,joe()];case 4:return[t.Minor,Aoe(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function koe(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=aU(e,r),i=sU(e,e.length-e.l);return{t:"Std",h:n,v:i}}function joe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Aoe(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Uo,function(s){var o=Xn(s);switch(cd(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Noe(e,t){var r={},n=r.EncryptionVersionInfo=Ud(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=aU(e,i),t-=i,r.EncryptionVerifier=sU(e,t),r}function Coe(e){var t={},r=t.EncryptionVersionInfo=Ud(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function eC(e){var t=0,r,n=iU(e),i=n.length+1,s,o,l,c,u;for(r=dh(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var oU=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=iU(o),c=s(l),u=l.length,d=dh(16),f=0;f!=16;++f)d[f]=0;var h,p,m;for((u&1)===1&&(h=c>>8,d[u]=i(e[0],h),--u,h=c&255,p=l[l.length-1],d[u]=i(p,h));u>0;)--u,h=c>>8,d[u]=i(l[u],h),--u,h=c&255,d[u]=i(l[u],h);for(u=15,m=15-l.length;m>0;)h=c>>8,d[u]=i(e[m],h),--u,--m,h=c&255,d[u]=i(l[u],h),--u,--m;return d}}(),Eoe=function(e,t,r,n,i){i||(i=t),n||(n=oU(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},Toe=function(e){var t=0,r=oU(e);return function(n){var i=Eoe("",n,t,r);return t=i[1],i[0]}};function Poe(e,t,r,n){var i={key:hs(e),verificationBytes:hs(e)};return r.password&&(i.verifier=eC(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Toe(r.password)),i}function Ooe(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Coe(e):n.Data=Noe(e,t),n}function Moe(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Ooe(e,t-2,n):Poe(e,r.biff>=8?t:t-2,r,n),n}var lU=function(){function e(i,s){switch(s.type){case"base64":return t(ic(i),s);case"binary":return t(i,s);case"buffer":return t(fi&&Buffer.isBuffer(i)?i.toString("binary"):_h(i),s);case"array":return t(S0(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},l=o.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var h=/\\\w+\b/g,p=0,m,g=-1;m=h.exec(d);){switch(m[0]){case"\\cell":var y=d.slice(p,h.lastIndex-m[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(l)?l[f][g]=b:l[Yn({r:f,c:g})]=b}break}p=h.lastIndex}g>u.e.c&&(u.e.c=g)}),l["!ref"]=si(u),l}function r(i,s){return kh(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=_i(i["!ref"]),l,c=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Yn({r:u,c:d});l=c?(i[u]||[])[d]:i[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(Yd(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Loe(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function g1(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Roe(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var l=0,c=0,u=i+s;switch(c=o/(u>1?2-u:u),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function Boe(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=i*l,o[0]+=i,o[1]+=c;break;case 1:c=i*(2-l),o[0]+=c,o[1]+=i;break;case 2:c=i*(l-2),o[1]+=i,o[2]+=c;break;case 3:c=i*(4-l),o[1]+=c,o[2]+=i;break;case 4:c=i*(l-4),o[2]+=i,o[0]+=c;break;case 5:c=i*(6-l),o[2]+=c,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function V2(e,t){if(t===0)return e;var r=Roe(Loe(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),g1(Boe(r))}var cU=6,Foe=15,Ioe=1,Oo=cU;function x1(e){return Math.floor((e+Math.round(128/Oo)/256)*Oo)}function y1(e){return Math.floor((e-5)/Oo*100+.5)/100}function G2(e){return Math.round((e*Oo+5)/Oo*256)/256}function nk(e){return G2(y1(x1(e)))}function tC(e){var t=Math.abs(e-nk(e)),r=Oo;if(t>.005)for(Oo=Ioe;Oo<Foe;++Oo)Math.abs(e-nk(e))<=t&&(t=Math.abs(e-nk(e)),r=Oo);Oo=r}function fh(e){e.width?(e.wpx=x1(e.width),e.wch=y1(e.wpx),e.MDW=Oo):e.wpx?(e.wch=y1(e.wpx),e.width=G2(e.wch),e.MDW=Oo):typeof e.wch=="number"&&(e.width=G2(e.wch),e.wpx=x1(e.width),e.MDW=Oo),e.customWidth&&delete e.customWidth}var Doe=96,uU=Doe;function b1(e){return e*96/uU}function Dm(e){return e*uU/96}var $oe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Uoe(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Uo)||[]).forEach(function(o){var l=Xn(o);switch(cd(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=fa(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=fa(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function zoe(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Uo)||[]).forEach(function(o){var l=Xn(o);switch(cd(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function Woe(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Uo)||[]).forEach(function(o){var l=Xn(o);switch(cd(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=Ki(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?fa(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?fa(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?fa(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?fa(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?fa(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?fa(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?fa(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=E3[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=fa(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var c=i0[i.color.index];i.color.index==81&&(c=i0[1]),c||(c=i0[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=V2(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function qoe(e,t,r){t.NumberFmt=[];for(var n=Ga(Vn),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Vn[n[i]];var s=e[0].match(Uo);if(s)for(i=0;i<s.length;++i){var o=Xn(s[i]);switch(cd(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=Si(Ki(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}$d(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Hoe(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ln("numFmt",null,{numFmtId:n,formatCode:Wi(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ln("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Eb=["numFmtId","fillId","fontId","borderId","xfId"],Tb=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Voe(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Uo)||[]).forEach(function(s){var o=Xn(s),l=0;switch(cd(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Eb.length;++l)n[Eb[l]]&&(n[Eb[l]]=parseInt(n[Eb[l]],10));for(l=0;l<Tb.length;++l)n[Tb[l]]&&(n[Tb[l]]=fa(n[Tb[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=fa(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Goe(e){var t=[];return t[t.length]=ln("cellXfs",null),e.forEach(function(r){t[t.length]=ln("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ln("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Koe=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&qoe(f,d,u),(f=l.match(i))&&Woe(f,d,c,u),(f=l.match(n))&&zoe(f,d,c,u),(f=l.match(s))&&Uoe(f,d,c,u),(f=l.match(r))&&Voe(f,d,u),d}}();function dU(e,t){var r=[ls,ln("styleSheet",null,{xmlns:Y0[0],"xmlns:vt":Ts.vt})],n;return e.SSF&&(n=Hoe(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Goe(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Yoe(e,t){var r=e.read_shift(2),n=Bo(e);return[r,n]}function Xoe(e,t,r){r||(r=_r(6+4*t.length)),r.write_shift(2,e),Vs(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Qoe(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Oie(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Pie(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Bo(e),n}function Joe(e,t){t||(t=_r(25+4*32)),t.write_shift(2,e.sz*20),Mie(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),W2(e.color,t);var n=0;return n=2,t.write_shift(1,n),Vs(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Zoe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ik,ele=Do;function GP(e,t){t||(t=_r(4*3+8*7+16*1)),ik||(ik=ES(Zoe));var r=ik[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(W2({auto:1},t),W2({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function tle(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function fU(e,t,r){r||(r=_r(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Wg(e,t){return t||(t=_r(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var rle=Do;function nle(e,t){return t||(t=_r(51)),t.write_shift(1,0),Wg(null,t),Wg(null,t),Wg(null,t),Wg(null,t),Wg(null,t),t.length>t.l?t.slice(0,t.l):t}function ile(e,t){return t||(t=_r(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),z2(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function ale(e,t,r){var n=_r(2052);return n.write_shift(4,e),z2(t,n),z2(r,n),n.length>n.l?n.slice(0,n.l):n}function sle(e,t,r){var n={};n.NumberFmt=[];for(var i in Vn)n.NumberFmt[i]=Vn[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return uf(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],$d(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=V2(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function ole(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Dr(e,615,hu(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Dr(e,44,Xoe(i,t[i]))}),Dr(e,616))}}function lle(e){var t=1;Dr(e,611,hu(t)),Dr(e,43,Joe({sz:12,color:{theme:1},name:"Calibri",family:2})),Dr(e,612)}function cle(e){var t=2;Dr(e,603,hu(t)),Dr(e,45,GP({patternType:"none"})),Dr(e,45,GP({patternType:"gray125"})),Dr(e,604)}function ule(e){var t=1;Dr(e,613,hu(t)),Dr(e,46,nle()),Dr(e,614)}function dle(e){var t=1;Dr(e,626,hu(t)),Dr(e,47,fU({numFmtId:0},65535)),Dr(e,627)}function fle(e,t){Dr(e,617,hu(t.length)),t.forEach(function(r){Dr(e,47,fU(r,0))}),Dr(e,618)}function hle(e){var t=1;Dr(e,619,hu(t)),Dr(e,48,ile({xfId:0,name:"Normal"})),Dr(e,620)}function ple(e){var t=0;Dr(e,505,hu(t)),Dr(e,506)}function mle(e){var t=0;Dr(e,508,ale(t,"TableStyleMedium9","PivotStyleMedium4")),Dr(e,509)}function gle(e,t){var r=Cl();return Dr(r,278),ole(r,e.SSF),lle(r),cle(r),ule(r),dle(r),fle(r,t.cellXfs),hle(r),ple(r),mle(r),Dr(r,279),r.end()}var xle=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function yle(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Uo)||[]).forEach(function(i){var s=Xn(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[xle.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function ble(){}function vle(){}var wle=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Sle=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,_le=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function kle(e,t,r){t.themeElements={};var n;[["clrScheme",wle,yle],["fontScheme",Sle,ble],["fmtScheme",_le,vle]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var jle=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function hU(e,t){(!e||e.length===0)&&(e=rC());var r,n={};if(!(r=e.match(jle)))throw new Error("themeElements not found in theme");return kle(r[0],n,t),n.raw=e,n}function rC(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ls];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Ale(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=a$(s,{type:"array"})}catch{return}var l=Kl(o,"theme/theme/theme1.xml",!0);if(l)return hU(l,r)}}function Nle(e){return e.read_shift(4)}function Cle(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Ele(e,4);break;case 2:t.xclrValue=V$(e);break;case 3:t.xclrValue=Nle(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Ele(e,t){return Do(e,t)}function Tle(e,t){return Do(e,t)}function Ple(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Cle(e);break;case 6:n[1]=Tle(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Ole(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(Ple(e,r-e.l));return{ixfe:n,ext:s}}function Mle(e,t){t.forEach(function(r){switch(r[0]){}})}function Lle(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Bo(e)}}function Rle(e){var t=_r(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Vs(e.name,t),t.slice(0,t.l)}function Ble(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Fle(e){var t=_r(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Ile(e,t){var r=_r(8+2*t.length);return r.write_shift(4,e),Vs(t,r),r.slice(0,r.l)}function Dle(e){return e.l+=4,e.read_shift(4)!=0}function $le(e,t){var r=_r(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Ule(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,l=2;return uf(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function zle(){var e=Cl();return Dr(e,332),Dr(e,334,hu(1)),Dr(e,335,Rle({name:"XLDAPR",version:12e4,flags:3496657072})),Dr(e,336),Dr(e,339,Ile(1,"XLDAPR")),Dr(e,52),Dr(e,35,hu(514)),Dr(e,4096,hu(0)),Dr(e,4097,Ec(1)),Dr(e,36),Dr(e,53),Dr(e,340),Dr(e,337,$le(1)),Dr(e,51,Fle([[1,0]])),Dr(e,338),Dr(e,333),e.end()}function Wle(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(Uo,function(l){var c=Xn(l);switch(cd(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function pU(){var e=[ls];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function qle(e){var t=[];if(!e)return t;var r=1;return(e.match(Uo)||[]).forEach(function(n){var i=Xn(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function Hle(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Yn(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Vle(e,t,r){var n=[];return uf(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Gle(e,t,r,n){if(!e)return e;var i=n||{},s=!1;uf(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function Kle(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var em=1024;function mU(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ln("xml",null,{"xmlns:v":Hl.v,"xmlns:o":Hl.o,"xmlns:x":Hl.x,"xmlns:mv":Hl.mv}).replace(/\/>/,">"),ln("o:shapelayout",ln("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ln("v:shapetype",[ln("v:stroke",null,{joinstyle:"miter"}),ln("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];em<e*1e3;)em+=1e3;return t.forEach(function(s){var o=Ta(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ln("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ln("v:fill",c,l),d={on:"t",obscured:"t"};++em,i=i.concat(["<v:shape"+h1({id:"_x0000_s"+em,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ln("v:shadow",null,d),ln("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",fo("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),fo("x:AutoFill","False"),fo("x:Row",String(o.r)),fo("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function KP(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var l=Ta(o.ref);if(i?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},i?e[l.r][l.c]=s:e[o.ref]=s;var c=_i(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=si(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function Yle(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Xn(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Ta(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&Z3(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function gU(e){var t=[ls,ln("comments",null,{xmlns:Y0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Wi(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(Wi(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(fo("t",Wi(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(fo("t",Wi(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Xle(e,t){var r=[],n=!1,i={},s=0;return e.replace(Uo,function(l,c){var u=Xn(l);switch(cd(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":i.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function Qle(e,t,r){var n=[ls,ln("ThreadedComments",null,{xmlns:Ts.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(ln("threadedComment",fo("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Jle(e,t){var r=[],n=!1;return e.replace(Uo,function(s){var o=Xn(s);switch(cd(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function Zle(e){var t=[ls,ln("personList",null,{xmlns:Ts.TCMNT,"xmlns:x":Y0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ln("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function ece(e){var t={};t.iauthor=e.read_shift(4);var r=Z0(e);return t.rfx=r.s,t.ref=Yn(r.s),e.l+=16,t}function tce(e,t){return t==null&&(t=_r(36)),t.write_shift(4,e[1].iauthor),cg(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var rce=Bo;function nce(e){return Vs(e.slice(0,54))}function ice(e,t){var r=[],n=[],i={},s=!1;return uf(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function ace(e){var t=Cl(),r=[];return Dr(t,628),Dr(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Dr(t,632,nce(i.a)))})}),Dr(t,631),Dr(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Ta(n[0]),e:Ta(n[0])};Dr(t,635,tce([s,i])),i.t&&i.t.length>0&&Dr(t,637,Nie(i)),Dr(t,636),delete i.iauthor})}),Dr(t,634),Dr(t,629),t.end()}var sce="application/vnd.ms-office.vbaProject";function oce(e){var t=zn.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");zn.utils.cfb_add(t,i,e.FileIndex[n].content)}}),zn.write(t)}function lce(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&zn.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var xU=["xlsb","xlsm","xlam","biff8","xla"];function cce(){return{"!type":"dialog"}}function uce(){return{"!type":"dialog"}}function dce(){return{"!type":"macro"}}function fce(){return{"!type":"macro"}}var gm=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,i+(l?"":"$")+Ea(d)+(c?"":"$")+os(u)}return function(i,s){return t=s,i.replace(e,r)}}(),nC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,iC=function(){return function(t,r){return t.replace(nC,function(n,i,s,o,l,c){var u=q3(o)-(s?0:r.c),d=W3(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",h=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+h})}}();function yU(e,t){return e.replace(nC,function(r,n,i,s,o,l){return n+(i=="$"?i+s:Ea(q3(s)+t.c))+(o=="$"?o+l:os(W3(l)+t.r))})}function hce(e,t,r){var n=El(t),i=n.s,s=Ta(r),o={r:s.r-i.r,c:s.c-i.c};return yU(e,o)}function pce(e){return e.length!=1}function YP(e){return e.replace(/_xlfn\./g,"")}function cs(e){e.l+=1}function hh(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bU(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return vU(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=hh(e),l=hh(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function vU(e){var t=hh(e),r=hh(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function mce(e,t,r){if(r.biff<8)return vU(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=hh(e),o=hh(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function wU(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return gce(e);var n=e.read_shift(r&&r.biff==12?4:2),i=hh(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function gce(e){var t=hh(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function xce(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function yce(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return bce(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:l}}function bce(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function vce(e,t,r){var n=(e[e.l++]&96)>>5,i=bU(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function wce(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=bU(e,s,r);return[n,i,o]}function Sce(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function _ce(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function kce(e,t,r){var n=(e[e.l++]&96)>>5,i=mce(e,t-1,r);return[n,i]}function jce(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function XP(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Ace(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Nce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Cce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ece(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Tce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function SU(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Pce(e){return e.read_shift(2),SU(e)}function Oce(e){return e.read_shift(2),SU(e)}function Mce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=wU(e,0,r);return[n,i]}function Lce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=yce(e,0,r);return[n,i]}function Rce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=wU(e,0,r);return[n,i,s]}function Bce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Due[i],jU[i],n]}function Fce(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Ice(e);return[i,(s[0]===0?jU:Iue)[s[1]]]}function Ice(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Dce(e,t,r){e.l+=r&&r.biff==2?3:4}function $ce(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Uce(e){return e.l++,df[e.read_shift(1)]}function zce(e){return e.l++,e.read_shift(2)}function Wce(e){return e.l++,e.read_shift(1)!==0}function qce(e){return e.l++,Ro(e)}function Hce(e,t,r){return e.l++,ay(e,t-1,r)}function Vce(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Za(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=df[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ro(e);break;case 2:r[1]=ep(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Gce(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Z0:OS)(e));return i}function Kce(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=Vce(e,r.biff);return o}function Yce(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Xce(e,t,r){if(r.biff==5)return Qce(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function Qce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Jce(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Zce(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function eue(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function tue(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var rue=Do,nue=Do,iue=Do;function oy(e,t,r){return e.l+=2,[xce(e)]}function aC(e){return e.l+=6,[]}var aue=oy,sue=aC,oue=aC,lue=oy;function _U(e){return e.l+=2,[hs(e),e.read_shift(2)&1]}var cue=oy,uue=_U,due=aC,fue=oy,hue=oy,pue=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function mue(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=pue[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function gue(e){return e.l+=2,[e.read_shift(4)]}function xue(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function yue(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function bue(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function vue(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function wue(e){return e.l+=4,[0,0]}var QP={1:{n:"PtgExp",f:$ce},2:{n:"PtgTbl",f:iue},3:{n:"PtgAdd",f:cs},4:{n:"PtgSub",f:cs},5:{n:"PtgMul",f:cs},6:{n:"PtgDiv",f:cs},7:{n:"PtgPower",f:cs},8:{n:"PtgConcat",f:cs},9:{n:"PtgLt",f:cs},10:{n:"PtgLe",f:cs},11:{n:"PtgEq",f:cs},12:{n:"PtgGe",f:cs},13:{n:"PtgGt",f:cs},14:{n:"PtgNe",f:cs},15:{n:"PtgIsect",f:cs},16:{n:"PtgUnion",f:cs},17:{n:"PtgRange",f:cs},18:{n:"PtgUplus",f:cs},19:{n:"PtgUminus",f:cs},20:{n:"PtgPercent",f:cs},21:{n:"PtgParen",f:cs},22:{n:"PtgMissArg",f:cs},23:{n:"PtgStr",f:Hce},26:{n:"PtgSheet",f:xue},27:{n:"PtgEndSheet",f:yue},28:{n:"PtgErr",f:Uce},29:{n:"PtgBool",f:Wce},30:{n:"PtgInt",f:zce},31:{n:"PtgNum",f:qce},32:{n:"PtgArray",f:jce},33:{n:"PtgFunc",f:Bce},34:{n:"PtgFuncVar",f:Fce},35:{n:"PtgName",f:Yce},36:{n:"PtgRef",f:Mce},37:{n:"PtgArea",f:vce},38:{n:"PtgMemArea",f:Jce},39:{n:"PtgMemErr",f:rue},40:{n:"PtgMemNoMem",f:nue},41:{n:"PtgMemFunc",f:Zce},42:{n:"PtgRefErr",f:eue},43:{n:"PtgAreaErr",f:Sce},44:{n:"PtgRefN",f:Lce},45:{n:"PtgAreaN",f:kce},46:{n:"PtgMemAreaN",f:bue},47:{n:"PtgMemNoMemN",f:vue},57:{n:"PtgNameX",f:Xce},58:{n:"PtgRef3d",f:Rce},59:{n:"PtgArea3d",f:wce},60:{n:"PtgRefErr3d",f:tue},61:{n:"PtgAreaErr3d",f:_ce},255:{}},Sue={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},_ue={1:{n:"PtgElfLel",f:_U},2:{n:"PtgElfRw",f:fue},3:{n:"PtgElfCol",f:aue},6:{n:"PtgElfRwV",f:hue},7:{n:"PtgElfColV",f:lue},10:{n:"PtgElfRadical",f:cue},11:{n:"PtgElfRadicalS",f:due},13:{n:"PtgElfColS",f:sue},15:{n:"PtgElfColSV",f:oue},16:{n:"PtgElfRadicalLel",f:uue},25:{n:"PtgList",f:mue},29:{n:"PtgSxName",f:gue},255:{}},kue={0:{n:"PtgAttrNoop",f:wue},1:{n:"PtgAttrSemi",f:Tce},2:{n:"PtgAttrIf",f:Cce},4:{n:"PtgAttrChoose",f:Ace},8:{n:"PtgAttrGoto",f:Nce},16:{n:"PtgAttrSum",f:Dce},32:{n:"PtgAttrBaxcel",f:XP},33:{n:"PtgAttrBaxcel",f:XP},64:{n:"PtgAttrSpace",f:Pce},65:{n:"PtgAttrSpaceSemi",f:Oce},128:{n:"PtgAttrIfError",f:Ece},255:{}};function ly(e,t,r,n){if(n.biff<8)return Do(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Kce(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Gce(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(Do(e,t)),s}function cy(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=QP[s]||QP[Sue[s]],(s===24||s===25)&&(i=(s===24?_ue:kue)[e[e.l+1]]),!i||!i.f?Do(e,t):o.push([i.n,i.f(e,t,r)]);return o}function jue(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Aue={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Nue(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function kU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function JP(e,t,r){var n=kU(e,t,r);return n=="#REF"?n:Nue(n,r)}function To(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,h=0,p,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",b=0,v=e[0].length;b<v;++b){var w=e[0][b];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=qa(" ",e[0][g][1][1]);break;case 1:y=qa("\r",e[0][g][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}l.push(u+Aue[w[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ex(w[1][1],o,i),l.push(Tx(d,s));break;case"PtgRefN":d=r?Ex(w[1][1],r,i):w[1][1],l.push(Tx(d,s));break;case"PtgRef3d":f=w[1][1],d=Ex(w[1][2],o,i),m=JP(n,f,i),l.push(m+"!"+Tx(d,s));break;case"PtgFunc":case"PtgFuncVar":var S=w[1][0],k=w[1][1];S||(S=0),S&=127;var j=S==0?[]:l.slice(-S);l.length-=S,k==="User"&&(k=j.shift()),l.push(k+"("+j.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":p=NP(w[1][1],r?{s:r}:o,i),l.push(ek(p,i));break;case"PtgArea":p=NP(w[1][1],o,i),l.push(ek(p,i));break;case"PtgArea3d":f=w[1][1],p=w[1][2],m=JP(n,f,i),l.push(m+"!"+ek(p,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=w[1][2];var A=(n.names||[])[h-1]||(n[0]||[])[h],L=A?A.Name:"SH33TJSNAME"+String(h);L&&L.slice(0,6)=="_xlfn."&&!i.xlfn&&(L=L.slice(6)),l.push(L);break;case"PtgNameX":var P=w[1][1];h=w[1][2];var B;if(i.biff<=5)P<0&&(P=-P),n[P]&&(B=n[P][h]);else{var E="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][h]&&n[P][h].itab>0&&(E=n.SheetNames[n[P][h].itab-1]+"!"):E=n.SheetNames[h-1]+"!"),n[P]&&n[P][h])E+=n[P][h].Name;else if(n[0]&&n[0][h])E+=n[0][h].Name;else{var T=(kU(n,P,i)||"").split(";;");T[h-1]?E=T[h-1]:E+="SH33TJSERRX"}l.push(E);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var F="(",W=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:F=qa(" ",e[0][g][1][1])+F;break;case 3:F=qa("\r",e[0][g][1][1])+F;break;case 4:W=qa(" ",e[0][g][1][1])+W;break;case 5:W=qa("\r",e[0][g][1][1])+W;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(F+l.pop()+W);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var z={c:r.c,r:r.r};if(n.sharedf[Yn(d)]){var se=n.sharedf[Yn(d)];l.push(To(se,o,z,n,i))}else{var de=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(To(u[1],o,z,n,i)),de=!0;break}de||l.push(w[1])}break;case"PtgArray":l.push("{"+jue(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var U=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&U.indexOf(e[0][b][0])==-1){w=e[0][g];var G=!0;switch(w[1][0]){case 4:G=!1;case 0:y=qa(" ",w[1][1]);break;case 5:G=!1;case 1:y=qa("\r",w[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((G?y:"")+l.pop()+(G?"":y)),g=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function Cue(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Do(e,t-2)];var l=cy(e,o,r);return t!==o+i&&(s=ly(e,t-o-i,l,r)),e.l=n,[l,s]}function Eue(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Do(e,t-2)];var l=cy(e,o,r);return t!==o+i&&(s=ly(e,t-o-i,l,r)),e.l=n,[l,s]}function Tue(e,t,r,n){var i=e.l+t,s=cy(e,n,r),o;return i!==e.l&&(o=ly(e,i-e.l,s,r)),[s,o]}function Pue(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=cy(e,s,r);return s==65535?[[],Do(e,t-2)]:(t!==s+2&&(i=ly(e,n-s-2,o,r)),[o,i])}function Oue(e){var t;if(Ld(e,e.l+6)!==65535)return[Ro(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Mue(e){if(e==null){var t=_r(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return _0(e);return _0(0)}function ak(e,t,r){var n=e.l+t,i=ud(e);r.biff==2&&++e.l;var s=Oue(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=Eue(e,n-e.l,r);return{cell:i,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function Lue(e,t,r,n,i){var s=j0(t,r,i),o=Mue(e.v),l=_r(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=_r(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Hs([s,o,l,u]);return f}function MS(e,t,r){var n=e.read_shift(4),i=cy(e,n,r),s=e.read_shift(4),o=s>0?ly(e,s,i,r):null;return[i,o]}var Rue=MS,LS=MS,Bue=MS,Fue=MS,Iue={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Due={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ZP(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function $ue(e){var t="of:="+e.replace(nC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function sk(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Uue(e){return e.replace(/\./,"!")}var Ox={},xm={},Mx=typeof Map<"u";function sC(e,t,r){var n=0,i=e.length;if(r){if(Mx?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Mx?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Mx?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function RS(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Oo=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=y1(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=G2(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function o0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function jh(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){$d(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function AU(e,t,r,n,i,s){try{n.cellNF&&(e.z=Vn[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ma(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Vn[t]==null&&$d(Ine[t]||"General",t),e.t==="e")e.w=e.w||df[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d1(e.v);else if(e.t==="d"){var o=Os(e.v);(o|0)===o?e.w=o.toString(10):e.w=d1(o)}else{if(e.v===void 0)return"";e.w=w0(e.v,xm)}else e.t==="d"?e.w=Dc(t,Os(e.v),xm):e.w=Dc(t,e.v,xm)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=V2(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=V2(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function zue(e,t,r){if(e&&e["!ref"]){var n=_i(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function Wue(e,t){var r=_i(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=si(r))}var que=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Hue=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Vue=/<(?:\w:)?hyperlink [^>]*>/mg,Gue=/"(\w*:\w*)"/,Kue=/<(?:\w:)?col\b[^>]*[\/]?>/g,Yue=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Xue=/<(?:\w:)?pageMargins[^>]*\/>/g,NU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Que=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Jue=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Zue(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(Hue);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(NU);h?oC(h[0],l,i,r):(h=u.match(Que))&&tde(h[0],h[1]||"",l,i,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var m=u.slice(p,p+50).match(Gue);m&&Wue(l,m[1])}var g=u.match(Jue);g&&g[1]&&pde(g[1],i);var y=[];if(t.cellStyles){var b=u.match(Kue);b&&cde(y,b)}f&&xde(f[1],l,t,c,s,o);var v=d.match(Yue);v&&(l["!autofilter"]=dde(v[0]));var w=[],S=d.match(que);if(S)for(p=0;p!=S.length;++p)w[p]=_i(S[p].slice(S[p].indexOf('"')+1));var k=d.match(Vue);k&&sde(l,k,n);var j=d.match(Xue);if(j&&(l["!margins"]=ode(Xn(j[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=si(c)),t.sheetRows>0&&l["!ref"]){var A=_i(l["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>c.e.r&&(A.e.r=c.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>c.e.c&&(A.e.c=c.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),l["!fullref"]=l["!ref"],l["!ref"]=si(A))}return y.length>0&&(l["!cols"]=y),w.length>0&&(l["!merges"]=w),l}function ede(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+si(e[r])+'"/>';return t+"</mergeCells>"}function oC(e,t,r,n){var i=Xn(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Si(Ki(i.codeName)))}function tde(e,t,r,n,i){oC(e.slice(0,e.indexOf(">")),r,n,i)}function rde(e,t,r,n,i){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Yu(Wi(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+ln("outlinePr",null,u)}!s&&!l||(i[i.length]=ln("sheetPr",l,o))}var nde=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ide=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ade(e){var t={sheet:1};return nde.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),ide.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=eC(e.password).toString(16).toUpperCase()),ln("sheetProtection",null,t)}function sde(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Xn(Ki(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+Si(s.location))):(s.Target="#"+Si(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=_i(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Yn({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function ode(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function lde(e){return o0(e),ln("pageMargins",null,e)}function cde(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Xn(t[n],!0);i.hidden&&(i.hidden=fa(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,tC(i.width)),fh(i);s<=o;)e[s++]=ga(i)}}function ude(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=ln("col",null,RS(i,n)));return r[r.length]="</cols>",r.join("")}function dde(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function fde(e,t,r,n){var i=typeof e.ref=="string"?e.ref:si(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=El(i);o.s.r==o.e.r&&(o.e.r=El(t["!ref"]).e.r,i=si(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ln("autoFilter",null,{ref:i})}var hde=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function pde(e,t){t.Views||(t.Views=[{}]),(e.match(hde)||[]).forEach(function(r,n){var i=Xn(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),fa(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function mde(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ln("sheetViews",ln("sheetView",null,i),{})}function gde(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=df[e.v];break;case"d":n&&n.cellDates?i=ma(e.v,-1).toISOString():(e=ga(e),e.t="n",i=""+(e.v=Os(ma(e.v)))),typeof e.z>"u"&&(e.z=Vn[14]);break;default:i=e.v;break}var l=fo("v",Wi(i)),c={r:t},u=jh(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=fo("v",""+sC(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=ln("f",Wi(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ln("c",l,c)}var xde=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=f1("v"),o=f1("f");return function(c,u,d,f,h,p){for(var m=0,g="",y=[],b=[],v=0,w=0,S=0,k="",j,A,L=0,P=0,B,E,T=0,F=0,W=Array.isArray(p.CellXf),z,se=[],de=[],U=Array.isArray(u),G=[],re={},X=!1,C=!!d.sheetStubs,K=c.split(t),V=0,R=K.length;V!=R;++V){g=K[V].trim();var J=g.length;if(J!==0){var q=0;e:for(m=0;m<J;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(A=Xn(g.slice(q,m),!0),L=A.r!=null?parseInt(A.r,10):L+1,P=-1,d.sheetRows&&d.sheetRows<L)continue;re={},X=!1,A.ht&&(X=!0,re.hpt=parseFloat(A.ht),re.hpx=Dm(re.hpt)),A.hidden=="1"&&(X=!0,re.hidden=!0),A.outlineLevel!=null&&(X=!0,re.level=+A.outlineLevel),X&&(G[L-1]=re)}break;case"<":q=m;break}if(q>=m)break;if(A=Xn(g.slice(q,m),!0),L=A.r!=null?parseInt(A.r,10):L+1,P=-1,!(d.sheetRows&&d.sheetRows<L)){f.s.r>L-1&&(f.s.r=L-1),f.e.r<L-1&&(f.e.r=L-1),d&&d.cellStyles&&(re={},X=!1,A.ht&&(X=!0,re.hpt=parseFloat(A.ht),re.hpx=Dm(re.hpt)),A.hidden=="1"&&(X=!0,re.hidden=!0),A.outlineLevel!=null&&(X=!0,re.level=+A.outlineLevel),X&&(G[L-1]=re)),y=g.slice(m).split(e);for(var Y=0;Y!=y.length&&y[Y].trim().charAt(0)=="<";++Y);for(y=y.slice(Y),m=0;m!=y.length;++m)if(g=y[m].trim(),g.length!==0){if(b=g.match(r),v=m,w=0,S=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(v=0,k=b[1],w=0;w!=k.length&&!((S=k.charCodeAt(w)-64)<1||S>26);++w)v=26*v+S;--v,P=v}else++P;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,A=Xn(g.slice(0,w),!0),A.r||(A.r=Yn({r:L-1,c:P})),k=g.slice(w),j={t:""},(b=k.match(s))!=null&&b[1]!==""&&(j.v=Si(b[1])),d.cellFormula){if((b=k.match(o))!=null&&b[1]!==""){if(j.f=Si(Ki(b[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=YP(j.f)),b[0].indexOf('t="array"')>-1)j.F=(k.match(i)||[])[1],j.F.indexOf(":")>-1&&se.push([_i(j.F),j.F]);else if(b[0].indexOf('t="shared"')>-1){E=Xn(b[0]);var Q=Si(Ki(b[1]));d.xlfn||(Q=YP(Q)),de[parseInt(E.si,10)]=[E,Q,A.r]}}else(b=k.match(/<f[^>]*\/>/))&&(E=Xn(b[0]),de[E.si]&&(j.f=hce(de[E.si][1],de[E.si][2],A.r)));var ie=Ta(A.r);for(w=0;w<se.length;++w)ie.r>=se[w][0].s.r&&ie.r<=se[w][0].e.r&&ie.c>=se[w][0].s.c&&ie.c<=se[w][0].e.c&&(j.F=se[w][1])}if(A.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(C)j.t="z";else continue;else j.t=A.t||"n";switch(f.s.c>P&&(f.s.c=P),f.e.c<P&&(f.e.c=P),j.t){case"n":if(j.v==""||j.v==null){if(!C)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!C)continue;j.t="z"}else B=Ox[parseInt(j.v,10)],j.v=B.t,j.r=B.r,d.cellHTML&&(j.h=B.h);break;case"str":j.t="s",j.v=j.v!=null?Ki(j.v):"",d.cellHTML&&(j.h=D3(j.v));break;case"inlineStr":b=k.match(n),j.t="s",b!=null&&(B=Z3(b[1]))?(j.v=B.t,d.cellHTML&&(j.h=B.h)):j.v="";break;case"b":j.v=fa(j.v);break;case"d":d.cellDates?j.v=ma(j.v,1):(j.v=Os(ma(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=E$[j.v];break}if(T=F=0,z=null,W&&A.s!==void 0&&(z=p.CellXf[A.s],z!=null&&(z.numFmtId!=null&&(T=z.numFmtId),d.cellStyles&&z.fillId!=null&&(F=z.fillId))),AU(j,T,F,d,h,p),d.cellDates&&W&&j.t=="n"&&sg(Vn[T])&&(j.t="d",j.v=PS(j.v)),A.cm&&d.xlmeta){var le=(d.xlmeta.Cell||[])[+A.cm-1];le&&le.type=="XLDAPR"&&(j.D=!0)}if(U){var O=Ta(A.r);u[O.r]||(u[O.r]=[]),u[O.r][O.c]=j}else u[A.r]=j}}}}G.length>0&&(u["!rows"]=G)}}();function yde(e,t,r,n){var i=[],s=[],o=_i(e["!ref"]),l="",c,u="",d=[],f=0,h=0,p=e["!rows"],m=Array.isArray(e),g={r:u},y,b=-1;for(h=o.s.c;h<=o.e.c;++h)d[h]=Ea(h);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=os(f),h=o.s.c;h<=o.e.c;++h){c=d[h]+u;var v=m?(e[f]||[])[h]:e[c];v!==void 0&&(l=gde(v,c,e,t))!=null&&s.push(l)}(s.length>0||p&&p[f])&&(g={r:u},p&&p[f]&&(y=p[f],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=b1(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),i[i.length]=ln("row",s.join(""),g))}if(p)for(;f<p.length;++f)p&&p[f]&&(g={r:f+1},y=p[f],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=b1(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level),i[i.length]=ln("row","",g));return i.join("")}function CU(e,t,r,n){var i=[ls,ln("worksheet",null,{xmlns:Y0[0],"xmlns:r":Ts.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=_i(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=si(d)}n||(n={}),c["!comments"]=[];var f=[];rde(c,r,e,t,i),i[i.length]=ln("dimension",null,{ref:u}),i[i.length]=mde(c,t,e,r),t.sheetFormat&&(i[i.length]=ln("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=ude(c,c["!cols"])),i[o=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=yde(c,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),c["!protect"]&&(i[i.length]=ade(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=fde(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=ede(c["!merges"]));var h=-1,p,m=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(p={ref:g[0]},g[1].Target.charAt(0)!="#"&&(m=$i(n,-1,Wi(g[1].Target).replace(/#.*$/,""),hi.HLINK),p["r:id"]="rId"+m),(h=g[1].Target.indexOf("#"))>-1&&(p.location=Wi(g[1].Target.slice(h+1))),g[1].Tooltip&&(p.tooltip=Wi(g[1].Tooltip)),i[i.length]=ln("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=lde(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=fo("ignoredErrors",ln("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=$i(n,-1,"../drawings/drawing"+(e+1)+".xml",hi.DRAW),i[i.length]=ln("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=$i(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",hi.VML),i[i.length]=ln("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function bde(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function vde(e,t,r){var n=_r(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=b1(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Yn(u)];m&&(f<0&&(f=p),h=p)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,h))}var g=n.l;return n.l=c,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function wde(e,t,r,n){var i=vde(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Dr(e,0,i)}var Sde=Z0,_de=cg;function kde(){}function jde(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Cie(e),r}function Ade(e,t,r){r==null&&(r=_r(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return W2({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),k$(e,r),r.slice(0,r.l)}function Nde(e){var t=Hc(e);return[t]}function Cde(e,t,r){return r==null&&(r=_r(8)),X0(t,r)}function Ede(e){var t=Q0(e);return[t]}function Tde(e,t,r){return r==null&&(r=_r(4)),J0(t,r)}function Pde(e){var t=Hc(e),r=e.read_shift(1);return[t,r,"b"]}function Ode(e,t,r){return r==null&&(r=_r(9)),X0(t,r),r.write_shift(1,e.v?1:0),r}function Mde(e){var t=Q0(e),r=e.read_shift(1);return[t,r,"b"]}function Lde(e,t,r){return r==null&&(r=_r(5)),J0(t,r),r.write_shift(1,e.v?1:0),r}function Rde(e){var t=Hc(e),r=e.read_shift(1);return[t,r,"e"]}function Bde(e,t,r){return r==null&&(r=_r(9)),X0(t,r),r.write_shift(1,e.v),r}function Fde(e){var t=Q0(e),r=e.read_shift(1);return[t,r,"e"]}function Ide(e,t,r){return r==null&&(r=_r(8)),J0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Dde(e){var t=Hc(e),r=e.read_shift(4);return[t,r,"s"]}function $de(e,t,r){return r==null&&(r=_r(12)),X0(t,r),r.write_shift(4,t.v),r}function Ude(e){var t=Q0(e),r=e.read_shift(4);return[t,r,"s"]}function zde(e,t,r){return r==null&&(r=_r(8)),J0(t,r),r.write_shift(4,t.v),r}function Wde(e){var t=Hc(e),r=Ro(e);return[t,r,"n"]}function qde(e,t,r){return r==null&&(r=_r(16)),X0(t,r),_0(e.v,r),r}function EU(e){var t=Q0(e),r=Ro(e);return[t,r,"n"]}function Hde(e,t,r){return r==null&&(r=_r(12)),J0(t,r),_0(e.v,r),r}function Vde(e){var t=Hc(e),r=K3(e);return[t,r,"n"]}function Gde(e,t,r){return r==null&&(r=_r(12)),X0(t,r),j$(e.v,r),r}function Kde(e){var t=Q0(e),r=K3(e);return[t,r,"n"]}function Yde(e,t,r){return r==null&&(r=_r(8)),J0(t,r),j$(e.v,r),r}function Xde(e){var t=Hc(e),r=H3(e);return[t,r,"is"]}function Qde(e){var t=Hc(e),r=Bo(e);return[t,r,"str"]}function Jde(e,t,r){return r==null&&(r=_r(12+4*e.v.length)),X0(t,r),Vs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Zde(e){var t=Q0(e),r=Bo(e);return[t,r,"str"]}function efe(e,t,r){return r==null&&(r=_r(8+4*e.v.length)),J0(t,r),Vs(e.v,r),r.length>r.l?r.slice(0,r.l):r}function tfe(e,t,r){var n=e.l+t,i=Hc(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var l=LS(e,n-e.l,r);o[3]=To(l,null,i,r.supbooks,r)}else e.l=n;return o}function rfe(e,t,r){var n=e.l+t,i=Hc(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var l=LS(e,n-e.l,r);o[3]=To(l,null,i,r.supbooks,r)}else e.l=n;return o}function nfe(e,t,r){var n=e.l+t,i=Hc(e);i.r=r["!row"];var s=Ro(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var l=LS(e,n-e.l,r);o[3]=To(l,null,i,r.supbooks,r)}else e.l=n;return o}function ife(e,t,r){var n=e.l+t,i=Hc(e);i.r=r["!row"];var s=Bo(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var l=LS(e,n-e.l,r);o[3]=To(l,null,i,r.supbooks,r)}else e.l=n;return o}var afe=Z0,sfe=cg;function ofe(e,t){return t==null&&(t=_r(4)),t.write_shift(4,e),t}function lfe(e,t){var r=e.l+t,n=Z0(e),i=V3(e),s=Bo(e),o=Bo(e),l=Bo(e);e.l=r;var c={rfx:n,relId:i,loc:s,display:l};return o&&(c.Tooltip=o),c}function cfe(e,t){var r=_r(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));cg({s:Ta(e[0]),e:Ta(e[0])},r),G3("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Vs(i||"",r),Vs(e[1].Tooltip||"",r),Vs("",r),r.slice(0,r.l)}function ufe(){}function dfe(e,t,r){var n=e.l+t,i=A$(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var l=Rue(e,n-e.l,r);o[1]=l}else e.l=n;return o}function ffe(e,t,r){var n=e.l+t,i=Z0(e),s=[i];if(r.cellFormula){var o=Fue(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function hfe(e,t,r){r==null&&(r=_r(18));var n=RS(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var TU=["left","right","top","bottom","header","footer"];function pfe(e){var t={};return TU.forEach(function(r){t[r]=Ro(e)}),t}function mfe(e,t){return t==null&&(t=_r(6*8)),o0(e),TU.forEach(function(r){_0(e[r],t)}),t}function gfe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function xfe(e,t,r){r==null&&(r=_r(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function yfe(e){var t=_r(24);return t.write_shift(4,4),t.write_shift(4,1),cg(e,t),t}function bfe(e,t){return t==null&&(t=_r(16*4+2)),t.write_shift(2,e.password?eC(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function vfe(){}function wfe(){}function Sfe(e,t,r,n,i,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,m,g,y,b,v,w,S,k,j=[];l.biff=12,l["!row"]=0;var A=0,L=!1,P=[],B={},E=l.supbooks||i.supbooks||[[]];if(E.sharedf=B,E.arrayf=P,E.SheetNames=i.SheetNames||i.Sheets.map(function(U){return U.name}),!l.supbooks&&(l.supbooks=E,i.Names))for(var T=0;T<i.Names.length;++T)E[0][T+1]=i.Names[T];var F=[],W=[],z=!1;v1[16]={n:"BrtShortReal",f:EU};var se;if(uf(e,function(G,re,X){if(!h)switch(X){case 148:u=G;break;case 0:p=G,l.sheetRows&&l.sheetRows<=p.r&&(h=!0),S=os(y=p.r),l["!row"]=p.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=Dm(G.hpt)),W[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:G[2]},G[2]){case"n":m.v=G[1];break;case"s":w=Ox[G[1]],m.v=w.t,m.r=w.r;break;case"b":m.v=!!G[1];break;case"e":m.v=G[1],l.cellText!==!1&&(m.w=df[m.v]);break;case"str":m.t="s",m.v=G[1];break;case"is":m.t="s",m.v=G[1].t;break}if((g=o.CellXf[G[0].iStyleRef])&&AU(m,g.numFmtId,null,l,s,o),b=G[0].c==-1?b+1:G[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=m):c[Ea(b)+S]=m,l.cellFormula){for(L=!1,A=0;A<P.length;++A){var C=P[A];p.r>=C[0].s.r&&p.r<=C[0].e.r&&b>=C[0].s.c&&b<=C[0].e.c&&(m.F=si(C[0]),L=!0)}!L&&G.length>3&&(m.f=G[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>b&&(d.s.c=b),d.e.r<p.r&&(d.e.r=p.r),d.e.c<b&&(d.e.c=b),l.cellDates&&g&&m.t=="n"&&sg(Vn[g.numFmtId])){var K=Kh(m.v);K&&(m.t="d",m.v=new Date(K.y,K.m-1,K.d,K.H,K.M,K.S,K.u))}se&&(se.type=="XLDAPR"&&(m.D=!0),se=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},b=G[0].c==-1?b+1:G[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=m):c[Ea(b)+S]=m,d.s.r>p.r&&(d.s.r=p.r),d.s.c>b&&(d.s.c=b),d.e.r<p.r&&(d.e.r=p.r),d.e.c<b&&(d.e.c=b),se&&(se.type=="XLDAPR"&&(m.D=!0),se=void 0);break;case 176:j.push(G);break;case 49:se=((l.xlmeta||{}).Cell||[])[G-1];break;case 494:var V=n["!id"][G.relId];for(V?(G.Target=V.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=V):G.relId==""&&(G.Target="#"+G.loc),y=G.rfx.s.r;y<=G.rfx.e.r;++y)for(b=G.rfx.s.c;b<=G.rfx.e.c;++b)l.dense?(c[y]||(c[y]=[]),c[y][b]||(c[y][b]={t:"z",v:void 0}),c[y][b].l=G):(v=Yn({c:b,r:y}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=G);break;case 426:if(!l.cellFormula)break;P.push(G),k=l.dense?c[y][b]:c[Ea(b)+S],k.f=To(G[1],d,{r:p.r,c:b},E,l),k.F=si(G[0]);break;case 427:if(!l.cellFormula)break;B[Yn(G[0].s)]=G[1],k=l.dense?c[y][b]:c[Ea(b)+S],k.f=To(G[1],d,{r:p.r,c:b},E,l);break;case 60:if(!l.cellStyles)break;for(;G.e>=G.s;)F[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},z||(z=!0,tC(G.w/256)),fh(F[G.e+1]);break;case 161:c["!autofilter"]={ref:si(G)};break;case 476:c["!margins"]=G;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),G.name&&(i.Sheets[r].CodeName=G.name),(G.above||G.left)&&(c["!outline"]={above:G.above,left:G.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),G.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!re.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+X.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=si(u||d)),l.sheetRows&&c["!ref"]){var de=_i(c["!ref"]);l.sheetRows<=+de.e.r&&(de.e.r=l.sheetRows-1,de.e.r>d.e.r&&(de.e.r=d.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>d.e.c&&(de.e.c=d.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),c["!fullref"]=c["!ref"],c["!ref"]=si(de))}return j.length>0&&(c["!merges"]=j),F.length>0&&(c["!cols"]=F),W.length>0&&(c["!rows"]=W),c}function _fe(e,t,r,n,i,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=ga(t),t.z=t.z||Vn[14],t.v=Os(ma(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=jh(i.cellXfs,t,i),t.l&&s["!links"].push([Yn(c),t.l]),t.c&&s["!comments"].push([Yn(c),t.c]),t.t){case"s":case"str":return i.bookSST?(l=sC(i.Strings,t.v,i.revStrings),c.t="s",c.v=l,o?Dr(e,18,zde(t,c)):Dr(e,7,$de(t,c))):(c.t="str",o?Dr(e,17,efe(t,c)):Dr(e,6,Jde(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Dr(e,13,Yde(t,c)):Dr(e,2,Gde(t,c)):o?Dr(e,16,Hde(t,c)):Dr(e,5,qde(t,c)),!0;case"b":return c.t="b",o?Dr(e,15,Lde(t,c)):Dr(e,4,Ode(t,c)),!0;case"e":return c.t="e",o?Dr(e,14,Ide(t,c)):Dr(e,3,Bde(t,c)),!0}return o?Dr(e,12,Tde(t,c)):Dr(e,1,Cde(t,c)),!0}function kfe(e,t,r,n){var i=_i(t["!ref"]||"A1"),s,o="",l=[];Dr(e,145);var c=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=u;++d){o=os(d),wde(e,t,i,d);var f=!1;if(d<=i.e.r)for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(l[h]=Ea(h)),s=l[h]+o;var p=c?(t[d]||[])[h]:t[s];if(!p){f=!1;continue}f=_fe(e,p,d,h,n,t,f)}}Dr(e,146)}function jfe(e,t){!t||!t["!merges"]||(Dr(e,177,ofe(t["!merges"].length)),t["!merges"].forEach(function(r){Dr(e,176,sfe(r))}),Dr(e,178))}function Afe(e,t){!t||!t["!cols"]||(Dr(e,390),t["!cols"].forEach(function(r,n){r&&Dr(e,60,hfe(n,r))}),Dr(e,391))}function Nfe(e,t){!t||!t["!ref"]||(Dr(e,648),Dr(e,649,yfe(_i(t["!ref"]))),Dr(e,650))}function Cfe(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=$i(r,-1,n[1].Target.replace(/#.*$/,""),hi.HLINK);Dr(e,494,cfe(n,i))}}),delete t["!links"]}function Efe(e,t,r,n){if(t["!comments"].length>0){var i=$i(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",hi.VML);Dr(e,551,G3("rId"+i)),t["!legacy"]=i}}function Tfe(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:si(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=El(s);l.s.r==l.e.r&&(l.e.r=El(t["!ref"]).e.r,s=si(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Dr(e,161,cg(_i(s))),Dr(e,162)}}function Pfe(e,t,r){Dr(e,133),Dr(e,137,xfe(t,r)),Dr(e,138),Dr(e,134)}function Ofe(e,t){t["!protect"]&&Dr(e,535,bfe(t["!protect"]))}function Mfe(e,t,r,n){var i=Cl(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=_i(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Dr(i,129),(r.vbaraw||o["!outline"])&&Dr(i,147,Ade(l,o["!outline"])),Dr(i,148,_de(c)),Pfe(i,o,r.Workbook),Afe(i,o),kfe(i,o,e,t),Ofe(i,o),Tfe(i,o,r,e),jfe(i,o),Cfe(i,o,n),o["!margins"]&&Dr(i,476,mfe(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Nfe(i,o),Efe(i,o,e,n),Dr(i,130),i.end()}function Lfe(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=Si((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function Rfe(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Lfe(f);d.s.r=d.s.c=0,d.e.c=l,u=Ea(l),h[0].forEach(function(p,m){o[u+os(m)]={t:"n",v:p,z:h[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=si(d)),o}function Bfe(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(NU);return l&&oC(l[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Ffe(e,t){e.l+=10;var r=Bo(e);return{name:r}}function Ife(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return uf(e,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var lC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Dfe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],$fe=[],Ufe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function eO(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=fa(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function tO(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=fa(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function PU(e){tO(e.WBProps,lC),tO(e.CalcPr,Ufe),eO(e.WBView,Dfe),eO(e.Sheets,$fe),xm.date1904=fa(e.WBProps.date1904)}function zfe(e){return!e.Workbook||!e.Workbook.WBProps?"false":fa(e.Workbook.WBProps.date1904)?"true":"false"}var Wfe="][*?/\\".split("");function OU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Wfe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function qfe(e,t,r){e.forEach(function(n,i){OU(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Hfe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];qfe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)zue(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Vfe=/<\w+:workbook/;function Gfe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(Uo,function(c,u){var d=Xn(c);switch(cd(d[0])){case"<?xml":break;case"<workbook":c.match(Vfe)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":lC.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=fa(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Ki(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Si(Ki(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ki(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),fa(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=Si(Ki(e.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Y0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return PU(r),r}function MU(e){var t=[ls];t[t.length]=ln("workbook",null,{xmlns:Y0[0],"xmlns:r":Ts.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(lC.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ln("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Wi(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=ln("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=ln("definedName",Wi(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Kfe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=$4(e),r.name=Bo(e),r}function Yfe(e,t){return t||(t=_r(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),G3(e.strRelID,t),Vs(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Xfe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Bo(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Qfe(e,t){t||(t=_r(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),k$(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Jfe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Zfe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=Eie(e),o=Bue(e,0,r),l=V3(e);e.l=n;var c={Name:s,Ptg:o};return i<268435455&&(c.Sheet=i),l&&(c.Comment=l),c}function ehe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],v1[16]={n:"BrtFRTArchID$",f:Jfe},uf(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=To(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),PU(r),r.Names=s,r.supbooks=o,r}function the(e,t){Dr(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Dr(e,156,Yfe(i))}Dr(e,144)}function rhe(e,t){t||(t=_r(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Vs("SheetJS",t),Vs(B2.version,t),Vs(B2.version,t),Vs("7262",t),t.length>t.l?t.slice(0,t.l):t}function nhe(e,t){t||(t=_r(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function ihe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Dr(e,135),Dr(e,158,nhe(i)),Dr(e,136))}}function ahe(e,t){var r=Cl();return Dr(r,131),Dr(r,128,rhe()),Dr(r,153,Qfe(e.Workbook&&e.Workbook.WBProps||null)),ihe(r,e),the(r,e),Dr(r,132),r.end()}function she(e,t,r){return t.slice(-4)===".bin"?ehe(e,r):Gfe(e,r)}function ohe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?Sfe(e,n,r,i,s,o,l):Zue(e,n,r,i,s,o,l)}function lhe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?Ife(e,n,r,i,s):Bfe(e,n,r,i,s)}function che(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?dce():fce()}function uhe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?cce():uce()}function dhe(e,t,r,n){return t.slice(-4)===".bin"?sle(e,r,n):Koe(e,r,n)}function fhe(e,t,r){return hU(e,r)}function hhe(e,t,r){return t.slice(-4)===".bin"?hoe(e,r):uoe(e,r)}function phe(e,t,r){return t.slice(-4)===".bin"?ice(e,r):Yle(e,r)}function mhe(e,t,r){return t.slice(-4)===".bin"?Vle(e):qle(e)}function ghe(e,t,r,n){return r.slice(-4)===".bin"?Gle(e,t,r,n):void 0}function xhe(e,t,r){return t.slice(-4)===".bin"?Ule(e,t,r):Wle(e,t,r)}function yhe(e,t,r){return(t.slice(-4)===".bin"?ahe:MU)(e)}function bhe(e,t,r,n,i){return(t.slice(-4)===".bin"?Mfe:CU)(e,r,n,i)}function vhe(e,t,r){return(t.slice(-4)===".bin"?gle:dU)(e,r)}function whe(e,t,r){return(t.slice(-4)===".bin"?goe:nU)(e,r)}function She(e,t,r){return(t.slice(-4)===".bin"?ace:gU)(e)}function _he(e){return(e.slice(-4)===".bin"?zle:pU)()}var LU=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,RU=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zc(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(LU),s,o,l,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(RU),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function khe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(LU),i,s,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(RU),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Lx;function jhe(e,t){var r=Lx[e]||Si(e);return r==="General"?w0(t):Dc(r,t)}function Ahe(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=fa(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=ma(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Si(t)]=i}function Nhe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||df[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d1(e.v):e.w=w0(e.v):e.w=jhe(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Lx[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&sg(n)){var i=Kh(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function Che(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=$oe[n.Pattern]||n.Pattern)}e[t.ID]=t}function Ehe(e,t,r,n,i,s,o,l,c,u){var d="General",f=n.StyleID,h={};u=u||{};var p=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=fa(e);break;case"String":n.t="s",n.r=yP(Si(e)),n.v=e.indexOf("<")>-1?Si(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ma(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Si(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=E$[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=yP(t||e));break}if(Nhe(n,d,u),u.cellFormula!==!1)if(n.Formula){var g=Si(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=gm(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=gm("RC:RC",i):n.ArrayRange&&(n.F=gm(n.ArrayRange,i),c.push([_i(n.F),n.F]))}else for(m=0;m<c.length;++m)i.r>=c[m][0].s.r&&i.r<=c[m][0].e.r&&i.c>=c[m][0].s.c&&i.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(p.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function The(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ok(e,t){var r=t||{};og();var n=fx($3(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ki(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=ga(r);return o.type="string",Im.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Oe){i.indexOf("<"+Oe)>=0&&(s=!0)}),s)return m0e(n,r);Lx={"General Number":"General","General Date":Vn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Vn[15],"Short Date":Vn[14],"Long Time":Vn[19],"Medium Time":Vn[18],"Short Time":Vn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Vn[2],Standard:Vn[4],Percent:Vn[10],Scientific:Vn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],h=r.dense?[]:{},p="",m={},g={},y=Zc('<Data ss:Type="String">'),b=0,v=0,w=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},j={},A="",L=0,P=[],B={},E={},T=0,F=[],W=[],z={},se=[],de,U=!1,G=[],re=[],X={},C=0,K=0,V={Sheets:[],WBProps:{date1904:!1}},R={};p1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";l=p1.exec(n);)switch(l[3]=(J=l[3]).toLowerCase()){case"data":if(J=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?Ehe(n.slice(b,l.index),A,y,c[c.length-1][0]=="comment"?z:m,{c:v,r:w},k,se[v],g,G,r):(A="",y=Zc(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(W.length>0&&(m.c=W),(!r.sheetRows||r.sheetRows>w)&&m.v!==void 0&&(r.dense?(h[w]||(h[w]=[]),h[w][v]=m):h[Ea(v)+os(w)]=m),m.HRef&&(m.l={Target:Si(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(C=v+(parseInt(m.MergeAcross,10)|0),K=w+(parseInt(m.MergeDown,10)|0),P.push({s:{c:v,r:w},e:{c:C,r:K}})),!r.sheetStubs)m.MergeAcross?v=C+1:++v;else if(m.MergeAcross||m.MergeDown){for(var q=v;q<=C;++q)for(var Y=w;Y<=K;++Y)(q>v||Y>w)&&(r.dense?(h[Y]||(h[Y]=[]),h[Y][q]={t:"z"}):h[Ea(q)+os(Y)]={t:"z"});v=C+1}else++v;else m=khe(l[0]),m.Index&&(v=+m.Index-1),v<S.s.c&&(S.s.c=v),v>S.e.c&&(S.e.c=v),l[0].slice(-2)==="/>"&&++v,W=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<S.s.r&&(S.s.r=w),w>S.e.r&&(S.e.r=w),l[0].slice(-2)==="/>"&&(g=Zc(l[0]),g.Index&&(w=+g.Index-1)),v=0,++w):(g=Zc(l[0]),g.Index&&(w=+g.Index-1),X={},(g.AutoFitHeight=="0"||g.Height)&&(X.hpx=parseInt(g.Height,10),X.hpt=b1(X.hpx),re[w]=X),g.Hidden=="1"&&(X.hidden=!0,re[w]=X));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(p),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=si(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=si(S))),P.length&&(h["!merges"]=P),se.length>0&&(h["!cols"]=se),re.length>0&&(h["!rows"]=re),d[p]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=v=0,c.push([l[3],!1]),u=Zc(l[0]),p=Si(u.Name),h=r.dense?[]:{},P=[],G=[],re=[],R={name:p,Hidden:0},V.Sheets.push(R);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),se=[],U=!1}break;case"style":l[1]==="/"?Che(k,j,r):j=Zc(l[0]);break;case"numberformat":j.nf=Si(Zc(l[0]).Format||"General"),Lx[j.nf]&&(j.nf=Lx[j.nf]);for(var Q=0;Q!=392&&Vn[Q]!=j.nf;++Q);if(Q==392){for(Q=57;Q!=392;++Q)if(Vn[Q]==null){$d(j.nf,Q);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(de=Zc(l[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!U&&de.wpx>10){U=!0,Oo=cU;for(var ie=0;ie<se.length;++ie)se[ie]&&fh(se[ie])}U&&fh(de),se[de.Index-1||se.length]=de;for(var le=0;le<+de.Span;++le)se[se.length]=ga(de);break;case"namedrange":if(l[1]==="/")break;V.Names||(V.Names=[]);var O=Xn(l[0]),H={Name:O.Name,Ref:gm(O.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(H.Sheet=V.Sheets.length-1),V.Names.push(H);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?A+=n.slice(L,l.index):L=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Zc(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?eae(B,J,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));The(z),W.push(z)}else c.push([l[3],!1]),u=Zc(l[0]),z={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ae=Zc(l[0]);h["!autofilter"]={ref:gm(ae.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return sO(n,r);var I=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:I=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:I=!1}break;case"excelworkbook":switch(l[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:I=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:I=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else T=l.index+l[0].length;break;case"header":h["!margins"]||o0(h["!margins"]={},"xlml"),isNaN(+Xn(l[0]).Margin)||(h["!margins"].header=+Xn(l[0]).Margin);break;case"footer":h["!margins"]||o0(h["!margins"]={},"xlml"),isNaN(+Xn(l[0]).Margin)||(h["!margins"].footer=+Xn(l[0]).Margin);break;case"pagemargins":var Z=Xn(l[0]);h["!margins"]||o0(h["!margins"]={},"xlml"),isNaN(+Z.Top)||(h["!margins"].top=+Z.Top),isNaN(+Z.Left)||(h["!margins"].left=+Z.Left),isNaN(+Z.Right)||(h["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(h["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:I=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:I=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:I=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:I=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:I=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:I=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:I=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:I=!1}break;case"smarttags":break;default:I=!1;break}if(I||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Ahe(E,J,F,n.slice(T,l.index)):(F=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var pe={};return!r.bookSheets&&!r.bookProps&&(pe.Sheets=d),pe.SheetNames=f,pe.Workbook=V,pe.SSF=ga(Vn),pe.Props=B,pe.Custprops=E,pe}function G4(e,t){switch(uC(t=t||{}),t.type||"base64"){case"base64":return ok(ic(e),t);case"binary":case"buffer":case"file":return ok(e,t);case"array":return ok(_h(e),t)}}function Phe(e,t){var r=[];return e.Props&&r.push(tae(e.Props,t)),e.Custprops&&r.push(rae(e.Props,e.Custprops)),r.join("")}function Ohe(){return""}function Mhe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(ln("NumberFormat",null,{"ss:Format":Wi(Vn[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(ln("Style",s.join(""),o))}),ln("Styles",r.join(""))}function BU(e){return ln("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+iC(e.Ref,{r:0,c:0})})}function Lhe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(BU(i)))}return ln("Names",r.join(""))}function Rhe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(BU(l)))}return s.join("")}function Bhe(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ln("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ln("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ln("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ln("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(fo("ProtectContents","True")),e["!protect"].objects&&i.push(fo("ProtectObjects","True")),e["!protect"].scenarios&&i.push(fo("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(fo("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(fo("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":ln("WorksheetOptions",i.join(""),{xmlns:Hl.x})}function Fhe(e){return e.map(function(t){var r=iie(t.t||""),n=ln("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ln("Comment",n,{"ss:Author":t.a})}).join("")}function Ihe(e,t,r,n,i,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Wi(iC(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Ta(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Wi(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Wi(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=df[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Vn[14]);break;case"s":f="String",h=nie(e.v||"");break}var p=jh(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+p),l["ss:Index"]=o.c+1;var m=e.v!=null?h:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(g+=Fhe(e.c)),ln("Cell",g,l)}function Dhe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Dm(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function $he(e,t,r,n){if(!e["!ref"])return"";var i=_i(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,b){fh(y);var v=!!y.width,w=RS(b,y),S={"ss:Index":b+1};v&&(S["ss:Width"]=x1(w.width)),y.hidden&&(S["ss:Hidden"]="1"),l.push(ln("Column",null,S))});for(var c=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var d=[Dhe(u,(e["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var h=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:f},m=Yn(p),g=c?(e[u]||[])[f]:e[m];d.push(Ihe(g,m,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Uhe(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],o=s?Rhe(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?$he(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Bhe(s,t,e,r)),n.join("")}function zhe(e,t){t||(t={}),e.SSF||(e.SSF=ga(Vn)),e.SSF&&(og(),CS(e.SSF),t.revssf=TS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],jh(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Phe(e,t)),r.push(Ohe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ln("Worksheet",Uhe(n,t,e),{"ss:Name":Wi(e.SheetNames[n])}));return r[2]=Mhe(e,t),r[3]=Lhe(e),ls+ln("Workbook",r.join(""),{xmlns:Hl.ss,"xmlns:o":Hl.o,"xmlns:x":Hl.x,"xmlns:ss":Hl.ss,"xmlns:dt":Hl.dt,"xmlns:html":Hl.html})}function Whe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Lie(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Rie(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var qhe=[60,1084,2066,2165,2175];function Hhe(e,t,r,n,i){var s=n,o=[],l=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Ld(r,r.l),u=K4[c],d=0;u!=null&&qhe.indexOf(c)>-1;)s=Ld(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=K4[c=Ld(r,r.l)];var f=Hs(o);uo(f,0);var h=0;f.lens=[];for(var p=0;p<o.length;++p)f.lens.push(h),h+=o[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function Ou(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Vn[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||df[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d1(e.v):e.w=w0(e.v):e.w=Dc(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&sg(Vn[n]||String(n))){var i=Kh(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Pb(e,t,r){return{v:e,ixfe:t,t:r}}function Vhe(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,h="",p,m,g,y,b={},v=[],w,S,k=[],j=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},L={},P=function(fe){return fe<8?i0[fe]:fe<64&&j[fe-8]||i0[fe]},B=function(fe,ge,lt){var He=ge.XF.data;if(!(!He||!He.patternType||!lt||!lt.cellStyles)){ge.s={},ge.s.patternType=He.patternType;var mt;(mt=g1(P(He.icvFore)))&&(ge.s.fgColor={rgb:mt}),(mt=g1(P(He.icvBack)))&&(ge.s.bgColor={rgb:mt})}},E=function(fe,ge,lt){if(!(X>1)&&!(lt.sheetRows&&fe.r>=lt.sheetRows)){if(lt.cellStyles&&ge.XF&&ge.XF.data&&B(fe,ge,lt),delete ge.ixfe,delete ge.XF,f=fe,h=Yn(fe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),fe.r<o.s.r&&(o.s.r=fe.r),fe.c<o.s.c&&(o.s.c=fe.c),fe.r+1>o.e.r&&(o.e.r=fe.r+1),fe.c+1>o.e.c&&(o.e.c=fe.c+1),lt.cellFormula&&ge.f){for(var He=0;He<v.length;++He)if(!(v[He][0].s.c>fe.c||v[He][0].s.r>fe.r)&&!(v[He][0].e.c<fe.c||v[He][0].e.r<fe.r)){ge.F=si(v[He][0]),(v[He][0].s.c!=fe.c||v[He][0].s.r!=fe.r)&&delete ge.f,ge.f&&(ge.f=""+To(v[He][1],o,fe,G,T));break}}lt.dense?(i[fe.r]||(i[fe.r]=[]),i[fe.r][fe.c]=ge):i[h]=ge}},T={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var F,W=[],z=[],se=[],de=[],U=!1,G=[];G.SheetNames=T.snames,G.sharedf=T.sharedf,G.arrayf=T.arrayf,G.names=[],G.XTI=[];var re=0,X=0,C=0,K=[],V=[],R;T.codepage=1200,lu(1200);for(var J=!1;e.l<e.length-1;){var q=e.l,Y=e.read_shift(2);if(Y===0&&re===10)break;var Q=e.l===e.length?0:e.read_shift(2),ie=K4[Y];if(ie&&ie.f){if(t.bookSheets&&re===133&&Y!==133)break;if(re=Y,ie.r===2||ie.r==12){var le=e.read_shift(2);if(Q-=2,!T.enc&&le!==Y&&((le&255)<<8|le>>8)!==Y)throw new Error("rt mismatch: "+le+"!="+Y);ie.r==12&&(e.l+=10,Q-=10)}var O={};if(Y===10?O=ie.f(e,Q,T):O=Hhe(Y,ie,e,Q,T),X==0&&[9,521,1033,2057].indexOf(re)===-1)continue;switch(Y){case 34:r.opts.Date1904=A.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=O;break;case 66:var H=Number(O);switch(H){case 21010:H=1200;break;case 32768:H=1e4;break;case 32769:H=1252;break}lu(T.codepage=H),J=!0;break;case 317:T.rrtabid=O;break;case 25:T.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:T.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(i["!type"]="dialog"),O.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),O.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:k.push(O);break;case 430:G.push([O]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(O);break;case 24:case 536:R={Name:O.Name,Ref:To(O.rgce,o,null,G,T)},O.itab>0&&(R.Sheet=O.itab-1),G.names.push(R),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(V[O.itab-1]={ref:si(O.rgce[0][0][1][2])});break;case 22:T.ExternCount=O;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(O),G.XTI=G.XTI.concat(O);break;case 2196:if(T.biff<8)break;R!=null&&(R.Comment=O[1]);break;case 18:i["!protect"]=O;break;case 19:O!==0&&T.WTF&&console.error("Password verifier: "+O);break;case 133:s[O.pos]=O,T.snames.push(O.name);break;case 10:{if(--X)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=si(o),t.sheetRows&&t.sheetRows<=o.e.r){var ae=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=si(o),o.e.r=ae}o.e.r++,o.e.c++}W.length>0&&(i["!merges"]=W),z.length>0&&(i["!objects"]=z),se.length>0&&(i["!cols"]=se),de.length>0&&(i["!rows"]=de),A.Sheets.push(L)}u===""?d=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[Y]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),T.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(T.biff=5,J=!0,lu(T.codepage=28591)),T.biff==8&&O.BIFFVer==0&&O.dt==16&&(T.biff=2),X++)break;if(i=t.dense?[]:{},T.biff<8&&!J&&(J=!0,lu(T.codepage=t.codepage||1252)),T.biff<5||O.BIFFVer==0&&O.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var I={pos:e.l-Q,name:u};s[I.pos]=I,T.snames.push(u)}else u=(s[q]||{name:""}).name;O.dt==32&&(i["!type"]="chart"),O.dt==64&&(i["!type"]="macro"),W=[],z=[],T.arrayf=v=[],se=[],de=[],U=!1,L={Hidden:(s[q]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[O.r]||[])[O.c]:i[Yn({c:O.c,r:O.r})])&&++O.c,w={ixfe:O.ixfe,XF:k[O.ixfe]||{},v:O.val,t:"n"},C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 5:case 517:w={ixfe:O.ixfe,XF:k[O.ixfe],v:O.val,t:O.t},C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 638:w={ixfe:O.ixfe,XF:k[O.ixfe],v:O.rknum,t:"n"},C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 189:for(var Z=O.c;Z<=O.C;++Z){var pe=O.rkrec[Z-O.c][0];w={ixfe:pe,XF:k[pe],v:O.rkrec[Z-O.c][1],t:"n"},C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:Z,r:O.r},w,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){l=O;break}if(w=Pb(O.val,O.cell.ixfe,O.tt),w.XF=k[w.ixfe],t.cellFormula){var Oe=O.formula;if(Oe&&Oe[0]&&Oe[0][0]&&Oe[0][0][0]=="PtgExp"){var Ae=Oe[0][0][1][0],ke=Oe[0][0][1][1],_e=Yn({r:Ae,c:ke});b[_e]?w.f=""+To(O.formula,o,O.cell,G,T):w.F=((t.dense?(i[Ae]||[])[ke]:i[_e])||{}).F}else w.f=""+To(O.formula,o,O.cell,G,T)}C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E(O.cell,w,t),l=O}break;case 7:case 519:if(l)l.val=O,w=Pb(O,l.cell.ixfe,"s"),w.XF=k[w.ixfe],t.cellFormula&&(w.f=""+To(l.formula,o,l.cell,G,T)),C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(O);var De=Yn(O[0].s);if(p=t.dense?(i[O[0].s.r]||[])[O[0].s.c]:i[De],t.cellFormula&&p){if(!l||!De||!p)break;p.f=""+To(O[1],o,O[0],G,T),p.F=si(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!l)break;b[Yn(l.cell)]=O[0],p=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[Yn(l.cell)],(p||{}).f=""+To(O[0],o,f,G,T)}}break;case 253:w=Pb(c[O.isst].t,O.ixfe,"s"),c[O.isst].h&&(w.h=c[O.isst].h),w.XF=k[w.ixfe],C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:O.ixfe,XF:k[O.ixfe],t:"z"},C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t));break;case 190:if(t.sheetStubs)for(var We=O.c;We<=O.C;++We){var Ct=O.ixfe[We-O.c];w={ixfe:Ct,XF:k[Ct],t:"z"},C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:We,r:O.r},w,t)}break;case 214:case 516:case 4:w=Pb(O.val,O.ixfe,"s"),w.XF=k[w.ixfe],C>0&&(w.z=K[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:O.c,r:O.r},w,t);break;case 0:case 512:X===1&&(o=O);break;case 252:c=O;break;case 1054:if(T.biff==4){K[C++]=O[1];for(var _t=0;_t<C+163&&Vn[_t]!=O[1];++_t);_t>=163&&$d(O[1],C+163)}else $d(O[1],O[0]);break;case 30:{K[C++]=O;for(var Xe=0;Xe<C+163&&Vn[Xe]!=O;++Xe);Xe>=163&&$d(O,C+163)}break;case 229:W=W.concat(O);break;case 93:z[O.cmo[0]]=T.lastobj=O;break;case 438:T.lastobj.TxO=O;break;case 127:T.lastobj.ImData=O;break;case 440:for(y=O[0].s.r;y<=O[0].e.r;++y)for(g=O[0].s.c;g<=O[0].e.c;++g)p=t.dense?(i[y]||[])[g]:i[Yn({c:g,r:y})],p&&(p.l=O[1]);break;case 2048:for(y=O[0].s.r;y<=O[0].e.r;++y)for(g=O[0].s.c;g<=O[0].e.c;++g)p=t.dense?(i[y]||[])[g]:i[Yn({c:g,r:y})],p&&p.l&&(p.l.Tooltip=O[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;p=t.dense?(i[O[0].r]||[])[O[0].c]:i[Yn(O[0])];var nt=z[O[2]];p||(t.dense?(i[O[0].r]||(i[O[0].r]=[]),p=i[O[0].r][O[0].c]={t:"z"}):p=i[Yn(O[0])]={t:"z"},o.e.r=Math.max(o.e.r,O[0].r),o.s.r=Math.min(o.s.r,O[0].r),o.e.c=Math.max(o.e.c,O[0].c),o.s.c=Math.min(o.s.c,O[0].c)),p.c||(p.c=[]),m={a:O[1],t:nt.TxO.t},p.c.push(m)}break;case 2173:Mle(k[O.ixfe],O.ext);break;case 125:{if(!T.cellStyles)break;for(;O.e>=O.s;)se[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},U||(U=!0,tC(O.w/256)),fh(se[O.e+1])}break;case 520:{var Ne={};O.level!=null&&(de[O.r]=Ne,Ne.level=O.level),O.hidden&&(de[O.r]=Ne,Ne.hidden=!0),O.hpt&&(de[O.r]=Ne,Ne.hpt=O.hpt,Ne.hpx=Dm(O.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||o0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Y]]=O;break;case 161:i["!margins"]||o0(i["!margins"]={}),i["!margins"].header=O.header,i["!margins"].footer=O.footer;break;case 574:O.RTL&&(A.Views[0].RTL=!0);break;case 146:j=O;break;case 2198:F=O;break;case 140:S=O;break;case 442:u?L.CodeName=O||L.name:A.WBProps.CodeName=O||"ThisWorkbook";break}}else ie||console.error("Missing Info for XLS Record 0x"+Y.toString(16)),e.l+=Q}return r.SheetNames=Ga(s).sort(function(be,fe){return Number(be)-Number(fe)}).map(function(be){return s[be].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&V.forEach(function(be,fe){r.Sheets[r.SheetNames[fe]]["!autofilter"]=be}),r.Strings=c,r.SSF=ga(Vn),T.enc&&(r.Encryption=T.enc),F&&(r.Themes=F),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),G.names.length>0&&(A.Names=G.names),r.Workbook=A,r}var Rx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Ghe(e,t,r){var n=zn.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=BP(n,U4,Rx.DSI);for(var s in i)t[s]=i[s]}catch(u){if(r.WTF)throw u}var o=zn.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=BP(o,z4,Rx.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(R$(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Khe(e,t){var r=[],n=[],i=[],s=0,o,l=fP(U4,"n"),c=fP(z4,"n");if(e.Props)for(o=Ga(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Ga(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)z$.indexOf(i[s][0])>-1||L$.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&zn.utils.cfb_add(t,"/SummaryInformation",FP(n,Rx.SI,c,z4)),(r.length||u.length)&&zn.utils.cfb_add(t,"/DocumentSummaryInformation",FP(r,Rx.DSI,l,U4,u.length?u:null,Rx.UDI))}function FU(e,t){t||(t={}),uC(t),P3(),t.codepage&&T3(t.codepage);var r,n;if(e.FullPaths){if(zn.find(e,"/encryption"))throw new Error("File is password-protected");r=zn.find(e,"!CompObj"),n=zn.find(e,"/Workbook")||zn.find(e,"/Book")}else{switch(t.type){case"base64":e=Gl(ic(e));break;case"binary":e=Gl(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}uo(e,0),n={content:e}}var i,s;if(r&&Whe(r),t.bookProps&&!t.bookSheets)i={};else{var o=fi?"buffer":"array";if(n&&n.content)i=Vhe(n.content,t);else if((s=zn.find(e,"PerfectOffice_MAIN"))&&s.content)i=s0.to_workbook(s.content,(t.type=o,t));else if((s=zn.find(e,"NativeContent_MAIN"))&&s.content)i=s0.to_workbook(s.content,(t.type=o,t));else throw(s=zn.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&zn.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=oce(e))}var l={};return e.FullPaths&&Ghe(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}function Yhe(e,t){var r=t||{},n=zn.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return zn.utils.cfb_add(n,i,IU(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Khe(e,n),r.biff==8&&e.vbaraw&&lce(n,zn.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var v1={0:{f:bde},1:{f:Nde},2:{f:Vde},3:{f:Rde},4:{f:Pde},5:{f:Wde},6:{f:Qde},7:{f:Dde},8:{f:ife},9:{f:nfe},10:{f:tfe},11:{f:rfe},12:{f:Ede},13:{f:Kde},14:{f:Fde},15:{f:Mde},16:{f:EU},17:{f:Zde},18:{f:Ude},19:{f:H3},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Zfe},40:{},42:{},43:{f:Qoe},44:{f:Yoe},45:{f:ele},46:{f:rle},47:{f:tle},48:{},49:{f:Sie},50:{},51:{f:Ble},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Z$},62:{f:Xde},63:{f:Hle},64:{f:vfe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Do,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:gfe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:jde},148:{f:Sde,p:16},151:{f:ufe},152:{},153:{f:Xfe},154:{},155:{},156:{f:Kfe},157:{},158:{},159:{T:1,f:foe},160:{T:-1},161:{T:1,f:Z0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:afe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Lle},336:{T:-1},337:{f:Dle,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$4},357:{},358:{},359:{},360:{T:1},361:{},362:{f:J$},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:dfe},427:{f:ffe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:pfe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:kde},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:lfe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$4},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:rce},633:{T:1},634:{T:-1},635:{T:1,f:ece},636:{T:-1},637:{f:Aie},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Ffe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:wfe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},K4={6:{f:ak},10:{f:Nf},12:{f:hs},13:{f:hs},14:{f:Za},15:{f:Za},16:{f:Ro},17:{f:Za},18:{f:Za},19:{f:hs},20:{f:WP},21:{f:WP},23:{f:J$},24:{f:HP},25:{f:Za},26:{},27:{},28:{f:wse},29:{},34:{f:Za},35:{f:qP},38:{f:Ro},39:{f:Ro},40:{f:Ro},41:{f:Ro},42:{f:Za},43:{f:Za},47:{f:Moe},49:{f:Kae},51:{f:hs},60:{},61:{f:Wae},64:{f:Za},65:{f:Gae},66:{f:hs},77:{},80:{},81:{},82:{},85:{f:hs},89:{},90:{},91:{},92:{f:Oae},93:{f:kse},94:{},95:{f:Za},96:{},97:{},99:{f:Za},125:{f:Z$},128:{f:cse},129:{f:Lae},130:{f:hs},131:{f:Za},132:{f:Za},133:{f:Rae},134:{},140:{f:Ose},141:{f:hs},144:{},146:{f:Rse},151:{},152:{},153:{},154:{},155:{},156:{f:hs},157:{},158:{},160:{f:zse},161:{f:Ise},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:ase},190:{f:sse},193:{f:Nf},197:{},198:{},199:{},200:{},201:{},202:{f:Za},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:hs},220:{},221:{f:Za},222:{},224:{f:lse},225:{f:Pae},226:{f:Nf},227:{},229:{f:Sse},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Fae},253:{f:Xae},255:{f:Dae},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:W$},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Za},353:{f:Nf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:pse},431:{f:Za},432:{},433:{},434:{},437:{},438:{f:Nse},439:{f:Za},440:{f:Cse},441:{},442:{f:sy},443:{},444:{f:hs},445:{},446:{},448:{f:Nf},449:{f:zae,r:2},450:{f:Nf},512:{f:$P},513:{f:Use},515:{f:fse},516:{f:Jae},517:{f:zP},519:{f:Wse},520:{f:$ae},523:{},545:{f:VP},549:{f:DP},566:{},574:{f:Hae},638:{f:ise},659:{},1048:{},1054:{f:ese},1084:{},1212:{f:yse},2048:{f:Tse},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Cb},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Nf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Bse,r:12},2173:{f:Ole,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Za,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:xse,r:12},2197:{},2198:{f:Ale,r:12},2199:{},2200:{},2201:{},2202:{f:bse,r:12},2203:{f:Nf},2204:{},2205:{},2206:{},2207:{},2211:{f:Uae},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:hs},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Dse},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Lse},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$P},1:{},2:{f:Kse},3:{f:Vse},4:{f:Hse},5:{f:zP},7:{f:Xse},8:{},9:{f:Cb},11:{},22:{f:hs},30:{f:rse},31:{},32:{},33:{f:VP},36:{},37:{f:DP},50:{f:Qse},62:{},52:{},67:{},68:{f:hs},69:{},86:{},126:{},127:{f:qse},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Jse},223:{},234:{},354:{},421:{},518:{f:ak},521:{f:Cb},536:{f:HP},547:{f:qP},561:{},579:{},1030:{f:ak},1033:{f:Cb},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function un(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&z3(r)&&e.push(r)}}function Xhe(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return un(e,t,r,i);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<i;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function uy(e,t,r){return e||(e=_r(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Qhe(e,t,r,n){var i=_r(9);return uy(i,e,t),q$(r,n||"b",i),i}function Jhe(e,t,r){var n=_r(8+2*r.length);return uy(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Zhe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Os(ma(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?un(e,2,Yse(r,n,i)):un(e,3,Gse(r,n,i));return;case"b":case"e":un(e,5,Qhe(r,n,t.v,t.t));return;case"s":case"str":un(e,4,Jhe(r,n,(t.v||"").slice(0,255)));return}un(e,1,uy(null,r,n))}function e0e(e,t,r,n){var i=Array.isArray(t),s=_i(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=si(s)}for(var u=s.s.r;u<=s.e.r;++u){l=os(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=Ea(d)),o=c[d]+l;var f=i?(t[u]||[])[d]:t[o];f&&Zhe(e,f,u,d)}}}function t0e(e,t){for(var r=t||{},n=Cl(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return un(n,r.biff==4?1033:r.biff==3?521:9,J3(e,16,r)),e0e(n,e.Sheets[e.SheetNames[i]],i,r),un(n,10),n.end()}function r0e(e,t,r){un(e,49,Yae({sz:12,name:"Arial"},r))}function n0e(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&un(e,1054,tse(i,t[i],r))})}function i0e(e,t){var r=_r(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),un(e,2151,r),r=_r(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Y$(_i(t["!ref"]||"A1"),r),r.write_shift(4,4),un(e,2152,r)}function a0e(e,t){for(var r=0;r<16;++r)un(e,224,UP({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){un(e,224,UP(n,0,t))})}function s0e(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];un(e,440,Ese(n)),n[1].Tooltip&&un(e,2048,Pse(n))}delete t["!links"]}function o0e(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&un(e,125,Fse(RS(i,n),i))})}}function l0e(e,t,r,n,i){var s=16+jh(i.cellXfs,t,i);if(t.v==null&&!t.bf){un(e,513,j0(r,n,s));return}if(t.bf)un(e,6,Lue(t,r,n,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Os(ma(t.v)):t.v;un(e,515,hse(r,n,o,s));break;case"b":case"e":un(e,517,dse(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var l=sC(i.Strings,t.v,i.revStrings);un(e,253,Qae(r,n,l,s))}else un(e,516,Zae(r,n,(t.v||"").slice(0,255),s,i));break;default:un(e,513,j0(r,n,s))}}function c0e(e,t,r){var n=Cl(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,f="",h=[],p=_i(s["!ref"]||"A1"),m=u?65536:16384;if(p.e.c>255||p.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,m-1)}un(n,2057,J3(r,16,t)),un(n,13,Ec(1)),un(n,12,Ec(100)),un(n,15,Qo(!0)),un(n,17,Qo(!1)),un(n,16,_0(.001)),un(n,95,Qo(!0)),un(n,42,Qo(!1)),un(n,43,Qo(!1)),un(n,130,Ec(1)),un(n,128,use()),un(n,131,Qo(!1)),un(n,132,Qo(!1)),u&&o0e(n,s["!cols"]),un(n,512,nse(p,t)),u&&(s["!links"]=[]);for(var g=p.s.r;g<=p.e.r;++g){f=os(g);for(var y=p.s.c;y<=p.e.c;++y){g===p.s.r&&(h[y]=Ea(y)),d=h[y]+f;var b=c?(s[g]||[])[y]:s[d];b&&(l0e(n,b,g,y,t),u&&b.l&&s["!links"].push([d,b.l]))}}var v=l.CodeName||l.name||i;return u&&un(n,574,Vae((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&un(n,229,_se(s["!merges"])),u&&s0e(n,s),un(n,442,H$(v)),u&&i0e(n,s),un(n,10),n.end()}function u0e(e,t,r){var n=Cl(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},l=r.biff==8,c=r.biff==5;if(un(n,2057,J3(e,5,r)),r.bookType=="xla"&&un(n,135),un(n,225,l?Ec(1200):null),un(n,193,dae(2)),c&&un(n,191),c&&un(n,192),un(n,226),un(n,92,Mae("SheetJS",r)),un(n,66,Ec(l?1200:1252)),l&&un(n,353,Ec(0)),l&&un(n,448),un(n,317,$se(e.SheetNames.length)),l&&e.vbaraw&&un(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";un(n,442,H$(u))}un(n,156,Ec(17)),un(n,25,Qo(!1)),un(n,18,Qo(!1)),un(n,19,Ec(0)),l&&un(n,431,Qo(!1)),l&&un(n,444,Ec(0)),un(n,61,qae()),un(n,64,Qo(!1)),un(n,141,Ec(0)),un(n,34,Qo(zfe(e)=="true")),un(n,14,Qo(!0)),l&&un(n,439,Qo(!1)),un(n,218,Ec(0)),r0e(n,e,r),n0e(n,e.SSF,r),a0e(n,r),l&&un(n,352,Qo(!1));var d=n.end(),f=Cl();l&&un(f,140,Mse()),l&&r.Strings&&Xhe(f,252,Iae(r.Strings)),un(f,10);var h=f.end(),p=Cl(),m=0,g=0;for(g=0;g<e.SheetNames.length;++g)m+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var y=d.length+m+h.length;for(g=0;g<e.SheetNames.length;++g){var b=s[g]||{};un(p,133,Bae({pos:y,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var v=p.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var w=[];return d.length&&w.push(d),v.length&&w.push(v),h.length&&w.push(h),Hs(w)}function d0e(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ga(Vn)),e&&e.SSF&&(og(),CS(e.SSF),r.revssf=TS(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,dC(r),r.cellXfs=[],jh(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=c0e(i,r,e);return n.unshift(u0e(e,n,r)),Hs(n)}function IU(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=El(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return d0e(e,t);case 4:case 3:case 2:return t0e(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function rO(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,l=s&&s.index||e.length,c=Yne(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var g=c[o].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var b=g.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var v=b[l].trim();if(v.match(/<t[dh]/i)){for(var w=v,S=0;w.charAt(0)=="<"&&(S=w.indexOf(">"))>-1;)w=w.slice(S+1);for(var k=0;k<m.length;++k){var j=m[k];j.s.c==d&&j.s.r<u&&u<=j.e.r&&(d=j.e.c+1,k=-1)}var A=Xn(v.slice(0,v.indexOf(">")));h=A.colspan?+A.colspan:1,((f=+A.rowspan)>1||h>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var L=A.t||A["data-t"]||"";if(!w.length){d+=h;continue}if(w=l$(w),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!w.length){d+=h;continue}var P={t:"s",v:w};r.raw||!w.trim().length||L=="s"||(w==="TRUE"?P={t:"b",v:!0}:w==="FALSE"?P={t:"b",v:!1}:isNaN(fu(w))?isNaN(Fm(w).getDate())||(P={t:"d",v:ma(w)},r.cellDates||(P={t:"n",v:Os(P.v)}),P.z=r.dateNF||Vn[14]):P={t:"n",v:fu(w)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=P):n[Yn({r:u,c:d})]=P,d+=h}}}}return n["!ref"]=si(p),m.length&&(n["!merges"]=m),n}function f0e(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){l=-1;break}l=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(l<0)){var d=Yn({r,c:o}),f=n.dense?(e[r]||[])[o]:e[d],h=f&&f.v!=null&&(f.h||D3(f.w||(Yd(f),f.w)||""))||"",p={};l>1&&(p.rowspan=l),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+d,s.push(ln("td",h,p))}}var m="<tr>";return m+s.join("")+"</tr>"}var h0e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',p0e="</body></html>";function m0e(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return kh(rO(r[0],t),t);var n=pC();return r.forEach(function(i,s){mC(n,rO(i,t),"Sheet"+(s+1))}),n}function g0e(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function DU(e,t){var r=t||{},n=r.header!=null?r.header:h0e,i=r.footer!=null?r.footer:p0e,s=[n],o=El(e["!ref"]);r.dense=Array.isArray(e),s.push(g0e(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(f0e(e,o,l,r));return s.push("</table>"+i),s.join("")}function $U(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Ta(n.origin):n.origin;i=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=El(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),i==-1&&(u.e.r=i=d.e.r+1)}var f=[],h=0,p=e["!rows"]||(e["!rows"]=[]),m=0,g=0,y=0,b=0,v=0,w=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&g<c;++m){var S=l[m];if(nO(S)){if(n.display)continue;p[g]={hidden:!0}}var k=S.children;for(y=b=0;y<k.length;++y){var j=k[y];if(!(n.display&&nO(j))){var A=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):l$(j.innerHTML),L=j.getAttribute("data-z")||j.getAttribute("z");for(h=0;h<f.length;++h){var P=f[h];P.s.c==b+s&&P.s.r<g+i&&g+i<=P.e.r&&(b=P.e.c+1-s,h=-1)}w=+j.getAttribute("colspan")||1,((v=+j.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:g+i,c:b+s},e:{r:g+i+(v||1)-1,c:b+s+(w||1)-1}});var B={t:"s",v:A},E=j.getAttribute("data-t")||j.getAttribute("t")||"";A!=null&&(A.length==0?B.t=E||"z":n.raw||A.trim().length==0||E=="s"||(A==="TRUE"?B={t:"b",v:!0}:A==="FALSE"?B={t:"b",v:!1}:isNaN(fu(A))?isNaN(Fm(A).getDate())||(B={t:"d",v:ma(A)},n.cellDates||(B={t:"n",v:Os(B.v)}),B.z=n.dateNF||Vn[14]):B={t:"n",v:fu(A)})),B.z===void 0&&L!=null&&(B.z=L);var T="",F=j.getElementsByTagName("A");if(F&&F.length)for(var W=0;W<F.length&&!(F[W].hasAttribute("href")&&(T=F[W].getAttribute("href"),T.charAt(0)!="#"));++W);T&&T.charAt(0)!="#"&&(B.l={Target:T}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][b+s]=B):e[Yn({c:b+s,r:g+i})]=B,u.e.c<b+s&&(u.e.c=b+s),b+=w}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=si(u),g>=c&&(e["!fullref"]=si((u.e.r=l.length-m+g-1+i,u))),e}function UU(e,t){var r=t||{},n=r.dense?[]:{};return $U(n,e,t)}function x0e(e,t){return kh(UU(e,t),t)}function nO(e){var t="",r=y0e(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function y0e(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function b0e(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Si(t.replace(/<[^>]*>/g,""));return[r]}var iO={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function zU(e,t){var r=t||{},n=$3(e),i=[],s,o,l={name:""},c="",u=0,d,f,h={},p=[],m=r.dense?[]:{},g,y,b={value:""},v="",w=0,S=[],k=-1,j=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},L=0,P={},B=[],E={},T=0,F=0,W=[],z=1,se=1,de=[],U={Names:[]},G={},re=["",""],X=[],C={},K="",V=0,R=!1,J=!1,q=0;for(p1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=p1.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?m["!ref"]=si(A):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(m["!fullref"]=m["!ref"],A.e.r=r.sheetRows-1,m["!ref"]=si(A)),B.length&&(m["!merges"]=B),W.length&&(m["!rows"]=W),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),h[d.name]=m,J=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=Xn(g[0],!1),k=j=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,m=r.dense?[]:{},B=[],W=[],J=!0);break;case"table-row-group":g[1]==="/"?--L:++L;break;case"table-row":case"":if(g[1]==="/"){k+=z,z=1;break}if(f=Xn(g[0],!1),f.?k=f.-1:k==-1&&(k=0),z=+f["number-rows-repeated"]||1,z<10)for(q=0;q<z;++q)L>0&&(W[k+q]={level:L});j=-1;break;case"covered-table-cell":g[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(m[k]||(m[k]=[]),m[k][j]={t:"z"}):m[Yn({r:k,c:j})]={t:"z"}),v="",S=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++j,b=Xn(g[0],!1),se=parseInt(b["number-columns-repeated"]||"1",10),y={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(y.f=ZP(Si(b.formula))),(b.||b["value-type"])=="string"&&(y.t="s",y.v=Si(b["string-value"]||""),r.dense?(m[k]||(m[k]=[]),m[k][j]=y):m[Yn({r:k,c:j})]=y),j+=se-1;else if(g[1]!=="/"){++j,v="",w=0,S=[],se=1;var Y=z?k+z-1:k;if(j>A.e.c&&(A.e.c=j),j<A.s.c&&(A.s.c=j),k<A.s.r&&(A.s.r=k),Y>A.e.r&&(A.e.r=Y),b=Xn(g[0],!1),X=[],C={},y={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=Si(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(T=parseInt(b["number-matrix-rows-spanned"],10)||0,F=parseInt(b["number-matrix-columns-spanned"],10)||0,E={s:{r:k,c:j},e:{r:k+T-1,c:j+F-1}},y.F=si(E),de.push([E,y.F])),b.formula)y.f=ZP(b.formula);else for(q=0;q<de.length;++q)k>=de[q][0].s.r&&k<=de[q][0].e.r&&j>=de[q][0].s.c&&j<=de[q][0].e.c&&(y.F=de[q][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(T=parseInt(b["number-rows-spanned"],10)||0,F=parseInt(b["number-columns-spanned"],10)||0,E={s:{r:k,c:j},e:{r:k+T-1,c:j+F-1}},B.push(E)),b["number-columns-repeated"]&&(se=parseInt(b["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=fa(b["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(b.value);break;case"percentage":y.t="n",y.v=parseFloat(b.value);break;case"currency":y.t="n",y.v=parseFloat(b.value);break;case"date":y.t="d",y.v=ma(b["date-value"]),r.cellDates||(y.t="n",y.v=Os(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=Vne(b["time-value"])/86400,r.cellDates&&(y.t="d",y.v=PS(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(b.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",b["string-value"]!=null&&(v=Si(b["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(R=!1,y.t==="s"&&(y.v=v||"",S.length&&(y.R=S),R=w==0),G.Target&&(y.l=G),X.length>0&&(y.c=X,X=[]),v&&r.cellText!==!1&&(y.w=v),R&&(y.t="z",delete y.v),(!R||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=k))for(var Q=0;Q<z;++Q){if(se=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(m[k+Q]||(m[k+Q]=[]),m[k+Q][j]=Q==0?y:ga(y);--se>0;)m[k+Q][j+se]=ga(y);else for(m[Yn({r:k+Q,c:j})]=y;--se>0;)m[Yn({r:k+Q,c:j+se})]=ga(y);A.e.c<=j&&(A.e.c=j)}se=parseInt(b["number-columns-repeated"]||"1",10),j+=se-1,se=0,y={},v="",S=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s;C.t=v,S.length&&(C.R=S),C.a=K,X.push(C)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);K="",V=0,v="",w=0,S=[];break;case"creator":g[1]==="/"?K=n.slice(V,g.index):V=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);v="",w=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(P[l.name]=c,(s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(c="",l=Xn(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Xn(g[0],!1),c+=iO[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Xn(g[0],!1),c+=iO[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":o=Xn(g[0],!1),re=sk(o["cell-range-address"]);var ie={Name:o.name,Ref:re[0]+"!"+re[1]};J&&(ie.Sheet=p.length),U.Names.push(ie);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var le=b0e(n.slice(w,g.index));v=(v.length>0?v+`
`:"")+le[0]}else Xn(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{re=sk(Xn(g[0])["target-range-address"]),h[re[0]]["!autofilter"]={ref:re[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(G=Xn(g[0],!1),!G.href)break;G.Target=Si(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(re=sk(G.Target.slice(1)),G.Target="#"+re[0]+"!"+re[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var O={Sheets:h,SheetNames:p,Workbook:U};return r.bookSheets&&delete O.Sheets,O}function aO(e,t){t=t||{},Cc(e,"META-INF/manifest.xml")&&Vie(fs(e,"META-INF/manifest.xml"),t);var r=Kl(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=zU(Ki(r),t);return Cc(e,"meta.xml")&&(n.Props=O$(fs(e,"meta.xml"))),n}function sO(e,t){return zU(e,t)}var v0e=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+h1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ls+t}}(),oO=function(){var e=function(s){return Wi(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+Wi(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=El(s["!ref"]||"A1"),h=s["!merges"]||[],p=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",y=s["!rows"]||[];for(u=0;u<f.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=f.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var b=!1,v={},w="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>d)&&!(h[p].s.r>u)&&!(h[p].e.c<d)&&!(h[p].e.r<u)){(h[p].s.c!=d||h[p].s.r!=u)&&(b=!0),v["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,v["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(b){c.push(r);continue}var S=Yn({r:u,c:d}),k=m?(s[u]||[])[d]:s[S];if(k&&k.f&&(v["table:formula"]=Wi($ue(k.f)),k.F&&k.F.slice(0,S.length)==S)){var j=El(k.F);v["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,v["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!k){c.push(t);continue}switch(k.t){case"b":w=k.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=k.v?"true":"false";break;case"n":w=k.w||String(k.v||0),v["office:value-type"]="float",v["office:value"]=k.v||0;break;case"s":case"str":w=k.v==null?"":k.v,v["office:value-type"]="string";break;case"d":w=k.w||ma(k.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=ma(k.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var A=e(w);if(k.l&&k.l.Target){var L=k.l.Target;L=L.charAt(0)=="#"?"#"+Uue(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),A=ln("text:a",A,{"xlink:href":L.replace(/&/g,"&amp;")})}c.push("          "+ln("table:table-cell",ln("text:p",A,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;fh(f),f.ods=l;var h=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ls],u=h1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=h1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(P$().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function WU(e,t){if(t.bookType=="fods")return oO(e,t);var r=B3(),n="",i=[],s=[];return n="mimetype",ui(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",ui(r,n,oO(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",ui(r,n,v0e(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",ui(r,n,ls+P$()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",ui(r,n,Yie(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",ui(r,n,Gie(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function A0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Y4(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ki(_h(e))}function w0e(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Gl(Yu(e))}function S0e(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ph(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function lO(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function _0e(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function k0e(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function w1(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Di(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Va(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ji(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=w1(e,r),s=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=w1(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:l,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function ao(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Di(n*8+i.type)),i.type==2&&t.push(Di(i.data.length)),t.push(i.data))})}),ph(t)}function cC(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function _c(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=w1(e,n),s=ji(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Va(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=ji(l.data),u=Va(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=Va(s[3][0].data)>>>0>0),r.push(o)}return r}function pp(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Di(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Di(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Di(o.data.length)}],n[2].push({data:ao(o.meta),type:2})});var s=ao(n);t.push(Di(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),ph(t)}function j0e(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=w1(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[ph(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var d=ph(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function kc(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(j0e(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ph(t)}function mp(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Di(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return ph(t)}function A0e(e,t,r,n){var i=A0(e),s=i.getUint32(4,!0),o=(n>1?12:8)+lO(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=i.getUint32(o,!0),o+=4),o+=lO(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(o,!0),o+=4),s&32&&(u=i.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function N0e(e,t,r){var n=A0(e),i=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);i&1&&(c=_0e(e,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(l=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function lk(e,t){var r=new Uint8Array(32),n=A0(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,k0e(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function ck(e,t){var r=new Uint8Array(32),n=A0(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function C0e(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return A0e(e,t,r,e[0]);case 5:return N0e(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Eo(e){var t=ji(e);return w1(t[1][0].data)}function cO(e,t){var r=ji(t.data),n=Va(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var l=ji(o.data),c=Va(l[1][0].data)>>>0;switch(n){case 1:s[c]=Y4(l[3][0].data);break;case 8:{var u=e[Eo(l[9][0].data)][0],d=ji(u.data),f=e[Eo(d[1][0].data)][0],h=Va(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=ji(f.data);s[c]=p[3].map(function(m){return Y4(m.data)}).join("")}break}}),s}function E0e(e,t){var r,n,i,s,o,l,c,u,d,f,h,p,m,g,y=ji(e),b=Va(y[1][0].data)>>>0,v=Va(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Va(y[8][0].data)>0||!1,S,k;if((s=(i=y[7])==null?void 0:i[0])!=null&&s.data&&t!=0)S=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,k=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=y[4])==null?void 0:d[0])!=null&&f.data&&t!=1)S=(p=(h=y[4])==null?void 0:h[0])==null?void 0:p.data,k=(g=(m=y[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var j=w?4:1,A=A0(S),L=[],P=0;P<S.length/2;++P){var B=A.getUint16(P*2,!0);B<65535&&L.push([P,B])}if(L.length!=v)throw"Expected ".concat(v," cells, found ").concat(L.length);var E=[];for(P=0;P<L.length-1;++P)E[L[P][0]]=k.subarray(L[P][1]*j,L[P+1][1]*j);return L.length>=1&&(E[L[L.length-1][0]]=k.subarray(L[L.length-1][1]*j)),{R:b,cells:E}}function T0e(e,t){var r,n=ji(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Va(n[7][0].data)>>>0>0?1:0:-1,s=cC(n[5],function(o){return E0e(o,i)});return{nrows:Va(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function P0e(e,t,r){var n,i=ji(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Va(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Va(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=si(s);var o=ji(i[4][0].data),l=cO(e,e[Eo(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?cO(e,e[Eo(o[17][0].data)][0]):[],u=ji(o[3][0].data),d=0;u[1].forEach(function(f){var h=ji(f.data),p=e[Eo(h[2][0].data)][0],m=Va(p.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=T0e(e,p);g.data.forEach(function(y,b){y.forEach(function(v,w){var S=Yn({r:d+b,c:w}),k=C0e(v,l,c);k&&(r[S]=k)})}),d+=g.nrows})}function O0e(e,t){var r=ji(t.data),n={"!ref":"A1"},i=e[Eo(r[2][0].data)],s=Va(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return P0e(e,i[0],n),n}function M0e(e,t){var r,n=ji(t.data),i={name:(r=n[1])!=null&&r[0]?Y4(n[1][0].data):"",sheets:[]},s=cC(n[2],Eo);return s.forEach(function(o){e[o].forEach(function(l){var c=Va(l.meta[1][0].data);c==6e3&&i.sheets.push(O0e(e,l))})}),i}function L0e(e,t){var r=pC(),n=ji(t.data),i=cC(n[1],Eo);if(i.forEach(function(s){e[s].forEach(function(o){var l=Va(o.meta[1][0].data);if(l==2){var c=M0e(e,o);c.sheets.forEach(function(u,d){mC(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function uk(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=kc(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=_c(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Va(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=Va(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return L0e(s,l)}function R0e(e,t,r){var n,i,s,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Va(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=A0(e[7][0].data),d=0,f=[],h=A0(e[4][0].data),p=0,m=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),h.setUint16(g*2,p,!0);var y,b;switch(typeof t[g]){case"string":y=lk({t:"s",v:t[g]},r),b=ck({t:"s",v:t[g]},r);break;case"number":y=lk({t:"n",v:t[g]},r),b=ck({t:"n",v:t[g]},r);break;case"boolean":y=lk({t:"b",v:t[g]},r),b=ck({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(y),d+=y.length,m.push(b),p+=b.length,++c}for(e[2][0].data=Di(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),h.setUint16(g*2,65535,!0);return e[6][0].data=ph(f),e[3][0].data=ph(m),c}function B0e(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=El(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(si(n)));var s=K2(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(K){return K.forEach(function(V){typeof V=="string"&&o.push(V)})});var l={},c=[],u=zn.read(t.numbers,{type:"base64"});u.FileIndex.map(function(K,V){return[K,u.FullPaths[V]]}).forEach(function(K){var V=K[0],R=K[1];if(V.type==2&&V.name.match(/\.iwa/)){var J=V.content,q=kc(J),Y=_c(q);Y.forEach(function(Q){c.push(Q.id),l[Q.id]={deps:[],location:R,type:Va(Q.messages[0].meta[1][0].data)}})}}),c.sort(function(K,V){return K-V});var d=c.filter(function(K){return K>1}).map(function(K){return[K,Di(K)]});u.FileIndex.map(function(K,V){return[K,u.FullPaths[V]]}).forEach(function(K){var V=K[0];if(K[1],!!V.name.match(/\.iwa/)){var R=_c(kc(V.content));R.forEach(function(J){J.messages.forEach(function(q){d.forEach(function(Y){J.messages.some(function(Q){return Va(Q.meta[1][0].data)!=11006&&S0e(Q.data,Y[1])})&&l[Y[0]].deps.push(J.id)})})})}});for(var f=zn.find(u,l[1].location),h=_c(kc(f.content)),p,m=0;m<h.length;++m){var g=h[m];g.id==1&&(p=g)}var y=Eo(ji(p.messages[0].data)[1][0].data);for(f=zn.find(u,l[y].location),h=_c(kc(f.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);for(y=Eo(ji(p.messages[0].data)[2][0].data),f=zn.find(u,l[y].location),h=_c(kc(f.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);for(y=Eo(ji(p.messages[0].data)[2][0].data),f=zn.find(u,l[y].location),h=_c(kc(f.content)),m=0;m<h.length;++m)g=h[m],g.id==y&&(p=g);var b=ji(p.messages[0].data);{b[6][0].data=Di(n.e.r+1),b[7][0].data=Di(n.e.c+1);var v=Eo(b[46][0].data),w=zn.find(u,l[v].location),S=_c(kc(w.content));{for(var k=0;k<S.length&&S[k].id!=v;++k);if(S[k].id!=v)throw"Bad ColumnRowUIDMapArchive";var j=ji(S[k].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var A=0;A<=n.e.c;++A){var L=[];L[1]=L[2]=[{type:0,data:Di(A+420690)}],j[1].push({type:2,data:ao(L)}),j[2].push({type:0,data:Di(A)}),j[3].push({type:0,data:Di(A)})}j[4]=[],j[5]=[],j[6]=[];for(var P=0;P<=n.e.r;++P)L=[],L[1]=L[2]=[{type:0,data:Di(P+726270)}],j[4].push({type:2,data:ao(L)}),j[5].push({type:0,data:Di(P)}),j[6].push({type:0,data:Di(P)});S[k].messages[0].data=ao(j)}w.content=mp(pp(S)),w.size=w.content.length,delete b[46];var B=ji(b[4][0].data);{B[7][0].data=Di(n.e.r+1);var E=ji(B[1][0].data),T=Eo(E[2][0].data);w=zn.find(u,l[T].location),S=_c(kc(w.content));{if(S[0].id!=T)throw"Bad HeaderStorageBucket";var F=ji(S[0].messages[0].data);for(P=0;P<s.length;++P){var W=ji(F[2][0].data);W[1][0].data=Di(P),W[4][0].data=Di(s[P].length),F[2][P]={type:F[2][0].type,data:ao(W)}}S[0].messages[0].data=ao(F)}w.content=mp(pp(S)),w.size=w.content.length;var z=Eo(B[2][0].data);w=zn.find(u,l[z].location),S=_c(kc(w.content));{if(S[0].id!=z)throw"Bad HeaderStorageBucket";for(F=ji(S[0].messages[0].data),A=0;A<=n.e.c;++A)W=ji(F[2][0].data),W[1][0].data=Di(A),W[4][0].data=Di(n.e.r+1),F[2][A]={type:F[2][0].type,data:ao(W)};S[0].messages[0].data=ao(F)}w.content=mp(pp(S)),w.size=w.content.length;var se=Eo(B[4][0].data);(function(){for(var K=zn.find(u,l[se].location),V=_c(kc(K.content)),R,J=0;J<V.length;++J){var q=V[J];q.id==se&&(R=q)}var Y=ji(R.messages[0].data);{Y[3]=[];var Q=[];o.forEach(function(O,H){Q[1]=[{type:0,data:Di(H)}],Q[2]=[{type:0,data:Di(1)}],Q[3]=[{type:2,data:w0e(O)}],Y[3].push({type:2,data:ao(Q)})})}R.messages[0].data=ao(Y);var ie=pp(V),le=mp(ie);K.content=le,K.size=K.content.length})();var de=ji(B[3][0].data);{var U=de[1][0];delete de[2];var G=ji(U.data);{var re=Eo(G[2][0].data);(function(){for(var K=zn.find(u,l[re].location),V=_c(kc(K.content)),R,J=0;J<V.length;++J){var q=V[J];q.id==re&&(R=q)}var Y=ji(R.messages[0].data);{delete Y[6],delete de[7];var Q=new Uint8Array(Y[5][0].data);Y[5]=[];for(var ie=0,le=0;le<=n.e.r;++le){var O=ji(Q);ie+=R0e(O,s[le],o),O[1][0].data=Di(le),Y[5].push({data:ao(O),type:2})}Y[1]=[{type:0,data:Di(n.e.c+1)}],Y[2]=[{type:0,data:Di(n.e.r+1)}],Y[3]=[{type:0,data:Di(ie)}],Y[4]=[{type:0,data:Di(n.e.r+1)}]}R.messages[0].data=ao(Y);var H=pp(V),ae=mp(H);K.content=ae,K.size=K.content.length})()}U.data=ao(G)}B[3][0].data=ao(de)}b[4][0].data=ao(B)}p.messages[0].data=ao(b);var X=pp(h),C=mp(X);return f.content=C,f.size=f.content.length,u}function qU(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function uC(e){qU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function dC(e){qU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function F0e(e){return hi.WS.indexOf(e)>-1?"sheet":e==hi.CS?"chart":e==hi.DS?"dialog":e==hi.MS?"macro":e&&e.length?e:"sheet"}function I0e(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,F0e(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function D0e(e,t,r,n,i,s,o,l,c,u,d,f){try{s[n]=Px(Kl(e,r,!0),t);var h=fs(e,t),p;switch(l){case"sheet":p=ohe(h,t,i,c,s[n],u,d,f);break;case"chart":if(p=lhe(h,t,i,c,s[n],u,d,f),!p||!p["!drawel"])break;var m=px(p["!drawel"].Target,t),g=m1(m),y=Kle(Kl(e,m,!0),Px(Kl(e,g,!0),m)),b=px(y,m),v=m1(b);p=Rfe(Kl(e,b,!0),b,c,Px(Kl(e,v,!0),b),u,p);break;case"macro":p=che(h,t,i,c,s[n],u,d,f);break;case"dialog":p=uhe(h,t,i,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=p;var w=[];s&&s[n]&&Ga(s[n]).forEach(function(S){var k="";if(s[n][S].Type==hi.CMNT){k=px(s[n][S].Target,t);var j=phe(fs(e,k,!0),k,c);if(!j||!j.length)return;KP(p,j,!1)}s[n][S].Type==hi.TCMNT&&(k=px(s[n][S].Target,t),w=w.concat(Xle(fs(e,k,!0),c)))}),w&&w.length&&KP(p,w,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function xc(e){return e.charAt(0)=="/"?e.slice(1):e}function $0e(e,t){if(og(),t=t||{},uC(t),Cc(e,"META-INF/manifest.xml")||Cc(e,"objectdata.xml"))return aO(e,t);if(Cc(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof uk<"u"){if(e.FileIndex)return uk(e);var r=zn.utils.cfb_new();return mP(e).forEach(function(W){ui(r,W,Qne(e,W))}),uk(r)}throw new Error("Unsupported NUMBERS file")}if(!Cc(e,"[Content_Types].xml"))throw Cc(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Cc(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=mP(e),i=qie(Kl(e,"[Content_Types].xml")),s=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",fs(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!fs(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Ox=[],i.sst)try{Ox=hhe(fs(e,xc(i.sst)),i.sst,t)}catch(W){if(t.WTF)throw W}t.cellStyles&&i.themes.length&&(c=fhe(Kl(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=dhe(fs(e,xc(i.style)),i.style,c,t))}i.links.map(function(W){try{var z=Px(Kl(e,m1(xc(W))),W);return ghe(fs(e,xc(W)),z,W,t)}catch{}});var d=she(fs(e,xc(i.workbooks[0])),i.workbooks[0],t),f={},h="";i.coreprops.length&&(h=fs(e,xc(i.coreprops[0]),!0),h&&(f=O$(h)),i.extprops.length!==0&&(h=fs(e,xc(i.extprops[0]),!0),h&&Qie(h,f,t)));var p={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(h=Kl(e,xc(i.custprops[0]),!0),h&&(p=Zie(h,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(z){return z.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=p),t.bookSheets&&typeof o<"u"&&(m.SheetNames=o),t.bookSheets?m.SheetNames:t.bookProps))return m;o={};var g={};t.bookDeps&&i.calcchain&&(g=mhe(fs(e,xc(i.calcchain)),i.calcchain));var y=0,b={},v,w;{var S=d.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var k=0;k!=S.length;++k)f.SheetNames[k]=S[k].name}var j=s?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),L=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Cc(e,L)||(L="xl/_rels/workbook."+j+".rels");var P=Px(Kl(e,L,!0),L.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=xhe(fs(e,xc(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=Jle(fs(e,xc(i.people[0])),t)),P&&(P=I0e(P,d.Sheets));var B=fs(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var E="sheet";if(P&&P[y]?(v="xl/"+P[y][1].replace(/[\/]?xl\//,""),Cc(e,v)||(v=P[y][1]),Cc(e,v)||(v=L.replace(/_rels\/.*$/,"")+P[y][1]),E=P[y][2]):(v="xl/worksheets/sheet"+(y+1-B)+"."+j,v=v.replace(/sheet0\./,"sheet.")),w=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,F=0;F!=t.sheets.length;++F)typeof t.sheets[F]=="number"&&t.sheets[F]==y&&(T=1),typeof t.sheets[F]=="string"&&t.sheets[F].toLowerCase()==f.SheetNames[y].toLowerCase()&&(T=1);if(!T)continue e}}D0e(e,v,w,f.SheetNames[y],y,b,o,E,t,d,c,u)}return m={Directory:i,Workbook:d,Props:f,Custprops:p,Deps:g,Sheets:o,SheetNames:f.SheetNames,Strings:Ox,Styles:u,Themes:c,SSF:ga(Vn)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(W,z){W=W.replace(/^Root Entry[\/]/,""),m.keys.push(W),m.files[W]=e.FileIndex[z]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=fs(e,xc(i.vba[0]),!0):i.defaults&&i.defaults.bin===sce&&(m.vbaraw=fs(e,"xl/vbaProject.bin",!0))),m}function U0e(e,t){var r=t||{},n="Workbook",i=zn.find(e,n);try{if(n="/!DataSpaces/Version",i=zn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(xoe(i.content),n="/!DataSpaces/DataSpaceMap",i=zn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=boe(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=zn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=voe(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=zn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Soe(i.content)}catch{}if(n="/EncryptionInfo",i=zn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=_oe(i.content);if(n="/EncryptedPackage",i=zn.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function z0e(e,t){return t.bookType=="ods"?WU(e,t):t.bookType=="numbers"?B0e(e,t):t.bookType=="xlsb"?W0e(e,t):q0e(e,t)}function W0e(e,t){em=1024,e&&!e.SSF&&(e.SSF=ga(Vn)),e&&e.SSF&&(og(),CS(e.SSF),t.revssf=TS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Mx?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=xU.indexOf(t.bookType)>-1,i=X3();dC(t=t||{});var s=B3(),o="",l=0;if(t.cellXfs=[],jh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ui(s,o,M$(e.Props,t)),i.coreprops.push(o),$i(t.rels,2,o,hi.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,ui(s,o,B$(e.Props)),i.extprops.push(o),$i(t.rels,3,o,hi.EXT_PROPS),e.Custprops!==e.Props&&Ga(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ui(s,o,F$(e.Custprops)),i.custprops.push(o),$i(t.rels,4,o,hi.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,ui(s,o,bhe(l-1,o,t,e,d)),i.sheets.push(o),$i(t.wbrels,-1,"worksheets/sheet"+l+"."+r,hi.WS[0])}if(f){var p=f["!comments"],m=!1,g="";p&&p.length>0&&(g="xl/comments"+l+"."+r,ui(s,g,She(p,g)),i.comments.push(g),$i(d,-1,"../comments"+l+"."+r,hi.CMNT),m=!0),f["!legacy"]&&m&&ui(s,"xl/drawings/vmlDrawing"+l+".vml",mU(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&ui(s,m1(o),mm(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,ui(s,o,whe(t.Strings,o,t)),i.strs.push(o),$i(t.wbrels,-1,"sharedStrings."+r,hi.SST)),o="xl/workbook."+r,ui(s,o,yhe(e,o)),i.workbooks.push(o),$i(t.rels,1,o,hi.WB),o="xl/theme/theme1.xml",ui(s,o,rC(e.Themes,t)),i.themes.push(o),$i(t.wbrels,-1,"theme/theme1.xml",hi.THEME),o="xl/styles."+r,ui(s,o,vhe(e,o,t)),i.styles.push(o),$i(t.wbrels,-1,"styles."+r,hi.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",ui(s,o,e.vbaraw),i.vba.push(o),$i(t.wbrels,-1,"vbaProject.bin",hi.VBA)),o="xl/metadata."+r,ui(s,o,_he(o)),i.metadata.push(o),$i(t.wbrels,-1,"metadata."+r,hi.XLMETA),ui(s,"[Content_Types].xml",T$(i,t)),ui(s,"_rels/.rels",mm(t.rels)),ui(s,"xl/_rels/workbook."+r+".rels",mm(t.wbrels)),delete t.revssf,delete t.ssf,s}function q0e(e,t){em=1024,e&&!e.SSF&&(e.SSF=ga(Vn)),e&&e.SSF&&(og(),CS(e.SSF),t.revssf=TS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Mx?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=xU.indexOf(t.bookType)>-1,i=X3();dC(t=t||{});var s=B3(),o="",l=0;if(t.cellXfs=[],jh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",ui(s,o,M$(e.Props,t)),i.coreprops.push(o),$i(t.rels,2,o,hi.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,ui(s,o,B$(e.Props)),i.extprops.push(o),$i(t.rels,3,o,hi.EXT_PROPS),e.Custprops!==e.Props&&Ga(e.Custprops||{}).length>0&&(o="docProps/custom.xml",ui(s,o,F$(e.Custprops)),i.custprops.push(o),$i(t.rels,4,o,hi.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},h=e.Sheets[e.SheetNames[l-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,ui(s,o,CU(l-1,t,e,f)),i.sheets.push(o),$i(t.wbrels,-1,"worksheets/sheet"+l+"."+r,hi.WS[0])}if(h){var m=h["!comments"],g=!1,y="";if(m&&m.length>0){var b=!1;m.forEach(function(v){v[1].forEach(function(w){w.T==!0&&(b=!0)})}),b&&(y="xl/threadedComments/threadedComment"+l+"."+r,ui(s,y,Qle(m,d,t)),i.threadedcomments.push(y),$i(f,-1,"../threadedComments/threadedComment"+l+"."+r,hi.TCMNT)),y="xl/comments"+l+"."+r,ui(s,y,gU(m)),i.comments.push(y),$i(f,-1,"../comments"+l+"."+r,hi.CMNT),g=!0}h["!legacy"]&&g&&ui(s,"xl/drawings/vmlDrawing"+l+".vml",mU(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&ui(s,m1(o),mm(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,ui(s,o,nU(t.Strings,t)),i.strs.push(o),$i(t.wbrels,-1,"sharedStrings."+r,hi.SST)),o="xl/workbook."+r,ui(s,o,MU(e)),i.workbooks.push(o),$i(t.rels,1,o,hi.WB),o="xl/theme/theme1.xml",ui(s,o,rC(e.Themes,t)),i.themes.push(o),$i(t.wbrels,-1,"theme/theme1.xml",hi.THEME),o="xl/styles."+r,ui(s,o,dU(e,t)),i.styles.push(o),$i(t.wbrels,-1,"styles."+r,hi.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",ui(s,o,e.vbaraw),i.vba.push(o),$i(t.wbrels,-1,"vbaProject.bin",hi.VBA)),o="xl/metadata."+r,ui(s,o,pU()),i.metadata.push(o),$i(t.wbrels,-1,"metadata."+r,hi.XLMETA),d.length>1&&(o="xl/persons/person.xml",ui(s,o,Zle(d)),i.people.push(o),$i(t.wbrels,-1,"persons/person.xml",hi.PEOPLE)),ui(s,"[Content_Types].xml",T$(i,t)),ui(s,"_rels/.rels",mm(t.rels)),ui(s,"xl/_rels/workbook."+r+".rels",mm(t.wbrels)),delete t.revssf,delete t.ssf,s}function fC(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ic(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function H0e(e,t){return zn.find(e,"EncryptedPackage")?U0e(e,t):FU(e,t)}function V0e(e,t){var r,n=e,i=t||{};return i.type||(i.type=fi&&Buffer.isBuffer(e)?"buffer":"base64"),r=a$(n,i),$0e(r,i)}function HU(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return G4(e.slice(r),t);default:break e}return Im.to_workbook(e,t)}function G0e(e,t){var r="",n=fC(e,t);switch(t.type){case"base64":r=ic(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=S0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ki(r)),t.type="binary",HU(r,t)}function K0e(e,t){var r=e;return t.type=="base64"&&(r=ic(r)),r=c1.utils.decode(1200,r.slice(2),"str"),t.type="binary",HU(r,t)}function Y0e(e){return e.match(/[^\x00-\x7F]/)?Yu(e):e}function dk(e,t,r,n){return n?(r.type="string",Im.to_workbook(e,r)):Im.to_workbook(t,r)}function N0(e,t){P3();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return N0(new Uint8Array(e),(r=ga(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),xm={},r.dateNF&&(xm.dateNF=r.dateNF),r.type||(r.type=fi&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=fi?"buffer":"binary",n=Wne(e),typeof Uint8Array<"u"&&!fi&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Y0e(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ga(r),r.type="array",N0(O3(n),r)}switch((i=fC(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return H0e(zn.read(n,r),r);break;case 9:if(i[1]<=8)return FU(n,r);break;case 60:return G4(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return eoe(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return tU.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?V0e(n,r):dk(e,n,r,s);case 239:return i[3]===60?G4(n,r):dk(e,n,r,s);case 255:if(i[1]===254)return K0e(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return s0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return s0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return V4.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return lU.to_workbook(n,r);break;case 10:case 13:case 32:return G0e(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Zse.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?V4.to_workbook(n,r):dk(e,n,r,s)}function VU(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ny(t.file,zn.write(e,{type:fi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return zn.write(e,t)}function X0e(e,t){var r=ga(t||{}),n=z0e(e,r);return Q0e(n,r)}function Q0e(e,t){var r={},n=fi?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?zn.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(NS(i))}return t.password&&typeof encrypt_agile<"u"?VU(encrypt_agile(i,t.password),t):t.type==="file"?ny(t.file,i):t.type=="string"?Ki(i):i}function J0e(e,t){var r=t||{},n=Yhe(e,r);return VU(n,r)}function $u(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return u1(Yu(n));case"binary":return Yu(n);case"string":return e;case"file":return ny(t.file,n,"utf8");case"buffer":return fi?cf(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):$u(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Z0e(e,t){switch(t.type){case"base64":return u1(e);case"binary":return e;case"string":return e;case"file":return ny(t.file,e,"binary");case"buffer":return fi?cf(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ob(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?u1(r):t.type=="string"?Ki(r):r;case"file":return ny(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function GU(e,t){P3(),Hfe(e);var r=ga(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=GU(e,r);return r.type="array",NS(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return $u(zhe(e,r),r);case"slk":case"sylk":return $u(eU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return $u(DU(e.Sheets[e.SheetNames[i]],r),r);case"txt":return Z0e(KU(e.Sheets[e.SheetNames[i]],r),r);case"csv":return $u(hC(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return $u(tU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Ob(V4.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return $u(Im.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return $u(lU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return $u(rU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return $u(WU(e,r),r);case"wk1":return Ob(s0.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Ob(s0.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Ob(IU(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),J0e(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return X0e(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function epe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function dy(e,t,r){var n={};return n.type="file",n.file=t,epe(n),GU(e,n)}function tpe(e,t,r,n,i,s,o,l){var c=os(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,h=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!o||e[r])for(var p=t.s.c;p<=t.e.c;++p){var m=o?e[r][p]:e[n[p]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[p]!=null&&(h[s[p]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[p]!=null){if(g==null)if(m.t=="e"&&g===null)h[s[p]]=null;else if(u!==void 0)h[s[p]]=u;else if(d&&g===null)h[s[p]]=null;else continue;else h[s[p]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?g:Yd(m,g,l);g!=null&&(f=!1)}}return{row:h,isempty:f}}function K2(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=_i(d);break;case"number":c=_i(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(i=0);var f=os(c.s.r),h=[],p=[],m=0,g=0,y=Array.isArray(e),b=c.s.r,v=0,w={};y&&!e[b]&&(e[b]=[]);var S=u.skipHidden&&e["!cols"]||[],k=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(S[v]||{}).hidden)switch(h[v]=Ea(v),r=y?e[b][v]:e[h[v]+f],n){case 1:s[v]=v-c.s.c;break;case 2:s[v]=h[v];break;case 3:s[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Yd(r,null,u),g=w[o]||0,!g)w[o]=1;else{do l=o+"_"+g++;while(w[l]);w[o]=g,w[l]=1}s[v]=l}for(b=c.s.r+i;b<=c.e.r;++b)if(!(k[b]||{}).hidden){var j=tpe(e,c,b,h,n,s,y,u);(j.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[m++]=j.row)}return p.length=m,p}var uO=/"/g;function rpe(e,t,r,n,i,s,o,l){for(var c=!0,u=[],d="",f=os(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=l.dense?(e[r]||[])[h]:e[n[h]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(l.rawNumbers&&p.t=="n"?p.v:Yd(p,null,l));for(var m=0,g=0;m!==d.length;++m)if((g=d.charCodeAt(m))===i||g===s||g===34||l.forceQuotes){d='"'+d.replace(uO,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(uO,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function hC(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=_i(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(h[m]||{}).hidden||(f[m]=Ea(m));for(var g=0,y=i.s.r;y<=i.e.r;++y)(p[y]||{}).hidden||(d=rpe(e,i,y,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?l:"")+d)));return delete n.dense,r.join("")}function KU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=hC(e,t);return r}function npe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=_i(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=Ea(l);for(var d=i.s.r;d<=i.e.r;++d)for(s=os(d),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+s,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function YU(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Ta(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var f=_i(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var h=n.header||[],p=0;t.forEach(function(g,y){Ga(g).forEach(function(b){(p=h.indexOf(b))==-1&&(h[p=h.length]=b);var v=g[b],w="z",S="",k=Yn({c:l+p,r:o+y+i});u=S1(s,k),v&&typeof v=="object"&&!(v instanceof Date)?s[k]=v:(typeof v=="number"?w="n":typeof v=="boolean"?w="b":typeof v=="string"?w="s":v instanceof Date?(w="d",n.cellDates||(w="n",v=Os(v)),S=n.dateNF||Vn[14]):v===null&&n.nullError&&(w="e",v=0),u?(u.t=w,u.v=v,delete u.w,delete u.R,S&&(u.z=S)):s[k]=u={t:w,v},S&&(u.z=S))})}),d.e.c=Math.max(d.e.c,l+h.length-1);var m=os(o);if(i)for(p=0;p<h.length;++p)s[Ea(p+l)+m]={t:"s",v:h[p]};return s["!ref"]=si(d),s}function ipe(e,t){return YU(null,e,t)}function S1(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ta(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?S1(e,Yn(t)):S1(e,Yn({r:t,c:r||0}))}function ape(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function pC(){return{SheetNames:[],Sheets:{}}}function mC(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(OU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function spe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=ape(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function ope(e,t){return e.z=t,e}function XU(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function lpe(e,t,r){return XU(e,"#"+t,r)}function cpe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function upe(e,t,r,n){for(var i=typeof t!="string"?t:_i(t),s=typeof t=="string"?t:si(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var c=S1(e,o,l);c.t="n",c.F=s,delete c.v,o==i.s.r&&l==i.s.c&&(c.f=r,n&&(c.D=!0))}return e}var bs={encode_col:Ea,encode_row:os,encode_cell:Yn,encode_range:si,decode_col:q3,decode_row:W3,split_cell:wie,decode_cell:Ta,decode_range:El,format_cell:Yd,sheet_add_aoa:_$,sheet_add_json:YU,sheet_add_dom:$U,aoa_to_sheet:lg,json_to_sheet:ipe,table_to_sheet:UU,table_to_book:x0e,sheet_to_csv:hC,sheet_to_txt:KU,sheet_to_json:K2,sheet_to_html:DU,sheet_to_formulae:npe,sheet_to_row_object_array:K2,sheet_get_cell:S1,book_new:pC,book_append_sheet:mC,book_set_sheet_visibility:spe,cell_set_number_format:ope,cell_set_hyperlink:XU,cell_set_internal_link:lpe,cell_add_comment:cpe,sheet_set_array_formula:upe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function zi(e){"@babel/helpers - typeof";return zi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zi(e)}var xu=Uint8Array,Ql=Uint16Array,gC=Int32Array,xC=new xu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),yC=new xu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),dO=new xu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),QU=function(e,t){for(var r=new Ql(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new gC(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},JU=QU(xC,2),dpe=JU.b,X4=JU.r;dpe[28]=258,X4[258]=28;var fpe=QU(yC,0),fO=fpe.r,Q4=new Ql(32768);for(var ha=0;ha<32768;++ha){var Cf=(ha&43690)>>1|(ha&21845)<<1;Cf=(Cf&52428)>>2|(Cf&13107)<<2,Cf=(Cf&61680)>>4|(Cf&3855)<<4,Q4[ha]=((Cf&65280)>>8|(Cf&255)<<8)>>1}var Bx=function(e,t,r){for(var n=e.length,i=0,s=new Ql(t);i<n;++i)e[i]&&++s[e[i]-1];var o=new Ql(t);for(i=1;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;var l;if(r){l=new Ql(1<<t);var c=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],d=t-e[i],f=o[e[i]-1]++<<d,h=f|(1<<d)-1;f<=h;++f)l[Q4[f]>>c]=u}else for(l=new Ql(n),i=0;i<n;++i)e[i]&&(l[i]=Q4[o[e[i]-1]++]>>15-e[i]);return l},C0=new xu(288);for(var ha=0;ha<144;++ha)C0[ha]=8;for(var ha=144;ha<256;++ha)C0[ha]=9;for(var ha=256;ha<280;++ha)C0[ha]=7;for(var ha=280;ha<288;++ha)C0[ha]=8;var Y2=new xu(32);for(var ha=0;ha<32;++ha)Y2[ha]=5;var hpe=Bx(C0,9,0),ppe=Bx(Y2,5,0),ZU=function(e){return(e+7)/8|0},mpe=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new xu(e.subarray(t,r))},vd=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},qg=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},fk=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return{t:tz,l:0};if(i==1){var o=new xu(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(k,j){return k.f-j.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=i-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var h=s[0].s,n=1;n<i;++n)s[n].s>h&&(h=s[n].s);var p=new Ql(h+1),m=J4(r[d-1],p,0);if(m>t){var n=0,g=0,y=m-t,b=1<<y;for(s.sort(function(j,A){return p[A.s]-p[j.s]||j.f-A.f});n<i;++n){var v=s[n].s;if(p[v]>t)g+=b-(1<<m-p[v]),p[v]=t;else break}for(g>>=y;g>0;){var w=s[n].s;p[w]<t?g-=1<<t-p[w]++-1:++n}for(;n>=0&&g;--n){var S=s[n].s;p[S]==t&&(--p[S],++g)}m=t}return{t:new xu(p),l:m}},J4=function(e,t,r){return e.s==-1?Math.max(J4(e.l,t,r+1),J4(e.r,t,r+1)):t[e.s]=r},hO=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ql(++t),n=0,i=e[0],s=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==i&&l!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=e[l]}return{c:r.subarray(0,n),n:t}},Hg=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},ez=function(e,t,r){var n=r.length,i=ZU(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},pO=function(e,t,r,n,i,s,o,l,c,u,d){vd(t,d++,r),++i[256];for(var f=fk(i,15),h=f.t,p=f.l,m=fk(s,15),g=m.t,y=m.l,b=hO(h),v=b.c,w=b.n,S=hO(g),k=S.c,j=S.n,A=new Ql(19),L=0;L<v.length;++L)++A[v[L]&31];for(var L=0;L<k.length;++L)++A[k[L]&31];for(var P=fk(A,7),B=P.t,E=P.l,T=19;T>4&&!B[dO[T-1]];--T);var F=u+5<<3,W=Hg(i,C0)+Hg(s,Y2)+o,z=Hg(i,h)+Hg(s,g)+o+14+3*T+Hg(A,B)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&F<=W&&F<=z)return ez(t,d,e.subarray(c,c+u));var se,de,U,G;if(vd(t,d,1+(z<W)),d+=2,z<W){se=Bx(h,p,0),de=h,U=Bx(g,y,0),G=g;var re=Bx(B,E,0);vd(t,d,w-257),vd(t,d+5,j-1),vd(t,d+10,T-4),d+=14;for(var L=0;L<T;++L)vd(t,d+3*L,B[dO[L]]);d+=3*T;for(var X=[v,k],C=0;C<2;++C)for(var K=X[C],L=0;L<K.length;++L){var V=K[L]&31;vd(t,d,re[V]),d+=B[V],V>15&&(vd(t,d,K[L]>>5&127),d+=K[L]>>12)}}else se=hpe,de=C0,U=ppe,G=Y2;for(var L=0;L<l;++L){var R=n[L];if(R>255){var V=R>>18&31;qg(t,d,se[V+257]),d+=de[V+257],V>7&&(vd(t,d,R>>23&31),d+=xC[V]);var J=R&31;qg(t,d,U[J]),d+=G[J],J>3&&(qg(t,d,R>>5&8191),d+=yC[J])}else qg(t,d,se[R]),d+=de[R]}return qg(t,d,se[256]),d+de[256]},gpe=new gC([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),tz=new xu(0),xpe=function(e,t,r,n,i,s){var o=s.z||e.length,l=new xu(n+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(n,l.length-i),u=s.l,d=(s.r||0)&7;if(t){d&&(c[0]=s.r>>3);for(var f=gpe[t-1],h=f>>13,p=f&8191,m=(1<<r)-1,g=s.p||new Ql(32768),y=s.h||new Ql(m+1),b=Math.ceil(r/3),v=2*b,w=function(ae){return(e[ae]^e[ae+1]<<b^e[ae+2]<<v)&m},S=new gC(25e3),k=new Ql(288),j=new Ql(32),A=0,L=0,P=s.i||0,B=0,E=s.w||0,T=0;P+2<o;++P){var F=w(P),W=P&32767,z=y[F];if(g[W]=z,y[F]=W,E<=P){var se=o-P;if((A>7e3||B>24576)&&(se>423||!u)){d=pO(e,c,0,S,k,j,L,B,T,P-T,d),B=A=L=0,T=P;for(var de=0;de<286;++de)k[de]=0;for(var de=0;de<30;++de)j[de]=0}var U=2,G=0,re=p,X=W-z&32767;if(se>2&&F==w(P-X))for(var C=Math.min(h,se)-1,K=Math.min(32767,P),V=Math.min(258,se);X<=K&&--re&&W!=z;){if(e[P+U]==e[P+U-X]){for(var R=0;R<V&&e[P+R]==e[P+R-X];++R);if(R>U){if(U=R,G=X,R>C)break;for(var J=Math.min(X,R-2),q=0,de=0;de<J;++de){var Y=P-X+de&32767,Q=g[Y],ie=Y-Q&32767;ie>q&&(q=ie,z=Y)}}}W=z,z=g[W],X+=W-z&32767}if(G){S[B++]=268435456|X4[U]<<18|fO[G];var le=X4[U]&31,O=fO[G]&31;L+=xC[le]+yC[O],++k[257+le],++j[O],E=P+U,++A}else S[B++]=e[P],++k[e[P]]}}for(P=Math.max(P,E);P<o;++P)S[B++]=e[P],++k[e[P]];d=pO(e,c,u,S,k,j,L,B,T,P-T,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=y,s.p=g,s.i=P,s.w=E)}else{for(var P=s.w||0;P<o+u;P+=65535){var H=P+65535;H>=o&&(c[d/8|0]=u,H=o),d=ez(c,d+1,e.subarray(P,H))}s.i=o}return mpe(l,0,n+ZU(d)+i)},rz=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)i+=n+=r[o];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},ype=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new xu(s.length+e.length);o.set(s),o.set(e,s.length),e=o,i.w=s.length}return xpe(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},nz=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},bpe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=rz();i.p(t.dictionary),nz(e,2,i.d())}};function Z4(e,t){t||(t={});var r=rz();r.p(e);var n=ype(e,t,t.dictionary?6:2,4);return bpe(n,t),nz(n,n.length-4,r.d()),n}var vpe=typeof TextDecoder<"u"&&new TextDecoder,wpe=0;try{vpe.decode(tz,{stream:!0}),wpe=1}catch{}function Spe(e){if(Array.isArray(e))return e}function _pe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function mO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function kpe(e,t){if(e){if(typeof e=="string")return mO(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mO(e,t):void 0}}function jpe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gO(e,t){return Spe(e)||_pe(e,t)||kpe(e,t)||jpe()}function xO(e,t="utf8"){return new TextDecoder(t).decode(e)}const Ape=new TextEncoder;function Npe(e){return Ape.encode(e)}const Cpe=1024*8,Epe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),hk={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class bC{constructor(t=Cpe,r={}){Ti(this,"buffer");Ti(this,"byteLength");Ti(this,"byteOffset");Ti(this,"length");Ti(this,"offset");Ti(this,"lastWrittenByte");Ti(this,"littleEndian");Ti(this,"_data");Ti(this,"_mark");Ti(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=r.offset?r.offset>>>0:0,s=t.byteLength-i;let o=i;(ArrayBuffer.isView(t)||t instanceof bC)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+i),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=hk[r].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+n);if(this.littleEndian===Epe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+n));l.reverse();const c=new hk[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new hk[r](s);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return xO(this.readBytes(t))}decodeText(t=1,r="utf8"){return xO(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(Npe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function ug(e){let t=e.length;for(;--t>=0;)e[t]=0}const Tpe=3,Ppe=258,iz=29,Ope=256,Mpe=Ope+1+iz,az=30,Lpe=512,Rpe=new Array((Mpe+2)*2);ug(Rpe);const Bpe=new Array(az*2);ug(Bpe);const Fpe=new Array(Lpe);ug(Fpe);const Ipe=new Array(Ppe-Tpe+1);ug(Ipe);const Dpe=new Array(iz);ug(Dpe);const $pe=new Array(az);ug($pe);const Upe=(e,t,r,n)=>{let i=e&65535|0,s=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+t[n++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};var eA=Upe;const zpe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},Wpe=new Uint32Array(zpe()),qpe=(e,t,r,n)=>{const i=Wpe,s=n+r;e^=-1;for(let o=n;o<s;o++)e=e>>>8^i[(e^t[o])&255];return e^-1};var Mu=qpe,tA={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},sz={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Hpe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Vpe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)Hpe(r,n)&&(e[n]=r[n])}}return e},Gpe=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,s=e.length;n<s;n++){let o=e[n];r.set(o,i),i+=o.length}return r},oz={assign:Vpe,flattenChunks:Gpe};let lz=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{lz=!1}const _1=new Uint8Array(256);for(let e=0;e<256;e++)_1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_1[254]=_1[254]=1;var Kpe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,s,o=e.length,l=0;for(i=0;i<o;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),s=0,i=0;s<l;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const Ype=(e,t)=>{if(t<65534&&e.subarray&&lz)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var Xpe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i;const s=new Array(r*2);for(i=0,n=0;n<r;){let o=e[n++];if(o<128){s[i++]=o;continue}let l=_1[o];if(l>4){s[i++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return Ype(s,i)},Qpe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+_1[e[r]]>t?r:t},rA={string2buf:Kpe,buf2string:Xpe,utf8border:Qpe};function Jpe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Zpe=Jpe;const Mb=16209,eme=16191;var tme=function(t,r){let n,i,s,o,l,c,u,d,f,h,p,m,g,y,b,v,w,S,k,j,A,L,P,B;const E=t.state;n=t.next_in,P=t.input,i=n+(t.avail_in-5),s=t.next_out,B=t.output,o=s-(r-t.avail_out),l=s+(t.avail_out-257),c=E.dmax,u=E.wsize,d=E.whave,f=E.wnext,h=E.window,p=E.hold,m=E.bits,g=E.lencode,y=E.distcode,b=(1<<E.lenbits)-1,v=(1<<E.distbits)-1;e:do{m<15&&(p+=P[n++]<<m,m+=8,p+=P[n++]<<m,m+=8),w=g[p&b];t:for(;;){if(S=w>>>24,p>>>=S,m-=S,S=w>>>16&255,S===0)B[s++]=w&65535;else if(S&16){k=w&65535,S&=15,S&&(m<S&&(p+=P[n++]<<m,m+=8),k+=p&(1<<S)-1,p>>>=S,m-=S),m<15&&(p+=P[n++]<<m,m+=8,p+=P[n++]<<m,m+=8),w=y[p&v];r:for(;;){if(S=w>>>24,p>>>=S,m-=S,S=w>>>16&255,S&16){if(j=w&65535,S&=15,m<S&&(p+=P[n++]<<m,m+=8,m<S&&(p+=P[n++]<<m,m+=8)),j+=p&(1<<S)-1,j>c){t.msg="invalid distance too far back",E.mode=Mb;break e}if(p>>>=S,m-=S,S=s-o,j>S){if(S=j-S,S>d&&E.sane){t.msg="invalid distance too far back",E.mode=Mb;break e}if(A=0,L=h,f===0){if(A+=u-S,S<k){k-=S;do B[s++]=h[A++];while(--S);A=s-j,L=B}}else if(f<S){if(A+=u+f-S,S-=f,S<k){k-=S;do B[s++]=h[A++];while(--S);if(A=0,f<k){S=f,k-=S;do B[s++]=h[A++];while(--S);A=s-j,L=B}}}else if(A+=f-S,S<k){k-=S;do B[s++]=h[A++];while(--S);A=s-j,L=B}for(;k>2;)B[s++]=L[A++],B[s++]=L[A++],B[s++]=L[A++],k-=3;k&&(B[s++]=L[A++],k>1&&(B[s++]=L[A++]))}else{A=s-j;do B[s++]=B[A++],B[s++]=B[A++],B[s++]=B[A++],k-=3;while(k>2);k&&(B[s++]=B[A++],k>1&&(B[s++]=B[A++]))}}else if(S&64){t.msg="invalid distance code",E.mode=Mb;break e}else{w=y[(w&65535)+(p&(1<<S)-1)];continue r}break}}else if(S&64)if(S&32){E.mode=eme;break e}else{t.msg="invalid literal/length code",E.mode=Mb;break e}else{w=g[(w&65535)+(p&(1<<S)-1)];continue t}break}}while(n<i&&s<l);k=m>>3,n-=k,m-=k<<3,p&=(1<<m)-1,t.next_in=n,t.next_out=s,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=s<l?257+(l-s):257-(s-l),E.hold=p,E.bits=m};const gp=15,yO=852,bO=592,vO=0,pk=1,wO=2,rme=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),nme=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ime=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ame=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),sme=(e,t,r,n,i,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,h=0,p=0,m=0,g=0,y=0,b=0,v=0,w,S,k,j,A,L=null,P;const B=new Uint16Array(gp+1),E=new Uint16Array(gp+1);let T=null,F,W,z;for(u=0;u<=gp;u++)B[u]=0;for(d=0;d<n;d++)B[t[r+d]]++;for(p=c,h=gp;h>=1&&B[h]===0;h--);if(p>h&&(p=h),h===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<h&&B[f]===0;f++);for(p<f&&(p=f),y=1,u=1;u<=gp;u++)if(y<<=1,y-=B[u],y<0)return-1;if(y>0&&(e===vO||h!==1))return-1;for(E[1]=0,u=1;u<gp;u++)E[u+1]=E[u]+B[u];for(d=0;d<n;d++)t[r+d]!==0&&(o[E[t[r+d]]++]=d);if(e===vO?(L=T=o,P=20):e===pk?(L=rme,T=nme,P=257):(L=ime,T=ame,P=0),v=0,d=0,u=f,A=s,m=p,g=0,k=-1,b=1<<p,j=b-1,e===pk&&b>yO||e===wO&&b>bO)return 1;for(;;){F=u-g,o[d]+1<P?(W=0,z=o[d]):o[d]>=P?(W=T[o[d]-P],z=L[o[d]-P]):(W=96,z=0),w=1<<u-g,S=1<<m,f=S;do S-=w,i[A+(v>>g)+S]=F<<24|W<<16|z|0;while(S!==0);for(w=1<<u-1;v&w;)w>>=1;if(w!==0?(v&=w-1,v+=w):v=0,d++,--B[u]===0){if(u===h)break;u=t[r+o[d]]}if(u>p&&(v&j)!==k){for(g===0&&(g=p),A+=f,m=u-g,y=1<<m;m+g<h&&(y-=B[m+g],!(y<=0));)m++,y<<=1;if(b+=1<<m,e===pk&&b>yO||e===wO&&b>bO)return 1;k=v&j,i[k]=p<<24|m<<16|A-s|0}}return v!==0&&(i[A+v]=u-g<<24|64<<16|0),l.bits=p,0};var Fx=sme;const ome=0,cz=1,uz=2,{Z_FINISH:SO,Z_BLOCK:lme,Z_TREES:Lb,Z_OK:E0,Z_STREAM_END:cme,Z_NEED_DICT:ume,Z_STREAM_ERROR:$c,Z_DATA_ERROR:dz,Z_MEM_ERROR:fz,Z_BUF_ERROR:dme,Z_DEFLATED:_O}=sz,BS=16180,kO=16181,jO=16182,AO=16183,NO=16184,CO=16185,EO=16186,TO=16187,PO=16188,OO=16189,X2=16190,wd=16191,mk=16192,MO=16193,gk=16194,LO=16195,RO=16196,BO=16197,FO=16198,Rb=16199,Bb=16200,IO=16201,DO=16202,$O=16203,UO=16204,zO=16205,xk=16206,WO=16207,qO=16208,ba=16209,hz=16210,pz=16211,fme=852,hme=592,pme=15,mme=pme,HO=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function gme(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const tp=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<BS||t.mode>pz?1:0},mz=e=>{if(tp(e))return $c;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=BS,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(fme),t.distcode=t.distdyn=new Int32Array(hme),t.sane=1,t.back=-1,E0},gz=e=>{if(tp(e))return $c;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,mz(e)},xz=(e,t)=>{let r;if(tp(e))return $c;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?$c:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,gz(e))},yz=(e,t)=>{if(!e)return $c;const r=new gme;e.state=r,r.strm=e,r.window=null,r.mode=BS;const n=xz(e,t);return n!==E0&&(e.state=null),n},xme=e=>yz(e,mme);let VO=!0,yk,bk;const yme=e=>{if(VO){yk=new Int32Array(512),bk=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Fx(cz,e.lens,0,288,yk,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Fx(uz,e.lens,0,32,bk,0,e.work,{bits:5}),VO=!1}e.lencode=yk,e.lenbits=9,e.distcode=bk,e.distbits=5},bz=(e,t,r,n)=>{let i;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),s.window.set(t.subarray(r-n,r-n+i),s.wnext),n-=i,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},bme=(e,t)=>{let r,n,i,s,o,l,c,u,d,f,h,p,m,g,y=0,b,v,w,S,k,j,A,L;const P=new Uint8Array(4);let B,E;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(tp(e)||!e.output||!e.input&&e.avail_in!==0)return $c;r=e.state,r.mode===wd&&(r.mode=mk),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,f=l,h=c,L=E0;e:for(;;)switch(r.mode){case BS:if(r.wrap===0){r.mode=mk;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,P[0]=u&255,P[1]=u>>>8&255,r.check=Mu(r.check,P,2,0),u=0,d=0,r.mode=kO;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=ba;break}if((u&15)!==_O){e.msg="unknown compression method",r.mode=ba;break}if(u>>>=4,d-=4,A=(u&15)+8,r.wbits===0&&(r.wbits=A),A>15||A>r.wbits){e.msg="invalid window size",r.mode=ba;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?OO:wd,u=0,d=0;break;case kO:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==_O){e.msg="unknown compression method",r.mode=ba;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=ba;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=Mu(r.check,P,2,0)),u=0,d=0,r.mode=jO;case jO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,P[2]=u>>>16&255,P[3]=u>>>24&255,r.check=Mu(r.check,P,4,0)),u=0,d=0,r.mode=AO;case AO:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=Mu(r.check,P,2,0)),u=0,d=0,r.mode=NO;case NO:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=Mu(r.check,P,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=CO;case CO:if(r.flags&1024&&(p=r.length,p>l&&(p=l),p&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+p),A)),r.flags&512&&r.wrap&4&&(r.check=Mu(r.check,n,p,s)),l-=p,s+=p,r.length-=p),r.length))break e;r.length=0,r.mode=EO;case EO:if(r.flags&2048){if(l===0)break e;p=0;do A=n[s+p++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A));while(A&&p<l);if(r.flags&512&&r.wrap&4&&(r.check=Mu(r.check,n,p,s)),l-=p,s+=p,A)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=TO;case TO:if(r.flags&4096){if(l===0)break e;p=0;do A=n[s+p++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A));while(A&&p<l);if(r.flags&512&&r.wrap&4&&(r.check=Mu(r.check,n,p,s)),l-=p,s+=p,A)break e}else r.head&&(r.head.comment=null);r.mode=PO;case PO:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=ba;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=wd;break;case OO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}e.adler=r.check=HO(u),u=0,d=0,r.mode=X2;case X2:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,ume;e.adler=r.check=1,r.mode=wd;case wd:if(t===lme||t===Lb)break e;case mk:if(r.last){u>>>=d&7,d-=d&7,r.mode=xk;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=MO;break;case 1:if(yme(r),r.mode=Rb,t===Lb){u>>>=2,d-=2;break e}break;case 2:r.mode=RO;break;case 3:e.msg="invalid block type",r.mode=ba}u>>>=2,d-=2;break;case MO:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=ba;break}if(r.length=u&65535,u=0,d=0,r.mode=gk,t===Lb)break e;case gk:r.mode=LO;case LO:if(p=r.length,p){if(p>l&&(p=l),p>c&&(p=c),p===0)break e;i.set(n.subarray(s,s+p),o),l-=p,s+=p,c-=p,o+=p,r.length-=p;break}r.mode=wd;break;case RO:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=ba;break}r.have=0,r.mode=BO;case BO:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[T[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},L=Fx(ome,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,L){e.msg="invalid code lengths set",r.mode=ba;break}r.have=0,r.mode=FO;case FO:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(w<16)u>>>=b,d-=b,r.lens[r.have++]=w;else{if(w===16){for(E=b+2;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=b,d-=b,r.have===0){e.msg="invalid bit length repeat",r.mode=ba;break}A=r.lens[r.have-1],p=3+(u&3),u>>>=2,d-=2}else if(w===17){for(E=b+3;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=b,d-=b,A=0,p=3+(u&7),u>>>=3,d-=3}else{for(E=b+7;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=b,d-=b,A=0,p=11+(u&127),u>>>=7,d-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=ba;break}for(;p--;)r.lens[r.have++]=A}}if(r.mode===ba)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=ba;break}if(r.lenbits=9,B={bits:r.lenbits},L=Fx(cz,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,L){e.msg="invalid literal/lengths set",r.mode=ba;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},L=Fx(uz,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,L){e.msg="invalid distances set",r.mode=ba;break}if(r.mode=Rb,t===Lb)break e;case Rb:r.mode=Bb;case Bb:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,tme(e,h),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,r.mode===wd&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(v&&!(v&240)){for(S=b,k=v,j=w;y=r.lencode[j+((u&(1<<S+k)-1)>>S)],b=y>>>24,v=y>>>16&255,w=y&65535,!(S+b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=b,d-=b,r.back+=b,r.length=w,v===0){r.mode=zO;break}if(v&32){r.back=-1,r.mode=wd;break}if(v&64){e.msg="invalid literal/length code",r.mode=ba;break}r.extra=v&15,r.mode=IO;case IO:if(r.extra){for(E=r.extra;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=DO;case DO:for(;y=r.distcode[u&(1<<r.distbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(v&240)){for(S=b,k=v,j=w;y=r.distcode[j+((u&(1<<S+k)-1)>>S)],b=y>>>24,v=y>>>16&255,w=y&65535,!(S+b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=b,d-=b,r.back+=b,v&64){e.msg="invalid distance code",r.mode=ba;break}r.offset=w,r.extra=v&15,r.mode=$O;case $O:if(r.extra){for(E=r.extra;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=ba;break}r.mode=UO;case UO:if(c===0)break e;if(p=h-c,r.offset>p){if(p=r.offset-p,p>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=ba;break}p>r.wnext?(p-=r.wnext,m=r.wsize-p):m=r.wnext-p,p>r.length&&(p=r.length),g=r.window}else g=i,m=o-r.offset,p=r.length;p>c&&(p=c),c-=p,r.length-=p;do i[o++]=g[m++];while(--p);r.length===0&&(r.mode=Bb);break;case zO:if(c===0)break e;i[o++]=r.length,c--,r.mode=Bb;break;case xk:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(h-=c,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?Mu(r.check,i,h,o-h):eA(r.check,i,h,o-h)),h=c,r.wrap&4&&(r.flags?u:HO(u))!==r.check){e.msg="incorrect data check",r.mode=ba;break}u=0,d=0}r.mode=WO;case WO:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=ba;break}u=0,d=0}r.mode=qO;case qO:L=cme;break e;case ba:L=dz;break e;case hz:return fz;case pz:default:return $c}return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,(r.wsize||h!==e.avail_out&&r.mode<ba&&(r.mode<xk||t!==SO))&&bz(e,e.output,e.next_out,h-e.avail_out),f-=e.avail_in,h-=e.avail_out,e.total_in+=f,e.total_out+=h,r.total+=h,r.wrap&4&&h&&(e.adler=r.check=r.flags?Mu(r.check,i,h,e.next_out-h):eA(r.check,i,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===wd?128:0)+(r.mode===Rb||r.mode===gk?256:0),(f===0&&h===0||t===SO)&&L===E0&&(L=dme),L},vme=e=>{if(tp(e))return $c;let t=e.state;return t.window&&(t.window=null),e.state=null,E0},wme=(e,t)=>{if(tp(e))return $c;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,E0):$c},Sme=(e,t)=>{const r=t.length;let n,i,s;return tp(e)||(n=e.state,n.wrap!==0&&n.mode!==X2)?$c:n.mode===X2&&(i=1,i=eA(i,t,r,0),i!==n.check)?dz:(s=bz(e,t,r,r),s?(n.mode=hz,fz):(n.havedict=1,E0))};var _me=gz,kme=xz,jme=mz,Ame=xme,Nme=yz,Cme=bme,Eme=vme,Tme=wme,Pme=Sme,Ome="pako inflate (from Nodeca project)",Ed={inflateReset:_me,inflateReset2:kme,inflateResetKeep:jme,inflateInit:Ame,inflateInit2:Nme,inflate:Cme,inflateEnd:Eme,inflateGetHeader:Tme,inflateSetDictionary:Pme,inflateInfo:Ome};function Mme(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Lme=Mme;const vz=Object.prototype.toString,{Z_NO_FLUSH:Rme,Z_FINISH:Bme,Z_OK:k1,Z_STREAM_END:vk,Z_NEED_DICT:wk,Z_STREAM_ERROR:Fme,Z_DATA_ERROR:GO,Z_MEM_ERROR:Ime}=sz;function fy(e){this.options=oz.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zpe,this.strm.avail_out=0;let r=Ed.inflateInit2(this.strm,t.windowBits);if(r!==k1)throw new Error(tA[r]);if(this.header=new Lme,Ed.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=rA.string2buf(t.dictionary):vz.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Ed.inflateSetDictionary(this.strm,t.dictionary),r!==k1)))throw new Error(tA[r])}fy.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?Bme:Rme,vz.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Ed.inflate(r,o),s===wk&&i&&(s=Ed.inflateSetDictionary(r,i),s===k1?s=Ed.inflate(r,o):s===GO&&(s=wk));r.avail_in>0&&s===vk&&r.state.wrap>0&&e[r.next_in]!==0;)Ed.inflateReset(r),s=Ed.inflate(r,o);switch(s){case Fme:case GO:case wk:case Ime:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===vk))if(this.options.to==="string"){let c=rA.utf8border(r.output,r.next_out),u=r.next_out-c,d=rA.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===k1&&l===0)){if(s===vk)return s=Ed.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};fy.prototype.onData=function(e){this.chunks.push(e)};fy.prototype.onEnd=function(e){e===k1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=oz.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Dme(e,t){const r=new fy(t);if(r.push(e),r.err)throw r.msg||tA[r.err];return r.result}var $me=fy,Ume=Dme,zme={Inflate:$me,inflate:Ume};const{Inflate:Wme,inflate:qme}=zme;var KO=Wme,Hme=qme;const wz=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;wz[e]=t}const YO=4294967295;function Vme(e,t,r){let n=e;for(let i=0;i<r;i++)n=wz[(n^t[i])&255]^n>>>8;return n}function Gme(e,t){return(Vme(YO,e,t)^YO)>>>0}function XO(e,t,r){const n=e.readUint32(),i=Gme(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function Sz(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function _z(e,t,r,n){let i=0;for(;i<n;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-n]&255}function kz(e,t,r,n){let i=0;if(r.length===0)for(;i<n;i++)t[i]=e[i];else for(;i<n;i++)t[i]=e[i]+r[i]&255}function jz(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-i]>>1)&255}else{for(;s<i;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-i]+r[s]>>1)&255}}function Az(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-i]&255}else{for(;s<i;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+Kme(t[s-i],r[s],r[s-i])&255}}function Kme(e,t,r){const n=e+t-r,i=Math.abs(n-e),s=Math.abs(n-t),o=Math.abs(n-r);return i<=s&&i<=o?e:s<=o?t:r}function Yme(e,t,r,n,i,s){switch(e){case 0:Sz(t,r,i);break;case 1:_z(t,r,i,s);break;case 2:kz(t,r,n,i);break;case 3:jz(t,r,n,i,s);break;case 4:Az(t,r,n,i,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const Xme=new Uint16Array([255]),Qme=new Uint8Array(Xme.buffer),Jme=Qme[0]===255;function Zme(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*i,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],h=Math.ceil((r-f.x)/f.xStep),p=Math.ceil((n-f.y)/f.yStep);if(h<=0||p<=0)continue;const m=h*l,g=new Uint8Array(m);for(let y=0;y<p;y++){const b=t[u++],v=t.subarray(u,u+m);u+=m;const w=new Uint8Array(m);Yme(b,v,w,g,m,l),g.set(w);for(let S=0;S<h;S++){const k=f.x+S*f.xStep,j=f.y+y*f.yStep;if(!(k>=r||j>=n))for(let A=0;A<l;A++)c[(j*r+k)*l+A]=w[S*l+A]}}}if(s===16){const d=new Uint16Array(c.buffer);if(Jme)for(let f=0;f<d.length;f++)d[f]=ege(d[f]);return d}else return c}function ege(e){return(e&255)<<8|e>>8&255}const tge=new Uint16Array([255]),rge=new Uint8Array(tge.buffer),nge=rge[0]===255,ige=new Uint8Array(0);function QO(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,o=Math.ceil(s/8)*i,l=Math.ceil(s/8*i*r),c=new Uint8Array(n*l);let u=ige,d=0,f,h;for(let p=0;p<n;p++){switch(f=t.subarray(d+1,d+1+l),h=c.subarray(p*l,(p+1)*l),t[d]){case 0:Sz(f,h,l);break;case 1:_z(f,h,l,o);break;case 2:kz(f,h,u,l);break;case 3:jz(f,h,u,l,o);break;case 4:Az(f,h,u,l,o);break;default:throw new Error(`Unsupported filter: ${t[d]}`)}u=h,d+=l+1}if(s===16){const p=new Uint16Array(c.buffer);if(nge)for(let m=0;m<p.length;m++)p[m]=age(p[m]);return p}else return c}function age(e){return(e&255)<<8|e>>8&255}const qv=Uint8Array.of(137,80,78,71,13,10,26,10);function JO(e){if(!sge(e.readBytes(qv.length)))throw new Error("wrong PNG signature")}function sge(e){if(e.length<qv.length)return!1;for(let t=0;t<qv.length;t++)if(e[t]!==qv[t])return!1;return!0}const oge="tEXt",lge=0,Nz=new TextDecoder("latin1");function cge(e){if(dge(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const uge=/^[\u0000-\u00FF]*$/;function dge(e){if(!uge.test(e))throw new Error("invalid latin1 text")}function fge(e,t,r){const n=Cz(t);e[n]=hge(t,r-n.length-1)}function Cz(e){for(e.mark();e.readByte()!==lge;);const t=e.offset;e.reset();const r=Nz.decode(e.readBytes(t-e.offset-1));return e.skip(1),cge(r),r}function hge(e,t){return Nz.decode(e.readBytes(t))}const $l={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Sk={UNKNOWN:-1,DEFLATE:0},ZO={UNKNOWN:-1,ADAPTIVE:0},_k={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Fb={NONE:0,BACKGROUND:1,PREVIOUS:2},kk={SOURCE:0,OVER:1};class pge extends bC{constructor(r,n={}){super(r);Ti(this,"_checkCrc");Ti(this,"_inflator");Ti(this,"_png");Ti(this,"_apng");Ti(this,"_end");Ti(this,"_hasPalette");Ti(this,"_palette");Ti(this,"_hasTransparency");Ti(this,"_transparency");Ti(this,"_compressionMethod");Ti(this,"_filterMethod");Ti(this,"_interlaceMethod");Ti(this,"_colorType");Ti(this,"_isAnimated");Ti(this,"_numberOfFrames");Ti(this,"_numberOfPlays");Ti(this,"_frames");Ti(this,"_writingDataChunks");const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new KO,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Sk.UNKNOWN,this._filterMethod=ZO.UNKNOWN,this._interlaceMethod=_k.UNKNOWN,this._colorType=$l.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(JO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(JO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case oge:fge(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?XO(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?XO(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=mge(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case $l.GREYSCALE:i=1;break;case $l.TRUECOLOUR:i=3;break;case $l.INDEXED_COLOUR:i=1;break;case $l.GREYSCALE_ALPHA:i=2;break;case $l.TRUECOLOUR_ALPHA:i=4;break;case $l.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==Sk.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<n;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case $l.GREYSCALE:case $l.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case $l.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case $l.UNKNOWN:case $l.GREYSCALE_ALPHA:case $l.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Cz(this),i=this.readUint8();if(i!==Sk.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:Hme(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=QO({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(i,s,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case Fb.NONE:break;case Fb.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)i.data[l+c]=0}break;case Fb.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case kk.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case kk.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/i,h=d%(this._png.channels-1)===0?1:n.data[u+d],p=Math.floor(f*h+(1-f)*r.data[c+d]);r.data[c+d]+=p}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==ZO.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===_k.NO_INTERLACE)this._png.data=QO({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===_k.ADAM7)this._png.data=Zme({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Fb.NONE,blendOp:kk.SOURCE,data:r}),this._inflator=new KO,this._writingDataChunks=!1}}function mge(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var eM;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(eM||(eM={}));function gge(e,t){return new pge(e,t).decode()}var Qn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function jk(){Qn.console&&typeof Qn.console.log=="function"&&Qn.console.log.apply(Qn.console,arguments)}var ta={log:jk,warn:function(e){Qn.console&&(typeof Qn.console.warn=="function"?Qn.console.warn.apply(Qn.console,arguments):jk.call(null,arguments))},error:function(e){Qn.console&&(typeof Qn.console.error=="function"?Qn.console.error.apply(Qn.console,arguments):jk(e))}};function Ak(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Ih(n.response,t,r)},n.onerror=function(){ta.error("could not download file")},n.send()}function tM(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Ib(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Ih=Qn.saveAs||((typeof window>"u"?"undefined":zi(window))!=="object"||window!==Qn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Qn.URL||Qn.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?tM(i.href)?Ak(e,t,r):Ib(i,i.target="_blank"):Ib(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Ib(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(tM(e))Ak(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Ib(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:zi(s)!=="object"&&(ta.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return Ak(e,t,r);var i=e.type==="application/octet-stream",s=/constructor/i.test(Qn.HTMLElement)||Qn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":zi(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(e)}else{var c=Qn.URL||Qn.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Ez(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,s=r[n].process,o=i.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Hv=Qn.atob.bind(Qn),rM=Qn.btoa.bind(Qn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Nk(e,t){var r=e[0],n=e[1],i=e[2],s=e[3];r=_o(r,n,i,s,t[0],7,-680876936),s=_o(s,r,n,i,t[1],12,-389564586),i=_o(i,s,r,n,t[2],17,606105819),n=_o(n,i,s,r,t[3],22,-1044525330),r=_o(r,n,i,s,t[4],7,-176418897),s=_o(s,r,n,i,t[5],12,1200080426),i=_o(i,s,r,n,t[6],17,-1473231341),n=_o(n,i,s,r,t[7],22,-45705983),r=_o(r,n,i,s,t[8],7,1770035416),s=_o(s,r,n,i,t[9],12,-1958414417),i=_o(i,s,r,n,t[10],17,-42063),n=_o(n,i,s,r,t[11],22,-1990404162),r=_o(r,n,i,s,t[12],7,1804603682),s=_o(s,r,n,i,t[13],12,-40341101),i=_o(i,s,r,n,t[14],17,-1502002290),r=ko(r,n=_o(n,i,s,r,t[15],22,1236535329),i,s,t[1],5,-165796510),s=ko(s,r,n,i,t[6],9,-1069501632),i=ko(i,s,r,n,t[11],14,643717713),n=ko(n,i,s,r,t[0],20,-373897302),r=ko(r,n,i,s,t[5],5,-701558691),s=ko(s,r,n,i,t[10],9,38016083),i=ko(i,s,r,n,t[15],14,-660478335),n=ko(n,i,s,r,t[4],20,-405537848),r=ko(r,n,i,s,t[9],5,568446438),s=ko(s,r,n,i,t[14],9,-1019803690),i=ko(i,s,r,n,t[3],14,-187363961),n=ko(n,i,s,r,t[8],20,1163531501),r=ko(r,n,i,s,t[13],5,-1444681467),s=ko(s,r,n,i,t[2],9,-51403784),i=ko(i,s,r,n,t[7],14,1735328473),r=jo(r,n=ko(n,i,s,r,t[12],20,-1926607734),i,s,t[5],4,-378558),s=jo(s,r,n,i,t[8],11,-2022574463),i=jo(i,s,r,n,t[11],16,1839030562),n=jo(n,i,s,r,t[14],23,-35309556),r=jo(r,n,i,s,t[1],4,-1530992060),s=jo(s,r,n,i,t[4],11,1272893353),i=jo(i,s,r,n,t[7],16,-155497632),n=jo(n,i,s,r,t[10],23,-1094730640),r=jo(r,n,i,s,t[13],4,681279174),s=jo(s,r,n,i,t[0],11,-358537222),i=jo(i,s,r,n,t[3],16,-722521979),n=jo(n,i,s,r,t[6],23,76029189),r=jo(r,n,i,s,t[9],4,-640364487),s=jo(s,r,n,i,t[12],11,-421815835),i=jo(i,s,r,n,t[15],16,530742520),r=Ao(r,n=jo(n,i,s,r,t[2],23,-995338651),i,s,t[0],6,-198630844),s=Ao(s,r,n,i,t[7],10,1126891415),i=Ao(i,s,r,n,t[14],15,-1416354905),n=Ao(n,i,s,r,t[5],21,-57434055),r=Ao(r,n,i,s,t[12],6,1700485571),s=Ao(s,r,n,i,t[3],10,-1894986606),i=Ao(i,s,r,n,t[10],15,-1051523),n=Ao(n,i,s,r,t[1],21,-2054922799),r=Ao(r,n,i,s,t[8],6,1873313359),s=Ao(s,r,n,i,t[15],10,-30611744),i=Ao(i,s,r,n,t[6],15,-1560198380),n=Ao(n,i,s,r,t[13],21,1309151649),r=Ao(r,n,i,s,t[4],6,-145523070),s=Ao(s,r,n,i,t[11],10,-1120210379),i=Ao(i,s,r,n,t[2],15,718787259),n=Ao(n,i,s,r,t[9],21,-343485551),e[0]=Gf(r,e[0]),e[1]=Gf(n,e[1]),e[2]=Gf(i,e[2]),e[3]=Gf(s,e[3])}function FS(e,t,r,n,i,s){return t=Gf(Gf(t,e),Gf(n,s)),Gf(t<<i|t>>>32-i,r)}function _o(e,t,r,n,i,s,o){return FS(t&r|~t&n,e,t,i,s,o)}function ko(e,t,r,n,i,s,o){return FS(t&n|r&~n,e,t,i,s,o)}function jo(e,t,r,n,i,s,o){return FS(t^r^n,e,t,i,s,o)}function Ao(e,t,r,n,i,s,o){return FS(r^(t|~n),e,t,i,s,o)}function Tz(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Nk(n,xge(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(Nk(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,Nk(n,i),n}function xge(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var nM="0123456789abcdef".split("");function yge(e){for(var t="",r=0;r<4;r++)t+=nM[e>>8*r+4&15]+nM[e>>8*r&15];return t}function bge(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function nA(e){return Tz(e).map(bge).join("")}var vge=function(e){for(var t=0;t<e.length;t++)e[t]=yge(e[t]);return e.join("")}(Tz("hello"))!="5d41402abc4b2a76b9719d911017c592";function Gf(e,t){if(vge){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function iA(e,t){var r,n,i,s;if(e!==r){for(var o=(i=e,s=1+(256/e.length|0),new Array(s+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=e,n=l}else l=n;var f=t.length,h=0,p=0,m="";for(c=0;c<f;c++)p=(p+(d=l[h=(h+1)%256]))%256,l[h]=l[p],l[p]=d,o=l[(l[h]+l[p])%256],m+=String.fromCharCode(t.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var iM={print:4,modify:8,copy:16,"annot-forms":32};function Bp(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(l){if(iM.perm!==void 0)throw new Error("Invalid permission: "+l);i+=iM[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=nA(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=iA(this.encryptionKey,this.padding)}function Fp(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);t+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):e[n]}return t}function aM(e){if(zi(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!i],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,n)}catch(l){Qn.console&&ta.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Q2(e){if(!(this instanceof Q2))return new Q2(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Pz(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Wh(e,t,r,n,i){if(!(this instanceof Wh))return new Wh(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Pz.call(this,n,i)}function tm(e,t,r,n,i){if(!(this instanceof tm))return new tm(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Pz.call(this,n,i)}function Un(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;zi(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,s=e.compress||e.compressPdf||s,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,h={},p={internal:{},__private__:{}};p.__private__.PubSub=aM;var m="1.3",g=p.__private__.getPdfVersion=function(){return m};p.__private__.setPdfVersion=function(M){m=M};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return y};var b=p.__private__.getPageFormat=function(M){return y[M]};i=i||"a4";var v="compat",w="advanced",S=v;function k(){this.saveGraphicsState(),I(new Ce(fe,0,0,-fe,0,kn()*fe).toString()+" cm"),this.setFontSize(this.getFontSize()/fe),u="n",S=w}function j(){this.restoreGraphicsState(),u="S",S=v}var A=p.__private__.combineFontStyleAndFontWeight=function(M,oe){if(M=="bold"&&oe=="normal"||M=="bold"&&oe==400||M=="normal"&&oe=="italic"||M=="bold"&&oe=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return oe&&(M=oe==400||oe==="normal"?M==="italic"?"italic":"normal":oe!=700&&oe!=="bold"||M!=="normal"?(oe==700?"bold":oe)+""+M:"bold"),M};p.advancedAPI=function(M){var oe=S===v;return oe&&k.call(this),typeof M!="function"||(M(this),oe&&j.call(this)),this},p.compatAPI=function(M){var oe=S===w;return oe&&j.call(this),typeof M!="function"||(M(this),oe&&k.call(this)),this},p.isAdvancedAPI=function(){return S===w};var L,P=function(M){if(S!==w)throw new Error(M+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=p.roundToPrecision=p.__private__.roundToPrecision=function(M,oe){var Re=t||oe;if(isNaN(M)||isNaN(Re))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return M.toFixed(Re).replace(/0+$/,"")};L=p.hpf=p.__private__.hpf=typeof c=="number"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,c)}:c==="smart"?function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,M>-1&&M<1?16:5)}:function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.hpf");return B(M,16)};var E=p.f2=p.__private__.f2=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f2");return B(M,2)},T=p.__private__.f3=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.f3");return B(M,3)},F=p.scale=p.__private__.scale=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.scale");return S===v?M*fe:S===w?M:void 0},W=function(M){return F(function(oe){return S===v?kn()-oe:S===w?oe:void 0}(M))};p.__private__.setPrecision=p.setPrecision=function(M){typeof parseInt(M,10)=="number"&&(t=parseInt(M,10))};var z,se="00000000000000000000000000000000",de=p.__private__.getFileId=function(){return se},U=p.__private__.setFileId=function(M){return se=M!==void 0&&/^[a-fA-F0-9]{32}$/.test(M)?M.toUpperCase():se.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Ge=new Bp(d.userPermissions,d.userPassword,d.ownerPassword,se)),se};p.setFileId=function(M){return U(M),this},p.getFileId=function(){return de()};var G=p.__private__.convertDateToPDFDate=function(M){var oe=M.getTimezoneOffset(),Re=oe<0?"+":"-",Je=Math.floor(Math.abs(oe/60)),kt=Math.abs(oe%60),mr=[Re,V(Je),"'",V(kt),"'"].join("");return["D:",M.getFullYear(),V(M.getMonth()+1),V(M.getDate()),V(M.getHours()),V(M.getMinutes()),V(M.getSeconds()),mr].join("")},re=p.__private__.convertPDFDateToDate=function(M){var oe=parseInt(M.substr(2,4),10),Re=parseInt(M.substr(6,2),10)-1,Je=parseInt(M.substr(8,2),10),kt=parseInt(M.substr(10,2),10),mr=parseInt(M.substr(12,2),10),lr=parseInt(M.substr(14,2),10);return new Date(oe,Re,Je,kt,mr,lr,0)},X=p.__private__.setCreationDate=function(M){var oe;if(M===void 0&&(M=new Date),M instanceof Date)oe=G(M);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(M))throw new Error("Invalid argument passed to jsPDF.setCreationDate");oe=M}return z=oe},C=p.__private__.getCreationDate=function(M){var oe=z;return M==="jsDate"&&(oe=re(z)),oe};p.setCreationDate=function(M){return X(M),this},p.getCreationDate=function(M){return C(M)};var K,V=p.__private__.padd2=function(M){return("0"+parseInt(M)).slice(-2)},R=p.__private__.padd2Hex=function(M){return("00"+(M=M.toString())).substr(M.length)},J=0,q=[],Y=[],Q=0,ie=[],le=[],O=!1,H=Y;p.__private__.setCustomOutputDestination=function(M){O=!0,H=M};var ae=function(M){O||(H=M)};p.__private__.resetCustomOutputDestination=function(){O=!1,H=Y};var I=p.__private__.out=function(M){return M=M.toString(),Q+=M.length+1,H.push(M),H},Z=p.__private__.write=function(M){return I(arguments.length===1?M.toString():Array.prototype.join.call(arguments," "))},pe=p.__private__.getArrayBuffer=function(M){for(var oe=M.length,Re=new ArrayBuffer(oe),Je=new Uint8Array(Re);oe--;)Je[oe]=M.charCodeAt(oe);return Re},Oe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return Oe};var Ae=e.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(M){return Ae=S===w?M/fe:M,this};var ke,_e=p.__private__.getFontSize=p.getFontSize=function(){return S===v?Ae:Ae*fe},De=e.R2L||!1;p.__private__.setR2L=p.setR2L=function(M){return De=M,this},p.__private__.getR2L=p.getR2L=function(){return De};var We,Ct=p.__private__.setZoomMode=function(M){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(M))ke=M;else if(isNaN(M)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(M)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+M+'" is not recognized.');ke=M}else ke=parseInt(M,10)};p.__private__.getZoomMode=function(){return ke};var _t,Xe=p.__private__.setPageMode=function(M){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(M)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+M+'" is not recognized.');We=M};p.__private__.getPageMode=function(){return We};var nt=p.__private__.setLayoutMode=function(M){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(M)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+M+'" is not recognized.');_t=M};p.__private__.getLayoutMode=function(){return _t},p.__private__.setDisplayMode=p.setDisplayMode=function(M,oe,Re){return Ct(M),nt(oe),Xe(Re),this};var Ne={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(M){if(Object.keys(Ne).indexOf(M)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Ne[M]},p.__private__.getDocumentProperties=function(){return Ne},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(M){for(var oe in Ne)Ne.hasOwnProperty(oe)&&M[oe]&&(Ne[oe]=M[oe]);return this},p.__private__.setDocumentProperty=function(M,oe){if(Object.keys(Ne).indexOf(M)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Ne[M]=oe};var be,fe,ge,lt,He,mt={},wt={},Pt=[],bt={},qr={},Tt={},xr={},Zr=null,Xr=0,Br=[],Vr=new aM(p),An=e.hotfixes||[],Yr={},Ln={},Me=[],Ce=function M(oe,Re,Je,kt,mr,lr){if(!(this instanceof M))return new M(oe,Re,Je,kt,mr,lr);isNaN(oe)&&(oe=1),isNaN(Re)&&(Re=0),isNaN(Je)&&(Je=0),isNaN(kt)&&(kt=1),isNaN(mr)&&(mr=0),isNaN(lr)&&(lr=0),this._matrix=[oe,Re,Je,kt,mr,lr]};Object.defineProperty(Ce.prototype,"sx",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(Ce.prototype,"shy",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(Ce.prototype,"shx",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(Ce.prototype,"sy",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(Ce.prototype,"tx",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(Ce.prototype,"ty",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(Ce.prototype,"a",{get:function(){return this._matrix[0]},set:function(M){this._matrix[0]=M}}),Object.defineProperty(Ce.prototype,"b",{get:function(){return this._matrix[1]},set:function(M){this._matrix[1]=M}}),Object.defineProperty(Ce.prototype,"c",{get:function(){return this._matrix[2]},set:function(M){this._matrix[2]=M}}),Object.defineProperty(Ce.prototype,"d",{get:function(){return this._matrix[3]},set:function(M){this._matrix[3]=M}}),Object.defineProperty(Ce.prototype,"e",{get:function(){return this._matrix[4]},set:function(M){this._matrix[4]=M}}),Object.defineProperty(Ce.prototype,"f",{get:function(){return this._matrix[5]},set:function(M){this._matrix[5]=M}}),Object.defineProperty(Ce.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ce.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ce.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ce.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ce.prototype.join=function(M){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(L).join(M)},Ce.prototype.multiply=function(M){var oe=M.sx*this.sx+M.shy*this.shx,Re=M.sx*this.shy+M.shy*this.sy,Je=M.shx*this.sx+M.sy*this.shx,kt=M.shx*this.shy+M.sy*this.sy,mr=M.tx*this.sx+M.ty*this.shx+this.tx,lr=M.tx*this.shy+M.ty*this.sy+this.ty;return new Ce(oe,Re,Je,kt,mr,lr)},Ce.prototype.decompose=function(){var M=this.sx,oe=this.shy,Re=this.shx,Je=this.sy,kt=this.tx,mr=this.ty,lr=Math.sqrt(M*M+oe*oe),Sr=(M/=lr)*Re+(oe/=lr)*Je;Re-=M*Sr,Je-=oe*Sr;var Hr=Math.sqrt(Re*Re+Je*Je);return Sr/=Hr,M*(Je/=Hr)<oe*(Re/=Hr)&&(M=-M,oe=-oe,Sr=-Sr,lr=-lr),{scale:new Ce(lr,0,0,Hr,0,0),translate:new Ce(1,0,0,1,kt,mr),rotate:new Ce(M,oe,-oe,M,0,0),skew:new Ce(1,0,Sr,1,0,0)}},Ce.prototype.toString=function(M){return this.join(" ")},Ce.prototype.inversed=function(){var M=this.sx,oe=this.shy,Re=this.shx,Je=this.sy,kt=this.tx,mr=this.ty,lr=1/(M*Je-oe*Re),Sr=Je*lr,Hr=-oe*lr,Jr=-Re*lr,me=M*lr;return new Ce(Sr,Hr,Jr,me,-Sr*kt-Jr*mr,-Hr*kt-me*mr)},Ce.prototype.applyToPoint=function(M){var oe=M.x*this.sx+M.y*this.shx+this.tx,Re=M.x*this.shy+M.y*this.sy+this.ty;return new fn(oe,Re)},Ce.prototype.applyToRectangle=function(M){var oe=this.applyToPoint(M),Re=this.applyToPoint(new fn(M.x+M.w,M.y+M.h));return new rr(oe.x,oe.y,Re.x-oe.x,Re.y-oe.y)},Ce.prototype.clone=function(){var M=this.sx,oe=this.shy,Re=this.shx,Je=this.sy,kt=this.tx,mr=this.ty;return new Ce(M,oe,Re,Je,kt,mr)},p.Matrix=Ce;var It=p.matrixMult=function(M,oe){return oe.multiply(M)},ft=new Ce(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=ft;var Ot=function(M,oe){if(!qr[M]){var Re=(oe instanceof Wh?"Sh":"P")+(Object.keys(bt).length+1).toString(10);oe.id=Re,qr[M]=Re,bt[Re]=oe,Vr.publish("addPattern",oe)}};p.ShadingPattern=Wh,p.TilingPattern=tm,p.addShadingPattern=function(M,oe){return P("addShadingPattern()"),Ot(M,oe),this},p.beginTilingPattern=function(M){P("beginTilingPattern()"),rt(M.boundingBox[0],M.boundingBox[1],M.boundingBox[2]-M.boundingBox[0],M.boundingBox[3]-M.boundingBox[1],M.matrix)},p.endTilingPattern=function(M,oe){P("endTilingPattern()"),oe.stream=le[K].join(`
`),Ot(M,oe),Vr.publish("endTilingPattern",oe),Me.pop().restore()};var er,hr=p.__private__.newObject=function(){var M=Tr();return ne(M,!0),M},Tr=p.__private__.newObjectDeferred=function(){return J++,q[J]=function(){return Q},J},ne=function(M,oe){return oe=typeof oe=="boolean"&&oe,q[M]=Q,oe&&I(M+" 0 obj"),M},ce=p.__private__.newAdditionalObject=function(){var M={objId:Tr(),content:""};return ie.push(M),M},te=Tr(),ue=Tr(),Ee=p.__private__.decodeColorString=function(M){var oe=M.split(" ");if(oe.length!==2||oe[1]!=="g"&&oe[1]!=="G")oe.length!==5||oe[4]!=="k"&&oe[4]!=="K"||(oe=[(1-oe[0])*(1-oe[3]),(1-oe[1])*(1-oe[3]),(1-oe[2])*(1-oe[3]),"r"]);else{var Re=parseFloat(oe[0]);oe=[Re,Re,Re,"r"]}for(var Je="#",kt=0;kt<3;kt++)Je+=("0"+Math.floor(255*parseFloat(oe[kt])).toString(16)).slice(-2);return Je},je=p.__private__.encodeColorString=function(M){var oe;typeof M=="string"&&(M={ch1:M});var Re=M.ch1,Je=M.ch2,kt=M.ch3,mr=M.ch4,lr=M.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Re=="string"&&Re.charAt(0)!=="#"){var Sr=new Ez(Re);if(Sr.ok)Re=Sr.toHex();else if(!/^\d*\.?\d*$/.test(Re))throw new Error('Invalid color "'+Re+'" passed to jsPDF.encodeColorString.')}if(typeof Re=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Re)&&(Re="#"+Re[1]+Re[1]+Re[2]+Re[2]+Re[3]+Re[3]),typeof Re=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Re)){var Hr=parseInt(Re.substr(1),16);Re=Hr>>16&255,Je=Hr>>8&255,kt=255&Hr}if(Je===void 0||mr===void 0&&Re===Je&&Je===kt)oe=typeof Re=="string"?Re+" "+lr[0]:M.precision===2?E(Re/255)+" "+lr[0]:T(Re/255)+" "+lr[0];else if(mr===void 0||zi(mr)==="object"){if(mr&&!isNaN(mr.a)&&mr.a===0)return["1.","1.","1.",lr[1]].join(" ");oe=typeof Re=="string"?[Re,Je,kt,lr[1]].join(" "):M.precision===2?[E(Re/255),E(Je/255),E(kt/255),lr[1]].join(" "):[T(Re/255),T(Je/255),T(kt/255),lr[1]].join(" ")}else oe=typeof Re=="string"?[Re,Je,kt,mr,lr[2]].join(" "):M.precision===2?[E(Re),E(Je),E(kt),E(mr),lr[2]].join(" "):[T(Re),T(Je),T(kt),T(mr),lr[2]].join(" ");return oe},gt=p.__private__.getFilters=function(){return o},Qe=p.__private__.putStream=function(M){var oe=(M=M||{}).data||"",Re=M.filters||gt(),Je=M.alreadyAppliedFilters||[],kt=M.addLength1||!1,mr=oe.length,lr=M.objectId,Sr=function(Vt){return Vt};if(d!==null&&lr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Sr=Ge.encryptor(lr,0));var Hr={};Re===!0&&(Re=["FlateEncode"]);var Jr=M.additionalKeyValues||[],me=(Hr=Un.API.processDataByFilters!==void 0?Un.API.processDataByFilters(oe,Re):{data:oe,reverseChain:[]}).reverseChain+(Array.isArray(Je)?Je.join(" "):Je.toString());if(Hr.data.length!==0&&(Jr.push({key:"Length",value:Hr.data.length}),kt===!0&&Jr.push({key:"Length1",value:mr})),me.length!=0)if(me.split("/").length-1==1)Jr.push({key:"Filter",value:me});else{Jr.push({key:"Filter",value:"["+me+"]"});for(var Pe=0;Pe<Jr.length;Pe+=1)if(Jr[Pe].key==="DecodeParms"){for(var et=[],xe=0;xe<Hr.reverseChain.split("/").length-1;xe+=1)et.push("null");et.push(Jr[Pe].value),Jr[Pe].value="["+et.join(" ")+"]"}}I("<<");for(var ze=0;ze<Jr.length;ze++)I("/"+Jr[ze].key+" "+Jr[ze].value);I(">>"),Hr.data.length!==0&&(I("stream"),I(Sr(Hr.data)),I("endstream"))},Fe=p.__private__.putPage=function(M){var oe=M.number,Re=M.data,Je=M.objId,kt=M.contentsObjId;ne(Je,!0),I("<</Type /Page"),I("/Parent "+M.rootDictionaryObjId+" 0 R"),I("/Resources "+M.resourceDictionaryObjId+" 0 R"),I("/MediaBox ["+parseFloat(L(M.mediaBox.bottomLeftX))+" "+parseFloat(L(M.mediaBox.bottomLeftY))+" "+L(M.mediaBox.topRightX)+" "+L(M.mediaBox.topRightY)+"]"),M.cropBox!==null&&I("/CropBox ["+L(M.cropBox.bottomLeftX)+" "+L(M.cropBox.bottomLeftY)+" "+L(M.cropBox.topRightX)+" "+L(M.cropBox.topRightY)+"]"),M.bleedBox!==null&&I("/BleedBox ["+L(M.bleedBox.bottomLeftX)+" "+L(M.bleedBox.bottomLeftY)+" "+L(M.bleedBox.topRightX)+" "+L(M.bleedBox.topRightY)+"]"),M.trimBox!==null&&I("/TrimBox ["+L(M.trimBox.bottomLeftX)+" "+L(M.trimBox.bottomLeftY)+" "+L(M.trimBox.topRightX)+" "+L(M.trimBox.topRightY)+"]"),M.artBox!==null&&I("/ArtBox ["+L(M.artBox.bottomLeftX)+" "+L(M.artBox.bottomLeftY)+" "+L(M.artBox.topRightX)+" "+L(M.artBox.topRightY)+"]"),typeof M.userUnit=="number"&&M.userUnit!==1&&I("/UserUnit "+M.userUnit),Vr.publish("putPage",{objId:Je,pageContext:Br[oe],pageNumber:oe,page:Re}),I("/Contents "+kt+" 0 R"),I(">>"),I("endobj");var mr=Re.join(`
`);return S===w&&(mr+=`
Q`),ne(kt,!0),Qe({data:mr,filters:gt(),objectId:kt}),I("endobj"),Je},$e=p.__private__.putPages=function(){var M,oe,Re=[];for(M=1;M<=Xr;M++)Br[M].objId=Tr(),Br[M].contentsObjId=Tr();for(M=1;M<=Xr;M++)Re.push(Fe({number:M,data:le[M],objId:Br[M].objId,contentsObjId:Br[M].contentsObjId,mediaBox:Br[M].mediaBox,cropBox:Br[M].cropBox,bleedBox:Br[M].bleedBox,trimBox:Br[M].trimBox,artBox:Br[M].artBox,userUnit:Br[M].userUnit,rootDictionaryObjId:te,resourceDictionaryObjId:ue}));ne(te,!0),I("<</Type /Pages");var Je="/Kids [";for(oe=0;oe<Xr;oe++)Je+=Re[oe]+" 0 R ";I(Je+"]"),I("/Count "+Xr),I(">>"),I("endobj"),Vr.publish("postPutPages")},st=function(M){Vr.publish("putFont",{font:M,out:I,newObject:hr,putStream:Qe}),M.isAlreadyPutted!==!0&&(M.objectNumber=hr(),I("<<"),I("/Type /Font"),I("/BaseFont /"+Fp(M.postScriptName)),I("/Subtype /Type1"),typeof M.encoding=="string"&&I("/Encoding /"+M.encoding),I("/FirstChar 32"),I("/LastChar 255"),I(">>"),I("endobj"))},Wt=function(M){M.objectNumber=hr();var oe=[];oe.push({key:"Type",value:"/XObject"}),oe.push({key:"Subtype",value:"/Form"}),oe.push({key:"BBox",value:"["+[L(M.x),L(M.y),L(M.x+M.width),L(M.y+M.height)].join(" ")+"]"}),oe.push({key:"Matrix",value:"["+M.matrix.toString()+"]"});var Re=M.pages[1].join(`
`);Qe({data:Re,additionalKeyValues:oe,objectId:M.objectNumber}),I("endobj")},qt=function(M,oe){oe||(oe=21);var Re=hr(),Je=function(lr,Sr){var Hr,Jr=[],me=1/(Sr-1);for(Hr=0;Hr<1;Hr+=me)Jr.push(Hr);if(Jr.push(1),lr[0].offset!=0){var Pe={offset:0,color:lr[0].color};lr.unshift(Pe)}if(lr[lr.length-1].offset!=1){var et={offset:1,color:lr[lr.length-1].color};lr.push(et)}for(var xe="",ze=0,Vt=0;Vt<Jr.length;Vt++){for(Hr=Jr[Vt];Hr>lr[ze+1].offset;)ze++;var Nt=lr[ze].offset,br=(Hr-Nt)/(lr[ze+1].offset-Nt),wr=lr[ze].color,zr=lr[ze+1].color;xe+=R(Math.round((1-br)*wr[0]+br*zr[0]).toString(16))+R(Math.round((1-br)*wr[1]+br*zr[1]).toString(16))+R(Math.round((1-br)*wr[2]+br*zr[2]).toString(16))}return xe.trim()}(M.colors,oe),kt=[];kt.push({key:"FunctionType",value:"0"}),kt.push({key:"Domain",value:"[0.0 1.0]"}),kt.push({key:"Size",value:"["+oe+"]"}),kt.push({key:"BitsPerSample",value:"8"}),kt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),kt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qe({data:Je,additionalKeyValues:kt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Re}),I("endobj"),M.objectNumber=hr(),I("<< /ShadingType "+M.type),I("/ColorSpace /DeviceRGB");var mr="/Coords ["+L(parseFloat(M.coords[0]))+" "+L(parseFloat(M.coords[1]))+" ";M.type===2?mr+=L(parseFloat(M.coords[2]))+" "+L(parseFloat(M.coords[3])):mr+=L(parseFloat(M.coords[2]))+" "+L(parseFloat(M.coords[3]))+" "+L(parseFloat(M.coords[4]))+" "+L(parseFloat(M.coords[5])),I(mr+="]"),M.matrix&&I("/Matrix ["+M.matrix.toString()+"]"),I("/Function "+Re+" 0 R"),I("/Extend [true true]"),I(">>"),I("endobj")},ht=function(M,oe){var Re=Tr(),Je=hr();oe.push({resourcesOid:Re,objectOid:Je}),M.objectNumber=Je;var kt=[];kt.push({key:"Type",value:"/Pattern"}),kt.push({key:"PatternType",value:"1"}),kt.push({key:"PaintType",value:"1"}),kt.push({key:"TilingType",value:"1"}),kt.push({key:"BBox",value:"["+M.boundingBox.map(L).join(" ")+"]"}),kt.push({key:"XStep",value:L(M.xStep)}),kt.push({key:"YStep",value:L(M.yStep)}),kt.push({key:"Resources",value:Re+" 0 R"}),M.matrix&&kt.push({key:"Matrix",value:"["+M.matrix.toString()+"]"}),Qe({data:M.stream,additionalKeyValues:kt,objectId:M.objectNumber}),I("endobj")},Ut=function(M){for(var oe in M.objectNumber=hr(),I("<<"),M)switch(oe){case"opacity":I("/ca "+E(M[oe]));break;case"stroke-opacity":I("/CA "+E(M[oe]))}I(">>"),I("endobj")},Gt=function(M){ne(M.resourcesOid,!0),I("<<"),I("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var oe in I("/Font <<"),mt)mt.hasOwnProperty(oe)&&(f===!1||f===!0&&h.hasOwnProperty(oe))&&I("/"+oe+" "+mt[oe].objectNumber+" 0 R");I(">>")}(),function(){if(Object.keys(bt).length>0){for(var oe in I("/Shading <<"),bt)bt.hasOwnProperty(oe)&&bt[oe]instanceof Wh&&bt[oe].objectNumber>=0&&I("/"+oe+" "+bt[oe].objectNumber+" 0 R");Vr.publish("putShadingPatternDict"),I(">>")}}(),function(oe){if(Object.keys(bt).length>0){for(var Re in I("/Pattern <<"),bt)bt.hasOwnProperty(Re)&&bt[Re]instanceof p.TilingPattern&&bt[Re].objectNumber>=0&&bt[Re].objectNumber<oe&&I("/"+Re+" "+bt[Re].objectNumber+" 0 R");Vr.publish("putTilingPatternDict"),I(">>")}}(M.objectOid),function(){if(Object.keys(Tt).length>0){var oe;for(oe in I("/ExtGState <<"),Tt)Tt.hasOwnProperty(oe)&&Tt[oe].objectNumber>=0&&I("/"+oe+" "+Tt[oe].objectNumber+" 0 R");Vr.publish("putGStateDict"),I(">>")}}(),function(){for(var oe in I("/XObject <<"),Yr)Yr.hasOwnProperty(oe)&&Yr[oe].objectNumber>=0&&I("/"+oe+" "+Yr[oe].objectNumber+" 0 R");Vr.publish("putXobjectDict"),I(">>")}(),I(">>"),I("endobj")},cr=function(M){wt[M.fontName]=wt[M.fontName]||{},wt[M.fontName][M.fontStyle]=M.id},ir=function(M,oe,Re,Je,kt){var mr={id:"F"+(Object.keys(mt).length+1).toString(10),postScriptName:M,fontName:oe,fontStyle:Re,encoding:Je,isStandardFont:kt||!1,metadata:{}};return Vr.publish("addFont",{font:mr,instance:this}),mt[mr.id]=mr,cr(mr),mr.id},Fr=p.__private__.pdfEscape=p.pdfEscape=function(M,oe){return function(Re,Je){var kt,mr,lr,Sr,Hr,Jr,me,Pe,et;if(lr=(Je=Je||{}).sourceEncoding||"Unicode",Hr=Je.outputEncoding,(Je.autoencode||Hr)&&mt[be].metadata&&mt[be].metadata[lr]&&mt[be].metadata[lr].encoding&&(Sr=mt[be].metadata[lr].encoding,!Hr&&mt[be].encoding&&(Hr=mt[be].encoding),!Hr&&Sr.codePages&&(Hr=Sr.codePages[0]),typeof Hr=="string"&&(Hr=Sr[Hr]),Hr)){for(me=!1,Jr=[],kt=0,mr=Re.length;kt<mr;kt++)(Pe=Hr[Re.charCodeAt(kt)])?Jr.push(String.fromCharCode(Pe)):Jr.push(Re[kt]),Jr[kt].charCodeAt(0)>>8&&(me=!0);Re=Jr.join("")}for(kt=Re.length;me===void 0&&kt!==0;)Re.charCodeAt(kt-1)>>8&&(me=!0),kt--;if(!me)return Re;for(Jr=Je.noBOM?[]:[254,255],kt=0,mr=Re.length;kt<mr;kt++){if((et=(Pe=Re.charCodeAt(kt))>>8)>>8)throw new Error("Character at position "+kt+" of string '"+Re+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Jr.push(et),Jr.push(Pe-(et<<8))}return String.fromCharCode.apply(void 0,Jr)}(M,oe).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},dn=p.__private__.beginPage=function(M){le[++Xr]=[],Br[Xr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(M[0]),topRightY:Number(M[1])}},Gr(Xr),ae(le[K])},vr=function(M,oe){var Re,Je,kt;switch(r=oe||r,typeof M=="string"&&(Re=b(M.toLowerCase()),Array.isArray(Re)&&(Je=Re[0],kt=Re[1])),Array.isArray(M)&&(Je=M[0]*fe,kt=M[1]*fe),isNaN(Je)&&(Je=i[0],kt=i[1]),(Je>14400||kt>14400)&&(ta.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Je=Math.min(14400,Je),kt=Math.min(14400,kt)),i=[Je,kt],r.substr(0,1)){case"l":kt>Je&&(i=[kt,Je]);break;case"p":Je>kt&&(i=[kt,Je])}dn(i),xt(tt),I(Be),en!==0&&I(en+" J"),vn!==0&&I(vn+" j"),Vr.publish("addPage",{pageNumber:Xr})},Lt=function(M){M>0&&M<=Xr&&(le.splice(M,1),Br.splice(M,1),Xr--,K>Xr&&(K=Xr),this.setPage(K))},Gr=function(M){M>0&&M<=Xr&&(K=M)},bn=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return le.length-1},or=function(M,oe,Re){var Je,kt=void 0;return Re=Re||{},M=M!==void 0?M:mt[be].fontName,oe=oe!==void 0?oe:mt[be].fontStyle,Je=M.toLowerCase(),wt[Je]!==void 0&&wt[Je][oe]!==void 0?kt=wt[Je][oe]:wt[M]!==void 0&&wt[M][oe]!==void 0?kt=wt[M][oe]:Re.disableWarning===!1&&ta.warn("Unable to look up font label for font '"+M+"', '"+oe+"'. Refer to getFontList() for available fonts."),kt||Re.noFallback||(kt=wt.times[oe])==null&&(kt=wt.times.normal),kt},kr=p.__private__.putInfo=function(){var M=hr(),oe=function(Je){return Je};for(var Re in d!==null&&(oe=Ge.encryptor(M,0)),I("<<"),I("/Producer ("+Fr(oe("jsPDF "+Un.version))+")"),Ne)Ne.hasOwnProperty(Re)&&Ne[Re]&&I("/"+Re.substr(0,1).toUpperCase()+Re.substr(1)+" ("+Fr(oe(Ne[Re]))+")");I("/CreationDate ("+Fr(oe(z))+")"),I(">>"),I("endobj")},Mr=p.__private__.putCatalog=function(M){var oe=(M=M||{}).rootDictionaryObjId||te;switch(hr(),I("<<"),I("/Type /Catalog"),I("/Pages "+oe+" 0 R"),ke||(ke="fullwidth"),ke){case"fullwidth":I("/OpenAction [3 0 R /FitH null]");break;case"fullheight":I("/OpenAction [3 0 R /FitV null]");break;case"fullpage":I("/OpenAction [3 0 R /Fit]");break;case"original":I("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Re=""+ke;Re.substr(Re.length-1)==="%"&&(ke=parseInt(ke)/100),typeof ke=="number"&&I("/OpenAction [3 0 R /XYZ null null "+E(ke)+"]")}switch(_t||(_t="continuous"),_t){case"continuous":I("/PageLayout /OneColumn");break;case"single":I("/PageLayout /SinglePage");break;case"two":case"twoleft":I("/PageLayout /TwoColumnLeft");break;case"tworight":I("/PageLayout /TwoColumnRight")}We&&I("/PageMode /"+We),Vr.publish("putCatalog"),I(">>"),I("endobj")},Ar=p.__private__.putTrailer=function(){I("trailer"),I("<<"),I("/Size "+(J+1)),I("/Root "+J+" 0 R"),I("/Info "+(J-1)+" 0 R"),d!==null&&I("/Encrypt "+Ge.oid+" 0 R"),I("/ID [ <"+se+"> <"+se+"> ]"),I(">>")},Zt=p.__private__.putHeader=function(){I("%PDF-"+m),I("%")},Kt=p.__private__.putXRef=function(){var M="0000000000";I("xref"),I("0 "+(J+1)),I("0000000000 65535 f ");for(var oe=1;oe<=J;oe++)typeof q[oe]=="function"?I((M+q[oe]()).slice(-10)+" 00000 n "):q[oe]!==void 0?I((M+q[oe]).slice(-10)+" 00000 n "):I("0000000000 00000 n ")},it=p.__private__.buildDocument=function(){var M;J=0,Q=0,Y=[],q=[],ie=[],te=Tr(),ue=Tr(),ae(Y),Vr.publish("buildDocument"),Zt(),$e(),function(){Vr.publish("putAdditionalObjects");for(var Re=0;Re<ie.length;Re++){var Je=ie[Re];ne(Je.objId,!0),I(Je.content),I("endobj")}Vr.publish("postPutAdditionalObjects")}(),M=[],function(){for(var Re in mt)mt.hasOwnProperty(Re)&&(f===!1||f===!0&&h.hasOwnProperty(Re))&&st(mt[Re])}(),function(){var Re;for(Re in Tt)Tt.hasOwnProperty(Re)&&Ut(Tt[Re])}(),function(){for(var Re in Yr)Yr.hasOwnProperty(Re)&&Wt(Yr[Re])}(),function(Re){var Je;for(Je in bt)bt.hasOwnProperty(Je)&&(bt[Je]instanceof Wh?qt(bt[Je]):bt[Je]instanceof tm&&ht(bt[Je],Re))}(M),Vr.publish("putResources"),M.forEach(Gt),Gt({resourcesOid:ue,objectOid:Number.MAX_SAFE_INTEGER}),Vr.publish("postPutResources"),d!==null&&(Ge.oid=hr(),I("<<"),I("/Filter /Standard"),I("/V "+Ge.v),I("/R "+Ge.r),I("/U <"+Ge.toHexString(Ge.U)+">"),I("/O <"+Ge.toHexString(Ge.O)+">"),I("/P "+Ge.P),I(">>"),I("endobj")),kr(),Mr();var oe=Q;return Kt(),Ar(),I("startxref"),I(""+oe),I("%%EOF"),ae(le[K]),Y.join(`
`)},At=p.__private__.getBlob=function(M){return new Blob([pe(M)],{type:"application/pdf"})},Mt=p.output=p.__private__.output=(er=function(M,oe){switch(typeof(oe=oe||{})=="string"?oe={filename:oe}:oe.filename=oe.filename||"generated.pdf",M){case void 0:return it();case"save":p.save(oe.filename);break;case"arraybuffer":return pe(it());case"blob":return At(it());case"bloburi":case"bloburl":if(Qn.URL!==void 0&&typeof Qn.URL.createObjectURL=="function")return Qn.URL&&Qn.URL.createObjectURL(At(it()))||void 0;ta.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Re="",Je=it();try{Re=rM(Je)}catch{Re=rM(unescape(encodeURIComponent(Je)))}return"data:application/pdf;filename="+oe.filename+";base64,"+Re;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Qn)==="[object Window]"){var kt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",mr=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';oe.pdfObjectUrl&&(kt=oe.pdfObjectUrl,mr="");var lr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+kt+'"'+mr+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(oe)+");<\/script></body></html>",Sr=Qn.open();return Sr!==null&&Sr.document.write(lr),Sr}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Qn)==="[object Window]"){var Hr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(oe.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+oe.filename+'" width="500px" height="400px" /></body></html>',Jr=Qn.open();if(Jr!==null){Jr.document.write(Hr);var me=this;Jr.document.documentElement.querySelector("#pdfViewer").onload=function(){Jr.document.title=oe.filename,Jr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(me.output("bloburl"))}}return Jr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Qn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Pe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",oe)+'"></iframe></body></html>',et=Qn.open();if(et!==null&&(et.document.write(Pe),et.document.title=oe.filename),et||typeof safari>"u")return et;break;case"datauri":case"dataurl":return Qn.document.location.href=this.output("datauristring",oe);default:return null}},er.foo=function(){try{return er.apply(this,arguments)}catch(Re){var M=Re.stack||"";~M.indexOf(" at ")&&(M=M.split(" at ")[1]);var oe="Error in function "+M.split(`
`)[0].split("<")[0]+": "+Re.message;if(!Qn.console)throw new Error(oe);Qn.console.error(oe,Re),Qn.alert&&alert(oe)}},er.foo.bar=er,er.foo),ar=function(M){return Array.isArray(An)===!0&&An.indexOf(M)>-1};switch(n){case"pt":fe=1;break;case"mm":fe=72/25.4;break;case"cm":fe=72/2.54;break;case"in":fe=72;break;case"px":fe=ar("px_scaling")==1?.75:96/72;break;case"pc":case"em":fe=12;break;case"ex":fe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);fe=n}var Ge=null;X(),U();var Rt=p.__private__.getPageInfo=p.getPageInfo=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Br[M].objId,pageNumber:M,pageContext:Br[M]}},Ze=p.__private__.getPageInfoByObjId=function(M){if(isNaN(M)||M%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var oe in Br)if(Br[oe].objId===M)break;return Rt(oe)},ot=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:Br[K].objId,pageNumber:K,pageContext:Br[K]}};p.addPage=function(){return vr.apply(this,arguments),this},p.setPage=function(){return Gr.apply(this,arguments),ae.call(this,le[K]),this},p.insertPage=function(M){return this.addPage(),this.movePage(K,M),this},p.movePage=function(M,oe){var Re,Je;if(M>oe){Re=le[M],Je=Br[M];for(var kt=M;kt>oe;kt--)le[kt]=le[kt-1],Br[kt]=Br[kt-1];le[oe]=Re,Br[oe]=Je,this.setPage(oe)}else if(M<oe){Re=le[M],Je=Br[M];for(var mr=M;mr<oe;mr++)le[mr]=le[mr+1],Br[mr]=Br[mr+1];le[oe]=Re,Br[oe]=Je,this.setPage(oe)}return this},p.deletePage=function(){return Lt.apply(this,arguments),this},p.__private__.text=p.text=function(M,oe,Re,Je,kt){var mr,lr,Sr,Hr,Jr,me,Pe,et,xe,ze=(Je=Je||{}).scope||this;if(typeof M=="number"&&typeof oe=="number"&&(typeof Re=="string"||Array.isArray(Re))){var Vt=Re;Re=oe,oe=M,M=Vt}if(arguments[3]instanceof Ce==0?(Sr=arguments[4],Hr=arguments[5],zi(Pe=arguments[3])==="object"&&Pe!==null||(typeof Sr=="string"&&(Hr=Sr,Sr=null),typeof Pe=="string"&&(Hr=Pe,Pe=null),typeof Pe=="number"&&(Sr=Pe,Pe=null),Je={flags:Pe,angle:Sr,align:Hr})):(P("The transform parameter of text() with a Matrix value"),xe=kt),isNaN(oe)||isNaN(Re)||M==null)throw new Error("Invalid arguments passed to jsPDF.text");if(M.length===0)return ze;var Nt,br="",wr=typeof Je.lineHeightFactor=="number"?Je.lineHeightFactor:Ie,zr=ze.internal.scaleFactor;function Wr(Li){return Li=Li.split("	").join(Array(Je.TabLen||9).join(" ")),Fr(Li,Pe)}function sn(Li){for(var Ji,Xa=Li.concat(),Ss=[],gd=Xa.length;gd--;)typeof(Ji=Xa.shift())=="string"?Ss.push(Ji):Array.isArray(Li)&&(Ji.length===1||Ji[1]===void 0&&Ji[2]===void 0)?Ss.push(Ji[0]):Ss.push([Ji[0],Ji[1],Ji[2]]);return Ss}function an(Li,Ji){var Xa;if(typeof Li=="string")Xa=Ji(Li)[0];else if(Array.isArray(Li)){for(var Ss,gd,jg=Li.concat(),up=[],Uy=jg.length;Uy--;)typeof(Ss=jg.shift())=="string"?up.push(Ji(Ss)[0]):Array.isArray(Ss)&&typeof Ss[0]=="string"&&(gd=Ji(Ss[0],Ss[1],Ss[2]),up.push([gd[0],gd[1],gd[2]]));Xa=up}return Xa}var Lr=!1,mn=!0;if(typeof M=="string")Lr=!0;else if(Array.isArray(M)){var cn=M.concat();lr=[];for(var xn,Ir=cn.length;Ir--;)(typeof(xn=cn.shift())!="string"||Array.isArray(xn)&&typeof xn[0]!="string")&&(mn=!1);Lr=mn}if(Lr===!1)throw new Error('Type of text must be string or Array. "'+M+'" is not recognized.');typeof M=="string"&&(M=M.match(/[\r?\n]/)?M.split(/\r\n|\r|\n/g):[M]);var jn=Ae/ze.internal.scaleFactor,Hn=jn*(wr-1);switch(Je.baseline){case"bottom":Re-=Hn;break;case"top":Re+=jn-Hn;break;case"hanging":Re+=jn-2*Hn;break;case"middle":Re+=jn/2-Hn}if((me=Je.maxWidth||0)>0&&(typeof M=="string"?M=ze.splitTextToSize(M,me):Object.prototype.toString.call(M)==="[object Array]"&&(M=M.reduce(function(Li,Ji){return Li.concat(ze.splitTextToSize(Ji,me))},[]))),mr={text:M,x:oe,y:Re,options:Je,mutex:{pdfEscape:Fr,activeFontKey:be,fonts:mt,activeFontSize:Ae}},Vr.publish("preProcessText",mr),M=mr.text,Sr=(Je=mr.options).angle,xe instanceof Ce==0&&Sr&&typeof Sr=="number"){Sr*=Math.PI/180,Je.rotationDirection===0&&(Sr=-Sr),S===w&&(Sr=-Sr);var Mn=Math.cos(Sr),Kn=Math.sin(Sr);xe=new Ce(Mn,Kn,-Kn,Mn,0,0)}else Sr&&Sr instanceof Ce&&(xe=Sr);S!==w||xe||(xe=ft),(Jr=Je.charSpace||Rr)!==void 0&&(br+=L(F(Jr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(et=Je.horizontalScale)!==void 0&&(br+=L(100*et)+` Tz
`),Je.lang;var Fn=-1,Xi=Je.renderingMode!==void 0?Je.renderingMode:Je.stroke,zo=ze.internal.getCurrentPageInfo().pageContext;switch(Xi){case 0:case!1:case"fill":Fn=0;break;case 1:case!0:case"stroke":Fn=1;break;case 2:case"fillThenStroke":Fn=2;break;case 3:case"invisible":Fn=3;break;case 4:case"fillAndAddForClipping":Fn=4;break;case 5:case"strokeAndAddPathForClipping":Fn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Fn=6;break;case 7:case"addToPathForClipping":Fn=7}var Ol=zo.usedRenderingMode!==void 0?zo.usedRenderingMode:-1;Fn!==-1?br+=Fn+` Tr
`:Ol!==-1&&(br+=`0 Tr
`),Fn!==-1&&(zo.usedRenderingMode=Fn),Hr=Je.align||"left";var Ya,Wo=Ae*wr,Ml=ze.internal.pageSize.getWidth(),dl=mt[be];Jr=Je.charSpace||Rr,me=Je.maxWidth||0,Pe=Object.assign({autoencode:!0,noBOM:!0},Je.flags);var xa=[],oa=function(Li){return ze.getStringUnitWidth(Li,{font:dl,charSpace:Jr,fontSize:Ae,doKerning:!1})*Ae/zr};if(Object.prototype.toString.call(M)==="[object Array]"){var la;lr=sn(M),Hr!=="left"&&(Ya=lr.map(oa));var ya,qo=0;if(Hr==="right"){oe-=Ya[0],M=[],Ir=lr.length;for(var gi=0;gi<Ir;gi++)gi===0?(ya=Ht(oe),la=Ue(Re)):(ya=F(qo-Ya[gi]),la=-Wo),M.push([lr[gi],ya,la]),qo=Ya[gi]}else if(Hr==="center"){oe-=Ya[0]/2,M=[],Ir=lr.length;for(var Js=0;Js<Ir;Js++)Js===0?(ya=Ht(oe),la=Ue(Re)):(ya=F((qo-Ya[Js])/2),la=-Wo),M.push([lr[Js],ya,la]),qo=Ya[Js]}else if(Hr==="left"){M=[],Ir=lr.length;for(var uc=0;uc<Ir;uc++)M.push(lr[uc])}else if(Hr==="justify"&&dl.encoding==="Identity-H"){M=[],Ir=lr.length,me=me!==0?me:Ml;for(var dc=0,ki=0;ki<Ir;ki++)if(la=ki===0?Ue(Re):-Wo,ya=ki===0?Ht(oe):dc,ki<Ir-1){var Ei=F((me-Ya[ki])/(lr[ki].split(" ").length-1)),Qi=lr[ki].split(" ");M.push([Qi[0]+" ",ya,la]),dc=0;for(var yo=1;yo<Qi.length;yo++){var pd=(oa(Qi[yo-1]+" "+Qi[yo])-oa(Qi[yo]))*zr+Ei;yo==Qi.length-1?M.push([Qi[yo],pd,0]):M.push([Qi[yo]+" ",pd,0]),dc-=pd}}else M.push([lr[ki],ya,la]);M.push(["",dc,0])}else{if(Hr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(M=[],Ir=lr.length,me=me!==0?me:Ml,ki=0;ki<Ir;ki++){la=ki===0?Ue(Re):-Wo,ya=ki===0?Ht(oe):0;var md=lr[ki].split(" ").length-1,ku=md>0?(me-Ya[ki])/md:0;ki<Ir-1?xa.push(L(F(ku))):xa.push(0),M.push([lr[ki],ya,la])}}}(typeof Je.R2L=="boolean"?Je.R2L:De)===!0&&(M=an(M,function(Li,Ji,Xa){return[Li.split("").reverse().join(""),Ji,Xa]})),mr={text:M,x:oe,y:Re,options:Je,mutex:{pdfEscape:Fr,activeFontKey:be,fonts:mt,activeFontSize:Ae}},Vr.publish("postProcessText",mr),M=mr.text,Nt=mr.mutex.isHex||!1;var yf=mt[be].encoding;yf!=="WinAnsiEncoding"&&yf!=="StandardEncoding"||(M=an(M,function(Li,Ji,Xa){return[Wr(Li),Ji,Xa]})),lr=sn(M),M=[];for(var Gc,fc,hc,ju=Array.isArray(lr[0])?1:0,Kc="",Au=function(Li,Ji,Xa){var Ss="";return Xa instanceof Ce?(Xa=typeof Je.angle=="number"?It(Xa,new Ce(1,0,0,1,Li,Ji)):It(new Ce(1,0,0,1,Li,Ji),Xa),S===w&&(Xa=It(new Ce(1,0,0,-1,0,0),Xa)),Ss=Xa.join(" ")+` Tm
`):Ss=L(Li)+" "+L(Ji)+` Td
`,Ss},pc=0;pc<lr.length;pc++){switch(Kc="",ju){case 1:hc=(Nt?"<":"(")+lr[pc][0]+(Nt?">":")"),Gc=parseFloat(lr[pc][1]),fc=parseFloat(lr[pc][2]);break;case 0:hc=(Nt?"<":"(")+lr[pc]+(Nt?">":")"),Gc=Ht(oe),fc=Ue(Re)}xa!==void 0&&xa[pc]!==void 0&&(Kc=xa[pc]+` Tw
`),pc===0?M.push(Kc+Au(Gc,fc,xe)+hc):ju===0?M.push(Kc+hc):ju===1&&M.push(Kc+Au(Gc,fc,xe)+hc)}M=ju===0?M.join(` Tj
T* `):M.join(` Tj
`),M+=` Tj
`;var Nu=`BT
/`;return Nu+=be+" "+Ae+` Tf
`,Nu+=L(Ae*wr)+` TL
`,Nu+=jt+`
`,Nu+=br,Nu+=M,I(Nu+="ET"),h[be]=!0,ze};var Bt=p.__private__.clip=p.clip=function(M){return I(M==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Bt("evenodd")},p.__private__.discardPath=p.discardPath=function(){return I("n"),this};var Qt=p.__private__.isValidStyle=function(M){var oe=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(M)!==-1&&(oe=!0),oe};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(M){return Qt(M)&&(u=M),this};var Yt=p.__private__.getStyle=p.getStyle=function(M){var oe=u;switch(M){case"D":case"S":oe="S";break;case"F":oe="f";break;case"FD":case"DF":oe="B";break;case"f":case"f*":case"B":case"B*":oe=M}return oe},fr=p.close=function(){return I("h"),this};p.stroke=function(){return I("S"),this},p.fill=function(M){return Dt("f",M),this},p.fillEvenOdd=function(M){return Dt("f*",M),this},p.fillStroke=function(M){return Dt("B",M),this},p.fillStrokeEvenOdd=function(M){return Dt("B*",M),this};var Dt=function(M,oe){zi(oe)==="object"?zt(oe,M):I(M)},ur=function(M){M===null||S===w&&M===void 0||(M=Yt(M),I(M))};function Ve(M,oe,Re,Je,kt){var mr=new tm(oe||this.boundingBox,Re||this.xStep,Je||this.yStep,this.gState,kt||this.matrix);mr.stream=this.stream;var lr=M+"$$"+this.cloneIndex+++"$$";return Ot(lr,mr),mr}var zt=function(M,oe){var Re=qr[M.key],Je=bt[Re];if(Je instanceof Wh)I("q"),I(yt(oe)),Je.gState&&p.setGState(Je.gState),I(M.matrix.toString()+" cm"),I("/"+Re+" sh"),I("Q");else if(Je instanceof tm){var kt=new Ce(1,0,0,-1,0,kn());M.matrix&&(kt=kt.multiply(M.matrix||ft),Re=Ve.call(Je,M.key,M.boundingBox,M.xStep,M.yStep,kt).id),I("q"),I("/Pattern cs"),I("/"+Re+" scn"),Je.gState&&p.setGState(Je.gState),I(oe),I("Q")}},yt=function(M){switch(M){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},St=p.moveTo=function(M,oe){return I(L(F(M))+" "+L(W(oe))+" m"),this},sr=p.lineTo=function(M,oe){return I(L(F(M))+" "+L(W(oe))+" l"),this},pr=p.curveTo=function(M,oe,Re,Je,kt,mr){return I([L(F(M)),L(W(oe)),L(F(Re)),L(W(Je)),L(F(kt)),L(W(mr)),"c"].join(" ")),this};p.__private__.line=p.line=function(M,oe,Re,Je,kt){if(isNaN(M)||isNaN(oe)||isNaN(Re)||isNaN(Je)||!Qt(kt))throw new Error("Invalid arguments passed to jsPDF.line");return S===v?this.lines([[Re-M,Je-oe]],M,oe,[1,1],kt||"S"):this.lines([[Re-M,Je-oe]],M,oe,[1,1]).stroke()},p.__private__.lines=p.lines=function(M,oe,Re,Je,kt,mr){var lr,Sr,Hr,Jr,me,Pe,et,xe,ze,Vt,Nt,br;if(typeof M=="number"&&(br=Re,Re=oe,oe=M,M=br),Je=Je||[1,1],mr=mr||!1,isNaN(oe)||isNaN(Re)||!Array.isArray(M)||!Array.isArray(Je)||!Qt(kt)||typeof mr!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(St(oe,Re),lr=Je[0],Sr=Je[1],Jr=M.length,Vt=oe,Nt=Re,Hr=0;Hr<Jr;Hr++)(me=M[Hr]).length===2?(Vt=me[0]*lr+Vt,Nt=me[1]*Sr+Nt,sr(Vt,Nt)):(Pe=me[0]*lr+Vt,et=me[1]*Sr+Nt,xe=me[2]*lr+Vt,ze=me[3]*Sr+Nt,Vt=me[4]*lr+Vt,Nt=me[5]*Sr+Nt,pr(Pe,et,xe,ze,Vt,Nt));return mr&&fr(),ur(kt),this},p.path=function(M){for(var oe=0;oe<M.length;oe++){var Re=M[oe],Je=Re.c;switch(Re.op){case"m":St(Je[0],Je[1]);break;case"l":sr(Je[0],Je[1]);break;case"c":pr.apply(this,Je);break;case"h":fr()}}return this},p.__private__.rect=p.rect=function(M,oe,Re,Je,kt){if(isNaN(M)||isNaN(oe)||isNaN(Re)||isNaN(Je)||!Qt(kt))throw new Error("Invalid arguments passed to jsPDF.rect");return S===v&&(Je=-Je),I([L(F(M)),L(W(oe)),L(F(Re)),L(F(Je)),"re"].join(" ")),ur(kt),this},p.__private__.triangle=p.triangle=function(M,oe,Re,Je,kt,mr,lr){if(isNaN(M)||isNaN(oe)||isNaN(Re)||isNaN(Je)||isNaN(kt)||isNaN(mr)||!Qt(lr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Re-M,Je-oe],[kt-Re,mr-Je],[M-kt,oe-mr]],M,oe,[1,1],lr,!0),this},p.__private__.roundedRect=p.roundedRect=function(M,oe,Re,Je,kt,mr,lr){if(isNaN(M)||isNaN(oe)||isNaN(Re)||isNaN(Je)||isNaN(kt)||isNaN(mr)||!Qt(lr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Sr=4/3*(Math.SQRT2-1);return kt=Math.min(kt,.5*Re),mr=Math.min(mr,.5*Je),this.lines([[Re-2*kt,0],[kt*Sr,0,kt,mr-mr*Sr,kt,mr],[0,Je-2*mr],[0,mr*Sr,-kt*Sr,mr,-kt,mr],[2*kt-Re,0],[-kt*Sr,0,-kt,-mr*Sr,-kt,-mr],[0,2*mr-Je],[0,-mr*Sr,kt*Sr,-mr,kt,-mr]],M+kt,oe,[1,1],lr,!0),this},p.__private__.ellipse=p.ellipse=function(M,oe,Re,Je,kt){if(isNaN(M)||isNaN(oe)||isNaN(Re)||isNaN(Je)||!Qt(kt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var mr=4/3*(Math.SQRT2-1)*Re,lr=4/3*(Math.SQRT2-1)*Je;return St(M+Re,oe),pr(M+Re,oe-lr,M+mr,oe-Je,M,oe-Je),pr(M-mr,oe-Je,M-Re,oe-lr,M-Re,oe),pr(M-Re,oe+lr,M-mr,oe+Je,M,oe+Je),pr(M+mr,oe+Je,M+Re,oe+lr,M+Re,oe),ur(kt),this},p.__private__.circle=p.circle=function(M,oe,Re,Je){if(isNaN(M)||isNaN(oe)||isNaN(Re)||!Qt(Je))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(M,oe,Re,Re,Je)},p.setFont=function(M,oe,Re){return Re&&(oe=A(oe,Re)),be=or(M,oe,{disableWarning:!1}),this};var we=p.__private__.getFont=p.getFont=function(){return mt[or.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var M,oe,Re={};for(M in wt)if(wt.hasOwnProperty(M))for(oe in Re[M]=[],wt[M])wt[M].hasOwnProperty(oe)&&Re[M].push(oe);return Re},p.addFont=function(M,oe,Re,Je,kt){var mr=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&mr.indexOf(arguments[3])!==-1?kt=arguments[3]:arguments[3]&&mr.indexOf(arguments[3])==-1&&(Re=A(Re,Je)),ir.call(this,M,oe,Re,kt=kt||"Identity-H")};var Ie,tt=e.lineWidth||.200025,dt=p.__private__.getLineWidth=p.getLineWidth=function(){return tt},xt=p.__private__.setLineWidth=p.setLineWidth=function(M){return tt=M,I(L(F(M))+" w"),this};p.__private__.setLineDash=Un.API.setLineDash=Un.API.setLineDashPattern=function(M,oe){if(M=M||[],oe=oe||0,isNaN(oe)||!Array.isArray(M))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return M=M.map(function(Re){return L(F(Re))}).join(" "),oe=L(F(oe)),I("["+M+"] "+oe+" d"),this};var Cr=p.__private__.getLineHeight=p.getLineHeight=function(){return Ae*Ie};p.__private__.getLineHeight=p.getLineHeight=function(){return Ae*Ie};var nn=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(M){return typeof(M=M||1.15)=="number"&&(Ie=M),this},ct=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return Ie};nn(e.lineHeight);var Ht=p.__private__.getHorizontalCoordinate=function(M){return F(M)},Ue=p.__private__.getVerticalCoordinate=function(M){return S===w?M:Br[K].mediaBox.topRightY-Br[K].mediaBox.bottomLeftY-F(M)},qe=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(M){return L(Ht(M))},at=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(M){return L(Ue(M))},Be=e.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Ee(Be)},p.__private__.setStrokeColor=p.setDrawColor=function(M,oe,Re,Je){return Be=je({ch1:M,ch2:oe,ch3:Re,ch4:Je,pdfColorType:"draw",precision:2}),I(Be),this};var vt=e.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Ee(vt)},p.__private__.setFillColor=p.setFillColor=function(M,oe,Re,Je){return vt=je({ch1:M,ch2:oe,ch3:Re,ch4:Je,pdfColorType:"fill",precision:2}),I(vt),this};var jt=e.textColor||"0 g",$t=p.__private__.getTextColor=p.getTextColor=function(){return Ee(jt)};p.__private__.setTextColor=p.setTextColor=function(M,oe,Re,Je){return jt=je({ch1:M,ch2:oe,ch3:Re,ch4:Je,pdfColorType:"text",precision:3}),this};var Rr=e.charSpace,Ur=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Rr||0)};p.__private__.setCharSpace=p.setCharSpace=function(M){if(isNaN(M))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Rr=M,this};var en=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(M){var oe=p.CapJoinStyles[M];if(oe===void 0)throw new Error("Line cap style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return en=oe,I(oe+" J"),this};var vn=0;p.__private__.setLineJoin=p.setLineJoin=function(M){var oe=p.CapJoinStyles[M];if(oe===void 0)throw new Error("Line join style of '"+M+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return vn=oe,I(oe+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(M){if(M=M||0,isNaN(M))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return I(L(F(M))+" M"),this},p.GState=Q2,p.setGState=function(M){(M=typeof M=="string"?Tt[xr[M]]:Nr(null,M)).equals(Zr)||(I("/"+M.id+" gs"),Zr=M)};var Nr=function(M,oe){if(!M||!xr[M]){var Re=!1;for(var Je in Tt)if(Tt.hasOwnProperty(Je)&&Tt[Je].equals(oe)){Re=!0;break}if(Re)oe=Tt[Je];else{var kt="GS"+(Object.keys(Tt).length+1).toString(10);Tt[kt]=oe,oe.id=kt}return M&&(xr[M]=oe.id),Vr.publish("addGState",oe),oe}};p.addGState=function(M,oe){return Nr(M,oe),this},p.saveGraphicsState=function(){return I("q"),Pt.push({key:be,size:Ae,color:jt}),this},p.restoreGraphicsState=function(){I("Q");var M=Pt.pop();return be=M.key,Ae=M.size,jt=M.color,Zr=null,this},p.setCurrentTransformationMatrix=function(M){return I(M.toString()+" cm"),this},p.comment=function(M){return I("#"+M),this};var fn=function(M,oe){var Re=M||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Re},set:function(mr){isNaN(mr)||(Re=parseFloat(mr))}});var Je=oe||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Je},set:function(mr){isNaN(mr)||(Je=parseFloat(mr))}});var kt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return kt},set:function(mr){kt=mr.toString()}}),this},rr=function(M,oe,Re,Je){fn.call(this,M,oe),this.type="rect";var kt=Re||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return kt},set:function(lr){isNaN(lr)||(kt=parseFloat(lr))}});var mr=Je||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return mr},set:function(lr){isNaN(lr)||(mr=parseFloat(lr))}}),this},ve=function(){this.page=Xr,this.currentPage=K,this.pages=le.slice(0),this.pagesContext=Br.slice(0),this.x=ge,this.y=lt,this.matrix=He,this.width=pt(K),this.height=Kr(K),this.outputDestination=H,this.id="",this.objectNumber=-1};ve.prototype.restore=function(){Xr=this.page,K=this.currentPage,Br=this.pagesContext,le=this.pages,ge=this.x,lt=this.y,He=this.matrix,Pr(K,this.width),pn(K,this.height),H=this.outputDestination};var rt=function(M,oe,Re,Je,kt){Me.push(new ve),Xr=K=0,le=[],ge=M,lt=oe,He=kt,dn([Re,Je])};for(var ut in p.beginFormObject=function(M,oe,Re,Je,kt){return rt(M,oe,Re,Je,kt),this},p.endFormObject=function(M){return function(oe){if(Ln[oe])Me.pop().restore();else{var Re=new ve,Je="Xo"+(Object.keys(Yr).length+1).toString(10);Re.id=Je,Ln[oe]=Je,Yr[Je]=Re,Vr.publish("addFormObject",Re),Me.pop().restore()}}(M),this},p.doFormObject=function(M,oe){var Re=Yr[Ln[M]];return I("q"),I(oe.toString()+" cm"),I("/"+Re.id+" Do"),I("Q"),this},p.getFormObject=function(M){var oe=Yr[Ln[M]];return{x:oe.x,y:oe.y,width:oe.width,height:oe.height,matrix:oe.matrix}},p.save=function(M,oe){return M=M||"generated.pdf",(oe=oe||{}).returnPromise=oe.returnPromise||!1,oe.returnPromise===!1?(Ih(At(it()),M),typeof Ih.unload=="function"&&Qn.setTimeout&&setTimeout(Ih.unload,911),this):new Promise(function(Re,Je){try{var kt=Ih(At(it()),M);typeof Ih.unload=="function"&&Qn.setTimeout&&setTimeout(Ih.unload,911),Re(kt)}catch(mr){Je(mr.message)}})},Un.API)Un.API.hasOwnProperty(ut)&&(ut==="events"&&Un.API.events.length?function(M,oe){var Re,Je,kt;for(kt=oe.length-1;kt!==-1;kt--)Re=oe[kt][0],Je=oe[kt][1],M.subscribe.apply(M,[Re].concat(typeof Je=="function"?[Je]:Je))}(Vr,Un.API.events):p[ut]=Un.API[ut]);function pt(M){return Br[M].mediaBox.topRightX-Br[M].mediaBox.bottomLeftX}function Pr(M,oe){Br[M].mediaBox.topRightX=oe+Br[M].mediaBox.bottomLeftX}function Kr(M){return Br[M].mediaBox.topRightY-Br[M].mediaBox.bottomLeftY}function pn(M,oe){Br[M].mediaBox.topRightY=oe+Br[M].mediaBox.bottomLeftY}var Nn=p.getPageWidth=function(M){return pt(M=M||K)/fe},_n=p.setPageWidth=function(M,oe){Pr(M,oe*fe)},kn=p.getPageHeight=function(M){return Kr(M=M||K)/fe},Wn=p.setPageHeight=function(M,oe){pn(M,oe*fe)};return p.internal={pdfEscape:Fr,getStyle:Yt,getFont:we,getFontSize:_e,getCharSpace:Ur,getTextColor:$t,getLineHeight:Cr,getLineHeightFactor:ct,getLineWidth:dt,write:Z,getHorizontalCoordinate:Ht,getVerticalCoordinate:Ue,getCoordinateString:qe,getVerticalCoordinateString:at,collections:{},newObject:hr,newAdditionalObject:ce,newObjectDeferred:Tr,newObjectDeferredBegin:ne,getFilters:gt,putStream:Qe,events:Vr,scaleFactor:fe,pageSize:{getWidth:function(){return Nn(K)},setWidth:function(M){_n(K,M)},getHeight:function(){return kn(K)},setHeight:function(M){Wn(K,M)}},encryptionOptions:d,encryption:Ge,getEncryptor:function(M){return d!==null?Ge.encryptor(M,0):function(oe){return oe}},output:Mt,getNumberOfPages:bn,get pages(){return le},out:I,f2:E,f3:T,getPageInfo:Rt,getPageInfoByObjId:Ze,getCurrentPageInfo:ot,getPDFVersion:g,Point:fn,Rectangle:rr,Matrix:Ce,hasHotfix:ar},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return Nn(K)},set:function(M){_n(K,M)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return kn(K)},set:function(M){Wn(K,M)},enumerable:!0,configurable:!0}),(function(M){for(var oe=0,Re=Oe.length;oe<Re;oe++){var Je=ir.call(this,M[oe][0],M[oe][1],M[oe][2],Oe[oe][3],!0);f===!1&&(h[Je]=!0);var kt=M[oe][0].split("-");cr({id:Je,fontName:kt[0],fontStyle:kt[1]||""})}Vr.publish("addFonts",{fonts:mt,dictionary:wt})}).call(p,Oe),be="F1",vr(i,r),Vr.publish("initialized"),p}Bp.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Bp.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Bp.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Bp.prototype.processOwnerPassword=function(e,t){return iA(nA(t).substr(0,5),e)},Bp.prototype.encryptor=function(e,t){var r=nA(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return iA(r,n)}},Q2.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||zi(e)!==zi(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Un.API={events:[]},Un.version="4.1.0";var $a=Un.API,vC=1,rp=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xp=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},J2=function(e){return e.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(t){var r=t.charCodeAt(0).toString(16).toUpperCase();return"#"+(r.length===1?"0"+r:r)})},Zn=function(e){return e.toFixed(2)},Ef=function(e){return e.toFixed(5)};$a.__acroform__={};var Tl=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},sM=function(e){return e*vC},Uu=function(e){var t=new Mz,r=On.internal.getHeight(e)||0,n=On.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Zn(n)),Number(Zn(r))],t},wge=$a.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},Sge=$a.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},_ge=$a.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},rs=$a.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return _ge(e,t-1)},ns=$a.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return wge(e,t-1)},is=$a.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Sge(e,t-1)},kge=$a.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],s=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(i+o)||0,c.upperRight_Y=n(s)||0,[Number(Zn(c.lowerLeft_X)),Number(Zn(c.lowerLeft_Y)),Number(Zn(c.upperRight_X)),Number(Zn(c.upperRight_Y))]},jge=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=aA(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Zn(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Uu(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},aA=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(E){return E.split(`
`)}):i.map(function(E){return[E]});var s=r,o=On.internal.getHeight(e)||0;o=o<0?-o:o;var l=On.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(E,T,F){if(E+1<i.length){var W=T+" "+i[E+1][0];return Db(W,e,F).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var u,d,f=Db("3",e,s).height,h=e.multiline?o-s:(o-f)/2,p=h+=2,m=0,g=0,y=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Db(t,e,s=12).width+", FieldWidth:"+l+`
`;break}for(var b="",v=0,w=0;w<i.length;w++)if(i.hasOwnProperty(w)){var S=!1;if(i[w].length!==1&&y!==i[w].length-1){if((f+2)*(v+2)+2>o)continue e;b+=i[w][y],S=!0,g=w,w--}else{b=(b+=i[w][y]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var k=parseInt(w),j=c(k,b,s),A=w>=i.length-1;if(j&&!A){b+=" ",y=0;continue}if(j||A){if(A)g=k;else if(e.multiline&&(f+2)*(v+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(v+2)+2>o)continue e;g=k}}for(var L="",P=m;P<=g;P++){var B=i[P];if(e.multiline){if(P===g){L+=B[y]+" ",y=(y+1)%B.length;continue}if(P===m){L+=B[B.length-1]+" ";continue}}L+=B[0]+" "}switch(L=L.substr(L.length-1)==" "?L.substr(0,L.length-1):L,d=Db(L,e,s).width,e.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}t+=Zn(u)+" "+Zn(p)+` Td
`,t+="("+rp(L)+`) Tj
`,t+=-Zn(u)+` 0 Td
`,p=-(s+2),d=0,m=S?g:g+1,v++,b=""}break}return n.text=t,n.fontSize=s,n},Db=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},Age={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Nge=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Cge=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(wu.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Age)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");vC=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Lz,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&Nge(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var s=!n;for(var o in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=kge(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=On.createDefaultAppearanceStream(l),zi(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=jge(l);c.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var h in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(h)){var p=l.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var m=p[o];typeof m=="function"&&(m=m.call(i,l)),f+="/"+o+" "+m+" ",i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m)}}else typeof(m=p)=="function"&&(m=m.call(i,l)),f+="/"+o+" "+m,i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}s&&function(g,y){for(var b in g)if(g.hasOwnProperty(b)){var v=b,w=g[b];y.internal.newObjectDeferredBegin(w.objId,!0),zi(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[v]}}(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},Oz=$a.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),zi(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)==="/"?i+="/"+J2(e[s].substr(1)):(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+rp(n(e[s].toString()))+")")}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Ck=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+rp(n(e))+")"},Xu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Xu.prototype.toString=function(){return this.objId+" 0 R"},Xu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Xu.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:Oz(i,this.objId,this.scope)}):i instanceof Xu?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var Mz=function(){Xu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Tl(Mz,Xu);var Lz=function(){Xu.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+rp(r(e))+")"}},set:function(r){e=r}})};Tl(Lz,Xu);var wu=function e(){Xu.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');t=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!rs(t,3)},set:function(b){b?this.F=ns(t,3):this.F=is(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Z2)return;s="FieldObject"+e.FieldNum++}var b=function(v){return v};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+rp(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/vC:u},set:function(b){u=b}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(b){d=b}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Z2||this instanceof l0))return Ck(f,this.objId,this.scope)},set:function(b){b=b.toString(),f=b}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof qs==0?Ck(h,this.objId,this.scope):h},set:function(b){b=b.toString(),h=this instanceof qs==0?b.substr(0,1)==="("?xp(b.substr(1,b.length-2)):xp(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof qs==1?xp(h.substr(1,h.length-1)):h},set:function(b){b=b.toString(),h=this instanceof qs==1?"/"+J2(b):b}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof qs==0?Ck(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof qs==0?b.substr(0,1)==="("?xp(b.substr(1,b.length-2)):xp(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof qs==1?xp(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof qs==1?"/"+J2(b):b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(b){b=!!b,g=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(b){m=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,1)},set:function(b){b?this.Ff=ns(this.Ff,1):this.Ff=is(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,2)},set:function(b){b?this.Ff=ns(this.Ff,2):this.Ff=is(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,3)},set:function(b){b?this.Ff=ns(this.Ff,3):this.Ff=is(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');y=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(y){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Tl(wu,Xu);var ym=function(){wu.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Oz(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,18)},set:function(r){r?this.Ff=ns(this.Ff,18):this.Ff=is(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=ns(this.Ff,19):this.Ff=is(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,20)},set:function(r){r?(this.Ff=ns(this.Ff,20),t.sort()):this.Ff=is(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,22)},set:function(r){r?this.Ff=ns(this.Ff,22):this.Ff=is(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(r){r?this.Ff=ns(this.Ff,23):this.Ff=is(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,27)},set:function(r){r?this.Ff=ns(this.Ff,27):this.Ff=is(this.Ff,27)}}),this.hasAppearanceStream=!1};Tl(ym,wu);var bm=function(){ym.call(this),this.fontName="helvetica",this.combo=!1};Tl(bm,ym);var vm=function(){bm.call(this),this.combo=!0};Tl(vm,bm);var Vv=function(){vm.call(this),this.edit=!0};Tl(Vv,vm);var qs=function(){wu.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,15)},set:function(r){r?this.Ff=ns(this.Ff,15):this.Ff=is(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,16)},set:function(r){r?this.Ff=ns(this.Ff,16):this.Ff=is(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,17)},set:function(r){r?this.Ff=ns(this.Ff,17):this.Ff=is(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(r){r?this.Ff=ns(this.Ff,26):this.Ff=is(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+rp(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){zi(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+J2(r)}})};Tl(qs,wu);var Gv=function(){qs.call(this),this.pushButton=!0};Tl(Gv,qs);var wm=function(){qs.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Tl(wm,qs);var Z2=function(){var e,t;wu.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+rp(i(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){zi(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=On.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Tl(Z2,wu),wm.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},wm.prototype.createOption=function(e){var t=new Z2;return t.Parent=this,t.optionName=e,this.Kids.push(t),Ege.call(this.scope,t),t};var Kv=function(){qs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=On.CheckBox.createAppearanceStream()};Tl(Kv,qs);var l0=function(){wu.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,13)},set:function(t){t?this.Ff=ns(this.Ff,13):this.Ff=is(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,21)},set:function(t){t?this.Ff=ns(this.Ff,21):this.Ff=is(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(t){t?this.Ff=ns(this.Ff,23):this.Ff=is(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,24)},set:function(t){t?this.Ff=ns(this.Ff,24):this.Ff=is(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,25)},set:function(t){t?this.Ff=ns(this.Ff,25):this.Ff=is(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(t){t?this.Ff=ns(this.Ff,26):this.Ff=is(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Tl(l0,wu);var Yv=function(){l0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,14)},set:function(e){e?this.Ff=ns(this.Ff,14):this.Ff=is(this.Ff,14)}}),this.password=!0};Tl(Yv,l0);var On={CheckBox:{createAppearanceStream:function(){return{N:{On:On.CheckBox.YesNormal},D:{On:On.CheckBox.YesPushDown,Off:On.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Uu(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=aA(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Zn(On.internal.getWidth(e))+" "+Zn(On.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Zn(s.fontSize)+" Tf "+i),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Uu(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],s=On.internal.getHeight(e),o=On.internal.getWidth(e),l=aA(e,e.caption);return i.push("1 g"),i.push("0 0 "+Zn(o)+" "+Zn(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Zn(o-1)+" "+Zn(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Zn(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Uu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zn(On.internal.getWidth(e))+" "+Zn(On.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:On.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=On.RadioButton.Circle.YesNormal,t.D[e]=On.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Uu(e);t.scope=e.scope;var r=[],n=On.internal.getWidth(e)<=On.internal.getHeight(e)?On.internal.getWidth(e)/4:On.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=On.internal.Bezier_C,s=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ef(On.internal.getWidth(e)/2)+" "+Ef(On.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Uu(e);t.scope=e.scope;var r=[],n=On.internal.getWidth(e)<=On.internal.getHeight(e)?On.internal.getWidth(e)/4:On.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*On.internal.Bezier_C).toFixed(5)),o=Number((n*On.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ef(On.internal.getWidth(e)/2)+" "+Ef(On.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ef(On.internal.getWidth(e)/2)+" "+Ef(On.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Uu(e);t.scope=e.scope;var r=[],n=On.internal.getWidth(e)<=On.internal.getHeight(e)?On.internal.getWidth(e)/4:On.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*On.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ef(On.internal.getWidth(e)/2)+" "+Ef(On.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:On.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=On.RadioButton.Cross.YesNormal,t.D[e]=On.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Uu(e);t.scope=e.scope;var r=[],n=On.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Zn(On.internal.getWidth(e)-2)+" "+Zn(On.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Zn(n.x1.x)+" "+Zn(n.x1.y)+" m"),r.push(Zn(n.x2.x)+" "+Zn(n.x2.y)+" l"),r.push(Zn(n.x4.x)+" "+Zn(n.x4.y)+" m"),r.push(Zn(n.x3.x)+" "+Zn(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Uu(e);t.scope=e.scope;var r=On.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Zn(On.internal.getWidth(e))+" "+Zn(On.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Zn(On.internal.getWidth(e)-2)+" "+Zn(On.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Zn(r.x1.x)+" "+Zn(r.x1.y)+" m"),n.push(Zn(r.x2.x)+" "+Zn(r.x2.y)+" l"),n.push(Zn(r.x4.x)+" "+Zn(r.x4.y)+" m"),n.push(Zn(r.x3.x)+" "+Zn(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Uu(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zn(On.internal.getWidth(e))+" "+Zn(On.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};On.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=On.internal.getWidth(e),r=On.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},On.internal.getWidth=function(e){var t=0;return zi(e)==="object"&&(t=sM(e.Rect[2])),t},On.internal.getHeight=function(e){var t=0;return zi(e)==="object"&&(t=sM(e.Rect[3])),t};var Ege=$a.addField=function(e){if(Cge(this,e),!(e instanceof wu))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};$a.AcroFormChoiceField=ym,$a.AcroFormListBox=bm,$a.AcroFormComboBox=vm,$a.AcroFormEditBox=Vv,$a.AcroFormButton=qs,$a.AcroFormPushButton=Gv,$a.AcroFormRadioButton=wm,$a.AcroFormCheckBox=Kv,$a.AcroFormTextField=l0,$a.AcroFormPasswordField=Yv,$a.AcroFormAppearance=On,$a.AcroForm={ChoiceField:ym,ListBox:bm,ComboBox:vm,EditBox:Vv,Button:qs,PushButton:Gv,RadioButton:wm,CheckBox:Kv,TextField:l0,PasswordField:Yv,Appearance:On},Un.AcroForm={ChoiceField:ym,ListBox:bm,ComboBox:vm,EditBox:Vv,Button:qs,PushButton:Gv,RadioButton:wm,CheckBox:Kv,TextField:l0,PasswordField:Yv,Appearance:On};Un.AcroForm;function Rz(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(E,T){var F,W,z,se,de,U=r;if((T=T||r)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(j(E))for(de in n)for(z=n[de],F=0;F<z.length;F+=1){for(se=!0,W=0;W<z[F].length;W+=1)if(z[F][W]!==void 0&&z[F][W]!==E[W]){se=!1;break}if(se===!0){U=de;break}}else for(de in n)for(z=n[de],F=0;F<z.length;F+=1){for(se=!0,W=0;W<z[F].length;W+=1)if(z[F][W]!==void 0&&z[F][W]!==E.charCodeAt(W)){se=!1;break}if(se===!0){U=de;break}}return U===r&&T!==r&&(U=T),U},s=function E(T){for(var F=this.internal.write,W=this.internal.putStream,z=(0,this.internal.getFilters)();z.indexOf("FlateEncode")!==-1;)z.splice(z.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var se=[];if(se.push({key:"Type",value:"/XObject"}),se.push({key:"Subtype",value:"/Image"}),se.push({key:"Width",value:T.width}),se.push({key:"Height",value:T.height}),T.colorSpace===b.INDEXED?se.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(se.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===b.DEVICE_CMYK&&se.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),se.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&se.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var de="",U=0,G=T.transparency.length;U<G;U++)de+=T.transparency[U]+" "+T.transparency[U]+" ";se.push({key:"Mask",value:"["+de+"]"})}T.sMask!==void 0&&se.push({key:"SMask",value:T.objectId+1+" 0 R"});var re=T.filter!==void 0?["/"+T.filter]:void 0;if(W({data:T.data,additionalKeyValues:se,alreadyAppliedFilters:re,objectId:T.objectId}),F("endobj"),"sMask"in T&&T.sMask!==void 0){var X,C=(X=T.sMaskBitsPerComponent)!==null&&X!==void 0?X:T.bitsPerComponent,K={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:C,data:T.sMask};"filter"in T&&(K.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(C," /Columns ").concat(T.width),K.filter=T.filter),E.call(this,K)}if(T.colorSpace===b.INDEXED){var V=this.internal.newObject();W({data:L(new Uint8Array(T.palette)),objectId:V}),F("endobj")}},o=function(){var E=this.internal.collections[t+"images"];for(var T in E)s.call(this,E[T])},l=function(){var E,T=this.internal.collections[t+"images"],F=this.internal.write;for(var W in T)F("/I"+(E=T[W]).index,E.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var E=this.internal.collections[t+"images"];return c.call(this),E},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(E){return typeof e["process"+E.toUpperCase()]=="function"},h=function(E){return zi(E)==="object"&&E.nodeType===1},p=function(E,T){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var F=""+E.getAttribute("src");if(F.indexOf("data:image/")===0)return Hv(unescape(F).split("base64,").pop());var W=e.loadFile(F,!0);if(W!==void 0)return W}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var z;switch(T){case"PNG":z="image/png";break;case"WEBP":z="image/webp";break;default:z="image/jpeg"}return Hv(E.toDataURL(z,1).split("base64,").pop())}},m=function(E){var T=this.internal.collections[t+"images"];if(T){for(var F in T)if(E===T[F].alias)return T[F]}},g=function(E,T,F){return E||T||(E=-96,T=-96),E<0&&(E=-1*F.width*72/E/this.internal.scaleFactor),T<0&&(T=-1*F.height*72/T/this.internal.scaleFactor),E===0&&(E=T*F.width/F.height),T===0&&(T=E*F.height/F.width),[E,T]},y=function(E,T,F,W,z,se){var de=g.call(this,F,W,z),U=this.internal.getCoordinateString,G=this.internal.getVerticalCoordinateString,re=u.call(this);if(F=de[0],W=de[1],re[z.index]=z,se){se*=Math.PI/180;var X=Math.cos(se),C=Math.sin(se),K=function(R){return R.toFixed(4)},V=[K(X),K(C),K(-1*C),K(X),0,0,"cm"]}this.internal.write("q"),se?(this.internal.write([1,"0","0",1,U(E),G(T+W),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([U(F),"0","0",U(W),"0","0","cm"].join(" "))):this.internal.write([U(F),"0","0",U(W),U(E),G(T+W),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+z.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(E){var T,F,W=0;if(typeof E=="string")for(F=E.length,T=0;T<F;T++)W=(W<<5)-W+E.charCodeAt(T),W|=0;else if(j(E))for(F=E.byteLength/2,T=0;T<F;T++)W=(W<<5)-W+E[T],W|=0;return W},S=e.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var T=!0;return E.length===0&&(T=!1),E.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(T=!1),T},k=e.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var T=E.indexOf(",");return T<0?null:E.substring(0,T).trim().endsWith("base64")?E.substring(T+1):null};e.__addimage__.isArrayBuffer=function(E){return E instanceof ArrayBuffer};var j=e.__addimage__.isArrayBufferView=function(E){return E instanceof Int8Array||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array},A=e.__addimage__.binaryStringToUint8Array=function(E){for(var T=E.length,F=new Uint8Array(T),W=0;W<T;W++)F[W]=E.charCodeAt(W);return F},L=e.__addimage__.arrayBufferToBinaryString=function(E){for(var T="",F=j(E)?E:new Uint8Array(E),W=0;W<F.length;W+=8192)T+=String.fromCharCode.apply(null,F.subarray(W,W+8192));return T};e.addImage=function(){var E,T,F,W,z,se,de,U,G;if(typeof arguments[1]=="number"?(T=r,F=arguments[1],W=arguments[2],z=arguments[3],se=arguments[4],de=arguments[5],U=arguments[6],G=arguments[7]):(T=arguments[1],F=arguments[2],W=arguments[3],z=arguments[4],se=arguments[5],de=arguments[6],U=arguments[7],G=arguments[8]),zi(E=arguments[0])==="object"&&!h(E)&&"imageData"in E){var re=E;E=re.imageData,T=re.format||T||r,F=re.x||F||0,W=re.y||W||0,z=re.w||re.width||z,se=re.h||re.height||se,de=re.alias||de,U=re.compression||U,G=re.rotation||re.angle||G}var X=this.internal.getFilters();if(U===void 0&&X.indexOf("FlateEncode")!==-1&&(U="SLOW"),isNaN(F)||isNaN(W))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var C=P.call(this,E,T,de,U);return y.call(this,F,W,z,se,C,G),this};var P=function(E,T,F,W){var z,se,de;if(typeof E=="string"&&i(E)===r){E=unescape(E);var U=B(E,!1);(U!==""||(U=e.loadFile(E,!0))!==void 0)&&(E=U)}if(h(E)&&(E=p(E,T)),T=i(E,T),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((de=F)==null||de.length===0)&&(F=function(G){return typeof G=="string"||j(G)?w(G):j(G.data)?w(G.data):null}(E)),(z=m.call(this,F))||(E instanceof Uint8Array||T==="RGBA"||(se=E,E=A(E)),z=this["process"+T.toUpperCase()](E,d.call(this),F,function(G){return G&&typeof G=="string"&&(G=G.toUpperCase()),G in e.image_compression?G:v.NONE}(W),se)),!z)throw new Error("An unknown error occurred whilst processing the image.");return z},B=e.__addimage__.convertBase64ToBinaryString=function(E,T){T=typeof T!="boolean"||T;var F,W="";if(typeof E=="string"){var z;F=(z=k(E))!==null&&z!==void 0?z:E;try{W=Hv(F)}catch(se){if(T)throw S(F)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+se.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return W};e.getImageProperties=function(E){var T,F,W="";if(h(E)&&(E=p(E)),typeof E=="string"&&i(E)===r&&((W=B(E,!1))===""&&(W=e.loadFile(E)||""),E=W),F=i(E),!f(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(E instanceof Uint8Array||(E=A(E)),!(T=this["process"+F.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=F,T}})(Un.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Un.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var h=0;h<u.length;h++){n=u[h];var p=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(g.objId),v=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+p(b(n.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+p(b(v))+") >>",g.content=s;var w=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var S=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+p(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var k=this.annotations._nameMap[n.options.name];n.options.pageNumber=k.page,n.options.top=k.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+p(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var j=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+s)},options:o,type:"link"})},e.textWithLink=function(r,n,i,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,i,s),i+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,i-u,l,o,s),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Un.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&i.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,b=r,v="",w=0;for(y=0;y<g.length;y+=1)b[g.charCodeAt(y)]!==void 0?(w++,typeof(b=b[g.charCodeAt(y)])=="number"&&(v+=String.fromCharCode(b),b=r,w=0),y===g.length-1&&(b=r,v+=g.charAt(y-(w-1)),y-=w-1,w=0)):(b=r,v+=g.charAt(y-w),y-=w,w=0);return v};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var h=e.__arabicParser__.getCorrectForm=function(g,y,b){return o(g)?s(g)===!1?-1:!u(g)||!o(y)&&!o(b)||!o(b)&&l(y)||l(g)&&!o(y)||l(g)&&c(y)||l(g)&&l(y)?0:d(g)&&o(y)&&!l(y)&&o(b)&&u(b)?3:l(g)||!o(b)?1:2:-1},p=function(g){var y=0,b=0,v=0,w="",S="",k="",j=(g=g||"").split("\\s+"),A=[];for(y=0;y<j.length;y+=1){for(A.push(""),b=0;b<j[y].length;b+=1)w=j[y][b],S=j[y][b-1],k=j[y][b+1],o(w)?(v=h(w,S,k),A[y]+=v!==-1?String.fromCharCode(t[w.charCodeAt(0)][v]):w):A[y]+=w;A[y]=f(A[y])}return A.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(y)){var v=0;for(b=[],v=0;v<y.length;v+=1)Array.isArray(y[v])?b.push([p(y[v][0]),y[v][1],y[v][2]]):b.push([p(y[v])]);g=b}else g=p(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])}(Un.API),Un.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Un.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),h=u.scaleFactor||this.internal.scaleFactor,p=0,m=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,S){return w.concat(y.splitTextToSize(S,b))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)p<(g=this.getStringUnitWidth(c[v],{font:f})*d)&&(p=g);return p!==0&&(m=c.length),{w:p/=h,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/h,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,h=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,p&&h&&(this.printHeaderRow(c.lineNumber,!0),c.y+=h[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,f,h){if(n.call(this),!d)throw new Error("No data for PDF table.");var p,m,g,y,b=[],v=[],w=[],S={},k={},j=[],A=[],L=(h=h||{}).autoSize||!1,P=h.printHeaders!==!1,B=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,E=h.margins||Object.assign({width:this.getPageWidth()},t),T=typeof h.padding=="number"?h.padding:3,F=h.headerBackgroundColor||"#c8c8c8",W=h.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=F,this.internal.__cell__.headerTextColor=W,this.setFontSize(B),f==null)v=b=Object.keys(d[0]),w=b.map(function(){return"left"});else if(Array.isArray(f)&&zi(f[0])==="object")for(b=f.map(function(re){return re.name}),v=f.map(function(re){return re.prompt||re.name||""}),w=f.map(function(re){return re.align||"left"}),p=0;p<f.length;p+=1)k[f[p].name]=.7499990551181103*f[p].width;else Array.isArray(f)&&typeof f[0]=="string"&&(v=b=f,w=b.map(function(){return"left"}));if(L||Array.isArray(f)&&typeof f[0]=="string")for(p=0;p<b.length;p+=1){for(S[y=b[p]]=d.map(function(re){return re[y]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(v[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=S[y],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)j.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);k[y]=Math.max.apply(null,j)+T+T,j=[]}if(P){var z={};for(p=0;p<b.length;p+=1)z[b[p]]={},z[b[p]].text=v[p],z[b[p]].align=w[p];var se=l.call(this,z,k);A=b.map(function(re){return new s(c,u,k[re],se,z[re].text,void 0,z[re].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var de=f.reduce(function(re,X){return re[X.name]=X.align,re},{});for(p=0;p<d.length;p+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:p,data:d[p]},this);var U=l.call(this,d[p],k);for(g=0;g<b.length;g+=1){var G=d[p][b[g]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:p,col:g,data:G},this),o.call(this,new s(c,u,k[b[g]],U,G,p+2,de[b[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(c).map(function(p){var m=c[p];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[p]-d-d)},this).map(function(p){return this.getLineHeightFactor()*p.length*f/h+d+d},this).reduce(function(p,m){return Math.max(p,m)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){d=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,h.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),r=!1}}(Un.API);var Bz={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Fz=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],sA=Rz(Fz),Iz=[100,200,300,400,500,600,700,800,900],Tge=Rz(Iz);function Ek(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return Bz[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),i=function(s){return typeof sA[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function oM(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var Pge={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},lM={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function cM(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function uM(e){return e.trimLeft()}function Oge(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function Mge(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var yp,$b,dM,fM,hM,Tk=["times"];function pM(e,t,r,n,i){var s=4,o=gM;switch(i){case Un.API.image_compression.FAST:s=1,o=mM;break;case Un.API.image_compression.MEDIUM:s=6,o=xM;break;case Un.API.image_compression.SLOW:s=9,o=yM}e=function(c,u,d,f){for(var h,p=c.length/u,m=new Uint8Array(c.length+p),g=[Lge,mM,gM,xM,yM],y=0;y<p;y+=1){var b=y*u,v=c.subarray(b,b+u);if(f)m.set(f(v,d,h),b+y);else{for(var w=g.length,S=[],k=0;k<w;k+=1)S[k]=g[k](v,d,h);var j=Bge(S.concat());m.set(S[j],b+y)}h=v}return m}(e,t,Math.ceil(r*n/8),o);var l=Z4(e,{level:s});return Un.API.__addimage__.arrayBufferToBinaryString(l)}function Lge(e){var t=Array.apply([],e);return t.unshift(0),t}function mM(e,t){var r=e.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var s=e[i-t]||0;n[i+1]=e[i]-s+256&255}return n}function gM(e,t,r){var n=e.length,i=[];i[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;i[s+1]=e[s]-o+256&255}return i}function xM(e,t,r){var n=e.length,i=[];i[0]=3;for(var s=0;s<n;s+=1){var o=e[s-t]||0,l=r&&r[s]||0;i[s+1]=e[s]+256-(o+l>>>1)&255}return i}function yM(e,t,r){var n=e.length,i=[];i[0]=4;for(var s=0;s<n;s+=1){var o=Rge(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);i[s+1]=e[s]-o+256&255}return i}function Rge(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),i=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=i&&n<=s?e:i<=s?t:r}function Bge(e){var t=e.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return t.indexOf(Math.min.apply(null,t))}function Pk(e,t,r){var n=t*r,i=Math.floor(n/8),s=16-(n-8*i+r),o=(1<<r)-1;return Dz(e,i)>>s&o}function bM(e,t,r,n){var i=r*n,s=Math.floor(i/8),o=16-(i-8*s+n),l=(1<<n)-1,c=(t&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var h=f>>8&255;u.setUint8(d,h)}})(e,s,Dz(e,s)&~(l<<o)&65535|c)}function Dz(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function Fge(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,o=1<<1+(7&i);e[t++],e[t++];var l=null,c=null;s&&(l=t,c=o,t+=3*o);var u=!0,d=[],f=0,h=null,p=0,m=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,h=e[t++],1&g||(h=null),p=g>>2&7,t++;break;case 254:for(;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,S=e[t++],k=S>>6&1,j=1<<1+(7&S),A=l,L=c,P=!1;S>>7&&(P=!0,A=t,L=j,t+=3*j);var B=t;for(t++;;){var E;if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}d.push({x:y,y:b,width:v,height:w,has_local_palette:P,palette_offset:A,palette_size:L,data_offset:B,data_length:t-B,transparent_index:h,interlaced:!!k,delay:f,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(T){if(T<0||T>=d.length)throw new Error("Frame index out of range.");return d[T]},this.decodeAndBlitFrameBGRA=function(T,F){var W=this.frameInfo(T),z=W.width*W.height,se=new Uint8Array(z);vM(e,W.data_offset,se,z);var de=W.palette_offset,U=W.transparent_index;U===null&&(U=256);var G=W.width,re=r-G,X=G,C=4*(W.y*r+W.x),K=4*((W.y+W.height)*r+W.x),V=C,R=4*re;W.interlaced===!0&&(R+=4*r*7);for(var J=8,q=0,Y=se.length;q<Y;++q){var Q=se[q];if(X===0&&(X=G,(V+=R)>=K&&(R=4*re+4*r*(J-1),V=C+(G+re)*(J<<1),J>>=1)),Q===U)V+=4;else{var ie=e[de+3*Q],le=e[de+3*Q+1],O=e[de+3*Q+2];F[V++]=O,F[V++]=le,F[V++]=ie,F[V++]=255}--X}},this.decodeAndBlitFrameRGBA=function(T,F){var W=this.frameInfo(T),z=W.width*W.height,se=new Uint8Array(z);vM(e,W.data_offset,se,z);var de=W.palette_offset,U=W.transparent_index;U===null&&(U=256);var G=W.width,re=r-G,X=G,C=4*(W.y*r+W.x),K=4*((W.y+W.height)*r+W.x),V=C,R=4*re;W.interlaced===!0&&(R+=4*r*7);for(var J=8,q=0,Y=se.length;q<Y;++q){var Q=se[q];if(X===0&&(X=G,(V+=R)>=K&&(R=4*re+4*r*(J-1),V=C+(G+re)*(J<<1),J>>=1)),Q===U)V+=4;else{var ie=e[de+3*Q],le=e[de+3*Q+1],O=e[de+3*Q+2];F[V++]=ie,F[V++]=le,F[V++]=O,F[V++]=255}--X}}}function vM(e,t,r,n){for(var i=e[t++],s=1<<i,o=s+1,l=o+1,c=i+1,u=(1<<c)-1,d=0,f=0,h=0,p=e[t++],m=new Int32Array(4096),g=null;;){for(;d<16&&p!==0;)f|=e[t++]<<d,d+=8,p===1?p=e[t++]:--p;if(d<c)break;var y=f&u;if(f>>=c,d-=c,y!==s){if(y===o)break;for(var b=y<l?y:g,v=0,w=b;w>s;)w=m[w]>>8,++v;var S=w;if(h+v+(b!==y?1:0)>n)return void ta.log("Warning, gif stream longer than expected.");r[h++]=S;var k=h+=v;for(b!==y&&(r[h++]=S),w=b;v--;)w=m[w],r[--k]=255&w,w>>=8;g!==null&&l<4096&&(m[l++]=g<<8|S,l>=u+1&&c<12&&(++c,u=u<<1|1)),g=y}else l=o+1,u=(1<<(c=i+1))-1,g=null}return h!==n&&ta.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Ok(e){var t,r,n,i,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),h=new Array(65535),p=new Array(64),m=new Array(64),g=[],y=0,b=7,v=new Array(64),w=new Array(64),S=new Array(64),k=new Array(256),j=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],L=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],F=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function se(C,K){for(var V=0,R=0,J=new Array,q=1;q<=16;q++){for(var Y=1;Y<=C[q];Y++)J[K[R]]=[],J[K[R]][0]=V,J[K[R]][1]=q,R++,V++;V*=2}return J}function de(C){for(var K=C[0],V=C[1]-1;V>=0;)K&1<<V&&(y|=1<<b),V--,--b<0&&(y==255?(U(255),U(0)):U(y),b=7,y=0)}function U(C){g.push(C)}function G(C){U(C>>8&255),U(255&C)}function re(C,K,V,R,J){for(var q,Y=J[0],Q=J[240],ie=function(Ae,ke){var _e,De,We,Ct,_t,Xe,nt,Ne,be,fe,ge=0;for(be=0;be<8;++be){_e=Ae[ge],De=Ae[ge+1],We=Ae[ge+2],Ct=Ae[ge+3],_t=Ae[ge+4],Xe=Ae[ge+5],nt=Ae[ge+6];var lt=_e+(Ne=Ae[ge+7]),He=_e-Ne,mt=De+nt,wt=De-nt,Pt=We+Xe,bt=We-Xe,qr=Ct+_t,Tt=Ct-_t,xr=lt+qr,Zr=lt-qr,Xr=mt+Pt,Br=mt-Pt;Ae[ge]=xr+Xr,Ae[ge+4]=xr-Xr;var Vr=.707106781*(Br+Zr);Ae[ge+2]=Zr+Vr,Ae[ge+6]=Zr-Vr;var An=.382683433*((xr=Tt+bt)-(Br=wt+He)),Yr=.5411961*xr+An,Ln=1.306562965*Br+An,Me=.707106781*(Xr=bt+wt),Ce=He+Me,It=He-Me;Ae[ge+5]=It+Yr,Ae[ge+3]=It-Yr,Ae[ge+1]=Ce+Ln,Ae[ge+7]=Ce-Ln,ge+=8}for(ge=0,be=0;be<8;++be){_e=Ae[ge],De=Ae[ge+8],We=Ae[ge+16],Ct=Ae[ge+24],_t=Ae[ge+32],Xe=Ae[ge+40],nt=Ae[ge+48];var ft=_e+(Ne=Ae[ge+56]),Ot=_e-Ne,er=De+nt,hr=De-nt,Tr=We+Xe,ne=We-Xe,ce=Ct+_t,te=Ct-_t,ue=ft+ce,Ee=ft-ce,je=er+Tr,gt=er-Tr;Ae[ge]=ue+je,Ae[ge+32]=ue-je;var Qe=.707106781*(gt+Ee);Ae[ge+16]=Ee+Qe,Ae[ge+48]=Ee-Qe;var Fe=.382683433*((ue=te+ne)-(gt=hr+Ot)),$e=.5411961*ue+Fe,st=1.306562965*gt+Fe,Wt=.707106781*(je=ne+hr),qt=Ot+Wt,ht=Ot-Wt;Ae[ge+40]=ht+$e,Ae[ge+24]=ht-$e,Ae[ge+8]=qt+st,Ae[ge+56]=qt-st,ge++}for(be=0;be<64;++be)fe=Ae[be]*ke[be],p[be]=fe>0?fe+.5|0:fe-.5|0;return p}(C,K),le=0;le<64;++le)m[A[le]]=ie[le];var O=m[0]-V;V=m[0],O==0?de(R[0]):(de(R[h[q=32767+O]]),de(f[q]));for(var H=63;H>0&&m[H]==0;)H--;if(H==0)return de(Y),V;for(var ae,I=1;I<=H;){for(var Z=I;m[I]==0&&I<=H;)++I;var pe=I-Z;if(pe>=16){ae=pe>>4;for(var Oe=1;Oe<=ae;++Oe)de(Q);pe&=15}q=32767+m[I],de(J[(pe<<4)+h[q]]),de(f[q]),I++}return H!=63&&de(Y),V}function X(C){C=Math.min(Math.max(C,1),100),s!=C&&(function(K){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],R=0;R<64;R++){var J=o((V[R]*K+50)/100);J=Math.min(Math.max(J,1),255),l[A[R]]=J}for(var q=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Y=0;Y<64;Y++){var Q=o((q[Y]*K+50)/100);Q=Math.min(Math.max(Q,1),255),c[A[Y]]=Q}for(var ie=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],le=0,O=0;O<8;O++)for(var H=0;H<8;H++)u[le]=1/(l[A[le]]*ie[O]*ie[H]*8),d[le]=1/(c[A[le]]*ie[O]*ie[H]*8),le++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),s=C)}this.encode=function(C,K){K&&X(K),g=new Array,y=0,b=7,G(65496),G(65504),G(16),U(74),U(70),U(73),U(70),U(0),U(1),U(1),U(0),G(1),G(1),U(0),U(0),function(){G(65499),G(132),U(0);for(var De=0;De<64;De++)U(l[De]);U(1);for(var We=0;We<64;We++)U(c[We])}(),function(De,We){G(65472),G(17),U(8),G(We),G(De),U(3),U(1),U(17),U(0),U(2),U(17),U(1),U(3),U(17),U(1)}(C.width,C.height),function(){G(65476),G(418),U(0);for(var De=0;De<16;De++)U(L[De+1]);for(var We=0;We<=11;We++)U(P[We]);U(16);for(var Ct=0;Ct<16;Ct++)U(B[Ct+1]);for(var _t=0;_t<=161;_t++)U(E[_t]);U(1);for(var Xe=0;Xe<16;Xe++)U(T[Xe+1]);for(var nt=0;nt<=11;nt++)U(F[nt]);U(17);for(var Ne=0;Ne<16;Ne++)U(W[Ne+1]);for(var be=0;be<=161;be++)U(z[be])}(),G(65498),G(12),U(3),U(1),U(0),U(2),U(17),U(3),U(17),U(0),U(63),U(0);var V=0,R=0,J=0;y=0,b=7,this.encode.displayName="_encode_";for(var q,Y,Q,ie,le,O,H,ae,I,Z=C.data,pe=C.width,Oe=C.height,Ae=4*pe,ke=0;ke<Oe;){for(q=0;q<Ae;){for(le=Ae*ke+q,H=-1,ae=0,I=0;I<64;I++)O=le+(ae=I>>3)*Ae+(H=4*(7&I)),ke+ae>=Oe&&(O-=Ae*(ke+1+ae-Oe)),q+H>=Ae&&(O-=q+H-Ae+4),Y=Z[O++],Q=Z[O++],ie=Z[O++],v[I]=(j[Y]+j[Q+256|0]+j[ie+512|0]>>16)-128,w[I]=(j[Y+768|0]+j[Q+1024|0]+j[ie+1280|0]>>16)-128,S[I]=(j[Y+1280|0]+j[Q+1536|0]+j[ie+1792|0]>>16)-128;V=re(v,u,V,t,n),R=re(w,d,R,r,i),J=re(S,d,J,r,i),q+=32}ke+=8}if(b>=0){var _e=[];_e[1]=b+1,_e[0]=(1<<b+1)-1,de(_e)}return G(65497),new Uint8Array(g)},e=e||50,function(){for(var C=String.fromCharCode,K=0;K<256;K++)k[K]=C(K)}(),t=se(L,P),r=se(T,F),n=se(B,E),i=se(W,z),function(){for(var C=1,K=2,V=1;V<=15;V++){for(var R=C;R<K;R++)h[32767+R]=V,f[32767+R]=[],f[32767+R][1]=V,f[32767+R][0]=R;for(var J=-(K-1);J<=-C;J++)h[32767+J]=V,f[32767+J]=[],f[32767+J][1]=V,f[32767+J][0]=K-1+J;C<<=1,K<<=1}}(),function(){for(var C=0;C<256;C++)j[C]=19595*C,j[C+256|0]=38470*C,j[C+512|0]=7471*C+32768,j[C+768|0]=-11059*C,j[C+1024|0]=-21709*C,j[C+1280|0]=32768*C+8421375,j[C+1536|0]=-27439*C,j[C+1792|0]=-5329*C}(),X(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function eu(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wM(e){function t(P){if(!P)throw Error("assert :P")}function r(P,B,E){for(var T=0;4>T;T++)if(P[B+T]!=E.charCodeAt(T))return!0;return!1}function n(P,B,E,T,F){for(var W=0;W<F;W++)P[B+W]=E[T+W]}function i(P,B,E,T){for(var F=0;F<T;F++)P[B+F]=E}function s(P){return new Int32Array(P)}function o(P,B){for(var E=[],T=0;T<P;T++)E.push(new B);return E}function l(P,B){var E=[];return function T(F,W,z){for(var se=z[W],de=0;de<se&&(F.push(z.length>W+1?[]:new B),!(z.length<W+1));de++)T(F[de],W+1,z)}(E,0,P),E}var c=function(){var P=this;function B(_,N){for(var D=1<<N-1>>>0;_&D;)D>>>=1;return D?(_&D-1)+D:_}function E(_,N,D,ee,he){t(!(ee%D));do _[N+(ee-=D)]=he;while(0<ee)}function T(_,N,D,ee,he){if(t(2328>=he),512>=he)var ye=s(512);else if((ye=s(he))==null)return 0;return function(Se,Te,Le,Ke,Et,nr){var Ye,Ft,Xt=Te,jr=1<<Le,tr=s(16),Er=s(16);for(t(Et!=0),t(Ke!=null),t(Se!=null),t(0<Le),Ft=0;Ft<Et;++Ft){if(15<Ke[Ft])return 0;++tr[Ke[Ft]]}if(tr[0]==Et)return 0;for(Er[1]=0,Ye=1;15>Ye;++Ye){if(tr[Ye]>1<<Ye)return 0;Er[Ye+1]=Er[Ye]+tr[Ye]}for(Ft=0;Ft<Et;++Ft)Ye=Ke[Ft],0<Ke[Ft]&&(nr[Er[Ye]++]=Ft);if(Er[15]==1)return(Ke=new F).g=0,Ke.value=nr[0],E(Se,Xt,1,jr,Ke),jr;var Or,Qr=-1,$r=jr-1,$n=0,Pn=1,oi=1,Rn=1<<Le;for(Ft=0,Ye=1,Et=2;Ye<=Le;++Ye,Et<<=1){if(Pn+=oi<<=1,0>(oi-=tr[Ye]))return 0;for(;0<tr[Ye];--tr[Ye])(Ke=new F).g=Ye,Ke.value=nr[Ft++],E(Se,Xt+$n,Et,Rn,Ke),$n=B($n,Ye)}for(Ye=Le+1,Et=2;15>=Ye;++Ye,Et<<=1){if(Pn+=oi<<=1,0>(oi-=tr[Ye]))return 0;for(;0<tr[Ye];--tr[Ye]){if(Ke=new F,($n&$r)!=Qr){for(Xt+=Rn,Or=1<<(Qr=Ye)-Le;15>Qr&&!(0>=(Or-=tr[Qr]));)++Qr,Or<<=1;jr+=Rn=1<<(Or=Qr-Le),Se[Te+(Qr=$n&$r)].g=Or+Le,Se[Te+Qr].value=Xt-Te-Qr}Ke.g=Ye-Le,Ke.value=nr[Ft++],E(Se,Xt+($n>>Le),Et,Rn,Ke),$n=B($n,Ye)}}return Pn!=2*Er[15]-1?0:jr}(_,N,D,ee,he,ye)}function F(){this.value=this.g=0}function W(){this.value=this.g=0}function z(){this.G=o(5,F),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(oa,W)}function se(_,N,D,ee){t(_!=null),t(N!=null),t(2147483648>ee),_.Ca=254,_.I=0,_.b=-8,_.Ka=0,_.oa=N,_.pa=D,_.Jd=N,_.Yc=D+ee,_.Zc=4<=ee?D+ee-4+1:D,Y(_)}function de(_,N){for(var D=0;0<N--;)D|=ie(_,128)<<N;return D}function U(_,N){var D=de(_,N);return Q(_)?-D:D}function G(_,N,D,ee){var he,ye=0;for(t(_!=null),t(N!=null),t(4294967288>ee),_.Sb=ee,_.Ra=0,_.u=0,_.h=0,4<ee&&(ee=4),he=0;he<ee;++he)ye+=N[D+he]<<8*he;_.Ra=ye,_.bb=ee,_.oa=N,_.pa=D}function re(_){for(;8<=_.u&&_.bb<_.Sb;)_.Ra>>>=8,_.Ra+=_.oa[_.pa+_.bb]<<qo-8>>>0,++_.bb,_.u-=8;R(_)&&(_.h=1,_.u=0)}function X(_,N){if(t(0<=N),!_.h&&N<=ya){var D=V(_)&la[N];return _.u+=N,re(_),D}return _.h=1,_.u=0}function C(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function K(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function V(_){return _.Ra>>>(_.u&qo-1)>>>0}function R(_){return t(_.bb<=_.Sb),_.h||_.bb==_.Sb&&_.u>qo}function J(_,N){_.u=N,_.h=R(_)}function q(_){_.u>=gi&&(t(_.u>=gi),re(_))}function Y(_){t(_!=null&&_.oa!=null),_.pa<_.Zc?(_.I=(_.oa[_.pa++]|_.I<<8)>>>0,_.b+=8):(t(_!=null&&_.oa!=null),_.pa<_.Yc?(_.b+=8,_.I=_.oa[_.pa++]|_.I<<8):_.Ka?_.b=0:(_.I<<=8,_.b+=8,_.Ka=1))}function Q(_){return de(_,1)}function ie(_,N){var D=_.Ca;0>_.b&&Y(_);var ee=_.b,he=D*N>>>8,ye=(_.I>>>ee>he)+0;for(ye?(D-=he,_.I-=he+1<<ee>>>0):D=he+1,ee=D,he=0;256<=ee;)he+=8,ee>>=8;return ee=7^he+Js[ee],_.b-=ee,_.Ca=(D<<ee)-1,ye}function le(_,N,D){_[N+0]=D>>24&255,_[N+1]=D>>16&255,_[N+2]=D>>8&255,_[N+3]=255&D}function O(_,N){return _[N+0]|_[N+1]<<8}function H(_,N){return O(_,N)|_[N+2]<<16}function ae(_,N){return O(_,N)|O(_,N+2)<<16}function I(_,N){var D=1<<N;return t(_!=null),t(0<N),_.X=s(D),_.X==null?0:(_.Mb=32-N,_.Xa=N,1)}function Z(_,N){t(_!=null),t(N!=null),t(_.Xa==N.Xa),n(N.X,0,_.X,0,1<<N.Xa)}function pe(){this.X=[],this.Xa=this.Mb=0}function Oe(_,N,D,ee){t(D!=null),t(ee!=null);var he=D[0],ye=ee[0];return he==0&&(he=(_*ye+N/2)/N),ye==0&&(ye=(N*he+_/2)/_),0>=he||0>=ye?0:(D[0]=he,ee[0]=ye,1)}function Ae(_,N){return _+(1<<N)-1>>>N}function ke(_,N){return((4278255360&_)+(4278255360&N)>>>0&4278255360)+((16711935&_)+(16711935&N)>>>0&16711935)>>>0}function _e(_,N){P[N]=function(D,ee,he,ye,Se,Te,Le){var Ke;for(Ke=0;Ke<Se;++Ke){var Et=P[_](Te[Le+Ke-1],he,ye+Ke);Te[Le+Ke]=ke(D[ee+Ke],Et)}}}function De(){this.ud=this.hd=this.jd=0}function We(_,N){return((4278124286&(_^N))>>>1)+(_&N)>>>0}function Ct(_){return 0<=_&&256>_?_:0>_?0:255<_?255:void 0}function _t(_,N){return Ct(_+(_-N+.5>>1))}function Xe(_,N,D){return Math.abs(N-D)-Math.abs(_-D)}function nt(_,N,D,ee,he,ye,Se){for(ee=ye[Se-1],D=0;D<he;++D)ye[Se+D]=ee=ke(_[N+D],ee)}function Ne(_,N,D,ee,he){var ye;for(ye=0;ye<D;++ye){var Se=_[N+ye],Te=Se>>8&255,Le=16711935&(Le=(Le=16711935&Se)+((Te<<16)+Te));ee[he+ye]=(4278255360&Se)+Le>>>0}}function be(_,N){N.jd=255&_,N.hd=_>>8&255,N.ud=_>>16&255}function fe(_,N,D,ee,he,ye){var Se;for(Se=0;Se<ee;++Se){var Te=N[D+Se],Le=Te>>>8,Ke=Te,Et=255&(Et=(Et=Te>>>16)+((_.jd<<24>>24)*(Le<<24>>24)>>>5));Ke=255&(Ke=(Ke+=(_.hd<<24>>24)*(Le<<24>>24)>>>5)+((_.ud<<24>>24)*(Et<<24>>24)>>>5)),he[ye+Se]=(4278255360&Te)+(Et<<16)+Ke}}function ge(_,N,D,ee,he){P[N]=function(ye,Se,Te,Le,Ke,Et,nr,Ye,Ft){for(Le=nr;Le<Ye;++Le)for(nr=0;nr<Ft;++nr)Ke[Et++]=he(Te[ee(ye[Se++])])},P[_]=function(ye,Se,Te,Le,Ke,Et,nr){var Ye=8>>ye.b,Ft=ye.Ea,Xt=ye.K[0],jr=ye.w;if(8>Ye)for(ye=(1<<ye.b)-1,jr=(1<<Ye)-1;Se<Te;++Se){var tr,Er=0;for(tr=0;tr<Ft;++tr)tr&ye||(Er=ee(Le[Ke++])),Et[nr++]=he(Xt[Er&jr]),Er>>=Ye}else P["VP8LMapColor"+D](Le,Ke,Xt,jr,Et,nr,Se,Te,Ft)}}function lt(_,N,D,ee,he){for(D=N+D;N<D;){var ye=_[N++];ee[he++]=ye>>16&255,ee[he++]=ye>>8&255,ee[he++]=255&ye}}function He(_,N,D,ee,he){for(D=N+D;N<D;){var ye=_[N++];ee[he++]=ye>>16&255,ee[he++]=ye>>8&255,ee[he++]=255&ye,ee[he++]=ye>>24&255}}function mt(_,N,D,ee,he){for(D=N+D;N<D;){var ye=(Se=_[N++])>>16&240|Se>>12&15,Se=240&Se|Se>>28&15;ee[he++]=ye,ee[he++]=Se}}function wt(_,N,D,ee,he){for(D=N+D;N<D;){var ye=(Se=_[N++])>>16&248|Se>>13&7,Se=Se>>5&224|Se>>3&31;ee[he++]=ye,ee[he++]=Se}}function Pt(_,N,D,ee,he){for(D=N+D;N<D;){var ye=_[N++];ee[he++]=255&ye,ee[he++]=ye>>8&255,ee[he++]=ye>>16&255}}function bt(_,N,D,ee,he,ye){if(ye==0)for(D=N+D;N<D;)le(ee,((ye=_[N++])[0]>>24|ye[1]>>8&65280|ye[2]<<8&16711680|ye[3]<<24)>>>0),he+=32;else n(ee,he,_,N,D)}function qr(_,N){P[N][0]=P[_+"0"],P[N][1]=P[_+"1"],P[N][2]=P[_+"2"],P[N][3]=P[_+"3"],P[N][4]=P[_+"4"],P[N][5]=P[_+"5"],P[N][6]=P[_+"6"],P[N][7]=P[_+"7"],P[N][8]=P[_+"8"],P[N][9]=P[_+"9"],P[N][10]=P[_+"10"],P[N][11]=P[_+"11"],P[N][12]=P[_+"12"],P[N][13]=P[_+"13"],P[N][14]=P[_+"0"],P[N][15]=P[_+"0"]}function Tt(_){return _==r5||_==n5||_==Gy||_==i5}function xr(){this.eb=[],this.size=this.A=this.fb=0}function Zr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Xr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new xr,this.f.kb=new Zr,this.sd=null}function Br(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Vr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function An(_){return alert("todo:WebPSamplerProcessPlane"),_.T}function Yr(_,N){var D=_.T,ee=N.ba.f.RGBA,he=ee.eb,ye=ee.fb+_.ka*ee.A,Se=gc[N.ba.S],Te=_.y,Le=_.O,Ke=_.f,Et=_.N,nr=_.ea,Ye=_.W,Ft=N.cc,Xt=N.dc,jr=N.Mc,tr=N.Nc,Er=_.ka,Or=_.ka+_.T,Qr=_.U,$r=Qr+1>>1;for(Er==0?Se(Te,Le,null,null,Ke,Et,nr,Ye,Ke,Et,nr,Ye,he,ye,null,null,Qr):(Se(N.ec,N.fc,Te,Le,Ft,Xt,jr,tr,Ke,Et,nr,Ye,he,ye-ee.A,he,ye,Qr),++D);Er+2<Or;Er+=2)Ft=Ke,Xt=Et,jr=nr,tr=Ye,Et+=_.Rc,Ye+=_.Rc,ye+=2*ee.A,Se(Te,(Le+=2*_.fa)-_.fa,Te,Le,Ft,Xt,jr,tr,Ke,Et,nr,Ye,he,ye-ee.A,he,ye,Qr);return Le+=_.fa,_.j+Or<_.o?(n(N.ec,N.fc,Te,Le,Qr),n(N.cc,N.dc,Ke,Et,$r),n(N.Mc,N.Nc,nr,Ye,$r),D--):1&Or||Se(Te,Le,null,null,Ke,Et,nr,Ye,Ke,Et,nr,Ye,he,ye+ee.A,null,null,Qr),D}function Ln(_,N,D){var ee=_.F,he=[_.J];if(ee!=null){var ye=_.U,Se=N.ba.S,Te=Se==Vy||Se==Gy;N=N.ba.f.RGBA;var Le=[0],Ke=_.ka;Le[0]=_.T,_.Kb&&(Ke==0?--Le[0]:(--Ke,he[0]-=_.width),_.j+_.ka+_.T==_.o&&(Le[0]=_.o-_.j-Ke));var Et=N.eb;Ke=N.fb+Ke*N.A,_=B6(ee,he[0],_.width,ye,Le,Et,Ke+(Te?0:3),N.A),t(D==Le),_&&Tt(Se)&&Ag(Et,Ke,Te,ye,Le,N.A)}return 0}function Me(_){var N=_.ma,D=N.ba.S,ee=11>D,he=D==qy||D==Hy||D==Vy||D==t5||D==12||Tt(D);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Ml(N.Oa,_,he?11:12))return 0;if(he&&Tt(D)&&sn(),_.da)alert("todo:use_scaling");else{if(ee){if(N.Ib=An,_.Kb){if(D=_.U+1>>1,N.memory=s(_.U+2*D),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+_.U,N.Mc=N.cc,N.Nc=N.dc+D,N.Ib=Yr,sn()}}else alert("todo:EmitYUV");he&&(N.Jb=Ln,ee&&zr())}if(ee&&!J6){for(_=0;256>_;++_)XK[_]=89858*(_-128)+Yy>>Ky,ZK[_]=-22014*(_-128)+Yy,JK[_]=-45773*(_-128),QK[_]=113618*(_-128)+Yy>>Ky;for(_=Cg;_<o5;++_)N=76283*(_-16)+Yy>>Ky,eY[_-Cg]=kr(N,255),tY[_-Cg]=kr(N+8>>4,15);J6=1}return 1}function Ce(_){var N=_.ma,D=_.U,ee=_.T;return t(!(1&_.ka)),0>=D||0>=ee?0:(D=N.Ib(_,N),N.Jb!=null&&N.Jb(_,N,D),N.Dc+=D,1)}function It(_){_.ma.memory=null}function ft(_,N,D,ee){return X(_,8)!=47?0:(N[0]=X(_,14)+1,D[0]=X(_,14)+1,ee[0]=X(_,1),X(_,3)!=0?0:!_.h)}function Ot(_,N){if(4>_)return _+1;var D=_-2>>1;return(2+(1&_)<<D)+X(N,D)+1}function er(_,N){return 120<N?N-120:1<=(D=((D=BK[N-1])>>4)*_+(8-(15&D)))?D:1;var D}function hr(_,N,D){var ee=V(D),he=_[N+=255&ee].g-8;return 0<he&&(J(D,D.u+8),ee=V(D),N+=_[N].value,N+=ee&(1<<he)-1),J(D,D.u+_[N].g),_[N].value}function Tr(_,N,D){return D.g+=_.g,D.value+=_.value<<N>>>0,t(8>=D.g),_.g}function ne(_,N,D){var ee=_.xc;return t((N=ee==0?0:_.vc[_.md*(D>>ee)+(N>>ee)])<_.Wb),_.Ya[N]}function ce(_,N,D,ee){var he=_.ab,ye=_.c*N,Se=_.C;N=Se+N;var Te=D,Le=ee;for(ee=_.Ta,D=_.Ua;0<he--;){var Ke=_.gc[he],Et=Se,nr=N,Ye=Te,Ft=Le,Xt=(Le=ee,Te=D,Ke.Ea);switch(t(Et<nr),t(nr<=Ke.nc),Ke.hc){case 2:ki(Ye,Ft,(nr-Et)*Xt,Le,Te);break;case 0:var jr=Et,tr=nr,Er=Le,Or=Te,Qr=(Rn=Ke).Ea;jr==0&&(uc(Ye,Ft,null,null,1,Er,Or),nt(Ye,Ft+1,0,0,Qr-1,Er,Or+1),Ft+=Qr,Or+=Qr,++jr);for(var $r=1<<Rn.b,$n=$r-1,Pn=Ae(Qr,Rn.b),oi=Rn.K,Rn=Rn.w+(jr>>Rn.b)*Pn;jr<tr;){var xi=oi,_s=Rn,li=1;for(dc(Ye,Ft,Er,Or-Qr,1,Er,Or);li<Qr;){var Bn=(li&~$n)+$r;Bn>Qr&&(Bn=Qr),(0,md[xi[_s++]>>8&15])(Ye,Ft+ +li,Er,Or+li-Qr,Bn-li,Er,Or+li),li=Bn}Ft+=Qr,Or+=Qr,++jr&$n||(Rn+=Pn)}nr!=Ke.nc&&n(Le,Te-Xt,Le,Te+(nr-Et-1)*Xt,Xt);break;case 1:for(Xt=Ye,tr=Ft,Qr=(Ye=Ke.Ea)-(Or=Ye&~(Er=(Ft=1<<Ke.b)-1)),jr=Ae(Ye,Ke.b),$r=Ke.K,Ke=Ke.w+(Et>>Ke.b)*jr;Et<nr;){for($n=$r,Pn=Ke,oi=new De,Rn=tr+Or,xi=tr+Ye;tr<Rn;)be($n[Pn++],oi),ku(oi,Xt,tr,Ft,Le,Te),tr+=Ft,Te+=Ft;tr<xi&&(be($n[Pn++],oi),ku(oi,Xt,tr,Qr,Le,Te),tr+=Qr,Te+=Qr),++Et&Er||(Ke+=jr)}break;case 3:if(Ye==Le&&Ft==Te&&0<Ke.b){for(tr=Le,Ye=Xt=Te+(nr-Et)*Xt-(Or=(nr-Et)*Ae(Ke.Ea,Ke.b)),Ft=Le,Er=Te,jr=[],Or=(Qr=Or)-1;0<=Or;--Or)jr[Or]=Ft[Er+Or];for(Or=Qr-1;0<=Or;--Or)tr[Ye+Or]=jr[Or];Ei(Ke,Et,nr,Le,Xt,Le,Te)}else Ei(Ke,Et,nr,Ye,Ft,Le,Te)}Te=ee,Le=D}Le!=D&&n(ee,D,Te,Le,ye)}function te(_,N){var D=_.V,ee=_.Ba+_.c*_.C,he=N-_.C;if(t(N<=_.l.o),t(16>=he),0<he){var ye=_.l,Se=_.Ta,Te=_.Ua,Le=ye.width;if(ce(_,he,D,ee),he=Te=[Te],t((D=_.C)<(ee=N)),t(ye.v<ye.va),ee>ye.o&&(ee=ye.o),D<ye.j){var Ke=ye.j-D;D=ye.j,he[0]+=Ke*Le}if(D>=ee?D=0:(he[0]+=4*ye.v,ye.ka=D-ye.j,ye.U=ye.va-ye.v,ye.T=ee-D,D=1),D){if(Te=Te[0],11>(D=_.ca).S){var Et=D.f.RGBA,nr=(ee=D.S,he=ye.U,ye=ye.T,Ke=Et.eb,Et.A),Ye=ye;for(Et=Et.fb+_.Ma*Et.A;0<Ye--;){var Ft=Se,Xt=Te,jr=he,tr=Ke,Er=Et;switch(ee){case Wy:yf(Ft,Xt,jr,tr,Er);break;case qy:Gc(Ft,Xt,jr,tr,Er);break;case r5:Gc(Ft,Xt,jr,tr,Er),Ag(tr,Er,0,jr,1,0);break;case W6:ju(Ft,Xt,jr,tr,Er);break;case Hy:bt(Ft,Xt,jr,tr,Er,1);break;case n5:bt(Ft,Xt,jr,tr,Er,1),Ag(tr,Er,0,jr,1,0);break;case Vy:bt(Ft,Xt,jr,tr,Er,0);break;case Gy:bt(Ft,Xt,jr,tr,Er,0),Ag(tr,Er,1,jr,1,0);break;case t5:fc(Ft,Xt,jr,tr,Er);break;case i5:fc(Ft,Xt,jr,tr,Er),R6(tr,Er,jr,1,0);break;case q6:hc(Ft,Xt,jr,tr,Er);break;default:t(0)}Te+=Le,Et+=nr}_.Ma+=ye}else alert("todo:EmitRescaledRowsYUVA");t(_.Ma<=D.height)}}_.C=N,t(_.C<=_.i)}function ue(_){var N;if(0<_.ua)return 0;for(N=0;N<_.Wb;++N){var D=_.Ya[N].G,ee=_.Ya[N].H;if(0<D[1][ee[1]+0].g||0<D[2][ee[2]+0].g||0<D[3][ee[3]+0].g)return 0}return 1}function Ee(_,N,D,ee,he,ye){if(_.Z!=0){var Se=_.qd,Te=_.rd;for(t(vf[_.Z]!=null);N<D;++N)vf[_.Z](Se,Te,ee,he,ee,he,ye),Se=ee,Te=he,he+=ye;_.qd=Se,_.rd=Te}}function je(_,N){var D=_.l.ma,ee=D.Z==0||D.Z==1?_.l.j:_.C;if(ee=_.C<ee?ee:_.C,t(N<=_.l.o),N>ee){var he=_.l.width,ye=D.ca,Se=D.tb+he*ee,Te=_.V,Le=_.Ba+_.c*ee,Ke=_.gc;t(_.ab==1),t(Ke[0].hc==3),yo(Ke[0],ee,N,Te,Le,ye,Se),Ee(D,ee,N,ye,Se,he)}_.C=_.Ma=N}function gt(_,N,D,ee,he,ye,Se){var Te=_.$/ee,Le=_.$%ee,Ke=_.m,Et=_.s,nr=D+_.$,Ye=nr;he=D+ee*he;var Ft=D+ee*ye,Xt=280+Et.ua,jr=_.Pb?Te:16777216,tr=0<Et.ua?Et.Wa:null,Er=Et.wc,Or=nr<Ft?ne(Et,Le,Te):null;t(_.C<ye),t(Ft<=he);var Qr=!1;e:for(;;){for(;Qr||nr<Ft;){var $r=0;if(Te>=jr){var $n=nr-D;t((jr=_).Pb),jr.wd=jr.m,jr.xd=$n,0<jr.s.ua&&Z(jr.s.Wa,jr.s.vb),jr=Te+IK}if(Le&Er||(Or=ne(Et,Le,Te)),t(Or!=null),Or.Qb&&(N[nr]=Or.qb,Qr=!0),!Qr)if(q(Ke),Or.jc){$r=Ke,$n=N;var Pn=nr,oi=Or.pd[V($r)&oa-1];t(Or.jc),256>oi.g?(J($r,$r.u+oi.g),$n[Pn]=oi.value,$r=0):(J($r,$r.u+oi.g-256),t(256<=oi.value),$r=oi.value),$r==0&&(Qr=!0)}else $r=hr(Or.G[0],Or.H[0],Ke);if(Ke.h)break;if(Qr||256>$r){if(!Qr)if(Or.nd)N[nr]=(Or.qb|$r<<8)>>>0;else{if(q(Ke),Qr=hr(Or.G[1],Or.H[1],Ke),q(Ke),$n=hr(Or.G[2],Or.H[2],Ke),Pn=hr(Or.G[3],Or.H[3],Ke),Ke.h)break;N[nr]=(Pn<<24|Qr<<16|$r<<8|$n)>>>0}if(Qr=!1,++nr,++Le>=ee&&(Le=0,++Te,Se!=null&&Te<=ye&&!(Te%16)&&Se(_,Te),tr!=null))for(;Ye<nr;)$r=N[Ye++],tr.X[(506832829*$r&4294967295)>>>tr.Mb]=$r}else if(280>$r){if($r=Ot($r-256,Ke),$n=hr(Or.G[4],Or.H[4],Ke),q(Ke),$n=er(ee,$n=Ot($n,Ke)),Ke.h)break;if(nr-D<$n||he-nr<$r)break e;for(Pn=0;Pn<$r;++Pn)N[nr+Pn]=N[nr+Pn-$n];for(nr+=$r,Le+=$r;Le>=ee;)Le-=ee,++Te,Se!=null&&Te<=ye&&!(Te%16)&&Se(_,Te);if(t(nr<=he),Le&Er&&(Or=ne(Et,Le,Te)),tr!=null)for(;Ye<nr;)$r=N[Ye++],tr.X[(506832829*$r&4294967295)>>>tr.Mb]=$r}else{if(!($r<Xt))break e;for(Qr=$r-280,t(tr!=null);Ye<nr;)$r=N[Ye++],tr.X[(506832829*$r&4294967295)>>>tr.Mb]=$r;$r=nr,t(!(Qr>>>($n=tr).Xa)),N[$r]=$n.X[Qr],Qr=!0}Qr||t(Ke.h==R(Ke))}if(_.Pb&&Ke.h&&nr<he)t(_.m.h),_.a=5,_.m=_.wd,_.$=_.xd,0<_.s.ua&&Z(_.s.vb,_.s.Wa);else{if(Ke.h)break e;Se!=null&&Se(_,Te>ye?ye:Te),_.a=0,_.$=nr-D}return 1}return _.a=3,0}function Qe(_){t(_!=null),_.vc=null,_.yc=null,_.Ya=null;var N=_.Wa;N!=null&&(N.X=null),_.vb=null,t(_!=null)}function Fe(){var _=new Jr;return _==null?null:(_.a=0,_.xb=G6,qr("Predictor","VP8LPredictors"),qr("Predictor","VP8LPredictors_C"),qr("PredictorAdd","VP8LPredictorsAdd"),qr("PredictorAdd","VP8LPredictorsAdd_C"),ki=Ne,ku=fe,yf=lt,Gc=He,fc=mt,hc=wt,ju=Pt,P.VP8LMapColor32b=Qi,P.VP8LMapColor8b=pd,_)}function $e(_,N,D,ee,he){var ye=1,Se=[_],Te=[N],Le=ee.m,Ke=ee.s,Et=null,nr=0;e:for(;;){if(D)for(;ye&&X(Le,1);){var Ye=Se,Ft=Te,Xt=ee,jr=1,tr=Xt.m,Er=Xt.gc[Xt.ab],Or=X(tr,2);if(Xt.Oc&1<<Or)ye=0;else{switch(Xt.Oc|=1<<Or,Er.hc=Or,Er.Ea=Ye[0],Er.nc=Ft[0],Er.K=[null],++Xt.ab,t(4>=Xt.ab),Or){case 0:case 1:Er.b=X(tr,3)+2,jr=$e(Ae(Er.Ea,Er.b),Ae(Er.nc,Er.b),0,Xt,Er.K),Er.K=Er.K[0];break;case 3:var Qr,$r=X(tr,8)+1,$n=16<$r?0:4<$r?1:2<$r?2:3;if(Ye[0]=Ae(Er.Ea,$n),Er.b=$n,Qr=jr=$e($r,1,0,Xt,Er.K)){var Pn,oi=$r,Rn=Er,xi=1<<(8>>Rn.b),_s=s(xi);if(_s==null)Qr=0;else{var li=Rn.K[0],Bn=Rn.w;for(_s[0]=Rn.K[0][0],Pn=1;Pn<1*oi;++Pn)_s[Pn]=ke(li[Bn+Pn],_s[Pn-1]);for(;Pn<4*xi;++Pn)_s[Pn]=0;Rn.K[0]=null,Rn.K[0]=_s,Qr=1}}jr=Qr;break;case 2:break;default:t(0)}ye=jr}}if(Se=Se[0],Te=Te[0],ye&&X(Le,1)&&!(ye=1<=(nr=X(Le,4))&&11>=nr)){ee.a=3;break e}var gn;if(gn=ye)t:{var Qa,ri,yi,ca=ee,Zs=Se,Ho=Te,Ba=nr,bo=D,Vo=ca.m,ks=ca.s,vi=[null],Fi=1,Fa=0,Ii=FK[Ba];r:for(;;){if(bo&&X(Vo,1)){var eo=X(Vo,3)+2,Xc=Ae(Zs,eo),Ja=Ae(Ho,eo),fl=Xc*Ja;if(!$e(Xc,Ja,0,ca,vi))break r;for(vi=vi[0],ks.xc=eo,Qa=0;Qa<fl;++Qa){var Zi=vi[Qa]>>8&65535;vi[Qa]=Zi,Zi>=Fi&&(Fi=Zi+1)}}if(Vo.h)break r;for(ri=0;5>ri;++ri){var js=H6[ri];!ri&&0<Ba&&(js+=1<<Ba),Fa<js&&(Fa=js)}var Rl=o(Fi*Ii,F),Go=Fi,Bl=o(Go,z);if(Bl==null)var Fl=null;else t(65536>=Go),Fl=Bl;var hl=s(Fa);if(Fl==null||hl==null||Rl==null){ca.a=1;break r}var Il=Rl;for(Qa=yi=0;Qa<Fi;++Qa){var na=Fl[Qa],Dl=na.G,Qc=na.H,Th=0,yd=1,to=0;for(ri=0;5>ri;++ri){js=H6[ri],Dl[ri]=Il,Qc[ri]=yi,!ri&&0<Ba&&(js+=1<<Ba);i:{var Qy,l5=js,Jy=ca,Eg=hl,iY=Il,aY=yi,c5=0,wf=Jy.m,sY=X(wf,1);if(i(Eg,0,0,l5),sY){var oY=X(wf,1)+1,lY=X(wf,1),tT=X(wf,lY==0?1:8);Eg[tT]=1,oY==2&&(Eg[tT=X(wf,8)]=1);var Zy=1}else{var rT=s(19),nT=X(wf,4)+4;if(19<nT){Jy.a=3;var eb=0;break i}for(Qy=0;Qy<nT;++Qy)rT[RK[Qy]]=X(wf,3);var u5=void 0,Tg=void 0,iT=Jy,cY=rT,tb=l5,aT=Eg,d5=0,Sf=iT.m,sT=8,oT=o(128,F);n:for(;T(oT,0,7,cY,19);){if(X(Sf,1)){var uY=2+2*X(Sf,3);if((u5=2+X(Sf,uY))>tb)break n}else u5=tb;for(Tg=0;Tg<tb&&u5--;){q(Sf);var lT=oT[0+(127&V(Sf))];J(Sf,Sf.u+lT.g);var dp=lT.value;if(16>dp)aT[Tg++]=dp,dp!=0&&(sT=dp);else{var dY=dp==16,cT=dp-16,fY=MK[cT],uT=X(Sf,OK[cT])+fY;if(Tg+uT>tb)break n;for(var hY=dY?sT:0;0<uT--;)aT[Tg++]=hY}}d5=1;break n}d5||(iT.a=3),Zy=d5}(Zy=Zy&&!wf.h)&&(c5=T(iY,aY,8,Eg,l5)),Zy&&c5!=0?eb=c5:(Jy.a=3,eb=0)}if(eb==0)break r;if(yd&&LK[ri]==1&&(yd=Il[yi].g==0),Th+=Il[yi].g,yi+=eb,3>=ri){var Pg,f5=hl[0];for(Pg=1;Pg<js;++Pg)hl[Pg]>f5&&(f5=hl[Pg]);to+=f5}}if(na.nd=yd,na.Qb=0,yd&&(na.qb=(Dl[3][Qc[3]+0].value<<24|Dl[1][Qc[1]+0].value<<16|Dl[2][Qc[2]+0].value)>>>0,Th==0&&256>Dl[0][Qc[0]+0].value&&(na.Qb=1,na.qb+=Dl[0][Qc[0]+0].value<<8)),na.jc=!na.Qb&&6>to,na.jc){var rb,bd=na;for(rb=0;rb<oa;++rb){var _f=rb,kf=bd.pd[_f],nb=bd.G[0][bd.H[0]+_f];256<=nb.value?(kf.g=nb.g+256,kf.value=nb.value):(kf.g=0,kf.value=0,_f>>=Tr(nb,8,kf),_f>>=Tr(bd.G[1][bd.H[1]+_f],16,kf),_f>>=Tr(bd.G[2][bd.H[2]+_f],0,kf),Tr(bd.G[3][bd.H[3]+_f],24,kf))}}}ks.vc=vi,ks.Wb=Fi,ks.Ya=Fl,ks.yc=Rl,gn=1;break t}gn=0}if(!(ye=gn)){ee.a=3;break e}if(0<nr){if(Ke.ua=1<<nr,!I(Ke.Wa,nr)){ee.a=1,ye=0;break e}}else Ke.ua=0;var h5=ee,dT=Se,pY=Te,p5=h5.s,m5=p5.xc;if(h5.c=dT,h5.i=pY,p5.md=Ae(dT,m5),p5.wc=m5==0?-1:(1<<m5)-1,D){ee.xb=HK;break e}if((Et=s(Se*Te))==null){ee.a=1,ye=0;break e}ye=(ye=gt(ee,Et,0,Se,Te,Te,null))&&!Le.h;break e}return ye?(he!=null?he[0]=Et:(t(Et==null),t(D)),ee.$=0,D||Qe(Ke)):Qe(Ke),ye}function st(_,N){var D=_.c*_.i,ee=D+N+16*N;return t(_.c<=N),_.V=s(ee),_.V==null?(_.Ta=null,_.Ua=0,_.a=1,0):(_.Ta=_.V,_.Ua=_.Ba+D+N,1)}function Wt(_,N){var D=_.C,ee=N-D,he=_.V,ye=_.Ba+_.c*D;for(t(N<=_.l.o);0<ee;){var Se=16<ee?16:ee,Te=_.l.ma,Le=_.l.width,Ke=Le*Se,Et=Te.ca,nr=Te.tb+Le*D,Ye=_.Ta,Ft=_.Ua;ce(_,Se,he,ye),F6(Ye,Ft,Et,nr,Ke),Ee(Te,D,D+Se,Et,nr,Le),ee-=Se,he+=Se*_.c,D+=Se}t(D==N),_.C=_.Ma=N}function qt(){this.ub=this.yd=this.td=this.Rb=0}function ht(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ut(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Gt(){this.Yb=function(){var _=[];return function N(D,ee,he){for(var ye=he[ee],Se=0;Se<ye&&(D.push(he.length>ee+1?[]:0),!(he.length<ee+1));Se++)N(D[Se],ee+1,he)}(_,0,[3,11]),_}()}function cr(){this.jb=s(3),this.Wc=l([4,8],Gt),this.Xc=l([4,17],Gt)}function ir(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Fr(){this.ld=this.La=this.dd=this.tc=0}function dn(){this.Na=this.la=0}function vr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Lt(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Gr(){this.uc=this.M=this.Nb=0,this.wa=Array(new Fr),this.Y=0,this.ya=Array(new Lt),this.aa=0,this.l=new Mr}function bn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function or(){this.cb=this.a=0,this.sc="",this.m=new C,this.Od=new qt,this.Kc=new ht,this.ed=new ir,this.Qa=new Ut,this.Ic=this.$c=this.Aa=0,this.D=new Gr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,C),this.ia=0,this.pb=o(4,vr),this.Pa=new cr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new bn),this.Hd=0,this.rb=Array(new dn),this.sb=0,this.wa=Array(new Fr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Lt),this.L=this.aa=0,this.gd=l([4,2],Fr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function kr(_,N){return 0>_?0:_>N?N:_}function Mr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ar(){var _=new or;return _!=null&&(_.a=0,_.sc="OK",_.cb=0,_.Xb=0,Ng||(Ng=At)),_}function Zt(_,N,D){return _.a==0&&(_.a=N,_.sc=D,_.cb=0),0}function Kt(_,N,D){return 3<=D&&_[N+0]==157&&_[N+1]==1&&_[N+2]==42}function it(_,N){if(_==null)return 0;if(_.a=0,_.sc="OK",N==null)return Zt(_,2,"null VP8Io passed to VP8GetHeaders()");var D=N.data,ee=N.w,he=N.ha;if(4>he)return Zt(_,7,"Truncated header.");var ye=D[ee+0]|D[ee+1]<<8|D[ee+2]<<16,Se=_.Od;if(Se.Rb=!(1&ye),Se.td=ye>>1&7,Se.yd=ye>>4&1,Se.ub=ye>>5,3<Se.td)return Zt(_,3,"Incorrect keyframe parameters.");if(!Se.yd)return Zt(_,4,"Frame not displayable.");ee+=3,he-=3;var Te=_.Kc;if(Se.Rb){if(7>he)return Zt(_,7,"cannot parse picture header");if(!Kt(D,ee,he))return Zt(_,3,"Bad code word");Te.c=16383&(D[ee+4]<<8|D[ee+3]),Te.Td=D[ee+4]>>6,Te.i=16383&(D[ee+6]<<8|D[ee+5]),Te.Ud=D[ee+6]>>6,ee+=7,he-=7,_.za=Te.c+15>>4,_.Ub=Te.i+15>>4,N.width=Te.c,N.height=Te.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,i((ye=_.Pa).jb,0,255,ye.jb.length),t((ye=_.Qa)!=null),ye.Cb=0,ye.Bb=0,ye.Fb=1,i(ye.Zb,0,0,ye.Zb.length),i(ye.Lb,0,0,ye.Lb)}if(Se.ub>he)return Zt(_,7,"bad partition length");se(ye=_.m,D,ee,Se.ub),ee+=Se.ub,he-=Se.ub,Se.Rb&&(Te.Ld=Q(ye),Te.Kd=Q(ye)),Te=_.Qa;var Le,Ke=_.Pa;if(t(ye!=null),t(Te!=null),Te.Cb=Q(ye),Te.Cb){if(Te.Bb=Q(ye),Q(ye)){for(Te.Fb=Q(ye),Le=0;4>Le;++Le)Te.Zb[Le]=Q(ye)?U(ye,7):0;for(Le=0;4>Le;++Le)Te.Lb[Le]=Q(ye)?U(ye,6):0}if(Te.Bb)for(Le=0;3>Le;++Le)Ke.jb[Le]=Q(ye)?de(ye,8):255}else Te.Bb=0;if(ye.Ka)return Zt(_,3,"cannot parse segment header");if((Te=_.ed).zd=Q(ye),Te.Tb=de(ye,6),Te.wb=de(ye,3),Te.Pc=Q(ye),Te.Pc&&Q(ye)){for(Ke=0;4>Ke;++Ke)Q(ye)&&(Te.vd[Ke]=U(ye,6));for(Ke=0;4>Ke;++Ke)Q(ye)&&(Te.od[Ke]=U(ye,6))}if(_.L=Te.Tb==0?0:Te.zd?1:2,ye.Ka)return Zt(_,3,"cannot parse filter header");var Et=he;if(he=Le=ee,ee=Le+Et,Te=Et,_.Xb=(1<<de(_.m,2))-1,Et<3*(Ke=_.Xb))D=7;else{for(Le+=3*Ke,Te-=3*Ke,Et=0;Et<Ke;++Et){var nr=D[he+0]|D[he+1]<<8|D[he+2]<<16;nr>Te&&(nr=Te),se(_.Jc[+Et],D,Le,nr),Le+=nr,Te-=nr,he+=3}se(_.Jc[+Ke],D,Le,Te),D=Le<ee?0:5}if(D!=0)return Zt(_,D,"cannot parse partitions");for(D=de(Le=_.m,7),he=Q(Le)?U(Le,4):0,ee=Q(Le)?U(Le,4):0,Te=Q(Le)?U(Le,4):0,Ke=Q(Le)?U(Le,4):0,Le=Q(Le)?U(Le,4):0,Et=_.Qa,nr=0;4>nr;++nr){if(Et.Cb){var Ye=Et.Zb[nr];Et.Fb||(Ye+=D)}else{if(0<nr){_.pb[nr]=_.pb[0];continue}Ye=D}var Ft=_.pb[nr];Ft.Sc[0]=a5[kr(Ye+he,127)],Ft.Sc[1]=s5[kr(Ye+0,127)],Ft.Eb[0]=2*a5[kr(Ye+ee,127)],Ft.Eb[1]=101581*s5[kr(Ye+Te,127)]>>16,8>Ft.Eb[1]&&(Ft.Eb[1]=8),Ft.Qc[0]=a5[kr(Ye+Ke,117)],Ft.Qc[1]=s5[kr(Ye+Le,127)],Ft.lc=Ye+Le}if(!Se.Rb)return Zt(_,4,"Not a key frame.");for(Q(ye),Se=_.Pa,D=0;4>D;++D){for(he=0;8>he;++he)for(ee=0;3>ee;++ee)for(Te=0;11>Te;++Te)Ke=ie(ye,WK[D][he][ee][Te])?de(ye,8):UK[D][he][ee][Te],Se.Wc[D][he].Yb[ee][Te]=Ke;for(he=0;17>he;++he)Se.Xc[D][he]=Se.Wc[D][qK[he]]}return _.kc=Q(ye),_.kc&&(_.Bd=de(ye,8)),_.cb=1}function At(_,N,D,ee,he,ye,Se){var Te=N[he].Yb[D];for(D=0;16>he;++he){if(!ie(_,Te[D+0]))return he;for(;!ie(_,Te[D+1]);)if(Te=N[++he].Yb[0],D=0,he==16)return 16;var Le=N[he+1].Yb;if(ie(_,Te[D+2])){var Ke=_,Et=0;if(ie(Ke,(Ye=Te)[(nr=D)+3]))if(ie(Ke,Ye[nr+6])){for(Te=0,nr=2*(Et=ie(Ke,Ye[nr+8]))+(Ye=ie(Ke,Ye[nr+9+Et])),Et=0,Ye=DK[nr];Ye[Te];++Te)Et+=Et+ie(Ke,Ye[Te]);Et+=3+(8<<nr)}else ie(Ke,Ye[nr+7])?(Et=7+2*ie(Ke,165),Et+=ie(Ke,145)):Et=5+ie(Ke,159);else Et=ie(Ke,Ye[nr+4])?3+ie(Ke,Ye[nr+5]):2;Te=Le[2]}else Et=1,Te=Le[1];Le=Se+$K[he],0>(Ke=_).b&&Y(Ke);var nr,Ye=Ke.b,Ft=(nr=Ke.Ca>>1)-(Ke.I>>Ye)>>31;--Ke.b,Ke.Ca+=Ft,Ke.Ca|=1,Ke.I-=(nr+1&Ft)<<Ye,ye[Le]=((Et^Ft)-Ft)*ee[(0<he)+0]}return 16}function Mt(_){var N=_.rb[_.sb-1];N.la=0,N.Na=0,i(_.zc,0,0,_.zc.length),_.ja=0}function ar(_,N,D,ee,he){he=_[N+D+32*ee]+(he>>3),_[N+D+32*ee]=-256&he?0>he?0:255:he}function Ge(_,N,D,ee,he,ye){ar(_,N,0,D,ee+he),ar(_,N,1,D,ee+ye),ar(_,N,2,D,ee-ye),ar(_,N,3,D,ee-he)}function Rt(_){return(20091*_>>16)+_}function Ze(_,N,D,ee){var he,ye=0,Se=s(16);for(he=0;4>he;++he){var Te=_[N+0]+_[N+8],Le=_[N+0]-_[N+8],Ke=(35468*_[N+4]>>16)-Rt(_[N+12]),Et=Rt(_[N+4])+(35468*_[N+12]>>16);Se[ye+0]=Te+Et,Se[ye+1]=Le+Ke,Se[ye+2]=Le-Ke,Se[ye+3]=Te-Et,ye+=4,N++}for(he=ye=0;4>he;++he)Te=(_=Se[ye+0]+4)+Se[ye+8],Le=_-Se[ye+8],Ke=(35468*Se[ye+4]>>16)-Rt(Se[ye+12]),ar(D,ee,0,0,Te+(Et=Rt(Se[ye+4])+(35468*Se[ye+12]>>16))),ar(D,ee,1,0,Le+Ke),ar(D,ee,2,0,Le-Ke),ar(D,ee,3,0,Te-Et),ye++,ee+=32}function ot(_,N,D,ee){var he=_[N+0]+4,ye=35468*_[N+4]>>16,Se=Rt(_[N+4]),Te=35468*_[N+1]>>16;Ge(D,ee,0,he+Se,_=Rt(_[N+1]),Te),Ge(D,ee,1,he+ye,_,Te),Ge(D,ee,2,he-ye,_,Te),Ge(D,ee,3,he-Se,_,Te)}function Bt(_,N,D,ee,he){Ze(_,N,D,ee),he&&Ze(_,N+16,D,ee+4)}function Qt(_,N,D,ee){Au(_,N+0,D,ee,1),Au(_,N+32,D,ee+128,1)}function Yt(_,N,D,ee){var he;for(_=_[N+0]+4,he=0;4>he;++he)for(N=0;4>N;++N)ar(D,ee,N,he,_)}function fr(_,N,D,ee){_[N+0]&&Li(_,N+0,D,ee),_[N+16]&&Li(_,N+16,D,ee+4),_[N+32]&&Li(_,N+32,D,ee+128),_[N+48]&&Li(_,N+48,D,ee+128+4)}function Dt(_,N,D,ee){var he,ye=s(16);for(he=0;4>he;++he){var Se=_[N+0+he]+_[N+12+he],Te=_[N+4+he]+_[N+8+he],Le=_[N+4+he]-_[N+8+he],Ke=_[N+0+he]-_[N+12+he];ye[0+he]=Se+Te,ye[8+he]=Se-Te,ye[4+he]=Ke+Le,ye[12+he]=Ke-Le}for(he=0;4>he;++he)Se=(_=ye[0+4*he]+3)+ye[3+4*he],Te=ye[1+4*he]+ye[2+4*he],Le=ye[1+4*he]-ye[2+4*he],Ke=_-ye[3+4*he],D[ee+0]=Se+Te>>3,D[ee+16]=Ke+Le>>3,D[ee+32]=Se-Te>>3,D[ee+48]=Ke-Le>>3,ee+=64}function ur(_,N,D){var ee,he=N-32,ye=Ll,Se=255-_[he-1];for(ee=0;ee<D;++ee){var Te,Le=ye,Ke=Se+_[N-1];for(Te=0;Te<D;++Te)_[N+Te]=Le[Ke+_[he+Te]];N+=32}}function Ve(_,N){ur(_,N,4)}function zt(_,N){ur(_,N,8)}function yt(_,N){ur(_,N,16)}function St(_,N){var D;for(D=0;16>D;++D)n(_,N+32*D,_,N-32,16)}function sr(_,N){var D;for(D=16;0<D;--D)i(_,N,_[N-1],16),N+=32}function pr(_,N,D){var ee;for(ee=0;16>ee;++ee)i(N,D+32*ee,_,16)}function we(_,N){var D,ee=16;for(D=0;16>D;++D)ee+=_[N-1+32*D]+_[N+D-32];pr(ee>>5,_,N)}function Ie(_,N){var D,ee=8;for(D=0;16>D;++D)ee+=_[N-1+32*D];pr(ee>>4,_,N)}function tt(_,N){var D,ee=8;for(D=0;16>D;++D)ee+=_[N+D-32];pr(ee>>4,_,N)}function dt(_,N){pr(128,_,N)}function xt(_,N,D){return _+2*N+D+2>>2}function Cr(_,N){var D,ee=N-32;for(ee=new Uint8Array([xt(_[ee-1],_[ee+0],_[ee+1]),xt(_[ee+0],_[ee+1],_[ee+2]),xt(_[ee+1],_[ee+2],_[ee+3]),xt(_[ee+2],_[ee+3],_[ee+4])]),D=0;4>D;++D)n(_,N+32*D,ee,0,ee.length)}function nn(_,N){var D=_[N-1],ee=_[N-1+32],he=_[N-1+64],ye=_[N-1+96];le(_,N+0,16843009*xt(_[N-1-32],D,ee)),le(_,N+32,16843009*xt(D,ee,he)),le(_,N+64,16843009*xt(ee,he,ye)),le(_,N+96,16843009*xt(he,ye,ye))}function ct(_,N){var D,ee=4;for(D=0;4>D;++D)ee+=_[N+D-32]+_[N-1+32*D];for(ee>>=3,D=0;4>D;++D)i(_,N+32*D,ee,4)}function Ht(_,N){var D=_[N-1+0],ee=_[N-1+32],he=_[N-1+64],ye=_[N-1-32],Se=_[N+0-32],Te=_[N+1-32],Le=_[N+2-32],Ke=_[N+3-32];_[N+0+96]=xt(ee,he,_[N-1+96]),_[N+1+96]=_[N+0+64]=xt(D,ee,he),_[N+2+96]=_[N+1+64]=_[N+0+32]=xt(ye,D,ee),_[N+3+96]=_[N+2+64]=_[N+1+32]=_[N+0+0]=xt(Se,ye,D),_[N+3+64]=_[N+2+32]=_[N+1+0]=xt(Te,Se,ye),_[N+3+32]=_[N+2+0]=xt(Le,Te,Se),_[N+3+0]=xt(Ke,Le,Te)}function Ue(_,N){var D=_[N+1-32],ee=_[N+2-32],he=_[N+3-32],ye=_[N+4-32],Se=_[N+5-32],Te=_[N+6-32],Le=_[N+7-32];_[N+0+0]=xt(_[N+0-32],D,ee),_[N+1+0]=_[N+0+32]=xt(D,ee,he),_[N+2+0]=_[N+1+32]=_[N+0+64]=xt(ee,he,ye),_[N+3+0]=_[N+2+32]=_[N+1+64]=_[N+0+96]=xt(he,ye,Se),_[N+3+32]=_[N+2+64]=_[N+1+96]=xt(ye,Se,Te),_[N+3+64]=_[N+2+96]=xt(Se,Te,Le),_[N+3+96]=xt(Te,Le,Le)}function qe(_,N){var D=_[N-1+0],ee=_[N-1+32],he=_[N-1+64],ye=_[N-1-32],Se=_[N+0-32],Te=_[N+1-32],Le=_[N+2-32],Ke=_[N+3-32];_[N+0+0]=_[N+1+64]=ye+Se+1>>1,_[N+1+0]=_[N+2+64]=Se+Te+1>>1,_[N+2+0]=_[N+3+64]=Te+Le+1>>1,_[N+3+0]=Le+Ke+1>>1,_[N+0+96]=xt(he,ee,D),_[N+0+64]=xt(ee,D,ye),_[N+0+32]=_[N+1+96]=xt(D,ye,Se),_[N+1+32]=_[N+2+96]=xt(ye,Se,Te),_[N+2+32]=_[N+3+96]=xt(Se,Te,Le),_[N+3+32]=xt(Te,Le,Ke)}function at(_,N){var D=_[N+0-32],ee=_[N+1-32],he=_[N+2-32],ye=_[N+3-32],Se=_[N+4-32],Te=_[N+5-32],Le=_[N+6-32],Ke=_[N+7-32];_[N+0+0]=D+ee+1>>1,_[N+1+0]=_[N+0+64]=ee+he+1>>1,_[N+2+0]=_[N+1+64]=he+ye+1>>1,_[N+3+0]=_[N+2+64]=ye+Se+1>>1,_[N+0+32]=xt(D,ee,he),_[N+1+32]=_[N+0+96]=xt(ee,he,ye),_[N+2+32]=_[N+1+96]=xt(he,ye,Se),_[N+3+32]=_[N+2+96]=xt(ye,Se,Te),_[N+3+64]=xt(Se,Te,Le),_[N+3+96]=xt(Te,Le,Ke)}function Be(_,N){var D=_[N-1+0],ee=_[N-1+32],he=_[N-1+64],ye=_[N-1+96];_[N+0+0]=D+ee+1>>1,_[N+2+0]=_[N+0+32]=ee+he+1>>1,_[N+2+32]=_[N+0+64]=he+ye+1>>1,_[N+1+0]=xt(D,ee,he),_[N+3+0]=_[N+1+32]=xt(ee,he,ye),_[N+3+32]=_[N+1+64]=xt(he,ye,ye),_[N+3+64]=_[N+2+64]=_[N+0+96]=_[N+1+96]=_[N+2+96]=_[N+3+96]=ye}function vt(_,N){var D=_[N-1+0],ee=_[N-1+32],he=_[N-1+64],ye=_[N-1+96],Se=_[N-1-32],Te=_[N+0-32],Le=_[N+1-32],Ke=_[N+2-32];_[N+0+0]=_[N+2+32]=D+Se+1>>1,_[N+0+32]=_[N+2+64]=ee+D+1>>1,_[N+0+64]=_[N+2+96]=he+ee+1>>1,_[N+0+96]=ye+he+1>>1,_[N+3+0]=xt(Te,Le,Ke),_[N+2+0]=xt(Se,Te,Le),_[N+1+0]=_[N+3+32]=xt(D,Se,Te),_[N+1+32]=_[N+3+64]=xt(ee,D,Se),_[N+1+64]=_[N+3+96]=xt(he,ee,D),_[N+1+96]=xt(ye,he,ee)}function jt(_,N){var D;for(D=0;8>D;++D)n(_,N+32*D,_,N-32,8)}function $t(_,N){var D;for(D=0;8>D;++D)i(_,N,_[N-1],8),N+=32}function Rr(_,N,D){var ee;for(ee=0;8>ee;++ee)i(N,D+32*ee,_,8)}function Ur(_,N){var D,ee=8;for(D=0;8>D;++D)ee+=_[N+D-32]+_[N-1+32*D];Rr(ee>>4,_,N)}function en(_,N){var D,ee=4;for(D=0;8>D;++D)ee+=_[N+D-32];Rr(ee>>3,_,N)}function vn(_,N){var D,ee=4;for(D=0;8>D;++D)ee+=_[N-1+32*D];Rr(ee>>3,_,N)}function Nr(_,N){Rr(128,_,N)}function fn(_,N,D){var ee=_[N-D],he=_[N+0],ye=3*(he-ee)+e5[1020+_[N-2*D]-_[N+D]],Se=zy[112+(ye+4>>3)];_[N-D]=Ll[255+ee+zy[112+(ye+3>>3)]],_[N+0]=Ll[255+he-Se]}function rr(_,N,D,ee){var he=_[N+0],ye=_[N+D];return mc[255+_[N-2*D]-_[N-D]]>ee||mc[255+ye-he]>ee}function ve(_,N,D,ee){return 4*mc[255+_[N-D]-_[N+0]]+mc[255+_[N-2*D]-_[N+D]]<=ee}function rt(_,N,D,ee,he){var ye=_[N-3*D],Se=_[N-2*D],Te=_[N-D],Le=_[N+0],Ke=_[N+D],Et=_[N+2*D],nr=_[N+3*D];return 4*mc[255+Te-Le]+mc[255+Se-Ke]>ee?0:mc[255+_[N-4*D]-ye]<=he&&mc[255+ye-Se]<=he&&mc[255+Se-Te]<=he&&mc[255+nr-Et]<=he&&mc[255+Et-Ke]<=he&&mc[255+Ke-Le]<=he}function ut(_,N,D,ee){var he=2*ee+1;for(ee=0;16>ee;++ee)ve(_,N+ee,D,he)&&fn(_,N+ee,D)}function pt(_,N,D,ee){var he=2*ee+1;for(ee=0;16>ee;++ee)ve(_,N+ee*D,1,he)&&fn(_,N+ee*D,1)}function Pr(_,N,D,ee){var he;for(he=3;0<he;--he)ut(_,N+=4*D,D,ee)}function Kr(_,N,D,ee){var he;for(he=3;0<he;--he)pt(_,N+=4,D,ee)}function pn(_,N,D,ee,he,ye,Se,Te){for(ye=2*ye+1;0<he--;){if(rt(_,N,D,ye,Se))if(rr(_,N,D,Te))fn(_,N,D);else{var Le=_,Ke=N,Et=D,nr=Le[Ke-2*Et],Ye=Le[Ke-Et],Ft=Le[Ke+0],Xt=Le[Ke+Et],jr=Le[Ke+2*Et],tr=27*(Or=e5[1020+3*(Ft-Ye)+e5[1020+nr-Xt]])+63>>7,Er=18*Or+63>>7,Or=9*Or+63>>7;Le[Ke-3*Et]=Ll[255+Le[Ke-3*Et]+Or],Le[Ke-2*Et]=Ll[255+nr+Er],Le[Ke-Et]=Ll[255+Ye+tr],Le[Ke+0]=Ll[255+Ft-tr],Le[Ke+Et]=Ll[255+Xt-Er],Le[Ke+2*Et]=Ll[255+jr-Or]}N+=ee}}function Nn(_,N,D,ee,he,ye,Se,Te){for(ye=2*ye+1;0<he--;){if(rt(_,N,D,ye,Se))if(rr(_,N,D,Te))fn(_,N,D);else{var Le=_,Ke=N,Et=D,nr=Le[Ke-Et],Ye=Le[Ke+0],Ft=Le[Ke+Et],Xt=zy[112+(4+(jr=3*(Ye-nr))>>3)],jr=zy[112+(jr+3>>3)],tr=Xt+1>>1;Le[Ke-2*Et]=Ll[255+Le[Ke-2*Et]+tr],Le[Ke-Et]=Ll[255+nr+jr],Le[Ke+0]=Ll[255+Ye-Xt],Le[Ke+Et]=Ll[255+Ft-tr]}N+=ee}}function _n(_,N,D,ee,he,ye){pn(_,N,D,1,16,ee,he,ye)}function kn(_,N,D,ee,he,ye){pn(_,N,1,D,16,ee,he,ye)}function Wn(_,N,D,ee,he,ye){var Se;for(Se=3;0<Se;--Se)Nn(_,N+=4*D,D,1,16,ee,he,ye)}function M(_,N,D,ee,he,ye){var Se;for(Se=3;0<Se;--Se)Nn(_,N+=4,1,D,16,ee,he,ye)}function oe(_,N,D,ee,he,ye,Se,Te){pn(_,N,he,1,8,ye,Se,Te),pn(D,ee,he,1,8,ye,Se,Te)}function Re(_,N,D,ee,he,ye,Se,Te){pn(_,N,1,he,8,ye,Se,Te),pn(D,ee,1,he,8,ye,Se,Te)}function Je(_,N,D,ee,he,ye,Se,Te){Nn(_,N+4*he,he,1,8,ye,Se,Te),Nn(D,ee+4*he,he,1,8,ye,Se,Te)}function kt(_,N,D,ee,he,ye,Se,Te){Nn(_,N+4,1,he,8,ye,Se,Te),Nn(D,ee+4,1,he,8,ye,Se,Te)}function mr(){this.ba=new Xr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Vr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function lr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Sr(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Hr(){this.ua=0,this.Wa=new pe,this.vb=new pe,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new z,this.yc=new F}function Jr(){this.xb=this.a=0,this.l=new Mr,this.ca=new Xr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new K,this.Pb=0,this.wd=new K,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Hr,this.ab=0,this.gc=o(4,Sr),this.Oc=0}function me(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Mr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Pe(_,N,D,ee,he,ye,Se){for(_=_==null?0:_[N+0],N=0;N<Se;++N)he[ye+N]=_+D[ee+N]&255,_=he[ye+N]}function et(_,N,D,ee,he,ye,Se){var Te;if(_==null)Pe(null,null,D,ee,he,ye,Se);else for(Te=0;Te<Se;++Te)he[ye+Te]=_[N+Te]+D[ee+Te]&255}function xe(_,N,D,ee,he,ye,Se){if(_==null)Pe(null,null,D,ee,he,ye,Se);else{var Te,Le=_[N+0],Ke=Le,Et=Le;for(Te=0;Te<Se;++Te)Ke=Et+(Le=_[N+Te])-Ke,Et=D[ee+Te]+(-256&Ke?0>Ke?0:255:Ke)&255,Ke=Le,he[ye+Te]=Et}}function ze(_,N,D,ee){var he=N.width,ye=N.o;if(t(_!=null&&N!=null),0>D||0>=ee||D+ee>ye)return null;if(!_.Cc){if(_.ga==null){var Se;if(_.ga=new me,(Se=_.ga==null)||(Se=N.width*N.o,t(_.Gb.length==0),_.Gb=s(Se),_.Uc=0,_.Gb==null?Se=0:(_.mb=_.Gb,_.nb=_.Uc,_.rc=null,Se=1),Se=!Se),!Se){Se=_.ga;var Te=_.Fa,Le=_.P,Ke=_.qc,Et=_.mb,nr=_.nb,Ye=Le+1,Ft=Ke-1,Xt=Se.l;if(t(Te!=null&&Et!=null&&N!=null),vf[0]=null,vf[1]=Pe,vf[2]=et,vf[3]=xe,Se.ca=Et,Se.tb=nr,Se.c=N.width,Se.i=N.height,t(0<Se.c&&0<Se.i),1>=Ke)N=0;else if(Se.$a=3&Te[Le+0],Se.Z=Te[Le+0]>>2&3,Se.Lc=Te[Le+0]>>4&3,Le=Te[Le+0]>>6&3,0>Se.$a||1<Se.$a||4<=Se.Z||1<Se.Lc||Le)N=0;else if(Xt.put=Ce,Xt.ac=Me,Xt.bc=It,Xt.ma=Se,Xt.width=N.width,Xt.height=N.height,Xt.Da=N.Da,Xt.v=N.v,Xt.va=N.va,Xt.j=N.j,Xt.o=N.o,Se.$a)e:{t(Se.$a==1),N=Fe();t:for(;;){if(N==null){N=0;break e}if(t(Se!=null),Se.mc=N,N.c=Se.c,N.i=Se.i,N.l=Se.l,N.l.ma=Se,N.l.width=Se.c,N.l.height=Se.i,N.a=0,G(N.m,Te,Ye,Ft),!$e(Se.c,Se.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&ue(N.s)?(Se.ic=1,Te=N.c*N.i,N.Ta=null,N.Ua=0,N.V=s(Te),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(Se.ic=0,N=st(N,Se.c)),!N))break t;N=1;break e}Se.mc=null,N=0}else N=Ft>=Se.c*Se.i;Se=!N}if(Se)return null;_.ga.Lc!=1?_.Ga=0:ee=ye-D}t(_.ga!=null),t(D+ee<=ye);e:{if(N=(Te=_.ga).c,ye=Te.l.o,Te.$a==0){if(Ye=_.rc,Ft=_.Vc,Xt=_.Fa,Le=_.P+1+D*N,Ke=_.mb,Et=_.nb+D*N,t(Le<=_.P+_.qc),Te.Z!=0)for(t(vf[Te.Z]!=null),Se=0;Se<ee;++Se)vf[Te.Z](Ye,Ft,Xt,Le,Ke,Et,N),Ye=Ke,Ft=Et,Et+=N,Le+=N;else for(Se=0;Se<ee;++Se)n(Ke,Et,Xt,Le,N),Ye=Ke,Ft=Et,Et+=N,Le+=N;_.rc=Ye,_.Vc=Ft}else{if(t(Te.mc!=null),N=D+ee,t((Se=Te.mc)!=null),t(N<=Se.i),Se.C>=N)N=1;else if(Te.ic||zr(),Te.ic){Te=Se.V,Ye=Se.Ba,Ft=Se.c;var jr=Se.i,tr=(Xt=1,Le=Se.$/Ft,Ke=Se.$%Ft,Et=Se.m,nr=Se.s,Se.$),Er=Ft*jr,Or=Ft*N,Qr=nr.wc,$r=tr<Or?ne(nr,Ke,Le):null;t(tr<=Er),t(N<=jr),t(ue(nr));t:for(;;){for(;!Et.h&&tr<Or;){if(Ke&Qr||($r=ne(nr,Ke,Le)),t($r!=null),q(Et),256>(jr=hr($r.G[0],$r.H[0],Et)))Te[Ye+tr]=jr,++tr,++Ke>=Ft&&(Ke=0,++Le<=N&&!(Le%16)&&je(Se,Le));else{if(!(280>jr)){Xt=0;break t}jr=Ot(jr-256,Et);var $n,Pn=hr($r.G[4],$r.H[4],Et);if(q(Et),!(tr>=(Pn=er(Ft,Pn=Ot(Pn,Et)))&&Er-tr>=jr)){Xt=0;break t}for($n=0;$n<jr;++$n)Te[Ye+tr+$n]=Te[Ye+tr+$n-Pn];for(tr+=jr,Ke+=jr;Ke>=Ft;)Ke-=Ft,++Le<=N&&!(Le%16)&&je(Se,Le);tr<Or&&Ke&Qr&&($r=ne(nr,Ke,Le))}t(Et.h==R(Et))}je(Se,Le>N?N:Le);break t}!Xt||Et.h&&tr<Er?(Xt=0,Se.a=Et.h?5:3):Se.$=tr,N=Xt}else N=gt(Se,Se.V,Se.Ba,Se.c,Se.i,N,Wt);if(!N){ee=0;break e}}D+ee>=ye&&(_.Cc=1),ee=1}if(!ee)return null;if(_.Cc&&((ee=_.ga)!=null&&(ee.mc=null),_.ga=null,0<_.Ga))return alert("todo:WebPDequantizeLevels"),null}return _.nb+D*he}function Vt(_,N,D,ee,he,ye){for(;0<he--;){var Se,Te=_,Le=N+(D?1:0),Ke=_,Et=N+(D?0:3);for(Se=0;Se<ee;++Se){var nr=Ke[Et+4*Se];nr!=255&&(nr*=32897,Te[Le+4*Se+0]=Te[Le+4*Se+0]*nr>>23,Te[Le+4*Se+1]=Te[Le+4*Se+1]*nr>>23,Te[Le+4*Se+2]=Te[Le+4*Se+2]*nr>>23)}N+=ye}}function Nt(_,N,D,ee,he){for(;0<ee--;){var ye;for(ye=0;ye<D;++ye){var Se=_[N+2*ye+0],Te=15&(Ke=_[N+2*ye+1]),Le=4369*Te,Ke=(240&Ke|Ke>>4)*Le>>16;_[N+2*ye+0]=(240&Se|Se>>4)*Le>>16&240|(15&Se|Se<<4)*Le>>16>>4&15,_[N+2*ye+1]=240&Ke|Te}N+=he}}function br(_,N,D,ee,he,ye,Se,Te){var Le,Ke,Et=255;for(Ke=0;Ke<he;++Ke){for(Le=0;Le<ee;++Le){var nr=_[N+Le];ye[Se+4*Le]=nr,Et&=nr}N+=D,Se+=Te}return Et!=255}function wr(_,N,D,ee,he){var ye;for(ye=0;ye<he;++ye)D[ee+ye]=_[N+ye]>>8}function zr(){Ag=Vt,R6=Nt,B6=br,F6=wr}function Wr(_,N,D){P[_]=function(ee,he,ye,Se,Te,Le,Ke,Et,nr,Ye,Ft,Xt,jr,tr,Er,Or,Qr){var $r,$n=Qr-1>>1,Pn=Te[Le+0]|Ke[Et+0]<<16,oi=nr[Ye+0]|Ft[Xt+0]<<16;t(ee!=null);var Rn=3*Pn+oi+131074>>2;for(N(ee[he+0],255&Rn,Rn>>16,jr,tr),ye!=null&&(Rn=3*oi+Pn+131074>>2,N(ye[Se+0],255&Rn,Rn>>16,Er,Or)),$r=1;$r<=$n;++$r){var xi=Te[Le+$r]|Ke[Et+$r]<<16,_s=nr[Ye+$r]|Ft[Xt+$r]<<16,li=Pn+xi+oi+_s+524296,Bn=li+2*(xi+oi)>>3;Rn=Bn+Pn>>1,Pn=(li=li+2*(Pn+_s)>>3)+xi>>1,N(ee[he+2*$r-1],255&Rn,Rn>>16,jr,tr+(2*$r-1)*D),N(ee[he+2*$r-0],255&Pn,Pn>>16,jr,tr+(2*$r-0)*D),ye!=null&&(Rn=li+oi>>1,Pn=Bn+_s>>1,N(ye[Se+2*$r-1],255&Rn,Rn>>16,Er,Or+(2*$r-1)*D),N(ye[Se+2*$r+0],255&Pn,Pn>>16,Er,Or+(2*$r+0)*D)),Pn=xi,oi=_s}1&Qr||(Rn=3*Pn+oi+131074>>2,N(ee[he+Qr-1],255&Rn,Rn>>16,jr,tr+(Qr-1)*D),ye!=null&&(Rn=3*oi+Pn+131074>>2,N(ye[Se+Qr-1],255&Rn,Rn>>16,Er,Or+(Qr-1)*D)))}}function sn(){gc[Wy]=VK,gc[qy]=K6,gc[W6]=GK,gc[Hy]=Y6,gc[Vy]=X6,gc[t5]=Q6,gc[q6]=KK,gc[r5]=K6,gc[n5]=Y6,gc[Gy]=X6,gc[i5]=Q6}function an(_){return _&-16384?0>_?0:255:_>>YK}function Lr(_,N){return an((19077*_>>8)+(26149*N>>8)-14234)}function mn(_,N,D){return an((19077*_>>8)-(6419*N>>8)-(13320*D>>8)+8708)}function cn(_,N){return an((19077*_>>8)+(33050*N>>8)-17685)}function xn(_,N,D,ee,he){ee[he+0]=Lr(_,D),ee[he+1]=mn(_,N,D),ee[he+2]=cn(_,N)}function Ir(_,N,D,ee,he){ee[he+0]=cn(_,N),ee[he+1]=mn(_,N,D),ee[he+2]=Lr(_,D)}function jn(_,N,D,ee,he){var ye=mn(_,N,D);N=ye<<3&224|cn(_,N)>>3,ee[he+0]=248&Lr(_,D)|ye>>5,ee[he+1]=N}function Hn(_,N,D,ee,he){var ye=240&cn(_,N)|15;ee[he+0]=240&Lr(_,D)|mn(_,N,D)>>4,ee[he+1]=ye}function Mn(_,N,D,ee,he){ee[he+0]=255,xn(_,N,D,ee,he+1)}function Kn(_,N,D,ee,he){Ir(_,N,D,ee,he),ee[he+3]=255}function Fn(_,N,D,ee,he){xn(_,N,D,ee,he),ee[he+3]=255}function Xi(_,N,D){P[_]=function(ee,he,ye,Se,Te,Le,Ke,Et,nr){for(var Ye=Et+(-2&nr)*D;Et!=Ye;)N(ee[he+0],ye[Se+0],Te[Le+0],Ke,Et),N(ee[he+1],ye[Se+0],Te[Le+0],Ke,Et+D),he+=2,++Se,++Le,Et+=2*D;1&nr&&N(ee[he+0],ye[Se+0],Te[Le+0],Ke,Et)}}function zo(_,N,D){return D==0?_==0?N==0?6:5:N==0?4:0:D}function Ol(_,N,D,ee,he){switch(_>>>30){case 3:Au(N,D,ee,he,0);break;case 2:pc(N,D,ee,he);break;case 1:Li(N,D,ee,he)}}function Ya(_,N){var D,ee,he=N.M,ye=N.Nb,Se=_.oc,Te=_.pc+40,Le=_.oc,Ke=_.pc+584,Et=_.oc,nr=_.pc+600;for(D=0;16>D;++D)Se[Te+32*D-1]=129;for(D=0;8>D;++D)Le[Ke+32*D-1]=129,Et[nr+32*D-1]=129;for(0<he?Se[Te-1-32]=Le[Ke-1-32]=Et[nr-1-32]=129:(i(Se,Te-32-1,127,21),i(Le,Ke-32-1,127,9),i(Et,nr-32-1,127,9)),ee=0;ee<_.za;++ee){var Ye=N.ya[N.aa+ee];if(0<ee){for(D=-1;16>D;++D)n(Se,Te+32*D-4,Se,Te+32*D+12,4);for(D=-1;8>D;++D)n(Le,Ke+32*D-4,Le,Ke+32*D+4,4),n(Et,nr+32*D-4,Et,nr+32*D+4,4)}var Ft=_.Gd,Xt=_.Hd+ee,jr=Ye.ad,tr=Ye.Hc;if(0<he&&(n(Se,Te-32,Ft[Xt].y,0,16),n(Le,Ke-32,Ft[Xt].f,0,8),n(Et,nr-32,Ft[Xt].ea,0,8)),Ye.Za){var Er=Se,Or=Te-32+16;for(0<he&&(ee>=_.za-1?i(Er,Or,Ft[Xt].y[15],4):n(Er,Or,Ft[Xt+1].y,0,4)),D=0;4>D;D++)Er[Or+128+D]=Er[Or+256+D]=Er[Or+384+D]=Er[Or+0+D];for(D=0;16>D;++D,tr<<=2)Er=Se,Or=Te+Z6[D],Yc[Ye.Ob[D]](Er,Or),Ol(tr,jr,16*+D,Er,Or)}else if(Er=zo(ee,he,Ye.Ob[0]),bf[Er](Se,Te),tr!=0)for(D=0;16>D;++D,tr<<=2)Ol(tr,jr,16*+D,Se,Te+Z6[D]);for(D=Ye.Gc,Er=zo(ee,he,Ye.Dd),xd[Er](Le,Ke),xd[Er](Et,nr),tr=jr,Er=Le,Or=Ke,255&(Ye=0|D)&&(170&Ye?Nu(tr,256,Er,Or):Ji(tr,256,Er,Or)),Ye=Et,tr=nr,255&(D>>=8)&&(170&D?Nu(jr,320,Ye,tr):Ji(jr,320,Ye,tr)),he<_.Ub-1&&(n(Ft[Xt].y,0,Se,Te+480,16),n(Ft[Xt].f,0,Le,Ke+224,8),n(Ft[Xt].ea,0,Et,nr+224,8)),D=8*ye*_.B,Ft=_.sa,Xt=_.ta+16*ee+16*ye*_.R,jr=_.qa,Ye=_.ra+8*ee+D,tr=_.Ha,Er=_.Ia+8*ee+D,D=0;16>D;++D)n(Ft,Xt+D*_.R,Se,Te+32*D,16);for(D=0;8>D;++D)n(jr,Ye+D*_.B,Le,Ke+32*D,8),n(tr,Er+D*_.B,Et,nr+32*D,8)}}function Wo(_,N,D,ee,he,ye,Se,Te,Le){var Ke=[0],Et=[0],nr=0,Ye=Le!=null?Le.kd:0,Ft=Le??new lr;if(_==null||12>D)return 7;Ft.data=_,Ft.w=N,Ft.ha=D,N=[N],D=[D],Ft.gb=[Ft.gb];e:{var Xt=N,jr=D,tr=Ft.gb;if(t(_!=null),t(jr!=null),t(tr!=null),tr[0]=0,12<=jr[0]&&!r(_,Xt[0],"RIFF")){if(r(_,Xt[0]+8,"WEBP")){tr=3;break e}var Er=ae(_,Xt[0]+4);if(12>Er||4294967286<Er){tr=3;break e}if(Ye&&Er>jr[0]-8){tr=7;break e}tr[0]=Er,Xt[0]+=12,jr[0]-=12}tr=0}if(tr!=0)return tr;for(Er=0<Ft.gb[0],D=D[0];;){e:{var Or=_;jr=N,tr=D;var Qr=Ke,$r=Et,$n=Xt=[0];if((Rn=nr=[nr])[0]=0,8>tr[0])tr=7;else{if(!r(Or,jr[0],"VP8X")){if(ae(Or,jr[0]+4)!=10){tr=3;break e}if(18>tr[0]){tr=7;break e}var Pn=ae(Or,jr[0]+8),oi=1+H(Or,jr[0]+12);if(2147483648<=oi*(Or=1+H(Or,jr[0]+15))){tr=3;break e}$n!=null&&($n[0]=Pn),Qr!=null&&(Qr[0]=oi),$r!=null&&($r[0]=Or),jr[0]+=18,tr[0]-=18,Rn[0]=1}tr=0}}if(nr=nr[0],Xt=Xt[0],tr!=0)return tr;if(jr=!!(2&Xt),!Er&&nr)return 3;if(ye!=null&&(ye[0]=!!(16&Xt)),Se!=null&&(Se[0]=jr),Te!=null&&(Te[0]=0),Se=Ke[0],Xt=Et[0],nr&&jr&&Le==null){tr=0;break}if(4>D){tr=7;break}if(Er&&nr||!Er&&!nr&&!r(_,N[0],"ALPH")){D=[D],Ft.na=[Ft.na],Ft.P=[Ft.P],Ft.Sa=[Ft.Sa];e:{Pn=_,tr=N,Er=D;var Rn=Ft.gb;Qr=Ft.na,$r=Ft.P,$n=Ft.Sa,oi=22,t(Pn!=null),t(Er!=null),Or=tr[0];var xi=Er[0];for(t(Qr!=null),t($n!=null),Qr[0]=null,$r[0]=null,$n[0]=0;;){if(tr[0]=Or,Er[0]=xi,8>xi){tr=7;break e}var _s=ae(Pn,Or+4);if(4294967286<_s){tr=3;break e}var li=8+_s+1&-2;if(oi+=li,0<Rn&&oi>Rn){tr=3;break e}if(!r(Pn,Or,"VP8 ")||!r(Pn,Or,"VP8L")){tr=0;break e}if(xi[0]<li){tr=7;break e}r(Pn,Or,"ALPH")||(Qr[0]=Pn,$r[0]=Or+8,$n[0]=_s),Or+=li,xi-=li}}if(D=D[0],Ft.na=Ft.na[0],Ft.P=Ft.P[0],Ft.Sa=Ft.Sa[0],tr!=0)break}D=[D],Ft.Ja=[Ft.Ja],Ft.xa=[Ft.xa];e:if(Rn=_,tr=N,Er=D,Qr=Ft.gb[0],$r=Ft.Ja,$n=Ft.xa,Pn=tr[0],Or=!r(Rn,Pn,"VP8 "),oi=!r(Rn,Pn,"VP8L"),t(Rn!=null),t(Er!=null),t($r!=null),t($n!=null),8>Er[0])tr=7;else{if(Or||oi){if(Rn=ae(Rn,Pn+4),12<=Qr&&Rn>Qr-12){tr=3;break e}if(Ye&&Rn>Er[0]-8){tr=7;break e}$r[0]=Rn,tr[0]+=8,Er[0]-=8,$n[0]=oi}else $n[0]=5<=Er[0]&&Rn[Pn+0]==47&&!(Rn[Pn+4]>>5),$r[0]=Er[0];tr=0}if(D=D[0],Ft.Ja=Ft.Ja[0],Ft.xa=Ft.xa[0],N=N[0],tr!=0)break;if(4294967286<Ft.Ja)return 3;if(Te==null||jr||(Te[0]=Ft.xa?2:1),Se=[Se],Xt=[Xt],Ft.xa){if(5>D){tr=7;break}Te=Se,Ye=Xt,jr=ye,_==null||5>D?_=0:5<=D&&_[N+0]==47&&!(_[N+4]>>5)?(Er=[0],Rn=[0],Qr=[0],G($r=new K,_,N,D),ft($r,Er,Rn,Qr)?(Te!=null&&(Te[0]=Er[0]),Ye!=null&&(Ye[0]=Rn[0]),jr!=null&&(jr[0]=Qr[0]),_=1):_=0):_=0}else{if(10>D){tr=7;break}Te=Xt,_==null||10>D||!Kt(_,N+3,D-3)?_=0:(Ye=_[N+0]|_[N+1]<<8|_[N+2]<<16,jr=16383&(_[N+7]<<8|_[N+6]),_=16383&(_[N+9]<<8|_[N+8]),1&Ye||3<(Ye>>1&7)||!(Ye>>4&1)||Ye>>5>=Ft.Ja||!jr||!_?_=0:(Se&&(Se[0]=jr),Te&&(Te[0]=_),_=1))}if(!_||(Se=Se[0],Xt=Xt[0],nr&&(Ke[0]!=Se||Et[0]!=Xt)))return 3;Le!=null&&(Le[0]=Ft,Le.offset=N-Le.w,t(4294967286>N-Le.w),t(Le.offset==Le.ha-D));break}return tr==0||tr==7&&nr&&Le==null?(ye!=null&&(ye[0]|=Ft.na!=null&&0<Ft.na.length),ee!=null&&(ee[0]=Se),he!=null&&(he[0]=Xt),0):tr}function Ml(_,N,D){var ee=N.width,he=N.height,ye=0,Se=0,Te=ee,Le=he;if(N.Da=_!=null&&0<_.Da,N.Da&&(Te=_.cd,Le=_.bd,ye=_.v,Se=_.j,11>D||(ye&=-2,Se&=-2),0>ye||0>Se||0>=Te||0>=Le||ye+Te>ee||Se+Le>he))return 0;if(N.v=ye,N.j=Se,N.va=ye+Te,N.o=Se+Le,N.U=Te,N.T=Le,N.da=_!=null&&0<_.da,N.da){if(!Oe(Te,Le,D=[_.ib],ye=[_.hb]))return 0;N.ib=D[0],N.hb=ye[0]}return N.ob=_!=null&&_.ob,N.Kb=_==null||!_.Sd,N.da&&(N.ob=N.ib<3*ee/4&&N.hb<3*he/4,N.Kb=0),1}function dl(_){if(_==null)return 2;if(11>_.S){var N=_.f.RGBA;N.fb+=(_.height-1)*N.A,N.A=-N.A}else N=_.f.kb,_=_.height,N.O+=(_-1)*N.fa,N.fa=-N.fa,N.N+=(_-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(_-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(_-1)*N.lb,N.lb=-N.lb);return 0}function xa(_,N,D,ee){if(ee==null||0>=_||0>=N)return 2;if(D!=null){if(D.Da){var he=D.cd,ye=D.bd,Se=-2&D.v,Te=-2&D.j;if(0>Se||0>Te||0>=he||0>=ye||Se+he>_||Te+ye>N)return 2;_=he,N=ye}if(D.da){if(!Oe(_,N,he=[D.ib],ye=[D.hb]))return 2;_=he[0],N=ye[0]}}ee.width=_,ee.height=N;e:{var Le=ee.width,Ke=ee.height;if(_=ee.S,0>=Le||0>=Ke||!(_>=Wy&&13>_))_=2;else{if(0>=ee.Rd&&ee.sd==null){Se=ye=he=N=0;var Et=(Te=Le*eT[_])*Ke;if(11>_||(ye=(Ke+1)/2*(N=(Le+1)/2),_==12&&(Se=(he=Le)*Ke)),(Ke=s(Et+2*ye+Se))==null){_=1;break e}ee.sd=Ke,11>_?((Le=ee.f.RGBA).eb=Ke,Le.fb=0,Le.A=Te,Le.size=Et):((Le=ee.f.kb).y=Ke,Le.O=0,Le.fa=Te,Le.Fd=Et,Le.f=Ke,Le.N=0+Et,Le.Ab=N,Le.Cd=ye,Le.ea=Ke,Le.W=0+Et+ye,Le.Db=N,Le.Ed=ye,_==12&&(Le.F=Ke,Le.J=0+Et+2*ye),Le.Tc=Se,Le.lb=he)}if(N=1,he=ee.S,ye=ee.width,Se=ee.height,he>=Wy&&13>he)if(11>he)_=ee.f.RGBA,N&=(Te=Math.abs(_.A))*(Se-1)+ye<=_.size,N&=Te>=ye*eT[he],N&=_.eb!=null;else{_=ee.f.kb,Te=(ye+1)/2,Et=(Se+1)/2,Le=Math.abs(_.fa),Ke=Math.abs(_.Ab);var nr=Math.abs(_.Db),Ye=Math.abs(_.lb),Ft=Ye*(Se-1)+ye;N&=Le*(Se-1)+ye<=_.Fd,N&=Ke*(Et-1)+Te<=_.Cd,N=(N&=nr*(Et-1)+Te<=_.Ed)&Le>=ye&Ke>=Te&nr>=Te,N&=_.y!=null,N&=_.f!=null,N&=_.ea!=null,he==12&&(N&=Ye>=ye,N&=Ft<=_.Tc,N&=_.F!=null)}else N=0;_=N?0:2}}return _!=0||D!=null&&D.fd&&(_=dl(ee)),_}var oa=64,la=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ya=24,qo=32,gi=8,Js=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_e("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(_){return _},P.Predictor2=function(_,N,D){return N[D+0]},P.Predictor3=function(_,N,D){return N[D+1]},P.Predictor4=function(_,N,D){return N[D-1]},P.Predictor5=function(_,N,D){return We(We(_,N[D+1]),N[D+0])},P.Predictor6=function(_,N,D){return We(_,N[D-1])},P.Predictor7=function(_,N,D){return We(_,N[D+0])},P.Predictor8=function(_,N,D){return We(N[D-1],N[D+0])},P.Predictor9=function(_,N,D){return We(N[D+0],N[D+1])},P.Predictor10=function(_,N,D){return We(We(_,N[D-1]),We(N[D+0],N[D+1]))},P.Predictor11=function(_,N,D){var ee=N[D+0];return 0>=Xe(ee>>24&255,_>>24&255,(N=N[D-1])>>24&255)+Xe(ee>>16&255,_>>16&255,N>>16&255)+Xe(ee>>8&255,_>>8&255,N>>8&255)+Xe(255&ee,255&_,255&N)?ee:_},P.Predictor12=function(_,N,D){var ee=N[D+0];return(Ct((_>>24&255)+(ee>>24&255)-((N=N[D-1])>>24&255))<<24|Ct((_>>16&255)+(ee>>16&255)-(N>>16&255))<<16|Ct((_>>8&255)+(ee>>8&255)-(N>>8&255))<<8|Ct((255&_)+(255&ee)-(255&N)))>>>0},P.Predictor13=function(_,N,D){var ee=N[D-1];return(_t((_=We(_,N[D+0]))>>24&255,ee>>24&255)<<24|_t(_>>16&255,ee>>16&255)<<16|_t(_>>8&255,ee>>8&255)<<8|_t(255&_,255&ee))>>>0};var uc=P.PredictorAdd0;P.PredictorAdd1=nt,_e("Predictor2","PredictorAdd2"),_e("Predictor3","PredictorAdd3"),_e("Predictor4","PredictorAdd4"),_e("Predictor5","PredictorAdd5"),_e("Predictor6","PredictorAdd6"),_e("Predictor7","PredictorAdd7"),_e("Predictor8","PredictorAdd8"),_e("Predictor9","PredictorAdd9"),_e("Predictor10","PredictorAdd10"),_e("Predictor11","PredictorAdd11"),_e("Predictor12","PredictorAdd12"),_e("Predictor13","PredictorAdd13");var dc=P.PredictorAdd2;ge("ColorIndexInverseTransform","MapARGB","32b",function(_){return _>>8&255},function(_){return _}),ge("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(_){return _},function(_){return _>>8&255});var ki,Ei=P.ColorIndexInverseTransform,Qi=P.MapARGB,yo=P.VP8LColorIndexInverseTransformAlpha,pd=P.MapAlpha,md=P.VP8LPredictorsAdd=[];md.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var ku,yf,Gc,fc,hc,ju,Kc,Au,pc,Nu,Li,Ji,Xa,Ss,gd,jg,up,Uy,E6,T6,P6,O6,M6,L6,Ag,R6,B6,F6,I6=s(511),D6=s(2041),$6=s(225),U6=s(767),z6=0,e5=D6,zy=$6,Ll=U6,mc=I6,Wy=0,qy=1,W6=2,Hy=3,Vy=4,t5=5,q6=6,r5=7,n5=8,Gy=9,i5=10,OK=[2,3,7],MK=[3,3,11],H6=[280,256,256,256,40],LK=[0,1,1,1,0],RK=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],BK=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],FK=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],IK=8,a5=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],s5=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Ng=null,DK=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],$K=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],V6=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],UK=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],zK=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],WK=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],qK=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],bf=[],Yc=[],xd=[],HK=1,G6=2,vf=[],gc=[];Wr("UpsampleRgbLinePair",xn,3),Wr("UpsampleBgrLinePair",Ir,3),Wr("UpsampleRgbaLinePair",Fn,4),Wr("UpsampleBgraLinePair",Kn,4),Wr("UpsampleArgbLinePair",Mn,4),Wr("UpsampleRgba4444LinePair",Hn,2),Wr("UpsampleRgb565LinePair",jn,2);var VK=P.UpsampleRgbLinePair,GK=P.UpsampleBgrLinePair,K6=P.UpsampleRgbaLinePair,Y6=P.UpsampleBgraLinePair,X6=P.UpsampleArgbLinePair,Q6=P.UpsampleRgba4444LinePair,KK=P.UpsampleRgb565LinePair,Ky=16,Yy=1<<Ky-1,Cg=-227,o5=482,YK=6,J6=0,XK=s(256),QK=s(256),JK=s(256),ZK=s(256),eY=s(o5-Cg),tY=s(o5-Cg);Xi("YuvToRgbRow",xn,3),Xi("YuvToBgrRow",Ir,3),Xi("YuvToRgbaRow",Fn,4),Xi("YuvToBgraRow",Kn,4),Xi("YuvToArgbRow",Mn,4),Xi("YuvToRgba4444Row",Hn,2),Xi("YuvToRgb565Row",jn,2);var Z6=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Xy=[0,2,8],rY=[8,7,6,4,4,2,2,2,1,1,1,1],nY=1;this.WebPDecodeRGBA=function(_,N,D,ee,he){var ye=qy,Se=new mr,Te=new Xr;Se.ba=Te,Te.S=ye,Te.width=[Te.width],Te.height=[Te.height];var Le=Te.width,Ke=Te.height,Et=new Br;if(Et==null||_==null)var nr=2;else t(Et!=null),nr=Wo(_,N,D,Et.width,Et.height,Et.Pd,Et.Qd,Et.format,null);if(nr!=0?Le=0:(Le!=null&&(Le[0]=Et.width[0]),Ke!=null&&(Ke[0]=Et.height[0]),Le=1),Le){Te.width=Te.width[0],Te.height=Te.height[0],ee!=null&&(ee[0]=Te.width),he!=null&&(he[0]=Te.height);e:{if(ee=new Mr,(he=new lr).data=_,he.w=N,he.ha=D,he.kd=1,N=[0],t(he!=null),((_=Wo(he.data,he.w,he.ha,null,null,null,N,null,he))==0||_==7)&&N[0]&&(_=4),(N=_)==0){if(t(Se!=null),ee.data=he.data,ee.w=he.w+he.offset,ee.ha=he.ha-he.offset,ee.put=Ce,ee.ac=Me,ee.bc=It,ee.ma=Se,he.xa){if((_=Fe())==null){Se=1;break e}if(function(Ye,Ft){var Xt=[0],jr=[0],tr=[0];t:for(;;){if(Ye==null)return 0;if(Ft==null)return Ye.a=2,0;if(Ye.l=Ft,Ye.a=0,G(Ye.m,Ft.data,Ft.w,Ft.ha),!ft(Ye.m,Xt,jr,tr)){Ye.a=3;break t}if(Ye.xb=G6,Ft.width=Xt[0],Ft.height=jr[0],!$e(Xt[0],jr[0],1,Ye,null))break t;return 1}return t(Ye.a!=0),0}(_,ee)){if(ee=(N=xa(ee.width,ee.height,Se.Oa,Se.ba))==0){t:{ee=_;r:for(;;){if(ee==null){ee=0;break t}if(t(ee.s.yc!=null),t(ee.s.Ya!=null),t(0<ee.s.Wb),t((D=ee.l)!=null),t((he=D.ma)!=null),ee.xb!=0){if(ee.ca=he.ba,ee.tb=he.tb,t(ee.ca!=null),!Ml(he.Oa,D,Hy)){ee.a=2;break r}if(!st(ee,D.width)||D.da)break r;if((D.da||Tt(ee.ca.S))&&zr(),11>ee.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),ee.ca.f.kb.F!=null&&zr()),ee.Pb&&0<ee.s.ua&&ee.s.vb.X==null&&!I(ee.s.vb,ee.s.Wa.Xa)){ee.a=1;break r}ee.xb=0}if(!gt(ee,ee.V,ee.Ba,ee.c,ee.i,D.o,te))break r;he.Dc=ee.Ma,ee=1;break t}t(ee.a!=0),ee=0}ee=!ee}ee&&(N=_.a)}else N=_.a}else{if((_=new Ar)==null){Se=1;break e}if(_.Fa=he.na,_.P=he.P,_.qc=he.Sa,it(_,ee)){if((N=xa(ee.width,ee.height,Se.Oa,Se.ba))==0){if(_.Aa=0,D=Se.Oa,t((he=_)!=null),D!=null){if(0<(Le=0>(Le=D.Md)?0:100<Le?255:255*Le/100)){for(Ke=Et=0;4>Ke;++Ke)12>(nr=he.pb[Ke]).lc&&(nr.ia=Le*rY[0>nr.lc?0:nr.lc]>>3),Et|=nr.ia;Et&&(alert("todo:VP8InitRandom"),he.ia=1)}he.Ga=D.Id,100<he.Ga?he.Ga=100:0>he.Ga&&(he.Ga=0)}(function(Ye,Ft){if(Ye==null)return 0;if(Ft==null)return Zt(Ye,2,"NULL VP8Io parameter in VP8Decode().");if(!Ye.cb&&!it(Ye,Ft))return 0;if(t(Ye.cb),Ft.ac==null||Ft.ac(Ft)){Ft.ob&&(Ye.L=0);var Xt=Xy[Ye.L];if(Ye.L==2?(Ye.yb=0,Ye.zb=0):(Ye.yb=Ft.v-Xt>>4,Ye.zb=Ft.j-Xt>>4,0>Ye.yb&&(Ye.yb=0),0>Ye.zb&&(Ye.zb=0)),Ye.Va=Ft.o+15+Xt>>4,Ye.Hb=Ft.va+15+Xt>>4,Ye.Hb>Ye.za&&(Ye.Hb=Ye.za),Ye.Va>Ye.Ub&&(Ye.Va=Ye.Ub),0<Ye.L){var jr=Ye.ed;for(Xt=0;4>Xt;++Xt){var tr;if(Ye.Qa.Cb){var Er=Ye.Qa.Lb[Xt];Ye.Qa.Fb||(Er+=jr.Tb)}else Er=jr.Tb;for(tr=0;1>=tr;++tr){var Or=Ye.gd[Xt][tr],Qr=Er;if(jr.Pc&&(Qr+=jr.vd[0],tr&&(Qr+=jr.od[0])),0<(Qr=0>Qr?0:63<Qr?63:Qr)){var $r=Qr;0<jr.wb&&($r=4<jr.wb?$r>>2:$r>>1)>9-jr.wb&&($r=9-jr.wb),1>$r&&($r=1),Or.dd=$r,Or.tc=2*Qr+$r,Or.ld=40<=Qr?2:15<=Qr?1:0}else Or.tc=0;Or.La=tr}}}Xt=0}else Zt(Ye,6,"Frame setup failed"),Xt=Ye.a;if(Xt=Xt==0){if(Xt){Ye.$c=0,0<Ye.Aa||(Ye.Ic=nY);t:{Xt=Ye.Ic,jr=4*($r=Ye.za);var $n=32*$r,Pn=$r+1,oi=0<Ye.L?$r*(0<Ye.Aa?2:1):0,Rn=(Ye.Aa==2?2:1)*$r;if((Or=jr+832+(tr=3*(16*Xt+Xy[Ye.L])/2*$n)+(Er=Ye.Fa!=null&&0<Ye.Fa.length?Ye.Kc.c*Ye.Kc.i:0))!=Or)Xt=0;else{if(Or>Ye.Vb){if(Ye.Vb=0,Ye.Ec=s(Or),Ye.Fc=0,Ye.Ec==null){Xt=Zt(Ye,1,"no memory during frame initialization.");break t}Ye.Vb=Or}Or=Ye.Ec,Qr=Ye.Fc,Ye.Ac=Or,Ye.Bc=Qr,Qr+=jr,Ye.Gd=o($n,bn),Ye.Hd=0,Ye.rb=o(Pn+1,dn),Ye.sb=1,Ye.wa=oi?o(oi,Fr):null,Ye.Y=0,Ye.D.Nb=0,Ye.D.wa=Ye.wa,Ye.D.Y=Ye.Y,0<Ye.Aa&&(Ye.D.Y+=$r),t(!0),Ye.oc=Or,Ye.pc=Qr,Qr+=832,Ye.ya=o(Rn,Lt),Ye.aa=0,Ye.D.ya=Ye.ya,Ye.D.aa=Ye.aa,Ye.Aa==2&&(Ye.D.aa+=$r),Ye.R=16*$r,Ye.B=8*$r,$r=($n=Xy[Ye.L])*Ye.R,$n=$n/2*Ye.B,Ye.sa=Or,Ye.ta=Qr+$r,Ye.qa=Ye.sa,Ye.ra=Ye.ta+16*Xt*Ye.R+$n,Ye.Ha=Ye.qa,Ye.Ia=Ye.ra+8*Xt*Ye.B+$n,Ye.$c=0,Qr+=tr,Ye.mb=Er?Or:null,Ye.nb=Er?Qr:null,t(Qr+Er<=Ye.Fc+Ye.Vb),Mt(Ye),i(Ye.Ac,Ye.Bc,0,jr),Xt=1}}if(Xt){if(Ft.ka=0,Ft.y=Ye.sa,Ft.O=Ye.ta,Ft.f=Ye.qa,Ft.N=Ye.ra,Ft.ea=Ye.Ha,Ft.Vd=Ye.Ia,Ft.fa=Ye.R,Ft.Rc=Ye.B,Ft.F=null,Ft.J=0,!z6){for(Xt=-255;255>=Xt;++Xt)I6[255+Xt]=0>Xt?-Xt:Xt;for(Xt=-1020;1020>=Xt;++Xt)D6[1020+Xt]=-128>Xt?-128:127<Xt?127:Xt;for(Xt=-112;112>=Xt;++Xt)$6[112+Xt]=-16>Xt?-16:15<Xt?15:Xt;for(Xt=-255;510>=Xt;++Xt)U6[255+Xt]=0>Xt?0:255<Xt?255:Xt;z6=1}Kc=Dt,Au=Bt,Nu=Qt,Li=Yt,Ji=fr,pc=ot,Xa=_n,Ss=kn,gd=oe,jg=Re,up=Wn,Uy=M,E6=Je,T6=kt,P6=ut,O6=pt,M6=Pr,L6=Kr,Yc[0]=ct,Yc[1]=Ve,Yc[2]=Cr,Yc[3]=nn,Yc[4]=Ht,Yc[5]=qe,Yc[6]=Ue,Yc[7]=at,Yc[8]=vt,Yc[9]=Be,bf[0]=we,bf[1]=yt,bf[2]=St,bf[3]=sr,bf[4]=Ie,bf[5]=tt,bf[6]=dt,xd[0]=Ur,xd[1]=zt,xd[2]=jt,xd[3]=$t,xd[4]=vn,xd[5]=en,xd[6]=Nr,Xt=1}else Xt=0}Xt&&(Xt=function(xi,_s){for(xi.M=0;xi.M<xi.Va;++xi.M){var li,Bn=xi.Jc[xi.M&xi.Xb],gn=xi.m,Qa=xi;for(li=0;li<Qa.za;++li){var ri=gn,yi=Qa,ca=yi.Ac,Zs=yi.Bc+4*li,Ho=yi.zc,Ba=yi.ya[yi.aa+li];if(yi.Qa.Bb?Ba.$b=ie(ri,yi.Pa.jb[0])?2+ie(ri,yi.Pa.jb[2]):ie(ri,yi.Pa.jb[1]):Ba.$b=0,yi.kc&&(Ba.Ad=ie(ri,yi.Bd)),Ba.Za=!ie(ri,145)+0,Ba.Za){var bo=Ba.Ob,Vo=0;for(yi=0;4>yi;++yi){var ks,vi=Ho[0+yi];for(ks=0;4>ks;++ks){vi=zK[ca[Zs+ks]][vi];for(var Fi=V6[ie(ri,vi[0])];0<Fi;)Fi=V6[2*Fi+ie(ri,vi[Fi])];vi=-Fi,ca[Zs+ks]=vi}n(bo,Vo,ca,Zs,4),Vo+=4,Ho[0+yi]=vi}}else vi=ie(ri,156)?ie(ri,128)?1:3:ie(ri,163)?2:0,Ba.Ob[0]=vi,i(ca,Zs,vi,4),i(Ho,0,vi,4);Ba.Dd=ie(ri,142)?ie(ri,114)?ie(ri,183)?1:3:2:0}if(Qa.m.Ka)return Zt(xi,7,"Premature end-of-partition0 encountered.");for(;xi.ja<xi.za;++xi.ja){if(Qa=Bn,ri=(gn=xi).rb[gn.sb-1],ca=gn.rb[gn.sb+gn.ja],li=gn.ya[gn.aa+gn.ja],Zs=gn.kc?li.Ad:0)ri.la=ca.la=0,li.Za||(ri.Na=ca.Na=0),li.Hc=0,li.Gc=0,li.ia=0;else{var Fa,Ii;if(ri=ca,ca=Qa,Zs=gn.Pa.Xc,Ho=gn.ya[gn.aa+gn.ja],Ba=gn.pb[Ho.$b],yi=Ho.ad,bo=0,Vo=gn.rb[gn.sb-1],vi=ks=0,i(yi,bo,0,384),Ho.Za)var eo=0,Xc=Zs[3];else{Fi=s(16);var Ja=ri.Na+Vo.Na;if(Ja=Ng(ca,Zs[1],Ja,Ba.Eb,0,Fi,0),ri.Na=Vo.Na=(0<Ja)+0,1<Ja)Kc(Fi,0,yi,bo);else{var fl=Fi[0]+3>>3;for(Fi=0;256>Fi;Fi+=16)yi[bo+Fi]=fl}eo=1,Xc=Zs[0]}var Zi=15&ri.la,js=15&Vo.la;for(Fi=0;4>Fi;++Fi){var Rl=1&js;for(fl=Ii=0;4>fl;++fl)Zi=Zi>>1|(Rl=(Ja=Ng(ca,Xc,Ja=Rl+(1&Zi),Ba.Sc,eo,yi,bo))>eo)<<7,Ii=Ii<<2|(3<Ja?3:1<Ja?2:yi[bo+0]!=0),bo+=16;Zi>>=4,js=js>>1|Rl<<7,ks=(ks<<8|Ii)>>>0}for(Xc=Zi,eo=js>>4,Fa=0;4>Fa;Fa+=2){for(Ii=0,Zi=ri.la>>4+Fa,js=Vo.la>>4+Fa,Fi=0;2>Fi;++Fi){for(Rl=1&js,fl=0;2>fl;++fl)Ja=Rl+(1&Zi),Zi=Zi>>1|(Rl=0<(Ja=Ng(ca,Zs[2],Ja,Ba.Qc,0,yi,bo)))<<3,Ii=Ii<<2|(3<Ja?3:1<Ja?2:yi[bo+0]!=0),bo+=16;Zi>>=2,js=js>>1|Rl<<5}vi|=Ii<<4*Fa,Xc|=Zi<<4<<Fa,eo|=(240&js)<<Fa}ri.la=Xc,Vo.la=eo,Ho.Hc=ks,Ho.Gc=vi,Ho.ia=43690&vi?0:Ba.ia,Zs=!(ks|vi)}if(0<gn.L&&(gn.wa[gn.Y+gn.ja]=gn.gd[li.$b][li.Za],gn.wa[gn.Y+gn.ja].La|=!Zs),Qa.Ka)return Zt(xi,7,"Premature end-of-file encountered.")}if(Mt(xi),gn=_s,Qa=1,li=(Bn=xi).D,ri=0<Bn.L&&Bn.M>=Bn.zb&&Bn.M<=Bn.Va,Bn.Aa==0)t:{if(li.M=Bn.M,li.uc=ri,Ya(Bn,li),Qa=1,li=(Ii=Bn.D).Nb,ri=(vi=Xy[Bn.L])*Bn.R,ca=vi/2*Bn.B,Fi=16*li*Bn.R,fl=8*li*Bn.B,Zs=Bn.sa,Ho=Bn.ta-ri+Fi,Ba=Bn.qa,yi=Bn.ra-ca+fl,bo=Bn.Ha,Vo=Bn.Ia-ca+fl,js=(Zi=Ii.M)==0,ks=Zi>=Bn.Va-1,Bn.Aa==2&&Ya(Bn,Ii),Ii.uc)for(Rl=(Ja=Bn).D.M,t(Ja.D.uc),Ii=Ja.yb;Ii<Ja.Hb;++Ii){eo=Ii,Xc=Rl;var Go=(Bl=(to=Ja).D).Nb;Fa=to.R;var Bl=Bl.wa[Bl.Y+eo],Fl=to.sa,hl=to.ta+16*Go*Fa+16*eo,Il=Bl.dd,na=Bl.tc;if(na!=0)if(t(3<=na),to.L==1)0<eo&&O6(Fl,hl,Fa,na+4),Bl.La&&L6(Fl,hl,Fa,na),0<Xc&&P6(Fl,hl,Fa,na+4),Bl.La&&M6(Fl,hl,Fa,na);else{var Dl=to.B,Qc=to.qa,Th=to.ra+8*Go*Dl+8*eo,yd=to.Ha,to=to.Ia+8*Go*Dl+8*eo;Go=Bl.ld,0<eo&&(Ss(Fl,hl,Fa,na+4,Il,Go),jg(Qc,Th,yd,to,Dl,na+4,Il,Go)),Bl.La&&(Uy(Fl,hl,Fa,na,Il,Go),T6(Qc,Th,yd,to,Dl,na,Il,Go)),0<Xc&&(Xa(Fl,hl,Fa,na+4,Il,Go),gd(Qc,Th,yd,to,Dl,na+4,Il,Go)),Bl.La&&(up(Fl,hl,Fa,na,Il,Go),E6(Qc,Th,yd,to,Dl,na,Il,Go))}}if(Bn.ia&&alert("todo:DitherRow"),gn.put!=null){if(Ii=16*Zi,Zi=16*(Zi+1),js?(gn.y=Bn.sa,gn.O=Bn.ta+Fi,gn.f=Bn.qa,gn.N=Bn.ra+fl,gn.ea=Bn.Ha,gn.W=Bn.Ia+fl):(Ii-=vi,gn.y=Zs,gn.O=Ho,gn.f=Ba,gn.N=yi,gn.ea=bo,gn.W=Vo),ks||(Zi-=vi),Zi>gn.o&&(Zi=gn.o),gn.F=null,gn.J=null,Bn.Fa!=null&&0<Bn.Fa.length&&Ii<Zi&&(gn.J=ze(Bn,gn,Ii,Zi-Ii),gn.F=Bn.mb,gn.F==null&&gn.F.length==0)){Qa=Zt(Bn,3,"Could not decode alpha data.");break t}Ii<gn.j&&(vi=gn.j-Ii,Ii=gn.j,t(!(1&vi)),gn.O+=Bn.R*vi,gn.N+=Bn.B*(vi>>1),gn.W+=Bn.B*(vi>>1),gn.F!=null&&(gn.J+=gn.width*vi)),Ii<Zi&&(gn.O+=gn.v,gn.N+=gn.v>>1,gn.W+=gn.v>>1,gn.F!=null&&(gn.J+=gn.v),gn.ka=Ii-gn.j,gn.U=gn.va-gn.v,gn.T=Zi-Ii,Qa=gn.put(gn))}li+1!=Bn.Ic||ks||(n(Bn.sa,Bn.ta-ri,Zs,Ho+16*Bn.R,ri),n(Bn.qa,Bn.ra-ca,Ba,yi+8*Bn.B,ca),n(Bn.Ha,Bn.Ia-ca,bo,Vo+8*Bn.B,ca))}if(!Qa)return Zt(xi,6,"Output aborted.")}return 1}(Ye,Ft)),Ft.bc!=null&&Ft.bc(Ft),Xt&=1}return Xt?(Ye.cb=0,Xt):0})(_,ee)||(N=_.a)}}else N=_.a}N==0&&Se.Oa!=null&&Se.Oa.fd&&(N=dl(Se.ba))}Se=N}ye=Se!=0?null:11>ye?Te.f.RGBA.eb:Te.f.kb.y}else ye=null;return ye};var eT=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(P,B){for(var E="",T=0;T<4;T++)E+=String.fromCharCode(P[B++]);return E}function d(P,B){return P[B+0]|P[B+1]<<8}function f(P,B){return(P[B+0]|P[B+1]<<8|P[B+2]<<16)>>>0}function h(P,B){return(P[B+0]|P[B+1]<<8|P[B+2]<<16|P[B+3]<<24)>>>0}new c;var p=[0],m=[0],g=[],y=new c,b=e,v=function(P,B){var E={},T=0,F=!1,W=0,z=0;if(E.frames=[],!function(C,K){for(var V=0;V<4;V++)if(C[K+V]!="RIFF".charCodeAt(V))return!0;return!1}(P,B)){for(h(P,B+=4),B+=8;B<P.length;){var se=u(P,B),de=h(P,B+=4);B+=4;var U=de+(1&de);switch(se){case"VP8 ":case"VP8L":E.frames[T]===void 0&&(E.frames[T]={}),(X=E.frames[T]).src_off=F?z:B-8,X.src_size=W+de+8,T++,F&&(F=!1,W=0,z=0);break;case"VP8X":(X=E.header={}).feature_flags=P[B];var G=B+4;X.canvas_width=1+f(P,G),G+=3,X.canvas_height=1+f(P,G),G+=3;break;case"ALPH":F=!0,W=U+8,z=B-8;break;case"ANIM":(X=E.header).bgcolor=h(P,B),G=B+4,X.loop_count=d(P,G),G+=2;break;case"ANMF":var re,X;(X=E.frames[T]={}).offset_x=2*f(P,B),B+=3,X.offset_y=2*f(P,B),B+=3,X.width=1+f(P,B),B+=3,X.height=1+f(P,B),B+=3,X.duration=f(P,B),B+=3,re=P[B++],X.dispose=1&re,X.blend=re>>1&1}se!="ANMF"&&(B+=U)}return E}}(b,0);v.response=b,v.rgbaoutput=!0,v.dataurl=!1;var w=v.header?v.header:null,S=v.frames?v.frames:null;if(w){w.loop_counter=w.loop_count,p=[w.canvas_height],m=[w.canvas_width];for(var k=0;k<S.length&&S[k].blend!=0;k++);}var j=S[0],A=y.WebPDecodeRGBA(b,j.src_off,j.src_size,m,p);j.rgba=A,j.imgwidth=m[0],j.imgheight=p[0];for(var L=0;L<m[0]*p[0]*4;L++)g[L]=A[L];return this.width=m,this.height=p,this.data=g,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function Ige(){var e,t=this.internal.__metadata__.metadata,r=unescape(encodeURIComponent(t));e=this.internal.__metadata__.rawXml?r:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+e.length+" >>"),this.internal.write("stream"),this.internal.write(e),this.internal.write("endstream"),this.internal.write("endobj")}function Dge(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(e){var t,r,n,i,s,o,l,c,u,d=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new c,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new o,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new o,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var K=C;Object.defineProperty(this,"pdf",{get:function(){return K}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(I){V=!!I}});var R=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return R},set:function(I){R=!!I}});var J=0;Object.defineProperty(this,"posX",{get:function(){return J},set:function(I){isNaN(I)||(J=I)}});var q=0;Object.defineProperty(this,"posY",{get:function(){return q},set:function(I){isNaN(I)||(q=I)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(I){var Z;typeof I=="number"?Z=[I,I,I,I]:((Z=new Array(4))[0]=I[0],Z[1]=I.length>=2?I[1]:Z[0],Z[2]=I.length>=3?I[2]:Z[0],Z[3]=I.length>=4?I[3]:Z[1]),u.margin=Z}});var Y=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Y},set:function(I){Y=I}});var Q=0;Object.defineProperty(this,"lastBreak",{get:function(){return Q},set:function(I){Q=I}});var ie=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ie},set:function(I){ie=I}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(I){I instanceof d&&(u=I)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(I){u.path=I}});var le=[];Object.defineProperty(this,"ctxStack",{get:function(){return le},set:function(I){le=I}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(I){var Z;Z=h(I),this.ctx.fillStyle=Z.style,this.ctx.isFillTransparent=Z.a===0,this.ctx.fillOpacity=Z.a,this.pdf.setFillColor(Z.r,Z.g,Z.b,{a:Z.a}),this.pdf.setTextColor(Z.r,Z.g,Z.b,{a:Z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(I){var Z=h(I);this.ctx.strokeStyle=Z.style,this.ctx.isStrokeTransparent=Z.a===0,this.ctx.strokeOpacity=Z.a,Z.a===0?this.pdf.setDrawColor(255,255,255):(Z.a,this.pdf.setDrawColor(Z.r,Z.g,Z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(I){["butt","round","square"].indexOf(I)!==-1&&(this.ctx.lineCap=I,this.pdf.setLineCap(I))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(I){isNaN(I)||(this.ctx.lineWidth=I,this.pdf.setLineWidth(I))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(I){["bevel","round","miter"].indexOf(I)!==-1&&(this.ctx.lineJoin=I,this.pdf.setLineJoin(I))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(I){isNaN(I)||(this.ctx.miterLimit=I,this.pdf.setMiterLimit(I))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(I){this.ctx.textBaseline=I}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(I){["right","end","center","left","start"].indexOf(I)!==-1&&(this.ctx.textAlign=I)}});var O=null,H=null,ae=null;Object.defineProperty(this,"fontFaces",{get:function(){return ae},set:function(I){O=null,H=null,ae=I}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(I){var Z;if(this.ctx.font=I,(Z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(I))!==null){var pe=Z[1];Z[2];var Oe=Z[3],Ae=Z[4];Z[5];var ke=Z[6],_e=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ae)[2];Ae=Math.floor(_e==="px"?parseFloat(Ae)*this.pdf.internal.scaleFactor:_e==="em"?parseFloat(Ae)*this.pdf.getFontSize():parseFloat(Ae)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ae);var De=function(ge){var lt,He,mt=[],wt=ge.trim();if(wt==="")return Tk;if(wt in lM)return[lM[wt]];for(;wt!=="";){switch(He=null,lt=(wt=uM(wt)).charAt(0)){case'"':case"'":He=Oge(wt.substring(1),lt);break;default:He=Mge(wt)}if(He===null||(mt.push(He[0]),(wt=uM(He[1]))!==""&&wt.charAt(0)!==","))return Tk;wt=wt.replace(/^,/,"")}return mt}(ke);if(this.fontFaces){var We=function(ge,lt){var He=ge.getFontList(),mt=JSON.stringify(He);if(O===null||H!==mt){var wt=function(Pt){var bt=[];return Object.keys(Pt).forEach(function(qr){Pt[qr].forEach(function(Tt){var xr=null;switch(Tt){case"bold":xr={family:qr,weight:"bold"};break;case"italic":xr={family:qr,style:"italic"};break;case"bolditalic":xr={family:qr,weight:"bold",style:"italic"};break;case"":case"normal":xr={family:qr}}xr!==null&&(xr.ref={name:qr,style:Tt},bt.push(xr))})}),bt}(He);O=function(Pt){for(var bt={},qr=0;qr<Pt.length;++qr){var Tt=Ek(Pt[qr]),xr=Tt.family,Zr=Tt.stretch,Xr=Tt.style,Br=Tt.weight;bt[xr]=bt[xr]||{},bt[xr][Zr]=bt[xr][Zr]||{},bt[xr][Zr][Xr]=bt[xr][Zr][Xr]||{},bt[xr][Zr][Xr][Br]=Tt}return bt}(wt.concat(lt)),H=mt}return O}(this.pdf,this.fontFaces),Ct=De.map(function(ge){return{family:ge,stretch:"normal",weight:Oe,style:pe}}),_t=function(ge,lt,He){for(var mt=(He=He||{}).defaultFontFamily||"times",wt=Object.assign({},Pge,He.genericFontFamilies||{}),Pt=null,bt=null,qr=0;qr<lt.length;++qr)if(wt[(Pt=Ek(lt[qr])).family]&&(Pt.family=wt[Pt.family]),ge.hasOwnProperty(Pt.family)){bt=ge[Pt.family];break}if(!(bt=bt||ge[mt]))throw new Error("Could not find a font-family for the rule '"+cM(Pt)+"' and default family '"+mt+"'.");if(bt=function(Tt,xr){if(xr[Tt])return xr[Tt];var Zr=sA[Tt],Xr=Zr<=sA.normal?-1:1,Br=oM(xr,Fz,Zr,Xr);if(!Br)throw new Error("Could not find a matching font-stretch value for "+Tt);return Br}(Pt.stretch,bt),bt=function(Tt,xr){if(xr[Tt])return xr[Tt];for(var Zr=Bz[Tt],Xr=0;Xr<Zr.length;++Xr)if(xr[Zr[Xr]])return xr[Zr[Xr]];throw new Error("Could not find a matching font-style for "+Tt)}(Pt.style,bt),!(bt=function(Tt,xr){if(xr[Tt])return xr[Tt];if(Tt===400&&xr[500])return xr[500];if(Tt===500&&xr[400])return xr[400];var Zr=Tge[Tt],Xr=oM(xr,Iz,Zr,Tt<400?-1:1);if(!Xr)throw new Error("Could not find a matching font-weight for value "+Tt);return Xr}(Pt.weight,bt)))throw new Error("Failed to resolve a font for the rule '"+cM(Pt)+"'.");return bt}(We,Ct);this.pdf.setFont(_t.ref.name,_t.ref.style)}else{var Xe="";(Oe==="bold"||parseInt(Oe,10)>=700||pe==="bold")&&(Xe="bold"),pe==="italic"&&(Xe+="italic"),Xe.length===0&&(Xe="normal");for(var nt="",Ne={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},be=0;be<De.length;be++){if(this.pdf.internal.getFont(De[be],Xe,{noFallback:!0,disableWarning:!0})!==void 0){nt=De[be];break}if(Xe==="bolditalic"&&this.pdf.internal.getFont(De[be],"bold",{noFallback:!0,disableWarning:!0})!==void 0)nt=De[be],Xe="bold";else if(this.pdf.internal.getFont(De[be],"normal",{noFallback:!0,disableWarning:!0})!==void 0){nt=De[be],Xe="normal";break}}if(nt===""){for(var fe=0;fe<De.length;fe++)if(Ne[De[fe]]){nt=Ne[De[fe]];break}}nt=nt===""?"Times":nt,this.pdf.setFont(nt,Xe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(I){this.ctx.globalCompositeOperation=I}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(I){this.ctx.globalAlpha=I}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(I){this.ctx.lineDashOffset=I,X.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(I){this.ctx.lineDash=I,X.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(I){this.ctx.ignoreClearRect=!!I}})};f.prototype.setLineDash=function(C){this.lineDash=C},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){S.call(this,"fill",!1)},f.prototype.stroke=function(){S.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(C,K){if(isNaN(C)||isNaN(K))throw ta.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new o(C,K));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(C,K)},f.prototype.closePath=function(){var C=new o(0,0),K=0;for(K=this.path.length-1;K!==-1;K--)if(this.path[K].type==="begin"&&zi(this.path[K+1])==="object"&&typeof this.path[K+1].x=="number"){C=new o(this.path[K+1].x,this.path[K+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(C.x,C.y)},f.prototype.lineTo=function(C,K){if(isNaN(C)||isNaN(K))throw ta.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new o(C,K));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},f.prototype.quadraticCurveTo=function(C,K,V,R){if(isNaN(V)||isNaN(R)||isNaN(C)||isNaN(K))throw ta.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var J=this.ctx.transform.applyToPoint(new o(V,R)),q=this.ctx.transform.applyToPoint(new o(C,K));this.path.push({type:"qct",x1:q.x,y1:q.y,x:J.x,y:J.y}),this.ctx.lastPoint=new o(J.x,J.y)},f.prototype.bezierCurveTo=function(C,K,V,R,J,q){if(isNaN(J)||isNaN(q)||isNaN(C)||isNaN(K)||isNaN(V)||isNaN(R))throw ta.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Y=this.ctx.transform.applyToPoint(new o(J,q)),Q=this.ctx.transform.applyToPoint(new o(C,K)),ie=this.ctx.transform.applyToPoint(new o(V,R));this.path.push({type:"bct",x1:Q.x,y1:Q.y,x2:ie.x,y2:ie.y,x:Y.x,y:Y.y}),this.ctx.lastPoint=new o(Y.x,Y.y)},f.prototype.arc=function(C,K,V,R,J,q){if(isNaN(C)||isNaN(K)||isNaN(V)||isNaN(R)||isNaN(J))throw ta.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(q=!!q,!this.ctx.transform.isIdentity){var Y=this.ctx.transform.applyToPoint(new o(C,K));C=Y.x,K=Y.y;var Q=this.ctx.transform.applyToPoint(new o(0,V)),ie=this.ctx.transform.applyToPoint(new o(0,0));V=Math.sqrt(Math.pow(Q.x-ie.x,2)+Math.pow(Q.y-ie.y,2))}Math.abs(J-R)>=2*Math.PI&&(R=0,J=2*Math.PI),this.path.push({type:"arc",x:C,y:K,radius:V,startAngle:R,endAngle:J,counterclockwise:q})},f.prototype.arcTo=function(C,K,V,R,J){throw new Error("arcTo not implemented.")},f.prototype.rect=function(C,K,V,R){if(isNaN(C)||isNaN(K)||isNaN(V)||isNaN(R))throw ta.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,K),this.lineTo(C+V,K),this.lineTo(C+V,K+R),this.lineTo(C,K+R),this.lineTo(C,K),this.lineTo(C+V,K),this.lineTo(C,K)},f.prototype.fillRect=function(C,K,V,R){if(isNaN(C)||isNaN(K)||isNaN(V)||isNaN(R))throw ta.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var J={};this.lineCap!=="butt"&&(J.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(J.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,K,V,R),this.fill(),J.hasOwnProperty("lineCap")&&(this.lineCap=J.lineCap),J.hasOwnProperty("lineJoin")&&(this.lineJoin=J.lineJoin)}},f.prototype.strokeRect=function(C,K,V,R){if(isNaN(C)||isNaN(K)||isNaN(V)||isNaN(R))throw ta.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(C,K,V,R),this.stroke())},f.prototype.clearRect=function(C,K,V,R){if(isNaN(C)||isNaN(K)||isNaN(V)||isNaN(R))throw ta.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,K,V,R))},f.prototype.save=function(C){C=typeof C!="boolean"||C;for(var K=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage(K),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var R=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=R}},f.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var K=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage(K),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(C){var K,V,R,J;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))K=0,V=0,R=0,J=0;else{var q=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(q!==null)K=parseInt(q[1]),V=parseInt(q[2]),R=parseInt(q[3]),J=1;else if((q=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)K=parseInt(q[1]),V=parseInt(q[2]),R=parseInt(q[3]),J=parseFloat(q[4]);else{if(J=1,typeof C=="string"&&C.charAt(0)!=="#"){var Y=new Ez(C);C=Y.ok?Y.toHex():"#000000"}C.length===4?(K=C.substring(1,2),K+=K,V=C.substring(2,3),V+=V,R=C.substring(3,4),R+=R):(K=C.substring(1,3),V=C.substring(3,5),R=C.substring(5,7)),K=parseInt(K,16),V=parseInt(V,16),R=parseInt(R,16)}}return{r:K,g:V,b:R,a:J,style:C}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(C,K,V,R){if(isNaN(K)||isNaN(V)||typeof C!="string")throw ta.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(R=isNaN(R)?void 0:R,!p.call(this)){var J=U(this.ctx.transform.rotation),q=this.ctx.transform.scaleX;T.call(this,{text:C,x:K,y:V,scale:q,angle:J,align:this.textAlign,maxWidth:R})}},f.prototype.strokeText=function(C,K,V,R){if(isNaN(K)||isNaN(V)||typeof C!="string")throw ta.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){R=isNaN(R)?void 0:R;var J=U(this.ctx.transform.rotation),q=this.ctx.transform.scaleX;T.call(this,{text:C,x:K,y:V,scale:q,renderingMode:"stroke",angle:J,align:this.textAlign,maxWidth:R})}},f.prototype.measureText=function(C){if(typeof C!="string")throw ta.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var K=this.pdf,V=this.pdf.internal.scaleFactor,R=K.internal.getFontSize(),J=K.getStringUnitWidth(C)*R/K.internal.scaleFactor;return new function(q){var Y=(q=q||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Y}}),this}({width:J*=Math.round(96*V/72*1e4)/1e4})},f.prototype.scale=function(C,K){if(isNaN(C)||isNaN(K))throw ta.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new c(C,0,0,K,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.rotate=function(C){if(isNaN(C))throw ta.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var K=new c(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(K)},f.prototype.translate=function(C,K){if(isNaN(C)||isNaN(K))throw ta.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new c(1,0,0,1,C,K);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.transform=function(C,K,V,R,J,q){if(isNaN(C)||isNaN(K)||isNaN(V)||isNaN(R)||isNaN(J)||isNaN(q))throw ta.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Y=new c(C,K,V,R,J,q);this.ctx.transform=this.ctx.transform.multiply(Y)},f.prototype.setTransform=function(C,K,V,R,J,q){C=isNaN(C)?1:C,K=isNaN(K)?0:K,V=isNaN(V)?0:V,R=isNaN(R)?1:R,J=isNaN(J)?0:J,q=isNaN(q)?0:q,this.ctx.transform=new c(C,K,V,R,J,q)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(C,K,V,R,J,q,Y,Q,ie){var le=this.pdf.getImageProperties(C),O=1,H=1,ae=1,I=1;R!==void 0&&Q!==void 0&&(ae=Q/R,I=ie/J,O=le.width/R*Q/R,H=le.height/J*ie/J),q===void 0&&(q=K,Y=V,K=0,V=0),R!==void 0&&Q===void 0&&(Q=R,ie=J),R===void 0&&Q===void 0&&(Q=le.width,ie=le.height);var Z=this.ctx.transform.decompose(),pe=U(Z.rotate.shx),Oe=new c,Ae=(Oe=(Oe=(Oe=Oe.multiply(Z.translate)).multiply(Z.skew)).multiply(Z.scale)).applyToRectangle(new l(q-K*ae,Y-V*I,R*O,J*H));if(this.autoPaging){for(var ke,_e=y.call(this,Ae),De=[],We=0;We<_e.length;We+=1)De.indexOf(_e[We])===-1&&De.push(_e[We]);w(De);for(var Ct=De[0],_t=De[De.length-1],Xe=Ct;Xe<_t+1;Xe++){this.pdf.setPage(Xe);var nt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ne=Xe===1?this.posY+this.margin[0]:this.margin[0],be=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],fe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ge=Xe===1?0:be+(Xe-2)*fe;if(this.ctx.clip_path.length!==0){var lt=this.path;ke=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(ke,this.posX+this.margin[3],-ge+Ne+this.ctx.prevPageLastElemOffset),k.call(this,"fill",!0),this.path=lt}var He=JSON.parse(JSON.stringify(Ae));He=v([He],this.posX+this.margin[3],-ge+Ne+this.ctx.prevPageLastElemOffset)[0];var mt=(Xe>Ct||Xe<_t)&&g.call(this);mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],nt,fe,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",He.x,He.y,He.w,He.h,null,null,pe),mt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(C,"JPEG",Ae.x,Ae.y,Ae.w,Ae.h,null,null,pe)};var y=function(C,K,V){var R=[];K=K||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var J=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":R.push(Math.floor((C.y+J)/V)+1);break;case"arc":R.push(Math.floor((C.y+J-C.radius)/V)+1),R.push(Math.floor((C.y+J+C.radius)/V)+1);break;case"qct":var q=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);R.push(Math.floor((q.y+J)/V)+1),R.push(Math.floor((q.y+q.h+J)/V)+1);break;case"bct":var Y=re(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);R.push(Math.floor((Y.y+J)/V)+1),R.push(Math.floor((Y.y+Y.h+J)/V)+1);break;case"rect":R.push(Math.floor((C.y+J)/V)+1),R.push(Math.floor((C.y+C.h+J)/V)+1)}for(var Q=0;Q<R.length;Q+=1)for(;this.pdf.internal.getNumberOfPages()<R[Q];)b.call(this);return R},b=function(){var C=this.fillStyle,K=this.strokeStyle,V=this.font,R=this.lineCap,J=this.lineWidth,q=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=K,this.font=V,this.lineCap=R,this.lineWidth=J,this.lineJoin=q},v=function(C,K,V){for(var R=0;R<C.length;R++)switch(C[R].type){case"bct":C[R].x2+=K,C[R].y2+=V;case"qct":C[R].x1+=K,C[R].y1+=V;default:C[R].x+=K,C[R].y+=V}return C},w=function(C){return C.sort(function(K,V){return K-V})},S=function(C,K){var V=this.fillStyle,R=this.strokeStyle,J=this.lineCap,q=this.lineWidth,Y=Math.abs(q*this.ctx.transform.scaleX),Q=this.lineJoin;if(this.autoPaging){for(var ie,le,O=JSON.parse(JSON.stringify(this.path)),H=JSON.parse(JSON.stringify(this.path)),ae=[],I=0;I<H.length;I++)if(H[I].x!==void 0)for(var Z=y.call(this,H[I]),pe=0;pe<Z.length;pe+=1)ae.indexOf(Z[pe])===-1&&ae.push(Z[pe]);for(var Oe=0;Oe<ae.length;Oe++)for(;this.pdf.internal.getNumberOfPages()<ae[Oe];)b.call(this);w(ae);for(var Ae=ae[0],ke=ae[ae.length-1],_e=Ae;_e<ke+1;_e++){this.pdf.setPage(_e),this.fillStyle=V,this.strokeStyle=R,this.lineCap=J,this.lineWidth=Y,this.lineJoin=Q;var De=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],We=_e===1?this.posY+this.margin[0]:this.margin[0],Ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xe=_e===1?0:Ct+(_e-2)*_t;if(this.ctx.clip_path.length!==0){var nt=this.path;ie=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(ie,this.posX+this.margin[3],-Xe+We+this.ctx.prevPageLastElemOffset),k.call(this,C,!0),this.path=nt}if(le=JSON.parse(JSON.stringify(O)),this.path=v(le,this.posX+this.margin[3],-Xe+We+this.ctx.prevPageLastElemOffset),K===!1||_e===0){var Ne=(_e>Ae||_e<ke)&&g.call(this);Ne&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],De,_t,null).clip().discardPath()),k.call(this,C,K),Ne&&this.pdf.restoreGraphicsState()}this.lineWidth=q}this.path=O}else this.lineWidth=Y,k.call(this,C,K),this.lineWidth=q},k=function(C,K){if((C!=="stroke"||K||!m.call(this))&&(C==="stroke"||K||!p.call(this))){for(var V,R,J=[],q=this.path,Y=0;Y<q.length;Y++){var Q=q[Y];switch(Q.type){case"begin":J.push({begin:!0});break;case"close":J.push({close:!0});break;case"mt":J.push({start:Q,deltas:[],abs:[]});break;case"lt":var ie=J.length;if(q[Y-1]&&!isNaN(q[Y-1].x)&&(V=[Q.x-q[Y-1].x,Q.y-q[Y-1].y],ie>0)){for(;ie>=0;ie--)if(J[ie-1].close!==!0&&J[ie-1].begin!==!0){J[ie-1].deltas.push(V),J[ie-1].abs.push(Q);break}}break;case"bct":V=[Q.x1-q[Y-1].x,Q.y1-q[Y-1].y,Q.x2-q[Y-1].x,Q.y2-q[Y-1].y,Q.x-q[Y-1].x,Q.y-q[Y-1].y],J[J.length-1].deltas.push(V);break;case"qct":var le=q[Y-1].x+2/3*(Q.x1-q[Y-1].x),O=q[Y-1].y+2/3*(Q.y1-q[Y-1].y),H=Q.x+2/3*(Q.x1-Q.x),ae=Q.y+2/3*(Q.y1-Q.y),I=Q.x,Z=Q.y;V=[le-q[Y-1].x,O-q[Y-1].y,H-q[Y-1].x,ae-q[Y-1].y,I-q[Y-1].x,Z-q[Y-1].y],J[J.length-1].deltas.push(V);break;case"arc":J.push({deltas:[],abs:[],arc:!0}),Array.isArray(J[J.length-1].abs)&&J[J.length-1].abs.push(Q)}}R=K?null:C==="stroke"?"stroke":"fill";for(var pe=!1,Oe=0;Oe<J.length;Oe++)if(J[Oe].arc)for(var Ae=J[Oe].abs,ke=0;ke<Ae.length;ke++){var _e=Ae[ke];_e.type==="arc"?L.call(this,_e.x,_e.y,_e.radius,_e.startAngle,_e.endAngle,_e.counterclockwise,void 0,K,!pe):F.call(this,_e.x,_e.y),pe=!0}else if(J[Oe].close===!0)this.pdf.internal.out("h"),pe=!1;else if(J[Oe].begin!==!0){var De=J[Oe].start.x,We=J[Oe].start.y;W.call(this,J[Oe].deltas,De,We),pe=!0}R&&P.call(this,R),K&&B.call(this)}},j=function(C){var K=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=K*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-V;case"top":return C+K-V;case"hanging":return C+K-2*V;case"middle":return C+K/2-V;default:return C}},A=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(K,V){this.colorStops.push([K,V])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var L=function(C,K,V,R,J,q,Y,Q,ie){for(var le=se.call(this,V,R,J,q),O=0;O<le.length;O++){var H=le[O];O===0&&(ie?E.call(this,H.x1+C,H.y1+K):F.call(this,H.x1+C,H.y1+K)),z.call(this,C,K,H.x2,H.y2,H.x3,H.y3,H.x4,H.y4)}Q?B.call(this):P.call(this,Y)},P=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(C,K){this.pdf.internal.out(r(C)+" "+n(K)+" m")},T=function(C){var K;switch(C.align){case"right":case"end":K="right";break;case"center":K="center";break;default:K="left"}var V,R,J,q=this.pdf.getTextDimensions(C.text),Y=j.call(this,C.y),Q=A.call(this,Y)-q.h,ie=this.ctx.transform.applyToPoint(new o(C.x,Y));if(this.autoPaging){var le=this.ctx.transform.decompose(),O=new c;O=(O=(O=O.multiply(le.translate)).multiply(le.skew)).multiply(le.scale);for(var H=this.ctx.transform.applyToRectangle(new l(C.x,Y,q.w,q.h)),ae=O.applyToRectangle(new l(C.x,Q,q.w,q.h)),I=y.call(this,ae),Z=[],pe=0;pe<I.length;pe+=1)Z.indexOf(I[pe])===-1&&Z.push(I[pe]);w(Z);for(var Oe=Z[0],Ae=Z[Z.length-1],ke=Oe;ke<Ae+1;ke++){this.pdf.setPage(ke);var _e=ke===1?this.posY+this.margin[0]:this.margin[0],De=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],We=this.pdf.internal.pageSize.height-this.margin[2],Ct=We-this.margin[0],_t=this.pdf.internal.pageSize.width-this.margin[1],Xe=_t-this.margin[3],nt=ke===1?0:De+(ke-2)*Ct;if(this.ctx.clip_path.length!==0){var Ne=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(V,this.posX+this.margin[3],-1*nt+_e),k.call(this,"fill",!0),this.path=Ne}var be=v([JSON.parse(JSON.stringify(ae))],this.posX+this.margin[3],-nt+_e+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(R=this.pdf.internal.getFontSize(),this.pdf.setFontSize(R*C.scale),J=this.lineWidth,this.lineWidth=J*C.scale);var fe=this.autoPaging!=="text";if(fe||be.y+be.h<=We){if(fe||be.y>=_e&&be.x<=_t){var ge=fe?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||_t-be.x)[0],lt=v([JSON.parse(JSON.stringify(H))],this.posX+this.margin[3],-nt+_e+this.ctx.prevPageLastElemOffset)[0],He=fe&&(ke>Oe||ke<Ae)&&g.call(this);He&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xe,Ct,null).clip().discardPath()),this.pdf.text(ge,lt.x,lt.y,{angle:C.angle,align:K,renderingMode:C.renderingMode}),He&&this.pdf.restoreGraphicsState()}}else be.y<We&&(this.ctx.prevPageLastElemOffset+=We-be.y);C.scale>=.01&&(this.pdf.setFontSize(R),this.lineWidth=J)}}else C.scale>=.01&&(R=this.pdf.internal.getFontSize(),this.pdf.setFontSize(R*C.scale),J=this.lineWidth,this.lineWidth=J*C.scale),this.pdf.text(C.text,ie.x+this.posX,ie.y+this.posY,{angle:C.angle,align:K,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(R),this.lineWidth=J)},F=function(C,K,V,R){V=V||0,R=R||0,this.pdf.internal.out(r(C+V)+" "+n(K+R)+" l")},W=function(C,K,V){return this.pdf.lines(C,K,V,null,null)},z=function(C,K,V,R,J,q,Y,Q){this.pdf.internal.out([t(i(V+C)),t(s(R+K)),t(i(J+C)),t(s(q+K)),t(i(Y+C)),t(s(Q+K)),"c"].join(" "))},se=function(C,K,V,R){for(var J=2*Math.PI,q=Math.PI/2;K>V;)K-=J;var Y=Math.abs(V-K);Y<J&&R&&(Y=J-Y);for(var Q=[],ie=R?-1:1,le=K;Y>1e-5;){var O=le+ie*Math.min(Y,q);Q.push(de.call(this,C,le,O)),Y-=Math.abs(O-le),le=O}return Q},de=function(C,K,V){var R=(V-K)/2,J=C*Math.cos(R),q=C*Math.sin(R),Y=J,Q=-q,ie=Y*Y+Q*Q,le=ie+Y*J+Q*q,O=4/3*(Math.sqrt(2*ie*le)-le)/(Y*q-Q*J),H=Y-O*Q,ae=Q+O*Y,I=H,Z=-ae,pe=R+K,Oe=Math.cos(pe),Ae=Math.sin(pe);return{x1:C*Math.cos(K),y1:C*Math.sin(K),x2:H*Oe-ae*Ae,y2:H*Ae+ae*Oe,x3:I*Oe-Z*Ae,y3:I*Ae+Z*Oe,x4:C*Math.cos(V),y4:C*Math.sin(V)}},U=function(C){return 180*C/Math.PI},G=function(C,K,V,R,J,q){var Y=C+.5*(V-C),Q=K+.5*(R-K),ie=J+.5*(V-J),le=q+.5*(R-q),O=Math.min(C,J,Y,ie),H=Math.max(C,J,Y,ie),ae=Math.min(K,q,Q,le),I=Math.max(K,q,Q,le);return new l(O,ae,H-O,I-ae)},re=function(C,K,V,R,J,q,Y,Q){var ie,le,O,H,ae,I,Z,pe,Oe,Ae,ke,_e,De,We,Ct=V-C,_t=R-K,Xe=J-V,nt=q-R,Ne=Y-J,be=Q-q;for(le=0;le<41;le++)Oe=(Z=(O=C+(ie=le/40)*Ct)+ie*((ae=V+ie*Xe)-O))+ie*(ae+ie*(J+ie*Ne-ae)-Z),Ae=(pe=(H=K+ie*_t)+ie*((I=R+ie*nt)-H))+ie*(I+ie*(q+ie*be-I)-pe),le==0?(ke=Oe,_e=Ae,De=Oe,We=Ae):(ke=Math.min(ke,Oe),_e=Math.min(_e,Ae),De=Math.max(De,Oe),We=Math.max(We,Ae));return new l(Math.round(ke),Math.round(_e),Math.round(De-ke),Math.round(We-_e))},X=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,K,V=(C=this.ctx.lineDash,K=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:K}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(Un.API),function(e){var t=function(o){var l,c,u,d,f,h,p,m,g,y;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(h=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(m=f%85))/85)-(p=f%85))/85)%85,c.push(h+33,p+33,m+33,g+33,y+33)):c.push(122);return function(b,v){for(var w=v;w>0;w--)b.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,h=String,p="length",m=255,g="charCodeAt",y="slice",b="replace";for(o[y](-2),o=o[y](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[y](o[p]%5||5))[p];f>d;d+=5)c=52200625*(o[g](d)-33)+614125*(o[g](d+1)-33)+7225*(o[g](d+2)-33)+85*(o[g](d+3)-33)+(o[g](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(v,w){for(var S=w;S>0;S--)v.pop()}(u,l[p]),h.fromCharCode.apply(h,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=Z4(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};e.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(Un.API),function(e){e.loadFile=function(t,r,n){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,h=0,p=function(m){var g=m.length,y=[],b=String.fromCharCode;for(h=0;h<g;h+=1)y.push(b(255&m.charCodeAt(h)));return y.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(p(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return p(f.responseText)}(i,s,o)}catch{}return l}(t,r,n)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile}(Un.API),function(e){function t(){return(Qn.html2canvas?Promise.resolve(Qn.html2canvas):dm(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Qn.DOMPurify?Promise.resolve(Qn.DOMPurify):dm(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=zi(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,h=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete h.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var p=0;p<d.length;++p){var m=d[p],g=m.src.find(function(y){return y.format==="truetype"});g&&u.addFont(g.url,m.ref.name,m.ref.style)}return h.windowHeight=h.windowHeight||0,h.windowHeight=h.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):h.windowHeight,u.context2d.save(!0),c(this.prop.container,h)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||Un.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(h){return u.updateProgress(null,d),h}).then(d,f).then(function(h){return u.updateProgress(1),h})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),h=u.call(f,l,c);return o.convert(h,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Un.getPageSize=function(l,c,u){if(zi(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,h=(""+u).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,g=0,y=0;if(p.hasOwnProperty(h))g=p[h][1]/f,y=p[h][0]/f;else try{g=u[1],y=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",y>g&&(m=y,y=g,g=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(m=y,y=g,g=m)}return{width:y,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Ek):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(Un.API),Un.API.addJS=function(e){var t,r,n=e;return this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(t+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+n+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){t!==void 0&&r!==void 0&&this.internal.out("/Names <</JavaScript "+t+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var h=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var p=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+p+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,s){var o={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(Un.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var h,p=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,g={width:0,height:0,numcomponents:1},y=4;y<m;y+=2){if(y+=p,t.indexOf(f.charCodeAt(y+1))!==-1){h=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:h,numcomponents:f.charCodeAt(y+9)};break}p=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:i}}return d}}(Un.API),Un.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var i,s=gge(e,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;i=u&&c===1?function(L){for(var P=L.width,B=L.height,E=L.data,T=L.palette,F=L.depth,W=!1,z=[],se=[],de=void 0,U=!1,G=0,re=0;re<T.length;re++){var X=gO(T[re],4),C=X[0],K=X[1],V=X[2],R=X[3];z.push(C,K,V),R!=null&&(R===0?(G++,se.length<1&&se.push(re)):R<255&&(U=!0))}if(U||G>1){W=!0,se=void 0;var J=P*B;de=new Uint8Array(J);for(var q=new DataView(E.buffer),Y=0;Y<J;Y++){var Q=Pk(q,Y,F),ie=gO(T[Q],4)[3];de[Y]=ie}}else G===0&&(se=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:W?8:void 0,colorBytes:E,alphaBytes:de,needSMask:W,palette:z,mask:se}}(s):c===2||c===4?function(L){for(var P=L.data,B=L.width,E=L.height,T=L.channels,F=L.depth,W=T===2?"DeviceGray":"DeviceRGB",z=T-1,se=B*E,de=z,U=se*de,G=1*se,re=Math.ceil(U*F/8),X=Math.ceil(G*F/8),C=new Uint8Array(re),K=new Uint8Array(X),V=new DataView(P.buffer),R=new DataView(C.buffer),J=new DataView(K.buffer),q=!1,Y=0;Y<se;Y++){for(var Q=Y*T,ie=0;ie<de;ie++)bM(R,Pk(V,Q+ie,F),Y*de+ie,F);var le=Pk(V,Q+de,F);le<(1<<F)-1&&(q=!0),bM(J,le,1*Y,F)}return{colorSpace:W,colorsPerPixel:z,sMaskBitsPerComponent:q?F:void 0,colorBytes:C,alphaBytes:K,needSMask:q}}(s):function(L){var P=L.data,B=L.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:P instanceof Uint16Array?function(E){for(var T=E.length,F=new Uint8Array(2*T),W=new DataView(F.buffer,F.byteOffset,F.byteLength),z=0;z<T;z++)W.setUint16(2*z,E[z],!1);return F}(P):P,needSMask:!1}}(s);var f,h,p,m=i,g=m.colorSpace,y=m.colorsPerPixel,b=m.sMaskBitsPerComponent,v=m.colorBytes,w=m.alphaBytes,S=m.needSMask,k=m.palette,j=m.mask,A=null;return n!==Un.API.image_compression.NONE&&typeof Z4=="function"?(A=function(L){var P;switch(L){case Un.API.image_compression.FAST:P=11;break;case Un.API.image_compression.MEDIUM:P=13;break;case Un.API.image_compression.SLOW:P=14;break;default:P=12}return P}(n),f=this.decode.FLATE_DECODE,h="/Predictor ".concat(A," /Colors ").concat(y," /BitsPerComponent ").concat(d," /Columns ").concat(o),e=pM(v,Math.ceil(o*y*d/8),y,d,n),S&&(p=pM(w,Math.ceil(o*b/8),1,b,n))):(f=void 0,h=void 0,e=v,S&&(p=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(p&&this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),{alias:r,data:e,index:t,filter:f,decodeParameters:h,transparency:j,palette:k,sMask:p,predictor:A,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:b,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,i){var s=new Fge(t),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new Ok(100).encode(u,100);return e.processJPEG.call(this,d,r,n,i)},e.processGIF87A=e.processGIF89A}(Un.API),eu.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},eu.prototype.parseBGR=function(){this.pos=this.offset;var e="bit"+this.bitPP,t=this.width*this.height*4;if(t>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(t);try{this[e]()}catch(r){ta.log("bit decode error:"+r)}},eu.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},eu.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*i*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},eu.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},eu.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,u=s>>15?255:0,d=n*this.width*4+4*i;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=e}},eu.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,d=i*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},eu.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},eu.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=o}},eu.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var s=new eu(t,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Ok(100).encode(c,100);return e.processJPEG.call(this,u,r,n,i)}}(Un.API),wM.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var s=new wM(t),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Ok(100).encode(c,100);return e.processJPEG.call(this,u,r,n,i)}}(Un.API),Un.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var d=n[u],f=n[u+1],h=n[u+2],p=n[u+3];s[l++]=d,s[l++]=f,s[l++]=h,o[c++]=p}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Un.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},yp=Un.API,$b=yp.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:i.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=t.doKerning!==!1,h=0,p=e.length,m=0,g=l[0]||c,y=[];for(r=0;r<p;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?y.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(h=f&&zi(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,y.push((l[n]||g)/c+h)),m=n;return y},dM=yp.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return yp.processArabic&&(e=yp.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:$b.apply(this,arguments).reduce(function(s,o){return s+o},0)},fM=function(e,t,r,n){for(var i=[],s=0,o=e.length,l=0;s!==o&&l+t[s]<r;)l+=t[s],s++;i.push(e.slice(0,s));var c=s;for(l=0;s!==o;)l+t[s]>n&&(i.push(e.slice(c,s)),l=0,c=s),l+=t[s],s++;return c!==s&&i.push(e.slice(c,s)),i},hM=function(e,t,r){r||(r={});var n,i,s,o,l,c,u,d=[],f=[d],h=r.textIndent||0,p=0,m=0,g=e.split(" "),y=$b.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var b=Array(c).join(" "),v=[];g.map(function(S){(S=S.split(/\s*\n/)).length>1?v=v.concat(S.map(function(k,j){return(j&&k.length?`
`:"")+k})):v.push(S[0])}),g=v,c=dM.apply(this,[b,r])}for(s=0,o=g.length;s<o;s++){var w=0;if(n=g[s],c&&n[0]==`
`&&(n=n.substr(1),w=1),h+p+(m=(i=$b.apply(this,[n,r])).reduce(function(S,k){return S+k},0))>t||w){if(m>t){for(l=fM.apply(this,[n,i,t-(h+p),t]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=i.slice(n.length-(d[0]?d[0].length:0)).reduce(function(S,k){return S+k},0)}else d=[n];f.push(d),h=m+c,p=y}else d.push(n),h+=p+m,p=y}return u=c?function(S,k){return(k?b:"")+S.join(" ")}:function(S){return S.join(" ")},f.map(u)},yp.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),h="Unicode";return f.metadata[h]?{widths:f.metadata[h].widths||{0:1},kerning:f.metadata[h].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/i;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(hM.apply(this,[n[l],o,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},s=0;s<16;s++)n[r[s]]=t[s],i[t[s]]=r[s];var o=function(h){return"0x"+parseInt(h,10).toString(16)},l=e.__fontmetrics__.compress=function(h){var p,m,g,y,b=["{"];for(var v in h){if(p=h[v],isNaN(parseInt(v,10))?m="'"+v+"'":(v=parseInt(v,10),m=(m=o(v).slice(2)).slice(0,-1)+i[m.slice(-1)]),typeof p=="number")p<0?(g=o(p).slice(3),y="-"):(g=o(p).slice(2),y=""),g=y+g.slice(0,-1)+i[g.slice(-1)];else{if(zi(p)!=="object")throw new Error("Don't know what to do with value type "+zi(p)+".");g=l(p)}b.push(m+g)}return b.push("}"),b.join("")},c=e.__fontmetrics__.uncompress=function(h){if(typeof h!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,m,g,y,b={},v=1,w=b,S=[],k="",j="",A=h.length-1,L=1;L<A;L+=1)(y=h[L])=="'"?p?(g=p.join(""),p=void 0):p=[]:p?p.push(y):y=="{"?(S.push([w,g]),w={},g=void 0):y=="}"?((m=S.pop())[0][m[1]]=w,g=void 0,w=m[0]):y=="-"?v=-1:g===void 0?n.hasOwnProperty(y)?(k+=n[y],g=parseInt(k,16)*v,v=1,k=""):k+=y:n.hasOwnProperty(y)?(j+=n[y],w[g]=parseInt(j,16)*v,v=1,g=void 0,j=""):j+=y;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(h){var p=h.font,m=f.Unicode[p.postScriptName];m&&(p.metadata.Unicode={},p.metadata.Unicode.widths=m.widths,p.metadata.Unicode.kerning=m.kerning);var g=d.Unicode[p.postScriptName];g&&(p.metadata.Unicode.encoding=g,p.encoding=g.codePages[0])}])}(Un.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=r.charCodeAt(s);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,s=r.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Hv(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,n)}}])}(Un),Un.API.addSvgAsImage=function(e,t,r,n,i,s,o,l){if(isNaN(t)||isNaN(r))throw ta.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw ta.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Qn.canvg?Promise.resolve(Qn.canvg):dm(()=>import("./index.es-bs0T-T8I.js"),[])).catch(function(h){return Promise.reject(new Error("Could not load canvg: "+h))}).then(function(h){return h.default?h.default:h}).then(function(h){return h.fromString(u,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(h){return h.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,i,o,l)})},Un.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},Un.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function h(m,g){var y,b=!1;for(y=0;y<m.length;y+=1)m[y]===g&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var p=l.length;for(f=0;f<p;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(zi(e)==="object"){for(i in e)if(s=e[i],h(l,i)&&s!==void 0){if(r[i].type==="boolean"&&typeof s=="boolean")r[i].value=s;else if(r[i].type==="name"&&h(r[i].valueSet,s))r[i].value=s;else if(r[i].type==="integer"&&Number.isInteger(s))r[i].value=s;else if(r[i].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},Un.API.addMetadata=function(e,t){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:e,namespaceUri:t??"http://jspdf.default.namespaceuri/",rawXml:typeof t=="boolean"&&t},this.internal.events.subscribe("putCatalog",Dge),this.internal.events.subscribe("postPutResources",Ige)),this},function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,h=s.length;f<h;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,h;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,h=(l=Object.keys(s).sort(function(p,m){return p-m})).length;f<h;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,h=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),p="",m=0;m<h.length;m++)p+=String.fromCharCode(h[m]);var g=u();d({data:p,addLength1:!0,objectId:g}),c("endobj");var y=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Fp(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var v=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Fp(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+Fp(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,h="",p=0;p<f.length;p++)h+=String.fromCharCode(f[p]);var m=u();d({data:h,addLength1:!0,objectId:m}),c("endobj");var g=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Fp(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Fp(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},h=f.pdfEscape,p=f.activeFontKey,m=f.fonts,g=p,y="",b=0,v="",w=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(v=l,g=p,Array.isArray(l)&&(v=l[0]),b=0;b<v.length;b+=1)m[g].metadata.hasOwnProperty("cmap")&&(o=m[g].metadata.cmap.unicode.codeMap[v[b].charCodeAt(0)]),o||v[b].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?y+=v[b]:y+="";var S="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?S=h(y,g).split("").map(function(k){return k.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(S=r(y,m[g])),f.isHex=!0,{text:S,x:c,y:u,options:d,mutex:f}};t.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(i(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=i(Object.assign({},c,{text:o})).text}])}(Un),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Un.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,s,o,l,c,u,d,f=t,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,w=0;this.__bidiEngine__={};var S=function(E){var T=E.charCodeAt(),F=T>>8,W=g[F];return W!==void 0?f[256*W+(255&T)]:F===252||F===253?"AL":b.test(F)?"L":F===8?"R":"N"},k=function(E){for(var T,F=0;F<E.length;F++){if((T=S(E.charAt(F)))==="L")return!1;if(T==="R")return!0}return!1},j=function(E,T,F,W){var z,se,de,U,G=T[W];switch(G){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"N":case"AN":break;case"EN":v&&(G="AN");break;case"AL":v=!0,G="R";break;case"WS":case"BN":G="N";break;case"CS":W<1||W+1>=T.length||(z=F[W-1])!=="EN"&&z!=="AN"||(se=T[W+1])!=="EN"&&se!=="AN"?G="N":v&&(se="AN"),G=se===z?se:"N";break;case"ES":G=(z=W>0?F[W-1]:"B")==="EN"&&W+1<T.length&&T[W+1]==="EN"?"EN":"N";break;case"ET":if(W>0&&F[W-1]==="EN"){G="EN";break}if(v){G="N";break}for(de=W+1,U=T.length;de<U&&T[de]==="ET";)de++;G=de<U&&T[de]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(U=T.length,de=W+1;de<U&&T[de]==="NSM";)de++;if(de<U){var re=E[W],X=re>=1425&&re<=2303||re===64286;if(z=T[de],X&&(z==="R"||z==="AL")){G="R";break}}}G=W<1||(z=T[W-1])==="B"?"N":F[W-1];break;case"B":v=!1,i=!0,G=w;break;case"S":s=!0,G="N"}return G},A=function(E,T,F){var W=E.split("");return F&&L(W,F,{hiLevel:w}),W.reverse(),T&&T.reverse(),W.join("")},L=function(E,T,F){var W,z,se,de,U,G=-1,re=E.length,X=0,C=[],K=w?p:h,V=[];for(v=!1,i=!1,s=!1,z=0;z<re;z++)V[z]=S(E[z]);for(se=0;se<re;se++){if(U=X,C[se]=j(E,V,C,se),W=240&(X=K[U][m[C[se]]]),X&=15,T[se]=de=K[X][5],W>0)if(W===16){for(z=G;z<se;z++)T[z]=1;G=-1}else G=-1;if(K[X][6])G===-1&&(G=se);else if(G>-1){for(z=G;z<se;z++)T[z]=de;G=-1}V[se]==="B"&&(T[se]=0),F.hiLevel|=de}s&&function(R,J,q){for(var Y=0;Y<q;Y++)if(R[Y]==="S"){J[Y]=w;for(var Q=Y-1;Q>=0&&R[Q]==="WS";Q--)J[Q]=w}}(V,T,re)},P=function(E,T,F,W,z){if(!(z.hiLevel<E)){if(E===1&&w===1&&!i)return T.reverse(),void(F&&F.reverse());for(var se,de,U,G,re=T.length,X=0;X<re;){if(W[X]>=E){for(U=X+1;U<re&&W[U]>=E;)U++;for(G=X,de=U-1;G<de;G++,de--)se=T[G],T[G]=T[de],T[de]=se,F&&(se=F[G],F[G]=F[de],F[de]=se);X=U}X++}}},B=function(E,T,F){var W=E.split(""),z={hiLevel:w};return F||(F=[]),L(W,F,z),function(se,de,U){if(U.hiLevel!==0&&d)for(var G,re=0;re<se.length;re++)de[re]===1&&(G=y.indexOf(se[re]))>=0&&(se[re]=y[G+1])}(W,F,z),P(2,W,T,F,z),P(1,W,T,F,z),W.join("")};return this.__bidiEngine__.doBidiReorder=function(E,T,F){if(function(z,se){if(se)for(var de=0;de<z.length;de++)se[de]=de;l===void 0&&(l=k(z)),u===void 0&&(u=k(z))}(E,T),o||!c||u)if(o&&c&&l^u)w=l?1:0,E=A(E,T,F);else if(!o&&c&&u)w=l?1:0,E=B(E,T,F),E=A(E,T);else if(!o||l||c||u){if(o&&!c&&l^u)E=A(E,T),l?(w=0,E=B(E,T,F)):(w=1,E=B(E,T,F),E=A(E,T));else if(o&&l&&!c&&u)w=1,E=B(E,T,F),E=A(E,T);else if(!o&&!c&&l^u){var W=d;l?(w=1,E=B(E,T,F),w=0,d=!1,E=B(E,T,F),d=W):(w=0,E=B(E,T,F),E=A(E,T),w=1,d=!1,E=B(E,T,F),d=W,E=A(E,T))}}else w=0,E=B(E,T,F);else w=l?1:0,E=B(E,T,F);return E},this.__bidiEngine__.setOptions=function(E){E&&(o=E.isInputVisual,c=E.isOutputVisual,l=E.isInputRtl,u=E.isOutputRtl,d=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([r.doBidiReorder(i[l])]);n.text=o}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(Un),Un.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new mh(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new exe(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new $ge(this.contents),this.head=new zge(this),this.name=new Gge(this),this.cmap=new $z(this),this.toUnicode={},this.hhea=new Wge(this),this.maxp=new Kge(this),this.hmtx=new Yge(this),this.post=new Hge(this),this.os2=new qge(this),this.loca=new Zge(this),this.glyf=new Xge(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,s,o,l;for(o=0,s=0,l=(t=""+t).length;0<=l?s<l:s>l;s=0<=l?++s:--s)i=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Su,mh=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,s,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*s+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),$ge=function(){var e;function t(r){var n,i,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,s,o,l,c,u,d,f,h,p,m,g;for(g in p=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(p)/c),o=Math.floor(f/c),d=16*p-f,(i=new mh).writeInt(this.scalarType),i.writeShort(p),i.writeShort(f),i.writeShort(o),i.writeShort(d),s=16*p,u=i.pos+s,l=null,m=[],r)for(h=r[g],i.writeString(g),i.writeInt(e(h)),i.writeInt(u),i.writeInt(h.length),m=m.concat(h),g==="head"&&(l=u),u+=h.length;u%4;)m.push(0),u++;return i.write(m),n=2981146554-e(i.data),i.pos=l+8,i.writeUInt32(n),i.data},e=function(r){var n,i,s,o;for(r=Uz.call(r);r.length%4;)r.push(0);for(s=new mh(r),i=0,n=0,o=r.length;n<o;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),Uge={}.hasOwnProperty,dd=function(e,t){for(var r in t)Uge.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Su=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var zge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new mh).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),SM=function(){function e(t,r){var n,i,s,o,l,c,u,d,f,h,p,m,g,y,b,v,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(p=t.readUInt16(),h=p/2,t.pos+=6,s=function(){var S,k;for(k=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)k.push(t.readUInt16());return k}(),t.pos+=2,g=function(){var S,k;for(k=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)k.push(t.readUInt16());return k}(),u=function(){var S,k;for(k=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)k.push(t.readUInt16());return k}(),d=function(){var S,k;for(k=[],c=S=0;0<=h?S<h:S>h;c=0<=h?++S:--S)k.push(t.readUInt16());return k}(),i=(this.length-t.pos+this.offset)/2,l=function(){var S,k;for(k=[],c=S=0;0<=i?S<i:S>i;c=0<=i?++S:--S)k.push(t.readUInt16());return k}(),c=b=0,w=s.length;b<w;c=++b)for(y=s[c],n=v=m=g[c];m<=y?v<=y:v>=y;n=m<=y?++v:--v)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(h-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}t.pos=f}return e.encode=function(t,r){var n,i,s,o,l,c,u,d,f,h,p,m,g,y,b,v,w,S,k,j,A,L,P,B,E,T,F,W,z,se,de,U,G,re,X,C,K,V,R,J,q,Y,Q,ie,le,O;switch(W=new mh,o=Object.keys(t).sort(function(H,ae){return H-ae}),r){case"macroman":for(g=0,y=function(){var H=[];for(m=0;m<256;++m)H.push(0);return H}(),v={0:0},s={},z=0,G=o.length;z<G;z++)v[Q=t[i=o[z]]]==null&&(v[Q]=++g),s[i]={old:t[i],new:v[t[i]]},y[i]=v[t[i]];return W.writeUInt16(1),W.writeUInt16(0),W.writeUInt32(12),W.writeUInt16(0),W.writeUInt16(262),W.writeUInt16(0),W.write(y),{charMap:s,subtable:W.data,maxGlyphID:g+1};case"unicode":for(T=[],f=[],w=0,v={},n={},b=u=null,se=0,re=o.length;se<re;se++)v[k=t[i=o[se]]]==null&&(v[k]=++w),n[i]={old:k,new:v[k]},l=v[k]-i,b!=null&&l===u||(b&&f.push(b),T.push(i),u=l),b=i;for(b&&f.push(b),f.push(65535),T.push(65535),B=2*(P=T.length),L=2*Math.pow(Math.log(P)/Math.LN2,2),h=Math.log(L/2)/Math.LN2,A=2*P-L,c=[],j=[],p=[],m=de=0,X=T.length;de<X;m=++de){if(E=T[m],d=f[m],E===65535){c.push(0),j.push(0);break}if(E-(F=n[E].new)>=32768)for(c.push(0),j.push(2*(p.length+P-m)),i=U=E;E<=d?U<=d:U>=d;i=E<=d?++U:--U)p.push(n[i].new);else c.push(F-E),j.push(0)}for(W.writeUInt16(3),W.writeUInt16(1),W.writeUInt32(12),W.writeUInt16(4),W.writeUInt16(16+8*P+2*p.length),W.writeUInt16(0),W.writeUInt16(B),W.writeUInt16(L),W.writeUInt16(h),W.writeUInt16(A),q=0,C=f.length;q<C;q++)i=f[q],W.writeUInt16(i);for(W.writeUInt16(0),Y=0,K=T.length;Y<K;Y++)i=T[Y],W.writeUInt16(i);for(ie=0,V=c.length;ie<V;ie++)l=c[ie],W.writeUInt16(l);for(le=0,R=j.length;le<R;le++)S=j[le],W.writeUInt16(S);for(O=0,J=p.length;O<J;O++)g=p[O],W.writeUInt16(g);return{charMap:n,subtable:W.data,maxGlyphID:w+1}}},e}(),$z=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new SM(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,i;return r==null&&(r="macroman"),n=SM.encode(t,r),(i=new mh).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),Wge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),qge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),Hge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),Vge=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Gge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,i,s,o,l,c,u,d,f,h;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)i=n[s],t.pos=i.offset,u=t.readString(i.length),o=new Vge(u,i),c[h=i.nameID]==null&&(c[h]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),Kge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),Yge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,i,s,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=i?u<i:u>i;r=0<=i?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,f,h;for(h=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],h.push(s.advance);return h}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=i?o<i:o>i;r=0<=i?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),Uz=[].slice,Xge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,i,s,o,l,c,u,d,f;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(i=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new mh(r.read(i))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new Jge(l,u,f,c,d):new Qge(l,o,u,f,c,d),this.cache[t]))},e.prototype.encode=function(t,r,n){var i,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)i=t[r[l]],s.push(o.length),i&&(o=o.concat(i.encode(n)));return s.push(o.length),{table:o,offsets:s}},e}(),Qge=function(){function e(t,r,n,i,s,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Jge=function(){function e(t,r,n,i,s){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new mh(Uz.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),Zge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return dd(e,Su),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<n.length;++o)if(n[o]=i,s<r.length&&r[s]==o){++s,n[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},e}(),exe=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,s;for(r in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,s,o,l,c;for(i={},o=0,l=t.length;o<l;o++)i[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],i)(n=i[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],i[s]=n;return i},e.prototype.encode=function(t,r){var n,i,s,o,l,c,u,d,f,h,p,m,g,y,b;for(i in n=$z.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),p={0:0},b=n.charMap)p[(c=b[i]).old]=c.new;for(m in h=n.maxGlyphID,o)m in p||(p[m]=h++);return d=function(v){var w,S;for(w in S={},v)S[v[w]]=w;return S}(p),f=Object.keys(d).sort(function(v,w){return v-w}),g=function(){var v,w,S;for(S=[],v=0,w=f.length;v<w;v++)l=f[v],S.push(d[l]);return S}(),s=this.font.glyf.encode(o,g,p),u=this.font.loca.encode(s.offsets,g),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Un.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in s=["<<"],r)o=r[i],s.push("/"+i+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();const txe="/assets/logo-BRcnjZP7.jpg",rxe="K RAMAKRISHNAN COLLEGE OF TECHNOLOGY, Autonomous";function zz(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,64)}function Ub(e,t,r){const n=String(t??"");if(!n)return"";if(e.getTextWidth(n)<=r)return n;const i="",s=e.getTextWidth(i);if(s>=r)return"";let o=0,l=n.length;for(;o<l;){const c=Math.ceil((o+l)/2),u=n.slice(0,c);e.getTextWidth(u)+s<=r?o=c:l=c-1}return n.slice(0,Math.max(0,o))+i}function _M(e,t){const r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=e,n.click(),setTimeout(()=>URL.revokeObjectURL(r),500)}async function nxe(){var e;try{const t=await yr("/api/accounts/me/",{method:"GET"});if(!t.ok)return"";const r=await t.json(),n=String((r==null?void 0:r.username)||"").trim(),i=String(((e=r==null?void 0:r.profile)==null?void 0:e.staff_id)||"").trim();return n||i||""}catch{return""}}function Wz(e){const t=String(e.collegeName||rxe).trim(),r=String(e.courseName||"").trim(),n=String(e.courseCode||"").trim(),i=String(e.staffName||"").trim(),s=String(e.className||"").trim();return[t,`Course Name: ${r||"-"}`,`Course Code: ${n||"-"}`,`Staff Name: ${i||"-"}`,`Class Name: ${s||"-"}`]}function ixe(e,t){const r=Wz(e),n=["S.No","Reg No","Name","Total"],i=t.map(s=>[s.sno,s.regNo,s.name,s.total]);return[...r.map(s=>[s,"","",""]),[""],[n[0],n[1],n[2],n[3]],...i]}function axe(e,t,r){const i=bs.book_new(),s=[];for(let l=0;l<r.length;l+=45)s.push(r.slice(l,l+45));s.length===0&&s.push([]),s.forEach((l,c)=>{const u=bs.aoa_to_sheet(ixe(t,l));u["!freeze"]={xSplit:0,ySplit:7},u["!cols"]=[{wch:6},{wch:16},{wch:34},{wch:12}],bs.book_append_sheet(i,u,s.length>1?`Page_${c+1}`:"Sheet1")});const o=`${zz(e)||"marks"}_totals.xlsx`;dy(i,o)}function sxe(e,t){if(e.availableH=Math.max(60,e.bottomY-e.tableTopY),t.length<=1){e.colsNeeded=1,e.rowsPerCol=Math.max(1,t.length),e.colW=e.availableW;return}e.colsNeeded=2,e.colW=(e.availableW-e.colGap)/2;const r=Math.max(1,Math.ceil(t.length/2)),n=()=>e.headerRowH+r*e.rowH<=e.availableH;let i=0;for(;i++<30&&!n()&&e.rowH>6;)e.tableFont=Math.max(5,e.tableFont-.25),e.rowH=Math.max(6,e.rowH-1),e.headerRowH=Math.max(9,e.headerRowH-1);e.rowsPerCol=r}function kM(e,t,r){const n=new Un({orientation:e,unit:"pt",format:"a4"}),i=n.internal.pageSize.getWidth(),s=n.internal.pageSize.getHeight(),o=32,l=34,c=s-28,u=i-o*2,d=12,f=l,h=Math.max(60,c-f);let p=8,m=12,g=14;const y=10,b=()=>{const A=Math.max(1,Math.floor((h-g)/m)),L=Math.max(1,Math.ceil(r.length/A)),P=(u-y*(L-1))/L;return{rowsPerCol:A,colsNeeded:L,colW:P}};let{rowsPerCol:v,colsNeeded:w,colW:S}=b();const k=150;let j=0;for(;j++<12&&S<k&&w>1;)p=Math.max(6,p-.5),m=Math.max(9,m-1),g=Math.max(11,g-1),{rowsPerCol:v,colsNeeded:w,colW:S}=b();return{doc:n,marginX:o,topY:l,bottomY:c,tableTopY:f,availableW:u,availableH:h,tableFont:p,headerFont:d,rowH:m,headerRowH:g,colGap:y,colsNeeded:w,rowsPerCol:v,colW:S}}function oxe(e,t,r,n){const i=t.tableTopY,s={sno:.12,reg:.3,name:.43,total:.15},o=t.colW*s.sno,l=t.colW*s.reg,c=t.colW*s.name,u=t.colW*s.total,d=3;e.setFontSize(t.tableFont);const f=[17,24,39],h=[255,255,255],p=[180,180,180];for(let m=0;m<t.colsNeeded;m++){const g=t.marginX+m*(t.colW+t.colGap);let y=i;e.setFillColor(f[0],f[1],f[2]),e.rect(g,y,t.colW,t.headerRowH,"F"),e.setTextColor(h[0],h[1],h[2]);const b=y+t.headerRowH-4;e.text("S.No",g+d,b),e.text("Reg No",g+o+d,b),e.text("Name",g+o+l+d,b),e.text("Total",g+o+l+c+d,b),e.setDrawColor(p[0],p[1],p[2]),e.rect(g,y,t.colW,t.headerRowH),e.line(g+o,y,g+o,y+t.headerRowH),e.line(g+o+l,y,g+o+l,y+t.headerRowH),e.line(g+o+l+c,y,g+o+l+c,y+t.headerRowH),y+=t.headerRowH,e.setTextColor(0,0,0);const v=m*t.rowsPerCol,w=Math.min(n.length,v+t.rowsPerCol);for(let S=v;S<w;S++){const k=n[S],j=y+(S-v)*t.rowH;e.rect(g,j,t.colW,t.rowH),e.line(g+o,j,g+o,j+t.rowH),e.line(g+o+l,j,g+o+l,j+t.rowH),e.line(g+o+l+c,j,g+o+l+c,j+t.rowH);const A=j+t.rowH-3,L=Ub(e,String((k==null?void 0:k.sno)??""),Math.max(0,o-d*2)),P=Ub(e,String((k==null?void 0:k.regNo)??""),Math.max(0,l-d*2)),B=Ub(e,String((k==null?void 0:k.name)??""),Math.max(0,c-d*2)),E=Ub(e,String((k==null?void 0:k.total)??""),Math.max(0,u-d*2));e.text(L,g+d,A),e.text(P,g+o+d,A),e.text(B,g+o+l+d,A),e.text(E,g+o+l+c+d,A)}}}async function lxe(e){try{const t=await fetch(e,{cache:"no-cache"});if(!t.ok)return null;const r=await t.blob();return await new Promise(n=>{const i=new FileReader;i.onload=()=>n(String(i.result||"")),i.onerror=()=>n(null),i.readAsDataURL(r)})}catch{return null}}async function cxe(e,t,r,n){const i=String((r==null?void 0:r.bannerUrl)||txe),s=(r==null?void 0:r.bannerUrl)||i,o=await lxe(s),l=n.length>=55;let c=0;if(o)try{const h=new Image;h.src=o,await new Promise(A=>{h.onload=()=>A(!0),h.onerror=()=>A(!0)});const p=h.naturalWidth||h.width||1,m=h.naturalHeight||h.height||1,g=t.doc.internal.pageSize.getWidth(),y=l?135:170,b=g-2*t.marginX,v=p/m;let w=b,S=w/v;S>y&&(S=y,w=S*v);const k=(g-w)/2,j=12;t.doc.addImage(o,"PNG",k,j,w,S),c=S,t.tableTopY=j+S+(l?10:14)}catch{}else t.tableTopY=t.topY;const u=t.tableTopY;e.setFontSize(l?8:9),e.setTextColor(0,0,0);const d=[];r.courseName&&d.push(`Course Name: ${r.courseName}`),r.courseCode&&d.push(`Course Code: ${r.courseCode}`),r.staffName&&d.push(`Staff Name: ${r.staffName}`),r.className&&d.push(`Class Name: ${r.className}`);const f=l?10:11;for(let h=0;h<d.length;h++)e.text(d[h],t.marginX,u+h*f);return t.tableTopY=u+d.length*f+(l?6:10),sxe(t,n),oxe(e,t,r,n)}async function Mk(e,t,r){const n=kM("portrait",t,r),s=n.colsNeeded>=4?kM("landscape",t,r):n;await cxe(s.doc,s,t,r);const o=s.doc.output("blob"),l=`${zz(e)||"marks"}_totals.pdf`;return{blob:o,filename:l}}function uxe(e,t,r){e.innerHTML="";const n=Wz(t),i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="2px",i.style.marginBottom="10px",n.forEach(d=>{const f=document.createElement("div");f.textContent=d,f.style.fontWeight=d===n[0]?"900":"700",f.style.fontSize=d===n[0]?"14px":"12px",i.appendChild(f)}),e.appendChild(i);const s=document.createElement("div");s.className="obe-table-wrapper",s.style.maxHeight="420px",s.style.overflow="auto";const o=document.createElement("table");o.className="obe-table",o.style.minWidth="unset";const l=document.createElement("thead"),c=document.createElement("tr");["S.No","Reg No","Name","Total"].forEach(d=>{const f=document.createElement("th");f.textContent=d,c.appendChild(f)}),l.appendChild(c),o.appendChild(l);const u=document.createElement("tbody");r.forEach(d=>{const f=document.createElement("tr");[d.sno,d.regNo,d.name,d.total].forEach(h=>{const p=document.createElement("td");p.textContent=String(h??""),f.appendChild(p)}),u.appendChild(f)}),o.appendChild(u),s.appendChild(o),e.appendChild(s)}function dxe(e,t){e.innerHTML="";const r=URL.createObjectURL(t),n=document.createElement("iframe");return n.src=r,n.style.width="100%",n.style.height="520px",n.style.border="1px solid rgba(226,232,240,0.9)",n.style.borderRadius="10px",e.appendChild(n),()=>URL.revokeObjectURL(r)}async function fxe(e){if(typeof document>"u"||typeof window>"u"){const{blob:S,filename:k}=await Mk(e.filenameBase,e.meta,e.rows);_M(k,S);return}const t=document.createElement("div");t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.style.position="fixed",t.style.inset="0",t.style.background="rgba(0,0,0,0.35)",t.style.display="grid",t.style.placeItems="center",t.style.padding="16px",t.style.zIndex="9999";const r=document.createElement("div");r.className="obe-card",r.style.width="min(980px, 100%)",r.style.maxHeight="min(92vh, 900px)",r.style.overflow="auto";const n=document.createElement("div");n.textContent="Preview totals before download",n.style.fontWeight="950",n.style.fontSize="14px",n.style.marginBottom="10px";const i=document.createElement("div");i.style.display="flex",i.style.gap="8px",i.style.flexWrap="wrap",i.style.alignItems="center",i.style.justifyContent="space-between",i.style.marginBottom="10px";const s=document.createElement("div");s.style.display="flex",s.style.gap="8px",s.style.flexWrap="wrap";const o=document.createElement("button");o.className="obe-btn obe-btn-secondary",o.textContent="Excel preview";const l=document.createElement("button");l.className="obe-btn obe-btn-primary",l.textContent="PDF preview",s.appendChild(o),s.appendChild(l);const c=document.createElement("div");c.style.display="flex",c.style.gap="8px",c.style.flexWrap="wrap";const u=document.createElement("button");u.className="obe-btn",u.textContent="Close";const d=document.createElement("button");d.className="obe-btn obe-btn-success",d.textContent="Download",c.appendChild(u),c.appendChild(d),i.appendChild(s),i.appendChild(c);const f=document.createElement("div");r.appendChild(n),r.appendChild(i),r.appendChild(f),t.appendChild(r);let h="pdf",p=null,m=null;const g=()=>{o.className=h==="excel"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",l.className=h==="pdf"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary"},y=async()=>{if(p&&(p(),p=null),f.innerHTML="",g(),h==="excel"){m=null,uxe(f,e.meta,e.rows);return}m=await Mk(e.filenameBase,e.meta,e.rows),p=dxe(f,m.blob)};let b=!1;const v=()=>{if(!b){b=!0,p&&p();try{window.removeEventListener("keydown",w),t.remove()}catch{}}},w=S=>{S.key==="Escape"&&v()};t.addEventListener("click",S=>{S.target===t&&v()}),u.addEventListener("click",v),o.addEventListener("click",()=>{h="excel",y()}),l.addEventListener("click",()=>{h="pdf",y()}),d.addEventListener("click",async()=>{if(h==="excel"){axe(e.filenameBase,e.meta,e.rows);return}const S=m||await Mk(e.filenameBase,e.meta,e.rows);_M(S.filename,S.blob)}),window.addEventListener("keydown",w),document.body.appendChild(t),y()}async function hy(e){const t={...e.meta};t.staffName||(t.staffName=await nxe());const r=(e.rows||[]).filter(n=>n&&n.regNo);await fxe({filenameBase:e.filenameBase,meta:t,rows:r})}const Lk={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},jM=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function AM(e){if(e==="both")return"both";if(e==="1&2"||e==="3&4")return e;if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="5")return 5;if(r==="4")return 4;if(r==="3")return 3;if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(4))return 4;if(r.includes(3))return 3;if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===5?5:t===4?4:t===3?3:t===2?2:t===34?"3&4":t===12?"1&2":1}function hxe(e){return e==="cia2"?{a:3,b:4}:{a:1,b:2}}function oA(e){return e==="both"||e==="1&2"||e==="3&4"}function pxe(e,t){if(oA(e))return{a:.5,b:.5};const r=t.a===3,n=e===t.a||r&&e===1,i=e===t.b||r&&e===2;return n?{a:1,b:0}:i?{a:0,b:1}:{a:0,b:0}}function zb(e,t,r){const n=e[t];if(!n)return{a:0,b:0};if(oA(n.co))return{a:.5,b:.5};const i=e.some(l=>oA(l.co)),s=t===e.length-1,o=String(n.key||"").toLowerCase()==="q9"||String(n.label||"").toLowerCase().includes("q9");return!i&&s&&o?{a:.5,b:.5}:pxe(n.co,r)}function Ph(e){return Object.fromEntries((e||[]).map(t=>[t.key,t.btl]))}function Sd(e,t,r){return Math.max(t,Math.min(r,e))}function _d(e,t){if(!t)return"-";const r=e/t*100;if(!Number.isFinite(r))return"-";const n=r.toFixed(1);return n.endsWith(".0")?n.slice(0,-2):n}function Wb(e,t){return`${e}_sheet_${t}`}function mxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function qz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,classType:n,questionPaperType:i}){const s=r||"cia1",o=s==="cia2"?"CIA 2":"CIA 1",l=x.useMemo(()=>hxe(s),[s]),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState(null),y=x.useMemo(()=>{const we=String(ti(n)||"").trim().toUpperCase();return we?we==="THEORY"?"THEORY":we:""},[n]),b=x.useMemo(()=>{const we=String(i??"").trim().toUpperCase();return we==="QP2"?"QP2":we==="QP1"?"QP1":""},[i]);x.useEffect(()=>{let we=!0;return(async()=>{var nn,ct;if(!y){p(null);return}const tt=y==="THEORY"&&b||null,dt=s==="cia2"?"CIA2":"CIA1";let xt=null,Cr=[];try{xt=await ih({class_type:y,question_paper_type:tt,exam:dt}),Cr=Array.isArray((nn=xt==null?void 0:xt.pattern)==null?void 0:nn.marks)?xt.pattern.marks:[]}catch{}if(!Cr.length)try{xt=await ih({class_type:y,question_paper_type:tt,exam:"CIA"}),Cr=Array.isArray((ct=xt==null?void 0:xt.pattern)==null?void 0:ct.marks)?xt.pattern.marks:[]}catch{}we&&p(Cr.length?xt.pattern:null)})(),()=>{we=!1}},[y,b,s]);const v=x.useMemo(()=>{var xt,Cr,nn,ct;const we=((Cr=(xt=c==null?void 0:c.assessments)==null?void 0:xt[s])==null?void 0:Cr.questions)??((ct=(nn=c==null?void 0:c.assessments)==null?void 0:nn.cia1)==null?void 0:ct.questions),Ie=Array.isArray(we)&&we.length?we.map(Ht=>({key:String((Ht==null?void 0:Ht.key)||""),label:String((Ht==null?void 0:Ht.label)||(Ht==null?void 0:Ht.key)||""),max:Number((Ht==null?void 0:Ht.max)||0),co:AM(Ht==null?void 0:Ht.co),btl:Math.min(6,Math.max(1,Number((Ht==null?void 0:Ht.btl)||1)))})).filter(Ht=>Ht.key):jM,tt=Array.isArray(h==null?void 0:h.marks)?h.marks:null,dt=Array.isArray(h==null?void 0:h.cos)?h.cos:null;return Array.isArray(tt)&&tt.length?tt.map((Ht,Ue)=>{const qe=Ie[Ue],at=dt?dt[Ue]:void 0;return{key:`q${Ue+1}`,label:`Q${Ue+1}`,max:Number(Ht)||0,co:at!=null?AM(at):(qe==null?void 0:qe.co)??l.a,btl:(qe==null?void 0:qe.btl)??1}}).filter(Ht=>!!Ht.key):Ie},[c,s,h,l.a]),[w,S]=x.useState(!1),[k,j]=x.useState(!1),[A,L]=x.useState(!1),[P,B]=x.useState(null),[E,T]=x.useState([]),[F,W]=x.useState({}),[z,se]=x.useState(null),[de,U]=x.useState(null),[G,re]=x.useState(!1),[X,C]=x.useState(!1),[K,V]=x.useState(null),[R,J]=x.useState(null),q=x.useRef(null),[Y,Q]=x.useState(!1),[ie,le]=x.useState(""),[O,H]=x.useState(!1),[ae,I]=x.useState(null),[Z,pe]=x.useState(!1),[Oe,Ae]=x.useState(null),[ke,_e]=x.useState(null),{data:De,loading:We,error:Ct,remainingSeconds:_t,publishAllowed:Xe,refresh:nt}=H0({assessment:s,subjectCode:e,teachingAssignmentId:t}),Ne=!!(De!=null&&De.global_override_active&&(De==null?void 0:De.global_is_open)===!1),{data:be,refresh:fe}=V0({assessment:s,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ge}=nc({assessment:s,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:lt}=nc({assessment:s,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),[He,mt]=x.useState(""),[wt,Pt]=x.useState(!1),[bt,qr]=x.useState(null),[Tt,xr]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,questionBtl:Ph(jM),rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),Zr=x.useRef(null),[Xr,Br]=x.useState(!1),[Vr,An]=x.useState(null),[Yr,Ln]=x.useState(!1),[Me,Ce]=x.useState(null),[It,ft]=x.useState([]),[Ot,er]=x.useState([]),[hr,Tr]=x.useState([]),[ne,ce]=x.useState(null);x.useEffect(()=>{ce(null),I(null)},[e]);const te=!!de||!!(be!=null&&be.exists&&(be!=null&&be.is_published)),ue=!!Tt.markManagerLocked;Tt.markManagerSnapshot!=null;const Ee=lt!=null&&lt.approval_until?String(lt.approval_until):null,je=ge!=null&&ge.approval_until?String(ge.approval_until):null,gt=!!(lt!=null&&lt.allowed_by_approval)&&!!Ee&&Ee!==((ne==null?void 0:ne.markEntryApprovalUntil)??null),Qe=!!(ge!=null&&ge.allowed_by_approval)&&!!je&&je!==((ne==null?void 0:ne.markManagerApprovalUntil)??null),Fe=te?!!(be!=null&&be.entry_open)||gt||Qe:!0,$e=!!(te&&!Fe),st=!!(Ne||(te?!Fe:!ue)),Wt=!!(te&&$e),{pending:qt,pendingUntilMs:ht,setPendingUntilMs:Ut,refresh:Gt}=G0({enabled:!!Wt&&!!e,assessment:s,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!Y||!!G||!!Vr);function cr(we,Ie){return JSON.stringify({assessmentKey:s,totalsMax:bn,questions:(v||[]).map(tt=>({key:tt.key,label:tt.label,max:tt.max})),questionBtl:we,mark_manager:{questions:(Ie==null?void 0:Ie.questions)??[],marks:(Ie==null?void 0:Ie.marks)??[],btls:(Ie==null?void 0:Ie.btls)??[]}})}async function ir(){if(e){Ln(!0),Ce(null);try{const we=await nl({assessment:s,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${o} ${e}`,teaching_assignment_id:t});alert(il(we))}catch(we){const Ie=al(we,"Request failed");Ce(Ie),alert(`Edit request failed: ${Ie}`)}finally{Ln(!1)}}}async function Fr(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(qt){I("Edit request is pending. Please wait for approval.");return}const Ie=String(ie||"").trim();if(!Ie){I("Reason is required.");return}H(!0);try{const tt=await nl({assessment:s,subject_code:String(e),scope:"MARK_ENTRY",reason:Ie,teaching_assignment_id:t});I(il(tt).replace(/\n/g,"  ")),Q(!1),le(""),Ut(Date.now()+24*60*60*1e3);try{Gt({silent:!0})}catch{}fe({silent:!0})}catch(tt){const dt=al(tt,"Request failed");alert(`Edit request failed: ${dt}`)}finally{H(!1)}}async function dn(){if(O)return;if(qt){I("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}B(null),I(null),le(""),Q(!0)}x.useEffect(()=>{if(!e||!te||Fe)return;const we=window.setInterval(()=>{fe({silent:!0})},3e4);return()=>window.clearInterval(we)},[Fe,te,e,fe]);const vr=x.useRef(!!Fe);x.useEffect(()=>{if(!e||!te)return;if(vr.current||!Fe){vr.current=!!Fe;return}let Ie=!0;return(async()=>{try{const tt=await ei(s,e);if(!Ie)return;const dt=tt==null?void 0:tt.draft;dt&&typeof dt=="object"?xr(xt=>({...xt,termLabel:String(dt.termLabel||xt.termLabel),batchLabel:e,questionBtl:dt.questionBtl&&typeof dt.questionBtl=="object"?dt.questionBtl:xt.questionBtl,rowsByStudentId:dt.rowsByStudentId&&typeof dt.rowsByStudentId=="object"?dt.rowsByStudentId:xt.rowsByStudentId,markManagerLocked:dt.markManagerLocked??xt.markManagerLocked,markManagerSnapshot:dt.markManagerSnapshot??xt.markManagerSnapshot,markManagerApprovalUntil:dt.markManagerApprovalUntil??xt.markManagerApprovalUntil})):Lt(!0)}catch{try{Lt(!0)}catch{}}})(),vr.current=!!Fe,()=>{Ie=!1}},[Fe,te,e,s]);const Lt=async we=>{if(e){we||(V(null),C(!0));try{const Ie=await v0(s,e,t),tt=Ie&&Ie.data!=null?Ie.data:null;J(tt)}catch(Ie){we||V((Ie==null?void 0:Ie.message)||"Failed to load published sheet")}finally{we||C(!1)}}};x.useEffect(()=>{G&&(J(null),Lt(!1))},[G,e,s]);async function Gr(){if(e){Ln(!0),Ce(null);try{const we=cr(Tt.questionBtl,{questions:It,marks:Ot,btls:hr}),Ie=ge!=null&&ge.approval_until?String(ge.approval_until):Tt.markManagerApprovalUntil||null,tt={...Tt,markManagerLocked:!0,markManagerSnapshot:we,markManagerApprovalUntil:Ie},dt={termLabel:tt.termLabel,batchLabel:e,questionBtl:tt.questionBtl,rowsByStudentId:tt.rowsByStudentId,markManagerLocked:tt.markManagerLocked,markManagerSnapshot:tt.markManagerSnapshot,markManagerApprovalUntil:tt.markManagerApprovalUntil};xr(tt),An(null),await Mi(s,e,dt),se(new Date().toLocaleString());try{await uh(s,String(e),t),fe({silent:!0})}catch(xt){console.warn("confirmMarkManagerLock failed",xt)}}catch(we){Ce((we==null?void 0:we.message)||"Save failed")}finally{Ln(!1)}}}x.useEffect(()=>{if(!(!Vr||Vr.mode!=="confirm"))try{if(Tt.markManagerSnapshot){const we=JSON.parse(String(Tt.markManagerSnapshot)),Ie=we&&we.mark_manager||{};ft(Array.isArray(Ie.questions)?Ie.questions.map(tt=>Number(tt)).filter(tt=>Number.isFinite(tt)):[]),er(Array.isArray(Ie.marks)?Ie.marks.map(tt=>Number(tt)).filter(tt=>Number.isFinite(tt)):[]),Tr(Array.isArray(Ie.btls)?Ie.btls.map(tt=>Number(tt)).filter(tt=>Number.isFinite(tt)):[])}else ft([]),er([]),Tr([])}catch{ft([]),er([]),Tr([])}},[Vr]),x.useEffect(()=>{let we=!0;return(async()=>{try{const Ie=await vu();if(!we)return;u(Ie||null),f(null),xr(tt=>({...tt,termLabel:String((Ie==null?void 0:Ie.termLabel)||tt.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch(Ie){if(!we)return;u(null),f((Ie==null?void 0:Ie.message)||"Failed to load OBE Master config; using derived maxima from questions.")}})(),()=>{we=!1}},[e]),x.useEffect(()=>{let we=!0;return(async()=>{if(e){S(!0),B(null);try{let tt=null,dt=null;try{dt=(await lc()||[]).find(Be=>{const vt=String(Be.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?Be.id===t:!1)||vt})}catch{}if(dt&&dt.elective_subject_id&&!dt.section_id)try{const at=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(dt.elective_subject_id))}`);if(at.ok){const Be=await at.json();tt={students:((Array.isArray(Be.results)?Be.results:Array.isArray(Be)?Be:Be.items||[])||[]).map(jt=>({id:Number(jt.student_id??jt.id),reg_no:String(jt.reg_no??jt.regno??""),name:String(jt.name??jt.full_name??jt.username??""),section:jt.section_name??jt.section??null})),marks:{}}}}catch(at){console.warn("Elective-choices fetch failed, falling back:",at)}if(!tt)try{tt=await B9(s,e,t)}catch(at){if(console.warn("CIA marks fetch failed:",at),dt&&dt.id)try{tt={students:(await qc(dt.id)).students||[],marks:{}}}catch{console.warn("TA roster fallback failed")}if(!tt)throw at}if(!we)return;let xt=(tt.students||[]).slice().sort((at,Be)=>{const vt=String((at==null?void 0:at.name)||"").trim().toLowerCase(),jt=String((Be==null?void 0:Be.name)||"").trim().toLowerCase();if(vt&&jt){const $t=vt.localeCompare(jt);if($t)return $t}else if(vt||jt)return vt?-1:1;return String((at==null?void 0:at.reg_no)||"").localeCompare(String((Be==null?void 0:Be.reg_no)||""),void 0,{numeric:!0,sensitivity:"base"})});T(xt),g((tt==null?void 0:tt.subject)||null);const Cr=tt.marks||{},nn={};for(const[at,Be]of Object.entries(Cr)){const vt=Number(at);if(!Number.isFinite(vt))continue;if(Be==null||Be===""){nn[vt]=null;continue}const jt=Number(Be);nn[vt]=Number.isFinite(jt)?jt:null}W(nn);try{let at=null;if(s==="cia1"?at=await ry(e):at=await v0("cia2",e),at&&at.data&&typeof at.data=="object"){const Be=at.data,vt=Be.rowsByStudentId||Be.rows||Be.sheet&&Be.sheet.rowsByStudentId||{},jt={};for(const[Ur,en]of Object.entries(vt||{})){const vn=String(Ur),Nr=en,fn={},rr=Nr.q||Nr.answers||Nr.questions||Nr;if(rr&&typeof rr=="object")for(const[ve,rt]of Object.entries(rr)){const ut=Number(rt);fn[ve]=Number.isFinite(ut)?ut:""}jt[vn]={studentId:Number(vn)||0,absent:!!Nr.absent,absentKind:Nr.absentKind||void 0,reg_no:String(Nr.reg_no||Nr.reg_no_text||""),q:fn}}const $t=Array.isArray(Be.questions)?Object.fromEntries(Be.questions.map(Ur=>[String(Ur.key||Ur.label||""),Number(Ur.btl||Ur.btl_level||1)])):Ph(v),Rr=Object.fromEntries(Object.entries($t).map(([Ur,en])=>{const vn=Number(en);return Number.isFinite(vn)&&vn>=1&&vn<=6?[Ur,vn]:[Ur,""]}));xr({termLabel:String(Be.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:Rr,rowsByStudentId:jt}),U(new Date().toLocaleString());try{Gn(Wb(s,e),{termLabel:String(Be.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:Rr,rowsByStudentId:jt})}catch{}}}catch{}const ct=Jn(Wb(s,e)),Ht=ct&&typeof ct=="object"?{termLabel:c!=null&&c.termLabel?String(c.termLabel):String(ct.termLabel||"KRCT AY25-26"),batchLabel:e,questionBtl:ct.questionBtl&&typeof ct.questionBtl=="object"?ct.questionBtl:Ph(v),rowsByStudentId:ct.rowsByStudentId&&typeof ct.rowsByStudentId=="object"?ct.rowsByStudentId:{}}:{termLabel:String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:Ph(v),rowsByStudentId:{}},Ue={...Ph(v),...Ht.questionBtl||{}};for(const at of v){const Be=Ue[at.key];Be===""||Be===1||Be===2||Be===3||Be===4||Be===5||Be===6||(Ue[at.key]="")}const qe={...Ht.rowsByStudentId};for(const at of tt.students||[]){const Be=String(at.id);if(qe[Be]){const vt=!!qe[Be].absent,jt=String(qe[Be].absentKind||"").toUpperCase(),$t=vt?jt==="ML"||jt==="SKL"||jt==="AL"?jt:"AL":void 0;qe[Be]={studentId:at.id,absent:vt,absentKind:$t,reg_no:at.reg_no||"",q:{...qe[Be].q}}}else qe[Be]={studentId:at.id,absent:!1,absentKind:void 0,reg_no:at.reg_no||"",q:Object.fromEntries(v.map(vt=>[vt.key,""]))};for(const vt of v)vt.key in(qe[Be].q||{})||(qe[Be].q[vt.key]="")}xr({...Ht,questionBtl:Ue,termLabel:Ht.termLabel||String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,rowsByStudentId:qe})}catch(tt){if(!we)return;B((tt==null?void 0:tt.message)||`Failed to load ${o} roster`)}finally{we&&S(!1)}}})(),()=>{we=!1}},[e,t,c,v,s,o]),x.useEffect(()=>{let we=!0;return(async()=>{if(e)try{const Ie=await ei(s,e);if(!we)return;const tt=Ie==null?void 0:Ie.draft;if(tt&&typeof tt=="object"){xr(dt=>({...dt,termLabel:String(tt.termLabel||dt.termLabel),batchLabel:e,questionBtl:tt.questionBtl&&typeof tt.questionBtl=="object"?tt.questionBtl:dt.questionBtl,rowsByStudentId:tt.rowsByStudentId&&typeof tt.rowsByStudentId=="object"?tt.rowsByStudentId:dt.rowsByStudentId}));try{const dt=Wb(s,e);Gn(dt,{termLabel:String(tt.termLabel||"KRCT AY25-26"),batchLabel:String(e),questionBtl:tt.questionBtl&&typeof tt.questionBtl=="object"?tt.questionBtl:Ph(v),rowsByStudentId:tt.rowsByStudentId&&typeof tt.rowsByStudentId=="object"?tt.rowsByStudentId:{}})}catch{}}}catch{if(!we)return}})(),()=>{we=!1}},[e,s,v]);const bn=x.useMemo(()=>v.reduce((we,Ie)=>we+Ie.max,0),[v]),or=x.useMemo(()=>{let we=0,Ie=0;for(let tt=0;tt<v.length;tt++){const dt=v[tt],xt=zb(v,tt,l);we+=dt.max*xt.a,Ie+=dt.max*xt.b}return{a:we,b:Ie}},[v,l]),kr=x.useMemo(()=>{var dt,xt,Cr,nn;const we=((xt=(dt=c==null?void 0:c.assessments)==null?void 0:dt[s])==null?void 0:xt.coMax)??((nn=(Cr=c==null?void 0:c.assessments)==null?void 0:Cr.cia1)==null?void 0:nn.coMax),Ie=Number((we==null?void 0:we[`co${l.a}`])??(we==null?void 0:we.co1)),tt=Number((we==null?void 0:we[`co${l.b}`])??(we==null?void 0:we.co2));return{a:Number.isFinite(Ie)?Math.max(0,Ie):or.a,b:Number.isFinite(tt)?Math.max(0,tt):or.b}},[c,or,s,l]),Mr=x.useMemo(()=>{const we=new Set;for(const Ie of v){const tt=(Tt.questionBtl||{})[Ie.key];(tt===1||tt===2||tt===3||tt===4||tt===5||tt===6)&&we.add(tt)}return[1,2,3,4,5,6].filter(Ie=>we.has(Ie))},[Tt.questionBtl,v]),Ar=x.useMemo(()=>{const we={1:0,2:0,3:0,4:0,5:0,6:0};for(const Ie of v){const tt=(Tt.questionBtl||{})[Ie.key];(tt===1||tt===2||tt===3||tt===4||tt===5||tt===6)&&(we[tt]+=Ie.max)}return we},[Tt.questionBtl,v]),Zt=x.useMemo(()=>{var tt,dt,xt,Cr;const we=((dt=(tt=c==null?void 0:c.assessments)==null?void 0:tt[s])==null?void 0:dt.btlMax)??((Cr=(xt=c==null?void 0:c.assessments)==null?void 0:xt.cia1)==null?void 0:Cr.btlMax),Ie=(nn,ct)=>{const Ht=Number(we==null?void 0:we[nn]);return Number.isFinite(Ht)?Math.max(0,Ht):ct};return{1:Ie("1",Ar[1]),2:Ie("2",Ar[2]),3:Ie("3",Ar[3]),4:Ie("4",Ar[4]),5:Ie("5",Ar[5]),6:Ie("6",Ar[6])}},[c,Ar,s]),Kt=(we,Ie)=>{A||st||xr(tt=>{const dt=String(we),xt=tt.rowsByStudentId[dt]||{studentId:we,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(nn=>[nn.key,""]))},Cr=Ie?{...xt,absent:!0,absentKind:xt.absentKind||"AL",q:Object.fromEntries(v.map(nn=>[nn.key,""]))}:{...xt,absent:!1,absentKind:void 0};return{...tt,rowsByStudentId:{...tt.rowsByStudentId,[dt]:Cr}}})},it=(we,Ie)=>{A||st||xr(tt=>{const dt=String(we),xt=tt.rowsByStudentId[dt]||{studentId:we,absent:!0,absentKind:"AL",reg_no:"",q:Object.fromEntries(v.map(Cr=>[Cr.key,""]))};return{...tt,rowsByStudentId:{...tt.rowsByStudentId,[dt]:{...xt,absent:!0,absentKind:Ie}}}})},At=(we,Ie)=>{if(A||Ne)return;const tt=Tt.markManagerSnapshot!=null;ue&&tt||$e||xr(dt=>({...dt,questionBtl:{...dt.questionBtl||Ph(v),[we]:Ie}}))};x.useEffect(()=>{if(!e)return;let we=!1;const Ie=setTimeout(async()=>{try{const tt={termLabel:Tt.termLabel,batchLabel:e,questionBtl:Tt.questionBtl,rowsByStudentId:Tt.rowsByStudentId};await Mi(s,e,tt);try{const dt=Wb(s,e);Gn(dt,{termLabel:Tt.termLabel,batchLabel:e,questionBtl:Tt.questionBtl,rowsByStudentId:Tt.rowsByStudentId})}catch{}we||se(new Date().toLocaleString())}catch{}},700);return()=>{we=!0,clearTimeout(Ie)}},[Tt.questionBtl,e,Tt.rowsByStudentId,s]);const Mt=(we,Ie,tt)=>{A||st||xr(dt=>{const xt=String(we),Cr=dt.rowsByStudentId[xt]||{studentId:we,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(jt=>[jt.key,""]))},nn=!!Cr.absent,ct=nn?String(Cr.absentKind||"AL").toUpperCase():"";if(nn&&!!!(Z&&nn))return dt;const Ue=v.find(jt=>jt.key===Ie),qe=(Ue==null?void 0:Ue.max)??bn,at=tt===""?"":Sd(Number(tt||0),0,qe),Be=Cr.absent?Cr.absentKind||"AL":null,vt=Be==="ML"?60:Be==="SKL"?75:null;return vt!=null&&v.reduce(($t,Rr)=>{const Ur=Rr.key===Ie?at:(Cr.q||{})[Rr.key];return $t+Sd(Number(Ur||0),0,Rr.max)},0)>vt?(_e({title:"Mark limit exceeded",message:ct==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"}),dt):{...dt,rowsByStudentId:{...dt.rowsByStudentId,[xt]:{...Cr,q:{...Cr.q||{},[Ie]:at}}}}})},ar=we=>!we||!we.q?!1:v.some(Ie=>{const tt=we.q[Ie.key];return tt!==""&&tt!==null&&tt!==void 0});x.useMemo(()=>{const we={};for(const Ie of E){const tt=Tt.rowsByStudentId[String(Ie.id)];if(!tt){we[Ie.id]=null;continue}if(tt.absent&&String(tt.absentKind||"AL").toUpperCase()==="AL"){we[Ie.id]=0;continue}const dt=v.reduce((xt,Cr)=>{var nn;return xt+Sd(Number(((nn=tt.q)==null?void 0:nn[Cr.key])||0),0,Cr.max)},0);we[Ie.id]=dt}return we},[E,Tt.rowsByStudentId,v]);const Ge=x.useRef(Tt);Ge.current=Tt,x.useEffect(()=>{const we=()=>{if(!e||E.length===0||st||Ne)return;const Ie=Ge.current,tt={termLabel:Ie.termLabel,batchLabel:e,questionBtl:Ie.questionBtl,rowsByStudentId:Ie.rowsByStudentId};Mi(s,e,tt).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",we),()=>window.removeEventListener("obe:before-tab-switch",we)},[e,s,E.length,st,Ne]);const Rt=async()=>{j(!0),B(null);try{const we={termLabel:Tt.termLabel,batchLabel:e,questionBtl:Tt.questionBtl,rowsByStudentId:Tt.rowsByStudentId};await Mi(s,e,we),se(new Date().toLocaleString())}catch(we){B((we==null?void 0:we.message)||`Failed to save ${o} draft`)}finally{j(!1)}},Ze=async()=>{var we;if(e){if(Ne){B("Publishing is locked by IQAC.");return}if(!Xe){B("Publish window is closed. Please request IQAC approval.");return}if(te&&$e){if(qt){B("Edit request is pending. Please wait for approval.");return}await dn();return}L(!0),B(null),I(null);try{const Ie={};for(const[dt,xt]of Object.entries(Tt.rowsByStudentId||{})){const Cr=xt||{},nn=ar(Cr);Cr.absent&&nn?Ie[dt]={...Cr,absent:!1,absentKind:void 0}:Ie[dt]=Cr}const tt={...Tt,batchLabel:e,questions:v,rowsByStudentId:Ie};await R9(s,e,tt,t),U(new Date().toLocaleString()),ce({markEntryApprovalUntil:Ee,markManagerApprovalUntil:je}),xr(dt=>({...dt,markManagerLocked:!0})),nt(),fe({silent:!0}),Lt(!0);try{console.debug("obe:published dispatch",{assessment:s,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:s}}))}catch{}setTimeout(()=>{try{if(G&&q.current){const dt=q.current;dt.scrollTop=dt.scrollHeight}}catch{}},50)}catch(Ie){const tt=Ie==null?void 0:Ie.status;if(String(((we=Ie==null?void 0:Ie.body)==null?void 0:we.detail)||(Ie==null?void 0:Ie.message)||""),tt===423){U(dt=>dt||new Date().toLocaleString()),nt(),fe({silent:!0}),B(null),await dn();return}B((Ie==null?void 0:Ie.message)||`Failed to publish ${o}`)}finally{L(!1)}}},ot=async()=>{Pt(!0),qr(null),B(null);try{await Sh({assessment:s,subject_code:e,reason:He,teaching_assignment_id:t}),qr("Request sent to IQAC for approval.")}catch(we){B((we==null?void 0:we.message)||"Failed to request approval")}finally{Pt(!1),nt()}},Bt=()=>{const we=E.map((Ie,tt)=>{const dt=Tt.rowsByStudentId[String(Ie.id)]||{studentId:Ie.id,absent:!1,absentKind:void 0,q:Object.fromEntries(v.map(jt=>[jt.key,""]))},xt=ar(dt),Cr=!!(dt.absent&&!xt),nn=Cr?String(dt.absentKind||"AL"):"";if(Cr){const jt=Object.fromEntries(v.map($t=>[$t.key,""]));return{sno:tt+1,registerNo:Ie.reg_no,name:Ie.name,absent:1,absentKind:nn,...jt,total:"ABSENT",[`co${l.a}_mark`]:"",[`co${l.a}_pct`]:"",[`co${l.b}_mark`]:"",[`co${l.b}_pct`]:"",...Object.fromEntries(Mr.flatMap($t=>[[`btl${$t}_mark`,""],[`btl${$t}_pct`,""]]))}}const ct=0,Ht="",Ue=Object.fromEntries(v.map(jt=>{var $t;return[jt.key,Sd(Number((($t=dt.q)==null?void 0:$t[jt.key])||0),0,jt.max)]})),qe=v.reduce((jt,$t)=>jt+Number(Ue[$t.key]||0),0);let at=0,Be=0;for(let jt=0;jt<v.length;jt++){const $t=v[jt],Rr=zb(v,jt,l),Ur=Number(Ue[$t.key]||0);at+=Ur*Rr.a,Be+=Ur*Rr.b}const vt={1:0,2:0,3:0,4:0,5:0,6:0};for(const jt of v){const $t=(Tt.questionBtl||{})[jt.key];($t===1||$t===2||$t===3||$t===4||$t===5||$t===6)&&(vt[$t]+=Number(Ue[jt.key]||0))}return{sno:tt+1,registerNo:Ie.reg_no,name:Ie.name,absent:ct,absentKind:Ht,...Ue,total:qe,[`co${l.a}_mark`]:at,[`co${l.a}_pct`]:_d(at,kr.a),[`co${l.b}_mark`]:Be,[`co${l.b}_pct`]:_d(Be,kr.b),...Object.fromEntries(Mr.flatMap(jt=>[[`btl${jt}_mark`,vt[jt]],[`btl${jt}_pct`,_d(vt[jt],Zt[jt])]]))}});mxe(`${e}_${s.toUpperCase()}_sheet.csv`,we)},Qt=async()=>{try{const we=new URLSearchParams;t&&we.set("teaching_assignment_id",String(t)),b&&we.set("question_paper_type",String(b));const dt=`${(Lk==null?void 0:Lk.VITE_API_BASE)||(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in")}/api/obe/cia-export-template/${encodeURIComponent(s)}/${encodeURIComponent(e)}${we.toString()?`?${we.toString()}`:""}`,xt=await yr(dt,{method:"GET"});if(!xt.ok){const Ht=await xt.text();throw new Error(Ht||`Export failed (${xt.status})`)}const Cr=await xt.blob(),nn=window.URL.createObjectURL(Cr),ct=document.createElement("a");ct.href=nn,ct.download=`${e}_${s.toUpperCase()}_template.xlsx`,document.body.appendChild(ct),ct.click(),window.URL.revokeObjectURL(nn),document.body.removeChild(ct)}catch(we){alert((we==null?void 0:we.message)||"Failed to export Excel")}},Yt=async()=>{const we=E.map((dt,xt)=>{const Cr=Tt.rowsByStudentId[String(dt.id)]||{studentId:dt.id,absent:!1,q:Object.fromEntries(v.map(qe=>[qe.key,""]))},nn=ar(Cr);if(!!(Cr.absent&&!nn))return{sno:xt+1,regNo:String(dt.reg_no||""),name:String(dt.name||""),total:"ABSENT"};const Ht=Object.fromEntries(v.map(qe=>{var at;return[qe.key,Sd(Number(((at=Cr.q)==null?void 0:at[qe.key])||0),0,qe.max)]})),Ue=v.reduce((qe,at)=>qe+Number(Ht[at.key]||0),0);return{sno:xt+1,regNo:String(dt.reg_no||""),name:String(dt.name||""),total:Ue}}),Ie=String((m==null?void 0:m.name)||"").trim(),tt=String((m==null?void 0:m.code)||e||"").trim();await hy({filenameBase:`${e}_${o}`,meta:{courseName:Ie,courseCode:tt,className:String((m==null?void 0:m.className)||"")},rows:we})},fr=async we=>{if(!(A||st||Xr)){Br(!0);try{const Ie=await we.arrayBuffer(),tt=N0(Ie,{type:"array"}),dt=tt.Sheets[tt.SheetNames[0]],xt=bs.sheet_to_json(dt,{header:1});if(xt.length<2)throw new Error("Excel file is empty or has no data rows");const Cr=xt[0],nn=Cr.findIndex($t=>String($t||"").toLowerCase().includes("register")),ct=Cr.findIndex($t=>String($t||"").toLowerCase().includes("status"));if(nn===-1)throw new Error('Could not find "Register No" column in Excel file');const Ht=2,Ue=ct!==-1?ct:Cr.length,qe=[];for(let $t=Ht;$t<Ue;$t++){const Rr=String(Cr[$t]||"").trim();if(!Rr)continue;const Ur=Rr.match(/^([QqOo]\d+|[A-Za-z]\d*)/);if(!Ur)continue;const en=Ur[1].toUpperCase();if(b==="QP2"&&en==="Q10"){qe.push({colIdx:$t,qKey:"q9",mode:"sum"});continue}if(b==="QP2"&&en==="Q9"){qe.push({colIdx:$t,qKey:"q9",mode:"set"});continue}const vn=v.find(Nr=>Nr.label.toUpperCase()===en||Nr.key.toUpperCase()===en.toUpperCase());vn&&qe.push({colIdx:$t,qKey:vn.key,mode:"set"})}if(qe.length===0)throw new Error("No matching question columns found in Excel file");const at=new Map;E.forEach($t=>{const Rr=String($t.reg_no||"").trim().toUpperCase();Rr&&at.set(Rr,$t)});let Be=0,vt=0;const jt={...Tt.rowsByStudentId};for(let $t=1;$t<xt.length;$t++){const Rr=xt[$t];if(!Rr||Rr.length===0)continue;const Ur=String(Rr[nn]||"").trim().toUpperCase();if(!Ur)continue;const en=at.get(Ur);if(!en){vt++;continue}const vn=String(en.id),Nr=jt[vn]||{studentId:en.id,absent:!1,absentKind:void 0,reg_no:en.reg_no,q:Object.fromEntries(v.map(ut=>[ut.key,""]))},fn={...Nr.q};let rr=!1;const ve={};for(const{colIdx:ut,qKey:pt,mode:Pr}of qe){const Kr=Rr[ut];if(Kr==null||Kr===""){Pr==="set"&&(fn[pt]="");continue}const pn=Number(Kr);if(!Number.isFinite(pn)){Pr==="set"&&(fn[pt]="");continue}if(Pr==="sum"){ve[pt]=(ve[pt]??0)+pn;continue}const Nn=v.find(kn=>kn.key===pt),_n=(Nn==null?void 0:Nn.max)??bn;fn[pt]=Sd(pn,0,_n),rr=!0}for(const[ut,pt]of Object.entries(ve)){const Pr=Number(fn[ut]===""?0:fn[ut]||0),Kr=v.find(_n=>_n.key===ut),pn=(Kr==null?void 0:Kr.max)??bn,Nn=Sd(Pr+pt,0,pn);fn[ut]=Nn,rr=!0}let rt=Nr.absent;ct!==-1&&(rt=String(Rr[ct]||"").trim().toLowerCase()==="absent"),jt[vn]={...Nr,q:fn,absent:rt},(rr||rt!==Nr.absent)&&Be++}xr($t=>({...$t,rowsByStudentId:jt})),alert(`Import successful!
Imported: ${Be} students
Skipped: ${vt} rows (no matching register number)`)}catch(Ie){alert(`Failed to import Excel: ${(Ie==null?void 0:Ie.message)||"Unknown error"}`),console.error("Import error:",Ie)}finally{Br(!1),Zr.current&&(Zr.current.value="")}}},Dt=we=>{var tt;const Ie=(tt=we.target.files)==null?void 0:tt[0];Ie&&fr(Ie)},ur=()=>{Zr.current&&Zr.current.click()};if(w)return a.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",o," roster"]});const Ve=E.some(we=>{var Ie;return!!((Ie=Tt.rowsByStudentId[String(we.id)])!=null&&Ie.absent)}),zt=Z?E.filter(we=>{var Ie;return Oe&&Oe.length?Oe.includes(we.id):!!((Ie=Tt.rowsByStudentId[String(we.id)])!=null&&Ie.absent)}):E,yt={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},St={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},sr={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11},pr=32;return a.jsxs(ag,{children:[ke?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>_e(null),children:a.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:we=>we.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:ke.title}),a.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:ke.message}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn",onClick:()=>_e(null),children:"Close"})})]})}):null,P&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:P}),d&&a.jsx("div",{style:{background:"#fffbeb",border:"1px solid #f59e0b55",color:"#92400e",padding:10,borderRadius:10,marginBottom:10},children:d}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!Ve,onClick:()=>{if(Z)return;const we=E.filter(Ie=>{var tt;return!!((tt=Tt.rowsByStudentId[String(Ie.id)])!=null&&tt.absent)}).map(Ie=>Ie.id);Ae(we),pe(!0)},title:Ve?"Filter the table to show only absentees":"No absentees marked yet",style:Z?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",Z?a.jsx("span",{onClick:we=>{we.stopPropagation(),pe(!1),Ae(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),a.jsx("button",{onClick:Bt,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Export CSV"}),a.jsx("button",{onClick:Qt,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Export Excel"}),a.jsx("button",{onClick:ur,className:"obe-btn obe-btn-secondary",disabled:Xr||E.length===0||st||Ne,children:Xr?"Importing":"Import Excel"}),a.jsx("input",{ref:Zr,type:"file",accept:".xlsx,.xls",onChange:Dt,style:{display:"none"}})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Yt,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Download"}),a.jsx("button",{onClick:Rt,className:"obe-btn obe-btn-success",disabled:k||E.length===0||st||Ne,children:k?"Saving":"Save Draft"}),a.jsx("button",{onClick:Ze,disabled:Wt?qt:A||E.length===0||!Xe||st||Ne,className:"obe-btn obe-btn-primary",children:Wt?qt?"Request Pending":"Request Edit":A?"Publishing":"Publish"}),z&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",z]}),de&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",de]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:Xe?"#065f46":"#b91c1c"},children:We?"Checking publish due time":Ct||(De!=null&&De.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(De.due_at).toLocaleString(),"  Remaining: ",ng(_t),De.allowed_by_approval&&De.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(De.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Ne?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>nt(),disabled:We,children:"Refresh"})})]}):Xe?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:He,onChange:we=>mt(we.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>nt(),disabled:wt||We,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:ot,disabled:wt,children:wt?"Requesting":"Request Approval"})]}),bt?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:bt}):null]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Term",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:Tt.termLabel})]}),a.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Sheet Label",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:Tt.batchLabel})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Total max: ",bn," | Questions: ",v.length," | COs: ",l.a,"",l.b," | BTLs: 16"]})]})}),E.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):a.jsxs("div",{style:{position:"relative"},children:[a.jsxs(ig,{locked:Ne,children:[a.jsxs("div",{style:{marginBottom:10,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Mark Manager"}),a.jsxs("div",{style:{border:"1px solid #fcd34d",background:ue?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,width:"100%",display:"flex",justifyContent:"space-between",gap:10,alignItems:"center",flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"baseline",flexWrap:"wrap",minWidth:0},children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"BTL configuration"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Set BTL per question in the BTL row, then confirm."})]}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e||Yr,onClick:()=>An({mode:ue?"request":"confirm"}),children:ue?"Edit":"Save"})})]}),Me?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:Me}):null]}),a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:yt,colSpan:4+v.length+1+4+Mr.length*2,children:[Tt.termLabel," | ",Tt.batchLabel," | ",o]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...yt,width:pr,minWidth:pr},rowSpan:3,children:"S.No"}),a.jsx("th",{style:{...yt,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),a.jsx("th",{style:{...yt,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:{...yt,minWidth:88},rowSpan:3,children:"AB"}),a.jsx("th",{style:yt,colSpan:v.length,children:"QUESTIONS"}),a.jsx("th",{style:yt,rowSpan:3,children:"Total"}),a.jsx("th",{style:yt,colSpan:4,children:"CO ATTAINMENT"}),Mr.length?a.jsx("th",{style:yt,colSpan:Mr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[v.map(we=>a.jsx("th",{style:{...yt,width:46,minWidth:46},children:we.label},we.key)),a.jsxs("th",{style:yt,colSpan:2,children:["CO-",l.a]}),a.jsxs("th",{style:yt,colSpan:2,children:["CO-",l.b]}),Mr.map(we=>a.jsxs("th",{style:yt,colSpan:2,children:["BTL-",we]},`btl-head-${we}`))]}),a.jsxs("tr",{children:[v.map(we=>a.jsx("th",{style:{...yt,width:46,minWidth:46},children:we.max},we.key)),Array.from({length:2+Mr.length}).flatMap((we,Ie)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:yt,children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:yt,children:"%"})]},Ie))]})]}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},colSpan:3}),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:"BTL"}),v.map(we=>a.jsx("td",{style:{...St,textAlign:"center"},children:(()=>{const Ie=(Tt.questionBtl||{})[we.key]??"",tt=Ie===""?"-":String(Ie);return a.jsxs("div",{style:{position:"relative",minWidth:44},children:[a.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${tt}`,children:tt}),a.jsxs("select",{"aria-label":`BTL for ${we.label}`,value:Ie,onChange:dt=>At(we.key,dt.target.value===""?"":Number(dt.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(dt=>a.jsx("option",{value:dt,children:dt},dt))]})]})})()},`btl-select-${we.key}`)),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},colSpan:4}),Mr.map(we=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"}})]},`btl-pad-${we}`))]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:"-"}),v.map(we=>a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:we.max},we.key)),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:bn}),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:kr.a}),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:"%"}),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:kr.b}),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:"%"}),Mr.map(we=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:Zt[we]}),a.jsx("td",{style:{...St,fontWeight:700,textAlign:"center"},children:"%"})]},`btl-max-${we}`))]}),zt.map((we,Ie)=>{const tt=Tt.rowsByStudentId[String(we.id)]||{studentId:we.id,reg_no:we.reg_no??"",absent:!1,absentKind:void 0,q:Object.fromEntries(v.map(Be=>[Be.key,""]))},dt=Object.fromEntries(v.map(Be=>{var vt;return[Be.key,Sd(Number(((vt=tt.q)==null?void 0:vt[Be.key])||0),0,Be.max)]})),xt=v.reduce((Be,vt)=>Be+Number(dt[vt.key]||0),0);let Cr=0,nn=0;for(let Be=0;Be<v.length;Be++){const vt=v[Be],jt=zb(v,Be,l),$t=Number(dt[vt.key]||0);Cr+=$t*jt.a,nn+=$t*jt.b}const ct={1:0,2:0,3:0,4:0,5:0,6:0};for(const Be of v){const vt=(Tt.questionBtl||{})[Be.key];(vt===1||vt===2||vt===3||vt===4||vt===5||vt===6)&&(ct[vt]+=Number(dt[Be.key]||0))}const Ht=tt.absent?{background:"#f1f5f9"}:void 0;tt.absent&&String(tt.absentKind||"AL").toUpperCase();const Ue=!!(Z&&tt.absent),qe=!!(A||st||Ne||$e),at=F[we.id];return a.jsxs("tr",{style:Ht,children:[a.jsx("td",{style:{...St,textAlign:"center",width:pr,minWidth:pr,paddingLeft:2,paddingRight:2},children:Ie+1}),a.jsx("td",{style:{...St,minWidth:70,overflow:"visible",textOverflow:"clip"},children:NM(tt.reg_no)}),a.jsx("td",{style:{...St,minWidth:240,overflow:"visible",textOverflow:"clip"},children:we.name}),a.jsx("td",{style:{...St,textAlign:"center",minWidth:88},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:tt.absent,disabled:qe,onChange:Be=>Kt(we.id,Be.target.checked)}),tt.absent?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:String(tt.absentKind||"AL")}),a.jsxs("select",{"aria-label":"Absent type",value:tt.absentKind||"AL",disabled:qe,onChange:Be=>it(we.id,Be.target.value),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),v.map(Be=>{var vt,jt,$t;return a.jsx("td",{style:{...St,textAlign:"center",width:46,minWidth:46},children:a.jsx("input",{style:{...sr,textAlign:"center"},type:"number",min:0,max:Be.max,disabled:qe||tt.absent&&!Ue,value:((vt=tt.q)==null?void 0:vt[Be.key])===""||((jt=tt.q)==null?void 0:jt[Be.key])==null?"":Number((($t=tt.q)==null?void 0:$t[Be.key])||0),onChange:Rr=>{const Ur=Rr.target.value;if(Ur==="")return Rr.currentTarget.setCustomValidity(""),Mt(we.id,Be.key,"");const en=Number(Ur);if(Number.isFinite(en)){if(en>Be.max){Rr.currentTarget.setCustomValidity(`Max mark is ${Be.max}`),Rr.currentTarget.reportValidity(),window.setTimeout(()=>Rr.currentTarget.setCustomValidity(""),0);return}Rr.currentTarget.setCustomValidity(""),Mt(we.id,Be.key,en)}}})},Be.key)}),a.jsx("td",{style:{...St,textAlign:"center",fontWeight:700},title:at!=null?`Server total: ${at}`:void 0,children:xt}),a.jsx("td",{style:{...St,textAlign:"center"},children:Cr}),a.jsx("td",{style:{...St,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:_d(Cr,kr.a)})}),a.jsx("td",{style:{...St,textAlign:"center"},children:nn}),a.jsx("td",{style:{...St,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:_d(nn,kr.b)})}),Mr.map(Be=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...St,textAlign:"center"},children:ct[Be]}),a.jsx("td",{style:{...St,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:_d(ct[Be],Zt[Be])})})]},`btl-row-${we.id}-${Be}`))]},we.id)})]})]})})]}),st&&!Ne?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:te?"rgba(240,253,244,0.55)":"rgba(239,246,255,0.65)",border:`1px solid ${te?"rgba(22,163,74,0.25)":"rgba(59,130,246,0.25)"}`,borderRadius:12,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:te?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:te?"Marks are published. Use View to inspect or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock student entry."}),te&&ae?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:ae}):null]}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:te?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>re(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:async()=>{await dn()},disabled:O||qt,children:qt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>An({mode:"confirm"}),disabled:!e||Yr,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>ir(),disabled:Yr,children:"Request Access"})]})})]})]}):null]}),Vr?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{Yr||An(null)},children:a.jsxs("div",{style:{width:"min(760px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:we=>we.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Vr.mode==="confirm"?`Confirmation - ${o}`:`Request Edit - ${o}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),Vr.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Question"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"BTL"})]})}),a.jsx("tbody",{children:v.map(we=>a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:we.label}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:we.max}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsxs("select",{value:(Tt.questionBtl||{})[we.key]===""?"":String((Tt.questionBtl||{})[we.key]),onChange:Ie=>{const tt=Ie.target.value===""?"":Number(Ie.target.value);At(we.key,tt)},style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e5e7eb",background:"#fff"},disabled:Yr||Ne,children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Ie=>a.jsx("option",{value:String(Ie),children:Ie},Ie))]})})]},we.key))})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:Yr,onClick:()=>An(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Yr||!e,onClick:async()=>{if(e){if(Vr.mode==="request"){An(null),await ir();return}await Gr()}},children:Vr.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,G?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>re(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:we=>we.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsx("button",{onClick:we=>{we.stopPropagation(),re(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),a.jsxs("div",{style:{padding:14},children:[X?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published sheet"}):null,K?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:K}):null]}),R&&(R.rowsByStudentId||R.rows_by_student_id)?a.jsx("div",{ref:q,style:{overflow:"auto",border:"1px solid #e5e7eb",borderRadius:12,maxHeight:"60vh"},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:yt,colSpan:6+Mr.length*2,children:[Tt.termLabel," | ",Tt.batchLabel," | ",o," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...yt,width:pr,minWidth:pr},children:"S.No"}),a.jsx("th",{style:{...yt,minWidth:70,overflow:"visible",textOverflow:"clip"},children:"R.No"}),a.jsx("th",{style:{...yt,minWidth:240,overflow:"visible",textOverflow:"clip"},children:"Name of the Students"}),a.jsx("th",{style:yt,children:"Total"}),a.jsxs("th",{style:yt,colSpan:2,children:["CO-",l.a]}),a.jsxs("th",{style:yt,colSpan:2,children:["CO-",l.b]}),Mr.map(we=>a.jsxs("th",{style:yt,colSpan:2,children:["BTL-",we]},`pv_btl_${we}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:yt}),a.jsx("th",{style:yt}),a.jsx("th",{style:yt}),a.jsx("th",{style:yt}),Array.from({length:2+Mr.length}).flatMap((we,Ie)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:yt,children:"Mark"}),a.jsx("th",{style:yt,children:"%"})]},`pv_hdr_${Ie}`))]})]}),a.jsx("tbody",{children:E.map((we,Ie)=>{var qe;const tt=R.rowsByStudentId||R.rows_by_student_id||{},dt=tt[String(we.id)]||tt[we.id]||{},xt=dt.q||{},Cr=Object.fromEntries(v.map(at=>[at.key,Sd(Number((xt==null?void 0:xt[at.key])||0),0,at.max)])),nn=v.reduce((at,Be)=>at+Number(Cr[Be.key]||0),0);let ct=0,Ht=0;for(let at=0;at<v.length;at++){const Be=v[at],vt=zb(v,at,l),jt=Number(Cr[Be.key]||0);ct+=jt*vt.a,Ht+=jt*vt.b}const Ue={1:0,2:0,3:0,4:0,5:0,6:0};for(const at of v){const Be=(R.questionBtl||R.question_btl||Tt.questionBtl||{})[at.key];if(Be===1||Be===2||Be===3||Be===4||Be===5||Be===6){const vt=Be;Ue[vt]+=Number(Cr[at.key]||0)}}return a.jsxs("tr",{children:[a.jsx("td",{style:{...St,textAlign:"center",width:pr,minWidth:pr,paddingLeft:2,paddingRight:2},children:Ie+1}),a.jsx("td",{style:{...St,minWidth:70,overflow:"visible",textOverflow:"clip"},children:NM(dt.reg_no||((qe=Tt.rowsByStudentId[String(we.id)])==null?void 0:qe.reg_no)||"")}),a.jsx("td",{style:{...St,minWidth:240,overflow:"visible",textOverflow:"clip"},children:we.name}),a.jsx("td",{style:{...St,textAlign:"center",fontWeight:900},children:nn}),a.jsx("td",{style:{...St,textAlign:"center"},children:Math.round(ct)}),a.jsx("td",{style:{...St,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:_d(ct,kr.a)})}),a.jsx("td",{style:{...St,textAlign:"center"},children:Math.round(Ht)}),a.jsx("td",{style:{...St,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:_d(Ht,kr.b)})}),Mr.map(at=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...St,textAlign:"center"},children:Math.round(Ue[at])}),a.jsx("td",{style:{...St,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:_d(Ue[at],Zt[at])})})]},`pv_btl_${we.id}_${at}`))]},`pv_${we.id}`)})})]})}):X?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published sheet found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>re(!1),children:"Close"})})]})})}):null,Y?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{O||Q(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:we=>we.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[o,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",ht?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:ie,onChange:we=>le(we.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:O,onClick:()=>Q(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:O||qt||!e||!String(ie||"").trim(),onClick:Fr,children:O?"Requesting":qt?"Request Pending":"Send Request"})]})]})})}):null]})}function NM(e){return e.slice(-8)}function gxe(e){return a.jsx(qz,{...e,assessmentKey:"cia2"})}const xxe=5,yxe=20,bxe=10;function Dn(e,t,r){return Math.max(t,Math.min(r,e))}function yc(e){return Math.round(e*10)/10}function us(e){if(e===""||e==null)return"";const t=Number(e);return Number.isFinite(t)?t:""}function qb(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function Aa(e,t){if(!t)return"-";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function vxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function wxe(e,t){return`${e}_sheet_${t}`}function Sxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function bp(e){return e.slice(-8)}function Hz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:n=!1}){var At,Mt,ar;const i=r||"formative1",s=i==="formative2"?"Formative 2":"Formative 1",o=i==="formative2"?3:1,l=i==="formative2"?4:2,[c,u]=x.useState(!1),[d,f]=x.useState(null),[h,p]=x.useState([]),[m,g]=x.useState(null),[y,b]=x.useState({skill1:3,skill2:4,att1:3,att2:4}),[v,w]=x.useState(!1),[S,k]=x.useState(!1),[j,A]=x.useState(null),[L,P]=x.useState(null),[B,E]=x.useState(!1),T=x.useRef(null),[F,W]=x.useState(!1),{data:z,loading:se,error:de,remainingSeconds:U,publishAllowed:G,refresh:re}=H0({assessment:i,subjectCode:String(e||""),teachingAssignmentId:t}),X=!!(z!=null&&z.global_override_active&&(z==null?void 0:z.global_is_open)===!1),[C,K]=x.useState(""),[V,R]=x.useState(!1),[J,q]=x.useState(null),[Y,Q]=x.useState(null),[ie,le]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e||"",rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),{data:O,refresh:H}=V0({assessment:i,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ae,refresh:I}=nc({assessment:i,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:Z,refresh:pe}=nc({assessment:i,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[Oe,Ae]=x.useState(null),ke=!!L||!!(O!=null&&O.exists&&(O!=null&&O.is_published)),_e=n?!0:!!ie.markManagerLocked,De=Z!=null&&Z.approval_until?String(Z.approval_until):null,We=ae!=null&&ae.approval_until?String(ae.approval_until):null,Ct=!!(Z!=null&&Z.allowed_by_approval)&&!!De&&De!==((Oe==null?void 0:Oe.markEntryApprovalUntil)??null),_t=!!(ae!=null&&ae.allowed_by_approval)&&!!We&&We!==((Oe==null?void 0:Oe.markManagerApprovalUntil)??null),Xe=ke?!!(O!=null&&O.entry_open)||Ct||_t:!0,nt=!!(ke&&!Xe),Ne=!!(ke&&nt),be=!!(ke&&nt),fe=n?!!(X||ke&&!Xe):!!(X||(ke?!Xe:!_e)),ge=n?!0:ie.markManagerSnapshot!=null||!!ke,[lt,He]=x.useState(null),[mt,wt]=x.useState(!1),Pt=ke,[bt,qr]=x.useState(!1),[Tt,xr]=x.useState(null),[Zr,Xr]=x.useState(!1),[Br,Vr]=x.useState(null),[An,Yr]=x.useState(!1),[Ln,Me]=x.useState(""),[Ce,It]=x.useState(!1),{pending:ft,pendingUntilMs:Ot,setPendingUntilMs:er,refresh:hr}=G0({enabled:!!be&&!!e,assessment:i,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!An||!!bt||!!lt);const Tr=String((Y==null?void 0:Y.termLabel)||"KRCT AY25-26"),ne=((At=Y==null?void 0:Y.assessments)==null?void 0:At[i])??((Mt=Y==null?void 0:Y.assessments)==null?void 0:Mt.formative1)??{},ce=Number.isFinite(Number(ne==null?void 0:ne.maxPart))?Number(ne.maxPart):xxe,te=Number.isFinite(Number(ne==null?void 0:ne.maxTotal))?Number(ne.maxTotal):yxe,ue=Number.isFinite(Number(ne==null?void 0:ne.maxCo))?Number(ne.maxCo):bxe,Ee=x.useMemo(()=>{const Ge=ie.markManagerSnapshot;if(!Ge)return null;try{const Rt=JSON.parse(String(Ge)),Ze=Rt==null?void 0:Rt.partBtl;if(!Ze||typeof Ze!="object")return null;const ot={};for(const Bt of["skill1","skill2","att1","att2"]){const Qt=Ze[Bt];ot[Bt]=Qt===""||Qt==null?"":Number(Qt),ot[Bt]===""||Number.isFinite(ot[Bt])&&ot[Bt]>=1&&ot[Bt]<=6||(ot[Bt]="")}return ot}catch{return null}},[ie.markManagerSnapshot]);x.useEffect(()=>{Ae(null)},[e]);const je=Ee||y,gt=async Ge=>{if(e){Ge||(Vr(null),Xr(!0));try{const Rt=await b0(i,e),Ze=Rt&&Rt.marks&&typeof Rt.marks=="object"?Rt.marks:null;Ze&&Object.keys(Ze).length?xr(Ze):xr(null)}catch(Rt){Ge||Vr((Rt==null?void 0:Rt.message)||"Failed to load published marks")}finally{Ge||Xr(!1)}}};x.useEffect(()=>{bt&&(xr(null),gt(!1))},[bt,e,i]);const Qe=x.useRef(!!Xe);x.useEffect(()=>{if(!e||!ke)return;if(Qe.current||!Xe){Qe.current=!!Xe;return}let Rt=!0;return(async()=>{try{const Ze=await ei(i,String(e));if(!Rt)return;const ot=Ze==null?void 0:Ze.draft,Bt=ot==null?void 0:ot.sheet,Qt=ot==null?void 0:ot.partBtl;if(Bt&&typeof Bt=="object"&&typeof Bt.rowsByStudentId=="object"&&le(Yt=>({...Yt,termLabel:String(Bt.termLabel||Tr||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:Bt.rowsByStudentId||{},markManagerLocked:typeof Bt.markManagerLocked=="boolean"?Bt.markManagerLocked:!!(Bt.markManagerSnapshot??Yt.markManagerSnapshot),markManagerSnapshot:Bt.markManagerSnapshot??Yt.markManagerSnapshot??null,markManagerApprovalUntil:Bt.markManagerApprovalUntil??Yt.markManagerApprovalUntil??null})),Qt&&typeof Qt=="object"){const Yt={};for(const fr of["skill1","skill2","att1","att2"]){const Dt=Qt[fr];Yt[fr]=Dt===""||Dt==null?"":Number(Dt),Yt[fr]===""||Number.isFinite(Yt[fr])&&Yt[fr]>=1&&Yt[fr]<=6||(Yt[fr]="")}b(Yt)}}catch{}})(),Qe.current=!!Xe,()=>{Rt=!1}},[Xe,ke,e,i,Tr]),x.useEffect(()=>{if(!e||!ke||Xe)return;const Ge=window.setInterval(()=>{H({silent:!0});try{pe==null||pe({silent:!0}),I==null||I({silent:!0})}catch{}},3e4);return()=>window.clearInterval(Ge)},[Xe,ke,e,H,pe,I]);async function Fe(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(ft){alert("Edit request is pending. Please wait for approval.");return}const Rt=String(Ln||"").trim();if(!Rt){alert("Reason is required.");return}It(!0);const Ze=new Date,ot=Z!=null&&Z.approval_until?String(Z.approval_until):null;try{const Bt=await nl({assessment:i,subject_code:String(e),scope:"MARK_ENTRY",reason:Rt,teaching_assignment_id:t});alert(il(Bt)),Yr(!1),Me(""),er(Date.now()+24*60*60*1e3);try{hr({silent:!0})}catch{}const Qt=Number(Bt==null?void 0:Bt.id),fr=Ze.getTime()-2e3;(async()=>{if(!e)return;const Dt=36,ur=5e3;for(let Ve=0;Ve<Dt;Ve++){try{const zt=await Lm({assessment:i,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),yt=zt==null?void 0:zt.result;if(!(yt&&Number.isFinite(Qt)&&yt.id!==Qt)){if((yt==null?void 0:yt.status)==="APPROVED"&&(yt!=null&&yt.is_active)){const St=yt.reviewed_at?new Date(yt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(St)||St<fr)){try{pe==null||pe({silent:!0}),H({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}else if((yt==null?void 0:yt.status)==="REJECTED"){const St=yt.reviewed_at?new Date(yt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(St)||St<fr)){alert("IQAC rejected the edit request.");return}}}}catch{try{const yt=await l1(i,String(e),"MARK_ENTRY",t),St=yt!=null&&yt.approval_until?String(yt.approval_until):null;if(yt!=null&&yt.allowed_by_approval&&St&&St!==ot){try{pe==null||pe({silent:!0}),H({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(zt=>setTimeout(zt,ur))}alert("Edit request still pending. Please try again later.")})()}catch(Bt){const Qt=al(Bt,"Request failed");alert(`Edit request failed: ${Qt}`)}finally{It(!1)}}x.useEffect(()=>{let Ge=!0;return(async()=>{try{const Rt=await vu();if(!Ge)return;Q(Rt||null),le(Ze=>({...Ze,termLabel:String((Rt==null?void 0:Rt.termLabel)||Ze.termLabel||"KRCT AY25-26"),batchLabel:e||Ze.batchLabel}))}catch{}})(),()=>{Ge=!1}},[e]);const $e=x.useMemo(()=>e?wxe(i,e):"",[i,e]),st=x.useMemo(()=>[{key:"skill1",label:"Skill 1",max:ce},{key:"skill2",label:"Skill 2",max:ce},{key:"att1",label:"Attitude 1",max:ce},{key:"att2",label:"Attitude 2",max:ce}],[ce]);(ar=st[st.length-1])==null||ar.key;const Wt=x.useMemo(()=>{const Ge=new Set;for(const Rt of Object.keys(y)){const Ze=y[Rt];(Ze===1||Ze===2||Ze===3||Ze===4||Ze===5||Ze===6)&&Ge.add(Ze)}return[1,2,3,4,5,6].filter(Rt=>Ge.has(Rt))},[y]),qt=x.useMemo(()=>12+Wt.length*2,[Wt.length]);x.useEffect(()=>{if(e){const Ge=`${i}_part_btl_${e}`,Rt=Jn(Ge);if(Rt&&typeof Rt=="object")try{const Ze={};for(const ot of Object.keys(y)){const Bt=Rt[ot];Ze[ot]=Bt===""||Bt==null?"":Number(Bt),Ze[ot]===""||Number.isFinite(Ze[ot])&&Ze[ot]>=1&&Ze[ot]<=6||(Ze[ot]="")}b(Ze)}catch{}}},[e,i]),x.useEffect(()=>{if(!e)return;const Ge=`${i}_part_btl_${e}`;try{Gn(Ge,y)}catch{}},[y,e,i]);const ht=Ge=>JSON.stringify({assessmentKey:i,partBtl:Ge,maxPart:ce,maxTotal:te});async function Ut(){if(e){wt(!0);try{const Ge=ht(y),Rt=ae!=null&&ae.approval_until?String(ae.approval_until):ie.markManagerApprovalUntil||null,Ze={...ie,markManagerLocked:!0,markManagerSnapshot:Ge,markManagerApprovalUntil:Rt},ot={sheet:Ze,partBtl:y,markManagerLocked:Ze.markManagerLocked,markManagerSnapshot:Ze.markManagerSnapshot,markManagerApprovalUntil:Ze.markManagerApprovalUntil};le(Ze),He(null),await Mi(i,String(e),ot),A(new Date().toLocaleString());try{await uh(i,String(e),t),H({silent:!0})}catch{}}catch{}finally{wt(!1)}}}async function Gt(){if(!e)return;wt(!0);const Ge=new Date,Rt=ae!=null&&ae.approval_until?String(ae.approval_until):null;try{const Ze=await nl({assessment:i,subject_code:String(e),scope:"MARK_MANAGER",reason:`Request mark-manager edit for ${e}`,teaching_assignment_id:t});alert(il(Ze));const ot=Number(Ze==null?void 0:Ze.id),Qt=Ge.getTime()-2e3;(async()=>{if(!e)return;const Yt=36,fr=5e3;for(let Dt=0;Dt<Yt;Dt++){try{const ur=await Lm({assessment:i,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),Ve=ur==null?void 0:ur.result;if(!(Ve&&Number.isFinite(ot)&&Ve.id!==ot)){if((Ve==null?void 0:Ve.status)==="APPROVED"&&(Ve!=null&&Ve.is_active)){const zt=Ve.reviewed_at?new Date(Ve.reviewed_at).getTime():NaN;if(!(!Number.isFinite(zt)||zt<Qt)){try{I==null||I({silent:!0}),H({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}else if((Ve==null?void 0:Ve.status)==="REJECTED"){const zt=Ve.reviewed_at?new Date(Ve.reviewed_at).getTime():NaN;if(!(!Number.isFinite(zt)||zt<Qt)){alert("IQAC rejected the mark-manager edit request.");return}}}}catch{try{const Ve=await l1(i,String(e),"MARK_MANAGER",t),zt=Ve!=null&&Ve.approval_until?String(Ve.approval_until):null;if(Ve!=null&&Ve.allowed_by_approval&&zt&&zt!==Rt){try{I==null||I({silent:!0}),H({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(ur=>setTimeout(ur,fr))}alert("Edit request still pending. Please try again later.")})()}catch(Ze){const ot=al(Ze,"Request failed");alert(`Edit request failed: ${ot}`)}finally{wt(!1)}}x.useEffect(()=>{if(!e)return;let Ge=!1;const Rt=setTimeout(async()=>{try{await Mi(i,e,{sheet:ie,partBtl:y});try{$e&&Gn($e,{termLabel:ie.termLabel,batchLabel:ie.batchLabel,rowsByStudentId:ie.rowsByStudentId})}catch{}Ge||A(new Date().toLocaleString())}catch{}},700);return()=>{Ge=!0,clearTimeout(Rt)}},[y,e,i,ie,$e]),x.useEffect(()=>{let Ge=!0;return(async()=>{if(e)try{const Rt=await ei(i,e);if(!Ge)return;const Ze=Rt==null?void 0:Rt.draft,ot=Ze==null?void 0:Ze.sheet,Bt=Ze==null?void 0:Ze.partBtl,Qt=Ze==null?void 0:Ze.selectedBtls;if(ot&&typeof ot=="object"&&typeof ot.rowsByStudentId=="object"){le({termLabel:String(ot.termLabel||Tr||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:ot.rowsByStudentId||{},markManagerLocked:typeof ot.markManagerLocked=="boolean"?ot.markManagerLocked:!!ot.markManagerSnapshot,markManagerSnapshot:ot.markManagerSnapshot??null,markManagerApprovalUntil:ot.markManagerApprovalUntil??null});try{$e&&Gn($e,{termLabel:String(ot.termLabel||Tr||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:ot.rowsByStudentId||{}})}catch{}}if(Bt&&typeof Bt=="object"){const Yt={};for(const fr of Object.keys(y)){const Dt=Bt[fr];Yt[fr]=Dt===""||Dt==null?"":Number(Dt),Yt[fr]===""||Number.isFinite(Yt[fr])&&Yt[fr]>=1&&Yt[fr]<=6||(Yt[fr]="")}b(Yt);try{const fr=`${i}_part_btl_${e}`;Gn(fr,Yt)}catch{}}else if(Array.isArray(Qt)){const Yt=Dt=>Number.isFinite(Dt)&&Dt>=1&&Dt<=6,fr=Qt.map(Dt=>Number(Dt)).filter(Yt);if(fr.length===1){const Dt={skill1:fr[0],skill2:fr[0],att1:fr[0],att2:fr[0]};b(Dt);try{const ur=`${i}_part_btl_${e}`;Gn(ur,Dt)}catch{}}else if(fr.length>=2){const Dt={skill1:fr[0],skill2:fr[1],att1:fr[0],att2:fr[1]};b(Dt);try{const ur=`${i}_part_btl_${e}`;Gn(ur,Dt)}catch{}}}}catch{}})(),()=>{Ge=!1}},[e,Tr,i,$e]),x.useEffect(()=>{let Ge=!0;return(async()=>{if(e){u(!0),f(null);try{let Ze=[],ot=null;try{const Dt=await lc();console.log("[Formative] My TAs:",Dt==null?void 0:Dt.length,"for subject:",e,"teachingAssignmentId:",t),ot=(Dt||[]).find(ur=>{const Ve=String(ur.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?ur.id===t:!1)||Ve}),ot?console.log("[Formative] Found TA match:",ot.id,"elective_subject_id:",ot.elective_subject_id,"section_id:",ot.section_id):console.log("[Formative] No TA match found in user TAs")}catch(Dt){console.warn("[Formative] My TAs fetch failed:",Dt)}if(ot&&ot.elective_subject_id&&!ot.section_id){console.log("[Formative] Detected elective, fetching elective-choices for elective_subject_id:",ot.elective_subject_id);try{const Dt=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(ot.elective_subject_id))}`);if(Dt.ok){const ur=await Dt.json(),Ve=Array.isArray(ur.results)?ur.results:Array.isArray(ur)?ur:ur.items||[];console.log("[Formative] Elective choices returned:",Ve==null?void 0:Ve.length,"students"),Ze=(Ve||[]).map(zt=>({id:Number(zt.student_id??zt.id),reg_no:String(zt.reg_no??zt.regno??""),name:String(zt.name??zt.full_name??zt.username??""),section:zt.section_name??zt.section??null})).filter(zt=>Number.isFinite(zt.id)),Ge&&g({subject_name:ot.subject_name,section:ot.section_name||"Elective"})}else console.warn("[Formative] Elective-choices API returned error:",Dt.status)}catch(Dt){console.warn("[Formative] Elective-choices fetch failed:",Dt)}}if(!Ze.length&&ot&&ot.id){console.log("[Formative] Fetching regular TA roster for TA ID:",ot.id);try{Ze=((await qc(ot.id)).students||[]).map(ur=>({id:Number(ur.id),reg_no:String(ur.reg_no??""),name:String(ur.name??""),section:ur.section??null})).filter(ur=>Number.isFinite(ur.id)),console.log("[Formative] Regular roster returned:",Ze.length,"students"),Ge&&g({subject_name:ot.subject_name,section:ot.section_name})}catch(Dt){console.warn("[Formative] TA roster fetch failed:",Dt)}}console.log("[Formative] Final roster count:",Ze.length),Ze.sort(vxe),Ge&&p(Ze);let Bt=null;try{const Dt=await b0(i,e);Dt&&Dt.marks&&typeof Dt.marks=="object"&&Object.keys(Dt.marks||{}).length&&(Bt=Dt.marks,P(new Date().toLocaleString()))}catch{}const Qt=$e?Jn($e):null,Yt=Bt?{termLabel:Y!=null&&Y.termLabel?String(Y.termLabel):Tr||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:Object.fromEntries(Object.entries(Bt).map(([Dt,ur])=>[Dt,{studentId:Number(Dt),skill1:us(ur==null?void 0:ur.skill1),skill2:us(ur==null?void 0:ur.skill2),att1:us(ur==null?void 0:ur.att1),att2:us(ur==null?void 0:ur.att2)}]))}:Qt&&typeof Qt=="object"?{termLabel:Y!=null&&Y.termLabel?String(Y.termLabel):String(Qt.termLabel||"KRCT AY25-26"),batchLabel:String(e||Qt.batchLabel||""),rowsByStudentId:Qt.rowsByStudentId&&typeof Qt.rowsByStudentId=="object"?Qt.rowsByStudentId:{}}:{termLabel:Tr||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:{}},fr={...Yt.rowsByStudentId};for(const Dt of Ze){const ur=String(Dt.id),Ve=fr[ur];fr[ur]={studentId:Dt.id,skill1:typeof(Ve==null?void 0:Ve.skill1)=="number"?Dn(Number(Ve==null?void 0:Ve.skill1),0,ce):"",skill2:typeof(Ve==null?void 0:Ve.skill2)=="number"?Dn(Number(Ve==null?void 0:Ve.skill2),0,ce):"",att1:typeof(Ve==null?void 0:Ve.att1)=="number"?Dn(Number(Ve==null?void 0:Ve.att1),0,ce):"",att2:typeof(Ve==null?void 0:Ve.att2)=="number"?Dn(Number(Ve==null?void 0:Ve.att2),0,ce):""}}le({...Yt,termLabel:Yt.termLabel||Tr,batchLabel:String(e||Yt.batchLabel||""),rowsByStudentId:fr})}catch(Ze){if(!Ge)return;f((Ze==null?void 0:Ze.message)||`Failed to load ${s} roster`),p([])}finally{Ge&&u(!1)}}})(),()=>{Ge=!1}},[e,$e,Y,Tr,ce,s]);const cr=(Ge,Rt)=>{fe||nt||le(Ze=>{const ot=String(Ge),Qt={...Ze.rowsByStudentId[ot]||{studentId:Ge,skill1:"",skill2:"",att1:"",att2:""},...Rt,studentId:Ge},Yt=fr=>{if(fr===""||fr==null)return"";const Dt=Number(fr),ur=Number.isFinite(Dt)?Math.round(Dt):NaN,Ve=Dn(ur,0,ce);return Number.isFinite(Ve)?Ve:""};return{...Ze,rowsByStudentId:{...Ze.rowsByStudentId,[ot]:{...Qt,skill1:Yt(Qt.skill1),skill2:Yt(Qt.skill2),att1:Yt(Qt.att1),att2:Yt(Qt.att2)}}}})},ir=async()=>{if(e){w(!0),f(null);try{await Mi(i,e,{sheet:ie,partBtl:y}),A(new Date().toLocaleString())}catch(Ge){f((Ge==null?void 0:Ge.message)||`Failed to save ${s} draft`)}finally{w(!1)}}},Fr=x.useRef(ie);Fr.current=ie;const dn=x.useRef(y);dn.current=y,x.useEffect(()=>{const Ge=()=>{if(!e||h.length===0)return;const Rt={sheet:Fr.current,partBtl:dn.current};Mi(i,e,Rt).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Ge),()=>window.removeEventListener("obe:before-tab-switch",Ge)},[e,i,h.length]);const vr=async()=>{if(!e)return;if(X){f("Publishing is locked by IQAC.");return}if(!G){f("Publish window is closed. Please request IQAC approval.");return}if(ke&&nt){if(ft){f("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Yr(!0);return}k(!0),f(null);const Ge=L,Rt=ie.markManagerLocked,Ze=Oe,ot={markEntryApprovalUntil:De,markManagerApprovalUntil:We};try{P(new Date().toLocaleString()),Ae(ot),le(Bt=>({...Bt,markManagerLocked:!0})),await M9(i,e,ie,t),re(),H({silent:!0}),gt(!0);try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:i}}))}catch{}}catch(Bt){const Qt=String((Bt==null?void 0:Bt.message)||"");Qt.includes("locked after publish")||Qt.includes("Marks entry is locked")?(P(new Date().toLocaleString()),Ae(ot),le(Yt=>({...Yt,markManagerLocked:!0})),f(null)):(P(Ge??null),le(Yt=>({...Yt,markManagerLocked:Rt})),Ae(Ze??null),f(Qt||`Failed to publish ${s}`))}finally{try{if(e){const Bt=await vS(i,String(e),t);Bt!=null&&Bt.exists&&(Bt!=null&&Bt.is_published)&&(P(new Date().toLocaleString()),le(Qt=>({...Qt,markManagerLocked:!0})),Ae(Qt=>Qt??ot),gt(!0),H({silent:!0}),re(),f(null))}}catch{}k(!1)}},Lt=()=>{if(!e)return;const Ge=h.map((Rt,Ze)=>{const ot=ie.rowsByStudentId[String(Rt.id)]||{studentId:Rt.id,skill1:"",skill2:"",att1:"",att2:""},Bt=typeof ot.skill1=="number"?Dn(Number(ot.skill1),0,ce):null,Qt=typeof ot.skill2=="number"?Dn(Number(ot.skill2),0,ce):null,Yt=typeof ot.att1=="number"?Dn(Number(ot.att1),0,ce):null,fr=typeof ot.att2=="number"?Dn(Number(ot.att2),0,ce):null,Dt=Bt!=null&&Qt!=null&&Yt!=null&&fr!=null?Dn(Bt+Qt+Yt+fr,0,te):"",ur=Bt!=null&&Yt!=null?Dn(Bt+Yt,0,ue):"",Ve=Qt!=null&&fr!=null?Dn(Qt+fr,0,ue):"",zt=[0,0,0,0,0,0];for(const pr of st){const we=y[pr.key];(we===1||we===2||we===3||we===4||we===5||we===6)&&(zt[we-1]+=pr.max)}const yt=Wt.map(pr=>pr-1),St=typeof Dt=="number"&&yt.length?yc(Dt/yt.length):"",sr=zt.map((pr,we)=>St===""||!yt.includes(we)?"":pr>0?Dn(St,0,pr):yc(St));return{sno:Ze+1,registerNo:Rt.reg_no,name:Rt.name,skill1:Bt??"",skill2:Qt??"",att1:Yt??"",att2:fr??"",total:Dt===""?"":Dt,[`co${o}_mark`]:ur===""?"":ur,[`co${o}_pct`]:ur===""?"":Aa(ur,ue),[`co${l}_mark`]:Ve===""?"":Ve,[`co${l}_pct`]:Ve===""?"":Aa(Ve,ue),btl1_mark:sr[0]??"",btl1_pct:sr[0]===""?"":Aa(Number(sr[0]),zt[0]),btl2_mark:sr[1]??"",btl2_pct:sr[1]===""?"":Aa(Number(sr[1]),zt[1]),btl3_mark:sr[2]??"",btl3_pct:sr[2]===""?"":Aa(Number(sr[2]),zt[2]),btl4_mark:sr[3]??"",btl4_pct:sr[3]===""?"":Aa(Number(sr[3]),zt[3]),btl5_mark:sr[4]??"",btl5_pct:sr[4]===""?"":Aa(Number(sr[4]),zt[4]),btl6_mark:sr[5]??"",btl6_pct:sr[5]===""?"":Aa(Number(sr[5]),zt[5])}});Sxe(`${e}_${i.toUpperCase()}_sheet.csv`,Ge)},Gr=async()=>{if(!e)return;const Ge=h.map((Rt,Ze)=>{const ot=ie.rowsByStudentId[String(Rt.id)]||{studentId:Rt.id,skill1:"",skill2:"",att1:"",att2:""},Bt=typeof ot.skill1=="number"?Dn(Number(ot.skill1),0,ce):null,Qt=typeof ot.skill2=="number"?Dn(Number(ot.skill2),0,ce):null,Yt=typeof ot.att1=="number"?Dn(Number(ot.att1),0,ce):null,fr=typeof ot.att2=="number"?Dn(Number(ot.att2),0,ce):null,Dt=Bt!=null&&Qt!=null&&Yt!=null&&fr!=null?Dn(Bt+Qt+Yt+fr,0,te):"";return{sno:Ze+1,regNo:String(Rt.reg_no||""),name:String(Rt.name||""),total:Dt===""?"":Dt}});await hy({filenameBase:`${e}_${s}`,meta:{courseName:String((m==null?void 0:m.subject_name)||""),courseCode:String(e||""),className:String((m==null?void 0:m.section)||"")},rows:Ge})};function bn(Ge){return String(Ge??"").trim().toLowerCase().replace(/\s+/g," ")}const or=()=>{if(!e||!h.length)return;const Ge=Qt=>`${Qt} (${Number(ce).toFixed(2)})`,Rt=["Register No","Student Name",Ge("Skill 1"),Ge("Skill 2"),Ge("Attitude 1"),Ge("Attitude 2"),"Status"],Ze=h.map(Qt=>{const Yt=ie.rowsByStudentId[String(Qt.id)];return[Qt.reg_no,Qt.name,(Yt==null?void 0:Yt.skill1)??"",(Yt==null?void 0:Yt.skill2)??"",(Yt==null?void 0:Yt.att1)??"",(Yt==null?void 0:Yt.att2)??"","present"]}),ot=bs.aoa_to_sheet([Rt,...Ze]);ot["!freeze"]={xSplit:0,ySplit:1};const Bt=bs.book_new();bs.book_append_sheet(Bt,ot,s),dy(Bt,`${e}_${i.toUpperCase()}_template.xlsx`)},kr=()=>{var Ge;fe||nt||(Ge=T.current)==null||Ge.click()},Mr=async Ge=>{var Rt;if(e&&!(fe||nt)){W(!0);try{const Ze=await Ge.arrayBuffer(),ot=N0(Ze,{type:"array"}),Bt=(Rt=ot.SheetNames)==null?void 0:Rt[0];if(!Bt)throw new Error("No sheet found in the Excel file.");const Qt=ot.Sheets[Bt],Yt=bs.sheet_to_json(Qt,{header:1});if(!Yt.length)throw new Error("Excel sheet is empty.");const fr=(Yt[0]||[]).map(bn),Dt=Ie=>fr.findIndex(tt=>Ie(tt)),ur=Dt(Ie=>Ie==="register no"||Ie==="reg no"||Ie.includes("register")),Ve=Dt(Ie=>Ie.startsWith("skill 1")||Ie.startsWith("skill1")),zt=Dt(Ie=>Ie.startsWith("skill 2")||Ie.startsWith("skill2")),yt=Dt(Ie=>Ie.startsWith("attitude 1")||Ie.startsWith("att1")||Ie.startsWith("attitude1")),St=Dt(Ie=>Ie.startsWith("attitude 2")||Ie.startsWith("att2")||Ie.startsWith("attitude2")),sr=Dt(Ie=>Ie==="status"||Ie.includes("status"));if(ur<0)throw new Error("Could not find Register No column.");const pr=new Map;for(const Ie of h){const tt=String(Ie.reg_no||"").trim();tt&&pr.set(tt,Ie.id);const dt=bp(tt);dt&&pr.set(dt,Ie.id)}const we=Ie=>Ie==null||!Number.isFinite(Ie)||Ie<=0?"":Dn(Number(Ie),1,ce);le(Ie=>{const tt={...Ie.rowsByStudentId};for(let dt=1;dt<Yt.length;dt++){const xt=Yt[dt]||[],Cr=String(xt[ur]??"").trim();if(!Cr)continue;const nn=pr.get(Cr);if(!nn)continue;const Ht=(sr>=0?String(xt[sr]??""):"").trim().toLowerCase(),Ue=Ht==="absent"||Ht==="ab"||Ht==="a",qe=tt[String(nn)]||{studentId:nn,skill1:"",skill2:"",att1:"",att2:""};if(Ue){tt[String(nn)]={...qe,skill1:"",skill2:"",att1:"",att2:""};continue}const at=Ve>=0?we(qb(xt[Ve])):qe.skill1,Be=zt>=0?we(qb(xt[zt])):qe.skill2,vt=yt>=0?we(qb(xt[yt])):qe.att1,jt=St>=0?we(qb(xt[St])):qe.att2;tt[String(nn)]={...qe,studentId:nn,skill1:at,skill2:Be,att1:vt,att2:jt}}return{...Ie,rowsByStudentId:tt}})}finally{W(!1)}}},Ar=async Ge=>{var Ze;const Rt=(Ze=Ge.target.files)==null?void 0:Ze[0];if(Ge.target.value="",!!Rt)try{await Mr(Rt)}catch(ot){f((ot==null?void 0:ot.message)||"Failed to import Excel")}};if(!e)return a.jsxs("div",{style:{color:"#6b7280"},children:["Select a course to start ",s," entry."]});if(c)return a.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",s," roster"]});const Zt={border:"1px solid #111",padding:"6px 6px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:12,whiteSpace:"nowrap"},Kt={border:"1px solid #111",padding:"6px 6px",fontSize:12,whiteSpace:"nowrap"},it={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:12,textAlign:"center"};return a.jsxs(ag,{children:[d&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:d}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:Lt,className:"obe-btn obe-btn-secondary",disabled:h.length===0,children:"Export CSV"}),a.jsx("button",{onClick:or,className:"obe-btn obe-btn-secondary",disabled:h.length===0,children:"Export Excel"}),a.jsx("button",{onClick:kr,className:"obe-btn obe-btn-secondary",disabled:h.length===0||fe||nt||F,children:F?"Importing":"Import Excel"}),a.jsx("input",{ref:T,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:Ar})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Gr,className:"obe-btn obe-btn-secondary",disabled:h.length===0,children:"Download"}),a.jsx("button",{onClick:ir,className:"obe-btn obe-btn-success",disabled:v||h.length===0,children:v?"Saving":"Save Draft"}),a.jsx("button",{onClick:vr,disabled:be?ft:S||h.length===0||!G||X,className:"obe-btn obe-btn-primary",children:be?ft?"Request Pending":"Request Edit":S?"Publishing":"Publish"}),j&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Draft: ",j]}),L&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",L]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:G?"#065f46":"#b91c1c"},children:se?"Checking publish due time":de||(z!=null&&z.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(z.due_at).toLocaleString(),"  Remaining: ",ng(U),z.allowed_by_approval&&z.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(z.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),X?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>re(),disabled:se,children:"Refresh"})})]}):null,a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Term",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:ie.termLabel})]}),a.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Sheet Label",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:ie.batchLabel})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Skill/Attitude max: ",ce," each | Total: ",te," | CO-",o,": ",ue," | CO-",l,": ",ue]})]})}),h.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):a.jsx(ig,{locked:X,children:ge?B&&ke?a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),a.jsx("button",{className:"obe-btn",onClick:()=>E(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),Zr?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,Br?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:Br}):null,Tt&&Object.keys(Tt).length||h.length?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Zt,colSpan:qt,children:[ie.termLabel," | ",ie.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Zt,width:42,minWidth:42},children:"S.No"}),a.jsx("th",{style:Zt,children:"Register No."}),a.jsx("th",{style:Zt,children:"Name of the Students"}),a.jsx("th",{style:Zt,children:"Skill 1"}),a.jsx("th",{style:Zt,children:"Skill 2"}),a.jsx("th",{style:Zt,children:"Att 1"}),a.jsx("th",{style:Zt,children:"Att 2"}),a.jsx("th",{style:Zt,children:"Total"}),a.jsxs("th",{style:Zt,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Zt,colSpan:2,children:["CO-",l]}),Wt.map(Ge=>a.jsxs("th",{style:Zt,colSpan:2,children:["BTL-",Ge]},`pv_btl_${Ge}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt,children:"Mark"}),a.jsx("th",{style:Zt,children:"%"}),a.jsx("th",{style:Zt,children:"Mark"}),a.jsx("th",{style:Zt,children:"%"}),Wt.map(Ge=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:Zt,children:"Mark"}),a.jsx("th",{style:Zt,children:"%"})]},`pv_btl_sub_${Ge}`))]})]}),a.jsx("tbody",{children:h.length?h.map((Ge,Rt)=>{const Ze=Tt&&Tt[String(Ge.id)]||{},ot=typeof Ze.skill1=="number"?Dn(Number(Ze.skill1),1,ce):us(Ze.skill1),Bt=typeof Ze.skill2=="number"?Dn(Number(Ze.skill2),1,ce):us(Ze.skill2),Qt=typeof Ze.att1=="number"?Dn(Number(Ze.att1),1,ce):us(Ze.att1),Yt=typeof Ze.att2=="number"?Dn(Number(Ze.att2),1,ce):us(Ze.att2),fr=ot!==""&&Bt!==""&&Qt!==""&&Yt!==""?Dn(ot+Bt+Qt+Yt,0,te):"",Dt=ot!==""&&Qt!==""?Dn(ot+Qt,0,ue):"",ur=Bt!==""&&Yt!==""?Dn(Bt+Yt,0,ue):"",Ve=[0,0,0,0,0,0];for(const sr of st){const pr=je[sr.key];(pr===1||pr===2||pr===3||pr===4||pr===5||pr===6)&&(Ve[pr-1]+=sr.max)}const zt=Wt.map(sr=>sr-1),yt=typeof fr=="number"&&zt.length?yc(fr/zt.length):"",St=Ve.map((sr,pr)=>yt===""||!zt.includes(pr)?"":sr>0?Dn(yt,0,sr):yc(yt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...Kt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Rt+1}),a.jsx("td",{style:Kt,children:bp(Ge.reg_no)}),a.jsx("td",{style:Kt,children:Ge.name||""}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ot}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Bt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Qt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Yt}),a.jsx("td",{style:{...Kt,textAlign:"center",fontWeight:700},children:fr}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Dt,ue)})}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(ur,ue)})}),Wt.map(sr=>{const pr=sr-1,we=St[pr],Ie=Ve[pr]??0;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Kt,textAlign:"center"},children:we}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:we===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Number(we),Ie)})})]},`pv_btl_cells_${Ge.id}_${sr}`)})]},`pv_${Ge.id}`)}):Object.keys(Tt||{}).map((Ge,Rt)=>{const Ze=Tt[Ge]||{},ot=typeof Ze.skill1=="number"?Dn(Number(Ze.skill1),1,ce):us(Ze.skill1),Bt=typeof Ze.skill2=="number"?Dn(Number(Ze.skill2),1,ce):us(Ze.skill2),Qt=typeof Ze.att1=="number"?Dn(Number(Ze.att1),1,ce):us(Ze.att1),Yt=typeof Ze.att2=="number"?Dn(Number(Ze.att2),1,ce):us(Ze.att2),fr=ot!==""&&Bt!==""&&Qt!==""&&Yt!==""?Dn(ot+Bt+Qt+Yt,0,te):"",Dt=ot!==""&&Qt!==""?Dn(ot+Qt,0,ue):"",ur=Bt!==""&&Yt!==""?Dn(Bt+Yt,0,ue):"",Ve=[0,0,0,0,0,0];for(const sr of st){const pr=je[sr.key];(pr===1||pr===2||pr===3||pr===4||pr===5||pr===6)&&(Ve[pr-1]+=sr.max)}const zt=Wt.map(sr=>sr-1),yt=typeof fr=="number"&&zt.length?yc(fr/zt.length):"",St=Ve.map((sr,pr)=>yt===""||!zt.includes(pr)?"":sr>0?Dn(yt,0,sr):yc(yt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...Kt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Rt+1}),a.jsx("td",{style:Kt,children:bp(String(Ze.reg_no??Ge))}),a.jsx("td",{style:Kt,children:Ze.name||""}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ot}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Bt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Qt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Yt}),a.jsx("td",{style:{...Kt,textAlign:"center",fontWeight:700},children:fr}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Dt,ue)})}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(ur,ue)})}),Wt.map(sr=>{const pr=sr-1,we=St[pr],Ie=Ve[pr]??0;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Kt,textAlign:"center"},children:we}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:we===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Number(we),Ie)})})]},`pv_btl_cells_${Ge}_${sr}`)})]},`pv_${Ge}`)})})]})}):Zr?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>E(!1),children:"Close"})})]}):a.jsxs("div",{className:"obe-table-wrapper",style:{position:"relative"},children:[a.jsxs("table",{className:"obe-table",style:{minWidth:1200,pointerEvents:Ne?"none":"auto"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Zt,colSpan:qt,children:[ie.termLabel," | ",ie.batchLabel," | ",s.toUpperCase()]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Zt,width:42,minWidth:42},rowSpan:3,children:"S.No"}),a.jsx("th",{style:Zt,rowSpan:3,children:"Register No."}),a.jsx("th",{style:Zt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:Zt,colSpan:2,children:"Skill"}),a.jsx("th",{style:Zt,colSpan:2,children:"Attitude"}),a.jsx("th",{style:Zt,rowSpan:3,children:"Total"}),a.jsx("th",{style:Zt,colSpan:4,children:"CIA 1"}),Wt.length?a.jsx("th",{style:Zt,colSpan:Wt.length*2,children:"BTL"}):null]}),a.jsxs("tr",{children:[a.jsx("th",{style:Zt,children:"1"}),a.jsx("th",{style:Zt,children:"2"}),a.jsx("th",{style:Zt,children:"1"}),a.jsx("th",{style:Zt,children:"2"}),a.jsxs("th",{style:Zt,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Zt,colSpan:2,children:["CO-",l]}),Wt.map(Ge=>a.jsxs("th",{style:Zt,colSpan:2,children:["BTL-",Ge]},`btlhead-${Ge}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt,children:"Mark"}),a.jsx("th",{style:Zt,children:"%"}),a.jsx("th",{style:Zt,children:"Mark"}),a.jsx("th",{style:Zt,children:"%"}),Wt.map(Ge=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:Zt,children:"Mark"}),a.jsx("th",{style:Zt,children:"%"})]},`btl-sub-${Ge}`))]})]}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:"BTL"}),st.map(Ge=>a.jsx("td",{style:{...Kt,textAlign:"center"},children:(()=>{const Rt=y[Ge.key]??"",Ze=Rt===""?"-":String(Rt);return a.jsxs("div",{style:{position:"relative",minWidth:44},children:[a.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${Ze}`,children:Ze}),a.jsxs("select",{"aria-label":`BTL for ${Ge.label}`,value:Rt,onChange:ot=>{if(X)return;const Bt=ie.markManagerSnapshot!=null;_e&&Bt||nt||b(Qt=>({...Qt||{},[Ge.key]:ot.target.value===""?"":Number(ot.target.value)}))},style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(ot=>a.jsx("option",{value:ot,children:ot},ot))]})]})})()},`btl-select-${Ge.key}`)),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},colSpan:4}),Wt.map(Ge=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"}})]},`btl-pad-${Ge}`))]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:ce}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:ce}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:ce}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:ce}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:te}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:ue}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:"%"}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:ue}),a.jsx("td",{style:{...Kt,fontWeight:700,textAlign:"center"},children:"%"})]}),h.map((Ge,Rt)=>{const Ze=ie.rowsByStudentId[String(Ge.id)]||{studentId:Ge.id,skill1:"",skill2:"",att1:"",att2:""},ot=typeof Ze.skill1=="number"?Dn(Number(Ze.skill1),0,ce):"",Bt=typeof Ze.skill2=="number"?Dn(Number(Ze.skill2),0,ce):"",Qt=typeof Ze.att1=="number"?Dn(Number(Ze.att1),0,ce):"",Yt=typeof Ze.att2=="number"?Dn(Number(Ze.att2),0,ce):"",fr=ot!==""&&Bt!==""&&Qt!==""&&Yt!==""?Dn(ot+Bt+Qt+Yt,0,te):"",Dt=ot!==""&&Qt!==""?Dn(ot+Qt,0,ue):"",ur=Bt!==""&&Yt!==""?Dn(Bt+Yt,0,ue):"",Ve=[0,0,0,0,0,0];for(const we of st){const Ie=y[we.key];(Ie===1||Ie===2||Ie===3||Ie===4||Ie===5||Ie===6)&&(Ve[Ie-1]+=we.max)}const zt=Wt.map(we=>we-1),yt=typeof fr=="number"&&zt.length?yc(fr/zt.length):"",St=Ve.map((we,Ie)=>yt===""||!zt.includes(Ie)?"":we>0?Dn(yt,0,we):yc(yt)),pr=Wt.length===0||fe||nt||X;return a.jsxs("tr",{children:[a.jsx("td",{style:{...Kt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Rt+1}),a.jsx("td",{style:Kt,children:bp(Ge.reg_no)}),a.jsx("td",{style:Kt,children:Ge.name||""}),a.jsx("td",{style:Kt,children:a.jsx("input",{style:it,type:"number",min:0,max:ce,value:Ze.skill1===""?"":Ze.skill1,disabled:pr,onChange:we=>{const Ie=we.target.value;if(Ie==="")return we.currentTarget.setCustomValidity(""),cr(Ge.id,{skill1:""});const tt=Number(Ie);if(Number.isFinite(tt)){if(tt>ce){we.currentTarget.setCustomValidity(`Max mark is ${ce}`),we.currentTarget.reportValidity(),window.setTimeout(()=>we.currentTarget.setCustomValidity(""),0);return}we.currentTarget.setCustomValidity(""),cr(Ge.id,{skill1:tt})}}})}),a.jsx("td",{style:Kt,children:a.jsx("input",{style:it,type:"number",min:0,max:ce,value:Ze.skill2===""?"":Ze.skill2,disabled:pr,onChange:we=>{const Ie=we.target.value;if(Ie==="")return we.currentTarget.setCustomValidity(""),cr(Ge.id,{skill2:""});const tt=Number(Ie);if(Number.isFinite(tt)){if(tt>ce){we.currentTarget.setCustomValidity(`Max mark is ${ce}`),we.currentTarget.reportValidity(),window.setTimeout(()=>we.currentTarget.setCustomValidity(""),0);return}we.currentTarget.setCustomValidity(""),cr(Ge.id,{skill2:tt})}}})}),a.jsx("td",{style:Kt,children:a.jsx("input",{style:it,type:"number",min:0,max:ce,value:Ze.att1===""?"":Ze.att1,disabled:pr,onChange:we=>{const Ie=we.target.value;if(Ie==="")return we.currentTarget.setCustomValidity(""),cr(Ge.id,{att1:""});const tt=Number(Ie);if(Number.isFinite(tt)){if(tt>ce){we.currentTarget.setCustomValidity(`Max mark is ${ce}`),we.currentTarget.reportValidity(),window.setTimeout(()=>we.currentTarget.setCustomValidity(""),0);return}we.currentTarget.setCustomValidity(""),cr(Ge.id,{att1:tt})}}})}),a.jsx("td",{style:Kt,children:a.jsx("input",{style:it,type:"number",min:0,max:ce,value:Ze.att2===""?"":Ze.att2,disabled:pr,onChange:we=>{const Ie=we.target.value;if(Ie==="")return we.currentTarget.setCustomValidity(""),cr(Ge.id,{att2:""});const tt=Number(Ie);if(Number.isFinite(tt)){if(tt>ce){we.currentTarget.setCustomValidity(`Max mark is ${ce}`),we.currentTarget.reportValidity(),window.setTimeout(()=>we.currentTarget.setCustomValidity(""),0);return}we.currentTarget.setCustomValidity(""),cr(Ge.id,{att2:tt})}}})}),a.jsx("td",{style:{...Kt,textAlign:"center",fontWeight:700},children:fr}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Dt,ue)})}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(ur,ue)})}),Wt.map(we=>{const Ie=we-1,tt=St[Ie],dt=Ve[Ie]??0;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Kt,textAlign:"center"},children:tt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:tt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Number(tt),dt)})})]},`btl-cells-${we}`)})]},Ge.id)})]})]}),Wt.length===0&&a.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(255,255,255,0.85)",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:10,padding:20,borderRadius:6},children:[a.jsx("div",{style:{fontSize:16,fontWeight:700},children:"BTL values not selected"}),a.jsx("div",{style:{color:"#6b7280"},children:"Assign BTL values in the BTL row below Skill/Attitude to enable entry."}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{onClick:()=>{if(X)return;const Ge=ie.markManagerSnapshot!=null;_e&&Ge||nt||b({skill1:3,skill2:4,att1:3,att2:4})},style:{padding:"6px 10px"},children:"Quick: BTL-3/4"})})]}),fe&&!X&&!Ne?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(239,246,255,0.65)",border:"1px solid rgba(59,130,246,0.25)",borderRadius:6,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:280,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:"Confirm the Mark Manager to unlock the student list."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>He({mode:"confirm"}),disabled:!e||mt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Gt(),disabled:mt,children:"Request Access"})]})]})]}):null,Ne&&!X?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.26) 100%)",border:"1px solid rgba(22,163,74,0.25)",borderRadius:6,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:12,color:"#065f46",marginTop:4},children:"Marks are published. Use View or Request Edit to ask IQAC for access."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",onClick:()=>{E(!0),xr(null);try{gt(!1)}catch{}},children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:ft,onClick:async()=>{if(ft){alert("Edit request is pending. Please wait.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Yr(!0)},children:ft?"Request Pending":"Request Edit"})]})]})]}):null]}):a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:16},children:Pt?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:8},children:Pt?"Marks published. Use View or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12,justifyContent:"flex-end"},children:Pt?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>{E(!0),xr(null);try{gt(!1)}catch{}},children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:ft,onClick:async()=>{if(ft){alert("Edit request is pending. Please wait.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Yr(!0)},children:ft?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>He({mode:"confirm"}),disabled:!e||mt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Gt(),disabled:mt,children:"Request Access"})]})})]})}),lt&&!n?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{mt||He(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ge=>Ge.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:lt.mode==="confirm"?`Confirmation - ${s}`:`Request Edit - ${s}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),lt.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Skill/Attitude max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:ce})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Total max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:te})]}),a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",o," max"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:ue})]}),a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",l," max"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:ue})]}),st.map(Ge=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:[Ge.label," BTL"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsxs("select",{className:"obe-input","aria-label":`BTL for ${Ge.label}`,value:y[Ge.key]??"",disabled:mt||X||nt,onChange:Rt=>{if(X||nt)return;const Ze=Rt.target.value;b(ot=>({...ot||{},[Ge.key]:Ze===""?"":Number(Ze)}))},style:{minWidth:110},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Rt=>a.jsx("option",{value:Rt,children:Rt},Rt))]})})]},`mm_${Ge.key}`))]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:mt,onClick:()=>He(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:mt||!e,onClick:async()=>{if(e){if(lt.mode==="request"){He(null),await Gt();return}await Ut()}},children:lt.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,bt?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>qr(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"90vh",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ge=>Ge.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>qr(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),Zr?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,Br?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:Br}):null,Tt&&Object.keys(Tt).length||h.length?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Zt,colSpan:qt,children:[ie.termLabel," | ",ie.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Zt,width:42,minWidth:42},children:"S.No"}),a.jsx("th",{style:Zt,children:"Register No."}),a.jsx("th",{style:Zt,children:"Name of the Students"}),a.jsx("th",{style:Zt,children:"Skill 1"}),a.jsx("th",{style:Zt,children:"Skill 2"}),a.jsx("th",{style:Zt,children:"Att 1"}),a.jsx("th",{style:Zt,children:"Att 2"}),a.jsx("th",{style:Zt,children:"Total"}),a.jsxs("th",{style:Zt,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Zt,colSpan:2,children:["CO-",l]}),Wt.map(Ge=>a.jsxs("th",{style:Zt,colSpan:2,children:["BTL-",Ge]},`pv_btl_${Ge}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt}),a.jsx("th",{style:Zt,children:"Mark"}),a.jsx("th",{style:Zt,children:"%"}),a.jsx("th",{style:Zt,children:"Mark"}),a.jsx("th",{style:Zt,children:"%"}),Wt.map(Ge=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:Zt,children:"Mark"}),a.jsx("th",{style:Zt,children:"%"})]},`pv_btl_sub_${Ge}`))]})]}),a.jsx("tbody",{children:h.length?h.map((Ge,Rt)=>{const Ze=Tt&&Tt[String(Ge.id)]||{},ot=typeof Ze.skill1=="number"?Dn(Number(Ze.skill1),1,ce):us(Ze.skill1),Bt=typeof Ze.skill2=="number"?Dn(Number(Ze.skill2),1,ce):us(Ze.skill2),Qt=typeof Ze.att1=="number"?Dn(Number(Ze.att1),1,ce):us(Ze.att1),Yt=typeof Ze.att2=="number"?Dn(Number(Ze.att2),1,ce):us(Ze.att2),fr=ot!==""&&Bt!==""&&Qt!==""&&Yt!==""?Dn(ot+Bt+Qt+Yt,0,te):"",Dt=ot!==""&&Qt!==""?Dn(ot+Qt,0,ue):"",ur=Bt!==""&&Yt!==""?Dn(Bt+Yt,0,ue):"",Ve=[0,0,0,0,0,0];for(const sr of st){const pr=je[sr.key];(pr===1||pr===2||pr===3||pr===4||pr===5||pr===6)&&(Ve[pr-1]+=sr.max)}const zt=Wt.map(sr=>sr-1),yt=typeof fr=="number"&&zt.length?yc(fr/zt.length):"",St=Ve.map((sr,pr)=>yt===""||!zt.includes(pr)?"":sr>0?Dn(yt,0,sr):yc(yt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...Kt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Rt+1}),a.jsx("td",{style:Kt,children:bp(Ge.reg_no)}),a.jsx("td",{style:Kt,children:Ge.name||""}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ot}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Bt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Qt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Yt}),a.jsx("td",{style:{...Kt,textAlign:"center",fontWeight:700},children:fr}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Dt,ue)})}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(ur,ue)})}),Wt.map(sr=>{const pr=sr-1,we=St[pr],Ie=Ve[pr]??0;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Kt,textAlign:"center"},children:we}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:we===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Number(we),Ie)})})]},`pv_btl_cells_${Ge.id}_${sr}`)})]},`pv_${Ge.id}`)}):Object.keys(Tt||{}).map((Ge,Rt)=>{const Ze=Tt[Ge]||{},ot=typeof Ze.skill1=="number"?Dn(Number(Ze.skill1),1,ce):us(Ze.skill1),Bt=typeof Ze.skill2=="number"?Dn(Number(Ze.skill2),1,ce):us(Ze.skill2),Qt=typeof Ze.att1=="number"?Dn(Number(Ze.att1),1,ce):us(Ze.att1),Yt=typeof Ze.att2=="number"?Dn(Number(Ze.att2),1,ce):us(Ze.att2),fr=ot!==""&&Bt!==""&&Qt!==""&&Yt!==""?Dn(ot+Bt+Qt+Yt,0,te):"",Dt=ot!==""&&Qt!==""?Dn(ot+Qt,0,ue):"",ur=Bt!==""&&Yt!==""?Dn(Bt+Yt,0,ue):"",Ve=[0,0,0,0,0,0];for(const sr of st){const pr=je[sr.key];(pr===1||pr===2||pr===3||pr===4||pr===5||pr===6)&&(Ve[pr-1]+=sr.max)}const zt=Wt.map(sr=>sr-1),yt=typeof fr=="number"&&zt.length?yc(fr/zt.length):"",St=Ve.map((sr,pr)=>yt===""||!zt.includes(pr)?"":sr>0?Dn(yt,0,sr):yc(yt));return a.jsxs("tr",{children:[a.jsx("td",{style:{...Kt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Rt+1}),a.jsx("td",{style:Kt,children:bp(String(Ze.reg_no??Ge))}),a.jsx("td",{style:Kt,children:Ze.name||""}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ot}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Bt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Qt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Yt}),a.jsx("td",{style:{...Kt,textAlign:"center",fontWeight:700},children:fr}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Dt,ue)})}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:ur===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(ur,ue)})}),Wt.map(sr=>{const pr=sr-1,we=St[pr],Ie=Ve[pr]??0;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Kt,textAlign:"center"},children:we}),a.jsx("td",{style:{...Kt,textAlign:"center"},children:we===""?"":a.jsx("span",{className:"obe-pct-badge",children:Aa(Number(we),Ie)})})]},`pv_btl_cells_${Ge}_${sr}`)})]},`pv_${Ge}`)})})]})}):Zr?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>qr(!1),children:"Close"})})]})})}):null,An?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{Ce||Yr(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ge=>Ge.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[s,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",Ot?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:Ln,onChange:Ge=>Me(Ge.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:Ce,onClick:()=>Yr(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Ce||ft||!e||!String(Ln||"").trim(),onClick:Fe,title:ft?"Request pending (up to 24 hours)":void 0,children:Ce?"Requesting":ft?"Request Pending":"Send Request"})]})]})})}):null,$e&&a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",a.jsx("span",{style:{fontFamily:"monospace"},children:$e})]})]})}function _xe(e){return a.jsx(Hz,{...e,assessmentKey:"formative2"})}const kxe=new URL("https://static.vecteezy.com/system/resources/thumbnails/014/585/778/small/gold-locked-padlock-png.png",import.meta.url).href,Ia=5,Ko=25,Hb={1:9,2:9,3:4.5},Vb={1:3,2:3,3:1.5},Lu={1:20,2:20,3:10},Gb={1:12,2:12,3:6};function jxe(e,t){const r=String(e??"").trim(),n=String(t??"").trim(),i=r.replace(/[^0-9]/g,""),s=n.replace(/[^0-9]/g,"");if(i&&s)try{const o=BigInt(i),l=BigInt(s);if(o<l)return-1;if(o>l)return 1}catch{if(i.length!==s.length)return i.length-s.length;if(i<s)return-1;if(i>s)return 1}else{if(i&&!s)return-1;if(!i&&s)return 1}return r<n?-1:r>n?1:0}function Axe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const i=r.localeCompare(n);if(i)return i}else if(r||n)return r?-1:1;return jxe(e==null?void 0:e.reg_no,t==null?void 0:t.reg_no)}function Ri(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function Nxe(e,t){return`${e}_sheet_${t}`}function bc(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function Fs(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i],o=typeof s=="number"?s:Number(s);o===1||o===2||o===3||o===4||o===5||o===6?n.push(o):n.push(1)}return n}function Kb(e){return e.reduce((t,r)=>t+(typeof r=="number"&&Number.isFinite(r)?r:0),0)}function CM(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Vg(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function vp(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function ew({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:i,coB:s,showCia1Embed:o,cia1Embed:l}){const[c,u]=x.useState(!1),[d,f]=x.useState(null),[h,p]=x.useState([]),[m,g]=x.useState(null),[y,b]=x.useState(!1),[v,w]=x.useState(null),[S,k]=x.useState(null),[j,A]=x.useState(!1),[L,P]=x.useState(null),[B,E]=x.useState(!1),[T,F]=x.useState(""),[W,z]=x.useState(!1),[se,de]=x.useState(null),[U,G]=x.useState(!1),[re,X]=x.useState(null),[C,K]=x.useState(!1),[V,R]=x.useState(null),[J,q]=x.useState(null),[Y,Q]=x.useState(!1),[ie,le]=x.useState(""),[O,H]=x.useState(!1),[ae,I]=x.useState(null),[Z,pe]=x.useState(null),[Oe,Ae]=x.useState(!1),[ke,_e]=x.useState({sheet:{termLabel:"KRCT AY25-26",batchLabel:e||"",coAEnabled:!0,coBEnabled:!0,ciaExamEnabled:!0,expCountA:Ia,expCountB:Ia,btlsA:Array.from({length:Ia},()=>1),btlsB:Array.from({length:Ia},()=>1),rowsByStudentId:{},expMaxA:Ko,expMaxB:Ko,markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}}),De=x.useMemo(()=>e?Nxe(r,e):"",[r,e]),{data:We,publishAllowed:Ct,remainingSeconds:_t,loading:Xe,error:nt,refresh:Ne}=H0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t}),{data:be,refresh:fe}=V0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ge}=nc({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),lt=!!L||!!(be!=null&&be.exists&&(be!=null&&be.is_published)),He=be!=null&&be.exists?!!(be!=null&&be.entry_open):!0,mt=!!(lt&&!He),{pending:wt,pendingUntilMs:Pt,setPendingUntilMs:bt,refresh:qr}=G0({enabled:!!(lt&&mt)&&!!e,assessment:r,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!B||!!J||!!U);const Tt=!!(We!=null&&We.global_override_active&&(We==null?void 0:We.global_is_open)===!1);x.useEffect(()=>{let it=!0;return(async()=>{try{const At=await vu();if(!it)return;g(At||null),_e(Mt=>({...Mt,sheet:{...Mt.sheet,termLabel:String((At==null?void 0:At.termLabel)||Mt.sheet.termLabel||"KRCT AY25-26"),batchLabel:e||Mt.sheet.batchLabel}}))}catch{}})(),()=>{it=!1}},[e]),x.useEffect(()=>{let it=!0;return(async()=>{if(e)try{const At=await ei(r,e);if(!it)return;const Mt=At==null?void 0:At.draft;if(Mt&&typeof Mt=="object"&&Mt.sheet&&typeof Mt.sheet=="object"){const ar=!!(Mt.sheet.coAEnabled??!0),Ge=!!(Mt.sheet.coBEnabled??!0),Rt=!!(Mt.sheet.ciaExamEnabled??!0),Ze=Ri(Number(Mt.sheet.expCountA??Ia),0,12),ot=Ri(Number(Mt.sheet.expCountB??Ia),0,12),Bt=Fs(Mt.sheet.btlsA,Ze),Qt=Fs(Mt.sheet.btlsB,ot),Yt={},fr=Mt.sheet.rowsByStudentId&&typeof Mt.sheet.rowsByStudentId=="object"?Mt.sheet.rowsByStudentId:{};for(const[sr,pr]of Object.entries(fr)){const we=pr&&typeof pr=="object"?pr:{},Ie=bc(we.marksA,Ze),tt=bc(we.marksB,ot),dt=we.ciaExam,xt=dt===""||dt==null?"":Number(dt),Cr=xt===""?"":Number.isFinite(xt)?xt:"";Yt[String(sr)]={...we,studentId:Number.isFinite(Number(we.studentId))?Number(we.studentId):Number(sr),marksA:Ie,marksB:tt,ciaExam:Cr,caaExamByCo:Vg(we.caaExamByCo)}}const Dt=Mt.sheet.markManagerSnapshot??null,ur=Mt.sheet.markManagerApprovalUntil??null,Ve=Mt.sheet.markManagerLocked,zt=typeof Ve=="boolean"?Ve:!!Dt;_e({sheet:{termLabel:String(Mt.sheet.termLabel||(m==null?void 0:m.termLabel)||"KRCT AY25-26"),batchLabel:String(e),coAEnabled:ar,coBEnabled:Ge,ciaExamEnabled:Rt,expCountA:Ze,expCountB:ot,btlsA:Bt,btlsB:Qt,rowsByStudentId:Yt,markManagerLocked:zt,markManagerSnapshot:Dt,markManagerApprovalUntil:ur}});try{De&&Gn(De,{rowsByStudentId:Mt.sheet.rowsByStudentId||{}})}catch{}const yt=(At==null?void 0:At.updated_at)??null,St=(At==null?void 0:At.updated_by)??null;if(yt)try{w(new Date(String(yt)).toLocaleString())}catch{w(String(yt))}St&&k(String(St.name||St.username||St.id||""))}else{const ar=De?Jn(De):null,Ge=ar!=null&&ar.rowsByStudentId&&typeof ar.rowsByStudentId=="object"?ar.rowsByStudentId:{};_e(Rt=>({...Rt,sheet:{...Rt.sheet,batchLabel:String(e),rowsByStudentId:Ge}}))}}catch{}})(),()=>{it=!1}},[r,e,De,m]),x.useEffect(()=>{let it=!0;return(async()=>{if(!t){p([]);return}u(!0),f(null);try{const At=await qc(t);if(!it)return;const ar=[...(At==null?void 0:At.students)||[]].sort((Ge,Rt)=>Axe(Ge,Rt));p(ar)}catch(At){if(!it)return;p([]),f((At==null?void 0:At.message)||"Failed to load roster")}finally{it&&u(!1)}})(),()=>{it=!1}},[t]),x.useEffect(()=>{e&&h.length!==0&&_e(it=>{const At=Ri(Number(it.sheet.expCountA??Ia),0,12),Mt=Ri(Number(it.sheet.expCountB??Ia),0,12),ar=Fs(it.sheet.btlsA,At),Ge=Fs(it.sheet.btlsB,Mt),Rt={...it.sheet.rowsByStudentId||{}};for(const Ze of h){const ot=String(Ze.id),Bt=Rt[ot];if(!Bt)Rt[ot]={studentId:Ze.id,marksA:Array.from({length:At},()=>""),marksB:Array.from({length:Mt},()=>""),caaExamByCo:{},ciaExam:""};else{const Qt=bc(Bt.marksA,At),Yt=bc(Bt.marksB,Mt),fr=Bt.ciaExam,Dt=fr===""||fr==null?"":Number(fr),ur=Dt===""?"":Number.isFinite(Dt)?Dt:"",Ve=Vg(Bt.caaExamByCo);Rt[ot]={...Bt,marksA:Qt,marksB:Yt,ciaExam:ur,caaExamByCo:Ve}}}return{...it,sheet:{...it.sheet,batchLabel:String(e),expCountA:At,expCountB:Mt,btlsA:ar,btlsB:Ge,rowsByStudentId:Rt}}})},[h,e]),x.useEffect(()=>{if(De)try{Gn(De,{rowsByStudentId:ke.sheet.rowsByStudentId})}catch{}},[ke.sheet.rowsByStudentId,De]),x.useEffect(()=>{if(!e)return;if(be!=null&&be.exists){const Mt=!!(be!=null&&be.mark_manager_locked);!!ke.sheet.markManagerLocked!==Mt&&_e(ar=>({...ar,sheet:{...ar.sheet,markManagerLocked:Mt}}));return}const it=!!(ge!=null&&ge.allowed_by_approval),At=ge!=null&&ge.approval_until?String(ge.approval_until):null;if(it&&At){(ke.sheet.markManagerApprovalUntil?String(ke.sheet.markManagerApprovalUntil):null)!==At&&_e(ar=>({...ar,sheet:{...ar.sheet,markManagerLocked:!1,markManagerApprovalUntil:At}}));return}},[e,be==null?void 0:be.exists,be==null?void 0:be.mark_manager_locked,ge==null?void 0:ge.allowed_by_approval,ge==null?void 0:ge.approval_until,ke.sheet.markManagerLocked,ke.sheet.markManagerApprovalUntil]),x.useEffect(()=>{if(!e)return;let it=!1;const At=setTimeout(async()=>{try{await Mi(r,e,ke),it||w(new Date().toLocaleString())}catch{}},900);return()=>{it=!0,clearTimeout(At)}},[r,e,ke]);const xr=Ri(Number(ke.sheet.expCountA??Ia),0,12),Zr=Ri(Number(ke.sheet.expCountB??Ia),0,12),Xr=!!ke.sheet.coAEnabled,Br=!!ke.sheet.coBEnabled,Vr=Xr?xr:0,An=Br?Zr:0,Yr=Vr+An,Ln=x.useMemo(()=>{const it=[];return Xr&&it.push(i),Br&&it.push(s),it},[Xr,Br,i,s]),Me=ke.sheet.ciaExamEnabled!==!1,Ce=x.useMemo(()=>Ln.filter(it=>Number.isFinite(Number(Lu[it]))),[Ln]),It=Me?Math.max(Ce.length,1):0,ft=x.useMemo(()=>{if(Yr===0)return[];const it=Fs(ke.sheet.btlsA,xr).slice(0,Vr),At=Fs(ke.sheet.btlsB,Zr).slice(0,An),Mt=new Set;for(const ar of it)Mt.add(ar);for(const ar of At)Mt.add(ar);return[1,2,3,4,5,6].filter(ar=>Mt.has(ar))},[ke.sheet,xr,Zr,Yr,Vr,An]),Ot=!!ke.sheet.markManagerLocked,er=Ot,hr=!!(Tt||be!=null&&be.exists&&!(be!=null&&be.entry_open));function Tr(it,At){_e(Mt=>Mt.sheet.markManagerLocked?Mt:{...Mt,sheet:{...Mt.sheet,coAEnabled:it==="A"?At:Mt.sheet.coAEnabled,coBEnabled:it==="B"?At:Mt.sheet.coBEnabled}})}function ne(it,At){const Mt=Ri(Number(At),0,100);_e(ar=>ar.sheet.markManagerLocked?ar:{...ar,sheet:{...ar.sheet,expMaxA:it==="A"?Mt:ar.sheet.expMaxA,expMaxB:it==="B"?Mt:ar.sheet.expMaxB}})}function ce(it,At){const Mt=Ri(At,0,12);_e(ar=>{if(ar.sheet.markManagerLocked)return ar;const Ge={...ar.sheet.rowsByStudentId||{}};for(const Qt of Object.keys(Ge)){const Yt=Ge[Qt];if(it==="A"){const fr=bc(Yt==null?void 0:Yt.marksA,Mt);Ge[Qt]={...Yt,marksA:fr}}else{const fr=bc(Yt==null?void 0:Yt.marksB,Mt);Ge[Qt]={...Yt,marksB:fr}}}const Rt=it==="A"?Mt:Ri(Number(ar.sheet.expCountA??Ia),0,12),Ze=it==="B"?Mt:Ri(Number(ar.sheet.expCountB??Ia),0,12),ot=Fs(ar.sheet.btlsA,Rt),Bt=Fs(ar.sheet.btlsB,Ze);return{...ar,sheet:{...ar.sheet,expCountA:it==="A"?Mt:ar.sheet.expCountA,expCountB:it==="B"?Mt:ar.sheet.expCountB,btlsA:ot,btlsB:Bt,rowsByStudentId:Ge}}})}function te(it,At,Mt){_e(ar=>{if(mt||Tt)return ar;const Ge=Ri(Number(ar.sheet.expCountA??Ia),0,12),Rt=Ri(Number(ar.sheet.expCountB??Ia),0,12),Ze=Fs(ar.sheet.btlsA,Ge),ot=Fs(ar.sheet.btlsB,Rt);return it==="A"?Ze[At]=Mt:ot[At]=Mt,{...ar,sheet:{...ar.sheet,btlsA:Ze,btlsB:ot}}})}function ue(it){_e(At=>At.sheet.markManagerLocked?At:{...At,sheet:{...At.sheet,ciaExamEnabled:!!it}})}function Ee(it){const At=Ri(Number(it.expCountA??Ia),0,12),Mt=Ri(Number(it.expCountB??Ia),0,12),ar=Fs(it.btlsA,At).slice(0,At),Ge=Fs(it.btlsB,Mt).slice(0,Mt);return JSON.stringify({coAEnabled:!!it.coAEnabled,coBEnabled:!!it.coBEnabled,ciaExamEnabled:!!(it.ciaExamEnabled??!0),expCountA:At,expMaxA:Ri(Number(it.expMaxA??Ko),0,100),expCountB:Mt,expMaxB:Ri(Number(it.expMaxB??Ko),0,100),btlsA:ar,btlsB:Ge})}async function je(){if(e){Q(!0),pe(null);try{const it=await nl({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t});alert(il(it))}catch(it){const At=al(it,"Request failed");pe(At),alert(`Edit request failed: ${At}`)}finally{Q(!1)}}}function gt(it,At,Mt,ar){_e(Ge=>{var zt;const Rt=String(it),Ze=Ri(Number(Ge.sheet.expCountA??Ia),0,12),ot=Ri(Number(Ge.sheet.expCountB??Ia),0,12),Bt=Ri(Number(Ge.sheet.expMaxA??Ko),0,100),Qt=Ri(Number(Ge.sheet.expMaxB??Ko),0,100),Yt=(zt=Ge.sheet.rowsByStudentId)==null?void 0:zt[Rt],fr=Yt?bc(Yt.marksA,Ze):Array.from({length:Ze},()=>""),Dt=Yt?bc(Yt.marksB,ot):Array.from({length:ot},()=>""),ur=[...fr],Ve=[...Dt];if(At==="A")if(ar===""||ar==null)ur[Mt]="";else{const yt=Number(ar);ur[Mt]=Number.isFinite(yt)?Math.max(0,Math.min(Bt,Math.trunc(yt))):""}else if(ar===""||ar==null)Ve[Mt]="";else{const yt=Number(ar);Ve[Mt]=Number.isFinite(yt)?Math.max(0,Math.min(Qt,Math.trunc(yt))):""}return{...Ge,sheet:{...Ge.sheet,rowsByStudentId:{...Ge.sheet.rowsByStudentId,[Rt]:{...Yt||{studentId:it},marksA:ur,marksB:Ve,ciaExam:Yt&&(typeof Yt.ciaExam=="number"||Yt.ciaExam==="")?Yt.ciaExam:""}}}}})}function Qe(it,At,Mt){_e(ar=>{var Yt;const Ge=String(it),Rt=(Yt=ar.sheet.rowsByStudentId)==null?void 0:Yt[Ge];if(!Rt)return ar;const Ze=String(Ri(Number(At),1,5)),ot=Number(Lu[Number(Ze)]||0),Bt=Mt===""?"":Ri(Number(Mt),0,ot>0?ot:0),Qt={...Vg(Rt.caaExamByCo),[Ze]:Bt};return{...ar,sheet:{...ar.sheet,rowsByStudentId:{...ar.sheet.rowsByStudentId,[Ge]:{...Rt,caaExamByCo:Qt}}}}})}async function Fe(){if(e){b(!0);try{await Mi(r,e,ke),w(new Date().toLocaleString())}catch(it){alert((it==null?void 0:it.message)||"Draft save failed")}finally{b(!1)}}}const $e=hn.useRef(ke);$e.current=ke,x.useEffect(()=>{const it=()=>{!e||hr||Mi(r,e,$e.current).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",it),()=>window.removeEventListener("obe:before-tab-switch",it)},[e,r,hr]);async function st(){if(!e||!window.confirm("Reset all lab marks for this sheet? This clears the draft (students + experiments + CIA Exam)."))return;const At=Ri(Number(ke.sheet.expCountA??Ia),0,12),Mt=Ri(Number(ke.sheet.expCountB??Ia),0,12),ar={};for(const Rt of h)ar[String(Rt.id)]={studentId:Rt.id,marksA:Array.from({length:At},()=>""),marksB:Array.from({length:Mt},()=>""),caaExamByCo:{},ciaExam:""};const Ge={sheet:{...ke.sheet,rowsByStudentId:ar}};_e(Ge);try{De&&Gn(De,{rowsByStudentId:{}})}catch{}try{await Mi(r,e,Ge),w(new Date().toLocaleString())}catch{}}async function Wt(){if(e){if(Tt){alert("Publishing is locked by IQAC.");return}if(!Ct){alert("Publish window is closed. Please request IQAC approval.");return}if(lt&&mt){if(wt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}E(!0);return}if(!L){A(!0);try{await k3(r,e,ke,t),P(new Date().toLocaleString()),await ht(!1),Ne(),fe({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(it){alert((it==null?void 0:it.message)||"Publish failed")}finally{A(!1)}}}}async function qt(){if(e){H(!0),I(null);try{await Sh({assessment:r,subject_code:e,reason:ie,teaching_assignment_id:t}),I("Request sent to IQAC successfully."),le(""),Ne()}catch(it){I((it==null?void 0:it.message)||"Failed to send request.")}finally{H(!1)}}}async function ht(it){if(e){it&&K(!0),R(null);try{const At=await ho(r,String(e),t),Mt=(At==null?void 0:At.data)??null;Mt&&typeof Mt=="object"&&X(Mt)}catch(At){it&&R((At==null?void 0:At.message)||"Failed to load published marks")}finally{it&&K(!1)}}}x.useEffect(()=>{e&&ht(!1)},[e,r]);const Ut=hn.useRef(!!He);x.useEffect(()=>{if(!e||!lt)return;if(Ut.current||!He){Ut.current=!!He;return}let At=!0;return(async()=>{try{const Mt=await ei(r,String(e),t),ar=(Mt==null?void 0:Mt.data)??null;if(!At)return;if(ar&&typeof ar=="object"&&ar.sheet){_e(ar);return}}catch{}At&&re&&re.sheet&&_e(re)})(),Ut.current=!!He,()=>{At=!1}},[He,lt,e,r,re]),x.useEffect(()=>{if(!e||!lt||He)return;const it=window.setInterval(()=>{fe({silent:!0})},3e4);return()=>window.clearInterval(it)},[He,lt,e,fe]),x.useEffect(()=>{U&&e&&(X(null),ht(!0))},[U,e,r]);const Gt=3+Yr+1+It+4+ft.length*2,cr=Ri(Number(ke.sheet.expMaxA??Ko),0,100),ir=Ri(Number(ke.sheet.expMaxB??Ko),0,100),Fr=Number(Gb[i]||0),dn=Number(Gb[s]||0),vr=Math.max(cr,ir,Ko),Lt={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Gr={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},bn={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},or={position:"relative",border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},kr="100%",Mr={display:"flex",width:"100%",maxWidth:1200,margin:"0 auto",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},Ar={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},Zt=Oe?"markManagerGlitch 2s ease-in-out":void 0,Kt={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"};return a.jsxs(ag,{children:[a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),a.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),a.jsxs("div",{style:{...Mr,border:"1px solid #fcd34d",background:Ot?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:Zt,position:"relative",overflow:"hidden"},children:[Oe?a.jsx(a.Fragment,{children:Array.from({length:20},(it,At)=>a.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},At))}):null,a.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx(T2,{size:20,color:Ot?"#6b7280":"#9a3412"}),a.jsx("div",{style:{fontWeight:950,color:"#111827",fontSize:14},children:"Mark Manager"}),Ot&&a.jsx("span",{style:{fontSize:11,color:"#fff",background:"#dc2626",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"LOCKED"}),!Ot&&a.jsx("span",{style:{fontSize:11,color:"#fff",background:"#16a34a",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"EDITABLE"})]}),a.jsx("button",{onClick:()=>q({mode:Ot?"request":"confirm"}),className:"obe-btn obe-btn-success",disabled:!e||Y,style:{minWidth:100},children:Y?"Saving...":Ot?"Request Edit":"Save & Lock"})]}),a.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:Xr,disabled:Ot,onChange:it=>Tr("A",it.target.checked),style:Ar}),"CO-",i]}),a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:Br,disabled:Ot,onChange:it=>Tr("B",it.target.checked),style:Ar}),"CO-",s]}),a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:Me,disabled:Ot,onChange:it=>ue(it.target.checked),style:Ar}),"CIA Exam"]})]}),a.jsxs("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,marginTop:8},children:[Xr?a.jsxs("div",{style:{minWidth:0},children:[a.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of experiments (CO-",i,")"]}),a.jsx("input",{type:"number",className:"obe-input",value:xr,onChange:it=>ce("A",Number(it.target.value)),min:0,max:12,disabled:Ot}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:6},children:"Max marks (per experiment)"}),a.jsx("input",{type:"number",className:"obe-input",value:ke.sheet.expMaxA??Ko,onChange:it=>ne("A",Number(it.target.value)),min:0,max:100,disabled:Ot})]}):null,Br?a.jsxs("div",{style:{minWidth:0},children:[a.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of experiments (CO-",s,")"]}),a.jsx("input",{type:"number",className:"obe-input",value:Zr,onChange:it=>ce("B",Number(it.target.value)),min:0,max:12,disabled:Ot}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:6},children:"Max marks (per experiment)"}),a.jsx("input",{type:"number",className:"obe-input",value:ke.sheet.expMaxB??Ko,onChange:it=>ne("B",Number(it.target.value)),min:0,max:100,disabled:Ot})]}):null]})]}),Z?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:Z}):null]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.jsx("button",{onClick:st,className:"obe-btn obe-btn-danger",disabled:!e||!er||hr,title:er?hr?"Table locked after publish":"Clear all marks":"Save & Lock Mark Manager first to enable table",children:"Reset All"})}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Fe,className:"obe-btn obe-btn-success",disabled:y||!e||!er||hr,title:er?hr?"Table locked after publish":"Save current draft":"Save & Lock Mark Manager first to enable table",children:y?"Saving":"Save Draft"}),a.jsx("button",{onClick:Wt,className:"obe-btn obe-btn-primary",disabled:mt?wt:!e||j||!er||hr||Tt||!Ct,title:er?hr?"Table locked after publish":Ct?Tt?"Publishing locked by IQAC":"Publish marks":"Publish window closed":"Save & Lock Mark Manager first",children:mt?wt?"Request Pending":"Request Edit":j?"Publishing":"Publish"}),v&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",v]}),L&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",L]})]})]}),d&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:d}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:Ct?"#065f46":"#b91c1c"},children:Xe?"Checking publish due time":nt||(We!=null&&We.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(We.due_at).toLocaleString(),"  Remaining: ",ng(_t),We.allowed_by_approval&&We.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(We.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Tt?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>Ne(),disabled:Xe,children:"Refresh"})})]}):Ct?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:ie,onChange:it=>le(it.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>Ne(),disabled:O||Xe,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:qt,disabled:O,children:O?"Requesting":"Request Approval"})]}),ae?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:ae}):null]}),c?a.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):h.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"Select a Teaching Assignment to load students."}):er?a.jsx("div",{style:or,children:a.jsxs(ig,{locked:Tt,children:[a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable"},children:a.jsxs("table",{className:"obe-table",style:{minWidth:kr,width:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Lt,colSpan:Gt,children:[ke.sheet.termLabel," | ",ke.sheet.batchLabel," | ",n]})}),a.jsxs("tr",{children:[a.jsx("th",{style:Lt,rowSpan:5,children:"S.No"}),a.jsx("th",{style:Lt,rowSpan:5,children:"Register No."}),a.jsx("th",{style:Lt,rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:Lt,colSpan:Math.max(1,Yr),children:"Experiments"}),a.jsx("th",{style:Lt,rowSpan:5,children:"Total (Avg)"}),Me?a.jsx("th",{style:Lt,colSpan:Math.max(Ce.length,1),children:"CIA EXAM"}):null,a.jsx("th",{style:Lt,colSpan:4,children:"CO ATTAINMENT"}),ft.length?a.jsx("th",{style:Lt,colSpan:ft.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Yr===0?a.jsx("th",{style:Lt,children:""}):a.jsxs(a.Fragment,{children:[Array.from({length:Vr},(it,At)=>a.jsx("th",{style:Lt,children:i},`coa_${At}`)),Array.from({length:An},(it,At)=>a.jsx("th",{style:Lt,children:s},`cob_${At}`))]}),Me?Ce.length?Ce.map(it=>a.jsxs("th",{style:Lt,children:["CO-",it]},`caa_hdr_${it}`)):a.jsx("th",{style:Lt,children:""}):null,a.jsxs("th",{style:Lt,colSpan:2,children:["CO-",i]}),a.jsxs("th",{style:Lt,colSpan:2,children:["CO-",s]}),ft.map(it=>a.jsxs("th",{style:Lt,colSpan:2,children:["BTL-",it]},`btl_${it}`))]}),a.jsxs("tr",{children:[Yr===0?a.jsx("th",{style:Lt,children:""}):a.jsxs(a.Fragment,{children:[Array.from({length:Vr},(it,At)=>a.jsx("th",{style:Lt,children:cr},`max_a_${At}`)),Array.from({length:An},(it,At)=>a.jsx("th",{style:Lt,children:ir},`max_b_${At}`))]}),Me?Ce.length?Ce.map(it=>a.jsx("th",{style:Lt,children:Lu[it]??0},`caa_max_${it}`)):a.jsx("th",{style:Lt,children:""}):null,a.jsx("th",{style:Lt,children:Fr}),a.jsx("th",{style:Lt,children:"%"}),a.jsx("th",{style:Lt,children:dn}),a.jsx("th",{style:Lt,children:"%"}),ft.map(it=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:Lt,children:vr}),a.jsx("th",{style:Lt,children:"%"})]},`btlmax_${it}`))]}),a.jsxs("tr",{children:[Yr===0?a.jsx("th",{style:Lt,children:"No experiments"}):a.jsxs(a.Fragment,{children:[Array.from({length:Vr},(it,At)=>a.jsxs("th",{style:Lt,children:["E",At+1]},`ea_${At}`)),Array.from({length:An},(it,At)=>a.jsxs("th",{style:Lt,children:["E",At+1]},`eb_${At}`))]}),a.jsx("th",{style:Lt,colSpan:4+ft.length*2+It})]}),a.jsxs("tr",{children:[Yr===0?a.jsx("th",{style:Lt,children:""}):a.jsxs(a.Fragment,{children:[Array.from({length:Vr},(it,At)=>{const Mt=Fs(ke.sheet.btlsA,xr)[At]??1,ar=!(mt||Tt);return a.jsx("th",{style:Lt,children:ar?a.jsx("select",{"aria-label":`BTL for CO${i} E${At+1}`,value:Mt,onChange:Ge=>te("A",At,Number(Ge.target.value)),style:{width:"100%",minWidth:38,padding:"2px 2px",fontWeight:800,fontSize:11,textAlign:"center",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",cursor:"pointer"},children:[1,2,3,4,5,6].map(Ge=>a.jsx("option",{value:Ge,children:Ge},Ge))}):a.jsx("span",{style:{fontWeight:800},children:Mt})},`btla_${At}`)}),Array.from({length:An},(it,At)=>{const Mt=Fs(ke.sheet.btlsB,Zr)[At]??1,ar=!(mt||Tt);return a.jsx("th",{style:Lt,children:ar?a.jsx("select",{"aria-label":`BTL for CO${s} E${At+1}`,value:Mt,onChange:Ge=>te("B",At,Number(Ge.target.value)),style:{width:"100%",minWidth:38,padding:"2px 2px",fontWeight:800,fontSize:11,textAlign:"center",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",cursor:"pointer"},children:[1,2,3,4,5,6].map(Ge=>a.jsx("option",{value:Ge,children:Ge},Ge))}):a.jsx("span",{style:{fontWeight:800},children:Mt})},`btlb_${At}`)})]}),a.jsx("th",{style:Lt,colSpan:4+ft.length*2+It})]})]}),a.jsx("tbody",{children:mt?a.jsx("tr",{children:a.jsx("td",{colSpan:Gt,style:{padding:14,textAlign:"center",color:"#065f46",fontWeight:900},children:"Published  students hidden"})}):a.jsxs(a.Fragment,{children:[h.map((it,At)=>{var vt;const Mt=(vt=ke.sheet.rowsByStudentId)==null?void 0:vt[String(it.id)],ar=bc(Mt==null?void 0:Mt.marksA,xr),Ge=bc(Mt==null?void 0:Mt.marksB,Zr),Rt=Vg(Mt==null?void 0:Mt.caaExamByCo),Ze=ar.slice(0,Vr),ot=Ge.slice(0,An),Bt=Ze.concat(ot),Qt=Fs(ke.sheet.btlsA,xr).slice(0,Vr),Yt=Fs(ke.sheet.btlsB,Zr).slice(0,An),fr=CM(Bt),Dt=Kb(Ze),ur=Kb(ot),Ve=Vr*cr,zt=An*ir,yt=Number(Hb[i]||0),St=Number(Hb[s]||0),sr=Ve>0?Dt/Ve*yt:0,pr=zt>0?ur/zt*St:0,we=typeof Rt[String(i)]=="number"?Number(Rt[String(i)]):0,Ie=typeof Rt[String(s)]=="number"?Number(Rt[String(s)]):0,tt=Number(Lu[i]||0),dt=Number(Lu[s]||0),xt=Number(Vb[i]||0),Cr=Number(Vb[s]||0),nn=Me&&tt>0?we/tt*xt:0,ct=Me&&dt>0?Ie/dt*Cr:0,Ht=Dt>0||we>0,Ue=ur>0||Ie>0,qe=Ht?sr+nn:null,at=Ue?pr+ct:null,Be={};for(const jt of ft){const $t=[];for(let Rr=0;Rr<Ze.length;Rr++)if(Qt[Rr]===jt){const Ur=Ze[Rr];typeof Ur=="number"&&Number.isFinite(Ur)&&$t.push(Ur)}for(let Rr=0;Rr<ot.length;Rr++)if(Yt[Rr]===jt){const Ur=ot[Rr];typeof Ur=="number"&&Number.isFinite(Ur)&&$t.push(Ur)}Be[jt]=$t.length?$t.reduce((Rr,Ur)=>Rr+Ur,0)/$t.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...Gr,width:"30px",minWidth:"30px",fontWeight:700},children:At+1}),a.jsx("td",{style:{...Gr,width:"70px",minWidth:"70px",fontWeight:600},children:String(it.reg_no||"").slice(-8)}),a.jsx("td",{style:{...Gr,fontWeight:600,whiteSpace:"nowrap"},children:String(it.name||"")}),Array.from({length:Vr},(jt,$t)=>a.jsx("td",{style:{...Gr,padding:"2px"},children:a.jsx("input",{type:"number",value:ar[$t],onChange:Rr=>{const Ur=Rr.target.value;if(Ur==="")return Rr.currentTarget.setCustomValidity(""),gt(it.id,"A",$t,"");const en=Number(Ur);if(Number.isFinite(en)){if(en>cr){Rr.currentTarget.setCustomValidity(`Max mark is ${cr}`),Rr.currentTarget.reportValidity(),window.setTimeout(()=>Rr.currentTarget.setCustomValidity(""),0);return}Rr.currentTarget.setCustomValidity(""),gt(it.id,"A",$t,en)}},style:bn,min:0,max:cr,disabled:!er||hr})},`ma${it.id}_${$t}`)),Array.from({length:An},(jt,$t)=>a.jsx("td",{style:{...Gr,padding:"2px"},children:a.jsx("input",{type:"number",value:Ge[$t],onChange:Rr=>{const Ur=Rr.target.value;if(Ur==="")return Rr.currentTarget.setCustomValidity(""),gt(it.id,"B",$t,"");const en=Number(Ur);if(Number.isFinite(en)){if(en>ir){Rr.currentTarget.setCustomValidity(`Max mark is ${ir}`),Rr.currentTarget.reportValidity(),window.setTimeout(()=>Rr.currentTarget.setCustomValidity(""),0);return}Rr.currentTarget.setCustomValidity(""),gt(it.id,"B",$t,en)}},style:bn,min:0,max:ir,disabled:!er||hr})},`mb${it.id}_${$t}`)),a.jsx("td",{style:{...Gr,fontWeight:700,fontSize:"clamp(10px, 0.9vw, 11px)"},children:fr==null?"":fr.toFixed(1)}),Me?Ce.length?Ce.map(jt=>{const $t=Number(Lu[jt]||0),Rr=Rt[String(jt)]??"";return a.jsx("td",{style:{...Gr,padding:"2px"},children:a.jsx("input",{type:"number",value:Rr,onChange:Ur=>{const en=Ur.target.value;if(en==="")return Ur.currentTarget.setCustomValidity(""),Qe(it.id,jt,"");const vn=Number(en);if(Number.isFinite(vn)){if(vn>$t){Ur.currentTarget.setCustomValidity(`Max mark is ${$t}`),Ur.currentTarget.reportValidity(),window.setTimeout(()=>Ur.currentTarget.setCustomValidity(""),0);return}Ur.currentTarget.setCustomValidity(""),Qe(it.id,jt,vn)}},style:bn,min:0,max:$t,disabled:!er||hr})},`caa_${it.id}_${jt}`)}):a.jsx("td",{style:{...Gr,textAlign:"center",color:"#6b7280"},children:""}):null,a.jsx("td",{style:{...Gr,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:qe==null?"":qe.toFixed(1)}),a.jsx("td",{style:{...Gr,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:vp(qe,Fr)}),a.jsx("td",{style:{...Gr,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:at==null?"":at.toFixed(1)}),a.jsx("td",{style:{...Gr,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:vp(at,dn)}),ft.map(jt=>{const $t=Be[jt]??null,Rr=Math.max(cr,ir,Ko);return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Gr,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:$t==null?"":$t.toFixed(1)}),a.jsx("td",{style:{...Gr,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:vp($t,Rr)})]},`btlcell_${it.id}_${jt}`)})]},it.id)}),h.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Gt,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})})]})}),mt?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,Ot?null:a.jsxs("div",{style:Kt,children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]}),mt?a.jsxs("div",{style:Kt,children:[a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>G(!0),children:"View Marks"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:wt,onClick:async()=>{if(wt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}E(!0)},children:wt?"Request Pending":"Request Edit"})]}),a.jsx("div",{style:{width:170,height:92,display:"grid",placeItems:"center",background:"#fff",borderRadius:10,border:"1px solid rgba(2,6,23,0.08)"},children:a.jsx("img",{src:new URL("/assets/lockong-CpAqbAhU.png",import.meta.url).toString(),alt:"locked",style:{maxWidth:150,maxHeight:80,display:"block"},onError:it=>{it.currentTarget.onerror=null,it.currentTarget.src=kxe}})})]}):null]})}):a.jsxs("div",{style:{padding:"20px",textAlign:"center",background:"#fff7ed",borderRadius:12,border:"1px solid #fcd34d"},children:[a.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#92400e",marginBottom:8},children:" Mark Manager Configuration Required"}),a.jsx("div",{style:{fontSize:12,color:"#78350f"},children:"Please configure and lock the Mark Manager above to enable the table."})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[v?a.jsxs("div",{children:["Draft saved: ",v,S?a.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",a.jsx("strong",{children:S})]}):null]}):null,L?a.jsxs("div",{children:["Last published: ",L]}):null]}),B?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{W||E(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:it=>it.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",Pt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",n]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Code:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",L||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",v||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:T,onChange:it=>F(it.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),se?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:se}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:W,onClick:()=>E(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",disabled:W||wt||!e||!String(T||"").trim(),onClick:async()=>{if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(wt){alert("Edit request is pending. Please wait.");return}const At=String(T||"").trim();if(!At){de("Reason is required.");return}z(!0),de(null);try{const Mt=await nl({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:At,teaching_assignment_id:t});alert(il(Mt)),E(!1),F(""),bt(Date.now()+24*60*60*1e3);try{qr({silent:!0})}catch{}fe({silent:!0})}catch(Mt){const ar=al(Mt,"Request failed");de(ar),alert(`Edit request failed: ${ar}`)}finally{z(!1)}},children:W?"Requesting":wt?"Request Pending":"Send Request"})]})]})})}):null,J?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{Y||q(null)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:it=>it.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:J.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(r).toUpperCase()})]}),J.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{background:"#fffbeb",border:"1px solid #fbbf24",borderRadius:8,padding:12,marginBottom:12},children:[a.jsx("div",{style:{fontWeight:700,color:"#92400e",marginBottom:4},children:" Important"}),a.jsxs("div",{style:{fontSize:12,color:"#78350f",lineHeight:1.5},children:["After confirming, Mark Manager will be ",a.jsx("strong",{children:"locked"}),". You'll need IQAC approval to change CO selection, experiment count, or max marks."]})]}),a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:8,fontWeight:600},children:"Review your settings:"}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Experiments"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Max marks"})]})}),a.jsxs("tbody",{children:[Xr?a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:["CO-",i]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:Vr}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:cr})]}):null,Br?a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:["CO-",s]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:An}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:ir})]}):null,!Xr&&!Br?a.jsx("tr",{children:a.jsx("td",{colSpan:3,style:{padding:10,color:"#dc2626",fontWeight:600},children:" No COs selected"})}):null,a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:"CIA Exam"}),a.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:Me?" Enabled":" Disabled"})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:Y,onClick:()=>q(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Y||!e,onClick:async()=>{if(e){if(J.mode==="request"){q(null),await je();return}Q(!0),pe(null),Ae(!0);try{const it=Ee(ke.sheet),At=ge!=null&&ge.approval_until?String(ge.approval_until):ke.sheet.markManagerApprovalUntil||null,Mt={...ke,sheet:{...ke.sheet,markManagerLocked:!0,markManagerSnapshot:it,markManagerApprovalUntil:At}};await Mi(r,String(e),Mt),w(new Date().toLocaleString()),await uh(r,String(e),t),await fe({silent:!1}),_e(Mt),q(null),alert(" Mark Manager saved and locked successfully! You can now proceed with mark entry."),setTimeout(()=>Ae(!1),1500)}catch(it){pe((it==null?void 0:it.message)||"Save failed"),Ae(!1),_e(At=>({...At,sheet:{...At.sheet,markManagerLocked:!1}}))}finally{Q(!1)}}},children:Y?"Saving...":J.mode==="confirm"?" Confirm & Lock":" Send Request"})]})]})})}):null,U?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:70},onClick:()=>G(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflow:"auto",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:it=>it.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Marks"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),C?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,V?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:V}):null,(()=>{const it=re&&re.sheet?re.sheet:ke.sheet,At=it.ciaExamEnabled!==!1,Mt=Ri(Number(it.expCountA??Ia),0,12),ar=Ri(Number(it.expCountB??Ia),0,12),Ge=!!it.coAEnabled,Rt=!!it.coBEnabled,Ze=Ge?Mt:0,ot=Rt?ar:0,Bt=Ze+ot,Qt=Fs(it.btlsA,Mt).slice(0,Ze),Yt=Fs(it.btlsB,ar).slice(0,ot),fr=new Set;for(const dt of Qt)fr.add(dt);for(const dt of Yt)fr.add(dt);const Dt=[1,2,3,4,5,6].filter(dt=>fr.has(dt)),ur=Ri(Number(it.expMaxA??Ko),0,100),Ve=Ri(Number(it.expMaxB??Ko),0,100),zt=Number(Gb[i]||0),yt=Number(Gb[s]||0),St=Math.max(ur,Ve,Ko),pr=[Ge?i:null,Rt?s:null].filter(dt=>typeof dt=="number").filter(dt=>Number.isFinite(Number(Lu[dt]))),we=At?Math.max(pr.length,1):0,Ie=3+Bt+1+we+4+Dt.length*2,tt=Math.max(920,360+(Bt+Dt.length*2+we)*80);return a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:tt,tableLayout:"auto",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:Lt,colSpan:Ie,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:Lt,rowSpan:5,children:"S.No"}),a.jsx("th",{style:Lt,rowSpan:5,children:"Register No."}),a.jsx("th",{style:Lt,rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:Lt,colSpan:Math.max(1,Bt),children:"Experiments"}),a.jsx("th",{style:Lt,rowSpan:5,children:"Total (Avg)"}),At?a.jsx("th",{style:Lt,colSpan:Math.max(pr.length,1),children:"CIA EXAM"}):null,a.jsx("th",{style:Lt,colSpan:4,children:"CO ATTAINMENT"}),Dt.length?a.jsx("th",{style:Lt,colSpan:Dt.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Bt===0?a.jsx("th",{style:Lt,children:""}):a.jsxs(a.Fragment,{children:[Array.from({length:Ze},(dt,xt)=>a.jsx("th",{style:Lt,children:i},`v_coa_${xt}`)),Array.from({length:ot},(dt,xt)=>a.jsx("th",{style:Lt,children:s},`v_cob_${xt}`))]}),At?pr.length?pr.map(dt=>a.jsxs("th",{style:Lt,children:["CO-",dt]},`v_caa_${dt}`)):a.jsx("th",{style:Lt,children:""}):null,a.jsxs("th",{style:Lt,colSpan:2,children:["CO-",i]}),a.jsxs("th",{style:Lt,colSpan:2,children:["CO-",s]}),Dt.map(dt=>a.jsxs("th",{style:Lt,colSpan:2,children:["BTL-",dt]},`v_btl_${dt}`))]}),a.jsxs("tr",{children:[Bt===0?a.jsx("th",{style:Lt,children:""}):a.jsx(a.Fragment,{children:Array.from({length:Bt},(dt,xt)=>a.jsx("th",{style:Lt,children:St},`v_max_${xt}`))}),At?pr.length?pr.map(dt=>a.jsx("th",{style:Lt,children:Lu[dt]??0},`v_caa_max_${dt}`)):a.jsx("th",{style:Lt,children:""}):null,a.jsx("th",{style:Lt,children:zt}),a.jsx("th",{style:Lt,children:"%"}),a.jsx("th",{style:Lt,children:yt}),a.jsx("th",{style:Lt,children:"%"}),Dt.map(dt=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:Lt,children:St}),a.jsx("th",{style:Lt,children:"%"})]},`v_btlmax_${dt}`))]}),a.jsxs("tr",{children:[Bt===0?a.jsx("th",{style:Lt,children:"No experiments"}):a.jsxs(a.Fragment,{children:[Array.from({length:Ze},(dt,xt)=>a.jsxs("th",{style:Lt,children:["E",xt+1]},`v_ea_${xt}`)),Array.from({length:ot},(dt,xt)=>a.jsxs("th",{style:Lt,children:["E",xt+1]},`v_eb_${xt}`))]}),a.jsx("th",{style:Lt,colSpan:4+Dt.length*2+we})]}),a.jsxs("tr",{children:[Bt===0?a.jsx("th",{style:Lt,children:"BTL"}):a.jsxs(a.Fragment,{children:[Array.from({length:Ze},(dt,xt)=>a.jsx("th",{style:Lt,children:Qt[xt]??1},`v_btla_${xt}`)),Array.from({length:ot},(dt,xt)=>a.jsx("th",{style:Lt,children:Yt[xt]??1},`v_btlb_${xt}`))]}),a.jsx("th",{style:Lt,colSpan:4+Dt.length*2+we})]})]}),a.jsxs("tbody",{children:[h.map((dt,xt)=>{var Nn;const Cr=(Nn=it==null?void 0:it.rowsByStudentId)==null?void 0:Nn[String(dt.id)],nn=bc(Cr==null?void 0:Cr.marksA,Mt).slice(0,Ze),ct=bc(Cr==null?void 0:Cr.marksB,ar).slice(0,ot),Ht=nn.concat(ct),Ue=CM(Ht),qe=Vg(Cr==null?void 0:Cr.caaExamByCo),at=Kb(nn),Be=Kb(ct),vt=Ze*ur,jt=ot*Ve,$t=Number(Hb[i]||0),Rr=Number(Hb[s]||0),Ur=vt>0?at/vt*$t:0,en=jt>0?Be/jt*Rr:0,vn=typeof qe[String(i)]=="number"?Number(qe[String(i)]):0,Nr=typeof qe[String(s)]=="number"?Number(qe[String(s)]):0,fn=Number(Lu[i]||0),rr=Number(Lu[s]||0),ve=Number(Vb[i]||0),rt=Number(Vb[s]||0),ut=At&&fn>0?vn/fn*ve:0,pt=At&&rr>0?Nr/rr*rt:0,Pr=at>0||vn>0?Ur+ut:null,Kr=Be>0||Nr>0?en+pt:null,pn={};for(const _n of Dt){const kn=[];for(let Wn=0;Wn<nn.length;Wn++)if(Qt[Wn]===_n){const M=nn[Wn];typeof M=="number"&&Number.isFinite(M)&&kn.push(M)}for(let Wn=0;Wn<ct.length;Wn++)if(Yt[Wn]===_n){const M=ct[Wn];typeof M=="number"&&Number.isFinite(M)&&kn.push(M)}pn[_n]=kn.length?kn.reduce((Wn,M)=>Wn+M,0)/kn.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...Gr,textAlign:"center",width:42,minWidth:42},children:xt+1}),a.jsx("td",{style:Gr,children:String(dt.reg_no||"")}),a.jsx("td",{style:Gr,children:String(dt.name||"")}),Bt===0?a.jsx("td",{style:{...Gr,textAlign:"center",color:"#6b7280"},children:""}):a.jsxs(a.Fragment,{children:[Array.from({length:Ze},(_n,kn)=>a.jsx("td",{style:{...Gr,width:78,minWidth:78,background:"#fff7ed",textAlign:"center",fontWeight:800},children:nn[kn]??""},`v_ma_${dt.id}_${kn}`)),Array.from({length:ot},(_n,kn)=>a.jsx("td",{style:{...Gr,width:78,minWidth:78,background:"#fff7ed",textAlign:"center",fontWeight:800},children:ct[kn]??""},`v_mb_${dt.id}_${kn}`))]}),a.jsx("td",{style:{...Gr,textAlign:"right",fontWeight:800},children:Ue==null?"":Ue.toFixed(1)}),At?pr.length?pr.map(_n=>a.jsx("td",{style:{...Gr,width:90,minWidth:90,background:"#fff7ed",textAlign:"center",fontWeight:800},children:qe[String(_n)]??""},`v_caa_cell_${dt.id}_${_n}`)):a.jsx("td",{style:{...Gr,textAlign:"center",color:"#6b7280"},children:""}):null,a.jsx("td",{style:{...Gr,textAlign:"right"},children:Pr==null?"":Pr.toFixed(1)}),a.jsx("td",{style:{...Gr,textAlign:"right"},children:vp(Pr,zt)}),a.jsx("td",{style:{...Gr,textAlign:"right"},children:Kr==null?"":Kr.toFixed(1)}),a.jsx("td",{style:{...Gr,textAlign:"right"},children:vp(Kr,yt)}),Dt.map(_n=>{const kn=pn[_n]??null;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Gr,textAlign:"right"},children:kn==null?"":kn.toFixed(1)}),a.jsx("td",{style:{...Gr,textAlign:"right"},children:vp(kn,St)})]},`v_btl_${dt.id}_${_n}`)})]},`v_${dt.id}`)}),h.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Ie,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})})(),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>G(!1),children:"Close"})})]})}):null]})}new URL("https://static.vecteezy.com/system/resources/thumbnails/014/585/778/small/gold-locked-padlock-png.png",import.meta.url).href;const EM={co1:42,co2:42,co3:58,co4:42,co5:42},Cxe={1:9,2:9,3:4.5},Exe={1:3,2:3,3:1.5},wp={1:20,2:20,3:10},Rk={1:12,2:12,3:6},Bk={1:9,2:9,3:4.5,4:9,5:9},kd={1:0,2:0,3:0,4:20,5:20},Pi=5,ea=25,Oh=30;function tn(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function TM(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,e)):t}function Mh(e){return Math.round(e*10)/10}function Txe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function As(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function Ru(e,t,r=1){const n=Array.isArray(e)?e:[],i=[];for(let s=0;s<t;s++){const o=n[s];if(o===""||o==null){i.push(r);continue}const l=typeof o=="number"?o:Number(o);i.push(Number.isFinite(l)&&l>=1&&l<=6?Math.trunc(l):r)}return i}function Yb(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Xb(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function PM(e){return e.reduce((t,r)=>t+(typeof r=="number"&&Number.isFinite(r)?r:0),0)}function Qb(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Fk(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Ik(e,t,r){return!Number.isFinite(e)||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0?0:Math.max(0,e)/t*r}function Pxe(e,t,r){const n=Number(r[t]??0);if(n<=0)return 0;const i=e[String(t)];return typeof i!="number"||!Number.isFinite(i)?0:Math.max(0,Math.min(i,n))}function OM(e,t=7){const r=String(e??"").trim();return r?r.length<=t?r:r.slice(-t):""}function Oxe(e,t){return`${e}_sheet_${t}`}function Ix({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:i,coB:s,skipMarkManager:o=!1,initialEnabledCos:l,itemLabel:c,itemLabelPlural:u,itemAbbrev:d,ciaExamAvailable:f,absentEnabled:h,autoSaveDraft:p,autoSaveDelayMs:m,viewerMode:g,floatPanelOnTable:y}){const[b,v]=x.useState([]),[w,S]=x.useState(!1),[k,j]=x.useState(null),[A,L]=x.useState(null),[P,B]=x.useState(!1),[E,T]=x.useState(null),[F,W]=x.useState(null),[z,se]=x.useState(!1),[de,U]=x.useState(null),[G,re]=x.useState(!1),[X,C]=x.useState(!1),[K,V]=x.useState(""),[R,J]=x.useState(!1),[q,Y]=x.useState(""),[Q,ie]=x.useState(!1),[le,O]=x.useState(null),[H,ae]=x.useState(null),[I,Z]=x.useState(!1),[pe,Oe]=x.useState(null),[Ae,ke]=x.useState(!1),[_e,De]=x.useState(null),[We,Ct]=x.useState(!1),[_t,Xe]=x.useState(null),[nt,Ne]=x.useState(!1),[be,fe]=x.useState(null),[ge,lt]=x.useState(null),He=String(c||"Experiment"),mt=String(u||"Experiments"),wt=String(d||"E"),Pt=f!==!1,bt=!!(h??r==="model"),qr=!!p,Tt=tn(Number(m??900),250,5e3),xr=x.useMemo(()=>{const Pe=(Array.isArray(l)&&l.length?l:[i,s].filter(et=>typeof et=="number"&&Number.isFinite(et))).map(et=>tn(Number(et),1,5));return Array.from(new Set(Pe)).sort((et,xe)=>et-xe)},[i,s,l]),Zr=x.useMemo(()=>new Set(xr.map(me=>String(me))),[xr]),Xr=x.useRef(null),Br=x.useRef(null),Vr=x.useMemo(()=>e?Oxe(r,String(e)):"",[r,e]),{data:An,publishAllowed:Yr,remainingSeconds:Ln,refresh:Me}=H0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:Ce,refresh:It}=V0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ft}=nc({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:Ot,refresh:er}=nc({assessment:r,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[hr,Tr]=x.useState(null),ne=!!de||!!(Ce!=null&&Ce.exists&&(Ce!=null&&Ce.is_published)),ce=Ce!=null&&Ce.mark_entry_unblocked_until?String(Ce.mark_entry_unblocked_until):null,te=Ce!=null&&Ce.mark_manager_unlocked_until?String(Ce.mark_manager_unlocked_until):null,ue=!!ce&&!!(Ce!=null&&Ce.entry_open)&&(hr==null||ce!==(hr.markEntryUnblockedUntil??null)),Ee=!!te&&(hr==null||te!==(hr.markManagerUnlockedUntil??null)),je=ne?!!(Ce!=null&&Ce.entry_open)&&(hr==null||ue||Ee):!0,gt=!!(ne&&!je),Qe=!!(ne&&gt&&!g),{pending:Fe,pendingUntilMs:$e,setPendingUntilMs:st,refresh:Wt}=G0({enabled:!!Qe&&!!e,assessment:r,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!_e||G||X||be&&be.visible||ge&&ge.visible);const qt=!!(An!=null&&An.global_override_active&&(An==null?void 0:An.global_is_open)===!1),[ht,Ut]=x.useState(()=>({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:tn(Number(i??1),1,5),coBNum:s==null?null:tn(Number(s),1,5),coAEnabled:!0,coBEnabled:!!s,ciaExamEnabled:!!Pt,expCountA:Pi,expCountB:s?Pi:0,expMaxA:ea,expMaxB:s?ea:0,btlA:Array.from({length:Pi},()=>1),btlB:s?Array.from({length:Pi},()=>1):[],coConfigs:Object.fromEntries((Array.isArray(l)&&l.length?l:[i,s].filter(me=>typeof me=="number"&&Number.isFinite(me))).map(me=>tn(Number(me),1,5)).filter((me,Pe,et)=>et.indexOf(me)===Pe).map(me=>[String(me),{enabled:!0,expCount:Pi,expMax:ea,btl:Array.from({length:Pi},()=>1)}])),rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null}}));x.useEffect(()=>{if(!xr.length||ht.sheet.markManagerSnapshot)return;const me=ht.sheet.coConfigs&&typeof ht.sheet.coConfigs=="object"?ht.sheet.coConfigs:{},Pe=xr.filter(et=>!me[String(et)]);Pe.length&&Ut(et=>{const ze={...et.sheet.coConfigs&&typeof et.sheet.coConfigs=="object"?et.sheet.coConfigs:{}};for(const Vt of Pe)ze[String(Vt)]={enabled:!0,expCount:Pi,expMax:ea,btl:Array.from({length:Pi},()=>1)};return{...et,sheet:{...et.sheet,coConfigs:ze}}})},[ht.sheet.coConfigs,ht.sheet.markManagerSnapshot,xr]);const[Gt,cr]=x.useState(null),ir=x.useMemo(()=>ti(Gt),[Gt]),Fr=x.useMemo(()=>N3(Gt),[Gt]),dn=x.useMemo(()=>ir==="LAB"||ir==="TCPL"||ir==="TCPR"||ir==="PRACTICAL"||ir==="PROJECT",[ir]),vr=ir==="LAB",Lt=dn&&!vr;x.useEffect(()=>{let me=!0;return(async()=>{try{const Pe=await vu();if(!me)return;Ut(et=>({...et,sheet:{...et.sheet,termLabel:String((Pe==null?void 0:Pe.termLabel)||et.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e||et.sheet.batchLabel||"")}}))}catch{}})(),()=>{me=!1}},[e]),x.useEffect(()=>{let me=!0;return(async()=>{if(e)try{const Pe=String(e).trim().toUpperCase(),et=await bl();if(!me)return;const xe=(et||[]).find(Nt=>String(Nt.course_code||"").trim().toUpperCase()===Pe);if(xe&&(xe!=null&&xe.class_type)){cr((xe==null?void 0:xe.class_type)??null);return}const ze=await Kd();if(!me)return;const Vt=(ze||[]).find(Nt=>String(Nt.course_code||"").trim().toUpperCase()===Pe);cr((Vt==null?void 0:Vt.class_type)??null)}catch{me&&cr(null)}})(),()=>{me=!1}},[e]),x.useEffect(()=>{let me=!0;return(async()=>{var Pe,et;if(e)try{const xe=await ei(r,String(e));if(!me)return;const ze=xe==null?void 0:xe.draft;if(ze&&typeof ze=="object"&&ze.sheet&&typeof ze.sheet=="object"){const Vt=tn(Number(i??1),1,5),Nt=s==null?null:tn(Number(s),1,5),br=Vt,wr=Nt,zr=!!(ze.sheet.coAEnabled??!0),Wr=!!(ze.sheet.coBEnabled??!!wr),sn=Pt?!!(ze.sheet.ciaExamEnabled??!0):!1,an=tn(Number(ze.sheet.expCountA??Pi),0,12),Lr=tn(Number(ze.sheet.expCountB??(Wr?Pi:0)),0,12),mn=Number.isFinite(Number(ze.sheet.expMaxA))?Number(ze.sheet.expMaxA):ea,cn=Number.isFinite(Number(ze.sheet.expMaxB))?Number(ze.sheet.expMaxB):Wr?ea:0,xn=Ru(ze.sheet.btlA,an,1),Ir=Ru(ze.sheet.btlB,Lr,1),jn=ze.sheet.coConfigs,Hn={};if(jn&&typeof jn=="object")for(const xa of Object.keys(jn)){const oa=jn[xa]||{},la=tn(Number(oa.expCount??Pi),0,12);Hn[xa]={enabled:!!oa.enabled,expCount:la,expMax:Number.isFinite(Number(oa.expMax))?Number(oa.expMax):ea,btl:Ru(oa.btl,la,1)}}const Mn=String(br);if(Hn[Mn]||(Hn[Mn]={enabled:zr,expCount:an,expMax:mn,btl:xn}),wr!=null){const xa=String(wr);Hn[xa]||(Hn[xa]={enabled:Wr,expCount:Lr,expMax:cn,btl:Ir})}const Kn=!!(((Pe=Hn[String(br)])==null?void 0:Pe.enabled)??zr),Fn=!!(wr!=null&&(((et=Hn[String(wr)])==null?void 0:et.enabled)??Wr)),Xi=xa=>{const oa=xa&&typeof xa=="object"?xa:{},la={};for(const[ya,qo]of Object.entries(oa)){const gi=qo&&typeof qo=="object"?qo:{},Js=gi!=null&&gi.marksByCo&&typeof gi.marksByCo=="object"?{...gi.marksByCo}:{},uc=As(gi==null?void 0:gi.marksA,an),dc=As(gi==null?void 0:gi.marksB,Lr),ki=As(Js[Mn],an),Ei=wr!=null?As(Js[String(wr)],Lr):[],Qi=md=>md.some(ku=>ku!==""&&ku!=null),yo=Qi(uc)?uc:Qi(ki)?ki:uc,pd=Lr?Qi(dc)?dc:Qi(Ei)?Ei:dc:dc;Js[Mn]=ki,wr!=null&&(Js[String(wr)]=Ei),la[String(ya)]={...gi,studentId:Number.isFinite(Number(gi==null?void 0:gi.studentId))?Number(gi.studentId):Number(ya),marksA:yo,marksB:pd,marksByCo:Js,caaExamByCo:Qb(gi==null?void 0:gi.caaExamByCo),ciaExamByCo:Fk(gi==null?void 0:gi.ciaExamByCo)}}return la},zo=ze.sheet.markManagerSnapshot??null,Ol=ze.sheet.markManagerApprovalUntil??null,Ya=ze.sheet.markManagerLocked,Wo=typeof Ya=="boolean"?Ya:!!zo;Ut({sheet:{termLabel:String(ze.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e),coANum:br,coBNum:wr,coAEnabled:Kn,coBEnabled:Fn,ciaExamEnabled:sn,expCountA:an,expCountB:Lr,expMaxA:mn,expMaxB:cn,btlA:xn,btlB:Ir,coConfigs:Hn,rowsByStudentId:Xi(ze.sheet.rowsByStudentId),markManagerLocked:Wo,markManagerSnapshot:zo,markManagerApprovalUntil:Ol}});const Ml=(xe==null?void 0:xe.updated_at)??null,dl=(xe==null?void 0:xe.updated_by)??null;if(Ml)try{T(new Date(String(Ml)).toLocaleString())}catch{T(String(Ml))}dl&&W(String(dl.name||dl.username||dl.id||""));try{Vr&&Gn(Vr,{rowsByStudentId:ze.sheet.rowsByStudentId||{}})}catch{}}else{const Vt=Vr?Jn(Vr):null,Nt=Vt!=null&&Vt.rowsByStudentId&&typeof Vt.rowsByStudentId=="object"?Vt.rowsByStudentId:{},br=tn(Number(i??1),1,5),wr=s==null?null:tn(Number(s),1,5),zr=Pi,Wr=wr!=null?Pi:0,sn=ea,an=wr!=null?ea:0,Lr=Array.from({length:zr},()=>1),mn=wr!=null?Array.from({length:Wr},()=>1):[],cn={[String(br)]:{enabled:!0,expCount:zr,expMax:sn,btl:Lr},...wr==null?{}:{[String(wr)]:{enabled:!0,expCount:Wr,expMax:an,btl:mn}}};Ut({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:br,coBNum:wr,coAEnabled:!0,coBEnabled:!!wr,ciaExamEnabled:!!Pt,expCountA:zr,expCountB:Wr,expMaxA:sn,expMaxB:an,btlA:Lr,btlB:mn,coConfigs:cn,rowsByStudentId:Nt,markManagerLocked:!1,markManagerSnapshot:null}})}}catch{}})(),()=>{me=!1}},[r,e,Vr,i,s]),x.useEffect(()=>{let me=!0;return(async()=>{var Pe,et,xe;if(!t){v([]);return}S(!0),j(null);try{let ze=null;try{const Nt=await yr(`/api/academics/teaching-assignments/${t}/`);if(Nt.ok){const br=await Nt.json();if(br&&br.elective_subject_id&&!br.section_id){const wr=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(br.elective_subject_id))}`);if(wr.ok){const zr=await wr.json();ze=(Array.isArray(zr.results)?zr.results:Array.isArray(zr)?zr:zr.items||[]).map(sn=>({id:Number(sn.student_id??sn.id),reg_no:String(sn.reg_no??sn.regno??""),name:String(sn.name??sn.full_name??sn.username??""),section:sn.section_name??sn.section??null}))}}}}catch{}if(!ze){const Nt=await qc(t);L({courseName:String(((Pe=Nt==null?void 0:Nt.teaching_assignment)==null?void 0:Pe.subject_name)||""),courseCode:String(((et=Nt==null?void 0:Nt.teaching_assignment)==null?void 0:et.subject_code)||e||""),className:String(((xe=Nt==null?void 0:Nt.teaching_assignment)==null?void 0:xe.section_name)||"")}),ze=((Nt==null?void 0:Nt.students)||[]).map(wr=>({id:Number(wr.id),reg_no:String(wr.reg_no??""),name:String(wr.name??""),section:wr.section??null}))}if(!me)return;const Vt=(ze||[]).filter(Nt=>Number.isFinite(Nt.id)).sort(Txe);v(Vt),Ut(Nt=>{const br=tn(Number(Nt.sheet.expCountA??Pi),0,12),wr=tn(Number(Nt.sheet.expCountB??0),0,12),zr={...Nt.sheet.rowsByStudentId||{}};for(const Wr of Vt){const sn=String(Wr.id);zr[sn]||(zr[sn]={studentId:Wr.id,absent:!1,absentKind:void 0,marksA:Array.from({length:br},()=>""),marksB:Array.from({length:wr},()=>""),marksByCo:{},caaExamByCo:{},ciaExamByCo:{},ciaExam:""})}return{...Nt,sheet:{...Nt.sheet,rowsByStudentId:zr}}})}catch(ze){if(!me)return;v([]),j((ze==null?void 0:ze.message)||"Failed to load roster")}finally{me&&S(!1)}})(),()=>{me=!1}},[t]),x.useEffect(()=>{if(Vr)try{Gn(Vr,{rowsByStudentId:ht.sheet.rowsByStudentId})}catch{}},[ht.sheet.rowsByStudentId,Vr]),x.useEffect(()=>{if(!e||!!!ht.sheet.markManagerSnapshot)return;if(ne&&(Ce!=null&&Ce.exists)){const xe=!!(Ce!=null&&Ce.mark_manager_locked);!!ht.sheet.markManagerLocked!==xe&&Ut(ze=>({...ze,sheet:{...ze.sheet,markManagerLocked:xe}}));return}const Pe=!!(ft!=null&&ft.allowed_by_approval),et=ft!=null&&ft.approval_until?String(ft.approval_until):null;if(Pe&&et){const xe=ht.sheet.markManagerApprovalUntil?String(ht.sheet.markManagerApprovalUntil):null;ht.sheet.markManagerLocked&&xe!==et&&Ut(ze=>({...ze,sheet:{...ze.sheet,markManagerLocked:!1,markManagerApprovalUntil:et}}));return}ht.sheet.markManagerLocked||Ut(xe=>({...xe,sheet:{...xe.sheet,markManagerLocked:!0}}))},[e,ne,Ce==null?void 0:Ce.exists,Ce==null?void 0:Ce.mark_manager_locked,ft==null?void 0:ft.allowed_by_approval,ft==null?void 0:ft.approval_until,ht.sheet.markManagerLocked,ht.sheet.markManagerSnapshot,ht.sheet.markManagerApprovalUntil]);const Gr=tn(Number(ht.sheet.coANum??i??1),1,5),bn=ht.sheet.coBNum??s??null,or=bn==null?null:tn(Number(bn),1,5),kr=x.useMemo(()=>[1,2,3,4,5],[]),Mr=x.useMemo(()=>new Set(kr.map(me=>String(me))),[kr]);tn(Number(ht.sheet.expCountA??Pi),0,12),tn(Number(ht.sheet.expCountB??0),0,12),ht.sheet.coAEnabled,ht.sheet.coBEnabled&&or!=null;const Ar=x.useMemo(()=>ur(ht.sheet),[ht.sheet]),Zt=!!ht.sheet.markManagerLocked,Kt=Pt?ht.sheet.ciaExamEnabled!==!1:!1;x.useMemo(()=>Ve(Ar,Kt),[Ar,Kt]);const it=!je,At=x.useMemo(()=>Object.entries(Ar||{}).filter(([me,Pe])=>Mr.has(String(me))&&!!(Pe&&Pe.enabled)).map(([me,Pe])=>({coNumber:Number(me),expCount:tn(Number(Pe.expCount??0),0,12),expMax:tn(Number(Pe.expMax??0),0,100),btl:Pe.btl??[]})),[Ar,Mr]),Mt=x.useMemo(()=>At.reduce((me,Pe)=>me+Pe.expCount,0),[At]),ar=Math.max(Mt,1),Ge=At.length>0,Rt=x.useMemo(()=>At.filter(me=>Number.isFinite(Number(wp[me.coNumber]))),[At]),Ze=Rt.length,ot=x.useMemo(()=>vr&&Kt?At.filter(me=>Number(kd[me.coNumber]||0)>0):[],[At,vr,Kt]),Bt=vr?Kt?ot.length:0:Kt?Lt?Math.max(Ze,1):1:0,Qt=Ge?At.length*2:2,Yt=x.useMemo(()=>At.reduce((me,Pe)=>Math.max(me,Pe.expMax),0),[At]);x.useMemo(()=>{if(!bt)return!1;const me=ht.sheet.rowsByStudentId||{};return Object.values(me).some(Pe=>!!(Pe!=null&&Pe.absent))},[bt,ht.sheet.rowsByStudentId]);function fr(me,Pe){const et=me==null?void 0:me.marksByCo;return Pe.map(xe=>{const ze=et&&typeof et=="object"?et[String(xe.coNumber)]:void 0,Vt=xe.coNumber===Gr?me==null?void 0:me.marksA:xe.coNumber===or?me==null?void 0:me.marksB:void 0,Nt=As(ze??Vt,xe.expCount);return{coNumber:xe.coNumber,expCount:xe.expCount,expMax:xe.expMax,marks:Nt}})}function Dt(me,Pe){const et=Qb(me==null?void 0:me.caaExamByCo),xe=Fk(me==null?void 0:me.ciaExamByCo),ze=Kt&&typeof(me==null?void 0:me.ciaExam)=="number"&&Number.isFinite(me==null?void 0:me.ciaExam)?Number(me==null?void 0:me.ciaExam):null;if(vr){const zr=Pe.map(an=>{const Lr=PM(an.marks),mn=Math.max(0,an.expCount)*Math.max(0,an.expMax),cn=Number(Bk[an.coNumber]||0),xn=Kt?Pxe(xe,an.coNumber,kd):0,Ir=Ik(Lr,mn,cn),Hn=Lr>0||xn>0?Mh(Ir+xn):null,Mn=Mh(cn+(Kt?Number(kd[an.coNumber]||0):0));return{coNumber:an.coNumber,mark:Hn,coMax:Mn}}),Wr=zr.reduce((an,Lr)=>an+(typeof Lr.mark=="number"&&Number.isFinite(Lr.mark)?Lr.mark:0),0),sn=zr.some(an=>typeof an.mark=="number"&&Number.isFinite(an.mark));return{caaByCo:et,ciaByCo:xe,ciaExamNumLegacy:ze,coAttainmentValues:zr,hasAnyMarks:sn,finalTotal:sn?Mh(Wr):""}}if(Lt){let zr=0,Wr=!1;const sn=Pe.map(an=>{const Lr=PM(an.marks),mn=Math.max(0,an.expCount)*Math.max(0,an.expMax),cn=Number(Cxe[an.coNumber]||0),xn=Number(Exe[an.coNumber]||0),Ir=Number(wp[an.coNumber]||0),jn=Number(Rk[an.coNumber]||0),Hn=Ik(Lr,mn,cn),Mn=et[String(an.coNumber)],Kn=typeof Mn=="number"&&Number.isFinite(Mn)?Mn:0,Fn=Ik(Kn,Ir,xn),Xi=Hn+Fn;return(Lr>0||Kn>0)&&(Wr=!0),zr+=Xi,{coNumber:an.coNumber,mark:Wr?Xi:null,coMax:jn}});return{caaByCo:et,ciaByCo:xe,ciaExamNumLegacy:ze,coAttainmentValues:sn.map(an=>({...an,mark:Wr?an.mark:null})),hasAnyMarks:Wr,finalTotal:Wr?Mh(zr):""}}const Vt=Pe.flatMap(zr=>zr.marks),Nt=Yb(Vt),br=Nt!=null||Kt&&ze!=null,wr=Pe.map(zr=>{const Wr=Yb(zr.marks),sn=br?(Wr??0)+(Kt?(ze??0)/2:0):null,an=EM[`co${zr.coNumber}`],Lr=Array.from({length:tn(Number(zr.expCount??0),0,12)}).map(()=>tn(Number(zr.expMax??ea),0,100)),mn=Lr.length?Lr.reduce((Ir,jn)=>Ir+jn,0)/Lr.length:0,cn=Fr&&Number.isFinite(Number(an))?Number(an):mn,xn=Math.round(cn+(Kt?Oh/2:0)||0);return{coNumber:zr.coNumber,mark:sn,coMax:xn}});return{caaByCo:et,ciaByCo:xe,ciaExamNumLegacy:ze,coAttainmentValues:wr,hasAnyMarks:br,finalTotal:Nt==null&&ze==null?"":Mh((Nt??0)+(ze??0))}}x.useMemo(()=>!g&&ne&&!je?[]:!bt||!Ae?b:b.filter(me=>{var Pe,et;return!!((et=(Pe=ht.sheet.rowsByStudentId)==null?void 0:Pe[String(me.id)])!=null&&et.absent)}),[g,ne,je,bt,b,Ae,ht.sheet.rowsByStudentId]),x.useEffect(()=>{if(!qr||!e||it||gt)return;Br.current!=null&&(window.clearTimeout(Br.current),Br.current=null);const me=JSON.stringify(ht);if(me!==Xr.current)return Br.current=window.setTimeout(async()=>{if(e)try{B(!0),await Mi(r,String(e),ht),Xr.current=me,T(new Date().toLocaleString())}catch{}finally{B(!1)}},Tt),()=>{Br.current!=null&&(window.clearTimeout(Br.current),Br.current=null)}},[qr,Tt,r,ht,gt,e,it]);function ur(me){const et={...me.coConfigs&&typeof me.coConfigs=="object"?me.coConfigs:{}};for(const xe of[1,2,3,4,5]){const ze=String(xe),Vt=et[ze];if(!Vt)et[ze]={enabled:Zr.has(ze),expCount:Pi,expMax:ea,btl:Array.from({length:Pi},()=>1)};else{const Nt=tn(Number(Vt.expCount??Pi),0,12);et[ze]={enabled:!!Vt.enabled,expCount:Nt,expMax:tn(Number(Vt.expMax??ea),0,100),btl:Ru(Vt.btl,Nt,1)}}}return et}function Ve(me,Pe){const et=Object.entries(me).filter(([xe,ze])=>Mr.has(String(xe))&&!!(ze!=null&&ze.enabled)).map(([xe,ze])=>({co:tn(Number(xe),1,5),expCount:tn(Number((ze==null?void 0:ze.expCount)??0),0,12),expMax:tn(Number((ze==null?void 0:ze.expMax)??0),0,100)})).sort((xe,ze)=>xe.co-ze.co);return JSON.stringify({enabled:et,ciaExamEnabled:!!Pe})}function zt(me){if(!me)return null;try{const Pe=JSON.parse(String(me)),et=Array.isArray(Pe==null?void 0:Pe.enabled)?Pe.enabled:[],xe={};for(const ze of[1,2,3,4,5])xe[String(ze)]={enabled:!1,expCount:Pi,expMax:ea,btl:Array.from({length:Pi},()=>1)};for(const ze of et){const Vt=tn(Number(ze==null?void 0:ze.co),1,5);xe[String(Vt)]={...xe[String(Vt)],enabled:!0,expCount:tn(Number((ze==null?void 0:ze.expCount)??Pi),0,12),expMax:tn(Number((ze==null?void 0:ze.expMax)??ea),0,100)}}return xe}catch{return null}}function yt(me,Pe,et,xe){if(!me)return 0;const ze=new Set(Pe.map(Nt=>String(Nt)));let Vt=0;for(const Nt of Object.values(me)){if(!Nt||typeof Nt!="object")continue;const br=Nt.marksByCo&&typeof Nt.marksByCo=="object"?Nt.marksByCo:{};let wr=!1;for(const zr of Pe){const Wr=String(zr);if(!ze.has(Wr))continue;const sn=br[Wr];if(Array.isArray(sn)&&sn.some(an=>an!==""&&an!=null)){wr=!0;break}if(!wr&&zr===et&&Array.isArray(Nt.marksA)&&Nt.marksA.some(an=>an!==""&&an!=null)&&(wr=!0),!wr&&xe!=null&&zr===xe&&Array.isArray(Nt.marksB)&&Nt.marksB.some(an=>an!==""&&an!=null)&&(wr=!0),wr)break}wr&&Vt++}return Vt}function St(me){return Object.entries(me).filter(([Pe,et])=>Mr.has(String(Pe))&&!!(et!=null&&et.enabled)).map(([Pe])=>tn(Number(Pe),1,5)).sort((Pe,et)=>Pe-et)}function sr(me,Pe){const et=[],xe=[],ze=[];for(const Vt of[1,2,3,4,5]){const Nt=String(Vt),br=me[Nt],wr=Pe[Nt],zr=!!(br!=null&&br.enabled),Wr=!!(wr!=null&&wr.enabled);if(!br&&wr){Wr&&et.push(Vt);continue}if(br&&!wr){zr&&xe.push(Vt);continue}if(br&&wr){const sn=tn(Number(br.expCount??0),0,12),an=tn(Number(wr.expCount??0),0,12),Lr=tn(Number(br.expMax??0),0,100),mn=tn(Number(wr.expMax??0),0,100);(zr!==Wr||sn!==an||Lr!==mn)&&ze.push(Vt)}}return{added:et,removed:xe,changed:ze}}function pr(me,Pe){if(!me)return 0;let et=0;for(const xe of Object.values(me)){if(!xe||typeof xe!="object")continue;if(Array.isArray(xe.marksA)&&xe.marksA.some(br=>br!==""&&br!=null)||Array.isArray(xe.marksB)&&xe.marksB.some(br=>br!==""&&br!=null)||xe.ciaExam!==""&&xe.ciaExam!=null){et++;continue}const Vt=xe.marksByCo&&typeof xe.marksByCo=="object"?xe.marksByCo:{};let Nt=!1;for(const br of Pe){const wr=Vt[String(br)];if(Array.isArray(wr)&&wr.some(zr=>zr!==""&&zr!=null)){Nt=!0;break}}Nt&&et++}return et}function we(me){Ut(Pe=>!Pt||Pe.sheet.markManagerLocked?Pe:{...Pe,sheet:{...Pe.sheet,ciaExamEnabled:!!me}})}function Ie(me,Pe){Ut(et=>{var br;const xe=String(me),ze=(br=et.sheet.rowsByStudentId)==null?void 0:br[xe];if(!ze)return et;const Vt=tn(Number(et.sheet.expCountA??Pi),0,12),Nt=tn(Number(et.sheet.expCountB??0),0,12);return Pe?{...et,sheet:{...et.sheet,rowsByStudentId:{...et.sheet.rowsByStudentId,[xe]:{...ze,absent:!0,absentKind:ze.absentKind||"AL",marksA:Array.from({length:Vt},()=>""),marksB:Array.from({length:Nt},()=>""),caaExamByCo:{},ciaExamByCo:{},ciaExam:""}}}}:{...et,sheet:{...et.sheet,rowsByStudentId:{...et.sheet.rowsByStudentId,[xe]:{...ze,absent:!1,absentKind:void 0}}}}})}function tt(me,Pe){Ut(et=>{var Vt;const xe=String(me),ze=(Vt=et.sheet.rowsByStudentId)==null?void 0:Vt[xe];return ze?{...et,sheet:{...et.sheet,rowsByStudentId:{...et.sheet.rowsByStudentId,[xe]:{...ze,absent:!0,absentKind:Pe}}}}:et})}function dt(me,Pe){const et=tn(Number(me),1,5);Ut(xe=>{if(xe.sheet.markManagerLocked)return xe;const ze=ur(xe.sheet),Vt=String(et),Nt=ze[Vt],br=tn(Number((Nt==null?void 0:Nt.expCount)??Pi),0,12),wr=tn(Number((Nt==null?void 0:Nt.expMax)??ea),0,100),zr=Ru((Nt==null?void 0:Nt.btl)??[],br,1);ze[Vt]={enabled:!!Pe,expCount:br,expMax:wr,btl:zr};const Wr=tn(Number(xe.sheet.coANum??i??1),1,5),sn=xe.sheet.coBNum??s??null,an=sn==null?null:tn(Number(sn),1,5),Lr={...xe.sheet,coConfigs:ze};return et===Wr&&(Lr.coAEnabled=!!Pe),an!=null&&et===an&&(Lr.coBEnabled=!!Pe),{...xe,sheet:Lr}})}async function xt(){if(!e)return;Ct(!0),Xe(null);const me=new Date,Pe=Ce!=null&&Ce.mark_manager_unlocked_until?String(Ce.mark_manager_unlocked_until):null;try{const et=await nl({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t});alert(il(et));const xe=Number(et==null?void 0:et.id),ze=me.getTime()-2e3;(async()=>{for(let br=0;br<36;br++){try{const wr=await Lm({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),zr=wr==null?void 0:wr.result;if(!zr)throw new Error("No status");if(Number.isFinite(xe)&&xe>0&&Number(zr.id)!==xe)throw new Error("Different request");const Wr=zr.reviewed_at?new Date(String(zr.reviewed_at)).getTime():0,sn=String(zr.status||"").toUpperCase();if(sn==="APPROVED"&&Wr>=ze){try{It({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}if(sn==="REJECTED"&&Wr>=ze){alert("IQAC rejected the mark-manager edit request.");return}}catch{try{const wr=Ce!=null&&Ce.mark_manager_unlocked_until?String(Ce.mark_manager_unlocked_until):null;if(wr&&Pe&&wr!==Pe){try{It({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(wr=>setTimeout(wr,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(et){const xe=al(et,"Request failed");Xe(xe),alert(`Edit request failed: ${xe}`)}finally{Ct(!1)}}async function Cr(me,Pe=[]){if(e){Ct(!0),Xe(null);try{const et=tn(Number(i??1),1,5),xe=s==null?null:tn(Number(s),1,5),ze=Ve(Ar,Kt),Vt=ft!=null&&ft.approval_until?String(ft.approval_until):ht.sheet.markManagerApprovalUntil||null,Nt=Ar[String(et)],br=xe==null?null:Ar[String(xe)],wr=!!(Nt!=null&&Nt.enabled),zr=!!(xe!=null&&(br!=null&&br.enabled)),Wr=tn(Number((Nt==null?void 0:Nt.expCount)??ht.sheet.expCountA??Pi),0,12),sn=tn(Number((Nt==null?void 0:Nt.expMax)??ht.sheet.expMaxA??ea),0,100),an=Ru((Nt==null?void 0:Nt.btl)??ht.sheet.btlA,Wr,1),Lr=xe==null?0:tn(Number((br==null?void 0:br.expCount)??ht.sheet.expCountB??Pi),0,12),mn=xe==null?0:tn(Number((br==null?void 0:br.expMax)??ht.sheet.expMaxB??ea),0,100),cn=xe==null?[]:Ru((br==null?void 0:br.btl)??ht.sheet.btlB,Lr,1),xn=new Set(me==="full"?[1,2,3,4,5].map(String):me==="partial"?Pe.map(Mn=>String(tn(Number(Mn),1,5))):[]),Ir=(Mn,Kn,Fn)=>{const Xi=Mn!=null&&Mn.marksByCo&&typeof Mn.marksByCo=="object"?Mn.marksByCo:{};return As(Xi[Kn],Fn)},jn=Mn=>Mn.some(Kn=>Kn!==""&&Kn!=null),Hn={...ht,sheet:{...ht.sheet,coANum:et,coBNum:xe,coAEnabled:wr,coBEnabled:zr,expCountA:Wr,expCountB:Lr,expMaxA:sn,expMaxB:mn,btlA:an,btlB:cn,coConfigs:Ar,markManagerLocked:!0,markManagerSnapshot:ze,markManagerApprovalUntil:Vt,rowsByStudentId:Object.fromEntries(Object.entries(ht.sheet.rowsByStudentId||{}).map(([Mn,Kn])=>{const Fn=Kn&&typeof Kn=="object"?Kn:{};let Xi=Fn!=null&&Fn.marksByCo&&typeof Fn.marksByCo=="object"?{...Fn.marksByCo}:{};if(me==="full")Xi={},Fn.marksA=Array.from({length:Wr},()=>""),Fn.marksB=Array.from({length:Lr},()=>""),Fn.caaExamByCo={},Fn.ciaExamByCo={},Fn.ciaExam="";else if(me==="partial"&&xn.size){const xa=Qb(Fn.caaExamByCo);for(const oa of Array.from(xn)){const la=Ar[String(oa)],ya=tn(Number((la==null?void 0:la.expCount)??0),0,12);ya>0?Xi[String(oa)]=Array.from({length:ya},()=>""):delete Xi[String(oa)],Object.prototype.hasOwnProperty.call(xa,String(oa))&&(xa[String(oa)]=""),Number(oa)===et&&(Fn.marksA=Array.from({length:Wr},()=>"")),xe!=null&&Number(oa)===xe&&(Fn.marksB=Array.from({length:Lr},()=>""))}Fn.caaExamByCo=xa}const zo=As(Fn==null?void 0:Fn.marksA,Wr),Ol=As(Fn==null?void 0:Fn.marksB,Lr),Ya=As(Xi[String(et)]??Ir(Fn,String(et),Wr),Wr),Wo=xe==null?[]:As(Xi[String(xe)]??Ir(Fn,String(xe),Lr),Lr),Ml=jn(zo)?zo:jn(Ya)?Ya:zo,dl=Lr?jn(Ol)?Ol:jn(Wo)?Wo:Ol:Ol;return Xi[String(et)]=Ya,xe!=null&&(Xi[String(xe)]=Wo),[Mn,{...Fn,marksA:Ml,marksB:dl,marksByCo:Xi}]}))}};Ut(Hn),De(null),lt(null),Ne(!0),await Mi(r,String(e),Hn),T(new Date().toLocaleString());try{await uh(r,String(e),t),It({silent:!0})}catch(Mn){console.warn("confirmMarkManagerLock failed",Mn)}}catch(et){Xe((et==null?void 0:et.message)||"Save failed")}finally{Ct(!1),setTimeout(()=>Ne(!1),2e3)}}}function nn(me,Pe){const et=tn(Number(Pe),0,12);Ut(xe=>{if(xe.sheet.markManagerLocked)return xe;const ze=ur(xe.sheet),Vt=String(me),Nt=ze[Vt],br=tn(Number((Nt==null?void 0:Nt.expMax)??ea),0,100);ze[Vt]={enabled:!!((Nt==null?void 0:Nt.enabled)??!0),expCount:et,expMax:br,btl:Ru((Nt==null?void 0:Nt.btl)??[],et,1)};const wr=tn(Number(xe.sheet.coANum??i??1),1,5),zr=xe.sheet.coBNum??s??null,Wr=zr==null?null:tn(Number(zr),1,5),sn={...xe.sheet.rowsByStudentId||{}};for(const an of Object.keys(sn)){const Lr=sn[an],mn=Lr!=null&&Lr.marksByCo&&typeof Lr.marksByCo=="object"?{...Lr.marksByCo}:{};mn[Vt]=As(mn[Vt],et);const cn={...Lr,marksByCo:mn};me===wr&&(cn.marksA=As(Lr.marksA,et)),Wr!=null&&me===Wr&&(cn.marksB=As(Lr.marksB,et)),sn[an]=cn}return{...xe,sheet:{...xe.sheet,coConfigs:ze,expCountA:me===wr?et:xe.sheet.expCountA,expCountB:me===Wr?et:xe.sheet.expCountB,btlA:me===wr?ze[Vt].btl:xe.sheet.btlA,btlB:me===Wr?ze[Vt].btl:xe.sheet.btlB,rowsByStudentId:sn}}})}function ct(me,Pe){const et=tn(Number(Pe),0,100);Ut(xe=>{if(xe.sheet.markManagerLocked)return xe;const ze=ur(xe.sheet),Vt=String(me),Nt=ze[Vt],br=tn(Number((Nt==null?void 0:Nt.expCount)??Pi),0,12);ze[Vt]={enabled:!!((Nt==null?void 0:Nt.enabled)??!0),expCount:br,expMax:et,btl:Ru((Nt==null?void 0:Nt.btl)??[],br,1)};const wr=tn(Number(xe.sheet.coANum??i??1),1,5),zr=xe.sheet.coBNum??s??null,Wr=zr==null?null:tn(Number(zr),1,5),sn=me===wr?et:tn(Number(xe.sheet.expMaxA??ea),0,100),an=me===Wr?et:tn(Number(xe.sheet.expMaxB??0),0,100),Lr=tn(Number(xe.sheet.expCountA??Pi),0,12),mn=tn(Number(xe.sheet.expCountB??0),0,12),cn={};for(const[xn,Ir]of Object.entries(xe.sheet.rowsByStudentId||{})){const jn=As(Ir.marksA,Lr).map(Kn=>typeof Kn=="number"?tn(Kn,0,sn):""),Hn=As(Ir.marksB,mn).map(Kn=>typeof Kn=="number"?tn(Kn,0,an):""),Mn=Ir!=null&&Ir.marksByCo&&typeof Ir.marksByCo=="object"?{...Ir.marksByCo}:{};Mn[Vt]=As(Mn[Vt],br).map(Kn=>typeof Kn=="number"?tn(Kn,0,et):""),cn[xn]={...Ir,marksA:jn,marksB:Hn,marksByCo:Mn}}return{...xe,sheet:{...xe.sheet,coConfigs:ze,expMaxA:sn,expMaxB:an,rowsByStudentId:cn}}})}function Ht(me,Pe,et){Ut(xe=>{if(xe.sheet.markManagerLocked)return xe;const ze=ur(xe.sheet),Vt=String(tn(Number(me),1,5)),Nt=ze[Vt],br=tn(Number((Nt==null?void 0:Nt.expCount)??Pi),0,12),wr=Ru((Nt==null?void 0:Nt.btl)??[],br,1);Pe>=0&&Pe<wr.length&&(wr[Pe]=et),ze[Vt]={enabled:!!((Nt==null?void 0:Nt.enabled)??!1),expCount:br,expMax:tn(Number((Nt==null?void 0:Nt.expMax)??ea),0,100),btl:wr};const zr=tn(Number(xe.sheet.coANum??i??1),1,5),Wr=xe.sheet.coBNum??s??null,sn=Wr==null?null:tn(Number(Wr),1,5);return{...xe,sheet:{...xe.sheet,coConfigs:ze,btlA:me===zr?wr:xe.sheet.btlA,btlB:me===sn?wr:xe.sheet.btlB}}})}function Ue(me,Pe,et,xe){Ut(ze=>{var Hn;const Vt=String(me),Nt=(Hn=ze.sheet.rowsByStudentId)==null?void 0:Hn[Vt];if(!Nt||bt&&r!=="model"&&Nt.absent)return ze;if(r==="model"){const Mn=!!Nt.absent,Kn=Mn?String(Nt.absentKind||"AL").toUpperCase():"";if(Mn&&!!!(Ae&&Mn&&(Kn==="ML"||Kn==="SKL")))return ze}const br=ur(ze.sheet),wr=String(tn(Number(Pe),1,5)),zr=br[wr],Wr=tn(Number((zr==null?void 0:zr.expCount)??0),0,12),sn=tn(Number((zr==null?void 0:zr.expMax)??ea),0,100),an=Nt!=null&&Nt.marksByCo&&typeof Nt.marksByCo=="object"?{...Nt.marksByCo}:{},Lr=As(an[wr],Wr),mn=xe===""?"":tn(Number(xe),0,sn);et>=0&&et<Lr.length&&(Lr[et]=mn),an[wr]=Lr;const cn=tn(Number(ze.sheet.coANum??i??1),1,5),xn=ze.sheet.coBNum??s??null,Ir=xn==null?null:tn(Number(xn),1,5),jn={...Nt,marksByCo:an};return Pe===cn&&(jn.marksA=As(Nt.marksA,Wr).map((Mn,Kn)=>Kn===et?mn:Mn)),Ir!=null&&Pe===Ir&&(jn.marksB=As(Nt.marksB,Wr).map((Mn,Kn)=>Kn===et?mn:Mn)),{...ze,sheet:{...ze.sheet,rowsByStudentId:{...ze.sheet.rowsByStudentId,[Vt]:jn}}}})}function qe(me,Pe){Ut(et=>{var Nt;const xe=String(me),ze=(Nt=et.sheet.rowsByStudentId)==null?void 0:Nt[xe];if(!ze||!Pt||bt&&r!=="model"&&ze.absent)return et;if(r==="model"){const br=!!ze.absent,wr=br?String(ze.absentKind||"AL").toUpperCase():"";if(br&&!!!(Ae&&br&&(wr==="ML"||wr==="SKL")))return et}if(vr)return et;const Vt=Pe===""?"":tn(Number(Pe),0,Oh);return{...et,sheet:{...et.sheet,rowsByStudentId:{...et.sheet.rowsByStudentId,[xe]:{...ze,ciaExam:Vt}}}}})}function at(me,Pe,et){Ut(xe=>{var Wr;if(vr)return xe;const ze=String(me),Vt=(Wr=xe.sheet.rowsByStudentId)==null?void 0:Wr[ze];if(!Vt||bt&&r!=="model"&&Vt.absent)return xe;if(r==="model"){const sn=!!Vt.absent,an=sn?String(Vt.absentKind||"AL").toUpperCase():"";if(sn&&!!!(Ae&&sn&&(an==="ML"||an==="SKL")))return xe}const Nt=String(tn(Number(Pe),1,5)),br=Number(wp[Number(Nt)]||0),wr=et===""?"":TM(Number(et),0,br>0?br:0),zr={...Qb(Vt==null?void 0:Vt.caaExamByCo),[Nt]:wr};return{...xe,sheet:{...xe.sheet,rowsByStudentId:{...xe.sheet.rowsByStudentId,[ze]:{...Vt,caaExamByCo:zr}}}}})}function Be(me,Pe,et){Ut(xe=>{var Wr;if(!vr)return xe;const ze=String(me),Vt=(Wr=xe.sheet.rowsByStudentId)==null?void 0:Wr[ze];if(!Vt||!Pt||!Kt||bt&&r!=="model"&&Vt.absent)return xe;if(r==="model"){const sn=!!Vt.absent,an=sn?String(Vt.absentKind||"AL").toUpperCase():"";if(sn&&!!!(Ae&&sn&&(an==="ML"||an==="SKL")))return xe}const Nt=String(tn(Number(Pe),1,5)),br=Number(kd[Number(Nt)]||0);if(br<=0)return xe;const wr=et===""?"":TM(Number(et),0,br),zr={...Fk(Vt==null?void 0:Vt.ciaExamByCo),[Nt]:wr};return{...xe,sheet:{...xe.sheet,rowsByStudentId:{...xe.sheet.rowsByStudentId,[ze]:{...Vt,ciaExamByCo:zr}}}}})}async function vt(){if(e){B(!0);try{await Mi(r,String(e),ht),T(new Date().toLocaleString())}catch(me){alert((me==null?void 0:me.message)||"Draft save failed")}finally{B(!1)}}}const jt=hn.useRef(ht);jt.current=ht,x.useEffect(()=>{const me=()=>{!e||it||Mi(r,String(e),jt.current).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",me),()=>window.removeEventListener("obe:before-tab-switch",me)},[e,r,it]);async function $t(){if(!e||!window.confirm(`Reset all marks for ${n}? This clears the draft for all students.`))return;const Pe=tn(Number(ht.sheet.expCountA??Pi),0,12),et=tn(Number(ht.sheet.expCountB??0),0,12),xe={};for(const Vt of b)xe[String(Vt.id)]={studentId:Vt.id,absent:!1,absentKind:void 0,marksA:Array.from({length:Pe},()=>""),marksB:Array.from({length:et},()=>""),marksByCo:{},caaExamByCo:{},ciaExamByCo:{},ciaExam:""};const ze={sheet:{...ht.sheet,btlA:Array.from({length:Pe},()=>1),btlB:Array.from({length:et},()=>1),rowsByStudentId:xe}};Ut(ze);try{Vr&&Gn(Vr,{rowsByStudentId:{}})}catch{}try{await Mi(r,String(e),ze),T(new Date().toLocaleString())}catch{}}async function Rr(){if(!e)return;if(qt){alert("Publishing is locked by IQAC.");return}if(!Yr){alert("Publish window is closed. Please request IQAC approval.");return}if(ne&&gt&&!g){if(Fe){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}re(!0);return}se(!0);const me=de,Pe=hr,et={markEntryUnblockedUntil:ce,markManagerUnlockedUntil:te};try{console.debug("publish called",{assessment:r,subjectId:e,entryOpen:je,publishAllowed:Yr,globalLocked:qt}),U(new Date().toLocaleString()),Tr(et),await k3(r,String(e),ht,t),console.debug("publish succeeded",{assessment:r,subjectId:e}),await Ur(!1),Me(),It({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(xe){U(me),Tr(Pe),alert((xe==null?void 0:xe.message)||"Publish failed")}finally{se(!1)}}async function Ur(me){if(e){me&&Z(!0),Oe(null);try{const Pe=await ho(r,String(e),t),et=(Pe==null?void 0:Pe.data)??null;et&&typeof et=="object"&&ae(et)}catch(Pe){me&&Oe((Pe==null?void 0:Pe.message)||"Failed to load published marks")}finally{me&&Z(!1)}}}x.useEffect(()=>{if(e){if(!(Ce!=null&&Ce.exists)||!(Ce!=null&&Ce.is_published)){ae(null);return}Ur(!1)}},[e,r,Ce==null?void 0:Ce.exists,Ce==null?void 0:Ce.is_published]);const en=hn.useRef(!!je);x.useEffect(()=>{if(!e||!ne)return;if(en.current||!je){en.current=!!je;return}let Pe=!0;return(async()=>{try{const et=await ei(r,String(e),t),xe=(et==null?void 0:et.data)??null;if(!Pe)return;if(xe&&typeof xe=="object"&&xe.sheet){Ut(xe);return}}catch{}Pe&&H&&H.sheet&&Ut(H)})(),en.current=!!je,()=>{Pe=!1}},[je,ne,e,r,H]),x.useEffect(()=>{if(!e||!ne||je)return;const me=window.setInterval(()=>{It({silent:!0});try{er==null||er({silent:!0})}catch{}},3e4);return()=>window.clearInterval(me)},[je,ne,e,It,er]),x.useEffect(()=>{Tr(null)},[e]);async function vn(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}const Pe=String(K||"").trim();if(!Pe){alert("Reason is required.");return}if(Fe){alert("Edit request is already pending. Please wait.");return}J(!0);const et=new Date,xe=Ot!=null&&Ot.approval_until?String(Ot.approval_until):null;try{const ze=await nl({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:Pe,teaching_assignment_id:t});alert(il(ze)),re(!1),V(""),st(Date.now()+24*60*60*1e3);try{Wt({silent:!0})}catch{}const Vt=Number(ze==null?void 0:ze.id),Nt=et.getTime()-2e3;(async()=>{for(let zr=0;zr<36;zr++){try{const Wr=await Lm({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),sn=Wr==null?void 0:Wr.result;if(!sn)throw new Error("No status");if(Number.isFinite(Vt)&&Vt>0&&Number(sn.id)!==Vt)throw new Error("Different request");const an=sn.reviewed_at?new Date(String(sn.reviewed_at)).getTime():0,Lr=String(sn.status||"").toUpperCase();if(Lr==="APPROVED"&&an>=Nt){try{It({silent:!0}),er==null||er({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}if(Lr==="REJECTED"&&an>=Nt){alert("IQAC rejected the edit request.");return}}catch{try{const Wr=await l1(r,String(e),"MARK_ENTRY",t),sn=Wr!=null&&Wr.approval_until?String(Wr.approval_until):null;if(Wr!=null&&Wr.allowed_by_approval&&sn&&sn!==xe){try{It({silent:!0}),er==null||er({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(Wr=>setTimeout(Wr,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(ze){const Vt=al(ze,"Request failed");alert(`Edit request failed: ${Vt}`)}finally{J(!1)}}x.useEffect(()=>{X&&e&&(ae(null),Ur(!0))},[X,e,r]);const Nr=x.useMemo(()=>{if(Mt===0)return[];const me=new Set;for(const Pe of At)for(let et=0;et<Pe.expCount;et++){const xe=Pe.btl[et];(xe===1||xe===2||xe===3||xe===4||xe===5||xe===6)&&me.add(xe)}return[1,2,3,4,5,6].filter(Pe=>me.has(Pe))},[At,Mt]),fn=3+(bt?1:0)+ar+1+Bt+Qt+Nr.length*2,rr={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},ve={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},rt={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},ut={border:"1px solid #e5e7eb",borderRadius:12,background:"#fff",padding:12},pt=40,Pr=90,Kr=180,pn=56,Nn=52,_n=72,kn=80,Wn=x.useMemo(()=>[...Array.from({length:ar},()=>kn),Nn,...Bt>0?Array.from({length:Bt},()=>kn):[],...Array.from({length:Qt+Nr.length*2},()=>kn)],[ar,Bt,Qt,Nr.length]),M=x.useMemo(()=>{const me=pt+Pr+Kr+(bt?pn:0),Pe=Wn.reduce((et,xe)=>et+xe,0);return Math.max(900,me+Pe)},[bt,Wn]),oe=x.useMemo(()=>{const me=pt+Pr+Kr,Pe=Wn.reduce((et,xe)=>et+xe,0);return Math.max(900,me+Pe)},[Wn]),Re=(me,Pe)=>({position:"sticky",left:me,zIndex:40,...Pe!=null?{width:Pe,minWidth:Pe,maxWidth:Pe}:null,background:rr.background}),Je=(me,Pe)=>({position:"sticky",left:me,zIndex:25,...Pe!=null?{width:Pe,minWidth:Pe,maxWidth:Pe}:null,background:"#fff"});function kt(me,Pe,et){const xe=3+(Pe?1:0),ze=Math.max(0,me-xe);return a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:pt}}),a.jsx("col",{style:{width:Pr}}),a.jsx("col",{style:{width:Kr}}),Pe?a.jsx("col",{style:{width:pn}}):null,Array.from({length:ze}).map((Vt,Nt)=>{const br=(et==null?void 0:et[Nt])??kn;return a.jsx("col",{style:{width:br,minWidth:br,maxWidth:br}},`rest_${Nt}`)})]})}const mr={display:"flex",width:"100%",maxWidth:1200,margin:"0 auto",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},lr={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},Sr=nt?"markManagerGlitch 2s ease-in-out":void 0,Hr={position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"},Jr=async()=>{if(!e)return;const me=b.map((Pe,et)=>{var wr;const xe=(wr=ht.sheet.rowsByStudentId)==null?void 0:wr[String(Pe.id)],ze=fr(xe,At),Vt=Dt(xe,ze),br=!!(bt&&(xe!=null&&xe.absent)&&!Vt.hasAnyMarks)?"ABSENT":Vt.finalTotal;return{sno:et+1,regNo:String(Pe.reg_no||""),name:String(Pe.name||""),total:br}});await hy({filenameBase:`${String(e)}_${n}`,meta:{courseName:(A==null?void 0:A.courseName)||"",courseCode:(A==null?void 0:A.courseCode)||String(e),className:(A==null?void 0:A.className)||""},rows:me})};return a.jsxs(ag,{children:[a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0% { background: #fff7ed; transform: translateX(0); }
          10% { background: #f3f4f6; transform: translateX(-2px); }
          20% { background: #fff7ed; transform: translateX(2px); }
          30% { background: #f3f4f6; transform: translateX(-1px); }
          40% { background: #fff7ed; transform: translateX(1px); }
          50% { background: #f3f4f6; transform: translateX(0); }
          60% { background: #fff7ed; transform: translateX(-1px); }
          70% { background: #f3f4f6; transform: translateX(1px); }
          80% { background: #fff7ed; transform: translateX(0); }
          90% { background: #f3f4f6; transform: translateX(-1px); }
          100% { background: #f3f4f6; transform: translateX(0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 1; transform: scale(1) rotate(0deg); }
          50% { opacity: 0.8; transform: scale(1.1) rotate(180deg); }
          100% { opacity: 0; transform: scale(0.5) rotate(360deg); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),a.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),a.jsxs("div",{style:{...mr,border:"1px solid #fcd34d",background:Zt?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:Sr,position:"relative",overflow:"hidden"},children:[nt&&a.jsx(a.Fragment,{children:Array.from({length:20},(me,Pe)=>a.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},Pe))}),a.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0},children:[a.jsx(T2,{size:18,color:Zt?"#6b7280":"#9a3412"}),a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Mark Manager"})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:a.jsx("button",{onClick:()=>{if(Zt){De({mode:"request"});return}const me=zt(ht.sheet.markManagerSnapshot??null);if(me){const Pe=St(me),et=St(Ar),xe=Pe.filter(ze=>!et.includes(ze));if(xe.length){const ze=tn(Number(i??1),1,5),Vt=s==null?null:tn(Number(s),1,5),Nt=yt(ht.sheet.rowsByStudentId,xe,ze,Vt);lt({visible:!0,removed:xe,affected:Nt});return}}De({mode:"confirm"})},className:"obe-btn obe-btn-success",disabled:!e||We,style:We?{opacity:.6,cursor:"not-allowed"}:void 0,children:Zt?"Edit":"Save"})})]}),a.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[kr.map(me=>{const Pe=Ar[String(me)],et=!!(Pe!=null&&Pe.enabled);return a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:et,disabled:Zt,onChange:xe=>dt(me,xe.target.checked),style:lr}),"CO-",me]},me)}),a.jsx("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:Pt?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"checkbox",checked:Kt,disabled:Zt,onChange:me=>we(me.target.checked),style:lr}),"CIA Exam"]}):null})]}),a.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,marginTop:8},children:kr.map(me=>{const Pe=Ar[String(me)];if(!!!(Pe!=null&&Pe.enabled))return null;const xe=tn(Number((Pe==null?void 0:Pe.expCount)??Pi),0,12),ze=tn(Number((Pe==null?void 0:Pe.expMax)??ea),0,100);return a.jsxs("div",{style:{width:"100%",minWidth:0,display:"flex",flexDirection:"column",gap:6,padding:"10px 10px",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:[a.jsxs("div",{style:{fontSize:12,fontWeight:950},children:["CO-",me]}),a.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of ",mt.toLowerCase()]}),a.jsx("input",{type:"number",className:"obe-input",value:xe,onChange:Vt=>nn(me,Number(Vt.target.value)),min:0,max:12,disabled:Zt}),a.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Max marks"}),a.jsx("input",{type:"number",className:"obe-input",value:ze,onChange:Vt=>ct(me,Number(Vt.target.value)),min:0,max:100,disabled:Zt})]},`cfg_${me}`)})})]}),_t?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:_t}):null]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:Jr,className:"obe-btn obe-btn-secondary",disabled:!e||b.length===0,children:"Download"}),a.jsx("button",{onClick:$t,className:"obe-btn obe-btn-danger",disabled:!e||it,title:it?"Table locked  confirm Mark Manager to enable actions":void 0,children:"Reset"})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:vt,className:"obe-btn obe-btn-success",disabled:P||!e||it,title:it?"Table locked  confirm Mark Manager to enable actions":void 0,children:P?"Saving":"Save Draft"}),a.jsx("button",{onClick:Rr,className:"obe-btn obe-btn-primary",disabled:Qe?!1:!e||z||it||qt||!Yr,title:it?"Table locked  confirm Mark Manager to enable actions":Yr?qt?"Publishing locked":"Publish":"Publish window closed",children:Qe?"Request Edit":z?"Publishing":"Publish"}),E&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",E]}),de&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",de]})]})]}),An&&!qt&&Yr&&a.jsxs("div",{style:{fontSize:13,color:"#6b7280",marginBottom:6},children:["Publish window open  due by"," ",a.jsx("strong",{children:An.due_at?new Date(An.due_at).toLocaleString():""}),Ln!=null&&Ln>0&&a.jsxs("span",{children:[" (",Math.ceil(Ln/60)," min remaining)"]})]}),qt&&a.jsx("div",{style:{background:"#fffbeb",border:"1px solid #fde68a",color:"#92400e",padding:"10px 14px",borderRadius:10,marginBottom:10,fontWeight:600},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:"Publishing disabled by IQAC"}),a.jsx("button",{className:"obe-btn obe-btn-secondary",style:{padding:"2px 10px",fontSize:12},onClick:()=>Me(),children:"Refresh"})]})}),!qt&&!Yr&&An&&a.jsxs("div",{style:{background:"#fff7ed",border:"1px solid #fecaca",color:"#9a3412",padding:"10px 14px",borderRadius:10,marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[a.jsx("strong",{children:"Publish time is over"}),a.jsxs("div",{style:{display:"flex",gap:6},children:[a.jsx("button",{className:"obe-btn obe-btn-secondary",style:{padding:"2px 10px",fontSize:12},onClick:()=>Me(),children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",style:{padding:"2px 10px",fontSize:12},disabled:Q,onClick:async()=>{if(q.trim()){ie(!0),O(null);try{await Sh({assessment:r,subject_code:String(e),reason:q,teaching_assignment_id:t}),O("Request sent successfully."),Y("")}catch(me){O((me==null?void 0:me.message)||"Request failed")}ie(!1)}},children:Q?"Sending":"Request Approval"})]})]}),a.jsx("input",{type:"text",placeholder:"Reason for approval",value:q,onChange:me=>Y(me.target.value),style:{width:"100%",padding:"4px 8px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13}}),le&&a.jsx("div",{style:{marginTop:4,fontSize:12,color:le.includes("success")?"#065f46":"#991b1b"},children:le})]}),w?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,k?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:k}):null,a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:ht.sheet.termLabel||""})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:ht.sheet.batchLabel||""})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:E||""}),F?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:F})]}):null]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:de||""})]})]}),a.jsx("div",{style:ut,children:a.jsx(ig,{locked:qt,children:a.jsxs("div",{className:"obe-table-wrapper",style:{overflowX:"auto",position:"relative",filter:it?"grayscale(5%)":void 0,opacity:it?.78:1},children:[a.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:M,tableLayout:"fixed",borderCollapse:"collapse"},children:[kt(fn,bt,Wn),a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:rr,colSpan:fn,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...rr,...Re(0,pt)},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...rr,...Re(pt,Pr)},rowSpan:5,children:"R.No"}),a.jsx("th",{style:{...rr,...Re(pt+Pr,Kr),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),bt?a.jsx("th",{style:{...rr,...Re(pt+Pr+Kr,pn)},rowSpan:5,children:"AB"}):null,a.jsx("th",{style:rr,colSpan:ar,children:mt}),a.jsx("th",{style:{...rr,width:Nn,minWidth:Nn,maxWidth:Nn},rowSpan:5,children:"AVG"}),vr?a.jsx(a.Fragment,{children:Kt&&ot.length>0?a.jsx("th",{style:rr,colSpan:ot.length,children:"CIA EXAM"}):null}):Kt?Lt?a.jsx("th",{style:rr,colSpan:Math.max(Ze,1),children:"CIA EXAM"}):a.jsx("th",{style:{...rr,width:_n,minWidth:_n,maxWidth:_n,whiteSpace:"pre-line",overflow:"visible",textOverflow:"clip",lineHeight:1.05},rowSpan:5,title:"CIA Exam",children:`CIA
EXAM`}):null,a.jsx("th",{style:rr,colSpan:Qt,children:"CO ATTAINMENT"}),Nr.length?a.jsx("th",{style:rr,colSpan:Nr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Mt===0?a.jsx("th",{style:rr,children:""}):a.jsx(a.Fragment,{children:At.map(me=>Array.from({length:me.expCount},(Pe,et)=>a.jsx("th",{style:rr,children:me.coNumber},`co_${me.coNumber}_${et}`)))}),vr?a.jsx(a.Fragment,{children:Kt?ot.map(me=>a.jsxs("th",{style:rr,children:["CO-",me.coNumber]},`lab_cia_co_${me.coNumber}`)):null}):Kt&&Lt?Ze>0?Rt.map(me=>a.jsxs("th",{style:rr,children:["CO-",me.coNumber]},`caa_co_${me.coNumber}`)):a.jsx("th",{style:rr,children:""}):null,Ge?At.map(me=>a.jsxs("th",{style:rr,colSpan:2,children:["CO-",me.coNumber]},`coatt_${me.coNumber}`)):a.jsx("th",{style:rr,colSpan:2,children:""}),Nr.map(me=>a.jsxs("th",{style:rr,colSpan:2,children:["BTL-",me]},`btl_${me}`))]}),a.jsxs("tr",{children:[Mt===0?a.jsx("th",{style:rr,children:""}):a.jsx(a.Fragment,{children:At.map(me=>Array.from({length:me.expCount},(Pe,et)=>a.jsx("th",{style:rr,children:me.expMax},`max_${me.coNumber}_${et}`)))}),vr?a.jsx(a.Fragment,{children:Kt?ot.map(me=>a.jsx("th",{style:rr,children:kd[me.coNumber]??0},`lab_cia_max_${me.coNumber}`)):null}):Kt&&Lt?Ze>0?Rt.map(me=>a.jsx("th",{style:rr,children:wp[me.coNumber]??0},`caa_max_${me.coNumber}`)):a.jsx("th",{style:rr,children:""}):null,Ge?At.map(me=>{const Pe=vr?Mh(Number(Bk[me.coNumber]||0)+(Kt?Number(kd[me.coNumber]||0):0)):(()=>{const et=Number(Rk[me.coNumber]||0),xe=EM[`co${me.coNumber}`],ze=Array.from({length:tn(Number(me.expCount??0),0,12)}).map(()=>tn(Number(me.expMax??ea),0,100)),Vt=ze.length?ze.reduce((br,wr)=>br+wr,0)/ze.length:0,Nt=Fr&&Number.isFinite(Number(xe))?Number(xe):Vt;return Lt&&et>0?et:Math.round(Nt+(Kt?Oh/2:0)||0)})();return a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:rr,children:Pe}),a.jsx("th",{style:rr,children:"%"})]},`comax_${me.coNumber}`)}):a.jsxs(a.Fragment,{children:[a.jsx("th",{style:rr,children:""}),a.jsx("th",{style:rr,children:"%"})]}),Nr.map(me=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:rr,children:Yt||ea}),a.jsx("th",{style:rr,children:"%"})]},`btlmax_${me}`))]}),a.jsxs("tr",{children:[Mt===0?a.jsxs("th",{style:rr,children:["No ",mt.toLowerCase()]}):a.jsx(a.Fragment,{children:At.map(me=>Array.from({length:me.expCount},(Pe,et)=>a.jsxs("th",{style:rr,children:[wt,et+1]},`e_${me.coNumber}_${et}`)))}),a.jsx("th",{style:rr,colSpan:Qt+Nr.length*2+Bt})]}),a.jsxs("tr",{children:[Mt===0?a.jsx("th",{style:rr,children:"BTL"}):a.jsx(a.Fragment,{children:At.map(me=>Array.from({length:me.expCount},(Pe,et)=>a.jsx("th",{style:rr,children:(()=>{var Nt;const xe=((Nt=me.btl)==null?void 0:Nt[et])??1,ze=xe===""?"-":String(xe);return!g&&!it&&!gt&&!qt?a.jsxs("select",{"aria-label":`BTL for ${He} ${et+1} (CO-${me.coNumber})`,value:xe,onChange:br=>{const wr=br.target.value,zr=wr===""?"":Number(wr);Ht(me.coNumber,et,zr)},style:{width:"100%",minWidth:44,padding:"4px 2px",fontWeight:800,fontSize:11,textAlign:"center",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",cursor:"pointer"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(br=>a.jsx("option",{value:br,children:br},br))]}):a.jsx("span",{style:{fontWeight:800},children:ze})})()},`btl_${me.coNumber}_${et}`)))}),a.jsx("th",{style:rr,colSpan:Qt+Nr.length*2+Bt})]})]}),a.jsxs("tbody",{children:[(!it&&!gt?b:[]).map((me,Pe)=>{var sn,an;const et=(sn=ht.sheet.rowsByStudentId)==null?void 0:sn[String(me.id)],xe=fr(et,At),ze=xe.flatMap(Lr=>Lr.marks),Vt=Yb(ze),Nt=Dt(et,xe),br=Ge?Nt.coAttainmentValues:[],wr=Nt.caaByCo,zr=Nt.ciaByCo,Wr={};for(const Lr of Nr){const mn=[];for(const cn of At){const xn=((an=xe.find(Ir=>Ir.coNumber===cn.coNumber))==null?void 0:an.marks)??[];for(let Ir=0;Ir<Math.min(cn.expCount,xn.length);Ir++)if(cn.btl[Ir]===Lr){const jn=xn[Ir];typeof jn=="number"&&Number.isFinite(jn)&&mn.push(jn)}}Wr[Lr]=mn.length?mn.reduce((cn,xn)=>cn+xn,0)/mn.length:null}return a.jsxs("tr",{style:it&&Pe<3?{position:"relative",zIndex:35,background:"#fff"}:void 0,children:[a.jsx("td",{style:{...ve,...Je(0,pt),textAlign:"center"},children:Pe+1}),a.jsx("td",{style:{...ve,...Je(pt,Pr),textAlign:"center"},title:String(me.reg_no||""),children:OM(me.reg_no,7)}),a.jsx("td",{style:{...ve,...Je(pt+Pr,Kr)},title:String(me.name||""),children:a.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(me.name||"")})}),bt?a.jsx("td",{style:{...ve,...Je(pt+Pr+Kr,pn),textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:!!(et!=null&&et.absent),onChange:Lr=>Ie(me.id,Lr.target.checked),disabled:it}),et!=null&&et.absent?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:String(et.absentKind||"AL")}),a.jsxs("select",{"aria-label":"Absent type",value:et.absentKind||"AL",onChange:Lr=>tt(me.id,Lr.target.value),disabled:it,children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}):null,Mt===0?a.jsx("td",{style:{...ve,textAlign:"center",color:"#6b7280"},children:""}):At.map(Lr=>{var cn;const mn=((cn=xe.find(xn=>xn.coNumber===Lr.coNumber))==null?void 0:cn.marks)??[];return Array.from({length:Lr.expCount},(xn,Ir)=>a.jsx("td",{style:{...ve,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:mn[Ir]??"",onChange:jn=>{const Hn=jn.target.value;if(Hn==="")return jn.currentTarget.setCustomValidity(""),Ue(me.id,Lr.coNumber,Ir,"");const Mn=Number(Hn);if(Number.isFinite(Mn)){if(Mn>Lr.expMax){jn.currentTarget.setCustomValidity(`Max mark is ${Lr.expMax}`),jn.currentTarget.reportValidity(),window.setTimeout(()=>jn.currentTarget.setCustomValidity(""),0);return}jn.currentTarget.setCustomValidity(""),Ue(me.id,Lr.coNumber,Ir,Mn)}},style:rt,min:0,max:Lr.expMax,disabled:it})},`m_${me.id}_${Lr.coNumber}_${Ir}`))}),a.jsx("td",{style:{...ve,width:Nn,minWidth:0,textAlign:"right",fontWeight:800},children:Vt==null?"":Vt.toFixed(1)}),vr?a.jsx(a.Fragment,{children:Kt?ot.map(Lr=>{const mn=Number(kd[Lr.coNumber]||0),cn=zr[String(Lr.coNumber)]??"";return a.jsx("td",{style:{...ve,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:cn,onChange:xn=>{const Ir=xn.target.value;if(Ir==="")return xn.currentTarget.setCustomValidity(""),Be(me.id,Lr.coNumber,"");const jn=Number(Ir);if(Number.isFinite(jn)){if(jn>mn){xn.currentTarget.setCustomValidity(`Max mark is ${mn}`),xn.currentTarget.reportValidity(),window.setTimeout(()=>xn.currentTarget.setCustomValidity(""),0);return}xn.currentTarget.setCustomValidity(""),Be(me.id,Lr.coNumber,jn)}},style:rt,min:0,max:mn,step:.1,disabled:it})},`lab_cia_${me.id}_${Lr.coNumber}`)}):null}):Kt?Lt?Ze>0?Rt.map(Lr=>{const mn=Number(wp[Lr.coNumber]||0),cn=wr[String(Lr.coNumber)]??"";return a.jsx("td",{style:{...ve,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:cn,onChange:xn=>{const Ir=xn.target.value;if(Ir==="")return xn.currentTarget.setCustomValidity(""),at(me.id,Lr.coNumber,"");const jn=Number(Ir);if(Number.isFinite(jn)){if(jn>mn){xn.currentTarget.setCustomValidity(`Max mark is ${mn}`),xn.currentTarget.reportValidity(),window.setTimeout(()=>xn.currentTarget.setCustomValidity(""),0);return}xn.currentTarget.setCustomValidity(""),at(me.id,Lr.coNumber,jn)}},style:rt,min:0,max:mn,disabled:it})},`caa_${me.id}_${Lr.coNumber}`)}):a.jsx("td",{style:{...ve,textAlign:"center",color:"#6b7280"},children:""}):a.jsx("td",{style:{...ve,width:_n,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:(et==null?void 0:et.ciaExam)??"",onChange:Lr=>{const mn=Lr.target.value;if(mn==="")return Lr.currentTarget.setCustomValidity(""),qe(me.id,"");const cn=Number(mn);if(Number.isFinite(cn)){if(cn>Oh){Lr.currentTarget.setCustomValidity(`Max mark is ${Oh}`),Lr.currentTarget.reportValidity(),window.setTimeout(()=>Lr.currentTarget.setCustomValidity(""),0);return}Lr.currentTarget.setCustomValidity(""),qe(me.id,cn)}},style:rt,min:0,max:Oh,disabled:it})}):null,Ge?br.map(Lr=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...ve,textAlign:"right"},children:Lr.mark==null?"":Lr.mark.toFixed(1)}),a.jsx("td",{style:{...ve,textAlign:"right"},children:Xb(Lr.mark,Lr.coMax)})]},`coattrow_${me.id}_${Lr.coNumber}`)):a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...ve,textAlign:"right"}}),a.jsx("td",{style:{...ve,textAlign:"right"}})]}),Nr.map(Lr=>{const mn=Wr[Lr]??null;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...ve,textAlign:"right"},children:mn==null?"":mn.toFixed(1)}),a.jsx("td",{style:{...ve,textAlign:"right"},children:Xb(mn,Yt||ea)})]},`btlcell_${me.id}_${Lr}`)})]},me.id)}),b.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:fn,style:{padding:10,color:"#6b7280"},children:"No students."})})]})]}),it&&!gt&&!g?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(72, 113, 195, 0.92) 0%, rgba(51, 55, 64, 0.96) 100%)"}}):null,gt&&!g?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,it&&!gt&&!g&&!y?a.jsxs("div",{style:Hr,children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{id:"mark-manager-float-gif",src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"gif",style:{maxWidth:72,maxHeight:72,display:"block"},onError:me=>{console.warn("Failed to load lock GIF:",me.currentTarget.src),me.currentTarget.onerror=null,me.currentTarget.src="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif" width="72" height="72" viewBox="0 0 24 24" fill="none" stroke="#0f172a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="10" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>')}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:4}})]}):null,gt&&!g&&!y?a.jsxs("div",{style:Hr,children:[a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Table is locked. Request IQAC approval to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>C(!0),children:"View"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:Fe,onClick:async()=>{if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}re(!0)},children:Fe?"Request Pending":"Request Edit"})]}),a.jsx("div",{style:{width:170,height:92,display:"grid",placeItems:"center",background:"#fff",borderRadius:10,border:"1px solid rgba(2,6,23,0.08)"},children:a.jsx("img",{id:"published-lock-image",src:new URL("/assets/lockong-CpAqbAhU.png",import.meta.url).toString(),alt:"locked",style:{maxWidth:150,maxHeight:80,display:"block"},onError:me=>{me.currentTarget.onerror=null,me.currentTarget.src="https://media.lordicon.com/icons/wired/flat/1103-check-mark.gif"}})})]}):null]})})}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[E?a.jsxs("div",{children:["Draft saved: ",E,F?a.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",a.jsx("strong",{children:F})]}):null]}):null,de?a.jsxs("div",{children:["Last published: ",de]}):null]}),_e?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:50},onClick:()=>{We||De(null)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",maxHeight:"90vh",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:me=>me.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:_e.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:r.toUpperCase()})]}),_e.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected COs and their settings. After confirming, the Mark Manager box will be locked."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"CO"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:mt}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max marks"})]})}),a.jsxs("tbody",{children:[Object.entries(Ar).filter(([me,Pe])=>Mr.has(String(me))&&!!(Pe!=null&&Pe.enabled)).map(([me,Pe])=>({co:tn(Number(me),1,5),expCount:tn(Number((Pe==null?void 0:Pe.expCount)??0),0,12),expMax:tn(Number((Pe==null?void 0:Pe.expMax)??0),0,100)})).sort((me,Pe)=>me.co-Pe.co).map(me=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",me.co]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:me.expCount}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:me.expMax})]},me.co)),Object.entries(Ar).filter(([me,Pe])=>Mr.has(String(me))&&!!(Pe!=null&&Pe.enabled)).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:3,style:{padding:10,color:"#6b7280"},children:"No COs selected."})}):null,Pt?a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CIA Exam"}),a.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:Kt?"Enabled":"Disabled"})]}):null]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. The Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:We,onClick:()=>De(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Qe?Fe:!e||z||it||qt||!Yr,onClick:async()=>{if(!e)return;if(_e.mode==="request"){Ct(!0),Xe(null);try{const Pe=H,et=Ar;if(Pe&&Pe.sheet&&Pe.sheet.coConfigs){const xe=sr(ur(Pe.sheet),et),ze=pr(Pe.sheet.rowsByStudentId,[...xe.removed,...xe.changed]);if((xe.removed.length||xe.changed.length||xe.added.length)&&ze>0){fe({visible:!0,diff:xe,affected:ze,mode:"request"}),Ct(!1);return}}De(null),await xt()}finally{Ct(!1)}return}const me=zt(ht.sheet.markManagerSnapshot??null);if(me){const Pe=St(me),et=St(Ar),xe=Pe.filter(ze=>!et.includes(ze));if(xe.length){const ze=tn(Number(i??1),1,5),Vt=s==null?null:tn(Number(s),1,5),Nt=yt(ht.sheet.rowsByStudentId,xe,ze,Vt);lt({visible:!0,removed:xe,affected:Nt});return}}await Cr("none")},children:_e.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,be&&be.visible?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:90},onClick:()=>{We||fe(null)},children:a.jsxs("div",{style:{width:"min(640px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:me=>me.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:8},children:"Mark Manager conflict with published marks"}),a.jsxs("div",{style:{color:"#374151",marginBottom:12},children:["The selected CO settings differ from the published mark sheet. ",be.affected," student rows contain marks that may be lost."]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Added COs:"})," ",be.diff.added.join(", ")||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Removed COs:"})," ",be.diff.removed.join(", ")||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Changed COs:"})," ",be.diff.changed.join(", ")||""]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>fe(null),disabled:We,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:We,onClick:async()=>{if(e){Ct(!0);try{const me=ht,Pe=Object.fromEntries(Object.entries(me.sheet.rowsByStudentId||{}).map(([xe,ze])=>{var Wr;const Vt=ze&&typeof ze=="object"?ze:{},Nt=tn(Number(me.sheet.expCountA??Pi),0,12),br=tn(Number(me.sheet.expCountB??0),0,12),wr={...Vt};wr.marksA=Array.from({length:Nt},()=>""),wr.marksB=Array.from({length:br},()=>""),wr.caaExamByCo={},wr.ciaExamByCo={},wr.ciaExam="";const zr=wr.marksByCo&&typeof wr.marksByCo=="object"?{...wr.marksByCo}:{};for(const sn of[...be.diff.removed.map(String),...be.diff.changed.map(String)])zr[sn]&&(zr[sn]=Array.from({length:((Wr=Ar[sn])==null?void 0:Wr.expCount)??0},()=>""));return wr.marksByCo=zr,[xe,wr]})),et={sheet:{...me.sheet,rowsByStudentId:Pe}};if(Ut(et),await Mi(r,String(e),et),T(new Date().toLocaleString()),be.mode==="request")fe(null),De(null),await xt();else{try{await uh(r,String(e),t),It({silent:!0})}catch(xe){console.warn("confirmMarkManagerLock failed after reset",xe)}fe(null)}}catch(me){alert((me==null?void 0:me.message)||"Failed to reset marks")}finally{Ct(!1)}}},children:"Reset & Continue"})]})]})})}):null,ge&&ge.visible?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:95},onClick:()=>{We||lt(null)},children:a.jsxs("div",{style:{width:"min(660px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:me=>me.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:8},children:ge.removed.length===1?`Shall I reset the CO${ge.removed[0]} column?`:"Shall I reset the removed CO columns?"}),a.jsxs("div",{style:{color:"#374151",marginBottom:10},children:["The new Mark Manager selection removed old COs.",ge.affected>0?` ${ge.affected} student rows contain marks in these columns.`:" No marks were found in these columns."]}),a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:a.jsxs("div",{children:[a.jsx("strong",{children:"Removed COs:"})," ",ge.removed.join(", ")||""]})}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>lt(null),disabled:We,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-primary",disabled:We,onClick:async()=>{const me=ge.removed;lt(null),await Cr("partial",me)},children:ge.removed.length===1?`Reset CO${ge.removed[0]} column`:"Reset removed CO columns"}),a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:We,onClick:async()=>{lt(null),await Cr("full")},children:"Reset full data"})]})]})})}):null,G?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{R||re(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:me=>me.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",$e?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",n]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Code:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",de||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",E||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:K,onChange:me=>V(me.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:R,onClick:()=>re(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:R||Fe||!e||!String(K||"").trim(),onClick:vn,title:Fe?"Request pending (up to 24 hours)":void 0,children:R?"Requesting":Fe?"Request Pending":"Send Request"})]})]})})}):null,X?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>C(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:me=>me.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[n,"  ",String(e||"")]}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:()=>C(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),I?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,pe?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:pe}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,position:"relative"},children:(()=>{const me=3+ar+1+Bt+Qt+Nr.length*2;return a.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:oe,tableLayout:"fixed",borderCollapse:"collapse"},children:[kt(me,!1,Wn),a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:rr,colSpan:me,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...rr,...Re(0,pt)},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...rr,...Re(pt,Pr)},rowSpan:5,children:"R.No"}),a.jsx("th",{style:{...rr,...Re(pt+Pr,Kr),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:rr,colSpan:ar,children:"Experiments"}),a.jsx("th",{style:{...rr,width:Nn,minWidth:Nn,maxWidth:Nn},rowSpan:5,children:"AVG"}),vr?a.jsx(a.Fragment,{children:Kt&&ot.length>0?a.jsx("th",{style:rr,colSpan:ot.length,children:"CIA EXAM"}):null}):Kt?Lt?a.jsx("th",{style:rr,colSpan:Math.max(Ze,1),children:"CIA EXAM"}):a.jsx("th",{style:{...rr,width:_n,minWidth:_n,maxWidth:_n,whiteSpace:"pre-line",overflow:"visible",textOverflow:"clip",lineHeight:1.05},rowSpan:5,title:"CIA Exam",children:`CIA
EXAM`}):null,a.jsx("th",{style:rr,colSpan:Qt,children:"CO ATTAINMENT"}),Nr.length?a.jsx("th",{style:rr,colSpan:Nr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Mt===0?a.jsx("th",{style:rr,children:""}):a.jsx(a.Fragment,{children:At.map(Pe=>Array.from({length:Pe.expCount},(et,xe)=>a.jsx("th",{style:rr,children:Pe.coNumber},`co_view_${Pe.coNumber}_${xe}`)))}),vr?a.jsx(a.Fragment,{children:Kt?ot.map(Pe=>a.jsxs("th",{style:rr,children:["CO-",Pe.coNumber]},`lab_cia_co_view_${Pe.coNumber}`)):null}):Kt&&Lt?Ze>0?Rt.map(Pe=>a.jsxs("th",{style:rr,children:["CO-",Pe.coNumber]},`caa_co_view_${Pe.coNumber}`)):a.jsx("th",{style:rr,children:""}):null,Ge?At.map(Pe=>a.jsxs("th",{style:rr,colSpan:2,children:["CO-",Pe.coNumber]},`coatt_view_${Pe.coNumber}`)):a.jsx("th",{style:rr,colSpan:2,children:""}),Nr.map(Pe=>a.jsxs("th",{style:rr,colSpan:2,children:["BTL-",Pe]},`btl_view_${Pe}`))]}),a.jsxs("tr",{children:[Mt===0?a.jsx("th",{style:rr,children:""}):a.jsx(a.Fragment,{children:At.map(Pe=>Array.from({length:Pe.expCount},(et,xe)=>a.jsx("th",{style:rr,children:Pe.expMax},`max_view_${Pe.coNumber}_${xe}`)))}),vr?a.jsx(a.Fragment,{children:Kt?ot.map(Pe=>a.jsx("th",{style:rr,children:kd[Pe.coNumber]??0},`lab_cia_max_view_${Pe.coNumber}`)):null}):Kt&&Lt?Ze>0?Rt.map(Pe=>a.jsx("th",{style:rr,children:wp[Pe.coNumber]??0},`caa_max_view_${Pe.coNumber}`)):a.jsx("th",{style:rr,children:""}):null,Ge?At.map(Pe=>{const et=vr?Mh(Number(Bk[Pe.coNumber]||0)+(Kt?Number(kd[Pe.coNumber]||0):0)):(()=>{const xe=Number(Rk[Pe.coNumber]||0);return Lt&&xe>0?xe:Pe.expMax+(Kt?Oh/2:0)})();return a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:rr,children:et}),a.jsx("th",{style:rr,children:"%"})]},`comax_view_${Pe.coNumber}`)}):a.jsxs(a.Fragment,{children:[a.jsx("th",{style:rr,children:""}),a.jsx("th",{style:rr,children:"%"})]}),Nr.map(Pe=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:rr,children:Yt||ea}),a.jsx("th",{style:rr,children:"%"})]},`btlmax_view_${Pe}`))]}),a.jsxs("tr",{children:[Mt===0?a.jsx("th",{style:rr,children:"No experiments"}):a.jsx(a.Fragment,{children:At.map(Pe=>Array.from({length:Pe.expCount},(et,xe)=>a.jsxs("th",{style:rr,children:["E",xe+1]},`e_view_${Pe.coNumber}_${xe}`)))}),a.jsx("th",{style:rr,colSpan:Qt+Nr.length*2+Bt})]}),a.jsxs("tr",{children:[Mt===0?a.jsx("th",{style:rr,children:"BTL"}):a.jsx(a.Fragment,{children:At.map(Pe=>Array.from({length:Pe.expCount},(et,xe)=>a.jsx("th",{style:rr,children:Pe.btl[xe]||1},`btlhdr_view_${Pe.coNumber}_${xe}`)))}),a.jsx("th",{style:rr,colSpan:Qt+Nr.length*2+Bt})]})]}),a.jsxs("tbody",{children:[b.map((Pe,et)=>{var Lr,mn;const xe=H&&H.sheet?H.sheet:ht.sheet,ze=(Lr=xe==null?void 0:xe.rowsByStudentId)==null?void 0:Lr[String(Pe.id)],Vt=fr(ze,At),Nt=Vt.flatMap(cn=>cn.marks),br=Yb(Nt),wr=Dt(ze,Vt),zr=Ge?wr.coAttainmentValues:[],Wr=wr.caaByCo,sn=wr.ciaByCo,an={};for(const cn of Nr){const xn=[];for(const Ir of At){const jn=((mn=Vt.find(Hn=>Hn.coNumber===Ir.coNumber))==null?void 0:mn.marks)??[];for(let Hn=0;Hn<Math.min(Ir.expCount,jn.length);Hn++)if(Ir.btl[Hn]===cn){const Mn=jn[Hn];typeof Mn=="number"&&Number.isFinite(Mn)&&xn.push(Mn)}}an[cn]=xn.length?xn.reduce((Ir,jn)=>Ir+jn,0)/xn.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...ve,...Je(0,pt),textAlign:"center"},children:et+1}),a.jsx("td",{style:{...ve,...Je(pt,Pr)},title:String(Pe.reg_no||""),children:OM(Pe.reg_no,7)}),a.jsx("td",{style:{...ve,...Je(pt+Pr,Kr)},title:String(Pe.name||""),children:a.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(Pe.name||"")})}),Mt===0?a.jsx("td",{style:{...ve,textAlign:"center",color:"#6b7280"},children:""}):At.map(cn=>{var Ir;const xn=((Ir=Vt.find(jn=>jn.coNumber===cn.coNumber))==null?void 0:Ir.marks)??[];return Array.from({length:cn.expCount},(jn,Hn)=>a.jsx("td",{style:{...ve,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:xn[Hn]??""},`view_m_${Pe.id}_${cn.coNumber}_${Hn}`))}),a.jsx("td",{style:{...ve,width:Nn,minWidth:0,textAlign:"right",fontWeight:800},children:br==null?"":br.toFixed(1)}),vr?a.jsx(a.Fragment,{children:Kt?ot.map(cn=>a.jsx("td",{style:{...ve,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:sn[String(cn.coNumber)]??""},`view_lab_cia_${Pe.id}_${cn.coNumber}`)):null}):Kt?Lt?Ze>0?Rt.map(cn=>a.jsx("td",{style:{...ve,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:Wr[String(cn.coNumber)]??""},`view_caa_${Pe.id}_${cn.coNumber}`)):a.jsx("td",{style:{...ve,textAlign:"center",color:"#6b7280"},children:""}):a.jsx("td",{style:{...ve,width:_n,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:(ze==null?void 0:ze.ciaExam)??""}):null,Ge?zr.map(cn=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...ve,textAlign:"right"},children:cn.mark==null?"":cn.mark.toFixed(1)}),a.jsx("td",{style:{...ve,textAlign:"right"},children:Xb(cn.mark,cn.coMax)})]},`view_coatt_${Pe.id}_${cn.coNumber}`)):a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...ve,textAlign:"right"}}),a.jsx("td",{style:{...ve,textAlign:"right"}})]}),Nr.map(cn=>{const xn=an[cn]??null;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...ve,textAlign:"right"},children:xn==null?"":xn.toFixed(1)}),a.jsx("td",{style:{...ve,textAlign:"right"},children:Xb(xn,Yt||ea)})]},`view_btl_${Pe.id}_${cn}`)})]},`view_${Pe.id}`)}),b.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:fn,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})()}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>C(!1),children:"Close"})})]})})}):null]})}const Mxe=[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:16},{key:"q8",label:"Q8",max:16},{key:"q9",label:"Q9",max:16}];function Jb(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function Lxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Rxe(e){return String(e??"").trim().toLowerCase().replace(/\s+/g," ")}function Bxe({subjectId:e,classType:t,teachingAssignmentId:r,questionPaperType:n}){const i=x.useMemo(()=>[1,2,3,4,5,6],[]),s=ve=>{const rt=String(ve??"AL").trim().toUpperCase();return rt==="ML"||rt==="MALPRACTICE"?"ML":rt==="SKL"||rt==="SICK"||rt==="SICKLEAVE"||rt==="SL"?"SKL":"AL"},o={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},l={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},c=32,[u,d]=x.useState([]),[f,h]=x.useState(!1),[p,m]=x.useState(null),[g,y]=x.useState(null),[b,v]=x.useState(!1),[w,S]=x.useState(!1),[k,j]=x.useState(!1),[A,L]=x.useState(null),[P,B]=x.useState(null),[E,T]=x.useState(null),[F,W]=x.useState(null),[z,se]=x.useState(!1),[de,U]=x.useState(null),G=x.useRef(!1),[re,X]=x.useState(!1),C=x.useRef(!1),[K,V]=x.useState(!1),[R,J]=x.useState(null),[q,Y]=x.useState(null),[Q,ie]=x.useState({}),[le,O]=x.useState({}),[H,ae]=x.useState(null),[I,Z]=x.useState(""),[pe,Oe]=x.useState(!1),[Ae,ke]=x.useState(null),[_e,De]=x.useState(!1),[We,Ct]=x.useState(""),[_t,Xe]=x.useState(!1),[nt,Ne]=x.useState(!1),be=x.useRef(null),[fe,ge]=x.useState(!1),lt=x.useMemo(()=>ti(t),[t]),He=lt==="THEORY",mt=lt==="TCPL"||lt==="TCPR",wt=lt==="TCPR"?"TCPR":"TCPL",{data:Pt,loading:bt,error:qr,remainingSeconds:Tt,publishAllowed:xr,refresh:Zr}=H0({assessment:"model",subjectCode:e,teachingAssignmentId:r}),{data:Xr,refresh:Br}=V0({assessment:"model",subjectCode:String(e||""),teachingAssignmentId:r,options:{poll:!1}}),{data:Vr,refresh:An}=nc({assessment:"model",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:r,options:{poll:!1}}),Yr=!!E||!!(Xr!=null&&Xr.exists&&(Xr!=null&&Xr.is_published))||!!F,Ln=!!(Vr!=null&&Vr.allowed_by_approval),Me=Yr?Ln:!0,Ce=!!(Yr&&!Ln),It=!!(Yr&&Ce),{pending:ft,pendingUntilMs:Ot,setPendingUntilMs:er,refresh:hr}=G0({enabled:!!It&&!!e,assessment:"model",subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:r});K0(!!_e);const Tr=!!(Pt!=null&&Pt.global_override_active&&(Pt==null?void 0:Pt.global_is_open)===!1),ne=!!(Tr||Yr&&!Me);x.useEffect(()=>{Ne(!1)},[e,r,Ce]);const ce=x.useMemo(()=>`model_qp_type_${e}_${String(r??"none")}`,[e,r]),[te,ue]=x.useState("");x.useEffect(()=>{const ve=Pr=>{const Kr=String(Pr??"").trim().toUpperCase();return Kr==="QP2"?"QP2":Kr==="QP1"?"QP1":""},rt=ve(n);if(rt){ue(rt);try{Gn(ce,rt)}catch{}return}const ut=Jn(ce),pt=ve(ut);ue(pt||"QP1")},[ce,n]);const Ee=String(te??"").trim().toUpperCase();x.useEffect(()=>{let ve=!0;return(async()=>{var Kr;let ut=String(lt||"").trim().toUpperCase();if(ut.startsWith("THEORY")&&(ut="THEORY"),!ut){ae(null);return}const pt=Ee==="QP2"?"QP2":Ee==="QP1"?"QP1":"",Pr=ut==="THEORY"&&pt||null;try{const pn=await ih({class_type:ut,question_paper_type:Pr,exam:"MODEL"}),Nn=Array.isArray((Kr=pn==null?void 0:pn.pattern)==null?void 0:Kr.marks)?pn.pattern.marks:[];if(!ve)return;ae(Nn.length?pn.pattern:null)}catch{if(!ve)return;ae(null)}})(),()=>{ve=!1}},[lt,Ee]);const je=x.useMemo(()=>{const ve=Array.isArray(H==null?void 0:H.marks)?H.marks:null;return Array.isArray(ve)&&ve.length?ve.map((rt,ut)=>({key:`q${ut+1}`,label:`Q${ut+1}`,max:Number(rt)||0})):Mxe},[H]),gt=4+je.length+1+4+i.length*2,Qe=mt?Q||{}:le||{},Fe={width:"100%",border:"none",outline:"none",background:"transparent",padding:0,margin:0,fontSize:11,textAlign:"center"},$e=async ve=>{const rt=!!(ve!=null&&ve.silent);if(!r){d([]),rt||m(null);return}rt||h(!0),rt||m(null);try{try{const Kr=await yr(`/api/academics/teaching-assignments/${r}/`);if(Kr.ok){const pn=await Kr.json();if(pn&&pn.elective_subject_id&&!pn.section_id){const Nn=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(pn.elective_subject_id))}`);if(!Nn.ok)throw new Error(`Elective-choices fetch failed: ${Nn.status}`);const _n=await Nn.json(),M=((Array.isArray(_n.results)?_n.results:Array.isArray(_n)?_n:_n.items||[])||[]).map(oe=>({id:Number(oe.student_id??oe.id),reg_no:String(oe.reg_no??oe.registration_no??oe.regno??""),name:String(oe.name??oe.full_name??oe.username??""),section:oe.section_name??oe.section??null})).filter(oe=>Number.isFinite(oe.id)).sort((oe,Re)=>String(oe.name||"").localeCompare(String(Re.name||"")));d(M);return}}}catch{}const ut=await qc(r),Pr=[...(ut==null?void 0:ut.students)||[]].sort((Kr,pn)=>String(Kr.name||"").localeCompare(String(pn.name||"")));d(Pr)}catch(ut){d([]),rt||m((ut==null?void 0:ut.message)||"Failed to load roster")}finally{rt||h(!1)}};x.useEffect(()=>{$e()},[r]);const st=()=>({version:1,qpType:String(te??""),classType:String(lt??""),tcplLikeKind:wt,theoryQuestionBtl:Ze||{},tcplQuestionBtl:zt||{},theorySheet:le||{},tcplSheet:Q||{}}),Wt=ve=>{if(!ve||typeof ve!="object")return;C.current=!0;const rt=typeof ve.qpType=="string"?ve.qpType:null;if(rt!=null){const pt=String(rt||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";ue(pt);try{Gn(ce,pt)}catch{}}if(ve.theoryQuestionBtl&&typeof ve.theoryQuestionBtl=="object"){ot({...Rt,...ve.theoryQuestionBtl});try{Gn(Ge,{...Rt,...ve.theoryQuestionBtl})}catch{}}if(ve.tcplQuestionBtl&&typeof ve.tcplQuestionBtl=="object"){yt({...Ve,...ve.tcplQuestionBtl});try{Gn(ur,{...Ve,...ve.tcplQuestionBtl})}catch{}}if(ve.tcplSheet&&typeof ve.tcplSheet=="object"){ie(ve.tcplSheet);try{Gn(sr,ve.tcplSheet)}catch{}}if(ve.theorySheet&&typeof ve.theorySheet=="object"){O(ve.theorySheet);try{Gn(pr,ve.theorySheet)}catch{}}window.setTimeout(()=>{C.current=!1},0)},qt=async ve=>{if(!e)return;const rt=!!(ve!=null&&ve.silent);rt||j(!0),rt||y(null);try{const ut=await ei("model",e,r);ut!=null&&ut.draft&&Wt(ut.draft),L(ut!=null&&ut.updated_at?new Date(ut.updated_at).toLocaleString():null);const pt=ut==null?void 0:ut.updated_by;B(typeof(pt==null?void 0:pt.name)=="string"?pt.name:typeof(pt==null?void 0:pt.username)=="string"?pt.username:null)}catch(ut){rt||y((ut==null?void 0:ut.message)||"Failed to refresh draft")}finally{rt||j(!1)}};x.useEffect(()=>{X(!1);let ve=!0;return(async()=>{try{await qt({silent:!0})}finally{ve&&X(!0)}})(),()=>{ve=!1}},[e,r]);const ht=async()=>{if(e){v(!0),y(null);try{await Mi("model",e,st()),L(new Date().toLocaleString())}catch(ve){y((ve==null?void 0:ve.message)||"Draft save failed")}finally{v(!1)}}};x.useEffect(()=>{const ve=()=>{!e||Ce||Mi("model",e,st()).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",ve),()=>window.removeEventListener("obe:before-tab-switch",ve)},[e,Ce]);const Ut=async()=>{if(e){if(Yr){if(Ce){if(ft){y("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}De(!0);return}y("Editing is already open for this published sheet.");return}if(Tr){y("Publishing is locked by IQAC.");return}if(!xr){y("Publish window is closed. Please request IQAC approval.");return}S(!0),y(null);try{await L9(e,st(),r),T(new Date().toLocaleString()),await ir(!1),Zr({silent:!0}),Br({silent:!0});try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:"model"}}))}catch{}}catch(ve){y((ve==null?void 0:ve.message)||"Publish failed")}finally{S(!1)}}},Gt=async()=>{if(e){Oe(!0),ke(null),y(null);try{await Sh({assessment:"model",subject_code:e,reason:I,teaching_assignment_id:r}),ke("Request sent to IQAC for approval.")}catch(ve){y((ve==null?void 0:ve.message)||"Failed to request approval")}finally{Oe(!1),Zr({silent:!0})}}},cr=async()=>{if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(ft){y("Edit request is pending. Please wait for approval.");return}const rt=String(We||"").trim();if(!rt){y("Reason is required.");return}Xe(!0),y(null);try{const ut=await nl({assessment:"model",subject_code:String(e),scope:"MARK_ENTRY",reason:rt,teaching_assignment_id:r});alert(il(ut)),De(!1),Ct(""),er(Date.now()+24*60*60*1e3);try{hr({silent:!0})}catch{}Br({silent:!0}),An({silent:!0})}catch(ut){const pt=al(ut,"Failed to request edit");y(pt),alert(`Edit request failed: ${pt}`)}finally{Xe(!1)}};async function ir(ve,rt){if(e){ve&&se(!0),U(null);try{const ut=await Rm(String(e),r),pt=(ut==null?void 0:ut.data)??null;!!(pt&&typeof pt=="object"&&Number(pt.version)===1&&(typeof pt.classType=="string"||typeof pt.qpType=="string")&&("theorySheet"in pt||"tcplSheet"in pt))?(W(pt),(rt!=null&&rt.applyToMain||Ce)&&Wt(pt)):(W(null),(ve||rt!=null&&rt.applyToMain)&&U("No published snapshot found."))}catch(ut){(ve||rt!=null&&rt.applyToMain)&&U((ut==null?void 0:ut.message)||"Failed to load published sheet")}finally{ve&&se(!1)}}}x.useEffect(()=>{e&&ir(!1)},[e,r]),x.useEffect(()=>{if(e){if(!Ce){G.current=!1;return}if(!G.current){if(G.current=!0,F&&typeof F=="object"){Wt(F);return}ir(!0,{applyToMain:!0})}}},[Ce,e,r]),x.useEffect(()=>{if(!e||!Yr||Me)return;const ve=window.setInterval(()=>{Br({silent:!0})},3e4);return()=>window.clearInterval(ve)},[Me,Yr,e,Br]);const Fr=x.useMemo(()=>u.length?u:Array.from({length:5},(ve,rt)=>({id:-(rt+1),reg_no:"",name:"",section:null})),[u]),dn=x.useMemo(()=>Object.values(Qe||{}).some(rt=>!!(rt!=null&&rt.absent)),[Qe]),vr=x.useMemo(()=>{const ve=Array.isArray(H==null?void 0:H.marks)?H.marks:null;if(Array.isArray(ve)&&ve.length&&mt)return ve.map((pt,Pr)=>({key:`q${Pr+1}`,label:`Q${Pr+1}`,max:Number(pt)||0}));const rt=wt==="TCPR"?12:15,ut=wt==="TCPR"?8:10;return Array.from({length:rt},(pt,Pr)=>{const Kr=Pr+1;return{key:`q${Kr}`,label:`Q${Kr}`,max:Kr<=ut?2:16}})},[wt,H,mt]),Lt=x.useMemo(()=>vr.reduce((ve,rt)=>ve+rt.max,0),[vr]),Gr=30,bn=wt==="TCPR",or=5,kr=bn?0:Gr/or,Mr=wt==="TCPR"?"REVIEW":"LAB",Ar=x.useMemo(()=>{const ve=Array.isArray(H==null?void 0:H.marks)?H.marks:null;return Array.isArray(ve)&&ve.length&&He?ve.map((rt,ut)=>({key:`q${ut+1}`,label:`Q${ut+1}`,max:Number(rt)||0})):[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:2},{key:"q8",label:"Q8",max:2},{key:"q9",label:"Q9",max:2},{key:"q10",label:"Q10",max:2},{key:"q11",label:"Q11",max:14},{key:"q12",label:"Q12",max:14},{key:"q13",label:"Q13",max:14},{key:"q14",label:"Q14",max:14},{key:"q15",label:"Q15",max:14},{key:"q16",label:"Q16",max:10}]},[H,He]),Zt=5,Kt=x.useMemo(()=>Ar.reduce((ve,rt)=>ve+rt.max,0),[Ar]),it=x.useMemo(()=>{const ve=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],rt=Array.isArray(H==null?void 0:H.cos)?H.cos:null;return He&&Array.isArray(rt)&&rt.length===Ar.length?rt.map(ut=>{const pt=Number(ut);return Number.isFinite(pt)?Math.max(1,Math.min(5,Math.trunc(pt))):1}):Ar.length===ve.length?ve:Array.from({length:Ar.length},(ut,pt)=>ve[pt%ve.length])},[H,He,Ar.length]),At=x.useMemo(()=>{const ve=[2,2,3,3,3,2,2,3,3,3,4,4,3,3,3,5];return Ar.length===ve.length?ve:Array.from({length:Ar.length},(rt,ut)=>ve[ut%ve.length])},[Ar.length]),Mt=x.useMemo(()=>{const ve=Array.from({length:Zt},()=>0);return Ar.forEach((rt,ut)=>{const pt=it[ut]??1;pt>=1&&pt<=Zt&&(ve[pt-1]+=rt.max)}),ve},[Ar,it]),ar=x.useMemo(()=>Mt,[Mt]),Ge=x.useMemo(()=>`model_theory_questionBtl_${e}`,[e]),Rt=x.useMemo(()=>Object.fromEntries(Ar.map((ve,rt)=>{const ut=At[rt];return[ve.key,typeof ut=="number"?ut:""]})),[Ar,At]),[Ze,ot]=x.useState(Rt);x.useEffect(()=>{if(!He)return;const ve=Jn(Ge);ot(ve&&typeof ve=="object"?{...Rt,...ve}:Rt)},[He,Ge,Rt]);const Bt=(ve,rt)=>{ot(ut=>{const pt={...ut||{},[ve]:rt};return Gn(Ge,pt),pt})},Qt=x.useMemo(()=>Ar.map((ve,rt)=>{const ut=(Ze||{})[ve.key];if(ut===""||ut===1||ut===2||ut===3||ut===4||ut===5||ut===6)return ut;const pt=At[rt];return typeof pt=="number"?pt:""}),[Ar,Ze,At]),Yt=x.useMemo(()=>{const ve=[0,0,0,0,0,0];return Ar.forEach((rt,ut)=>{const pt=Qt[ut];typeof pt=="number"&&pt>=1&&pt<=6&&(ve[pt-1]+=rt.max)}),ve},[Ar,Qt]),fr=x.useMemo(()=>{const ve=wt==="TCPR"?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5],rt=Array.isArray(H==null?void 0:H.cos)?H.cos:null;return mt&&Array.isArray(rt)&&rt.length===vr.length?rt.map(ut=>{const pt=Number(ut);return Number.isFinite(pt)?Math.max(1,Math.min(5,Math.trunc(pt))):1}):vr.length===ve.length?ve:Array.from({length:vr.length},(ut,pt)=>ve[pt%ve.length])},[H,mt,wt,vr.length]),Dt=wt==="TCPR"?"tcpr":"tcpl",ur=x.useMemo(()=>`model_${Dt}_questionBtl_${e}`,[e,Dt]),Ve=x.useMemo(()=>Object.fromEntries(vr.map(ve=>[ve.key,""])),[vr]),[zt,yt]=x.useState(Ve);x.useEffect(()=>{if(!mt)return;const ve=Jn(ur);yt(ve&&typeof ve=="object"?{...Ve,...ve}:Ve)},[mt,ur,Ve]);const St=(ve,rt)=>{yt(ut=>{const pt={...ut||{},[ve]:rt};return Gn(ur,pt),pt})},sr=x.useMemo(()=>`model_${Dt}_sheet_${e}_${String(r??"none")}`,[e,r,Dt]);x.useEffect(()=>{if(!mt)return;const ve=Jn(sr);ie(ve&&typeof ve=="object"?ve:{})},[mt,sr]);const pr=x.useMemo(()=>`model_theory_sheet_${e}_${String(r??"none")}`,[e,r]);x.useEffect(()=>{if(mt)return;const ve=Jn(pr);O(ve&&typeof ve=="object"?ve:{})},[mt,pr]);const we=(ve,rt)=>{ie(ut=>{const pt={...ut||{},[ve]:rt};return Gn(sr,pt),pt})},Ie=(ve,rt)=>{O(ut=>{const pt={...ut||{},[ve]:rt};return Gn(pr,pt),pt})},tt=ve=>{if(mt){ie(ve),Gn(sr,ve);return}O(ve),Gn(pr,ve)};x.useEffect(()=>{if(!re||!e||Ce||C.current)return;let ve=!1;const rt=window.setTimeout(async()=>{try{await Mi("model",e,st()),ve||L(new Date().toLocaleString())}catch{}},700);return()=>{ve=!0,window.clearTimeout(rt)}},[re,e,r,Ce,te,lt,Ze,zt,le,Q]);const dt=(ve,rt)=>{const ut=String(ve??"");if(ut.trim()==="")return"";const pt=Number(ut);return Number.isFinite(pt)?Math.max(0,Math.min(rt,pt)):""},xt=ve=>{const ut=(Math.round((ve+Number.EPSILON)*10)/10).toFixed(1);return ut.endsWith(".0")?ut.slice(0,-2):ut},Cr=()=>mt?vr:Ar,nn=()=>{const ve=Cr(),rt=(u||[]).map((pt,Pr)=>{const Kr=$t(pt,Pr),pn=(Qe||{})[Kr]||{},Nn=pn.q&&typeof pn.q=="object"?pn.q:{},_n={sno:Pr+1,registerNo:String(pt.reg_no||""),name:String(pt.name||""),absent:pn.absent?"YES":"",absentKind:pn.absent?s(pn.absentKind):""};if(ve.forEach(kn=>{const Wn=Nn[kn.key],M=Number(Wn);_n[kn.label]=Number.isFinite(M)?Math.max(0,Math.min(kn.max,M)):""}),mt){const kn=Number(pn.lab);_n[Mr]=Number.isFinite(kn)?Math.max(0,Math.min(Gr,kn)):""}return _n}),ut=mt?String(lt||"TCPL"):"THEORY";Lxe(`${Jb(e)}_MODEL_${Jb(ut)}.csv`,rt)},ct=()=>{const ve=Cr();if(!u.length)return;const rt=["Register No","Student Name",...ve.map(Nn=>`${Nn.label} (${Nn.max})`)];mt&&rt.push(`${Mr} (${Gr})`),rt.push("Status","Absence Kind");const ut=u.map(Nn=>{const _n=[String(Nn.reg_no||""),String(Nn.name||"")],kn=ve.map(()=>"");return mt?[..._n,...kn,"","present","AL"]:[..._n,...kn,"present","AL"]}),pt=bs.aoa_to_sheet([rt,...ut]);pt["!freeze"]={xSplit:0,ySplit:1};const Pr=bs.book_new();bs.book_append_sheet(Pr,pt,"MODEL");const Kr=mt?String(lt||"TCPL"):"THEORY",pn=`${Jb(e)}_MODEL_${Jb(Kr)}_template.xlsx`;dy(Pr,pn)},Ht=()=>{var ve;Ce||(ve=be.current)==null||ve.click()},Ue=async ve=>{var rt;if(ve){ge(!0);try{const ut=Cr(),pt=await ve.arrayBuffer(),Pr=N0(pt,{type:"array"}),Kr=(rt=Pr.SheetNames)==null?void 0:rt[0];if(!Kr)throw new Error("No sheet found in the Excel file.");const pn=Pr.Sheets[Kr],Nn=bs.sheet_to_json(pn,{header:1});if(!Nn.length)throw new Error("Excel sheet is empty.");const _n=(Nn[0]||[]).map(Rxe),kn=lr=>_n.findIndex(Sr=>lr(Sr)),Wn=kn(lr=>lr==="register no"||lr==="reg no"||lr.includes("register")),M=kn(lr=>lr==="status"||lr.includes("status")),oe=kn(lr=>lr==="absence kind"||lr==="absent kind"||lr==="kind");if(Wn<0)throw new Error("Could not find Register No column.");const Re=ut.map(lr=>{const Sr=String(lr.label||"").toLowerCase(),Hr=kn(Jr=>Jr===Sr||Jr.startsWith(Sr));return{q:lr,col:Hr}}),Je=mt?kn(lr=>lr===String(Mr||"").toLowerCase()||lr.startsWith(String(Mr||"").toLowerCase())):-1,kt=new Map;u.forEach((lr,Sr)=>{const Hr=String(lr.reg_no||"").trim();Hr&&kt.set(Hr,$t(lr,Sr))});const mr={...Qe||{}};for(let lr=1;lr<Nn.length;lr++){const Sr=Nn[lr]||[],Hr=String(Sr[Wn]??"").trim();if(!Hr)continue;const Jr=kt.get(Hr);if(!Jr)continue;const me=mr[Jr]||{},Pe={...me.q||{}};Re.forEach(({q:br,col:wr})=>{if(wr<0)return;const zr=Sr[wr],Wr=Number(zr);Pe[br.key]=Number.isFinite(Wr)?Math.max(0,Math.min(br.max,Wr)):""});const et=M>=0?String(Sr[M]??"").trim().toLowerCase():"",xe=et==="absent"||et==="ab"||et==="a",ze=oe>=0?Sr[oe]:"AL",Vt=s(ze),Nt={...me,q:Pe,absent:xe,absentKind:Vt};if(mt&&Je>=0){const br=Number(Sr[Je]);Nt.lab=Number.isFinite(br)?Math.max(0,Math.min(Gr,br)):""}mr[Jr]=Nt}tt(mr)}finally{ge(!1)}}},qe=async ve=>{var ut;const rt=(ut=ve.target.files)==null?void 0:ut[0];if(ve.target.value="",!!rt)try{await Ue(rt)}catch(pt){alert((pt==null?void 0:pt.message)||"Failed to import Excel")}},at=x.useMemo(()=>{const ve=Array.from({length:or},()=>0);return vr.forEach((rt,ut)=>{const pt=fr[ut]??1;pt>=1&&pt<=or&&(ve[pt-1]+=rt.max)}),ve},[vr,fr,or]),Be=x.useMemo(()=>bn?at.map((ve,rt)=>rt===4?Gr:ve):at.map(ve=>ve+kr),[at,kr,bn,Gr]),vt=x.useMemo(()=>{const ve=[0,0,0,0,0,0];return vr.forEach(rt=>{const ut=(zt||{})[rt.key]??"";typeof ut=="number"&&ut>=1&&ut<=6&&(ve[ut-1]+=rt.max)}),ve},[vr,zt]),jt=x.useMemo(()=>{const ve=new Set;return vr.forEach(rt=>{const ut=(zt||{})[rt.key]??"";(ut===1||ut===2||ut===3||ut===4||ut===5||ut===6)&&ve.add(ut)}),ve.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(rt=>ve.has(rt))},[vr,zt]),$t=(ve,rt)=>{const ut=ve==null?void 0:ve.id;if(typeof ut=="number"&&ut>0)return`id:${ut}`;const pt=String((ve==null?void 0:ve.reg_no)||"").trim();return pt?`reg:${pt}`:`idx:${rt}`},Rr=x.useRef({}),Ur=ve=>rt=>{Rr.current[ve]=rt},en=ve=>{const rt=Rr.current[ve];if(rt){rt.focus();try{rt.select()}catch{}}},vn=4+vr.length+1+1+or*2+jt.length*2,Nr=x.useMemo(()=>{const ve=new Set;return Ar.forEach(rt=>{const ut=(Ze||{})[rt.key]??"";(ut===1||ut===2||ut===3||ut===4||ut===5||ut===6)&&ve.add(ut)}),ve.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(rt=>ve.has(rt))},[Ar,Ze]),fn=4+Ar.length+1+Zt*2+Nr.length*2,rr=x.useMemo(()=>K?Fr.filter((ve,rt)=>{var pt;const ut=$t(ve,rt);return R&&R.length?R.includes(ut):!!((pt=(Qe||{})[ut])!=null&&pt.absent)}):Fr,[Fr,K,Qe,R]);return a.jsxs("div",{children:[q?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>Y(null),children:a.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:ve=>ve.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:q.title}),a.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:q.message}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn",onClick:()=>Y(null),children:"Close"})})]})}):null,a.jsxs("div",{style:{marginBottom:10,color:"#6b7280",fontSize:12},children:["Subject: ",a.jsx("b",{children:e})," | Assessment: ",a.jsx("b",{children:"MODEL"}),lt?a.jsxs(a.Fragment,{children:[" ","| Class: ",a.jsx("b",{children:lt})]}):null," ","| QP: ",a.jsx("b",{children:Ee||"QP1"})]}),f?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,p?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:p}):null,g?a.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fed7aa",color:"#9a3412",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:g}):null,a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:nn,className:"obe-btn obe-btn-secondary",disabled:!u.length,children:"Export CSV"}),a.jsx("button",{onClick:ct,className:"obe-btn obe-btn-secondary",disabled:!u.length,children:"Export Excel"}),a.jsx("button",{onClick:Ht,className:"obe-btn obe-btn-secondary",disabled:!u.length||Ce||fe,children:fe?"Importing":"Import Excel"}),a.jsx("input",{ref:be,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:qe})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:ht,className:"obe-btn obe-btn-success",disabled:b||!e||Ce,title:Ce?"Published sheets are locked (IQAC must open editing).":void 0,children:b?"Saving":"Save Draft"}),a.jsx("button",{onClick:Ut,className:"obe-btn obe-btn-primary",disabled:It?ft:w||u.length===0||!xr||ne||Tr,title:u.length===0?"No students in roster":xr?Tr?"Publishing locked by IQAC":void 0:"Publish window is closed.",children:It?ft?"Request Pending":"Request Edit":w?"Publishing":"Publish"}),A&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",A]}),E&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",E]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:xr?"#065f46":"#b91c1c"},children:bt?"Checking publish due time":qr||(Pt!=null&&Pt.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(Pt.due_at).toLocaleString(),"  Remaining: ",ng(Tt)]}):"Due time not set by IQAC.")}),Tr?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>Zr(),disabled:bt,children:"Refresh"})})]}):xr?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:I,onChange:ve=>Z(ve.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>Zr(),disabled:pe||bt,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Gt,disabled:pe||!e,children:pe?"Requesting":"Request Approval"})]}),Ae?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:Ae}):null]}),a.jsxs("div",{style:{marginBottom:10,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:A||""}),P?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:P})]}):null]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:E||""}),a.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",disabled:!Yr||!e,onClick:()=>ir(!0,{applyToMain:!0}),title:Yr?void 0:"Publish first to view the published snapshot.",children:z?"Loading":"View Published"}),a.jsx("button",{className:"obe-btn",onClick:()=>Br(),disabled:!e,children:"Refresh Lock"})]}),de?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:de}):null]})]}),Ce?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Published & locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Editing and auto-save are disabled until IQAC opens the edit window."})]}):null,_e?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>De(!1),children:a.jsxs("div",{style:{width:"min(520px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:16,border:"1px solid #e5e7eb",padding:14,boxShadow:"0 12px 30px rgba(0,0,0,0.18)"},onClick:ve=>ve.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:6,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",Ot?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:We,onChange:ve=>Ct(ve.target.value),placeholder:"Explain why you need to edit (required)",rows:3,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{className:"obe-btn",disabled:_t,onClick:()=>De(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:_t||ft||!e||!String(We||"").trim(),onClick:cr,children:_t?"Sending":ft?"Request Pending":"Send Request"})]})]})})}):null,a.jsx(a.Fragment,{children:a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:10},children:a.jsxs("button",{className:"obe-btn",disabled:!dn,onClick:()=>{if(K)return;const ve=(Fr||[]).map((rt,ut)=>{var pt;return{key:$t(rt,ut),isAbsent:!!((pt=(Qe||{})[$t(rt,ut)])!=null&&pt.absent)}}).filter(rt=>rt.isAbsent).map(rt=>rt.key);J(ve),V(!0)},title:dn?"Filter the table to show only absentees":"No absentees marked yet",style:K?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",K?a.jsx("span",{onClick:ve=>{ve.stopPropagation(),V(!1),J(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]})})}),a.jsxs("div",{style:{position:"relative",minHeight:Ce&&!nt?220:void 0},children:[Yr&&Ce?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.24) 100%)"}}):null,Yr&&Ce?a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,background:"#fff",border:"1px solid #e5e7eb",padding:"10px 14px",borderRadius:999,display:"flex",alignItems:"center",gap:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",pointerEvents:"auto",maxWidth:"min(720px, 96vw)"},children:[a.jsx("div",{style:{width:34,height:34,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #f59e0b33",color:"#92400e"},"aria-hidden":"true",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M7 11V8a5 5 0 0 1 10 0v3",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M6 11h12a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2Z",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsxs("div",{style:{minWidth:0},children:[a.jsx("div",{style:{fontWeight:900,fontSize:18,color:"#111827",lineHeight:1.1},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginTop:2},children:z?"Loading published marks":de||"Marks are published. IQAC approval is required to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",disabled:!Yr||!e,onClick:async()=>{Ne(ve=>!ve);try{await ir(!0,{applyToMain:!0})}catch{}},title:Yr?void 0:"Publish first to view the published snapshot.",children:z?"Loading":"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e||ft,onClick:async()=>{if(ft){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}De(!0)},title:"Ask IQAC to open editing for published marks",children:ft?"Request Pending":"Request Edit"})]})]}):null,a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto",pointerEvents:Ce?"none":void 0,opacity:Ce?.78:1,display:Ce&&!nt?"none":void 0},children:mt?a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:o,colSpan:vn,children:["MODEL (",lt||"TCPL"," Header Template)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"AB"}),vr.map(ve=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve.label},ve.key)),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:Mr}),a.jsx("th",{style:o,colSpan:or*2,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:jt.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:vr.length,children:"COS"}),a.jsx("th",{style:o,colSpan:or*2,children:""}),a.jsx("th",{style:o,colSpan:jt.length*2,children:""})]}),a.jsxs("tr",{children:[fr.map((ve,rt)=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve},`co-map-${rt}`)),Array.from({length:or}).map((ve,rt)=>a.jsxs("th",{style:o,colSpan:2,children:["CO-",rt+1]},`co-head-${rt}`)),jt.map(ve=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",ve]},`btl-head-${ve}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:vr.length,children:"BTL"}),a.jsx("th",{style:o,children:""}),a.jsx("th",{style:o,children:""}),Array.from({length:or+jt.length}).flatMap((ve,rt)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`mkpct-${rt}`))]}),a.jsxs("tr",{children:[vr.map(ve=>{const rt=(zt||{})[ve.key]??"",ut=rt===""?"-":String(rt);return a.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:a.jsxs("div",{style:{position:"relative",minWidth:40},children:[a.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${ut}`,children:ut}),a.jsxs("select",{"aria-label":`BTL for ${ve.label}`,value:rt,onChange:pt=>St(ve.key,pt.target.value===""?"":Number(pt.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"}),a.jsx("option",{value:"6",children:"6"})]})]})},`btl-map-${ve.key}`)}),a.jsx("th",{style:o,children:""}),a.jsx("th",{style:o,children:""}),Array.from({length:or*2+jt.length*2}).map((ve,rt)=>a.jsx("th",{style:o,children:""},`tailblank-${rt}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:o,children:"S.No"}),a.jsx("th",{style:o,children:"Register No."}),a.jsx("th",{style:o,children:"Name / Max Marks"}),a.jsx("th",{style:o,children:""}),vr.map(ve=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve.max},`qmax-${ve.key}`)),a.jsx("th",{style:o,children:Lt}),a.jsx("th",{style:o,children:"30"}),Be.flatMap((ve,rt)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:o,children:xt(ve)}),a.jsx("th",{style:o,children:"%"})]},`co-max-mm-${rt}`)),jt.flatMap(ve=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:o,children:xt(vt[ve-1]||0)}),a.jsx("th",{style:o,children:"%"})]},`btl-max-mm-${ve}`))]})]}),a.jsx("tbody",{children:rr.map((ve,rt)=>a.jsx("tr",{children:(()=>{const ut=$t(ve,rt),pt=(Q||{})[ut]||{},Pr=!!pt.absent,Kr=pt.lab??"",pn=Pr?s(pt.absentKind):null,Nn=!!(K&&Pr&&(pn==="ML"||pn==="SKL")),_n=Pr&&pn==="AL"?0:null,kn=Pr&&pn==="ML"?60:Pr&&pn==="SKL"?75:null,Wn={};vr.forEach(xe=>{const ze=(pt.q||{})[xe.key]??"",Vt=typeof ze=="number"&&Number.isFinite(ze)?ze:0;Wn[xe.key]=Math.max(0,Math.min(xe.max,Vt))});const M=typeof Kr=="number"&&Number.isFinite(Kr)?Math.max(0,Math.min(Gr,Kr)):0,oe=Object.values(Wn).reduce((xe,ze)=>xe+ze,0),Re=Array.from({length:or},()=>0);if(vr.forEach((xe,ze)=>{const Vt=fr[ze]??1;Vt>=1&&Vt<=or&&(Re[Vt-1]+=Wn[xe.key]||0)}),bn)Re[4]+=M;else for(let xe=0;xe<or;xe++)Re[xe]+=M/or;const Je=Re.map((xe,ze)=>{const Vt=Be[ze]||0;return Vt?xe/Vt*100:0}),kt=[0,0,0,0,0,0];vr.forEach(xe=>{const ze=(zt||{})[xe.key]??"";typeof ze=="number"&&ze>=1&&ze<=6&&(kt[ze-1]+=Wn[xe.key]||0)});const mr=kt.map((xe,ze)=>{const Vt=vt[ze]||0;return Vt?xe/Vt*100:0}),lr=xe=>{if(xe){we(ut,{...pt,absent:!0,absentKind:s(pt.absentKind),q:Object.fromEntries(vr.map(ze=>[ze.key,""])),lab:""});return}we(ut,{...pt,absent:!1,absentKind:void 0})},Sr=xe=>{we(ut,{...pt,absent:!0,absentKind:s(xe)})},Hr=xe=>{Pr&&!Nn||we(ut,{...pt,lab:dt(xe,Gr)})},Jr=(xe,ze,Vt)=>{if(Pr&&!Nn)return;const Nt=dt(ze,Vt),br={...pt.q||{},[xe]:Nt};if(kn!=null&&vr.reduce((zr,Wr)=>{const sn=br[Wr.key]??"",an=typeof sn=="number"&&Number.isFinite(sn)?sn:0;return zr+Math.max(0,Math.min(Wr.max,an))},0)>kn){Y({title:"Mark limit exceeded",message:pn==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}we(ut,{...pt,q:br})},me=[...vr.map(xe=>xe.key),"lab"],Pe=(xe,ze)=>{const Vt=me.indexOf(xe),Nt=ze==="left"?Math.max(0,Vt-1):ze==="right"?Math.min(me.length-1,Vt+1):Vt,br=ze==="up"?Math.max(0,rt-1):ze==="down"?Math.min(rr.length-1,rt+1):rt,zr=`${$t(rr[br],br)}|${me[Nt]}`;en(zr)},et=xe=>ze=>{ze.key==="Tab"?(ze.preventDefault(),Pe(xe,ze.shiftKey?"left":"right")):ze.key==="ArrowLeft"?(ze.preventDefault(),Pe(xe,"left")):ze.key==="ArrowRight"?(ze.preventDefault(),Pe(xe,"right")):ze.key==="ArrowUp"||ze.key==="Enter"&&ze.shiftKey?(ze.preventDefault(),Pe(xe,"up")):(ze.key==="ArrowDown"||ze.key==="Enter")&&(ze.preventDefault(),Pe(xe,"down"))};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:rt+1}),a.jsx("td",{style:l,children:ve.reg_no||""}),a.jsx("td",{style:l,children:ve.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Pr,onChange:xe=>lr(xe.target.checked)}),Pr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:pn||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:pn||"AL",onChange:xe=>Sr(s(xe.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),vr.map(xe=>{const ze=(pt.q||{})[xe.key]??"",Vt=`${ut}|${xe.key}`;return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:Ur(Vt),type:"text",inputMode:"decimal",disabled:Pr&&!Nn,value:ze===""?"":String(ze),onChange:Nt=>Jr(xe.key,Nt.target.value,xe.max),onFocus:Nt=>Nt.currentTarget.select(),onKeyDown:et(xe.key),style:Fe})},`${rt}-${xe.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:xt(_n??oe)}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:Ur(`${ut}|lab`),type:"text",inputMode:"decimal",disabled:Pr&&!Nn,value:Kr===""?"":String(Kr),onChange:xe=>Hr(xe.target.value),onFocus:xe=>xe.currentTarget.select(),onKeyDown:et("lab"),style:Fe})}),Re.flatMap((xe,ze)=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:xt(xe)}),a.jsx("td",{style:{...l,textAlign:"center"},children:xt(Je[ze])})]},`co-${rt}-${ze}`)),jt.flatMap(xe=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:xt(kt[xe-1]||0)}),a.jsx("td",{style:{...l,textAlign:"center"},children:xt(mr[xe-1]||0)})]},`btl-${rt}-${xe}`))]})})()},String(ve.id??rt)))})]}):a.jsx(a.Fragment,{children:He?a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:o,colSpan:fn,children:"MODEL (THEORY Header Template)"})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"ABSENT"}),Ar.map(ve=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve.label},ve.key)),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),a.jsx("th",{style:o,colSpan:Zt*2,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:Nr.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:Ar.length,children:"COs"}),a.jsx("th",{style:o,colSpan:Zt*2,children:""}),a.jsx("th",{style:o,colSpan:Nr.length*2,children:""})]}),a.jsxs("tr",{children:[it.map((ve,rt)=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve},`theory-co-map-${rt}`)),Array.from({length:Zt}).map((ve,rt)=>a.jsxs("th",{style:o,colSpan:2,children:["CO-",rt+1]},`theory-co-head-${rt}`)),Nr.map(ve=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",ve]},`theory-btl-head-${ve}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:Ar.length,children:"BTL"}),a.jsx("th",{style:o,children:""}),Array.from({length:Zt+Nr.length}).flatMap((ve,rt)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`theory-mkpct-${rt}`))]}),a.jsxs("tr",{children:[Ar.map((ve,rt)=>{const ut=(Ze||{})[ve.key]??"",pt=ut===""?"-":String(ut);return a.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:a.jsxs("div",{style:{position:"relative",minWidth:40},children:[a.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${pt}`,children:pt}),a.jsxs("select",{"aria-label":`BTL for ${ve.label}`,value:ut,onChange:Pr=>Bt(ve.key,Pr.target.value===""?"":Number(Pr.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"}),a.jsx("option",{value:"6",children:"6"})]})]})},`theory-btl-map-${ve.key}`)}),a.jsx("th",{style:o,children:""}),Array.from({length:Zt*2+Nr.length*2}).map((ve,rt)=>a.jsx("th",{style:o,children:""},`theory-tailblank-${rt}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:o,children:"S.No"}),a.jsx("th",{style:o,children:"Register No."}),a.jsx("th",{style:o,children:"Name / Max Marks"}),a.jsx("th",{style:o,children:""}),Ar.map(ve=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:ve.max},`theory-qmax-${ve.key}`)),a.jsx("th",{style:o,children:Kt}),ar.flatMap((ve,rt)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:o,children:xt(ve)}),a.jsx("th",{style:o,children:"%"})]},`theory-co-max-mm-${rt}`)),Nr.flatMap(ve=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:o,children:xt(Yt[ve-1]||0)}),a.jsx("th",{style:o,children:"%"})]},`theory-btl-max-mm-${ve}`))]})]}),a.jsx("tbody",{children:rr.map((ve,rt)=>a.jsx("tr",{children:(()=>{const ut=$t(ve,rt),pt=(Qe||{})[ut]||{},Pr=!!pt.absent,Kr=Pr?s(pt.absentKind):null,pn=!!(K&&Pr&&(Kr==="ML"||Kr==="SKL")),Nn=Pr&&Kr==="AL"?0:null,_n=Pr&&Kr==="ML"?60:Pr&&Kr==="SKL"?75:null,kn={};Ar.forEach(Sr=>{const Hr=(pt.q||{})[Sr.key]??"",Jr=typeof Hr=="number"&&Number.isFinite(Hr)?Hr:0;kn[Sr.key]=Math.max(0,Math.min(Sr.max,Jr))});const Wn=Object.values(kn).reduce((Sr,Hr)=>Sr+Hr,0),M=Array.from({length:Zt},()=>0);Ar.forEach((Sr,Hr)=>{const Jr=it[Hr]??1;Jr>=1&&Jr<=Zt&&(M[Jr-1]+=kn[Sr.key]||0)});const oe=M.map((Sr,Hr)=>{const Jr=ar[Hr]||0;return Jr?Sr/Jr*100:0}),Re=[0,0,0,0,0,0];Ar.forEach((Sr,Hr)=>{const Jr=Qt[Hr];typeof Jr=="number"&&Jr>=1&&Jr<=6&&(Re[Jr-1]+=kn[Sr.key]||0)});const Je=Re.map((Sr,Hr)=>{const Jr=Yt[Hr]||0;return Jr?Sr/Jr*100:0}),kt=Sr=>{if(Sr){Ie(ut,{...pt,absent:!0,absentKind:s(pt.absentKind),q:Object.fromEntries(Ar.map(Hr=>[Hr.key,""]))});return}Ie(ut,{...pt,absent:!1,absentKind:void 0})},mr=Sr=>{Ie(ut,{...pt,absent:!0,absentKind:s(Sr)})},lr=(Sr,Hr,Jr)=>{if(Pr&&!pn)return;const me=dt(Hr,Jr),Pe={...pt.q||{},[Sr]:me};if(_n!=null&&Ar.reduce((xe,ze)=>{const Vt=Pe[ze.key]??"",Nt=typeof Vt=="number"&&Number.isFinite(Vt)?Vt:0;return xe+Math.max(0,Math.min(ze.max,Nt))},0)>_n){Y({title:"Mark limit exceeded",message:Kr==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}Ie(ut,{...pt,q:Pe})};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:rt+1}),a.jsx("td",{style:l,children:ve.reg_no||""}),a.jsx("td",{style:l,children:ve.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Pr,onChange:Sr=>kt(Sr.target.checked)}),Pr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:Kr||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:Kr||"AL",onChange:Sr=>mr(s(Sr.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),Ar.map(Sr=>{const Hr=(pt.q||{})[Sr.key]??"",Jr=`${ut}|${Sr.key}`,me=Ar.map(xe=>xe.key),Pe=(xe,ze)=>{const Vt=Math.max(0,me.indexOf(xe)),Nt=ze==="left"?Math.max(0,Vt-1):ze==="right"?Math.min(me.length-1,Vt+1):Vt,br=ze==="up"?Math.max(0,rt-1):ze==="down"?Math.min(rr.length-1,rt+1):rt,wr=$t(rr[br],br);en(`${wr}|${me[Nt]}`)},et=xe=>ze=>{ze.key==="Tab"?(ze.preventDefault(),Pe(xe,ze.shiftKey?"left":"right")):ze.key==="ArrowLeft"?(ze.preventDefault(),Pe(xe,"left")):ze.key==="ArrowRight"?(ze.preventDefault(),Pe(xe,"right")):ze.key==="ArrowUp"||ze.key==="Enter"&&ze.shiftKey?(ze.preventDefault(),Pe(xe,"up")):(ze.key==="ArrowDown"||ze.key==="Enter")&&(ze.preventDefault(),Pe(xe,"down"))};return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:Ur(Jr),type:"text",inputMode:"decimal",disabled:Pr&&!pn,value:Hr===""?"":String(Hr),onChange:xe=>lr(Sr.key,xe.target.value,Sr.max),onFocus:xe=>xe.currentTarget.select(),onKeyDown:et(Sr.key),style:Fe})},`${rt}-${Sr.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:xt(Nn??Wn)}),M.flatMap((Sr,Hr)=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:xt(Sr)}),a.jsx("td",{style:{...l,textAlign:"center"},children:xt(oe[Hr])})]},`theory-co-${rt}-${Hr}`)),Nr.flatMap(Sr=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:xt(Re[Sr-1]||0)}),a.jsx("td",{style:{...l,textAlign:"center"},children:xt(Je[Sr-1]||0)})]},`theory-btl-${rt}-${Sr}`))]})})()},String(ve.id??rt)))})]}):a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:o,colSpan:gt,children:"MODEL (Blank Template)"})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:3,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:32},rowSpan:3,children:"AB"}),a.jsx("th",{style:o,colSpan:je.length,children:"QUESTIONS"}),a.jsx("th",{style:o,rowSpan:3,children:"Total"}),a.jsx("th",{style:o,colSpan:4,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:i.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[je.map(ve=>a.jsx("th",{style:{...o,width:46,minWidth:46},children:ve.label},ve.key)),a.jsx("th",{style:o,colSpan:2,children:"CO-1"}),a.jsx("th",{style:o,colSpan:2,children:"CO-2"}),i.map(ve=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",ve]},`btl-head-${ve}`))]}),a.jsxs("tr",{children:[je.map(ve=>a.jsx("th",{style:{...o,width:46,minWidth:46},children:ve.max},ve.key)),Array.from({length:2+i.length}).flatMap((ve,rt)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},rt))]})]}),a.jsx("tbody",{children:rr.map((ve,rt)=>a.jsxs("tr",{children:[(()=>{const ut=$t(ve,rt),pt=(Qe||{})[ut]||{},Pr=!!pt.absent,Kr=Pr?s(pt.absentKind):null,pn=!!(K&&Pr&&(Kr==="ML"||Kr==="SKL")),Nn=Pr&&Kr==="AL"?0:null,_n=Pr&&Kr==="ML"?60:Pr&&Kr==="SKL"?75:null,kn={};je.forEach(Je=>{const kt=(pt.q||{})[Je.key]??"",mr=typeof kt=="number"&&Number.isFinite(kt)?kt:0;kn[Je.key]=Math.max(0,Math.min(Je.max,mr))});const Wn=Object.values(kn).reduce((Je,kt)=>Je+kt,0),M=Je=>{if(Je){Ie(ut,{...pt,absent:!0,absentKind:s(pt.absentKind),q:Object.fromEntries(je.map(kt=>[kt.key,""]))});return}Ie(ut,{...pt,absent:!1,absentKind:void 0})},oe=Je=>{Ie(ut,{...pt,absent:!0,absentKind:s(Je)})},Re=(Je,kt,mr)=>{if(Pr&&!pn)return;const lr=dt(kt,mr),Sr={...pt.q||{},[Je]:lr};if(_n!=null&&je.reduce((Jr,me)=>{const Pe=Sr[me.key]??"",et=typeof Pe=="number"&&Number.isFinite(Pe)?Pe:0;return Jr+Math.max(0,Math.min(me.max,et))},0)>_n){Y({title:"Mark limit exceeded",message:Kr==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}Ie(ut,{...pt,q:Sr})};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:rt+1}),a.jsx("td",{style:l,children:ve.reg_no||""}),a.jsx("td",{style:l,children:ve.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Pr,onChange:Je=>M(Je.target.checked)}),Pr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:Kr||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:Kr||"AL",onChange:Je=>oe(s(Je.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),je.map(Je=>{const kt=(pt.q||{})[Je.key]??"",mr=`${ut}|${Je.key}`,lr=je.map(Jr=>Jr.key),Sr=(Jr,me)=>{const Pe=Math.max(0,lr.indexOf(Jr)),et=me==="left"?Math.max(0,Pe-1):me==="right"?Math.min(lr.length-1,Pe+1):Pe,xe=me==="up"?Math.max(0,rt-1):me==="down"?Math.min(rr.length-1,rt+1):rt,ze=$t(rr[xe],xe);en(`${ze}|${lr[et]}`)},Hr=Jr=>me=>{me.key==="Tab"?(me.preventDefault(),Sr(Jr,me.shiftKey?"left":"right")):me.key==="ArrowLeft"?(me.preventDefault(),Sr(Jr,"left")):me.key==="ArrowRight"?(me.preventDefault(),Sr(Jr,"right")):me.key==="ArrowUp"||me.key==="Enter"&&me.shiftKey?(me.preventDefault(),Sr(Jr,"up")):(me.key==="ArrowDown"||me.key==="Enter")&&(me.preventDefault(),Sr(Jr,"down"))};return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:Ur(mr),type:"text",inputMode:"decimal",disabled:Pr&&!pn,value:kt===""?"":String(kt),onChange:Jr=>Re(Je.key,Jr.target.value,Je.max),onFocus:Jr=>Jr.currentTarget.select(),onKeyDown:Hr(Je.key),style:Fe})},`${rt}-${Je.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:xt(Nn??Wn)})]})})(),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),i.flatMap(ut=>a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""})]},`${rt}-btl-${ut}`))]},String(ve.id??rt)))})]})})})})]})]})}function Dk({subjectId:e,teachingAssignmentId:t,assessmentKey:r,viewerMode:n}){const i=r==="cia1"?{label:"CIA 1 Review",coA:1,coB:2}:r==="cia2"?{label:"CIA 2 Review",coA:3,coB:4}:{label:"MODEL Review",coA:5,coB:null};return a.jsx(Ix,{subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:!0,floatPanelOnTable:!0,label:i.label,coA:i.coA,coB:i.coB,initialEnabledCos:[1,2,3,4,5],viewerMode:!!n,itemLabel:"Content",itemLabelPlural:"Content",itemAbbrev:"Con",ciaExamAvailable:!0,absentEnabled:!0,autoSaveDraft:!0})}function $k({subjectId:e,teachingAssignmentId:t,assessmentKey:r,viewerMode:n,classType:i}){const s=ti(i||"");if(s&&s!=="PROJECT")return a.jsx("div",{style:{color:"#6b7280"},children:"Review mark entry is available only for PROJECT class type courses."});const o=r==="cia1"?{label:"CIA 1 Review",coA:1,coB:2}:r==="cia2"?{label:"CIA 2 Review",coA:3,coB:4}:{label:"MODEL Review",coA:5,coB:null};return a.jsx(Ix,{subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:!0,floatPanelOnTable:!0,label:o.label,coA:o.coA,coB:o.coB,initialEnabledCos:[1,2,3,4,5],viewerMode:!!n,itemLabel:"Content",itemLabelPlural:"Content",itemAbbrev:"Con",ciaExamAvailable:!0,absentEnabled:!0,autoSaveDraft:!0})}function Fxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(ew,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review1",label:r||"Review 1",coA:1,coB:2})}function Ixe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(ew,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review2",label:r||"Review 2",coA:2,coB:3})}const Dxe=20,MM={co1:10,co2:10},Sp={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},Ip=10;function ro(e,t,r){return Math.max(t,Math.min(r,e))}function Ul(e){return Math.round(e*10)/10}function pl(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Xv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function _p(e,t,r){const n=e==null?void 0:e.btlMax,i=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Xv(i);return s??r}function $xe(e){const t=Number(e);return Number.isFinite(t)&&t>0?t:Ip}function Uxe(e,t){return`${t}_sheet_${e}`}function LM(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function zxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Wxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Uk(e){return e.slice(-8)}function qxe({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa1"}){var nn,ct,Ht;const i=String(r||"SSA1"),s=n==="review1",o=!1,l=x.useMemo(()=>Uxe(e,n),[e,n]),c=n==="review1"?kS:rg,u=n==="review1"?T9:E9,[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),y=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),b=((nn=d==null?void 0:d.assessments)==null?void 0:nn.ssa1)||{},v=Number.isFinite(Number(b==null?void 0:b.maxTotal))?Number(b.maxTotal):Dxe,w=s?30:v,S={co1:Number.isFinite(Number((ct=b==null?void 0:b.coMax)==null?void 0:ct.co1))?Number(b.coMax.co1):MM.co1,co2:Number.isFinite(Number((Ht=b==null?void 0:b.coMax)==null?void 0:Ht.co2))?Number(b.coMax.co2):MM.co2},k=s?{co1:15,co2:15}:S,j={btl1:_p(b,1,Sp.btl1),btl2:_p(b,2,Sp.btl2),btl3:_p(b,3,Sp.btl3),btl4:_p(b,4,Sp.btl4),btl5:_p(b,5,Sp.btl5),btl6:_p(b,6,Sp.btl6)},A=s?30:Ip,L=x.useRef(null),[P,B]=x.useState(!1);x.useEffect(()=>{let Ue=!0;return(async()=>{try{const qe=await vu();if(!Ue)return;f(qe||null),g(at=>({...at,termLabel:String((qe==null?void 0:qe.termLabel)||at.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{Ue=!1}},[e]);const[E,T]=x.useState(!1),[F,W]=x.useState(null),[z,se]=x.useState(()=>s?[3,4]:[]),[de,U]=x.useState(!1),[G,re]=x.useState(!1),[X,C]=x.useState(null),[K,V]=x.useState(null),[R,J]=x.useState(null),[q,Y]=x.useState(null),[Q,ie]=x.useState(!1),[le,O]=x.useState(!1),[H,ae]=x.useState(""),[I,Z]=x.useState(!1),[pe,Oe]=x.useState(null),[Ae,ke]=x.useState(null),[_e,De]=x.useState(!1),[We,Ct]=x.useState(null),[_t,Xe]=x.useState(!1),[nt,Ne]=x.useState(null),{data:be,loading:fe,error:ge,remainingSeconds:lt,publishAllowed:He,refresh:mt}=H0({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:wt,loading:Pt,error:bt,refresh:qr}=V0({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:Tt}=nc({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:xr}=nc({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),Zr=!!(be!=null&&be.global_override_active&&(be==null?void 0:be.global_is_open)===!1),[Xr,Br]=x.useState(""),[Vr,An]=x.useState(!1),[Yr,Ln]=x.useState(null),[Me,Ce]=x.useState(null),[It,ft]=x.useState(!1),[Ot,er]=x.useState(null),[hr,Tr]=x.useState(!1),ne=!!q||!!(wt!=null&&wt.exists&&(wt!=null&&wt.is_published))||!!Ae,te=!!!(e&&!It)&&ne,[ue,Ee]=x.useState(null);x.useEffect(()=>{Ee(null),Y(null),ke(null),Ct(null),O(!1),ae(""),Oe(null)},[e,n,t]);const je=!!m.markManagerLocked,gt=xr!=null&&xr.approval_until?String(xr.approval_until):null,Qe=Tt!=null&&Tt.approval_until?String(Tt.approval_until):null,Fe=!!(xr!=null&&xr.allowed_by_approval)&&!!gt&&gt!==((ue==null?void 0:ue.markEntryApprovalUntil)??null),$e=!!(Tt!=null&&Tt.allowed_by_approval)&&!!Qe&&Qe!==((ue==null?void 0:ue.markManagerApprovalUntil)??null),st=ne?!!(wt!=null&&wt.entry_open)||Fe||$e:!0,Wt=!!(ne&&!st),{pending:qt,pendingUntilMs:ht,setPendingUntilMs:Ut,refresh:Gt}=G0({enabled:!!(ne&&Wt)&&!!e,assessment:n,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!le||!!Me||!!Q);const cr=!!e&&(Pt||!!bt||wt==null),ir=!!(Zr||cr||(wt?!wt.entry_open:ne?!st:!je)),Fr=!!(Zr||Wt||ir),dn=m.markManagerSnapshot!=null,vr=x.useMemo(()=>{const Ue=new Set(z);return[1,2,3,4,5,6].filter(qe=>Ue.has(qe))},[z]),Lt=x.useMemo(()=>8+vr.length*2,[vr.length,o]),Gr=x.useMemo(()=>{try{return m.rows.some(Ue=>!!Ue.absent||Object.values(Ue).some(qe=>typeof qe=="string"&&String(qe).toLowerCase().includes("absent")))}catch{return!1}},[m.rows]),bn=x.useMemo(()=>_t?nt&&nt.length?m.rows.filter(Ue=>nt.includes(Number(Ue.studentId))):m.rows.filter(Ue=>!!Ue.absent||Object.values(Ue).some(qe=>typeof qe=="string"&&String(qe).toLowerCase().includes("absent"))):m.rows,[m.rows,_t,nt]);x.useEffect(()=>{if(!e)return;try{const at=`${n}_selected_btls_${e}`;Gn(at,z)}catch{}let Ue=!1;const qe=setTimeout(async()=>{try{await Mi(n,e,{sheet:m,selectedBtls:z});try{l&&Gn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}Ue||V(new Date().toLocaleString())}catch{}},700);return()=>{Ue=!0,clearTimeout(qe)}},[z,e,m,n,l]),x.useEffect(()=>{if(!e)return;const Ue=Jn(l);Ue&&typeof Ue=="object"&&Array.isArray(Ue.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(Ue.termLabel||"KRCT AY25-26"),batchLabel:e,rows:Ue.rows}):g({termLabel:y||"KRCT AY25-26",batchLabel:e,rows:[]})},[l,e,d,y]),x.useEffect(()=>{let Ue=!0;return(async()=>{if(e)try{const qe=await ei(n,e);if(!Ue)return;const at=qe==null?void 0:qe.draft,Be=at==null?void 0:at.sheet,vt=at==null?void 0:at.selectedBtls;if(Be&&typeof Be=="object"&&Array.isArray(Be.rows)){g(Rr=>({...Rr,termLabel:String(Be.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Be.rows,markManagerSnapshot:(Be==null?void 0:Be.markManagerSnapshot)??Rr.markManagerSnapshot??null,markManagerApprovalUntil:(Be==null?void 0:Be.markManagerApprovalUntil)??Rr.markManagerApprovalUntil??null,markManagerLocked:typeof(Be==null?void 0:Be.markManagerLocked)=="boolean"?Be.markManagerLocked:!!((Be==null?void 0:Be.markManagerSnapshot)??Rr.markManagerSnapshot)}));const jt=(qe==null?void 0:qe.updated_at)??null,$t=(qe==null?void 0:qe.updated_by)??null;if(jt)try{V(new Date(String(jt)).toLocaleString())}catch{V(String(jt))}$t&&J(String($t.name||$t.username||$t.id||""));try{l&&Gn(l,{termLabel:String(Be.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Be.rows})}catch{}}if(Array.isArray(vt)){se(vt.map(jt=>Number(jt)).filter(jt=>Number.isFinite(jt)));try{const jt=`${n}_selected_btls_${e}`;Gn(jt,vt.map($t=>Number($t)).filter($t=>Number.isFinite($t)))}catch{}}}catch{}})(),()=>{Ue=!1}},[e,y,n,l]),x.useEffect(()=>{if(!e)return;if((!!(wt!=null&&wt.exists&&(wt!=null&&wt.is_published))||!!q)&&(wt!=null&&wt.exists)){const Be=!!(wt!=null&&wt.mark_manager_locked);!!m.markManagerLocked!==Be&&g(vt=>({...vt,markManagerLocked:Be}));return}const qe=!!(Tt!=null&&Tt.allowed_by_approval),at=Tt!=null&&Tt.approval_until?String(Tt.approval_until):null;if(qe&&at){if(at===((ue==null?void 0:ue.markManagerApprovalUntil)??null))return;const Be=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&Be!==at&&g(vt=>({...vt,markManagerLocked:!1,markManagerApprovalUntil:at}));return}},[e,wt==null?void 0:wt.exists,wt==null?void 0:wt.mark_manager_locked,Tt==null?void 0:Tt.allowed_by_approval,Tt==null?void 0:Tt.approval_until,m.markManagerLocked,q,ue==null?void 0:ue.markManagerApprovalUntil,m.markManagerApprovalUntil]);const or=Ue=>{g(qe=>{const at=new Map,Be=new Map;for(const jt of qe.rows||[])typeof jt.studentId=="number"&&at.set(jt.studentId,jt),jt.registerNo&&Be.set(String(jt.registerNo),jt);const vt=(Ue||[]).slice().sort(Wxe).map(jt=>{const $t=at.get(jt.id)||Be.get(String(jt.reg_no||""));return{studentId:jt.id,section:String(jt.section||""),registerNo:String(jt.reg_no||""),name:String(jt.name||""),total:typeof($t==null?void 0:$t.total)=="number"?ro(Number($t.total),0,w):(($t==null?void 0:$t.total)==="","")}});return{...qe,rows:vt}})},kr=async()=>{var Ue,qe,at;if(!e){W("Subject ID is required.");return}T(!0),W(null);try{let Be=[],vt=null;try{const jt=await lc();console.log("[SSA1] My TAs:",jt==null?void 0:jt.length,"for subject:",e,"teachingAssignmentId:",t),vt=(jt||[]).find($t=>{const Rr=String($t.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?$t.id===t:!1)||Rr}),vt?console.log("[SSA1] Found TA match:",vt.id,"elective_subject_id:",vt.elective_subject_id,"section_id:",vt.section_id):console.log("[SSA1] No TA match found in user TAs")}catch(jt){console.warn("[SSA1] My TAs fetch failed:",jt)}if(vt&&vt.elective_subject_id&&!vt.section_id){console.log("[SSA1] Detected elective, fetching elective-choices for elective_subject_id:",vt.elective_subject_id);try{const jt=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(vt.elective_subject_id))}`);if(jt.ok){const $t=await jt.json(),Rr=Array.isArray($t.results)?$t.results:Array.isArray($t)?$t:$t.items||[];console.log("[SSA1] Elective choices returned:",Rr==null?void 0:Rr.length,"students"),Be=(Rr||[]).map(Ur=>({id:Number(Ur.student_id??Ur.id),reg_no:String(Ur.reg_no??Ur.regno??""),name:String(Ur.name??Ur.full_name??Ur.username??""),section:Ur.section_name??Ur.section??null}))}else console.warn("[SSA1] Elective-choices API returned error:",jt.status)}catch(jt){console.warn("[SSA1] Elective-choices fetch failed:",jt)}}if(!Be.length&&vt&&vt.id){console.log("[SSA1] Fetching regular TA roster for TA ID:",vt.id);try{const jt=await qc(vt.id);Be=jt.students||[],p({courseName:String(((Ue=jt==null?void 0:jt.teaching_assignment)==null?void 0:Ue.subject_name)||(vt==null?void 0:vt.subject_name)||""),courseCode:String(((qe=jt==null?void 0:jt.teaching_assignment)==null?void 0:qe.subject_code)||(vt==null?void 0:vt.subject_code)||e||""),className:String(((at=jt==null?void 0:jt.teaching_assignment)==null?void 0:at.section_name)||(vt==null?void 0:vt.section_name)||"")}),console.log("[SSA1] Regular roster returned:",Be.length,"students")}catch(jt){console.warn("[SSA1] TA roster fetch failed:",jt)}}console.log("[SSA1] Final roster count:",Be.length),or(Be)}catch(Be){W((Be==null?void 0:Be.message)||"Failed to load roster")}finally{T(!1)}};x.useEffect(()=>{e&&kr()},[t,e]);async function Mr(Ue){if(e){Ue&&De(!0),Ct(null);try{const qe=await c(String(e));ke(qe||null)}catch(qe){Ue&&Ct((qe==null?void 0:qe.message)||`Failed to load published ${i} marks`)}finally{Ue&&De(!1)}}}x.useEffect(()=>{e&&Mr(!1)},[e,n,t]);const Ar=x.useRef(!!st);x.useEffect(()=>{Ar.current=!!st},[e,n,t,st]),x.useEffect(()=>{if(!e||!ne)return;if(Ar.current||!st){Ar.current=!!st;return}let qe=!0;return(async()=>{try{const at=await ei(n,String(e));if(!qe)return;const Be=at==null?void 0:at.draft,vt=Be==null?void 0:Be.sheet,jt=Be==null?void 0:Be.selectedBtls;vt&&typeof vt=="object"&&Array.isArray(vt.rows)&&g($t=>({...$t,termLabel:String(vt.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:vt.rows,markManagerSnapshot:(vt==null?void 0:vt.markManagerSnapshot)??$t.markManagerSnapshot??null,markManagerApprovalUntil:(vt==null?void 0:vt.markManagerApprovalUntil)??$t.markManagerApprovalUntil??null,markManagerLocked:typeof(vt==null?void 0:vt.markManagerLocked)=="boolean"?vt.markManagerLocked:!!((vt==null?void 0:vt.markManagerSnapshot)??$t.markManagerSnapshot)})),Array.isArray(jt)&&se(jt.map($t=>Number($t)).filter($t=>Number.isFinite($t)));return}catch{}qe&&Mr(!1)})(),Ar.current=!!st,()=>{qe=!1}},[st,ne,e,n,y]),x.useEffect(()=>{if(!e||!ne||st)return;const Ue=window.setInterval(()=>{qr({silent:!0})},3e4);return()=>window.clearInterval(Ue)},[st,ne,e,qr]),x.useEffect(()=>{Q&&e&&(ke(null),Mr(!0))},[Q,e]);const Zt=async()=>{U(!0),C(null);try{await Mi(n,e,{sheet:m,selectedBtls:z}),V(new Date().toLocaleString())}catch(Ue){C((Ue==null?void 0:Ue.message)||`Failed to save ${i} draft`)}finally{U(!1)}},Kt=x.useRef(m);Kt.current=m;const it=x.useRef(z);it.current=z,x.useEffect(()=>{const Ue=()=>{if(!e||ir)return;const qe={sheet:Kt.current,selectedBtls:it.current};Mi(n,e,qe).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Ue),()=>window.removeEventListener("obe:before-tab-switch",Ue)},[e,n,ir]);const At=async()=>{if(e){if(Zr){C("Publishing is locked by IQAC.");return}if(!He){C("Publish window is closed. Please request IQAC approval.");return}re(!0),C(null);try{await u(e,m,t),Y(new Date().toLocaleString()),Ee({markEntryApprovalUntil:gt,markManagerApprovalUntil:Qe}),g(Ue=>({...Ue,markManagerLocked:!0})),mt(),qr({silent:!0}),Mr(!1);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}}catch(Ue){C((Ue==null?void 0:Ue.message)||`Failed to publish ${i}`)}finally{re(!1)}}},Mt=async()=>{An(!0),Ln(null),C(null);try{await Sh({assessment:n,subject_code:e,reason:Xr,teaching_assignment_id:t}),Ln("Request sent to IQAC for approval.")}catch(Ue){C((Ue==null?void 0:Ue.message)||"Failed to request approval")}finally{An(!1),mt()}};function ar(Ue){return JSON.stringify({maxTotal:w,coMax:k,selectedBtls:z.slice(),btlMax:j})}async function Ge(){if(e){ft(!0),er(null);try{const Ue=await nl({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${i} ${e}`,teaching_assignment_id:t});alert(il(Ue))}catch(Ue){const qe=al(Ue,"Request failed");er(qe),alert(`Edit request failed: ${qe}`)}finally{ft(!1)}}}async function Rt(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(qt){alert("Edit request is pending. Please wait for approval.");return}const qe=String(H||"").trim();if(!qe){Oe("Reason is required.");return}Z(!0),Oe(null);try{const at=await nl({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:qe,teaching_assignment_id:t});alert(il(at)),O(!1),ae(""),Ut(Date.now()+24*60*60*1e3);try{Gt({silent:!0})}catch{}qr({silent:!0}),mt()}catch(at){const Be=al(at,"Request failed");Oe(Be),alert(`Edit request failed: ${Be}`)}finally{Z(!1)}}async function Ze(){if(e){ft(!0),er(null);try{const Ue=ar(m),qe=Tt!=null&&Tt.approval_until?String(Tt.approval_until):m.markManagerApprovalUntil||null,at={...m,markManagerLocked:!0,markManagerSnapshot:Ue,markManagerApprovalUntil:qe},Be={sheet:at,selectedBtls:z};g(at),Ce(null),Tr(!0),await Mi(n,String(e),Be),V(new Date().toLocaleString());try{await uh(n,String(e),t),qr({silent:!0})}catch(vt){console.warn("confirmMarkManagerLock failed",vt)}}catch(Ue){er((Ue==null?void 0:Ue.message)||"Save failed")}finally{ft(!1),setTimeout(()=>Tr(!1),2e3)}}}const ot=()=>{confirm(`Reset ${i} marks for all students in this section?`)&&(ir||g(Ue=>({...Ue,rows:(Ue.rows||[]).map(qe=>({...qe,total:""}))})))},Bt=(Ue,qe)=>{g(at=>{const Be=at.rows.slice(),vt=Be[Ue]||{studentId:0,section:"",registerNo:"",name:"",total:""};return Be[Ue]={...vt,...qe},{...at,rows:Be}})},Qt=()=>{const Ue=m.rows.map((qe,at)=>{const Be=typeof qe.total=="number"?ro(Number(qe.total),0,w):null,vt=Be==null?"":Ul(Be),$t=Be==null?null:Ul(Be/2),Rr=$t==null?null:ro($t,0,k.co1),Ur=$t==null?null:ro($t,0,k.co2),en=vr.map(rt=>rt-1),Nr=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((rt,ut)=>en.includes(ut)?s?A:rt>0?rt:Ip:rt),fn=Be==null?null:en.length?Ul(Be/en.length):0,rr=Nr.map((rt,ut)=>Be==null||!en.includes(ut)?null:rt>0?ro(fn,0,rt):Ul(fn)),ve={sno:at+1,registerNo:qe.registerNo,name:qe.name,co1_mark:Rr??"",co1_pct:pl(Rr,k.co1),co2_mark:Ur??"",co2_pct:pl(Ur,k.co2),btl1_mark:rr[0]??"",btl1_pct:pl(rr[0],Nr[0]),btl2_mark:rr[1]??"",btl2_pct:pl(rr[1],Nr[1]),btl3_mark:rr[2]??"",btl3_pct:pl(rr[2],Nr[2]),btl4_mark:rr[3]??"",btl4_pct:pl(rr[3],Nr[3]),btl5_mark:rr[4]??"",btl5_pct:pl(rr[4],Nr[4]),btl6_mark:rr[5]??"",btl6_pct:pl(rr[5],Nr[5])};return ve[i]=vt,ve});zxe(`${e}_${LM(i)||"SSA1"}_sheet.csv`,Ue)},Yt=()=>{if(!m.rows.length)return;const Ue=Number.isFinite(Number(k.co1))?Number(k.co1):0,qe=Number.isFinite(Number(k.co2))?Number(k.co2):0,at=["Register No","Student Name",`Q1 (${Ue.toFixed(2)})`,`Q2 (${qe.toFixed(2)})`,"Status"],Be=m.rows.map(Rr=>[Rr.registerNo,Rr.name,"","","present"]),vt=bs.aoa_to_sheet([at,...Be]);vt["!freeze"]={xSplit:0,ySplit:1};const jt=bs.book_new();bs.book_append_sheet(jt,vt,i||"SSA1");const $t=`${e}_${LM(i)||"SSA1"}_template.xlsx`;dy(jt,$t)},fr=async()=>{const Ue=m.rows.map((qe,at)=>({sno:at+1,regNo:String(qe.registerNo||""),name:String(qe.name||""),total:qe.total===""?"":Number(qe.total)}));await hy({filenameBase:`${e}_${i}`,meta:{courseName:(h==null?void 0:h.courseName)||"",courseCode:(h==null?void 0:h.courseCode)||e,className:(h==null?void 0:h.className)||""},rows:Ue})};function Dt(Ue){return String(Ue??"").trim().toLowerCase().replace(/\s+/g," ")}const ur=()=>{var Ue;ir||(Ue=L.current)==null||Ue.click()},Ve=async Ue=>{var qe;if(Ue){B(!0);try{const at=await Ue.arrayBuffer(),Be=N0(at,{type:"array"}),vt=(qe=Be.SheetNames)==null?void 0:qe[0];if(!vt)throw new Error("No sheet found in the Excel file.");const jt=Be.Sheets[vt],$t=bs.sheet_to_json(jt,{header:1});if(!$t.length)throw new Error("Excel sheet is empty.");const Rr=($t[0]||[]).map(Dt),Ur=pt=>Rr.findIndex(Pr=>pt(Pr)),en=Ur(pt=>pt==="register no"||pt==="reg no"||pt.includes("register")),vn=Ur(pt=>pt.startsWith("q1")),Nr=Ur(pt=>pt.startsWith("q2")),fn=Ur(pt=>pt==="total"||pt.includes("total")),rr=Ur(pt=>pt==="status"||pt.includes("status"));if(en<0)throw new Error("Could not find Register No column.");const ve=Number.isFinite(Number(k.co1))?Number(k.co1):0,rt=Number.isFinite(Number(k.co2))?Number(k.co2):0,ut=new Map;m.rows.forEach((pt,Pr)=>{const Kr=String(pt.registerNo||"").trim();Kr&&ut.set(Kr,Pr);const pn=Uk(Kr);pn&&ut.set(pn,Pr)}),g(pt=>{const Pr=pt.rows.slice();for(let Kr=1;Kr<$t.length;Kr++){const pn=$t[Kr]||[],Nn=String(pn[en]??"").trim();if(!Nn)continue;const _n=ut.get(Nn);if(_n==null)continue;const Wn=(rr>=0?String(pn[rr]??""):"").trim().toLowerCase(),M=Wn==="absent"||Wn==="ab"||Wn==="a",oe=vn>=0?Xv(pn[vn]):null,Re=Nr>=0?Xv(pn[Nr]):null,Je=fn>=0?Xv(pn[fn]):null,kt=oe==null?0:ro(oe,0,ve),mr=Re==null?0:ro(Re,0,rt),lr=Je??kt+mr,Sr=M?0:ro(lr,0,w);Pr[_n]={...Pr[_n],total:Ul(Sr)}}return{...pt,rows:Pr}})}finally{B(!1)}}},zt=async Ue=>{var at;const qe=(at=Ue.target.files)==null?void 0:at[0];if(Ue.target.value="",!!qe)try{await Ve(qe)}catch(Be){alert((Be==null?void 0:Be.message)||"Failed to import Excel")}},yt={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},St={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},sr={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},pr={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},we={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},Ie=Ue=>{if(Zr||It)return;const qe=m.markManagerSnapshot!=null;je&&qe||se(at=>at.includes(Ue)?at.filter(Be=>Be!==Ue):at.concat(Ue).sort((Be,vt)=>Be-vt))},tt=!!(ne&&Wt),dt=async()=>{if(qt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Oe(null),O(!0)},xt=tt?dt:At,Cr=tt?qt:!!(G||!He||ir);return a.jsx(a.Fragment,{children:a.jsxs(ag,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:kr,className:"obe-btn obe-btn-secondary",disabled:E,children:E?"Loading roster":"Load/Refresh Roster"}),a.jsx("button",{onClick:ot,className:"obe-btn obe-btn-danger",disabled:!m.rows.length,children:"Reset Marks"}),a.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!Gr,onClick:()=>{if(_t)return;const Ue=m.rows.filter(qe=>!!qe.absent||Object.values(qe).some(at=>typeof at=="string"&&String(at).toLowerCase().includes("absent"))).map(qe=>Number(qe.studentId)).filter(qe=>Number.isFinite(qe));Ne(Ue.length?Ue:null),Xe(!0)},title:Gr?"Filter the table to show only absentees":"No absentees marked yet",style:_t?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",_t?a.jsx("span",{onClick:Ue=>{Ue.stopPropagation(),Xe(!1),Ne(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),a.jsx("button",{onClick:Qt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export CSV"}),a.jsx("button",{onClick:Yt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export Excel"}),a.jsx("button",{onClick:ur,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length||ir||P,children:P?"Importing":"Import Excel"}),a.jsx("input",{ref:L,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:zt})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:fr,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Download"}),a.jsx("button",{onClick:Zt,className:"obe-btn obe-btn-success",disabled:de||ir,title:ir?"Table locked  confirm Mark Manager to enable actions":void 0,children:de?"Saving":"Save Draft"}),a.jsx("button",{onClick:xt,className:"obe-btn obe-btn-primary",disabled:Cr,title:ir?"Table locked  confirm Mark Manager to enable actions":void 0,children:tt?qt?"Request Pending":"Request Edit":G?"Publishing":"Publish"})]})]}),a.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:we,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),a.jsxs("div",{style:we,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),a.jsxs("div",{style:we,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:K||""}),R?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:R})]}):null]}),a.jsxs("div",{style:we,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:q||""})]})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:He?"#065f46":"#b91c1c"},children:fe?"Checking publish due time":ge||(be!=null&&be.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(be.due_at).toLocaleString(),"  Remaining: ",ng(lt),be.allowed_by_approval&&be.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(be.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Zr?a.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>mt(),disabled:fe,children:"Refresh"})})]}):He?null:a.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:Xr,onChange:Ue=>Br(Ue.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>mt(),disabled:Vr||fe,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Mt,disabled:Vr,children:Vr?"Requesting":"Request Approval"})]}),Yr?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:Yr}):null]}),Q?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>ie(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ue=>Ue.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsxs("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:["View Published ",i]}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i}),a.jsx("button",{onClick:Ue=>{Ue.stopPropagation(),ie(!1)},"aria-label":"Close",style:{marginLeft:8,border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),_e?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,We?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:We}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:yt,colSpan:Lt,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...yt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:yt,rowSpan:4,children:"Register No."}),a.jsx("th",{style:yt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:yt,children:i}),null,a.jsx("th",{style:yt,colSpan:4,children:"CO ATTAINMENT"}),vr.length?a.jsx("th",{style:yt,colSpan:vr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:yt,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,a.jsx("th",{style:yt,colSpan:2,children:"CO-1"}),a.jsx("th",{style:yt,colSpan:2,children:"CO-2"}),vr.map(Ue=>a.jsxs("th",{style:yt,colSpan:2,children:["BTL-",Ue]},`btl-head-${Ue}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:yt,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:vr.length?vr.join(","):"-"})]}),null,Array.from({length:2+vr.length}).flatMap((Ue,qe)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:yt,children:"Mark"}),a.jsx("th",{style:yt,children:"%"})]},qe))]}),a.jsxs("tr",{children:[a.jsx("th",{style:yt,children:"Name / Max Marks"}),a.jsx("th",{style:yt,children:w}),null,a.jsx("th",{style:yt,children:k.co1}),a.jsx("th",{style:yt,children:"%"}),a.jsx("th",{style:yt,children:k.co2}),a.jsx("th",{style:yt,children:"%"}),vr.flatMap(Ue=>[a.jsx("th",{style:yt,children:String(s?A:Math.max(Number(j[`btl${Ue}`]??0)||0,Ip))},`btl-max-${Ue}`),a.jsx("th",{style:yt,children:"%"},`btl-pct-${Ue}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Lt,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):bn.map((Ue,qe)=>{var rr;const at=((rr=Ae==null?void 0:Ae.marks)==null?void 0:rr[String(Ue.studentId)])??null,Be=at==null||at===""?null:ro(Number(at),0,w),jt=Be==null?null:Ul(Be/2),$t=jt==null?null:ro(jt,0,k.co1),Rr=jt==null?null:ro(jt,0,k.co2),Ur=vr.map(ve=>ve-1),vn=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((ve,rt)=>Ur.includes(rt)?s?A:ve>0?ve:Ip:ve),Nr=Be==null?null:Ur.length?Ul(Be/Ur.length):0,fn=vn.map((ve,rt)=>Be==null||!Ur.includes(rt)?null:ve>0?ro(Nr,0,ve):Ul(Nr));return a.jsxs("tr",{style:{background:qe%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...St,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:qe+1}),a.jsx("td",{style:St,children:Uk(Ue.registerNo)}),a.jsx("td",{style:St,children:Ue.name}),a.jsx("td",{style:{...St,width:90,background:"#fff7ed",textAlign:"center"},children:Be==null?"":Ul(Be)}),null,a.jsx("td",{style:{...St,textAlign:"center"},children:$t??""}),a.jsx("td",{style:{...St,textAlign:"center"},children:pl($t,k.co1)}),a.jsx("td",{style:{...St,textAlign:"center"},children:Rr??""}),a.jsx("td",{style:{...St,textAlign:"center"},children:pl(Rr,k.co2)}),vr.map(ve=>{const rt=ve-1,ut=fn[rt],pt=vn[rt];return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...St,textAlign:"center"},children:ut??""}),a.jsx("td",{style:{...St,textAlign:"center"},children:pl(ut,pt)})]},ve)})]},String(Ue.studentId||qe))})})]})}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>ie(!1),children:"Close"})})]})})}):null,(F||X)&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:F||X}),a.jsxs("div",{style:{marginTop:12,...we},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),a.jsx("div",{children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const Ue=m.markManagerSnapshot!=null;Ce({mode:Ue?"request":"confirm"})},disabled:!e||It,children:m.markManagerSnapshot?"Edit":"Save"})})]}),a.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[a.jsxs("div",{children:["Max ",i,": ",a.jsx("strong",{style:{color:"#111"},children:w})]}),a.jsxs("div",{children:["CO-1 max: ",a.jsx("strong",{style:{color:"#111"},children:k.co1}),"  CO-2 max: ",a.jsx("strong",{style:{color:"#111"},children:k.co2})]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(Ue=>{const qe=z.includes(Ue),at=!!(je&&m.markManagerSnapshot!=null);return a.jsxs("div",{onClick:()=>Ie(Ue),style:{...pr,borderColor:qe?"#16a34a":"#cbd5e1",background:qe?"#ecfdf5":"#fff",cursor:at||It?"not-allowed":"pointer",opacity:at?.6:1,padding:"6px 8px"},"aria-disabled":at||It,children:[a.jsx("input",{type:"checkbox",checked:qe,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",Ue]})]},`card_btl_${Ue}`)})})]})]}),Ot?a.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:Ot}):null]}),a.jsx("div",{style:{marginTop:14},children:dn?a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx(ig,{locked:!!(Zr||Wt||ne&&cr),title:Zr?"Locked by IQAC":te?"Published  Locked":"Table Locked",subtitle:Zr?"Publishing is turned OFF globally for this assessment.":te?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:yt,colSpan:Lt,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...yt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:yt,rowSpan:4,children:"Register No."}),a.jsx("th",{style:yt,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:yt,children:i}),null,a.jsx("th",{style:yt,colSpan:4,children:"CO ATTAINMENT"}),vr.length?a.jsx("th",{style:yt,colSpan:vr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:yt,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,a.jsx("th",{style:yt,colSpan:2,children:"CO-1"}),a.jsx("th",{style:yt,colSpan:2,children:"CO-2"}),vr.map(Ue=>a.jsxs("th",{style:yt,colSpan:2,children:["BTL-",Ue]},`btl-head-${Ue}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:yt,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:vr.length?vr.join(","):"-"})]}),null,Array.from({length:2+vr.length}).flatMap((Ue,qe)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:yt,children:"Mark"}),a.jsx("th",{style:yt,children:"%"})]},qe))]}),a.jsxs("tr",{children:[a.jsx("th",{style:yt,children:"Name / Max Marks"}),a.jsx("th",{style:yt,children:w}),null,a.jsx("th",{style:yt,children:k.co1}),a.jsx("th",{style:yt,children:"%"}),a.jsx("th",{style:yt,children:k.co2}),a.jsx("th",{style:yt,children:"%"}),vr.flatMap(Ue=>[a.jsx("th",{style:yt,children:String(s?A:$xe(j[`btl${Ue}`]))},`btl-max-${Ue}`),a.jsx("th",{style:yt,children:"%"},`btl-pct-${Ue}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Lt,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):ir&&!Wt?a.jsx("tr",{children:a.jsx("td",{colSpan:Lt,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):bn.map((Ue,qe)=>{const at=typeof Ue.total=="number"?ro(Number(Ue.total),0,w):null,Be=at==null?null:Ul(at/2),vt=Be==null?null:ro(Be,0,k.co1),jt=Be==null?null:ro(Be,0,k.co2),$t=vr.map(Nr=>Nr-1),Ur=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((Nr,fn)=>$t.includes(fn)?s?A:Nr>0?Nr:Ip:Nr),en=at==null?null:$t.length?Ul(at/$t.length):0,vn=Ur.map((Nr,fn)=>at==null||!$t.includes(fn)?null:Nr>0?ro(en,0,Nr):Ul(en));return a.jsxs("tr",{style:{background:qe%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...St,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:qe+1}),a.jsx("td",{style:St,children:Uk(Ue.registerNo)}),a.jsx("td",{style:St,children:Ue.name}),a.jsx("td",{style:{...St,width:90,background:"#fff7ed"},children:Fr?a.jsx("div",{style:sr,children:typeof Ue.total=="number"?Ul(Ue.total):""}):a.jsx("input",{style:sr,type:"number",value:Ue.total,min:0,max:w,onChange:Nr=>{if(Fr)return;const fn=Nr.target.value;if(fn==="")return Bt(qe,{total:""});const rr=Number(fn);if(!Number.isFinite(rr))return Bt(qe,{total:""});if(rr>w){Nr.currentTarget.setCustomValidity(`Max mark is ${w}`),Nr.currentTarget.reportValidity(),window.setTimeout(()=>Nr.currentTarget.setCustomValidity(""),0);return}Nr.currentTarget.setCustomValidity("");const ve=ro(rr,0,w);Bt(qe,{total:ve})}})}),null,a.jsx("td",{style:{...St,textAlign:"center"},children:vt??""}),a.jsx("td",{style:{...St,textAlign:"center"},children:pl(vt,k.co1)}),a.jsx("td",{style:{...St,textAlign:"center"},children:jt??""}),a.jsx("td",{style:{...St,textAlign:"center"},children:pl(jt,k.co2)}),vr.map(Nr=>{const fn=Nr-1,rr=vn[fn],ve=Ur[fn];return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...St,textAlign:"center"},children:rr??""}),a.jsx("td",{style:{...St,textAlign:"center"},children:pl(rr,ve)})]},Nr)})]},String(Ue.studentId||qe))})})]})})}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:a.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[a.jsx("div",{style:{fontSize:40},children:""}),a.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:te?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:te?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:te?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>ie(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:qt,onClick:dt,children:qt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ce({mode:"confirm"}),disabled:!e||It,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Ge(),disabled:It,children:"Request Access"})]})})]})})}),le?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>{I||O(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ue=>Ue.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[i,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",ht?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:H,onChange:Ue=>ae(Ue.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),pe?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:pe}):null,a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:I,onClick:()=>O(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:I||qt||!e||!String(H||"").trim(),onClick:Rt,children:I?"Requesting":qt?"Request Pending":"Send Request"})]})]})})}):null,a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }

        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),a.jsxs("div",{style:{position:"relative"},children:[je?null:a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"rgba(107, 114, 128, 0.15)"}}),je?null:a.jsxs("div",{style:{position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]})]}),Me?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{It||Ce(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ue=>Ue.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Me.mode==="confirm"?`Confirmation - ${i}`:`Request Edit - ${i}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),Me.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",i]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-1 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:k.co1})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-2 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:k.co2})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(Ue=>{const qe=z.includes(Ue);return a.jsxs("div",{onClick:()=>se(at=>at.includes(Ue)?at.filter(Be=>Be!==Ue):[...at,Ue].sort((Be,vt)=>Be-vt)),style:{...pr,borderColor:qe?"#16a34a":"#cbd5e1",background:qe?"#ecfdf5":"#fff",cursor:It?"not-allowed":"pointer",padding:"6px 8px"},children:[a.jsx("input",{type:"checkbox",checked:qe,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",Ue]})]},`modal_btl_${Ue}`)})})})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:It,onClick:()=>Ce(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:It||!e,onClick:async()=>{if(e){if(Me.mode==="request"){Ce(null),await Ge();return}await Ze()}},children:Me.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null]})})}function Hxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(qxe,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa1",label:r||"SSA1"})}const Vxe=20,RM={co3:10,co4:10},kp={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},jp=10;function no(e,t,r){return Math.max(t,Math.min(r,e))}function zl(e){return Math.round(e*10)/10}function ml(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Qv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function Ap(e,t,r){const n=e==null?void 0:e.btlMax,i=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Qv(i);return s??r}function Gxe(e,t){return`${t}_sheet_${e}`}function BM(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function Kxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Yxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Zb(e){return e.slice(-8)}function Xxe({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa2"}){var tt,dt,xt,Cr,nn;const i=String(r||"SSA2"),s=n==="review2",o=!1,l=x.useMemo(()=>Gxe(e,n),[e,n]),c=n==="review2"?jS:ty,u=n==="review2"?O9:P9,[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),y=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),b=((tt=d==null?void 0:d.assessments)==null?void 0:tt.ssa2)||{},v=Number.isFinite(Number(b==null?void 0:b.maxTotal))?Number(b.maxTotal):Vxe,w=s?30:v,S={co3:Number.isFinite(Number((dt=b==null?void 0:b.coMax)==null?void 0:dt.co3))?Number(b.coMax.co3):Number.isFinite(Number((xt=b==null?void 0:b.coMax)==null?void 0:xt.co1))?Number(b.coMax.co1):RM.co3,co4:Number.isFinite(Number((Cr=b==null?void 0:b.coMax)==null?void 0:Cr.co4))?Number(b.coMax.co4):Number.isFinite(Number((nn=b==null?void 0:b.coMax)==null?void 0:nn.co2))?Number(b.coMax.co2):RM.co4},k=s?{co3:15,co4:15}:S,j={btl1:Ap(b,1,kp.btl1),btl2:Ap(b,2,kp.btl2),btl3:Ap(b,3,kp.btl3),btl4:Ap(b,4,kp.btl4),btl5:Ap(b,5,kp.btl5),btl6:Ap(b,6,kp.btl6)},A=s?30:jp,L=x.useRef(null),[P,B]=x.useState(!1);x.useEffect(()=>{let ct=!0;return(async()=>{try{const Ht=await vu();if(!ct)return;f(Ht||null),g(Ue=>({...Ue,termLabel:String((Ht==null?void 0:Ht.termLabel)||Ue.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{ct=!1}},[e]);const[E,T]=x.useState(!1),[F,W]=x.useState(null),[z,se]=x.useState(()=>s?[3,4]:[]),[de,U]=x.useState(!1),[G,re]=x.useState(!1),[X,C]=x.useState(null),[K,V]=x.useState(null),[R,J]=x.useState(null),[q,Y]=x.useState(null),[Q,ie]=x.useState(!1),[le,O]=x.useState(""),[H,ae]=x.useState(!1),[I,Z]=x.useState(null),[pe,Oe]=x.useState(!1),[Ae,ke]=x.useState(null),[_e,De]=x.useState(!1),[We,Ct]=x.useState(null),[_t,Xe]=x.useState(!1),{data:nt,loading:Ne,error:be,remainingSeconds:fe,publishAllowed:ge,refresh:lt}=H0({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:He,loading:mt,error:wt,refresh:Pt}=V0({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:bt,refresh:qr}=nc({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:Tt,refresh:xr}=nc({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),Zr=!!(nt!=null&&nt.global_override_active&&(nt==null?void 0:nt.global_is_open)===!1),[Xr,Br]=x.useState(""),[Vr,An]=x.useState(!1),[Yr,Ln]=x.useState(null),[Me,Ce]=x.useState(null),[It,ft]=x.useState(!1),[Ot,er]=x.useState(null),hr=!!(e&&!It),[Tr,ne]=x.useState(null);x.useEffect(()=>{ne(null),Y(null),ke(null),Ct(null)},[e,n,t]);const ce=!!q||!!(He!=null&&He.exists&&(He!=null&&He.is_published))||!!Ae,te=!hr&&ce,ue=!!m.markManagerLocked,Ee=Tt!=null&&Tt.approval_until?String(Tt.approval_until):null,je=bt!=null&&bt.approval_until?String(bt.approval_until):null,gt=!!(Tt!=null&&Tt.allowed_by_approval)&&!!Ee&&Ee!==((Tr==null?void 0:Tr.markEntryApprovalUntil)??null),Qe=!!(bt!=null&&bt.allowed_by_approval)&&!!je&&je!==((Tr==null?void 0:Tr.markManagerApprovalUntil)??null),Fe=ce?!!(He!=null&&He.entry_open)||gt||Qe:!0,$e=!!(ce&&!Fe),{pending:st,pendingUntilMs:Wt,setPendingUntilMs:qt,refresh:ht}=G0({enabled:!!(ce&&$e)&&!!e,assessment:n,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!Q||!!Me||!!pe);const Ut=!!(ce&&$e),Gt=async()=>{if(st){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}Z(null),ie(!0)},cr=!!e&&(mt||!!wt||He==null),ir=!!(Zr||cr||(He?!He.entry_open:ce?!Fe:!ue)),Fr=m.markManagerSnapshot!=null,dn=!!(Zr||$e||ir),vr=!!(ce&&$e&&ue),Lt=x.useMemo(()=>{const ct=new Set(z);return[1,2,3,4,5,6].filter(Ht=>ct.has(Ht))},[z]),Gr=x.useMemo(()=>8+Lt.length*2,[o,Lt.length]);x.useEffect(()=>{if(!e)return;try{const Ue=`${n}_selected_btls_${e}`;Gn(Ue,z)}catch{}let ct=!1;const Ht=setTimeout(async()=>{try{await Mi(n,e,{sheet:m,selectedBtls:z});try{l&&Gn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}ct||V(new Date().toLocaleString())}catch{}},700);return()=>{ct=!0,clearTimeout(Ht)}},[z,e,m,l,n]),x.useEffect(()=>{if(!e)return;const ct=Jn(l);ct&&typeof ct=="object"&&Array.isArray(ct.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(ct.termLabel||"KRCT AY25-26"),batchLabel:e,rows:ct.rows,markManagerSnapshot:(ct==null?void 0:ct.markManagerSnapshot)??null,markManagerApprovalUntil:(ct==null?void 0:ct.markManagerApprovalUntil)??null,markManagerLocked:typeof(ct==null?void 0:ct.markManagerLocked)=="boolean"?ct.markManagerLocked:!!(ct!=null&&ct.markManagerSnapshot)}):g({termLabel:y||"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null})},[l,e,d,y]),x.useEffect(()=>{let ct=!0;return(async()=>{if(e)try{const Ht=await ei(n,e);if(!ct)return;const Ue=Ht==null?void 0:Ht.draft,qe=Ue==null?void 0:Ue.sheet,at=Ue==null?void 0:Ue.selectedBtls;if(qe&&typeof qe=="object"&&Array.isArray(qe.rows)){g(jt=>({...jt,termLabel:String(qe.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:qe.rows,markManagerSnapshot:(qe==null?void 0:qe.markManagerSnapshot)??jt.markManagerSnapshot??null,markManagerApprovalUntil:(qe==null?void 0:qe.markManagerApprovalUntil)??jt.markManagerApprovalUntil??null,markManagerLocked:typeof(qe==null?void 0:qe.markManagerLocked)=="boolean"?qe.markManagerLocked:!!((qe==null?void 0:qe.markManagerSnapshot)??jt.markManagerSnapshot)}));const Be=(Ht==null?void 0:Ht.updated_at)??null,vt=(Ht==null?void 0:Ht.updated_by)??null;if(Be)try{V(new Date(String(Be)).toLocaleString())}catch{V(String(Be))}vt&&J(String(vt.name||vt.username||vt.id||""));try{l&&Gn(l,{termLabel:String(qe.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:qe.rows})}catch{}}if(Array.isArray(at)){const Be=at.map(vt=>Number(vt)).filter(vt=>Number.isFinite(vt));se(Be);try{const vt=`${n}_selected_btls_${e}`;Gn(vt,Be)}catch{}}}catch{}})(),()=>{ct=!1}},[e,y,l,n]),x.useEffect(()=>{if(!e)return;if((!!(He!=null&&He.exists&&(He!=null&&He.is_published))||!!q)&&(He!=null&&He.exists)){const qe=!!(He!=null&&He.mark_manager_locked);!!m.markManagerLocked!==qe&&g(at=>({...at,markManagerLocked:qe}));return}const Ht=!!(bt!=null&&bt.allowed_by_approval),Ue=bt!=null&&bt.approval_until?String(bt.approval_until):null;if(Ht&&Ue){if(Ue===((Tr==null?void 0:Tr.markManagerApprovalUntil)??null))return;const qe=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&qe!==Ue&&g(at=>({...at,markManagerLocked:!1,markManagerApprovalUntil:Ue}));return}},[e,He==null?void 0:He.exists,He==null?void 0:He.is_published,He==null?void 0:He.mark_manager_locked,bt==null?void 0:bt.allowed_by_approval,bt==null?void 0:bt.approval_until,m.markManagerLocked,m.markManagerApprovalUntil,q,Tr==null?void 0:Tr.markManagerApprovalUntil]);const bn=ct=>{g(Ht=>{const Ue=new Map,qe=new Map;for(const Be of Ht.rows||[])typeof Be.studentId=="number"&&Ue.set(Be.studentId,Be),Be.registerNo&&qe.set(String(Be.registerNo),Be);const at=(ct||[]).slice().sort(Yxe).map(Be=>{const vt=Ue.get(Be.id)||qe.get(String(Be.reg_no||""));return{studentId:Be.id,section:String(Be.section||""),registerNo:String(Be.reg_no||""),name:String(Be.name||""),total:typeof(vt==null?void 0:vt.total)=="number"?no(Number(vt.total),0,w):((vt==null?void 0:vt.total)==="","")}});return{...Ht,rows:at}})},or=async()=>{var ct,Ht,Ue;if(!e){W("Subject ID is required.");return}T(!0),W(null);try{let qe=[],at=null;try{const Be=await lc();console.log("[SSA2] My TAs:",Be==null?void 0:Be.length,"for subject:",e,"teachingAssignmentId:",t),at=(Be||[]).find(vt=>{const jt=String(vt.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?vt.id===t:!1)||jt}),at?console.log("[SSA2] Found TA match:",at.id,"elective_subject_id:",at.elective_subject_id,"section_id:",at.section_id):console.log("[SSA2] No TA match found in user TAs")}catch(Be){console.warn("[SSA2] My TAs fetch failed:",Be)}if(at&&at.elective_subject_id&&!at.section_id){console.log("[SSA2] Detected elective, fetching elective-choices for elective_subject_id:",at.elective_subject_id);try{const Be=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(at.elective_subject_id))}`);if(Be.ok){const vt=await Be.json(),jt=Array.isArray(vt.results)?vt.results:Array.isArray(vt)?vt:vt.items||[];console.log("[SSA2] Elective choices returned:",jt==null?void 0:jt.length,"students"),qe=(jt||[]).map($t=>({id:Number($t.student_id??$t.id),reg_no:String($t.reg_no??$t.regno??""),name:String($t.name??$t.full_name??$t.username??""),section:$t.section_name??$t.section??null}))}else console.warn("[SSA2] Elective-choices API returned error:",Be.status)}catch(Be){console.warn("[SSA2] Elective-choices fetch failed:",Be)}}if(!qe.length&&at&&at.id){console.log("[SSA2] Fetching regular TA roster for TA ID:",at.id);try{const Be=await qc(at.id);qe=Be.students||[],p({courseName:String(((ct=Be==null?void 0:Be.teaching_assignment)==null?void 0:ct.subject_name)||(at==null?void 0:at.subject_name)||""),courseCode:String(((Ht=Be==null?void 0:Be.teaching_assignment)==null?void 0:Ht.subject_code)||(at==null?void 0:at.subject_code)||e||""),className:String(((Ue=Be==null?void 0:Be.teaching_assignment)==null?void 0:Ue.section_name)||(at==null?void 0:at.section_name)||"")}),console.log("[SSA2] Regular roster returned:",qe.length,"students")}catch(Be){console.warn("[SSA2] TA roster fetch failed:",Be)}}console.log("[SSA2] Final roster count:",qe.length),bn(qe)}catch(qe){W((qe==null?void 0:qe.message)||"Failed to load roster")}finally{T(!1)}};x.useEffect(()=>{e&&or()},[t,e]);async function kr(ct){if(e){ct&&De(!0),Ct(null);try{const Ht=await c(String(e));ke(Ht||null)}catch(Ht){ct&&Ct((Ht==null?void 0:Ht.message)||`Failed to load published ${i} marks`)}finally{ct&&De(!1)}}}x.useEffect(()=>{e&&kr(!1)},[e,n,t]);const Mr=x.useRef(!!Fe);x.useEffect(()=>{Mr.current=!!Fe},[e,n,t,Fe]);const Ar=x.useRef(null);async function Zt(ct=!0){try{if(lt(),Pt({silent:!1}),await kr(ct),t)try{await or()}catch{}}catch{}}x.useEffect(()=>{if(!e||!ce)return;if(Mr.current||!Fe){Mr.current=!!Fe;return}let Ht=!0;return(async()=>{try{const Ue=await ei(n,String(e));if(!Ht)return;const qe=Ue==null?void 0:Ue.draft,at=qe==null?void 0:qe.sheet,Be=qe==null?void 0:qe.selectedBtls;at&&typeof at=="object"&&Array.isArray(at.rows)&&g(vt=>({...vt,termLabel:String(at.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:at.rows,markManagerSnapshot:(at==null?void 0:at.markManagerSnapshot)??vt.markManagerSnapshot??null,markManagerApprovalUntil:(at==null?void 0:at.markManagerApprovalUntil)??vt.markManagerApprovalUntil??null,markManagerLocked:typeof(at==null?void 0:at.markManagerLocked)=="boolean"?at.markManagerLocked:!!((at==null?void 0:at.markManagerSnapshot)??vt.markManagerSnapshot)})),Array.isArray(Be)&&se(Be.map(vt=>Number(vt)).filter(vt=>Number.isFinite(vt)));return}catch{}Ht&&kr(!1)})(),Mr.current=!!Fe,()=>{Ht=!1}},[Fe,ce,e,n,y]),x.useEffect(()=>{if(!e||!ce||Fe)return;const ct=window.setInterval(()=>{Pt({silent:!0})},3e4);return()=>window.clearInterval(ct)},[Fe,ce,e,Pt]),x.useEffect(()=>{pe&&e&&(ke(null),kr(!0))},[pe,e]);const Kt=async()=>{U(!0),C(null);try{await Mi(n,e,{sheet:m,selectedBtls:z}),V(new Date().toLocaleString())}catch(ct){C((ct==null?void 0:ct.message)||`Failed to save ${i} draft`)}finally{U(!1)}},it=x.useRef(m);it.current=m;const At=x.useRef(z);At.current=z,x.useEffect(()=>{const ct=()=>{if(!e||ir)return;const Ht={sheet:it.current,selectedBtls:At.current};Mi(n,e,Ht).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",ct),()=>window.removeEventListener("obe:before-tab-switch",ct)},[e,n,ir]);const Mt=async()=>{if(e){if(Zr){C("Publishing is locked by IQAC.");return}if(!ge){C("Publish window is closed. Please request IQAC approval.");return}if(ce&&$e){if(st){C("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ie(!0);return}re(!0),C(null);try{await u(e,m,t),Y(new Date().toLocaleString()),ne({markEntryApprovalUntil:Ee,markManagerApprovalUntil:je}),g(ct=>({...ct,markManagerLocked:!0})),lt(),Pt({silent:!0}),kr(!1),setTimeout(()=>{try{if(pe&&Ar.current){const ct=Ar.current;ct.scrollTop=ct.scrollHeight}}catch{}},50);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}setTimeout(()=>{Zt(!0),Xe(!0),setTimeout(()=>Xe(!1),5e3)},2e3)}catch(ct){C((ct==null?void 0:ct.message)||`Failed to publish ${i}`)}finally{re(!1)}}},ar=async()=>{An(!0),Ln(null),C(null);try{await Sh({assessment:n,subject_code:e,reason:Xr,teaching_assignment_id:t}),Ln("Request sent to IQAC for approval.")}catch(ct){C((ct==null?void 0:ct.message)||"Failed to request approval")}finally{An(!1),lt()}},Ge=()=>{confirm(`Reset ${i} marks for all students in this section?`)&&(ir||g(ct=>({...ct,rows:(ct.rows||[]).map(Ht=>({...Ht,total:""}))})))};function Rt(ct){return JSON.stringify({maxTotal:w,coMax:k,selectedBtls:z.slice(),btlMax:j})}async function Ze(){if(e){ft(!0),er(null);try{const ct=await nl({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${i} ${e}`,teaching_assignment_id:t});alert(il(ct));try{await(qr?qr({silent:!0}):Promise.resolve())}catch{}}catch(ct){const Ht=al(ct,"Request failed");er(Ht),alert(`Edit request failed: ${Ht}`)}finally{ft(!1)}}}async function ot(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(st){alert("Edit request is pending. Please wait for approval.");return}const Ht=String(le||"").trim();if(!Ht){Z("Reason is required.");return}ae(!0),Z(null);try{const Ue=await nl({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:Ht,teaching_assignment_id:t});alert(il(Ue)),ie(!1),O(""),qt(Date.now()+24*60*60*1e3);try{ht({silent:!0})}catch{}Pt({silent:!0});try{await(xr?xr({silent:!0}):Promise.resolve())}catch{}}catch(Ue){const qe=al(Ue,"Request failed");Z(qe),alert(`Edit request failed: ${qe}`)}finally{ae(!1)}}async function Bt(){if(e){ft(!0),er(null);try{const ct=Rt(m),Ht=bt!=null&&bt.approval_until?String(bt.approval_until):m.markManagerApprovalUntil||null,Ue={...m,markManagerLocked:!0,markManagerSnapshot:ct,markManagerApprovalUntil:Ht},qe={sheet:Ue,selectedBtls:z};g(Ue),Ce(null),await Mi(n,String(e),qe),V(new Date().toLocaleString());try{await uh(n,String(e),t),Pt({silent:!0})}catch(at){console.warn("confirmMarkManagerLock failed",at)}}catch(ct){er((ct==null?void 0:ct.message)||"Save failed")}finally{ft(!1)}}}const Qt=(ct,Ht)=>{g(Ue=>{const qe=Ue.rows.slice(),at=qe[ct]||{studentId:0,section:"",registerNo:"",name:"",total:""};return qe[ct]={...at,...Ht},{...Ue,rows:qe}})},Yt=()=>{const ct=m.rows.map((Ht,Ue)=>{const qe=typeof Ht.total=="number"?no(Number(Ht.total),0,w):null,at=qe==null?"":zl(qe),vt=qe==null?null:zl(qe/2),jt=vt==null?null:no(vt,0,k.co3),$t=vt==null?null:no(vt,0,k.co4),Rr=Lt.map(rr=>rr-1),en=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((rr,ve)=>Rr.includes(ve)?s?A:rr>0?rr:jp:rr),vn=qe==null?null:Rr.length?zl(qe/Rr.length):0,Nr=en.map((rr,ve)=>qe==null||!Rr.includes(ve)?null:rr>0?no(vn,0,rr):zl(vn)),fn={sno:Ue+1,registerNo:Zb(Ht.registerNo),name:Ht.name,co3_mark:jt??"",co3_pct:ml(jt,k.co3),co4_mark:$t??"",co4_pct:ml($t,k.co4),btl1_mark:Nr[0]??"",btl1_pct:ml(Nr[0],en[0]),btl2_mark:Nr[1]??"",btl2_pct:ml(Nr[1],en[1]),btl3_mark:Nr[2]??"",btl3_pct:ml(Nr[2],en[2]),btl4_mark:Nr[3]??"",btl4_pct:ml(Nr[3],en[3]),btl5_mark:Nr[4]??"",btl5_pct:ml(Nr[4],en[4]),btl6_mark:Nr[5]??"",btl6_pct:ml(Nr[5],en[5])};return fn[i]=at,fn});Kxe(`${e}_${BM(i)||"SSA2"}_sheet.csv`,ct)},fr=()=>{if(!m.rows.length)return;const ct=Number.isFinite(Number(k.co3))?Number(k.co3):0,Ht=Number.isFinite(Number(k.co4))?Number(k.co4):0,Ue=["Register No","Student Name",`Q1 (${ct.toFixed(2)})`,`Q2 (${Ht.toFixed(2)})`,"Status"],qe=m.rows.map(jt=>[jt.registerNo,jt.name,"","","present"]),at=bs.aoa_to_sheet([Ue,...qe]);at["!freeze"]={xSplit:0,ySplit:1};const Be=bs.book_new();bs.book_append_sheet(Be,at,i||"SSA2");const vt=`${e}_${BM(i)||"SSA2"}_template.xlsx`;dy(Be,vt)},Dt=async()=>{const ct=m.rows.map((Ht,Ue)=>({sno:Ue+1,regNo:String(Ht.registerNo||""),name:String(Ht.name||""),total:Ht.total===""?"":Number(Ht.total)}));await hy({filenameBase:`${e}_${i}`,meta:{courseName:(h==null?void 0:h.courseName)||"",courseCode:(h==null?void 0:h.courseCode)||e,className:(h==null?void 0:h.className)||""},rows:ct})};function ur(ct){return String(ct??"").trim().toLowerCase().replace(/\s+/g," ")}const Ve=()=>{var ct;ir||(ct=L.current)==null||ct.click()},zt=async ct=>{var Ht;if(ct){B(!0);try{const Ue=await ct.arrayBuffer(),qe=N0(Ue,{type:"array"}),at=(Ht=qe.SheetNames)==null?void 0:Ht[0];if(!at)throw new Error("No sheet found in the Excel file.");const Be=qe.Sheets[at],vt=bs.sheet_to_json(Be,{header:1});if(!vt.length)throw new Error("Excel sheet is empty.");const jt=(vt[0]||[]).map(ur),$t=rt=>jt.findIndex(ut=>rt(ut)),Rr=$t(rt=>rt==="register no"||rt==="reg no"||rt.includes("register")),Ur=$t(rt=>rt.startsWith("q1")),en=$t(rt=>rt.startsWith("q2")),vn=$t(rt=>rt==="total"||rt.includes("total")),Nr=$t(rt=>rt==="status"||rt.includes("status"));if(Rr<0)throw new Error("Could not find Register No column.");const fn=Number.isFinite(Number(k.co3))?Number(k.co3):0,rr=Number.isFinite(Number(k.co4))?Number(k.co4):0,ve=new Map;m.rows.forEach((rt,ut)=>{const pt=String(rt.registerNo||"").trim();pt&&ve.set(pt,ut);const Pr=Zb(pt);Pr&&ve.set(Pr,ut)}),g(rt=>{const ut=rt.rows.slice();for(let pt=1;pt<vt.length;pt++){const Pr=vt[pt]||[],Kr=String(Pr[Rr]??"").trim();if(!Kr)continue;const pn=ve.get(Kr);if(pn==null)continue;const _n=(Nr>=0?String(Pr[Nr]??""):"").trim().toLowerCase(),kn=_n==="absent"||_n==="ab"||_n==="a",Wn=Ur>=0?Qv(Pr[Ur]):null,M=en>=0?Qv(Pr[en]):null,oe=vn>=0?Qv(Pr[vn]):null,Re=Wn==null?0:no(Wn,0,fn),Je=M==null?0:no(M,0,rr),kt=oe??Re+Je,mr=kn?0:no(kt,0,w);ut[pn]={...ut[pn],total:zl(mr)}}return{...rt,rows:ut}})}finally{B(!1)}}},yt=async ct=>{var Ue;const Ht=(Ue=ct.target.files)==null?void 0:Ue[0];if(ct.target.value="",!!Ht)try{await zt(Ht)}catch(qe){alert((qe==null?void 0:qe.message)||"Failed to import Excel")}},St={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},sr={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},pr={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},we={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},Ie={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"};return a.jsx(a.Fragment,{children:a.jsxs(ag,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:or,className:"obe-btn obe-btn-secondary",disabled:E,children:E?"Loading roster":"Load/Refresh Roster"}),a.jsx("button",{onClick:Ge,className:"obe-btn obe-btn-danger",disabled:!m.rows.length,children:"Reset Marks"}),a.jsx("button",{onClick:Yt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export CSV"}),a.jsx("button",{onClick:fr,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export Excel"}),a.jsx("button",{onClick:Ve,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length||ir||P,children:P?"Importing":"Import Excel"}),a.jsx("input",{ref:L,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:yt})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Dt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Download"}),a.jsx("button",{onClick:Kt,className:"obe-btn obe-btn-success",disabled:de||ir,title:ir?"Table locked  confirm Mark Manager to enable actions":void 0,children:de?"Saving":"Save Draft"}),a.jsx("button",{onClick:Mt,className:"obe-btn obe-btn-primary",disabled:Ut?st:G||!ge||ir,title:ir?"Table locked  confirm Mark Manager to enable actions":void 0,children:Ut?st?"Request Pending":"Request Edit":G?"Publishing":"Publish"})]})]}),_t?a.jsx("div",{style:{marginTop:8,padding:8,background:"#ecfdf5",border:"1px solid #bbf7d0",borderRadius:8,color:"#065f46",fontWeight:700},children:"Name list locked"}):null,a.jsx("div",{style:{marginTop:10,fontSize:12,color:ge?"#065f46":"#b91c1c"},children:Ne?"Checking publish due time":be||(nt!=null&&nt.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(nt.due_at).toLocaleString(),"  Remaining: ",ng(fe),nt.allowed_by_approval&&nt.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(nt.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Zr?a.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>lt(),disabled:Ne,children:"Refresh"})})]}):ge?null:a.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:Xr,onChange:ct=>Br(ct.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>lt(),disabled:Vr||Ne,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:ar,disabled:Vr,children:Vr?"Requesting":"Request Approval"})]}),Yr?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:Yr}):null]}),(F||X)&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:F||X}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:Ie,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),a.jsxs("div",{style:Ie,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),a.jsxs("div",{style:Ie,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:K||""}),R?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:R})]}):null]}),a.jsxs("div",{style:Ie,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:q||""})]})]}),a.jsxs("div",{style:{marginTop:12,...Ie},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),a.jsx("div",{children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const ct=m.markManagerSnapshot!=null;Ce({mode:ct?"request":"confirm"})},disabled:!e||It,children:m.markManagerSnapshot?"Edit":"Save"})})]}),a.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[a.jsxs("div",{children:["Max ",i,": ",a.jsx("strong",{style:{color:"#111"},children:w})]}),a.jsxs("div",{children:["CO-3 max: ",a.jsx("strong",{style:{color:"#111"},children:k.co3}),"  CO-4 max: ",a.jsx("strong",{style:{color:"#111"},children:k.co4})]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(ct=>{const Ht=z.includes(ct),Ue=!!(ue&&m.markManagerSnapshot!=null);return a.jsxs("div",{onClick:()=>{if(Zr||It)return;const qe=m.markManagerSnapshot!=null;ue&&qe||se(at=>at.includes(ct)?at.filter(Be=>Be!==ct):at.concat(ct).sort((Be,vt)=>Be-vt))},style:{...we,borderColor:Ht?"#16a34a":"#cbd5e1",background:Ht?"#ecfdf5":"#fff",cursor:Ue||It?"not-allowed":"pointer",opacity:Ue?.6:1,padding:"6px 8px"},"aria-disabled":Ue||It,children:[a.jsx("input",{type:"checkbox",checked:Ht,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",ct]})]},`card_btl_${ct}`)})})]})]}),Ot?a.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:Ot}):null]}),a.jsx("div",{style:{marginTop:14},children:Fr?a.jsxs("div",{style:{position:"relative"},children:[a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx(ig,{locked:!!(Zr||$e||ce&&cr),title:Zr?"Locked by IQAC":te?"Published  Locked":"Table Locked",subtitle:Zr?"Publishing is turned OFF globally for this assessment.":te?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:St,colSpan:Gr,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...St,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:St,rowSpan:4,children:"Register No."}),a.jsx("th",{style:St,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:St,children:i}),null,a.jsx("th",{style:St,colSpan:4,children:"CO ATTAINMENT"}),Lt.length?a.jsx("th",{style:St,colSpan:Lt.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:St,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,a.jsx("th",{style:St,colSpan:2,children:"CO-3"}),a.jsx("th",{style:St,colSpan:2,children:"CO-4"}),Lt.map(ct=>a.jsxs("th",{style:St,colSpan:2,children:["BTL-",ct]},`btl-head-${ct}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:St,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:Lt.length?Lt.join(","):"-"})]}),null,Array.from({length:2+Lt.length}).flatMap((ct,Ht)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:St,children:"Mark"}),a.jsx("th",{style:St,children:"%"})]},Ht))]}),a.jsxs("tr",{children:[a.jsx("th",{style:St,children:"Name / Max Marks"}),a.jsx("th",{style:St,children:w}),null,a.jsx("th",{style:St,children:k.co3}),a.jsx("th",{style:St,children:"%"}),a.jsx("th",{style:St,children:k.co4}),a.jsx("th",{style:St,children:"%"}),Lt.flatMap(ct=>[a.jsx("th",{style:St,children:String(s?A:Math.max(Number(j[`btl${ct}`]??0)||0,jp))},`btl-max-${ct}`),a.jsx("th",{style:St,children:"%"},`btl-pct-${ct}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Gr,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):ir&&!$e?a.jsx("tr",{children:a.jsx("td",{colSpan:Gr,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):m.rows.map((ct,Ht)=>{const Ue=typeof ct.total=="number"?no(Number(ct.total),0,w):null,qe=Ue==null?null:zl(Ue/2),at=qe==null?null:no(qe,0,k.co3),Be=qe==null?null:no(qe,0,k.co4),vt=Lt.map(en=>en-1),$t=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((en,vn)=>vt.includes(vn)?s?A:en>0?en:jp:en),Rr=Ue==null?null:vt.length?zl(Ue/vt.length):0,Ur=$t.map((en,vn)=>Ue==null||!vt.includes(vn)?null:en>0?no(Rr,0,en):zl(Rr));return a.jsxs("tr",{style:{background:Ht%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...sr,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ht+1}),a.jsx("td",{style:sr,children:Zb(ct.registerNo)}),a.jsx("td",{style:sr,children:ct.name}),a.jsx("td",{style:{...sr,width:90,background:"#fff7ed"},children:dn?a.jsx("div",{style:pr,children:typeof ct.total=="number"?zl(ct.total):""}):a.jsx("input",{style:pr,type:"number",value:ct.total,min:0,max:w,onChange:en=>{if(dn)return;const vn=en.target.value;if(vn==="")return Qt(Ht,{total:""});const Nr=Number(vn);if(!Number.isFinite(Nr))return Qt(Ht,{total:""});if(Nr>w){en.currentTarget.setCustomValidity(`Max mark is ${w}`),en.currentTarget.reportValidity(),window.setTimeout(()=>en.currentTarget.setCustomValidity(""),0);return}en.currentTarget.setCustomValidity("");const fn=no(Nr,0,w);Qt(Ht,{total:fn})}})}),null,a.jsx("td",{style:{...sr,textAlign:"center"},children:at??""}),a.jsx("td",{style:{...sr,textAlign:"center"},children:ml(at,k.co3)}),a.jsx("td",{style:{...sr,textAlign:"center"},children:Be??""}),a.jsx("td",{style:{...sr,textAlign:"center"},children:ml(Be,k.co4)}),Lt.map(en=>{const vn=en-1,Nr=Ur[vn],fn=$t[vn];return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...sr,textAlign:"center"},children:Nr??""}),a.jsx("td",{style:{...sr,textAlign:"center"},children:ml(Nr,fn)})]},en)})]},String(ct.studentId||Ht))})})]})})}),vr&&Fr?a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[a.jsx("div",{style:{textAlign:"center"},children:te?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Confirm the Mark Manager"})]})}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{className:"obe-btn",onClick:()=>Oe(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:st,onClick:Gt,children:st?"Request Pending":"Request Edit"})]})]}):null]}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:a.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[a.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:te&&Fr?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:te&&Fr?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:te&&Fr?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>Oe(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:st,onClick:Gt,children:st?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ce({mode:"confirm"}),disabled:!e||It,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Ze(),disabled:It,children:"Request Access"})]})})]})})}),pe?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>Oe(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:ct=>ct.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsx("button",{onClick:ct=>{ct.stopPropagation(),Oe(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),a.jsxs("div",{style:{padding:14},children:[_e?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,We?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:We}):null]}),a.jsx("div",{ref:Ar,style:{overflow:"auto",borderTop:"1px solid #e5e7eb",borderBottom:"1px solid #e5e7eb",borderLeft:"1px solid #e5e7eb",borderRight:"1px solid #e5e7eb",borderRadius:0,maxHeight:"60vh",background:"#fff"},children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:St,colSpan:Gr,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...St,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:St,rowSpan:4,children:"Register No."}),a.jsx("th",{style:St,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:St,children:i}),null,a.jsx("th",{style:St,colSpan:4,children:"CO ATTAINMENT"}),Lt.length?a.jsx("th",{style:St,colSpan:Lt.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:St,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,a.jsx("th",{style:St,colSpan:2,children:"CO-3"}),a.jsx("th",{style:St,colSpan:2,children:"CO-4"}),Lt.map(ct=>a.jsxs("th",{style:St,colSpan:2,children:["BTL-",ct]},`btl-head-${ct}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:St,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:Lt.length?Lt.join(","):"-"})]}),null,Array.from({length:2+Lt.length}).flatMap((ct,Ht)=>a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:St,children:"Mark"}),a.jsx("th",{style:St,children:"%"})]},Ht))]}),a.jsxs("tr",{children:[a.jsx("th",{style:St,children:"Name / Max Marks"}),a.jsx("th",{style:St,children:w}),null,a.jsx("th",{style:St,children:k.co3}),a.jsx("th",{style:St,children:"%"}),a.jsx("th",{style:St,children:k.co4}),a.jsx("th",{style:St,children:"%"}),Lt.flatMap(ct=>[a.jsx("th",{style:St,children:String(s?A:Math.max(Number(j[`btl${ct}`]??0)||0,jp))},`btl-max-${ct}`),a.jsx("th",{style:St,children:"%"},`btl-pct-${ct}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Gr,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):m.rows.map((ct,Ht)=>{var Nr;const Ue=((Nr=Ae==null?void 0:Ae.marks)==null?void 0:Nr[String(ct.studentId)])??null,qe=Ue==null||Ue===""?null:no(Number(Ue),0,w),Be=qe==null?null:zl(qe/2),vt=Be==null?null:no(Be,0,k.co3),jt=Be==null?null:no(Be,0,k.co4),$t=Lt.map(fn=>fn-1),Ur=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((fn,rr)=>$t.includes(rr)?s?A:fn>0?fn:jp:fn),en=qe==null?null:$t.length?zl(qe/$t.length):0,vn=Ur.map((fn,rr)=>qe==null||!$t.includes(rr)?null:fn>0?no(en,0,fn):zl(en));return a.jsxs("tr",{style:{background:Ht%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...sr,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ht+1}),a.jsx("td",{style:sr,children:Zb(ct.registerNo)}),a.jsx("td",{style:sr,children:ct.name}),a.jsx("td",{style:{...sr,width:90,background:"#fff7ed",textAlign:"center"},children:qe==null?"":zl(qe)}),null,a.jsx("td",{style:{...sr,textAlign:"center"},children:vt??""}),a.jsx("td",{style:{...sr,textAlign:"center"},children:ml(vt,k.co3)}),a.jsx("td",{style:{...sr,textAlign:"center"},children:jt??""}),a.jsx("td",{style:{...sr,textAlign:"center"},children:ml(jt,k.co4)}),Lt.map(fn=>{const rr=fn-1,ve=vn[rr],rt=Ur[rr];return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...sr,textAlign:"center"},children:ve??""}),a.jsx("td",{style:{...sr,textAlign:"center"},children:ml(ve,rt)})]},fn)})]},String(ct.studentId||Ht))})})]})}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>Oe(!1),children:"Close"})})]})})}):null,Me?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{It||Ce(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ct=>ct.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Me.mode==="confirm"?`Confirmation - ${i}`:`Request Edit - ${i}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),Me.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",i]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-3 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:k.co3})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-4 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:k.co4})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(ct=>{const Ht=z.includes(ct);return a.jsxs("div",{onClick:()=>{It||se(Ue=>Ue.includes(ct)?Ue.filter(qe=>qe!==ct):[...Ue,ct].sort((qe,at)=>qe-at))},style:{...we,borderColor:Ht?"#16a34a":"#cbd5e1",background:Ht?"#ecfdf5":"#fff",cursor:It?"not-allowed":"pointer",padding:"6px 8px"},children:[a.jsx("input",{type:"checkbox",checked:Ht,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",ct]})]},`modal_btl_${ct}`)})})})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:It,onClick:()=>Ce(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:It||!e,onClick:async()=>{if(e){if(Me.mode==="request"){Ce(null),await Ze();return}await Bt()}},children:Me.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,Q?a.jsx(gs,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{H||ie(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ct=>ct.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",Wt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",q||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",K||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:le,onChange:ct=>O(ct.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),I?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:I}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:H,onClick:()=>ie(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",disabled:H||st||!e||!String(le||"").trim(),onClick:async()=>{await ot()},children:H?"Requesting":st?"Request Pending":"Send Request"})]})]})})}):null,a.jsx("style",{children:`
        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),a.jsx("div",{style:{marginTop:14},children:Fr?a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"}}):null})]})})}function Qxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Xxe,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa2",label:r||"SSA2"})}const ev=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],FM=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function jd(e,t,r){return Math.max(t,Math.min(r,e))}function Jxe(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function IM(e,t){if(Array.isArray(e)){const r=e.slice(0,t).map(n=>typeof n=="number"&&Number.isFinite(n)?n:"");for(;r.length<t;)r.push("");return r}return new Array(t).fill("")}function DM(e){const t=(e||[]).filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Ns(e){return Math.round(e*100)/100}function Zxe(e,t){const r=String(t||"").toLowerCase();return r==="ssa"?"SSA":r==="cia"?"CIA":r==="fa"?"FA":r==="review"?"REVIEW":r==="me"?"ME":r==="lab1"?"LAB1":r==="lab2"?"LAB2":String(t||"").toUpperCase()}function tu(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function e1e(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function $M(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),i=n.includes("1"),s=n.includes("2");if(i&&s||n==="1&2"||n==="1,2"||n==="1/2"||n==="2/1"||n==="CO1&CO2"||n==="CO1,CO2"||n==="CO1/CO2"||n==="CO2/CO1")return"1&2";if(n==="CO2"||n==="2")return 2;if(n==="CO1"||n==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const i=n.match(/\d+/);return Number(i?i[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===2?2:t===12?"1&2":1}function UM(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),i=n.includes("3"),s=n.includes("4");if(i&&s)return"3&4";if(s)return 4;if(i)return 3;if(n==="3&4"||n==="3,4"||n==="3/4"||n==="4/3"||n==="CO3&CO4"||n==="CO3,CO4"||n==="CO3/CO4"||n==="CO4/CO3")return"3&4";if(n==="CO4"||n==="4")return 4;if(n==="CO3"||n==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const i=n.match(/\d+/);return Number(i?i[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===4?4:t===3?3:t===34?"3&4":3}function t1e(e,t){const r=e[t];if(!r)return{co1:0,co2:0};const n=$M(r.co);if(n==="1&2")return{co1:.5,co2:.5};const i=e.some(u=>$M(u==null?void 0:u.co)==="1&2"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!i&&s&&c?{co1:.5,co2:.5}:n===2?{co1:0,co2:1}:{co1:1,co2:0}}function r1e(e,t){const r=e[t];if(!r)return{co3:0,co4:0};const n=UM(r.co);if(n==="3&4")return{co3:.5,co4:.5};const i=e.some(u=>UM(u==null?void 0:u.co)==="3&4"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!i&&s&&c?{co3:.5,co4:.5}:n===4?{co3:0,co4:1}:{co3:1,co4:0}}function n1e({subjectId:e,teachingAssignmentId:t,classType:r,enabledAssessments:n,assessmentType:i,cos:s,cqiDivider:o,cqiMultiplier:l}){var R,J;const[c,u]=x.useState([]),[d,f]=x.useState(!1),[h,p]=x.useState(null),[m,g]=x.useState({}),[y,b]=x.useState({}),[v,w]=x.useState({}),[S,k]=x.useState(null),[j,A]=x.useState(null),L=58,P=x.useMemo(()=>{const q=Number(o);if(Number.isFinite(q)&&q>0)return q;const Y=Number(j==null?void 0:j.divider);return Number.isFinite(Y)&&Y>0?Y:2},[o,j]),B=x.useMemo(()=>{const q=Number(l);if(Number.isFinite(q)&&q>=0)return q;const Y=Number(j==null?void 0:j.multiplier);return Number.isFinite(Y)&&Y>=0?Y:.15},[l,j]),[E,T]=x.useState(!0),[F,W]=x.useState(!0),[z,se]=x.useState(null),[de,U]=x.useState(!0),[G,re]=x.useState(!1);x.useEffect(()=>{let q=!0;return(async()=>{try{const Y=await SS();if(!q)return;const Q=Number(Y==null?void 0:Y.divider),ie=Number(Y==null?void 0:Y.multiplier);A({options:Array.isArray(Y==null?void 0:Y.options)?Y.options:[],divider:Number.isFinite(Q)?Q:2,multiplier:Number.isFinite(ie)?ie:.15})}catch{q&&A(null)}})(),()=>{q=!1}},[]);const X=x.useMemo(()=>!s||!Array.isArray(s)?[]:s.map(q=>{const Y=q.match(/\d+/);return Y?parseInt(Y[0]):null}).filter(q=>q!==null).sort((q,Y)=>q-Y),[s]),C=x.useMemo(()=>{const q={};return X.forEach(Y=>{const Q=`co${Y}`;let ie=null;Object.values(m).forEach(le=>{const O=le&&le[Q];if(O&&typeof O.max=="number"){const H=O.max;(ie==null||H>ie)&&(ie=H)}}),q[Y]=ie}),q},[m,X]);x.useEffect(()=>{let q=!0;return(async()=>{try{const Y=await vu();if(!q)return;k(Y||null)}catch{}})(),()=>{q=!1}},[e]),x.useEffect(()=>{if(!t)return;let q=!0;return f(!0),p(null),(async()=>{try{const Y=await qc(t);if(!q)return;const Q=(Y.students||[]).map(ie=>({id:Number(ie.id),reg_no:String(ie.reg_no??""),name:String(ie.name??""),section:ie.section??null})).filter(ie=>Number.isFinite(ie.id)).sort(e1e);u(Q)}catch(Y){if(!q)return;p((Y==null?void 0:Y.message)||"Failed to load roster")}finally{q&&f(!1)}})(),()=>{q=!1}},[t]),x.useEffect(()=>{if(!e||!t)return;const q=`cqi_entries_${e}_${t}`,Y=Jn(q);Y&&typeof Y=="object"&&(b(Y),re(!1)),(async()=>{try{const Q=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",ie=await yr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${Q}`,{method:"GET"}).catch(()=>null);if(ie&&ie.ok){const le=await ie.json().catch(()=>null);le!=null&&le.draft&&(b(le.draft.entries||le.draft||{}),se({updated_at:le.updated_at||null,updated_by:le.updated_by||null}),re(!1))}}catch{}})()},[e,t]),x.useEffect(()=>{if(!e||!t||c.length===0||X.length===0)return;let q=!0;return(async()=>{var Y,Q,ie,le,O,H,ae,I,Z,pe,Oe,Ae,ke,_e,De,We,Ct,_t,Xe,nt,Ne,be,fe,ge,lt,He;try{f(!0);const mt=ti(r),wt=Jxe(n),Pt=mt==="SPECIAL"&&wt.size,bt=or=>Pt?wt.has(String(or).toLowerCase()):!0,qr=mt==="TCPR",Tt=mt==="TCPL",xr=mt==="LAB"||mt==="PRACTICAL",Xr=!xr&&mt!=="SPECIAL"&&X.some(or=>or>=1&&or<=5),Br=(()=>{if(!Xr)return null;const or=String(t??"none"),kr=[];mt==="THEORY"?(kr.push(`model_theory_sheet_${e}_${or}`),kr.push(`model_theory_sheet_${e}_none`)):mt==="TCPL"?(kr.push(`model_tcpl_sheet_${e}_${or}`),kr.push(`model_tcpl_sheet_${e}_none`)):mt==="TCPR"&&(kr.push(`model_tcpr_sheet_${e}_${or}`),kr.push(`model_tcpr_sheet_${e}_none`)),kr.push(`model_sheet_${e}`);for(const Mr of kr){const Ar=Jn(Mr);if(Ar&&typeof Ar=="object")return Ar}return null})(),Vr=(()=>{const or={co1:0,co2:0,co3:0,co4:0,co5:0};for(let kr=0;kr<ev.length;kr++){const Mr=ev[kr],Ar=FM[kr];Ar===1?or.co1+=Mr.max:Ar===2?or.co2+=Mr.max:Ar===3?or.co3+=Mr.max:Ar===4?or.co4+=Mr.max:Ar===5&&(or.co5+=Mr.max)}return or})(),An=or=>{if(!Br)return null;const kr=`id:${String(or.id)}`,Mr=or.reg_no?`reg:${String(or.reg_no).trim()}`:"",Ar=Br[kr]||(Mr?Br[Mr]:null)||null;if(!Ar||typeof Ar!="object")return null;const Zt=!!Ar.absent,Kt=String(Ar.absentKind||"AL").toUpperCase();if(Zt&&Kt==="AL")return null;const it=Ar.q&&typeof Ar.q=="object"?Ar.q:Ar;let At=!1;const Mt={co1:0,co2:0,co3:0,co4:0,co5:0};for(let Ge=0;Ge<ev.length;Ge++){const Rt=ev[Ge],Ze=tu(it[Rt.key]);if(Ze==null)continue;At=!0;const ot=FM[Ge];ot===1?Mt.co1+=Ze:ot===2?Mt.co2+=Ze:ot===3?Mt.co3+=Ze:ot===4?Mt.co4+=Ze:ot===5&&(Mt.co5+=Ze)}if(!At)return null;const ar=(Ge,Rt,Ze)=>!Rt||!Number.isFinite(Rt)||Rt<=0?0:jd(jd(Ge,0,Rt)/Rt*Ze,0,Ze);return{co1:ar(Mt.co1,Vr.co1,2),co2:ar(Mt.co2,Vr.co2,2),co3:ar(Mt.co3,Vr.co3,2),co4:ar(Mt.co4,Vr.co4,2),co5:ar(Mt.co5,Vr.co5,4)}},Yr=X.some(or=>or===1||or===2),Ln=X.some(or=>or===3||or===4),Me=X.some(or=>or===5),[Ce,It,ft,Ot,er,hr,Tr,ne,ce,te,ue,Ee,je]=await Promise.all([Yr&&bt("ssa1")&&!xr?rg(e,t).catch(()=>({marks:{}})):{marks:{}},Ln&&bt("ssa2")&&!xr?ty(e,t).catch(()=>({marks:{}})):{marks:{}},Yr&&bt("formative1")&&!xr&&!qr&&!Tt?AS(e,t).catch(()=>({marks:{}})):{marks:{}},Ln&&bt("formative2")&&!xr&&!qr&&!Tt?b0("formative2",e,t).catch(()=>({marks:{}})):{marks:{}},Yr&&bt("cia1")&&!xr?ry(e,t).catch(()=>({data:null})):{data:null},Ln&&bt("cia2")&&!xr?v0("cia2",e,t).catch(()=>({data:null})):{data:null},Yr&&bt("review1")&&qr?kS(e).catch(()=>({marks:{}})):{marks:{}},Ln&&bt("review2")&&qr?jS(e).catch(()=>({marks:{}})):{marks:{}},Yr&&bt("formative1")&&Tt?(async()=>{try{const or=await ei("formative1",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return ho("formative1",e,t).catch(()=>({data:null}))})():{data:null},Ln&&bt("formative2")&&Tt?(async()=>{try{const or=await ei("formative2",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return ho("formative2",e,t).catch(()=>({data:null}))})():{data:null},Yr&&bt("cia1")&&xr?(async()=>{try{const or=await ei("cia1",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return ho("cia1",e,t).catch(()=>({data:null}))})():{data:null},Ln&&bt("cia2")&&xr?(async()=>{try{const or=await ei("cia2",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return ho("cia2",e,t).catch(()=>({data:null}))})():{data:null},Me&&bt("model")&&xr?(async()=>{try{const or=await ei("model",e,t);if(or!=null&&or.draft)return{data:or.draft.data??or.draft}}catch{}return Rm(e,t).catch(()=>({data:null}))})():{data:null}]);if(!q)return;const gt={ssa:1.5,cia:3,fa:2.5},Qe={ssa:gt.ssa,cia:gt.cia,fa:gt.fa},Fe=((Y=S==null?void 0:S.assessments)==null?void 0:Y.ssa1)||{},$e=((Q=S==null?void 0:S.assessments)==null?void 0:Q.ssa2)||{},st=((ie=S==null?void 0:S.assessments)==null?void 0:ie.formative1)||{},Wt=((le=S==null?void 0:S.assessments)==null?void 0:le.formative2)||{},qt=((O=S==null?void 0:S.assessments)==null?void 0:O.cia1)||{},ht=((H=S==null?void 0:S.assessments)==null?void 0:H.cia2)||{},Ut=((ae=S==null?void 0:S.assessments)==null?void 0:ae.review1)||{},Gt=((I=S==null?void 0:S.assessments)==null?void 0:I.review2)||{},cr={ssa1:{co1:Number((Z=Fe==null?void 0:Fe.coMax)==null?void 0:Z.co1)||10,co2:Number((pe=Fe==null?void 0:Fe.coMax)==null?void 0:pe.co2)||10},ssa2:{co3:Number(((Oe=$e==null?void 0:$e.coMax)==null?void 0:Oe.co3)??((Ae=$e==null?void 0:$e.coMax)==null?void 0:Ae.co1))||10,co4:Number(((ke=$e==null?void 0:$e.coMax)==null?void 0:ke.co4)??((_e=$e==null?void 0:$e.coMax)==null?void 0:_e.co2))||10},cia1:{co1:Number((De=qt==null?void 0:qt.coMax)==null?void 0:De.co1)||30,co2:Number((We=qt==null?void 0:qt.coMax)==null?void 0:We.co2)||30},cia2:{co3:Number(((Ct=ht==null?void 0:ht.coMax)==null?void 0:Ct.co3)??((_t=ht==null?void 0:ht.coMax)==null?void 0:_t.co1))||30,co4:Number(((Xe=ht==null?void 0:ht.coMax)==null?void 0:Xe.co4)??((nt=ht==null?void 0:ht.coMax)==null?void 0:nt.co2))||30},f1:{co1:Number(st==null?void 0:st.maxCo)||10,co2:Number(st==null?void 0:st.maxCo)||10},f2:{co3:Number(Wt==null?void 0:Wt.maxCo)||10,co4:Number(Wt==null?void 0:Wt.maxCo)||10},review1:{co1:Number((Ne=Ut==null?void 0:Ut.coMax)==null?void 0:Ne.co1)||15,co2:Number((be=Ut==null?void 0:Ut.coMax)==null?void 0:be.co2)||15},review2:{co3:Number(((fe=Gt==null?void 0:Gt.coMax)==null?void 0:fe.co3)??((ge=Gt==null?void 0:Gt.coMax)==null?void 0:ge.co1))||15,co4:Number(((lt=Gt==null?void 0:Gt.coMax)==null?void 0:lt.co4)??((He=Gt==null?void 0:Gt.coMax)==null?void 0:He.co2))||15}},ir=or=>{const kr=or!=null&&or.sheet&&typeof or.sheet=="object"?or.sheet:{},Mr=kr!=null&&kr.rowsByStudentId&&typeof kr.rowsByStudentId=="object"?kr.rowsByStudentId:{},Ar=jd(Number((kr==null?void 0:kr.expCountA)??0),0,12),Zt=jd(Number((kr==null?void 0:kr.expCountB)??0),0,12),Kt=Number.isFinite(Number(kr==null?void 0:kr.expMaxA))?Number(kr.expMaxA):25,it=Number.isFinite(Number(kr==null?void 0:kr.expMaxB))?Number(kr.expMaxB):25,At=(kr==null?void 0:kr.ciaExamEnabled)!==!1,Mt=30/2,ar=Kt+(At?Mt:0),Ge=it+(At?Mt:0);return{get:Ze=>{const ot=Mr[String(Ze)]||{},Bt=IM(ot==null?void 0:ot.marksA,Ar),Qt=IM(ot==null?void 0:ot.marksB,Zt),Yt=DM(Bt),fr=DM(Qt),Dt=ot==null?void 0:ot.ciaExam,ur=typeof Dt=="number"&&Number.isFinite(Dt)?Dt:null,Ve=Yt!=null||fr!=null||ur!=null,zt=Ve?(Yt??0)+(At?(ur??0)/2:0):null,yt=Ve?(fr??0)+(At?(ur??0)/2:0):null;return{a:zt==null?null:jd(zt,0,ar),b:yt==null?null:jd(yt,0,Ge)}},CO_MAX_A:ar,CO_MAX_B:Ge}},Fr=Tt?ir((ce==null?void 0:ce.data)??null):null,dn=Tt?ir((te==null?void 0:te.data)??null):null,vr=xr?ir((ue==null?void 0:ue.data)??null):null,Lt=xr?ir((Ee==null?void 0:Ee.data)??null):null,Gr=xr?ir((je==null?void 0:je.data)??null):null,bn={};c.forEach(or=>{bn[or.id]={};const kr=Xr?An(or):null;X.forEach(Mr=>{let Ar=null,Zt=0,Kt=null,it=0,At=null,Mt=0,ar=null,Ge=0,Rt=null,Ze=0;if(kr){const Bt=`co${Mr}`;Bt in kr&&(Rt=Number(kr[Bt]),Ze=Mr===5?4:2)}if(Mr===1||Mr===2)if(xr){if(vr){const Bt=vr.get(or.id),Qt=Mr===1?Bt.a:Bt.b;Qt!=null&&(Kt=Qt,it=Mr===1?vr.CO_MAX_A:vr.CO_MAX_B)}}else{const Bt=tu(Ce.marks[String(or.id)]);Ar=Bt==null?null:Number(Bt)/2,Zt=Mr===1?cr.ssa1.co1:cr.ssa1.co2;const Yt=er.data;if(Yt){const Dt=(Yt.rowsByStudentId||{})[String(or.id)]||{},ur=Yt.questions||[],Ve=Dt!=null&&Dt.q&&typeof Dt.q=="object"?Dt.q:Dt;let zt=!1,yt=0,St=0;ur.forEach((sr,pr)=>{const we=Number((sr==null?void 0:sr.max)||0),Ie=t1e(ur,pr),tt=Mr===2?Ie.co2:Ie.co1;tt>0&&we>0&&(St+=we*tt);const dt=tu(Ve==null?void 0:Ve[sr.key]);if(dt==null||tt<=0)return;zt=!0;const xt=we>0?jd(dt,0,we):dt;yt+=xt*tt}),zt&&(Kt=yt,it=St>0?St:Mr===1?cr.cia1.co1:cr.cia1.co2)}if(qr){const fr=tu(Tr.marks[String(or.id)]),Dt=fr==null?null:Number(fr)/2;Dt!=null&&(At=Dt,Mt=Mr===1?cr.review1.co1:cr.review1.co2)}if(Tt&&Fr){const fr=Fr.get(or.id),Dt=Mr===1?fr.a:fr.b;Dt!=null&&(ar=Dt,Ge=Mr===1?Fr.CO_MAX_A:Fr.CO_MAX_B)}if(!qr&&!Tt){const fr=(ft.marks||{})[String(or.id)]||{},Dt=Mr===1?"skill1":"skill2",ur=Mr===1?"att1":"att2",Ve=tu(fr[Dt]),zt=tu(fr[ur]);Ve!==null&&zt!==null&&(ar=Ve+zt,Ge=Mr===1?cr.f1.co1:cr.f1.co2)}}else if(Mr===3||Mr===4)if(xr){if(Lt){const Bt=Lt.get(or.id),Qt=Mr===3?Bt.a:Bt.b;Qt!=null&&(Kt=Qt,it=Mr===3?Lt.CO_MAX_A:Lt.CO_MAX_B)}}else{const Bt=tu(It.marks[String(or.id)]);Ar=Bt==null?null:Number(Bt)/2,Zt=Mr===3?cr.ssa2.co3:cr.ssa2.co4;const Yt=hr.data;if(Yt){const Dt=(Yt.rowsByStudentId||{})[String(or.id)]||{},ur=Yt.questions||[],Ve=Dt!=null&&Dt.q&&typeof Dt.q=="object"?Dt.q:Dt;let zt=!1,yt=0,St=0;ur.forEach((sr,pr)=>{const we=Number((sr==null?void 0:sr.max)||0),Ie=r1e(ur,pr),tt=Mr===4?Ie.co4:Ie.co3;tt>0&&we>0&&(St+=we*tt);const dt=tu(Ve==null?void 0:Ve[sr.key]);if(dt==null||tt<=0)return;zt=!0;const xt=we>0?jd(dt,0,we):dt;yt+=xt*tt}),zt&&(Kt=yt,it=St>0?St:Mr===3?cr.cia2.co3:cr.cia2.co4)}if(qr){const fr=tu(ne.marks[String(or.id)]),Dt=fr==null?null:Number(fr)/2;Dt!=null&&(At=Dt,Mt=Mr===3?cr.review2.co3:cr.review2.co4)}if(Tt&&dn){const fr=dn.get(or.id),Dt=Mr===3?fr.a:fr.b;Dt!=null&&(ar=Dt,Ge=Mr===3?dn.CO_MAX_A:dn.CO_MAX_B)}if(!qr&&!Tt){const fr=(Ot.marks||{})[String(or.id)]||{},Dt=Mr===3?"skill1":"skill2",ur=Mr===3?"att1":"att2",Ve=tu(fr[Dt]),zt=tu(fr[ur]);Ve!==null&&zt!==null&&(ar=Ve+zt,Ge=Mr===3?cr.f2.co3:cr.f2.co4)}}if(xr&&Mr===5&&Gr){const Bt=Gr.get(or.id);Bt.a!=null&&(Rt=Bt.a,Ze=Gr.CO_MAX_A)}const ot=[];if(Ar!==null&&Zt>0&&ot.push({key:"ssa",mark:Ar,max:Zt,w:Qe.ssa}),Kt!==null&&it>0&&ot.push({key:"cia",mark:Kt,max:it,w:Qe.cia}),At!==null&&Mt>0&&ot.push({key:"review",mark:At,max:Mt,w:Qe.fa}),ar!==null&&Ge>0){const Bt=Tt?Mr===1||Mr===2?"lab1":Mr===3||Mr===4?"lab2":"fa":"fa";ot.push({key:Bt,mark:ar,max:Ge,w:Qe.fa})}if(Rt!==null&&Ze>0&&ot.push({key:"me",mark:Rt,max:Ze,w:Ze}),ot.length>0){const Qt=ot.reduce((Dt,ur)=>Dt+ur.w,0),Yt=ot.reduce((Dt,ur)=>{const Ve=ur.mark/ur.max;return Dt+Ve*ur.w},0),fr=ot.map(Dt=>({...Dt,contrib:Ns(Dt.mark/Dt.max*Dt.w)}));bn[or.id][`co${Mr}`]={value:Ns(Yt),max:Ns(Qt),breakdown:fr}}else bn[or.id][`co${Mr}`]=null})}),g(bn)}catch(mt){if(!q)return;p((mt==null?void 0:mt.message)||"Failed to calculate CO totals")}finally{q&&f(!1)}})(),()=>{q=!1}},[e,t,r,n,c,X,S]);const K=(q,Y,Q)=>{if(Q===""){w(H=>{const ae={...H};return delete ae[`${q}_${Y}`],ae}),b(H=>({...H,[q]:{...H[q],[Y]:null}}));return}const ie=Number(Q);if(!(Number.isFinite(ie)&&Math.floor(ie)===ie)){w(H=>({...H,[`${q}_${Y}`]:"Enter an integer between 0 and 10"})),b(H=>({...H,[q]:{...H[q],[Y]:null}}));return}const O=ie;if(O<0||O>10){w(H=>({...H,[`${q}_${Y}`]:"Value must be between 0 and 10"})),b(H=>({...H,[q]:{...H[q],[Y]:O}}));return}w(H=>{const ae={...H};return delete ae[`${q}_${Y}`],ae}),b(H=>{const ae={...H,[q]:{...H[q],[Y]:O}};if(e&&t){const I=`cqi_entries_${e}_${t}`;try{Gn(I,ae)}catch{}}return re(!0),ae})},V=()=>{if(!(!e||!t)){if(Object.keys(v).length){alert("Fix CQI input errors before saving");return}(async()=>{const q=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"";try{const Q=await yr(`/api/obe/cqi-save/${encodeURIComponent(String(e))}${q}`,{method:"PUT",body:JSON.stringify({entries:y})}).catch(()=>null);if(Q&&Q.ok){alert("CQI entries saved to server"),re(!1);try{const ie=await Q.json().catch(()=>null);ie&&se(ie)}catch{}return}}catch{}const Y=`cqi_entries_${e}_${t}`;try{Gn(Y,y),re(!1),alert("CQI entries saved locally")}catch(Q){alert("Failed to save CQI entries: "+String((Q==null?void 0:Q.message)||Q))}})()}};return!e||!t?a.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"Missing subject ID or teaching assignment ID"}):d?a.jsx("div",{style:{padding:24,textAlign:"center",color:"#6b7280"},children:"Loading CQI data..."}):h?a.jsxs("div",{style:{padding:24,color:"#b91c1c"},children:["Error: ",h]}):X.length===0?a.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"No course outcomes selected for CQI entry"}):a.jsxs("div",{style:{padding:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:16,background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",borderRadius:12,border:"1px solid #bae6fd"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:["CQI Entry - ",s==null?void 0:s.join(", ")]}),a.jsxs("div",{style:{marginTop:4,fontSize:14,color:"#64748b"},children:["Students below ",L,"% threshold require CQI intervention"]})]}),a.jsx("button",{onClick:V,className:"obe-btn obe-btn-primary",style:{minWidth:100},children:"Save CQI"}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("button",{type:"button",onClick:()=>T(q=>!q),className:"obe-btn",style:{minWidth:90,background:E?"#fef3c7":void 0},children:E?"DEBUG ON":"DEBUG"}),a.jsx("button",{type:"button",onClick:()=>W(q=>!q),className:"obe-btn",style:{minWidth:120},children:F?"Hide Header Max":"Show Header Max"}),a.jsx("button",{type:"button",onClick:async()=>{if(!e||!t)return alert("Missing subject/teaching assignment");try{const q={entries:y},Y=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",Q=await yr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${Y}`,{method:"PUT",body:JSON.stringify(q)}).catch(()=>null);if(Q&&Q.ok){const ie=await Q.json().catch(()=>null);se(ie||{updated_at:new Date().toISOString(),updated_by:null}),re(!1),alert("Draft saved to server")}else{const ie=`cqi_entries_${e}_${t}`;try{Gn(ie,y),re(!1),alert("Draft saved locally")}catch{alert("Failed to save draft")}}}catch(q){alert("Failed to save draft: "+String((q==null?void 0:q.message)||q))}},className:"obe-btn",style:{minWidth:110},children:"Save Draft"}),a.jsx("button",{type:"button",onClick:async()=>{if(!e)return alert("Missing subject");if(confirm("Publish CQI to DB? This action cannot be undone."))try{const q=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",Y=await yr(`/api/obe/cqi-publish/${encodeURIComponent(String(e))}${q}`,{method:"POST"}).catch(()=>null);Y&&Y.ok?alert("CQI published"):alert("Publish failed (server may not support CQI publish)")}catch(q){alert("Publish failed: "+String((q==null?void 0:q.message)||q))}},className:"obe-btn obe-btn-primary",style:{minWidth:110},children:"Publish"})]})]}),a.jsxs("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",background:"#f8fafc",borderBottom:"1px solid #e6eef8"},children:[a.jsxs("div",{style:{fontSize:13,color:"#475569"},children:["Draft: ",z!=null&&z.updated_at?new Date(String(z.updated_at)).toLocaleString():"never"," ",z!=null&&z.updated_by?`by ${((R=z.updated_by)==null?void 0:R.name)||((J=z.updated_by)==null?void 0:J.username)||z.updated_by}`:"",G?"  unsaved changes":""]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:13,color:"#475569"},children:[a.jsx("input",{type:"checkbox",checked:de,onChange:()=>U(q=>!q)})," Auto-save"]}),a.jsx("button",{className:"obe-btn",onClick:()=>{(async()=>{if(!e||!t)return alert("Missing subject/TA");try{const q=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",Y=await yr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${q}`,{method:"PUT",body:JSON.stringify({entries:y})}).catch(()=>null);if(Y&&Y.ok){const Q=await Y.json().catch(()=>null);se(Q||null),re(!1),alert("Draft synced to server")}else alert("Server save failed")}catch(q){alert("Server save failed: "+String((q==null?void 0:q.message)||q))}})()},children:"Sync Draft"})]})]}),a.jsxs("table",{className:"cqi-table",style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},children:[a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:60},children:"S.No"}),a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:120},children:"Reg No"}),a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:200},children:"Name"}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["BEFORE CQI",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["AFTER CQI",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:120},children:["TOTAL",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Sum of selected COs"})]}),X.map(q=>a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:150},children:["CO",q,a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:F?a.jsxs(a.Fragment,{children:["Max: ",C[q]!=null?Ns(C[q]):""]}):a.jsx(a.Fragment,{children:""})})]},q))]})}),a.jsx("tbody",{children:c.map((q,Y)=>{const Q=m[q.id]||{};let ie=0,le=0;X.forEach(_e=>{const De=Q[`co${_e}`];De&&(ie+=De.value,le+=De.max)});const O=ie,H=le,ae=H?O/H*100:0,I=le?ie/le*100:0,Z=H?ae:I,pe=le;let Oe=ie,Ae=0;X.forEach(_e=>{var be;const De=`co${_e}`,We=Q[De],Ct=(be=y[q.id])==null?void 0:be[De];if(!We||Ct==null||!((We.max?Number(We.value)/Number(We.max)*100:0)<L))return;const nt=Number(Ct)/10*Number(We.max),Ne=Z<L?nt/P:nt*B;Number.isFinite(Ne)&&Ne>0&&(Ae+=Ne,Oe+=Ne)}),Oe=Number.isFinite(Oe)?jd(Oe,0,pe||Oe):ie;const ke=pe?Oe/pe*100:0;return a.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:Y%2===0?"white":"#f9fafb"},children:[a.jsx("td",{style:{padding:"10px 8px",color:"#64748b"},children:Y+1}),a.jsx("td",{style:{padding:"10px 8px",fontFamily:"monospace",color:"#0f172a"},children:q.reg_no}),a.jsx("td",{style:{padding:"10px 8px",color:"#0f172a"},children:q.name}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600},children:le>0?a.jsxs("div",{children:[a.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[Ns(ie),!E&&le>0?a.jsxs(a.Fragment,{children:[" / ",Ns(le)]}):null]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",Ns(I),"%)"]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600,backgroundColor:Oe>ie?"#f0fdf4":"transparent"},children:pe>0?a.jsxs("div",{children:[a.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[Ns(Oe),!E&&pe>0?a.jsxs(a.Fragment,{children:[" / ",Ns(pe)]}):null]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",Ns(ke),"%)"]}),Ae>0&&a.jsxs("div",{style:{fontSize:11,color:"#16a34a",marginTop:2},children:["+",Ns(Ae)]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:700},children:H>0?a.jsxs("div",{style:{backgroundColor:ae<L?"#fff1f2":"transparent",padding:6,borderRadius:6},children:[a.jsxs("div",{style:{color:ae<L?"#ef4444":"#0f172a",fontSize:14,fontWeight:800},children:[Ns(ae),"%"]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:6},children:[Ns(O),!E&&H>0?a.jsxs(a.Fragment,{children:[" / ",Ns(H)]}):null]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),X.map(_e=>{var nt;const De=`co${_e}`,We=Q[De];if(!We)return a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",color:"#94a3b8"},children:""},_e);const Ct=We.max?We.value/We.max*100:0,_t=Ct<L,Xe=(nt=y[q.id])==null?void 0:nt[De];return a.jsxs("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:_t?"#fef2f2":"#f0fdf4"},children:[a.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:6},children:[a.jsxs("div",{children:[Ns(We.value)," (",Ns(Ct),"%)"]}),E?null:Array.isArray(We.breakdown)&&a.jsx("div",{style:{marginTop:6,fontSize:11,color:"#94a3b8"},children:We.breakdown.map(Ne=>a.jsxs("div",{style:{display:"inline-block",marginRight:8},children:[Zxe(ti(r),String(Ne.key||"")),": ",Ns(Ne.mark)," / ",Ns(Ne.max)," =",Ns(Ne.contrib)]},Ne.key))})]}),_t?a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:11,color:"#dc2626",fontWeight:600,marginBottom:4},children:"CQI ATTAINED"}),a.jsx("input",{type:"number",value:Xe??"",onChange:Ne=>K(q.id,De,Ne.target.value),placeholder:"Enter CQI",className:"obe-input",style:{width:90,padding:"4px 8px",fontSize:13,textAlign:"center"}}),v[`${q.id}_${De}`]&&a.jsx("div",{style:{color:"#dc2626",fontSize:11,marginTop:6},children:v[`${q.id}_${De}`]})]}):a.jsx("div",{style:{fontSize:12,color:"#16a34a",fontWeight:600},children:" NO CQI"})]},_e)})]},q.id)})})]})]}),c.length===0&&a.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8"},children:"No students found in this section"})]})}function Vz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=Vz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function bi(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=Vz(e))&&(n&&(n+=" "),n+=t);return n}var i1e=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function wC(e){if(typeof e!="string")return!1;var t=i1e;return t.includes(e)}var a1e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],s1e=new Set(a1e);function Gz(e){return typeof e!="string"?!1:s1e.has(e)}function Kz(e){return typeof e=="string"&&e.startsWith("data-")}function sl(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Gz(r)||Kz(r))&&(t[r]=e[r]);return t}function gh(e){if(e==null)return null;if(x.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return sl(t)}return typeof e=="object"&&!Array.isArray(e)?sl(e):null}function $o(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Gz(r)||Kz(r)||wC(r))&&(t[r]=e[r]);return t}function o1e(e){return e==null?null:x.isValidElement(e)?$o(e.props):typeof e=="object"&&!Array.isArray(e)?$o(e):null}var l1e=["children","width","height","viewBox","className","style","title","desc"];function lA(){return lA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lA.apply(null,arguments)}function c1e(e,t){if(e==null)return{};var r,n,i=u1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function u1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var SC=x.forwardRef((e,t)=>{var{children:r,width:n,height:i,viewBox:s,className:o,style:l,title:c,desc:u}=e,d=c1e(e,l1e),f=s||{width:n,height:i,x:0,y:0},h=bi("recharts-surface",o);return x.createElement("svg",lA({},$o(d),{className:h,width:n,height:i,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),x.createElement("title",null,c),x.createElement("desc",null,u),r)}),d1e=["children","className"];function cA(){return cA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cA.apply(null,arguments)}function f1e(e,t){if(e==null)return{};var r,n,i=h1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function h1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ka=x.forwardRef((e,t)=>{var{children:r,className:n}=e,i=f1e(e,d1e),s=bi("recharts-layer",n);return x.createElement("g",cA({className:s},$o(i),{ref:t}),r)}),Yz=x.createContext(null),p1e=()=>x.useContext(Yz);function ia(e){return function(){return e}}const Xz=Math.cos,tw=Math.sin,_u=Math.sqrt,rw=Math.PI,IS=2*rw,uA=Math.PI,dA=2*uA,Dh=1e-6,m1e=dA-Dh;function Qz(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function g1e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Qz;const r=10**t;return function(n){this._+=n[0];for(let i=1,s=n.length;i<s;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class x1e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Qz:g1e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,s,o){this._append`C${+t},${+r},${+n},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(t,r,n,i,s){if(t=+t,r=+r,n=+n,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-t,u=i-r,d=o-t,f=l-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>Dh)if(!(Math.abs(f*c-u*d)>Dh)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-o,m=i-l,g=c*c+u*u,y=p*p+m*m,b=Math.sqrt(g),v=Math.sqrt(h),w=s*Math.tan((uA-Math.acos((g+h-y)/(2*b*v)))/2),S=w/v,k=w/b;Math.abs(S-1)>Dh&&this._append`L${t+S*d},${r+S*f}`,this._append`A${s},${s},0,0,${+(f*p>d*m)},${this._x1=t+k*c},${this._y1=r+k*u}`}}arc(t,r,n,i,s,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),c=n*Math.sin(i),u=t+l,d=r+c,f=1^o,h=o?i-s:s-i;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Dh||Math.abs(this._y1-d)>Dh)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%dA+dA),h>m1e?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>Dh&&this._append`A${n},${n},0,${+(h>=uA)},${f},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function _C(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new x1e(t)}function kC(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Jz(e){this._context=e}Jz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function DS(e){return new Jz(e)}function Zz(e){return e[0]}function eW(e){return e[1]}function tW(e,t){var r=ia(!0),n=null,i=DS,s=null,o=_C(l);e=typeof e=="function"?e:e===void 0?Zz:ia(e),t=typeof t=="function"?t:t===void 0?eW:ia(t);function l(c){var u,d=(c=kC(c)).length,f,h=!1,p;for(n==null&&(s=i(p=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+e(f,u,c),+t(f,u,c));if(p)return s=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:ia(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:ia(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:ia(!!c),l):r},l.curve=function(c){return arguments.length?(i=c,n!=null&&(s=i(n)),l):i},l.context=function(c){return arguments.length?(c==null?n=s=null:s=i(n=c),l):n},l}function tv(e,t,r){var n=null,i=ia(!0),s=null,o=DS,l=null,c=_C(u);e=typeof e=="function"?e:e===void 0?Zz:ia(+e),t=typeof t=="function"?t:ia(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?eW:ia(+r);function u(f){var h,p,m,g=(f=kC(f)).length,y,b=!1,v,w=new Array(g),S=new Array(g);for(s==null&&(l=o(v=c())),h=0;h<=g;++h){if(!(h<g&&i(y=f[h],h,f))===b)if(b=!b)p=h,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=h-1;m>=p;--m)l.point(w[m],S[m]);l.lineEnd(),l.areaEnd()}b&&(w[h]=+e(y,h,f),S[h]=+t(y,h,f),l.point(n?+n(y,h,f):w[h],r?+r(y,h,f):S[h]))}if(v)return l=null,v+""||null}function d(){return tW().defined(i).curve(o).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:ia(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:ia(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:ia(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:ia(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:ia(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:ia(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:ia(!!f),u):i},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class rW{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function y1e(e){return new rW(e,!0)}function b1e(e){return new rW(e,!1)}const jC={draw(e,t){const r=_u(t/rw);e.moveTo(r,0),e.arc(0,0,r,0,IS)}},v1e={draw(e,t){const r=_u(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},nW=_u(1/3),w1e=nW*2,S1e={draw(e,t){const r=_u(t/w1e),n=r*nW;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},_1e={draw(e,t){const r=_u(t),n=-r/2;e.rect(n,n,r,r)}},k1e=.8908130915292852,iW=tw(rw/10)/tw(7*rw/10),j1e=tw(IS/10)*iW,A1e=-Xz(IS/10)*iW,N1e={draw(e,t){const r=_u(t*k1e),n=j1e*r,i=A1e*r;e.moveTo(0,-r),e.lineTo(n,i);for(let s=1;s<5;++s){const o=IS*s/5,l=Xz(o),c=tw(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*i,c*n+l*i)}e.closePath()}},zk=_u(3),C1e={draw(e,t){const r=-_u(t/(zk*3));e.moveTo(0,r*2),e.lineTo(-zk*r,-r),e.lineTo(zk*r,-r),e.closePath()}},vc=-.5,wc=_u(3)/2,fA=1/_u(12),E1e=(fA/2+1)*3,T1e={draw(e,t){const r=_u(t/E1e),n=r/2,i=r*fA,s=n,o=r*fA+r,l=-s,c=o;e.moveTo(n,i),e.lineTo(s,o),e.lineTo(l,c),e.lineTo(vc*n-wc*i,wc*n+vc*i),e.lineTo(vc*s-wc*o,wc*s+vc*o),e.lineTo(vc*l-wc*c,wc*l+vc*c),e.lineTo(vc*n+wc*i,vc*i-wc*n),e.lineTo(vc*s+wc*o,vc*o-wc*s),e.lineTo(vc*l+wc*c,vc*c-wc*l),e.closePath()}};function P1e(e,t){let r=null,n=_C(i);e=typeof e=="function"?e:ia(e||jC),t=typeof t=="function"?t:ia(t===void 0?64:+t);function i(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:ia(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:ia(+s),i):t},i.context=function(s){return arguments.length?(r=s??null,i):r},i}function nw(){}function iw(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function aW(e){this._context=e}aW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:iw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:iw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function O1e(e){return new aW(e)}function sW(e){this._context=e}sW.prototype={areaStart:nw,areaEnd:nw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:iw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function M1e(e){return new sW(e)}function oW(e){this._context=e}oW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:iw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function L1e(e){return new oW(e)}function lW(e){this._context=e}lW.prototype={areaStart:nw,areaEnd:nw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function R1e(e){return new lW(e)}function zM(e){return e<0?-1:1}function WM(e,t,r){var n=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(n||i<0&&-0),o=(r-e._y1)/(i||n<0&&-0),l=(s*i+o*n)/(n+i);return(zM(s)+zM(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function qM(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Wk(e,t,r){var n=e._x0,i=e._y0,s=e._x1,o=e._y1,l=(s-n)/3;e._context.bezierCurveTo(n+l,i+l*t,s-l,o-l*r,s,o)}function aw(e){this._context=e}aw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Wk(this,this._t0,qM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Wk(this,qM(this,r=WM(this,e,t)),r);break;default:Wk(this,this._t0,r=WM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function cW(e){this._context=new uW(e)}(cW.prototype=Object.create(aw.prototype)).point=function(e,t){aw.prototype.point.call(this,t,e)};function uW(e){this._context=e}uW.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,s){this._context.bezierCurveTo(t,e,n,r,s,i)}};function B1e(e){return new aw(e)}function F1e(e){return new cW(e)}function dW(e){this._context=e}dW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=HM(e),i=HM(t),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],i[0][s],n[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function HM(e){var t,r=e.length-1,n,i=new Array(r),s=new Array(r),o=new Array(r);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,s[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/s[t-1],s[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/s[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function I1e(e){return new dW(e)}function $S(e,t){this._context=e,this._t=t}$S.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function D1e(e){return new $S(e,.5)}function $1e(e){return new $S(e,0)}function U1e(e){return new $S(e,1)}function T0(e,t){if((o=e.length)>1)for(var r=1,n,i,s=e[t[0]],o,l=s.length;r<o;++r)for(i=s,s=e[t[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function hA(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function z1e(e,t){return e[t]}function W1e(e){const t=[];return t.key=e,t}function q1e(){var e=ia([]),t=hA,r=T0,n=z1e;function i(s){var o=Array.from(e.apply(this,arguments),W1e),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=kC(t(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return i.keys=function(s){return arguments.length?(e=typeof s=="function"?s:ia(Array.from(s)),i):e},i.value=function(s){return arguments.length?(n=typeof s=="function"?s:ia(+s),i):n},i.order=function(s){return arguments.length?(t=s==null?hA:typeof s=="function"?s:ia(Array.from(s)),i):t},i.offset=function(s){return arguments.length?(r=s??T0,i):r},i}function H1e(e,t){if((n=e.length)>0){for(var r,n,i=0,s=e[0].length,o;i<s;++i){for(o=r=0;r<n;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<n;++r)e[r][i][1]/=o}T0(e,t)}}function V1e(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,s=n.length;r<s;++r){for(var o=0,l=0;o<i;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}T0(e,t)}}function G1e(e,t){if(!(!((o=e.length)>0)||!((s=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],f=d[n][1]||0,h=d[n-1][1]||0,p=(f-h)/2,m=0;m<l;++m){var g=e[t[m]],y=g[n][1]||0,b=g[n-1][1]||0;p+=y-b}c+=f,u+=p*f}i[n-1][1]+=i[n-1][0]=r,c&&(r-=u/c)}i[n-1][1]+=i[n-1][0]=r,T0(e,t)}}var US={},fW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(fW);var AC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(AC);var zS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(zS);var WS={},hW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(hW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hW,r=zS;function n(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=t.toString(i);const s=[],o=i.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(i.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=i[l];u?f==="\\"&&l+1<o?(l++,c+=i[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}e.toPath=n})(WS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fW,r=AC,n=zS,i=WS;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,i.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=s})(US);var K1e=US.get;const P0=af(K1e);var Y1e=4;function Kf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y1e,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function za(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((i,s,o)=>{var l=r[o-1];return typeof l=="string"?i+l+s:l!==void 0?i+Kf(l)+s:i+s},"")}var Gs=e=>e===0?0:e>0?1:-1,id=e=>typeof e=="number"&&e!=+e,O0=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,En=e=>(typeof e=="number"||e instanceof Number)&&!id(e),Uc=e=>En(e)||typeof e=="string",X1e=0,j1=e=>{var t=++X1e;return"".concat(e||"").concat(t)},Fo=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!En(t)&&typeof t!="string")return n;var s;if(O0(t)){if(r==null)return n;var o=t.indexOf("%");s=r*parseFloat(t.slice(0,o))/100}else s=+t;return id(s)&&(s=n),i&&r!=null&&s>r&&(s=r),s},pW=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Vi(e,t,r){return En(e)&&En(t)?Kf(e+r*(t-e)):t}function mW(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):P0(n,t))===r)}var Q1e=e=>{for(var t=e.length,r=0,n=0,i=0,s=0,o=1/0,l=-1/0,c=0,u=0,d=0;d<t;d++){var f,h;c=((f=e[d])===null||f===void 0?void 0:f.cx)||0,u=((h=e[d])===null||h===void 0?void 0:h.cy)||0,r+=c,n+=u,i+=c*u,s+=c*c,o=Math.min(o,c),l=Math.max(l,c)}var p=t*s!==r*r?(t*i-r*n)/(t*s-r*r):0;return{xmin:o,xmax:l,a:p,b:(n-p*r)/t}},Gi=e=>e===null||typeof e>"u",py=e=>Gi(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function vl(e){return e!=null}function np(){}var J1e=["type","size","sizeType"];function pA(){return pA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pA.apply(null,arguments)}function VM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function GM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VM(Object(r),!0).forEach(function(n){Z1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Z1e(e,t,r){return(t=eye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eye(e){var t=tye(e,"string");return typeof t=="symbol"?t:t+""}function tye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rye(e,t){if(e==null)return{};var r,n,i=nye(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function nye(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var gW={symbolCircle:jC,symbolCross:v1e,symbolDiamond:S1e,symbolSquare:_1e,symbolStar:N1e,symbolTriangle:C1e,symbolWye:T1e},iye=Math.PI/180,aye=e=>{var t="symbol".concat(py(e));return gW[t]||jC},sye=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*iye;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},oye=(e,t)=>{gW["symbol".concat(py(e))]=t},qS=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,i=rye(e,J1e),s=GM(GM({},i),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var h=aye(o),p=P1e().type(h).size(sye(r,n,o)),m=p();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=$o(s);return En(u)&&En(d)&&En(r)?x.createElement("path",pA({},f,{className:bi("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};qS.registerSymbol=oye;var xW=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,NC=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(x.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{wC(i)&&(n[i]=s=>r[i](r,s))}),n},lye=(e,t,r)=>n=>(e(t,r,n),null),dg=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(i=>{var s=e[i];wC(i)&&typeof s=="function"&&(n||(n={}),n[i]=lye(s,t,r))}),n},cye=e=>Array.isArray(e)&&e.length>0;function KM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KM(Object(r),!0).forEach(function(n){dye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dye(e,t,r){return(t=fye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fye(e){var t=hye(e,"string");return typeof t=="symbol"?t:t+""}function hye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ja(e,t){var r=uye({},e),n=t,i=Object.keys(t),s=i.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function sw(){return sw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sw.apply(null,arguments)}function YM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YM(Object(r),!0).forEach(function(n){mye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mye(e,t,r){return(t=gye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gye(e){var t=xye(e,"string");return typeof t=="symbol"?t:t+""}function xye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ac=32,yye={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function bye(e){var{data:t,iconType:r,inactiveColor:n}=e,i=Ac/2,s=Ac/6,o=Ac/3,l=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline"){var u;return x.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=t.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:i,x2:Ac,y2:i,className:"recharts-legend-icon"})}if(c==="line")return x.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(Ac,"M").concat(2*o,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(c==="rect")return x.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Ac/8,"h").concat(Ac,"v").concat(Ac*3/4,"h").concat(-Ac,"z"),className:"recharts-legend-icon"});if(x.isValidElement(t.legendIcon)){var d=pye({},t);return delete d.legendIcon,x.cloneElement(t.legendIcon,d)}return x.createElement(qS,{fill:l,cx:i,cy:i,size:Ac,sizeType:"diameter",type:c})}function vye(e){var{payload:t,iconSize:r,layout:n,formatter:i,inactiveColor:s,iconType:o}=e,l={x:0,y:0,width:Ac,height:Ac},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,f)=>{var h=d.formatter||i,p=bi({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,g=h?h(d.value,d,f):d.value;return x.createElement("li",sw({className:p,style:c,key:"legend-item-".concat(f)},dg(e,d,f)),x.createElement(SC,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(g," legend icon")},x.createElement(bye,{data:d,iconType:o,inactiveColor:s})),x.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},g))})}var wye=e=>{var t=ja(e,yye),{payload:r,layout:n,align:i}=t;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?i:"left"};return x.createElement("ul",{className:"recharts-default-legend",style:s},x.createElement(vye,sw({},t,{payload:r})))},yW={},bW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const i=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o,s,r);i.has(l)||i.set(l,o)}return Array.from(i.values())}e.uniqBy=t})(bW);var vW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...i){return r.apply(this,i.slice(0,n))}}e.ary=t})(vW);var CC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(CC);var wW={},HS={},SW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(SW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SW;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(HS);var _W={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(_W);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=HS,r=_W;function n(i){return r.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=n})(wW);var kW={},jW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=US;function r(n){return function(i){return t.get(i,n)}}e.property=r})(jW);var AW={},EC={},NW={},TC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(TC);var PC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(PC);var OC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(OC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TC,r=PC,n=OC;function i(d,f,h){return typeof h!="function"?i(d,f,()=>{}):s(d,f,function p(m,g,y,b,v,w){const S=h(m,g,y,b,v,w);return S!==void 0?!!S:s(m,g,p,w)},new Map)}function s(d,f,h,p){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,h,p);case"function":return Object.keys(f).length>0?s(d,{...f},h,p):n.isEqualsSameValueZero(d,f);default:return t.isObject(d)?typeof f=="string"?f==="":!0:n.isEqualsSameValueZero(d,f)}}function o(d,f,h,p){if(f==null)return!0;if(Array.isArray(f))return c(d,f,h,p);if(f instanceof Map)return l(d,f,h,p);if(f instanceof Set)return u(d,f,h,p);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(p!=null&&p.has(f))return p.get(f)===d;p==null||p.set(f,d);try{for(let g=0;g<m.length;g++){const y=m[g];if(!r.isPrimitive(d)&&!(y in d)||f[y]===void 0&&d[y]!==void 0||f[y]===null&&d[y]!==null||!h(d[y],f[y],y,d,f,p))return!1}return!0}finally{p==null||p.delete(f)}}function l(d,f,h,p){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,g]of f.entries()){const y=d.get(m);if(h(y,g,m,d,f,p)===!1)return!1}return!0}function c(d,f,h,p){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let g=0;g<f.length;g++){const y=f[g];let b=!1;for(let v=0;v<d.length;v++){if(m.has(v))continue;const w=d[v];let S=!1;if(h(w,y,g,d,f,p)&&(S=!0),S){m.add(v),b=!0;break}}if(!b)return!1}return!0}function u(d,f,h,p){return f.size===0?!0:d instanceof Set?c([...d],[...f],h,p):!1}e.isMatchWith=i,e.isSetMatch=u})(NW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NW;function r(n,i){return t.isMatchWith(n,i,()=>{})}e.isMatch=r})(EC);var CW={},MC={},EW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(EW);var VS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(VS);var LC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",h="[object ArrayBuffer]",p="[object Object]",m="[object Error]",g="[object DataView]",y="[object Uint8Array]",b="[object Uint8ClampedArray]",v="[object Uint16Array]",w="[object Uint32Array]",S="[object BigUint64Array]",k="[object Int8Array]",j="[object Int16Array]",A="[object Int32Array]",L="[object BigInt64Array]",P="[object Float32Array]",B="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=h,e.arrayTag=d,e.bigInt64ArrayTag=L,e.bigUint64ArrayTag=S,e.booleanTag=i,e.dataViewTag=g,e.dateTag=l,e.errorTag=m,e.float32ArrayTag=P,e.float64ArrayTag=B,e.functionTag=f,e.int16ArrayTag=j,e.int32ArrayTag=A,e.int8ArrayTag=k,e.mapTag=c,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=v,e.uint32ArrayTag=w,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=b})(LC);var TW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(TW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EW,r=VS,n=LC,i=PC,s=TW;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,h,p=new Map,m=void 0){const g=m==null?void 0:m(d,f,h,p);if(g!==void 0)return g;if(i.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const y=new Array(d.length);p.set(d,y);for(let b=0;b<d.length;b++)y[b]=l(d[b],b,h,p,m);return Object.hasOwn(d,"index")&&(y.index=d.index),Object.hasOwn(d,"input")&&(y.input=d.input),y}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const y=new RegExp(d.source,d.flags);return y.lastIndex=d.lastIndex,y}if(d instanceof Map){const y=new Map;p.set(d,y);for(const[b,v]of d)y.set(b,l(v,b,h,p,m));return y}if(d instanceof Set){const y=new Set;p.set(d,y);for(const b of d)y.add(l(b,void 0,h,p,m));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const y=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,y);for(let b=0;b<d.length;b++)y[b]=l(d[b],b,h,p,m);return y}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const y=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,y),c(y,d,h,p,m),y}if(typeof File<"u"&&d instanceof File){const y=new File([d],d.name,{type:d.type});return p.set(d,y),c(y,d,h,p,m),y}if(typeof Blob<"u"&&d instanceof Blob){const y=new Blob([d],{type:d.type});return p.set(d,y),c(y,d,h,p,m),y}if(d instanceof Error){const y=new d.constructor;return p.set(d,y),y.message=d.message,y.name=d.name,y.stack=d.stack,y.cause=d.cause,c(y,d,h,p,m),y}if(d instanceof Boolean){const y=new Boolean(d.valueOf());return p.set(d,y),c(y,d,h,p,m),y}if(d instanceof Number){const y=new Number(d.valueOf());return p.set(d,y),c(y,d,h,p,m),y}if(d instanceof String){const y=new String(d.valueOf());return p.set(d,y),c(y,d,h,p,m),y}if(typeof d=="object"&&u(d)){const y=Object.create(Object.getPrototypeOf(d));return p.set(d,y),c(y,d,h,p,m),y}return d}function c(d,f,h=d,p,m){const g=[...Object.keys(f),...t.getSymbols(f)];for(let y=0;y<g.length;y++){const b=g[y],v=Object.getOwnPropertyDescriptor(d,b);(v==null||v.writable)&&(d[b]=l(f[b],b,h,p,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(MC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MC;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(CW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EC,r=CW;function n(i){return i=r.cloneDeep(i),s=>t.isMatch(s,i)}e.matches=n})(AW);var PW={},OW={},MW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MC,r=VS,n=LC;function i(s,o){return t.cloneDeepWith(s,(l,c,u,d)=>{const f=o==null?void 0:o(l,c,u,d);if(f!==void 0)return f;if(typeof s=="object"){if(r.getTag(s)===n.objectTag&&typeof s.constructor!="function"){const h={};return d.set(s,h),t.copyProperties(h,s,u,d),h}switch(Object.prototype.toString.call(s)){case n.numberTag:case n.stringTag:case n.booleanTag:{const h=new s.constructor(s==null?void 0:s.valueOf());return t.copyProperties(h,s),h}case n.argumentsTag:{const h={};return t.copyProperties(h,s),h.length=s.length,h[Symbol.iterator]=s[Symbol.iterator],h}default:return}}})}e.cloneDeepWith=i})(MW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=MW;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(OW);var LW={},RC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(RC);var RW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VS;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(RW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=AC,r=RC,n=RW,i=WS;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=i.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=s})(LW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EC,r=zS,n=OW,i=US,s=LW;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=i.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=o})(PW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CC,r=jW,n=AW,i=PW;function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=s})(kW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bW,r=vW,n=CC,i=wW,s=kW;function o(l,c=n.identity){return i.isArrayLikeObject(l)?t.uniqBy(Array.from(l),r.ary(s.iteratee(c),1)):[]}e.uniqBy=o})(yW);var Sye=yW.uniqBy;const XM=af(Sye);function BW(e,t,r){return t===!0?XM(e,r):typeof t=="function"?XM(e,t):e}var FW={exports:{}},IW={},DW={exports:{}},$W={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $m=x;function _ye(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kye=typeof Object.is=="function"?Object.is:_ye,jye=$m.useState,Aye=$m.useEffect,Nye=$m.useLayoutEffect,Cye=$m.useDebugValue;function Eye(e,t){var r=t(),n=jye({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return Nye(function(){i.value=r,i.getSnapshot=t,qk(i)&&s({inst:i})},[e,r,t]),Aye(function(){return qk(i)&&s({inst:i}),e(function(){qk(i)&&s({inst:i})})},[e]),Cye(r),r}function qk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!kye(e,r)}catch{return!0}}function Tye(e,t){return t()}var Pye=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Tye:Eye;$W.useSyncExternalStore=$m.useSyncExternalStore!==void 0?$m.useSyncExternalStore:Pye;DW.exports=$W;var Oye=DW.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GS=x,Mye=Oye;function Lye(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Rye=typeof Object.is=="function"?Object.is:Lye,Bye=Mye.useSyncExternalStore,Fye=GS.useRef,Iye=GS.useEffect,Dye=GS.useMemo,$ye=GS.useDebugValue;IW.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=Fye(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=Dye(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),i!==void 0&&o.hasValue){var m=o.value;if(i(m,p))return f=m}return f=p}if(m=f,Rye(d,p))return m;var g=n(p);return i!==void 0&&i(m,g)?(d=p,m):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,i]);var l=Bye(e,s[0],s[1]);return Iye(function(){o.hasValue=!0,o.value=l},[l]),$ye(l),l};FW.exports=IW;var Uye=FW.exports,BC=x.createContext(null),zye=e=>e,Yi=()=>{var e=x.useContext(BC);return e?e.store.dispatch:zye},Jv=()=>{},Wye=()=>Jv,qye=(e,t)=>e===t;function wn(e){var t=x.useContext(BC),r=x.useMemo(()=>t?n=>{if(n!=null)return e(n)}:Jv,[t,e]);return Uye.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Wye,t?t.store.getState:Jv,t?t.store.getState:Jv,r,qye)}function Hye(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Vye(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Gye(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var QM=e=>Array.isArray(e)?e:[e];function Kye(e){const t=Array.isArray(e[0])?e[0]:e;return Gye(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Yye(e,t){const r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var Xye=class{constructor(e){this.value=e}deref(){return this.value}},Qye=typeof WeakRef<"u"?WeakRef:Xye,Jye=0,JM=1;function rv(){return{s:Jye,v:void 0,o:null,p:null}}function UW(e,t={}){let r=rv();const{resultEqualityCheck:n}=t;let i,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let h=0,p=c;h<p;h++){const m=arguments[h];if(typeof m=="function"||typeof m=="object"&&m!==null){let g=l.o;g===null&&(l.o=g=new WeakMap);const y=g.get(m);y===void 0?(l=rv(),g.set(m,l)):l=y}else{let g=l.p;g===null&&(l.p=g=new Map);const y=g.get(m);y===void 0?(l=rv(),g.set(m,l)):l=y}}const u=l;let d;if(l.s===JM)d=l.v;else if(d=e.apply(null,arguments),s++,n){const h=((f=i==null?void 0:i.deref)==null?void 0:f.call(i))??i;h!=null&&n(h,d)&&(d=h,s!==0&&s--),i=typeof d=="object"&&d!==null||typeof d=="function"?new Qye(d):d}return u.s=JM,u.v=d,d}return o.clearCache=()=>{r=rv(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function Zye(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let s=0,o=0,l,c={},u=i.pop();typeof u=="object"&&(c=u,u=i.pop()),Hye(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:h=[],argsMemoize:p=UW,argsMemoizeOptions:m=[]}=d,g=QM(h),y=QM(m),b=Kye(i),v=f(function(){return s++,u.apply(null,arguments)},...g),w=p(function(){o++;const k=Yye(b,arguments);return l=v.apply(null,k),l},...y);return Object.assign(w,{resultFunc:u,memoizedResultFunc:v,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var Jt=Zye(UW),ebe=Object.assign((e,t=Jt)=>{Vye(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(s=>e[s]);return t(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>ebe}),zW={},WW={},qW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,s)=>{if(n!==i){const o=t(n),l=t(i);if(o===l&&o===0){if(n<i)return s==="desc"?1:-1;if(n>i)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};e.compareValues=r})(qW);var HW={},FC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(FC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FC,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=i})(HW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qW,r=HW,n=WS;function i(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(p=>String(p));const u=(p,m)=>{let g=p;for(let y=0;y<m.length&&g!=null;++y)g=g[m[y]];return g},d=(p,m)=>m==null||p==null?m:typeof p=="object"&&"key"in p?Object.hasOwn(m,p.key)?m[p.key]:u(m,p.path):typeof p=="function"?p(m):Array.isArray(p)?u(m,p):typeof m=="object"?m[p]:m,f=o.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return s.map(p=>({original:p,criteria:f.map(m=>d(m,p))})).slice().sort((p,m)=>{for(let g=0;g<f.length;g++){const y=t.compareValues(p.criteria[g],m.criteria[g],l[g]);if(y!==0)return y}return 0}).map(p=>p.original)}e.orderBy=i})(WW);var VW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const i=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):i.push(d)}};return o(r,0),i}e.flatten=t})(VW);var IC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RC,r=HS,n=TC,i=OC;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?i.isEqualsSameValueZero(c[l],o):!1}e.isIterateeCall=s})(IC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WW,r=VW,n=IC;function i(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,r.flatten(o),["asc"])}e.sortBy=i})(zW);var tbe=zW.sortBy;const KS=af(tbe);var GW=e=>e.legend.settings,rbe=e=>e.legend.size,nbe=e=>e.legend.payload,ibe=Jt([nbe,GW],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?KS(n,r):n});function abe(){return wn(ibe)}var nv=1;function KW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=x.useState({height:0,left:0,top:0,width:0}),n=x.useCallback(i=>{if(i!=null){var s=i.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>nv||Math.abs(o.left-t.left)>nv||Math.abs(o.top-t.top)>nv||Math.abs(o.width-t.width)>nv)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function oo(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var sbe=typeof Symbol=="function"&&Symbol.observable||"@@observable",ZM=sbe,Hk=()=>Math.random().toString(36).substring(7).split("").join("."),obe={INIT:`@@redux/INIT${Hk()}`,REPLACE:`@@redux/REPLACE${Hk()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Hk()}`},ow=obe;function DC(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function YW(e,t,r){if(typeof e!="function")throw new Error(oo(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(oo(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(oo(1));return r(YW)(e,t)}let n=e,i=t,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((y,b)=>{o.set(b,y)}))}function d(){if(c)throw new Error(oo(3));return i}function f(y){if(typeof y!="function")throw new Error(oo(4));if(c)throw new Error(oo(5));let b=!0;u();const v=l++;return o.set(v,y),function(){if(b){if(c)throw new Error(oo(6));b=!1,u(),o.delete(v),s=null}}}function h(y){if(!DC(y))throw new Error(oo(7));if(typeof y.type>"u")throw new Error(oo(8));if(typeof y.type!="string")throw new Error(oo(17));if(c)throw new Error(oo(9));try{c=!0,i=n(i,y)}finally{c=!1}return(s=o).forEach(v=>{v()}),y}function p(y){if(typeof y!="function")throw new Error(oo(10));n=y,h({type:ow.REPLACE})}function m(){const y=f;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(oo(11));function v(){const S=b;S.next&&S.next(d())}return v(),{unsubscribe:y(v)}},[ZM](){return this}}}return h({type:ow.INIT}),{dispatch:h,subscribe:f,getState:d,replaceReducer:p,[ZM]:m}}function lbe(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:ow.INIT})>"u")throw new Error(oo(12));if(typeof r(void 0,{type:ow.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(oo(13))})}function XW(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let i;try{lbe(r)}catch(s){i=s}return function(o={},l){if(i)throw i;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],h=r[f],p=o[f],m=h(p,l);if(typeof m>"u")throw l&&l.type,new Error(oo(14));u[f]=m,c=c||m!==p}return c=c||n.length!==Object.keys(o).length,c?u:o}}function lw(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function cbe(...e){return t=>(r,n)=>{const i=t(r,n);let s=()=>{throw new Error(oo(15))};const o={getState:i.getState,dispatch:(c,...u)=>s(c,...u)},l=e.map(c=>c(o));return s=lw(...l)(i.dispatch),{...i,dispatch:s}}}function QW(e){return DC(e)&&"type"in e&&typeof e.type=="string"}var JW=Symbol.for("immer-nothing"),eL=Symbol.for("immer-draftable"),ol=Symbol.for("immer-state");function au(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Jl=Object,Um=Jl.getPrototypeOf,cw="constructor",YS="prototype",mA="configurable",uw="enumerable",Zv="writable",A1="value",Xd=e=>!!e&&!!e[ol];function yu(e){var t;return e?ZW(e)||QS(e)||!!e[eL]||!!((t=e[cw])!=null&&t[eL])||JS(e)||ZS(e):!1}var ube=Jl[YS][cw].toString(),tL=new WeakMap;function ZW(e){if(!e||!$C(e))return!1;const t=Um(e);if(t===null||t===Jl[YS])return!0;const r=Jl.hasOwnProperty.call(t,cw)&&t[cw];if(r===Object)return!0;if(!Dp(r))return!1;let n=tL.get(r);return n===void 0&&(n=Function.toString.call(r),tL.set(r,n)),n===ube}function XS(e,t,r=!0){my(e)===0?(r?Reflect.ownKeys(e):Jl.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function my(e){const t=e[ol];return t?t.type_:QS(e)?1:JS(e)?2:ZS(e)?3:0}var rL=(e,t,r=my(e))=>r===2?e.has(t):Jl[YS].hasOwnProperty.call(e,t),gA=(e,t,r=my(e))=>r===2?e.get(t):e[t],dw=(e,t,r,n=my(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function dbe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var QS=Array.isArray,JS=e=>e instanceof Map,ZS=e=>e instanceof Set,$C=e=>typeof e=="object",Dp=e=>typeof e=="function",Vk=e=>typeof e=="boolean";function fbe(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var Td=e=>e.copy_||e.base_,UC=e=>e.modified_?e.copy_:e.base_;function xA(e,t){if(JS(e))return new Map(e);if(ZS(e))return new Set(e);if(QS(e))return Array[YS].slice.call(e);const r=ZW(e);if(t===!0||t==="class_only"&&!r){const n=Jl.getOwnPropertyDescriptors(e);delete n[ol];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],l=n[o];l[Zv]===!1&&(l[Zv]=!0,l[mA]=!0),(l.get||l.set)&&(n[o]={[mA]:!0,[Zv]:!0,[uw]:l[uw],[A1]:e[o]})}return Jl.create(Um(e),n)}else{const n=Um(e);if(n!==null&&r)return{...e};const i=Jl.create(n);return Jl.assign(i,e)}}function zC(e,t=!1){return e_(e)||Xd(e)||!yu(e)||(my(e)>1&&Jl.defineProperties(e,{set:iv,add:iv,clear:iv,delete:iv}),Jl.freeze(e),t&&XS(e,(r,n)=>{zC(n,!0)},!1)),e}function hbe(){au(2)}var iv={[A1]:hbe};function e_(e){return e===null||!$C(e)?!0:Jl.isFrozen(e)}var fw="MapSet",yA="Patches",nL="ArrayMethods",eq={};function M0(e){const t=eq[e];return t||au(0,e),t}var iL=e=>!!eq[e],N1,tq=()=>N1,pbe=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:iL(fw)?M0(fw):void 0,arrayMethodsPlugin_:iL(nL)?M0(nL):void 0});function aL(e,t){t&&(e.patchPlugin_=M0(yA),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function bA(e){vA(e),e.drafts_.forEach(mbe),e.drafts_=null}function vA(e){e===N1&&(N1=e.parent_)}var sL=e=>N1=pbe(N1,e);function mbe(e){const t=e[ol];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function oL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[ol].modified_&&(bA(t),au(4)),yu(e)&&(e=lL(t,e));const{patchPlugin_:i}=t;i&&i.generateReplacementPatches_(r[ol].base_,e,t)}else e=lL(t,r);return gbe(t,e,!0),bA(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==JW?e:void 0}function lL(e,t){if(e_(t))return t;const r=t[ol];if(!r)return hw(t,e.handledSet_,e);if(!t_(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);iq(r,e)}return r.copy_}function gbe(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&zC(t,r)}function rq(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var t_=(e,t)=>e.scope_===t,xbe=[];function nq(e,t,r,n){const i=Td(e),s=e.type_;if(n!==void 0&&gA(i,n,s)===t){dw(i,n,r,s);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;XS(i,(c,u)=>{if(Xd(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=e.draftLocations_.get(t)??xbe;for(const l of o)dw(i,l,r,s)}function ybe(e,t,r){e.callbacks_.push(function(i){var l;const s=t;if(!s||!t_(s,i))return;(l=i.mapSetPlugin_)==null||l.fixSetContents(s);const o=UC(s);nq(e,s.draft_??s,o,r),iq(s,i)})}function iq(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:i}=t;if(i){const s=i.getPath(e);s&&i.generatePatches_(e,s,t)}rq(e)}}function bbe(e,t,r){const{scope_:n}=e;if(Xd(r)){const i=r[ol];t_(i,n)&&i.callbacks_.push(function(){e2(e);const o=UC(i);nq(e,r,o,t)})}else yu(r)&&e.callbacks_.push(function(){const s=Td(e);e.type_===3?s.has(r)&&hw(r,n.handledSet_,n):gA(s,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&hw(gA(e.copy_,t,e.type_),n.handledSet_,n)})}function hw(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Xd(e)||t.has(e)||!yu(e)||e_(e)||(t.add(e),XS(e,(n,i)=>{if(Xd(i)){const s=i[ol];if(t_(s,r)){const o=UC(s);dw(e,n,o,e.type_),rq(s)}}else yu(i)&&hw(i,t,r)})),e}function vbe(e,t){const r=QS(e),n={type_:r?1:0,scope_:t?t.scope_:tq(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,s=pw;r&&(i=[n],s=C1);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return n.draft_=l,n.revoke_=o,[l,n]}var pw={get(e,t){if(t===ol)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const i=Td(e);if(!rL(i,t,e.type_))return wbe(e,i,t);const s=i[t];if(e.finalized_||!yu(s)||n&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&fbe(t))return s;if(s===Gk(e.base_,t)){e2(e);const o=e.type_===1?+t:t,l=SA(e.scope_,s,e,o);return e.copy_[o]=l}return s},has(e,t){return t in Td(e)},ownKeys(e){return Reflect.ownKeys(Td(e))},set(e,t,r){const n=aq(Td(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Gk(Td(e),t),s=i==null?void 0:i[ol];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(dbe(r,i)&&(r!==void 0||rL(e.base_,t,e.type_)))return!0;e2(e),wA(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),bbe(e,t,r)),!0},deleteProperty(e,t){return e2(e),Gk(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),wA(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Td(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Zv]:!0,[mA]:e.type_!==1||t!=="length",[uw]:n[uw],[A1]:r[t]}},defineProperty(){au(11)},getPrototypeOf(e){return Um(e.base_)},setPrototypeOf(){au(12)}},C1={};for(let e in pw){let t=pw[e];C1[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}C1.deleteProperty=function(e,t){return C1.set.call(this,e,t,void 0)};C1.set=function(e,t,r){return pw.set.call(this,e[0],t,r,e[0])};function Gk(e,t){const r=e[ol];return(r?Td(r):e)[t]}function wbe(e,t,r){var i;const n=aq(t,r);return n?A1 in n?n[A1]:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function aq(e,t){if(!(t in e))return;let r=Um(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Um(r)}}function wA(e){e.modified_||(e.modified_=!0,e.parent_&&wA(e.parent_))}function e2(e){e.copy_||(e.assigned_=new Map,e.copy_=xA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Sbe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,i)=>{if(Dp(r)&&!Dp(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}Dp(n)||au(6),i!==void 0&&!Dp(i)&&au(7);let s;if(yu(r)){const o=sL(this),l=SA(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?bA(o):vA(o)}return aL(o,i),oL(s,o)}else if(!r||!$C(r)){if(s=n(r),s===void 0&&(s=r),s===JW&&(s=void 0),this.autoFreeze_&&zC(s,!0),i){const o=[],l=[];M0(yA).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),i(o,l)}return s}else au(1,r)},this.produceWithPatches=(r,n)=>{if(Dp(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let i,s;return[this.produce(r,n,(l,c)=>{i=l,s=c}),i,s]},Vk(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Vk(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Vk(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){yu(t)||au(8),Xd(t)&&(t=pu(t));const r=sL(this),n=SA(r,t,void 0);return n[ol].isManual_=!0,vA(r),n}finishDraft(t,r){const n=t&&t[ol];(!n||!n.isManual_)&&au(9);const{scope_:i}=n;return aL(i,r),oL(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(r=r.slice(n+1));const i=M0(yA).applyPatches_;return Xd(t)?i(t,r):this.produce(t,s=>i(s,r))}};function SA(e,t,r,n){const[i,s]=JS(t)?M0(fw).proxyMap_(t,r):ZS(t)?M0(fw).proxySet_(t,r):vbe(t,r);return((r==null?void 0:r.scope_)??tq()).drafts_.push(i),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?ybe(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),i}function pu(e){return Xd(e)||au(10,e),sq(e)}function sq(e){if(!yu(e)||e_(e))return e;const t=e[ol];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=xA(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=xA(e,!0);return XS(r,(i,s)=>{dw(r,i,sq(s))},n),t&&(t.finalized_=!1),r}var _be=new Sbe,oq=_be.produce;function lq(e){return({dispatch:r,getState:n})=>i=>s=>typeof s=="function"?s(r,n,e):i(s)}var kbe=lq(),jbe=lq,Abe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?lw:lw.apply(null,arguments)};function zc(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(ec(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>QW(n)&&n.type===e,r}var cq=class mx extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,mx.prototype)}static get[Symbol.species](){return mx}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new mx(...t[0].concat(this)):new mx(...t.concat(this))}};function cL(e){return yu(e)?oq(e,()=>{}):e}function av(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Nbe(e){return typeof e=="boolean"}var Cbe=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:s=!0}=t??{};let o=new cq;return r&&(Nbe(r)?o.push(kbe):o.push(jbe(r.extraArgument))),o},uq="RTK_autoBatch",wa=()=>e=>({payload:e,meta:{[uq]:!0}}),uL=e=>t=>{setTimeout(t,e)},dq=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let i=!0,s=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:uL(10):e.type==="callback"?e.queueNotification:uL(e.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>i&&d(),h=n.subscribe(f);return l.add(d),()=>{h(),l.delete(d)}},dispatch(d){var f;try{return i=!((f=d==null?void 0:d.meta)!=null&&f[uq]),s=!i,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{i=!0}}})},Ebe=e=>function(r){const{autoBatch:n=!0}=r??{};let i=new cq(e);return n&&i.push(dq(typeof n=="object"?n:void 0)),i};function Tbe(e){const t=Cbe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(DC(r))l=XW(r);else throw new Error(ec(1));let c;typeof n=="function"?c=n(t):c=t();let u=lw;i&&(u=Abe({trace:!1,...typeof i=="object"&&i}));const d=cbe(...c),f=Ebe(d);let h=typeof o=="function"?o(f):f();const p=u(...h);return YW(l,s,p)}function fq(e){const t={},r=[];let n;const i={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(ec(28));if(l in t)throw new Error(ec(29));return t[l]=o,i},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),i},addMatcher(s,o){return r.push({matcher:s,reducer:o}),i},addDefaultCase(s){return n=s,i}};return e(i),[t,r,n]}function Pbe(e){return typeof e=="function"}function Obe(e,t){let[r,n,i]=fq(t),s;if(Pbe(e))s=()=>cL(e());else{const l=cL(e);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[i]),u.reduce((d,f)=>{if(f)if(Xd(d)){const p=f(d,c);return p===void 0?d:p}else{if(yu(d))return oq(d,h=>f(h,c));{const h=f(d,c);if(h===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return d},l)}return o.getInitialState=s,o}var Mbe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Lbe=(e=21)=>{let t="",r=e;for(;r--;)t+=Mbe[Math.random()*64|0];return t},Rbe=Symbol.for("rtk-slice-createasyncthunk");function Bbe(e,t){return`${e}/${t}`}function Fbe({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[Rbe];return function(i){const{name:s,reducerPath:o=s}=i;if(!s)throw new Error(ec(11));const l=(typeof i.reducers=="function"?i.reducers(Dbe()):i.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,k){const j=typeof S=="string"?S:S.type;if(!j)throw new Error(ec(12));if(j in u.sliceCaseReducersByType)throw new Error(ec(13));return u.sliceCaseReducersByType[j]=k,d},addMatcher(S,k){return u.sliceMatchers.push({matcher:S,reducer:k}),d},exposeAction(S,k){return u.actionCreators[S]=k,d},exposeCaseReducer(S,k){return u.sliceCaseReducersByName[S]=k,d}};c.forEach(S=>{const k=l[S],j={reducerName:S,type:Bbe(s,S),createNotation:typeof i.reducers=="function"};Ube(k)?Wbe(j,k,d,t):$be(j,k,d)});function f(){const[S={},k=[],j=void 0]=typeof i.extraReducers=="function"?fq(i.extraReducers):[i.extraReducers],A={...S,...u.sliceCaseReducersByType};return Obe(i.initialState,L=>{for(let P in A)L.addCase(P,A[P]);for(let P of u.sliceMatchers)L.addMatcher(P.matcher,P.reducer);for(let P of k)L.addMatcher(P.matcher,P.reducer);j&&L.addDefaultCase(j)})}const h=S=>S,p=new Map,m=new WeakMap;let g;function y(S,k){return g||(g=f()),g(S,k)}function b(){return g||(g=f()),g.getInitialState()}function v(S,k=!1){function j(L){let P=L[S];return typeof P>"u"&&k&&(P=av(m,j,b)),P}function A(L=h){const P=av(p,k,()=>new WeakMap);return av(P,L,()=>{const B={};for(const[E,T]of Object.entries(i.selectors??{}))B[E]=Ibe(T,L,()=>av(m,L,b),k);return B})}return{reducerPath:S,getSelectors:A,get selectors(){return A(j)},selectSlice:j}}const w={name:s,reducer:y,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...v(o),injectInto(S,{reducerPath:k,...j}={}){const A=k??o;return S.inject({reducerPath:A,reducer:y},j),{...w,...v(A,!0)}}};return w}}function Ibe(e,t,r,n){function i(s,...o){let l=t(s);return typeof l>"u"&&n&&(l=r()),e(l,...o)}return i.unwrapped=e,i}var Pl=Fbe();function Dbe(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function $be({type:e,reducerName:t,createNotation:r},n,i){let s,o;if("reducer"in n){if(r&&!zbe(n))throw new Error(ec(17));s=n.reducer,o=n.prepare}else s=n;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?zc(e,o):zc(e))}function Ube(e){return e._reducerDefinitionType==="asyncThunk"}function zbe(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Wbe({type:e,reducerName:t},r,n,i){if(!i)throw new Error(ec(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=i(e,s,d);n.exposeAction(t,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:o||sv,pending:l||sv,rejected:c||sv,settled:u||sv})}function sv(){}var qbe="task",hq="listener",pq="completed",WC="cancelled",Hbe=`task-${WC}`,Vbe=`task-${pq}`,_A=`${hq}-${WC}`,Gbe=`${hq}-${pq}`,r_=class{constructor(e){Ti(this,"name","TaskAbortError");Ti(this,"message");this.code=e,this.message=`${qbe} ${WC} (reason: ${e})`}},qC=(e,t)=>{if(typeof e!="function")throw new TypeError(ec(32))},mw=()=>{},mq=(e,t=mw)=>(e.catch(t),e),gq=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),c0=e=>{if(e.aborted)throw new r_(e.reason)};function xq(e,t){let r=mw;return new Promise((n,i)=>{const s=()=>i(new r_(e.reason));if(e.aborted){s();return}r=gq(e,s),t.finally(()=>r()).then(n,i)}).finally(()=>{r=mw})}var Kbe=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof r_?"cancelled":"rejected",error:r}}finally{t==null||t()}},gw=e=>t=>mq(xq(e,t).then(r=>(c0(e),r))),yq=e=>{const t=gw(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Sm}=Object,dL={},n_="listenerMiddleware",Ybe=(e,t)=>{const r=n=>gq(e,()=>n.abort(e.reason));return(n,i)=>{qC(n);const s=new AbortController;r(s);const o=Kbe(async()=>{c0(e),c0(s.signal);const l=await n({pause:gw(s.signal),delay:yq(s.signal),signal:s.signal});return c0(s.signal),l},()=>s.abort(Vbe));return i!=null&&i.autoJoin&&t.push(o.catch(mw)),{result:gw(e)(o),cancel(){s.abort(Hbe)}}}},Xbe=(e,t)=>{const r=async(n,i)=>{c0(t);let s=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,h)=>{h.unsubscribe(),c([f,h.getState(),h.getOriginalState()])}});s=()=>{d(),u()}})];i!=null&&l.push(new Promise(c=>setTimeout(c,i,null)));try{const c=await xq(t,Promise.race(l));return c0(t),c}finally{s()}};return(n,i)=>mq(r(n,i))},bq=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:s}=e;if(t)i=zc(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(ec(21));return qC(s),{predicate:i,type:t,effect:s}},vq=Sm(e=>{const{type:t,predicate:r,effect:n}=bq(e);return{id:Lbe(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ec(22))}}},{withTypes:()=>vq}),fL=(e,t)=>{const{type:r,effect:n,predicate:i}=bq(t);return Array.from(e.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===i)&&s.effect===n)},kA=e=>{e.pending.forEach(t=>{t.abort(_A)})},Qbe=(e,t)=>()=>{for(const r of t.keys())kA(r);e.clear()},hL=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},wq=Sm(zc(`${n_}/add`),{withTypes:()=>wq}),Jbe=zc(`${n_}/removeAll`),Sq=Sm(zc(`${n_}/remove`),{withTypes:()=>Sq}),Zbe=(...e)=>{console.error(`${n_}/error`,...e)},gy=(e={})=>{const t=new Map,r=new Map,n=p=>{const m=r.get(p)??0;r.set(p,m+1)},i=p=>{const m=r.get(p)??1;m===1?r.delete(p):r.set(p,m-1)},{extra:s,onError:o=Zbe}=e;qC(o);const l=p=>(p.unsubscribe=()=>t.delete(p.id),t.set(p.id,p),m=>{p.unsubscribe(),m!=null&&m.cancelActive&&kA(p)}),c=p=>{const m=fL(t,p)??vq(p);return l(m)};Sm(c,{withTypes:()=>c});const u=p=>{const m=fL(t,p);return m&&(m.unsubscribe(),p.cancelActive&&kA(m)),!!m};Sm(u,{withTypes:()=>u});const d=async(p,m,g,y)=>{const b=new AbortController,v=Xbe(c,b.signal),w=[];try{p.pending.add(b),n(p),await Promise.resolve(p.effect(m,Sm({},g,{getOriginalState:y,condition:(S,k)=>v(S,k).then(Boolean),take:v,delay:yq(b.signal),pause:gw(b.signal),extra:s,signal:b.signal,fork:Ybe(b.signal,w),unsubscribe:p.unsubscribe,subscribe:()=>{t.set(p.id,p)},cancelActiveListeners:()=>{p.pending.forEach((S,k,j)=>{S!==b&&(S.abort(_A),j.delete(S))})},cancel:()=>{b.abort(_A),p.pending.delete(b)},throwIfCancelled:()=>{c0(b.signal)}})))}catch(S){S instanceof r_||hL(o,S,{raisedBy:"effect"})}finally{await Promise.all(w),b.abort(Gbe),i(p),p.pending.delete(b)}},f=Qbe(t,r);return{middleware:p=>m=>g=>{if(!QW(g))return m(g);if(wq.match(g))return c(g.payload);if(Jbe.match(g)){f();return}if(Sq.match(g))return u(g.payload);let y=p.getState();const b=()=>{if(y===dL)throw new Error(ec(23));return y};let v;try{if(v=m(g),t.size>0){const w=p.getState(),S=Array.from(t.values());for(const k of S){let j=!1;try{j=k.predicate(g,w,y)}catch(A){j=!1,hL(o,A,{raisedBy:"predicate"})}j&&d(k,g,p,b)}}}finally{y=dL}return v},startListening:c,stopListening:u,clearListeners:f}};function ec(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var eve={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},_q=Pl({name:"chartLayout",initialState:eve,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,i,s;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:tve,setLayout:rve,setChartSize:nve,setScale:ive}=_q.actions,ave=_q.reducer;function kq(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function di(e){return Number.isFinite(e)}function ad(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function pL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pL(Object(r),!0).forEach(function(n){sve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sve(e,t,r){return(t=ove(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ove(e){var t=lve(e,"string");return typeof t=="symbol"?t:t+""}function lve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ai(e,t,r){return Gi(e)||Gi(t)?r:Uc(t)?P0(e,t,r):typeof t=="function"?t(e):r}var cve=(e,t,r)=>{if(t&&r){var{width:n,height:i}=r,{align:s,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&En(e[s]))return rm(rm({},e),{},{[s]:e[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&En(e[o]))return rm(rm({},e),{},{[o]:e[o]+(i||0)})}return e},ff=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",jq=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var i,s,o=e.map(l=>(l.coordinate===t&&(i=!0),l.coordinate===r&&(s=!0),l.coordinate));return i||o.push(t),s||o.push(r),o},Aq=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:i,range:s,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:h,axisType:p}=e;if(!o)return null;var m=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,g=i==="category"&&o.bandwidth?o.bandwidth()/m:0;if(g=p==="angleAxis"&&s&&s.length>=2?Gs(s[0]-s[1])*2*g:g,f||h){var y=(f||h||[]).map((b,v)=>{var w=n?n.indexOf(b):b,S=o.map(w);return di(S)?{coordinate:S+g,value:b,offset:g,index:v}:null}).filter(vl);return y}return c&&u?u.map((b,v)=>{var w=o.map(b);return di(w)?{coordinate:w+g,value:b,index:v,offset:g}:null}).filter(vl):o.ticks&&d!=null?o.ticks(d).map((b,v)=>{var w=o.map(b);return di(w)?{coordinate:w+g,value:b,index:v,offset:g}:null}).filter(vl):o.domain().map((b,v)=>{var w=o.map(b);return di(w)?{coordinate:w+g,value:n?n[b]:b,index:v,offset:g}:null}).filter(vl)},uve=(e,t)=>{if(!t||t.length!==2||!En(t[0])||!En(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!En(e[0])||e[0]<r)&&(i[0]=r),(!En(e[1])||e[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},dve=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var s=0,o=0,l=0;l<r;++l){var c=e[l],u=c==null?void 0:c[i];if(u!=null){var d=u[1],f=u[0],h=id(d)?f:d;h>=0?(u[0]=s,s+=h,u[1]=s):(u[0]=o,o+=h,u[1]=o)}}}},fve=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var s=0,o=0;o<r;++o){var l=e[o],c=l==null?void 0:l[i];if(c!=null){var u=id(c[1])?c[0]:c[1];u>=0?(c[0]=s,s+=u,c[1]=s):(c[0]=0,c[1]=0)}}}},hve={sign:dve,expand:H1e,none:T0,silhouette:V1e,wiggle:G1e,positive:fve},pve=(e,t,r)=>{var n,i=(n=hve[r])!==null&&n!==void 0?n:T0,s=q1e().keys(t).value((l,c)=>Number(Ai(l,c,0))).order(hA).offset(i),o=s(e);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=Ai(e[d],t[c],0);Array.isArray(f)&&f.length===2&&En(f[0])&&En(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function mve(e){return e==null?void 0:String(e)}function xw(e){var{axis:t,ticks:r,bandSize:n,entry:i,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Gi(i[t.dataKey])){var l=mW(r,"value",i[t.dataKey]);if(l)return l.coordinate+n/2}return r!=null&&r[s]?r[s].coordinate+n/2:null}var c=Ai(i,Gi(o)?t.dataKey:o),u=t.scale.map(c);return En(u)?u:null}var mL=e=>{var{axis:t,ticks:r,offset:n,bandSize:i,entry:s,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var l=Ai(s,t.dataKey,t.scale.domain()[o]);if(Gi(l))return null;var c=t.scale.map(l);return En(c)?c-i/2+n:null},gve=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},xve=e=>{var t=e.flat(2).filter(En);return[Math.min(...t),Math.max(...t)]},yve=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],bve=(e,t,r)=>{if(e!=null)return yve(Object.keys(e).reduce((n,i)=>{var s=e[i];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=kq(u,t,r),f=xve(d);return!di(f[0])||!di(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},gL=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,xL=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,zm=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var i=KS(t,d=>d.coordinate),s=1/0,o=1,l=i.length;o<l;o++){var c=i[o],u=i[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function yL(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:i,name:s}=e;return rm(rm({},t),{},{dataKey:r,payload:n,value:i,name:s})}function Ah(e,t){if(e)return String(e);if(typeof t=="string")return t}var vve=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},wve=(e,t)=>t==="centric"?e.angle:e.radius,hf=e=>e.layout.width,pf=e=>e.layout.height,Sve=e=>e.layout.scale,Nq=e=>e.layout.margin,i_=Jt(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),a_=Jt(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),Cq="data-recharts-item-index",HC="data-recharts-item-id",xy=60;function bL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ov(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bL(Object(r),!0).forEach(function(n){_ve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _ve(e,t,r){return(t=kve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kve(e){var t=jve(e,"string");return typeof t=="symbol"?t:t+""}function jve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ave=e=>e.brush.height;function Nve(e){var t=a_(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:xy;return r+i}return r},0)}function Cve(e){var t=a_(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:xy;return r+i}return r},0)}function Eve(e){var t=i_(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Tve(e){var t=i_(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Ms=Jt([hf,pf,Nq,Ave,Nve,Cve,Eve,Tve,GW,rbe],(e,t,r,n,i,s,o,l,c,u)=>{var d={left:(r.left||0)+i,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},h=ov(ov({},f),d),p=h.bottom;h.bottom+=n,h=cve(h,c,u);var m=e-h.left-h.right,g=t-h.top-h.bottom;return ov(ov({brushBottom:p},h),{},{width:Math.max(m,0),height:Math.max(g,0)})}),Pve=Jt(Ms,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),VC=Jt(hf,pf,(e,t)=>({x:0,y:0,width:e,height:t})),Ove=x.createContext(null),Ls=()=>x.useContext(Ove)!=null,s_=e=>e.brush,o_=Jt([s_,Ms,Nq],(e,t,r)=>({height:e.height,x:En(e.x)?e.x:t.left,y:En(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:En(e.width)?e.width:t.width})),Eq={},Tq={},Pq={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:i,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),g()};let h=null;const p=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,f()},n)},m=()=>{h!==null&&(clearTimeout(h),h=null)},g=()=>{m(),o=void 0,l=null},y=()=>{d()},b=function(...v){if(i!=null&&i.aborted)return;o=this,l=v;const w=h==null;p(),c&&w&&d()};return b.schedule=p,b.cancel=g,b.flush=y,i==null||i.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(Pq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pq;function r(n,i=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const h=t.debounce(function(...g){d=n.apply(this,g),f=null},i,{edges:u}),p=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,g),f=Date.now(),h.cancel(),h.schedule(),d):(h.apply(this,g),d)},m=()=>(h.flush(),d);return p.cancel=h.cancel,p.flush=m,p}e.debounce=r})(Tq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Tq;function r(n,i=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return t.debounce(n,i,{leading:o,maxWait:i,trailing:l})}e.throttle=r})(Eq);var Mve=Eq.throttle;const Lve=af(Mve);var yw=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>i[o++]))}},Qu={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},Oq=(e,t,r)=>{var{width:n=Qu.width,height:i=Qu.height,aspect:s,maxHeight:o}=r,l=O0(n)?e:Number(n),c=O0(i)?t:Number(i);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},Rve={width:0,height:0,overflow:"visible"},Bve={width:0,overflowX:"visible"},Fve={height:0,overflowY:"visible"},Ive={},Dve=e=>{var{width:t,height:r}=e,n=O0(t),i=O0(r);return n&&i?Rve:n?Bve:i?Fve:Ive};function $ve(e){var{width:t,height:r,aspect:n}=e,i=t,s=r;return i===void 0&&s===void 0?(i=Qu.width,s=Qu.height):i===void 0?i=n&&n>0?void 0:Qu.width:s===void 0&&(s=n&&n>0?void 0:Qu.height),{width:i,height:s}}function jA(){return jA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jA.apply(null,arguments)}function vL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vL(Object(r),!0).forEach(function(n){Uve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uve(e,t,r){return(t=zve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zve(e){var t=Wve(e,"string");return typeof t=="symbol"?t:t+""}function Wve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Mq=x.createContext(Qu.initialDimension);function qve(e){return ad(e.width)&&ad(e.height)}function Lq(e){var{children:t,width:r,height:n}=e,i=x.useMemo(()=>({width:r,height:n}),[r,n]);return qve(i)?x.createElement(Mq.Provider,{value:i},t):null}var GC=()=>x.useContext(Mq),Hve=x.forwardRef((e,t)=>{var{aspect:r,initialDimension:n=Qu.initialDimension,width:i,height:s,minWidth:o=Qu.minWidth,minHeight:l,maxHeight:c,children:u,debounce:d=Qu.debounce,id:f,className:h,onResize:p,style:m={}}=e,g=x.useRef(null),y=x.useRef();y.current=p,x.useImperativeHandle(t,()=>g.current);var[b,v]=x.useState({containerWidth:n.width,containerHeight:n.height}),w=x.useCallback((L,P)=>{v(B=>{var E=Math.round(L),T=Math.round(P);return B.containerWidth===E&&B.containerHeight===T?B:{containerWidth:E,containerHeight:T}})},[]);x.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return np;var L=T=>{var F,W=T[0];if(W!=null){var{width:z,height:se}=W.contentRect;w(z,se),(F=y.current)===null||F===void 0||F.call(y,z,se)}};d>0&&(L=Lve(L,d,{trailing:!0,leading:!1}));var P=new ResizeObserver(L),{width:B,height:E}=g.current.getBoundingClientRect();return w(B,E),P.observe(g.current),()=>{P.disconnect()}},[w,d]);var{containerWidth:S,containerHeight:k}=b;yw(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:j,calculatedHeight:A}=Oq(S,k,{width:i,height:s,aspect:r,maxHeight:c});return yw(j!=null&&j>0||A!=null&&A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,j,A,i,s,o,l,r),x.createElement("div",{id:f?"".concat(f):void 0,className:bi("recharts-responsive-container",h),style:wL(wL({},m),{},{width:i,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:g},x.createElement("div",{style:Dve({width:i,height:s})},x.createElement(Lq,{width:j,height:A},u)))}),yy=x.forwardRef((e,t)=>{var r=GC();if(ad(r.width)&&ad(r.height))return e.children;var{width:n,height:i}=$ve({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:o}=Oq(void 0,void 0,{width:n,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return En(s)&&En(o)?x.createElement(Lq,{width:s,height:o},e.children):x.createElement(Hve,jA({},e,{width:n,height:i,ref:t}))});function KC(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var fg=()=>{var e,t=Ls(),r=wn(Pve),n=wn(o_),i=(e=wn(s_))===null||e===void 0?void 0:e.padding;return!t||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},Vve={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Rq=()=>{var e;return(e=wn(Ms))!==null&&e!==void 0?e:Vve},YC=()=>wn(hf),XC=()=>wn(pf),Gve=()=>wn(e=>e.layout.margin),Ci=e=>e.layout.layoutType,ip=()=>wn(Ci),Bq=()=>{var e=ip();if(e==="horizontal"||e==="vertical")return e},Fq=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},Kve=()=>{var e=ip();return e!==void 0},by=e=>{var t=Yi(),r=Ls(),{width:n,height:i}=e,s=GC(),o=n,l=i;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:i),x.useEffect(()=>{!r&&ad(o)&&ad(l)&&t(nve({width:o,height:l}))},[t,r,o,l]),null},Iq=Symbol.for("immer-nothing"),SL=Symbol.for("immer-draftable"),ac=Symbol.for("immer-state");function su(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var E1=Object.getPrototypeOf;function Wm(e){return!!e&&!!e[ac]}function L0(e){var t;return e?Dq(e)||Array.isArray(e)||!!e[SL]||!!((t=e.constructor)!=null&&t[SL])||vy(e)||c_(e):!1}var Yve=Object.prototype.constructor.toString(),_L=new WeakMap;function Dq(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=_L.get(r);return n===void 0&&(n=Function.toString.call(r),_L.set(r,n)),n===Yve}function bw(e,t,r=!0){l_(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function l_(e){const t=e[ac];return t?t.type_:Array.isArray(e)?1:vy(e)?2:c_(e)?3:0}function AA(e,t){return l_(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function $q(e,t,r){const n=l_(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Xve(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function vy(e){return e instanceof Map}function c_(e){return e instanceof Set}function $h(e){return e.copy_||e.base_}function NA(e,t){if(vy(e))return new Map(e);if(c_(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Dq(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[ac];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(E1(e),n)}else{const n=E1(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function QC(e,t=!1){return u_(e)||Wm(e)||!L0(e)||(l_(e)>1&&Object.defineProperties(e,{set:lv,add:lv,clear:lv,delete:lv}),Object.freeze(e),t&&Object.values(e).forEach(r=>QC(r,!0))),e}function Qve(){su(2)}var lv={value:Qve};function u_(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var Jve={};function R0(e){const t=Jve[e];return t||su(0,e),t}var T1;function Uq(){return T1}function Zve(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function kL(e,t){t&&(R0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function CA(e){EA(e),e.drafts_.forEach(e2e),e.drafts_=null}function EA(e){e===T1&&(T1=e.parent_)}function jL(e){return T1=Zve(T1,e)}function e2e(e){const t=e[ac];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function AL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[ac].modified_&&(CA(t),su(4)),L0(e)&&(e=vw(t,e),t.parent_||ww(t,e)),t.patches_&&R0("Patches").generateReplacementPatches_(r[ac].base_,e,t.patches_,t.inversePatches_)):e=vw(t,r,[]),CA(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Iq?e:void 0}function vw(e,t,r){if(u_(t))return t;const n=e.immer_.shouldUseStrictIteration(),i=t[ac];if(!i)return bw(t,(s,o)=>NL(e,i,t,s,o,r),n),t;if(i.scope_!==e)return t;if(!i.modified_)return ww(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,l=!1;i.type_===3&&(o=new Set(s),s.clear(),l=!0),bw(o,(c,u)=>NL(e,i,s,c,u,r,l),n),ww(e,s,!1),r&&e.patches_&&R0("Patches").generatePatches_(i,r,e.patches_,e.inversePatches_)}return i.copy_}function NL(e,t,r,n,i,s,o){if(i==null||typeof i!="object"&&!o)return;const l=u_(i);if(!(l&&!o)){if(Wm(i)){const c=s&&t&&t.type_!==3&&!AA(t.assigned_,n)?s.concat(n):void 0,u=vw(e,i,c);if($q(r,n,u),Wm(u))e.canAutoFreeze_=!1;else return}else o&&r.add(i);if(L0(i)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===i&&l)return;vw(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(vy(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&ww(e,i)}}}function ww(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&QC(t,r)}function t2e(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Uq(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=JC;r&&(i=[n],s=P1);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return n.draft_=l,n.revoke_=o,l}var JC={get(e,t){if(t===ac)return e;const r=$h(e);if(!AA(r,t))return r2e(e,r,t);const n=r[t];return e.finalized_||!L0(n)?n:n===Kk(e.base_,t)?(Yk(e),e.copy_[t]=PA(n,e)):n},has(e,t){return t in $h(e)},ownKeys(e){return Reflect.ownKeys($h(e))},set(e,t,r){const n=zq($h(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Kk($h(e),t),s=i==null?void 0:i[ac];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Xve(r,i)&&(r!==void 0||AA(e.base_,t)))return!0;Yk(e),TA(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Kk(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Yk(e),TA(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=$h(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){su(11)},getPrototypeOf(e){return E1(e.base_)},setPrototypeOf(){su(12)}},P1={};bw(JC,(e,t)=>{P1[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});P1.deleteProperty=function(e,t){return P1.set.call(this,e,t,void 0)};P1.set=function(e,t,r){return JC.set.call(this,e[0],t,r,e[0])};function Kk(e,t){const r=e[ac];return(r?$h(r):e)[t]}function r2e(e,t,r){var i;const n=zq(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function zq(e,t){if(!(t in e))return;let r=E1(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=E1(r)}}function TA(e){e.modified_||(e.modified_=!0,e.parent_&&TA(e.parent_))}function Yk(e){e.copy_||(e.copy_=NA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var n2e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&su(6),n!==void 0&&typeof n!="function"&&su(7);let i;if(L0(t)){const s=jL(this),o=PA(t,void 0);let l=!0;try{i=r(o),l=!1}finally{l?CA(s):EA(s)}return kL(s,n),AL(i,s)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===Iq&&(i=void 0),this.autoFreeze_&&QC(i,!0),n){const s=[],o=[];R0("Patches").generateReplacementPatches_(t,i,s,o),n(s,o)}return i}else su(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let n,i;return[this.produce(t,r,(o,l)=>{n=o,i=l}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){L0(e)||su(8),Wm(e)&&(e=i2e(e));const t=jL(this),r=PA(e,void 0);return r[ac].isManual_=!0,EA(t),r}finishDraft(e,t){const r=e&&e[ac];(!r||!r.isManual_)&&su(9);const{scope_:n}=r;return kL(n,t),AL(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=R0("Patches").applyPatches_;return Wm(e)?n(e,t):this.produce(e,i=>n(i,t))}};function PA(e,t){const r=vy(e)?R0("MapSet").proxyMap_(e,t):c_(e)?R0("MapSet").proxySet_(e,t):t2e(e,t);return(t?t.scope_:Uq()).drafts_.push(r),r}function i2e(e){return Wm(e)||su(10,e),Wq(e)}function Wq(e){if(!L0(e)||u_(e))return e;const t=e[ac];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=NA(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=NA(e,!0);return bw(r,(i,s)=>{$q(r,i,Wq(s))},n),t&&(t.finalized_=!1),r}var a2e=new n2e;a2e.produce;var s2e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},qq=Pl({name:"legend",initialState:s2e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:wa()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,i=pu(e).payload.indexOf(r);i>-1&&(e.payload[i]=n)},prepare:wa()},removeLegendPayload:{reducer(e,t){var r=pu(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:wa()}}}),{setLegendSize:CL,setLegendSettings:o2e,addLegendPayload:Hq,replaceLegendPayload:Vq,removeLegendPayload:Gq}=qq.actions,l2e=qq.reducer,c2e=["contextPayload"];function OA(){return OA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OA.apply(null,arguments)}function EL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EL(Object(r),!0).forEach(function(n){u2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function u2e(e,t,r){return(t=d2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d2e(e){var t=f2e(e,"string");return typeof t=="symbol"?t:t+""}function f2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h2e(e,t){if(e==null)return{};var r,n,i=p2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function p2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function m2e(e){return e.value}function g2e(e){var{contextPayload:t}=e,r=h2e(e,c2e),n=BW(t,e.payloadUniqBy,m2e),i=qm(qm({},r),{},{payload:n});return x.isValidElement(e.content)?x.cloneElement(e.content,i):typeof e.content=="function"?x.createElement(e.content,i):x.createElement(wye,i)}function x2e(e,t,r,n,i,s){var{layout:o,align:l,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((i||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),qm(qm({},u),d)}function y2e(e){var t=Yi();return x.useEffect(()=>{t(o2e(e))},[t,e]),null}function b2e(e){var t=Yi();return x.useEffect(()=>(t(CL(e)),()=>{t(CL({width:0,height:0}))}),[t,e]),null}function v2e(e,t,r,n){return e==="vertical"&&t!=null?{height:t}:e==="horizontal"?{width:r||n}:null}var w2e={align:"center",iconSize:14,inactiveColor:"#ccc",itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function ZC(e){var t=ja(e,w2e),r=abe(),n=p1e(),i=Gve(),{width:s,height:o,wrapperStyle:l,portal:c}=t,[u,d]=KW([r]),f=YC(),h=XC();if(f==null||h==null)return null;var p=f-((i==null?void 0:i.left)||0)-((i==null?void 0:i.right)||0),m=v2e(t.layout,o,s,p),g=c?l:qm(qm({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},x2e(l,t,i,f,h,u)),l),y=c??n;if(y==null||r==null)return null;var b=x.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:d},x.createElement(y2e,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!c&&x.createElement(b2e,{width:u.width,height:u.height}),x.createElement(g2e,OA({},t,m,{margin:i,chartWidth:f,chartHeight:h,contextPayload:r})));return Y1.createPortal(b,y)}ZC.displayName="Legend";function MA(){return MA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},MA.apply(null,arguments)}function TL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TL(Object(r),!0).forEach(function(n){S2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S2e(e,t,r){return(t=_2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _2e(e){var t=k2e(e,"string");return typeof t=="symbol"?t:t+""}function k2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j2e(e){return Array.isArray(e)&&Uc(e[0])&&Uc(e[1])?e.join(" ~ "):e}var Np={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},A2e=e=>{var{separator:t=Np.separator,contentStyle:r,itemStyle:n,labelStyle:i=Np.labelStyle,payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:h=Np.accessibilityLayer}=e,p=()=>{if(s&&s.length){var k={padding:0,margin:0},j=(l?KS(s,l):s).map((A,L)=>{if(A.type==="none")return null;var P=A.formatter||o||j2e,{value:B,name:E}=A,T=B,F=E;if(P){var W=P(B,E,A,L,s);if(Array.isArray(W))[T,F]=W;else if(W!=null)T=W;else return null}var z=Gg(Gg({},Np.itemStyle),{},{color:A.color||Np.itemStyle.color},n);return x.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(L),style:z},Uc(F)?x.createElement("span",{className:"recharts-tooltip-item-name"},F):null,Uc(F)?x.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,x.createElement("span",{className:"recharts-tooltip-item-value"},T),x.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return x.createElement("ul",{className:"recharts-tooltip-item-list",style:k},j)}return null},m=Gg(Gg({},Np.contentStyle),r),g=Gg({margin:0},i),y=!Gi(d),b=y?d:"",v=bi("recharts-default-tooltip",c),w=bi("recharts-tooltip-label",u);y&&f&&s!==void 0&&s!==null&&(b=f(d,s));var S=h?{role:"status","aria-live":"assertive"}:{};return x.createElement("div",MA({className:v,style:m},S),x.createElement("p",{className:w,style:g},x.isValidElement(b)?b:"".concat(b)),p())},Kg="recharts-tooltip-wrapper",N2e={visibility:"hidden"};function C2e(e){var{coordinate:t,translateX:r,translateY:n}=e;return bi(Kg,{["".concat(Kg,"-right")]:En(r)&&t&&En(t.x)&&r>=t.x,["".concat(Kg,"-left")]:En(r)&&t&&En(t.x)&&r<t.x,["".concat(Kg,"-bottom")]:En(n)&&t&&En(t.y)&&n>=t.y,["".concat(Kg,"-top")]:En(n)&&t&&En(t.y)&&n<t.y})}function PL(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offset:i,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(s&&En(s[n]))return s[n];var d=r[n]-l-(i>0?i:0),f=r[n]+i;if(t[n])return o[n]?d:f;var h=c[n];if(h==null)return 0;if(o[n]){var p=d,m=h;return p<m?Math.max(f,h):Math.max(d,h)}if(u==null)return 0;var g=f+l,y=h+u;return g>y?Math.max(d,h):Math.max(f,h)}function E2e(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function T2e(e){var{allowEscapeViewBox:t,coordinate:r,offsetTop:n,offsetLeft:i,position:s,reverseDirection:o,tooltipBox:l,useTranslate3d:c,viewBox:u}=e,d,f,h;return l.height>0&&l.width>0&&r?(f=PL({allowEscapeViewBox:t,coordinate:r,key:"x",offset:i,position:s,reverseDirection:o,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),h=PL({allowEscapeViewBox:t,coordinate:r,key:"y",offset:n,position:s,reverseDirection:o,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),d=E2e({translateX:f,translateY:h,useTranslate3d:c})):d=N2e,{cssProperties:d,cssClasses:C2e({translateX:f,translateY:h,coordinate:r})}}function OL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OL(Object(r),!0).forEach(function(n){LA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LA(e,t,r){return(t=P2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P2e(e){var t=O2e(e,"string");return typeof t=="symbol"?t:t+""}function O2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class M2e extends x.PureComponent{constructor(){super(...arguments),LA(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),LA(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,i,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:h,viewBox:p,wrapperStyle:m,lastBoundingBox:g,innerRef:y,hasPortalFromProps:b}=this.props,v=typeof u=="number"?u:u.x,w=typeof u=="number"?u:u.y,{cssClasses:S,cssProperties:k}=T2e({allowEscapeViewBox:r,coordinate:o,offsetLeft:v,offsetTop:w,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:h,viewBox:p}),j=b?{}:cv(cv({transition:c&&t?"transform ".concat(n,"ms ").concat(i):void 0},k),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),A=cv(cv({},j),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},m);return x.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:S,style:A,ref:y},s)}}var Kq=()=>{var e;return(e=wn(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function RA(){return RA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RA.apply(null,arguments)}function ML(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function LL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ML(Object(r),!0).forEach(function(n){L2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ML(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L2e(e,t,r){return(t=R2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R2e(e){var t=B2e(e,"string");return typeof t=="symbol"?t:t+""}function B2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RL={curveBasisClosed:M1e,curveBasisOpen:L1e,curveBasis:O1e,curveBumpX:y1e,curveBumpY:b1e,curveLinearClosed:R1e,curveLinear:DS,curveMonotoneX:B1e,curveMonotoneY:F1e,curveNatural:I1e,curveStep:D1e,curveStepAfter:U1e,curveStepBefore:$1e},Sw=e=>di(e.x)&&di(e.y),BL=e=>e.base!=null&&Sw(e.base)&&Sw(e),Yg=e=>e.x,Xg=e=>e.y,F2e=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(py(e));if((r==="curveMonotone"||r==="curveBump")&&t){var n=RL["".concat(r).concat(t==="vertical"?"Y":"X")];if(n)return n}return RL[r]||DS},FL={connectNulls:!1,type:"linear"},I2e=e=>{var{type:t=FL.type,points:r=[],baseLine:n,layout:i,connectNulls:s=FL.connectNulls}=e,o=F2e(t,i),l=s?r.filter(Sw):r;if(Array.isArray(n)){var c,u=r.map((m,g)=>LL(LL({},m),{},{base:n[g]}));i==="vertical"?c=tv().y(Xg).x1(Yg).x0(m=>m.base.x):c=tv().x(Yg).y1(Xg).y0(m=>m.base.y);var d=c.defined(BL).curve(o),f=s?u.filter(BL):u;return d(f)}var h;i==="vertical"&&En(n)?h=tv().y(Xg).x1(Yg).x0(n):En(n)?h=tv().x(Yg).y1(Xg).y0(n):h=tW().x(Yg).y(Xg);var p=h.defined(Sw).curve(o);return p(l)},d_=e=>{var{className:t,points:r,path:n,pathRef:i}=e,s=ip();if((!r||!r.length)&&!n)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||s,connectNulls:e.connectNulls},l=r&&r.length?I2e(o):n;return x.createElement("path",RA({},sl(e),NC(e),{className:bi("recharts-curve",t),d:l===null?void 0:l,ref:i}))},D2e=["x","y","top","left","width","height","className"];function BA(){return BA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BA.apply(null,arguments)}function IL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IL(Object(r),!0).forEach(function(n){U2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U2e(e,t,r){return(t=z2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z2e(e){var t=W2e(e,"string");return typeof t=="symbol"?t:t+""}function W2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q2e(e,t){if(e==null)return{};var r,n,i=H2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function H2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var V2e=(e,t,r,n,i,s)=>"M".concat(e,",").concat(i,"v").concat(n,"M").concat(s,",").concat(t,"h").concat(r),G2e=e=>{var{x:t=0,y:r=0,top:n=0,left:i=0,width:s=0,height:o=0,className:l}=e,c=q2e(e,D2e),u=$2e({x:t,y:r,top:n,left:i,width:s,height:o},c);return!En(t)||!En(r)||!En(s)||!En(o)||!En(n)||!En(i)?null:x.createElement("path",BA({},$o(u),{className:bi("recharts-cross",l),d:V2e(t,r,s,o,n,i)}))};function K2e(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function DL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $L(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DL(Object(r),!0).forEach(function(n){Y2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y2e(e,t,r){return(t=X2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X2e(e){var t=Q2e(e,"string");return typeof t=="symbol"?t:t+""}function Q2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J2e=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Yq=(e,t,r)=>e.map(n=>"".concat(J2e(n)," ").concat(t,"ms ").concat(r)).join(","),Z2e=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(i=>n.includes(i))),O1=(e,t)=>Object.keys(t).reduce((r,n)=>$L($L({},r),{},{[n]:e(n,t[n])}),{});function UL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Es(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?UL(Object(r),!0).forEach(function(n){ewe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):UL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ewe(e,t,r){return(t=twe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function twe(e){var t=rwe(e,"string");return typeof t=="symbol"?t:t+""}function rwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _w=(e,t,r)=>e+(t-e)*r,FA=e=>{var{from:t,to:r}=e;return t!==r},Xq=(e,t,r)=>{var n=O1((i,s)=>{if(FA(s)){var[o,l]=e(s.from,s.to,s.velocity);return Es(Es({},s),{},{from:o,velocity:l})}return s},t);return r<1?O1((i,s)=>FA(s)&&n[i]!=null?Es(Es({},s),{},{velocity:_w(s.velocity,n[i].velocity,r),from:_w(s.from,n[i].from,r)}):s,t):Xq(e,n,r-1)};function nwe(e,t,r,n,i,s){var o,l=n.reduce((h,p)=>Es(Es({},h),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>O1((h,p)=>p.from,l),u=()=>!Object.values(l).filter(FA).length,d=null,f=h=>{o||(o=h);var p=h-o,m=p/r.dt;l=Xq(r,l,m),i(Es(Es(Es({},e),t),c())),o=h,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var h;(h=d)===null||h===void 0||h()})}function iwe(e,t,r,n,i,s,o){var l=null,c=i.reduce((f,h)=>{var p=e[h],m=t[h];return p==null||m==null?f:Es(Es({},f),{},{[h]:[p,m]})},{}),u,d=f=>{u||(u=f);var h=(f-u)/n,p=O1((g,y)=>_w(...y,r(h)),c);if(s(Es(Es(Es({},e),t),p)),h<1)l=o.setTimeout(d);else{var m=O1((g,y)=>_w(...y,r(1)),c);s(Es(Es(Es({},e),t),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const awe=(e,t,r,n,i,s)=>{var o=Z2e(e,t);return r==null?()=>(i(Es(Es({},e),t)),()=>{}):r.isStepper===!0?nwe(e,t,r,o,i,s):iwe(e,t,r,n,o,i,s)};var kw=1e-4,Qq=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],Jq=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),zL=(e,t)=>r=>{var n=Qq(e,t);return Jq(n,r)},swe=(e,t)=>r=>{var n=Qq(e,t),i=[...n.map((s,o)=>s*o).slice(1),0];return Jq(i,r)},owe=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var i=n.map(s=>parseFloat(s));return[i[0],i[1],i[2],i[3]]},lwe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i=owe(r[0]);if(i)return i}}return r.length===4?r:[0,0,1,1]},cwe=(e,t,r,n)=>{var i=zL(e,r),s=zL(t,n),o=swe(e,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,h=0;h<8;++h){var p=i(f)-d,m=o(f);if(Math.abs(p-d)<kw||m<kw)return s(f);f=l(f-p/m)}return s(f)};return c.isStepper=!1,c},WL=function(){return cwe(...lwe(...arguments))},uwe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=t,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*i/1e3,h=c*i/1e3+o;return Math.abs(h-l)<kw&&Math.abs(f)<kw?[l,0]:[h,f]};return s.isStepper=!0,s.dt=i,s},dwe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return WL(e);case"spring":return uwe();default:if(e.split("(")[0]==="cubic-bezier")return WL(e)}return typeof e=="function"?e:null};function fwe(e){var t,r=()=>null,n=!1,i=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){i=e.setTimeout(s.bind(null,u),c);return}s(c),i=e.setTimeout(s.bind(null,u));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,i&&(i(),i=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class hwe{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,s=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(s))};return i=requestAnimationFrame(s),()=>{i!=null&&cancelAnimationFrame(i)}}}function pwe(){return fwe(new hwe)}var mwe=x.createContext(pwe);function gwe(e,t){var r=x.useContext(mwe);return x.useMemo(()=>t??r(e),[e,t,r])}var xwe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),f_={isSsr:xwe()},ywe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},qL={t:0},Xk={t:1};function hg(e){var t=ja(e,ywe),{isActive:r,canBegin:n,duration:i,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=r==="auto"?!f_.isSsr:r,f=gwe(t.animationId,t.animationManager),[h,p]=x.useState(d?qL:Xk),m=x.useRef(null);return x.useEffect(()=>{d||p(Xk)},[d]),x.useEffect(()=>{if(!d||!n)return np;var g=awe(qL,Xk,dwe(s),i,p,f.getTimeoutController()),y=()=>{m.current=g()};return f.start([c,o,y,i,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,i,s,o,c,l,f]),u(h.t)}function pg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=x.useRef(j1(t)),n=x.useRef(e);return n.current!==e&&(r.current=j1(t),n.current=e),r.current}var bwe=["radius"],vwe=["radius"],HL,VL,GL,KL,YL,XL,QL,JL,ZL,e7;function t7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function r7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t7(Object(r),!0).forEach(function(n){wwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wwe(e,t,r){return(t=Swe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Swe(e){var t=_we(e,"string");return typeof t=="symbol"?t:t+""}function _we(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jw(){return jw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jw.apply(null,arguments)}function n7(e,t){if(e==null)return{};var r,n,i=kwe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function kwe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Bu(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var i7=(e,t,r,n,i)=>{var s=Kf(r),o=Kf(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&Array.isArray(i)){for(var h=[0,0,0,0],p=0,m=4;p<m;p++){var g,y=(g=i[p])!==null&&g!==void 0?g:0;h[p]=y>l?l:y}f=za(HL||(HL=Bu(["M",",",""])),e,t+c*h[0]),h[0]>0&&(f+=za(VL||(VL=Bu(["A ",",",",0,0,",",",",",""])),h[0],h[0],d,e+u*h[0],t)),f+=za(GL||(GL=Bu(["L ",",",""])),e+r-u*h[1],t),h[1]>0&&(f+=za(KL||(KL=Bu(["A ",",",",0,0,",`,
        `,",",""])),h[1],h[1],d,e+r,t+c*h[1])),f+=za(YL||(YL=Bu(["L ",",",""])),e+r,t+n-c*h[2]),h[2]>0&&(f+=za(XL||(XL=Bu(["A ",",",",0,0,",`,
        `,",",""])),h[2],h[2],d,e+r-u*h[2],t+n)),f+=za(QL||(QL=Bu(["L ",",",""])),e+u*h[3],t+n),h[3]>0&&(f+=za(JL||(JL=Bu(["A ",",",",0,0,",`,
        `,",",""])),h[3],h[3],d,e,t+n-c*h[3])),f+="Z"}else if(l>0&&i===+i&&i>0){var b=Math.min(l,i);f=za(ZL||(ZL=Bu(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*b,b,b,d,e+u*b,t,e+r-u*b,t,b,b,d,e+r,t+c*b,e+r,t+n-c*b,b,b,d,e+r-u*b,t+n,e+u*b,t+n,b,b,d,e,t+n-c*b)}else f=za(e7||(e7=Bu(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return f},a7={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Zq=e=>{var t=ja(e,a7),r=x.useRef(null),[n,i]=x.useState(-1);x.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var de=r.current.getTotalLength();de&&i(de)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:h,animationBegin:p,isAnimationActive:m,isUpdateAnimationActive:g}=t,y=x.useRef(l),b=x.useRef(c),v=x.useRef(s),w=x.useRef(o),S=x.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),k=pg(S,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var j=bi("recharts-rectangle",d);if(!g){var A=$o(t),{radius:L}=A,P=n7(A,bwe);return x.createElement("path",jw({},P,{x:Kf(s),y:Kf(o),width:Kf(l),height:Kf(c),radius:typeof u=="number"?u:void 0,className:j,d:i7(s,o,l,c,u)}))}var B=y.current,E=b.current,T=v.current,F=w.current,W="0px ".concat(n===-1?1:n,"px"),z="".concat(n,"px 0px"),se=Yq(["strokeDasharray"],h,typeof f=="string"?f:a7.animationEasing);return x.createElement(hg,{animationId:k,key:k,canBegin:n>0,duration:h,easing:f,isActive:g,begin:p},de=>{var U=Vi(B,l,de),G=Vi(E,c,de),re=Vi(T,s,de),X=Vi(F,o,de);r.current&&(y.current=U,b.current=G,v.current=re,w.current=X);var C;m?de>0?C={transition:se,strokeDasharray:z}:C={strokeDasharray:W}:C={strokeDasharray:z};var K=$o(t),{radius:V}=K,R=n7(K,vwe);return x.createElement("path",jw({},R,{radius:typeof u=="number"?u:void 0,className:j,d:i7(re,X,U,G,u),ref:r,style:r7(r7({},C),t.style)}))})};function s7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function o7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s7(Object(r),!0).forEach(function(n){jwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jwe(e,t,r){return(t=Awe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Awe(e){var t=Nwe(e,"string");return typeof t=="symbol"?t:t+""}function Nwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aw=Math.PI/180,Cwe=e=>e*180/Math.PI,vs=(e,t,r,n)=>({x:e+Math.cos(-Aw*n)*r,y:t+Math.sin(-Aw*n)*r}),eH=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},Ewe=(e,t)=>{var{x:r,y:n}=e,{x:i,y:s}=t;return Math.sqrt((r-i)**2+(n-s)**2)},Twe=(e,t)=>{var{x:r,y:n}=e,{cx:i,cy:s}=t,o=Ewe({x:r,y:n},{x:i,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-i)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:Cwe(c),angleInRadian:c}},Pwe=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),i=Math.floor(r/360),s=Math.min(n,i);return{startAngle:t-s*360,endAngle:r-s*360}},Owe=(e,t)=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(i,s);return e+o*360},Mwe=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:i,angle:s}=Twe({x:r,y:n},t),{innerRadius:o,outerRadius:l}=t;if(i<o||i>l||i===0)return null;var{startAngle:c,endAngle:u}=Pwe(t),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?o7(o7({},t),{},{radius:i,angle:Owe(d,t)}):null};function tH(e){var{cx:t,cy:r,radius:n,startAngle:i,endAngle:s}=e,o=vs(t,r,n,i),l=vs(t,r,n,s);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:i,endAngle:s}}var l7,c7,u7,d7,f7,h7,p7;function IA(){return IA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},IA.apply(null,arguments)}function Yh(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Lwe=(e,t)=>{var r=Gs(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},uv=e=>{var{cx:t,cy:r,radius:n,angle:i,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,u=l*(o?1:-1)+n,d=Math.asin(l/u)/Aw,f=c?i:i+s*d,h=vs(t,r,u,f),p=vs(t,r,n,f),m=c?i-s*d:i,g=vs(t,r,u*Math.cos(d*Aw),m);return{center:h,circleTangency:p,lineTangency:g,theta:d}},rH=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:s,endAngle:o}=e,l=Lwe(s,o),c=s+l,u=vs(t,r,i,s),d=vs(t,r,i,c),f=za(l7||(l7=Yh(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,i,i,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var h=vs(t,r,n,s),p=vs(t,r,n,c);f+=za(c7||(c7=Yh(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),p.x,p.y,n,n,+(Math.abs(l)>180),+(s<=c),h.x,h.y)}else f+=za(u7||(u7=Yh(["L ",","," Z"])),t,r);return f},Rwe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=Gs(u-c),{circleTangency:f,lineTangency:h,theta:p}=uv({cx:t,cy:r,radius:i,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:g,theta:y}=uv({cx:t,cy:r,radius:i,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),b=l?Math.abs(c-u):Math.abs(c-u)-p-y;if(b<0)return o?za(d7||(d7=Yh(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),h.x,h.y,s,s,s*2,s,s,-s*2):rH({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:c,endAngle:u});var v=za(f7||(f7=Yh(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),h.x,h.y,s,s,+(d<0),f.x,f.y,i,i,+(b>180),+(d<0),m.x,m.y,s,s,+(d<0),g.x,g.y);if(n>0){var{circleTangency:w,lineTangency:S,theta:k}=uv({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:j,lineTangency:A,theta:L}=uv({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),P=l?Math.abs(c-u):Math.abs(c-u)-k-L;if(P<0&&s===0)return"".concat(v,"L").concat(t,",").concat(r,"Z");v+=za(h7||(h7=Yh(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),A.x,A.y,s,s,+(d<0),j.x,j.y,n,n,+(P>180),+(d>0),w.x,w.y,s,s,+(d<0),S.x,S.y)}else v+=za(p7||(p7=Yh(["L",",","Z"])),t,r);return v},Bwe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},nH=e=>{var t=ja(e,Bwe),{cx:r,cy:n,innerRadius:i,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(s<i||u===d)return null;var h=bi("recharts-sector",f),p=s-i,m=Fo(o,p,0,!0),g;return m>0&&Math.abs(u-d)<360?g=Rwe({cx:r,cy:n,innerRadius:i,outerRadius:s,cornerRadius:Math.min(m,p/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):g=rH({cx:r,cy:n,innerRadius:i,outerRadius:s,startAngle:u,endAngle:d}),x.createElement("path",IA({},$o(t),{className:h,d:g}))};function Fwe(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(xW(t)){if(e==="centric"){var{cx:n,cy:i,innerRadius:s,outerRadius:o,angle:l}=t,c=vs(n,i,s,l),u=vs(n,i,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return tH(t)}}var iH={},aH={},sH={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FC;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(sH);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sH;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(aH);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IC,r=aH;function n(i,s,o){o&&typeof o!="number"&&t.isIterateeCall(i,s,o)&&(s=o=void 0),i=r.toFinite(i),s===void 0?(s=i,i=0):s=r.toFinite(s),o=o===void 0?i<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-i)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=i,i+=o;return c}e.range=n})(iH);var Iwe=iH.range;const oH=af(Iwe);function ah(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Dwe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function eE(e){let t,r,n;e.length!==2?(t=ah,r=(l,c)=>ah(e(l),c),n=(l,c)=>e(l)-c):(t=e===ah||e===Dwe?e:$we,r=e,n=e);function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=i(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:i,center:o,right:s}}function $we(){return 0}function lH(e){return e===null?NaN:+e}function*Uwe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const zwe=eE(ah),wy=zwe.right;eE(lH).center;class m7 extends Map{constructor(t,r=Hwe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(g7(this,t))}has(t){return super.has(g7(this,t))}set(t,r){return super.set(Wwe(this,t),r)}delete(t){return super.delete(qwe(this,t))}}function g7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function Wwe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function qwe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function Hwe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Vwe(e=ah){if(e===ah)return cH;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function cH(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Gwe=Math.sqrt(50),Kwe=Math.sqrt(10),Ywe=Math.sqrt(2);function Nw(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),s=n/Math.pow(10,i),o=s>=Gwe?10:s>=Kwe?5:s>=Ywe?2:1;let l,c,u;return i<0?(u=Math.pow(10,-i)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,i)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?Nw(e,t,r*2):[l,c,u]}function DA(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,s,o]=n?Nw(t,e,r):Nw(e,t,r);if(!(s>=i))return[];const l=s-i+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(i+u)/-o;else for(let u=0;u<l;++u)c[u]=(i+u)*o;return c}function $A(e,t,r){return t=+t,e=+e,r=+r,Nw(e,t,r)[2]}function UA(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?$A(t,e,r):$A(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function x7(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function y7(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function uH(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?cH:Vwe(i);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+h)),m=Math.min(n,Math.floor(t+(c-u)*f/c+h));uH(e,t,p,m,i)}const s=e[t];let o=r,l=n;for(Qg(e,r,t),i(e[n],s)>0&&Qg(e,r,n);o<l;){for(Qg(e,o,l),++o,--l;i(e[o],s)<0;)++o;for(;i(e[l],s)>0;)--l}i(e[r],s)===0?Qg(e,r,l):(++l,Qg(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Qg(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Xwe(e,t,r){if(e=Float64Array.from(Uwe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return y7(e);if(t>=1)return x7(e);var n,i=(n-1)*t,s=Math.floor(i),o=x7(uH(e,s).subarray(0,s+1)),l=y7(e.subarray(s+1));return o+(l-o)*(i-s)}}function Qwe(e,t,r=lH){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,s=Math.floor(i),o=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return o+(l-o)*(i-s)}}function Jwe(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(i);++n<i;)s[n]=e+n*r;return s}function Vc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function mf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const zA=Symbol("implicit");function tE(){var e=new m7,t=[],r=[],n=zA;function i(s){let o=e.get(s);if(o===void 0){if(n!==zA)return n;e.set(s,o=t.push(s)-1)}return r[o%r.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new m7;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(r=Array.from(s),i):r.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return tE(t,r).unknown(n)},Vc.apply(i,arguments),i}function rE(){var e=tE().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,s,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,p=i<n,m=p?i:n,g=p?n:i;s=(g-m)/Math.max(1,h-c+u*2),l&&(s=Math.floor(s)),m+=(g-m-s*(h-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var y=Jwe(h).map(function(b){return m+s*b});return r(p?y.reverse():y)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,i]=h,n=+n,i=+i,f()):[n,i]},e.rangeRound=function(h){return[n,i]=h,n=+n,i=+i,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(h){return arguments.length?(l=!!h,f()):l},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return rE(t(),[n,i]).round(l).paddingInner(c).paddingOuter(u).align(d)},Vc.apply(f(),arguments)}function dH(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return dH(t())},e}function Zwe(){return dH(rE.apply(null,arguments).paddingInner(1))}function nE(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function fH(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Sy(){}var M1=.7,Cw=1/M1,_m="\\s*([+-]?\\d+)\\s*",L1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",rd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",eSe=/^#([0-9a-f]{3,8})$/,tSe=new RegExp(`^rgb\\(${_m},${_m},${_m}\\)$`),rSe=new RegExp(`^rgb\\(${rd},${rd},${rd}\\)$`),nSe=new RegExp(`^rgba\\(${_m},${_m},${_m},${L1}\\)$`),iSe=new RegExp(`^rgba\\(${rd},${rd},${rd},${L1}\\)$`),aSe=new RegExp(`^hsl\\(${L1},${rd},${rd}\\)$`),sSe=new RegExp(`^hsla\\(${L1},${rd},${rd},${L1}\\)$`),b7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};nE(Sy,R1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:v7,formatHex:v7,formatHex8:oSe,formatHsl:lSe,formatRgb:w7,toString:w7});function v7(){return this.rgb().formatHex()}function oSe(){return this.rgb().formatHex8()}function lSe(){return hH(this).formatHsl()}function w7(){return this.rgb().formatRgb()}function R1(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=eSe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?S7(t):r===3?new wl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?dv(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?dv(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=tSe.exec(e))?new wl(t[1],t[2],t[3],1):(t=rSe.exec(e))?new wl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=nSe.exec(e))?dv(t[1],t[2],t[3],t[4]):(t=iSe.exec(e))?dv(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=aSe.exec(e))?j7(t[1],t[2]/100,t[3]/100,1):(t=sSe.exec(e))?j7(t[1],t[2]/100,t[3]/100,t[4]):b7.hasOwnProperty(e)?S7(b7[e]):e==="transparent"?new wl(NaN,NaN,NaN,0):null}function S7(e){return new wl(e>>16&255,e>>8&255,e&255,1)}function dv(e,t,r,n){return n<=0&&(e=t=r=NaN),new wl(e,t,r,n)}function cSe(e){return e instanceof Sy||(e=R1(e)),e?(e=e.rgb(),new wl(e.r,e.g,e.b,e.opacity)):new wl}function WA(e,t,r,n){return arguments.length===1?cSe(e):new wl(e,t,r,n??1)}function wl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}nE(wl,WA,fH(Sy,{brighter(e){return e=e==null?Cw:Math.pow(Cw,e),new wl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?M1:Math.pow(M1,e),new wl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new wl(u0(this.r),u0(this.g),u0(this.b),Ew(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:_7,formatHex:_7,formatHex8:uSe,formatRgb:k7,toString:k7}));function _7(){return`#${Xh(this.r)}${Xh(this.g)}${Xh(this.b)}`}function uSe(){return`#${Xh(this.r)}${Xh(this.g)}${Xh(this.b)}${Xh((isNaN(this.opacity)?1:this.opacity)*255)}`}function k7(){const e=Ew(this.opacity);return`${e===1?"rgb(":"rgba("}${u0(this.r)}, ${u0(this.g)}, ${u0(this.b)}${e===1?")":`, ${e})`}`}function Ew(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function u0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Xh(e){return e=u0(e),(e<16?"0":"")+e.toString(16)}function j7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ou(e,t,r,n)}function hH(e){if(e instanceof ou)return new ou(e.h,e.s,e.l,e.opacity);if(e instanceof Sy||(e=R1(e)),!e)return new ou;if(e instanceof ou)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new ou(o,l,c,e.opacity)}function dSe(e,t,r,n){return arguments.length===1?hH(e):new ou(e,t,r,n??1)}function ou(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}nE(ou,dSe,fH(Sy,{brighter(e){return e=e==null?Cw:Math.pow(Cw,e),new ou(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?M1:Math.pow(M1,e),new ou(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new wl(Qk(e>=240?e-240:e+120,i,n),Qk(e,i,n),Qk(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new ou(A7(this.h),fv(this.s),fv(this.l),Ew(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ew(this.opacity);return`${e===1?"hsl(":"hsla("}${A7(this.h)}, ${fv(this.s)*100}%, ${fv(this.l)*100}%${e===1?")":`, ${e})`}`}}));function A7(e){return e=(e||0)%360,e<0?e+360:e}function fv(e){return Math.max(0,Math.min(1,e||0))}function Qk(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const iE=e=>()=>e;function fSe(e,t){return function(r){return e+r*t}}function hSe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function pSe(e){return(e=+e)==1?pH:function(t,r){return r-t?hSe(t,r,e):iE(isNaN(t)?r:t)}}function pH(e,t){var r=t-e;return r?fSe(e,r):iE(isNaN(e)?t:e)}const N7=function e(t){var r=pSe(t);function n(i,s){var o=r((i=WA(i)).r,(s=WA(s)).r),l=r(i.g,s.g),c=r(i.b,s.b),u=pH(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=l(d),i.b=c(d),i.opacity=u(d),i+""}}return n.gamma=e,n}(1);function mSe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(s){for(i=0;i<r;++i)n[i]=e[i]*(1-s)+t[i]*s;return n}}function gSe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function xSe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)i[o]=mg(e[o],t[o]);for(;o<r;++o)s[o]=t[o];return function(l){for(o=0;o<n;++o)s[o]=i[o](l);return s}}function ySe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Tw(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function bSe(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=mg(e[i],t[i]):n[i]=t[i];return function(s){for(i in r)n[i]=r[i](s);return n}}var qA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jk=new RegExp(qA.source,"g");function vSe(e){return function(){return e}}function wSe(e){return function(t){return e(t)+""}}function SSe(e,t){var r=qA.lastIndex=Jk.lastIndex=0,n,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=qA.exec(e))&&(i=Jk.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:Tw(n,i)})),r=Jk.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?wSe(c[0].x):vSe(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function mg(e,t){var r=typeof t,n;return t==null||r==="boolean"?iE(t):(r==="number"?Tw:r==="string"?(n=R1(t))?(t=n,N7):SSe:t instanceof R1?N7:t instanceof Date?ySe:gSe(t)?mSe:Array.isArray(t)?xSe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?bSe:Tw)(e,t)}function aE(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function _Se(e,t){t===void 0&&(t=e,e=mg);for(var r=0,n=t.length-1,i=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(i,i=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function kSe(e){return function(){return e}}function Pw(e){return+e}var C7=[0,1];function Zo(e){return e}function HA(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:kSe(isNaN(t)?NaN:.5)}function jSe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function ASe(e,t,r){var n=e[0],i=e[1],s=t[0],o=t[1];return i<n?(n=HA(i,n),s=r(o,s)):(n=HA(n,i),s=r(s,o)),function(l){return s(n(l))}}function NSe(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),s=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=HA(e[o],e[o+1]),s[o]=r(t[o],t[o+1]);return function(l){var c=wy(e,l,1,n)-1;return s[c](i[c](l))}}function _y(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function h_(){var e=C7,t=C7,r=mg,n,i,s,o=Zo,l,c,u;function d(){var h=Math.min(e.length,t.length);return o!==Zo&&(o=jSe(e[0],e[h-1])),l=h>2?NSe:ASe,c=u=null,f}function f(h){return h==null||isNaN(h=+h)?s:(c||(c=l(e.map(n),t,r)))(n(o(h)))}return f.invert=function(h){return o(i((u||(u=l(t,e.map(n),Tw)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,Pw),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=aE,d()},f.clamp=function(h){return arguments.length?(o=h?!0:Zo,d()):o!==Zo},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(s=h,f):s},function(h,p){return n=h,i=p,d()}}function sE(){return h_()(Zo,Zo)}function CSe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ow(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Hm(e){return e=Ow(Math.abs(e)),e?e[1]:NaN}function ESe(e,t){return function(r,n){for(var i=r.length,s=[],o=0,l=e[0],c=0;i>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(i-=l,i+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return s.reverse().join(t)}}function TSe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var PSe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function B1(e){if(!(t=PSe.exec(e)))throw new Error("invalid format: "+e);var t;return new oE({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}B1.prototype=oE.prototype;function oE(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}oE.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function OSe(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var Mw;function MSe(e,t){var r=Ow(e,t);if(!r)return Mw=void 0,e.toPrecision(t);var n=r[0],i=r[1],s=i-(Mw=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Ow(e,Math.max(0,t+s-1))[0]}function E7(e,t){var r=Ow(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const T7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:CSe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>E7(e*100,t),r:E7,s:MSe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function P7(e){return e}var O7=Array.prototype.map,M7=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function LSe(e){var t=e.grouping===void 0||e.thousands===void 0?P7:ESe(O7.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?P7:TSe(O7.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f,h){f=B1(f);var p=f.fill,m=f.align,g=f.sign,y=f.symbol,b=f.zero,v=f.width,w=f.comma,S=f.precision,k=f.trim,j=f.type;j==="n"?(w=!0,j="g"):T7[j]||(S===void 0&&(S=12),k=!0,j="g"),(b||p==="0"&&m==="=")&&(b=!0,p="0",m="=");var A=(h&&h.prefix!==void 0?h.prefix:"")+(y==="$"?r:y==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():""),L=(y==="$"?n:/[%p]/.test(j)?o:"")+(h&&h.suffix!==void 0?h.suffix:""),P=T7[j],B=/[defgprs%]/.test(j);S=S===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function E(T){var F=A,W=L,z,se,de;if(j==="c")W=P(T)+W,T="";else{T=+T;var U=T<0||1/T<0;if(T=isNaN(T)?c:P(Math.abs(T),S),k&&(T=OSe(T)),U&&+T==0&&g!=="+"&&(U=!1),F=(U?g==="("?g:l:g==="-"||g==="("?"":g)+F,W=(j==="s"&&!isNaN(T)&&Mw!==void 0?M7[8+Mw/3]:"")+W+(U&&g==="("?")":""),B){for(z=-1,se=T.length;++z<se;)if(de=T.charCodeAt(z),48>de||de>57){W=(de===46?i+T.slice(z+1):T.slice(z))+W,T=T.slice(0,z);break}}}w&&!b&&(T=t(T,1/0));var G=F.length+T.length+W.length,re=G<v?new Array(v-G+1).join(p):"";switch(w&&b&&(T=t(re+T,re.length?v-W.length:1/0),re=""),m){case"<":T=F+T+W+re;break;case"=":T=F+re+T+W;break;case"^":T=re.slice(0,G=re.length>>1)+F+T+W+re.slice(G);break;default:T=re+F+T+W;break}return s(T)}return E.toString=function(){return f+""},E}function d(f,h){var p=Math.max(-8,Math.min(8,Math.floor(Hm(h)/3)))*3,m=Math.pow(10,-p),g=u((f=B1(f),f.type="f",f),{suffix:M7[8+p/3]});return function(y){return g(m*y)}}return{format:u,formatPrefix:d}}var hv,lE,mH;RSe({thousands:",",grouping:[3],currency:["$",""]});function RSe(e){return hv=LSe(e),lE=hv.format,mH=hv.formatPrefix,hv}function BSe(e){return Math.max(0,-Hm(Math.abs(e)))}function FSe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Hm(t)/3)))*3-Hm(Math.abs(e)))}function ISe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Hm(t)-Hm(e))+1}function gH(e,t,r,n){var i=UA(e,t,r),s;switch(n=B1(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=FSe(i,o))&&(n.precision=s),mH(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=ISe(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=BSe(i))&&(n.precision=s-(n.type==="%")*2);break}}return lE(n)}function Nh(e){var t=e.domain;return e.ticks=function(r){var n=t();return DA(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return gH(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,s=n.length-1,o=n[i],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=i,i=s,s=u);d-- >0;){if(u=$A(o,l,r),u===c)return n[i]=o,n[s]=l,t(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function xH(){var e=sE();return e.copy=function(){return _y(e,xH())},Vc.apply(e,arguments),Nh(e)}function yH(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Pw),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return yH(e).unknown(t)},e=arguments.length?Array.from(e,Pw):[0,1],Nh(r)}function bH(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],s=e[n],o;return s<i&&(o=r,r=n,n=o,o=i,i=s,s=o),e[r]=t.floor(i),e[n]=t.ceil(s),e}function L7(e){return Math.log(e)}function R7(e){return Math.exp(e)}function DSe(e){return-Math.log(-e)}function $Se(e){return-Math.exp(-e)}function USe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function zSe(e){return e===10?USe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function WSe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function B7(e){return(t,r)=>-e(-t,r)}function cE(e){const t=e(L7,R7),r=t.domain;let n=10,i,s;function o(){return i=WSe(n),s=zSe(n),r()[0]<0?(i=B7(i),s=B7(s),e(DSe,$Se)):e(L7,R7),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=i(u),p=i(d),m,g;const y=l==null?10:+l;let b=[];if(!(n%1)&&p-h<y){if(h=Math.floor(h),p=Math.ceil(p),u>0){for(;h<=p;++h)for(m=1;m<n;++m)if(g=h<0?m/s(-h):m*s(h),!(g<u)){if(g>d)break;b.push(g)}}else for(;h<=p;++h)for(m=n-1;m>=1;--m)if(g=h>0?m/s(-h):m*s(h),!(g<u)){if(g>d)break;b.push(g)}b.length*2<y&&(b=DA(u,d,y))}else b=DA(h,p,Math.min(p-h,y)).map(s);return f?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=B1(c)).precision==null&&(c.trim=!0),c=lE(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/s(Math.round(i(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(bH(r(),{floor:l=>s(Math.floor(i(l))),ceil:l=>s(Math.ceil(i(l)))})),t}function vH(){const e=cE(h_()).domain([1,10]);return e.copy=()=>_y(e,vH()).base(e.base()),Vc.apply(e,arguments),e}function F7(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function I7(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function uE(e){var t=1,r=e(F7(t),I7(t));return r.constant=function(n){return arguments.length?e(F7(t=+n),I7(t)):t},Nh(r)}function wH(){var e=uE(h_());return e.copy=function(){return _y(e,wH()).constant(e.constant())},Vc.apply(e,arguments)}function D7(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function qSe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function HSe(e){return e<0?-e*e:e*e}function dE(e){var t=e(Zo,Zo),r=1;function n(){return r===1?e(Zo,Zo):r===.5?e(qSe,HSe):e(D7(r),D7(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Nh(t)}function fE(){var e=dE(h_());return e.copy=function(){return _y(e,fE()).exponent(e.exponent())},Vc.apply(e,arguments),e}function VSe(){return fE.apply(null,arguments).exponent(.5)}function $7(e){return Math.sign(e)*e*e}function GSe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function SH(){var e=sE(),t=[0,1],r=!1,n;function i(s){var o=GSe(e(s));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(s){return e.invert($7(s))},i.domain=function(s){return arguments.length?(e.domain(s),i):e.domain()},i.range=function(s){return arguments.length?(e.range((t=Array.from(s,Pw)).map($7)),i):t.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(r=!!s,i):r},i.clamp=function(s){return arguments.length?(e.clamp(s),i):e.clamp()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return SH(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Vc.apply(i,arguments),Nh(i)}function _H(){var e=[],t=[],r=[],n;function i(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=Qwe(e,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:t[wy(r,o)]}return s.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(ah),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return _H().domain(e).range(t).unknown(n)},Vc.apply(s,arguments)}function kH(){var e=0,t=1,r=1,n=[.5],i=[0,1],s;function o(c){return c!=null&&c<=c?i[wy(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,l()):i.slice()},o.invertExtent=function(c){var u=i.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return kH().domain([e,t]).range(i).unknown(s)},Vc.apply(Nh(o),arguments)}function jH(){var e=[.5],t=[0,1],r,n=1;function i(s){return s!=null&&s<=s?t[wy(e,s,0,n)]:r}return i.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return jH().domain(e).range(t).unknown(r)},Vc.apply(i,arguments)}const Zk=new Date,ej=new Date;function Rs(e,t,r,n){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),l=i.ceil(s);return s-o<l-s?o:l},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,l)=>{const c=[];if(s=i.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),t(s,l),e(s);while(u<s&&s<o);return c},i.filter=s=>Rs(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!s(o););else for(;--l>=0;)for(;t(o,1),!s(o););}),r&&(i.count=(s,o)=>(Zk.setTime(+s),ej.setTime(+o),e(Zk),e(ej),Math.floor(r(Zk,ej))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?o=>n(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const Lw=Rs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Lw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Rs(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Lw);Lw.range;const Rd=1e3,Lc=Rd*60,Bd=Lc*60,Qd=Bd*24,hE=Qd*7,U7=Qd*30,tj=Qd*365,Qh=Rs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Rd)},(e,t)=>(t-e)/Rd,e=>e.getUTCSeconds());Qh.range;const pE=Rs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rd)},(e,t)=>{e.setTime(+e+t*Lc)},(e,t)=>(t-e)/Lc,e=>e.getMinutes());pE.range;const mE=Rs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Lc)},(e,t)=>(t-e)/Lc,e=>e.getUTCMinutes());mE.range;const gE=Rs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rd-e.getMinutes()*Lc)},(e,t)=>{e.setTime(+e+t*Bd)},(e,t)=>(t-e)/Bd,e=>e.getHours());gE.range;const xE=Rs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Bd)},(e,t)=>(t-e)/Bd,e=>e.getUTCHours());xE.range;const ky=Rs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Lc)/Qd,e=>e.getDate()-1);ky.range;const p_=Rs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qd,e=>e.getUTCDate()-1);p_.range;const AH=Rs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Qd,e=>Math.floor(e/Qd));AH.range;function ap(e){return Rs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Lc)/hE)}const m_=ap(0),Rw=ap(1),KSe=ap(2),YSe=ap(3),Vm=ap(4),XSe=ap(5),QSe=ap(6);m_.range;Rw.range;KSe.range;YSe.range;Vm.range;XSe.range;QSe.range;function sp(e){return Rs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/hE)}const g_=sp(0),Bw=sp(1),JSe=sp(2),ZSe=sp(3),Gm=sp(4),e_e=sp(5),t_e=sp(6);g_.range;Bw.range;JSe.range;ZSe.range;Gm.range;e_e.range;t_e.range;const yE=Rs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());yE.range;const bE=Rs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());bE.range;const Jd=Rs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Jd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Rs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Jd.range;const Zd=Rs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Zd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Rs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Zd.range;function NH(e,t,r,n,i,s){const o=[[Qh,1,Rd],[Qh,5,5*Rd],[Qh,15,15*Rd],[Qh,30,30*Rd],[s,1,Lc],[s,5,5*Lc],[s,15,15*Lc],[s,30,30*Lc],[i,1,Bd],[i,3,3*Bd],[i,6,6*Bd],[i,12,12*Bd],[n,1,Qd],[n,2,2*Qd],[r,1,hE],[t,1,U7],[t,3,3*U7],[e,1,tj]];function l(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),m=p?p.range(u,+d+1):[];return h?m.reverse():m}function c(u,d,f){const h=Math.abs(d-u)/f,p=eE(([,,y])=>y).right(o,h);if(p===o.length)return e.every(UA(u/tj,d/tj,f));if(p===0)return Lw.every(Math.max(UA(u,d,f),1));const[m,g]=o[h/o[p-1][2]<o[p][2]/h?p-1:p];return m.every(g)}return[l,c]}const[r_e,n_e]=NH(Zd,bE,g_,AH,xE,mE),[i_e,a_e]=NH(Jd,yE,m_,ky,gE,pE);function rj(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function nj(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Jg(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function s_e(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,s=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=Zg(i),d=ex(i),f=Zg(s),h=ex(s),p=Zg(o),m=ex(o),g=Zg(l),y=ex(l),b=Zg(c),v=ex(c),w={a:de,A:U,b:G,B:re,c:null,d:G7,e:G7,f:E_e,g:D_e,G:U_e,H:A_e,I:N_e,j:C_e,L:CH,m:T_e,M:P_e,p:X,q:C,Q:X7,s:Q7,S:O_e,u:M_e,U:L_e,V:R_e,w:B_e,W:F_e,x:null,X:null,y:I_e,Y:$_e,Z:z_e,"%":Y7},S={a:K,A:V,b:R,B:J,c:null,d:K7,e:K7,f:V_e,g:r5e,G:i5e,H:W_e,I:q_e,j:H_e,L:TH,m:G_e,M:K_e,p:q,q:Y,Q:X7,s:Q7,S:Y_e,u:X_e,U:Q_e,V:J_e,w:Z_e,W:e5e,x:null,X:null,y:t5e,Y:n5e,Z:a5e,"%":Y7},k={a:B,A:E,b:T,B:F,c:W,d:H7,e:H7,f:S_e,g:q7,G:W7,H:V7,I:V7,j:y_e,L:w_e,m:x_e,M:b_e,p:P,q:g_e,Q:k_e,s:j_e,S:v_e,u:d_e,U:f_e,V:h_e,w:u_e,W:p_e,x:z,X:se,y:q7,Y:W7,Z:m_e,"%":__e};w.x=j(r,w),w.X=j(n,w),w.c=j(t,w),S.x=j(r,S),S.X=j(n,S),S.c=j(t,S);function j(Q,ie){return function(le){var O=[],H=-1,ae=0,I=Q.length,Z,pe,Oe;for(le instanceof Date||(le=new Date(+le));++H<I;)Q.charCodeAt(H)===37&&(O.push(Q.slice(ae,H)),(pe=z7[Z=Q.charAt(++H)])!=null?Z=Q.charAt(++H):pe=Z==="e"?" ":"0",(Oe=ie[Z])&&(Z=Oe(le,pe)),O.push(Z),ae=H+1);return O.push(Q.slice(ae,H)),O.join("")}}function A(Q,ie){return function(le){var O=Jg(1900,void 0,1),H=L(O,Q,le+="",0),ae,I;if(H!=le.length)return null;if("Q"in O)return new Date(O.Q);if("s"in O)return new Date(O.s*1e3+("L"in O?O.L:0));if(ie&&!("Z"in O)&&(O.Z=0),"p"in O&&(O.H=O.H%12+O.p*12),O.m===void 0&&(O.m="q"in O?O.q:0),"V"in O){if(O.V<1||O.V>53)return null;"w"in O||(O.w=1),"Z"in O?(ae=nj(Jg(O.y,0,1)),I=ae.getUTCDay(),ae=I>4||I===0?Bw.ceil(ae):Bw(ae),ae=p_.offset(ae,(O.V-1)*7),O.y=ae.getUTCFullYear(),O.m=ae.getUTCMonth(),O.d=ae.getUTCDate()+(O.w+6)%7):(ae=rj(Jg(O.y,0,1)),I=ae.getDay(),ae=I>4||I===0?Rw.ceil(ae):Rw(ae),ae=ky.offset(ae,(O.V-1)*7),O.y=ae.getFullYear(),O.m=ae.getMonth(),O.d=ae.getDate()+(O.w+6)%7)}else("W"in O||"U"in O)&&("w"in O||(O.w="u"in O?O.u%7:"W"in O?1:0),I="Z"in O?nj(Jg(O.y,0,1)).getUTCDay():rj(Jg(O.y,0,1)).getDay(),O.m=0,O.d="W"in O?(O.w+6)%7+O.W*7-(I+5)%7:O.w+O.U*7-(I+6)%7);return"Z"in O?(O.H+=O.Z/100|0,O.M+=O.Z%100,nj(O)):rj(O)}}function L(Q,ie,le,O){for(var H=0,ae=ie.length,I=le.length,Z,pe;H<ae;){if(O>=I)return-1;if(Z=ie.charCodeAt(H++),Z===37){if(Z=ie.charAt(H++),pe=k[Z in z7?ie.charAt(H++):Z],!pe||(O=pe(Q,le,O))<0)return-1}else if(Z!=le.charCodeAt(O++))return-1}return O}function P(Q,ie,le){var O=u.exec(ie.slice(le));return O?(Q.p=d.get(O[0].toLowerCase()),le+O[0].length):-1}function B(Q,ie,le){var O=p.exec(ie.slice(le));return O?(Q.w=m.get(O[0].toLowerCase()),le+O[0].length):-1}function E(Q,ie,le){var O=f.exec(ie.slice(le));return O?(Q.w=h.get(O[0].toLowerCase()),le+O[0].length):-1}function T(Q,ie,le){var O=b.exec(ie.slice(le));return O?(Q.m=v.get(O[0].toLowerCase()),le+O[0].length):-1}function F(Q,ie,le){var O=g.exec(ie.slice(le));return O?(Q.m=y.get(O[0].toLowerCase()),le+O[0].length):-1}function W(Q,ie,le){return L(Q,t,ie,le)}function z(Q,ie,le){return L(Q,r,ie,le)}function se(Q,ie,le){return L(Q,n,ie,le)}function de(Q){return o[Q.getDay()]}function U(Q){return s[Q.getDay()]}function G(Q){return c[Q.getMonth()]}function re(Q){return l[Q.getMonth()]}function X(Q){return i[+(Q.getHours()>=12)]}function C(Q){return 1+~~(Q.getMonth()/3)}function K(Q){return o[Q.getUTCDay()]}function V(Q){return s[Q.getUTCDay()]}function R(Q){return c[Q.getUTCMonth()]}function J(Q){return l[Q.getUTCMonth()]}function q(Q){return i[+(Q.getUTCHours()>=12)]}function Y(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var ie=j(Q+="",w);return ie.toString=function(){return Q},ie},parse:function(Q){var ie=A(Q+="",!1);return ie.toString=function(){return Q},ie},utcFormat:function(Q){var ie=j(Q+="",S);return ie.toString=function(){return Q},ie},utcParse:function(Q){var ie=A(Q+="",!0);return ie.toString=function(){return Q},ie}}}var z7={"-":"",_:" ",0:"0"},Ys=/^\s*\d+/,o_e=/^%/,l_e=/[\\^$*+?|[\]().{}]/g;function Ni(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",s=i.length;return n+(s<r?new Array(r-s+1).join(t)+i:i)}function c_e(e){return e.replace(l_e,"\\$&")}function Zg(e){return new RegExp("^(?:"+e.map(c_e).join("|")+")","i")}function ex(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function u_e(e,t,r){var n=Ys.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function d_e(e,t,r){var n=Ys.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function f_e(e,t,r){var n=Ys.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function h_e(e,t,r){var n=Ys.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function p_e(e,t,r){var n=Ys.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function W7(e,t,r){var n=Ys.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function q7(e,t,r){var n=Ys.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function m_e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function g_e(e,t,r){var n=Ys.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function x_e(e,t,r){var n=Ys.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function H7(e,t,r){var n=Ys.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function y_e(e,t,r){var n=Ys.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function V7(e,t,r){var n=Ys.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function b_e(e,t,r){var n=Ys.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function v_e(e,t,r){var n=Ys.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function w_e(e,t,r){var n=Ys.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function S_e(e,t,r){var n=Ys.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function __e(e,t,r){var n=o_e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function k_e(e,t,r){var n=Ys.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function j_e(e,t,r){var n=Ys.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function G7(e,t){return Ni(e.getDate(),t,2)}function A_e(e,t){return Ni(e.getHours(),t,2)}function N_e(e,t){return Ni(e.getHours()%12||12,t,2)}function C_e(e,t){return Ni(1+ky.count(Jd(e),e),t,3)}function CH(e,t){return Ni(e.getMilliseconds(),t,3)}function E_e(e,t){return CH(e,t)+"000"}function T_e(e,t){return Ni(e.getMonth()+1,t,2)}function P_e(e,t){return Ni(e.getMinutes(),t,2)}function O_e(e,t){return Ni(e.getSeconds(),t,2)}function M_e(e){var t=e.getDay();return t===0?7:t}function L_e(e,t){return Ni(m_.count(Jd(e)-1,e),t,2)}function EH(e){var t=e.getDay();return t>=4||t===0?Vm(e):Vm.ceil(e)}function R_e(e,t){return e=EH(e),Ni(Vm.count(Jd(e),e)+(Jd(e).getDay()===4),t,2)}function B_e(e){return e.getDay()}function F_e(e,t){return Ni(Rw.count(Jd(e)-1,e),t,2)}function I_e(e,t){return Ni(e.getFullYear()%100,t,2)}function D_e(e,t){return e=EH(e),Ni(e.getFullYear()%100,t,2)}function $_e(e,t){return Ni(e.getFullYear()%1e4,t,4)}function U_e(e,t){var r=e.getDay();return e=r>=4||r===0?Vm(e):Vm.ceil(e),Ni(e.getFullYear()%1e4,t,4)}function z_e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ni(t/60|0,"0",2)+Ni(t%60,"0",2)}function K7(e,t){return Ni(e.getUTCDate(),t,2)}function W_e(e,t){return Ni(e.getUTCHours(),t,2)}function q_e(e,t){return Ni(e.getUTCHours()%12||12,t,2)}function H_e(e,t){return Ni(1+p_.count(Zd(e),e),t,3)}function TH(e,t){return Ni(e.getUTCMilliseconds(),t,3)}function V_e(e,t){return TH(e,t)+"000"}function G_e(e,t){return Ni(e.getUTCMonth()+1,t,2)}function K_e(e,t){return Ni(e.getUTCMinutes(),t,2)}function Y_e(e,t){return Ni(e.getUTCSeconds(),t,2)}function X_e(e){var t=e.getUTCDay();return t===0?7:t}function Q_e(e,t){return Ni(g_.count(Zd(e)-1,e),t,2)}function PH(e){var t=e.getUTCDay();return t>=4||t===0?Gm(e):Gm.ceil(e)}function J_e(e,t){return e=PH(e),Ni(Gm.count(Zd(e),e)+(Zd(e).getUTCDay()===4),t,2)}function Z_e(e){return e.getUTCDay()}function e5e(e,t){return Ni(Bw.count(Zd(e)-1,e),t,2)}function t5e(e,t){return Ni(e.getUTCFullYear()%100,t,2)}function r5e(e,t){return e=PH(e),Ni(e.getUTCFullYear()%100,t,2)}function n5e(e,t){return Ni(e.getUTCFullYear()%1e4,t,4)}function i5e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Gm(e):Gm.ceil(e),Ni(e.getUTCFullYear()%1e4,t,4)}function a5e(){return"+0000"}function Y7(){return"%"}function X7(e){return+e}function Q7(e){return Math.floor(+e/1e3)}var Cp,OH,MH;s5e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function s5e(e){return Cp=s_e(e),OH=Cp.format,Cp.parse,MH=Cp.utcFormat,Cp.utcParse,Cp}function o5e(e){return new Date(e)}function l5e(e){return e instanceof Date?+e:+new Date(+e)}function vE(e,t,r,n,i,s,o,l,c,u){var d=sE(),f=d.invert,h=d.domain,p=u(".%L"),m=u(":%S"),g=u("%I:%M"),y=u("%I %p"),b=u("%a %d"),v=u("%b %d"),w=u("%B"),S=u("%Y");function k(j){return(c(j)<j?p:l(j)<j?m:o(j)<j?g:s(j)<j?y:n(j)<j?i(j)<j?b:v:r(j)<j?w:S)(j)}return d.invert=function(j){return new Date(f(j))},d.domain=function(j){return arguments.length?h(Array.from(j,l5e)):h().map(o5e)},d.ticks=function(j){var A=h();return e(A[0],A[A.length-1],j??10)},d.tickFormat=function(j,A){return A==null?k:u(A)},d.nice=function(j){var A=h();return(!j||typeof j.range!="function")&&(j=t(A[0],A[A.length-1],j??10)),j?h(bH(A,j)):d},d.copy=function(){return _y(d,vE(e,t,r,n,i,s,o,l,c,u))},d}function c5e(){return Vc.apply(vE(i_e,a_e,Jd,yE,m_,ky,gE,pE,Qh,OH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function u5e(){return Vc.apply(vE(r_e,n_e,Zd,bE,g_,p_,xE,mE,Qh,MH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function x_(){var e=0,t=1,r,n,i,s,o=Zo,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(i===0?.5:(f=(s(f)-r)*i,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),n=s(t=+t),i=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(h){var p,m;return arguments.length?([p,m]=h,o=f(p,m),u):[o(0),o(1)]}}return u.range=d(mg),u.rangeRound=d(aE),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(e),n=f(t),i=r===n?0:1/(n-r),u}}function Ch(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function LH(){var e=Nh(x_()(Zo));return e.copy=function(){return Ch(e,LH())},mf.apply(e,arguments)}function RH(){var e=cE(x_()).domain([1,10]);return e.copy=function(){return Ch(e,RH()).base(e.base())},mf.apply(e,arguments)}function BH(){var e=uE(x_());return e.copy=function(){return Ch(e,BH()).constant(e.constant())},mf.apply(e,arguments)}function wE(){var e=dE(x_());return e.copy=function(){return Ch(e,wE()).exponent(e.exponent())},mf.apply(e,arguments)}function d5e(){return wE.apply(null,arguments).exponent(.5)}function FH(){var e=[],t=Zo;function r(n){if(n!=null&&!isNaN(n=+n))return t((wy(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(ah),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,s)=>Xwe(e,s/n))},r.copy=function(){return FH(t).domain(e)},mf.apply(r,arguments)}function y_(){var e=0,t=.5,r=1,n=1,i,s,o,l,c,u=Zo,d,f=!1,h;function p(g){return isNaN(g=+g)?h:(g=.5+((g=+d(g))-s)*(n*g<n*s?l:c),u(f?Math.max(0,Math.min(1,g)):g))}p.domain=function(g){return arguments.length?([e,t,r]=g,i=d(e=+e),s=d(t=+t),o=d(r=+r),l=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),n=s<i?-1:1,p):[e,t,r]},p.clamp=function(g){return arguments.length?(f=!!g,p):f},p.interpolator=function(g){return arguments.length?(u=g,p):u};function m(g){return function(y){var b,v,w;return arguments.length?([b,v,w]=y,u=_Se(g,[b,v,w]),p):[u(0),u(.5),u(1)]}}return p.range=m(mg),p.rangeRound=m(aE),p.unknown=function(g){return arguments.length?(h=g,p):h},function(g){return d=g,i=g(e),s=g(t),o=g(r),l=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),n=s<i?-1:1,p}}function IH(){var e=Nh(y_()(Zo));return e.copy=function(){return Ch(e,IH())},mf.apply(e,arguments)}function DH(){var e=cE(y_()).domain([.1,1,10]);return e.copy=function(){return Ch(e,DH()).base(e.base())},mf.apply(e,arguments)}function $H(){var e=uE(y_());return e.copy=function(){return Ch(e,$H()).constant(e.constant())},mf.apply(e,arguments)}function SE(){var e=dE(y_());return e.copy=function(){return Ch(e,SE()).exponent(e.exponent())},mf.apply(e,arguments)}function f5e(){return SE.apply(null,arguments).exponent(.5)}const gx=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:rE,scaleDiverging:IH,scaleDivergingLog:DH,scaleDivergingPow:SE,scaleDivergingSqrt:f5e,scaleDivergingSymlog:$H,scaleIdentity:yH,scaleImplicit:zA,scaleLinear:xH,scaleLog:vH,scaleOrdinal:tE,scalePoint:Zwe,scalePow:fE,scaleQuantile:_H,scaleQuantize:kH,scaleRadial:SH,scaleSequential:LH,scaleSequentialLog:RH,scaleSequentialPow:wE,scaleSequentialQuantile:FH,scaleSequentialSqrt:d5e,scaleSequentialSymlog:BH,scaleSqrt:VSe,scaleSymlog:wH,scaleThreshold:jH,scaleTime:c5e,scaleUtc:u5e,tickFormat:gH},Symbol.toStringTag,{value:"Module"}));var gf=e=>e.chartData,b_=Jt([gf],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),v_=(e,t,r,n)=>n?b_(e):gf(e),h5e=(e,t,r)=>r?b_(e):gf(e);function ef(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(di(t)&&di(r))return!0}return!1}function J7(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function UH(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,i,s;if(di(r))i=r;else if(typeof r=="function")return;if(di(n))s=n;else if(typeof n=="function")return;var o=[i,s];if(ef(o))return o}}function p5e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(ef(n))return J7(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[i,s]=e,o,l;if(i==="auto")t!=null&&(o=Math.min(...t));else if(En(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[0]))}catch{}else if(typeof i=="string"&&gL.test(i)){var c=gL.exec(i);if(c==null||c[1]==null||t==null)o=void 0;else{var u=+c[1];o=t[0]-u}}else o=t==null?void 0:t[0];if(s==="auto")t!=null&&(l=Math.max(...t));else if(En(s))l=s;else if(typeof s=="function")try{t!=null&&(l=s(t==null?void 0:t[1]))}catch{}else if(typeof s=="string"&&xL.test(s)){var d=xL.exec(s);if(d==null||d[1]==null||t==null)l=void 0;else{var f=+d[1];l=t[1]+f}}else l=t==null?void 0:t[1];var h=[o,l];if(ef(h))return t==null?h:J7(h,t,r)}}}var gg=1e9,m5e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},kE,_a=!0,Wc="[DecimalError] ",d0=Wc+"Invalid argument: ",_E=Wc+"Exponent out of range: ",xg=Math.floor,Uh=Math.pow,g5e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Yl,zs=1e7,da=7,zH=9007199254740991,Fw=xg(zH/da),Tn={};Tn.absoluteValue=Tn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Tn.comparedTo=Tn.cmp=function(e){var t,r,n,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===i?0:n>i^s.s<0?1:-1};Tn.decimalPlaces=Tn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*da;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Tn.dividedBy=Tn.div=function(e){return zd(this,new this.constructor(e))};Tn.dividedToIntegerBy=Tn.idiv=function(e){var t=this,r=t.constructor;return ra(zd(t,new r(e),0,1),r.precision)};Tn.equals=Tn.eq=function(e){return!this.cmp(e)};Tn.exponent=function(){return ws(this)};Tn.greaterThan=Tn.gt=function(e){return this.cmp(e)>0};Tn.greaterThanOrEqualTo=Tn.gte=function(e){return this.cmp(e)>=0};Tn.isInteger=Tn.isint=function(){return this.e>this.d.length-2};Tn.isNegative=Tn.isneg=function(){return this.s<0};Tn.isPositive=Tn.ispos=function(){return this.s>0};Tn.isZero=function(){return this.s===0};Tn.lessThan=Tn.lt=function(e){return this.cmp(e)<0};Tn.lessThanOrEqualTo=Tn.lte=function(e){return this.cmp(e)<1};Tn.logarithm=Tn.log=function(e){var t,r=this,n=r.constructor,i=n.precision,s=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Yl))throw Error(Wc+"NaN");if(r.s<1)throw Error(Wc+(r.s?"NaN":"-Infinity"));return r.eq(Yl)?new n(0):(_a=!1,t=zd(F1(r,s),F1(e,s),s),_a=!0,ra(t,i))};Tn.minus=Tn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?HH(t,e):WH(t,(e.s=-e.s,e))};Tn.modulo=Tn.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(Wc+"NaN");return r.s?(_a=!1,t=zd(r,e,0,1).times(e),_a=!0,r.minus(t)):ra(new n(r),i)};Tn.naturalExponential=Tn.exp=function(){return qH(this)};Tn.naturalLogarithm=Tn.ln=function(){return F1(this)};Tn.negated=Tn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Tn.plus=Tn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?WH(t,e):HH(t,(e.s=-e.s,e))};Tn.precision=Tn.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(d0+e);if(t=ws(i)+1,n=i.d.length-1,r=n*da+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Tn.squareRoot=Tn.sqrt=function(){var e,t,r,n,i,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Wc+"NaN")}for(e=ws(l),_a=!1,i=Math.sqrt(+l),i==0||i==1/0?(t=Ju(l.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=xg((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(i.toString()),r=c.precision,i=o=r+3;;)if(s=n,n=s.plus(zd(l,s,o+2)).times(.5),Ju(s.d).slice(0,o)===(t=Ju(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(ra(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(t!="9999")break;o+=4}return _a=!0,ra(n,r)};Tn.times=Tn.mul=function(e){var t,r,n,i,s,o,l,c,u,d=this,f=d.constructor,h=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=h.length,u=p.length,c<u&&(s=h,h=p,p=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(t=0,i=c+n;i>n;)l=s[i]+p[n]*h[i-n-1]+t,s[i--]=l%zs|0,t=l/zs|0;s[i]=(s[i]+t)%zs|0}for(;!s[--o];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,_a?ra(e,f.precision):e};Tn.toDecimalPlaces=Tn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(sd(e,0,gg),t===void 0?t=n.rounding:sd(t,0,8),ra(r,e+ws(r)+1,t))};Tn.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=B0(n,!0):(sd(e,0,gg),t===void 0?t=i.rounding:sd(t,0,8),n=ra(new i(n),e+1,t),r=B0(n,!0,e+1)),r};Tn.toFixed=function(e,t){var r,n,i=this,s=i.constructor;return e===void 0?B0(i):(sd(e,0,gg),t===void 0?t=s.rounding:sd(t,0,8),n=ra(new s(i),e+ws(i)+1,t),r=B0(n.abs(),!1,e+ws(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Tn.toInteger=Tn.toint=function(){var e=this,t=e.constructor;return ra(new t(e),ws(e)+1,t.rounding)};Tn.toNumber=function(){return+this};Tn.toPower=Tn.pow=function(e){var t,r,n,i,s,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Yl);if(l=new c(l),!l.s){if(e.s<1)throw Error(Wc+"Infinity");return l}if(l.eq(Yl))return l;if(n=c.precision,e.eq(Yl))return ra(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,s=l.s,o){if((r=d<0?-d:d)<=zH){for(i=new c(Yl),t=Math.ceil(n/da+4),_a=!1;r%2&&(i=i.times(l),eR(i.d,t)),r=xg(r/2),r!==0;)l=l.times(l),eR(l.d,t);return _a=!0,e.s<0?new c(Yl).div(i):ra(i,n)}}else if(s<0)throw Error(Wc+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,_a=!1,i=e.times(F1(l,n+u)),_a=!0,i=qH(i),i.s=s,i};Tn.toPrecision=function(e,t){var r,n,i=this,s=i.constructor;return e===void 0?(r=ws(i),n=B0(i,r<=s.toExpNeg||r>=s.toExpPos)):(sd(e,1,gg),t===void 0?t=s.rounding:sd(t,0,8),i=ra(new s(i),e,t),r=ws(i),n=B0(i,e<=r||r<=s.toExpNeg,e)),n};Tn.toSignificantDigits=Tn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(sd(e,1,gg),t===void 0?t=n.rounding:sd(t,0,8)),ra(new n(r),e,t)};Tn.toString=Tn.valueOf=Tn.val=Tn.toJSON=Tn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ws(e),r=e.constructor;return B0(e,t<=r.toExpNeg||t>=r.toExpPos)};function WH(e,t){var r,n,i,s,o,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),_a?ra(t,f):t;if(c=e.d,u=t.d,o=e.e,i=t.e,c=c.slice(),s=o-i,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,i=o,l=c.length),o=Math.ceil(f/da),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/zs|0,c[s]%=zs;for(r&&(c.unshift(r),++i),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=i,_a?ra(t,f):t}function sd(e,t,r){if(e!==~~e||e<t||e>r)throw Error(d0+e)}function Ju(e){var t,r,n,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)n=e[t]+"",r=da-n.length,r&&(s+=Rf(r)),s+=n;o=e[t],n=o+"",r=da-n.length,r&&(s+=Rf(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var zd=function(){function e(n,i){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*i+o,n[l]=s%zs|0,o=s/zs|0;return o&&n.unshift(o),n}function t(n,i,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=i[l]){c=n[l]>i[l]?1:-1;break}return c}function r(n,i,s){for(var o=0;s--;)n[s]-=o,o=n[s]<i[s]?1:0,n[s]=o*zs+n[s]-i[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,s,o){var l,c,u,d,f,h,p,m,g,y,b,v,w,S,k,j,A,L,P=n.constructor,B=n.s==i.s?1:-1,E=n.d,T=i.d;if(!n.s)return new P(n);if(!i.s)throw Error(Wc+"Division by zero");for(c=n.e-i.e,A=T.length,k=E.length,p=new P(B),m=p.d=[],u=0;T[u]==(E[u]||0);)++u;if(T[u]>(E[u]||0)&&--c,s==null?v=s=P.precision:o?v=s+(ws(n)-ws(i))+1:v=s,v<0)return new P(0);if(v=v/da+2|0,u=0,A==1)for(d=0,T=T[0],v++;(u<k||d)&&v--;u++)w=d*zs+(E[u]||0),m[u]=w/T|0,d=w%T|0;else{for(d=zs/(T[0]+1)|0,d>1&&(T=e(T,d),E=e(E,d),A=T.length,k=E.length),S=A,g=E.slice(0,A),y=g.length;y<A;)g[y++]=0;L=T.slice(),L.unshift(0),j=T[0],T[1]>=zs/2&&++j;do d=0,l=t(T,g,A,y),l<0?(b=g[0],A!=y&&(b=b*zs+(g[1]||0)),d=b/j|0,d>1?(d>=zs&&(d=zs-1),f=e(T,d),h=f.length,y=g.length,l=t(f,g,h,y),l==1&&(d--,r(f,A<h?L:T,h))):(d==0&&(l=d=1),f=T.slice()),h=f.length,h<y&&f.unshift(0),r(g,f,y),l==-1&&(y=g.length,l=t(T,g,A,y),l<1&&(d++,r(g,A<y?L:T,y))),y=g.length):l===0&&(d++,g=[0]),m[u++]=d,l&&g[0]?g[y++]=E[S]||0:(g=[E[S]],y=1);while((S++<k||g[0]!==void 0)&&v--)}return m[0]||m.shift(),p.e=c,ra(p,o?s+ws(p)+1:s)}}();function qH(e,t){var r,n,i,s,o,l,c=0,u=0,d=e.constructor,f=d.precision;if(ws(e)>16)throw Error(_E+ws(e));if(!e.s)return new d(Yl);for(_a=!1,l=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Uh(2,u))/Math.LN10*2+5|0,l+=n,r=i=s=new d(Yl),d.precision=l;;){if(i=ra(i.times(e),l),r=r.times(++c),o=s.plus(zd(i,r,l)),Ju(o.d).slice(0,l)===Ju(s.d).slice(0,l)){for(;u--;)s=ra(s.times(s),l);return d.precision=f,t==null?(_a=!0,ra(s,f)):s}s=o}}function ws(e){for(var t=e.e*da,r=e.d[0];r>=10;r/=10)t++;return t}function ij(e,t,r){if(t>e.LN10.sd())throw _a=!0,r&&(e.precision=r),Error(Wc+"LN10 precision limit exceeded");return ra(new e(e.LN10),t)}function Rf(e){for(var t="";e--;)t+="0";return t}function F1(e,t){var r,n,i,s,o,l,c,u,d,f=1,h=10,p=e,m=p.d,g=p.constructor,y=g.precision;if(p.s<1)throw Error(Wc+(p.s?"NaN":"-Infinity"));if(p.eq(Yl))return new g(0);if(t==null?(_a=!1,u=y):u=t,p.eq(10))return t==null&&(_a=!0),ij(g,u);if(u+=h,g.precision=u,r=Ju(m),n=r.charAt(0),s=ws(p),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Ju(p.d),n=r.charAt(0),f++;s=ws(p),n>1?(p=new g("0."+r),s++):p=new g(n+"."+r.slice(1))}else return c=ij(g,u+2,y).times(s+""),p=F1(new g(n+"."+r.slice(1)),u-h).plus(c),g.precision=y,t==null?(_a=!0,ra(p,y)):p;for(l=o=p=zd(p.minus(Yl),p.plus(Yl),u),d=ra(p.times(p),u),i=3;;){if(o=ra(o.times(d),u),c=l.plus(zd(o,new g(i),u)),Ju(c.d).slice(0,u)===Ju(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(ij(g,u+2,y).times(s+""))),l=zd(l,new g(f),u),g.precision=y,t==null?(_a=!0,ra(l,y)):l;l=c,i+=2}}function Z7(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=xg(r/da),e.d=[],n=(r+1)%da,r<0&&(n+=da),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=da;n<i;)e.d.push(+t.slice(n,n+=da));t=t.slice(n),n=da-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),_a&&(e.e>Fw||e.e<-Fw))throw Error(_E+r)}else e.s=0,e.e=0,e.d=[0];return e}function ra(e,t,r){var n,i,s,o,l,c,u,d,f=e.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=t-o,n<0)n+=da,i=t,u=f[d=0];else{if(d=Math.ceil((n+1)/da),s=f.length,d>=s)return e;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=da,i=n-da+o}if(r!==void 0&&(s=Uh(10,o-i-1),l=u/s%10|0,c=t<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?i>0?u/Uh(10,o-i):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(s=ws(e),f.length=1,t=t-s-1,f[0]=Uh(10,(da-t%da)%da),e.e=xg(-t/da)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=Uh(10,da-n),f[d]=i>0?(u/Uh(10,o-i)%Uh(10,i)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==zs&&(f[0]=1,++e.e);break}else{if(f[d]+=s,f[d]!=zs)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(_a&&(e.e>Fw||e.e<-Fw))throw Error(_E+ws(e));return e}function HH(e,t){var r,n,i,s,o,l,c,u,d,f,h=e.constructor,p=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),_a?ra(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),i=Math.max(Math.ceil(p/da),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=c.length,l=f.length,d=i<l,d&&(l=i),i=0;i<l;i++)if(c[i]!=f[i]){d=c[i]<f[i];break}o=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,i=f.length-l;i>0;--i)c[l++]=0;for(i=f.length;i>o;){if(c[--i]<f[i]){for(s=i;s&&c[--s]===0;)c[s]=zs-1;--c[s],c[i]+=zs}c[i]-=f[i]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,_a?ra(t,p):t):new h(0)}function B0(e,t,r){var n,i=ws(e),s=Ju(e.d),o=s.length;return t?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+Rf(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Rf(-i-1)+s,r&&(n=r-o)>0&&(s+=Rf(n))):i>=o?(s+=Rf(i+1-o),r&&(n=r-i-1)>0&&(s=s+"."+Rf(n))):((n=i+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(s+="."),s+=Rf(n))),e.s<0?"-"+s:s}function eR(e,t){if(e.length>t)return e.length=t,!0}function VH(e){var t,r,n;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(d0+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Z7(o,s.toString())}else if(typeof s!="string")throw Error(d0+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,g5e.test(s))Z7(o,s);else throw Error(d0+s)}if(i.prototype=Tn,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=VH,i.config=i.set=x5e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function x5e(e){if(!e||typeof e!="object")throw Error(Wc+"Object expected");var t,r,n,i=["precision",1,gg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(xg(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(d0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(d0+r+": "+n);return this}var kE=VH(m5e);Yl=new kE(1);const Ui=kE;function GH(e){var t;return e===0?t=1:t=Math.floor(new Ui(e).abs().log(10).toNumber())+1,t}function KH(e,t,r){for(var n=new Ui(e),i=0,s=[];n.lt(t)&&i<1e5;)s.push(n.toNumber()),n=n.add(r),i++;return s}var YH=e=>{var[t,r]=e,[n,i]=[t,r];return t>r&&([n,i]=[r,t]),[n,i]},XH=(e,t,r)=>{if(e.lte(0))return new Ui(0);var n=GH(e.toNumber()),i=new Ui(10).pow(n),s=e.div(i),o=n!==1?.05:.1,l=new Ui(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(i);return t?new Ui(c.toNumber()):new Ui(Math.ceil(c.toNumber()))},y5e=(e,t,r)=>{var n=new Ui(1),i=new Ui(e);if(!i.isint()&&r){var s=Math.abs(e);s<1?(n=new Ui(10).pow(GH(e)-1),i=new Ui(Math.floor(i.div(n).toNumber())).mul(n)):s>1&&(i=new Ui(Math.floor(e)))}else e===0?i=new Ui(Math.floor((t-1)/2)):r||(i=new Ui(Math.floor(e)));for(var o=Math.floor((t-1)/2),l=[],c=0;c<t;c++)l.push(i.add(new Ui(c-o).mul(n)).toNumber());return l},QH=function(t,r,n,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Ui(0),tickMin:new Ui(0),tickMax:new Ui(0)};var o=XH(new Ui(r).sub(t).div(n-1),i,s),l;t<=0&&r>=0?l=new Ui(0):(l=new Ui(t).add(r).div(2),l=l.sub(new Ui(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),u=Math.ceil(new Ui(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?QH(t,r,n,i,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new Ui(c).mul(o)),tickMax:l.add(new Ui(u).mul(o))})},b5e=function(t){var[r,n]=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),[l,c]=YH([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...Array(i-1).fill(1/0)]:[...Array(i-1).fill(-1/0),c];return r>n?u.reverse():u}if(l===c)return y5e(l,i,s);var{step:d,tickMin:f,tickMax:h}=QH(l,c,o,s,0),p=KH(f,h.add(new Ui(.1).mul(d)),d);return r>n?p.reverse():p},v5e=function(t,r){var[n,i]=t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=YH([n,i]);if(o===-1/0||l===1/0)return[n,i];if(o===l)return[o];var c=Math.max(r,2),u=XH(new Ui(l).sub(o).div(c-1),s,0),d=[...KH(new Ui(o),new Ui(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>i?d.reverse():d},JH=e=>e.rootProps.maxBarSize,w5e=e=>e.rootProps.barGap,ZH=e=>e.rootProps.barCategoryGap,S5e=e=>e.rootProps.barSize,jy=e=>e.rootProps.stackOffset,eV=e=>e.rootProps.reverseStackOrder,jE=e=>e.options.chartName,AE=e=>e.rootProps.syncId,tV=e=>e.rootProps.syncMethod,NE=e=>e.options.eventEmitter,Pa={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Lh={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Fu={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},w_=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function S_(e,t,r){if(r!=="auto")return r;if(e!=null)return ff(e,t)?"category":"number"}function tR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Iw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tR(Object(r),!0).forEach(function(n){_5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _5e(e,t,r){return(t=k5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k5e(e){var t=j5e(e,"string");return typeof t=="symbol"?t:t+""}function j5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rR={allowDataOverflow:Lh.allowDataOverflow,allowDecimals:Lh.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Lh.angleAxisId,includeHidden:!1,name:void 0,reversed:Lh.reversed,scale:Lh.scale,tick:Lh.tick,tickCount:void 0,ticks:void 0,type:Lh.type,unit:void 0},nR={allowDataOverflow:Fu.allowDataOverflow,allowDecimals:Fu.allowDecimals,allowDuplicatedCategory:Fu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Fu.radiusAxisId,includeHidden:Fu.includeHidden,name:void 0,reversed:Fu.reversed,scale:Fu.scale,tick:Fu.tick,tickCount:Fu.tickCount,ticks:void 0,type:Fu.type,unit:void 0},A5e=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},CE=Jt([A5e,Fq],(e,t)=>{var r;if(e!=null)return e;var n=(r=S_(t,"angleAxis",rR.type))!==null&&r!==void 0?r:"category";return Iw(Iw({},rR),{},{type:n})}),N5e=(e,t)=>e.polarAxis.radiusAxis[t],EE=Jt([N5e,Fq],(e,t)=>{var r;if(e!=null)return e;var n=(r=S_(t,"radiusAxis",nR.type))!==null&&r!==void 0?r:"category";return Iw(Iw({},nR),{},{type:n})}),__=e=>e.polarOptions,TE=Jt([hf,pf,Ms],eH),rV=Jt([__,TE],(e,t)=>{if(e!=null)return Fo(e.innerRadius,t,0)}),nV=Jt([__,TE],(e,t)=>{if(e!=null)return Fo(e.outerRadius,t,t*.8)}),C5e=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},iV=Jt([__],C5e);Jt([CE,iV],w_);var aV=Jt([TE,rV,nV],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Jt([EE,aV],w_);var sV=Jt([Ci,__,rV,nV,hf,pf],(e,t,r,n,i,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=t;return{cx:Fo(o,i,i/2),cy:Fo(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Ra=(e,t)=>t,Ay=(e,t,r)=>r;function PE(e){return e==null?void 0:e.id}function oV(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:i,dataKey:s}=r,o=new Map;return e.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=PE(l);u.forEach((f,h)=>{var p=s==null||i?h:String(Ai(f,s,null)),m=Ai(f,l.dataKey,0),g;o.has(p)?g=o.get(p):g={},Object.assign(g,{[d]:m}),o.set(p,g)})}}),Array.from(o.values())}function k_(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var j_=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function A_(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function E5e(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var Xs=e=>{var t=Ci(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},yg=e=>e.tooltip.settings.axisId;function T5e(e){if(e in gx)return gx[e]();var t="scale".concat(py(e));if(t in gx)return gx[t]()}function iR(e){var t=e.ticks,r=e.bandwidth,n=e.range(),i=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:function(s){function o(){return s.apply(this,arguments)}return o.toString=function(){return s.toString()},o}(()=>i),rangeMin:()=>i[0],rangeMax:()=>i[1],isInRange(s){var o=i[0],l=i[1];return o<=l?s>=o&&s<=l:s>=l&&s<=o},bandwidth:r?()=>r.call(e):void 0,ticks:t?s=>t.call(e,s):void 0,map:(s,o)=>{var l=e(s);if(l!=null){if(e.bandwidth&&o!==null&&o!==void 0&&o.position){var c=e.bandwidth();switch(o.position){case"middle":l+=c/2;break;case"end":l+=c;break}}return l}}}}function aR(e,t,r){if(typeof e=="function")return iR(e.copy().domain(t).range(r));if(e!=null){var n=T5e(e);if(n!=null)return n.domain(t).range(r),iR(n)}}var lV=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!ef(t)){for(var r,n,i=0;i<t.length;i++){var s=t[i];di(s)&&((r===void 0||s<r)&&(r=s),(n===void 0||s>n)&&(n=s))}return r!==void 0&&n!==void 0?[r,n]:void 0}return t}default:return t}};function sR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Dw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sR(Object(r),!0).forEach(function(n){P5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P5e(e,t,r){return(t=O5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O5e(e){var t=M5e(e,"string");return typeof t=="symbol"?t:t+""}function M5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VA=[0,"auto"],Ds={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},cV=(e,t)=>e.cartesianAxis.xAxis[t],fd=(e,t)=>{var r=cV(e,t);return r??Ds},$s={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:VA,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:xy},uV=(e,t)=>e.cartesianAxis.yAxis[t],hd=(e,t)=>{var r=uV(e,t);return r??$s},Fd={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},OE=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Fd},Ka=(e,t,r)=>{switch(t){case"xAxis":return fd(e,r);case"yAxis":return hd(e,r);case"zAxis":return OE(e,r);case"angleAxis":return CE(e,r);case"radiusAxis":return EE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},L5e=(e,t,r)=>{switch(t){case"xAxis":return fd(e,r);case"yAxis":return hd(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},bg=(e,t,r)=>{switch(t){case"xAxis":return fd(e,r);case"yAxis":return hd(e,r);case"angleAxis":return CE(e,r);case"radiusAxis":return EE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},dV=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function ME(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Ny=e=>e.graphicalItems.cartesianItems,R5e=Jt([Ra,Ay],ME),LE=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),Cy=Jt([Ny,Ka,R5e],LE,{memoizeOptions:{resultEqualityCheck:A_}}),fV=Jt([Cy],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(k_)),hV=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),B5e=Jt([Cy],hV),RE=e=>e.map(t=>t.data).filter(Boolean).flat(1),F5e=Jt([Cy],RE,{memoizeOptions:{resultEqualityCheck:A_}}),BE=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=t;return e.length>0?e:r.slice(n,i+1)},FE=Jt([F5e,v_],BE),IE=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Ai(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(i=>({value:Ai(i,n)}))):e.map(n=>({value:n})),N_=Jt([FE,Ka,Cy],IE);function pV(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function t2(e){if(Uc(e)||e instanceof Date){var t=Number(e);if(di(t))return t}}function oR(e){if(Array.isArray(e)){var t=[t2(e[0]),t2(e[1])];return ef(t)?t:void 0}var r=t2(e);if(r!=null)return[r,r]}function tf(e){return e.map(t2).filter(vl)}function I5e(e,t,r){return!r||typeof t!="number"||id(t)?[]:r.length?tf(r.flatMap(n=>{var i=Ai(e,n.dataKey),s,o;if(Array.isArray(i)?[s,o]=i:s=o=i,!(!di(s)||!di(o)))return[t-s,t+o]})):[]}var Bs=e=>{var t=Xs(e),r=yg(e);return bg(e,t,r)},Ey=Jt([Bs],e=>e==null?void 0:e.dataKey),D5e=Jt([fV,v_,Bs],oV),mV=(e,t,r,n)=>{var i={},s=t.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},i);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(PE);return[l,{stackedData:pve(e,d,r),graphicalItems:u}]}))},GA=Jt([D5e,fV,jy,eV],mV),gV=(e,t,r,n)=>{var{dataStartIndex:i,dataEndIndex:s}=t;if(n==null&&r!=="zAxis"){var o=bve(e,i,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},$5e=Jt([Ka],e=>e.allowDataOverflow),DE=e=>{var t;if(e==null||!("domain"in e))return VA;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=tf(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:VA},$E=Jt([Ka],DE),UE=Jt([$E,$5e],UH),U5e=Jt([GA,gf,Ra,UE],gV,{memoizeOptions:{resultEqualityCheck:j_}}),C_=e=>e.errorBars,z5e=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>pV(r,n)),$w=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var s=i.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},zE=(e,t,r,n,i)=>{var s,o;if(r.length>0&&e.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(b=>pV(i,b)),h=Ai(l,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),p=I5e(l,h,f);if(p.length>=2){var m=Math.min(...p),g=Math.max(...p);(s==null||m<s)&&(s=m),(o==null||g>o)&&(o=g)}var y=oR(h);y!=null&&(s=s==null?y[0]:Math.min(s,y[0]),o=o==null?y[1]:Math.max(o,y[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(l=>{var c=oR(Ai(l,t.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),di(s)&&di(o))return[s,o]},W5e=Jt([FE,Ka,B5e,C_,Ra],zE,{memoizeOptions:{resultEqualityCheck:j_}});function q5e(e){var{value:t}=e;if(Uc(t)||t instanceof Date)return t}var H5e=(e,t,r)=>{var n=e.map(q5e).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&pW(n))?oH(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},xV=e=>e.referenceElements.dots,vg=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),V5e=Jt([xV,Ra,Ay],vg),yV=e=>e.referenceElements.areas,G5e=Jt([yV,Ra,Ay],vg),bV=e=>e.referenceElements.lines,K5e=Jt([bV,Ra,Ay],vg),vV=(e,t)=>{if(e!=null){var r=tf(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},Y5e=Jt(V5e,Ra,vV),wV=(e,t)=>{if(e!=null){var r=tf(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},X5e=Jt([G5e,Ra],wV);function Q5e(e){var t;if(e.x!=null)return tf([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:tf(r)}function J5e(e){var t;if(e.y!=null)return tf([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:tf(r)}var SV=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?Q5e(n):J5e(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},Z5e=Jt([K5e,Ra],SV),eke=Jt(Y5e,Z5e,X5e,(e,t,r)=>$w(e,r,t)),WE=(e,t,r,n,i,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?$w(n,s,i):$w(s,i);return p5e(t,u,e.allowDataOverflow)},tke=Jt([Ka,$E,UE,U5e,W5e,eke,Ci,Ra],WE,{memoizeOptions:{resultEqualityCheck:j_}}),rke=[0,1],qE=(e,t,r,n,i,s,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,u=ff(t,s);if(u&&l==null){var d;return oH(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?H5e(n,e,u):i==="expand"?rke:o}},HE=Jt([Ka,Ci,FE,N_,jy,Ra,tke],qE);function nke(e){return e in gx}var _V=(e,t,r)=>{if(e!=null){var{scale:n,type:i}=e;if(n==="auto")return i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!t)?"point":i==="category"?"band":"linear";if(typeof n=="string"){var s="scale".concat(py(n));return nke(s)?s:"point"}}},Eh=Jt([Ka,dV,jE],_V);function VE(e,t,r,n){if(!(r==null||n==null))return typeof e.scale=="function"?aR(e.scale,r,n):aR(t,r,n)}var GE=(e,t,r)=>{var n=DE(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&ef(e))return b5e(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&ef(e))return v5e(e,t.tickCount,t.allowDecimals)}},KE=Jt([HE,bg,Eh],GE),YE=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&ef(t)&&Array.isArray(r)&&r.length>0){var i,s,o=t[0],l=(i=r[0])!==null&&i!==void 0?i:0,c=t[1],u=(s=r[r.length-1])!==null&&s!==void 0?s:0;return[Math.min(o,l),Math.max(c,u)]}return t},ike=Jt([Ka,HE,KE,Ra],YE),ake=Jt(N_,Ka,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(tf(e.map(f=>f.value))).sort((f,h)=>f-h),i=n[0],s=n[n.length-1];if(i==null||s==null)return 1/0;var o=s-i;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),kV=Jt(ake,Ci,ZH,Ms,(e,t,r,n,i)=>i,(e,t,r,n,i)=>{if(!di(e))return 0;var s=t==="vertical"?n.height:n.width;if(i==="gap")return e*s/2;if(i==="no-gap"){var o=Fo(r,e*s),l=e*s/2;return l-o-(l-o)/s*o}return 0}),ske=(e,t,r)=>{var n=fd(e,t);return n==null||typeof n.padding!="string"?0:kV(e,"xAxis",t,r,n.padding)},oke=(e,t,r)=>{var n=hd(e,t);return n==null||typeof n.padding!="string"?0:kV(e,"yAxis",t,r,n.padding)},lke=Jt(fd,ske,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((n=i.right)!==null&&n!==void 0?n:0)+t}}),cke=Jt(hd,oke,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+t}}),uke=Jt([Ms,lke,o_,s_,(e,t,r)=>r],(e,t,r,n,i)=>{var{padding:s}=n;return i?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),dke=Jt([Ms,Ci,cke,o_,s_,(e,t,r)=>r],(e,t,r,n,i,s)=>{var{padding:o}=i;return s?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Ty=(e,t,r,n)=>{var i;switch(t){case"xAxis":return uke(e,r,n);case"yAxis":return dke(e,r,n);case"zAxis":return(i=OE(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return iV(e);case"radiusAxis":return aV(e,r);default:return}},jV=Jt([Ka,Ty],w_),fke=Jt([Eh,ike],lV),Km=Jt([Ka,Eh,fke,jV],VE);Jt([Cy,C_,Ra],z5e);function AV(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var E_=(e,t)=>t,T_=(e,t,r)=>r,hke=Jt(i_,E_,T_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(AV)),pke=Jt(a_,E_,T_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(AV)),NV=(e,t)=>({width:e.width,height:t.height}),mke=(e,t)=>{var r=typeof t.width=="number"?t.width:xy;return{width:r,height:e.height}},CV=Jt(Ms,fd,NV),gke=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},xke=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},yke=Jt(pf,Ms,hke,E_,T_,(e,t,r,n,i)=>{var s={},o;return r.forEach(l=>{var c=NV(t,l);o==null&&(o=gke(t,n,e));var u=n==="top"&&!i||n==="bottom"&&i;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),bke=Jt(hf,Ms,pke,E_,T_,(e,t,r,n,i)=>{var s={},o;return r.forEach(l=>{var c=mke(t,l);o==null&&(o=xke(t,n,e));var u=n==="left"&&!i||n==="right"&&i;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),vke=(e,t)=>{var r=fd(e,t);if(r!=null)return yke(e,r.orientation,r.mirror)},wke=Jt([Ms,fd,vke,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),Ske=(e,t)=>{var r=hd(e,t);if(r!=null)return bke(e,r.orientation,r.mirror)},_ke=Jt([Ms,hd,Ske,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),EV=Jt(Ms,hd,(e,t)=>{var r=typeof t.width=="number"?t.width:xy;return{width:r,height:e.height}}),lR=(e,t,r)=>{switch(t){case"xAxis":return CV(e,r).width;case"yAxis":return EV(e,r).height;default:return}},TV=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:s,dataKey:o}=r,l=ff(e,n),c=t.map(u=>u.value);if(o&&l&&s==="category"&&i&&pW(c))return c}},XE=Jt([Ci,N_,Ka,Ra],TV),PV=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:s}=r,o=ff(e,n);if(o&&(i==="number"||s!=="auto"))return t.map(l=>l.value)}},QE=Jt([Ci,N_,bg,Ra],PV),cR=Jt([Ci,L5e,Eh,Km,XE,QE,Ty,KE,Ra],(e,t,r,n,i,s,o,l,c)=>{if(t!=null){var u=ff(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:s,duplicateDomain:i,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}}),kke=(e,t,r,n,i,s,o,l,c)=>{if(!(t==null||n==null)){var u=ff(e,c),{type:d,ticks:f,tickCount:h}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/p:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Gs(s[0]-s[1])*2*m:m;var g=f||i;return g?g.map((y,b)=>{var v=o?o.indexOf(y):y,w=n.map(v);return di(w)?{index:b,coordinate:w+m,value:y,offset:m}:null}).filter(vl):u&&l?l.map((y,b)=>{var v=n.map(y);return di(v)?{coordinate:v+m,value:y,index:b,offset:m}:null}).filter(vl):n.ticks?n.ticks(h).map((y,b)=>{var v=n.map(y);return di(v)?{coordinate:v+m,value:y,index:b,offset:m}:null}).filter(vl):n.domain().map((y,b)=>{var v=n.map(y);return di(v)?{coordinate:v+m,value:o?o[y]:y,index:b,offset:m}:null}).filter(vl)}},OV=Jt([Ci,bg,Eh,Km,KE,Ty,XE,QE,Ra],kke),jke=(e,t,r,n,i,s,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=ff(e,o),{tickCount:c}=t,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Gs(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>{var h=r.map(d);return di(h)?{coordinate:h+u,value:d,index:f,offset:u}:null}).filter(vl):r.ticks?r.ticks(c).map((d,f)=>{var h=r.map(d);return di(h)?{coordinate:h+u,value:d,index:f,offset:u}:null}).filter(vl):r.domain().map((d,f)=>{var h=r.map(d);return di(h)?{coordinate:h+u,value:i?i[d]:d,index:f,offset:u}:null}).filter(vl)}},od=Jt([Ci,bg,Km,Ty,XE,QE,Ra],jke),ld=Jt(Ka,Km,(e,t)=>{if(!(e==null||t==null))return Dw(Dw({},e),{},{scale:t})}),Ake=Jt([Ka,Eh,HE,jV],VE),Nke=Jt((e,t,r)=>OE(e,r),Ake,(e,t)=>{if(!(e==null||t==null))return Dw(Dw({},e),{},{scale:t})}),Cke=Jt([Ci,i_,a_],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),MV=e=>e.options.defaultTooltipEventType,LV=e=>e.options.validateTooltipEventTypes;function RV(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function JE(e,t){var r=MV(e),n=LV(e);return RV(t,r,n)}function Eke(e){return wn(t=>JE(t,e))}var BV=(e,t)=>{var r,n=Number(t);if(!(id(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},Tke=e=>e.tooltip.settings,Df={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},Pke={itemInteraction:{click:Df,hover:Df},axisInteraction:{click:Df,hover:Df},keyboardInteraction:Df,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},FV=Pl({name:"tooltip",initialState:Pke,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:wa()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,i=pu(e).tooltipItemPayloads.indexOf(r);i>-1&&(e.tooltipItemPayloads[i]=n)},prepare:wa()},removeTooltipEntrySettings:{reducer(e,t){var r=pu(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:wa()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:Oke,replaceTooltipEntrySettings:Mke,removeTooltipEntrySettings:Lke,setTooltipSettingsState:Rke,setActiveMouseOverItemIndex:IV,mouseLeaveItem:Bke,mouseLeaveChart:DV,setActiveClickItemIndex:Fke,setMouseOverAxisIndex:$V,setMouseClickAxisIndex:Ike,setSyncInteraction:KA,setKeyboardInteraction:YA}=FV.actions,Dke=FV.reducer;function uR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uR(Object(r),!0).forEach(function(n){$ke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $ke(e,t,r){return(t=Uke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uke(e){var t=zke(e,"string");return typeof t=="symbol"?t:t+""}function zke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wke(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function qke(e){return e.index!=null}var UV=(e,t,r,n)=>{if(t==null)return Df;var i=Wke(e,t,r);if(i==null)return Df;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(qke(i)){if(s)return pv(pv({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return pv(pv({},Df),{},{coordinate:i.coordinate})};function Hke(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function Vke(e,t){var r=Hke(e),n=t[0],i=t[1];if(r===void 0)return!1;var s=Math.min(n,i),o=Math.max(n,i);return r>=s&&r<=o}function Gke(e,t,r){if(r==null||t==null)return!0;var n=Ai(e,t);return n==null||!ef(r)?!0:Vke(n,r)}var ZE=(e,t,r,n)=>{var i=e==null?void 0:e.index;if(i==null)return null;var s=Number(i);if(!di(s))return i;var o=0,l=1/0;t.length>0&&(l=t.length-1);var c=Math.max(o,Math.min(s,l)),u=t[c];return u==null||Gke(u,r,n)?String(c):null},zV=(e,t,r,n,i,s,o)=>{if(s!=null){var l=o[0],c=l==null?void 0:l.getPosition(s);if(c!=null)return c;var u=i==null?void 0:i[Number(s)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:u.coordinate}}}},WV=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;if(r==="hover"?i=e.itemInteraction.hover.graphicalItemId:i=e.itemInteraction.click.graphicalItemId,i==null&&n!=null){var s=e.tooltipItemPayloads[0];return s!=null?[s]:[]}return e.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===i})},qV=e=>e.options.tooltipPayloadSearcher,wg=e=>e.tooltip;function dR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dR(Object(r),!0).forEach(function(n){Kke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kke(e,t,r){return(t=Yke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Yke(e){var t=Xke(e,"string");return typeof t=="symbol"?t:t+""}function Xke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Qke(e,t){return e??t}var HV=(e,t,r,n,i,s,o)=>{if(!(t==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((h,p)=>{var m,{dataDefinedOnItem:g,settings:y}=p,b=Qke(g,l),v=Array.isArray(b)?kq(b,u,d):b,w=(m=y==null?void 0:y.dataKey)!==null&&m!==void 0?m:n,S=y==null?void 0:y.nameKey,k;if(n&&Array.isArray(v)&&!Array.isArray(v[0])&&o==="axis"?k=mW(v,n,i):k=s(v,t,c,S),Array.isArray(k))k.forEach(A=>{var L=fR(fR({},y),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});h.push(yL({tooltipEntrySettings:L,dataKey:A.dataKey,payload:A.payload,value:Ai(A.payload,A.dataKey),name:A.name}))});else{var j;h.push(yL({tooltipEntrySettings:y,dataKey:w,payload:k,value:Ai(k,w),name:(j=Ai(k,S))!==null&&j!==void 0?j:y==null?void 0:y.name}))}return h},f)}},e6=Jt([Bs,dV,jE],_V),Jke=Jt([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Zke=Jt([Xs,yg],ME),Sg=Jt([Jke,Bs,Zke],LE,{memoizeOptions:{resultEqualityCheck:A_}}),eje=Jt([Sg],e=>e.filter(k_)),tje=Jt([Sg],RE,{memoizeOptions:{resultEqualityCheck:A_}}),_g=Jt([tje,gf],BE),rje=Jt([eje,gf,Bs],oV),t6=Jt([_g,Bs,Sg],IE),VV=Jt([Bs],DE),nje=Jt([Bs],e=>e.allowDataOverflow),GV=Jt([VV,nje],UH),ije=Jt([Sg],e=>e.filter(k_)),aje=Jt([rje,ije,jy,eV],mV),sje=Jt([aje,gf,Xs,GV],gV),oje=Jt([Sg],hV),lje=Jt([_g,Bs,oje,C_,Xs],zE,{memoizeOptions:{resultEqualityCheck:j_}}),cje=Jt([xV,Xs,yg],vg),uje=Jt([cje,Xs],vV),dje=Jt([yV,Xs,yg],vg),fje=Jt([dje,Xs],wV),hje=Jt([bV,Xs,yg],vg),pje=Jt([hje,Xs],SV),mje=Jt([uje,pje,fje],$w),gje=Jt([Bs,VV,GV,sje,lje,mje,Ci,Xs],WE),Py=Jt([Bs,Ci,_g,t6,jy,Xs,gje],qE),xje=Jt([Py,Bs,e6],GE),yje=Jt([Bs,Py,xje,Xs],YE),KV=e=>{var t=Xs(e),r=yg(e),n=!1;return Ty(e,t,r,n)},YV=Jt([Bs,KV],w_),XV=Jt([Bs,e6,yje,YV],VE),bje=Jt([Ci,t6,Bs,Xs],TV),vje=Jt([Ci,t6,Bs,Xs],PV),wje=(e,t,r,n,i,s,o,l)=>{if(t){var{type:c}=t,u=ff(e,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Gs(i[0]-i[1])*2*f:f,u&&o?o.map((h,p)=>{var m=n.map(h);return di(m)?{coordinate:m+f,value:h,index:p,offset:f}:null}).filter(vl):n.domain().map((h,p)=>{var m=n.map(h);return di(m)?{coordinate:m+f,value:s?s[h]:h,index:p,offset:f}:null}).filter(vl)}}},xf=Jt([Ci,Bs,e6,XV,KV,bje,vje,Xs],wje),r6=Jt([MV,LV,Tke],(e,t,r)=>RV(r.shared,e,t)),QV=e=>e.tooltip.settings.trigger,n6=e=>e.tooltip.settings.defaultIndex,Oy=Jt([wg,r6,QV,n6],UV),rf=Jt([Oy,_g,Ey,Py],ZE),JV=Jt([xf,rf],BV),i6=Jt([Oy],e=>{if(e)return e.dataKey}),Sje=Jt([Oy],e=>{if(e)return e.graphicalItemId}),ZV=Jt([wg,r6,QV,n6],WV),_je=Jt([hf,pf,Ci,Ms,xf,n6,ZV],zV),kje=Jt([Oy,_je],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),jje=Jt([Oy],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),Aje=Jt([ZV,rf,gf,Ey,JV,qV,r6],HV),Nje=Jt([Aje],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function hR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function pR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hR(Object(r),!0).forEach(function(n){Cje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cje(e,t,r){return(t=Eje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eje(e){var t=Tje(e,"string");return typeof t=="symbol"?t:t+""}function Tje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Pje=()=>wn(Bs),Oje=()=>{var e=Pje(),t=wn(xf),r=wn(XV);return zm(!e||!r?void 0:pR(pR({},e),{},{scale:r}),t)};function mR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ep(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mR(Object(r),!0).forEach(function(n){Mje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Mje(e,t,r){return(t=Lje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lje(e){var t=Rje(e,"string");return typeof t=="symbol"?t:t+""}function Rje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bje=(e,t,r,n)=>{var i=t.find(s=>s&&s.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:i.coordinate}}return{x:0,y:0}},Fje=(e,t,r,n)=>{var i=t.find(u=>u&&u.index===r);if(i){if(e==="centric"){var s=i.coordinate,{radius:o}=n;return Ep(Ep(Ep({},n),vs(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=i.coordinate,{angle:c}=n;return Ep(Ep(Ep({},n),vs(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function Ije(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var eG=(e,t,r,n,i)=>{var s,o=(s=t==null?void 0:t.length)!==null&&s!==void 0?s:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,h,p=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,g=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(h=r[l+1])===null||h===void 0?void 0:h.coordinate,y=void 0;if(!(p==null||m==null||g==null))if(Gs(m-p)!==Gs(g-m)){var b=[];if(Gs(g-m)===Gs(i[1]-i[0])){y=g;var v=m+i[1]-i[0];b[0]=Math.min(v,(v+p)/2),b[1]=Math.max(v,(v+p)/2)}else{y=p;var w=g+i[1]-i[0];b[0]=Math.min(m,(w+m)/2),b[1]=Math.max(m,(w+m)/2)}var S=[Math.min(m,(y+m)/2),Math.max(m,(y+m)/2)];if(e>S[0]&&e<=S[1]||e>=b[0]&&e<=b[1]){var k;return(k=r[l])===null||k===void 0?void 0:k.index}}else{var j=Math.min(p,g),A=Math.max(p,g);if(e>(j+m)/2&&e<=(A+m)/2){var L;return(L=r[l])===null||L===void 0?void 0:L.index}}}else if(t)for(var P=0;P<o;P++){var B=t[P];if(B!=null){var E=t[P+1],T=t[P-1];if(P===0&&E!=null&&e<=(B.coordinate+E.coordinate)/2||P===o-1&&T!=null&&e>(B.coordinate+T.coordinate)/2||P>0&&P<o-1&&T!=null&&E!=null&&e>(B.coordinate+T.coordinate)/2&&e<=(B.coordinate+E.coordinate)/2)return B.index}}return-1},Dje=()=>wn(jE),a6=(e,t)=>t,tG=(e,t,r)=>r,s6=(e,t,r,n)=>n,$je=Jt(xf,e=>KS(e,t=>t.coordinate)),o6=Jt([wg,a6,tG,s6],UV),l6=Jt([o6,_g,Ey,Py],ZE),Uje=(e,t,r)=>{if(t!=null){var n=wg(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},rG=Jt([wg,a6,tG,s6],WV),Uw=Jt([hf,pf,Ci,Ms,xf,s6,rG],zV),zje=Jt([o6,Uw],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),nG=Jt([xf,l6],BV),Wje=Jt([rG,l6,gf,Ey,nG,qV,a6],HV),qje=Jt([o6,l6],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),Hje=(e,t,r,n,i,s,o)=>{if(!(!e||!r||!n||!i)&&Ije(e,o)){var l=vve(e,t),c=eG(l,s,i,r,n),u=Bje(t,i,c,e);return{activeIndex:String(c),activeCoordinate:u}}},Vje=(e,t,r,n,i,s,o)=>{if(!(!e||!n||!i||!s||!r)){var l=Mwe(e,r);if(l){var c=wve(l,t),u=eG(c,o,s,n,i),d=Fje(t,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},Gje=(e,t,r,n,i,s,o,l)=>{if(!(!e||!t||!n||!i||!s))return t==="horizontal"||t==="vertical"?Hje(e,t,n,i,s,o,l):Vje(e,t,r,n,i,s,o)},Kje=Jt(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),Yje=Jt(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(Pa)),r=Array.from(new Set(t));return r.sort((n,i)=>n-i)},{memoizeOptions:{resultEqualityCheck:E5e}});function gR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gR(Object(r),!0).forEach(function(n){Xje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xje(e,t,r){return(t=Qje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qje(e){var t=Jje(e,"string");return typeof t=="symbol"?t:t+""}function Jje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zje={},e4e={zIndexMap:Object.values(Pa).reduce((e,t)=>xR(xR({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),Zje)},t4e=new Set(Object.values(Pa));function r4e(e){return t4e.has(e)}var iG=Pl({name:"zIndex",initialState:e4e,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:wa()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!r4e(r)&&delete e.zIndexMap[r])},prepare:wa()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:i}=t.payload;e.zIndexMap[r]?i?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:i?void 0:n,panoramaElement:i?n:void 0}},prepare:wa()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:wa()}}}),{registerZIndexPortal:n4e,unregisterZIndexPortal:i4e,registerZIndexPortalElement:a4e,unregisterZIndexPortalElement:s4e}=iG.actions,o4e=iG.reducer;function xo(e){var{zIndex:t,children:r}=e,n=Kve(),i=n&&t!==void 0&&t!==0,s=Ls(),o=Yi();x.useLayoutEffect(()=>i?(o(n4e({zIndex:t})),()=>{o(i4e({zIndex:t}))}):np,[o,t,i]);var l=wn(c=>Kje(c,t,s));return i?l?Y1.createPortal(r,l):null:r}function XA(){return XA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},XA.apply(null,arguments)}function yR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yR(Object(r),!0).forEach(function(n){l4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function l4e(e,t,r){return(t=c4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c4e(e){var t=u4e(e,"string");return typeof t=="symbol"?t:t+""}function u4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function d4e(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return x.isValidElement(t)?x.cloneElement(t,n):x.createElement(r,n)}function f4e(e){var t,{coordinate:r,payload:n,index:i,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=e,f=r,h=n,p=i;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,g,y;if(d==="ScatterChart")m=f,g=G2e,y=Pa.cursorLine;else if(d==="BarChart")m=K2e(l,f,s,o),g=Zq,y=Pa.cursorRectangle;else if(l==="radial"&&xW(f)){var{cx:b,cy:v,radius:w,startAngle:S,endAngle:k}=tH(f);m={cx:b,cy:v,startAngle:S,endAngle:k,innerRadius:w,outerRadius:w},g=nH,y=Pa.cursorLine}else m={points:Fwe(l,f,s)},g=d_,y=Pa.cursorLine;var j=typeof c=="object"&&"className"in c?c.className:void 0,A=mv(mv(mv(mv({stroke:"#ccc",pointerEvents:"none"},s),m),gh(c)),{},{payload:h,payloadIndex:p,className:bi("recharts-tooltip-cursor",j)});return x.createElement(xo,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:y},x.createElement(d4e,{cursor:c,cursorComp:g,cursorProps:A}))}function h4e(e){var t=Oje(),r=Rq(),n=ip(),i=Dje();return t==null||r==null||n==null||i==null?null:x.createElement(f4e,XA({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:i}))}var aG=x.createContext(null),p4e=()=>x.useContext(aG),sG={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new i(d,f||c,h),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],p]:c._events[m].push(p):(c._events[m]=p,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,p=f.length,m=new Array(p);h<p;h++)m[h]=f[h].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,h,p,m){var g=r?r+u:u;if(!this._events[g])return!1;var y=this._events[g],b=arguments.length,v,w;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,h),!0;case 5:return y.fn.call(y.context,d,f,h,p),!0;case 6:return y.fn.call(y.context,d,f,h,p,m),!0}for(w=1,v=new Array(b-1);w<b;w++)v[w-1]=arguments[w];y.fn.apply(y.context,v)}else{var S=y.length,k;for(w=0;w<S;w++)switch(y[w].once&&this.removeListener(u,y[w].fn,void 0,!0),b){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,d);break;case 3:y[w].fn.call(y[w].context,d,f);break;case 4:y[w].fn.call(y[w].context,d,f,h);break;default:if(!v)for(k=1,v=new Array(b-1);k<b;k++)v[k-1]=arguments[k];y[w].fn.apply(y[w].context,v)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,h){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return o(this,p),this;var m=this._events[p];if(m.fn)m.fn===d&&(!h||m.once)&&(!f||m.context===f)&&o(this,p);else{for(var g=0,y=[],b=m.length;g<b;g++)(m[g].fn!==d||h&&!m[g].once||f&&m[g].context!==f)&&y.push(m[g]);y.length?this._events[p]=y.length===1?y[0]:y:o(this,p)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(sG);var m4e=sG.exports;const g4e=af(m4e);var I1=new g4e,QA="recharts.syncEvent.tooltip",bR="recharts.syncEvent.brush",P_=(e,t)=>{if(t&&Array.isArray(e)){var r=Number.parseInt(t,10);if(!id(r))return e[r]}},x4e={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},oG=Pl({name:"options",initialState:x4e,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),y4e=oG.reducer,{createEventEmitter:b4e}=oG.actions;function v4e(e){return e.tooltip.syncInteraction}var w4e={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},lG=Pl({name:"chartData",initialState:w4e,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:vR,setDataStartEndIndexes:S4e,setComputedData:CMe}=lG.actions,_4e=lG.reducer,k4e=["x","y"];function wR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Tp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wR(Object(r),!0).forEach(function(n){j4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function j4e(e,t,r){return(t=A4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function A4e(e){var t=N4e(e,"string");return typeof t=="symbol"?t:t+""}function N4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C4e(e,t){if(e==null)return{};var r,n,i=E4e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function E4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function T4e(){var e=wn(AE),t=wn(NE),r=Yi(),n=wn(tV),i=wn(xf),s=ip(),o=fg(),l=wn(c=>c.rootProps.className);x.useEffect(()=>{if(e==null)return np;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var h;if(o&&d!==null&&d!==void 0&&(h=d.payload)!==null&&h!==void 0&&h.coordinate&&d.payload.sourceViewBox){var p=d.payload.coordinate,{x:m,y:g}=p,y=C4e(p,k4e),{x:b,y:v,width:w,height:S}=d.payload.sourceViewBox,k=Tp(Tp({},y),{},{x:o.x+(w?(m-b)/w:0)*o.width,y:o.y+(S?(g-v)/S:0)*o.height});r(Tp(Tp({},d),{},{payload:Tp(Tp({},d.payload),{},{coordinate:k})}))}else r(d);return}if(i!=null){var j;if(typeof n=="function"){var A={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},L=n(i,A);j=i[L]}else n==="value"&&(j=i.find(se=>String(se.value)===d.payload.label));var{coordinate:P}=d.payload;if(j==null||d.payload.active===!1||P==null||o==null){r(KA({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:E}=P,T=Math.min(B,o.x+o.width),F=Math.min(E,o.y+o.height),W={x:s==="horizontal"?j.coordinate:T,y:s==="horizontal"?F:j.coordinate},z=KA({active:d.payload.active,coordinate:W,dataKey:d.payload.dataKey,index:String(j.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(z)}}};return I1.on(QA,c),()=>{I1.off(QA,c)}},[l,r,t,e,n,i,s,o])}function P4e(){var e=wn(AE),t=wn(NE),r=Yi();x.useEffect(()=>{if(e==null)return np;var n=(i,s,o)=>{t!==o&&e===i&&r(S4e(s))};return I1.on(bR,n),()=>{I1.off(bR,n)}},[r,t,e])}function O4e(){var e=Yi();x.useEffect(()=>{e(b4e())},[e]),T4e(),P4e()}function M4e(e,t,r,n,i,s){var o=wn(p=>Uje(p,e,t)),l=wn(NE),c=wn(AE),u=wn(tV),d=wn(v4e),f=d==null?void 0:d.active,h=fg();x.useEffect(()=>{if(!f&&c!=null&&l!=null){var p=KA({active:s,coordinate:r,dataKey:o,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:h,graphicalItemId:void 0});I1.emit(QA,c,p,l)}},[f,r,o,i,n,l,c,u,s,h])}function SR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function _R(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SR(Object(r),!0).forEach(function(n){L4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L4e(e,t,r){return(t=R4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R4e(e){var t=B4e(e,"string");return typeof t=="symbol"?t:t+""}function B4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F4e(e){return e.dataKey}function I4e(e,t){return x.isValidElement(e)?x.cloneElement(e,t):typeof e=="function"?x.createElement(e,t):x.createElement(A2e,t)}var kR=[],D4e={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function My(e){var t,r,n=ja(e,D4e),{active:i,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:h,position:p,reverseDirection:m,useTranslate3d:g,wrapperStyle:y,cursor:b,shared:v,trigger:w,defaultIndex:S,portal:k,axisId:j}=n,A=Yi(),L=typeof S=="number"?String(S):S;x.useEffect(()=>{A(Rke({shared:v,trigger:w,axisId:j,active:i,defaultIndex:L}))},[A,v,w,j,i,L]);var P=fg(),B=Kq(),E=Eke(v),{activeIndex:T,isActive:F}=(t=wn(q=>qje(q,E,w,L)))!==null&&t!==void 0?t:{},W=wn(q=>Wje(q,E,w,L)),z=wn(q=>nG(q,E,w,L)),se=wn(q=>zje(q,E,w,L)),de=W,U=p4e(),G=(r=i??F)!==null&&r!==void 0?r:!1,[re,X]=KW([de,G]),C=E==="axis"?z:void 0;M4e(E,w,se,C,T,G);var K=k??U;if(K==null||P==null||E==null)return null;var V=de??kR;G||(V=kR),u&&V.length&&(V=BW(V.filter(q=>q.value!=null&&(q.hide!==!0||n.includeHidden)),h,F4e));var R=V.length>0,J=x.createElement(M2e,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:G,coordinate:se,hasPayload:R,offset:f,position:p,reverseDirection:m,useTranslate3d:g,viewBox:P,wrapperStyle:y,lastBoundingBox:re,innerRef:X,hasPortalFromProps:!!k},I4e(c,_R(_R({},n),{},{payload:V,label:C,active:G,activeIndex:T,coordinate:se,accessibilityLayer:B})));return x.createElement(x.Fragment,null,Y1.createPortal(J,K),G&&x.createElement(h4e,{cursor:b,tooltipEventType:E,coordinate:se,payload:V,index:T}))}var op=e=>null;op.displayName="Cell";function $4e(e,t,r){return(t=U4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U4e(e){var t=z4e(e,"string");return typeof t=="symbol"?t:t+""}function z4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class W4e{constructor(t){$4e(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function jR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function q4e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jR(Object(r),!0).forEach(function(n){H4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H4e(e,t,r){return(t=V4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V4e(e){var t=G4e(e,"string");return typeof t=="symbol"?t:t+""}function G4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K4e={cacheSize:2e3,enableCache:!0},cG=q4e({},K4e),AR=new W4e(cG.cacheSize),Y4e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},NR="recharts_measurement_span";function X4e(e,t){var r=t.fontSize||"",n=t.fontFamily||"",i=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(s,"|").concat(o,"|").concat(l)}var CR=(e,t)=>{try{var r=document.getElementById(NR);r||(r=document.createElement("span"),r.setAttribute("id",NR),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,Y4e,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Dx=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||f_.isSsr)return{width:0,height:0};if(!cG.enableCache)return CR(t,r);var n=X4e(t,r),i=AR.get(n);if(i)return i;var s=CR(t,r);return AR.set(n,s),s},uG;function Q4e(e,t,r){return(t=J4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J4e(e){var t=Z4e(e,"string");return typeof t=="symbol"?t:t+""}function Z4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ER=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,TR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,eAe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,tAe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,rAe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},nAe=["cm","mm","pt","pc","in","Q","px"];function iAe(e){return nAe.includes(e)}var nm="NaN";function aAe(e,t){return e*rAe[t]}class co{static parse(t){var r,[,n,i]=(r=tAe.exec(t))!==null&&r!==void 0?r:[];return n==null?co.NaN:new co(parseFloat(n),i??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,id(t)&&(this.unit=""),r!==""&&!eAe.test(r)&&(this.num=NaN,this.unit=""),iAe(r)&&(this.num=aAe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new co(NaN,""):new co(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new co(NaN,""):new co(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new co(NaN,""):new co(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new co(NaN,""):new co(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return id(this.num)}}uG=co;Q4e(co,"NaN",new uG(NaN,""));function dG(e){if(e==null||e.includes(nm))return nm;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,i,s]=(r=ER.exec(t))!==null&&r!==void 0?r:[],o=co.parse(n??""),l=co.parse(s??""),c=i==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return nm;t=t.replace(ER,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,h]=(u=TR.exec(t))!==null&&u!==void 0?u:[],p=co.parse(d??""),m=co.parse(h??""),g=f==="+"?p.add(m):p.subtract(m);if(g.isNaN())return nm;t=t.replace(TR,g.toString())}return t}var PR=/\(([^()]*)\)/;function sAe(e){for(var t=e,r;(r=PR.exec(t))!=null;){var[,n]=r;t=t.replace(PR,dG(n))}return t}function oAe(e){var t=e.replace(/\s+/g,"");return t=sAe(t),t=dG(t),t}function lAe(e){try{return oAe(e)}catch{return nm}}function aj(e){var t=lAe(e.slice(5,-1));return t===nm?"":t}var cAe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],uAe=["dx","dy","angle","className","breakAll"];function JA(){return JA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JA.apply(null,arguments)}function OR(e,t){if(e==null)return{};var r,n,i=dAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function dAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var fG=/[ \f\n\r\t\v\u2028\u2029]+/,hG=e=>{var{children:t,breakAll:r,style:n}=e;try{var i=[];Gi(t)||(r?i=t.toString().split(""):i=t.toString().split(fG));var s=i.map(l=>({word:l,width:Dx(l,n).width})),o=r?0:Dx("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function fAe(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var pG=(e,t,r,n)=>e.reduce((i,s)=>{var{word:o,width:l}=s,c=i[i.length-1];if(c&&l!=null&&(t==null||n||c.width+l+r<Number(t)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};i.push(u)}return i},[]),mG=e=>e.reduce((t,r)=>t.width>r.width?t:r),hAe="",MR=(e,t,r,n,i,s,o,l)=>{var c=e.slice(0,t),u=hG({breakAll:r,style:n,children:c+hAe});if(!u)return[!1,[]];var d=pG(u.wordsWithComputedWidth,s,o,l),f=d.length>i||mG(d).width>Number(s);return[f,d]},pAe=(e,t,r,n,i)=>{var{maxLines:s,children:o,style:l,breakAll:c}=e,u=En(s),d=String(o),f=pG(t,n,r,i);if(!u||i)return f;var h=f.length>s||mG(f).width>Number(n);if(!h)return f;for(var p=0,m=d.length-1,g=0,y;p<=m&&g<=d.length-1;){var b=Math.floor((p+m)/2),v=b-1,[w,S]=MR(d,v,c,l,s,n,r,i),[k]=MR(d,b,c,l,s,n,r,i);if(!w&&!k&&(p=b+1),w&&k&&(m=b-1),!w&&k){y=S;break}g++}return y||f},LR=e=>{var t=Gi(e)?[]:e.toString().split(fG);return[{words:t,width:void 0}]},mAe=e=>{var{width:t,scaleToFit:r,children:n,style:i,breakAll:s,maxLines:o}=e;if((t||r)&&!f_.isSsr){var l,c,u=hG({breakAll:s,children:n,style:i});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return LR(n);return pAe({breakAll:s,children:n,maxLines:o,style:i},l,c,t,!!r)}return LR(n)},gG="#808080",gAe={angle:0,breakAll:!1,capHeight:"0.71em",fill:gG,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},O_=x.forwardRef((e,t)=>{var r=ja(e,gAe),{x:n,y:i,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=OR(r,cAe),h=x.useMemo(()=>mAe({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:p,dy:m,angle:g,className:y,breakAll:b}=f,v=OR(f,uAe);if(!Uc(n)||!Uc(i)||h.length===0)return null;var w=Number(n)+(En(p)?p:0),S=Number(i)+(En(m)?m:0);if(!di(w)||!di(S))return null;var k;switch(d){case"start":k=aj("calc(".concat(o,")"));break;case"middle":k=aj("calc(".concat((h.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:k=aj("calc(".concat(h.length-1," * -").concat(s,")"));break}var j=[],A=h[0];if(c&&A!=null){var L=A.width,{width:P}=f;j.push("scale(".concat(En(P)&&En(L)?P/L:1,")"))}return g&&j.push("rotate(".concat(g,", ").concat(w,", ").concat(S,")")),j.length&&(v.transform=j.join(" ")),x.createElement("text",JA({},$o(v),{ref:t,x:w,y:S,className:bi("recharts-text",y),textAnchor:u,fill:l.includes("url")?gG:l}),h.map((B,E)=>{var T=B.words.join(b?"":" ");return x.createElement("tspan",{x:w,dy:E===0?k:s,key:"".concat(T,"-").concat(E)},T)}))});O_.displayName="Text";function RR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Iu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RR(Object(r),!0).forEach(function(n){xAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xAe(e,t,r){return(t=yAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yAe(e){var t=bAe(e,"string");return typeof t=="symbol"?t:t+""}function bAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vAe=e=>{var{viewBox:t,position:r,offset:n=0,parentViewBox:i}=e,{x:s,y:o,height:l,upperWidth:c,lowerWidth:u}=KC(t),d=s,f=s+(c-u)/2,h=(d+f)/2,p=(c+u)/2,m=d+c/2,g=l>=0?1:-1,y=g*n,b=g>0?"end":"start",v=g>0?"start":"end",w=c>=0?1:-1,S=w*n,k=w>0?"end":"start",j=w>0?"start":"end",A=i;if(r==="top"){var L={x:d+c/2,y:o-y,horizontalAnchor:"middle",verticalAnchor:b};return A&&(L.height=Math.max(o-A.y,0),L.width=c),L}if(r==="bottom"){var P={x:f+u/2,y:o+l+y,horizontalAnchor:"middle",verticalAnchor:v};return A&&(P.height=Math.max(A.y+A.height-(o+l),0),P.width=u),P}if(r==="left"){var B={x:h-S,y:o+l/2,horizontalAnchor:k,verticalAnchor:"middle"};return A&&(B.width=Math.max(B.x-A.x,0),B.height=l),B}if(r==="right"){var E={x:h+p+S,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"};return A&&(E.width=Math.max(A.x+A.width-E.x,0),E.height=l),E}var T=A?{width:p,height:l}:{};return r==="insideLeft"?Iu({x:h+S,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"},T):r==="insideRight"?Iu({x:h+p-S,y:o+l/2,horizontalAnchor:k,verticalAnchor:"middle"},T):r==="insideTop"?Iu({x:d+c/2,y:o+y,horizontalAnchor:"middle",verticalAnchor:v},T):r==="insideBottom"?Iu({x:f+u/2,y:o+l-y,horizontalAnchor:"middle",verticalAnchor:b},T):r==="insideTopLeft"?Iu({x:d+S,y:o+y,horizontalAnchor:j,verticalAnchor:v},T):r==="insideTopRight"?Iu({x:d+c-S,y:o+y,horizontalAnchor:k,verticalAnchor:v},T):r==="insideBottomLeft"?Iu({x:f+S,y:o+l-y,horizontalAnchor:j,verticalAnchor:b},T):r==="insideBottomRight"?Iu({x:f+u-S,y:o+l-y,horizontalAnchor:k,verticalAnchor:b},T):r&&typeof r=="object"&&(En(r.x)||O0(r.x))&&(En(r.y)||O0(r.y))?Iu({x:s+Fo(r.x,p),y:o+Fo(r.y,l),horizontalAnchor:"end",verticalAnchor:"end"},T):Iu({x:m,y:o+l/2,horizontalAnchor:"middle",verticalAnchor:"middle"},T)},wAe=["labelRef"],SAe=["content"];function BR(e,t){if(e==null)return{};var r,n,i=_Ae(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function _Ae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function FR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function xx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FR(Object(r),!0).forEach(function(n){kAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kAe(e,t,r){return(t=jAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jAe(e){var t=AAe(e,"string");return typeof t=="symbol"?t:t+""}function AAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pd(){return Pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pd.apply(null,arguments)}var xG=x.createContext(null),yG=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:i,width:s,height:o,children:l}=e,c=x.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:i,width:s,height:o}),[t,r,n,i,s,o]);return x.createElement(xG.Provider,{value:c},l)},bG=()=>{var e=x.useContext(xG),t=fg();return e||(t?KC(t):void 0)},NAe=x.createContext(null),CAe=()=>{var e=x.useContext(NAe),t=wn(sV);return e||t},EAe=e=>{var{value:t,formatter:r}=e,n=Gi(e.children)?t:e.children;return typeof r=="function"?r(n):n},c6=e=>e!=null&&typeof e=="function",TAe=(e,t)=>{var r=Gs(t-e),n=Math.min(Math.abs(t-e),360);return r*n},PAe=(e,t,r,n,i)=>{var{offset:s,className:o}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:h,clockWise:p}=i,m=(u+d)/2,g=TAe(f,h),y=g>=0?1:-1,b,v;switch(t){case"insideStart":b=f+y*s,v=p;break;case"insideEnd":b=h-y*s,v=!p;break;case"end":b=h+y*s,v=p;break;default:throw new Error("Unsupported position ".concat(t))}v=g<=0?v:!v;var w=vs(l,c,m,b),S=vs(l,c,m,b+(v?1:-1)*359),k="M".concat(w.x,",").concat(w.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(v?0:1,`,
    `).concat(S.x,",").concat(S.y),j=Gi(e.id)?j1("recharts-radial-line-"):e.id;return x.createElement("text",Pd({},n,{dominantBaseline:"central",className:bi("recharts-radial-bar-label",o)}),x.createElement("defs",null,x.createElement("path",{id:j,d:k})),x.createElement("textPath",{xlinkHref:"#".concat(j)},r))},OAe=(e,t,r)=>{var{cx:n,cy:i,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=vs(n,i,o+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var h=(s+o)/2,{x:p,y:m}=vs(n,i,h,u);return{x:p,y:m,textAnchor:"middle",verticalAnchor:"middle"}},r2=e=>e!=null&&"cx"in e&&En(e.cx),MAe={angle:0,offset:5,zIndex:Pa.label,position:"middle",textBreakAll:!1};function LAe(e){if(!r2(e))return e;var{cx:t,cy:r,outerRadius:n}=e,i=n*2;return{x:t-n,y:r-n,width:i,upperWidth:i,lowerWidth:i,height:i}}function Bf(e){var t=ja(e,MAe),{viewBox:r,parentViewBox:n,position:i,value:s,children:o,content:l,className:c="",textBreakAll:u,labelRef:d}=t,f=CAe(),h=bG(),p=i==="center"?h:f??h,m,g,y;r==null?m=p:r2(r)?m=r:m=KC(r);var b=LAe(m);if(!m||Gi(s)&&Gi(o)&&!x.isValidElement(l)&&typeof l!="function")return null;var v=xx(xx({},t),{},{viewBox:m});if(x.isValidElement(l)){var{labelRef:w}=v,S=BR(v,wAe);return x.cloneElement(l,S)}if(typeof l=="function"){var{content:k}=v,j=BR(v,SAe);if(g=x.createElement(l,j),x.isValidElement(g))return g}else g=EAe(t);var A=$o(t);if(r2(m)){if(i==="insideStart"||i==="insideEnd"||i==="end")return PAe(t,i,g,A,m);y=OAe(m,t.offset,t.position)}else{if(!b)return null;var L=vAe({viewBox:b,position:i,offset:t.offset,parentViewBox:r2(n)?void 0:n});y=xx(xx({x:L.x,y:L.y,textAnchor:L.horizontalAnchor,verticalAnchor:L.verticalAnchor},L.width!==void 0?{width:L.width}:{}),L.height!==void 0?{height:L.height}:{})}return x.createElement(xo,{zIndex:t.zIndex},x.createElement(O_,Pd({ref:d,className:bi("recharts-label",c)},A,y,{textAnchor:fAe(A.textAnchor)?A.textAnchor:y.textAnchor,breakAll:u}),g))}Bf.displayName="Label";var RAe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?x.createElement(Bf,Pd({key:"label-implicit"},n)):Uc(e)?x.createElement(Bf,Pd({key:"label-implicit",value:e},n)):x.isValidElement(e)?e.type===Bf?x.cloneElement(e,xx({key:"label-implicit"},n)):x.createElement(Bf,Pd({key:"label-implicit",content:e},n)):c6(e)?x.createElement(Bf,Pd({key:"label-implicit",content:e},n)):e&&typeof e=="object"?x.createElement(Bf,Pd({},e,{key:"label-implicit"},n)):null};function vG(e){var{label:t,labelRef:r}=e,n=bG();return RAe(t,n,r)||null}var wG={},SG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(SG);var _G={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(_G);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SG,r=_G,n=HS;function i(s){if(n.isArrayLike(s))return t.last(r.toArray(s))}e.last=i})(wG);var BAe=wG.last;const FAe=af(BAe);var IAe=["valueAccessor"],DAe=["dataKey","clockWise","id","textBreakAll","zIndex"];function zw(){return zw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zw.apply(null,arguments)}function IR(e,t){if(e==null)return{};var r,n,i=$Ae(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function $Ae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UAe=e=>Array.isArray(e.value)?FAe(e.value):e.value,kG=x.createContext(void 0),u6=kG.Provider,jG=x.createContext(void 0),zAe=jG.Provider;function WAe(){return x.useContext(kG)}function qAe(){return x.useContext(jG)}function n2(e){var{valueAccessor:t=UAe}=e,r=IR(e,IAe),{dataKey:n,clockWise:i,id:s,textBreakAll:o,zIndex:l}=r,c=IR(r,DAe),u=WAe(),d=qAe(),f=u||d;return!f||!f.length?null:x.createElement(xo,{zIndex:l??Pa.label},x.createElement(ka,{className:"recharts-label-list"},f.map((h,p)=>{var m,g=Gi(n)?t(h,p):Ai(h.payload,n),y=Gi(s)?{}:{id:"".concat(s,"-").concat(p)};return x.createElement(Bf,zw({key:"label-".concat(p)},$o(h),c,y,{fill:(m=r.fill)!==null&&m!==void 0?m:h.fill,parentViewBox:h.parentViewBox,value:g,textBreakAll:o,viewBox:h.viewBox,index:p,zIndex:0}))})))}n2.displayName="LabelList";function M_(e){var{label:t}=e;return t?t===!0?x.createElement(n2,{key:"labelList-implicit"}):x.isValidElement(t)||c6(t)?x.createElement(n2,{key:"labelList-implicit",content:t}):typeof t=="object"?x.createElement(n2,zw({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function ZA(){return ZA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ZA.apply(null,arguments)}var AG=e=>{var{cx:t,cy:r,r:n,className:i}=e,s=bi("recharts-dot",i);return En(t)&&En(r)&&En(n)?x.createElement("circle",ZA({},sl(e),NC(e),{className:s,cx:t,cy:r,r:n})):null},NG=e=>e.graphicalItems.polarItems,HAe=Jt([Ra,Ay],ME),L_=Jt([NG,Ka,HAe],LE),VAe=Jt([L_],RE),R_=Jt([VAe,b_],BE),GAe=Jt([R_,Ka,L_],IE);Jt([R_,Ka,L_],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(i=>{var s,o=Ai(n,(s=t.dataKey)!==null&&s!==void 0?s:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Ai(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var DR=()=>{},KAe=Jt([R_,Ka,L_,C_,Ra],zE),YAe=Jt([Ka,$E,UE,DR,KAe,DR,Ci,Ra],WE),CG=Jt([Ka,Ci,R_,GAe,jy,Ra,YAe],qE),XAe=Jt([CG,bg,Eh],GE),QAe=Jt([Ka,CG,XAe,Ra],YE);Jt([Eh,QAe],lV);var JAe={radiusAxis:{},angleAxis:{}},EG=Pl({name:"polarAxis",initialState:JAe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:EMe,removeRadiusAxis:TMe,addAngleAxis:PMe,removeAngleAxis:OMe}=EG.actions,ZAe=EG.reducer;function TG(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function $R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function UR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$R(Object(r),!0).forEach(function(n){eNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$R(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eNe(e,t,r){return(t=tNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tNe(e){var t=rNe(e,"string");return typeof t=="symbol"?t:t+""}function rNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nNe=(e,t)=>t,d6=Jt([NG,nNe],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),iNe=[],f6=(e,t,r)=>(r==null?void 0:r.length)===0?iNe:r,PG=Jt([b_,d6,f6],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var i;if((t==null?void 0:t.data)!=null&&t.data.length>0?i=t.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(s=>UR(UR({},t.presentationProps),s.props))),i!=null)return i}}),aNe=Jt([PG,d6,f6],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,i)=>{var s,o=Ai(n,t.nameKey,t.name),l;return r!=null&&(s=r[i])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:Ah(o,t.dataKey),color:l,payload:n,type:t.legendType}})}),sNe=Jt([PG,d6,f6,Ms],(e,t,r,n)=>{if(!(t==null||e==null))return l3e({offset:n,pieSettings:t,displayedData:e,cells:r})}),OG={exports:{}},Hi={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qs=typeof Symbol=="function"&&Symbol.for,h6=Qs?Symbol.for("react.element"):60103,p6=Qs?Symbol.for("react.portal"):60106,B_=Qs?Symbol.for("react.fragment"):60107,F_=Qs?Symbol.for("react.strict_mode"):60108,I_=Qs?Symbol.for("react.profiler"):60114,D_=Qs?Symbol.for("react.provider"):60109,$_=Qs?Symbol.for("react.context"):60110,m6=Qs?Symbol.for("react.async_mode"):60111,U_=Qs?Symbol.for("react.concurrent_mode"):60111,z_=Qs?Symbol.for("react.forward_ref"):60112,W_=Qs?Symbol.for("react.suspense"):60113,oNe=Qs?Symbol.for("react.suspense_list"):60120,q_=Qs?Symbol.for("react.memo"):60115,H_=Qs?Symbol.for("react.lazy"):60116,lNe=Qs?Symbol.for("react.block"):60121,cNe=Qs?Symbol.for("react.fundamental"):60117,uNe=Qs?Symbol.for("react.responder"):60118,dNe=Qs?Symbol.for("react.scope"):60119;function cc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case h6:switch(e=e.type,e){case m6:case U_:case B_:case I_:case F_:case W_:return e;default:switch(e=e&&e.$$typeof,e){case $_:case z_:case H_:case q_:case D_:return e;default:return t}}case p6:return t}}}function MG(e){return cc(e)===U_}Hi.AsyncMode=m6;Hi.ConcurrentMode=U_;Hi.ContextConsumer=$_;Hi.ContextProvider=D_;Hi.Element=h6;Hi.ForwardRef=z_;Hi.Fragment=B_;Hi.Lazy=H_;Hi.Memo=q_;Hi.Portal=p6;Hi.Profiler=I_;Hi.StrictMode=F_;Hi.Suspense=W_;Hi.isAsyncMode=function(e){return MG(e)||cc(e)===m6};Hi.isConcurrentMode=MG;Hi.isContextConsumer=function(e){return cc(e)===$_};Hi.isContextProvider=function(e){return cc(e)===D_};Hi.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===h6};Hi.isForwardRef=function(e){return cc(e)===z_};Hi.isFragment=function(e){return cc(e)===B_};Hi.isLazy=function(e){return cc(e)===H_};Hi.isMemo=function(e){return cc(e)===q_};Hi.isPortal=function(e){return cc(e)===p6};Hi.isProfiler=function(e){return cc(e)===I_};Hi.isStrictMode=function(e){return cc(e)===F_};Hi.isSuspense=function(e){return cc(e)===W_};Hi.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===B_||e===U_||e===I_||e===F_||e===W_||e===oNe||typeof e=="object"&&e!==null&&(e.$$typeof===H_||e.$$typeof===q_||e.$$typeof===D_||e.$$typeof===$_||e.$$typeof===z_||e.$$typeof===cNe||e.$$typeof===uNe||e.$$typeof===dNe||e.$$typeof===lNe)};Hi.typeOf=cc;OG.exports=Hi;var fNe=OG.exports,zR=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",WR=null,sj=null,LG=e=>{if(e===WR&&Array.isArray(sj))return sj;var t=[];return x.Children.forEach(e,r=>{Gi(r)||(fNe.isFragment(r)?t=t.concat(LG(r.props.children)):t.push(r))}),sj=t,WR=e,t};function V_(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(i=>zR(i)):n=[zR(t)],LG(e).forEach(i=>{var s=P0(i,"type.displayName")||P0(i,"type.name");s&&n.indexOf(s)!==-1&&r.push(i)}),r}var RG=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,BG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var i;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((i=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&i.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(BG);var hNe=BG.isPlainObject;const pNe=af(hNe);var qR,HR,VR,GR,KR;function YR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function XR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YR(Object(r),!0).forEach(function(n){mNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mNe(e,t,r){return(t=gNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gNe(e){var t=xNe(e,"string");return typeof t=="symbol"?t:t+""}function xNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ww(){return Ww=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ww.apply(null,arguments)}function tx(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var QR=(e,t,r,n,i)=>{var s=r-n,o;return o=za(qR||(qR=tx(["M ",",",""])),e,t),o+=za(HR||(HR=tx(["L ",",",""])),e+r,t),o+=za(VR||(VR=tx(["L ",",",""])),e+r-s/2,t+i),o+=za(GR||(GR=tx(["L ",",",""])),e+r-s/2-n,t+i),o+=za(KR||(KR=tx(["L ",","," Z"])),e,t),o},yNe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},bNe=e=>{var t=ja(e,yNe),{x:r,y:n,upperWidth:i,lowerWidth:s,height:o,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=t,h=x.useRef(null),[p,m]=x.useState(-1),g=x.useRef(i),y=x.useRef(s),b=x.useRef(o),v=x.useRef(r),w=x.useRef(n),S=pg(e,"trapezoid-");if(x.useEffect(()=>{if(h.current&&h.current.getTotalLength)try{var W=h.current.getTotalLength();W&&m(W)}catch{}},[]),r!==+r||n!==+n||i!==+i||s!==+s||o!==+o||i===0&&s===0||o===0)return null;var k=bi("recharts-trapezoid",l);if(!f)return x.createElement("g",null,x.createElement("path",Ww({},$o(t),{className:k,d:QR(r,n,i,s,o)})));var j=g.current,A=y.current,L=b.current,P=v.current,B=w.current,E="0px ".concat(p===-1?1:p,"px"),T="".concat(p,"px 0px"),F=Yq(["strokeDasharray"],u,c);return x.createElement(hg,{animationId:S,key:S,canBegin:p>0,duration:u,easing:c,isActive:f,begin:d},W=>{var z=Vi(j,i,W),se=Vi(A,s,W),de=Vi(L,o,W),U=Vi(P,r,W),G=Vi(B,n,W);h.current&&(g.current=z,y.current=se,b.current=de,v.current=U,w.current=G);var re=W>0?{transition:F,strokeDasharray:T}:{strokeDasharray:E};return x.createElement("path",Ww({},$o(t),{className:k,d:QR(U,G,z,se,de),ref:h,style:XR(XR({},re),t.style)}))})},vNe=["option","shapeType","activeClassName"];function wNe(e,t){if(e==null)return{};var r,n,i=SNe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function SNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function JR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function qw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JR(Object(r),!0).forEach(function(n){_Ne(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Ne(e,t,r){return(t=kNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kNe(e){var t=jNe(e,"string");return typeof t=="symbol"?t:t+""}function jNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ANe(e,t){return qw(qw({},t),e)}function NNe(e,t){return e==="symbols"}function ZR(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return x.createElement(Zq,r);case"trapezoid":return x.createElement(bNe,r);case"sector":return x.createElement(nH,r);case"symbols":if(NNe(t))return x.createElement(qS,r);break;case"curve":return x.createElement(d_,r);default:return null}}function CNe(e){return x.isValidElement(e)?e.props:e}function D1(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,i=wNe(e,vNe),s;if(x.isValidElement(t))s=x.cloneElement(t,qw(qw({},i),CNe(t)));else if(typeof t=="function")s=t(i,i.index);else if(pNe(t)&&typeof t!="boolean"){var o=ANe(t,i);s=x.createElement(ZR,{shapeType:r,elementProps:o})}else{var l=i;s=x.createElement(ZR,{shapeType:r,elementProps:l})}return i.isActive?x.createElement(ka,{className:n},s):s}var G_=(e,t,r)=>{var n=Yi();return(i,s)=>o=>{e==null||e(i,s,o),n(IV({activeIndex:String(s),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}},K_=e=>{var t=Yi();return(r,n)=>i=>{e==null||e(r,n,i),t(Bke())}},Y_=(e,t,r)=>{var n=Yi();return(i,s)=>o=>{e==null||e(i,s,o),n(Fke({activeIndex:String(s),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}};function X_(e){var{tooltipEntrySettings:t}=e,r=Yi(),n=Ls(),i=x.useRef(null);return x.useLayoutEffect(()=>{n||(i.current===null?r(Oke(t)):i.current!==t&&r(Mke({prev:i.current,next:t})),i.current=t)},[t,r,n]),x.useLayoutEffect(()=>()=>{i.current&&(r(Lke(i.current)),i.current=null)},[r]),null}function g6(e){var{legendPayload:t}=e,r=Yi(),n=Ls(),i=x.useRef(null);return x.useLayoutEffect(()=>{n||(i.current===null?r(Hq(t)):i.current!==t&&r(Vq({prev:i.current,next:t})),i.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{i.current&&(r(Gq(i.current)),i.current=null)},[r]),null}function ENe(e){var{legendPayload:t}=e,r=Yi(),n=wn(Ci),i=x.useRef(null);return x.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(i.current===null?r(Hq(t)):i.current!==t&&r(Vq({prev:i.current,next:t})),i.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{i.current&&(r(Gq(i.current)),i.current=null)},[r]),null}var oj,TNe=()=>{var[e]=x.useState(()=>j1("uid-"));return e},PNe=(oj=pF.useId)!==null&&oj!==void 0?oj:TNe;function ONe(e,t){var r=PNe();return t||(e?"".concat(e,"-").concat(r):r)}var MNe=x.createContext(void 0),Q_=e=>{var{id:t,type:r,children:n}=e,i=ONe("recharts-".concat(r),t);return x.createElement(MNe.Provider,{value:i},n(i))},LNe={cartesianItems:[],polarItems:[]},FG=Pl({name:"graphicalItems",initialState:LNe,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:wa()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,i=pu(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=n)},prepare:wa()},removeCartesianGraphicalItem:{reducer(e,t){var r=pu(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:wa()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:wa()},removePolarGraphicalItem:{reducer(e,t){var r=pu(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:wa()}}}),{addCartesianGraphicalItem:RNe,replaceCartesianGraphicalItem:BNe,removeCartesianGraphicalItem:FNe,addPolarGraphicalItem:INe,removePolarGraphicalItem:DNe}=FG.actions,$Ne=FG.reducer,UNe=e=>{var t=Yi(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(RNe(e)):r.current!==e&&t(BNe({prev:r.current,next:e})),r.current=e},[t,e]),x.useLayoutEffect(()=>()=>{r.current&&(t(FNe(r.current)),r.current=null)},[t]),null},x6=x.memo(UNe);function zNe(e){var t=Yi();return x.useLayoutEffect(()=>(t(INe(e)),()=>{t(DNe(e))}),[t,e]),null}var WNe=["key"],qNe=["onMouseEnter","onClick","onMouseLeave"],HNe=["id"],VNe=["id"];function eB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eB(Object(r),!0).forEach(function(n){GNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GNe(e,t,r){return(t=KNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KNe(e){var t=YNe(e,"string");return typeof t=="symbol"?t:t+""}function YNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xh(){return xh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xh.apply(null,arguments)}function J_(e,t){if(e==null)return{};var r,n,i=XNe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function XNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function QNe(e){var t=x.useMemo(()=>V_(e.children,op),[e.children]),r=wn(n=>aNe(n,e.id,t));return r==null?null:x.createElement(ENe,{legendPayload:r})}var JNe=x.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:i,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:n.map(h=>h.tooltipPayload),getPosition:h=>{var p;return(p=n[Number(h)])===null||p===void 0?void 0:p.tooltipPosition},settings:{stroke:i,strokeWidth:s,fill:o,dataKey:t,nameKey:r,name:Ah(l,t),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return x.createElement(X_,{tooltipEntrySettings:f})}),ZNe=(e,t)=>e>t?"start":e<t?"end":"middle",e3e=(e,t,r)=>Fo(typeof t=="function"?t(e):t,r,r*.8),t3e=(e,t,r)=>{var{top:n,left:i,width:s,height:o}=t,l=eH(s,o),c=i+Fo(e.cx,s,s/2),u=n+Fo(e.cy,o,o/2),d=Fo(e.innerRadius,l,0),f=e3e(r,e.outerRadius,l),h=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:h}},r3e=(e,t)=>{var r=Gs(t-e),n=Math.min(Math.abs(t-e),360);return r*n},n3e=(e,t)=>{if(x.isValidElement(e))return x.cloneElement(e,t);if(typeof e=="function")return e(t);var r=bi("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,i=J_(t,WNe);return x.createElement(d_,xh({},i,{type:"linear",className:r}))},i3e=(e,t,r)=>{if(x.isValidElement(e))return x.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),x.isValidElement(n)))return n;var i=bi("recharts-pie-label-text",TG(e));return x.createElement(O_,xh({},t,{alignmentBaseline:"middle",className:i}),n)};function a3e(e){var{sectors:t,props:r,showLabels:n}=e,{label:i,labelLine:s,dataKey:o}=r;if(!n||!i||!t)return null;var l=sl(r),c=gh(i),u=gh(s),d=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,f=t.map((h,p)=>{var m=(h.startAngle+h.endAngle)/2,g=vs(h.cx,h.cy,h.outerRadius+d,m),y=Ha(Ha(Ha(Ha({},l),h),{},{stroke:"none"},c),{},{index:p,textAnchor:ZNe(g.x,h.cx)},g),b=Ha(Ha(Ha(Ha({},l),h),{},{fill:"none",stroke:h.fill},u),{},{index:p,points:[vs(h.cx,h.cy,h.outerRadius,m),g],key:"line"});return x.createElement(xo,{zIndex:Pa.label,key:"label-".concat(h.startAngle,"-").concat(h.endAngle,"-").concat(h.midAngle,"-").concat(p)},x.createElement(ka,null,s&&n3e(s,b),i3e(i,y,Ai(h,o))))});return x.createElement(ka,{className:"recharts-pie-labels"},f)}function s3e(e){var{sectors:t,props:r,showLabels:n}=e,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?x.createElement(M_,{label:i}):x.createElement(a3e,{sectors:t,props:r,showLabels:n})}function o3e(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:i,shape:s,id:o}=e,l=wn(rf),c=wn(i6),u=wn(Sje),{onMouseEnter:d,onClick:f,onMouseLeave:h}=i,p=J_(i,qNe),m=G_(d,i.dataKey,o),g=K_(h),y=Y_(f,i.dataKey,o);return t==null||t.length===0?null:x.createElement(x.Fragment,null,t.map((b,v)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&t.length!==1)return null;var w=u==null||u===o,S=String(v)===l&&(c==null||i.dataKey===c)&&w,k=l?n:null,j=r&&S?r:k,A=Ha(Ha({},b),{},{stroke:b.stroke,tabIndex:-1,[Cq]:v,[HC]:o});return x.createElement(ka,xh({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(v),tabIndex:-1,className:"recharts-pie-sector"},dg(p,b,v),{onMouseEnter:m(b,v),onMouseLeave:g(b,v),onClick:y(b,v)}),x.createElement(D1,xh({option:s??j,index:v,shapeType:"sector",isActive:S},A)))}))}function l3e(e){var t,{pieSettings:r,displayedData:n,cells:i,offset:s}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,h=Math.abs(r.minAngle),p=r3e(l,c),m=Math.abs(p),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=n.filter(j=>Ai(j,u,0)!==0).length,b=(m>=360?y:y-1)*g,v=m-y*h-b,w=n.reduce((j,A)=>{var L=Ai(A,u,0);return j+(En(L)?L:0)},0),S;if(w>0){var k;S=n.map((j,A)=>{var L=Ai(j,u,0),P=Ai(j,d,A),B=t3e(r,s,j),E=(En(L)?L:0)/w,T,F=Ha(Ha({},j),i&&i[A]&&i[A].props);A?T=k.endAngle+Gs(p)*g*(L!==0?1:0):T=l;var W=T+Gs(p)*((L!==0?h:0)+E*v),z=(T+W)/2,se=(B.innerRadius+B.outerRadius)/2,de=[{name:P,value:L,payload:F,dataKey:u,type:f,graphicalItemId:r.id}],U=vs(B.cx,B.cy,se,z);return k=Ha(Ha(Ha(Ha({},r.presentationProps),{},{percent:E,cornerRadius:typeof o=="string"?parseFloat(o):o,name:P,tooltipPayload:de,midAngle:z,middleRadius:se,tooltipPosition:U},F),B),{},{value:L,dataKey:u,startAngle:T,endAngle:W,payload:F,paddingAngle:Gs(p)*g}),k})}return S}function c3e(e){var{showLabels:t,sectors:r,children:n}=e,i=x.useMemo(()=>!t||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,t]);return x.createElement(zAe,{value:t?i:void 0},n)}function u3e(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:h}=t,p=pg(t,"recharts-pie-"),m=r.current,[g,y]=x.useState(!1),b=x.useCallback(()=>{typeof h=="function"&&h(),y(!1)},[h]),v=x.useCallback(()=>{typeof f=="function"&&f(),y(!0)},[f]);return x.createElement(c3e,{showLabels:!g,sectors:i},x.createElement(hg,{animationId:p,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:v,onAnimationEnd:b,key:p},w=>{var S,k=[],j=i&&i[0],A=(S=j==null?void 0:j.startAngle)!==null&&S!==void 0?S:0;return i==null||i.forEach((L,P)=>{var B=m&&m[P],E=P>0?P0(L,"paddingAngle",0):0;if(B){var T=Vi(B.endAngle-B.startAngle,L.endAngle-L.startAngle,w),F=Ha(Ha({},L),{},{startAngle:A+E,endAngle:A+T+E});k.push(F),A=F.endAngle}else{var{endAngle:W,startAngle:z}=L,se=Vi(0,W-z,w),de=Ha(Ha({},L),{},{startAngle:A+E,endAngle:A+se+E});k.push(de),A=de.endAngle}}),r.current=k,x.createElement(ka,null,x.createElement(o3e,{sectors:k,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:n}))}),x.createElement(s3e,{showLabels:!g,sectors:i,props:t}),t.children)}var d3e={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Pa.area};function f3e(e){var{id:t}=e,r=J_(e,HNe),{hide:n,className:i,rootTabIndex:s}=e,o=x.useMemo(()=>V_(e.children,op),[e.children]),l=wn(d=>sNe(d,t,o)),c=x.useRef(null),u=bi("recharts-pie",i);return n||l==null?(c.current=null,x.createElement(ka,{tabIndex:s,className:u})):x.createElement(xo,{zIndex:e.zIndex},x.createElement(JNe,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:l,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),x.createElement(ka,{tabIndex:s,className:u},x.createElement(u3e,{props:Ha(Ha({},r),{},{sectors:l}),previousSectorsRef:c,id:t})))}function IG(e){var t=ja(e,d3e),{id:r}=t,n=J_(t,VNe),i=sl(n);return x.createElement(Q_,{id:r,type:"pie"},s=>x.createElement(x.Fragment,null,x.createElement(zNe,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i,maxRadius:t.maxRadius}),x.createElement(QNe,xh({},n,{id:s})),x.createElement(f3e,xh({},n,{id:s}))))}IG.displayName="Pie";var h3e=["points"];function tB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tB(Object(r),!0).forEach(function(n){p3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function p3e(e,t,r){return(t=m3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function m3e(e){var t=g3e(e,"string");return typeof t=="symbol"?t:t+""}function g3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hw(){return Hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hw.apply(null,arguments)}function x3e(e,t){if(e==null)return{};var r,n,i=y3e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function y3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function b3e(e){var{option:t,dotProps:r,className:n}=e;if(x.isValidElement(t))return x.cloneElement(t,r);if(typeof t=="function")return t(r);var i=bi(n,typeof t!="boolean"?t.className:""),s=r??{},{points:o}=s,l=x3e(s,h3e);return x.createElement(AG,Hw({},l,{className:i}))}function v3e(e,t){return e==null?!1:t?!0:e.length===1}function w3e(e){var{points:t,dot:r,className:n,dotClassName:i,dataKey:s,baseProps:o,needClip:l,clipPathId:c,zIndex:u=Pa.scatter}=e;if(!v3e(t,r))return null;var d=RG(r),f=o1e(r),h=t.map((m,g)=>{var y,b,v=lj(lj(lj({r:3},o),f),{},{index:g,cx:(y=m.x)!==null&&y!==void 0?y:void 0,cy:(b=m.y)!==null&&b!==void 0?b:void 0,dataKey:s,value:m.value,payload:m.payload,points:t});return x.createElement(b3e,{key:"dot-".concat(g),option:r,dotProps:v,className:i})}),p={};return l&&c!=null&&(p.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),x.createElement(xo,{zIndex:u},x.createElement(ka,Hw({className:n},p),h))}function rB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rB(Object(r),!0).forEach(function(n){S3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function S3e(e,t,r){return(t=_3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _3e(e){var t=k3e(e,"string");return typeof t=="symbol"?t:t+""}function k3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DG=0,j3e={xAxis:{},yAxis:{},zAxis:{}},$G=Pl({name:"cartesianAxis",initialState:j3e,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:wa()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:wa()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:wa()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:wa()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:wa()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:wa()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:wa()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:wa()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:wa()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,i=e.yAxis[r];if(i){var s,o=i.widthHistory||[];if(o.length===3&&o[0]===o[2]&&n===o[1]&&n!==i.width&&Math.abs(n-((s=o[0])!==null&&s!==void 0?s:0))<=1)return;var l=[...o,n].slice(-3);e.yAxis[r]=nB(nB({},i),{},{width:n,widthHistory:l})}}}}),{addXAxis:A3e,replaceXAxis:N3e,removeXAxis:C3e,addYAxis:E3e,replaceYAxis:T3e,removeYAxis:P3e,addZAxis:O3e,replaceZAxis:M3e,removeZAxis:L3e,updateYAxisWidth:R3e}=$G.actions,B3e=$G.reducer,F3e=Jt([Ms],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),I3e=Jt([F3e,hf,pf],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),y6=()=>wn(I3e),D3e=()=>wn(Nje);function iB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iB(Object(r),!0).forEach(function(n){$3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $3e(e,t,r){return(t=U3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U3e(e){var t=z3e(e,"string");return typeof t=="symbol"?t:t+""}function z3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var W3e=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:i,dataKey:s,clipPath:o}=e;if(i===!1||t.x==null||t.y==null)return null;var l={index:r,dataKey:s,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=cj(cj(cj({},l),gh(i)),NC(i)),u;return x.isValidElement(i)?u=x.cloneElement(i,c):typeof i=="function"?u=i(c):u=x.createElement(AG,c),x.createElement(ka,{className:"recharts-active-dot",clipPath:o},u)};function q3e(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:i,clipPath:s,zIndex:o=Pa.activeDot}=e,l=wn(rf),c=D3e();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return Gi(u)?null:x.createElement(xo,{zIndex:o},x.createElement(W3e,{point:u,childIndex:Number(l),mainColor:r,dataKey:i,activeDot:n,clipPath:s}))}var aB=(e,t,r)=>{var n=r??e;if(!Gi(n))return Fo(n,t,0)},H3e=(e,t,r)=>{var n={},i=e.filter(k_),s=e.filter(u=>u.stackId==null),o=i.reduce((u,d)=>{var f=u[d.stackId];return f==null&&(f=[]),f.push(d),u[d.stackId]=f,u},n),l=Object.entries(o).map(u=>{var d,[f,h]=u,p=h.map(g=>g.dataKey),m=aB(t,r,(d=h[0])===null||d===void 0?void 0:d.barSize);return{stackId:f,dataKeys:p,barSize:m}}),c=s.map(u=>{var d=[u.dataKey].filter(h=>h!=null),f=aB(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function sB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function gv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sB(Object(r),!0).forEach(function(n){V3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V3e(e,t,r){return(t=G3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G3e(e){var t=K3e(e,"string");return typeof t=="symbol"?t:t+""}function K3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y3e(e,t,r,n,i){var s,o=n.length;if(!(o<1)){var l=Fo(e,r,0,!0),c,u=[];if(di((s=n[0])===null||s===void 0?void 0:s.barSize)){var d=!1,f=r/o,h=n.reduce((v,w)=>v+(w.barSize||0),0);h+=(o-1)*l,h>=r&&(h-=(o-1)*l,l=0),h>=r&&f>0&&(d=!0,f*=.9,h=o*f);var p=(r-h)/2>>0,m={offset:p-l,size:0};c=n.reduce((v,w)=>{var S,k={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:m.offset+m.size+l,size:d?f:(S=w.barSize)!==null&&S!==void 0?S:0}},j=[...v,k];return m=k.position,j},u)}else{var g=Fo(t,r,0,!0);r-2*g-(o-1)*l<=0&&(l=0);var y=(r-2*g-(o-1)*l)/o;y>1&&(y>>=0);var b=di(i)?Math.min(y,i):y;c=n.reduce((v,w,S)=>[...v,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:g+(y+l)*S+(y-b)/2,size:b}}],u)}return c}}var X3e=(e,t,r,n,i,s,o)=>{var l=Gi(o)?t:o,c=Y3e(r,n,i!==s?i:s,e,l);return i!==s&&c!=null&&(c=c.map(u=>gv(gv({},u),{},{position:gv(gv({},u.position),{},{offset:u.position.offset-i/2})}))),c},Q3e=(e,t)=>{var r=PE(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var i=e[n];if(i){var{stackedData:s}=i;if(s)return s.find(o=>o.key===r)}}}},J3e=(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}};function Z3e(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&di(e.zIndex)?e.zIndex:t}var UG=e=>{var{chartData:t}=e,r=Yi(),n=Ls();return x.useEffect(()=>n?()=>{}:(r(vR(t)),()=>{r(vR(void 0))}),[t,r,n]),null},oB={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},zG=Pl({name:"brush",initialState:oB,reducers:{setBrushSettings(e,t){return t.payload==null?oB:t.payload}}}),{setBrushSettings:MMe}=zG.actions,eCe=zG.reducer,tCe=(e,t)=>{var{x:r,y:n}=e,{x:i,y:s}=t;return{x:Math.min(r,i),y:Math.min(n,s),width:Math.abs(i-r),height:Math.abs(s-n)}},rCe=e=>{var{x1:t,y1:r,x2:n,y2:i}=e;return tCe({x:t,y:r},{x:n,y:i})};function nCe(e){return(e%180+180)%180}var iCe=function(t){var{width:r,height:n}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=nCe(i),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},aCe={dots:[],areas:[],lines:[]},WG=Pl({name:"referenceElements",initialState:aCe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=pu(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=pu(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=pu(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:LMe,removeDot:RMe,addArea:BMe,removeArea:FMe,addLine:sCe,removeLine:oCe}=WG.actions,lCe=WG.reducer,qG=x.createContext(void 0),cCe=e=>{var{children:t}=e,[r]=x.useState("".concat(j1("recharts"),"-clip")),n=y6();if(n==null)return null;var{x:i,y:s,width:o,height:l}=n;return x.createElement(qG.Provider,{value:r},x.createElement("defs",null,x.createElement("clipPath",{id:r},x.createElement("rect",{x:i,y:s,height:l,width:o}))),t)},uCe=()=>x.useContext(qG);class dCe{constructor(t){var{x:r,y:n}=t;this.xAxisScale=r,this.yAxisScale=n}map(t,r){var n,i,{position:s}=r;return{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:0,y:(i=this.yAxisScale.map(t.y,{position:s}))!==null&&i!==void 0?i:0}}mapWithFallback(t,r){var n,i,{position:s,fallback:o}=r,l,c;return o==="rangeMin"?l=this.yAxisScale.rangeMin():o==="rangeMax"?l=this.yAxisScale.rangeMax():l=0,o==="rangeMin"?c=this.xAxisScale.rangeMin():o==="rangeMax"?c=this.xAxisScale.rangeMax():c=0,{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:c,y:(i=this.yAxisScale.map(t.y,{position:s}))!==null&&i!==void 0?i:l}}isInRange(t){var{x:r,y:n}=t,i=r==null||this.xAxisScale.isInRange(r),s=n==null||this.yAxisScale.isInRange(n);return i&&s}}function lB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lB(Object(r),!0).forEach(function(n){fCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fCe(e,t,r){return(t=hCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hCe(e){var t=pCe(e,"string");return typeof t=="symbol"?t:t+""}function pCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vw(){return Vw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vw.apply(null,arguments)}var mCe=(e,t)=>{var r;if(x.isValidElement(e))r=x.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{if(!di(t.x1)||!di(t.y1)||!di(t.x2)||!di(t.y2))return null;r=x.createElement("line",Vw({},t,{className:"recharts-reference-line-line"}))}return r},gCe=(e,t,r,n,i,s)=>{var{x:o,width:l}=s,c=i.map(e,{position:r});if(!di(c)||t==="discard"&&!i.isInRange(c))return null;var u=[{x:o+l,y:c},{x:o,y:c}];return n==="left"?u.reverse():u},xCe=(e,t,r,n,i,s)=>{var{y:o,height:l}=s,c=i.map(e,{position:r});if(!di(c)||t==="discard"&&!i.isInRange(c))return null;var u=[{x:c,y:o+l},{x:c,y:o}];return n==="top"?u.reverse():u},yCe=(e,t,r,n)=>{var i=[n.mapWithFallback(e[0],{position:r,fallback:"rangeMin"}),n.mapWithFallback(e[1],{position:r,fallback:"rangeMax"})];return t==="discard"&&i.some(s=>!n.isInRange(s))?null:i},bCe=(e,t,r,n,i,s,o)=>{var{x:l,y:c,segment:u,ifOverflow:d}=o,f=Uc(l),h=Uc(c);return h?gCe(c,d,n,s,t,r):f?xCe(l,d,n,i,e,r):u!=null&&u.length===2?yCe(u,d,n,new dCe({x:e,y:t})):null};function vCe(e){var t=Yi();return x.useEffect(()=>(t(sCe(e)),()=>{t(oCe(e))})),null}function wCe(e){var{xAxisId:t,yAxisId:r,shape:n,className:i,ifOverflow:s}=e,o=Ls(),l=uCe(),c=wn(A=>fd(A,t)),u=wn(A=>hd(A,r)),d=wn(A=>Km(A,"xAxis",t,o)),f=wn(A=>Km(A,"yAxis",r,o)),h=fg();if(!l||!h||c==null||u==null||d==null||f==null)return null;var p=bCe(d,f,h,e.position,c.orientation,u.orientation,e);if(!p)return null;var m=p[0],g=p[1];if(m==null||g==null)return null;var{x:y,y:b}=m,{x:v,y:w}=g,S=s==="hidden"?"url(#".concat(l,")"):void 0,k=cB(cB({clipPath:S},$o(e)),{},{x1:y,y1:b,x2:v,y2:w}),j=rCe({x1:y,y1:b,x2:v,y2:w});return x.createElement(xo,{zIndex:e.zIndex},x.createElement(ka,{className:bi("recharts-reference-line",i)},mCe(n,k),x.createElement(yG,Vw({},j,{lowerWidth:j.width,upperWidth:j.width}),x.createElement(vG,{label:e.label}),e.children)))}var SCe={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",label:!1,stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:Pa.line};function eN(e){var t=ja(e,SCe);return x.createElement(x.Fragment,null,x.createElement(vCe,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y,segment:t.segment}),x.createElement(wCe,t))}eN.displayName="ReferenceLine";function HG(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var i=e[n];i!==void 0&&r.push(i)}return r}function _Ce(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return iCe(n,r)}function kCe(e,t,r){var n=r==="width",{x:i,y:s,width:o,height:l}=e;return t===1?{start:n?i:s,end:n?i+o:s+l}:{start:n?i+o:s+l,end:n?i:s}}function $1(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-i)<=0}function jCe(e,t){return HG(e,t+1)}function ACe(e,t,r,n,i){for(var s=(n||[]).slice(),{start:o,end:l}=t,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:HG(n,u)};var g=c,y,b=()=>(y===void 0&&(y=r(m,g)),y),v=m.coordinate,w=c===0||$1(e,v,b,d,l);w||(c=0,d=o,u+=1),w&&(d=v+e*(b()/2+i),c+=u)},h;u<=s.length;)if(h=f(),h)return h.v;return[]}function NCe(e,t,r,n,i){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=t,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,h=!0,p=function(){var S=n[g];if(S==null)return 0;var k=g,j,A=()=>(j===void 0&&(j=r(S,k)),j),L=S.coordinate,P=g===d||$1(e,L,A,f,c);if(!P)return h=!1,1;P&&(f=L+e*(A()/2+i))},m,g=d;g<o&&(m=p(),!(m!==0&&m===1));g+=u);if(h){for(var y=[],b=d;b<o;b+=u){var v=n[b];v!=null&&y.push(v)}return y}}return[]}function uB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Co(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uB(Object(r),!0).forEach(function(n){CCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CCe(e,t,r){return(t=ECe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ECe(e){var t=TCe(e,"string");return typeof t=="symbol"?t:t+""}function TCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PCe(e,t,r,n,i){for(var s=(n||[]).slice(),o=s.length,{start:l}=t,{end:c}=t,u=function(h){var p=s[h];if(p==null)return 1;var m=p,g,y=()=>(g===void 0&&(g=r(p,h)),g);if(h===o-1){var b=e*(m.coordinate+e*y()/2-c);s[h]=m=Co(Co({},m),{},{tickCoord:b>0?m.coordinate-b*e:m.coordinate})}else s[h]=m=Co(Co({},m),{},{tickCoord:m.coordinate});if(m.tickCoord!=null){var v=$1(e,m.tickCoord,y,l,c);v&&(c=m.tickCoord-e*(y()/2+i),s[h]=Co(Co({},m),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function OCe(e,t,r,n,i,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=t;if(s){var d=n[l-1];if(d!=null){var f=r(d,l-1),h=e*(d.coordinate+e*f/2-u);if(o[l-1]=d=Co(Co({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate}),d.tickCoord!=null){var p=$1(e,d.tickCoord,()=>f,c,u);p&&(u=d.tickCoord-e*(f/2+i),o[l-1]=Co(Co({},d),{},{isShow:!0}))}}}for(var m=s?l-1:l,g=function(v){var w=o[v];if(w==null)return 1;var S=w,k,j=()=>(k===void 0&&(k=r(w,v)),k);if(v===0){var A=e*(S.coordinate-e*j()/2-c);o[v]=S=Co(Co({},S),{},{tickCoord:A<0?S.coordinate-A*e:S.coordinate})}else o[v]=S=Co(Co({},S),{},{tickCoord:S.coordinate});if(S.tickCoord!=null){var L=$1(e,S.tickCoord,j,c,u);L&&(c=S.tickCoord+e*(j()/2+i),o[v]=Co(Co({},S),{},{isShow:!0}))}},y=0;y<m;y++)g(y);return o}function b6(e,t,r){var{tick:n,ticks:i,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!i||!i.length||!n)return[];if(En(c)||f_.isSsr){var h;return(h=jCe(i,En(c)?c:0))!==null&&h!==void 0?h:[]}var p=[],m=l==="top"||l==="bottom"?"width":"height",g=d&&m==="width"?Dx(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},y=(k,j)=>{var A=typeof u=="function"?u(k.value,j):k.value;return m==="width"?_Ce(Dx(A,{fontSize:t,letterSpacing:r}),g,f):Dx(A,{fontSize:t,letterSpacing:r})[m]},b=i[0],v=i[1],w=i.length>=2&&b!=null&&v!=null?Gs(v.coordinate-b.coordinate):1,S=kCe(s,w,m);return c==="equidistantPreserveStart"?ACe(w,S,y,i,o):c==="equidistantPreserveEnd"?NCe(w,S,y,i,o):(c==="preserveStart"||c==="preserveStartEnd"?p=OCe(w,S,y,i,o,c==="preserveStartEnd"):p=PCe(w,S,y,i,o),p.filter(k=>k.isShow))}var MCe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:s=0}=e,o=0;if(t){Array.from(t).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=i+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},LCe=["axisLine","width","height","className","hide","ticks","axisType"];function RCe(e,t){if(e==null)return{};var r,n,i=BCe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function BCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function F0(){return F0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},F0.apply(null,arguments)}function dB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ua(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dB(Object(r),!0).forEach(function(n){FCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FCe(e,t,r){return(t=ICe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ICe(e){var t=DCe(e,"string");return typeof t=="symbol"?t:t+""}function DCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Wd={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Pa.axis};function $Ce(e){var{x:t,y:r,width:n,height:i,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=Ua(Ua(Ua({},c),sl(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=Ua(Ua({},u),{},{x1:t,y1:r+d*i,x2:t+n,y2:r+d*i})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=Ua(Ua({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+i})}return x.createElement("line",F0({},u,{className:bi("recharts-cartesian-axis-line",P0(l,"className"))}))}function UCe(e,t,r,n,i,s,o,l,c){var u,d,f,h,p,m,g=l?-1:1,y=e.tickSize||o,b=En(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=d=e.coordinate,h=r+ +!l*i,f=h-g*y,m=f-g*c,p=b;break;case"left":f=h=e.coordinate,d=t+ +!l*n,u=d-g*y,p=u-g*c,m=b;break;case"right":f=h=e.coordinate,d=t+ +l*n,u=d+g*y,p=u+g*c,m=b;break;default:u=d=e.coordinate,h=r+ +l*i,f=h+g*y,m=f+g*c,p=b;break}return{line:{x1:u,y1:f,x2:d,y2:h},tick:{x:p,y:m}}}function zCe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function WCe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function qCe(e){var{option:t,tickProps:r,value:n}=e,i,s=bi(r.className,"recharts-cartesian-axis-tick-value");if(x.isValidElement(t))i=x.cloneElement(t,Ua(Ua({},r),{},{className:s}));else if(typeof t=="function")i=t(Ua(Ua({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=bi(o,TG(t))),i=x.createElement(O_,F0({},r,{className:o}),n)}return i}var HCe=x.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:i,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:h,y:p,width:m,height:g,tickSize:y,tickMargin:b,fontSize:v,letterSpacing:w,getTicksConfig:S,events:k,axisType:j}=e,A=b6(Ua(Ua({},S),{},{ticks:r}),v,w),L=zCe(d,f),P=WCe(d,f),B=sl(S),E=gh(n),T={};typeof i=="object"&&(T=i);var F=Ua(Ua({},B),{},{fill:"none"},T),W=A.map(de=>Ua({entry:de},UCe(de,h,p,m,g,d,y,f,b))),z=W.map(de=>{var{entry:U,line:G}=de;return x.createElement(ka,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(U.value,"-").concat(U.coordinate,"-").concat(U.tickCoord)},i&&x.createElement("line",F0({},F,G,{className:bi("recharts-cartesian-axis-tick-line",P0(i,"className"))})))}),se=W.map((de,U)=>{var G,re,{entry:X,tick:C}=de,K=Ua(Ua(Ua(Ua({verticalAnchor:P},B),{},{textAnchor:L,stroke:"none",fill:s},C),{},{index:U,payload:X,visibleTicksCount:A.length,tickFormatter:o,padding:c},u),{},{angle:(G=(re=u==null?void 0:u.angle)!==null&&re!==void 0?re:B.angle)!==null&&G!==void 0?G:0}),V=Ua(Ua({},K),E);return x.createElement(ka,F0({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(X.value,"-").concat(X.coordinate,"-").concat(X.tickCoord)},dg(k,X,U)),n&&x.createElement(qCe,{option:n,tickProps:V,value:"".concat(typeof o=="function"?o(X.value,U):X.value).concat(l||"")}))});return x.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(j,"-ticks")},se.length>0&&x.createElement(xo,{zIndex:Pa.label},x.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(j,"-tick-labels"),ref:t},se)),z.length>0&&x.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(j,"-tick-lines")},z))}),VCe=x.forwardRef((e,t)=>{var{axisLine:r,width:n,height:i,className:s,hide:o,ticks:l,axisType:c}=e,u=RCe(e,LCe),[d,f]=x.useState(""),[h,p]=x.useState(""),m=x.useRef(null);x.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var y;return MCe({ticks:m.current,label:(y=e.labelRef)===null||y===void 0?void 0:y.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=x.useCallback(y=>{if(y){var b=y.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=b;var v=b[0];if(v){var w=window.getComputedStyle(v),S=w.fontSize,k=w.letterSpacing;(S!==d||k!==h)&&(f(S),p(k))}}},[d,h]);return o||n!=null&&n<=0||i!=null&&i<=0?null:x.createElement(xo,{zIndex:e.zIndex},x.createElement(ka,{className:bi("recharts-cartesian-axis",s)},x.createElement($Ce,{x:e.x,y:e.y,width:n,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:sl(e)}),x.createElement(HCe,{ref:g,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:h,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),x.createElement(yG,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},x.createElement(vG,{label:e.label,labelRef:e.labelRef}),e.children)))}),v6=x.forwardRef((e,t)=>{var r=ja(e,Wd);return x.createElement(VCe,F0({},r,{ref:t}))});v6.displayName="CartesianAxis";var GCe=["x1","y1","x2","y2","key"],KCe=["offset"],YCe=["xAxisId","yAxisId"],XCe=["xAxisId","yAxisId"];function fB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Mo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fB(Object(r),!0).forEach(function(n){QCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QCe(e,t,r){return(t=JCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JCe(e){var t=ZCe(e,"string");return typeof t=="symbol"?t:t+""}function ZCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jh(){return Jh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jh.apply(null,arguments)}function Gw(e,t){if(e==null)return{};var r,n,i=eEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function eEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tEe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:i,width:s,height:o,ry:l}=e;return x.createElement("rect",{x:n,y:i,ry:l,width:s,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function VG(e){var{option:t,lineItemProps:r}=e,n;if(x.isValidElement(t))n=x.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var i,{x1:s,y1:o,x2:l,y2:c,key:u}=r,d=Gw(r,GCe),f=(i=sl(d))!==null&&i!==void 0?i:{},{offset:h}=f,p=Gw(f,KCe);n=x.createElement("line",Jh({},p,{x1:s,y1:o,x2:l,y2:c,fill:"none",key:u}))}return n}function rEe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Gw(e,YCe),c=i.map((u,d)=>{var f=Mo(Mo({},l),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return x.createElement(VG,{key:"line-".concat(d),option:n,lineItemProps:f})});return x.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function nEe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Gw(e,XCe),c=i.map((u,d)=>{var f=Mo(Mo({},l),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return x.createElement(VG,{option:n,lineItemProps:f,key:"line-".concat(d)})});return x.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function iEe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:i,width:s,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var u=l.map(f=>Math.round(f+i-i)).sort((f,h)=>f-h);i!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=u[h+1],m=p==null,g=m?i+o-f:p-f;if(g<=0)return null;var y=h%t.length;return x.createElement("rect",{key:"react-".concat(h),y:f,x:n,height:g,width:s,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function aEe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:i,y:s,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+i-i)).sort((f,h)=>f-h);i!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var p=u[h+1],m=p==null,g=m?i+o-f:p-f;if(g<=0)return null;var y=h%r.length;return x.createElement("rect",{key:"react-".concat(h),x:f,y:s,width:g,height:l,stroke:"none",fill:r[y],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var sEe=(e,t)=>{var{xAxis:r,width:n,height:i,offset:s}=e;return jq(b6(Mo(Mo(Mo({},Wd),r),{},{ticks:Aq(r),viewBox:{x:0,y:0,width:n,height:i}})),s.left,s.left+s.width,t)},oEe=(e,t)=>{var{yAxis:r,width:n,height:i,offset:s}=e;return jq(b6(Mo(Mo(Mo({},Wd),r),{},{ticks:Aq(r),viewBox:{x:0,y:0,width:n,height:i}})),s.top,s.top+s.height,t)},lEe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Pa.grid};function Ly(e){var t=YC(),r=XC(),n=Rq(),i=Mo(Mo({},ja(e,lEe)),{},{x:En(e.x)?e.x:n.left,y:En(e.y)?e.y:n.top,width:En(e.width)?e.width:n.width,height:En(e.height)?e.height:n.height}),{xAxisId:s,yAxisId:o,x:l,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:h,verticalValues:p}=i,m=Ls(),g=wn(P=>cR(P,"xAxis",s,m)),y=wn(P=>cR(P,"yAxis",o,m));if(!ad(u)||!ad(d)||!En(l)||!En(c))return null;var b=i.verticalCoordinatesGenerator||sEe,v=i.horizontalCoordinatesGenerator||oEe,{horizontalPoints:w,verticalPoints:S}=i;if((!w||!w.length)&&typeof v=="function"){var k=h&&h.length,j=v({yAxis:y?Mo(Mo({},y),{},{ticks:k?h:y.ticks}):void 0,width:t??u,height:r??d,offset:n},k?!0:f);yw(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(w=j)}if((!S||!S.length)&&typeof b=="function"){var A=p&&p.length,L=b({xAxis:g?Mo(Mo({},g),{},{ticks:A?p:g.ticks}):void 0,width:t??u,height:r??d,offset:n},A?!0:f);yw(Array.isArray(L),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof L,"]")),Array.isArray(L)&&(S=L)}return x.createElement(xo,{zIndex:i.zIndex},x.createElement("g",{className:"recharts-cartesian-grid"},x.createElement(tEe,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),x.createElement(iEe,Jh({},i,{horizontalPoints:w})),x.createElement(aEe,Jh({},i,{verticalPoints:S})),x.createElement(rEe,Jh({},i,{offset:n,horizontalPoints:w,xAxis:g,yAxis:y})),x.createElement(nEe,Jh({},i,{offset:n,verticalPoints:S,xAxis:g,yAxis:y}))))}Ly.displayName="CartesianGrid";var cEe={},GG=Pl({name:"errorBars",initialState:cEe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:i}=t.payload;e[r]&&(e[r]=e[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?i:s))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:IMe,replaceErrorBar:DMe,removeErrorBar:$Me}=GG.actions,uEe=GG.reducer,dEe=["children"];function fEe(e,t){if(e==null)return{};var r,n,i=hEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function hEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var pEe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},mEe=x.createContext(pEe);function w6(e){var{children:t}=e,r=fEe(e,dEe);return x.createElement(mEe.Provider,{value:r},t)}function Z_(e,t){var r,n,i=wn(u=>fd(u,e)),s=wn(u=>hd(u,t)),o=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:Ds.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:$s.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function S6(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,i=y6(),{needClipX:s,needClipY:o,needClip:l}=Z_(t,r);if(!l||!i)return null;var{x:c,y:u,width:d,height:f}=i;return x.createElement("clipPath",{id:"clipPath-".concat(n)},x.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var KG=(e,t,r,n)=>ld(e,"xAxis",t,n),YG=(e,t,r,n)=>od(e,"xAxis",t,n),XG=(e,t,r,n)=>ld(e,"yAxis",r,n),QG=(e,t,r,n)=>od(e,"yAxis",r,n),gEe=Jt([Ci,KG,XG,YG,QG],(e,t,r,n,i)=>ff(e,"xAxis")?zm(t,n,!1):zm(r,i,!1)),xEe=(e,t,r,n,i)=>i;function yEe(e){return e.type==="line"}var bEe=Jt([Ny,xEe],(e,t)=>e.filter(yEe).find(r=>r.id===t)),vEe=Jt([Ci,KG,XG,YG,QG,bEe,gEe,v_],(e,t,r,n,i,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=l;if(!(s==null||t==null||r==null||n==null||i==null||n.length===0||i.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:f,data:h}=s,p;if(h!=null&&h.length>0?p=h:p=c==null?void 0:c.slice(u,d+1),p!=null)return d6e({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:f,bandSize:o,displayedData:p})}});function wEe(e){var t=gh(e),r=3,n=2;if(t!=null){var{r:i,strokeWidth:s}=t,o=Number(i),l=Number(s);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(l)||l<0)&&(l=n),{r:o,strokeWidth:l}}return{r,strokeWidth:n}}var SEe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ry=x;function _Ee(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kEe=typeof Object.is=="function"?Object.is:_Ee,jEe=Ry.useSyncExternalStore,AEe=Ry.useRef,NEe=Ry.useEffect,CEe=Ry.useMemo,EEe=Ry.useDebugValue;SEe.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=AEe(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=CEe(function(){function c(p){if(!u){if(u=!0,d=p,p=n(p),i!==void 0&&o.hasValue){var m=o.value;if(i(m,p))return f=m}return f=p}if(m=f,kEe(d,p))return m;var g=n(p);return i!==void 0&&i(m,g)?(d=p,m):(d=p,f=g)}var u=!1,d,f,h=r===void 0?null:r;return[function(){return c(t())},h===null?void 0:function(){return c(h())}]},[t,r,n,i]);var l=jEe(e,s[0],s[1]);return NEe(function(){o.hasValue=!0,o.value=l},[l]),EEe(l),l};function TEe(e){e()}function PEe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){TEe(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var hB={notify(){},get:()=>[]};function OEe(e,t){let r,n=hB,i=0,s=!1;function o(g){d();const y=n.subscribe(g);let b=!1;return()=>{b||(b=!0,y(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){i++,r||(r=e.subscribe(c),n=PEe())}function f(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=hB)}function h(){s||(s=!0,d())}function p(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:h,tryUnsubscribe:p,getListeners:()=>n};return m}var MEe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LEe=MEe(),REe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",BEe=REe(),FEe=()=>LEe||BEe?x.useLayoutEffect:x.useEffect,IEe=FEe();function pB(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function DEe(e,t){if(pB(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!pB(e[r[i]],t[r[i]]))return!1;return!0}var uj=Symbol.for("react-redux-context"),dj=typeof globalThis<"u"?globalThis:{};function $Ee(){if(!x.createContext)return{};const e=dj[uj]??(dj[uj]=new Map);let t=e.get(x.createContext);return t||(t=x.createContext(null),e.set(x.createContext,t)),t}var UEe=$Ee();function zEe(e){const{children:t,context:r,serverState:n,store:i}=e,s=x.useMemo(()=>{const c=OEe(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),o=x.useMemo(()=>i.getState(),[i]);IEe(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||UEe;return x.createElement(l.Provider,{value:s},t)}var WEe=zEe,qEe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function HEe(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function By(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(qEe.has(n)){if(e[n]==null&&t[n]==null)continue;if(!DEe(e[n],t[n]))return!1}else if(!HEe(e[n],t[n]))return!1;return!0}var VEe=["id"],GEe=["type","layout","connectNulls","needClip","shape"],KEe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function U1(){return U1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U1.apply(null,arguments)}function mB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mB(Object(r),!0).forEach(function(n){YEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function YEe(e,t,r){return(t=XEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XEe(e){var t=QEe(e,"string");return typeof t=="symbol"?t:t+""}function QEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _6(e,t){if(e==null)return{};var r,n,i=JEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function JEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ZEe=e=>{var{dataKey:t,name:r,stroke:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Ah(r,t),payload:e}]},e6e=x.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:i,fill:s,name:o,hide:l,unit:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:r,getPosition:np,settings:{stroke:n,strokeWidth:i,fill:s,dataKey:t,nameKey:void 0,name:Ah(o,t),hide:l,type:u,color:n,unit:c,graphicalItemId:d}};return x.createElement(X_,{tooltipEntrySettings:f})}),JG=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function t6e(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],i=0;i<t;++i)n=[...n,...r];return n}var r6e=(e,t,r)=>{var n=r.reduce((p,m)=>p+m);if(!n)return JG(t,e);for(var i=Math.floor(e/n),s=e%n,o=t-e,l=[],c=0,u=0;c<r.length;u+=(d=r[c])!==null&&d!==void 0?d:0,++c){var d,f=r[c];if(f!=null&&u+f>s){l=[...r.slice(0,c),s-u];break}}var h=l.length%2===0?[0,o]:[o];return[...t6e(r,i),...l,...h].map(p=>"".concat(p,"px")).join(", ")};function n6e(e){var{clipPathId:t,points:r,props:n}=e,{dot:i,dataKey:s,needClip:o}=n,{id:l}=n,c=_6(n,VEe),u=sl(c);return x.createElement(w3e,{points:r,dot:i,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:u,needClip:o,clipPathId:t})}function i6e(e){var{showLabels:t,children:r,points:n}=e,i=x.useMemo(()=>n==null?void 0:n.map(s=>{var o,l,c={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Vu(Vu({},c),{},{value:s.value,payload:s.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[n]);return x.createElement(u6,{value:t?i:void 0},r)}function gB(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:i,props:s}=e,{type:o,layout:l,connectNulls:c,needClip:u,shape:d}=s,f=_6(s,GEe),h=Vu(Vu({},$o(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:o,layout:l,connectNulls:c,strokeDasharray:i??s.strokeDasharray});return x.createElement(x.Fragment,null,(n==null?void 0:n.length)>1&&x.createElement(D1,U1({shapeType:"curve",option:d},h,{pathRef:r})),x.createElement(n6e,{points:n,clipPathId:t,props:s}))}function a6e(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function s6e(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:s}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:h,width:p,height:m,onAnimationEnd:g,onAnimationStart:y}=r,b=i.current,v=pg(o,"recharts-line-"),w=x.useRef(v),[S,k]=x.useState(!1),j=!S,A=x.useCallback(()=>{typeof g=="function"&&g(),k(!1)},[g]),L=x.useCallback(()=>{typeof y=="function"&&y(),k(!0)},[y]),P=a6e(n.current),B=x.useRef(0);w.current!==v&&(B.current=s.current,w.current=v);var E=B.current;return x.createElement(i6e,{points:o,showLabels:j},r.children,x.createElement(hg,{animationId:v,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:A,onAnimationStart:L,key:v},T=>{var F=Vi(E,P+E,T),W=Math.min(F,P),z;if(c)if(l){var se="".concat(l).split(/[,\s]+/gim).map(G=>parseFloat(G));z=r6e(W,P,se)}else z=JG(P,W);else z=l==null?void 0:String(l);if(T>0&&P>0&&(i.current=o,s.current=Math.max(s.current,W)),b){var de=b.length/o.length,U=T===1?o:o.map((G,re)=>{var X=Math.floor(re*de);if(b[X]){var C=b[X];return Vu(Vu({},G),{},{x:Vi(C.x,G.x,T),y:Vi(C.y,G.y,T)})}return h?Vu(Vu({},G),{},{x:Vi(p*2,G.x,T),y:Vi(m/2,G.y,T)}):Vu(Vu({},G),{},{x:G.x,y:G.y})});return i.current=U,x.createElement(gB,{props:r,points:U,clipPathId:t,pathRef:n,strokeDasharray:z})}return x.createElement(gB,{props:r,points:o,clipPathId:t,pathRef:n,strokeDasharray:z})}),x.createElement(M_,{label:r.label}))}function o6e(e){var{clipPathId:t,props:r}=e,n=x.useRef(null),i=x.useRef(0),s=x.useRef(null);return x.createElement(s6e,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:i,pathRef:s})}var l6e=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:Ai(e.payload,t)}};class c6e extends x.Component{render(){var{hide:t,dot:r,points:n,className:i,xAxisId:s,yAxisId:o,top:l,left:c,width:u,height:d,id:f,needClip:h,zIndex:p}=this.props;if(t)return null;var m=bi("recharts-line",i),g=f,{r:y,strokeWidth:b}=wEe(r),v=RG(r),w=y*2+b,S=h?"url(#clipPath-".concat(v?"":"dots-").concat(g,")"):void 0;return x.createElement(xo,{zIndex:p},x.createElement(ka,{className:m},h&&x.createElement("defs",null,x.createElement(S6,{clipPathId:g,xAxisId:s,yAxisId:o}),!v&&x.createElement("clipPath",{id:"clipPath-dots-".concat(g)},x.createElement("rect",{x:c-w/2,y:l-w/2,width:u+w,height:d+w}))),x.createElement(w6,{xAxisId:s,yAxisId:o,data:n,dataPointFormatter:l6e,errorBarOffset:0},x.createElement(o6e,{props:this.props,clipPathId:g}))),x.createElement(q3e,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:S}))}}var ZG={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Pa.line,type:"linear"};function u6e(e){var t=ja(e,ZG),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:s,animationEasing:o,connectNulls:l,dot:c,hide:u,isAnimationActive:d,label:f,legendType:h,xAxisId:p,yAxisId:m,id:g}=t,y=_6(t,KEe),{needClip:b}=Z_(p,m),v=y6(),w=ip(),S=Ls(),k=wn(B=>vEe(B,p,m,S,g));if(w!=="horizontal"&&w!=="vertical"||k==null||v==null)return null;var{height:j,width:A,x:L,y:P}=v;return x.createElement(c6e,U1({},y,{id:g,connectNulls:l,dot:c,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:s,animationEasing:o,isAnimationActive:d,hide:u,label:f,legendType:h,xAxisId:p,yAxisId:m,points:k,layout:w,height:j,width:A,left:L,top:P,needClip:b}))}function d6e(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:s,dataKey:o,bandSize:l,displayedData:c}=e;return c.map((u,d)=>{var f=Ai(u,o);if(t==="horizontal"){var h=xw({axis:r,ticks:i,bandSize:l,entry:u,index:d}),p=Gi(f)?null:n.scale.map(f);return{x:h,y:p??null,value:f,payload:u}}var m=Gi(f)?null:r.scale.map(f),g=xw({axis:n,ticks:s,bandSize:l,entry:u,index:d});return m==null||g==null?null:{x:m,y:g,value:f,payload:u}}).filter(Boolean)}function f6e(e){var t=ja(e,ZG),r=Ls();return x.createElement(Q_,{id:t.id,type:"line"},n=>x.createElement(x.Fragment,null,x.createElement(g6,{legendPayload:ZEe(t)}),x.createElement(e6e,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),x.createElement(x6,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),x.createElement(u6e,U1({},t,{id:n}))))}var eK=x.memo(f6e,By);eK.displayName="Line";function lp(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:DG}function cp(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:DG}var h6e="Invariant failed";function p6e(e,t){throw new Error(h6e)}function tN(){return tN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tN.apply(null,arguments)}function Kw(e){return x.createElement(D1,tN({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var m6e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(En(t))return t;var s=En(n)||Gi(n);return s?t(n,i):(s||p6e(),r)}},g6e=(e,t,r)=>r,x6e=(e,t)=>t,Fy=Jt([Ny,x6e],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),y6e=Jt([Fy],e=>e==null?void 0:e.maxBarSize),b6e=(e,t,r,n)=>n,v6e=Jt([Ci,Ny,lp,cp,g6e],(e,t,r,n,i)=>t.filter(s=>e==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===i).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),w6e=(e,t,r)=>{var n=Ci(e),i=lp(e,t),s=cp(e,t);if(!(i==null||s==null))return n==="horizontal"?GA(e,"yAxis",s,r):GA(e,"xAxis",i,r)},S6e=(e,t)=>{var r=Ci(e),n=lp(e,t),i=cp(e,t);if(!(n==null||i==null))return r==="horizontal"?lR(e,"xAxis",n):lR(e,"yAxis",i)},_6e=Jt([v6e,S5e,S6e],H3e),k6e=(e,t,r)=>{var n,i,s=Fy(e,t);if(s==null)return 0;var o=lp(e,t),l=cp(e,t);if(o==null||l==null)return 0;var c=Ci(e),u=JH(e),{maxBarSize:d}=s,f=Gi(d)?u:d,h,p;return c==="horizontal"?(h=ld(e,"xAxis",o,r),p=od(e,"xAxis",o,r)):(h=ld(e,"yAxis",l,r),p=od(e,"yAxis",l,r)),(n=(i=zm(h,p,!0))!==null&&i!==void 0?i:f)!==null&&n!==void 0?n:0},tK=(e,t,r)=>{var n=Ci(e),i=lp(e,t),s=cp(e,t);if(!(i==null||s==null)){var o,l;return n==="horizontal"?(o=ld(e,"xAxis",i,r),l=od(e,"xAxis",i,r)):(o=ld(e,"yAxis",s,r),l=od(e,"yAxis",s,r)),zm(o,l)}},j6e=Jt([_6e,JH,w5e,ZH,k6e,tK,y6e],X3e),A6e=(e,t,r)=>{var n=lp(e,t);if(n!=null)return ld(e,"xAxis",n,r)},N6e=(e,t,r)=>{var n=cp(e,t);if(n!=null)return ld(e,"yAxis",n,r)},C6e=(e,t,r)=>{var n=lp(e,t);if(n!=null)return od(e,"xAxis",n,r)},E6e=(e,t,r)=>{var n=cp(e,t);if(n!=null)return od(e,"yAxis",n,r)},T6e=Jt([j6e,Fy],J3e),P6e=Jt([w6e,Fy],Q3e),O6e=Jt([Ms,VC,A6e,N6e,C6e,E6e,T6e,Ci,h5e,tK,P6e,Fy,b6e],(e,t,r,n,i,s,o,l,c,u,d,f,h)=>{var{chartData:p,dataStartIndex:m,dataEndIndex:g}=c;if(!(f==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||i==null||s==null||u==null)){var{data:y}=f,b;if(y!=null&&y.length>0?b=y:b=p==null?void 0:p.slice(m,g+1),b!=null)return sTe({layout:l,barSettings:f,pos:o,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:s,stackedData:d,displayedData:b,offset:e,cells:h,dataStartIndex:m})}}),M6e=["index"];function rN(){return rN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rN.apply(null,arguments)}function L6e(e,t){if(e==null)return{};var r,n,i=R6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function R6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rK=x.createContext(void 0),B6e=e=>{var t=x.useContext(rK);if(t!=null)return t.stackId;if(e!=null)return mve(e)},F6e=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),I6e=e=>{var t=x.useContext(rK);if(t!=null){var{stackId:r}=t;return"url(#".concat(F6e(r,e),")")}},nK=e=>{var{index:t}=e,r=L6e(e,M6e),n=I6e(t);return x.createElement(ka,rN({className:"recharts-bar-stack-layer",clipPath:n},r))},D6e=["onMouseEnter","onMouseLeave","onClick"],$6e=["value","background","tooltipPosition"],U6e=["id"],z6e=["onMouseEnter","onClick","onMouseLeave"];function nf(){return nf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nf.apply(null,arguments)}function xB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Jo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xB(Object(r),!0).forEach(function(n){W6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W6e(e,t,r){return(t=q6e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q6e(e){var t=H6e(e,"string");return typeof t=="symbol"?t:t+""}function H6e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yw(e,t){if(e==null)return{};var r,n,i=V6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function V6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var G6e=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Ah(r,t),payload:e}]},K6e=x.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:i,name:s,hide:o,unit:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:void 0,getPosition:np,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:t,nameKey:void 0,name:Ah(s,t),hide:o,type:c,color:i,unit:l,graphicalItemId:u}};return x.createElement(X_,{tooltipEntrySettings:d})});function Y6e(e){var t=wn(rf),{data:r,dataKey:n,background:i,allOtherBarProps:s}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=Yw(s,D6e),d=G_(o,n,s.id),f=K_(l),h=Y_(c,n,s.id);if(!i||r==null)return null;var p=gh(i);return x.createElement(xo,{zIndex:Z3e(i,Pa.barBackground)},r.map((m,g)=>{var{value:y,background:b,tooltipPosition:v}=m,w=Yw(m,$6e);if(!b)return null;var S=d(m,g),k=f(m,g),j=h(m,g),A=Jo(Jo(Jo(Jo(Jo({option:i,isActive:String(g)===t},w),{},{fill:"#eee"},b),p),dg(u,m,g)),{},{onMouseEnter:S,onMouseLeave:k,onClick:j,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return x.createElement(Kw,nf({key:"background-bar-".concat(g)},A))}))}function X6e(e){var{showLabels:t,children:r,rects:n}=e,i=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return Jo(Jo({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return x.createElement(u6,{value:t?i:void 0},r)}function Q6e(e){var{shape:t,activeBar:r,baseProps:n,entry:i,index:s,dataKey:o}=e,l=wn(rf),c=wn(i6),u=r&&String(s)===l&&(c==null||o===c),d=u?r:t;return u?x.createElement(xo,{zIndex:Pa.activeBar},x.createElement(nK,{index:s},x.createElement(Kw,nf({},n,{name:String(n.name)},i,{isActive:u,option:d,index:s,dataKey:o})))):x.createElement(Kw,nf({},n,{name:String(n.name)},i,{isActive:u,option:d,index:s,dataKey:o}))}function J6e(e){var{shape:t,baseProps:r,entry:n,index:i,dataKey:s}=e;return x.createElement(Kw,nf({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:i,dataKey:s}))}function Z6e(e){var t,{data:r,props:n}=e,i=(t=sl(n))!==null&&t!==void 0?t:{},{id:s}=i,o=Yw(i,U6e),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:h}=n,p=Yw(n,z6e),m=G_(d,c,s),g=K_(h),y=Y_(f,c,s);return r?x.createElement(x.Fragment,null,r.map((b,v)=>x.createElement(nK,nf({index:v,key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(v),className:"recharts-bar-rectangle"},dg(p,b,v),{onMouseEnter:m(b,v),onMouseLeave:g(b,v),onClick:y(b,v)}),u?x.createElement(Q6e,{shape:l,activeBar:u,baseProps:o,entry:b,index:v,dataKey:c}):x.createElement(J6e,{shape:l,baseProps:o,entry:b,index:v,dataKey:c})))):null}function eTe(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,h=pg(t,"recharts-bar-"),[p,m]=x.useState(!1),g=!p,y=x.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),b=x.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return x.createElement(X6e,{showLabels:g,rects:n},x.createElement(hg,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:y,onAnimationStart:b,key:h},v=>{var w=v===1?n:n==null?void 0:n.map((S,k)=>{var j=f&&f[k];if(j)return Jo(Jo({},S),{},{x:Vi(j.x,S.x,v),y:Vi(j.y,S.y,v),width:Vi(j.width,S.width,v),height:Vi(j.height,S.height,v)});if(i==="horizontal"){var A=Vi(0,S.height,v),L=Vi(S.stackedBarStart,S.y,v);return Jo(Jo({},S),{},{y:L,height:A})}var P=Vi(0,S.width,v),B=Vi(S.stackedBarStart,S.x,v);return Jo(Jo({},S),{},{width:P,x:B})});return v>0&&(r.current=w??null),w==null?null:x.createElement(ka,null,x.createElement(Z6e,{props:t,data:w}))}),x.createElement(M_,{label:t.label}),t.children)}function tTe(e){var t=x.useRef(null);return x.createElement(eTe,{previousRectanglesRef:t,props:e})}var iK=0,rTe=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Ai(e,t)}};class nTe extends x.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:i,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(t||r==null)return null;var d=bi("recharts-bar",i),f=u;return x.createElement(ka,{className:d,id:u},l&&x.createElement("defs",null,x.createElement(S6,{clipPathId:f,xAxisId:s,yAxisId:o})),x.createElement(ka,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},x.createElement(Y6e,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),x.createElement(tTe,this.props)))}}var iTe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:iK,xAxisId:0,yAxisId:0,zIndex:Pa.bar};function aTe(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:f}=Z_(t,r),h=ip(),p=Ls(),m=V_(e.children,op),g=wn(v=>O6e(v,e.id,p,m));if(h!=="vertical"&&h!=="horizontal")return null;var y,b=g==null?void 0:g[0];return b==null||b.height==null||b.width==null?y=0:y=h==="vertical"?b.height/2:b.width/2,x.createElement(w6,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:rTe,errorBarOffset:y},x.createElement(nTe,nf({},e,{layout:h,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function sTe(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:h,cells:p,parentViewBox:m,dataStartIndex:g}=e,y=t==="horizontal"?l:o,b=d?y.scale.domain():null,v=gve({numericAxis:y}),w=y.scale.map(v);return f.map((S,k)=>{var j,A,L,P,B,E;if(d){var T=d[k+g];if(T==null)return null;j=uve(T,b)}else j=Ai(S,r),Array.isArray(j)||(j=[v,j]);var F=m6e(n,iK)(j[1],k);if(t==="horizontal"){var W,z=l.scale.map(j[0]),se=l.scale.map(j[1]);if(z==null||se==null)return null;A=mL({axis:o,ticks:c,bandSize:s,offset:i.offset,entry:S,index:k}),L=(W=se??z)!==null&&W!==void 0?W:void 0,P=i.size;var de=z-se;if(B=id(de)?0:de,E={x:A,y:h.top,width:P,height:h.height},Math.abs(F)>0&&Math.abs(B)<Math.abs(F)){var U=Gs(B||F)*(Math.abs(F)-Math.abs(B));L-=U,B+=U}}else{var G=o.scale.map(j[0]),re=o.scale.map(j[1]);if(G==null||re==null)return null;if(A=G,L=mL({axis:l,ticks:u,bandSize:s,offset:i.offset,entry:S,index:k}),P=re-G,B=i.size,E={x:h.left,y:L,width:h.width,height:B},Math.abs(F)>0&&Math.abs(P)<Math.abs(F)){var X=Gs(P||F)*(Math.abs(F)-Math.abs(P));P+=X}}if(A==null||L==null||P==null||B==null)return null;var C=Jo(Jo({},S),{},{stackedBarStart:w,x:A,y:L,width:P,height:B,value:d?j:j[1],payload:S,background:E,tooltipPosition:{x:A+P/2,y:L+B/2},parentViewBox:m},p&&p[k]&&p[k].props);return C}).filter(Boolean)}function oTe(e){var t=ja(e,iTe),r=B6e(t.stackId),n=Ls();return x.createElement(Q_,{id:t.id,type:"bar"},i=>x.createElement(x.Fragment,null,x.createElement(g6,{legendPayload:G6e(t)}),x.createElement(K6e,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:i}),x.createElement(x6,{type:"bar",id:i,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),x.createElement(xo,{zIndex:t.zIndex},x.createElement(aTe,nf({},t,{id:i})))))}var $x=x.memo(oTe,By);$x.displayName="Bar";var lTe=["option","isActive"];function Ux(){return Ux=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ux.apply(null,arguments)}function cTe(e,t){if(e==null)return{};var r,n,i=uTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function uTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function dTe(e){var{option:t,isActive:r}=e,n=cTe(e,lTe);return typeof t=="string"?x.createElement(D1,Ux({option:x.createElement(qS,Ux({type:t},n)),isActive:r,shapeType:"symbols"},n)):x.createElement(D1,Ux({option:t,isActive:r,shapeType:"symbols"},n))}var fTe=(e,t,r,n,i,s,o)=>ld(e,"xAxis",t,o),hTe=(e,t,r,n,i,s,o)=>od(e,"xAxis",t,o),pTe=(e,t,r,n,i,s,o)=>ld(e,"yAxis",r,o),mTe=(e,t,r,n,i,s,o)=>od(e,"yAxis",r,o),gTe=(e,t,r,n)=>Nke(e,"zAxis",n,!1),xTe=(e,t,r,n,i)=>i,yTe=(e,t,r,n,i,s)=>s,bTe=(e,t,r,n,i,s,o)=>v_(e,void 0,void 0,o),vTe=Jt([Ny,xTe],(e,t)=>e.filter(r=>r.type==="scatter").find(r=>r.id===t)),wTe=Jt([bTe,fTe,hTe,pTe,mTe,gTe,vTe,yTe],(e,t,r,n,i,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=e;if(o!=null){var f;if((o==null?void 0:o.data)!=null&&o.data.length>0?f=o.data:f=c==null?void 0:c.slice(u,d+1),!(f==null||t==null||n==null||r==null||i==null||(r==null?void 0:r.length)===0||(i==null?void 0:i.length)===0))return RTe({displayedData:f,xAxis:t,yAxis:n,zAxis:s,scatterSettings:o,xAxisTicks:r,yAxisTicks:i,cells:l})}}),STe=["id"],_Te=["onMouseEnter","onClick","onMouseLeave"],kTe=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function nN(e,t){if(e==null)return{};var r,n,i=jTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function jTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I0.apply(null,arguments)}function yB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Sl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yB(Object(r),!0).forEach(function(n){ATe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ATe(e,t,r){return(t=NTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NTe(e){var t=CTe(e,"string");return typeof t=="symbol"?t:t+""}function CTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ETe=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Ah(r,t),payload:e}]},TTe=x.memo(e=>{var{dataKey:t,points:r,stroke:n,strokeWidth:i,fill:s,name:o,hide:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:r==null?void 0:r.map(f=>f.tooltipPayload),getPosition:f=>{var h;return r==null||(h=r[Number(f)])===null||h===void 0?void 0:h.tooltipPosition},settings:{stroke:n,strokeWidth:i,fill:s,nameKey:void 0,dataKey:t,name:Ah(o,t),hide:l,type:c,color:s,unit:"",graphicalItemId:u}};return x.createElement(X_,{tooltipEntrySettings:d})});function PTe(e){var{points:t,props:r}=e,{line:n,lineType:i,lineJointType:s}=r;if(!n)return null;var o=sl(r),l=gh(n),c,u;if(i==="joint")c=t.map(y=>{var b,v;return{x:(b=y.cx)!==null&&b!==void 0?b:null,y:(v=y.cy)!==null&&v!==void 0?v:null}});else if(i==="fitting"){var{xmin:d,xmax:f,a:h,b:p}=Q1e(t),m=y=>h*y+p;c=[{x:d,y:m(d)},{x:f,y:m(f)}]}var g=Sl(Sl(Sl({},o),{},{fill:"none",stroke:o&&o.fill},l),{},{points:c});return x.isValidElement(n)?u=x.cloneElement(n,g):typeof n=="function"?u=n(g):u=x.createElement(d_,I0({},g,{type:s})),x.createElement(ka,{className:"recharts-scatter-line",key:"recharts-scatter-line"},u)}function OTe(e){var{showLabels:t,points:r,children:n}=e,i=fg(),s=x.useMemo(()=>r==null?void 0:r.map(o=>{var l,c,u={x:(l=o.x)!==null&&l!==void 0?l:0,y:(c=o.y)!==null&&c!==void 0?c:0,width:o.width,height:o.height,lowerWidth:o.width,upperWidth:o.width};return Sl(Sl({},u),{},{value:void 0,payload:o.payload,viewBox:u,parentViewBox:i,fill:void 0})}),[i,r]);return x.createElement(u6,{value:t?s:void 0},n)}function MTe(e){var{points:t,allOtherScatterProps:r}=e,{shape:n,activeShape:i,dataKey:s}=r,{id:o}=r,l=nN(r,STe),c=wn(rf),{onMouseEnter:u,onClick:d,onMouseLeave:f}=r,h=nN(r,_Te),p=G_(u,s,o),m=K_(f),g=Y_(d,s,o);if(!cye(t))return null;var y=sl(l);return x.createElement(x.Fragment,null,x.createElement(PTe,{points:t,props:l}),t.map((b,v)=>{var w=i!=null&&i!==!1,S=w&&c===String(v),k=w&&S?i:n,j=Sl(Sl(Sl({},y),b),{},{index:v,[HC]:String(o)});return x.createElement(xo,{key:"symbol-".concat(b==null?void 0:b.cx,"-").concat(b==null?void 0:b.cy,"-").concat(b==null?void 0:b.size,"-").concat(v),zIndex:S?Pa.activeDot:void 0},x.createElement(ka,I0({className:"recharts-scatter-symbol"},dg(h,b,v),{onMouseEnter:p(b,v),onMouseLeave:m(b,v),onClick:g(b,v)}),x.createElement(dTe,I0({option:k,isActive:S},j))))}))}function LTe(e){var{previousPointsRef:t,props:r}=e,{points:n,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:l}=r,c=t.current,u=pg(r,"recharts-scatter-"),[d,f]=x.useState(!1),h=x.useCallback(()=>{f(!1)},[]),p=x.useCallback(()=>{f(!0)},[]),m=!d;return x.createElement(OTe,{showLabels:m,points:n},r.children,x.createElement(hg,{animationId:u,begin:s,duration:o,isActive:i,easing:l,onAnimationEnd:h,onAnimationStart:p,key:u},g=>{var y=g===1?n:n==null?void 0:n.map((b,v)=>{var w=c&&c[v];return w?Sl(Sl({},b),{},{cx:b.cx==null?void 0:Vi(w.cx,b.cx,g),cy:b.cy==null?void 0:Vi(w.cy,b.cy,g),size:Vi(w.size,b.size,g)}):Sl(Sl({},b),{},{size:Vi(0,b.size,g)})});return g>0&&(t.current=y),x.createElement(ka,null,x.createElement(MTe,{points:y,allOtherScatterProps:r,showLabels:m}))}),x.createElement(M_,{label:r.label}))}function RTe(e){var{displayedData:t,xAxis:r,yAxis:n,zAxis:i,scatterSettings:s,xAxisTicks:o,yAxisTicks:l,cells:c}=e,u=Gi(r.dataKey)?s.dataKey:r.dataKey,d=Gi(n.dataKey)?s.dataKey:n.dataKey,f=i&&i.dataKey,h=i?i.range:Fd.range,p=h&&h[0],m=r.scale.bandwidth?r.scale.bandwidth():0,g=n.scale.bandwidth?n.scale.bandwidth():0;return t.map((y,b)=>{var v=Ai(y,u),w=Ai(y,d),S=!Gi(f)&&Ai(y,f)||"-",k=[{name:Gi(r.dataKey)?s.name:r.name||String(r.dataKey),unit:r.unit||"",value:v,payload:y,dataKey:u,type:s.tooltipType},{name:Gi(n.dataKey)?s.name:n.name||String(n.dataKey),unit:n.unit||"",value:w,payload:y,dataKey:d,type:s.tooltipType}];S!=="-"&&i!=null&&k.push({name:i.name||i.dataKey,unit:i.unit||"",value:S,payload:y,dataKey:f,type:s.tooltipType});var j=xw({axis:r,ticks:o,bandSize:m,entry:y,index:b,dataKey:u}),A=xw({axis:n,ticks:l,bandSize:g,entry:y,index:b,dataKey:d}),L=S!=="-"&&i!=null?i.scale.map(S):p,P=L==null?0:Math.sqrt(Math.max(L,0)/Math.PI);return Sl(Sl({},y),{},{cx:j,cy:A,x:j==null?void 0:j-P,y:A==null?void 0:A-P,width:2*P,height:2*P,size:L,node:{x:v,y:w,z:S},tooltipPayload:k,tooltipPosition:{x:j,y:A},payload:y},c&&c[b]&&c[b].props)})}var BTe=(e,t,r)=>({x:e.cx,y:e.cy,value:Number(r==="x"?e.node.x:e.node.y),errorVal:Ai(e,t)});function FTe(e){var{hide:t,points:r,className:n,needClip:i,xAxisId:s,yAxisId:o,id:l}=e,c=x.useRef(null);if(t)return null;var u=bi("recharts-scatter",n),d=l;return x.createElement(xo,{zIndex:e.zIndex},x.createElement(ka,{className:u,clipPath:i?"url(#clipPath-".concat(d,")"):void 0,id:l},i&&x.createElement("defs",null,x.createElement(S6,{clipPathId:d,xAxisId:s,yAxisId:o})),x.createElement(w6,{xAxisId:s,yAxisId:o,data:r,dataPointFormatter:BTe,errorBarOffset:0},x.createElement(ka,{key:"recharts-scatter-symbols"},x.createElement(LTe,{props:e,previousPointsRef:c})))))}var aK={xAxisId:0,yAxisId:0,zAxisId:0,label:!1,line:!1,legendType:"circle",lineType:"joint",lineJointType:"linear",shape:"circle",hide:!1,isAnimationActive:"auto",animationBegin:0,animationDuration:400,animationEasing:"linear",zIndex:Pa.scatter};function ITe(e){var t=ja(e,aK),{animationBegin:r,animationDuration:n,animationEasing:i,hide:s,isAnimationActive:o,legendType:l,lineJointType:c,lineType:u,shape:d,xAxisId:f,yAxisId:h,zAxisId:p}=t,m=nN(t,kTe),{needClip:g}=Z_(f,h),y=x.useMemo(()=>V_(e.children,op),[e.children]),b=Ls(),v=wn(w=>wTe(w,f,h,p,e.id,y,b));return g==null||v==null?null:x.createElement(x.Fragment,null,x.createElement(TTe,{dataKey:e.dataKey,points:v,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:e.id}),x.createElement(FTe,I0({},m,{xAxisId:f,yAxisId:h,zAxisId:p,lineType:u,lineJointType:c,legendType:l,shape:d,hide:s,isAnimationActive:o,animationBegin:r,animationDuration:n,animationEasing:i,points:v,needClip:g})))}function DTe(e){var t=ja(e,aK),r=Ls();return x.createElement(Q_,{id:t.id,type:"scatter"},n=>x.createElement(x.Fragment,null,x.createElement(g6,{legendPayload:ETe(t)}),x.createElement(x6,{type:"scatter",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:t.zAxisId,dataKey:t.dataKey,hide:t.hide,name:t.name,tooltipType:t.tooltipType,isPanorama:r}),x.createElement(ITe,I0({},t,{id:n}))))}var sK=x.memo(DTe,By);sK.displayName="Scatter";var $Te=["domain","range"],UTe=["domain","range"];function bB(e,t){if(e==null)return{};var r,n,i=zTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function zTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vB(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function oK(e,t){if(e===t)return!0;var{domain:r,range:n}=e,i=bB(e,$Te),{domain:s,range:o}=t,l=bB(t,UTe);return!vB(r,s)||!vB(n,o)?!1:By(i,l)}var WTe=["type"],qTe=["dangerouslySetInnerHTML","ticks","scale"],HTe=["id","scale"];function iN(){return iN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iN.apply(null,arguments)}function wB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function SB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wB(Object(r),!0).forEach(function(n){VTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VTe(e,t,r){return(t=GTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GTe(e){var t=KTe(e,"string");return typeof t=="symbol"?t:t+""}function KTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aN(e,t){if(e==null)return{};var r,n,i=YTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function YTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function XTe(e){var t=Yi(),r=x.useRef(null),n=Bq(),{type:i}=e,s=aN(e,WTe),o=S_(n,"xAxis",i),l=x.useMemo(()=>{if(o!=null)return SB(SB({},s),{},{type:o})},[s,o]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(A3e(l)):r.current!==l&&t(N3e({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(C3e(r.current)),r.current=null)},[t]),null}var QTe=e=>{var{xAxisId:t,className:r}=e,n=wn(VC),i=Ls(),s="xAxis",o=wn(b=>OV(b,s,t,i)),l=wn(b=>CV(b,t)),c=wn(b=>wke(b,t)),u=wn(b=>cV(b,t));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:h}=e,p=aN(e,qTe),{id:m,scale:g}=u,y=aN(u,HTe);return x.createElement(v6,iN({},p,y,{x:c.x,y:c.y,width:l.width,height:l.height,className:bi("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},JTe={allowDataOverflow:Ds.allowDataOverflow,allowDecimals:Ds.allowDecimals,allowDuplicatedCategory:Ds.allowDuplicatedCategory,angle:Ds.angle,axisLine:Wd.axisLine,height:Ds.height,hide:!1,includeHidden:Ds.includeHidden,interval:Ds.interval,label:!1,minTickGap:Ds.minTickGap,mirror:Ds.mirror,orientation:Ds.orientation,padding:Ds.padding,reversed:Ds.reversed,scale:Ds.scale,tick:Ds.tick,tickCount:Ds.tickCount,tickLine:Wd.tickLine,tickSize:Wd.tickSize,type:Ds.type,xAxisId:0},ZTe=e=>{var t=ja(e,JTe);return x.createElement(x.Fragment,null,x.createElement(XTe,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),x.createElement(QTe,t))},Iy=x.memo(ZTe,oK);Iy.displayName="XAxis";var e8e=["type"],t8e=["dangerouslySetInnerHTML","ticks","scale"],r8e=["id","scale"];function sN(){return sN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sN.apply(null,arguments)}function _B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function kB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_B(Object(r),!0).forEach(function(n){n8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_B(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n8e(e,t,r){return(t=i8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i8e(e){var t=a8e(e,"string");return typeof t=="symbol"?t:t+""}function a8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oN(e,t){if(e==null)return{};var r,n,i=s8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function s8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function o8e(e){var t=Yi(),r=x.useRef(null),n=Bq(),{type:i}=e,s=oN(e,e8e),o=S_(n,"yAxis",i),l=x.useMemo(()=>{if(o!=null)return kB(kB({},s),{},{type:o})},[o,s]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(E3e(l)):r.current!==l&&t(T3e({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(P3e(r.current)),r.current=null)},[t]),null}function l8e(e){var{yAxisId:t,className:r,width:n,label:i}=e,s=x.useRef(null),o=x.useRef(null),l=wn(VC),c=Ls(),u=Yi(),d="yAxis",f=wn(j=>EV(j,t)),h=wn(j=>_ke(j,t)),p=wn(j=>OV(j,d,t,c)),m=wn(j=>uV(j,t));if(x.useLayoutEffect(()=>{if(!(n!=="auto"||!f||c6(i)||x.isValidElement(i)||m==null)){var j=s.current;if(j){var A=j.getCalculatedWidth();Math.round(f.width)!==Math.round(A)&&u(R3e({id:t,width:A}))}}},[p,f,u,i,t,n,m]),f==null||h==null||m==null)return null;var{dangerouslySetInnerHTML:g,ticks:y,scale:b}=e,v=oN(e,t8e),{id:w,scale:S}=m,k=oN(m,r8e);return x.createElement(v6,sN({},v,k,{ref:s,labelRef:o,x:h.x,y:h.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:bi("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:p,axisType:d}))}var c8e={allowDataOverflow:$s.allowDataOverflow,allowDecimals:$s.allowDecimals,allowDuplicatedCategory:$s.allowDuplicatedCategory,angle:$s.angle,axisLine:Wd.axisLine,hide:!1,includeHidden:$s.includeHidden,interval:$s.interval,label:!1,minTickGap:$s.minTickGap,mirror:$s.mirror,orientation:$s.orientation,padding:$s.padding,reversed:$s.reversed,scale:$s.scale,tick:$s.tick,tickCount:$s.tickCount,tickLine:Wd.tickLine,tickSize:Wd.tickSize,type:$s.type,width:$s.width,yAxisId:0},u8e=e=>{var t=ja(e,c8e);return x.createElement(x.Fragment,null,x.createElement(o8e,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),x.createElement(l8e,t))},Dy=x.memo(u8e,oK);Dy.displayName="YAxis";function d8e(e){var t=Yi(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(O3e(e)):r.current!==e&&t(M3e({prev:r.current,next:e})),r.current=e},[e,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(L3e(r.current)),r.current=null)},[t]),null}var f8e={zAxisId:0,range:Fd.range,scale:Fd.scale,type:Fd.type};function lK(e){var t=ja(e,f8e);return x.createElement(d8e,{domain:t.domain,id:t.zAxisId,dataKey:t.dataKey,name:t.name,unit:t.unit,range:t.range,scale:t.scale,type:t.type,allowDuplicatedCategory:Fd.allowDuplicatedCategory,allowDataOverflow:Fd.allowDataOverflow,reversed:Fd.reversed,includeHidden:Fd.includeHidden})}lK.displayName="ZAxis";var h8e=(e,t)=>t,k6=Jt([h8e,Ci,sV,Xs,YV,xf,$je,Ms],Gje),j6=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},cK=zc("mouseClick"),uK=gy();uK.startListening({actionCreator:cK,effect:(e,t)=>{var r=e.payload,n=k6(t.getState(),j6(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(Ike({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var lN=zc("mouseMove"),dK=gy(),xv=null;dK.startListening({actionCreator:lN,effect:(e,t)=>{var r=e.payload;xv!==null&&cancelAnimationFrame(xv);var n=j6(r);xv=requestAnimationFrame(()=>{var i=t.getState(),s=JE(i,i.tooltip.settings.shared);if(s==="axis"){var o=k6(i,n);(o==null?void 0:o.activeIndex)!=null?t.dispatch($V({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(DV())}xv=null})}});function p8e(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var jB={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},fK=Pl({name:"rootProps",initialState:jB,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:jB.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),m8e=fK.reducer,{updateOptions:g8e}=fK.actions,x8e=null,y8e={updatePolarOptions:(e,t)=>t.payload},hK=Pl({name:"polarOptions",initialState:x8e,reducers:y8e}),{updatePolarOptions:b8e}=hK.actions,v8e=hK.reducer,pK=zc("keyDown"),mK=zc("focus"),A6=gy();A6.startListening({actionCreator:pK,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=ZE(i,_g(r),Ey(r),Py(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=xf(r);if(s==="Enter"){var u=Uw(r,"axis","hover",String(i.index));t.dispatch(YA({active:!i.active,activeIndex:i.index,activeCoordinate:u}));return}var d=Cke(r),f=d==="left-to-right"?1:-1,h=s==="ArrowRight"?1:-1,p=l+h*f;if(!(c==null||p>=c.length||p<0)){var m=Uw(r,"axis","hover",String(p));t.dispatch(YA({active:!0,activeIndex:p.toString(),activeCoordinate:m}))}}}}}});A6.startListening({actionCreator:mK,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var s="0",o=Uw(r,"axis","hover",String(s));t.dispatch(YA({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var jc=zc("externalEvent"),gK=gy(),fj=new Map;gK.startListening({actionCreator:jc,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var i=n.type,s=fj.get(i);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=t.getState(),c={activeCoordinate:kje(l),activeDataKey:i6(l),activeIndex:rf(l),activeLabel:JV(l),activeTooltipIndex:rf(l),isTooltipActive:jje(l)};r(c,n)}finally{fj.delete(i)}});fj.set(i,o)}}});var w8e=Jt([wg],e=>e.tooltipItemPayloads),S8e=Jt([w8e,(e,t)=>t,(e,t,r)=>r],(e,t,r)=>{if(t!=null){var n=e.find(s=>s.settings.graphicalItemId===r);if(n!=null){var{getPosition:i}=n;if(i!=null)return i(t)}}}),xK=zc("touchMove"),yK=gy();yK.startListening({actionCreator:xK,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),i=JE(n,n.tooltip.settings.shared);if(i==="axis"){var s=r.touches[0];if(s==null)return;var o=k6(n,j6({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&t.dispatch($V({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(Cq),f=(l=u.getAttribute(HC))!==null&&l!==void 0?l:void 0,h=Sg(n).find(g=>g.id===f);if(d==null||h==null||f==null)return;var{dataKey:p}=h,m=S8e(n,d,f);t.dispatch(IV({activeDataKey:p,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var _8e=XW({brush:eCe,cartesianAxis:B3e,chartData:_4e,errorBars:uEe,graphicalItems:$Ne,layout:ave,legend:l2e,options:y4e,polarAxis:ZAe,polarOptions:v8e,referenceElements:lCe,rootProps:m8e,tooltip:Dke,zIndex:o4e}),k8e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return Tbe({reducer:_8e,preloadedState:t,middleware:n=>{var i;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((i="es6")!==null&&i!==void 0?i:"")}).concat([uK.middleware,dK.middleware,A6.middleware,gK.middleware,yK.middleware])},enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(dq({type:"raf"}))},devTools:{serialize:{replacer:p8e},name:"recharts-".concat(r)}})};function bK(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,i=Ls(),s=x.useRef(null);if(i)return r;s.current==null&&(s.current=k8e(t,n));var o=BC;return x.createElement(WEe,{context:o,store:s.current},r)}function j8e(e){var{layout:t,margin:r}=e,n=Yi(),i=Ls();return x.useEffect(()=>{i||(n(rve(t)),n(tve(r)))},[n,i,t,r]),null}var vK=x.memo(j8e,By);function wK(e){var t=Yi();return x.useEffect(()=>{t(g8e(e))},[t,e]),null}function AB(e){var{zIndex:t,isPanorama:r}=e,n=x.useRef(null),i=Yi();return x.useLayoutEffect(()=>(n.current&&i(a4e({zIndex:t,element:n.current,isPanorama:r})),()=>{i(s4e({zIndex:t,isPanorama:r}))}),[i,t,r]),x.createElement("g",{tabIndex:-1,ref:n})}function NB(e){var{children:t,isPanorama:r}=e,n=wn(Yje);if(!n||n.length===0)return t;var i=n.filter(o=>o<0),s=n.filter(o=>o>0);return x.createElement(x.Fragment,null,i.map(o=>x.createElement(AB,{key:o,zIndex:o,isPanorama:r})),t,s.map(o=>x.createElement(AB,{key:o,zIndex:o,isPanorama:r})))}var A8e=["children"];function N8e(e,t){if(e==null)return{};var r,n,i=C8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function C8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Xw(){return Xw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xw.apply(null,arguments)}var E8e={width:"100%",height:"100%",display:"block"},T8e=x.forwardRef((e,t)=>{var r=YC(),n=XC(),i=Kq();if(!ad(r)||!ad(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=e,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=i?0:void 0,typeof o.role=="string"?d=o.role:d=i?"application":void 0),x.createElement(SC,Xw({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:E8e,ref:t}),s)}),P8e=e=>{var{children:t}=e,r=wn(o_);if(!r)return null;var{width:n,height:i,y:s,x:o}=r;return x.createElement(SC,{width:n,height:i,x:o,y:s},t)},CB=x.forwardRef((e,t)=>{var{children:r}=e,n=N8e(e,A8e),i=Ls();return i?x.createElement(P8e,null,x.createElement(NB,{isPanorama:!0},r)):x.createElement(T8e,Xw({ref:t},n),x.createElement(NB,{isPanorama:!1},r))});function O8e(){var e=Yi(),[t,r]=x.useState(null),n=wn(Sve);return x.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),s=i.width/t.offsetWidth;di(s)&&s!==n&&e(ive(s))}},[t,e,n]),r}function EB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function M8e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?EB(Object(r),!0).forEach(function(n){L8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):EB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L8e(e,t,r){return(t=R8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R8e(e){var t=B8e(e,"string");return typeof t=="symbol"?t:t+""}function B8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sh(){return sh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sh.apply(null,arguments)}var F8e=()=>(O4e(),null);function Qw(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var I8e=x.forwardRef((e,t)=>{var r,n,i=x.useRef(null),[s,o]=x.useState({containerWidth:Qw((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Qw((n=e.style)===null||n===void 0?void 0:n.height)}),l=x.useCallback((u,d)=>{o(f=>{var h=Math.round(u),p=Math.round(d);return f.containerWidth===h&&f.containerHeight===p?f:{containerWidth:h,containerHeight:p}})},[]),c=x.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var h=m=>{var g=m[0];if(g!=null){var{width:y,height:b}=g.contentRect;l(y,b)}},p=new ResizeObserver(h);p.observe(u),i.current=p}},[t,l]);return x.useEffect(()=>()=>{var u=i.current;u!=null&&u.disconnect()},[l]),x.createElement(x.Fragment,null,x.createElement(by,{width:s.containerWidth,height:s.containerHeight}),x.createElement("div",sh({ref:c},e)))}),D8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e,[i,s]=x.useState({containerWidth:Qw(r),containerHeight:Qw(n)}),o=x.useCallback((c,u)=>{s(d=>{var f=Math.round(c),h=Math.round(u);return d.containerWidth===f&&d.containerHeight===h?d:{containerWidth:f,containerHeight:h}})},[]),l=x.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[t,o]);return x.createElement(x.Fragment,null,x.createElement(by,{width:i.containerWidth,height:i.containerHeight}),x.createElement("div",sh({ref:l},e)))}),$8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return x.createElement(x.Fragment,null,x.createElement(by,{width:r,height:n}),x.createElement("div",sh({ref:t},e)))}),U8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return typeof r=="string"||typeof n=="string"?x.createElement(D8e,sh({},e,{ref:t})):typeof r=="number"&&typeof n=="number"?x.createElement($8e,sh({},e,{width:r,height:n,ref:t})):x.createElement(x.Fragment,null,x.createElement(by,{width:r,height:n}),x.createElement("div",sh({ref:t},e)))});function z8e(e){return e?I8e:U8e}var W8e=x.forwardRef((e,t)=>{var{children:r,className:n,height:i,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:h,onTouchEnd:p,onTouchMove:m,onTouchStart:g,style:y,width:b,responsive:v,dispatchTouchEvents:w=!0}=e,S=x.useRef(null),k=Yi(),[j,A]=x.useState(null),[L,P]=x.useState(null),B=O8e(),E=GC(),T=(E==null?void 0:E.width)>0?E.width:b,F=(E==null?void 0:E.height)>0?E.height:i,W=x.useCallback(Q=>{B(Q),typeof t=="function"&&t(Q),A(Q),P(Q),Q!=null&&(S.current=Q)},[B,t,A,P]),z=x.useCallback(Q=>{k(cK(Q)),k(jc({handler:s,reactEvent:Q}))},[k,s]),se=x.useCallback(Q=>{k(lN(Q)),k(jc({handler:u,reactEvent:Q}))},[k,u]),de=x.useCallback(Q=>{k(DV()),k(jc({handler:d,reactEvent:Q}))},[k,d]),U=x.useCallback(Q=>{k(lN(Q)),k(jc({handler:f,reactEvent:Q}))},[k,f]),G=x.useCallback(()=>{k(mK())},[k]),re=x.useCallback(Q=>{k(pK(Q.key))},[k]),X=x.useCallback(Q=>{k(jc({handler:o,reactEvent:Q}))},[k,o]),C=x.useCallback(Q=>{k(jc({handler:l,reactEvent:Q}))},[k,l]),K=x.useCallback(Q=>{k(jc({handler:c,reactEvent:Q}))},[k,c]),V=x.useCallback(Q=>{k(jc({handler:h,reactEvent:Q}))},[k,h]),R=x.useCallback(Q=>{k(jc({handler:g,reactEvent:Q}))},[k,g]),J=x.useCallback(Q=>{w&&k(xK(Q)),k(jc({handler:m,reactEvent:Q}))},[k,w,m]),q=x.useCallback(Q=>{k(jc({handler:p,reactEvent:Q}))},[k,p]),Y=z8e(v);return x.createElement(aG.Provider,{value:j},x.createElement(Yz.Provider,{value:L},x.createElement(Y,{width:T??(y==null?void 0:y.width),height:F??(y==null?void 0:y.height),className:bi("recharts-wrapper",n),style:M8e({position:"relative",cursor:"default",width:T,height:F},y),onClick:z,onContextMenu:X,onDoubleClick:C,onFocus:G,onKeyDown:re,onMouseDown:K,onMouseEnter:se,onMouseLeave:de,onMouseMove:U,onMouseUp:V,onTouchEnd:q,onTouchMove:J,onTouchStart:R,ref:W},x.createElement(F8e,null),r)))}),q8e=["width","height","responsive","children","className","style","compact","title","desc"];function H8e(e,t){if(e==null)return{};var r,n,i=V8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function V8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var SK=x.forwardRef((e,t)=>{var{width:r,height:n,responsive:i,children:s,className:o,style:l,compact:c,title:u,desc:d}=e,f=H8e(e,q8e),h=sl(f);return c?x.createElement(x.Fragment,null,x.createElement(by,{width:r,height:n}),x.createElement(CB,{otherAttributes:h,title:u,desc:d},s)):x.createElement(W8e,{className:o,style:l,width:r,height:n,responsive:i??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},x.createElement(CB,{otherAttributes:h,title:u,desc:d,ref:t},x.createElement(cCe,null,s)))});function cN(){return cN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cN.apply(null,arguments)}var G8e={top:5,right:5,bottom:5,left:5},K8e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:G8e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},N6=x.forwardRef(function(t,r){var n,i=ja(t.categoricalChartProps,K8e),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return x.createElement(bK,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},x.createElement(UG,{chartData:u.data}),x.createElement(vK,{layout:i.layout,margin:i.margin}),x.createElement(wK,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),x.createElement(SK,cN({},i,{ref:r})))}),Y8e=["axis"],X8e=x.forwardRef((e,t)=>x.createElement(N6,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Y8e,tooltipPayloadSearcher:P_,categoricalChartProps:e,ref:t})),Q8e=["axis","item"],_K=x.forwardRef((e,t)=>x.createElement(N6,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Q8e,tooltipPayloadSearcher:P_,categoricalChartProps:e,ref:t}));function J8e(e){var t=Yi();return x.useEffect(()=>{t(b8e(e))},[t,e]),null}var Z8e=["layout"];function uN(){return uN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uN.apply(null,arguments)}function ePe(e,t){if(e==null)return{};var r,n,i=tPe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function tPe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rPe={top:5,right:5,bottom:5,left:5},kK={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:rPe,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},nPe=x.forwardRef(function(t,r){var n,i=ja(t.categoricalChartProps,kK),{layout:s}=i,o=ePe(i,Z8e),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return x.createElement(bK,{preloadedState:{options:f},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:l},x.createElement(UG,{chartData:i.data}),x.createElement(vK,{layout:s,margin:i.margin}),x.createElement(wK,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),x.createElement(J8e,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),x.createElement(SK,uN({},o,{ref:r})))});function TB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function PB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TB(Object(r),!0).forEach(function(n){iPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iPe(e,t,r){return(t=aPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aPe(e){var t=sPe(e,"string");return typeof t=="symbol"?t:t+""}function sPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oPe=["item"],lPe=PB(PB({},kK),{},{layout:"centric",startAngle:0,endAngle:360}),cPe=x.forwardRef((e,t)=>{var r=ja(e,lPe);return x.createElement(nPe,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:oPe,tooltipPayloadSearcher:P_,categoricalChartProps:r,ref:t})}),uPe=["item"],dPe=x.forwardRef((e,t)=>x.createElement(N6,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:uPe,tooltipPayloadSearcher:P_,categoricalChartProps:e,ref:t}));function hj(e,t){try{const r=Jn(`${t}_${e}`);if(!r)return null;if(r.rowsByStudentId&&typeof r.rowsByStudentId=="object")return r.rowsByStudentId;if(Array.isArray(r.rows)){const n={};return r.rows.forEach(i=>{n[String(i.studentId||i.id||"")]=i}),n}if(Array.isArray(r)){const n={};return r.forEach(i=>{n[String(i.studentId||i.id||"")]=i}),n}return typeof r=="object"?r:null}catch{return null}}function pj(e){if(!e)return null;for(const t of["total","mark","score","marks"])if(typeof e[t]=="number")return e[t];return null}const dN=58;function rx({title:e,subtitle:t,children:r}){return a.jsxs("div",{className:"obe-card",style:{padding:"18px 18px 14px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:14},children:[a.jsx("div",{style:{fontWeight:800,fontSize:15,color:"#0f172a"},children:e}),t&&a.jsx("div",{style:{fontSize:11,color:"#94a3b8",fontWeight:600},children:t})]}),r]})}function $y(){return a.jsxs("div",{style:{textAlign:"center",padding:"32px 0",color:"#94a3b8",fontSize:13},children:[a.jsx("svg",{width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"#cbd5e1",strokeWidth:1.5,style:{margin:"0 auto 6px",display:"block"},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v18h18M7 16l4-5 4 3 4-6"})}),"No marks saved yet"]})}function fPe(e){const t=hj(e,"cia1_sheet"),r=hj(e,"cia2_sheet"),n=hj(e,"model_sheet"),i=new Set;return[t,r,n].forEach(s=>s&&Object.keys(s).forEach(o=>i.add(o))),Array.from(i).map(s=>{const o=t!=null&&t[s]?pj(t[s]):null,l=r!=null&&r[s]?pj(r[s]):null,c=n!=null&&n[s]?pj(n[s]):null,u=[o,l,c].filter(f=>f!==null),d=u.length?u.reduce((f,h)=>f+h,0)/u.length:null;return{id:s,cia1:o??void 0,cia2:l??void 0,model:c??void 0,avg:d??void 0}})}function hPe({students:e}){const t=e.filter(c=>typeof c.avg=="number"),r=t.length,n=t.filter(c=>(c.avg??0)>=dN).length,i=r?t.reduce((c,u)=>c+(u.avg??0),0)/r:0,s=r?Math.max(...t.map(c=>c.avg??0)):0,o=r?Math.min(...t.map(c=>c.avg??0)):0,l=[{label:"Total Students",value:r,color:"#0b74b8"},{label:"Passed",value:n,color:"#10b981"},{label:"Class Avg",value:i.toFixed(1),color:"#f59e0b"},{label:"Highest",value:s.toFixed(1),color:"#8b5cf6"},{label:"Lowest",value:o.toFixed(1),color:"#ef4444"}];return a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12,marginBottom:14},children:l.map(c=>a.jsxs("div",{style:{flex:"1 1 120px",background:"#fff",borderRadius:12,padding:"14px 18px",boxShadow:"0 2px 8px rgba(0,0,0,0.07)",borderLeft:`4px solid ${c.color}`},children:[a.jsx("div",{style:{fontSize:22,fontWeight:900,color:c.color},children:c.value}),a.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:2,fontWeight:600},children:c.label})]},c.label))})}function pPe({students:e}){const t=n=>{const i=n.filter(s=>typeof s=="number");return i.length?Math.round(i.reduce((s,o)=>s+o,0)/i.length*10)/10:0},r=[{name:"CIA 1",average:t(e.map(n=>n.cia1))},{name:"CIA 2",average:t(e.map(n=>n.cia2))},{name:"Model",average:t(e.map(n=>n.model))}];return e.length===0?a.jsx($y,{}):a.jsx(yy,{width:"100%",height:220,children:a.jsxs(X8e,{data:r,margin:{top:10,right:20,left:0,bottom:5},children:[a.jsx(Ly,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(Iy,{dataKey:"name",tick:{fontSize:12,fill:"#475569"}}),a.jsx(Dy,{domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),a.jsx(My,{contentStyle:{borderRadius:10,fontSize:13}}),a.jsx(eK,{type:"monotone",dataKey:"average",stroke:"#0b74b8",strokeWidth:3,dot:{r:6,fill:"#ff8c42",stroke:"#fff",strokeWidth:2},activeDot:{r:8}})]})})}const OB=["#ef4444","#f59e0b","#06b6d4","#10b981"];function mPe({students:e}){const t={"Fail (<58)":0,"5864":0,"6574":0,"75+":0};e.forEach(s=>{const o=s.avg??0;o<58?t["Fail (<58)"]+=1:o<65?t["5864"]+=1:o<75?t["6574"]+=1:t["75+"]+=1});const r=Object.entries(t).map(([s,o])=>({name:s,value:o})).filter(s=>s.value>0),n=e.filter(s=>typeof s.avg=="number").length,i=n?Math.round((n-t["Fail (<58)"])/n*100):0;return r.length===0?a.jsx($y,{}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{textAlign:"center",marginBottom:4},children:[a.jsxs("span",{style:{fontSize:28,fontWeight:900,color:i>=75?"#10b981":"#f59e0b"},children:[i,"%"]}),a.jsx("span",{style:{fontSize:12,color:"#64748b",marginLeft:6},children:"Pass Rate"})]}),a.jsx(yy,{width:"100%",height:200,children:a.jsxs(cPe,{children:[a.jsx(IG,{data:r,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"value",label:({name:s,percent:o})=>`${s} ${(o*100).toFixed(0)}%`,labelLine:!1,children:r.map((s,o)=>a.jsx(op,{fill:OB[o%OB.length]},o))}),a.jsx(My,{}),a.jsx(ZC,{iconType:"circle",iconSize:10})]})})]})}function gPe({students:e}){const t=[...e].filter(n=>typeof n.avg=="number").sort((n,i)=>(i.avg??0)-(n.avg??0)),r=[...t.slice(0,5).map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Top"})),...t.slice(-5).reverse().map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Bottom"}))];return r.length===0?a.jsx($y,{}):a.jsx(yy,{width:"100%",height:260,children:a.jsxs(_K,{data:r,layout:"vertical",margin:{top:4,right:24,left:8,bottom:4},children:[a.jsx(Ly,{strokeDasharray:"3 3",horizontal:!1,stroke:"#e2e8f0"}),a.jsx(Iy,{type:"number",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),a.jsx(Dy,{dataKey:"id",type:"category",tick:{fontSize:11,fill:"#475569"},width:56}),a.jsx(My,{contentStyle:{borderRadius:10,fontSize:13}}),a.jsx($x,{dataKey:"avg",radius:[0,6,6,0],children:r.map((n,i)=>a.jsx(op,{fill:n.group==="Top"?"#0b74b8":"#ef4444"},i))})]})})}function xPe({students:e}){const t=e.filter(r=>r.cia1!=null||r.cia2!=null||r.model!=null).slice(0,25).map(r=>({id:r.id.slice(-5),CIA1:r.cia1!=null?+r.cia1.toFixed(1):null,CIA2:r.cia2!=null?+r.cia2.toFixed(1):null,Model:r.model!=null?+r.model.toFixed(1):null}));return t.length===0?a.jsx($y,{}):a.jsx(yy,{width:"100%",height:240,children:a.jsxs(_K,{data:t,margin:{top:10,right:10,left:0,bottom:20},children:[a.jsx(Ly,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(Iy,{dataKey:"id",tick:{fontSize:9,fill:"#475569"},angle:-45,textAnchor:"end",interval:0}),a.jsx(Dy,{domain:[0,100],tick:{fontSize:10,fill:"#94a3b8"}}),a.jsx(My,{contentStyle:{borderRadius:10,fontSize:12}}),a.jsx(ZC,{iconType:"circle",iconSize:9}),a.jsx($x,{dataKey:"CIA1",fill:"#0b74b8",radius:[3,3,0,0]}),a.jsx($x,{dataKey:"CIA2",fill:"#06b6d4",radius:[3,3,0,0]}),a.jsx($x,{dataKey:"Model",fill:"#f59e0b",radius:[3,3,0,0]})]})})}function yPe({students:e}){const t=e.filter(r=>r.cia1!=null&&r.cia2!=null).map(r=>({x:+(r.cia1??0).toFixed(1),y:+(r.cia2??0).toFixed(1),id:r.id}));return t.length===0?a.jsx($y,{}):a.jsx(yy,{width:"100%",height:220,children:a.jsxs(dPe,{margin:{top:10,right:20,left:0,bottom:10},children:[a.jsx(Ly,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(Iy,{type:"number",dataKey:"x",name:"CIA1",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 1",position:"insideBottom",offset:-6,fontSize:11,fill:"#475569"}}),a.jsx(Dy,{type:"number",dataKey:"y",name:"CIA2",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 2",angle:-90,position:"insideLeft",fontSize:11,fill:"#475569"}}),a.jsx(lK,{range:[40,40]}),a.jsx(My,{cursor:{strokeDasharray:"3 3"},contentStyle:{borderRadius:10,fontSize:12},content:({payload:r})=>{var n,i,s,o,l,c;return r!=null&&r.length?a.jsxs("div",{style:{background:"#fff",padding:"6px 10px",borderRadius:8,fontSize:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[a.jsx("div",{children:a.jsx("b",{children:(i=(n=r[0])==null?void 0:n.payload)==null?void 0:i.id})}),a.jsxs("div",{children:["CIA1: ",(o=(s=r[0])==null?void 0:s.payload)==null?void 0:o.x,"  CIA2: ",(c=(l=r[0])==null?void 0:l.payload)==null?void 0:c.y]})]}):null}}),a.jsx(eN,{x:dN,stroke:"#ef4444",strokeDasharray:"5 3",label:{value:"Fail",fill:"#ef4444",fontSize:10}}),a.jsx(eN,{y:dN,stroke:"#ef4444",strokeDasharray:"5 3"}),a.jsx(sK,{data:t,fill:"#0b74b8",opacity:.75})]})})}function bPe({subjectId:e}){const t=String(e||""),r=x.useMemo(()=>fPe(t),[t]);return a.jsxs("div",{style:{padding:"4px 0"},children:[a.jsx(hPe,{students:r}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:16},children:[a.jsx(rx,{title:"Trend Over Time",subtitle:"Class avg per assessment",children:a.jsx(pPe,{students:r})}),a.jsx(rx,{title:"Grade Distribution",subtitle:"Pass rate (fail < 58)",children:a.jsx(mPe,{students:r})}),a.jsx(rx,{title:"Top vs Bottom Performers",subtitle:"Avg marks (last 5 digits of ID)",children:a.jsx(gPe,{students:r})}),a.jsx(rx,{title:"CIA1 vs CIA2 Scatter",subtitle:"Each dot = one student",children:a.jsx(yPe,{students:r})}),a.jsx(rx,{title:"Per-Student Assessment Comparison",subtitle:"First 25 students  CIA1 / CIA2 / Model",children:a.jsx(xPe,{students:r})})]})]})}const vPe=["ssa1","formative1","ssa2","formative2","cia1","cia2"];function wPe({teachingAssignmentId:e,onSaved:t,onClose:r}){var E;const[n,i]=x.useState(!1),[s,o]=x.useState(!1),[l,c]=x.useState(new Set),[u,d]=x.useState(null),[f,h]=x.useState(!1),[p,m]=x.useState(null),g=x.useRef(null);x.useEffect(()=>{let T=!0;if(e)return(async()=>{i(!0);try{const F=await fm(Number(e));if(!T)return;c(new Set((F==null?void 0:F.enabled_assessments)||[])),d((F==null?void 0:F.meta)||null),m(null)}catch(F){m((F==null?void 0:F.message)||"Failed to load")}finally{T&&i(!1)}})(),()=>{T=!1}},[e]),x.useEffect(()=>{var W;if(!e||(u==null?void 0:u.mode)!=="SPECIAL_GLOBAL"||((W=u==null?void 0:u.edit_request)==null?void 0:W.status)!=="PENDING")return;let T=!1;const F=window.setInterval(async()=>{try{const z=await fm(Number(e));if(T)return;c(new Set((z==null?void 0:z.enabled_assessments)||[])),d((z==null?void 0:z.meta)||null)}catch{}},4e3);return()=>{T=!0,window.clearInterval(F)}},[e,u==null?void 0:u.mode,(E=u==null?void 0:u.edit_request)==null?void 0:E.status]);const y=!!(u!=null&&u.locked),b=(u==null?void 0:u.can_edit)!==!1,v=y&&!b,w=(u==null?void 0:u.edit_request)||null,k=String((w==null?void 0:w.status)||"").toUpperCase()==="PENDING";x.useEffect(()=>{if((u==null?void 0:u.mode)!=="SPECIAL_GLOBAL")return;const T=g.current;g.current=b,T===!1&&b===!0&&alert("IQAC approval granted. You can now edit and re-save the enabled exams.")},[b,u==null?void 0:u.mode]);const j=T=>{v||c(F=>{const W=new Set(F);return W.has(T)?W.delete(T):W.add(T),W})},A=async()=>{if(e){o(!0);try{const T=Array.from(l.values()),F=await u9(Number(e),T),W=(F==null?void 0:F.enabled_assessments)||[];c(new Set(W)),d((F==null?void 0:F.meta)||u),m(null),t&&t(W),alert("Saved enabled assessments.")}catch(T){m((T==null?void 0:T.message)||"Save failed"),alert("Save failed: "+((T==null?void 0:T.message)||""))}finally{o(!1)}}},L=async T=>{if(e){h(!0);try{const F=await d9(Number(e));d(W=>({...W||{},locked:!0,can_edit:!1,edit_request:F||{status:"PENDING"}})),alert(T?"Request is already pending. Synced status with server.":"Edit request sent to IQAC for approval.")}catch(F){m((F==null?void 0:F.message)||"Failed to request edit"),alert("Edit request failed: "+((F==null?void 0:F.message)||""))}finally{h(!1)}}},P=async()=>{await L(k),await B()},B=async()=>{if(e)try{i(!0);const T=await fm(Number(e));c(new Set((T==null?void 0:T.enabled_assessments)||[])),d((T==null?void 0:T.meta)||null),m(null)}catch(T){m((T==null?void 0:T.message)||"Failed to refresh")}finally{i(!1)}};return a.jsxs("div",{style:{border:"1px solid #e5e7eb",padding:12,borderRadius:8,background:"#ffffff",maxWidth:520},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[a.jsx("div",{style:{fontWeight:700},children:"Select Exams for this Assignment"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"?"Special course (global lock)":"Faculty override"})]}),(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&y&&a.jsxs("div",{style:{fontSize:12,color:v?"#92400e":"#065f46",marginBottom:8},children:[v?"Locked after first save. Edit requires IQAC approval.":"Editing permitted (approved by IQAC/admin).",w!=null&&w.status?a.jsxs("span",{style:{marginLeft:8,color:"#6b7280"},children:["Request: ",String(w.status)]}):null]}),n?a.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0,1fr))",gap:8},children:vPe.map(T=>a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("input",{type:"checkbox",checked:l.has(T),onChange:()=>j(T),disabled:v||s}),a.jsx("span",{style:{textTransform:"uppercase",fontSize:13},children:T.toUpperCase()})]},T))}),p&&a.jsx("div",{style:{color:"#b91c1c",marginTop:8},children:p}),a.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[!v&&a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:A,disabled:s||n||!e,children:s?"Saving":"Save"}),v&&(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:P,disabled:f||s||n||!e,title:k?"Request already pending. Wait for IQAC approval.":void 0,children:f?"Requesting":k?"Edit Request Pending":"Edit (Request IQAC Approval)"}),a.jsx("button",{className:"obe-btn",onClick:B,disabled:s||n||!e,children:"Refresh"})]}),a.jsx("button",{className:"obe-btn",onClick:()=>r&&r(),disabled:s,children:"Close"})]})]})}function SPe({teachingAssignmentId:e}){var u,d,f;const[t,r]=x.useState([]),[n,i]=x.useState(!1);x.useEffect(()=>{let h=!0;return(async()=>{try{const p=await l9(e);if(!h)return;const m=p.filter(g=>g.teaching_assignment_id===e);r(m),m.length===0&&i(!0)}catch(p){console.error("Failed to fetch reset notifications:",p),h&&i(!0)}})(),()=>{h=!1}},[e]);const s=async()=>{if(t.length!==0)try{const h=t.map(p=>p.id);await c9(h),i(!0)}catch(h){console.error("Failed to dismiss notifications:",h),i(!0)}};if(n||t.length===0)return null;const o={ssa1:"SSA1",review1:"Review 1",ssa2:"SSA2",review2:"Review 2",cia1:"CIA1",cia2:"CIA2",formative1:"Formative 1",formative2:"Formative 2",model:"Model Exam"},c=[...new Set(t.map(h=>h.assessment))].map(h=>o[h]||h).join(", ");return a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:s,children:a.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,maxWidth:500,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onClick:h=>h.stopPropagation(),children:[a.jsx("h3",{style:{margin:0,marginBottom:12,color:"#dc2626",fontSize:18,fontWeight:800},children:" Course Reset by IQAC"}),a.jsx("p",{style:{margin:0,marginBottom:16,color:"#374151",lineHeight:1.6},children:"The following assessment(s) have been reset by the IQAC administrator:"}),a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:12,marginBottom:16},children:[a.jsxs("div",{style:{fontWeight:700,color:"#991b1b",marginBottom:6},children:[(u=t[0])==null?void 0:u.subject_code,"  ",(d=t[0])==null?void 0:d.subject_name]}),a.jsxs("div",{style:{fontSize:14,color:"#7f1d1d"},children:["Section: ",((f=t[0])==null?void 0:f.section_name)||""]}),a.jsxs("div",{style:{fontSize:14,color:"#7f1d1d",marginTop:4},children:["Assessments: ",c]})]}),a.jsx("p",{style:{margin:0,marginBottom:16,color:"#6b7280",fontSize:14},children:"All previously entered data for these assessment(s) has been cleared. You will need to re-enter the marks."}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:s,style:{minWidth:80},children:"OK"})})]})})}function _Pe(e){return String(e).startsWith("cqi_")?null:e==="ssa1"?"ssa1":e==="review1"?"review1":e==="ssa2"?"ssa2":e==="review2"?"review2":e==="formative1"?"formative1":e==="formative2"?"formative2":e==="cia1"?"cia1":e==="cia2"?"cia2":e==="model"?"model":null}const nx=[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"formative1",label:"Formative 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"formative2",label:"Formative 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}];function kPe(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?{showAfter:"cia1",assessmentType:"cia1",cos:["CO1","CO2"]}:t==="cia2_co3_co4"?{showAfter:"cia2",assessmentType:"cia2",cos:["CO3","CO4"]}:t==="model_co1_co2_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO1","CO2","CO3","CO4","CO5"]}:t==="model_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO3","CO4","CO5"]}:t==="model_co5"?{showAfter:"model",assessmentType:"model",cos:["CO5"]}:null}function jPe(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function APe(e,t){const r=ti(e),n=jPe(t);if(r==="SPECIAL"){const i=new Set(["dashboard"]);return["ssa1","ssa2","formative1","formative2","cia1","cia2"].forEach(s=>{n.has(s)&&i.add(s)}),nx.filter(s=>i.has(s.key))}return r==="PRACTICAL"?nx.filter(i=>["dashboard","cia1","cia2","model"].includes(i.key)).map(i=>i.key==="cia1"?{...i,label:"CIA 1 Review"}:i.key==="cia2"?{...i,label:"CIA 2 Review"}:i.key==="model"?{...i,label:"MODEL Review"}:i):r==="PROJECT"?[{key:"dashboard",label:"Dashboard"},{key:"review1",label:"Review 1"},{key:"review2",label:"Review 2"},{key:"model",label:"MODEL Review"}]:r==="TCPR"?[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"review1",label:"Review 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"review2",label:"Review 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}]:r==="TCPL"?nx.map(i=>i.key==="formative1"?{...i,label:"LAB 1"}:i.key==="formative2"?{...i,label:"LAB 2"}:i):r==="LAB"?nx.filter(i=>["dashboard","cia1","cia2","model"].includes(i.key)).map(i=>i.key==="cia1"?{...i,label:"CIA 1 LAB"}:i.key==="cia2"?{...i,label:"CIA 2 LAB"}:i.key==="model"?{...i,label:"MODEL LAB"}:i):nx}function jK(e,t){return`marks_${e}_${t}`}function NPe(e,t){const r=String(t||"").trim().toLowerCase();Pu(`marks_${e}_${r}`),r==="ssa1"&&Pu(`ssa1_sheet_${e}`),r==="review1"&&Pu(`review1_sheet_${e}`),r==="ssa2"&&Pu(`ssa2_sheet_${e}`),r==="review2"&&Pu(`review2_sheet_${e}`),r==="formative1"&&Pu(`formative1_sheet_${e}`),r==="formative2"&&Pu(`formative2_sheet_${e}`),r==="cia1"&&Pu(`cia1_sheet_${e}`),r==="cia2"&&Pu(`cia2_sheet_${e}`),r==="model"&&Pu(`model_sheet_${e}`)}function CPe(e,t){const r=`studentId,mark
`,n=t.map(l=>`${String(l.studentId||"").replace(/\n/g," ")},${Number(l.mark||0)}`).join(`
`),i=new Blob([r+n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function EPe({active:e,label:t,onClick:r}){return a.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""}`,children:t})}function TPe({active:e,label:t,onClick:r,isCqi:n,uniqueId:i}){return a.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""} ${n?"cqi-floating-btn":""}`,...i?{"data-cqi-id":i}:{},children:t})}function PPe({subjectId:e,tab:t}){const r=x.useMemo(()=>jK(e,t),[e,t]),[n,i]=x.useState([]);x.useEffect(()=>{const d=Jn(r)||[];i(Array.isArray(d)?d:[])},[r]);const s=()=>i(d=>[...d,{studentId:"",mark:0}]),o=(d,f,h)=>{i(p=>{const m=[...p],g=m[d]||{studentId:"",mark:0};return m[d]={...g,[f]:h},m})},l=d=>{i(f=>f.filter((h,p)=>p!==d))},c=()=>{Gn(r,n),alert("Marks saved locally.")},u=()=>{CPe(`${e}_${t}_marks.csv`,n)};return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:10,flexWrap:"wrap"},children:[a.jsx("button",{onClick:s,className:"obe-btn obe-btn-primary",children:"Add Row"}),a.jsx("button",{onClick:c,className:"obe-btn obe-btn-success",children:"Save Local"}),a.jsx("button",{onClick:u,className:"obe-btn obe-btn-secondary",disabled:!n.length,title:n.length?"Export as CSV":"Add at least one row to export",children:"Export CSV"})]}),n.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No rows yet. Click Add Row to start."}):a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((d,f)=>a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 120px 90px",gap:8,alignItems:"center"},children:[a.jsx("input",{value:d.studentId,onChange:h=>o(f,"studentId",h.target.value),placeholder:"Student ID",className:"obe-input"}),a.jsx("input",{type:"number",value:d.mark,onChange:h=>o(f,"mark",Number(h.target.value)),className:"obe-input"}),a.jsx("button",{onClick:()=>l(f),className:"obe-btn obe-btn-danger",children:"Remove"})]},f))}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",a.jsx("span",{style:{fontFamily:"monospace"},children:r})]})]})}function C6({subjectId:e,classType:t,questionPaperType:r,enabledAssessments:n,teachingAssignmentsOverride:i,fixedTeachingAssignmentId:s,iqacResetEnabled:o,viewerMode:l}){var ie,le;const[c,u]=x.useState("dashboard"),d=hn.useCallback(O=>{if(O!==c){try{window.dispatchEvent(new CustomEvent("obe:before-tab-switch",{detail:{from:c,to:O}}))}catch{}u(O),e&&Gn(`markEntry_activeTab_${e}`,O)}},[c,e]),[f,h]=x.useState([]),[p,m]=x.useState(null),[g,y]=x.useState(null),[b,v]=x.useState(void 0),[w,S]=x.useState(!1),[k,j]=x.useState(!1),[A,L]=x.useState(0),[P,B]=x.useState(null),E=x.useMemo(()=>_Pe(c),[c]),[T,F]=x.useState({loading:!1,enabled:!0,open:!0,error:null});x.useEffect(()=>{let O=!0;return(async()=>{if(!E){if(!O)return;F({loading:!1,enabled:!0,open:!0,error:null});return}if(O){F({loading:!0,enabled:!0,open:!0,error:null});try{const H=await _3(E,String(e||""),g??void 0);if(!O)return;const ae=(H==null?void 0:H.assessment_enabled)??!0,I=(H==null?void 0:H.assessment_open)??!0;F({loading:!1,enabled:!!ae,open:!!I,error:null})}catch(H){if(!O)return;F({loading:!1,enabled:!0,open:!0,error:(H==null?void 0:H.message)||"Failed to check exam availability"})}}})(),()=>{O=!1}},[E,e,g]);const W=E?!!T.enabled:!0,z=!!l||(E?!T.open:!1),se=x.useMemo(()=>g==null?null:(f||[]).find(O=>O.id===g)||null,[f,g]),[de,U]=x.useState(null),[G,re]=x.useState(null);x.useEffect(()=>{let O=!0;return(async()=>{if(U(null),re(null),g==null)return;const H=se||null,ae=String((H==null?void 0:H.class_type)||"").trim(),I=!!String((H==null?void 0:H.academic_year)||"").trim(),Z=typeof(H==null?void 0:H.semester)<"u"&&(H==null?void 0:H.semester)!=null,pe=!!(H!=null&&H.department||H!=null&&H.department_name),Oe=!!String((H==null?void 0:H.section_name)||"").trim();if(ae&&I&&Z&&pe&&Oe){U(ae);return}const Ae=String(t||"").trim();try{const ke=await qc(Number(g));if(!O)return;const _e=(ke==null?void 0:ke.teaching_assignment)||{},De=String((_e==null?void 0:_e.class_type)||"").trim();U(De||ae||Ae||null),re({academic_year:(_e==null?void 0:_e.academic_year)||(_e==null?void 0:_e.academic_year_name)||(_e==null?void 0:_e.year)||null,semester:typeof(_e==null?void 0:_e.semester)<"u"?_e==null?void 0:_e.semester:null,department:(_e==null?void 0:_e.department)||(_e==null?void 0:_e.department_name)||null,section_name:(_e==null?void 0:_e.section_name)||(_e==null?void 0:_e.section)||null})}catch{if(!O)return;U(ae||Ae||null),re(null)}})(),()=>{O=!1}},[g,se,t]);const X=x.useMemo(()=>{const O=String((se==null?void 0:se.class_type)||"").trim();if(O)return O;const H=String(de||"").trim();return H||String(t||"").trim()||null},[se,de,t]),C=x.useMemo(()=>{const O=ti(X),H=O.replace(/[^A-Z0-9]/g,"");return H.includes("TCPR")?"TCPR":H.includes("TCPL")?"TCPL":String(r||"").trim().toUpperCase()==="QP2"&&(!O||O==="THEORY")?"TCPR":X},[X,r]),K=x.useMemo(()=>ti(C),[C]);x.useEffect(()=>{let O=!0;return(async()=>{try{const H=await SS();if(!O)return;const I=(Array.isArray(H==null?void 0:H.options)?H.options:[]).map(Z=>typeof Z=="string"?String(Z||""):Z&&typeof Z=="object"&&Z.id?String(Z.id||""):"").map(Z=>Z.trim()).filter(Boolean);B({options:I,divider:Number.isFinite(Number(H==null?void 0:H.divider))?Number(H.divider):2,multiplier:Number.isFinite(Number(H==null?void 0:H.multiplier))?Number(H.multiplier):.15})}catch{if(!O)return;B(null)}})(),()=>{O=!1}},[]);const V=x.useMemo(()=>K==="SPECIAL",[K]),R=b===void 0?n:b,J=x.useMemo(()=>APe(C,R),[C,n,b]),q=x.useMemo(()=>(Array.isArray(P==null?void 0:P.options)?P.options:[]).map(H=>kPe(H)).filter(H=>!!H),[P]),Y=x.useMemo(()=>{const O=[...J];return q.length&&q.forEach((H,ae)=>{var Oe,Ae,ke;const I=`CQI (${H.assessmentType.toUpperCase()} ${H.cos.join(", ")})`,Z={key:`cqi_${ae}`,label:I,cqi:H},pe=O.findIndex(_e=>_e.key===H.showAfter);if(pe>=0){let _e=pe+1;for(;_e<O.length&&String(((Oe=O[_e])==null?void 0:Oe.key)||"").startsWith("cqi_")&&((ke=(Ae=O[_e])==null?void 0:Ae.cqi)==null?void 0:ke.showAfter)===H.showAfter;)_e+=1;O.splice(_e,0,Z)}else O.push(Z)}),O},[J,q]);x.useEffect(()=>{if(!e)return;const O=Jn(`markEntry_activeTab_${e}`);O&&Y.some(H=>H.key===O)&&u(O)},[e]),x.useEffect(()=>{Y.some(O=>O.key===c)||u("dashboard")},[Y,c]),x.useEffect(()=>{var ae;if(!e||!i)return;const O=(i||[]).filter(I=>String(I.subject_code)===String(e));h(O),m(null);const H=typeof s=="number"&&O.some(I=>I.id===s)&&s||(((ae=O[0])==null?void 0:ae.id)??null);y(H)},[e,i,s]),x.useEffect(()=>{let O=!0;if(!(i&&Array.isArray(i)))return(async()=>{var H;try{const ae=await lc();if(!O)return;let I=(ae||[]).filter(Oe=>Oe.subject_code===e);if(I.length===0)try{const Oe=await yr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(Oe.ok){const Ae=await Oe.json();I=(Array.isArray(Ae.results)?Ae.results:Array.isArray(Ae)?Ae:Ae.items||[])||[]}}catch(Oe){console.warn("Server TA list fetch failed:",Oe)}h(I),m(null);const Z=Jn(`markEntry_selectedTa_${e}`),pe=typeof s=="number"&&I.some(Oe=>Oe.id===s)&&s||typeof Z=="number"&&I.some(Oe=>Oe.id===Z)&&Z||(((H=I[0])==null?void 0:H.id)??null);y(pe)}catch(ae){if(!O)return;h([]),y(null),m((ae==null?void 0:ae.message)||"Failed to load teaching assignments")}})(),()=>{O=!1}},[e,i,s]),x.useEffect(()=>{e&&g!=null&&typeof s!="number"&&Gn(`markEntry_selectedTa_${e}`,g)},[e,g,s]),x.useEffect(()=>{let O=!0;if(e){if(g==null){v(void 0);return}if(!V){v(void 0);return}return(async()=>{try{const H=await fm(Number(g)),ae=H==null?void 0:H.enabled_assessments;if(!O)return;v(Array.isArray(ae)&&ae.length?ae:null)}catch(H){if(!O)return;v(void 0),m((H==null?void 0:H.message)||"Failed to load faculty enabled assessments")}})(),()=>{O=!1}}},[e,g,V]),x.useEffect(()=>{e&&Gn(`markEntry_activeTab_${e}`,c)},[e,c]);const Q=x.useMemo(()=>{if(!e)return{};const O={};for(const H of Y){if(H.key==="dashboard"||String(H.key).startsWith("cqi_"))continue;if(H.key==="ssa1"){const I=Jn(`ssa1_sheet_${e}`),Z=I==null?void 0:I.rows;O[H.key]=Array.isArray(Z)?Z.length:0;continue}if(H.key==="review1"){const I=Jn(`review1_sheet_${e}`),Z=I==null?void 0:I.rows;O[H.key]=Array.isArray(Z)?Z.length:0;continue}if(H.key==="ssa2"){const I=Jn(`ssa2_sheet_${e}`),Z=I==null?void 0:I.rows;O[H.key]=Array.isArray(Z)?Z.length:0;continue}if(H.key==="review2"){const I=Jn(`review2_sheet_${e}`),Z=I==null?void 0:I.rows;O[H.key]=Array.isArray(Z)?Z.length:0;continue}if(H.key==="formative1"){const I=Jn(`formative1_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[H.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(H.key==="formative2"){const I=Jn(`formative2_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[H.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(H.key==="cia1"){const I=Jn(`cia1_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[H.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(H.key==="cia2"){const I=Jn(`cia2_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[H.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(H.key==="model"){const I=Jn(`model_sheet_${e}`),Z=I==null?void 0:I.rowsByStudentId;O[H.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}const ae=Jn(jK(e,H.key))||[];O[H.key]=Array.isArray(ae)?ae.length:0}return O},[e,c,Y,A]);return a.jsxs("div",{children:[g!=null&&a.jsx(SPe,{teachingAssignmentId:g}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{minWidth:260},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Teaching Assignment (Section)"}),f.length===0?a.jsx("div",{className:"obe-input",children:"No teaching assignments"}):a.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,background:"#fff",border:"1px solid #e5e7eb"},children:[a.jsx("div",{style:{fontSize:14,fontWeight:600},children:((ie=se||f[0])==null?void 0:ie.section_name)||(G==null?void 0:G.section_name)||""}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(()=>{var Oe,Ae,ke,_e,De,We,Ct,_t;const O=se||f[0]||{},H=O.academic_year||(G==null?void 0:G.academic_year)||O.academic_year_name||O.year||"",ae=typeof O.semester<"u"&&O.semester!=null?O.semester:typeof(G==null?void 0:G.semester)<"u"?G==null?void 0:G.semester:(Oe=f[0])==null?void 0:Oe.semester,I=O.department||((Ae=O.section_details)==null?void 0:Ae.department)||((De=(_e=(ke=O.section_details)==null?void 0:ke.batch)==null?void 0:_e.course)==null?void 0:De.department)||(G==null?void 0:G.department)||(O.department_name?{name:O.department_name}:null)||((We=f[0])==null?void 0:We.department)||((_t=(Ct=f[0])==null?void 0:Ct.section_details)==null?void 0:_t.department),Z=(I==null?void 0:I.short_name)||(I==null?void 0:I.code)||(I==null?void 0:I.name)||O.department_name||"",pe=[];return pe.push(H||""),typeof ae<"u"&&ae!=null&&pe.push(`Sem ${ae}`),Z&&pe.push(Z),pe.filter(Boolean).join("  ")})()})]}),p&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:p})]}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:"Student rows load from the selected section roster."}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:V&&g?a.jsx("button",{className:"obe-btn",onClick:()=>S(O=>!O),children:"Show exams"}):null})]}),V&&w&&g?a.jsx("div",{style:{marginBottom:12},children:a.jsx(wPe,{teachingAssignmentId:g??void 0,onSaved:O=>{v(Array.isArray(O)&&O.length?O:null),S(!1)},onClose:()=>S(!1)})}):null,o&&E&&g!=null?a.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:k,onClick:async()=>{const O=E;if(window.confirm(`Reset ${O.toUpperCase()} for this section? This clears draft + published data for that exam.`))try{j(!0),await S3(O,String(e),Number(g)),NPe(String(e),String(O)),L(ae=>ae+1),alert("Reset completed.")}catch(ae){alert((ae==null?void 0:ae.message)||"Reset failed")}finally{j(!1)}},children:k?"Resetting":"Reset This Exam"})}):null,a.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%)",borderRadius:12,padding:"16px",marginBottom:20,border:"1px solid #cbd5e1",boxShadow:"0 2px 8px rgba(2,6,23,0.04), inset 0 1px 0 rgba(255,255,255,0.5)"},children:[a.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:12},children:"Assessment Exams"}),a.jsx("div",{className:"obe-sidebar-nav","aria-label":"Mark Entry sub-tabs",style:{display:"flex",flexWrap:"wrap",gap:8},children:Y.map((O,H)=>a.jsx(hn.Fragment,{children:O.cqi?a.jsx(TPe,{active:c===O.key,label:O.label,onClick:()=>d(O.key),isCqi:!0,uniqueId:String(O.key)}):a.jsx(EPe,{active:c===O.key,label:O.label,onClick:()=>d(O.key)})},O.key))})]}),c==="dashboard"&&a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 6px 0"},children:"Dashboard"}),a.jsxs("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:["Quick overview for ",a.jsx("b",{children:e}),". Use the tabs to enter marks."]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12},children:Y.filter(O=>O.key!=="dashboard").map(O=>a.jsxs("div",{className:"obe-card",children:[a.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:O.label}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#6b7280"},children:["Rows saved: ",String(O.key).startsWith("cqi_")?"":Q[O.key]??0]})]},O.key))}),a.jsx("div",{style:{marginTop:14},children:a.jsx(bPe,{subjectId:e})})]}),c!=="dashboard"&&a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 6px 0"},children:(le=Y.find(O=>O.key===c))==null?void 0:le.label}),(()=>{const O=Y.find(ae=>ae.key===c)||null,H=(O==null?void 0:O.cqi)||null;return a.jsx("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:c==="formative1"?K==="TCPL"?"Enter and manage LAB-1 marks (experiments + totals).":"Enter and manage Formative-1 assessment marks with BTL mapping.":c==="formative2"?K==="TCPL"?"Enter and manage LAB-2 marks (experiments + totals).":"Enter and manage Formative-2 assessment marks with BTL mapping.":c==="ssa1"?"SSA1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review1"?"Review 1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="ssa2"?"SSA2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review2"?"Review 2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="cia1"?K==="LAB"?"CIA 1 LAB entry (CO-1/CO-2 experiments + CIA exam)":K==="PRACTICAL"?"CIA 1 Review (Practical) - enter review marks for practical content.":"CIA 1 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="cia2"?K==="LAB"?"CIA 2 LAB entry (CO-3/CO-4/CO-5 experiments + CIA exam).":"CIA 2 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="model"?K==="LAB"?"MODEL LAB entry (CO-5 experiments + CIA exam).":"MODEL blank table template (same layout style as CIA sheets).":String(c).startsWith("cqi_")?`CQI view for ${((H==null?void 0:H.assessmentType)||"assessment").toUpperCase()} (${((H==null?void 0:H.cos)||[]).join(", ")})`:"Enter and save marks locally for this assessment."})})(),T.loading&&E?a.jsx("div",{style:{padding:"10px 0",color:"#6b7280",fontSize:13},children:"Checking availability"}):!W&&E?a.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fdba7433",color:"#9a3412",padding:12,borderRadius:12,fontWeight:800},children:"This exam is disabled by IQAC. Please contact IQAC to enable it."}):a.jsx("fieldset",{disabled:!!z,style:{border:0,padding:0,margin:0},children:(()=>{const O=Y.find(ae=>ae.key===c)||null,H=(O==null?void 0:O.cqi)||null;return c==="formative1"?K==="TCPL"?a.jsx(ew,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"formative1",label:"LAB 1",coA:1,coB:2}):a.jsx(Hz,{subjectId:e,teachingAssignmentId:g??void 0}):c==="formative2"?K==="TCPL"?a.jsx(ew,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"formative2",label:"LAB 2",coA:2,coB:3}):a.jsx(_xe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="ssa1"?a.jsx(Hxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="review1"?a.jsx(Fxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="ssa2"?a.jsx(Qxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="review2"?a.jsx(Ixe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="cia1"?K==="LAB"?a.jsx(Ix,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",label:"CIA 1 LAB",coA:1,coB:2,initialEnabledCos:[1,2],viewerMode:!!z}):K==="PROJECT"?a.jsx($k,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",viewerMode:!!z,classType:X??null}):K==="PRACTICAL"?a.jsx(Dk,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",viewerMode:!!z}):a.jsx(qz,{subjectId:e,teachingAssignmentId:g??void 0,classType:X??null,questionPaperType:r??null}):c==="cia2"?K==="LAB"?a.jsx(Ix,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",label:"CIA 2 LAB",coA:3,coB:4,initialEnabledCos:[3,4,5],viewerMode:!!z}):K==="PROJECT"?a.jsx($k,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",viewerMode:!!z,classType:X??null}):K==="PRACTICAL"?a.jsx(Dk,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",viewerMode:!!z}):a.jsx(gxe,{subjectId:e,teachingAssignmentId:g??void 0,classType:X??null,questionPaperType:r??null}):c==="model"?K==="LAB"?a.jsx(Ix,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",label:"MODEL LAB",coA:5,coB:null,initialEnabledCos:[5],viewerMode:!!z}):K==="PROJECT"?a.jsx($k,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",viewerMode:!!z,classType:X??null}):K==="PRACTICAL"?a.jsx(Dk,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",viewerMode:!!z}):a.jsx(Bxe,{subjectId:e,teachingAssignmentId:g??void 0,classType:X??null,questionPaperType:r??null}):String(c).startsWith("cqi_")?a.jsx(n1e,{subjectId:e,teachingAssignmentId:g??void 0,classType:X??null,enabledAssessments:R??null,assessmentType:(H==null?void 0:H.assessmentType)||"model",cos:(H==null?void 0:H.cos)||["CO1","CO2","CO3","CO4","CO5"],cqiDivider:Number(P==null?void 0:P.divider)||2,cqiMultiplier:Number(P==null?void 0:P.multiplier)||.15}):a.jsx(PPe,{subjectId:e,tab:c})})()})]},`${c}_${A}`)]})}function OPe(){var m,g,y,b;const{courseCode:e,taId:t}=U0(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),n=x.useMemo(()=>t?Number(t):NaN,[t]),[i,s]=x.useState(null),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null);x.useEffect(()=>{let v=!0;return(async()=>{if(r)try{const[w,S]=await Promise.all([bl(),Kd()]);if(!v)return;const j=(w||[]).filter(A=>String((A==null?void 0:A.course_code)||"").trim().toUpperCase()===r.toUpperCase())[0];if(j)if(l(j!=null&&j.class_type?String(j.class_type):null),u(j!=null&&j.question_paper_type?String(j.question_paper_type):null),String((j==null?void 0:j.class_type)||"").trim().toUpperCase()==="SPECIAL"){f([]);try{const L=await wS(r);f(Array.isArray(L)?L:[])}catch{const L=j==null?void 0:j.enabled_assessments;f(Array.isArray(L)?L.map(P=>String(P).trim().toLowerCase()).filter(Boolean):[])}}else f(null);else{const A=(S||[]).find(L=>String((L==null?void 0:L.course_code)||"").trim().toUpperCase()===r.toUpperCase());l(A!=null&&A.class_type?String(A.class_type):null),u(null),f(null)}}catch{}})(),()=>{v=!1}},[r]),x.useEffect(()=>{let v=!0;return(async()=>{if(!(!r||!Number.isFinite(n)))try{const w=await R2(r);if(!v)return;const S=(w||[]).find(k=>Number(k.teaching_assignment_id)===Number(n))||null;s(S)}catch{if(!v)return;s(null)}})(),()=>{v=!1}},[r,n]);const h=x.useMemo(()=>Number.isFinite(n)?[{id:n,subject_id:0,subject_code:r,subject_name:(i==null?void 0:i.course_name)||r,section_id:(i==null?void 0:i.section_id)||0,section_name:(i==null?void 0:i.section_name)||"Section",academic_year:(i==null?void 0:i.academic_year)||""}]:[],[n,r,i]),p=ti(o);return!r||!Number.isFinite(n)?a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),a.jsx("div",{style:{marginTop:10},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]}):a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Mark Entry Viewer"}),a.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:r}),a.jsxs("div",{style:{color:"#6b7280",marginTop:4},children:[i?`${i.section_name}  ${i.academic_year}`:"",(m=i==null?void 0:i.staff)!=null&&m.name||(g=i==null?void 0:i.staff)!=null&&g.username?`    ${((y=i.staff)==null?void 0:y.name)||((b=i.staff)==null?void 0:b.username)}`:"",p?`    ${p}`:""]})]}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(r)}`,children:"Back"})})]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:a.jsx(C6,{subjectId:r,classType:o,questionPaperType:c,enabledAssessments:d,teachingAssignmentsOverride:h,fixedTeachingAssignmentId:n,iqacResetEnabled:!0,viewerMode:!1})})]})}function MPe(e){return e==="-"||e===null||e===void 0||e===""?" - ":String(e)}function Pp(e,t){const r=Math.pow(10,t);return Math.round((e+Number.EPSILON)*r)/r}function fN({headers:e,rows:t}){return a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:900},children:[a.jsx("thead",{children:a.jsx("tr",{children:e.map(r=>a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#111827",background:"#f9fafb",padding:"10px 10px",borderBottom:"1px solid #e5e7eb",whiteSpace:"nowrap"},children:r},r))})}),a.jsx("tbody",{children:t.map((r,n)=>a.jsx("tr",{children:r.map((i,s)=>a.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid #f3f4f6",fontSize:12,color:"#111827",whiteSpace:s===3?"normal":"nowrap",maxWidth:s===3?360:void 0},children:MPe(i)},s))},n))})]})})}function MB({title:e,headers:t,rows:r,collapsedByDefault:n=!1,showToggle:i=!0}){const[s,o]=x.useState(!n);return a.jsxs("section",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("h3",{style:{margin:"6px 0 10px 0",flex:1},children:e}),i?a.jsx("button",{"aria-label":s?"Collapse table":"Expand table",onClick:()=>o(l=>!l),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:18,padding:6,color:"#374151"},children:s?"":""}):null]}),s&&a.jsx(fN,{headers:t,rows:r})]})}function LPe({subjectId:e,matrix:t}){var s,o,l;if(!e)return a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Select a course to view the Articulation Matrix."});if(!t)return a.jsxs("div",{style:{border:"1px dashed #bbb",padding:16,borderRadius:8,color:"#666"},children:["No articulation matrix loaded yet for ",a.jsx("b",{children:e}),". Upload the Excel to parse page-2."]});const r=Array.isArray(t.units)?t.units:[],n=(s=t.summaries)==null?void 0:s.co_po_summary,i=["S. No","CO Mapped","Topic No.","Topic Name",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Hours"];return Array.from({length:i.length},()=>""),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[((o=t.meta)==null?void 0:o.sheet_used)&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Sheet: ",a.jsx("b",{children:t.meta.sheet_used})]}),r.map(c=>{const u=(c.rows||[]).map(d=>[d.s_no,d.co_mapped,d.topic_no,d.topic_name,...d.po||[],...d.pso||[],d.hours]);return a.jsxs("section",{children:[a.jsx("h3",{style:{margin:"6px 0 10px 0"},children:c.unit}),a.jsx(fN,{headers:i,rows:u})]},c.unit)}),(()=>{const c=[],u=(f,h)=>{const p=r[f];if(!p||!Array.isArray(p.rows)||p.rows.length===0)return[h,...Array.from({length:11},()=>""),...Array.from({length:3},()=>""),""];const m=p.rows,g=m.reduce((v,w)=>{const S=Number(w.hours);return v+(Number.isFinite(S)?S:0)},0),y=[];for(let v=0;v<11;v++){const w=m.reduce((S,k)=>{const j=Number((k.po&&k.po[v])??0);return S+(Number.isFinite(j)?j:0)},0);if(g>0){const S=w/g,k=Pp(S,2);y.push(k.toFixed(2))}else y.push("")}const b=[];for(let v=0;v<3;v++){const w=m.reduce((S,k)=>{const j=Number((k.pso&&k.pso[v])??0);return S+(Number.isFinite(j)?j:0)},0);if(g>0){const S=w/g,k=Pp(S,2);b.push(k.toFixed(2))}else b.push("")}return[h,...y,...b,g||""]};for(let f=0;f<5;f++)c.push(u(f,`CO${f+1}`));const d=(()=>{const f=[];c.forEach(y=>{const b=y[0],w=y.slice(1,15).map(j=>{if(j===""||j===null||j===void 0)return"";const A=Number(String(j));if(!Number.isFinite(A))return"";const L=A*3,P=Pp(L,2);return P===0?"":P.toFixed(2)}),S=w.map(j=>j===""?null:Number(j)).filter(j=>j!==null),k=S.length?Pp(S.reduce((j,A)=>j+A,0)/S.length,2).toFixed(2):"";f.push([b,...w,k])});const p=[];for(let y=0;y<14;y++){const b=[];for(let v=0;v<f.length;v++){const w=f[v][1+y];if(w===""||w===null||w===void 0)continue;const S=Number(w);Number.isFinite(S)&&b.push(S)}b.length?p.push(Pp(b.reduce((v,w)=>v+w,0)/b.length,2).toFixed(2)):p.push("")}const m=f.map(y=>y[y.length-1]).filter(y=>y!=="").map(Number),g=m.length?Pp(m.reduce((y,b)=>y+b,0)/m.length,2).toFixed(2):"";return f.push(["Average",...p,g]),f})();return a.jsxs(a.Fragment,{children:[a.jsx(MB,{title:"CO  PO/PSO (Course Delivery)",headers:["COs",...Array.from({length:11},(f,h)=>`PO${h+1}`),...Array.from({length:3},(f,h)=>`PSO${h+1}`),"Course delivery"],rows:c,collapsedByDefault:!0}),a.jsx(MB,{title:"CO  PO/PSO Summary",headers:["COs",...Array.from({length:11},(f,h)=>`PO${h+1}`),...Array.from({length:3},(f,h)=>`PSO${h+1}`),"Average"],rows:d,collapsedByDefault:!1,showToggle:!1})]})})(),(l=n==null?void 0:n.rows)!=null&&l.length?a.jsxs("section",{children:[a.jsx("h3",{style:{margin:"6px 0 10px 0"},children:"CO  PO/PSO Summary"}),a.jsx(fN,{headers:["CO",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Average"],rows:[...n.rows.map(c=>[c.label,...c.po,...c.pso,c.average]),...n.average?[[n.average.label,...n.average.po,...n.average.pso,n.average.average]]:[]]})]}):null]})}const Da={container:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%)",padding:"2rem"},card:{maxWidth:"1400px",margin:"0 auto",background:"#ffffff",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07), 0 1px 3px rgba(0, 0, 0, 0.06)",overflow:"hidden"},header:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"2rem 2.5rem",borderBottom:"1px solid #e5e7eb"},title:{fontSize:"1.875rem",fontWeight:"700",color:"#ffffff",margin:"0",letterSpacing:"-0.025em"},subtitle:{fontSize:"0.95rem",color:"rgba(255, 255, 255, 0.9)",marginTop:"0.5rem",fontWeight:"400"},content:{padding:"2rem 2.5rem"},inputSection:{marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},label:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.025em"},input:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #e5e7eb",borderRadius:"6px",outline:"none",transition:"all 0.2s ease",fontFamily:"inherit"},inputFocus:{borderColor:"#667eea",boxShadow:"0 0 0 3px rgba(102, 126, 234, 0.1)"},actionBar:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap",marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px"},button:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:"600",color:"#ffffff",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)",outline:"none"},buttonHover:{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(102, 126, 234, 0.4)"},buttonDisabled:{background:"#9ca3af",cursor:"not-allowed",boxShadow:"none",opacity:.6},infoText:{fontSize:"0.875rem",color:"#6b7280",display:"flex",alignItems:"center",gap:"0.5rem"},infoIcon:{width:"16px",height:"16px",borderRadius:"50%",background:"#667eea",color:"#ffffff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"700"},alert:{padding:"1rem 1.25rem",borderRadius:"8px",fontSize:"0.925rem",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",fontWeight:"500"},alertSuccess:{background:"#d1fae5",color:"#065f46",border:"1px solid #6ee7b7"},alertError:{background:"#fee2e2",color:"#991b1b",border:"1px solid #fca5a5"},matrixContainer:{background:"#ffffff",borderRadius:"8px",border:"1px solid #e5e7eb",padding:"1.5rem",minHeight:"200px"},loadingSpinner:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid #ffffff",borderRadius:"50%",animation:"spin 0.6s linear infinite",marginRight:"0.5rem"}};function RPe({courseId:e,embedded:t=!1}){const[r,n]=x.useState(e||""),[i,s]=x.useState(null),[o,l]=x.useState("idle"),[c,u]=x.useState(null),[d,f]=x.useState(!1),[h,p]=x.useState(!1);async function m(v){if(v){try{const w=new URLSearchParams(window.location.search),S=w.get("teaching_assignment_id")||w.get("teachingAssignmentId");if(S){const k=Number(S);if(Number.isFinite(k))return k}}catch{}try{const S=(await lc()||[]).find(j=>String(j==null?void 0:j.subject_code)===String(v)),k=(S==null?void 0:S.id)!=null?Number(S.id):NaN;if(Number.isFinite(k))return k}catch{}}}x.useEffect(()=>{r&&(async()=>{l("loading"),u(null);try{const v=await m(r),w=await I4(r,v);s(w),l("success")}catch(v){s(null),l("error"),u((v==null?void 0:v.message)||"Articulation Matrix fetch failed.")}})()},[r]);async function g(){if(r){l("loading"),u(null);try{const v=await m(r),w=await I4(r,v);s(w),l("success");const S=Array.isArray(w==null?void 0:w.units)?w.units.length:0;u(`Loaded articulation matrix from saved CDAP. Units: ${S}.`)}catch(v){l("error"),u((v==null?void 0:v.message)||"Articulation Matrix fetch failed.")}}}const y=t?{padding:0}:Da.container,b=t?{...Da.card,maxWidth:"100%",margin:0,borderRadius:12,boxShadow:"none"}:Da.card;return a.jsxs("div",{style:y,children:[a.jsx("style",{children:`
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `}),a.jsxs("div",{style:b,children:[!t&&a.jsxs("div",{style:Da.header,children:[a.jsx("h1",{style:Da.title,children:"Articulation Matrix"}),a.jsx("p",{style:Da.subtitle,children:r?`Course: ${r}`:"Select a course to view the articulation matrix"})]}),a.jsxs("div",{style:t?{padding:0}:Da.content,children:[!e&&a.jsxs("div",{style:Da.inputSection,children:[a.jsx("label",{style:Da.label,children:"Course ID"}),a.jsx("input",{value:r,onChange:v=>n(v.target.value),placeholder:"Enter course identifier (e.g., CS101)",style:{...Da.input,...d?Da.inputFocus:{}},onFocus:()=>f(!0),onBlur:()=>f(!1)})]}),a.jsxs("div",{style:Da.actionBar,children:[a.jsxs("button",{onClick:g,disabled:o==="loading"||!r,style:{...Da.button,...o==="loading"||!r?Da.buttonDisabled:{},...h&&o!=="loading"&&r?Da.buttonHover:{}},onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:[o==="loading"&&a.jsx("span",{style:Da.loadingSpinner}),o==="loading"?"Loading...":"Refresh Matrix"]}),a.jsxs("span",{style:Da.infoText,children:[a.jsx("span",{style:Da.infoIcon,children:"i"}),"Uses saved CDAP ticks + hours (no upload required)"]})]}),c&&a.jsxs("div",{style:{...Da.alert,...o==="error"?Da.alertError:Da.alertSuccess},children:[a.jsx("span",{style:{fontSize:"1.25rem"},children:o==="error"?"":""}),c]}),a.jsx("div",{style:Da.matrixContainer,children:a.jsx(LPe,{subjectId:r,matrix:i})})]})]})]})}const BPe="https://db.krgi.co.in",FPe=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":BPe;function IPe(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function DPe(e,t){if(e===401)return"Authentication required. Please login and try again.";if(e===403)return"Permission required to upload CDAP Excel files.";if(e===400)return"Invalid file. Please upload a valid CDAP Excel template.";if(e===404)return"Upload endpoint not found. Please contact admin.";const r=(t||"").trim();return r&&!r.startsWith("<")?r:`Upload failed with status ${e}. Please try again.`}function $Pe({subjectId:e,onUpload:t}){const[r,n]=x.useState(null),[i,s]=x.useState("idle"),[o,l]=x.useState(null),[c,u]=x.useState(null);async function d(){var y,b,v;if(!r){s("error"),l("Please choose an Excel file first.");return}s("uploading"),l(null);const p=new FormData;p.append("file",r),e&&p.append("subject_id",e);const m=new AbortController,g=setTimeout(()=>m.abort(),6e4);try{const w={...IPe()},S=await fetch(`${FPe}/api/obe/upload-cdap`,{method:"POST",headers:w,body:p,signal:m.signal});if(!S.ok){const L=await S.text();s("error"),l(DPe(S.status,L));return}const k=await S.json(),j={rows:Array.isArray(k==null?void 0:k.rows)?k.rows:[],textbook:((y=k==null?void 0:k.books)==null?void 0:y.textbook)??(k==null?void 0:k.textbook)??"",reference:((b=k==null?void 0:k.books)==null?void 0:b.reference)??(k==null?void 0:k.reference)??"",activeLearningOptionsByRow:((v=k==null?void 0:k.active_learning)==null?void 0:v.optionsByRow)??(k==null?void 0:k.activeLearningOptions)??[],articulationExtras:(k==null?void 0:k.articulation_extras)??{}};u(j);const A=Array.isArray(k==null?void 0:k.rows)?k.rows.length:0;A?(s("success"),l(`Upload complete. Parsed ${A} rows from the Excel file.`)):(s("success"),l("Upload completed, but no rows were parsed. Please check the Excel template format.")),t&&t({revision:j,uploadedAt:new Date().toISOString()})}catch(w){s("error"),(w==null?void 0:w.name)==="AbortError"?l("Upload timed out. The server took too long to respond. Please try again."):l((w==null?void 0:w.message)||"Upload failed. Please try again.")}finally{clearTimeout(g),s(w=>w==="uploading"?"error":w)}}function f(p,m){for(const g of m){if(p==null)continue;if(p[g]!=null)return p[g];const y=String(g).toLowerCase();for(const b of Object.keys(p||{}))if(String(b).toLowerCase()===y)return p[b]}return""}function h(p){if(!p||!Array.isArray(p.rows)||!p.rows.length)return;const m=p.rows,g=["#","Content type","PART NO.","TOPICS TO BE COVERED (SYLLBUS TOPICS)","SUB TOPICS (WHAT TO BE TAUGHT)","BT LEVEL"],y=m.map((w,S)=>{const k=f(w,["content_type","contentType","Content type","content"]),j=f(w,["part_no","partNo","PART NO","part"]),A=f(w,["topics","topics_to_be_covered","Topics","TOPICS TO BE COVERED"]),L=f(w,["sub_topics","subTopics","Sub Topics","SUB TOPICS","sub_topics_to_be_taught"]),P=f(w,["bt_level","bt","BT LEVEL","btLevel"]);return`<tr>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${S+1}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(k??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(j??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(A??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(L??"")}</td>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${String(P??"")}</td>
      </tr>`}).join(`
`),b=`<!doctype html><html><head><meta charset="utf-8"><title>CDAP Export</title>
      <style>body{font-family:Arial,Helvetica,sans-serif;font-size:12px;padding:20px}table{border-collapse:collapse;width:100%}th{background:#f3f4f6;padding:8px;border:1px solid #ddd;text-align:left}td{vertical-align:top}</style>
      </head><body>
      <h2>CDAP Export</h2>
      <p>Exported rows: ${m.length}</p>
      <table>
        <thead><tr>${g.map(w=>`<th>${w}</th>`).join("")}</tr></thead>
        <tbody>
          ${y}
        </tbody>
      </table>
      </body></html>`,v=window.open("","_blank");if(!v){alert("Popup blocked  allow popups for this site to export PDF.");return}v.document.write(b),v.document.close(),v.focus(),setTimeout(()=>{v.print()},300)}return a.jsxs("div",{children:[a.jsx("div",{style:{marginBottom:8},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:p=>{var m;return n(((m=p.target.files)==null?void 0:m[0])||null)}})}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("button",{id:"cdap-upload-button",onClick:d,disabled:i==="uploading","aria-label":"Upload CDAP Excel file",title:"Upload parsed CDAP Excel",style:{background:"#1d4ed8",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",boxShadow:"0 8px 20px rgba(29,78,216,0.24)",fontWeight:600,cursor:i==="uploading"?"default":"pointer",transition:"transform 120ms ease, box-shadow 120ms ease, opacity 120ms ease",opacity:i==="uploading"?.65:1},onMouseDown:p=>{p.currentTarget.style.transform="translateY(1px)"},onMouseUp:p=>{p.currentTarget.style.transform="translateY(0)"},children:i==="uploading"?"Uploading...":"Upload Excel"}),r&&a.jsx("span",{style:{fontSize:12,color:"#555"},children:r.name})]}),i==="success"&&c&&Array.isArray(c.rows)&&c.rows.length>0&&a.jsx("div",{style:{marginTop:10},children:a.jsx("button",{onClick:()=>h(c),style:{background:"#047857",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},"aria-label":"Export PDF",title:"Export CDAP to PDF (will open print dialog)",children:"Export PDF"})}),o&&a.jsx("div",{style:{marginTop:8,fontSize:12,color:i==="error"?"#b91c1c":"#166534"},children:o})]})}const LB=[{key:"unit",label:"UNIT",type:"text"},{key:"unit_name",label:"SYLLABUS (UNIT NAME)",type:"text"},{key:"co",label:"OUTCOME (WRITE THE CO)",type:"text"},{key:"content_type",label:"Content type",type:"text"},{key:"part_no",label:"PART NO.",type:"text"},{key:"topics",label:"TOPICS TO BE COVERED (SYLLBUS TOPICS)",type:"text"},{key:"sub_topics",label:"SUB TOPICS (WHAT TO BE TAUGHT)",type:"text"},{key:"bt_level",label:"BT LEVEL",type:"text"}],RB=Array.from({length:11},(e,t)=>({key:`po${t+1}`,label:`PO${t+1}`,type:"checkbox",group:"po_pso"})),BB=Array.from({length:3},(e,t)=>({key:`pso${t+1}`,label:`PSO${t+1}`,type:"checkbox",group:"po_pso"})),io=["SSA1","SSA2","ACTIVE LEARNING 1 (SKILL)","ACTIVE LEARNING 2 (SKILL)","ACTIVE LEARNING 1 (ATTITUDE)","ACTIVE LEARNING 2 (ATTITUDE)","SPECIAL ACTIVITY"],Tf=Array.from({length:11},(e,t)=>`PO${t+1}`),yv={SSA1:["Technical magazine","Journal paper reading","Real time problems","Case study"],SSA2:["Technical magazine","Journal paper reading","Real time problems","Case study"],"ACTIVE LEARNING 1 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 2 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 1 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"ACTIVE LEARNING 2 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"SPECIAL ACTIVITY":["Active Projects","Journal Preparation"]};function UPe({subjectId:e,imported:t,onLockChange:r}){const n=x.useMemo(()=>{if(e)try{const Ne=localStorage.getItem(`markEntry_selectedTa_${e}`),be=Ne==null?NaN:Number(Ne);return Number.isFinite(be)?be:void 0}catch{return}},[e]),i=(Ne,be)=>{const fe=[...be];for(let ge=0;ge<Ne.length;ge++){const lt=Ne[ge]??[];(!fe[ge]||String(fe[ge]).trim()==="")&&Array.isArray(lt)&&lt.length===1&&(fe[ge]=String(lt[0]??"").trim())}return fe},s=x.useRef(null),[o,l]=x.useState(!0),[c,u]=x.useState(1),[d,f]=x.useState(()=>{if(!e)return 100;try{const Ne=localStorage.getItem(`cdap_zoom_${e}`);return Ne?parseInt(Ne,10):100}catch{return 100}}),[h,p]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState(()=>io.map(()=>Tf.map(()=>!1))),[v,w]=x.useState(()=>io.map(()=>"")),[S,k]=x.useState(()=>Qre()),[j,A]=x.useState(()=>io.map(Ne=>yv[Ne]??[])),[L,P]=x.useState({}),[B,E]=x.useState(!1),[T,F]=x.useState(null),[W,z]=x.useState(!1),{data:se,loading:de,error:U,refresh:G}=nc({assessment:"cdap",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:n,options:{poll:!0}}),re=!!W,X=!!(se!=null&&se.allowed_by_approval),C=!!(re&&!X),[K,V]=x.useState(!1),[R,J]=x.useState(""),[q,Y]=x.useState(!1),[Q,ie]=x.useState(null);x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_active_learning_draft_${e}`,JSON.stringify({dropdowns:v,grid:y,ts:Date.now()})),window.dispatchEvent(new CustomEvent("cdap-active-learning-changed",{detail:{subjectId:e}}))}catch{}},[e,v,y]),x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_zoom_${e}`,d.toString())}catch{}},[e,d]);const le=Ne=>String(Ne??"").replace(/\s+/g," ").trim().toUpperCase().includes("#N/A"),O=Ne=>Ne.filter(be=>!le(be==null?void 0:be.content_type)),H=x.useMemo(()=>[...LB,...RB,...BB],[]),ae=x.useMemo(()=>{const Ne={};for(const be of H)Ne[be.key]=be.type==="checkbox"?!1:"";return Ne},[H]),[I,Z]=x.useState(()=>[structuredClone(ae)]),pe=Ne=>{const be=Oc(Ne);if(be===Oc("SPECIAL ACTIVITY")){const fe=Oc("Active Projects");if(Array.isArray(S==null?void 0:S[fe])&&S[fe].length===11)return S[fe]}if(Array.isArray(S==null?void 0:S[be])&&S[be].length===11)return S[be];for(const fe of Bm){const ge=Oc(fe);if(ge===be&&Array.isArray(S==null?void 0:S[ge])&&S[ge].length===11)return S[ge]}for(const fe of Bm){const ge=Oc(fe);if((ge.includes(be)||be.includes(ge))&&Array.isArray(S==null?void 0:S[ge])&&S[ge].length===11)return S[ge]}return null},Oe=(Ne,be)=>{const fe=Ne.map(ge=>[...ge]);for(let ge=0;ge<io.length;ge++){const lt=(be==null?void 0:be[ge])??"";if(!lt)continue;const He=pe(lt);if(!(!Array.isArray(He)||He.length!==11))for(let mt=0;mt<Tf.length;mt++)fe[ge][mt]=!!He[mt]}return fe};x.useEffect(()=>{if(!e)return;let Ne=!0;return(async()=>{try{F(null),E(!0);const fe=await D9(e,n);if(!Ne)return;const ge=String((fe==null?void 0:fe.status)||"").toLowerCase()==="published";if(z(ge),ge&&(V(!1),ie(null)),!fe){Z([structuredClone(ae)]),p(""),g(""),b(io.map(()=>Tf.map(()=>!1))),w(io.map(()=>"")),A(io.map(Xr=>yv[Xr]??[])),z(!1);return}const lt=Array.isArray(fe.rows)?fe.rows:[];Z(lt.length?O(lt):[structuredClone(ae)]);const He=fe.books&&typeof fe.books=="object"?fe.books:{};p(typeof He.textbook=="string"?He.textbook:""),g(typeof He.reference=="string"?He.reference:"");const mt=fe.active_learning&&typeof fe.active_learning=="object"?fe.active_learning:{},wt=Array.isArray(mt.dropdowns)?mt.dropdowns.map(Xr=>Xr==null?"":String(Xr)):[],Pt=Array.isArray(mt.grid)?mt.grid:[],bt=Array.isArray(mt.optionsByRow)?mt.optionsByRow:null,qr=mt.articulation_extras&&typeof mt.articulation_extras=="object"?mt.articulation_extras:{};P(qr);const Tt=io.map((Xr,Br)=>Tf.map((Vr,An)=>{var Ln;const Yr=(Ln=Pt==null?void 0:Pt[Br])==null?void 0:Ln[An];return Yr===!0||Yr==="true"||Yr===1||Yr==="1"||String(Yr).trim().toLowerCase()==="x"?!0:!!Yr})),xr=wt.length===io.length?wt.slice(0,io.length):io.map(()=>""),Zr=bt&&Array.isArray(bt)?i(bt,xr):xr;if(w(Zr),b(Oe(Tt,Zr)),bt&&Array.isArray(bt)){const Xr=io.map((Br,Vr)=>{const An=bt==null?void 0:bt[Vr];return Array.isArray(An)?An.map(Yr=>String(Yr??"")).map(Yr=>Yr.trim()).filter(Boolean):[]});A(Xr)}else A(io.map(Xr=>yv[Xr]??[]))}catch(fe){if(!Ne)return;F((fe==null?void 0:fe.message)||"Failed to load CDAP from cloud"),Z([structuredClone(ae)])}finally{Ne&&E(!1)}})(),()=>{Ne=!1}},[e,ae]),x.useEffect(()=>{r&&r(!!C)},[C,r]),x.useEffect(()=>{let Ne=!0;const be=async()=>{try{const ge=await C3();Ne&&k(ge)}catch{}};be();const fe=ene(()=>be());return()=>{Ne=!1,fe()}},[]),x.useEffect(()=>{if(t&&!C){if(Array.isArray(t.rows)&&t.rows.length&&Z(O(t.rows)),typeof t.textbook=="string"&&p(t.textbook),typeof t.reference=="string"&&g(t.reference),Array.isArray(t.activeLearningOptionsByRow)&&t.activeLearningOptionsByRow.length){const Ne=io.map((ge,lt)=>{var mt;const He=(mt=t.activeLearningOptionsByRow)==null?void 0:mt[lt];return Array.isArray(He)?He.map(wt=>String(wt??"")).map(wt=>wt.trim()).filter(Boolean):[]}),fe=i(Ne,v);A(Ne),w(fe),b(ge=>Oe(ge,fe))}t.articulationExtras&&typeof t.articulationExtras=="object"&&P(t.articulationExtras)}},[t,C]);const Ae=async()=>{if(!e)return;const Ne=String(R||"").trim();if(!Ne){ie("Reason is required.");return}Y(!0),ie(null);try{const be=await nl({assessment:"cdap",subject_code:e,scope:"MARK_ENTRY",reason:Ne,teaching_assignment_id:n});alert(il(be)),V(!1)}catch(be){const fe=al(be,"Failed to request edit");ie(fe),alert(`Edit request failed: ${fe}`)}finally{Y(!1),G()}};x.useEffect(()=>{b(Ne=>Oe(Ne,v))},[S]);const ke=x.useMemo(()=>{const Ne=new Map;let be=null;return I.forEach((fe,ge)=>{const lt=fe.unit??"",He=lt!==""?String(lt):"";He&&(be=He);const mt=He||be||String(Math.floor(ge/9)+1),wt=Ne.get(mt)??{key:mt,items:[]};wt.items.push({row:fe,index:ge}),Ne.set(mt,wt)}),Array.from(Ne.values()).sort((fe,ge)=>{const lt=Number(fe.key),He=Number(ge.key);return!Number.isNaN(lt)&&!Number.isNaN(He)?lt-He:fe.key.localeCompare(ge.key)})},[I]),_e=(Ne,be,fe)=>{if(be==="content_type"&&le(fe)){Z(ge=>ge.filter((lt,He)=>He!==Ne));return}Z(ge=>{const lt=[...ge];return lt[Ne]={...lt[Ne],[be]:fe},lt})},De=()=>Z(Ne=>[...Ne,structuredClone(ae)]),We=Ne=>Z(be=>be.filter((fe,ge)=>ge!==Ne)),Ct=Ne=>{Z(be=>{const fe=structuredClone(ae);fe.unit=Ne;let ge=null,lt=-1,He=-1;for(let wt=0;wt<be.length;wt++){const Pt=be[wt].unit??"",bt=Pt!==""?String(Pt):"";bt&&(ge=bt),(bt||ge||String(Math.floor(wt/9)+1))===String(Ne)&&(He===-1&&(He=wt),lt=wt)}return He!==-1&&(fe.unit_name=be[He].unit_name??"",fe.co=be[He].co??""),lt===-1?[...be,fe]:[...be.slice(0,lt+1),fe,...be.slice(lt+1)]})},_t=async()=>{if(!e){alert("No subject selected.");return}try{F(null),E(!0),await $9({subjectId:e,status:"published",teaching_assignment_id:n,rows:I,books:{textbook:h,reference:m},active_learning:{grid:y,dropdowns:v,optionsByRow:j,articulation_extras:L}}),z(!0),alert("Published to cloud.")}catch(Ne){alert((Ne==null?void 0:Ne.message)||"Failed to save to cloud")}finally{E(!1),G()}};x.useEffect(()=>{if(!o){u(1);return}const Ne=()=>{const ge=s.current;if(!ge)return;const lt=ge.querySelector('table[data-cdap-table="1"]');if(!lt)return;const He=ge.clientWidth,mt=lt.scrollWidth;if(!He||!mt)return;const Pt=(He-24)/mt,bt=Math.min(1,Math.max(.35,Pt));u(bt)};Ne();const be=s.current;if(!be)return;const fe=new ResizeObserver(()=>Ne());return fe.observe(be),()=>fe.disconnect()},[o,I]);const Xe=LB.slice(3,8),nt=[...RB,...BB];return a.jsxs("div",{style:{border:"1px solid #dbe4f0",borderRadius:14,padding:"16px 18px",background:"#fff",boxShadow:"0 2px 12px rgba(15, 23, 42, 0.08)",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("style",{children:`
        .cdap-slider::-webkit-slider-thumb {
          appearance: none;
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .cdap-slider::-moz-range-thumb {
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          border: none;
        }
        .cdap-slider::-webkit-slider-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
        }
        .cdap-slider::-moz-range-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
          border: none;
        }
        .cdap-table-wrap { overflow-x: auto; border: 1px solid #e2e8f0; border-radius: 10px; }
        .cdap-table { border-collapse: collapse; width: 100%; font-size: 11px; table-layout: fixed; }
        .cdap-table thead th {
          position: sticky;
          top: 0;
          z-index: 2;
          border: 1px solid #e2e8f0;
          padding: 5px 4px;
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.03em;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .cdap-table tbody tr:hover td { background: #eff6ff !important; }
        .cdap-table tbody td { border: 1px solid #e2e8f0; padding: 3px 4px; vertical-align: top; }
        .cdap-cell-textarea {
          width: 100%;
          border: 1px solid #cbd5e1;
          border-radius: 4px;
          padding: 3px 5px;
          font-size: 11px;
          resize: none;
          font-family: inherit;
          line-height: 1.4;
        }
        .cdap-cell-textarea:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 2px rgba(37,99,235,0.15); }
        .cdap-cell-textarea:disabled { background: #f3f4f6; cursor: not-allowed; color: #6b7280; }
        .cdap-unit-card {
          border: 1px solid #dbe4f0;
          border-radius: 12px;
          background: #fff;
          margin-bottom: 14px;
          overflow: hidden;
          box-shadow: 0 1px 4px rgba(15,23,42,0.05);
        }
        .cdap-unit-header {
          display: grid;
          grid-template-columns: 80px 1fr 1fr;
          gap: 0;
          border-bottom: 1px solid #dbe4f0;
          background: #f1f5f9;
        }
        .cdap-unit-header-cell {
          padding: 8px 10px;
          border-right: 1px solid #dbe4f0;
        }
        .cdap-unit-header-cell:last-child { border-right: none; }
        .cdap-unit-header-cell label {
          display: block;
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.04em;
          color: #64748b;
          margin-bottom: 4px;
        }
        .cdap-unit-header-cell textarea {
          width: 100%;
          border: 1px solid #cbd5e1;
          border-radius: 6px;
          padding: 4px 6px;
          font-size: 12px;
          font-family: inherit;
          resize: none;
          background: #fff;
          line-height: 1.4;
        }
        .cdap-unit-header-cell textarea:focus { outline: none; border-color: #2563eb; }
        .cdap-unit-header-cell textarea:disabled { background: #f3f4f6; cursor: not-allowed; color: #6b7280; }
        .cdap-table-scale-wrap {
          transform-origin: left top;
        }
      `}),B?a.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#64748b"},children:"Loading from cloud"}):T?a.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#b91c1c"},children:T}):null,C?a.jsx("div",{style:{marginBottom:12,padding:"12px 16px",background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",border:"1px solid #fbbf24",borderRadius:10,color:"#92400e",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:a.jsx("span",{children:" Published  Document is read-only. Use Request Edit to make changes."})}):null,de||U?a.jsx("div",{style:{marginBottom:10,fontSize:12,color:U?"#b91c1c":"#64748b"},children:U||"Checking edit approval"}):re&&X&&(se!=null&&se.approval_until)?a.jsxs("div",{style:{marginBottom:10,fontSize:12,color:"#065f46"},children:["Edit approved until ",new Date(se.approval_until).toLocaleString(),"."]}):null,a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:10,padding:"10px 14px",background:"linear-gradient(to right, #f8fafc, #f1f5f9)",border:"1px solid #e2e8f0",borderRadius:12,marginBottom:14},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[a.jsx("div",{style:{width:36,height:36,borderRadius:9,background:"linear-gradient(135deg, #1e40af 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"}),a.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21"})]})}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,color:"#0f172a",fontSize:13},children:"Revised CDP Editor"}),a.jsx("div",{style:{fontSize:11,color:"#64748b"},children:"Interactive spreadsheet interface"})]})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,padding:"5px 8px",boxShadow:"0 1px 2px rgba(0,0,0,0.04)"},children:[a.jsx("button",{type:"button",onClick:()=>f(Ne=>Math.max(50,Ne-10)),style:{background:"none",border:"none",cursor:"pointer",padding:"0 2px",display:"flex",alignItems:"center"},children:a.jsx(Xte,{size:14,color:"#64748b"})}),a.jsx("input",{type:"range",min:"50",max:"200",step:"10",value:d,onChange:Ne=>f(parseInt(Ne.target.value,10)),className:"cdap-slider",style:{width:80}}),a.jsx("button",{type:"button",onClick:()=>f(Ne=>Math.min(200,Ne+10)),style:{background:"none",border:"none",cursor:"pointer",padding:"0 2px",display:"flex",alignItems:"center"},children:a.jsx(Kte,{size:14,color:"#64748b"})}),a.jsxs("span",{style:{fontSize:11,color:"#334155",minWidth:32,textAlign:"right",fontVariantNumeric:"tabular-nums"},children:[d,"%"]})]}),a.jsxs("button",{onClick:()=>l(Ne=>!Ne),title:"Toggle fit-to-screen scaling",style:{padding:"6px 10px",borderRadius:8,border:o?"none":"1px solid #e2e8f0",background:o?"#111827":"#fff",color:o?"#fff":"#374151",cursor:"pointer",fontWeight:600,fontSize:11,display:"flex",alignItems:"center",gap:5,boxShadow:o?"0 2px 6px rgba(17,24,39,0.25)":"0 1px 2px rgba(0,0,0,0.04)",transition:"all 150ms ease"},children:[a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}),a.jsx("path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}),a.jsx("path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}),a.jsx("path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"})]}),"Fit Screen: ",o?"ON":"OFF"]}),a.jsxs("button",{onClick:De,disabled:C,style:{padding:"6px 12px",borderRadius:8,border:"none",background:C?"#d1d5db":"#059669",color:"#fff",cursor:C?"not-allowed":"pointer",fontWeight:600,fontSize:11,opacity:C?.5:1,display:"flex",alignItems:"center",gap:5,boxShadow:C?"none":"0 2px 6px rgba(5,150,105,0.28)"},children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Row"]}),a.jsx("button",{onClick:()=>{if(!C)return _t();V(Ne=>!Ne),ie(null)},disabled:q,style:{padding:"6px 14px",borderRadius:8,border:"none",background:C?"#16a34a":"#2563eb",color:"#fff",cursor:q?"not-allowed":"pointer",fontWeight:700,fontSize:11,opacity:q?.6:1,boxShadow:C?"0 2px 6px rgba(22,163,74,0.28)":"0 2px 6px rgba(37,99,235,0.28)"},children:C?" Request Edit":" Publish"})]})]}),C&&K?a.jsxs("div",{style:{marginBottom:16,border:"1px solid #e2e8f0",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0f172a",marginBottom:8},children:"Reason (required)"}),a.jsx("textarea",{value:R,onChange:Ne=>J(Ne.target.value),rows:3,style:{width:"100%",padding:10,border:"1px solid #cbd5e1",borderRadius:10,fontSize:13,background:"#fff"},placeholder:"Why do you need to edit this published CDAP?"}),Q?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c",fontWeight:700},children:Q}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>V(!1),disabled:q,children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:Ae,disabled:q||!String(R||"").trim(),children:q?"Requesting":"Confirm Request"})]})]}):null,a.jsx("div",{ref:s,children:ke.map(Ne=>{var fe;const be=(fe=Ne.items[0])==null?void 0:fe.row;return be?a.jsxs("div",{className:"cdap-unit-card",children:[a.jsxs("div",{className:"cdap-unit-header",children:[a.jsxs("div",{className:"cdap-unit-header-cell",style:{background:"linear-gradient(135deg, #1e40af 0%, #2563eb 100%)"},children:[a.jsx("label",{style:{color:"rgba(255,255,255,0.75)"},children:"Unit #"}),a.jsx("textarea",{value:be.unit??"",onChange:ge=>Ne.items.forEach(lt=>_e(lt.index,"unit",ge.target.value)),disabled:C,rows:2,style:{background:"rgba(255,255,255,0.15)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:6,color:"#fff",padding:"4px 6px",fontSize:13,fontWeight:700,width:"100%",resize:"none",fontFamily:"inherit",cursor:C?"not-allowed":"text"}})]}),a.jsxs("div",{className:"cdap-unit-header-cell",children:[a.jsx("label",{children:"Syllabus (Unit Name)"}),a.jsx("textarea",{value:be.unit_name??"",onChange:ge=>Ne.items.forEach(lt=>_e(lt.index,"unit_name",ge.target.value)),disabled:C,rows:2})]}),a.jsxs("div",{className:"cdap-unit-header-cell",children:[a.jsx("label",{children:"Course Outcome (CO)"}),a.jsx("textarea",{value:be.co??"",onChange:ge=>Ne.items.forEach(lt=>_e(lt.index,"co",ge.target.value)),disabled:C,rows:2})]})]}),a.jsx("div",{className:"cdap-table-wrap",style:{margin:"0 0"},children:(()=>{const ge=o?c*(d/100):d/100,lt=Math.max(1,100/ge);return a.jsx("div",{className:"cdap-table-scale-wrap",style:{transform:`scale(${ge})`,width:`${lt}%`},children:a.jsxs("table",{"data-cdap-table":"1",className:"cdap-table",style:{minWidth:1200},children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:34}}),a.jsx("col",{style:{width:90}}),a.jsx("col",{style:{width:70}}),a.jsx("col",{style:{width:190}}),a.jsx("col",{style:{width:190}}),a.jsx("col",{style:{width:62}}),nt.map(He=>a.jsx("col",{style:{width:34}},He.key)),a.jsx("col",{style:{width:82}}),a.jsx("col",{style:{width:66}})]}),a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{background:"#f1f5f9",textAlign:"center"},children:"#"}),Xe.map(He=>a.jsx("th",{style:{background:"#f1f5f9",textAlign:"left"},children:He.label},He.key)),nt.map(He=>a.jsx("th",{style:{background:He.key.startsWith("pso")?"#fdf4ff":"#fff7ed",textAlign:"center"},children:He.label},He.key)),a.jsx("th",{style:{background:"#f0fdf4",textAlign:"center"},children:"HRS"}),a.jsx("th",{style:{background:"#f1f5f9",textAlign:"center"},children:"Act."})]})}),a.jsx("tbody",{children:Ne.items.map((He,mt)=>a.jsx(x.Fragment,{children:a.jsxs("tr",{style:{background:mt%2===0?"#fff":"#f8fafc"},children:[a.jsx("td",{style:{textAlign:"center",color:"#94a3b8",fontWeight:600,fontSize:10},children:mt+1}),Xe.map(wt=>a.jsx("td",{children:a.jsx("textarea",{value:He.row[wt.key]??"",onChange:Pt=>_e(He.index,wt.key,Pt.target.value),disabled:C,className:"cdap-cell-textarea",rows:2})},wt.key)),nt.map(wt=>a.jsx("td",{style:{textAlign:"center",background:wt.key.startsWith("pso")?"#fdf4ff":void 0},children:a.jsx("input",{type:"checkbox",checked:!!He.row[wt.key],onChange:Pt=>_e(He.index,wt.key,Pt.target.checked),disabled:C,style:{cursor:C?"not-allowed":"pointer",width:14,height:14,accentColor:"#2563eb"}})},wt.key)),a.jsx("td",{style:{textAlign:"center"},children:a.jsx("input",{type:"text",value:He.row.total_hours_required??"",onChange:wt=>_e(He.index,"total_hours_required",wt.target.value),disabled:C,style:{width:"100%",border:"1px solid #cbd5e1",borderRadius:4,padding:"3px 4px",fontSize:11,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text",textAlign:"center"}})}),a.jsx("td",{style:{textAlign:"center"},children:a.jsx("button",{type:"button",onClick:()=>We(He.index),disabled:C,title:"Delete row",style:{padding:"3px 7px",background:C?"#d1d5db":"#fee2e2",color:C?"#9ca3af":"#dc2626",border:`1px solid ${C?"#d1d5db":"#fca5a5"}`,borderRadius:5,cursor:C?"not-allowed":"pointer",fontSize:11,fontWeight:600,opacity:C?.5:1},children:""})})]})},He.index))})]})})})()}),a.jsx("div",{style:{padding:"10px 14px",borderTop:"1px solid #f1f5f9"},children:a.jsxs("button",{type:"button",onClick:()=>Ct(Ne.key),disabled:C,style:{padding:"6px 12px",background:C?"#e5e7eb":"#eff6ff",color:C?"#9ca3af":"#2563eb",border:`1px solid ${C?"#d1d5db":"#bfdbfe"}`,borderRadius:7,cursor:C?"not-allowed":"pointer",fontWeight:600,fontSize:12,opacity:C?.5:1,display:"flex",alignItems:"center",gap:5},children:[a.jsx("span",{style:{fontSize:14,lineHeight:1},children:"+"})," Add Row to Unit ",Ne.key]})})]},Ne.key):null})}),a.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#f8fafc"},children:[a.jsx("h4",{style:{marginBottom:10},children:"Reference Materials"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:16},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Textbook Details"}),a.jsx("textarea",{value:h,onChange:Ne=>p(Ne.target.value),disabled:C,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text"},placeholder:"Textbook details (Excel: Column B, Row 64)"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Reference Book Details"}),a.jsx("textarea",{value:m,onChange:Ne=>g(Ne.target.value),disabled:C,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text"},placeholder:"Reference book details (Excel: Column B, Row 68)"})]})]})]}),a.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0},children:"Active Learning Mapping"}),a.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"7  11 PO mapping matrix"})]}),a.jsx("button",{type:"button",onClick:()=>{b(io.map(()=>Tf.map(()=>!1))),w(io.map(()=>""))},disabled:C,style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e2e8f0",background:C?"#e5e7eb":"#f8fafc",cursor:C?"not-allowed":"pointer",opacity:C?.5:1},children:"Clear All"})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",minWidth:900,width:"100%"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Activity Type"}),a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Specific Activity"}),Tf.map(Ne=>a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#fff7ed",textAlign:"center"},children:Ne},Ne))]})}),a.jsx("tbody",{children:io.map((Ne,be)=>a.jsxs("tr",{style:{background:be%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,fontWeight:600},children:Ne}),a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8},children:a.jsxs("select",{value:v[be]??"",onChange:fe=>{const ge=fe.target.value;w(lt=>{const He=[...lt];return He[be]=ge,He}),b(lt=>{const He=lt.map(wt=>[...wt]),mt=pe(ge);if(Array.isArray(mt)&&mt.length===11)for(let wt=0;wt<Tf.length;wt++)He[be][wt]=!!mt[wt];return He})},disabled:C,style:{width:"100%",padding:6,border:"1px solid #cbd5e1",borderRadius:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"pointer"},children:[a.jsx("option",{value:"",children:"-- Select Activity --"}),(Array.isArray(j==null?void 0:j[be])&&(j!=null&&j[be].length)?j==null?void 0:j[be]:yv[Ne]??[]).map(lt=>String(lt??"").trim()).filter(Boolean).filter((lt,He,mt)=>mt.indexOf(lt)===He).map(lt=>a.jsx("option",{value:lt,children:lt},lt))]})}),Tf.map((fe,ge)=>a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!y[be][ge],disabled:C||(()=>{const lt=(v==null?void 0:v[be])??"";if(!lt)return!1;const He=pe(lt);return Array.isArray(He)&&He.length===11})(),onChange:lt=>{const He=lt.target.checked;b(mt=>{const wt=mt.map(Pt=>[...Pt]);return wt[be][ge]=He,wt})},style:{cursor:C?"not-allowed":"pointer"}})},fe))]},Ne))})]})})]})]})}function zPe({courseId:e,showHeader:t=!0,showCourseInput:r=!0}){const[n,i]=x.useState(e||""),[s,o]=x.useState(null),[l,c]=x.useState("idle"),[u,d]=x.useState(null),[f,h]=x.useState(!1),p=hn.useMemo(()=>{if(n)try{const m=localStorage.getItem(`markEntry_selectedTa_${n}`),g=m==null?NaN:Number(m);return Number.isFinite(g)?g:void 0}catch{return}},[n]);return x.useEffect(()=>{e&&i(e)},[e]),a.jsxs("div",{children:[t&&a.jsxs("h2",{children:["CDAP - ",n||"No course selected"]}),r&&!e&&a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("label",{style:{marginRight:8},children:"Course ID:"}),a.jsx("input",{value:n,onChange:m=>i(m.target.value),placeholder:"Enter course id",style:{padding:6,border:"1px solid #ccc",borderRadius:4}})]}),f?null:a.jsx("div",{style:{marginBottom:12},children:a.jsx($Pe,{subjectId:n,onUpload:async m=>{o(m);const g=(m==null?void 0:m.revision)||m;if(!(!n||!g)&&!(!Array.isArray(g==null?void 0:g.rows)||g.rows.length===0))try{c("saving"),d(null);const y=$9({subjectId:n,status:"draft",rows:g.rows,books:{textbook:g.textbook||"",reference:g.reference||""},teaching_assignment_id:p,active_learning:{grid:[],dropdowns:[],optionsByRow:g.activeLearningOptionsByRow||[],articulation_extras:g.articulationExtras||{}}}),b=new Promise((v,w)=>setTimeout(()=>w(new Error("Auto-save timed out. Server did not respond in time.")),6e4));await Promise.race([y,b]),c("saved"),d("Saved parsed CDAP to cloud (draft).")}catch(y){c("error"),d((y==null?void 0:y.message)||"Auto-save failed. You can still publish from the editor.")}}})}),u&&a.jsx("div",{style:{marginBottom:12,fontSize:12,color:l==="error"?"#b91c1c":"#166534"},children:u}),a.jsx("div",{style:{marginBottom:12},children:a.jsx(UPe,{subjectId:n,imported:(s==null?void 0:s.revision)||s,onLockChange:m=>h(!!m)})})]})}function Op({value:e,onChange:t,min:r,max:n}){return a.jsx("input",{type:"number",value:e,onChange:i=>{const s=i.target.value;t(s===""?"":Number(s))},min:r,max:n,style:{width:76,padding:"6px 8px",borderRadius:8,border:"1px solid #e6eef8",outline:"none",fontSize:13}})}function FB(e){const t=typeof e.band1=="number"?e.band1:0,r=typeof e.band2=="number"?e.band2:0,n=typeof e.band3=="number"?e.band3:0;if(!(t+r+n))return"-";const s=Math.max(t,r,n);return s===t?1:s===r?2:3}function WPe(e){return e===1?{label:"LOW LEVEL",code:"LL"}:e===2?{label:"MEDIUM LEVEL",code:"ML"}:e===3?{label:"HIGH LEVEL",code:"HL"}:{label:"",code:"-"}}const dr={page:{padding:20,width:"100%",boxSizing:"border-box",minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"flex-start",margin:0,fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947",background:"transparent"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)",width:"100%",maxWidth:1200,margin:"18px",flex:"1 1 auto"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},table:{width:"100%",borderCollapse:"collapse",marginTop:8,tableLayout:"auto",display:"block",overflowX:"auto",WebkitOverflowScrolling:"touch"},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13,whiteSpace:"nowrap"},thLeft:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"left",fontSize:13,whiteSpace:"nowrap",minWidth:220},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left",minWidth:220},cellYellow:{background:"#fef9c3"},cellGreen:{background:"#ecfdf3"},link:{color:"#0b4a6f",textDecoration:"underline",fontWeight:700},btn:{border:"1px solid #e6eef8",background:"#fbfdff",padding:"8px 10px",borderRadius:10,cursor:"pointer",fontWeight:700,color:"#0b4a6f"},pill:{display:"inline-flex",alignItems:"center",gap:8,padding:"8px 10px",borderRadius:10,background:"#fbfdff",border:"1px solid #e6eef8",fontSize:13,color:"#234451"}};function mj(e){return String(e||"").trim().toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9]/g,"")}function qPe(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=parseFloat(e.replace(/[^0-9.\-]/g,""));return Number.isFinite(t)?t:null}return null}function HPe(e){return e<=6?"HC":e<=8?"MC":"EC"}function VPe(e){return e==="EC"?"L1":e==="MC"?"L2":e==="HC"?"L3":"-"}async function GPe(e){var m;let t;try{t=await import("xlsx")}catch{throw new Error('Missing dependency "xlsx". Install it with: npm install xlsx  (or yarn add xlsx / pnpm add xlsx)')}const r=await e.arrayBuffer(),n=t.read(r,{type:"array"}),i=(m=n.SheetNames)==null?void 0:m[0];if(!i)throw new Error("No sheet found in the Excel file.");const s=n.Sheets[i],o=t.utils.sheet_to_json(s,{defval:""})||[];if(!o.length)throw new Error("Excel sheet is empty.");const l=Object.keys(o[0]||{}),c=new Map;l.forEach(g=>c.set(mj(g),g));const u=c.get("grade")||l.find(g=>mj(g).includes("grade"))||null,d=c.get("gpaconversion")||c.get("gpaconvert")||l.find(g=>{const y=mj(g);return y.includes("gpaconversion")||y.includes("gpaconvert")||y==="gpa"})||null;if(!u||!d)throw new Error('Excel must contain columns for "Grade" and "GPA conversion".');const f=[];for(const g of o){if(!String(g[u]??"").trim())continue;const b=qPe(g[d]);b!==null&&f.push(b)}if(!f.length)throw new Error('No numeric "GPA conversion" values found.');const h=f.reduce((g,y)=>g+y,0)/f.length,p=Number(h.toFixed(2));return{fileName:e.name,studentsCount:f.length,meanGpa:p,courseLevel:HPe(p)}}function KPe({courseId:e,courseCode:t,courseName:r,embedded:n}){const i=ul(),s=go(),o=(i.pathname||"").toLowerCase().includes("/lca/pbr"),[l,c]=x.useState({courseCode:t??e??"",courseName:r??"",credit:"",courseModule:""});x.useEffect(()=>{c(re=>({...re,courseCode:t??e??re.courseCode,courseName:r??re.courseName}))},[e,t,r]);const[u,d]=x.useState({band1:"",band2:"",band3:""}),f=x.useMemo(()=>FB(u),[u]),[h,p]=x.useState([{name:"Prerequisite 1",band1:"",band2:"",band3:""}]),m=x.useMemo(()=>h.map(re=>FB({band1:re.band1,band2:re.band2,band3:re.band3})),[h]),g=x.useMemo(()=>{const re=m.filter(C=>C!=="-");if(!re.length)return"";const X=re.reduce((C,K)=>C+K,0);return Number((X/re.length).toFixed(2))},[m]),y=x.useMemo(()=>g===""?"":Math.floor(g),[g]),b=x.useMemo(()=>y===""||y===0?"-":y===1||y===2||y===3?y:"-",[y]),v=x.useMemo(()=>WPe(b),[b]),w=x.useMemo(()=>b==="-"?"-":`L${b}`,[b]),[S,k]=x.useState(null),[j,A]=x.useState(null),[L,P]=x.useState(null),[B,E]=x.useState(null),[T,F]=x.useState("-"),W=x.useMemo(()=>j?j.courseLevel:S?S.courseLevel:T&&T!=="-"?T:"-",[S,j,T]),z=x.useMemo(()=>VPe(W),[W]),se=x.useMemo(()=>z!=="-"?z:w,[w,z]),de=e?`/obe/course/${encodeURIComponent(e)}`:"/obe/course",U=async(re,X)=>{if(P(null),!X){re==="cay1"?k(null):A(null);return}try{E(re);const C=await GPe(X);re==="cay1"?k(C):A(C)}catch(C){P(String((C==null?void 0:C.message)||C||"Failed to parse Excel")),re==="cay1"?k(null):A(null)}finally{E(null)}},G=re=>n?a.jsx(a.Fragment,{children:re}):a.jsx("div",{style:dr.page,children:a.jsx("div",{style:dr.card,children:re})});return G(o?a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:dr.title,children:"Previous Batch Result (PBR)"}),a.jsx("div",{style:dr.subtitle,children:"Upload up to 2 Excel files (max 2)."})]}),a.jsx("button",{type:"button",onClick:()=>s(`${de}/lca`),style:dr.btn,children:"Back"})]}),a.jsx("div",{style:{height:14}}),a.jsxs("div",{style:{marginBottom:8,display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{color:"#0b4a6f",fontWeight:700},children:"Fallback course level (if no Excel):"}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"HC",checked:T==="HC",onChange:()=>F("HC")}),"HARD COURSE (HC)"]}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"MC",checked:T==="MC",onChange:()=>F("MC")}),"MEDIUM COURSE (MC)"]}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"EC",checked:T==="EC",onChange:()=>F("EC")}),"EASY COURSE (EC)"]}),a.jsx("button",{type:"button",onClick:()=>F("-"),style:{marginLeft:8,...dr.btn,padding:"6px 8px"},children:"Clear"})]}),a.jsx("table",{style:dr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:800,width:220},children:"CAY-1 Excel"}),a.jsx("td",{style:{...dr.tdLeft,...dr.cellGreen},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:re=>{var X;return U("cay1",((X=re.target.files)==null?void 0:X[0])||null)}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:800},children:"CAY-2 Excel"}),a.jsx("td",{style:{...dr.tdLeft,...dr.cellGreen},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:re=>{var X;return U("cay2",((X=re.target.files)==null?void 0:X[0])||null)}})})]})]})}),B&&a.jsxs("div",{style:{marginTop:10,fontSize:13,color:"#3d5566"},children:["Parsing ",B.toUpperCase()," Excel"]}),L&&a.jsx("div",{style:{marginTop:10,fontSize:13,color:"#b42318",fontWeight:700},children:L}),a.jsx("div",{style:{height:14}}),a.jsxs("table",{style:dr.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:dr.thLeft,children:"DATASET"}),a.jsx("th",{style:dr.th,children:"FILE"}),a.jsx("th",{style:dr.th,children:"STUDENTS"}),a.jsx("th",{style:dr.th,children:"MEAN GPA"}),a.jsx("th",{style:dr.th,children:"COURSE LEVEL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:900},children:"CAY-1"}),a.jsx("td",{style:dr.tdLeft,children:(S==null?void 0:S.fileName)||""}),a.jsx("td",{style:dr.td,children:(S==null?void 0:S.studentsCount)??""}),a.jsx("td",{style:dr.td,children:S?S.meanGpa:""}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:(S==null?void 0:S.courseLevel)||""})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:900},children:"CAY-2"}),a.jsx("td",{style:dr.tdLeft,children:(j==null?void 0:j.fileName)||""}),a.jsx("td",{style:dr.td,children:(j==null?void 0:j.studentsCount)??""}),a.jsx("td",{style:dr.td,children:j?j.meanGpa:""}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:(j==null?void 0:j.courseLevel)||""})]})]})]}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:dr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:900,width:220},children:"PREVIOUS BATCH RESULT (PBR)"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:W==="-"?"":W}),a.jsx("td",{style:{...dr.tdLeft,fontWeight:900},children:"Learner Centric Level"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:z==="-"?"":z})]}),a.jsx("tr",{children:a.jsx("td",{style:{...dr.tdLeft,color:"#557085"},colSpan:4,children:"Course level rule: mean GPA 06 = HC, 68 = MC, >8 = EC. PBR uses CAY-2 when provided; otherwise CAY-1."})})]})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},children:[a.jsxs("div",{children:[a.jsx("h2",{style:dr.title,children:"Learner Centric Approach"}),a.jsx("div",{style:dr.subtitle,children:"Enter values in the highlighted cells; levels are computed automatically."})]}),a.jsx("div",{style:{...dr.pill,fontWeight:800},children:"INDEX"})]}),a.jsx("table",{style:dr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,width:220,fontWeight:700},children:"COURSE CODE"}),a.jsx("td",{style:{...dr.tdLeft,...dr.cellGreen},children:a.jsx("input",{value:l.courseCode,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course code is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:700},children:"COURSE NAME"}),a.jsx("td",{style:{...dr.tdLeft,...dr.cellGreen},children:a.jsx("input",{value:l.courseName,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course name is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:700},children:"CREDIT OF THE COURSE"}),a.jsx("td",{style:{...dr.tdLeft,...dr.cellGreen},children:a.jsx("input",{value:l.credit,onChange:re=>c(X=>({...X,credit:re.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:700},children:"COURSE MODULE"}),a.jsx("td",{style:{...dr.tdLeft,...dr.cellGreen},children:a.jsx("input",{value:l.courseModule,onChange:re=>c(X=>({...X,courseModule:re.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]})]})}),a.jsx("div",{style:{height:16}}),a.jsx("div",{style:dr.sectionTitle,children:"STEP 1: Identifying Learner profile"}),a.jsxs("table",{style:dr.table,children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:220}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:100}}),a.jsx("col",{style:{width:60}})]}),a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:dr.thLeft,colSpan:4,children:"1.1 CURRENT GPA PROFILE (CGP)"}),a.jsx("th",{style:dr.th,rowSpan:3,colSpan:2,children:"LEVEL"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:dr.thLeft,children:"Current batch mean GPA"}),a.jsx("th",{style:dr.th,children:"1"}),a.jsx("th",{style:dr.th,children:"2"}),a.jsx("th",{style:dr.th,children:"3"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:dr.thLeft,children:"GPA"}),a.jsx("th",{style:dr.th,children:"0 - 5"}),a.jsx("th",{style:dr.th,children:"5 - 7.5"}),a.jsx("th",{style:dr.th,children:"> 7.5"})]})]}),a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:700},children:"NUMBER OF STUDENTS (CAY-1)"}),a.jsx("td",{style:{...dr.td,...dr.cellYellow},children:a.jsx(Op,{value:u.band1,onChange:re=>d(X=>({...X,band1:re}))})}),a.jsx("td",{style:{...dr.td,...dr.cellYellow},children:a.jsx(Op,{value:u.band2,onChange:re=>d(X=>({...X,band2:re}))})}),a.jsx("td",{style:{...dr.td,...dr.cellYellow},children:a.jsx(Op,{value:u.band3,onChange:re=>d(X=>({...X,band3:re}))})}),a.jsx("td",{style:{...dr.td,fontWeight:800,color:"#0b4a6f"},colSpan:2,children:f})]})})]}),a.jsx("div",{style:{height:14}}),a.jsxs("table",{style:dr.table,children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:220}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:100}}),a.jsx("col",{style:{width:60}})]}),a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:dr.thLeft,colSpan:4,children:"1.2 PRE REQUISITE PROFILE (PRP)"}),a.jsx("th",{style:dr.th,children:"LEVEL"}),a.jsx("th",{style:dr.th,children:" "})]}),a.jsxs("tr",{children:[a.jsx("th",{style:dr.thLeft,children:" "}),a.jsx("th",{style:dr.th,children:"1"}),a.jsx("th",{style:dr.th,children:"2"}),a.jsx("th",{style:dr.th,children:"3"}),a.jsx("th",{style:dr.th,children:" "}),a.jsx("th",{style:dr.th,children:" "})]}),a.jsxs("tr",{children:[a.jsx("th",{style:dr.thLeft,children:" "}),a.jsx("th",{style:dr.th,children:"0 - 5"}),a.jsx("th",{style:dr.th,children:"5 - 7.5"}),a.jsx("th",{style:dr.th,children:"> 7.5"}),a.jsx("th",{style:dr.th,children:" "}),a.jsx("th",{style:dr.th,children:" "})]})]}),a.jsxs("tbody",{children:[h.map((re,X)=>a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:700},children:re.name}),a.jsx("td",{style:{...dr.td,...dr.cellYellow},children:a.jsx(Op,{value:re.band1,onChange:C=>p(K=>{const V=[...K];return V[X]={...V[X],band1:C},V})})}),a.jsx("td",{style:{...dr.td,...dr.cellYellow},children:a.jsx(Op,{value:re.band2,onChange:C=>p(K=>{const V=[...K];return V[X]={...V[X],band2:C},V})})}),a.jsx("td",{style:{...dr.td,...dr.cellYellow},children:a.jsx(Op,{value:re.band3,onChange:C=>p(K=>{const V=[...K];return V[X]={...V[X],band3:C},V})})}),a.jsx("td",{style:{...dr.td,fontWeight:800,color:"#0b4a6f"},children:m[X]}),a.jsx("td",{style:{...dr.td},children:a.jsx("button",{type:"button",title:"Delete prerequisite","aria-label":`Delete ${re.name}`,onClick:()=>p(C=>C.filter((K,V)=>V!==X)),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:16},children:""})})]},re.name)),a.jsx("tr",{children:a.jsxs("td",{style:{...dr.tdLeft},colSpan:6,children:[a.jsx("button",{type:"button",style:{...dr.btn,padding:"6px 10px"},onClick:()=>p(re=>[...re,{name:`Prerequisite ${re.length+1}`,band1:"",band2:"",band3:""}]),"aria-label":"Add prerequisite",children:"+"}),a.jsx("span",{style:{marginLeft:10,fontSize:13,color:"#557085"},children:"Add next prerequisite"})]})}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:700},colSpan:5,children:"AVERAGE"}),a.jsx("td",{style:{...dr.td,fontWeight:800},children:g===""?"-":g})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:700},colSpan:5,children:"Standardized level of Learner profile as per the above norms"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900,color:"#0b4a6f"},children:b==="-"?"-":b})]})]})]}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:dr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,...dr.cellGreen,fontWeight:900},children:"LOW LEVEL"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:"LL"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:"1"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,...dr.cellGreen,fontWeight:900},children:"MEDIUM LEVEL"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:"ML"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:"2"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,...dr.cellGreen,fontWeight:900},children:"HIGH LEVEL"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:"HL"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:"3"})]})]})}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:dr.table,children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:800,width:220},children:"The Learners are at"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:v.label}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:v.code})]})})}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:dr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:900,width:260},children:a.jsx(es,{style:dr.link,to:`${de}/lca/pbr`,children:"PREVIOUS BATCH RESULT (PBR)"})}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:W==="-"?"":W}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:j?"COURSE LEVEL (CAY-2)":"COURSE LEVEL (CAY-1)"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:700},children:" "}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:S?`Mean GPA: ${S.meanGpa}`:""}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:j?`Mean GPA: ${j.meanGpa}`:""})]})]})}),a.jsx("div",{style:{height:12}}),a.jsx("table",{style:dr.table,children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...dr.tdLeft,fontWeight:900,width:260},children:"Learner Centric Level"}),a.jsx("td",{style:{...dr.td,...dr.cellGreen,fontWeight:900},children:se})]})})})]}))}const In={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},headerRow:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap",marginBottom:12},label:{color:"#557085",fontSize:12,fontWeight:700},codeBox:{background:"#fbfdff",border:"1px solid #e6eef8",padding:"10px 14px",borderRadius:8,fontWeight:800,color:"#0b4a6f",fontSize:18},nameBox:{background:"#fff",padding:"6px 10px",color:"#234451"},sectionTitle:{marginTop:8,marginBottom:12,color:"#0b3b57",fontSize:16,fontWeight:700},table:{width:"100%",borderCollapse:"collapse",marginTop:12},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"12px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"12px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left"},checkbox:{transform:"scale(1.2)",cursor:"pointer",margin:"0"},inputNumber:{width:80,padding:"6px 8px",borderRadius:6,border:"1px solid #d1e3f0",textAlign:"center"}};function AK({courseCode:e=" ",courseName:t=" ",embedded:r=!1,onClose:n}){const i=ul(),s=go(),o=r?{padding:12,maxWidth:980,width:"100%",margin:"0 auto"}:In.page,[l,c]=x.useState(""),[u,d]=x.useState(()=>{var de;const W=t&&t.trim()?t.trim():"",z=((de=i.state)==null?void 0:de.courseName)||"",se=new URLSearchParams(i.search).get("name")||"";return W||z||se||""}),f=u||l||"",[h,p]=x.useState(()=>{try{const W=new URLSearchParams(i.search),z=W.get("teaching_assignment_id")||W.get("teachingAssignmentId");if(!z)return null;const se=Number(z);return Number.isFinite(se)?se:null}catch{return null}}),[m,g]=x.useState(null),[y,b]=x.useState(null),[v,w]=x.useState(()=>Array(5).fill(null)),[S,k]=x.useState({ico:.4,bco:.3,aco:.1,api:.1,iic:.1}),[j,A]=x.useState(Array.from({length:5},()=>({aco:null,api:null,iic:null})));function L(W,z){const se=Math.pow(10,z);return Math.round((W+Number.EPSILON)*se)/se}function P(W,z=2,se=!0){if(W==null||W==="")return se?null:0;const de=Number(W);if(!Number.isFinite(de))return se?null:0;const U=L(de,z);return U<0?0:U}x.useEffect(()=>{let W=!0;return(async()=>{try{if(!e)return;const z=await I4(e,typeof h=="number"?h:void 0);if(!W||!z)return;g(z);const se=Array.isArray(z.units)?z.units:[],de=[],U=G=>{if(!Number.isFinite(G))return null;const re=L(G,2),X=L(re*3,2);return X===0?null:X};for(let G=0;G<5;G++){const re=se[G];if(!re||!Array.isArray(re.rows)||re.rows.length===0){de.push([]);continue}const X=re.rows,C=X.reduce((J,q)=>{const Y=Number(q.hours);return J+(Number.isFinite(Y)?Y:0)},0),K=11,V=3,R=[];for(let J=0;J<K;J++){const q=X.reduce((Y,Q)=>{const ie=Number((Q.po&&Q.po[J])??0);return Y+(Number.isFinite(ie)?ie:0)},0);if(C>0){const Y=q/C,Q=U(Y);Q!=null&&R.push(Q)}}for(let J=0;J<V;J++){const q=X.reduce((Y,Q)=>{const ie=Number((Q.pso&&Q.pso[J])??0);return Y+(Number.isFinite(ie)?ie:0)},0);if(C>0){const Y=q/C,Q=U(Y);Q!=null&&R.push(Q)}}de.push(R)}b(de)}catch{}})(),()=>{W=!1}},[e,h]);const B=hn.useMemo(()=>y?y.map(W=>{if(!Array.isArray(W)||W.length===0)return{high:0,med:0,low:0,total:0,ico:0};let z=0,se=0,de=0;W.forEach(X=>{const C=Number(X);Number.isFinite(C)&&(C>=1.98?z++:C>=.99?se++:de++)});const U=z*3+se*2+de*1,G=z+se+de,re=G?L(U/(G*3)*100,2):0;return{high:z,med:se,low:de,total:U,ico:re}}):null,[y]),E=hn.useMemo(()=>v.map(W=>W?W*10:null),[v]),T=hn.useMemo(()=>{var z,se,de;const W=[];for(let U=0;U<5;U++){const G=B&&B[U]?B[U].ico:0,re=E[U]??0,X=((z=j[U])==null?void 0:z.aco)??0,C=((se=j[U])==null?void 0:se.api)??0,K=((de=j[U])==null?void 0:de.iic)??0,V=G*S.ico+re*S.bco+X*S.aco+C*S.api+K*S.iic,R=Math.round(V),J=L(R*.03,2);W.push({weightedRounded:R,final:J})}return W},[B,E,j,S]);x.useEffect(()=>{let W=!0;return(async()=>{try{if(!l&&e&&typeof h=="number"){const z=await D9(e,h);if(!W||!z)return;const se=z.course_name||z.subject_name||z.courseName||z.revision&&(z.revision.course_name||z.revision.courseName||z.revision.subject_name)||"";se&&c(String(se))}}catch{}})(),()=>{W=!1}},[e,l,h]),x.useEffect(()=>{l&&!u&&d(l)},[l,u]),x.useEffect(()=>{let W=!0;return(async()=>{try{if(u||!e)return;try{const z=await lc();if(!W)return;const de=(z||[]).filter(U=>String(U.subject_code)===String(e))[0]||null;if(h==null&&de&&de.id!=null){const U=Number(de.id);Number.isFinite(U)&&p(U)}if(de&&de.subject_name){d(String(de.subject_name));return}}catch{}try{const z=await bl();if(!W)return;const se=String(e),de=se.toUpperCase(),U=(z||[]).find(G=>String((G==null?void 0:G.course_code)||"").trim()===se||String((G==null?void 0:G.course_code)||"").trim().toUpperCase()===de);if(U&&U.course_name){d(String(U.course_name));return}}catch{}}catch{}})(),()=>{W=!1}},[e,f,u,h]);const F=[{co:"CO1",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:68,scale:2.03},{co:"CO2",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:66,scale:1.99},{co:"CO3",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.01},{co:"CO4",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.02},{co:"CO5",ico:0,bco:.5,aco:0,api:0,iic:0,target:74,scale:2.22}];return a.jsx("div",{style:o,children:a.jsxs("div",{style:In.card,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,marginBottom:12},children:[a.jsxs("div",{style:In.headerRow,children:[a.jsxs("div",{children:[a.jsx("div",{style:In.label,children:"COURSE CODE"}),a.jsx("div",{style:In.codeBox,children:e})]}),a.jsxs("div",{style:{marginLeft:12},children:[a.jsx("div",{style:In.label,children:"COURSE NAME"}),a.jsx("div",{style:In.nameBox,children:f})]})]}),a.jsx("div",{children:r?n?a.jsx("button",{onClick:n,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:"Close"}):null:a.jsx("button",{onClick:()=>s(-1),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:" Back"})})]}),a.jsxs("div",{style:{...In.card,padding:14,marginTop:0},children:[a.jsx("div",{style:In.sectionTitle,children:"Course Outcome Attainment  Targets"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginTop:12},children:[a.jsxs("div",{style:{...In.card,padding:16,minHeight:140},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"1. Rubrics for Impact (ICO)"}),a.jsxs("table",{style:In.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:In.th,children:"CO"}),a.jsx("th",{style:In.th,children:"High (3)"}),a.jsx("th",{style:In.th,children:"Medium (2)"}),a.jsx("th",{style:In.th,children:"Low (1)"}),a.jsx("th",{style:In.th,children:"Total"}),a.jsx("th",{style:In.th,children:"ICO"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((W,z)=>{const se=B&&B[z]?B[z]:{high:0,med:0,low:0,total:0,ico:0};return a.jsxs("tr",{children:[a.jsx("td",{style:In.tdLeft,children:W}),a.jsx("td",{style:In.td,children:se.high}),a.jsx("td",{style:In.td,children:se.med}),a.jsx("td",{style:In.td,children:se.low}),a.jsx("td",{style:In.td,children:se.total}),a.jsxs("td",{style:In.td,children:[se.ico.toFixed(2),"%"]})]},W)})})]})]}),a.jsxs("div",{style:{...In.card,padding:16,minHeight:140},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"2. BTL Level (BCO)"}),a.jsxs("table",{style:In.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:In.th,children:"CO"}),a.jsx("th",{style:In.th,children:"BTL-1"}),a.jsx("th",{style:In.th,children:"BTL-2"}),a.jsx("th",{style:In.th,children:"BTL-3"}),a.jsx("th",{style:In.th,children:"BTL-4"}),a.jsx("th",{style:In.th,children:"BTL-5"}),a.jsx("th",{style:In.th,children:"BTL-6"}),a.jsx("th",{style:In.th,children:"BCO"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((W,z)=>a.jsxs("tr",{children:[a.jsx("td",{style:In.tdLeft,children:W}),Array.from({length:6},(se,de)=>{const U=de+1,G=v[z]===U;return a.jsx("td",{style:In.td,children:a.jsx("input",{type:"checkbox","aria-label":`BTL-${U} for ${W}`,style:In.checkbox,checked:!!G,onChange:()=>{w(re=>{const X=[...re];return X[z]===U?X[z]=null:X[z]=U,X})},disabled:v[z]!=null&&v[z]!==U,title:v[z]!=null&&v[z]!==U?"Disabled while another BTL is selected":`Select BTL-${U}`})},U)}),a.jsx("td",{style:In.td,children:E[z]??""})]},W))})]})]}),a.jsxs("div",{style:{...In.card,padding:16,minHeight:120},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"3. Last year's Average CO attainment (ACO)"}),a.jsxs("table",{style:In.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:In.th,children:"COs"}),a.jsx("th",{style:In.th,children:"SUB"})]})}),a.jsx("tbody",{children:F.map((W,z)=>{var se;return a.jsxs("tr",{children:[a.jsx("td",{style:In.tdLeft,children:W.co}),a.jsx("td",{style:In.td,children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((se=j[z])==null?void 0:se.aco)??"",onChange:de=>{const U=de.target.value===""?null:de.target.value;A(G=>{const re=[...G];return re[z]={...re[z],aco:U===null?null:Number(U)},re})},onBlur:de=>{const U=P(de.target.value,2,!0);A(G=>{const re=[...G];return re[z]={...re[z],aco:U},re})}})})]},W.co)})})]})]}),a.jsxs("div",{style:{...In.card,padding:16,minHeight:120},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"4. Average Performance Index (API)"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{border:"1px solid #94a3b8",borderRadius:4,overflow:"hidden",flex:1},children:a.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,minWidth:220,background:"#fff",fontWeight:700,borderRight:"1px solid #94a3b8"},children:"BATCH (CAY)"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"NO OF SUCCESSFUL"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"MEAN CGPA"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]})]})})}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Per-CO API (manual)"}),a.jsxs("table",{style:In.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:In.th,children:"CO"}),a.jsx("th",{style:In.th,children:"API"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((W,z)=>{var se;return a.jsxs("tr",{children:[a.jsx("td",{style:In.tdLeft,children:W}),a.jsx("td",{style:In.td,children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((se=j[z])==null?void 0:se.api)??"",onChange:de=>{const U=de.target.value===""?null:de.target.value;A(G=>{const re=[...G];return re[z]={...re[z],api:U===null?null:Number(U)},re})},onBlur:de=>{const U=P(de.target.value,2,!0);A(G=>{const re=[...G];return re[z]={...re[z],api:U},re})}})})]},W)})})]})]})]}),a.jsxs("div",{style:{marginTop:12,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("div",{style:{color:"#234451",fontWeight:700},children:"Average Performance Index of the student's batch (API) - GPA ="}),a.jsx("div",{style:{border:"2px solid #0b4a6f",padding:"6px 10px",fontWeight:900}}),a.jsx("div",{children:"/100"})]})]}),a.jsxs("div",{style:{...In.card,padding:18,minHeight:180},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"5. The Improvement Index on CO attainment (IIC)"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{border:"2px solid #0b3b57",borderRadius:4,overflow:"hidden",width:360,background:"#fff"},children:a.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:a.jsxs("tbody",{children:[a.jsx("tr",{children:a.jsx("td",{colSpan:2,style:{padding:12,background:"#f8fafc",fontWeight:800,color:"#0b3b57"},children:"Learner Centric Approach (LCA)"})}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L3"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L2"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L1"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]})]})})}),a.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:12,alignItems:"stretch"},children:[a.jsxs("div",{style:{width:"100%"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:8,textAlign:"center",color:"#0b3b57"},children:"The Course Outcome Attainment Targets"}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"2px solid #0b3b57"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f2ff",color:"#0b3b57"},children:"COs"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"ICO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"BCO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"ACO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"API"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"IIC"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fff7d6",color:"#6b4a00"},children:"COs Targets"}),a.jsx("th",{style:{padding:10,background:"#fff7d6",color:"#6b4a00"},children:"CO TARGET IN 3 POINT SCALE"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderTop:"1px solid #e6eef8",background:"#f3f8ff",fontWeight:700},children:"Weight Values"}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.ico,onChange:W=>k(z=>({...z,ico:Number(W.target.value||0)})),onBlur:W=>k(z=>({...z,ico:P(W.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.bco,onChange:W=>k(z=>({...z,bco:Number(W.target.value||0)})),onBlur:W=>k(z=>({...z,bco:P(W.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.aco,onChange:W=>k(z=>({...z,aco:Number(W.target.value||0)})),onBlur:W=>k(z=>({...z,aco:P(W.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.api,onChange:W=>k(z=>({...z,api:Number(W.target.value||0)})),onBlur:W=>k(z=>({...z,api:P(W.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:S.iic,onChange:W=>k(z=>({...z,iic:Number(W.target.value||0)})),onBlur:W=>k(z=>({...z,iic:P(W.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}})]}),["CO-1","CO-2","CO-3","CO-4","CO-5"].map((W,z)=>{var se,de,U,G,re;return a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb",textAlign:"left",fontWeight:700},children:W}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:B&&B[z]?B[z].ico.toFixed(2)+"%":""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:E[z]??""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((se=j[z])==null?void 0:se.aco)??"",onChange:X=>{const C=X.target.value===""?null:X.target.value;A(K=>{const V=[...K];return V[z]={...V[z],aco:C===null?null:Number(C)},V})},onBlur:X=>{const C=P(X.target.value,2,!0);A(K=>{const V=[...K];return V[z]={...V[z],aco:C},V})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((de=j[z])==null?void 0:de.api)??"",onChange:X=>{const C=X.target.value===""?null:X.target.value;A(K=>{const V=[...K];return V[z]={...V[z],api:C===null?null:Number(C)},V})},onBlur:X=>{const C=P(X.target.value,2,!0);A(K=>{const V=[...K];return V[z]={...V[z],api:C},V})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:In.inputNumber,type:"number",value:((U=j[z])==null?void 0:U.iic)??"",onChange:X=>{const C=X.target.value===""?null:X.target.value;A(K=>{const V=[...K];return V[z]={...V[z],iic:C===null?null:Number(C)},V})},onBlur:X=>{const C=P(X.target.value,2,!0);A(K=>{const V=[...K];return V[z]={...V[z],iic:C},V})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:((G=T[z])==null?void 0:G.weightedRounded)??""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:((re=T[z])==null?void 0:re.final)??""})]},W)})]})]})]}),a.jsx("div",{style:{width:"100%",background:"#86efac",padding:12,borderRadius:6,border:"2px solid #16a34a",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontWeight:700},children:"TARGET TABLE WILL BE GENERATED AUTOMATICALLY"})]})]})]})]})]})]})})}const on={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},titleBlock:{display:"flex",flexDirection:"column"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},grid:{display:"grid",gap:16},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},paragraph:{color:"#334e68",lineHeight:1.45,margin:0},table:{width:"100%",borderCollapse:"collapse",marginTop:8},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},note:{color:"#6b8190",fontSize:13},kv:{background:"#fbfdff",padding:10,borderRadius:8,border:"1px solid #e9f3fb",minWidth:160},kvLabel:{fontSize:12,color:"#557085",marginBottom:6},kvValue:{fontWeight:700,color:"#0b4a6f"}};function YPe({title:e,columns:t,rows:r}){return a.jsxs("div",{children:[e&&a.jsx("div",{style:on.sectionTitle,children:e}),a.jsxs("table",{style:on.table,children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(n=>a.jsx("th",{style:on.th,children:n},n))})}),a.jsx("tbody",{children:r.map((n,i)=>a.jsx("tr",{children:n.map((s,o)=>a.jsx("td",{style:on.td,children:s},o))},i))})]})]})}function NK({courseCode:e,courseName:t,initialTab:r,viewerMode:n}){const i=x.useMemo(()=>e?String(e):"",[e]);go();const[s,o]=x.useState(r||"instructions");x.useEffect(()=>{r&&o(r)},[r]);const l=[{key:"instructions",label:"LCA Instructions"},{key:"lca",label:"LCA"},{key:"cdap",label:"CDAP"},{key:"articulation",label:"Articulation Matrix"},{key:"cotarget",label:"CO Target"}],c={display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},u=(d,f)=>{const h=s===d,p=()=>{if(d==="cotarget"){o(d);return}o(d)};return a.jsx("button",{onClick:p,style:{padding:"8px 12px",borderRadius:8,border:h?"2px solid #0b4a6f":"1px solid #e6eef8",background:h?"#0b4a6f":"#fbfdff",color:h?"#fff":"#0b4a6f",fontWeight:700,cursor:"pointer"},children:f},f)};return a.jsx("div",{style:on.page,children:a.jsxs("div",{style:{...on.card},children:[a.jsx("div",{style:on.header,children:a.jsxs("div",{style:on.titleBlock,children:[a.jsx("h2",{style:on.title,children:"Learner Centric Approach  Instructions"}),a.jsx("div",{style:on.subtitle,children:"Default LCA planning matrix and instruction-level guidance for course design and assessment."})]})}),a.jsxs("div",{style:{padding:12},children:[a.jsx("div",{style:c,children:l.map(d=>u(d.key,d.label))}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-start",gap:12,flexWrap:"wrap",marginBottom:12},children:a.jsxs("div",{style:on.kv,children:[a.jsx("div",{style:on.kvLabel,children:"Course"}),a.jsx("div",{style:on.kvValue,children:(e||"")+(t?`  ${t}`:"")})]})}),s==="instructions"&&a.jsxs("div",{style:on.grid,children:[a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:16,alignItems:"start"},children:a.jsxs("div",{style:{...on.card,padding:14,gridColumn:"1 / -1"},children:[a.jsx("div",{style:on.sectionTitle,children:"Overview"}),a.jsx("p",{style:on.paragraph,children:"Use this page to map learner profiles (L1L3) to instruction levels (IL-1..IL-3) and to define assessment distribution. The tables below provide recommended mappings and a sample distribution for course planning."}),a.jsx("div",{style:{marginTop:12},children:a.jsx(YPe,{title:"Learner Profile  Quick Guide",columns:["Profile","Description"],rows:[["L1","Lower CGPA / limited prerequisites"],["L2","Average preparedness"],["L3","High CGPA / strong prerequisites"]]})})]})}),a.jsxs("div",{style:{...on.card,padding:14},children:[a.jsx("div",{style:on.sectionTitle,children:"Instruction Steps (recommended)"}),a.jsxs("ol",{style:{margin:0,paddingLeft:18,color:"#334e68"},children:[a.jsx("li",{style:{marginBottom:8},children:"Identify learner profile (L1 / L2 / L3) for the target offering."}),a.jsx("li",{style:{marginBottom:8},children:"Use IL mapping to determine instruction emphasis across IL-1..IL-3."}),a.jsx("li",{style:{marginBottom:8},children:"Apply distribution when preparing teaching plan and question banks (map PT / CO / BTL)."})]})]}),a.jsxs("div",{style:{display:"grid",gap:12},children:[a.jsxs("div",{style:{...on.card,padding:12},children:[a.jsx("div",{style:on.sectionTitle,children:"Sample Assessment Distribution by Learner Profile"}),a.jsxs("table",{style:on.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:on.th,children:"Learner Profile"}),a.jsx("th",{style:on.th,children:"IL-1 %"}),a.jsx("th",{style:on.th,children:"IL-2 %"}),a.jsx("th",{style:on.th,children:"IL-3 %"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"L1"}),a.jsx("td",{style:on.td,children:"60"}),a.jsx("td",{style:on.td,children:"30"}),a.jsx("td",{style:on.td,children:"10"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"L2"}),a.jsx("td",{style:on.td,children:"30"}),a.jsx("td",{style:on.td,children:"50"}),a.jsx("td",{style:on.td,children:"20"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"L3"}),a.jsx("td",{style:on.td,children:"10"}),a.jsx("td",{style:on.td,children:"40"}),a.jsx("td",{style:on.td,children:"50"})]})]})]})]}),a.jsxs("div",{style:{...on.card,padding:12},children:[a.jsx("div",{style:on.sectionTitle,children:"Current Course  Example Breakdown"}),a.jsxs("table",{style:on.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:on.th,children:"Component"}),a.jsx("th",{style:on.th,children:"IL-1"}),a.jsx("th",{style:on.th,children:"IL-2"}),a.jsx("th",{style:on.th,children:"IL-3"}),a.jsx("th",{style:on.th,children:"Notes"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"Teaching Hours"}),a.jsx("td",{style:on.td,children:"40%"}),a.jsx("td",{style:on.td,children:"40%"}),a.jsx("td",{style:on.td,children:"20%"}),a.jsx("td",{style:on.td,children:"Blend of lectures and labs"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"Question Bank"}),a.jsx("td",{style:on.td,children:"50%"}),a.jsx("td",{style:on.td,children:"30%"}),a.jsx("td",{style:on.td,children:"20%"}),a.jsx("td",{style:on.td,children:"Adjust difficulty by profile"})]})]})]}),a.jsx("div",{style:{marginTop:10},children:a.jsx("div",{style:on.note,children:"Tip: Use these templates as starting points and adapt percentages to the specific cohort."})})]}),a.jsxs("div",{style:{...on.card,padding:12},children:[a.jsx("div",{style:on.sectionTitle,children:"IL Mapping"}),a.jsxs("table",{style:on.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:on.th,children:"IL"}),a.jsx("th",{style:on.th,children:"Instruction Focus"}),a.jsx("th",{style:on.th,children:"Typical Assessment Emphasis"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"IL-1"}),a.jsx("td",{style:on.td,children:"Foundation, concepts, scaffolding"}),a.jsx("td",{style:on.td,children:"More formative; MCQ / guided tasks"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"IL-2"}),a.jsx("td",{style:on.td,children:"Application and practice"}),a.jsx("td",{style:on.td,children:"Mixture of practical and theory"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:on.td,children:"IL-3"}),a.jsx("td",{style:on.td,children:"Advanced, synthesis, independent work"}),a.jsx("td",{style:on.td,children:"Problem-solving, projects, high-level questions"})]})]})]})]})]})]}),s==="lca"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx(KPe,{embedded:!0,courseId:i,courseCode:i,courseName:t??void 0}):a.jsxs("div",{style:{...on.card,padding:16},children:[a.jsx("div",{style:on.sectionTitle,children:"LCA"}),a.jsx("div",{style:on.paragraph,children:"Select a course to view the LCA worksheet."})]})}),s==="cdap"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx("div",{style:{...on.card,padding:12},children:a.jsx(zPe,{courseId:i,showHeader:!1,showCourseInput:!1})}):a.jsxs("div",{style:{...on.card,padding:16},children:[a.jsx("div",{style:on.sectionTitle,children:"CDAP"}),a.jsx("div",{style:on.paragraph,children:"Select a course to open CDAP."})]})}),s==="articulation"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx(RPe,{embedded:!0,courseId:i}):a.jsxs("div",{style:{...on.card,padding:16},children:[a.jsx("div",{style:on.sectionTitle,children:"Articulation Matrix"}),a.jsx("div",{style:on.paragraph,children:"Select a course to view the articulation matrix."})]})}),s==="cotarget"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx("div",{style:{...on.card,padding:12},children:a.jsx(AK,{embedded:!0,courseCode:i,courseName:t??void 0,onClose:()=>o("instructions")})}):a.jsxs("div",{style:{...on.card,padding:16},children:[a.jsx("div",{style:on.sectionTitle,children:"CO Target"}),a.jsx("div",{style:on.paragraph,children:"Select a course to view CO Targets."})]})})]})]})})}const XPe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],QPe=[{key:"q1",label:"Q1",max:2,co:3,btl:1},{key:"q2",label:"Q2",max:2,co:3,btl:3},{key:"q3",label:"Q3",max:2,co:3,btl:4},{key:"q4",label:"Q4",max:2,co:4,btl:1},{key:"q5",label:"Q5",max:2,co:4,btl:1},{key:"q6",label:"Q6",max:2,co:4,btl:2},{key:"q7",label:"Q7",max:16,co:3,btl:2},{key:"q8",label:"Q8",max:16,co:4,btl:3},{key:"q9",label:"Q9",max:16,co:"3&4",btl:5}],gj=30,ix={co1:42,co2:42,co3:58,co4:42,co5:42},hN=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],CK=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],xj=hN.reduce((e,t,r)=>e+(CK[r]===5?t.max:0),0),IB=10;function JPe(e,t,r){if(t)return 5;const n=ti(e);return r.includes("model")&&(n==="THEORY"||n==="TCPL"||n==="TCPR")?5:4}function ZPe(e){return Array.from({length:e},(t,r)=>r+1)}const im={ssa1:1.5,cia1:3,formative1:2.5},eOe={THEORY:{ssa1:1.5,cia1:3,formative1:2.5},TCPR:{ssa1:2,cia1:2.5,formative1:2},TCPL:{ssa1:1,cia1:2,formative1:3},LAB:{ssa1:1,cia1:1,formative1:1},PRACTICAL:{ssa1:1,cia1:1,formative1:1},SPECIAL:{ssa1:1.5,cia1:3,formative1:2.5},AUDIT:{ssa1:1.5,cia1:3,formative1:2.5}};function bv(e){if(!e)return im;const t=ti(e);return eOe[t]||im}function mi(e,t,r){return Math.max(t,Math.min(r,e))}function ds(e){return Math.round(e*10)/10}function Pf(e){return Math.round(e*100)/100}function Wl(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function ax(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function vv(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function yj(e){const t=typeof e=="number"?e:Number(e);if(!Number.isFinite(t))return null;const r=Math.trunc(t);return r>=1&&r<=6?r:null}function DB(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function $B(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const r=e.trim();if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="4")return 4;if(r==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(e);return t===4?4:t===3?3:t===34?"3&4":3}function tOe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function UB(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),i=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&i&&s?{co1:.5,co2:.5}:tOe(r.co)}function rOe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function zB(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),i=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&i&&s?{co3:.5,co4:.5}:rOe(r.co)}function WB(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function wv(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:i,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u,outOf:d}=e,f=[{mark:t,max:i,w:l},{mark:r,max:s,w:c},{mark:n,max:o,w:u}].filter(g=>Number(g.w||0)>0);if(!f.length||!d||!Number.isFinite(Number(d))||f.some(g=>g.mark==null)||f.some(g=>!g.max||!Number.isFinite(Number(g.max))))return null;const h=f.reduce((g,y)=>g+y.w,0);if(!h)return null;const m=f.reduce((g,y)=>g+y.mark/y.max*y.w,0)/h*d;return Number.isFinite(m)?mi(m,0,d):null}function EK({courseId:e,enabledAssessments:t,classType:r}){const[n,i]=x.useState(null),[s,o]=x.useState(r??null),l=x.useMemo(()=>Array.isArray(t),[t]),c=x.useMemo(()=>{const Me=Array.isArray(t)?t:[];return new Set(Me.map(Ce=>String(Ce||"").trim().toLowerCase()).filter(Boolean))},[t]),u=x.useMemo(()=>c.has("model"),[c]),[d,f]=x.useState(null),[h,p]=x.useState(null),m=x.useMemo(()=>l||Wre(s),[l,s]),g=x.useMemo(()=>({ssa1:!m||c.has("ssa1"),ssa2:!m||c.has("ssa2"),formative1:!m||c.has("formative1"),formative2:!m||c.has("formative2"),cia1:!m||c.has("cia1"),cia2:!m||c.has("cia2"),model:!m||c.has("model")}),[m,c]),y=x.useMemo(()=>N3(s)&&!l,[s,l]),b=x.useMemo(()=>ti(s)==="TCPL",[s]),v=x.useMemo(()=>{const Me=ti(s);return(Me==="THEORY"||Me==="TCPL"||Me==="TCPR")&&!!g.model},[s,g.model]),w=x.useMemo(()=>{const Me=Object.entries(g).filter(([Ce,It])=>It).map(([Ce])=>Ce);return JPe(s,y,Me)},[s,y,g]),S=x.useMemo(()=>ZPe(w),[w]),[k,j]=x.useState([]),[A,L]=x.useState(null),[P,B]=x.useState(null);x.useEffect(()=>{if(!e||P==null||!u){f(null),p(null);return}let Me=!0;return(async()=>{try{const Ce=await vS("model",String(e),Number(P));if(!Me)return;f(Ce),p(null)}catch(Ce){if(!Me)return;f(null),p((Ce==null?void 0:Ce.message)||"Failed to fetch MODEL publish status")}})(),()=>{Me=!1}},[e,P,u]);const[E,T]=x.useState(!1),[F,W]=x.useState(null),[z,se]=x.useState([]),[de,U]=x.useState(!1),[G,re]=x.useState(null),[X,C]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[K,V]=x.useState({}),[R,J]=x.useState({cia1:null,cia2:null,model:null}),[q,Y]=x.useState({lab1:null,lab2:null}),Q=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[ie,le]=x.useState(!1),[O,H]=x.useState(()=>({ssa1:im.ssa1,cia1:im.cia1,formative1:im.formative1})),[ae,I]=x.useState(IB),Z=!!(u&&d&&d.is_published);x.useEffect(()=>{v&&I(Z?30:IB)},[v,Z]);const[pe,Oe]=x.useState("default"),Ae=hn.useRef(null),ke=hn.useRef(null),[_e,De]=x.useState(null),[We,Ct]=x.useState(null),[_t,Xe]=x.useState(null),[nt,Ne]=x.useState(!1),[be,fe]=x.useState(!1),[ge,lt]=x.useState({});x.useEffect(()=>{try{const Me=localStorage.getItem("roles"),Ce=localStorage.getItem("permissions"),It=Me?JSON.parse(Me):[],ft=Ce?JSON.parse(Ce):[],Ot=Array.isArray(It)?It.map(ne=>String(ne||"").toUpperCase()):[],er=Array.isArray(ft)?ft.map(ne=>String(ne||"").toLowerCase()):[],hr=Ot.includes("IQAC"),Tr=er.includes("obe.master.manage");le(hr||Tr)}catch{le(!1)}},[]),x.useEffect(()=>{let Me=!0;const Ce=async It=>{Me&&De("Loading IQAC weights");try{const Ot=await _S();if(!Me)return;if(Ot&&typeof Ot=="object"){const er={...Ot};try{Object.defineProperty(er,"__source",{value:"server",enumerable:!1})}catch{}Ae.current=er,Xe(Object.keys(er||{}).length||0),Ct(null),De(`Server weights loaded (${Object.keys(er||{}).length} class-types)`);const hr=It??s;if(hr){const Tr=ti(hr),ne=er[Tr];if(ne&&typeof ne=="object"){const ce=bv(hr);H({ssa1:Number.isFinite(Number(ne.ssa1))?Number(ne.ssa1):ce.ssa1,cia1:Number.isFinite(Number(ne.cia1))?Number(ne.cia1):ce.cia1,formative1:Number.isFinite(Number(ne.formative1))?Number(ne.formative1):ce.formative1}),Oe("server"),De(`Applied server weights for ${Tr}`);return}else De(`Server weights loaded (${Object.keys(er||{}).length} keys) but no entry for ${Tr}`)}}}catch(Ot){const er=String((Ot==null?void 0:Ot.message)||Ot||"Unknown error");Ct(er),De(`Server fetch failed: ${er}`)}try{const Ot=Jn("iqac_class_type_weights");if(Ot&&typeof Ot=="object"){const er={...Ot};try{Object.defineProperty(er,"__source",{value:"local",enumerable:!1})}catch{}Ae.current=er,Xe(Object.keys(er||{}).length||0);const hr=It??s;if(hr){const Tr=ti(hr),ne=er[Tr];if(ne&&typeof ne=="object"){const ce=bv(hr);H({ssa1:Number.isFinite(Number(ne.ssa1))?Number(ne.ssa1):ce.ssa1,cia1:Number.isFinite(Number(ne.cia1))?Number(ne.cia1):ce.cia1,formative1:Number.isFinite(Number(ne.formative1))?Number(ne.formative1):ce.formative1}),Oe("local"),De(`Applied local weights for ${Tr}`);return}else De(`Local weights loaded (${Object.keys(er||{}).length} keys) but no entry for ${Tr}`)}}}catch(Ot){const er=String((Ot==null?void 0:Ot.message)||Ot||"Unknown error");Ct(er),De(`Local weights read failed: ${er}`)}const ft=It??s;if(ft){const Ot=bv(ft);H(Ot),Oe("default"),De(`Applied class-type defaults for ${ti(ft)}`)}else H(im),Oe("default"),De("Applied general defaults (no class type detected)")};return Ce(),ke.current=Ce,()=>{Me=!1}},[s]),x.useEffect(()=>{try{const Me=ke.current;typeof Me=="function"&&Me()}catch{}},[P]),x.useEffect(()=>{try{const Me=Ae.current;if(s&&Me&&typeof Me=="object"){const Ce=ti(s),It=Me[Ce];if(It&&typeof It=="object"){const ft=bv(s);H({ssa1:Number.isFinite(Number(It.ssa1))?Number(It.ssa1):ft.ssa1,cia1:Number.isFinite(Number(It.cia1))?Number(It.cia1):ft.cia1,formative1:Number.isFinite(Number(It.formative1))?Number(It.formative1):ft.formative1}),Oe(Me.__source==="server"?"server":"local"),De(`Applied cached mapping for ${Ce}`),Ct(null)}}}catch{}},[s]),x.useEffect(()=>{let Me=!0;return(async()=>{try{const Ce=await vu();if(!Me)return;i(Ce||null)}catch{}})(),()=>{Me=!1}},[e]),x.useEffect(()=>{let Me=!0;return(async()=>{var Ce;try{const It=await lc();if(!Me)return;let ft=(It||[]).filter(hr=>hr.subject_code===e);if(ft.length===0)try{const hr=await yr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(hr.ok){const Tr=await hr.json();ft=(Array.isArray(Tr.results)?Tr.results:Array.isArray(Tr)?Tr:Tr.items||[])||[]}}catch(hr){console.warn("Server TA list fetch failed:",hr)}j(ft),L(null);const Ot=Jn(`coAttainment_selectedTa_${e}`),er=typeof Ot=="number"&&ft.some(hr=>hr.id===Ot)&&Ot||(((Ce=ft[0])==null?void 0:Ce.id)??null);B(er)}catch(It){if(!Me)return;j([]),B(null),L((It==null?void 0:It.message)||"Failed to load teaching assignments")}})(),()=>{Me=!1}},[e]),x.useEffect(()=>{!e||P==null||Gn(`coAttainment_selectedTa_${e}`,P)},[e,P]),x.useEffect(()=>{if(r){o(r);return}let Me=!0;return(async()=>{try{const Ce=(k||[]).find(Tr=>Tr.id===P)||null,It=(Ce==null?void 0:Ce.class_type)??null;if(It){if(!Me)return;o(It);return}const ft=Ce==null?void 0:Ce.elective_subject_id;if(ft&&!(Ce!=null&&Ce.section_id)){console.log("[COAttainment] Detected elective TA, fetching elective subject details for:",ft);try{const Tr=await yr(`/api/curriculum/elective-subjects/${ft}/`);if(Tr.ok){const ne=await Tr.json(),ce=ne==null?void 0:ne.class_type;if(console.log("[COAttainment] Elective subject class_type:",ce),ce){if(!Me)return;o(ce);return}}else console.warn("[COAttainment] Elective subject API returned error:",Tr.status)}catch(Tr){console.warn("[COAttainment] Failed to fetch elective subject:",Tr)}}const Ot=Ce==null?void 0:Ce.curriculum_row_id;if(!Ot)try{const Tr=String(e).trim().toUpperCase(),ne=await bl();if(!Me)return;const ce=(ne||[]).find(je=>String(je.course_code||"").trim().toUpperCase()===Tr),te=(ce==null?void 0:ce.class_type)??null;if(te){o(te);return}const ue=await Kd();if(!Me)return;const Ee=(ue||[]).find(je=>String(je.course_code||"").trim().toUpperCase()===Tr);o((Ee==null?void 0:Ee.class_type)??null);return}catch{Me&&o(null);return}const er=await A3(Number(Ot));if(!Me)return;const hr=(er==null?void 0:er.class_type)??null;if(hr){o(hr);return}try{const Tr=String(e).trim().toUpperCase(),ne=await Kd();if(!Me)return;const ce=(ne||[]).find(te=>String(te.course_code||"").trim().toUpperCase()===Tr);o((ce==null?void 0:ce.class_type)??null)}catch{o(null)}}catch{Me&&o(null)}})(),()=>{Me=!1}},[k,P,r]),x.useEffect(()=>{Gn(Q,{weights:O})},[Q,O]),x.useEffect(()=>{let Me=!0;return(async()=>{if(P){T(!0),W(null);try{const It=(k||[]).find(Ot=>Ot.id===P)||null,ft=[];if(It&&It.elective_subject_id&&!It.section_id){const Ot=It.elective_subject_id,er=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Ot))}`);if(!er.ok)throw new Error(`Elective-choices fetch failed: ${er.status}`);const hr=await er.json();if(!Me)return;const ne=((Array.isArray(hr.results)?hr.results:Array.isArray(hr)?hr:hr.items||[])||[]).map(ce=>({id:Number(ce.student_id??ce.id),reg_no:String(ce.reg_no??ce.registration_no??ce.regno??""),name:String(ce.name??ce.full_name??ce.username??ce.student_name??""),section:ce.section_name??ce.section??null,section_id:ce.section_id??null}));if(!Me)return;se(ne.filter(ce=>Number.isFinite(ce.id)).sort(WB))}else{const Ot=await qc(P);if(!Me)return;const er=(Ot.students||[]).map(hr=>({id:Number(hr.id),reg_no:String(hr.reg_no??""),name:String(hr.name??""),section:hr.section??null})).filter(hr=>Number.isFinite(hr.id)).sort(WB);se(er)}}catch(It){if(!Me)return;se([]),W((It==null?void 0:It.message)||"Failed to load roster")}finally{Me&&T(!1)}}})(),()=>{Me=!1}},[P,k]);const He=x.useMemo(()=>{var Ce,It;const Me=(It=(Ce=n==null?void 0:n.assessments)==null?void 0:Ce.cia1)==null?void 0:It.questions;return Array.isArray(Me)&&Me.length?Me.map(ft=>({key:String((ft==null?void 0:ft.key)||""),label:String((ft==null?void 0:ft.label)||(ft==null?void 0:ft.key)||""),max:Number((ft==null?void 0:ft.max)||0),co:DB(ft==null?void 0:ft.co),btl:Math.min(6,Math.max(1,Number((ft==null?void 0:ft.btl)||1)))})).filter(ft=>ft.key):XPe},[n]),mt=x.useMemo(()=>{var Ce,It;const Me=(It=(Ce=n==null?void 0:n.assessments)==null?void 0:Ce.cia2)==null?void 0:It.questions;return Array.isArray(Me)&&Me.length?Me.map(ft=>({key:String((ft==null?void 0:ft.key)||""),label:String((ft==null?void 0:ft.label)||(ft==null?void 0:ft.key)||""),max:Number((ft==null?void 0:ft.max)||0),co:$B(ft==null?void 0:ft.co),btl:Math.min(6,Math.max(1,Number((ft==null?void 0:ft.btl)||1)))})).filter(ft=>ft.key):QPe},[n]),wt=x.useMemo(()=>{let Me=0,Ce=0;const It=He||[];return It.forEach((ft,Ot)=>{const er=UB(It,Ot);Me+=(Number(ft.max)||0)*er.co1,Ce+=(Number(ft.max)||0)*er.co2}),{co1:Me,co2:Ce}},[He]),Pt=x.useMemo(()=>{let Me=0,Ce=0;const It=mt||[];return It.forEach((ft,Ot)=>{const er=zB(It,Ot);Me+=(Number(ft.max)||0)*er.co3,Ce+=(Number(ft.max)||0)*er.co4}),{co3:Me,co4:Ce}},[mt]),bt=x.useMemo(()=>{var Fe,$e,st,Wt,qt,ht,Ut,Gt,cr,ir,Fr,dn,vr,Lt,Gr,bn,or,kr;const Me=((Fe=n==null?void 0:n.assessments)==null?void 0:Fe.ssa1)||{},Ce=(($e=n==null?void 0:n.assessments)==null?void 0:$e.ssa2)||{},It=((st=n==null?void 0:n.assessments)==null?void 0:st.formative1)||{},ft=((Wt=n==null?void 0:n.assessments)==null?void 0:Wt.formative2)||{},Ot=((qt=n==null?void 0:n.assessments)==null?void 0:qt.cia1)||{},er=((ht=n==null?void 0:n.assessments)==null?void 0:ht.cia2)||{},hr=Number((Ut=Me==null?void 0:Me.coMax)==null?void 0:Ut.co1),Tr=Number((Gt=Me==null?void 0:Me.coMax)==null?void 0:Gt.co2),ne=Number(((cr=Ce==null?void 0:Ce.coMax)==null?void 0:cr.co3)??((ir=Ce==null?void 0:Ce.coMax)==null?void 0:ir.co1)),ce=Number(((Fr=Ce==null?void 0:Ce.coMax)==null?void 0:Fr.co4)??((dn=Ce==null?void 0:Ce.coMax)==null?void 0:dn.co2)),te=Number((vr=Ot==null?void 0:Ot.coMax)==null?void 0:vr.co1),ue=Number((Lt=Ot==null?void 0:Ot.coMax)==null?void 0:Lt.co2),Ee=Number(((Gr=er==null?void 0:er.coMax)==null?void 0:Gr.co3)??((bn=er==null?void 0:er.coMax)==null?void 0:bn.co1)),je=Number(((or=er==null?void 0:er.coMax)==null?void 0:or.co4)??((kr=er==null?void 0:er.coMax)==null?void 0:kr.co2)),gt=Number(It==null?void 0:It.maxCo),Qe=Number(ft==null?void 0:ft.maxCo);return{ssa1:{co1:Number.isFinite(hr)?Math.max(0,hr):10,co2:Number.isFinite(Tr)?Math.max(0,Tr):10},ssa2:{co3:Number.isFinite(ne)?Math.max(0,ne):10,co4:Number.isFinite(ce)?Math.max(0,ce):10},cia1:{co1:Number.isFinite(te)?Math.max(0,te):wt.co1,co2:Number.isFinite(ue)?Math.max(0,ue):wt.co2},cia2:{co3:Number.isFinite(Ee)?Math.max(0,Ee):Pt.co3,co4:Number.isFinite(je)?Math.max(0,je):Pt.co4},f1:{co1:Number.isFinite(gt)?Math.max(0,gt):10,co2:Number.isFinite(gt)?Math.max(0,gt):10},f2:{co3:Number.isFinite(Qe)?Math.max(0,Qe):10,co4:Number.isFinite(Qe)?Math.max(0,Qe):10}}},[n,wt,Pt]),qr=x.useMemo(()=>{if(!y)return null;const Me=ix.co1,Ce=ix.co2,It=ix.co3,ft=ix.co4,Ot=ix.co5;return{co1:Me,co2:Ce,co3:It,co4:ft,co5:Ot,total:ds(Me+Ce+It+ft+Ot)}},[y]),Tt=async()=>{U(!0),re(null);const Me=typeof P=="number"?P:void 0;try{if(V({}),Y({lab1:null,lab2:null}),y){let Ce=null,It=null,ft=null;try{Ce=await ho("cia1",e,Me)}catch(Ot){V(er=>({...er,lab_cia1:String((Ot==null?void 0:Ot.message)||Ot)}))}try{It=await ho("cia2",e,Me)}catch(Ot){V(er=>({...er,lab_cia2:String((Ot==null?void 0:Ot.message)||Ot)}))}try{ft=await Rm(e,Me)}catch(Ot){V(er=>({...er,lab_model:String((Ot==null?void 0:Ot.message)||Ot)}))}J({cia1:(Ce==null?void 0:Ce.data)??null,cia2:(It==null?void 0:It.data)??null,model:(ft==null?void 0:ft.data)??null});try{if(!(Ce!=null&&Ce.data))try{const Ot=await ei("cia1",e,Me);Ot&&Ot.draft&&J(er=>({...er,cia1:Ot.draft.data??Ot.draft}))}catch(Ot){V(er=>({...er,lab_cia1_draft:String((Ot==null?void 0:Ot.message)||Ot)}))}if(!(It!=null&&It.data))try{const Ot=await ei("cia2",e,Me);Ot&&Ot.draft&&J(er=>({...er,cia2:Ot.draft.data??Ot.draft}))}catch(Ot){V(er=>({...er,lab_cia2_draft:String((Ot==null?void 0:Ot.message)||Ot)}))}if(!(ft!=null&&ft.data))try{const Ot=await ei("model",e,Me);Ot&&Ot.draft&&J(er=>({...er,model:Ot.draft.data??Ot.draft}))}catch(Ot){V(er=>({...er,lab_model_draft:String((Ot==null?void 0:Ot.message)||Ot)}))}}catch{}}if(y)C({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});else{const Ce=ti(s)==="TCPL";let It=null,ft=null,Ot=null,er=null,hr=null,Tr=null,ne=null,ce=null;if(g.ssa1)try{It=await rg(e,Me)}catch(te){V(ue=>({...ue,ssa1:String((te==null?void 0:te.message)||te)}))}if(g.ssa2)try{ft=await ty(e,Me)}catch(te){V(ue=>({...ue,ssa2:String((te==null?void 0:te.message)||te)}))}if(g.formative1)if(Ce)try{hr=await ho("formative1",e,Me)}catch(te){V(ue=>({...ue,tcpl_lab1:String((te==null?void 0:te.message)||te)}))}else try{Ot=await AS(e,Me)}catch(te){V(ue=>({...ue,formative1:String((te==null?void 0:te.message)||te)}))}if(g.formative2)if(Ce)try{Tr=await ho("formative2",e,Me)}catch(te){V(ue=>({...ue,tcpl_lab2:String((te==null?void 0:te.message)||te)}))}else try{er=await b0("formative2",e,Me)}catch(te){V(ue=>({...ue,formative2:String((te==null?void 0:te.message)||te)}))}if(g.cia1)try{ne=await ry(e,Me)}catch(te){V(ue=>({...ue,cia1:String((te==null?void 0:te.message)||te)}))}if(g.cia2)try{ce=await v0("cia2",e,Me)}catch(te){V(ue=>({...ue,cia2:String((te==null?void 0:te.message)||te)}))}try{if(g.ssa1&&(!It||!(It.marks&&Object.keys(It.marks||{}).length)))try{const te=await ei("ssa1",e,Me);te&&te.draft&&te.draft.marks&&(It={marks:te.draft.marks})}catch(te){V(ue=>({...ue,ssa1_draft:String((te==null?void 0:te.message)||te)}))}if(g.ssa2&&(!ft||!(ft.marks&&Object.keys(ft.marks||{}).length)))try{const te=await ei("ssa2",e,Me);te&&te.draft&&te.draft.marks&&(ft={marks:te.draft.marks})}catch(te){V(ue=>({...ue,ssa2_draft:String((te==null?void 0:te.message)||te)}))}if(g.formative1){if(Ce){if(!(hr!=null&&hr.data))try{const te=await ei("formative1",e,Me);te&&te.draft&&(hr={data:te.draft.data??te.draft})}catch(te){V(ue=>({...ue,tcpl_lab1_draft:String((te==null?void 0:te.message)||te)}))}}else if(!Ot||!(Ot.marks&&Object.keys(Ot.marks||{}).length))try{const te=await ei("formative1",e,Me);te&&te.draft&&te.draft.marks&&(Ot={marks:te.draft.marks})}catch(te){V(ue=>({...ue,formative1_draft:String((te==null?void 0:te.message)||te)}))}}if(g.formative2){if(Ce){if(!(Tr!=null&&Tr.data))try{const te=await ei("formative2",e,Me);te&&te.draft&&(Tr={data:te.draft.data??te.draft})}catch(te){V(ue=>({...ue,tcpl_lab2_draft:String((te==null?void 0:te.message)||te)}))}}else if(!er||!(er.marks&&Object.keys(er.marks||{}).length))try{const te=await ei("formative2",e,Me);te&&te.draft&&te.draft.marks&&(er={marks:te.draft.marks})}catch(te){V(ue=>({...ue,formative2_draft:String((te==null?void 0:te.message)||te)}))}}if(g.cia1&&(!ne||!ne.data))try{const te=await ei("cia1",e,Me);te&&te.draft&&(ne={data:te.draft.data??te.draft})}catch(te){V(ue=>({...ue,cia1_draft:String((te==null?void 0:te.message)||te)}))}if(g.cia2&&(!ce||!ce.data))try{const te=await ei("cia2",e,Me);te&&te.draft&&(ce={data:te.draft.data??te.draft})}catch(te){V(ue=>({...ue,cia2_draft:String((te==null?void 0:te.message)||te)}))}}catch{}Ce&&Y({lab1:(hr==null?void 0:hr.data)??null,lab2:(Tr==null?void 0:Tr.data)??null}),C({ssa1:It!=null&&It.marks&&typeof It.marks=="object"?It.marks:{},ssa2:ft!=null&&ft.marks&&typeof ft.marks=="object"?ft.marks:{},f1:!Ce&&(Ot!=null&&Ot.marks)&&typeof Ot.marks=="object"?Ot.marks:{},f2:!Ce&&(er!=null&&er.marks)&&typeof er.marks=="object"?er.marks:{},cia1:(ne==null?void 0:ne.data)??null,cia2:(ce==null?void 0:ce.data)??null})}}catch(Ce){C({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),J({cia1:null,cia2:null,model:null}),Y({lab1:null,lab2:null}),re((Ce==null?void 0:Ce.message)||"Failed to load published marks")}finally{U(!1)}};x.useEffect(()=>{e&&Tt()},[e,P,y,g,s]),x.useEffect(()=>{const Me=Ce=>{try{const It=(Ce==null?void 0:Ce.detail)||{},ft=It.subjectId,Ot=It.assessment;if(!ft||String(ft)!==String(e)||Ot&&!["ssa1","formative1","cia1"].includes(String(Ot)))return;Tt()}catch{}};return window.addEventListener("obe:published",Me),()=>window.removeEventListener("obe:published",Me)},[e]);const xr=x.useMemo(()=>{const Me=new Map;if(y){const Qe=gj/2,Fe=(qt,ht,Ut)=>{const Gt=qt!=null&&qt.sheet&&typeof qt.sheet=="object"?qt.sheet:{},cr=Gt!=null&&Gt.rowsByStudentId&&typeof Gt.rowsByStudentId=="object"?Gt.rowsByStudentId:{},ir=mi(Number((Gt==null?void 0:Gt.expCountA)??0),0,12),Fr=mi(Number((Gt==null?void 0:Gt.expCountB)??0),0,12),dn=!!(Gt!=null&&Gt.coAEnabled),vr=!!(Gt!=null&&Gt.coBEnabled),Lt=!!(Gt!=null&&Gt.ciaExamEnabled),Gr=Gt!=null&&Gt.coConfigs&&typeof Gt.coConfigs=="object"?Gt.coConfigs:null,bn=Gr?Gr[String(ht)]:null,or=Ut!=null&&Gr?Gr[String(Ut)]:null,kr=bn?!!bn.enabled:dn,Mr=Ut!=null?or?!!or.enabled:vr:!1,Ar=bn?mi(Number(bn.expCount??0),0,12):ir,Zt=Ut!=null?or?mi(Number(or.expCount??0),0,12):Fr:0,Kt=bn&&Number.isFinite(Number(bn.expMax))?Number(bn.expMax):Number.isFinite(Number(Gt==null?void 0:Gt.expMaxA))?Number(Gt.expMaxA):25,it=Ut!=null?or&&Number.isFinite(Number(or.expMax))?Number(or.expMax):Number.isFinite(Number(Gt==null?void 0:Gt.expMaxB))?Number(Gt.expMaxB):25:0,At=Kt+(Lt?Qe:0),Mt=Ut!=null?it+(Lt?Qe:0):0;return{get:Ge=>{const Rt=cr[String(Ge)]||{},Ze=Rt!=null&&Rt.marksByCo&&typeof Rt.marksByCo=="object"?Rt.marksByCo:{},ot=(Ze==null?void 0:Ze[String(ht)])??Rt.marksA,Bt=Ut!=null?(Ze==null?void 0:Ze[String(Ut)])??Rt.marksB:[],Qt=ax(ot,Ar).slice(0,kr?Ar:0),Yt=ax(Bt,Zt).slice(0,Mr?Zt:0),fr=vv(Qt),Dt=vv(Yt),ur=Rt==null?void 0:Rt.ciaExam,Ve=typeof ur=="number"&&Number.isFinite(ur)?ur:null,zt=fr!=null||Dt!=null||Ve!=null,yt=zt?(fr??0)+(Lt?(Ve??0)/2:0):null,St=zt?(Dt??0)+(Lt?(Ve??0)/2:0):null;return{a:yt==null?null:mi(yt,0,At),b:St==null?null:mi(St,0,Mt)}},coA:ht,coB:Ut,CO_MAX_A:At,CO_MAX_B:Mt,expMaxA:Kt,expMaxB:it,expCountA:Ar,expCountB:Zt}},$e=Fe(R.cia1,1,2),st=Fe(R.cia2,3,4),Wt=Fe(R.model,5,null);for(const qt of z){const ht=$e.get(qt.id),Ut=st.get(qt.id),Gt=Wt.get(qt.id);Me.set(qt.id,{co1:ht.a,co2:ht.b,co3:Ut.a,co4:Ut.b,co5:Gt.a,coMax1:$e.CO_MAX_A,coMax2:$e.CO_MAX_B,coMax3:st.CO_MAX_A,coMax4:st.CO_MAX_B,coMax5:Wt.CO_MAX_A})}return Me}const Ce=ti(s)==="TCPL",It=Qe=>{const Fe=Qe!=null&&Qe.sheet&&typeof Qe.sheet=="object"?Qe.sheet:{},$e=Fe!=null&&Fe.rowsByStudentId&&typeof Fe.rowsByStudentId=="object"?Fe.rowsByStudentId:{},st=mi(Number((Fe==null?void 0:Fe.expCountA)??0),0,12),Wt=mi(Number((Fe==null?void 0:Fe.expCountB)??0),0,12),qt=Number.isFinite(Number(Fe==null?void 0:Fe.expMaxA))?Number(Fe.expMaxA):25,ht=Number.isFinite(Number(Fe==null?void 0:Fe.expMaxB))?Number(Fe.expMaxB):25,Ut=(Fe==null?void 0:Fe.ciaExamEnabled)!==!1,Gt=gj/2,cr=qt+(Ut?Gt:0),ir=ht+(Ut?Gt:0);return{get:dn=>{const vr=$e[String(dn)]||{},Lt=ax(vr==null?void 0:vr.marksA,st),Gr=ax(vr==null?void 0:vr.marksB,Wt),bn=vv(Lt),or=vv(Gr),kr=vr==null?void 0:vr.ciaExam,Mr=typeof kr=="number"&&Number.isFinite(kr)?kr:null,Ar=bn!=null||or!=null||Mr!=null,Zt=Ar?(bn??0)+(Ut?(Mr??0)/2:0):null,Kt=Ar?(or??0)+(Ut?(Mr??0)/2:0):null;return{a:Zt==null?null:mi(Zt,0,cr),b:Kt==null?null:mi(Kt,0,ir)}},CO_MAX_A:cr,CO_MAX_B:ir}},ft=Ce?It(q.lab1):null,Ot=Ce?It(q.lab2):null,er=(()=>{if(!v)return null;const Qe=String(P??"none"),Fe=ti(s),$e=[];Fe==="THEORY"?($e.push(`model_theory_sheet_${e}_${Qe}`),$e.push(`model_theory_sheet_${e}_none`)):Fe==="TCPL"?($e.push(`model_tcpl_sheet_${e}_${Qe}`),$e.push(`model_tcpl_sheet_${e}_none`)):Fe==="TCPR"&&($e.push(`model_tcpr_sheet_${e}_${Qe}`),$e.push(`model_tcpr_sheet_${e}_none`)),$e.push(`model_sheet_${e}`);for(const st of $e){const Wt=Jn(st);if(Wt&&typeof Wt=="object")return Wt}return null})(),hr=Qe=>{const Fe=ti(s),$e=er&&typeof er=="object"?er:null,qt=Fe==="THEORY"?xj:0;if(!v)return{mark:null,max:qt};if(!$e)return{mark:null,max:qt};let ht=qt;const Ut=`id:${String(Qe.id)}`,Gt=Qe.reg_no?`reg:${String(Qe.reg_no).trim()}`:"",cr=$e[Ut]||(Gt?$e[Gt]:null)||null;if(!cr||typeof cr!="object")return{mark:null,max:ht};const ir=!!cr.absent,Fr=String(cr.absentKind||"AL").toUpperCase(),dn=cr.q&&typeof cr.q=="object"?cr.q:{};let vr=!1,Lt=0;if(ht=0,Fe==="THEORY"){ht=xj;for(let Gr=0;Gr<hN.length;Gr++){const bn=hN[Gr],or=dn[bn.key],kr=Wl(or);if(kr==null)continue;vr=!0;const Mr=mi(kr,0,bn.max);CK[Gr]===5&&(Lt+=Mr)}}else if(Fe==="TCPL"||Fe==="TCPR"){const Gr=Fe==="TCPR",bn=Gr?12:15,or=Gr?8:10,kr=Gr?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];for(let Zt=0;Zt<bn;Zt++){const Kt=Zt+1,it=`q${Kt}`,At=Kt<=or?2:16,Mt=kr[Zt]??1;Mt===5&&(ht+=At);const ar=dn[it],Ge=Wl(ar);if(Ge==null)continue;vr=!0;const Rt=mi(Ge,0,At);Mt===5&&(Lt+=Rt)}const Mr=Wl(cr.lab);Mr!=null&&(vr=!0);const Ar=Mr==null?null:mi(Mr,0,30);Gr?(ht+=30,Ar!=null&&(Lt+=Ar)):(ht+=30/5,Ar!=null&&(Lt+=Ar/5))}return vr?ir&&Fr==="AL"?{mark:0,max:ht}:{mark:mi(Lt,0,ht),max:ht}:ir&&Fr==="AL"?{mark:0,max:ht}:{mark:null,max:ht}},Tr=X.f1&&typeof X.f1=="object"?X.f1:{},ne=X.f2&&typeof X.f2=="object"?X.f2:{},ce=X.cia1&&typeof X.cia1=="object"?X.cia1:null,te=Array.isArray(ce==null?void 0:ce.questions)?ce.questions.map(Qe=>({key:String((Qe==null?void 0:Qe.key)||""),label:String((Qe==null?void 0:Qe.label)||(Qe==null?void 0:Qe.key)||""),max:Number((Qe==null?void 0:Qe.max)||0),co:DB(Qe==null?void 0:Qe.co),btl:Math.min(6,Math.max(1,Number((Qe==null?void 0:Qe.btl)||1)))})).filter(Qe=>Qe.key):He,ue=ce!=null&&ce.rowsByStudentId&&typeof ce.rowsByStudentId=="object"?ce.rowsByStudentId:{},Ee=X.cia2&&typeof X.cia2=="object"?X.cia2:null,je=Array.isArray(Ee==null?void 0:Ee.questions)?Ee.questions.map(Qe=>({key:String((Qe==null?void 0:Qe.key)||""),label:String((Qe==null?void 0:Qe.label)||(Qe==null?void 0:Qe.key)||""),max:Number((Qe==null?void 0:Qe.max)||0),co:$B(Qe==null?void 0:Qe.co),btl:Math.min(6,Math.max(1,Number((Qe==null?void 0:Qe.btl)||1)))})).filter(Qe=>Qe.key):mt,gt=Ee!=null&&Ee.rowsByStudentId&&typeof Ee.rowsByStudentId=="object"?Ee.rowsByStudentId:{};for(const Qe of z){const Fe=(X.ssa1&&typeof X.ssa1=="object"?X.ssa1[String(Qe.id)]:null)??null,$e=Fe==null?null:Number(Fe)/2,st=$e==null?null:mi($e,0,bt.ssa1.co1),Wt=$e==null?null:mi($e,0,bt.ssa1.co2),qt=(X.ssa2&&typeof X.ssa2=="object"?X.ssa2[String(Qe.id)]:null)??null,ht=qt==null?null:Number(qt)/2,Ut=ht==null?null:mi(ht,0,bt.ssa2.co3),Gt=ht==null?null:mi(ht,0,bt.ssa2.co4),cr=Ce&&ft?ft.get(Qe.id):null,ir=Ce&&Ot?Ot.get(Qe.id):null,Fr=Tr[String(Qe.id)]||{},dn=Wl(Fr==null?void 0:Fr.skill1),vr=Wl(Fr==null?void 0:Fr.skill2),Lt=Wl(Fr==null?void 0:Fr.att1),Gr=Wl(Fr==null?void 0:Fr.att2),bn=Ce?(cr==null?void 0:cr.a)??null:dn!=null&&Lt!=null?mi(dn+Lt,0,bt.f1.co1):null,or=Ce?(cr==null?void 0:cr.b)??null:vr!=null&&Gr!=null?mi(vr+Gr,0,bt.f1.co2):null,kr=ne[String(Qe.id)]||{},Mr=Wl(kr==null?void 0:kr.skill1),Ar=Wl(kr==null?void 0:kr.skill2),Zt=Wl(kr==null?void 0:kr.att1),Kt=Wl(kr==null?void 0:kr.att2),it=Ce?(ir==null?void 0:ir.a)??null:Mr!=null&&Zt!=null?mi(Mr+Zt,0,bt.f2.co3):null,At=Ce?(ir==null?void 0:ir.b)??null:Ar!=null&&Kt!=null?mi(Ar+Kt,0,bt.f2.co4):null,Mt=ue[String(Qe.id)]||{},ar=!!(Mt!=null&&Mt.absent),Ge=Mt!=null&&Mt.q&&typeof Mt.q=="object"?Mt.q:{};let Rt=null,Ze=null;if(!ar){let ur=0,Ve=0,zt=!1;te.forEach((yt,St)=>{const sr=Ge==null?void 0:Ge[yt.key],pr=Wl(sr);if(pr==null)return;zt=!0;const we=mi(pr,0,Number(yt.max)||pr),Ie=UB(te,St);ur+=we*Ie.co1,Ve+=we*Ie.co2}),zt&&(Rt=mi(ur,0,bt.cia1.co1),Ze=mi(Ve,0,bt.cia1.co2))}const ot=gt[String(Qe.id)]||{},Bt=!!(ot!=null&&ot.absent),Qt=ot!=null&&ot.q&&typeof ot.q=="object"?ot.q:{};let Yt=null,fr=null;if(!Bt){let ur=0,Ve=0,zt=!1;je.forEach((yt,St)=>{const sr=Qt==null?void 0:Qt[yt.key],pr=Wl(sr);if(pr==null)return;zt=!0;const we=mi(pr,0,Number(yt.max)||pr),Ie=zB(je,St);ur+=we*Ie.co3,Ve+=we*Ie.co4}),zt&&(Yt=mi(ur,0,bt.cia2.co3),fr=mi(Ve,0,bt.cia2.co4))}const Dt=v?hr(Qe):{mark:null,max:0};Me.set(Qe.id,{ssaCo1:st,ssaCo2:Wt,ssaCo3:Ut,ssaCo4:Gt,ciaCo1:Rt,ciaCo2:Ze,ciaCo3:Yt,ciaCo4:fr,f1Co1:bn,f1Co2:or,f2Co3:it,f2Co4:At,modelCo5:Dt.mark,modelCo5Max:Dt.max})}return Me},[X,R,q,z,bt,He,y,s,e,P,v]),Zr=x.useMemo(()=>{if(!b)return null;const Me=Ce=>{const It=Ce!=null&&Ce.sheet&&typeof Ce.sheet=="object"?Ce.sheet:{},ft=Number.isFinite(Number(It==null?void 0:It.expMaxA))?Number(It.expMaxA):25,Ot=Number.isFinite(Number(It==null?void 0:It.expMaxB))?Number(It.expMaxB):25,er=(It==null?void 0:It.ciaExamEnabled)!==!1,hr=gj/2;return{a:ft+(er?hr:0),b:Ot+(er?hr:0)}};return{lab1:Me(q.lab1),lab2:Me(q.lab2)}},[b,q]),Xr=x.useMemo(()=>{var te,ue,Ee,je;const Me=b?((te=Zr==null?void 0:Zr.lab1)==null?void 0:te.a)??bt.f1.co1:bt.f1.co1,Ce=b?((ue=Zr==null?void 0:Zr.lab1)==null?void 0:ue.b)??bt.f1.co2:bt.f1.co2,It=b?((Ee=Zr==null?void 0:Zr.lab2)==null?void 0:Ee.a)??bt.f2.co3:bt.f2.co3,ft=b?((je=Zr==null?void 0:Zr.lab2)==null?void 0:je.b)??bt.f2.co4:bt.f2.co4,Ot=(g.ssa1?bt.ssa1.co1:0)+(g.cia1?bt.cia1.co1:0)+(g.formative1?Me:0),er=(g.ssa1?bt.ssa1.co2:0)+(g.cia1?bt.cia1.co2:0)+(g.formative1?Ce:0),hr=(g.ssa2?bt.ssa2.co3:0)+(g.cia2?bt.cia2.co3:0)+(g.formative2?It:0),Tr=(g.ssa2?bt.ssa2.co4:0)+(g.cia2?bt.cia2.co4:0)+(g.formative2?ft:0),ne=v?ae:0,ce=Ot+er+hr+Tr+ne;return{f1MaxCo1:Me,f1MaxCo2:Ce,f2MaxCo3:It,f2MaxCo4:ft,co1:Ot,co2:er,co3:hr,co4:Tr,co5:ne,total:ce}},[b,Zr,bt,g,v,ae]),Br=x.useMemo(()=>{if(y){const Qe=qr||{co1:55,co2:55,co3:55,co4:55,co5:55},Fe=(qt,ht)=>qt==null||!ht?null:ds(qt/ht*100),$e=(qt,ht)=>qt==null||!ht?null:Pf(qt/ht*3),st=[R.cia1,R.cia2,R.model].filter(Boolean),Wt=qt=>{const ht=[0,0,0,0,0,0,0],Ut=[0,0,0,0,0,0,0];for(const cr of st){const ir=cr!=null&&cr.sheet&&typeof cr.sheet=="object"?cr.sheet:{},dn=(ir!=null&&ir.rowsByStudentId&&typeof ir.rowsByStudentId=="object"?ir.rowsByStudentId:{})[String(qt)]||{},vr=ir!=null&&ir.coConfigs&&typeof ir.coConfigs=="object"?ir.coConfigs:null,Lt=dn!=null&&dn.marksByCo&&typeof dn.marksByCo=="object"?dn.marksByCo:{},Gr=!!(ir!=null&&ir.coAEnabled),bn=!!(ir!=null&&ir.coBEnabled),or=mi(Number((ir==null?void 0:ir.expCountA)??0),0,12),kr=mi(Number((ir==null?void 0:ir.expCountB)??0),0,12),Mr=Number.isFinite(Number(ir==null?void 0:ir.expMaxA))?Number(ir.expMaxA):25,Ar=Number.isFinite(Number(ir==null?void 0:ir.expMaxB))?Number(ir.expMaxB):25,Zt=Array.isArray(ir==null?void 0:ir.btlA)?ir.btlA:[],Kt=Array.isArray(ir==null?void 0:ir.btlB)?ir.btlB:[],it=(At,Mt,ar,Ge,Rt,Ze)=>{if(!Mt||ar<=0||!Ge)return;const ot=ax(Ze,ar);for(let Bt=0;Bt<ar;Bt++){const Qt=yj(Rt[Bt]),Yt=typeof ot[Bt]=="number"&&Number.isFinite(ot[Bt])?ot[Bt]:null;if(!Qt||Yt==null)continue;const fr=mi(Yt,0,Ge)*(10/Ge);ht[Qt]+=fr,Ut[Qt]+=1}};if(vr)for(const[At,Mt]of Object.entries(vr)){const ar=Number(At);if(!Number.isFinite(ar)||!Mt||typeof Mt!="object")continue;const Ge=!!Mt.enabled,Rt=mi(Number(Mt.expCount??0),0,12),Ze=Number.isFinite(Number(Mt.expMax))?Number(Mt.expMax):25,ot=Array.isArray(Mt.btl)?Mt.btl:[],Bt=(Lt==null?void 0:Lt[String(ar)])??[];it(ar,Ge,Rt,Ze,ot,Bt)}else it(0,Gr,or,Mr,Zt,dn.marksA),it(0,bn,kr,Ar,Kt,dn.marksB)}const Gt={};for(let cr=1;cr<=6;cr++)Gt[`btl${cr}`]=Ut[cr]?ds(ht[cr]/Ut[cr]):null,Gt[`btl${cr}Pct`]=Ut[cr]?ds(ht[cr]/Ut[cr]/10*100):null;return Gt};return z.map((qt,ht)=>{const Ut=xr.get(qt.id)||{},Gt=typeof Ut.co1=="number"?Ut.co1:null,cr=typeof Ut.co2=="number"?Ut.co2:null,ir=typeof Ut.co3=="number"?Ut.co3:null,Fr=typeof Ut.co4=="number"?Ut.co4:null,dn=typeof Ut.co5=="number"?Ut.co5:null,vr=Wt(qt.id),Lt=[Gt,cr,ir,Fr,dn].every(Gr=>typeof Gr=="number")?ds(Gt+cr+ir+Fr+dn):null;return{sno:ht+1,...qt,co1:Gt,co1Pct:Fe(Gt,Qe.co1),co1_3pt:$e(Gt,Qe.co1),co2:cr,co2Pct:Fe(cr,Qe.co2),co2_3pt:$e(cr,Qe.co2),co3:ir,co3Pct:Fe(ir,Qe.co3),co3_3pt:$e(ir,Qe.co3),co4:Fr,co4Pct:Fe(Fr,Qe.co4),co4_3pt:$e(Fr,Qe.co4),co5:dn,co5Pct:Fe(dn,Qe.co5),co5_3pt:$e(dn,Qe.co5),...vr,total:Lt}})}const Me=g.ssa1?O.ssa1:0,Ce=g.cia1?O.cia1:0,It=g.formative1?O.formative1:0,ft=g.ssa2?O.ssa1:0,Ot=g.cia2?O.cia1:0,er=g.formative2?O.formative1:0,{f1MaxCo1:hr,f1MaxCo2:Tr,f2MaxCo3:ne,f2MaxCo4:ce}=Xr,te=Xr.co1,ue=Xr.co2,Ee=Xr.co3,je=Xr.co4,gt=Xr.co5;return z.map((Qe,Fe)=>{const $e=xr.get(Qe.id),st=wv({ssaMark:($e==null?void 0:$e.ssaCo1)??null,ciaMark:($e==null?void 0:$e.ciaCo1)??null,f1Mark:($e==null?void 0:$e.f1Co1)??null,ssaMax:bt.ssa1.co1,ciaMax:bt.cia1.co1,f1Max:hr,ssaW:Me,ciaW:Ce,f1W:It,outOf:te}),Wt=wv({ssaMark:($e==null?void 0:$e.ssaCo2)??null,ciaMark:($e==null?void 0:$e.ciaCo2)??null,f1Mark:($e==null?void 0:$e.f1Co2)??null,ssaMax:bt.ssa1.co2,ciaMax:bt.cia1.co2,f1Max:Tr,ssaW:Me,ciaW:Ce,f1W:It,outOf:ue}),qt=wv({ssaMark:($e==null?void 0:$e.ssaCo3)??null,ciaMark:($e==null?void 0:$e.ciaCo3)??null,f1Mark:($e==null?void 0:$e.f2Co3)??null,ssaMax:bt.ssa2.co3,ciaMax:bt.cia2.co3,f1Max:ne,ssaW:ft,ciaW:Ot,f1W:er,outOf:Ee}),ht=wv({ssaMark:($e==null?void 0:$e.ssaCo4)??null,ciaMark:($e==null?void 0:$e.ciaCo4)??null,f1Mark:($e==null?void 0:$e.f2Co4)??null,ssaMax:bt.ssa2.co4,ciaMax:bt.cia2.co4,f1Max:ce,ssaW:ft,ciaW:Ot,f1W:er,outOf:je}),Ut=st==null||!te?null:ds(st/te*100),Gt=Wt==null||!ue?null:ds(Wt/ue*100),cr=qt==null||!Ee?null:ds(qt/Ee*100),ir=ht==null||!je?null:ds(ht/je*100),Fr=typeof($e==null?void 0:$e.modelCo5)=="number"&&Number.isFinite($e.modelCo5)?$e.modelCo5:null,dn=typeof($e==null?void 0:$e.modelCo5Max)=="number"&&Number.isFinite($e.modelCo5Max)?Math.max(0,$e.modelCo5Max):xj,vr=!v||Fr==null||!dn||!gt?null:mi(Fr/dn*gt,0,gt),Lt=vr==null||!gt?null:ds(vr/gt*100),Gr=st==null||!te?null:Pf(st/te*3),bn=Wt==null||!ue?null:Pf(Wt/ue*3),or=qt==null||!Ee?null:Pf(qt/Ee*3),kr=ht==null||!je?null:Pf(ht/je*3),Mr=vr==null||!gt?null:Pf(vr/gt*3),Ar=[{enabled:te>0,v:st},{enabled:ue>0,v:Wt},{enabled:Ee>0,v:qt},{enabled:je>0,v:ht},...v?[{enabled:gt>0,v:vr}]:[]];let Zt=!1,Kt=!1,it=0;for(const Mt of Ar)if(Mt.enabled){if(Zt=!0,typeof Mt.v!="number"||!Number.isFinite(Mt.v)){Kt=!0;break}it+=Mt.v}const At=!Zt||Kt?null:ds(it);return{sno:Fe+1,...Qe,co1:st,co1Pct:Ut,co1_3pt:Gr,co2:Wt,co2Pct:Gt,co2_3pt:bn,co3:qt,co3Pct:cr,co3_3pt:or,co4:ht,co4Pct:ir,co4_3pt:kr,co5:vr,co5Pct:Lt,co5_3pt:Mr,total:At}})},[z,xr,bt,O,g,v,ae,Xr,y,qr,R]),Vr=x.useMemo(()=>{if(y){const hr=Tr=>{const ne=Br.map(ce=>ce==null?void 0:ce[Tr]).filter(ce=>typeof ce=="number");return ne.length?Pf(ne.reduce((ce,te)=>ce+te,0)/ne.length):null};return{strength:z.length,co1Avg3pt:hr("co1_3pt"),co2Avg3pt:hr("co2_3pt"),co3Avg3pt:hr("co3_3pt"),co4Avg3pt:hr("co4_3pt"),co5Avg3pt:hr("co5_3pt")}}const Me=Br.map(hr=>hr.co1_3pt).filter(hr=>typeof hr=="number"),Ce=Br.map(hr=>hr.co2_3pt).filter(hr=>typeof hr=="number"),It=Br.map(hr=>hr.co3_3pt).filter(hr=>typeof hr=="number"),ft=Br.map(hr=>hr.co4_3pt).filter(hr=>typeof hr=="number"),Ot=Br.map(hr=>hr.co5_3pt).filter(hr=>typeof hr=="number"),er=hr=>hr.length?Pf(hr.reduce((Tr,ne)=>Tr+ne,0)/hr.length):null;return{strength:z.length,co1Avg3pt:er(Me),co2Avg3pt:er(Ce),co3Avg3pt:er(It),co4Avg3pt:er(ft),...v?{co5Avg3pt:er(Ot)}:{}}},[Br,z.length,y,v]),An=x.useMemo(()=>{const Me=Number(qr==null?void 0:qr.co1);return Number.isFinite(Me)&&Me>0?Me:55},[qr]),Yr=x.useMemo(()=>{if(!y)return{1:0,2:0,3:0,4:0,5:0,6:0};const Me={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1},Ce=[R.cia1,R.cia2,R.model].filter(Boolean);for(const It of Ce){const ft=It!=null&&It.sheet&&typeof It.sheet=="object"?It.sheet:{},Ot=mi(Number((ft==null?void 0:ft.expCountA)??0),0,12),er=mi(Number((ft==null?void 0:ft.expCountB)??0),0,12),hr=!!(ft!=null&&ft.coAEnabled),Tr=!!(ft!=null&&ft.coBEnabled),ne=Array.isArray(ft==null?void 0:ft.btlA)?ft.btlA:[],ce=Array.isArray(ft==null?void 0:ft.btlB)?ft.btlB:[];if(hr)for(let te=0;te<Ot;te++){const ue=yj(ne[te]);ue&&(Me[ue]=!0)}if(Tr)for(let te=0;te<er;te++){const ue=yj(ce[te]);ue&&(Me[ue]=!0)}}return{1:Me[1]?10:0,2:Me[2]?10:0,3:Me[3]?10:0,4:Me[4]?10:0,5:Me[5]?10:0,6:Me[6]?10:0}},[y,R]),Ln={padding:"8px 10px",borderRadius:10,border:"1px solid #e5e7eb",width:90};return a.jsxs("div",{style:{display:"grid",gap:14},children:[(de||G)&&a.jsx("div",{style:{fontSize:12,color:G?"#b91c1c":"#6b7280"},children:de?"Loading published marks":G}),K&&Object.keys(K).length>0&&a.jsx("div",{style:{marginTop:6,fontSize:12},children:Object.entries(K).map(([Me,Ce])=>Ce?a.jsxs("div",{style:{color:"#b91c1c"},children:[Me,": ",String(Ce)]},Me):null)}),a.jsxs("div",{style:{padding:16,borderRadius:12,background:"linear-gradient(180deg,#ffffff, #f6fbff)",border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13, 60, 100, 0.06)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:18,fontWeight:800,color:"#0b4a6f"},children:y?"CO Attainment (LAB)":"CO Attainment (Summative + Formative)"}),a.jsx("div",{style:{marginTop:6,color:"#264653",fontSize:13},children:y?"Uses published LAB sheets: CIA1 LAB (CO1/CO2) + CIA2 LAB (CO3/CO4) + MODEL LAB (CO5).":"Uses weighted blending per CO: SSA1 + CIA1 + Formative1 (based on your Excel formula)."})]}),a.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Teaching Assignment / Section"}),a.jsxs("select",{value:P??"",onChange:Me=>B(Me.target.value?Number(Me.target.value):null),style:{padding:"10px 12px",borderRadius:10,border:"1px solid #e5e7eb",minWidth:320},children:[a.jsx("option",{value:"",children:"Select"}),k.map(Me=>{const Ce=Me.department,It=(Ce==null?void 0:Ce.short_name)||(Ce==null?void 0:Ce.code)||(Ce==null?void 0:Ce.name)||Me.department_name||"",ft=Me.semester;return a.jsxs("option",{value:Me.id,children:[Me.section_name," ",ft?` Sem ${ft}`:""," ",Me.academic_year?` ${Me.academic_year}`:""," ",It?` ${It}`:""]},Me.id)})]})]})})]}),A&&a.jsx("div",{style:{marginTop:10,background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:A}),y?a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12,marginTop:12},children:a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"LAB CO max"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["CO max values are pulled from published LAB sheets only.",qr?a.jsx(a.Fragment,{children:S.map((Me,Ce)=>{const It=`co${Me}`;return a.jsxs(hn.Fragment,{children:[Ce>0&&" | ","CO",Me,": ",a.jsx("b",{children:qr[It]})]},Me)})}):a.jsxs(a.Fragment,{children:[" Each CO max is ",a.jsx("b",{children:An}),"."]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",a.jsx("b",{children:Vr.strength}),S.map(Me=>{const Ce=`co${Me}Avg3pt`;return a.jsxs(hn.Fragment,{children:["| CO",Me," avg (3pt): ",a.jsx("b",{children:Vr[Ce]??"-"})]},Me)})]})]})}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr",gap:12,marginTop:12},children:[a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Max marks per CO (P4:P6)"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 120px 120px 120px",gap:8,alignItems:"center"},children:[a.jsx("div",{}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"SSA1"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"CIA1"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"Formative1"}),a.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO1"}),a.jsx("div",{children:bt.ssa1.co1}),a.jsx("div",{children:bt.cia1.co1}),a.jsx("div",{children:bt.f1.co1}),a.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO2"}),a.jsx("div",{children:bt.ssa1.co2}),a.jsx("div",{children:bt.cia1.co2}),a.jsx("div",{children:bt.f1.co2})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:S.filter(Me=>Me<=4||v).map((Me,Ce)=>{const It=`co${Me}`,ft=Me===5?ae:Xr[It];return a.jsxs(hn.Fragment,{children:[Ce>0&&a.jsx(a.Fragment,{children:"|"}),"CO",Me," total max: ",a.jsx("b",{children:ft})]},Me)})})]}),a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Weights (R4:R6)"}),a.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Source: ",a.jsx("b",{children:pe==="server"?"IQAC (server)":pe==="local"?"IQAC (local)":"Defaults"})]})]}),_e&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:_e}),We&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",We]}),_t!=null&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#475569"},children:["Known class-types on server/local: ",_t]}),a.jsx("div",{style:{marginTop:6},children:a.jsxs("button",{onClick:()=>Ne(Me=>!Me),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[nt?"Hide":"Show"," raw IQAC mapping"]})}),nt&&a.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(Ae.current||{},null,2).slice(0,3200)}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1",a.jsx("input",{type:"number",step:"0.1",value:O.ssa1,onChange:Me=>H(Ce=>({...Ce,ssa1:Number(Me.target.value)})),disabled:!ie,style:Ln})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1",a.jsx("input",{type:"number",step:"0.1",value:O.cia1,onChange:Me=>H(Ce=>({...Ce,cia1:Number(Me.target.value)})),disabled:!ie,style:Ln})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1",a.jsx("input",{type:"number",step:"0.1",value:O.formative1,onChange:Me=>H(Ce=>({...Ce,formative1:Number(Me.target.value)})),disabled:!ie,style:Ln})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",a.jsx("b",{children:Vr.strength})," | CO1 avg (3pt): ",a.jsx("b",{children:Vr.co1Avg3pt??"-"})," | CO2 avg (3pt): ",a.jsx("b",{children:Vr.co2Avg3pt??"-"})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Note: CIA1 CO marks are computed from the locally saved CIA1 question-wise sheet."})]})]}),a.jsx("div",{style:{marginTop:12},children:a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Assessment Weights"}),a.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Class Type: ",a.jsx("b",{children:s||"Unknown"})," | Source: ",a.jsx("b",{children:pe==="server"?"IQAC (server)":pe==="local"?"IQAC (local)":"Defaults"})]})]}),_e&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:_e}),We&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",We]}),a.jsx("div",{style:{marginTop:6},children:a.jsxs("button",{onClick:()=>Ne(Me=>!Me),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[nt?"Hide":"Show"," raw IQAC mapping"]})}),nt&&a.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(Ae.current||{},null,2).slice(0,3200)}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:12},children:[a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1 Weight",a.jsx("input",{type:"number",step:"0.1",value:O.ssa1,onChange:Me=>H(Ce=>({...Ce,ssa1:Number(Me.target.value)})),disabled:!ie,style:Ln})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1 Weight",a.jsx("input",{type:"number",step:"0.1",value:O.cia1,onChange:Me=>H(Ce=>({...Ce,cia1:Number(Me.target.value)})),disabled:!ie,style:Ln})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1 Weight",a.jsx("input",{type:"number",step:"0.1",value:O.formative1,onChange:Me=>H(Ce=>({...Ce,formative1:Number(Me.target.value)})),disabled:!ie,style:Ln})]}),v&&a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CO5 Weightage (MODEL)",a.jsx("input",{type:"number",step:"1",value:ae,onChange:Me=>I(Number(Me.target.value)),disabled:!ie,style:Ln})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["These weights determine how SSA1, CIA1, and Formative1 assessments contribute to CO attainment calculations.",!ie&&a.jsxs("span",{style:{color:"#059669",fontWeight:600},children:[" Values shown are appropriate defaults for ",s||"this"," class type."]})]})]})})]}),F&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:F}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:a.jsx("button",{onClick:()=>fe(!be),style:{padding:"8px 16px",backgroundColor:be?"#059669":"#0ea5e9",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontWeight:600,fontSize:13},children:be?"Show CO Columns":"Hide CO Columns"})}),E?a.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,overflow:"auto",background:"#fff"},children:y?a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:2100},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{rowSpan:2,style:Oi,children:"S.No"}),a.jsx("th",{rowSpan:2,style:Oi,children:"Section"}),a.jsx("th",{rowSpan:2,style:Oi,children:"Register No"}),a.jsx("th",{rowSpan:2,style:Oi,children:"Name"}),!be&&a.jsx(a.Fragment,{children:S.map(Me=>a.jsxs("th",{colSpan:3,style:Of,children:["CO",Me]},`co${Me}`))}),a.jsx("th",{rowSpan:2,style:Oi,children:"CQI Entry"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-1"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-2"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-3"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-4"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-5"}),a.jsx("th",{colSpan:2,style:Of,children:"BTL-6"}),a.jsxs("th",{rowSpan:2,style:Oi,children:["Total / ",ds((qr==null?void 0:qr.total)??An*5)]})]}),a.jsxs("tr",{children:[!be&&a.jsx(a.Fragment,{children:S.map(Me=>{const Ce=`co${Me}`,It=(qr==null?void 0:qr[Ce])??An;return a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:Oi,children:It}),a.jsx("th",{style:Oi,children:"%"}),a.jsx("th",{style:Oi,children:"3pt"})]},`co${Me}-cells`)})}),a.jsx("th",{style:Oi,children:Yr[1]}),a.jsx("th",{style:Oi,children:"%"}),a.jsx("th",{style:Oi,children:Yr[2]}),a.jsx("th",{style:Oi,children:"%"}),a.jsx("th",{style:Oi,children:Yr[3]}),a.jsx("th",{style:Oi,children:"%"}),a.jsx("th",{style:Oi,children:Yr[4]}),a.jsx("th",{style:Oi,children:"%"}),a.jsx("th",{style:Oi,children:Yr[5]}),a.jsx("th",{style:Oi,children:"%"}),a.jsx("th",{style:Oi,children:Yr[6]}),a.jsx("th",{style:Oi,children:"%"})]})]}),a.jsx("tbody",{children:Br.map(Me=>a.jsxs("tr",{children:[a.jsx("td",{style:Bi,children:Me.sno}),a.jsx("td",{style:Bi,children:Me.section??""}),a.jsx("td",{style:Bi,children:Me.reg_no}),a.jsx("td",{style:Bi,children:Me.name}),!be&&a.jsx(a.Fragment,{children:S.map(Ce=>{const It=`co${Ce}`,ft=`co${Ce}Pct`,Ot=`co${Ce}_3pt`;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me[It]==null?"":ds(Me[It])}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me[ft]==null?"":Me[ft]}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me[Ot]==null?"":Me[Ot]})]},`co${Ce}-row`)})}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:a.jsx("input",{type:"text",value:ge[Me.id]||"",onChange:Ce=>lt({...ge,[Me.id]:Ce.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl1==null?"":ds(Me.btl1)}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl1Pct==null?"":Me.btl1Pct}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl2==null?"":ds(Me.btl2)}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl2Pct==null?"":Me.btl2Pct}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl3==null?"":ds(Me.btl3)}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl3Pct==null?"":Me.btl3Pct}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl4==null?"":ds(Me.btl4)}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl4Pct==null?"":Me.btl4Pct}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl5==null?"":ds(Me.btl5)}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl5Pct==null?"":Me.btl5Pct}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl6==null?"":ds(Me.btl6)}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me.btl6Pct==null?"":Me.btl6Pct}),a.jsx("td",{style:{...Bi,textAlign:"center",fontWeight:700},children:Me.total==null?"":Me.total})]},Me.id))})]}):a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:980},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{rowSpan:2,style:Oi,children:"S.No"}),a.jsx("th",{rowSpan:2,style:Oi,children:"Section"}),a.jsx("th",{rowSpan:2,style:Oi,children:"Register No"}),a.jsx("th",{rowSpan:2,style:Oi,children:"Name"}),!be&&a.jsx(a.Fragment,{children:S.map(Me=>Me===5&&!v?null:a.jsxs("th",{colSpan:3,style:Of,children:["CO",Me]},`co${Me}`))}),a.jsx("th",{rowSpan:2,style:Oi,children:"CQI Entry"}),a.jsxs("th",{rowSpan:2,style:Oi,children:["Total / ",Xr.total]})]}),a.jsx("tr",{children:!be&&a.jsx(a.Fragment,{children:S.map(Me=>{if(Me===5&&!v)return null;const Ce=`co${Me}`,It=Me===5?ae:Xr[Ce];return a.jsxs(hn.Fragment,{children:[a.jsx("th",{style:Oi,children:It}),a.jsx("th",{style:Oi,children:"%"}),a.jsx("th",{style:Oi,children:"3pt"})]},`co${Me}-cells`)})})})]}),a.jsx("tbody",{children:Br.map(Me=>a.jsxs("tr",{children:[a.jsx("td",{style:Bi,children:Me.sno}),a.jsx("td",{style:Bi,children:Me.section??""}),a.jsx("td",{style:Bi,children:Me.reg_no}),a.jsx("td",{style:Bi,children:Me.name}),!be&&a.jsx(a.Fragment,{children:S.map(Ce=>{if(Ce===5&&!v)return null;const It=`co${Ce}`,ft=`co${Ce}Pct`,Ot=`co${Ce}_3pt`;return a.jsxs(hn.Fragment,{children:[a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me[It]==null?"":ds(Me[It])}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me[ft]==null?"":Me[ft]}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:Me[Ot]==null?"":Me[Ot]})]},`co${Ce}-row`)})}),a.jsx("td",{style:{...Bi,textAlign:"center"},children:a.jsx("input",{type:"text",value:ge[Me.id]||"",onChange:Ce=>lt({...ge,[Me.id]:Ce.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),a.jsx("td",{style:{...Bi,textAlign:"center",fontWeight:700},children:Me.total==null?"":Me.total})]},Me.id))})]})})]})}const Oi={border:"1px solid #111827",padding:"8px 8px",background:"#f3f4f6",textAlign:"center",fontWeight:800,fontSize:12,whiteSpace:"nowrap"},Of={...Oi,background:"#eaf2ff",color:"#0b4a6f"},Bi={border:"1px solid #111827",padding:"7px 8px",fontSize:12,whiteSpace:"nowrap"},Na=[1,2,3,4,5];function Is(e){return`co${e}`}function so(e){return{co1:e,co2:e,co3:e,co4:e,co5:e}}const nOe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],Ad={ssa1:1.5,cia1:3,formative1:2.5},bj=1.74;function zu(e,t,r){return Math.max(t,Math.min(r,e))}function qB(e){return Math.round(e*100)/100}function Sv(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function HB(e){const t=s=>!Number.isFinite(s)||s<1||s>5?null:s;if(e==null||e==="")return[1];if(Array.isArray(e)){const s=[];for(const o of e){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}if(typeof e=="number")return[t(e)||1];const r=String(e).trim().toLowerCase();if(!r)return[1];if(r==="both")return[1,2];const n=r.replace(/[^0-9,\/\+&]+/g,"").split(/[,\/\+&]+/g).map(s=>s.trim()).filter(Boolean);if(n.length>1){const s=[];for(const o of n){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}return r==="12"?[1,2]:[t(Number(r))||1]}function iOe(e){const t=so(0),n=Array.from(new Set((e||[]).filter(Boolean))).filter(s=>Na.includes(s)),i=n.length||1;for(const s of n.length?n:[1])t[Is(s)]=1/i;return t}function VB(e,t){const r=e[t];if(!r)return so(0);const n=HB(r.co),i=e.some(c=>HB(c.co).length>1),s=t===e.length-1,o=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return iOe(!i&&s&&o?[1,2]:n)}function GB(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function aOe(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:i,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u}=e;if(t==null||r==null||n==null||!i||!s||!o)return null;const d=l+c+u,f=i+s+o;if(!d||!f)return null;const p=(t/i*l+r/s*c+n/o*u)/d*f;return Number.isFinite(p)?zu(p,0,f):null}function sOe({courseId:e}){const[t,r]=x.useState(null),n=x.useMemo(()=>`cqi_visible_cos_${e}`,[e]),[i,s]=x.useState(()=>{try{const H=Jn(`cqi_visible_cos_${e}`);if(Array.isArray(H)){const ae=H.map(Z=>Number(Z)).filter(Z=>Na.includes(Z)),I=Array.from(new Set(ae));return I.length?I:[...Na]}}catch{}return[...Na]});x.useEffect(()=>{try{Gn(n,i)}catch{}},[n,i]);const[o,l]=x.useState(null);x.useMemo(()=>ti(o),[o]);const c=x.useMemo(()=>N3(o),[o]),[u,d]=x.useState([]),[f,h]=x.useState(null),[p,m]=x.useState(null),[g,y]=x.useState(!1),[b,v]=x.useState(null),[w,S]=x.useState([]),[k,j]=x.useState(!1),[A,L]=x.useState(null),[P,B]=x.useState({ssa:{},f1:{},cia:null}),[E,T]=x.useState({cia1:null}),[F,W]=x.useState(""),z=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[se,de]=x.useState(()=>{const H=Jn(`co_attainment_cfg_${e}`),ae=H==null?void 0:H.weights;return{ssa1:Number.isFinite(Number(ae==null?void 0:ae.ssa1))?Number(ae.ssa1):Ad.ssa1,cia1:Number.isFinite(Number(ae==null?void 0:ae.cia1))?Number(ae.cia1):Ad.cia1,formative1:Number.isFinite(Number(ae==null?void 0:ae.formative1))?Number(ae.formative1):Ad.formative1}}),[U,G]=x.useState("default"),[re,X]=x.useState(null);x.useEffect(()=>{let H=!0;return(async()=>{try{const ae=await vu();if(!H)return;r(ae||null)}catch{}})(),()=>{H=!1}},[e]),x.useEffect(()=>{let H=!0;return(async()=>{var ae;try{const I=await lc();if(!H)return;const Z=(I||[]).filter(Ae=>Ae.subject_code===e);d(Z),h(null);const pe=Jn(`coAttainment_selectedTa_${e}`),Oe=typeof pe=="number"&&Z.some(Ae=>Ae.id===pe)&&pe||(((ae=Z[0])==null?void 0:ae.id)??null);m(Oe)}catch(I){if(!H)return;d([]),m(null),h((I==null?void 0:I.message)||"Failed to load teaching assignments")}})(),()=>{H=!1}},[e]),x.useEffect(()=>{!e||p==null||Gn(`coAttainment_selectedTa_${e}`,p)},[e,p]),x.useEffect(()=>{let H=!0;return(async()=>{try{const ae=(u||[]).find(Ae=>Ae.id===p)||null,I=String((ae==null?void 0:ae.class_type)||"").trim();if(I){H&&l(I);return}const Z=ae==null?void 0:ae.curriculum_row_id;if(!Z){H&&l(null);return}const pe=await A3(Number(Z));if(!H)return;const Oe=String((pe==null?void 0:pe.class_type)||"").trim();l(Oe||null)}catch{H&&l(null)}})(),()=>{H=!1}},[p,u]),x.useEffect(()=>{let H=!0;return(async()=>{if(o){X("Loading IQAC weights");try{const ae=await _S();if(!H)return;if(ae&&typeof ae=="object"){const I=ti(o),Z=ae[I];if(Z&&typeof Z=="object"){const pe={ssa1:Number.isFinite(Number(Z.ssa1))?Number(Z.ssa1):Ad.ssa1,cia1:Number.isFinite(Number(Z.cia1))?Number(Z.cia1):Ad.cia1,formative1:Number.isFinite(Number(Z.formative1))?Number(Z.formative1):Ad.formative1};de(pe),G("server"),X(`Applied server weights for ${I}`);try{Gn(z,{weights:pe})}catch{}return}X(`Server weights loaded but no entry for ${ti(o)}`)}}catch(ae){X(`Server fetch failed: ${String((ae==null?void 0:ae.message)||ae)}`)}try{const ae=Jn("iqac_class_type_weights");if(ae&&typeof ae=="object"){const I=ti(o),Z=ae[I];if(Z&&typeof Z=="object"){const pe={ssa1:Number.isFinite(Number(Z.ssa1))?Number(Z.ssa1):Ad.ssa1,cia1:Number.isFinite(Number(Z.cia1))?Number(Z.cia1):Ad.cia1,formative1:Number.isFinite(Number(Z.formative1))?Number(Z.formative1):Ad.formative1};de(pe),G("local"),X(`Applied local weights for ${I}`);try{Gn(z,{weights:pe})}catch{}return}}}catch(ae){X(`Local read failed: ${String((ae==null?void 0:ae.message)||ae)}`)}}})(),()=>{H=!1}},[o,z]);const C=x.useMemo(()=>{var ae,I;const H=(I=(ae=t==null?void 0:t.assessments)==null?void 0:ae.cia1)==null?void 0:I.questions;return Array.isArray(H)&&H.length?H.map(Z=>({key:String((Z==null?void 0:Z.key)||""),label:String((Z==null?void 0:Z.label)||(Z==null?void 0:Z.key)||""),max:Number((Z==null?void 0:Z.max)||0),co:Z==null?void 0:Z.co,btl:Math.min(6,Math.max(1,Number((Z==null?void 0:Z.btl)||1)))})).filter(Z=>Z.key):nOe},[t]),K=x.useMemo(()=>{const H=so(0);return C.forEach((ae,I)=>{const Z=VB(C,I);for(const pe of Na)H[Is(pe)]+=(Number(ae.max)||0)*(Z[Is(pe)]||0)}),H},[C]),V=x.useMemo(()=>{var _e,De,We;const H=((_e=t==null?void 0:t.assessments)==null?void 0:_e.ssa1)||{},ae=((De=t==null?void 0:t.assessments)==null?void 0:De.formative1)||{},I=((We=t==null?void 0:t.assessments)==null?void 0:We.cia1)||{},Z=(Ct,_t)=>{var nt;const Xe=so(0);for(const Ne of Na){const be=Is(Ne),fe=Number((nt=Ct==null?void 0:Ct.coMax)==null?void 0:nt[be]);Xe[be]=Number.isFinite(fe)?Math.max(0,fe):_t[be]}return Xe},pe={...so(0),co1:10,co2:10},Oe=Number(ae==null?void 0:ae.maxCo),Ae={...so(0),co1:Number.isFinite(Oe)?Math.max(0,Oe):10,co2:Number.isFinite(Oe)?Math.max(0,Oe):10},ke=K;return{ssa:Z(H,pe),cia:Z(I,ke),f1:Z(ae,Ae)}},[t,K]),R=async()=>{j(!0),L(null);try{if(c){const H=await ho("cia1",e);B({ssa:{},f1:{},cia:null}),T({cia1:(H==null?void 0:H.data)??null})}else{const[H,ae,I]=await Promise.all([rg(e),AS(e),ry(e)]);B({ssa:H!=null&&H.marks&&typeof H.marks=="object"?H.marks:{},f1:ae!=null&&ae.marks&&typeof ae.marks=="object"?ae.marks:{},cia:(I==null?void 0:I.data)??null}),T({cia1:null})}}catch(H){B({ssa:{},f1:{},cia:null}),T({cia1:null}),L((H==null?void 0:H.message)||"Failed to load published marks")}finally{j(!1)}};x.useEffect(()=>{e&&R()},[e,c]),x.useEffect(()=>{const H=ae=>{try{const I=(ae==null?void 0:ae.detail)||{},Z=I.subjectId,pe=I.assessment;if(!Z||String(Z)!==String(e)||pe&&!["ssa1","formative1","cia1"].includes(String(pe)))return;R()}catch{}};return window.addEventListener("obe:published",H),()=>window.removeEventListener("obe:published",H)},[e]),x.useEffect(()=>{let H=!0;return(async()=>{if(p){y(!0),v(null);try{const I=(u||[]).find(Z=>Z.id===p)||null;if(I&&I.elective_subject_id&&!I.section_id){const Z=I.elective_subject_id,pe=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Z))}`);if(!pe.ok)throw new Error(`Elective-choices fetch failed: ${pe.status}`);const Oe=await pe.json();if(!H)return;const ke=((Array.isArray(Oe.results)?Oe.results:Array.isArray(Oe)?Oe:Oe.items||[])||[]).map(_e=>({id:Number(_e.student_id??_e.id),reg_no:String(_e.reg_no??_e.registration_no??_e.regno??""),name:String(_e.name??_e.full_name??_e.username??""),section:_e.section_name??_e.section??null}));if(!H)return;S(ke.filter(_e=>Number.isFinite(_e.id)).sort(GB))}else{const Z=await qc(p);if(!H)return;const pe=(Z.students||[]).map(Oe=>({id:Number(Oe.id),reg_no:String(Oe.reg_no??""),name:String(Oe.name??""),section:Oe.section??null})).filter(Oe=>Number.isFinite(Oe.id)).sort(GB);S(pe)}}catch(I){if(!H)return;S([]),v((I==null?void 0:I.message)||"Failed to load roster")}finally{H&&y(!1)}}})(),()=>{H=!1}},[p,u]);const J=x.useMemo(()=>{const H=new Map;if(c){const ke=E.cia1,_e=ke!=null&&ke.sheet&&typeof ke.sheet=="object"?ke.sheet:{},De=_e!=null&&_e.rowsByStudentId&&typeof _e.rowsByStudentId=="object"?_e.rowsByStudentId:{},We=zu(Number((_e==null?void 0:_e.expCountA)??0),0,12),Ct=zu(Number((_e==null?void 0:_e.expCountB)??0),0,12),_t=!!(_e!=null&&_e.coAEnabled),Xe=!!(_e!=null&&_e.coBEnabled),nt=(be,fe)=>{const ge=Array.isArray(be)?be:[],lt=[];for(let He=0;He<fe;He++){const mt=ge[He];if(mt===""||mt==null){lt.push("");continue}const wt=typeof mt=="number"?mt:Number(mt);lt.push(Number.isFinite(wt)?wt:"")}return lt},Ne=be=>{const fe=be.filter(ge=>typeof ge=="number"&&Number.isFinite(ge));return fe.length?fe.reduce((ge,lt)=>ge+lt,0)/fe.length:null};for(const be of w){const fe=De[String(be.id)]||{},ge=nt(fe.marksA,We).slice(0,_t?We:0),lt=nt(fe.marksB,Ct).slice(0,Xe?Ct:0),He=Ne(ge),mt=Ne(lt),wt=fe==null?void 0:fe.ciaExam,Pt=typeof wt=="number"&&Number.isFinite(wt)?wt:null,bt=He!=null||mt!=null||Pt!=null,qr=bt?(He??0)+(Pt??0)/2:null,Tt=bt?(mt??0)+(Pt??0)/2:null;H.set(be.id,{ssaCo1:null,ssaCo2:null,ciaCo1:qr==null?null:zu(qr,0,40),ciaCo2:Tt==null?null:zu(Tt,0,40),f1Co1:null,f1Co2:null,__labCoMax:40})}return H}const ae=new Map;for(const[Ae,ke]of Object.entries(P.ssa||{})){const _e=Number(Ae);Number.isFinite(_e)&&ae.set(_e,Sv(ke))}const I=P.f1&&typeof P.f1=="object"?P.f1:{},Z=P.cia&&typeof P.cia=="object"?P.cia:null,pe=Array.isArray(Z==null?void 0:Z.questions)?Z.questions.map(Ae=>({key:String((Ae==null?void 0:Ae.key)||""),label:String((Ae==null?void 0:Ae.label)||(Ae==null?void 0:Ae.key)||""),max:Number((Ae==null?void 0:Ae.max)||0),co:Ae==null?void 0:Ae.co,btl:Math.min(6,Math.max(1,Number((Ae==null?void 0:Ae.btl)||1)))})).filter(Ae=>Ae.key):C,Oe=Z!=null&&Z.rowsByStudentId&&typeof Z.rowsByStudentId=="object"?Z.rowsByStudentId:{};for(const Ae of w){const ke=ae.get(Ae.id)??null,_e=Na.reduce((fe,ge)=>fe+(V.ssa[Is(ge)]||0),0),De=so(null);for(const fe of Na){const ge=Is(fe),lt=V.ssa[ge]||0;if(ke==null||!_e||!lt){De[ge]=null;continue}const He=ke/_e*lt;De[ge]=zu(He,0,lt)}const We=I[String(Ae.id)]||{},Ct=so(null);for(const fe of Na){const ge=Is(fe),lt=V.f1[ge]||0,He=Sv(We==null?void 0:We[`skill${fe}`]),mt=Sv(We==null?void 0:We[`att${fe}`]);lt&&He!=null&&mt!=null?Ct[ge]=zu(He+mt,0,lt):Ct[ge]=null}const _t=Oe[String(Ae.id)]||{},Xe=!!(_t!=null&&_t.absent),nt=_t!=null&&_t.q&&typeof _t.q=="object"?_t.q:{},Ne=so(null);if(!Xe){const fe=so(0);let ge=!1;if(pe.forEach((lt,He)=>{const mt=nt==null?void 0:nt[lt.key],wt=Sv(mt);if(wt==null)return;ge=!0;const Pt=zu(wt,0,Number(lt.max)||wt),bt=VB(pe,He);for(const qr of Na){const Tt=Is(qr);fe[Tt]+=Pt*(bt[Tt]||0)}}),ge)for(const lt of Na){const He=Is(lt),mt=V.cia[He]||0;Ne[He]=mt?zu(fe[He],0,mt):null}}const be={};for(const fe of Na){const ge=Is(fe);be[`ssaCo${fe}`]=De[ge],be[`f1Co${fe}`]=Ct[ge],be[`ciaCo${fe}`]=Ne[ge]}H.set(Ae.id,be)}return H},[P,E,w,V,C,c]),q=x.useMemo(()=>{var pe;if(c){const Oe=((pe=w[0])==null?void 0:pe.id)!=null?J.get(w[0].id):null,Ae=Number(Oe==null?void 0:Oe.__labCoMax),ke=Number.isFinite(Ae)&&Ae>0?Ae:40,_e=We=>We==null||!ke?null:qB(We/ke*3),De=(We,Ct)=>{if(We==null||Ct==null||!ke)return null;const _t=(We+Ct)/(2*ke)*100;return Number.isFinite(_t)?Math.round(zu(_t,0,100)):null};return w.map((We,Ct)=>{const _t=J.get(We.id)||{},Xe=so(null);Xe.co1=typeof _t.ciaCo1=="number"?_t.ciaCo1:null,Xe.co2=typeof _t.ciaCo2=="number"?_t.ciaCo2:null;const nt=so(null),Ne=so(!1);for(const lt of Na){const He=Is(lt);nt[He]=_e(Xe[He]),Ne[He]=typeof nt[He]=="number"&&nt[He]<bj}const be=De(Xe.co1,Xe.co2),fe=Na.map(lt=>Ne[Is(lt)]?`CO${lt}`:null).filter(Boolean).join("+"),ge={sno:Ct+1,...We,total:be,cos:fe};for(const lt of Na){const He=Is(lt);ge[`${He}_3pt`]=nt[He],ge[`flagCO${lt}`]=Ne[He]}return ge})}const H=se.ssa1,ae=se.cia1,I=se.formative1,Z=so(0);for(const Oe of Na){const Ae=Is(Oe);Z[Ae]=(V.ssa[Ae]||0)+(V.cia[Ae]||0)+(V.f1[Ae]||0)}return w.map((Oe,Ae)=>{const ke=J.get(Oe.id),_e=so(null),De=so(null),We=so(!1);for(const nt of Na){const Ne=Is(nt),be=aOe({ssaMark:(ke==null?void 0:ke[`ssaCo${nt}`])??null,ciaMark:(ke==null?void 0:ke[`ciaCo${nt}`])??null,f1Mark:(ke==null?void 0:ke[`f1Co${nt}`])??null,ssaMax:V.ssa[Ne]||0,ciaMax:V.cia[Ne]||0,f1Max:V.f1[Ne]||0,ssaW:H,ciaW:ae,f1W:I});_e[Ne]=be;const fe=Z[Ne]||0;De[Ne]=be==null||!fe?null:qB(be/fe*3),We[Ne]=typeof De[Ne]=="number"&&De[Ne]<bj}const Ct=(()=>{const nt=Na.map(Ne=>_e[Is(Ne)]).filter(Ne=>typeof Ne=="number"&&Number.isFinite(Ne));return nt.length?Math.round(nt.reduce((Ne,be)=>Ne+be,0)):null})(),_t=Na.map(nt=>We[Is(nt)]?`CO${nt}`:null).filter(Boolean).join("+"),Xe={sno:Ae+1,...Oe,total:Ct,cos:_t};for(const nt of Na){const Ne=Is(nt);Xe[`${Ne}_3pt`]=De[Ne],Xe[`flagCO${nt}`]=We[Ne]}return Xe})},[w,J,V,se,c]),Y=x.useMemo(()=>{const H=F.trim().toLowerCase();return H?q.filter(ae=>{const I=String(ae.reg_no||"").toLowerCase(),Z=String(ae.name||"").toLowerCase(),pe=String(ae.section||"").toLowerCase();return I.includes(H)||Z.includes(H)||pe.includes(H)}):q},[q,F]),Q=x.useMemo(()=>{const H=Z=>i.some(pe=>!!(Z!=null&&Z[`flagCO${pe}`])),ae=q.filter(Z=>H(Z)).length,I={strength:q.length,flagged:ae};for(const Z of Na)I[`co${Z}`]=q.filter(pe=>!!pe[`flagCO${Z}`]).length;return I},[q,i]),ie={position:"sticky",top:0,zIndex:2,textAlign:"left",padding:"10px 12px",fontSize:12,letterSpacing:.2,textTransform:"uppercase",color:"#0f172a",background:"linear-gradient(180deg,#eaf6ff,#ffffff)",borderBottom:"1px solid rgba(148, 163, 184, 0.5)",whiteSpace:"nowrap"},le={padding:"10px 12px",borderBottom:"1px solid rgba(226, 232, 240, 0.9)",fontSize:13,color:"#0f172a",verticalAlign:"middle",whiteSpace:"nowrap"},O=(H,ae)=>{const I=ae==="danger"?{background:"rgba(239, 68, 68, 0.12)",border:"1px solid rgba(239, 68, 68, 0.35)",color:"#991b1b"}:{background:"rgba(2, 132, 199, 0.08)",border:"1px solid rgba(2, 132, 199, 0.25)",color:"#0b4a6f"};return a.jsx("span",{style:{display:"inline-flex",alignItems:"center",height:24,padding:"0 10px",borderRadius:999,fontSize:12,fontWeight:800,...I},children:H})};return a.jsxs("div",{style:{display:"grid",gap:14},children:[a.jsxs("div",{style:{padding:16,borderRadius:14,background:"linear-gradient(135deg,#ffffff,#f0f9ff)",border:"1px solid rgba(226, 232, 240, 0.9)",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"flex-end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:18,fontWeight:950,color:"#0b4a6f"},children:"C1-CQI"}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#334155"},children:["Flags CO1CO5 when 3pt attainment is below ",a.jsx("b",{children:bj}),"."]})]}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Teaching Assignment / Section"}),a.jsxs("select",{value:p??"",onChange:H=>m(H.target.value?Number(H.target.value):null),style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",minWidth:320,background:"#fff"},children:[a.jsx("option",{value:"",children:"Select"}),u.map(H=>{const ae=H.department,I=(ae==null?void 0:ae.short_name)||(ae==null?void 0:ae.code)||(ae==null?void 0:ae.name)||H.department_name||"",Z=H.semester;return a.jsxs("option",{value:H.id,children:[H.section_name," ",Z?` Sem ${Z}`:""," ",H.academic_year?` ${H.academic_year}`:""," ",I?` ${I}`:""]},H.id)})]})]}),a.jsxs("div",{style:{minWidth:320},children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Show CO columns"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff"},children:[Na.map(H=>{const ae=i.includes(H);return a.jsxs("label",{style:{display:"inline-flex",gap:8,alignItems:"center",cursor:"pointer",userSelect:"none"},children:[a.jsx("input",{type:"checkbox",checked:ae,onChange:I=>{const Z=I.target.checked?Array.from(new Set([...i,H])):i.filter(pe=>pe!==H);s(Z)}}),a.jsx("span",{style:{fontSize:12,fontWeight:800,color:"#0f172a"},children:`CO${H}`})]},H)}),a.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[a.jsx("button",{type:"button",onClick:()=>s([...Na]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",fontSize:12,fontWeight:800,color:"#0f172a"},children:"All"}),a.jsx("button",{type:"button",onClick:()=>s([]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",fontSize:12,fontWeight:800,color:"#0f172a"},children:"None"})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Search"}),a.jsx("input",{value:F,onChange:H=>W(H.target.value),placeholder:"Reg no / name / section",style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",width:260}})]})]})]}),(k||A||g||b||f)&&a.jsxs("div",{style:{marginTop:12,display:"grid",gap:8},children:[(k||A)&&a.jsx("div",{style:{fontSize:12,color:A?"#b91c1c":"#64748b"},children:k?"Loading published marks":A}),(g||b)&&a.jsx("div",{style:{fontSize:12,color:b?"#b91c1c":"#64748b"},children:g?"Loading roster":b}),f&&a.jsx("div",{style:{marginTop:4,background:"#fef2f2",border:"1px solid rgba(239, 68, 68, 0.25)",color:"#991b1b",padding:10,borderRadius:12},children:f})]}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:12,flexWrap:"wrap"},children:[O(`Strength: ${Q.strength}`,"neutral"),O(`Flagged: ${Q.flagged}`,Q.flagged?"danger":"neutral"),i.map(H=>a.jsx(hn.Fragment,{children:O(`CO${H} below: ${Q[`co${H}`]??0}`,Q[`co${H}`]?"danger":"neutral")},H))]})]}),a.jsx("div",{style:{borderRadius:14,border:"1px solid rgba(226, 232, 240, 0.9)",overflow:"hidden",background:"#fff",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:a.jsx("div",{style:{maxHeight:"70vh",overflow:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{...ie,width:70},children:"slno"}),a.jsx("th",{style:{...ie,width:70},children:"SEC"}),a.jsx("th",{style:{...ie,width:160},children:"Reg number"}),a.jsx("th",{style:{...ie,minWidth:260},children:"NAME"}),a.jsx("th",{style:{...ie,width:140},children:"CO's"}),a.jsx("th",{style:{...ie,width:90,textAlign:"center"},children:"100"}),i.map(H=>a.jsx("th",{style:{...ie,width:90,textAlign:"center"},children:`CO${H} (3pt)`},H))]})}),a.jsxs("tbody",{children:[Y.map((H,ae)=>{const I=i.some(ke=>!!H[`flagCO${ke}`]),Z=ae%2===0,pe=I?"rgba(239, 68, 68, 0.10)":Z?"#ffffff":"#f8fafc",Oe=ke=>({...le,textAlign:"center",fontWeight:900,color:ke?"#991b1b":"#065f46",background:ke?"rgba(239, 68, 68, 0.10)":"rgba(34, 197, 94, 0.10)",borderBottom:"1px solid rgba(226, 232, 240, 0.9)"}),Ae=H.total!=null&&H.total<=58;return a.jsxs("tr",{style:{background:pe},children:[a.jsx("td",{style:{...le,width:70,borderLeft:I?"4px solid rgba(239, 68, 68, 0.55)":"4px solid transparent"},children:H.sno}),a.jsx("td",{style:{...le,width:70},children:H.section??""}),a.jsx("td",{style:{...le,width:160,fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},children:H.reg_no}),a.jsx("td",{style:{...le,minWidth:260,fontWeight:800},children:H.name}),a.jsx("td",{style:{...le,width:140},children:i.some(ke=>!!H[`flagCO${ke}`])?a.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:i.filter(ke=>!!H[`flagCO${ke}`]).map(ke=>a.jsx(hn.Fragment,{children:O(`CO${ke}`,"danger")},ke))}):""}),a.jsx("td",{style:{...le,width:90,textAlign:"center",fontWeight:900,color:Ae?"#991b1b":"#0f172a",background:Ae?"rgba(239, 68, 68, 0.12)":"transparent"},children:H.total==null?"":Number.isFinite(Number(H.total))?String(Math.round(Number(H.total))):H.total}),i.map(ke=>a.jsx("td",{style:Oe(!!H[`flagCO${ke}`]),children:H[`co${ke}_3pt`]==null?"":H[`co${ke}_3pt`]},ke))]},H.id)}),!Y.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6+i.length,style:{padding:18,textAlign:"center",color:"#64748b"},children:"No rows."})})]})]})})})]})}function TK({courseId:e}){return a.jsx(sOe,{courseId:e})}function Rh(e){return String(e||"").trim()}function oOe(){var k,j;const{courseCode:e,taId:t}=U0(),r=go(),n=ul(),i=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),s=x.useMemo(()=>t?Number(t):NaN,[t]),[o,l]=x.useState("marks"),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(null),[m,g]=x.useState(null);x.useEffect(()=>{if(!(n!=null&&n.pathname))return;const A=n.pathname.toLowerCase();A.includes("/lca/instructions")||A.includes("/lca_instructions")||A.includes("/lca")||A.includes("/cdap")||A.includes("/articulation")?l("lca_instructions"):A.includes("/marks")?l("marks"):A.includes("/co_attainment")?l("co_attainment"):A.includes("/cqi")?l("cqi"):l("marks")},[n]);const y=x.useMemo(()=>{const A=String((n==null?void 0:n.pathname)||"").toLowerCase();return A.includes("/cdap")?"cdap":A.includes("/articulation")?"articulation":A.includes("/lca")&&!(A.includes("/lca/instructions")||A.includes("/lca_instructions"))?"lca":"instructions"},[n==null?void 0:n.pathname]);x.useEffect(()=>{let A=!0;return(async()=>{if(i)try{const L=await R2(i);if(!A)return;const P=(L||[]).find(B=>Number(B.teaching_assignment_id)===Number(s))||null;u(P)}catch{if(!A)return;u(null)}})(),()=>{A=!1}},[i,s]),x.useEffect(()=>{let A=!0;return(async()=>{if(i)try{const[L,P]=await Promise.all([bl(),Kd()]);if(!A)return;const B=i.toUpperCase(),E=(L||[]).filter(z=>Rh(z==null?void 0:z.course_code).toUpperCase()===B),T=z=>Rh(z).toUpperCase(),F=E.find(z=>{const se=T(z==null?void 0:z.question_paper_type);return se&&se!=="QP1"})||E.find(z=>T(z==null?void 0:z.question_paper_type))||E.find(z=>Rh(z==null?void 0:z.class_type))||E[0];if(F){if(f(F!=null&&F.class_type?Rh(F.class_type):null),p(F!=null&&F.question_paper_type?Rh(F.question_paper_type):null),ti(F==null?void 0:F.class_type)==="SPECIAL"){g([]);try{const z=await wS(i);g(Array.isArray(z)?z:[])}catch{const z=F==null?void 0:F.enabled_assessments;g(Array.isArray(z)?z.map(se=>String(se).trim().toLowerCase()).filter(Boolean):[])}}else g(null);return}const W=(P||[]).find(z=>Rh(z==null?void 0:z.course_code).toUpperCase()===B);f(W!=null&&W.class_type?Rh(W.class_type):null),p(null),g(null)}catch{}})(),()=>{A=!1}},[i]);const b=x.useMemo(()=>Number.isFinite(s)?[{id:s,subject_id:0,subject_code:i,subject_name:(c==null?void 0:c.course_name)||i,section_id:(c==null?void 0:c.section_id)||0,section_name:(c==null?void 0:c.section_name)||"Section",academic_year:(c==null?void 0:c.academic_year)||""}]:[],[s,i,c]);if(!i||!Number.isFinite(s))return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),a.jsx("div",{style:{marginTop:10},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]});const v=(c==null?void 0:c.course_name)||i,w=[c==null?void 0:c.section_name,c==null?void 0:c.academic_year].filter(Boolean).join("  "),S=((k=c==null?void 0:c.staff)==null?void 0:k.name)||((j=c==null?void 0:c.staff)==null?void 0:j.username)||"";return a.jsx("main",{className:"obe-course-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:a.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsx("div",{style:{marginBottom:12,padding:18},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{margin:0},children:["OBE Viewer - ",i]}),a.jsx("div",{style:{color:"#666",marginTop:6},children:"View-only (IQAC)"}),a.jsx("div",{style:{color:"#222",marginTop:6,fontWeight:800},children:v}),a.jsxs("div",{style:{color:"#374151",marginTop:4},children:[w||"",S?`    ${S}`:"",d?`    ${String(d).toUpperCase()}`:""]}),h?a.jsxs("div",{style:{color:"#374151",marginTop:2},children:["QP Type: ",a.jsx("strong",{style:{color:"#111827"},children:String(h)})]}):null]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx(es,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(i)}`,children:"Back"}),a.jsx("button",{onClick:()=>r(`/iqac/academic-controller/course/${encodeURIComponent(i)}/marks/${encodeURIComponent(String(s))}`),className:"obe-btn",children:"Mark Entry Only"})]})]})}),a.jsx("div",{className:"obe-tab-nav","aria-label":"OBE Tabs",style:{padding:"0 18px"},children:[{key:"lca_instructions",label:"LCA Instructions"},{key:"marks",label:"Mark Entry"},{key:"co_attainment",label:"CO ATTAINMENT"},{key:"cqi",label:"CQI"}].map(A=>{const L=o===A.key;return a.jsx("button",{onClick:()=>{l(A.key);const P=encodeURIComponent(i),B=encodeURIComponent(String(s)),E=A.key==="lca_instructions"?"lca/instructions":String(A.key);r(`/iqac/academic-controller/course/${P}/obe/${B}/${E}`)},className:`obe-tab-btn ${L?"active":""}`,children:A.label},A.key)})}),a.jsxs("div",{style:{border:"1px solid #eee",borderRadius:10,padding:12,margin:18},children:[o==="lca_instructions"&&a.jsx(NK,{courseCode:i,courseName:(c==null?void 0:c.course_name)||null,initialTab:y,viewerMode:!0}),o!=="lca_instructions"?a.jsxs("fieldset",{disabled:!0,style:{border:0,padding:0,margin:0},children:[o==="co_attainment"&&a.jsx(EK,{courseId:i,enabledAssessments:m}),o==="cqi"&&a.jsx(TK,{courseId:i})]}):null,o==="marks"?a.jsx("div",{children:a.jsx(C6,{subjectId:i,classType:d,questionPaperType:h,enabledAssessments:m,teachingAssignmentsOverride:b,fixedTeachingAssignmentId:s,iqacResetEnabled:!0,viewerMode:!1})}):null]})]})})}function lOe(){const{courseCode:e,taId:t}=U0(),r=String(e||""),n=go(),[i,s]=x.useState(!0),[o,l]=x.useState(!1),[c,u]=x.useState(null),[d,f]=x.useState(null),h={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},p=j=>{const A=Number(j);if(!Number.isFinite(A)||A<=0)return[0,0,0];const L=1.5,P=3,B=2.5,E=L+P+B,T=Math.round(A*L/E*100)/100,F=Math.round(A*P/E*100)/100,W=Math.round(A*B/E*100)/100;return[T,F,W]},m=j=>{const A=j&&typeof j=="object"?j:{};let L=Array.isArray(A.weights)?[...A.weights]:[];if(L=L.map(P=>{const B=Number(P);return Number.isFinite(B)?B:0}),L.length===13){const[P,B,E]=p(L[0]??0),[T,F,W]=p(L[1]??0);L=[P,B,E,T,F,W,...L.slice(2)]}for(;L.length<h.weights.length;)L.push(h.weights[L.length]??0);return L=L.slice(0,h.weights.length),{...A,header:h.header,cycles:h.cycles,weights:L}};x.useEffect(()=>{let j=!0;return(async()=>{s(!0);try{const A=await _9(r);if(!j)return;f(A!=null&&A.mapping?m(A.mapping):null)}catch(A){if(!j)return;u((A==null?void 0:A.message)||String(A))}finally{j&&s(!1)}})(),()=>{j=!1}},[r]);const g=()=>d?m(d):(f(h),h),y=(j,A)=>{const L=A===""?"":Number(A);f(P=>{const B={...P||g()},E=Array.isArray(B.weights)?[...B.weights]:[];return E[j]=L,B.weights=E,B})},b=async()=>{l(!0),u(null);try{const j=m(d??g());await k9(r,j);try{window.dispatchEvent(new CustomEvent("internal-mark:updated",{detail:{subjectId:r}}))}catch{}n(-1)}catch(j){u((j==null?void 0:j.message)||String(j))}finally{l(!1)}};if(i)return a.jsx("div",{style:{padding:18},children:"Loading"});const v=m(d??g()),w=v.header,S=v.weights,k=v.cycles;return a.jsxs("main",{style:{padding:18},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[a.jsxs("h2",{style:{margin:0},children:["Internal Mark Mapping - ",r]}),a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>n(-1),children:"Back"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:b,disabled:o,children:o?"Saving...":"Save"})]})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:w.map((j,A)=>a.jsx("th",{style:{border:"1px solid #d1d5db",padding:8,background:"#f3f4f6"},children:j},A))}),a.jsx("tr",{children:k.map((j,A)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb",fontWeight:600},children:j},`cy-${A}`))})]}),a.jsx("tbody",{children:a.jsx("tr",{children:S.map((j,A)=>a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,background:"#f3f4f6"},children:a.jsx("input",{type:"number",step:"0.1",value:j===""?"":String(j),onChange:L=>y(A,L.target.value),style:{width:70,padding:6}})},A))})})]})}),c?a.jsx("div",{style:{color:"red",marginTop:12},children:c}):null]})}function cOe(){return a.jsx(F9,{})}function va({user:e,element:t,requiredRoles:r,requiredPermissions:n,requiredProfile:i}){if(!e)return a.jsx(Jp,{to:"/login",replace:!0});const s=(e.roles||[]).map(u=>(u||"").toString().toUpperCase()),o=(e.permissions||[]).map(u=>(u||"").toString().toLowerCase()),l=(e.profile_type||"").toString().toUpperCase();let c=!1;return i&&(i==="STUDENT"&&l==="STUDENT"&&(c=!0),i==="STAFF"&&l==="STAFF"&&(c=!0)),!c&&r&&r.length&&r.map(d=>d.toString().toUpperCase()).some(d=>s.includes(d))&&(c=!0),!c&&n&&n.length&&n.map(d=>d.toString().toLowerCase()).some(d=>o.includes(d))&&(c=!0),!i&&(!r||r.length===0)&&(!n||n.length===0)&&(c=!0),c?t:a.jsx(Jp,{to:"/dashboard",replace:!0})}function vj({user:e}){return a.jsx("div",{className:"fixed inset-0 overflow-hidden bg-gradient-to-br from-blue-50 to-slate-100",children:a.jsx("section",{className:"relative h-full flex items-center justify-center bg-gradient-to-b from-indigo-50 to-white py-0 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[a.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-gray-900 mb-6",children:"Welcome to IDCS"}),a.jsx("p",{className:"text-lg sm:text-xl text-gray-600 mb-8 max-w-2xl mx-auto",children:"Streamline your academic management with our comprehensive Education Resource Planning system"}),e?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 max-w-md mx-auto",children:[a.jsxs("p",{className:"text-lg text-gray-700 mb-2",children:["Hello, ",a.jsx("strong",{className:"text-blue-600",children:e.username}),"!"]}),e.roles&&e.roles.length>0&&a.jsxs("p",{className:"text-sm text-gray-500",children:["Role: ",a.jsx("span",{className:"font-semibold text-indigo-600",children:e.roles.join(", ")})]})]}):a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[a.jsx("a",{href:"/login",className:"px-8 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105",children:"Get Started"}),a.jsx("a",{href:"#features",className:"px-8 py-3 bg-white text-blue-600 border-2 border-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition-all duration-200",children:"Learn More"})]})]})})})}function uOe(){return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(z0,{className:"w-7 h-7 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Welcome back"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome to the dashboard."})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:a.jsx(ms,{className:"w-5 h-5 text-emerald-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Courses"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"View your enrolled courses"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(ey,{className:"w-5 h-5 text-purple-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Academics"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Access academic resources"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow sm:col-span-2 lg:col-span-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(xs,{className:"w-5 h-5 text-blue-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Schedule"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Check your timetable"})]})]})]})}function Zh({children:e}){return a.jsx(a.Fragment,{children:e})}function dOe(){return a.jsx(Zh,{children:a.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:[a.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6",children:"Dashboard"}),a.jsx(uOe,{})]})})}function fOe(e){return String(e??"").trim()}function hOe({user:e}){const[t,r]=x.useState(e===void 0?null:e),[n,i]=x.useState(!e),[s,o]=x.useState(null),l=x.useMemo(()=>{var se;return fOe((se=t==null?void 0:t.profile)==null?void 0:se.mobile_number)},[t]),c=x.useMemo(()=>{var se;return!!((se=t==null?void 0:t.profile)!=null&&se.mobile_verified)},[t]),[u,d]=x.useState(""),[f,h]=x.useState(!1),[p,m]=x.useState(!1),[g,y]=x.useState(""),[b,v]=x.useState(!1),[w,S]=x.useState(null),[k,j]=x.useState(null),[A,L]=x.useState(null),[P,B]=x.useState(0);if(x.useEffect(()=>{const se=l||"";d(se),h(!c||!se),m(!1),y(""),S(null),j(null),L(null),B(0)},[l,c]),x.useEffect(()=>{if(!p||!A)return;const se=()=>{const U=Math.max(0,Math.ceil((A-Date.now())/1e3));B(U)};se();const de=window.setInterval(se,1e3);return()=>window.clearInterval(de)},[p,A]),x.useEffect(()=>{if(e)return;let se=!0;return i(!0),y0().then(de=>{if(!se)return;const U={...de,roles:Array.isArray(de.roles)?de.roles.map(G=>typeof G=="string"?G:G.name):[]};r(U)}).catch(de=>o(String(de))).finally(()=>i(!1)),()=>{se=!1}},[e]),n)return a.jsx(Zh,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading profile"})]})})});if(s)return a.jsx(Zh,{children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-800",children:["Error loading profile: ",s]})})});if(!t)return a.jsx(Zh,{children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:a.jsx("div",{className:"text-center text-gray-500",children:"No profile available"})})});const E=(t.username||"U").slice(0,2).toUpperCase(),T=!!(c&&!f&&l);async function F(){var de,U,G;S(null),j(null);const se=String(u||"").trim();if(!se){S("Enter mobile number.");return}try{v(!0);const re=await t9(se);m(!0);const X=Number((re==null?void 0:re.expires_in_seconds)??0);if(Number.isFinite(X)&&X>0){L(Date.now()+X*1e3),B(Math.ceil(X));const C=Math.ceil(X/60);j(`OTP sent. Valid for ${C} minute${C===1?"":"s"}.`)}else L(null),B(0),j("OTP sent.")}catch(re){const C=Number(((de=re==null?void 0:re.response)==null?void 0:de.status)||0)===401?"Session expired. Please login again and retry OTP request.":String(((G=(U=re==null?void 0:re.response)==null?void 0:U.data)==null?void 0:G.detail)||(re==null?void 0:re.message)||re||"Failed to send OTP");S(C)}finally{v(!1)}}async function W(){var U,G,re;S(null),j(null);const se=String(u||"").trim(),de=String(g||"").trim();if(!se){S("Enter mobile number.");return}if(!de){S("Enter OTP.");return}try{v(!0);const X=await r9(se,de),C=X&&X.me||null;if(C){const K={...C,roles:Array.isArray(C.roles)?C.roles.map(V=>typeof V=="string"?V:V.name):[]};r(K)}else{const K=await y0(),V={...K,roles:Array.isArray(K.roles)?K.roles.map(R=>typeof R=="string"?R:R.name):[]};r(V)}m(!1),y(""),j(null),S(null),h(!1),L(null),B(0)}catch(X){const K=Number(((U=X==null?void 0:X.response)==null?void 0:U.status)||0)===401?"Session expired. Please login again and retry OTP verification.":String(((re=(G=X==null?void 0:X.response)==null?void 0:G.data)==null?void 0:re.detail)||(X==null?void 0:X.message)||X||"OTP verification failed");S(K)}finally{v(!1)}}const z=p&&A!=null&&P<=0;return a.jsx(Zh,{children:a.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6 space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-white",children:E})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:t.username}),a.jsx("p",{className:"text-gray-600 mt-1",children:t.email||"No email provided"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg px-4 py-2 shadow-sm",children:[a.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Profile Type"}),a.jsx("div",{className:"font-bold text-gray-900",children:t.profile_type||""})]})]})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(z0,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Account"}),a.jsxs("div",{className:"text-gray-900 font-medium truncate",children:["ID: ",t.id]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(v3,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Email"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.email||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Mte,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Roles"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:(t.roles||[]).join(", ")||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Fee,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Department"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.department&&(t.profile.department.short_name||t.profile.department.code)||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Ree,{className:"w-5 h-5 text-indigo-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Designation"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.designation||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Ete,{className:"w-5 h-5 text-pink-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"College"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.college&&(t.college.short_name||t.college.name)||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(kte,{className:"w-5 h-5 text-teal-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-2",children:"Mobile Number"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx("input",{className:"w-full rounded-md border border-gray-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-200",value:u,onChange:se=>{d(se.target.value),m(!1),y(""),S(null),j(null),L(null),B(0)},readOnly:T,placeholder:"Enter mobile number"}),T&&a.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:a.jsx(qf,{className:"w-5 h-5 text-emerald-600"})})]}),!T&&a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md bg-teal-600 text-white text-sm font-semibold disabled:opacity-60",onClick:F,disabled:b||p&&A!=null&&!z,children:p?z?"Resend OTP":"OTP Sent":"Verify"})]}),k&&a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:k}),w&&a.jsx("div",{className:"mt-2 text-xs text-red-600 font-semibold",children:w}),p&&A!=null&&!T&&a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:P>0?a.jsxs("span",{children:["OTP expires in"," ",String(Math.floor(P/60)).padStart(2,"0"),":",String(P%60).padStart(2,"0")]}):a.jsx("span",{className:"text-amber-700 font-semibold",children:"OTP expired. You can resend now."})}),p&&!T&&a.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[a.jsx("input",{className:"flex-1 rounded-md border border-gray-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-200",value:g,onChange:se=>y(se.target.value),placeholder:"Enter OTP"}),a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md bg-emerald-600 text-white text-sm font-semibold disabled:opacity-60",onClick:W,disabled:b,children:"Submit"})]}),T&&a.jsx("button",{type:"button",className:"mt-2 text-xs text-blue-700 underline font-semibold",onClick:()=>{h(!0),m(!1),y(""),S(null),j(null)},children:"Change number"})]})]})})]})]})]})})}function z1({children:e}){return a.jsx(Zh,{children:a.jsx("div",{className:"flex flex-col w-full max-w-full overflow-x-hidden",children:e})})}function pOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),[i,s]=x.useState(null),o=ul(),l=go(),c=e&&e.length?Array.from(new Set(e.map(b=>b.regulation))):[],u=e&&e.length?Array.from(new Set(e.map(b=>b.semester))).sort((b,v)=>b-v):[],[d,f]=x.useState(c.length===1?c[0]:c[0]??null),[h,p]=x.useState(u.length===1?u[0]:u[0]??null);x.useEffect(()=>{const b=e&&e.length?Array.from(new Set(e.map(w=>w.regulation))):[];b.length===1?f(b[0]):b.includes(d||"")||f(b[0]??null);const v=e&&e.length?Array.from(new Set(e.map(w=>w.semester))).sort((w,S)=>w-S):[];v.length===1?p(v[0]):v.includes(h||-1)||p(v[0]??null)},[e]),x.useEffect(()=>{Kd().then(b=>t(b)).catch(b=>console.error(b)).finally(()=>n(!1))},[]);function m(b){if(b==null)return"";const v=String(b);return v.includes(",")||v.includes('"')||v.includes(`
`)?'"'+v.replace(/"/g,'""')+'"':v}function g(){const b=e.filter(A=>(!d||A.regulation===d)&&(!h||A.semester===h)&&A.editable===!0);if(!b.length){alert("No editable subjects in current view");return}const w=[["regulation","semester","course_code","course_name","category","class_type","l","t","p","s","c","internal_mark","external_mark","for_all_departments","editable","departments"].join(",")];for(const A of b){const L=A.for_all_departments?"":(A.departments_display||[]).map(B=>B.short_name||B.shortname||B.code||B.name).join(","),P=[A.regulation,A.semester,A.course_code||"",A.course_name||"",A.category||"",A.class_type||"",A.l??0,A.t??0,A.p??0,A.s??0,A.c??0,A.internal_mark??"",A.external_mark??"",A.for_all_departments?"True":"False",A.editable?"True":"False",L];w.push(P.map(m).join(","))}const S=new Blob([w.join(`
`)],{type:"text/csv"}),k=URL.createObjectURL(S),j=document.createElement("a");j.href=k,j.download=`department_curriculum_editable_${d||"all"}_${h||"all"}.csv`,document.body.appendChild(j),j.click(),j.remove(),URL.revokeObjectURL(k)}async function y(b){const v=b.target.files&&b.target.files[0];if(v){if(!confirm(`Upload ${v.name} to import masters?`)){b.currentTarget.value="";return}try{const w=new FormData;w.append("csv_file",v,v.name);const S=await yr("/api/curriculum/master/import/",{method:"POST",body:w});if(S.status===401){alert("Your session has expired. Please refresh the page and try again.");return}if(S.ok)alert("Import request submitted; refresh to see changes."),n(!0),Kd().then(k=>t(k)).catch(()=>{}).finally(()=>n(!1));else{let k="";try{k=await S.text()}catch{k=S.statusText}alert("Import failed: "+(k||S.statusText))}}catch(w){console.error(w),alert("Import failed: "+(w.message||w))}try{const w=document.getElementById("master-import-file");w&&(w.value="")}catch{}}}return x.useEffect(()=>{const b=o.state;b&&b.savedMessage&&(s(b.savedMessage),l(location.pathname,{replace:!0,state:{}}),setTimeout(()=>s(null),2500))},[o,l]),r?a.jsx(z1,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading masters"})]})})}):a.jsx(z1,{children:a.jsxs("div",{className:"px-4 pb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(ms,{className:"w-6 h-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Master Curriculum"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage all master curriculum entries."})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[(()=>{try{const b=JSON.parse(localStorage.getItem("roles")||"[]");if(Array.isArray(b)&&b.some(w=>String(w).toLowerCase()==="iqac"))return a.jsx(es,{to:"/curriculum/master/new",className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:"New Master"})}catch{}return null})(),a.jsxs("button",{onClick:()=>g(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[a.jsx(P4,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),a.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-all duration-200 shadow-sm hover:shadow-md cursor-pointer",children:[a.jsx(M2,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Import CSV"}),a.jsx("input",{id:"master-import-file",type:"file",accept:".csv",className:"hidden",onChange:b=>y(b)})]})]})]}),c.length>0&&a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),a.jsx("select",{value:d??"",onChange:b=>f(b.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(b=>a.jsx("option",{value:b,children:b},b))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),a.jsx("select",{value:h??"",onChange:b=>p(b.target.value?Number(b.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(b=>a.jsx("option",{value:b,children:b},b))})]})]}),i&&a.jsx("div",{className:"mb-4 inline-block bg-green-100 text-green-800 px-4 py-2 rounded-lg font-semibold",children:i}),a.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Course"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Depts"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(b=>(!d||b.regulation===d)&&(!h||b.semester===h)).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:16,className:"px-4 py-8 text-center text-gray-500",children:"No curriculum entries found for the selected filters."})}):e.filter(b=>(!d||b.regulation===d)&&(!h||b.semester===h)).map(b=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${b.editable?"bg-blue-50/30":""}`,children:[a.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 whitespace-nowrap",children:b.course_code||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 font-medium min-w-[200px]",children:b.course_name||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.category||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.class_type||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:b.is_elective?a.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.l??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.t??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.p??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.s??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.c??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.external_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 font-semibold whitespace-nowrap",children:b.total_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.for_all_departments?"ALL":b.departments_display&&b.departments_display.length>0?b.departments_display.map(v=>v.short_name||v.shortname||v.code||v.name).join(", "):"No Depts"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:b.editable?a.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(es,{to:`/curriculum/master/${b.id}`,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:a.jsx(ch,{className:"w-4 h-4"})}),b.status==="PENDING"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"px-3 py-1.5 text-green-600 hover:bg-green-50 text-xs font-medium rounded-lg transition-colors",children:"Approve"}),a.jsx("button",{type:"button",className:"px-3 py-1.5 text-red-600 hover:bg-red-50 text-xs font-medium rounded-lg transition-colors",children:"Reject"})]})]})})]},b.id))})]})})]})})}function KB(){const{id:e}=U0(),t=e??(window.location.pathname.endsWith("/new")?"new":void 0),r=go(),[n,i]=x.useState({regulation:"",semester:1,for_all_departments:!0,editable:!1,is_elective:!1}),[s,o]=x.useState(!1),[l,c]=x.useState([]),[u,d]=x.useState(null);x.useEffect(()=>{t&&t!=="new"&&(o(!0),Kd().then(h=>{const p=h.find(m=>String(m.id)===String(t));p&&i(p)}).finally(()=>o(!1)))},[t]),x.useEffect(()=>{bl().then(h=>{const p=new Map;h.forEach(m=>p.set(m.department.id,m.department)),c(Array.from(p.values()))}).catch(()=>c([]))},[]);async function f(){o(!0);try{if(!n.regulation)throw new Error("Regulation is required");if(!n.semester||n.semester<=0)throw new Error("Semester must be a positive number");if(!n.course_name)throw new Error("Course Name is required");if(n.internal_mark!==""&&n.internal_mark!=null&&n.internal_mark<0||n.external_mark!==""&&n.external_mark!=null&&n.external_mark<0)throw new Error("Marks cannot be negative");const h={...n};if(n.for_all_departments?h.departments=[]:h.departments=Array.isArray(n.departments)?n.departments:[],h.internal_mark=n.internal_mark===""||n.internal_mark==null?0:Number(n.internal_mark),h.external_mark=n.external_mark===""||n.external_mark==null?0:Number(n.external_mark),h.course_code=n.course_code===""||n.course_code==null?null:n.course_code,t==="new"){const p=await Bre(h);r("/curriculum/master",{state:{savedMessage:"Saved",newId:p.id}})}else{const p=Number(t);if(Number.isNaN(p))throw new Error("Invalid master id");const m=await Fre(p,h);i(m),d("Saved"),setTimeout(()=>d(null),2500)}}catch(h){alert(`Error: ${h.message}`)}finally{o(!1)}}return a.jsxs(z1,{children:[a.jsxs("div",{className:"px-2 sm:px-4 pb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(ms,{className:"w-5 h-5 sm:w-6 sm:h-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:e==="new"?"New Master":"Edit Master"}),a.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-1",children:e==="new"?"Create a new master curriculum entry.":"Edit the selected master curriculum entry."})]})]}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),f()},className:"bg-white rounded-lg shadow-md p-3 sm:p-4 lg:p-6 space-y-4",autoComplete:"off",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Regulation"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.regulation||"",onChange:h=>i({...n,regulation:h.target.value}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Semester"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:1,value:n.semester||1,onChange:h=>i({...n,semester:Number(h.target.value)}),required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Code"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_code??"",onChange:h=>i({...n,course_code:h.target.value}),placeholder:"Optional"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Name"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_name||"",onChange:h=>i({...n,course_name:h.target.value}),required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"CAT"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.category||"",onChange:h=>i({...n,category:h.target.value}),placeholder:"e.g. CORE"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Class"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.class_type||"",onChange:h=>i({...n,class_type:h.target.value}),placeholder:"e.g. Theory"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"L"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.l||0,onChange:h=>i({...n,l:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"T"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.t||0,onChange:h=>i({...n,t:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"P"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.p||0,onChange:h=>i({...n,p:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"S"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.s||0,onChange:h=>i({...n,s:Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"C"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.c||0,onChange:h=>i({...n,c:Number(h.target.value)})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Internal Mark"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.internal_mark??"",onChange:h=>i({...n,internal_mark:h.target.value===""?"":Number(h.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"External Mark"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.external_mark??"",onChange:h=>i({...n,external_mark:h.target.value===""?"":Number(h.target.value)})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:h=>i({...n,for_all_departments:h.target.checked}),id:"forAllDepts",className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"forAllDepts",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"For All Departments"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Departments"}),n.for_all_departments?a.jsx("div",{className:"text-gray-600 text-xs sm:text-sm p-2 bg-gray-50 rounded-lg",children:"Applies to all departments"}):a.jsxs("div",{className:"max-h-32 overflow-y-auto p-2 border border-gray-300 rounded-lg bg-white",children:[l.length===0&&a.jsx("div",{className:"text-gray-400 text-xs",children:"No departments available"}),l.map(h=>a.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[a.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(h.id):!1,onChange:p=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(p.target.checked)m.includes(h.id)||m.push(h.id);else{const g=m.indexOf(h.id);g>=0&&m.splice(g,1)}i({...n,departments:m})},id:`dept-${h.id}`,className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsxs("label",{htmlFor:`dept-${h.id}`,className:"text-xs sm:text-sm text-gray-700",children:[h.code,"  ",h.name]})]},h.id))]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:h=>i({...n,editable:h.target.checked}),id:"editable",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"editable",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Editable"})]}),a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.is_elective,onChange:h=>i({...n,is_elective:h.target.checked}),id:"is_elective",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"is_elective",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Is Elective"})]})]}),u&&a.jsx("div",{className:"bg-green-100 text-green-800 px-3 py-1.5 rounded-lg font-semibold text-sm inline-block",children:u}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed text-sm",disabled:s,children:[a.jsx(nd,{className:"w-4 h-4"}),s?"Saving":"Save"]}),a.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors text-sm",onClick:()=>r("/curriculum/master"),children:[a.jsx(gu,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),f()},style:{background:"#fff",borderRadius:10,boxShadow:"0 2px 8px #e5e7eb",padding:32,maxWidth:700,margin:"0 auto",display:"grid",gap:22},autoComplete:"off",children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Regulation"}),a.jsx("input",{className:"input",value:n.regulation||"",onChange:h=>i({...n,regulation:h.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Semester"}),a.jsx("input",{className:"input",type:"number",min:1,value:n.semester||1,onChange:h=>i({...n,semester:Number(h.target.value)}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Code"}),a.jsx("input",{className:"input",value:n.course_code??"",onChange:h=>i({...n,course_code:h.target.value}),placeholder:"Optional",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Name"}),a.jsx("input",{className:"input",value:n.course_name||"",onChange:h=>i({...n,course_name:h.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"CAT"}),a.jsx("input",{className:"input",value:n.category||"",onChange:h=>i({...n,category:h.target.value}),placeholder:"e.g. CORE",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Class"}),a.jsxs("select",{className:"input",value:n.class_type||"",onChange:h=>i({...n,class_type:h.target.value}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4},children:[a.jsx("option",{value:"",children:"Select class type"}),Zp.map(h=>{const p=ti(String(h)),m=String(h).charAt(0).toUpperCase()+String(h).slice(1);return a.jsx("option",{value:p,children:m},p)})]})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"L"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.l||0,onChange:h=>i({...n,l:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"T"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.t||0,onChange:h=>i({...n,t:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"P"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.p||0,onChange:h=>i({...n,p:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"S"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.s||0,onChange:h=>i({...n,s:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"C"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.c||0,onChange:h=>i({...n,c:Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Internal Mark"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.internal_mark??"",onChange:h=>i({...n,internal_mark:h.target.value===""?"":Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"External Mark"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.external_mark??"",onChange:h=>i({...n,external_mark:h.target.value===""?"":Number(h.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:h=>i({...n,for_all_departments:h.target.checked}),id:"forAllDepts"}),a.jsx("label",{htmlFor:"forAllDepts",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"For All Departments"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Departments"}),n.for_all_departments?a.jsx("div",{style:{marginTop:6,color:"#6b7280"},children:"Applies to all departments"}):a.jsxs("div",{style:{marginTop:6,maxHeight:220,overflowY:"auto",padding:6,border:"1px solid #e5e7eb",borderRadius:6},children:[l.length===0&&a.jsx("div",{style:{color:"#9ca3af"},children:"No departments available"}),l.map(h=>a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[a.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(h.id):!1,onChange:p=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(p.target.checked)m.includes(h.id)||m.push(h.id);else{const g=m.indexOf(h.id);g>=0&&m.splice(g,1)}i({...n,departments:m})},id:`dept-${h.id}`}),a.jsxs("label",{htmlFor:`dept-${h.id}`,style:{marginBottom:0},children:[h.code,"  ",h.name]})]},h.id))]})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:h=>i({...n,editable:h.target.checked}),id:"editable"}),a.jsx("label",{htmlFor:"editable",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"Editable"})]}),u&&a.jsx("div",{style:{background:"#ecfccb",color:"#365314",padding:"8px 12px",borderRadius:8,fontWeight:600,display:"inline-block"},children:u}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:8},children:[a.jsx("button",{type:"submit",className:"btn-primary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},disabled:s,children:s?"Saving":"Save"}),a.jsx("button",{type:"button",className:"btn-secondary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},onClick:()=>r("/curriculum/master"),children:"Cancel"})]})]})]})}function mOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),i=e&&e.length?Array.from(new Set(e.map(U=>U.regulation))):[],s=e&&e.length?Array.from(new Set(e.map(U=>U.semester))).sort((U,G)=>U-G):[],[o,l]=x.useState(i.length===1?i[0]:i[0]??null),[c,u]=x.useState(s.length===1?s[0]:s[0]??null),d=e&&e.length?Array.from(new Set(e.map(U=>U.department.id))):[];x.useEffect(()=>{const U=e&&e.length?Array.from(new Set(e.map(re=>re.regulation))):[];U.length===1?l(U[0]):U.includes(o||"")||l(U[0]??null);const G=e&&e.length?Array.from(new Set(e.map(re=>re.semester))).sort((re,X)=>re-X):[];G.length===1?u(G[0]):G.includes(c||-1)||u(G[0]??null)},[e]),x.useEffect(()=>{bl().then(U=>t(U)).catch(console.error).finally(()=>n(!1))},[]);async function f(U){try{const G=await Dre(U.id,U);t(re=>re.map(X=>X.id===G.id?G:X)),p(null),alert("Row updated successfully")}catch(G){alert(String(G))}}const[h,p]=x.useState(null),m=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),g=Array.isArray(m)&&(m.includes("curriculum.department.approve")||m.includes("CURRICULUM_DEPARTMENT_APPROVE"));async function y(U,G){try{await $re(U,G);const re=await bl();t(re),alert("OK")}catch(re){alert(String(re))}}const[b,v]=x.useState(null);x.useEffect(()=>{d.length===1?v(d[0]):d.includes(b||-1)||v(d[0]??null)},[e]);const w=e.filter(U=>U.is_elective&&(!b||U.department.id===b)&&(!o||U.regulation===o)&&(!c||U.semester===c)),[S,k]=x.useState([]);x.useEffect(()=>{hm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0}).then(k).catch(()=>k([]))},[b,o,c,e]);const[j,A]=x.useState(!1),[L,P]=x.useState({parent:null,department_id:b||null,regulation:o||null,semester_id:c||null,course_code:"",course_name:"",class_type:"THEORY",category:"",is_elective:!0,l:0,t:0,p:0,s:0,c:0,internal_mark:null,external_mark:null,total_mark:null,total_hours:null,question_paper_type:"",editable:!1});function B(U){P(G=>({...G,parent:U.id,department_id:b||G.department_id,regulation:o||G.regulation,semester_id:c||G.semester_id,course_name:"",course_code:""})),A(!0)}async function E(){try{const U={...L};if(!U.parent)throw new Error("Parent curriculum id missing");U.course_code||delete U.course_code,U.course_name||delete U.course_name,await Ire(U);const G=await bl();t(G);const re=await hm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0});k(re),A(!1),alert("Elective subject added")}catch(U){alert(String(U))}}const[T,F]=x.useState(!1),[W,z]=x.useState(null);function se(U){z({...U}),F(!0)}async function de(){if(!(!W||!W.id))try{const U=await yr(`/api/curriculum/elective/${W.id}/`,{method:"PATCH",body:JSON.stringify(W)});if(!U.ok)throw new Error(await U.text());const G=await bl();t(G);const re=await hm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0});k(re),F(!1),alert("Elective updated")}catch(U){alert(String(U))}}return r?a.jsx(z1,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading department curriculum"})]})})}):a.jsx(z1,{children:a.jsxs("div",{className:"px-4 pb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 48 48",children:[a.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),a.jsx("path",{d:"M16 32V16h16v16H16zm2-2h12V18H18v12zm2-2v-8h8v8h-8z",fill:"#6366f1"})]})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Department Curriculum"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage department-specific curriculum entries."})]})]}),i.length>0&&a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),a.jsx("select",{value:o??"",onChange:U=>l(U.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:i.map(U=>a.jsx("option",{value:U,children:U},U))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),a.jsx("select",{value:c??"",onChange:U=>u(U.target.value?Number(U.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:s.map(U=>a.jsx("option",{value:U,children:U},U))})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(U=>{var C;const G=b===U,re=(C=e.find(K=>K.department.id===U))==null?void 0:C.department,X=(re==null?void 0:re.short_name)||(re==null?void 0:re.shortname)||(re==null?void 0:re.code)||(re==null?void 0:re.name)||`Dept ${U}`;return a.jsx("button",{onClick:()=>v(U),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${G?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:X},U)})})]}),a.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap min-w-[200px]",children:"Course"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Hours"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"QP Type"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(U=>(!b||U.department.id===b)&&(!o||U.regulation===o)&&(!c||U.semester===c)).map(U=>a.jsx("tr",{className:`hover:bg-gray-50 transition-colors ${U.editable?"bg-slate-50":""}`,children:h===U.id?a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:U.course_code||"",onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,course_code:G.target.value}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("textarea",{value:U.course_name||"",onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,course_name:G.target.value}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",style:{minHeight:"32px"},placeholder:"Course Name",rows:1,onInput:G=>{const re=G.target;re.style.height="32px",re.style.height=re.scrollHeight+"px"}})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:U.category||"",onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,category:G.target.value}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("select",{value:U.class_type||"THEORY",onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,class_type:G.target.value}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input",style:{minWidth:90},children:Zp.map(G=>{const re=ti(String(G)),X=String(G).charAt(0).toUpperCase()+String(G).slice(1).toLowerCase();return a.jsx("option",{value:re,children:X},re)})})}),a.jsx("td",{className:"px-3 py-2 text-center whitespace-nowrap",children:a.jsx("input",{type:"checkbox",checked:!!U.is_elective,onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,is_elective:G.target.checked}:X)),className:"w-4 h-4"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:U.l||0,onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,l:Number(G.target.value)}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:U.t||0,onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,t:Number(G.target.value)}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:U.p||0,onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,p:Number(G.target.value)}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:U.s||0,onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,s:Number(G.target.value)}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:U.c||0,onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,c:Number(G.target.value)}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:U.internal_mark||"",onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,internal_mark:Number(G.target.value)}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:U.external_mark||"",onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,external_mark:Number(G.target.value)}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:U.total_mark||"",onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,total_mark:Number(G.target.value)}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:U.total_hours||"",onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,total_hours:Number(G.target.value)}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:U.question_paper_type||"",onChange:G=>t(re=>re.map(X=>X.id===U.id?{...X,question_paper_type:G.target.value}:X)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:U.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsxs("td",{className:"px-3 py-2 whitespace-nowrap",children:[a.jsx("button",{className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors mr-2",onClick:()=>f(U),title:"Save",children:a.jsx(nd,{className:"w-4 h-4"})}),a.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>p(null),title:"Cancel",children:a.jsx(gu,{className:"w-4 h-4"})})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.course_code||"-"}),a.jsx("td",{className:"px-3 py-2.5 text-sm text-gray-900 font-medium",children:U.course_name||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.category||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.class_type||"-"}),a.jsx("td",{className:"px-3 py-2.5 text-center whitespace-nowrap text-sm",children:U.is_elective?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.l??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.t??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.p??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.s??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.c??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.external_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.total_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.total_hours??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.question_paper_type||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:U.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsxs("td",{className:"px-3 py-2.5 whitespace-nowrap",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[U.editable?a.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>p(U.id),title:"Edit",children:a.jsx(ch,{className:"w-4 h-4"})}):a.jsx("div",{className:"w-8 h-8"}),g&&U.approval_status==="PENDING"?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>y(U.id,"approve"),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Approve",children:a.jsx(Uee,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>y(U.id,"reject"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Reject",children:a.jsx(gu,{className:"w-4 h-4"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-8 h-8"}),a.jsx("div",{className:"w-8 h-8"})]})]}),a.jsxs("div",{className:"text-xs mt-1 text-gray-600",children:["Status: ",a.jsx("strong",{className:"text-gray-900",children:U.approval_status||"APPROVED"})]})]})]})},U.id))})]})}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Elective Options"}),w.length===0?a.jsx("div",{className:"text-gray-400 py-4",children:"No elective options for selected department/semester."}):a.jsx("div",{className:"space-y-6",children:w.map(U=>{const G=S.filter(re=>re.parent===U.id);return a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"text-lg font-bold text-gray-900",children:U.course_name||U.course_code||"Elective"}),a.jsx("button",{onClick:()=>B(U),className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Add Subject"})]}),a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Course"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Hours"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"QP Type"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:G.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:15,className:"px-3 py-4 text-gray-400 text-center",children:"No subjects added yet."})}):G.map(re=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.course_code||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.course_name||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.category||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.class_type||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.l??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.t??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.p??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.s??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.c??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.external_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.total_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.total_hours??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:re.question_paper_type||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:re.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("button",{onClick:()=>se(re),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:a.jsx(ch,{className:"w-4 h-4"})})]})})]},re.id))})]})})]},U.id)})})]}),j&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Add Elective Subject"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),a.jsx("input",{value:L.course_name||"",onChange:U=>P(G=>({...G,course_name:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),a.jsx("input",{value:L.course_code||"",onChange:U=>P(G=>({...G,course_code:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),a.jsxs("select",{value:L.class_type,onChange:U=>P(G=>({...G,class_type:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"THEORY",children:"THEORY"}),a.jsx("option",{value:"LAB",children:"LAB"}),a.jsx("option",{value:"TCPL",children:"TCPL"}),a.jsx("option",{value:"TCPR",children:"TCPR"}),a.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),a.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),a.jsx("input",{value:L.category||"",onChange:U=>P(G=>({...G,category:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),a.jsx("input",{type:"number",value:L.l??0,onChange:U=>P(G=>({...G,l:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),a.jsx("input",{type:"number",value:L.t??0,onChange:U=>P(G=>({...G,t:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),a.jsx("input",{type:"number",value:L.p??0,onChange:U=>P(G=>({...G,p:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),a.jsx("input",{type:"number",value:L.s??0,onChange:U=>P(G=>({...G,s:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),a.jsx("input",{type:"number",value:L.c??0,onChange:U=>P(G=>({...G,c:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),a.jsx("input",{type:"number",value:L.internal_mark??"",onChange:U=>P(G=>({...G,internal_mark:U.target.value?Number(U.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),a.jsx("input",{type:"number",value:L.external_mark??"",onChange:U=>P(G=>({...G,external_mark:U.target.value?Number(U.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),a.jsx("input",{type:"number",value:L.total_mark??"",onChange:U=>P(G=>({...G,total_mark:U.target.value?Number(U.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),a.jsx("input",{type:"number",value:L.total_hours??"",onChange:U=>P(G=>({...G,total_hours:U.target.value?Number(U.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),a.jsx("input",{value:L.question_paper_type||"",onChange:U=>P(G=>({...G,question_paper_type:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"add-editable",type:"checkbox",checked:!!L.editable,onChange:U=>P(G=>({...G,editable:U.target.checked})),className:"w-4 h-4"}),a.jsx("label",{htmlFor:"add-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),a.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})}),T&&W&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Edit Elective Subject"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),a.jsx("input",{value:W.course_name||"",onChange:U=>z(G=>({...G,course_name:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),a.jsx("input",{value:W.course_code||"",onChange:U=>z(G=>({...G,course_code:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),a.jsxs("select",{value:W.class_type||"THEORY",onChange:U=>z(G=>({...G,class_type:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"THEORY",children:"THEORY"}),a.jsx("option",{value:"LAB",children:"LAB"}),a.jsx("option",{value:"TCPL",children:"TCPL"}),a.jsx("option",{value:"TCPR",children:"TCPR"}),a.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),a.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),a.jsx("input",{value:W.category||"",onChange:U=>z(G=>({...G,category:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),a.jsx("input",{type:"number",value:W.l??0,onChange:U=>z(G=>({...G,l:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),a.jsx("input",{type:"number",value:W.t??0,onChange:U=>z(G=>({...G,t:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),a.jsx("input",{type:"number",value:W.p??0,onChange:U=>z(G=>({...G,p:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),a.jsx("input",{type:"number",value:W.s??0,onChange:U=>z(G=>({...G,s:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),a.jsx("input",{type:"number",value:W.c??0,onChange:U=>z(G=>({...G,c:Number(U.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),a.jsx("input",{type:"number",value:W.internal_mark??"",onChange:U=>z(G=>({...G,internal_mark:U.target.value?Number(U.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),a.jsx("input",{type:"number",value:W.external_mark??"",onChange:U=>z(G=>({...G,external_mark:U.target.value?Number(U.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),a.jsx("input",{type:"number",value:W.total_mark??"",onChange:U=>z(G=>({...G,total_mark:U.target.value?Number(U.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),a.jsx("input",{type:"number",value:W.total_hours??"",onChange:U=>z(G=>({...G,total_hours:U.target.value?Number(U.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),a.jsx("input",{value:W.question_paper_type||"",onChange:U=>z(G=>({...G,question_paper_type:U.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"edit-editable",type:"checkbox",checked:!!W.editable,onChange:U=>z(G=>({...G,editable:U.target.checked})),className:"w-4 h-4"}),a.jsx("label",{htmlFor:"edit-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>F(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),a.jsx("button",{onClick:de,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})})]})})}function gOe(){const[e,t]=x.useState(null),[r,n]=x.useState(!1),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[h,p]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState(""),[v,w]=x.useState([]),[S,k]=x.useState(!1);x.useEffect(()=>{j()},[h,m,y]),x.useEffect(()=>{A()},[]);const j=async()=>{k(!0);try{const F={};h&&(F.regulation=h),m&&(F.semester=m),y&&(F.department_id=y);const W=await hm(F);w(W||[])}catch(F){console.error("Failed to load electives:",F),w([])}finally{k(!1)}},A=async()=>{try{const F=await hm();if(!F||!Array.isArray(F))return;const W=[...new Set(F.map(de=>de.regulation))].filter(Boolean).sort(),z=[...new Set(F.map(de=>de.semester))].filter(Boolean).sort((de,U)=>de-U),se=Array.from(new Map(F.map(de=>de.department).filter(Boolean).map(de=>[de.id,de])).values()).sort((de,U)=>(de.code||"").localeCompare(U.code||""));l(W),u(z),f(se)}catch(F){console.error("Failed to load filter options:",F)}},L=async()=>{try{const F=await yr("/api/curriculum/elective-choices/template/");if(!F.ok){alert("Failed to download template");return}const W=await F.blob(),z=window.URL.createObjectURL(W),se=document.createElement("a");se.href=z,se.download="elective_choices_template.csv",document.body.appendChild(se),se.click(),window.URL.revokeObjectURL(z),document.body.removeChild(se)}catch(F){console.error("Download error:",F),alert("Failed to download template")}},P=async()=>{try{const F=await yr("/api/curriculum/elective-choices/template/?format=excel");if(!F.ok){alert("Failed to download Excel template");return}const W=await F.blob(),z=window.URL.createObjectURL(W),se=document.createElement("a");se.href=z,se.download="elective_choices_template.xlsx",document.body.appendChild(se),se.click(),window.URL.revokeObjectURL(z),document.body.removeChild(se)}catch(F){console.error("Download error:",F),alert("Failed to download Excel template")}},B=F=>{var z;const W=(z=F.target.files)==null?void 0:z[0];if(W){if(![".csv",".xlsx",".xls"].some(U=>W.name.toLowerCase().endsWith(U))){alert("Please select a CSV or Excel file (.csv, .xlsx, .xls)");return}t(W),s(null)}},E=async()=>{if(!e){alert("Please select a file first");return}n(!0),s(null);try{const F=new FormData;F.append("csv_file",e);const W=await yr("/api/curriculum/elective-choices/import/",{method:"POST",body:F});if(W.status===401){alert("Your session has expired. Please refresh the page and try again.");return}let z;try{z=await W.json()}catch(se){console.error("Failed to parse response:",se),alert("Import failed: Invalid response from server");return}if(W.ok){s(z),t(null);const se=document.getElementById("file-input");se&&(se.value=""),j()}else{const se=z.error||z.detail||z.message||"Import failed";alert(typeof se=="string"?se:"Import failed: "+JSON.stringify(se).substring(0,200))}}catch(F){console.error("Upload error:",F),alert("Failed to upload file. Please check your connection and try again.")}finally{n(!1)}},T=v.filter(F=>{var W;return!(h&&F.regulation!==h||m&&F.semester!==m||y&&((W=F.department)==null?void 0:W.id)!==y)});return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg",children:a.jsx(nte,{className:"h-6 w-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Elective Import"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Import student elective choices from CSV or Excel"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:L,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx(P4,{className:"h-5 w-5"}),"CSV Template"]}),a.jsxs("button",{onClick:P,className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white font-medium rounded-lg hover:bg-emerald-700 transition-colors",children:[a.jsx(P4,{className:"h-5 w-5"}),"Excel Template"]})]})]}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upload File"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{children:a.jsxs("label",{htmlFor:"file-input",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center",children:[a.jsx(M2,{className:"h-8 w-8 text-gray-400 mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:e?a.jsx("span",{className:"font-medium text-indigo-600",children:e.name}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"CSV or Excel files (.csv, .xlsx, .xls)"})]}),a.jsx("input",{id:"file-input",type:"file",className:"hidden",accept:".csv,.xlsx,.xls",onChange:B})]})}),a.jsxs("button",{onClick:E,disabled:!e||r,className:`w-full inline-flex items-center justify-center gap-2 px-6 py-3 font-medium rounded-lg transition-colors ${!e||r?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[a.jsx(M2,{className:"h-5 w-5"}),r?"Uploading...":"Upload and Import"]})]})]}),i&&a.jsx("div",{className:`rounded-lg shadow-sm p-6 mb-6 ${i.errors&&i.errors.length>0?"bg-yellow-50 border border-yellow-200":"bg-green-50 border border-green-200"}`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[i.errors&&i.errors.length>0?a.jsx(td,{className:"h-6 w-6 text-yellow-600 flex-shrink-0 mt-0.5"}):a.jsx(y3,{className:"h-6 w-6 text-green-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:`text-lg font-semibold mb-2 ${i.errors&&i.errors.length>0?"text-yellow-900":"text-green-900"}`,children:i.message}),a.jsxs("div",{className:`space-y-1 text-sm ${i.errors&&i.errors.length>0?"text-yellow-800":"text-green-800"}`,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Created:"})," ",i.created," entries"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Updated:"})," ",i.updated," entries"]}),i.errors&&i.errors.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("p",{className:"font-semibold text-red-700 mb-2",children:["Errors (",i.errors.length,"):"]}),a.jsx("ul",{className:"list-disc list-inside space-y-1 text-red-600 max-h-40 overflow-y-auto",children:i.errors.map((F,W)=>a.jsx("li",{className:"text-xs",children:F},W))})]})]})]})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(ote,{className:"h-5 w-5 text-gray-600"}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Elective Subjects"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Regulation"}),a.jsxs("select",{value:h,onChange:F=>p(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Regulations"}),o.map(F=>a.jsx("option",{value:F,children:F},F))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),a.jsxs("select",{value:m,onChange:F=>g(F.target.value?Number(F.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Semesters"}),c.map(F=>a.jsxs("option",{value:F,children:["Semester ",F]},F))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),a.jsxs("select",{value:y,onChange:F=>b(F.target.value?Number(F.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Departments"}),d.map(F=>a.jsxs("option",{value:F.id,children:[F.code," - ",F.short_name||F.name]},F.id))]})]})]}),S?a.jsx("div",{className:"text-center py-8 text-gray-600",children:"Loading electives..."}):T.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No electives found"}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Regulation"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Semester"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(ys,{className:"h-4 w-4"}),"Students"]})})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(F=>{var W;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:F.course_code||""}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:F.course_name||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:F.regulation||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:F.semester||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:((W=F.department)==null?void 0:W.code)||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${F.student_count>0?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-600"}`,children:F.student_count})})]},F.id)})})]})})]})]})})}function xOe(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const Mp=xOe();function sx(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function PK(){var be;const[e,t]=x.useState([]),[r,n]=x.useState("courses"),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState(!1),[h,p]=x.useState(1),[m,g]=x.useState("idle"),[y,b]=x.useState(null),[v,w]=x.useState([]),[S,k]=x.useState(null),[j,A]=x.useState(""),[L,P]=x.useState(""),[B,E]=x.useState(""),[T,F]=x.useState(""),[W,z]=x.useState(""),[se,de]=x.useState(!1),[U,G]=x.useState(null),[re,X]=x.useState(null),[C,K]=x.useState([]),[V,R]=x.useState(!1),[J,q]=x.useState(0),[Y,Q]=x.useState([]),[ie,le]=x.useState(null),[O,H]=x.useState(null),[ae,I]=x.useState(null);function Z(fe){try{if(typeof fe=="string"){let ge=fe;return!ge.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(ge)&&ge.length>100&&(ge=`data:image/png;base64,${ge.replace(/\s+/g,"")}`),ge}if(fe&&typeof fe=="object"){if(typeof fe.url=="string"&&fe.url)return fe.url;if(typeof fe.base64=="string"&&fe.base64)return fe.base64.startsWith("data:")?fe.base64:`data:image/png;base64,${fe.base64}`;if(fe.binary&&fe.binary instanceof Uint8Array){const ge=new Blob([fe.binary],{type:"image/png"});return URL.createObjectURL(ge)}}if(fe instanceof Uint8Array){const ge=new Blob([fe],{type:"image/png"});return URL.createObjectURL(ge)}return null}catch{return null}}x.useEffect(()=>{y0().then(fe=>s(fe)).catch(()=>s(null)),(async()=>{try{u(!0);const fe=await lc();Array.isArray(fe)&&l(fe)}catch(fe){console.warn("Failed to load teaching assignments",fe),l([])}finally{u(!1)}})(),(async()=>{try{const fe=await fetch(`${Mp}/api/obe/list-uploads`,{headers:{...sx()}});if(!fe.ok)return;const ge=await fe.json();Array.isArray(ge==null?void 0:ge.files)&&Q(ge.files||[])}catch{}})()},[]);const pe=x.useMemo(()=>i?i.faculty_id??i.staff_id??i.employee_id??i.id??null:null,[i]),Oe=fe=>{const ge=parseFloat(fe.replace(/[^0-9.\-]/g,""));return Number.isFinite(ge)?ge:0},Ae=fe=>{const ge=`/obe/course/${encodeURIComponent(fe)}`;window.location.href=ge},ke=x.useMemo(()=>(v||[]).filter(fe=>{const ge=String((fe==null?void 0:fe.marks)??"").trim().toUpperCase(),lt=String((fe==null?void 0:fe.btl)??"").trim().toUpperCase(),He=String((fe==null?void 0:fe.course_outcomes)??"").trim().toUpperCase();return!(ge==="(OR)"&&lt==="(OR)"&&He==="(OR)")}),[v]),[_e,De]=x.useState("idle"),[We,Ct]=x.useState(null);async function _t(fe){De("uploading"),Ct(null),g("idle"),b(null),G(null),X(null);const ge=new FormData;ge.append("file",fe);try{const lt=await fetch(`${Mp}/api/obe/upload-docx`,{method:"POST",headers:{...sx()},body:ge});if(!lt.ok){const xr=await lt.text();De("error"),Ct(xr||`Upload failed (${lt.status})`);return}const He=await lt.json();De("success");const mt=(He==null?void 0:He.file_url)||(He==null?void 0:He.saved_path)||"";k(mt||null),Ct(`Uploaded: ${mt}`),f(!0),p(1),w([]),g("scanning"),b("Scanning DOCX");const wt=new FormData;wt.append("file",fe);const Pt=await fetch(`${Mp}/api/template/scan-docx`,{method:"POST",headers:{...sx()},body:wt});if(!Pt.ok){const xr=await Pt.text();g("error"),b(xr||`Scan failed (${Pt.status})`),w([]);return}const bt=await Pt.json(),Tt=(Array.isArray(bt==null?void 0:bt.questions)?bt.questions:[]).map(xr=>({...xr,source_file_path:mt||xr.source_file_path||null}));if(w(Tt),g("success"),b(`Scanned ${Tt.length} question(s).`),!j.trim()){const xr=fe.name.replace(/\.docx$/i,"");A(xr)}}catch(lt){De("error"),Ct((lt==null?void 0:lt.message)||"Upload failed"),g("error"),b((lt==null?void 0:lt.message)||"Scan failed")}}function Xe(){f(!1),p(1)}async function nt(){if(!j.trim()){X("Exam name is required."),p(2);return}if(!B.trim()){X("Exam type is required."),p(2);return}if(!T.trim()){X("Exam date is required."),p(2);return}de(!0),X(null),G(null);try{const fe=W.split(/\r?\n/).map(wt=>wt.trim()).filter(Boolean),ge=ke.map(wt=>({...wt,excel_type:wt.excel_type||B,source_file_path:wt.source_file_path||S||null})),lt=await fetch(`${Mp}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...sx()},body:JSON.stringify({title:j.trim(),status:"pending",exam_type:B.trim(),exam_date:T.trim(),sections:fe,faculty_id:pe,questions:ge})});if(!lt.ok){const wt=await lt.text();X(wt||`Import failed (${lt.status})`);return}const He=await lt.json();G(He);const mt={title:j.trim(),inserted:He.inserted||0,failed:Array.isArray(He.failed)?He.failed.length:0,source_file_path:S||null,title_id:He.title_id||null,exam_date:T||null,exam_type:B||null,faculty_id:pe||null,created_at:new Date().toISOString()};K(wt=>[mt,...wt]),R(!0),setTimeout(()=>R(!1),4e3),setTimeout(()=>Xe(),600)}catch(fe){X((fe==null?void 0:fe.message)||"Import failed")}finally{de(!1)}}const Ne=e.length;return Ne&&(e.reduce((fe,ge)=>fe+Oe(ge.achieved),0)/Ne).toFixed(1)+"",a.jsxs("main",{className:"obe-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[a.jsx("header",{style:{marginBottom:32,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsx("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",width:"100%"},children:a.jsxs("div",{style:{textAlign:"left"},children:[a.jsx("h1",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:"Outcome Based Education (OBE)"}),a.jsx("div",{style:{marginTop:8,color:"#64748b",fontSize:16,fontWeight:400},children:"Select a course, then work through CDAP, Articulation Matrix and Mark Entry."})]})})}),a.jsxs("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)"},children:[a.jsx("button",{onClick:()=>n("courses"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="courses"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="courses"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="courses"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="courses"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Courses"}),a.jsx("button",{onClick:()=>n("exam"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="exam"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="exam"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="exam"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="exam"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Exam Management"})]}),r==="courses"&&a.jsxs("section",{"aria-label":"Course selector",style:{marginBottom:32},children:[a.jsx("div",{style:{fontSize:14,color:"#475569",marginBottom:20,fontWeight:500},children:"Select a course to work on:"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:24,marginBottom:32},children:c?a.jsx("div",{style:{gridColumn:"1/-1",color:"#64748b",fontSize:16,textAlign:"center",padding:60,background:"#fff",borderRadius:12},children:" Loading courses"}):o.length===0?a.jsxs("div",{style:{gridColumn:"1/-1",color:"#94a3b8",fontSize:18,textAlign:"center",padding:60,background:"#fff",borderRadius:12,border:"2px dashed #e2e8f0"},children:[" No courses found. You have no teaching assignments.",a.jsx("br",{}),a.jsx("span",{style:{fontSize:14,marginTop:12,display:"block"},children:"(If you expect to see courses here, please check with your backend/API or contact admin.)"})]}):o.reduce((fe,ge)=>(fe.some(lt=>lt.subject_code===ge.subject_code)||fe.push(ge),fe),[]).map(fe=>a.jsxs("div",{onClick:()=>Ae(fe.subject_code),role:"button",tabIndex:0,onKeyDown:ge=>{ge.key==="Enter"&&Ae(fe.subject_code)},onMouseEnter:ge=>{ge.currentTarget.style.transform="translateY(-4px)",ge.currentTarget.style.boxShadow="0 12px 24px rgba(0,0,0,0.1), 0 4px 8px rgba(0,0,0,0.06)",ge.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:ge=>{ge.currentTarget.style.transform="translateY(0)",ge.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",ge.currentTarget.style.borderColor="#e2e8f0"},style:{border:"1px solid #e2e8f0",borderRadius:12,padding:24,background:"#fff",boxShadow:"0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"flex-start",minHeight:140,position:"relative",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer"},children:[a.jsx("div",{style:{fontWeight:700,fontSize:19,marginBottom:6,color:"#0f172a",lineHeight:1.3},children:fe.subject_name}),a.jsx("div",{style:{fontSize:14,color:"#3b82f6",marginBottom:16,fontWeight:600,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:fe.subject_code}),a.jsxs("div",{style:{marginTop:"auto",display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("button",{onClick:ge=>{ge.stopPropagation(),Ae(fe.subject_code)},onMouseEnter:ge=>{ge.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)",ge.currentTarget.style.transform="scale(1.05)"},onMouseLeave:ge=>{ge.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",ge.currentTarget.style.transform="scale(1)"},style:{padding:"8px 18px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:"0 2px 4px rgba(37,99,235,0.2)",transition:"all 0.2s ease"},children:"Open Course"}),a.jsx("button",{onClick:ge=>{ge.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(fe.subject_code)}/lca`},onMouseEnter:ge=>{ge.currentTarget.style.background="#f8fafc",ge.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:ge=>{ge.currentTarget.style.background="#fff",ge.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"LCA"}),a.jsx("button",{onClick:ge=>{ge.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(fe.subject_code)}/co_attainment`},onMouseEnter:ge=>{ge.currentTarget.style.background="#f8fafc",ge.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:ge=>{ge.currentTarget.style.background="#fff",ge.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"CO"})]})]},fe.subject_code))})]}),r==="exam"&&a.jsx("section",{"aria-label":"Exam management",style:{background:"#fff",padding:28,borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[a.jsx("div",{style:{background:"#f8fafc",padding:20,borderRadius:12,border:"2px dashed #cbd5e1"},children:a.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center"},children:[a.jsx("input",{id:"exam-upload-input",type:"file",accept:".docx",style:{display:"none"},onChange:fe=>{const ge=fe.target.files&&fe.target.files[0];ge&&_t(ge),fe.currentTarget.value=""}}),a.jsx("label",{htmlFor:"exam-upload-input",style:{display:"inline-flex",alignItems:"center",gap:10,padding:"12px 20px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",borderRadius:10,cursor:"pointer",fontWeight:600,fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:_e==="uploading"?" Uploading...":" Upload .docx"}),a.jsx("div",{style:{color:"#64748b",fontSize:14},children:"Upload exam spreadsheets or related files here."})]})}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("input",{type:"search",placeholder:" Search exams, courses, entries...",style:{flex:1,padding:"12px 16px",borderRadius:10,border:"1px solid #e2e8f0",fontSize:15,background:"#fff",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},onChange:()=>{}}),a.jsx("button",{style:{padding:"12px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#475569",transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:"Search"})]}),a.jsxs("div",{style:{marginTop:8},children:[a.jsx("h3",{style:{margin:"12px 0 16px 0",fontSize:18,fontWeight:700,color:"#0f172a"},children:" Recent"}),C.length===0?a.jsxs("div",{style:{color:"#666"},children:[a.jsx("div",{style:{marginBottom:8,fontSize:13},children:"Uploaded DOCX files"}),Y.length===0?a.jsx("div",{style:{color:"#666"},children:"No uploaded DOCX files found."}):a.jsx("div",{style:{display:"grid",gap:8},children:Y.map((fe,ge)=>a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700},children:fe.name}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:fe.path})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>le(fe),style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",padding:6},children:"Open"})})]},ge))})]}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr",gap:12},children:[a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:C.slice(0,12).map((fe,ge)=>{const lt=ge===J;return a.jsxs("div",{onClick:()=>q(ge),role:"button",tabIndex:0,style:{border:lt?"2px solid #2563eb":"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[a.jsx("path",{d:"M6 2h7l5 5v13a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1z",fill:"#e6f0ff",stroke:"#2563eb",strokeWidth:"0.5"}),a.jsx("path",{d:"M13 2v6h6",fill:"#fff"}),a.jsx("rect",{x:"7",y:"11",width:"10",height:"2.2",rx:"0.6",fill:"#2563eb"}),a.jsx("rect",{x:"7",y:"14",width:"6",height:"2.2",rx:"0.6",fill:"#2563eb"}),a.jsx("text",{x:"7",y:"18.8",fontSize:"2.8",fill:"#2563eb",fontFamily:"Arial, Helvetica, sans-serif",children:"DOCX"})]}),a.jsx("div",{style:{fontWeight:700},children:fe.title})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[fe.exam_type||"","  ",fe.exam_date||""]})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontWeight:800,color:"#16a34a"},children:fe.inserted}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"questions"})]})]},ge)})}),a.jsx("div",{children:C[J]&&a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Preview"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:12},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():"U"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#111827"},children:pe??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Course details"}),a.jsx("div",{style:{fontWeight:700},children:""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""}),a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:["Assignments: ",a.jsx("strong",{style:{color:"#111827"},children:""})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Questions imported"}),a.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:C[J].inserted})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Title"}),a.jsx("div",{style:{fontWeight:700},children:C[J].title||""}),a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Assessment"}),a.jsx("div",{style:{fontWeight:700},children:C[J].exam_type||""})]})]}),a.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam Type"}),a.jsx("div",{style:{fontWeight:700},children:C[J].exam_type||""})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam date"}),a.jsx("div",{style:{fontWeight:700},children:C[J].exam_date||""})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Uploaded file"}),a.jsx("div",{style:{fontWeight:700,whiteSpace:"pre-wrap"},children:C[J].source_file_path||""})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Questions preview"}),a.jsx("div",{children:a.jsx("button",{onClick:async()=>{var fe,ge;H(null);try{const lt=(fe=C[J])==null?void 0:fe.title_id;let He="";lt?He=`${Mp}/api/import/questions/list?title_id=${lt}`:He=`${Mp}/api/import/questions/list?title=${encodeURIComponent(((ge=C[J])==null?void 0:ge.title)||"")}`;const mt=await fetch(He,{headers:{...sx()}});if(!mt.ok){H([]);return}const wt=await mt.json();H(Array.isArray(wt==null?void 0:wt.questions)?wt.questions:[])}catch{H([])}},style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Load questions"})})]}),a.jsx("div",{style:{maxHeight:220,overflow:"auto"},children:O===null?a.jsx("div",{style:{color:"#6b7280"},children:'Click "Load questions" to fetch saved questions for this import.'}):O.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No saved questions found for this title."}):O.slice(0,20).map((fe,ge)=>a.jsxs("div",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:[a.jsxs("div",{style:{fontWeight:700,color:"#111827"},children:[ge+1,"."]}),a.jsx("div",{style:{color:"#111827"},children:String(fe.question_text).slice(0,300)})]},ge))})]})]})]})]})})]})]}),We&&a.jsx("div",{style:{marginTop:12,fontSize:14,color:_e==="error"?"#dc2626":"#16a34a",background:_e==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${_e==="error"?"#fecaca":"#bbf7d0"}`},children:We})]})}),d&&a.jsx("div",{role:"dialog","aria-modal":"true",onClick:Xe,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:a.jsxs("div",{onClick:fe=>fe.stopPropagation(),style:{width:"min(1000px, 100%)",background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.3)",overflow:"hidden",border:"1px solid #e2e8f0"},children:[a.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#0f172a"},children:" Question Import"}),a.jsxs("div",{style:{color:"#64748b",fontSize:14,marginTop:4},children:["Step ",h," of 3  ",m==="scanning"?"Scanning":m==="error"?"Scan failed":"Ready"]})]}),a.jsx("button",{onClick:Xe,onMouseEnter:fe=>{fe.currentTarget.style.background="#fee2e2"},onMouseLeave:fe=>{fe.currentTarget.style.background="#fff"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#64748b",transition:"all 0.2s ease"},children:" Close"})]}),a.jsx("div",{style:{overflow:"hidden",background:"#fafbfc"},children:a.jsxs("div",{style:{display:"flex",width:"300%",transform:`translateX(-${(h-1)*33.3333333}%)`,transition:"transform 360ms cubic-bezier(0.4, 0, 0.2, 1)"},children:[a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,marginBottom:16},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#0f172a"},children:" Preview"}),a.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:S?`Source: ${S}`:"Source: (not available)"})]}),a.jsxs("div",{style:{fontSize:14,color:"#0f172a",background:"#eff6ff",padding:"6px 12px",borderRadius:8,fontWeight:600},children:["Questions: ",a.jsx("b",{style:{color:"#3b82f6"},children:ke.length})]})]}),y&&a.jsx("div",{style:{marginBottom:12,fontSize:14,color:m==="error"?"#dc2626":"#16a34a",background:m==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${m==="error"?"#fecaca":"#bbf7d0"}`},children:y}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,maxHeight:420,overflow:"auto",background:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[m==="scanning"&&a.jsx("div",{style:{color:"#64748b",textAlign:"center",padding:40},children:" Scanning your DOCX"}),m!=="scanning"&&ke.length===0&&a.jsx("div",{style:{color:"#94a3b8",textAlign:"center",padding:40},children:" No questions to preview yet."}),ke.map((fe,ge)=>a.jsxs("div",{style:{padding:"14px 12px",borderBottom:ge<ke.length-1?"1px solid #f1f5f9":"none"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10,marginBottom:8},children:[a.jsxs("div",{style:{fontWeight:700,color:"#3b82f6",fontSize:15,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:["Q",ge+1]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",background:"#f8fafc",padding:"4px 10px",borderRadius:6},children:["Marks: ",String((fe==null?void 0:fe.marks)??"-")," "," BTL: ",String((fe==null?void 0:fe.btl)??"-")," "," CO: ",String((fe==null?void 0:fe.course_outcomes)??"-")]})]}),a.jsxs("div",{style:{marginTop:8,color:"#1e293b",whiteSpace:"pre-wrap",fontSize:14,lineHeight:1.6},children:[String((fe==null?void 0:fe.question_text)??"").slice(0,500),String((fe==null?void 0:fe.question_text)??"").length>500?"":""]}),Array.isArray(fe==null?void 0:fe.images)&&fe.images.length?a.jsx("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:fe.images.slice(0,4).map((lt,He)=>{const mt=Z(lt);return mt?a.jsx("img",{src:mt,alt:`q${ge+1}-img${He+1}`,onClick:()=>I(mt),style:{maxHeight:140,borderRadius:10,border:"2px solid #e2e8f0",cursor:"pointer",objectFit:"contain",background:"#fff",transition:"all 0.2s ease",boxShadow:"0 2px 6px rgba(0,0,0,0.08)"}},He):null})}):null]},ge))]})]}),a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Save details"}),re&&a.jsx("div",{style:{marginBottom:12,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:re}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam name"}),a.jsx("input",{value:j,onChange:fe=>A(fe.target.value),placeholder:"e.g., Unit 1 - Introduction",style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",boxShadow:"inset 0 1px 2px #00000008"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam (CIA / Model / ESE)"}),a.jsxs("select",{value:L,onChange:fe=>P(fe.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[a.jsx("option",{value:"",children:"Select assessment"}),a.jsx("option",{value:"CIA1",children:"CIA1"}),a.jsx("option",{value:"CIA2",children:"CIA2"}),a.jsx("option",{value:"MODEL",children:"MODEL"}),a.jsx("option",{value:"ESE",children:"ESE"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam Type"}),a.jsxs("select",{value:B,onChange:fe=>E(fe.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[a.jsx("option",{value:"",children:"Select paper"}),a.jsx("option",{value:"QP1",children:"QP1"}),a.jsx("option",{value:"QP2",children:"QP2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam date"}),a.jsx("input",{type:"date",value:T,onChange:fe=>F(fe.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8"}})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Sections"}),a.jsx("textarea",{value:W,onChange:fe=>z(fe.target.value),placeholder:"e.g., Part A\\nPart B\\nSection 1",rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",resize:"vertical"}})]})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"This metadata is shown for confirmation. (Currently, only the exam name is used as the imported title.)"})]}),a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Confirmation"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:16},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:10,background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#3b82f6",fontSize:24},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():""}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#0f172a"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#64748b"},children:"Faculty"})]})]}),a.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569",background:"#f8fafc",padding:"8px 12px",borderRadius:8},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#0f172a"},children:pe??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",marginBottom:10,fontWeight:600},children:" Course details"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:""}),a.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:""}),a.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569"},children:["Assignments: ",a.jsx("strong",{style:{color:"#0f172a"},children:""})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:16,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Questions to import"}),a.jsx("div",{style:{fontSize:28,fontWeight:900,color:"#3b82f6",marginTop:4},children:ke.length})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Exam name"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",fontSize:16,marginTop:2},children:j||""}),a.jsx("div",{style:{marginTop:8,fontSize:13,color:"#64748b",fontWeight:600},children:"Assessment"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:2},children:L||""})]})]}),a.jsxs("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,background:"#f8fafc",padding:12,borderRadius:8},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam Type"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:B||""})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam date"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:T||""})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Sections"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",whiteSpace:"pre-wrap",marginTop:4},children:W||""})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:10,fontWeight:600},children:" Questions preview"}),a.jsx("div",{style:{maxHeight:240,overflow:"auto"},children:ke.slice(0,10).map((fe,ge)=>a.jsxs("div",{style:{padding:"10px 8px",borderBottom:ge<Math.min(ke.length,10)-1?"1px solid #f1f5f9":"none",display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{fontWeight:700,color:"#3b82f6",minWidth:40,background:"#eff6ff",padding:"4px 8px",borderRadius:6,textAlign:"center"},children:ge+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"#1e293b",fontSize:14,lineHeight:1.5},children:String(fe.question_text).slice(0,260)}),Array.isArray(fe.images)&&fe.images.length?a.jsx("div",{style:{display:"flex",gap:10,marginTop:8},children:fe.images.slice(0,2).map((lt,He)=>{const mt=Z(lt);return mt?a.jsx("img",{src:mt,style:{width:90,height:70,objectFit:"cover",borderRadius:8,border:"2px solid #e2e8f0",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>I(mt)},He):null})}):null]})]},ge))})]})]})]}),re&&a.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:[" ",re]}),U&&a.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#16a34a",background:"#f0fdf4",padding:"12px 16px",borderRadius:10,border:"1px solid #bbf7d0"},children:[" Imported ",U.inserted," question(s)",(be=U.failed)!=null&&be.length?`, failed ${U.failed.length}.`:"."]})]})]})}),a.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,background:"#fafbfc"},children:[a.jsx("button",{onClick:()=>p(fe=>fe===1?1:fe-1),disabled:h===1,onMouseEnter:fe=>{h!==1&&(fe.currentTarget.style.background="#f8fafc")},onMouseLeave:fe=>{h!==1&&(fe.currentTarget.style.background="#fff")},style:{padding:"10px 18px",borderRadius:10,border:"1px solid #e2e8f0",background:h===1?"#f1f5f9":"#fff",cursor:h===1?"not-allowed":"pointer",fontWeight:600,fontSize:14,color:h===1?"#94a3b8":"#475569",transition:"all 0.2s ease"},children:" Back"}),a.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:h<3?a.jsx("button",{onClick:()=>{if(X(null),h===2){if(!j.trim()){X("Exam name is required.");return}if(!B.trim()){X("Exam type is required.");return}if(!T.trim()){X("Exam date is required.");return}}p(fe=>fe+1)},disabled:h===1&&m==="scanning",onMouseEnter:fe=>{h===1&&m==="scanning"||(fe.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)")},onMouseLeave:fe=>{h===1&&m==="scanning"||(fe.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:700,cursor:"pointer",fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:"Next "}):a.jsx("button",{onClick:nt,disabled:se||m==="scanning"||ke.length===0,onMouseEnter:fe=>{!se&&m!=="scanning"&&ke.length>0&&(fe.currentTarget.style.background="linear-gradient(135deg, #15803d 0%, #166534 100%)")},onMouseLeave:fe=>{!se&&m!=="scanning"&&ke.length>0&&(fe.currentTarget.style.background="linear-gradient(135deg, #16a34a 0%, #15803d 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:se?"#cbd5e1":"linear-gradient(135deg, #16a34a 0%, #15803d 100%)",color:"#fff",fontWeight:800,fontSize:15,cursor:se?"not-allowed":"pointer",boxShadow:se?"none":"0 2px 8px rgba(22,163,74,0.25)",transition:"all 0.2s ease"},children:se?" Importing":" Confirm & Import"})})]})]})}),ae&&a.jsx("div",{role:"dialog",onClick:()=>{I(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80},children:a.jsx("div",{onClick:fe=>fe.stopPropagation(),style:{maxWidth:"95%",maxHeight:"95%",padding:16,background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.5)"},children:a.jsx("img",{src:ae,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:12}})})}),ie&&a.jsx("div",{role:"dialog",onClick:()=>{le(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80,padding:16},children:a.jsxs("div",{onClick:fe=>fe.stopPropagation(),style:{width:"min(900px, 100%)",background:"#fff",borderRadius:12,boxShadow:"0 12px 40px rgba(0,0,0,0.25)",overflow:"hidden",border:"1px solid #e5e7eb"},children:[a.jsxs("div",{style:{padding:"14px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:800,fontSize:16},children:"Uploaded file preview"}),a.jsxs("div",{style:{color:"#6b7280",fontSize:12},children:["Preview of uploaded DOCX  ",ie.name]})]}),a.jsx("button",{onClick:()=>le(null),style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Close"})]}),a.jsx("div",{style:{padding:16},children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:12},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():"U"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#111827"},children:pe??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"File details"}),a.jsx("div",{style:{fontWeight:700},children:ie.name}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:ie.path}),a.jsx("div",{style:{marginTop:8},children:a.jsx("a",{href:ie.url,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:"Download file"})})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded file"}),a.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:ie.name})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded path"}),a.jsx("div",{style:{fontWeight:700},children:ie.path})]})]}),a.jsx("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr",gap:10},children:a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Notes"}),a.jsx("div",{style:{fontWeight:700},children:"This preview shows file metadata. Open the file to view full content or import to parse questions."})]})})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Importer preview"}),a.jsx("div",{style:{maxHeight:260,overflow:"auto"},children:a.jsx("div",{style:{color:"#6b7280"},children:"To see a full questions preview, upload and scan this DOCX using the importer  then the Step 3 confirmation contains the parsed question list."})})]})]})]})})]})}),V&&a.jsx("div",{style:{position:"fixed",left:24,bottom:24,zIndex:120,animation:"slideIn 0.3s ease"},children:a.jsxs("div",{style:{background:"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)",color:"#065f46",border:"1px solid #6ee7b7",padding:"16px 20px",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:[a.jsx("div",{style:{fontWeight:800,fontSize:16,marginBottom:4},children:" Imported"}),a.jsxs("div",{style:{fontSize:14,color:"#047857"},children:[(U==null?void 0:U.inserted)??0," question(s) imported successfully."]})]})})]})}const Hu=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function km(e){let t=0,r=0;for(const n of e||[]){const i=Number(n.max||0);n.co==="1&2"?(t+=i/2,r+=i/2):n.co===2?r+=i:t+=i}return{co1:t,co2:r}}function W1(e){const t={1:0,2:0,3:0,4:0,5:0,6:0};for(const r of e||[]){const n=String(r.btl);n in t&&(t[n]+=Number(r.max||0))}return t}function _v(e){var d,f;const t=km(e.prevQuestions),r=km(e.nextQuestions),n=W1(e.prevQuestions),i=W1(e.nextQuestions),s=Number((d=e.existingCoMax)==null?void 0:d.co1),o=Number((f=e.existingCoMax)==null?void 0:f.co2),l=!Number.isFinite(s)||s===t.co1?r.co1:Math.max(0,s),c=!Number.isFinite(o)||o===t.co2?r.co2:Math.max(0,o),u={...i};return["1","2","3","4","5","6"].forEach(h=>{var m;const p=Number((m=e.existingBtlMax)==null?void 0:m[h]);Number.isFinite(p)&&p!==n[h]&&(u[h]=Math.max(0,p))}),{coMax:{co1:l,co2:c},btlMax:u}}const wj={termLabel:"KRCT AY25-26",assessments:{ssa1:{maxTotal:20,coMax:{co1:10,co2:10},btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},formative1:{maxPart:5,maxTotal:20,maxCo:10,btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},cia1:{questions:Hu,coMax:km(Hu),btlMax:W1(Hu)}}},yOe=Array.from({length:11},(e,t)=>`PO${t+1}`);function bOe(e,t){const r=Oc(t),n=e==null?void 0:e[r];return Array.isArray(n)&&n.length===11?n:Array.from({length:11},()=>!1)}function vOe(){var L,P,B,E,T,F,W,z,se,de,U,G,re,X,C,K,V,R,J,q;const[e,t]=x.useState({}),[r,n]=x.useState(wj),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState("assessments"),[d,f]=x.useState({}),[h,p]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState("");x.useEffect(()=>{let Y=!0;return(async()=>{try{const Q=await C3();Y&&t(Q||{})}catch(Q){Y&&l((Q==null?void 0:Q.message)||"Failed to load global mapping")}})(),()=>{Y=!1}},[]),x.useEffect(()=>{let Y=!0;return(async()=>{var Q,ie,le,O,H,ae,I;try{const Z=await vu();if(!Y)return;const pe={...wj,...Z||{},assessments:{...wj.assessments||{},...(Z==null?void 0:Z.assessments)||{}}},Oe=((ie=(Q=pe.assessments)==null?void 0:Q.cia1)==null?void 0:ie.questions)||[],Ae=Array.isArray(Oe)&&Oe.length?Oe:Hu,ke=km(Ae),_e=W1(Ae),De=(O=(le=pe.assessments)==null?void 0:le.cia1)==null?void 0:O.coMax,We=Number(De==null?void 0:De.co1),Ct=Number(De==null?void 0:De.co2),_t=(ae=(H=pe.assessments)==null?void 0:H.cia1)==null?void 0:ae.btlMax,Xe=nt=>{const Ne=Number(_t==null?void 0:_t[nt]);return Number.isFinite(Ne)?Math.max(0,Ne):_e[nt]};pe.assessments={...pe.assessments||{},cia1:{...((I=pe.assessments)==null?void 0:I.cia1)||{},questions:Ae,coMax:{co1:Number.isFinite(We)?Math.max(0,We):ke.co1,co2:Number.isFinite(Ct)?Math.max(0,Ct):ke.co2},btlMax:{1:Xe("1"),2:Xe("2"),3:Xe("3"),4:Xe("4"),5:Xe("5"),6:Xe("6")}}},n(pe)}catch(Z){Y&&l((Z==null?void 0:Z.message)||"Failed to load assessment master config")}})(),()=>{Y=!1}},[]);const v=x.useMemo(()=>Bm.map(Y=>({label:Y,key:Oc(Y),values:bOe(e,Y)})),[e]),w=(Y,Q,ie)=>{const le=Oc(Y);t(O=>{const H=Array.isArray(O==null?void 0:O[le])?[...O[le]]:Array.from({length:11},()=>!1);return H[Q]=ie,{...O,[le]:H}})},S=async()=>{s(!0),l(null);try{c==="po"?(await U9(e),l("Saved global mapping.")):(await Zre(r),l("Saved assessment master config."))}catch(Y){l((Y==null?void 0:Y.message)||"Failed to save global mapping")}finally{s(!1)}},k=x.useMemo(()=>{var Q,ie;const Y=(ie=(Q=r==null?void 0:r.assessments)==null?void 0:Q.cia1)==null?void 0:ie.questions;return Array.isArray(Y)&&Y.length?Y:Hu},[r]),j=x.useMemo(()=>k.filter(Y=>d[Y.key]),[k,d]),A=()=>{j.length&&n(Y=>{var O,H,ae,I,Z,pe,Oe;const Q=(((H=(O=Y.assessments)==null?void 0:O.cia1)==null?void 0:H.questions)||Hu).slice(),ie=Q.map(Ae=>{if(!d[Ae.key])return Ae;const ke={...Ae};return h!==""&&Number.isFinite(Number(h))&&(ke.max=Math.max(0,Number(h))),(m==="1"||m==="2")&&(ke.co=Number(m)),m==="1&2"&&(ke.co="1&2"),y&&["1","2","3","4","5","6"].includes(y)&&(ke.btl=Number(y)),ke}),le=_v({prevQuestions:Q,nextQuestions:ie,existingCoMax:(I=(ae=Y.assessments)==null?void 0:ae.cia1)==null?void 0:I.coMax,existingBtlMax:(pe=(Z=Y.assessments)==null?void 0:Z.cia1)==null?void 0:pe.btlMax});return{...Y,assessments:{...Y.assessments||{},cia1:{...((Oe=Y.assessments)==null?void 0:Oe.cia1)||{},questions:ie,coMax:le.coMax,btlMax:le.btlMax}}}})};return a.jsx("main",{className:"obe-master-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:a.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("h2",{style:{margin:0},children:"OBE Master"}),a.jsx("div",{style:{color:"#666",marginTop:4},children:"Global settings for OBE pages"})]}),a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"},children:[a.jsx("button",{onClick:()=>u("assessments"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="assessments"?"#111827":"#fff",color:c==="assessments"?"#fff":"#111827"},children:"Assessment Headers"}),a.jsx("button",{onClick:()=>u("po"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="po"?"#111827":"#fff",color:c==="po"?"#fff":"#111827"},children:"Active Learning PO Mapping"})]}),o&&a.jsx("div",{style:{marginBottom:12,fontSize:12,color:o.startsWith("Saved")?"#166534":"#b91c1c"},children:o}),c==="po"?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"left",background:"#f8fafc"},children:"Activity"}),yOe.map(Y=>a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"center",background:"#fff7ed"},children:Y},Y))]})}),a.jsx("tbody",{children:v.map((Y,Q)=>a.jsxs("tr",{style:{background:Q%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,fontWeight:600},children:Y.label}),Y.values.map((ie,le)=>a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!ie,onChange:O=>w(Y.label,le,O.target.checked)})},`${Y.key}-${le}`))]},Y.key))})]})}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Global Term Label"}),a.jsx("input",{value:r.termLabel??"",onChange:Y=>n(Q=>({...Q,termLabel:Y.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db",width:260}})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"SSA1 Headers"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:12},children:["Total Max",a.jsx("input",{type:"number",value:String(((P=(L=r.assessments)==null?void 0:L.ssa1)==null?void 0:P.maxTotal)??20),onChange:Y=>n(Q=>{var ie;return{...Q,assessments:{...Q.assessments||{},ssa1:{...((ie=Q.assessments)==null?void 0:ie.ssa1)||{},maxTotal:Number(Y.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO1 Max",a.jsx("input",{type:"number",value:String(((T=(E=(B=r.assessments)==null?void 0:B.ssa1)==null?void 0:E.coMax)==null?void 0:T.co1)??10),onChange:Y=>n(Q=>{var ie,le,O;return{...Q,assessments:{...Q.assessments||{},ssa1:{...((ie=Q.assessments)==null?void 0:ie.ssa1)||{},coMax:{...((O=(le=Q.assessments)==null?void 0:le.ssa1)==null?void 0:O.coMax)||{},co1:Number(Y.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO2 Max",a.jsx("input",{type:"number",value:String(((z=(W=(F=r.assessments)==null?void 0:F.ssa1)==null?void 0:W.coMax)==null?void 0:z.co2)??10),onChange:Y=>n(Q=>{var ie,le,O;return{...Q,assessments:{...Q.assessments||{},ssa1:{...((ie=Q.assessments)==null?void 0:ie.ssa1)||{},coMax:{...((O=(le=Q.assessments)==null?void 0:le.ssa1)==null?void 0:O.coMax)||{},co2:Number(Y.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Formative 1 Headers"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:12},children:["Part Max",a.jsx("input",{type:"number",value:String(((de=(se=r.assessments)==null?void 0:se.formative1)==null?void 0:de.maxPart)??5),onChange:Y=>n(Q=>{var ie;return{...Q,assessments:{...Q.assessments||{},formative1:{...((ie=Q.assessments)==null?void 0:ie.formative1)||{},maxPart:Number(Y.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["Total Max",a.jsx("input",{type:"number",value:String(((G=(U=r.assessments)==null?void 0:U.formative1)==null?void 0:G.maxTotal)??20),onChange:Y=>n(Q=>{var ie;return{...Q,assessments:{...Q.assessments||{},formative1:{...((ie=Q.assessments)==null?void 0:ie.formative1)||{},maxTotal:Number(Y.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO Max",a.jsx("input",{type:"number",value:String(((X=(re=r.assessments)==null?void 0:re.formative1)==null?void 0:X.maxCo)??10),onChange:Y=>n(Q=>{var ie;return{...Q,assessments:{...Q.assessments||{},formative1:{...((ie=Q.assessments)==null?void 0:ie.formative1)||{},maxCo:Number(Y.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:10},children:"CIA 1"}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"stretch",marginBottom:12},children:[a.jsxs("div",{style:{flex:"1 1 360px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fbfdff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"CIA1 Limits"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:10},children:[a.jsxs("label",{style:{fontSize:12},children:["CO-1 Max",a.jsx("input",{type:"number",value:String(((V=(K=(C=r.assessments)==null?void 0:C.cia1)==null?void 0:K.coMax)==null?void 0:V.co1)??km(k).co1),onChange:Y=>n(Q=>{var ie,le,O;return{...Q,assessments:{...Q.assessments||{},cia1:{...((ie=Q.assessments)==null?void 0:ie.cia1)||{},coMax:{...(O=(le=Q.assessments)==null?void 0:le.cia1)==null?void 0:O.coMax,co1:Math.max(0,Number(Y.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO-2 Max",a.jsx("input",{type:"number",value:String(((q=(J=(R=r.assessments)==null?void 0:R.cia1)==null?void 0:J.coMax)==null?void 0:q.co2)??km(k).co2),onChange:Y=>n(Q=>{var ie,le,O;return{...Q,assessments:{...Q.assessments||{},cia1:{...((ie=Q.assessments)==null?void 0:ie.cia1)||{},coMax:{...(O=(le=Q.assessments)==null?void 0:le.cia1)==null?void 0:O.coMax,co2:Math.max(0,Number(Y.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]})]}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"BTL Max Marks (1 to 6)"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, minmax(70px, 1fr))",gap:8},children:["1","2","3","4","5","6"].map(Y=>{var Q,ie,le;return a.jsxs("label",{style:{fontSize:12,display:"flex",flexDirection:"column",gap:4},children:[a.jsxs("span",{style:{color:"#111827"},children:["BTL-",Y]}),a.jsx("input",{type:"number",value:String(((le=(ie=(Q=r.assessments)==null?void 0:Q.cia1)==null?void 0:ie.btlMax)==null?void 0:le[Y])??W1(k)[Y]),onChange:O=>n(H=>{var ae,I,Z;return{...H,assessments:{...H.assessments||{},cia1:{...((ae=H.assessments)==null?void 0:ae.cia1)||{},btlMax:{...((Z=(I=H.assessments)==null?void 0:I.cia1)==null?void 0:Z.btlMax)||{},[Y]:Math.max(0,Number(O.target.value||0))}}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",textAlign:"center"}})]},Y)})})]}),a.jsxs("div",{style:{flex:"2 1 520px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700},children:"CIA1 Question Headers"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Select question rows and apply Max / CO / BTL in bulk."})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("input",{placeholder:"Max",value:h,onChange:Y=>p(Y.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}}),a.jsxs("select",{value:m,onChange:Y=>g(Y.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",children:"CO"}),a.jsx("option",{value:"1",children:"CO-1"}),a.jsx("option",{value:"2",children:"CO-2"}),a.jsx("option",{value:"1&2",children:"CO-1&CO-2 (split)"})]}),a.jsxs("select",{value:y,onChange:Y=>b(Y.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",children:"BTL"}),[1,2,3,4,5,6].map(Y=>a.jsxs("option",{value:String(Y),children:["BTL-",Y]},Y))]}),a.jsxs("button",{onClick:A,disabled:!j.length,style:{padding:"8px 10px"},children:["Apply to Selected (",j.length,")"]})]})]}),a.jsx("div",{style:{overflowX:"auto",marginTop:10,border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:720},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Sel"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Key"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Label"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Max"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"CO"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"BTL"})]})}),a.jsx("tbody",{children:k.map((Y,Q)=>a.jsxs("tr",{style:{background:Q%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!d[Y.key],onChange:ie=>f(le=>({...le,[Y.key]:ie.target.checked}))})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:Y.key}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:a.jsx("input",{value:Y.label,onChange:ie=>n(le=>{var ae,I,Z;const H=(((I=(ae=le.assessments)==null?void 0:ae.cia1)==null?void 0:I.questions)||Hu).slice().map(pe=>pe.key===Y.key?{...pe,label:ie.target.value}:pe);return{...le,assessments:{...le.assessments||{},cia1:{...((Z=le.assessments)==null?void 0:Z.cia1)||{},questions:H}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:"100%"}})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"number",value:String(Y.max),onChange:ie=>n(le=>{var Z,pe,Oe,Ae,ke,_e,De;const O=Math.max(0,Number(ie.target.value||0)),H=(((pe=(Z=le.assessments)==null?void 0:Z.cia1)==null?void 0:pe.questions)||Hu).slice(),ae=H.map(We=>We.key===Y.key?{...We,max:O}:We),I=_v({prevQuestions:H,nextQuestions:ae,existingCoMax:(Ae=(Oe=le.assessments)==null?void 0:Oe.cia1)==null?void 0:Ae.coMax,existingBtlMax:(_e=(ke=le.assessments)==null?void 0:ke.cia1)==null?void 0:_e.btlMax});return{...le,assessments:{...le.assessments||{},cia1:{...((De=le.assessments)==null?void 0:De.cia1)||{},questions:ae,coMax:I.coMax,btlMax:I.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsxs("select",{value:String(Y.co),onChange:ie=>n(le=>{var pe,Oe,Ae,ke,_e,De,We;const O=String(ie.target.value),H=O==="1&2"?"1&2":Number(O)===2?2:1,ae=(((Oe=(pe=le.assessments)==null?void 0:pe.cia1)==null?void 0:Oe.questions)||Hu).slice(),I=ae.map(Ct=>Ct.key===Y.key?{...Ct,co:H}:Ct),Z=_v({prevQuestions:ae,nextQuestions:I,existingCoMax:(ke=(Ae=le.assessments)==null?void 0:Ae.cia1)==null?void 0:ke.coMax,existingBtlMax:(De=(_e=le.assessments)==null?void 0:_e.cia1)==null?void 0:De.btlMax});return{...le,assessments:{...le.assessments||{},cia1:{...((We=le.assessments)==null?void 0:We.cia1)||{},questions:I,coMax:Z.coMax,btlMax:Z.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"1&2",children:"1&2"})]})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("select",{value:String(Y.btl),onChange:ie=>n(le=>{var Z,pe,Oe,Ae,ke,_e,De;const O=Math.min(6,Math.max(1,Number(ie.target.value||1))),H=(((pe=(Z=le.assessments)==null?void 0:Z.cia1)==null?void 0:pe.questions)||Hu).slice(),ae=H.map(We=>We.key===Y.key?{...We,btl:O}:We),I=_v({prevQuestions:H,nextQuestions:ae,existingCoMax:(Ae=(Oe=le.assessments)==null?void 0:Oe.cia1)==null?void 0:Ae.coMax,existingBtlMax:(_e=(ke=le.assessments)==null?void 0:ke.cia1)==null?void 0:_e.btlMax});return{...le,assessments:{...le.assessments||{},cia1:{...((De=le.assessments)==null?void 0:De.cia1)||{},questions:ae,coMax:I.coMax,btlMax:I.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[1,2,3,4,5,6].map(ie=>a.jsx("option",{value:String(ie),children:ie},ie))})})]},Y.key))})]})})]})]})]})]}),a.jsx("div",{style:{marginTop:16,display:"flex",gap:12},children:a.jsx("button",{onClick:S,disabled:i,style:{padding:"10px 14px",borderRadius:8,border:"1px solid #2563eb",background:"#2563eb",color:"#fff",fontWeight:600,cursor:"pointer"},children:i?"Saving...":c==="po"?"Save Global PO Mapping":"Save Assessment Headers"})})]})})}function wOe(){var u,d;const e=ul(),r=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"obe",[n,i]=x.useState(r),s=((u=window.__APP_ME__)==null?void 0:u.permissions)||((d=window.__ME__)==null?void 0:d.permissions)||[],l=(Array.isArray(s)?s.map(f=>String(f||"").toLowerCase()):[]).includes("obe.master.manage"),c=x.useMemo(()=>{const f=[];return f.push({key:"obe",label:"OBE"}),l&&(f.push({key:"obe_master",label:"OBE Master"}),f.push({key:"due_dates",label:"OBE: Due Dates"})),f},[l]);return hn.useEffect(()=>{var f;c.some(h=>h.key===n)||i(((f=c[0])==null?void 0:f.key)||"obe")},[c,n]),x.useEffect(()=>{const f=new URLSearchParams(e.search).get("tab");f&&c.some(h=>h.key===f)&&f!==n&&i(f)},[e.search]),a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"Quick access to OBE tools."})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18},children:c.map(f=>a.jsx("button",{onClick:()=>i(f.key),style:{padding:"8px 12px",borderRadius:8,border:n===f.key?"1px solid #10b981":"1px solid #e5e7eb",background:n===f.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:f.label},f.key))}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[n==="obe"&&a.jsx(PK,{}),n==="obe_master"&&l&&a.jsx(vOe,{}),n==="due_dates"&&l&&a.jsx(j3,{})]})]})}const SOe="https://db.krgi.co.in",YB=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":SOe;function XB(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function _Oe(){var P,B;const[e,t]=x.useState(null),[r,n]=x.useState(!1),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(""),[h,p]=x.useState("pending"),[m,g]=x.useState(!1),[y,b]=x.useState(null),[v,w]=x.useState(null),[S,k]=x.useState(null),j=x.useMemo(()=>o.filter(E=>{const T=String(E.marks??"").trim().toUpperCase(),F=String(E.btl??"").trim().toUpperCase(),W=String(E.course_outcomes??"").trim().toUpperCase();return!(T==="(OR)"&&F==="(OR)"&&W==="(OR)")}),[o]);async function A(){if(!e){s("Please select a .docx file first.");return}n(!0),s(null),b(null),w(null);const E=new FormData;E.append("file",e);try{const T=await fetch(`${YB}/api/template/scan-docx`,{method:"POST",headers:{...XB()},body:E});if(!T.ok){const z=await T.text();s(z||`Scan failed (${T.status})`),l([]);return}const F=await T.json(),W=Array.isArray(F==null?void 0:F.questions)?F.questions:[];u((F==null?void 0:F.debug)??null);try{console.debug("scan_docx response: questions=",W.length,"sample=",W[0]?{q0:W[0].question_text,imgs:(W[0].images||[]).slice(0,2)}:null),W.length&&W.forEach((z,se)=>{console.log(`Q#${se+1} images:`,Array.isArray(z.images)?z.images.map(de=>typeof de=="string"?de.slice(0,80):typeof de):z.images)})}catch(z){console.warn("scan_docx debug log failed",z)}l(W)}catch(T){s((T==null?void 0:T.message)||"Scan failed"),l([])}finally{n(!1)}}async function L(){if(!d.trim()){w("Title is required to import.");return}g(!0),w(null),b(null);try{const E={title:d.trim(),status:h,questions:j},T=await fetch(`${YB}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...XB()},body:JSON.stringify(E)});if(!T.ok){const W=await T.text();w(W||`Import failed (${T.status})`);return}const F=await T.json();b(F)}catch(E){w((E==null?void 0:E.message)||"Import failed")}finally{g(!1)}}return a.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:24},children:[a.jsx("h1",{style:{marginTop:0},children:"Question Import"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"file",accept:".docx",onChange:E=>{var T;return t(((T=E.target.files)==null?void 0:T[0])||null)}}),a.jsx("button",{onClick:A,disabled:r||!e,children:r?"Scanning":"Scan DOCX"}),a.jsx("div",{style:{color:"#666",fontSize:13},children:o.length?`${o.length} scanned (${j.length} visible)`:""})]}),i&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:i}),c&&a.jsxs("div",{style:{marginTop:10,padding:10,background:"#f8fafc",border:"1px solid #e6eef8",borderRadius:8},children:[a.jsx("div",{style:{fontSize:13,color:"#0747a6",fontWeight:700},children:"Scan debug"}),a.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Questions parsed: ",c.parsed_questions??"-"]}),a.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Total images: ",c.total_images??0]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample questions: ",Array.isArray(c.sample_questions)?c.sample_questions.join(" | "):"-"]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample image prefix: ",a.jsx("code",{style:{background:"#fff",padding:"2px 6px",borderRadius:4},children:String(c.sample_image_prefix||"").slice(0,200)})]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["First questions' images (raw):",a.jsx("pre",{style:{whiteSpace:"pre-wrap",maxHeight:160,overflow:"auto",background:"#fff",padding:8,borderRadius:6},children:JSON.stringify(o.slice(0,3).map(E=>E.images),null,2)})]})]}),a.jsx("hr",{style:{margin:"20px 0"}}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{value:d,onChange:E=>f(E.target.value),placeholder:"Title (e.g., Midterm 2026)",style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6,minWidth:260}}),a.jsxs("select",{value:h,onChange:E=>p(E.target.value),style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6},children:[a.jsx("option",{value:"pending",children:"pending"}),a.jsx("option",{value:"approved",children:"approved"})]}),a.jsx("button",{onClick:L,disabled:m||j.length===0,children:m?"Importing":"Import to Bank"})]}),v&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:v}),y&&a.jsxs("div",{style:{marginTop:10,color:"#166534"},children:["Imported ",y.inserted," question(s)",(P=y.failed)!=null&&P.length?`, ${y.failed.length} failed.`:"."]}),(B=y==null?void 0:y.failed)!=null&&B.length?a.jsxs("div",{style:{marginTop:10},children:[a.jsx("h3",{style:{margin:"10px 0"},children:"Failures"}),a.jsx("ul",{children:y.failed.map(E=>a.jsxs("li",{style:{color:"#b91c1c"},children:["#",E.index+1,": ",E.error]},E.index))})]}):null,a.jsx("hr",{style:{margin:"20px 0"}}),a.jsx("h2",{style:{margin:"10px 0"},children:"Preview"}),j.length===0?a.jsx("div",{style:{color:"#666"},children:"No questions to preview yet."}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[j.slice(0,50).map((E,T)=>a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:14},children:[a.jsxs("div",{style:{fontWeight:700,marginBottom:6},children:[T+1,". ",E.question_text]}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",color:"#555",fontSize:13,marginBottom:8},children:[E.marks!=null&&a.jsxs("span",{children:["Marks: ",String(E.marks)]}),E.btl!=null&&a.jsxs("span",{children:["BTL: ",String(E.btl)]}),E.course_outcomes&&a.jsxs("span",{children:["CO: ",E.course_outcomes]}),E.chapter&&a.jsxs("span",{children:["Chapter: ",E.chapter]})]}),Array.isArray(E.options)&&E.options.length?a.jsx("ol",{type:"a",style:{marginTop:0},children:E.options.map((F,W)=>a.jsx("li",{children:String(F)},W))}):null,E.correct_answer?a.jsxs("div",{style:{marginTop:6,color:"#111",fontSize:13},children:[a.jsx("strong",{children:"Answer:"})," ",E.correct_answer]}):null,E.answer_text?a.jsxs("div",{style:{marginTop:4,color:"#444",fontSize:13},children:[a.jsx("strong",{children:"Explanation:"})," ",E.answer_text]}):null,Array.isArray(E.images)&&E.images.length?a.jsx("div",{style:{marginTop:10,display:"flex",gap:10,flexWrap:"wrap"},children:E.images.slice(0,6).map((F,W)=>{let z=null;try{if(typeof F=="string")z=F,!z.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(z)&&z.length>100&&(z=`data:image/png;base64,${z.replace(/\s+/g,"")}`);else if(F&&typeof F=="object"){if(F.url)z=F.url;else if(F.base64)z=F.base64.startsWith("data:")?F.base64:`data:image/png;base64,${F.base64}`;else if(F.binary&&F.binary instanceof Uint8Array){const se=new Blob([F.binary],{type:"image/png"});z=URL.createObjectURL(se)}}else if(F instanceof Uint8Array){const se=new Blob([F],{type:"image/png"});z=URL.createObjectURL(se)}}catch{z=null}return z?a.jsx("img",{src:z,alt:`q${T+1}-img${W+1}`,onClick:()=>k(z),style:{maxHeight:140,borderRadius:8,border:"1px solid #eee",cursor:"pointer",objectFit:"contain"}},W):null})}):null]},T)),j.length>50&&a.jsx("div",{style:{color:"#666"},children:"Showing first 50 questions."})]}),S&&a.jsx("div",{role:"dialog",onClick:()=>{k(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},children:a.jsx("div",{onClick:E=>E.stopPropagation(),style:{maxWidth:"90%",maxHeight:"90%",padding:12},children:a.jsx("img",{src:S,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:8}})})})]})}function kOe({courseId:e,classType:t,questionPaperType:r,enabledAssessments:n}){const[i,s]=x.useState(e||""),[o,l]=x.useState(!1);return x.useEffect(()=>{e&&e!==i&&s(e),!e&&i&&s("")},[e]),a.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #ecfdf5 0%, #ffffff 60%)",padding:"0"},children:a.jsxs("div",{style:{background:"#ffffff",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"#ffffff",padding:"20px 24px",flexShrink:0},children:[a.jsx("div",{style:{fontSize:24,fontWeight:800},children:"Mark Entry"}),a.jsxs("div",{style:{fontSize:14,opacity:.9},children:[" ",i?`Course: ${i}`:"No course selected"," "]})]}),a.jsxs("div",{style:{padding:"20px 24px",flex:1},children:[!e&&a.jsxs("div",{className:"obe-card",style:{marginBottom:12},children:[a.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:"#065f46",textTransform:"uppercase",letterSpacing:"0.03em"},children:"Course ID"}),a.jsx("input",{value:i,onChange:c=>s(c.target.value),placeholder:"Enter course id",className:"obe-input",style:{marginTop:6,...o?{boxShadow:"0 0 0 3px rgba(16,185,129,0.2)",borderColor:"#a7f3d0"}:{}},onFocus:()=>l(!0),onBlur:()=>l(!1)})]}),i?a.jsx(C6,{subjectId:i,classType:t,questionPaperType:r,enabledAssessments:n}):a.jsx("div",{style:{background:"#d1fae5",border:"1px solid #a7f3d0",color:"#065f46",fontSize:14,padding:12,borderRadius:10},children:"Select a course to start mark entry."})]})]})})}const Nc={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},jOe=[{key:"q1",max:2,co:1},{key:"q2",max:2,co:1},{key:"q3",max:2,co:1},{key:"q4",max:2,co:2},{key:"q5",max:2,co:2},{key:"q6",max:2,co:2},{key:"q7",max:16,co:1},{key:"q8",max:16,co:2},{key:"q9",max:16,co:"1&2"}],AOe=[{key:"q1",max:2,co:3},{key:"q2",max:2,co:3},{key:"q3",max:2,co:3},{key:"q4",max:2,co:4},{key:"q5",max:2,co:4},{key:"q6",max:2,co:4},{key:"q7",max:16,co:3},{key:"q8",max:16,co:4},{key:"q9",max:16,co:"3&4"}],NOe=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],kv=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function ci(e,t,r){return Math.max(t,Math.min(r,e))}function $f(e){return Math.round(e*100)/100}function No(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function QB(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function COe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function EOe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function Sj(e){if(e==="both"||e==="1&2")return"1&2";if(Array.isArray(e)){const r=e.map(s=>String(s??"").trim().toUpperCase());if(r.some(s=>s==="BOTH"))return"1&2";const n=r.some(s=>s==="1"||s==="CO1"),i=r.some(s=>s==="2"||s==="CO2");return n&&i?"1&2":i?2:1}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2")return"1&2";if(r==="2"||r==="CO2")return 2;if(r==="1"||r==="CO1")return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function _j(e){if(e==="both"||e==="3&4")return"3&4";if(Array.isArray(e)){const r=e.map(l=>String(l??"").trim().toUpperCase());if(r.some(l=>l==="BOTH"))return"3&4";const n=r.some(l=>l==="1"||l==="CO1"),i=r.some(l=>l==="2"||l==="CO2"),s=r.some(l=>l==="3"||l==="CO3"),o=r.some(l=>l==="4"||l==="CO4");return s&&o||n&&i?"3&4":o||i?4:3}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2"||r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3"||r==="CO3&CO4"||r==="CO3,CO4")return"3&4";if(r==="4"||r==="CO4")return 4;if(r==="3"||r==="CO3")return 3;if(r==="2"||r==="CO2")return 4;if(r==="1"||r==="CO1")return 3}const t=Number(e);return t===4?4:t===34?"3&4":t===2?4:t===1?3:t===12?"3&4":3}function kj(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),i=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&i&&s?{co1:.5,co2:.5}:COe(r.co)}function jj(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),i=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&i&&s?{co3:.5,co4:.5}:EOe(r.co)}function JB(e,t,r,n){const i=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(i)||i<=0||!c)return[0,0,0];const u=$f(i*(s||0)/c),d=$f(i*(o||0)/c),f=$f(i*(l||0)/c);return[u,d,f]}function TOe(e,t){const r=ti(e),n=Nc.header,i=Nc.cycles,s=["CO1-SSA","CO1-CIA","CO1-FA","CO2-SSA","CO2-CIA","CO2-FA","CO3-SSA","CO3-CIA","CO3-FA","CO4-SSA","CO4-CIA","CO4-FA","ME-CO1","ME-CO2","ME-CO3","ME-CO4","ME-CO5"];let o=Array.from({length:17},(h,p)=>p),l=[...i],c=[...s];if(r==="TCPR"&&(l=l.map((h,p)=>p===2||p===5||p===8||p===11?"review":h),c=c.map((h,p)=>p===2||p===5||p===8||p===11?h.replace("-FA","-Review"):h)),r==="TCPL"&&(l=l.map((h,p)=>p===2||p===5||p===8||p===11?"lab":h),c=c.map((h,p)=>p===2||p===5?h.replace("-FA","-LAB1"):p===8||p===11?h.replace("-FA","-LAB2"):h)),r==="LAB"||r==="PRACTICAL")return o=[1,4,7,10,16],{visible:o,header:["CO1","CO2","CO3","CO4","ME"],cycles:["CIA 1","CIA 1","CIA 2","CIA 2","MODEL"],labels:["CO1-CIA1","CO2-CIA1","CO3-CIA2","CO4-CIA2","ME-CO5"]};if(r==="SPECIAL"&&t.size){const h=[],p=(m,g)=>{if(m)for(const y of g)h.push(y)};p(t.has("ssa1"),[0,3]),p(t.has("cia1"),[1,4]),p(t.has("formative1"),[2,5]),p(t.has("ssa2"),[6,9]),p(t.has("cia2"),[7,10]),p(t.has("formative2"),[8,11]),o=h}const u=o.map(h=>n[h]),d=o.map(h=>l[h]),f=o.map(h=>c[h]);return{visible:o,header:u,cycles:d,labels:f}}function POe({courseId:e,enabledAssessments:t}){const r=x.useMemo(()=>new Set((t||[]).map(O=>String(O||"").trim().toLowerCase()).filter(Boolean)),[t]),[n,i]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(null),[u,d]=x.useState(null),[f,h]=x.useState(null),[p,m]=x.useState([]),[g,y]=x.useState(null),[b,v]=x.useState(!1),[w,S]=x.useState({ssa1:1.5,cia1:3,formative1:2.5}),[k,j]=x.useState([...Nc.weights]),[A,L]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[P,B]=x.useState({r1:{},r2:{}}),[E,T]=x.useState({cia1:null,cia2:null,model:null}),[F,W]=x.useState({lab1:null,lab2:null}),[z,se]=x.useState(null),[de,U]=x.useState({cia1:null,cia2:null}),[G,re]=x.useState(null),[X,C]=x.useState(!1),[K,V]=x.useState(null);x.useEffect(()=>{let O=!0;return(async()=>{try{const H=await vu();if(!O)return;h(H||null)}catch{}})(),()=>{O=!1}},[e]),x.useEffect(()=>{let O=!0;return(async()=>{var H;try{const ae=await lc();if(!O)return;let I=(ae||[]).filter(Oe=>String(Oe.subject_code)===String(e));if(I.length===0)try{const Oe=await yr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(Oe.ok){const Ae=await Oe.json();I=(Array.isArray(Ae.results)?Ae.results:Array.isArray(Ae)?Ae:Ae.items||[])||[]}}catch(Oe){console.warn("Server TA list fetch failed:",Oe)}i(I);const Z=Jn(`internalMark_selectedTa_${e}`),pe=(typeof Z=="number"&&I.some(Oe=>Oe.id===Z)?Z:(H=I[0])==null?void 0:H.id)??null;o(pe),c(null)}catch(ae){if(!O)return;i([]),o(null),c((ae==null?void 0:ae.message)||"Failed to load teaching assignments")}})(),()=>{O=!1}},[e]),x.useEffect(()=>{!e||s==null||Gn(`internalMark_selectedTa_${e}`,s)},[e,s]),x.useEffect(()=>{let O=!0;return(async()=>{try{const H=(n||[]).find(Z=>Z.id===s)||null,ae=H==null?void 0:H.curriculum_row_id;if(!ae){const Z=String(e).trim().toUpperCase(),pe=await bl();if(!O)return;const Oe=(pe||[]).find(De=>String(De.course_code||"").trim().toUpperCase()===Z),Ae=(Oe==null?void 0:Oe.class_type)??null;if(Ae){d(Ae);return}const ke=await Kd();if(!O)return;const _e=(ke||[]).find(De=>String(De.course_code||"").trim().toUpperCase()===Z);d((_e==null?void 0:_e.class_type)??null);return}const I=await A3(Number(ae));if(!O)return;d((I==null?void 0:I.class_type)??null)}catch{O&&d(null)}})(),()=>{O=!1}},[n,s,e]),x.useEffect(()=>{let O=!0;return(async()=>{try{const H=ti(u),ae=I=>{if(!I||typeof I!="object")return!1;const Z=Number.isFinite(Number(I.ssa1))?Number(I.ssa1):1.5,pe=Number.isFinite(Number(I.cia1))?Number(I.cia1):3,Oe=Number.isFinite(Number(I.formative1))?Number(I.formative1):2.5;S({ssa1:Z,cia1:pe,formative1:Oe});const Ae=I.internal_mark_weights;if(Array.isArray(Ae)&&Ae.length){let ke=Ae.map(_e=>{const De=Number(_e);return Number.isFinite(De)?De:0});if(ke.length===13&&Nc.weights.length===17){const[_e,De,We]=JB(ke[0]||0,Z,pe,Oe),[Ct,_t,Xe]=JB(ke[1]||0,Z,pe,Oe);ke=[_e,De,We,Ct,_t,Xe,...ke.slice(2)]}for(;ke.length<Nc.weights.length;)ke.push(Nc.weights[ke.length]??0);j(ke.slice(0,Nc.weights.length))}else j([...Nc.weights]);return!0};try{const I=await _S();if(!O)return;const Z=I&&I[H]||null;if(ae(Z))return}catch{}try{const I=Jn("iqac_class_type_weights"),Z=I&&I[H]||null;if(ae(Z))return}catch{}}catch{}})(),()=>{O=!1}},[u]),x.useEffect(()=>{let O=!0;return(async()=>{if(s){v(!0),y(null);try{const ae=(n||[]).find(I=>I.id===s)||null;if(ae&&ae.elective_subject_id&&!ae.section_id){const I=ae.elective_subject_id,Z=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(I))}`);if(!Z.ok)throw new Error(`Elective-choices fetch failed: ${Z.status}`);const pe=await Z.json();if(!O)return;const Ae=((Array.isArray(pe.results)?pe.results:Array.isArray(pe)?pe:pe.items||[])||[]).map(ke=>({id:Number(ke.student_id??ke.id),reg_no:String(ke.reg_no??ke.registration_no??ke.regno??""),name:String(ke.name??ke.full_name??ke.username??""),section:ke.section_name??ke.section??null}));if(!O)return;m(Ae.filter(ke=>Number.isFinite(ke.id)).sort(QB))}else{const I=await qc(s);if(!O)return;const Z=(I.students||[]).map(pe=>({id:Number(pe.id),reg_no:String(pe.reg_no??""),name:String(pe.name??""),section:pe.section??null})).filter(pe=>Number.isFinite(pe.id)).sort(QB);m(Z)}}catch(ae){if(!O)return;m([]),y((ae==null?void 0:ae.message)||"Failed to load roster")}finally{O&&v(!1)}}})(),()=>{O=!1}},[s]),x.useEffect(()=>{let O=!0;return(async()=>{C(!0),V(null);try{const ae=ti(u),I=s??void 0,Z=ae==="TCPL",pe=ae==="TCPR",Oe=ae==="LAB"||ae==="PRACTICAL",Ae=ae==="SPECIAL"&&r.size,ke=Pt=>Ae?r.has(String(Pt).toLowerCase()):!0;B({r1:{},r2:{}}),T({cia1:null,cia2:null,model:null}),W({lab1:null,lab2:null}),se(null),U({cia1:null,cia2:null}),re(null);const _e=async Pt=>{if(!ae)return null;try{const bt=await ih({class_type:String(ae).toUpperCase(),question_paper_type:null,exam:Pt}),qr=bt&&bt.pattern;if(qr&&Array.isArray(qr.marks)&&qr.marks.length)return qr}catch{}try{const bt=await ih({class_type:String(ae).toUpperCase(),question_paper_type:null,exam:"CIA"}),qr=bt&&bt.pattern;if(qr&&Array.isArray(qr.marks)&&qr.marks.length)return qr}catch{}return null};try{const[Pt,bt]=await Promise.all([_e("CIA1"),_e("CIA2")]);O&&U({cia1:Pt,cia2:bt})}catch{O&&U({cia1:null,cia2:null})}let De=null,We=null,Ct=null,_t=null,Xe=null,nt=null,Ne=null,be=null,fe=null,ge=null,lt=null,He=null,mt=null,wt=null;if(Oe){try{const Pt=await ei("cia1",e,I);Pt!=null&&Pt.draft&&(fe={data:Pt.draft.data??Pt.draft})}catch{}try{const Pt=await ei("cia2",e,I);Pt!=null&&Pt.draft&&(ge={data:Pt.draft.data??Pt.draft})}catch{}try{const Pt=await ei("model",e,I);Pt!=null&&Pt.draft&&(lt={data:Pt.draft.data??Pt.draft})}catch{}if(!(fe!=null&&fe.data))try{fe=await ho("cia1",e,I)}catch{fe=null}if(!(ge!=null&&ge.data))try{ge=await ho("cia2",e,I)}catch{ge=null}if(!(lt!=null&&lt.data))try{lt=await Rm(e,I)}catch{lt=null}if(!O)return;T({cia1:(fe==null?void 0:fe.data)??null,cia2:(ge==null?void 0:ge.data)??null,model:(lt==null?void 0:lt.data)??null}),L({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});return}if(ke("ssa1"))try{const Pt=await ei("ssa1",e,I);Pt!=null&&Pt.draft&&Pt.draft.marks&&(De={marks:Pt.draft.marks})}catch{}if(ke("ssa2"))try{const Pt=await ei("ssa2",e,I);Pt!=null&&Pt.draft&&Pt.draft.marks&&(We={marks:Pt.draft.marks})}catch{}if(ke("ssa1")&&!(De!=null&&De.marks))try{De=await rg(e,I)}catch{De=null}if(ke("ssa2")&&!(We!=null&&We.marks))try{We=await ty(e,I)}catch{We=null}if(pe){try{const Pt=await ei("review1",e,I);Pt!=null&&Pt.draft&&Pt.draft.marks&&(Ne={marks:Pt.draft.marks})}catch{}try{const Pt=await ei("review2",e,I);Pt!=null&&Pt.draft&&Pt.draft.marks&&(be={marks:Pt.draft.marks})}catch{}if(!(Ne!=null&&Ne.marks))try{Ne=await kS(e)}catch{Ne=null}if(!(be!=null&&be.marks))try{be=await jS(e)}catch{be=null}if(!O)return;B({r1:(Ne==null?void 0:Ne.marks)||{},r2:(be==null?void 0:be.marks)||{}})}if(Z){try{const Pt=await ei("formative1",e,I);Pt!=null&&Pt.draft&&(He={data:Pt.draft.data??Pt.draft})}catch{}try{const Pt=await ei("formative2",e,I);Pt!=null&&Pt.draft&&(mt={data:Pt.draft.data??Pt.draft})}catch{}if(!(He!=null&&He.data))try{He=await ho("formative1",e,I)}catch{He=null}if(!(mt!=null&&mt.data))try{mt=await ho("formative2",e,I)}catch{mt=null}if(!O)return;W({lab1:(He==null?void 0:He.data)??null,lab2:(mt==null?void 0:mt.data)??null})}else{if(!pe&&ke("formative1")){try{const Pt=await ei("formative1",e,I);Pt!=null&&Pt.draft&&Pt.draft.marks&&(Ct={marks:Pt.draft.marks})}catch{}if(!(Ct!=null&&Ct.marks))try{Ct=await b0("formative1",e,I)}catch{Ct=null}}if(!pe&&ke("formative2")){try{const Pt=await ei("formative2",e,I);Pt!=null&&Pt.draft&&Pt.draft.marks&&(_t={marks:Pt.draft.marks})}catch{}if(!(_t!=null&&_t.marks))try{_t=await b0("formative2",e,I)}catch{_t=null}}}if(ke("cia1")){try{const Pt=await ei("cia1",e,I);Pt!=null&&Pt.draft&&(Xe={data:Pt.draft.data??Pt.draft})}catch{}if(!(Xe!=null&&Xe.data))try{Xe=await v0("cia1",e,I)}catch{Xe=null}}if(ke("cia2")){try{const Pt=await ei("cia2",e,I);Pt!=null&&Pt.draft&&(nt={data:Pt.draft.data??Pt.draft})}catch{}if(!(nt!=null&&nt.data))try{nt=await v0("cia2",e,I)}catch{nt=null}}try{const Pt=await ei("model",e,I);Pt!=null&&Pt.draft&&(wt={data:Pt.draft.data??Pt.draft})}catch{}if(!(wt!=null&&wt.data))try{wt=await Rm(e,I)}catch{wt=null}try{const Pt=wt==null?void 0:wt.data,bt=String((Pt==null?void 0:Pt.qpType)||"").trim().toUpperCase(),qr=bt==="QP2"?"QP2":bt==="QP1"?"QP1":null,Tt=String(ae||"").toUpperCase(),xr=await ih({class_type:Tt,question_paper_type:Tt==="THEORY"?qr:null,exam:"MODEL"}),Zr=xr==null?void 0:xr.pattern;Zr&&Array.isArray(Zr.marks)&&Zr.marks.length&&O&&re(Zr)}catch{}if(!O)return;L({ssa1:(De==null?void 0:De.marks)||{},ssa2:(We==null?void 0:We.marks)||{},f1:(Ct==null?void 0:Ct.marks)||{},f2:(_t==null?void 0:_t.marks)||{},cia1:(Xe==null?void 0:Xe.data)||null,cia2:(nt==null?void 0:nt.data)||null}),se((wt==null?void 0:wt.data)||null)}catch(ae){if(!O)return;V((ae==null?void 0:ae.message)||"Failed to load marks")}finally{O&&C(!1)}})(),()=>{O=!1}},[e,u,r,s]);const R=x.useMemo(()=>TOe(u,r),[u,r]),J=x.useMemo(()=>{const H=(Array.isArray(k)&&k.length?k:Nc.weights).slice(0,Nc.weights.length);for(;H.length<Nc.weights.length;)H.push(Nc.weights[H.length]??0);const ae=R.visible.map(I=>H[I]??0);return{header:R.header,weights:ae,cycles:R.cycles,visible:R.visible,labels:R.labels}},[k,R]),q=x.useMemo(()=>J.weights.map(H=>Number(H)||0).reduce((H,ae)=>H+ae,0),[J]),Y=x.useMemo(()=>{var Gr,bn,or,kr,Mr,Ar,Zt,Kt,it,At,Mt,ar,Ge,Rt,Ze,ot,Bt,Qt,Yt,fr,Dt,ur;const O=ti(u),H=new Array(17).fill(0);for(let Ve=0;Ve<J.visible.length;Ve++){const zt=J.visible[Ve];H[zt]=Number(J.weights[Ve])||0}const ae=H[0]||0,I=H[1]||0,Z=H[2]||0,pe=H[3]||0,Oe=H[4]||0,Ae=H[5]||0,ke=H[6]||0,_e=H[7]||0,De=H[8]||0,We=H[9]||0,Ct=H[10]||0,_t=H[11]||0,Xe=H[12]||0,nt=H[13]||0,Ne=H[14]||0,be=H[15]||0,fe=H[16]||0,ge=A.cia1&&typeof A.cia1=="object"?A.cia1:null,lt=A.cia2&&typeof A.cia2=="object"?A.cia2:null,He=de==null?void 0:de.cia1,mt=de==null?void 0:de.cia2,wt=Array.isArray((bn=(Gr=f==null?void 0:f.assessments)==null?void 0:Gr.cia1)==null?void 0:bn.questions)?f.assessments.cia1.questions.map(Ve=>({key:String((Ve==null?void 0:Ve.key)||""),max:Number((Ve==null?void 0:Ve.max)??(Ve==null?void 0:Ve.maxMarks)??0),co:Sj(Ve==null?void 0:Ve.co)})).filter(Ve=>Ve.key):[],Pt=Array.isArray((kr=(or=f==null?void 0:f.assessments)==null?void 0:or.cia2)==null?void 0:kr.questions)?f.assessments.cia2.questions.map(Ve=>({key:String((Ve==null?void 0:Ve.key)||""),max:Number((Ve==null?void 0:Ve.max)??(Ve==null?void 0:Ve.maxMarks)??0),co:_j(Ve==null?void 0:Ve.co)})).filter(Ve=>Ve.key):[],bt=He&&Array.isArray(He.marks)&&He.marks.length?He.marks.map((Ve,zt)=>{const yt=wt[zt],St=Array.isArray(He.cos)?He.cos[zt]:void 0;return{key:`q${zt+1}`,max:Number(Ve)||0,co:St!=null?Sj(St):(yt==null?void 0:yt.co)??1}}).filter(Ve=>!!Ve.key):[],qr=mt&&Array.isArray(mt.marks)&&mt.marks.length?mt.marks.map((Ve,zt)=>{const yt=Pt[zt],St=Array.isArray(mt.cos)?mt.cos[zt]:void 0;return{key:`q${zt+1}`,max:Number(Ve)||0,co:St!=null?_j(St):(yt==null?void 0:yt.co)??3}}).filter(Ve=>!!Ve.key):[],Tt=Array.isArray(ge==null?void 0:ge.questions)?ge.questions.map(Ve=>({key:String((Ve==null?void 0:Ve.key)||""),max:Number((Ve==null?void 0:Ve.max)??(Ve==null?void 0:Ve.maxMarks)??0),co:Sj(Ve==null?void 0:Ve.co)})).filter(Ve=>Ve.key):bt.length?bt:wt.length?wt:jOe,xr=Array.isArray(lt==null?void 0:lt.questions)?lt.questions.map(Ve=>({key:String((Ve==null?void 0:Ve.key)||""),max:Number((Ve==null?void 0:Ve.max)??(Ve==null?void 0:Ve.maxMarks)??0),co:_j(Ve==null?void 0:Ve.co)})).filter(Ve=>Ve.key):qr.length?qr:Pt.length?Pt:AOe,Zr=ge!=null&&ge.rowsByStudentId&&typeof ge.rowsByStudentId=="object"?ge.rowsByStudentId:{},Xr=lt!=null&&lt.rowsByStudentId&&typeof lt.rowsByStudentId=="object"?lt.rowsByStudentId:{},Br=Tt.reduce((Ve,zt,yt)=>{const St=kj(Tt,yt);return Ve+zt.max*St.co1},0),Vr=Tt.reduce((Ve,zt,yt)=>{const St=kj(Tt,yt);return Ve+zt.max*St.co2},0),An=xr.reduce((Ve,zt,yt)=>{const St=jj(xr,yt);return Ve+zt.max*St.co3},0),Yr=xr.reduce((Ve,zt,yt)=>{const St=jj(xr,yt);return Ve+zt.max*St.co4},0),Ln=((Mr=f==null?void 0:f.assessments)==null?void 0:Mr.ssa1)||{},Me=((Ar=f==null?void 0:f.assessments)==null?void 0:Ar.ssa2)||{},Ce=((Zt=f==null?void 0:f.assessments)==null?void 0:Zt.formative1)||{},It=((Kt=f==null?void 0:f.assessments)==null?void 0:Kt.formative2)||{},ft=((it=f==null?void 0:f.assessments)==null?void 0:it.cia1)||{},Ot=((At=f==null?void 0:f.assessments)==null?void 0:At.cia2)||{},er=Number((Mt=Ln==null?void 0:Ln.coMax)==null?void 0:Mt.co1),hr=Number((ar=Ln==null?void 0:Ln.coMax)==null?void 0:ar.co2),Tr=Number(((Ge=Me==null?void 0:Me.coMax)==null?void 0:Ge.co3)??((Rt=Me==null?void 0:Me.coMax)==null?void 0:Rt.co1)),ne=Number(((Ze=Me==null?void 0:Me.coMax)==null?void 0:Ze.co4)??((ot=Me==null?void 0:Me.coMax)==null?void 0:ot.co2)),ce=Number((Bt=ft==null?void 0:ft.coMax)==null?void 0:Bt.co1),te=Number((Qt=ft==null?void 0:ft.coMax)==null?void 0:Qt.co2),ue=Number(((Yt=Ot==null?void 0:Ot.coMax)==null?void 0:Yt.co3)??((fr=Ot==null?void 0:Ot.coMax)==null?void 0:fr.co1)),Ee=Number(((Dt=Ot==null?void 0:Ot.coMax)==null?void 0:Dt.co4)??((ur=Ot==null?void 0:Ot.coMax)==null?void 0:ur.co2)),je=Number(Ce==null?void 0:Ce.maxCo),gt=Number(It==null?void 0:It.maxCo),Qe=O==="TCPL",Fe={ssa1:{co1:Number.isFinite(er)?Math.max(0,er):10,co2:Number.isFinite(hr)?Math.max(0,hr):10},ssa2:{co3:Number.isFinite(Tr)?Math.max(0,Tr):10,co4:Number.isFinite(ne)?Math.max(0,ne):10},cia1:{co1:Qe?Br>0?Br:Number.isFinite(ce)?Math.max(0,ce):30:Number.isFinite(ce)?Math.max(0,ce):Br,co2:Qe?Vr>0?Vr:Number.isFinite(te)?Math.max(0,te):30:Number.isFinite(te)?Math.max(0,te):Vr},cia2:{co3:Qe?An>0?An:Number.isFinite(ue)?Math.max(0,ue):30:Number.isFinite(ue)?Math.max(0,ue):An,co4:Qe?Yr>0?Yr:Number.isFinite(Ee)?Math.max(0,Ee):30:Number.isFinite(Ee)?Math.max(0,Ee):Yr},f1:{co1:Number.isFinite(je)?Math.max(0,je):10,co2:Number.isFinite(je)?Math.max(0,je):10},f2:{co3:Number.isFinite(gt)?Math.max(0,gt):10,co4:Number.isFinite(gt)?Math.max(0,gt):10},review1:{co1:15,co2:15},review2:{co3:15,co4:15}},$e=O==="TCPL",st=O==="TCPR",Wt=$e||st,qt=Array.isArray(G==null?void 0:G.marks)?G.marks:null,ht=(()=>{if(Array.isArray(qt)&&qt.length)return qt.map((Ve,zt)=>({key:`q${zt+1}`,max:Number(Ve)||0}));if(Wt){const Ve=st?12:15,zt=st?8:10;return Array.from({length:Ve},(yt,St)=>{const sr=St+1;return{key:`q${sr}`,max:sr<=zt?2:16}})}return NOe})(),Ut=(()=>{const Ve=Array.isArray(G==null?void 0:G.cos)?G.cos:null;if(Array.isArray(Ve)&&Ve.length===ht.length)return Ve.map(zt=>{const yt=Number(zt);if(Number.isFinite(yt))return ci(Math.round(yt),1,5);const sr=String(zt??"").toUpperCase().match(/\d+/);return sr?ci(Number(sr[0]),1,5):1});if(st){const zt=[1,1,2,2,3,3,4,4,1,2,3,4];return ht.length===zt.length?zt:Array.from({length:ht.length},(yt,St)=>zt[St%zt.length])}if($e){const zt=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];return ht.length===zt.length?zt:Array.from({length:ht.length},(yt,St)=>zt[St%zt.length])}return ht.length===kv.length?[...kv]:Array.from({length:ht.length},(zt,yt)=>kv[yt%kv.length])})(),Gt=(()=>{const Ve={co1:0,co2:0,co3:0,co4:0,co5:0};for(let zt=0;zt<ht.length;zt++){const yt=ht[zt],St=Ut[zt]??1;St===1?Ve.co1+=yt.max:St===2?Ve.co2+=yt.max:St===3?Ve.co3+=yt.max:St===4?Ve.co4+=yt.max:St===5&&(Ve.co5+=yt.max)}return Ve})(),cr=(()=>{const Ve={...Gt};return st?{...Ve,co5:Ve.co5+30}:$e?{co1:Ve.co1+6,co2:Ve.co2+6,co3:Ve.co3+6,co4:Ve.co4+6,co5:Ve.co5+6}:Ve})(),ir=String(s??"none"),Fr=z&&typeof z=="object"?z:null,dn=(()=>{if(Fr){const Ht=ti(Fr==null?void 0:Fr.classType),qe=Ht==="TCPL"||Ht==="TCPR"?Fr==null?void 0:Fr.tcplSheet:Fr==null?void 0:Fr.theorySheet;if(qe&&typeof qe=="object")return qe}const Ve=`model_theory_sheet_${e}_${ir}`,zt=`model_theory_sheet_${e}_none`,yt=`model_tcpl_sheet_${e}_${ir}`,St=`model_tcpl_sheet_${e}_none`,sr=`model_tcpr_sheet_${e}_${ir}`,pr=`model_tcpr_sheet_${e}_none`,we=`model_sheet_${e}`,Ie=Jn(Ve);if(Ie&&typeof Ie=="object")return Ie;const tt=Jn(zt);if(tt&&typeof tt=="object")return tt;const dt=Jn(yt);if(dt&&typeof dt=="object")return dt;const xt=Jn(St);if(xt&&typeof xt=="object")return xt;const Cr=Jn(sr);if(Cr&&typeof Cr=="object")return Cr;const nn=Jn(pr);if(nn&&typeof nn=="object")return nn;const ct=Jn(we);return ct&&typeof ct=="object"?ct:null})(),vr=Ve=>{const zt=cr;if(!dn)return{co1:null,co2:null,co3:null,co4:null,co5:null,max:zt};const yt=`id:${String(Ve.id)}`,St=Ve.reg_no?`reg:${String(Ve.reg_no).trim()}`:"",sr=dn[yt]||(St?dn[St]:null)||null;if(!sr||typeof sr!="object")return{co1:null,co2:null,co3:null,co4:null,co5:null,max:zt};const pr=!!sr.absent,we=String(sr.absentKind||"AL").toUpperCase(),Ie=sr.q&&typeof sr.q=="object"?sr.q:{},tt=No(sr.lab);let dt=!1;const xt={co1:0,co2:0,co3:0,co4:0,co5:0};for(let Cr=0;Cr<ht.length;Cr++){const nn=ht[Cr],ct=Ie[nn.key],Ht=No(ct);if(Ht==null)continue;dt=!0;const Ue=ci(Ht,0,nn.max),qe=Ut[Cr]??1;qe===1?xt.co1+=Ue:qe===2?xt.co2+=Ue:qe===3?xt.co3+=Ue:qe===4?xt.co4+=Ue:qe===5&&(xt.co5+=Ue)}if(Wt&&tt!=null){dt=!0;const Cr=ci(tt,0,30);if(st)xt.co5+=Cr;else{const nn=Cr/5;xt.co1+=nn,xt.co2+=nn,xt.co3+=nn,xt.co4+=nn,xt.co5+=nn}}return dt?pr&&we==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:zt}:{co1:ci(xt.co1,0,zt.co1),co2:ci(xt.co2,0,zt.co2),co3:ci(xt.co3,0,zt.co3),co4:ci(xt.co4,0,zt.co4),co5:ci(xt.co5,0,zt.co5),max:zt}:pr&&we==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:zt}:{co1:null,co2:null,co3:null,co4:null,co5:null,max:zt}},Lt=(Ve,zt,yt)=>Ve==null||!zt||!Number.isFinite(zt)?null:ci(Ve/zt*yt,0,yt);if(O==="LAB"||O==="PRACTICAL"){const zt=(we,Ie,tt)=>{const dt=we!=null&&we.sheet&&typeof we.sheet=="object"?we.sheet:{},xt=dt!=null&&dt.rowsByStudentId&&typeof dt.rowsByStudentId=="object"?dt.rowsByStudentId:{},Cr=ci(Number((dt==null?void 0:dt.expCountA)??0),0,12),nn=ci(Number((dt==null?void 0:dt.expCountB)??0),0,12),ct=!!(dt!=null&&dt.coAEnabled),Ht=!!(dt!=null&&dt.coBEnabled),Ue=!!(dt!=null&&dt.ciaExamEnabled),qe=dt!=null&&dt.coConfigs&&typeof dt.coConfigs=="object"?dt.coConfigs:null,at=qe?qe[String(Ie)]:null,Be=tt!=null&&qe?qe[String(tt)]:null,vt=at?!!at.enabled:ct,jt=tt!=null?Be?!!Be.enabled:Ht:!1,$t=at?ci(Number(at.expCount??0),0,12):Cr,Rr=tt!=null?Be?ci(Number(Be.expCount??0),0,12):nn:0,Ur=at&&Number.isFinite(Number(at.expMax))?Number(at.expMax):Number.isFinite(Number(dt==null?void 0:dt.expMaxA))?Number(dt.expMaxA):25,en=tt!=null?Be&&Number.isFinite(Number(Be.expMax))?Number(Be.expMax):Number.isFinite(Number(dt==null?void 0:dt.expMaxB))?Number(dt.expMaxB):25:0,vn=Ur+(Ue?15:0),Nr=tt!=null?en+(Ue?15:0):0,fn=(rt,ut)=>Array.isArray(rt)?rt.map(pt=>typeof pt=="number"&&Number.isFinite(pt)?pt:null):rt==null?[]:[],rr=rt=>{const ut=(rt||[]).filter(pt=>typeof pt=="number"&&Number.isFinite(pt));return ut.length?ut.reduce((pt,Pr)=>pt+Pr,0)/ut.length:null};return{get:rt=>{const ut=xt[String(rt)]||{},pt=ut!=null&&ut.marksByCo&&typeof ut.marksByCo=="object"?ut.marksByCo:{},Pr=(pt==null?void 0:pt[String(Ie)])??ut.marksA,Kr=tt!=null?(pt==null?void 0:pt[String(tt)])??ut.marksB:[],pn=fn(Pr).slice(0,vt?$t:0),Nn=fn(Kr).slice(0,jt?Rr:0),_n=rr(pn),kn=rr(Nn),Wn=ut==null?void 0:ut.ciaExam,M=typeof Wn=="number"&&Number.isFinite(Wn)?Wn:null,oe=_n!=null||kn!=null||M!=null,Re=oe?(_n??0)+(Ue?(M??0)/2:0):null,Je=oe?(kn??0)+(Ue?(M??0)/2:0):null;return{a:Re==null?null:ci(Re,0,vn),b:Je==null?null:ci(Je,0,Nr)}},CO_MAX_A:vn,CO_MAX_B:Nr}},yt=zt(E.cia1,1,2),St=zt(E.cia2,3,4),sr=zt(E.model,5,null),pr=(we,Ie,tt)=>we==null||!Ie||!Number.isFinite(Ie)?null:ci(we/Ie*tt,0,tt);return p.map((we,Ie)=>{const tt=yt.get(we.id),dt=St.get(we.id),xt=sr.get(we.id),Cr=null,nn=pr(tt.a,yt.CO_MAX_A,I),ct=null,Ht=null,Ue=pr(tt.b,yt.CO_MAX_B,Oe),qe=null,at=null,Be=pr(dt.a,St.CO_MAX_A,_e),vt=null,jt=null,$t=pr(dt.b,St.CO_MAX_B,Ct),Rr=null,Ur=null,en=null,vn=null,Nr=null,fn=pr(xt.a,sr.CO_MAX_A,fe),rr=[Cr,nn,ct,Ht,Ue,qe,at,Be,vt,jt,$t,Rr,Ur,en,vn,Nr,fn],ve=J.visible.map(Pr=>rr[Pr]),ut=ve.some(Pr=>typeof Pr=="number"&&Number.isFinite(Pr))?$f(ve.reduce((Pr,Kr)=>Pr+(typeof Kr=="number"&&Number.isFinite(Kr)?Kr:0),0)):null,pt=ut==null||!q?null:$f(ut/q*100);return{sno:Ie+1,...we,cells:ve,total:ut,pct:pt}})}return p.map((Ve,zt)=>{const yt=No(A.ssa1[String(Ve.id)]),St=No(A.ssa2[String(Ve.id)]),sr=yt==null?null:Number(yt)/2,pr=St==null?null:Number(St)/2,we=sr==null?null:ci(sr,0,Fe.ssa1.co1),Ie=sr==null?null:ci(sr,0,Fe.ssa1.co2),tt=pr==null?null:ci(pr,0,Fe.ssa2.co3),dt=pr==null?null:ci(pr,0,Fe.ssa2.co4),xt=(A.f1||{})[String(Ve.id)]||{},Cr=(A.f2||{})[String(Ve.id)]||{},nn=No(xt==null?void 0:xt.skill1)!=null&&No(xt==null?void 0:xt.att1)!=null?ci(Number(xt.skill1)+Number(xt.att1),0,Fe.f1.co1):null,ct=No(xt==null?void 0:xt.skill2)!=null&&No(xt==null?void 0:xt.att2)!=null?ci(Number(xt.skill2)+Number(xt.att2),0,Fe.f1.co2):null,Ht=No(Cr==null?void 0:Cr.skill1)!=null&&No(Cr==null?void 0:Cr.att1)!=null?ci(Number(Cr.skill1)+Number(Cr.att1),0,Fe.f2.co3):null,Ue=No(Cr==null?void 0:Cr.skill2)!=null&&No(Cr==null?void 0:Cr.att2)!=null?ci(Number(Cr.skill2)+Number(Cr.att2),0,Fe.f2.co4):null,qe=No(P.r1[String(Ve.id)]),at=No(P.r2[String(Ve.id)]),Be=qe==null?null:Number(qe)/2,vt=at==null?null:Number(at)/2,jt=Be==null?null:ci(Be,0,Fe.review1.co1),$t=Be==null?null:ci(Be,0,Fe.review1.co2),Rr=vt==null?null:ci(vt,0,Fe.review2.co3),Ur=vt==null?null:ci(vt,0,Fe.review2.co4),en=(mn,cn,xn)=>{const Ir=mn!=null&&mn.sheet&&typeof mn.sheet=="object"?mn.sheet:{},jn=Ir!=null&&Ir.rowsByStudentId&&typeof Ir.rowsByStudentId=="object"?Ir.rowsByStudentId:{},Hn=30/2,Mn=Ir!=null&&Ir.coConfigs&&typeof Ir.coConfigs=="object"?Ir.coConfigs:null,Kn=Mn?Mn[String(cn)]:null,Fn=xn!=null&&Mn?Mn[String(xn)]:null,Xi=ci(Number((Ir==null?void 0:Ir.expCountA)??0),0,12),zo=ci(Number((Ir==null?void 0:Ir.expCountB)??0),0,12),Ol=(Ir==null?void 0:Ir.coAEnabled)!==!1,Ya=xn!=null?(Ir==null?void 0:Ir.coBEnabled)!==!1:!1,Wo=Kn?!!Kn.enabled:Ol,Ml=xn!=null?Fn?!!Fn.enabled:Ya:!1,dl=Kn?ci(Number(Kn.expCount??0),0,12):Xi,xa=xn!=null?Fn?ci(Number(Fn.expCount??0),0,12):zo:0,oa=Kn&&Number.isFinite(Number(Kn.expMax))?Number(Kn.expMax):Number.isFinite(Number(Ir==null?void 0:Ir.expMaxA))?Number(Ir.expMaxA):25,la=xn!=null?Fn&&Number.isFinite(Number(Fn.expMax))?Number(Fn.expMax):Number.isFinite(Number(Ir==null?void 0:Ir.expMaxB))?Number(Ir.expMaxB):25:0,ya=(Ir==null?void 0:Ir.ciaExamEnabled)!==!1,qo=oa+(ya?Hn:0),gi=xn!=null?la+(ya?Hn:0):0,Js=ki=>Array.isArray(ki)?ki.map(Ei=>typeof Ei=="number"&&Number.isFinite(Ei)?Ei:null):[],uc=ki=>{const Ei=(ki||[]).filter(Qi=>typeof Qi=="number"&&Number.isFinite(Qi));return Ei.length?Ei.reduce((Qi,yo)=>Qi+yo,0)/Ei.length:null};return{get:ki=>{const Ei=jn[String(ki)]||{},Qi=Ei!=null&&Ei.marksByCo&&typeof Ei.marksByCo=="object"?Ei.marksByCo:{},yo=(Qi==null?void 0:Qi[String(cn)])??(Ei==null?void 0:Ei.marksA),pd=xn!=null?(Qi==null?void 0:Qi[String(xn)])??(Ei==null?void 0:Ei.marksB):[],md=Js(yo).slice(0,Wo?dl:0),ku=Js(pd).slice(0,Ml?xa:0),yf=uc(md),Gc=uc(ku),fc=Ei==null?void 0:Ei.ciaExam,hc=typeof fc=="number"&&Number.isFinite(fc)?fc:null,ju=yf!=null||Gc!=null||hc!=null,Kc=ju?(yf??0)+(ya?(hc??0)/2:0):null,Au=ju?(Gc??0)+(ya?(hc??0)/2:0):null;return{a:Kc==null?null:ci(Kc,0,qo),b:Au==null?null:ci(Au,0,gi)}},CO_MAX_A:qo,CO_MAX_B:gi}},vn=O==="TCPL"?en(F.lab1,1,2):null,Nr=O==="TCPL"?en(F.lab2,3,4):null,fn=vn?vn.get(Ve.id):null,rr=Nr?Nr.get(Ve.id):null,ve=(fn==null?void 0:fn.a)??null,rt=(fn==null?void 0:fn.b)??null,ut=(rr==null?void 0:rr.a)??null,pt=(rr==null?void 0:rr.b)??null,Pr=Zr[String(Ve.id)]||{},Kr=Xr[String(Ve.id)]||{},pn=!!(Pr!=null&&Pr.absent),Nn=!!(Kr!=null&&Kr.absent);let _n=null,kn=null;if(!pn){const mn=Pr!=null&&Pr.q&&typeof Pr.q=="object"?Pr.q:{};let cn=!1,xn=0,Ir=0;for(let jn=0;jn<Tt.length;jn++){const Hn=Tt[jn],Mn=No(mn==null?void 0:mn[Hn.key]);if(Mn==null)continue;cn=!0;const Kn=ci(Mn,0,Hn.max||Mn),Fn=kj(Tt,jn);xn+=Kn*Fn.co1,Ir+=Kn*Fn.co2}cn&&(_n=ci(xn,0,Fe.cia1.co1),kn=ci(Ir,0,Fe.cia1.co2))}let Wn=null,M=null;if(!Nn){const mn=Kr!=null&&Kr.q&&typeof Kr.q=="object"?Kr.q:{};let cn=!1,xn=0,Ir=0;for(let jn=0;jn<xr.length;jn++){const Hn=xr[jn],Mn=No(mn==null?void 0:mn[Hn.key]);if(Mn==null)continue;cn=!0;const Kn=ci(Mn,0,Hn.max||Mn),Fn=jj(xr,jn);xn+=Kn*Fn.co3,Ir+=Kn*Fn.co4}cn&&(Wn=ci(xn,0,Fe.cia2.co3),M=ci(Ir,0,Fe.cia2.co4))}const oe=Lt(we,Fe.ssa1.co1,ae),Re=Lt(_n,Fe.cia1.co1,I),Je=O==="TCPR"?Lt(jt,Fe.review1.co1,Z):O==="TCPL"?Lt(ve,(vn==null?void 0:vn.CO_MAX_A)??Fe.f1.co1,Z):Lt(nn,Fe.f1.co1,Z),kt=Lt(Ie,Fe.ssa1.co2,pe),mr=Lt(kn,Fe.cia1.co2,Oe),lr=O==="TCPR"?Lt($t,Fe.review1.co2,Ae):O==="TCPL"?Lt(rt,(vn==null?void 0:vn.CO_MAX_B)??Fe.f1.co2,Ae):Lt(ct,Fe.f1.co2,Ae),Sr=Lt(tt,Fe.ssa2.co3,ke),Hr=Lt(Wn,Fe.cia2.co3,_e),Jr=O==="TCPR"?Lt(Rr,Fe.review2.co3,De):O==="TCPL"?Lt(ut,(Nr==null?void 0:Nr.CO_MAX_A)??Fe.f2.co3,De):Lt(Ht,Fe.f2.co3,De),me=Lt(dt,Fe.ssa2.co4,We),Pe=Lt(M,Fe.cia2.co4,Ct),et=O==="TCPR"?Lt(Ur,Fe.review2.co4,_t):O==="TCPL"?Lt(pt,(Nr==null?void 0:Nr.CO_MAX_B)??Fe.f2.co4,_t):Lt(Ue,Fe.f2.co4,_t),xe=vr(Ve),ze=Lt(xe.co1,xe.max.co1,Xe),Vt=Lt(xe.co2,xe.max.co2,nt),Nt=Lt(xe.co3,xe.max.co3,Ne),br=Lt(xe.co4,xe.max.co4,be),wr=Lt(xe.co5,xe.max.co5,fe),zr=[oe,Re,Je,kt,mr,lr,Sr,Hr,Jr,me,Pe,et,ze,Vt,Nt,br,wr],Wr=J.visible.map(mn=>zr[mn]),an=Wr.some(mn=>typeof mn=="number"&&Number.isFinite(mn))?$f(Wr.reduce((mn,cn)=>mn+(typeof cn=="number"&&Number.isFinite(cn)?cn:0),0)):null,Lr=an==null||!q?null:$f(an/q*100);return{sno:zt+1,...Ve,cells:Wr,total:an,pct:Lr}})},[J,A,P,E,F,z,p,w,q,e,s,f,u,de,G]),Q=J.header,ie=J.cycles,le=J.weights;return a.jsxs("div",{style:{padding:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0},children:"INTERNAL MARK"}),a.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Summative + Formative (based on IQAC mapping)"})]}),a.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:a.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("span",{style:{color:"#374151",fontWeight:700},children:"Section"}),a.jsxs("select",{value:s??"",onChange:O=>o(O.target.value?Number(O.target.value):null),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",disabled:!0,children:""}),n.map(O=>{const H=O.department,ae=(H==null?void 0:H.short_name)||(H==null?void 0:H.code)||(H==null?void 0:H.name)||O.department_name||"",I=O.semester,Z=`${O.section_name||`TA ${O.id}`} ${I?` Sem ${I}`:""} ${ae?` ${ae}`:""}`;return a.jsx("option",{value:O.id,children:Z},O.id)})]})]})})]}),l?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:l}):null,g?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:g}):null,K?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:K}):null,b||X?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading"}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",fontSize:12},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"S.No"}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Register No."}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Name"}),Q.map((O,H)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:String(O)},H)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:$f(q)}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"100"})]}),a.jsxs("tr",{children:[a.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"internal weightage"}),le.map((O,H)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:Number(O).toFixed(1)},`w-${H}`)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]}),a.jsxs("tr",{children:[a.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"cycle"}),ie.map((O,H)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"},children:String(O)},`c-${H}`)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]})]}),a.jsx("tbody",{children:Y.map(O=>a.jsxs("tr",{children:[a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:O.sno}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:O.reg_no}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:O.name}),(Array.isArray(O.cells)?O.cells:[]).map((H,ae)=>a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:H==null?"":Number(H).toFixed(2)},ae)),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center",fontWeight:800},children:O.total==null?"":Number(O.total).toFixed(2)}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:O.pct==null?"":Number(O.pct).toFixed(2)})]},O.id))})]})})]})}function OOe(){const{code:e}=U0(),t=go(),r=ul(),n=e?decodeURIComponent(e):"",[i,s]=hn.useState(()=>"marks"),[o,l]=hn.useState(null),[c,u]=hn.useState(null),[d,f]=hn.useState(!1),[h,p]=hn.useState(()=>{if(!n)return"QP1";try{const b=localStorage.getItem(`obe_course_qp_${n}`);return String(b||"").trim().toUpperCase()==="QP2"?"QP2":"QP1"}catch{return"QP1"}}),[m,g]=hn.useState(null);hn.useEffect(()=>{if(!r||!r.pathname)return;const b=r.pathname.toLowerCase();b.includes("/lca/instructions")||b.includes("/lca_instructions")||b.includes("/lca")||b.includes("/cdap")||b.includes("/articulation")?s("lca_instructions"):b.includes("/marks")?s("marks"):b.includes("/co_attainment")?s("co_attainment"):b.includes("/internal_mark")||b.includes("/internal-mark")?s("internal_mark"):b.includes("/cqi")?s("cqi"):s("marks")},[r]);const y=hn.useMemo(()=>{const b=String((r==null?void 0:r.pathname)||"").toLowerCase();return b.includes("/cdap")?"cdap":b.includes("/articulation")?"articulation":b.includes("/lca")&&!(b.includes("/lca/instructions")||b.includes("/lca_instructions"))?"lca":"instructions"},[r==null?void 0:r.pathname]);return hn.useEffect(()=>{if(!n)return;let b=!0;return(async()=>{try{b&&f(!1);const v=await lc();if(!b)return;const w=(v||[]).filter(L=>String(L.subject_code)===String(n)),S=w[0]||null;S&&l(S.subject_name||null);let k=null;try{const L=localStorage.getItem(`markEntry_selectedTa_${n}`),P=L==null?NaN:Number(L);k=Number.isFinite(P)?P:null}catch{k=null}const j=k!=null&&w.find(L=>Number(L.id)===Number(k))||w.find(L=>String((L==null?void 0:L.class_type)||"").trim())||S,A=String((j==null?void 0:j.class_type)||"").trim();A&&(u(A),f(!0))}catch{}})(),()=>{b=!1}},[n]),hn.useEffect(()=>{if(!n)return;let b=!0;return(async()=>{try{const v=await bl();if(!b)return;const w=String(n),S=w.toUpperCase(),k=(v||[]).filter(B=>String((B==null?void 0:B.course_code)||"").trim()===w||String((B==null?void 0:B.course_code)||"").trim().toUpperCase()===S),j=B=>String(B||"").trim().toUpperCase(),A=k.find(B=>{const E=j(B==null?void 0:B.question_paper_type);return E&&E!=="QP1"})||k.find(B=>j(B==null?void 0:B.question_paper_type))||k.find(B=>String((B==null?void 0:B.class_type)||"").trim())||k[0];if(!d&&A&&A.class_type){const B=String(A.class_type||"").trim();u(B||null)}else if(!d)try{const B=await hm();if(!b)return;const E=(Array.isArray(B)?B:B.results||[]).find(T=>String(T.course_code||"").trim().toUpperCase()===S);E&&E.class_type&&(u(String(E.class_type||"").trim()||null),Array.isArray(E.enabled_assessments)&&E.enabled_assessments.length&&g(E.enabled_assessments.map(T=>String(T).trim().toLowerCase()).filter(Boolean)))}catch{}let L=null;try{L=localStorage.getItem(`obe_course_qp_${n}`)}catch{L=null}const P=String(L||"").trim().toUpperCase();if(P==="QP1"||P==="QP2")p(P);else{const B=String((A==null?void 0:A.question_paper_type)||"").trim().toUpperCase();p(B==="QP2"?"QP2":"QP1")}if(ti(A==null?void 0:A.class_type)==="SPECIAL"){g([]);try{const B=await wS(w);g(Array.isArray(B)?B:[])}catch{const B=A==null?void 0:A.enabled_assessments;g(Array.isArray(B)?B.map(E=>String(E).trim().toLowerCase()).filter(Boolean):[])}}else g(null)}catch{}})(),()=>{b=!1}},[n]),e?a.jsx("main",{className:"obe-course-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:a.jsxs("div",{style:{width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsx("div",{style:{marginBottom:24,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:24,flexWrap:"wrap"},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("h2",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:["OBE - ",n]}),a.jsx("div",{style:{color:"#64748b",marginTop:8,fontSize:16},children:"Course OBE workspace"}),o&&a.jsx("div",{style:{color:"#1e293b",marginTop:12,fontWeight:700,fontSize:20},children:o}),a.jsxs("div",{style:{marginTop:16,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[c&&a.jsxs("div",{style:{background:"#eff6ff",color:"#3b82f6",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #bfdbfe"},children:[" Class type: ",a.jsx("strong",{children:String(c).toLowerCase()[0].toUpperCase()+String(c).toLowerCase().slice(1)})]}),a.jsxs("div",{style:{background:"#f8fafc",color:"#475569",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:8},children:[a.jsx("span",{children:" QP Type:"}),a.jsxs("select",{value:String(h||"QP1").trim().toUpperCase()==="QP2"?"QP2":"QP1",onChange:b=>{const w=String(b.target.value||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";p(w);try{localStorage.setItem(`obe_course_qp_${n}`,w)}catch{}},style:{padding:"4px 10px",borderRadius:6,border:"1px solid #cbd5e1",fontSize:14,fontWeight:600,color:"#0f172a",background:"#fff",cursor:"pointer"},children:[a.jsx("option",{value:"QP1",children:"QP1"}),a.jsx("option",{value:"QP2",children:"QP2"})]})]})]})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>t("/obe"),onMouseEnter:b=>{b.currentTarget.style.background="#f8fafc",b.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:b=>{b.currentTarget.style.background="#fff",b.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"10px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",cursor:"pointer",fontWeight:600,fontSize:15,transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:" Back to courses"})})]})}),a.jsx("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)",flexWrap:"wrap"},"aria-label":"OBE Tabs",children:[{key:"lca_instructions",label:" Learner Centric Approach",icon:""},{key:"marks",label:" Mark Entry",icon:""},{key:"co_attainment",label:" CO Attainment",icon:""},{key:"cqi",label:" CQI",icon:""},{key:"internal_mark",label:" Internal Mark",icon:""}].map(b=>{const v=i===b.key;return a.jsx("button",{onClick:()=>{if(s(b.key),e){const w=encodeURIComponent(e),S=b.key==="lca_instructions"?"lca/instructions":String(b.key);t(`/obe/course/${w}/${S}`)}},onMouseEnter:w=>{v||(w.currentTarget.style.background="rgba(59,130,246,0.08)",w.currentTarget.style.color="#3b82f6")},onMouseLeave:w=>{v||(w.currentTarget.style.background="transparent",w.currentTarget.style.color="#64748b")},style:{padding:"10px 24px",borderRadius:8,border:"none",background:v?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:v?"#fff":"#64748b",cursor:"pointer",fontWeight:v?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:v?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:b.label},b.key)})}),a.jsxs("div",{children:[i==="marks"&&a.jsx(kOe,{courseId:n,classType:c,questionPaperType:h,enabledAssessments:m}),i==="lca_instructions"&&a.jsx(NK,{courseCode:n,courseName:o,initialTab:y}),i==="co_attainment"&&a.jsx(EK,{courseId:n,enabledAssessments:m,classType:c}),i==="internal_mark"&&a.jsx(POe,{courseId:n,enabledAssessments:m}),i==="cqi"&&a.jsx(TK,{courseId:n})]})]})}):a.jsxs("div",{style:{padding:24},children:[a.jsx("p",{style:{color:"#666"},children:"No course selected."}),a.jsx("button",{onClick:()=>t("/obe"),className:"obe-btn obe-btn-primary",children:"Back"})]})}function MOe(){const e=go(),[t]=HJ(),r=x.useMemo(()=>{const y=String(t.get("subject_code")||"").trim(),b=String(t.get("assessment")||"").trim().toLowerCase(),v=String(t.get("reason")||"Edit Marks").trim(),w=t.get("teaching_assignment_id"),S=w?Number(w):void 0;return{subject_code:y,assessment:b,reason:v,teaching_assignment_id:Number.isFinite(S)?S:void 0}},[t]),[n,i]=x.useState(r.subject_code),[s,o]=x.useState(r.assessment),[l,c]=x.useState(r.reason),[u,d]=x.useState(String(r.teaching_assignment_id??"")),[f,h]=x.useState(!1),[p,m]=x.useState(null);async function g(){h(!0),m(null);try{const y=(u||"").trim(),b=y?Number(y):void 0;await Sh({assessment:s,subject_code:n,reason:l,teaching_assignment_id:Number.isFinite(b)?b:void 0,force:!0}),alert("Edit request sent to IQAC."),e(-1)}catch(y){m((y==null?void 0:y.message)||"Request failed")}finally{h(!1)}}return a.jsxs("div",{style:{maxWidth:720},children:[a.jsx("div",{style:{fontWeight:900,fontSize:16,marginBottom:12},children:"OBE Request"}),a.jsx("div",{className:"obe-card",children:a.jsxs("div",{style:{display:"grid",gap:10},children:[a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Subject Code"}),a.jsx("input",{className:"obe-input",value:n,onChange:y=>i(y.target.value),placeholder:"e.g., GEA1268"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Assessment"}),a.jsx("input",{className:"obe-input",value:s,onChange:y=>o(y.target.value),placeholder:"cia1 | cia2 | model | formative1 | formative2"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Teaching Assignment ID (optional)"}),a.jsx("input",{className:"obe-input",value:u,onChange:y=>d(y.target.value),placeholder:"e.g., 123"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Reason"}),a.jsx("textarea",{className:"obe-input",value:l,onChange:y=>c(y.target.value),rows:3,placeholder:"Edit Marks",style:{resize:"vertical"}})]}),p?a.jsx("div",{className:"obe-danger-pill",children:p}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{className:"obe-btn",type:"button",onClick:()=>e(-1),disabled:f,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-primary",type:"button",onClick:g,disabled:f||!n||!s,children:f?"Requesting":"Request Edit"})]})]})})]})}function LOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(!1),[d,f]=x.useState(null),[h,p]=x.useState(new Set);x.useEffect(()=>{m()},[]);async function m(){l(!0);try{const v=await yr("/api/academics/section-advisors/?page_size=0"),w=await yr("/api/academics/sections/?page_size=0"),S=await yr("/api/academics/hod-staff/?page_size=0"),k=await yr("/api/accounts/me/");async function j(A){if(!(A.headers.get("content-type")||"").includes("application/json")){const P=await A.text();throw console.error("Expected JSON but got:",P),new Error("Server returned non-JSON response (see console)")}return A.json()}if(v.ok){const A=await j(v);s(A.results||A)}if(w.ok){const A=await j(w);t(A.results||A)}if(S.ok){const A=await j(S);n(A.results||A)}if(k.ok){const A=await j(k);u(!!(A.permissions&&(A.permissions.includes("academics.assign_advisor")||A.permissions.includes("academics.add_sectionadvisor"))))}}catch(v){console.error(v),alert("Failed to load HOD assignments. Check console for server response.")}finally{l(!1)}}async function g(v,w){l(!0);try{if(!c)return alert("You do not have permission to assign advisors");const k=await yr("/api/academics/section-advisors/",{method:"POST",body:JSON.stringify({section_id:v,advisor_id:w,is_active:!0})});if(k.ok)p(j=>{const A=new Set(j);return A.delete(v),A}),await m();else{const j=await k.text();alert("Error: "+j)}}finally{l(!1)}}function y(v){p(w=>{const S=new Set(w);return S.has(v)?S.delete(v):S.add(v),S})}function b(v){return i.find(w=>w.section_id===v&&w.is_active)}return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(z0,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Advisor Assign"}),a.jsx("p",{className:"text-gray-600",children:"Assign advisors to sections and edit existing assignments"})]})]})}),o&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Loading assignments..."})]})}),!o&&e.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>v>0).map(v=>{var j,A;const w=e.filter(L=>(L.department_id||0)===v);if(w.length===0)return null;const S=((j=w[0])==null?void 0:j.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Dept ${v}`,k=d===v;return a.jsx("button",{onClick:()=>f(k?null:v),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${k?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S},v)})]})]}),a.jsx("div",{className:"space-y-6",children:Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>d===null||d===v).map(v=>{var j,A;const w=e.filter(L=>(L.department_id||0)===v);if(w.length===0)return null;const S=((j=w[0])==null?void 0:j.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Department ${v}`,k=r.filter(L=>(L.department||0)===v);return a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:[S," Department"]}),a.jsx("div",{className:"overflow-x-auto mb-6",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Section"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Select Advisor"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:w.map(L=>{const P=b(L.id),B=h.has(L.id),E=!P||B;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 text-gray-700",children:L.name}),a.jsx("td",{className:"px-4 py-3",children:E?a.jsxs("select",{id:`advisor-${L.id}`,className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:(P==null?void 0:P.advisor_id)||"",children:[a.jsx("option",{value:"",children:"-- Select Advisor --"}),k.map(T=>a.jsxs("option",{value:T.id,children:[T.staff_id," - ",T.user]},T.id))]}):a.jsx("div",{className:"text-gray-900 font-medium",children:(P==null?void 0:P.advisor)||"No advisor assigned"})}),a.jsx("td",{className:"px-4 py-3",children:P&&!B?a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>c&&y(L.id),title:"Edit Assignment",children:a.jsx(ch,{className:"h-4 w-4"})}):a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>{if(!c)return;const F=document.getElementById(`advisor-${L.id}`).value;if(!F)return alert("Select an advisor first");g(L.id,Number(F))},title:"Save Assignment",children:a.jsx(nd,{className:"h-4 w-4"})}),B&&a.jsx("button",{className:"p-2 text-sm font-medium rounded-lg transition-colors text-red-600 hover:bg-red-50 border border-red-300",onClick:()=>y(L.id),title:"Cancel",children:a.jsx(gu,{className:"h-4 w-4"})}),P&&a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors flex items-center justify-center ${c?"bg-red-50 text-red-700 border border-red-300 hover:bg-red-100":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:async()=>{if(c&&confirm("Delete advisor assignment for this section?"))try{const T=await yr(`/api/academics/section-advisors/${P.id}/`,{method:"DELETE"});if(!T.ok){const F=await T.text();return alert("Delete failed: "+F)}await m()}catch(T){console.error(T),alert("Delete failed")}},title:"Delete Assignment",children:a.jsx(o1,{className:"h-4 w-4"})})]})})]},L.id)})})]})})]},v)})})]}),!o&&e.length===0&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ms,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sections available"}),a.jsx("p",{className:"text-gray-600",children:"There are no sections available for advisor assignment at this time."})]})})]})})}const ZB=e=>{if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id},eF=e=>{if(!e)return"";if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id||""};function ROe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState([]),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState([]),[S,k]=x.useState(!0),[j,A]=x.useState(new Set),[L,P]=x.useState(new Set),B=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),E=B.includes("academics.view_elective_teaching"),T=B.includes("academics.assign_elective_teaching");x.useEffect(()=>{F()},[]);async function F(){try{k(!0);const R=await yr("/api/academics/my-students/?page_size=0"),J=E||T?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0";let q=await yr(c&&J.includes("hod-staff")?`${J}&department=${c}`:J);if(q.status===403&&J.includes("hod-staff")){console.warn("hod-staff returned 403  falling back to advisor-staff endpoint");const O=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const H=await yr(O);H.ok&&(q=H)}catch(H){console.error("fallback to advisor-staff failed",H)}}const Y=await yr("/api/curriculum/department/?page_size=0"),Q=await yr("/api/curriculum/elective/?page_size=0"),ie=await yr("/api/academics/teaching-assignments/?page_size=0"),le=async O=>{if(!(O.headers.get("content-type")||"").includes("application/json"))throw new Error("non-json");return O.json()};if(R.ok){const O=await le(R),H=(O.results||O).map(ae=>({id:ae.section_id,name:ae.section_name,batch:ae.batch,batch_regulation:ae.batch_regulation,department_id:ae.department_id,semester:ae.semester,department:ae.department}));t(H)}if(q.ok){const O=await le(q);let H=O.results||O;c&&(H=H.filter(ae=>ae.department&&ae.department.id===c||ae.department===c)),n(H)}if(Y.ok){const O=await le(Y),H=O.results||O;p(H),w(H.filter(I=>I.is_elective));const ae=new Map;H.forEach(I=>{I.department&&I.department.id&&ae.set(I.department.id,I.department)}),ae.size>0&&l(Array.from(ae.values()));try{const I=await yr("/api/academics/departments/?page_size=0");if(I.ok){const Z=await le(I),pe=Z.results||Z;Array.isArray(pe)&&pe.length>0&&s(pe)}else ae.size>0&&s(Array.from(ae.values()))}catch{ae.size>0&&s(Array.from(ae.values()))}}if(Q.ok){const O=await le(Q);b(O.results||O)}if(ie.ok){const O=await le(ie);g(O.results||O)}}catch(R){console.error(R),alert("Failed to load teaching assignment data")}finally{k(!1)}}x.useEffect(()=>{async function R(){try{const J=E||T?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0",q=c&&J.includes("hod-staff")?`${J}&department=${c}`:J,Y=await yr(q);let Q=Y;if(Y.status===403&&J.includes("hod-staff")){console.warn("hod-staff returned 403 in loadStaff  trying advisor-staff");const O=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const H=await yr(O);if(H.ok)Q=H;else if(H.status!==200)return}catch(H){console.error("fallback failed",H);return}}if(!Q.ok)return;const ie=await Q.json();let le=ie.results||ie;!J.includes("hod-staff")&&c&&(le=le.filter(O=>O.department&&O.department.id===c||O.department===c)),n(le)}catch(J){console.error("loadStaff failed",J)}}R()},[c]);const W=(R,J)=>m.find(q=>{const Y=q.section_details&&q.section_details.id===R||q.section_details&&q.section_details.id===R||q.section===R||q.section_id===R,Q=q.curriculum_row_details&&q.curriculum_row_details.id===J||q.curriculum_row_details&&q.curriculum_row_details.id===J||q.curriculum_row&&q.curriculum_row.id===J||q.curriculum_row_id===J;return Y&&Q}),z=(R,J)=>`${R}-${J}`,se=(R,J)=>{const q=z(R,J);A(Y=>new Set(Y).add(q))},de=(R,J)=>{const q=z(R,J);A(Y=>{const Q=new Set(Y);return Q.delete(q),Q})},U=(R,J)=>{const q=z(R,J);return j.has(q)},G=R=>m.find(J=>{const q=J.elective_subject_id||J.elective_subject&&J.elective_subject.id||J.elective_subject_details&&J.elective_subject_details.id||J.elective_subject;return Number(q)===Number(R)}),re=R=>`elective-${R}`,X=R=>{const J=re(R);P(q=>new Set(q).add(J))},C=R=>{const J=re(R);P(q=>{const Y=new Set(q);return Y.delete(J),Y})},K=R=>{const J=re(R);return L.has(J)};async function V(R,J,q){if(!J)return alert("Select staff"),Promise.reject("No staff selected");try{if(q){const Y={staff_id:Number(J),is_active:!0},Q=await yr(`/api/academics/teaching-assignments/${q}/`,{method:"PATCH",body:JSON.stringify(Y)});if(Q.ok)return alert("Updated successfully"),F(),Promise.resolve();{const ie=await Q.text();return alert("Error: "+ie),Promise.reject(ie)}}else{const Y={elective_subject_id:R,staff_id:Number(J),is_active:!0},Q=await yr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(Y)});if(Q.ok)return alert("Assigned successfully"),F(),Promise.resolve();{const ie=await Q.text();return alert("Error: "+ie),Promise.reject(ie)}}}catch(Y){return alert("Error: "+Y),Promise.reject(Y)}}return S?a.jsx("div",{style:{padding:"28px",minHeight:"100vh",background:"linear-gradient(180deg, #f7fbff 0%, #ffffff 60%)"},children:a.jsx("div",{style:{padding:"16px",borderRadius:"8px",background:"#fff",border:"1px solid rgba(15,23,42,0.04)",color:"#6b7280"},children:"Loading teaching assignments"})}):a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(z0,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teaching Assign"}),a.jsx("p",{className:"text-gray-600",children:"Assign faculty to courses and sections"})]})]})}),i.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filters"}),a.jsx("div",{className:"flex flex-wrap gap-4",children:i.length>0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Department:"}),a.jsxs("select",{value:c??"",onChange:R=>u(R.target.value?Number(R.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"All Departments"}),i.map(R=>a.jsx("option",{value:R.id,children:R.short_name||R.code||R.name||`Dept ${R.id}`},R.id))]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(ms,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Assignments"})]}),e.length===0?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"text-gray-500 text-sm",children:"No sections available for the selected filters."})}):a.jsx("div",{className:"space-y-6",children:e.map(R=>{const J=h.filter(q=>(R.semester?q.semester===R.semester:!0)&&(R.batch_regulation?q.regulation===R.batch_regulation.code:!0)&&!q.is_elective);return a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-blue-900",children:[R.batch," / ",R.name]}),a.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[a.jsxs("p",{className:"text-blue-700 text-sm",children:["Semester: ",R.semester||"Not specified"]}),R.batch_regulation&&a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 border border-indigo-200",children:["Regulation: ",R.batch_regulation.code]})]})]}),a.jsxs("div",{className:"text-blue-600 text-sm font-medium",children:["Section ID: ",R.id]})]})}),J.length===0?a.jsx("div",{className:"text-gray-500 text-sm py-4",children:"No subjects available for this section."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Assigned Staff"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:J.map(q=>{var ie,le;const Y=W(R.id,q.id),Q=U(R.id,q.id);return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:q.course_code||"-"}),a.jsx("td",{className:"px-4 py-3 text-gray-700",children:q.course_name||"Unnamed"}),a.jsx("td",{className:"px-4 py-3",children:Q?a.jsxs("select",{id:`staff-${R.id}-${q.id}`,defaultValue:((ie=Y==null?void 0:Y.staff_details)==null?void 0:ie.id)||(Y==null?void 0:Y.staff)||"",className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"-- select staff --"}),r.map(O=>a.jsxs("option",{value:O.id,children:[O.staff_id," - ",ZB(O)]},O.id))]}):Y?a.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(le=Y.staff_details)==null?void 0:le.staff_id," - ",eF(Y.staff_details)]}):a.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("div",{className:"flex items-center justify-center gap-2",children:Q?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>{const O=document.getElementById(`staff-${R.id}-${q.id}`);if(!(O!=null&&O.value))return alert("Select staff member");if(Y){const H={staff_id:Number(O.value),is_active:!0};yr(`/api/academics/teaching-assignments/${Y.id}/`,{method:"PATCH",body:JSON.stringify(H)}).then(ae=>{ae.ok?(alert("Updated successfully"),de(R.id,q.id),F()):ae.text().then(I=>alert("Error: "+I))})}else{const H={section_id:R.id,staff_id:Number(O.value),curriculum_row_id:q.id,is_active:!0};yr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(H)}).then(ae=>{ae.ok?(alert("Assigned successfully"),de(R.id,q.id),F()):ae.text().then(I=>alert("Error: "+I))})}},className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors border border-green-300",title:"Save Assignment",children:a.jsx(nd,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>de(R.id,q.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:a.jsx(gu,{className:"h-4 w-4"})}),Y&&a.jsx("button",{onClick:async()=>{if(confirm("Delete teaching assignment for this subject/section?"))try{const O=await yr(`/api/academics/teaching-assignments/${Y.id}/`,{method:"DELETE"});if(O.ok)alert("Deleted"),de(R.id,q.id),F();else{const H=await O.text().catch(()=>null);alert("Failed: "+(H||O.status))}}catch(O){console.error(O),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:a.jsx(o1,{className:"h-4 w-4"})})]}):a.jsx(a.Fragment,{children:a.jsx("button",{onClick:()=>se(R.id,q.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:a.jsx(ch,{className:"h-4 w-4"})})})})})]},`${R.id}-${q.id}`)})})]})})]},R.id)})})]}),E&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Elective Subject Assignments"}),o.length>1&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Filter by Department"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),o.map(R=>a.jsx("button",{onClick:()=>f(R.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===R.id?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:R.short_name||R.code||R.name||`Dept ${R.id}`},R.id))]})]}),a.jsx("div",{className:"space-y-4",children:v.filter(R=>!d||R.department&&R.department.id===d).length===0?a.jsx("div",{className:"text-gray-500 text-sm",children:"No elective parents found for the selected department."}):v.filter(R=>!d||R.department&&R.department.id===d).map(R=>a.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"flex justify-between items-center mb-4",children:a.jsx("div",{className:"font-semibold text-gray-900",children:R.course_name||R.course_code||"Elective"})}),a.jsx("div",{className:"space-y-3",children:(y&&y.filter(J=>J.parent===R.id)).map(J=>{var Q,ie;const q=G(J.id),Y=K(J.id);return console.log(`Elective ${J.course_code} (ID: ${J.id}):`,{opt:J,existingElectiveAssignment:q,allAssignments:m.filter(le=>le.subject&&(le.subject.includes(J.course_code)||le.subject.includes(J.course_name)))}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex-1 text-sm font-medium text-gray-900",children:[J.course_code||"-","  ",J.course_name||"-"]}),a.jsx("div",{className:"min-w-[200px]",children:Y?a.jsxs("select",{id:`elective-staff-${J.id}`,defaultValue:((Q=q==null?void 0:q.staff_details)==null?void 0:Q.id)||(q==null?void 0:q.staff)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"-- select staff --"}),r.map(le=>a.jsxs("option",{value:le.id,children:[le.staff_id," - ",ZB(le)]},le.id))]}):q?a.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(ie=q.staff_details)==null?void 0:ie.staff_id," - ",eF(q.staff_details)]}):a.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),a.jsx("div",{className:"flex items-center gap-2",children:Y?a.jsxs(a.Fragment,{children:[a.jsx("button",{disabled:!T,onClick:()=>{if(!T)return alert("No permission to assign electives");const le=document.getElementById(`elective-staff-${J.id}`);if(!(le!=null&&le.value))return alert("Select staff member");V(J.id,Number(le.value),q==null?void 0:q.id).then(()=>{C(J.id)}).catch(()=>{})},className:`p-2 rounded-lg transition-colors ${T?"text-green-600 hover:bg-green-50 border border-green-300":"text-gray-400 bg-gray-100 cursor-not-allowed border border-gray-300"}`,title:T?"Save Assignment":"No permission",children:a.jsx(nd,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>C(J.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:a.jsx(gu,{className:"h-4 w-4"})}),q&&a.jsx("button",{onClick:async()=>{if(confirm("Delete elective teaching assignment for this option?"))try{const le=await yr(`/api/academics/teaching-assignments/${q.id}/`,{method:"DELETE"});if(le.ok)alert("Deleted"),C(J.id),F();else{const O=await le.text().catch(()=>null);alert("Failed: "+(O||le.status))}}catch(le){console.error(le),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:a.jsx(o1,{className:"h-4 w-4"})})]}):a.jsx(a.Fragment,{children:a.jsx("button",{onClick:()=>X(J.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:a.jsx(ch,{className:"h-4 w-4"})})})})]},J.id)})})]},R.id))})]})]})})}function BOe(){const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState({});async function c(){t(!0),n(null);try{const m=await w9(),g=Array.isArray(m==null?void 0:m.results)?m.results:[];s(g)}catch(m){n((m==null?void 0:m.message)||"Failed to load requests")}finally{t(!1)}}x.useEffect(()=>{c()},[]);const u=x.useMemo(()=>[...i].sort((m,g)=>String(g.requested_at||"").localeCompare(String(m.requested_at||""))),[i]);function d(m){const g=String(m||"").trim();if(!g)return"?";const y=g.split(/\s+/g).filter(Boolean);return y.length===1?y[0].slice(0,2).toUpperCase():(y[0][0]+y[y.length-1][0]).toUpperCase()}function f(m){if(!m)return"";const g=new Date(m);return Number.isNaN(g.getTime())?String(m):g.toLocaleString()}async function h(m){l(g=>({...g,[m]:!0})),n(null);try{await N9(m),await c()}catch(g){n((g==null?void 0:g.message)||"Forward failed")}finally{l(g=>({...g,[m]:!1}))}}async function p(m){l(g=>({...g,[m]:!0})),n(null);try{await C9(m),await c()}catch(g){n((g==null?void 0:g.message)||"Reject failed")}finally{l(g=>({...g,[m]:!1}))}}return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:20},children:[a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:20},children:[a.jsx(rc,{size:24,color:"#9a3412"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:24,fontWeight:950,color:"#111827"},children:"HOD: OBE Edit Requests"}),a.jsx("div",{style:{color:"#6b7280",fontSize:14},children:"Approve requests from your department before they go to IQAC"})]}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:a.jsxs("button",{className:"obe-btn obe-btn-secondary",onClick:c,disabled:e,children:[a.jsx(O2,{size:16,style:{marginRight:6}}),e?"Refreshing":"Refresh"]})})]}),r?a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:12,borderRadius:12,marginBottom:20},children:[a.jsx(b3,{size:16,style:{marginRight:8,verticalAlign:"middle"}}),r]}):null,a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"Pending with HOD"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",u.length,")"]})]}),u.length===0?a.jsxs("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:[a.jsx(y3,{size:34,color:"#10b981",style:{marginBottom:8}}),a.jsx("div",{children:"No pending requests"})]}):a.jsx("div",{style:{display:"grid",gap:10},children:u.map(m=>{var v,w;const g=!!o[m.id],y=String(((v=m.staff)==null?void 0:v.name)||((w=m.staff)==null?void 0:w.username)||"Unknown"),b=m.scope==="MARK_MANAGER"?"Mark Manager":"Mark Entry";return a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#fff7ed",border:"1px solid #fed7aa",display:"grid",placeItems:"center",fontWeight:950,color:"#9a3412",flex:"0 0 auto"},children:d(y)}),a.jsxs("div",{style:{flex:1,minWidth:240},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:y}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[m.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:m.subject_name||m.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[b,"  ",String(m.assessment||"").toUpperCase(),"  ",f(m.requested_at)]}),m.reason?a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#374151"},children:[a.jsx("span",{style:{fontWeight:800},children:"Reason:"})," ",String(m.reason)]}):null]}),a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",flex:"0 0 auto"},children:[a.jsxs("div",{style:{background:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:800,whiteSpace:"nowrap"},children:[a.jsx(rc,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"Pending"]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsxs("button",{className:"obe-btn obe-btn-success",onClick:()=>h(m.id),disabled:g,children:[a.jsx(Pte,{size:16,style:{marginRight:6}}),g?"Forwarding":"Forward to IQAC"]}),a.jsx("button",{className:"obe-btn obe-btn-danger",onClick:()=>p(m.id),disabled:g,children:g?"Rejecting":"Reject"})]})]})]},m.id)})})]})]})}function FOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1),[i,s]=x.useState(null);x.useEffect(()=>{o()},[]),x.useEffect(()=>{e.length>0&&i===null&&s(e[0].section_id)},[e]);async function o(){n(!0);try{const u=await yr("/api/academics/my-students/");if(!u.ok)throw new Error(await u.text());const d=await u.json();t(d.results||[])}catch(u){console.error(u),alert("Failed to load your students. See console for details.")}finally{n(!1)}}const l=e.find(u=>u.section_id===i),c=[...(l==null?void 0:l.students)||[]].sort((u,d)=>u.reg_no.localeCompare(d.reg_no));return r?a.jsx("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ku,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"text-slate-600 text-lg",children:"Loading student information..."})]})}):a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(ey,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Students"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"View and manage your assigned student profiles"})]})]}),a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-slate-100 to-indigo-100 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-700"}),a.jsxs("span",{className:"text-sm font-semibold text-indigo-900",children:["Total: ",e.reduce((u,d)=>u+d.students.length,0)]})]})})]})}),e.length===0&&!r&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:a.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(ys,{className:"w-16 h-16 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No Students Assigned"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned to your sections yet."})]})}),e.length>0&&a.jsx("div",{className:"mb-6 flex flex-wrap gap-3",children:e.map(u=>{const d=i===u.section_id;return a.jsxs("button",{onClick:()=>s(u.section_id),className:`px-5 py-2 rounded-full font-medium text-sm transition-all duration-200 flex items-center gap-2 ${d?"bg-gradient-to-r from-indigo-600 to-cyan-500 text-white shadow-lg shadow-indigo-200":"bg-white text-slate-700 border border-slate-200 hover:border-indigo-300 hover:bg-slate-50"}`,children:[u.section_name,a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${d?"bg-white/25 text-white":"bg-slate-100 text-slate-700"}`,children:u.students.length})]},u.section_id)})}),c.length>0&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-indigo-50 border-b-2 border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"S.No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Registration No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Student Name"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Email"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map((u,d)=>a.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-medium text-slate-600",children:d+1})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:u.reg_no})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Kee,{className:"w-5 h-5 text-slate-400"}),a.jsx("span",{className:"text-sm font-medium text-slate-900",children:u.first_name&&u.last_name?`${u.first_name} ${u.last_name}`.trim():u.username})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("div",{className:"flex items-center gap-2 text-slate-600",children:u.email?a.jsxs(a.Fragment,{children:[a.jsx(v3,{className:"w-4 h-4 text-slate-400"}),a.jsx("span",{className:"text-sm",children:u.email})]}):a.jsx("span",{className:"text-sm text-slate-400",children:"-"})})})]},u.id))})]})})})]})}const IOe=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function tF(e){if(!e)return"";if(typeof e=="string"){const i=e.trim();return i.split(/[\s\-\_]+/)[0]||i.slice(0,15)+(i.length>15?"":"")}if(e.course_code)return e.course_code;const t=e.course_name||e.course||e.subject_text||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(i=>i.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function DOe(){const[e,t]=x.useState(null),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(null);x.useEffect(()=>{d()},[]);async function d(){try{const f=await yr("/api/accounts/me/");if(!f.ok)throw new Error(await f.text());const h=await f.json(),p=h.profile||{};u(h.id),p.section_id&&t(p.section_id)}catch(f){console.error(f)}}return x.useEffect(()=>{e&&(l(!0),(async()=>{try{const f=await yr(`/api/timetable/section/${e}/timetable/`);if(!f.ok)throw new Error(await f.text());let p=(await f.json()).results||[];n(p);const m=[];for(const g of p||[])for(const y of g.assignments||[])m.find(b=>b.id===y.period_id)||m.push({id:y.period_id,index:y.period_index,is_break:y.is_break,label:y.label});m.sort((g,y)=>(g.index||0)-(y.index||0)),s(m)}catch(f){console.error(f)}finally{l(!1)}})())},[e]),a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(xs,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),a.jsx("p",{className:"text-gray-600",children:"View your class schedule for the week"})]})]})}),o&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx(Ku,{className:"animate-spin h-5 w-5 text-indigo-600"}),a.jsx("span",{children:"Loading timetable..."})]})})}),!o&&!e&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(td,{className:"h-12 w-12 text-amber-500 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Section Not Assigned"}),a.jsx("p",{className:"text-gray-600",children:"You are not assigned to a section or your profile is incomplete."})]})}),!o&&e&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(rc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[100px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),i.map(f=>a.jsx("th",{className:"px-4 py-3 text-left min-w-[140px]",children:a.jsx("div",{className:"text-sm font-bold text-indigo-700",children:f.is_break||f.is_lunch?f.label||(f.is_break?"Break":"Lunch"):f.label||`${f.start_time||""}${f.start_time&&f.end_time?" - ":""}${f.end_time||""}`})},`period-${f.id}`))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:IOe.map((f,h)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:f}),i.map(p=>{const g=((r.find(b=>b.day===h+1)||{assignments:[]}).assignments||[]).filter(b=>b.period_id===p.id),y=g.some(b=>b.is_special);return a.jsx("td",{className:`px-4 py-3 align-top ${y&&g.some(b=>!b.is_special)?"bg-red-50":""}`,children:p.is_break?a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:p.label||"Break"})}):g&&g.length?a.jsx("div",{className:"space-y-2",children:g.map((b,v)=>{var S,k;const w=y&&!b.is_special;return a.jsxs("div",{className:`rounded-lg p-2.5 ${b.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[a.jsx(ms,{className:"h-3 w-3"}),b.is_special?b.timetable_name||"Special":tF(b.curriculum_row||b.subject_text),b.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",tF(b.curriculum_row||b.subject_text)]})]}),a.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3 w-3"}),"Staff: ",((S=b.staff)==null?void 0:S.username)||""]}),w&&a.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden by special"}),b.is_special&&a.jsxs("div",{className:"text-xs text-amber-700 mt-1 flex items-center gap-1",children:[a.jsx(xs,{className:"h-3 w-3"}),b.date||"","  ",p.label||""]}),b.subject_batch&&a.jsxs("div",{className:"text-xs text-blue-700 mt-1 font-medium",children:["Batch: ",b.subject_batch.name]}),w&&b.elective_subject&&a.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Elective: ",b.elective_subject.course_code||b.elective_subject.course_name]})]},`${b.id||((k=b.curriculum_row)==null?void 0:k.id)||v}`)})}):a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("span",{className:"text-gray-300 text-sm",children:""})})},`cell-${h}-${p.id}`)})]},`day-${h}`))})]})})]})]})})}const $Oe=["Mon","Tue","Wed","Thu","Fri","Sat"];function rF(e){if(!e)return"";if(typeof e=="string"){const i=e.trim();return i.split(/[\s\-\_]+/)[0]||i.slice(0,15)+(i.length>15?"":"")}const t=(e==null?void 0:e.course_name)||(e==null?void 0:e.course)||(e==null?void 0:e.subject_text)||(e==null?void 0:e.course_code)||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(i=>i.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function UOe(e){var i,s;if(Array.isArray(e)){const o=[],l=new Set;for(const c of e){const u=c.section,d=c.subject_batch||(u==null?void 0:u.batch);let f="";d!=null&&d.name&&(f+=d.name),u!=null&&u.name&&(f+=(f?" / ":"")+u.name),f||(u!=null&&u.id?f="Sec "+u.id:(i=c.subject_batch)!=null&&i.name&&(f=c.subject_batch.name)),f&&!l.has(f)&&(o.push(f),l.add(f))}return o.length?o.join(" + "):""}const t=e.section,r=e.subject_batch||(t==null?void 0:t.batch);let n="";return r!=null&&r.name&&(n+=r.name),t!=null&&t.name&&(n+=(n?" / ":"")+t.name),n||(t!=null&&t.id?n="Sec "+t.id:(s=e.subject_batch)!=null&&s.name&&(n=e.subject_batch.name)),n||""}function zOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState(!1);x.useEffect(()=>{o()},[]);async function o(){s(!0);try{const l=new Date().toISOString().slice(0,10),c=await yr(`/api/timetable/staff/?date=${l}`);if(!c.ok)throw new Error(await c.text());const u=await c.json();t(u.results||[]);const d=await yr("/api/timetable/templates/");if(d.ok){const f=await d.json(),h=f.find(p=>p.is_active)||f[0];if(h&&h.periods)n(h.periods);else{const p=[];for(const m of u.results||[])for(const g of m.assignments||[])p.find(y=>y.id===g.period_id)||p.push({id:g.period_id,index:g.period_index,is_break:g.is_break,is_lunch:g.is_lunch,label:g.label,start_time:g.start_time,end_time:g.end_time});p.sort((m,g)=>(m.index||0)-(g.index||0)),n(p)}}}catch(l){console.error(l)}finally{s(!1)}}return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(xs,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),a.jsx("p",{className:"text-gray-600",children:"View your assigned teaching schedule"})]})]})}),i?a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-8",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),a.jsx("span",{children:"Loading timetable..."})]})})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(rc,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Day / Period"}),r.map(l=>a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700 min-w-[120px]",children:l.label||`${l.start_time||""}${l.start_time&&l.end_time?" - ":""}${l.end_time||""}`},l.id))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:$Oe.map((l,c)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-semibold text-gray-900 bg-gray-50",children:l}),r.map(u=>{const f=((e.find(p=>p.day===c+1)||{assignments:[]}).assignments||[]).filter(p=>p.period_id===u.id),h=f.some(p=>p.is_special);return a.jsx("td",{className:`px-4 py-3 ${h&&f.some(p=>!p.is_special)?"bg-red-50":""}`,children:u.is_break||u.is_lunch?a.jsx("div",{className:"flex items-center justify-center",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:u.label||(u.is_break?"Break":"Lunch")})}):f&&f.length?a.jsx("div",{className:"space-y-2",children:(()=>{var m;const p={};for(const g of f){let y="";g.is_special?y=`special_${g.timetable_name||g.id}`:g.curriculum_row&&g.curriculum_row.id?y=`curr_${g.curriculum_row.id}`:g.subject_batch&&g.subject_batch.id?y=`batch_${g.subject_batch.id}`:g.elective_subject&&g.elective_subject.id?y=`elective_${g.elective_subject.id}`:g.subject_text?y=`subj_${(g.subject_text||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:y=`section_${((m=g.section)==null?void 0:m.id)||Math.random()}`,p[y]=p[y]||[],p[y].push(g)}return Object.keys(p).map((g,y)=>{const b=p[g],v=b[0],w=h&&!v.is_special,S=v.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200";return a.jsxs("div",{className:`rounded-lg p-2.5 ${S}`,children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight",children:[v.is_special?v.timetable_name||"Special":rF(v.elective_subject||v.curriculum_row||v.subject_text),v.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",rF(v.elective_subject||v.curriculum_row||v.subject_text)]})]}),a.jsx("div",{className:"text-xs text-blue-700 font-medium mt-1",children:UOe(b)}),w&&a.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden"}),v.is_special&&a.jsx("div",{className:"text-xs text-amber-700 mt-1",children:v.date||""})]},y)})})()}):a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("span",{className:"text-gray-300 text-sm",children:""})})},u.id)})]},l))})]})})]})]})})}async function WOe(e){const t=e?`/api/academics/staff/${e}/assigned-subjects/`:"/api/academics/staff/assigned-subjects/",r=await yr(t);if(!r.ok)throw new Error("Failed to fetch assigned subjects");const n=await r.json();return n.results||n}async function jv(){const e=await yr("/api/academics/subject-batches/?page_size=0");if(!e.ok)throw new Error("Failed to fetch subject batches");const t=await e.json();return t.results||t}async function qOe(e){var i;const t=await yr("/api/academics/subject-batches/",{method:"POST",body:JSON.stringify(e)}),r=t.headers.get("content-type")||"",n=await t.text();if(!t.ok){const s=r.includes("application/json")&&((i=JSON.parse(n))==null?void 0:i.detail)||n;throw new Error(s)}return r.includes("application/json")?JSON.parse(n):n}function HOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState({}),[o,l]=x.useState(!0),[c,u]=x.useState(null),[d,f]=x.useState(null),[h,p]=x.useState(""),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState(null),[S,k]=x.useState([]),[j,A]=x.useState(!1),[L,P]=x.useState([]),[B,E]=x.useState(null),[T,F]=x.useState([]);x.useEffect(()=>{W()},[]);async function W(){l(!0),u(null);try{const R=await WOe(),J=await jv();t(R),n(J)}catch(R){console.error(R),u((R==null?void 0:R.message)||"Failed to load assigned subjects")}finally{l(!1)}}async function z(R){var q;console.log("openPickerForAssignment clicked",R),u(null);const J=i[R.id]||`Batch for ${R.subject_code||R.subject_name||R.id}`;E(R),s(Y=>({...Y,[R.id]:J}));try{const Y=await yr(`/api/academics/sections/${R.section_id}/students/`);if(!Y.ok){const O=await Y.text();throw new Error(O||"Failed to load students")}const Q=await Y.json();let ie=Q.results||Q;const le=R.curriculum_row_id||((q=R.curriculum_row)==null?void 0:q.id);if(le){const O=new Set;for(const H of r)if(H.curriculum_row&&H.curriculum_row.id===le)for(const ae of H.students||[])O.add(ae.id);ie=ie.filter(H=>!O.has(H.id))}P(ie),F(ie.map(O=>O.id)),A(!0)}catch(Y){console.error("openPickerForAssignment error",Y),u((Y==null?void 0:Y.message)||String(Y)),alert("Failed to load students: "+((Y==null?void 0:Y.message)||Y))}}async function se(R){u(null),E(R),P([]),F([]);try{let J;if(R.section_id){const Q=await yr(`/api/academics/sections/${R.section_id}/students/`);if(!Q.ok)throw new Error(await Q.text());J=await Q.json()}else if(R.elective_subject_id){const Q=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${R.elective_subject_id}`);if(!Q.ok)throw new Error(await Q.text());J=await Q.json()}else throw new Error("No student mapping available for this assignment");const Y=(J.results||J||[]).map(Q=>({id:Number(Q.id),reg_no:String(Q.reg_no??Q.regno??""),name:String(Q.username??Q.name??Q.full_name??""),section:Q.section_name??Q.section??null,section_id:Q.section_id??null}));P(Y),F(Y.map(Q=>Q.id)),A(!0)}catch(J){console.error("openListStudents error",J),u((J==null?void 0:J.message)||String(J)),alert("Failed to load students: "+((J==null?void 0:J.message)||J))}}function de(R){F(J=>J.includes(R)?J.filter(q=>q!==R):[...J,R])}async function U(){if(!B)return;const R=r.map(Q=>{const ie=String(Q.name||"").match(/Batch\s*(\d+)/i);return ie?parseInt(ie[1],10):null}).filter(Boolean),Y={name:`Batch ${(R.length?Math.max(...R):0)+1}`,student_ids:T};B.curriculum_row_id&&(Y.curriculum_row_id=B.curriculum_row_id);try{await qOe(Y);const Q=await jv();n(Q),A(!1),P([]),E(null),alert("Batch created for subject")}catch(Q){console.error(Q),alert("Failed to create batch: "+((Q==null?void 0:Q.message)||Q))}}async function G(R){if(f(R.id),p(R.name||""),w(R),b((R.students||[]).map(J=>J.id)),R.curriculum_row&&R.curriculum_row.id)try{const J=e.find(q=>q.curriculum_row_id===R.curriculum_row.id);if(J&&J.section_id){const q=await yr(`/api/academics/sections/${J.section_id}/students/`);if(q.ok){const Y=await q.json(),Q=Y.results||Y;g(Q)}}}catch(J){console.error("Failed to load students for batch editing:",J),g(R.students||[])}else g(R.students||[])}async function re(){if(d)try{const R={name:h,student_ids:y},J=await yr(`/api/academics/subject-batches/${d}/`,{method:"PATCH",body:JSON.stringify(R)});if(!J.ok)throw new Error(await J.text());const q=await jv();n(q),X(),alert("Batch updated successfully")}catch(R){console.error("saveBatchEdit failed",R),alert("Failed to update batch: "+((R==null?void 0:R.message)||R))}}function X(){f(null),p(""),w(null),g([]),b([])}function C(R){b(J=>J.includes(R)?J.filter(q=>q!==R):[...J,R])}async function K(R){if(confirm("Delete this batch?"))try{const J=await yr(`/api/academics/subject-batches/${R}/`,{method:"DELETE"});if(!J.ok)throw new Error(await J.text());const q=await jv();n(q),alert("Batch deleted")}catch(J){console.error("deleteBatch failed",J),alert("Failed to delete: "+((J==null?void 0:J.message)||J))}}const V={};return r.forEach(R=>{const J=R.curriculum_row&&R.curriculum_row.id?String(R.curriculum_row.id):"___no_cr";V[J]||(V[J]=[]),V[J].push(R)}),a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 via-white to-gray-50 p-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-white to-blue-50 rounded-xl shadow-lg p-6 mb-6",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-xl flex items-center justify-center",children:a.jsx(ms,{className:"w-6 h-6 text-blue-700"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Assigned Subjects"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View all subjects assigned to you for the current academic session"})]})]}),!o&&!c&&e.length>0&&a.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-full",children:[a.jsx("span",{className:"text-sm font-medium",children:"Total Subjects"}),a.jsx("span",{className:"bg-white/20 text-white px-3 py-1 rounded-full text-sm font-semibold",children:e.length})]})]})}),o&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4"}),a.jsx("p",{className:"text-gray-600 font-medium",children:"Loading your assigned subjects..."})]}),c&&!o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(td,{className:"w-8 h-8 text-red-600"})}),a.jsx("p",{className:"text-red-600 font-medium mb-4",children:c}),a.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",onClick:W,children:"Try Again"})]}),!o&&!c&&e.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(ate,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Subjects Assigned"}),a.jsx("p",{className:"text-gray-600",children:"You don't have any subjects assigned for the current session."})]}),!o&&!c&&e.length>0&&a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"S.No"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Section"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Batch"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Semester"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:e.map((R,J)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"text-sm font-medium text-gray-900",children:J+1})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:R.subject_name||"Unnamed Subject"}),R.subject_code&&a.jsx("div",{className:"text-sm text-blue-600 font-medium",children:R.subject_code})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:R.section_id?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>z(R),children:"Create Batch"}),a.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>se(R),children:"List Students"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>se(R),children:"List Students"}),a.jsx("span",{className:"text-xs text-gray-500 px-2 py-1",children:"Department-wide elective"})]})})]})}),a.jsx("td",{className:"px-6 py-4",children:R.section_name?a.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 text-blue-700 px-3 py-1 rounded-full w-fit",children:[a.jsx(ys,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:R.section_name})]}):a.jsx("span",{className:"text-gray-400",children:""})}),a.jsx("td",{className:"px-6 py-4",children:R.batch?a.jsxs("div",{className:"flex items-center gap-2 bg-green-50 text-green-700 px-3 py-1 rounded-full w-fit",children:[a.jsx(xs,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:R.batch})]}):a.jsx("span",{className:"text-gray-400",children:""})}),a.jsx("td",{className:"px-6 py-4",children:R.semester!=null?a.jsxs("span",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold",children:["Sem ",R.semester]}):a.jsx("span",{className:"text-gray-400",children:""})})]},R.id))})]})})}),a.jsx("div",{className:"mt-6",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-blue-600"}),"Student Subject Batches"]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Existing Batches"}),r.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(ys,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No batches created yet"})]}),e.map(R=>{const J=R.curriculum_row_id?String(R.curriculum_row_id):null,q=J?V[J]||[]:[];return!q||q.length===0?null:a.jsxs("div",{className:"mb-6 border-b border-gray-100 pb-4 last:border-b-0",children:[a.jsx("div",{className:"font-bold text-gray-900 mb-3",children:R.subject_name||R.subject_code||"Unnamed Subject"}),a.jsx("div",{className:"space-y-3",children:q.map(Y=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:Y.name}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsxs("span",{className:"font-medium",children:[(Y.students||[]).length," students"]})})]}),a.jsxs("div",{className:"ml-4 flex gap-2",children:[a.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>G(Y),children:"Edit"}),a.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>K(Y.id),children:"Delete"})]})]})},Y.id))})]},`subject-${R.id}`)}),(()=>{const R=r.filter(J=>{const q=J.curriculum_row&&J.curriculum_row.id?J.curriculum_row.id:null;return!q||!e.some(Y=>Y.curriculum_row_id===q)});return R.length===0?null:a.jsxs("div",{className:"mt-6",children:[a.jsx("div",{className:"font-bold text-gray-900 mb-3",children:"Other Batches"}),a.jsx("div",{className:"space-y-3",children:R.map(J=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:J.name}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsxs("span",{className:"font-medium",children:[(J.students||[]).length," students"]})})]}),a.jsxs("div",{className:"ml-4 flex gap-2",children:[a.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>G(J),children:"Edit"}),a.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>K(J.id),children:"Delete"})]})]})},`other-${J.id}`))})]})})()]})]})}),j&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:i[(B==null?void 0:B.id)||""]||"Create Batch"}),a.jsx("div",{className:"text-sm text-gray-600",children:(B==null?void 0:B.subject_name)||(B==null?void 0:B.subject_code)})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:()=>{A(!1),P([]),E(null)},children:"Cancel"}),a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:U,children:"Create Batch"})]})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-2",children:["Students (",L.length,")"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Select students to include in this batch"})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:L.map(R=>a.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:T.includes(R.id),onChange:()=>de(R.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:R.username||R.full_name||R.reg_no}),R.reg_no&&a.jsx("div",{className:"text-xs text-gray-500",children:R.reg_no})]})]},R.id))})})]})]})}),d&&v&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"Edit Batch"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Modify batch name and student assignments"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:X,children:"Cancel"}),a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:re,children:"Save Changes"})]})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Batch Name"}),a.jsx("input",{type:"text",value:h,onChange:R=>p(R.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter batch name"})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center justify-between",children:[a.jsxs("span",{children:["Students (",y.length," selected)"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Click to add/remove students"})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:m.length===0?a.jsxs("div",{className:"text-center text-gray-500 py-4",children:[a.jsx(ys,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No students available for this batch"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:m.map(R=>a.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${y.includes(R.id)?"border-blue-300 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[a.jsx("input",{type:"checkbox",checked:y.includes(R.id),onChange:()=>C(R.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:R.username||R.full_name||R.reg_no}),R.reg_no&&a.jsx("div",{className:"text-xs text-gray-500",children:R.reg_no})]})]},R.id))})})]})]})]})})]})}function VOe(){const[e,t]=x.useState(new Date().toISOString().slice(0,10)),[r,n]=x.useState([]),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState([]),[d,f]=x.useState({}),[h,p]=x.useState(!1),[m,g]=x.useState(!1),[y,b]=x.useState(!1),[v,w]=x.useState(new Date().toISOString().slice(0,7)),[S,k]=x.useState([]),[j,A]=x.useState({}),[L,P]=x.useState([]),[B,E]=x.useState(!1),[T,F]=x.useState({}),[W,z]=x.useState({}),[se,de]=x.useState({}),[U,G]=x.useState(!1),[re,X]=x.useState(null),[C,K]=x.useState(null);x.useEffect(()=>{R()},[e]);function V(Z){const pe={};for(const Oe of Z){let Ae="";if(Oe.period&&Oe.period.index!==void 0){const ke=Oe.period.index;Oe.subject_batch_id?Ae=`batch_${ke}_${Oe.subject_batch_id}`:Oe.elective_subject_id?Ae=`elective_${ke}_${Oe.teaching_assignment_id||Oe.elective_subject_id}`:Oe.subject?Ae=`subj_${ke}_${String(Oe.subject||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:Ae=`section_${ke}_${Oe.section_id}`}else Oe.subject_batch_id?Ae=`batch_${Oe.subject_batch_id}`:Oe.elective_subject_id?Ae=`elective_${Oe.teaching_assignment_id||Oe.elective_subject_id}`:Oe.subject?Ae=`subj_${String(Oe.subject).replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:Ae=`section_${Oe.section_id}`;if(!pe[Ae])pe[Ae]={...Oe,section_ids:[Oe.section_id],section_names:[Oe.section_name],attendance_session_ids:[Oe.attendance_session_id]};else{const ke=pe[Ae];ke.section_ids.includes(Oe.section_id)||ke.section_ids.push(Oe.section_id),Oe.section_name&&!ke.section_names.includes(Oe.section_name)&&ke.section_names.push(Oe.section_name),ke.attendance_session_ids=Array.from(new Set([...ke.attendance_session_ids||[],Oe.attendance_session_id]))}}return Object.keys(pe).map(Oe=>({...pe[Oe],id:Oe}))}async function R(){s(!0);try{const Z=await yr(`/api/academics/staff/periods/?date=${e}`);if(!Z.ok)throw new Error("Failed to load periods");const pe=await Z.json();n(pe.results||[])}catch(Z){console.error("fetchPeriods",Z),n([])}finally{s(!1)}}function J(Z){var Ct;const pe=Z.section_ids&&Array.isArray(Z.section_ids)&&Z.section_ids.length?Z.section_ids:[Z.section_id],Oe=r.filter(_t=>!_t||_t.attendance_session_locked||!pe.includes(_t.section_id)||Z.id&&_t.id===Z.id?!1:!!(Z.subject_batch_id&&_t.subject_batch_id===Z.subject_batch_id||Z.teaching_assignment_id&&_t.teaching_assignment_id===Z.teaching_assignment_id||Z.elective_subject_id&&_t.elective_subject_id===Z.elective_subject_id||Z.subject&&_t.subject===Z.subject));if(Oe.length===0)return null;const Ae=[...Oe].sort((_t,Xe)=>_t.period.index-Xe.period.index),ke=((Ct=Z.period)==null?void 0:Ct.index)||Z.period&&Z.period.index||0,_e=Ae.find(_t=>_t.period.index>ke),De=[...Ae].reverse().find(_t=>_t.period.index<ke),We=4;return _e&&_e.period.index-ke<=We?_e:De&&ke-De.period.index<=We?De:null}function q(Z){const pe=J(Z);pe?(X(Z),K(pe),G(!0)):Y(Z)}async function Y(Z){l(Z),u([]),f({}),s(!0);try{let pe=[];if(Z.section_ids&&Array.isArray(Z.section_ids)&&Z.section_ids.length>1)if(Z.elective_subject_id){const _e=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${Z.elective_subject_id}`);_e.ok&&(pe=(await _e.json()).results||[])}else{const _e=[];for(const We of Z.section_ids)_e.push(yr(`/api/academics/sections/${We}/students/`).then(Ct=>Ct.ok?Ct.json():{results:[]}).catch(()=>({results:[]})));const De=await Promise.allSettled(_e);for(const We of De)if(We.status==="fulfilled"){const Ct=We.value||{},_t=Ct.results||Ct.students||[];pe=pe.concat(_t)}}else if(Z.elective_subject_id){const _e=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${Z.elective_subject_id}`);_e.ok&&(pe=(await _e.json()).results||[])}else if(Z.subject_batch_id){const _e=await yr(`/api/academics/subject-batches/${Z.subject_batch_id}/`);if(_e.ok){const De=await _e.json();pe=De.students||De.results||[]}}else{const _e=await yr(`/api/academics/sections/${Z.section_id}/students/`);_e.ok&&(pe=(await _e.json()).results||[])}const Oe={};for(const _e of pe||[])_e&&_e.id&&(Oe[_e.id]=_e);const Ae=Object.values(Oe);u((Ae||[]).map(_e=>({id:Number(_e.id),reg_no:String(_e.reg_no||_e.regno||String(_e.id)),name:String(_e.name??_e.full_name??_e.username??""),username:String(_e.username??_e.name??""),section:_e.section_name??_e.section??null,section_id:_e.section_id??null})));const ke={};if((Ae||[]).forEach(_e=>ke[_e.id]="P"),f(ke),Z.attendance_session_id||Z.attendance_session_ids&&Z.attendance_session_ids.length)try{const De=(Z.attendance_session_ids&&Z.attendance_session_ids.length?Z.attendance_session_ids:[Z.attendance_session_id]).map(_t=>yr(`/api/academics/period-attendance/${_t}/`).then(Xe=>Xe.ok?Xe.json():null).catch(()=>null)),We=await Promise.allSettled(De),Ct={...ke};for(const _t of We){if(_t.status!=="fulfilled"||!_t.value)continue;(_t.value.records||[]).forEach(Ne=>{const be=Ne.student_pk||Ne.student&&Ne.student.id||null;be&&(Ct[be]=Ne.status||Ct[be]||"A")})}f(Ct)}catch(_e){console.error("load session records",_e)}}catch(pe){console.error("openPeriod",pe)}finally{s(!1)}}function Q(Z,pe){f(Oe=>({...Oe,[Z]:pe}))}async function ie(){if(o){p(!0);try{const Z=c.map(De=>({student_id:De.id,status:d[De.id]||"P"})),pe=o.consecutive_periods&&Array.isArray(o.consecutive_periods)&&o.consecutive_periods.length>0?o.consecutive_periods.map(De=>De.period_id):[o.period.id],Oe=o.section_ids&&Array.isArray(o.section_ids)&&o.section_ids.length>0?o.section_ids:[o.section_id],Ae={};for(const De of Oe){const We=c.filter(Ct=>(Ct.section_id||null)===De).map(Ct=>({student_id:Ct.id,status:d[Ct.id]||"P"}));if(We.length===0&&o.section_name){const Ct=new Set(String(o.section_name).split(" + ").map(Xe=>Xe.trim())),_t=c.filter(Xe=>Ct.has(String(Xe.section_name||Xe.section||"").trim())).map(Xe=>({student_id:Xe.id,status:d[Xe.id]||"P"}));Ae[De]=_t.length?_t:c.map(Xe=>({student_id:Xe.id,status:d[Xe.id]||"P"}))}else Ae[De]=We.length?We:c.map(Ct=>({student_id:Ct.id,status:d[Ct.id]||"P"}))}const ke=[];for(const De of pe)for(const We of Oe){const Ct={section_id:We,period_id:De,teaching_assignment_id:o.teaching_assignment_id??null,date:e,records:Ae[We]||[]};console.log("Saving attendance for section",We,"period",De,Ct);const _t=await yr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify(Ct)}),Xe=await(_t.ok?_t.json().catch(()=>null):_t.json().catch(()=>null));ke.push({section:We,period:De,ok:_t.ok,data:Xe})}const _e=ke.filter(De=>!De.ok);if(_e.length)console.error("Some saves failed:",_e),alert("Attendance saved for some sections/periods, but failed for others. Check console for details.");else{await R();const De=o.combined_period_label||o.period&&(o.period.label||`Period ${o.period.index}`);alert(`Attendance saved successfully!

Date: ${e}
Period(s): ${De}
Sections: ${Oe.length}
Students: ${c.length}`),l(null)}}catch(Z){console.error("saveMarks error:",Z),alert("Failed to save attendance: "+(Z instanceof Error?Z.message:String(Z)))}finally{p(!1)}}}async function le(){var Z,pe,Oe,Ae,ke,_e;if(!(!re||!C)){G(!1);try{const De=re;let We=[];if(De.section_ids&&Array.isArray(De.section_ids)&&De.section_ids.length>1){const be=De.section_ids.map(fe=>yr(`/api/academics/sections/${fe}/students/`).then(ge=>ge.ok?ge.json():{results:[]}).catch(()=>({results:[]})));if(De.elective_subject_id){const fe=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${De.elective_subject_id}`);fe.ok&&(We=(await fe.json()).results||[])}else{const fe=await Promise.allSettled(be);for(const ge of fe)if(ge.status==="fulfilled"){const lt=ge.value||{};We=We.concat(lt.results||lt.students||[])}}}else if(De.elective_subject_id){const be=await yr(`/api/curriculum/elective-choices/?elective_subject_id=${De.elective_subject_id}`);be.ok&&(We=(await be.json()).results||[])}else if(De.subject_batch_id){const be=await yr(`/api/academics/subject-batches/${De.subject_batch_id}/`);if(be.ok){const fe=await be.json();We=fe.students||fe.results||[]}}else{const be=await yr(`/api/academics/sections/${De.section_id}/students/`);be.ok&&(We=(await be.json()).results||[])}const Ct={};for(const be of We||[])be&&be.id&&(Ct[be.id]=be);let _t=Object.values(Ct).map(be=>({id:Number(be.id),reg_no:String(be.reg_no||be.regno||String(be.id)),username:be.username||be.name||"",section_id:be.section_id||be.sectionId||null,section_name:be.section_name||be.section||""}));if((!_t||_t.length===0)&&De.section_ids&&Array.isArray(De.section_ids)&&De.section_ids.length>0){const be=De.section_ids.map(He=>yr(`/api/academics/sections/${He}/students/`).then(mt=>mt.ok?mt.json():{results:[]}).catch(()=>({results:[]}))),fe=await Promise.allSettled(be),ge=[];for(const He of fe)if(He.status==="fulfilled"){const mt=He.value||{},wt=mt.results||mt.students||[];ge.push(...wt)}const lt={};for(const He of ge)He&&He.id&&(lt[He.id]=He);_t=Object.values(lt).map(He=>({id:Number(He.id),reg_no:String(He.reg_no||He.regno||String(He.id)),username:He.username||He.name||"",section_id:He.section_id||He.sectionId||null,section_name:He.section_name||He.section||""}))}const Xe={};_t.forEach(be=>Xe[be.id]="P"),u(_t),f(Xe);const nt=`${((Z=re.period)==null?void 0:Z.label)||`Period ${(pe=re.period)==null?void 0:pe.index}`} & ${((Oe=C.period)==null?void 0:Oe.label)||`Period ${(Ae=C.period)==null?void 0:Ae.index}`}`,Ne=De.section_names&&De.section_names.length?De.section_names.join(" + "):De.section_name||"";l({...re,consecutive_periods:[{period_id:re.period.id,label:((ke=re.period)==null?void 0:ke.label)||""},{period_id:C.period.id,label:((_e=C.period)==null?void 0:_e.label)||""}],combined_period_label:nt,section_name:Ne,section_ids:De.section_ids||[De.section_id]})}catch(De){console.error("markBothPeriods error:",De),alert("Failed to prepare marking for both periods: "+(De instanceof Error?De.message:String(De)))}finally{G(!1),X(null),K(null)}}}function O(){re&&(G(!1),Y(re),X(null),K(null))}async function H(){var Ae;if(!o||!o.attendance_session_id){alert("No active attendance session to lock/unlock");return}const Z=o.attendance_session_locked,pe=o.attendance_session_id;if(window.confirm(Z?"Are you sure you want to request an unlock for this attendance session? Unlocking requires approval.":"Are you sure you want to lock this attendance session? This will prevent any further changes to attendance records.")){g(!0);try{if(Z){const ke=await yr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:o.attendance_session_id,note:""})});if(ke.ok){const _e=await ke.json();console.log("Unlock request created:",_e),alert('Unlock request submitted successfully! Check the "My Requests" button in the Analytics page to view the status.');try{l(De=>De&&{...De,unlock_request_status:_e.status,unlock_request_id:_e.id}),n(De=>De.map(We=>We.attendance_session_id&&pe&&We.attendance_session_id===pe?{...We,unlock_request_status:_e.status,unlock_request_id:_e.id}:We))}catch(De){console.warn("Failed to update local unlock status",De)}}else{const _e=await ke.json().catch(()=>({}));if(ke.status===400&&((Ae=_e.detail)!=null&&Ae.includes("already pending")))alert("An unlock request for this session already exists and is pending approval. Please check the Requests section for status.");else throw new Error(_e.detail||"Failed to create unlock request")}}else{const ke=await yr(`/api/academics/period-attendance/${o.attendance_session_id}/lock/`,{method:"POST"});if(!ke.ok){const De=await ke.json().catch(()=>({}));throw new Error(De.detail||"Failed to lock session")}const _e=await ke.json();console.log("Session locked successfully:",_e),l({...o,attendance_session_locked:_e.is_locked}),await R(),alert("Attendance session locked successfully!")}}catch(ke){console.error("toggleLock error:",ke),alert("Failed to perform lock/unlock: "+(ke instanceof Error?ke.message:String(ke)))}finally{g(!1)}}}async function ae(){try{const Z=await yr("/api/timetable/staff/");if(!Z.ok)throw new Error("Failed to load assignments");const pe=await Z.json(),Oe=[];for(const Ae of pe.results||[]){const ke=Ae.day;for(const _e of Ae.assignments||[])Oe.push({..._e,_day:ke})}await I(v,Oe),k(Oe),b(!0),A({}),F({}),z({})}catch(Z){console.error("openBulkModal",Z),alert("Failed to open bulk modal")}}async function I(Z,pe){var Oe,Ae;try{const[ke,_e]=Z.split("-").map(Ne=>parseInt(Ne)),De=new Date(ke,_e-1,1).toISOString().slice(0,10),We=new Date(ke,_e,0).toISOString().slice(0,10),Ct=await yr(`/api/academics/period-attendance/?date_after=${De}&date_before=${We}`);if(!Ct.ok){console.warn("Failed to load existing sessions"),de({});return}const Xe=(await Ct.json()).results||[],nt={};for(const Ne of Xe){const be=Ne.date,fe=((Oe=Ne.section)==null?void 0:Oe.id)||Ne.section_id,ge=((Ae=Ne.period)==null?void 0:Ae.id)||Ne.period_id;if(!be||!fe||!ge)continue;const lt=new Date(be),He=lt.getDay()===0?7:lt.getDay(),mt=pe.find(wt=>{var Pt,bt;return wt._day===He&&(wt.period_id===ge||((Pt=wt.period)==null?void 0:Pt.id)===ge)&&(wt.section_id===fe||((bt=wt.section)==null?void 0:bt.id)===fe)});if(mt){const wt=mt.id?String(mt.id):`${mt._day}_${ge}_${fe}`;nt[wt]||(nt[wt]=new Set),nt[wt].add(be)}}de(nt),console.log("Loaded marked sessions:",nt)}catch(ke){console.error("Error loading marked sessions:",ke),de({})}}return x.useEffect(()=>{y&&S.length>0&&I(v,S)},[v]),x.useEffect(()=>{async function Z(){var Oe,Ae,ke,_e;if(!Object.keys(j).filter(De=>j[De]).length){P([]);return}E(!0);try{const De=[];for(const _t of S){const Xe=_t.id?String(_t.id):`${_t._day}_${_t.period_id}_${_t.section_id}`;if(j[Xe]){if(_t.elective_subject_id)De.push(yr(`/api/curriculum/elective-choices/?elective_subject_id=${_t.elective_subject_id}`).then(nt=>nt.ok?nt.json():{results:[]}));else if(_t.subject_batch_id||(Oe=_t.subject_batch)!=null&&Oe.id){const nt=_t.subject_batch_id||((Ae=_t.subject_batch)==null?void 0:Ae.id);De.push(yr(`/api/academics/subject-batches/${nt}/`).then(Ne=>Ne.ok?Ne.json():{students:[]}))}else if(_t.section_id||(ke=_t.section)!=null&&ke.id){const nt=_t.section_id||((_e=_t.section)==null?void 0:_e.id);De.push(yr(`/api/academics/sections/${nt}/students/`).then(Ne=>Ne.ok?Ne.json():{results:[]}))}}}const We=await Promise.allSettled(De),Ct=[];for(const _t of We){if(_t.status!=="fulfilled")continue;const Xe=_t.value||{},nt=Xe.results||Xe.students||[];for(const Ne of nt)!Ne||!Ne.id||Ct.find(be=>be.id===Ne.id)||Ct.push({id:Ne.id,reg_no:Ne.reg_no||Ne.regno||String(Ne.id),username:Ne.username||Ne.name||""})}P(Ct),z(_t=>{const Xe={..._t};for(const nt of Ct)Xe[nt.id]===void 0&&(Xe[nt.id]=!1);return Xe})}catch(De){console.error("loadAgg",De),P([])}finally{E(!1)}}Z()},[j,S]),a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(xs,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mark Attendance"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Record student attendance for periods"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-4 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("label",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[a.jsx(rc,{className:"w-4 h-4 text-indigo-600"}),"Select Date:"]}),a.jsx("input",{type:"date",value:e,onChange:Z=>t(Z.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-600"}),"Assigned Periods"]})}),a.jsx("div",{className:"p-6",children:i?a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx(Ku,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"ml-3 text-slate-600",children:"Loading periods..."})]}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[V(r).map(Z=>a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 bg-white hover:shadow-md transition-shadow",children:[a.jsx("div",{className:"flex items-start justify-between mb-2",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:Z.period.label||`Period ${Z.period.index}`}),a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-600 mb-1",children:[a.jsx(rc,{className:"w-4 h-4"}),Z.period.start_time||"",Z.period.start_time&&Z.period.end_time?`  ${Z.period.end_time}`:""]}),a.jsx("div",{className:"text-sm text-slate-700 mb-1",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-md bg-blue-100 text-blue-800 font-medium",children:Z.section_names&&Z.section_names.length?Z.section_names.join(" + "):Z.section_name})}),a.jsx("div",{className:"text-sm italic text-slate-600",children:Z.subject_display||Z.subject||"No subject"}),Z.unlock_request_status&&a.jsxs("div",{className:"mt-2",children:[Z.unlock_request_status==="PENDING"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-amber-100 text-amber-800 border border-amber-300 rounded-md text-xs font-medium",children:"Pending"}),Z.unlock_request_status==="APPROVED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-100 text-green-800 border border-green-300 rounded-md text-xs font-medium",children:"Approved"}),Z.unlock_request_status==="REJECTED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-red-100 text-red-800 border border-red-300 rounded-md text-xs font-medium",children:"Rejected"})]})]})}),a.jsx("div",{className:"mt-3",children:Z.attendance_session_locked?a.jsxs("button",{onClick:()=>Y(Z),className:"w-full px-3 py-2 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium hover:bg-amber-200 flex items-center justify-center gap-2",children:[a.jsx(n0,{className:"w-4 h-4"}),Z.attendance_session_id?"View Locked Session":"View Locked Period"]}):a.jsx("button",{onClick:()=>q(Z),className:"w-full px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:Z.attendance_session_id?a.jsxs(a.Fragment,{children:[a.jsx(qf,{className:"w-4 h-4"}),"Open Session"]}):a.jsxs(a.Fragment,{children:[a.jsx(xs,{className:"w-4 h-4"}),"Take Attendance"]})})})]},Z.id)),!r.length&&a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(xs,{className:"w-12 h-12 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Periods Found"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"No periods assigned for this date"})]}),a.jsx("div",{className:"col-span-full mt-2",children:a.jsx("button",{onClick:ae,className:"w-full px-4 py-3 border-2 border-dashed border-indigo-300 text-indigo-600 rounded-lg font-medium hover:bg-indigo-50 transition-colors",children:"Bulk Mark (All Assignments)"})})]})})]}),o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:[o.combined_period_label||o.period.label||`Period ${o.period.index}`,"  ",o.section_name,a.jsxs("span",{className:"ml-3 inline-flex items-center px-2 py-0.5 rounded-md bg-slate-100 text-slate-700 text-sm font-medium",children:[c.length," student",c.length!==1?"s":""]})]}),o.attendance_session_locked&&a.jsxs(a.Fragment,{children:[a.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium",children:[a.jsx(n0,{className:"w-3.5 h-3.5"}),"Locked"]}),o.unlock_request_status==="PENDING"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-50 text-amber-800 border border-amber-200 rounded-lg text-sm font-medium ml-3",children:"Pending"}),o.unlock_request_status==="APPROVED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-green-50 text-green-800 border border-green-200 rounded-lg text-sm font-medium ml-3",children:"Approved"}),o.unlock_request_status==="REJECTED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-50 text-red-800 border border-red-200 rounded-lg text-sm font-medium ml-3",children:"Rejected"})]})]}),a.jsxs("button",{onClick:()=>l(null),className:"px-3 py-1.5 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[a.jsx(gu,{className:"w-4 h-4"}),"Close"]})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Student"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Status"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map(Z=>{const pe=d[Z.id]||"P",Oe={P:"bg-green-50 text-green-800 border-green-300",A:"bg-red-50 text-red-800 border-red-300",LEAVE:"bg-amber-50 text-amber-800 border-amber-300",OD:"bg-blue-50 text-blue-800 border-blue-300",LATE:"bg-indigo-50 text-indigo-800 border-indigo-300"},Ae={P:"bg-green-600",A:"bg-red-600",LEAVE:"bg-amber-600",OD:"bg-blue-600",LATE:"bg-indigo-600"},ke=Oe[pe]||Oe.P,_e=Ae[pe]||Ae.P;return a.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4 text-sm font-medium text-slate-900",children:Z.reg_no}),a.jsx("td",{className:"py-3 px-4 text-sm text-slate-700",children:Z.username}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`inline-block w-3 h-3 rounded-full mr-2 ${_e}`}),a.jsxs("div",{className:"relative inline-block",children:[a.jsxs("select",{value:d[Z.id]||"P",onChange:De=>Q(Z.id,De.target.value),disabled:o.attendance_session_locked,className:`appearance-none px-3 py-1.5 pr-8 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent ${ke} ${o.attendance_session_locked?"disabled:bg-slate-100 disabled:text-slate-500 disabled:cursor-not-allowed":""}`,children:[a.jsx("option",{value:"P",children:"Present"}),a.jsx("option",{value:"A",children:"Absent"}),a.jsx("option",{value:"LEAVE",children:"Leave"}),a.jsx("option",{value:"OD",children:"On Duty"}),a.jsx("option",{value:"LATE",children:"Late"})]}),a.jsx(Wee,{className:"w-4 h-4 text-slate-400 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"})]})]})})]},Z.id)})})]})}),a.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[a.jsx("button",{onClick:ie,disabled:h||o.attendance_session_locked,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:h?a.jsxs(a.Fragment,{children:[a.jsx(Ku,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(nd,{className:"w-4 h-4"}),"Save Attendance"]})}),o.attendance_session_id&&a.jsx("button",{onClick:H,disabled:m,className:`px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 ${o.attendance_session_locked?"bg-amber-600 hover:bg-amber-700 disabled:bg-amber-300 text-white":"bg-slate-600 hover:bg-slate-700 disabled:bg-slate-300 text-white"}`,children:m?a.jsxs(a.Fragment,{children:[a.jsx(Ku,{className:"w-4 h-4 animate-spin"}),o.attendance_session_locked?"Unlocking...":"Locking..."]}):a.jsx(a.Fragment,{children:o.attendance_session_locked?a.jsxs(a.Fragment,{children:[a.jsx(hte,{className:"w-4 h-4"}),"Unlock Session"]}):a.jsxs(a.Fragment,{children:[a.jsx(n0,{className:"w-4 h-4"}),"Lock Session"]})})})]})]})]}),y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[85vh] overflow-y-auto shadow-2xl",children:[a.jsx("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 rounded-t-xl",children:a.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Bulk Mark Attendance"})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[a.jsx(xs,{className:"w-4 h-4 text-indigo-600"}),"Select Month:"]}),a.jsx("input",{type:"month",value:v,onChange:Z=>w(Z.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Assignments"}),a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-60 overflow-y-auto bg-slate-50",children:[a.jsxs("label",{className:"flex items-center gap-2 mb-3 text-sm font-medium text-slate-700",children:[a.jsx("input",{type:"checkbox",checked:Object.keys(j).length>0&&Object.values(j).every(Boolean),onChange:Z=>{const pe=Z.target.checked,Oe={};for(const Ae of S){const ke=Ae.id?String(Ae.id):`${Ae._day}_${Ae.period_id}_${Ae.section_id}`;Oe[ke]=pe}A(Oe)},className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),"Select / Deselect all"]}),a.jsx("div",{className:"space-y-2",children:(()=>{const Z=S.filter(pe=>{const Oe=pe.id?String(pe.id):`${pe._day}_${pe.period_id}_${pe.section_id}`,Ae=se[Oe];if(!Ae)return!0;try{const[ke,_e]=v.split("-").map(Ct=>parseInt(Ct)),De=new Date(ke,_e,0).getDate();let We=0;for(let Ct=1;Ct<=De;Ct++){const _t=new Date(ke,_e-1,Ct);(_t.getDay()===0?7:_t.getDay())===pe._day&&We++}return Ae.size<We}catch{return!0}});return Z.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-600",children:[a.jsx(qf,{className:"w-12 h-12 text-green-500 mx-auto mb-2"}),a.jsx("p",{className:"font-medium",children:"All assignments are fully marked for this month!"})]}):Z.map(pe=>{var _e;const Oe=pe.id?String(pe.id):`${pe._day}_${pe.period_id}_${pe.section_id}`,Ae=se[Oe],ke=Ae?Ae.size:0;return a.jsxs("label",{className:"flex items-start gap-3 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:!!j[Oe],onChange:()=>A(De=>({...De,[Oe]:!De[Oe]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500 mt-0.5"}),a.jsxs("div",{className:"flex-1 text-sm",children:[a.jsxs("div",{className:"font-medium text-slate-900",children:[pe.label||`Period ${pe.period_index}`,"  ",["Mon","Tue","Wed","Thu","Fri","Sat"][pe._day-1]||`Day ${pe._day}`,pe.start_time?` ${pe.start_time}${pe.end_time?" - "+pe.end_time:""}`:""]}),a.jsxs("div",{className:"text-xs text-slate-600 mt-0.5",children:[pe.section_name||((_e=pe.section)==null?void 0:_e.name)||(pe.section_id?`Section ${pe.section_id}`:""),"  ",pe.subject_display||pe.subject_text||"",ke>0&&a.jsxs("span",{className:"ml-2 text-green-600 font-medium",children:["(",ke," day",ke!==1?"s":""," marked)"]})]})]})]},Oe)})})()})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Dates (month view for selected assignments)"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{try{const[Z,pe]=v.split("-").map(We=>parseInt(We)),Oe=new Date(Z,pe,0),Ae=new Set;for(const We of S){const Ct=We.id?String(We.id):`${We._day}_${We.period_id}_${We.section_id}`;j[Ct]&&Ae.add(We._day)}const ke=[];for(let We=1;We<=Oe.getDate();We++){const Ct=new Date(Z,pe-1,We),_t=Ct.getDay()===0?7:Ct.getDay();Ae.size>0&&Ae.has(_t)&&ke.push(Ct.toISOString().slice(0,10))}const _e=Object.keys(j).filter(We=>j[We]),De=ke.filter(We=>_e.length===0?!0:_e.some(Ct=>{const _t=se[Ct];return!_t||!_t.has(We)}));return De.length===0&&_e.length>0?a.jsxs("div",{className:"text-center py-4 text-slate-600",children:[a.jsx(qf,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),a.jsx("p",{className:"text-sm",children:"All dates are already marked for selected assignments"})]}):De.map(We=>{const Ct=_e.filter(_t=>{const Xe=se[_t];return Xe&&Xe.has(We)}).length;return a.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-1.5 border border-slate-300 rounded-lg text-sm hover:bg-slate-100 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:!!T[We],onChange:()=>F(_t=>({..._t,[We]:!_t[We]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),a.jsxs("span",{children:[We,Ct>0&&_e.length>1&&a.jsxs("span",{className:"ml-1 text-xs text-amber-600",children:["(",Ct,"/",_e.length," marked)"]})]})]},We)})}catch{return a.jsx("div",{})}})()})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:["Students (derived from selected assignments)",a.jsxs("span",{className:"ml-2 text-sm text-slate-600",children:["(",L.length," student",L.length!==1?"s":"",")"]})]}),a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-64 overflow-y-auto bg-slate-50",children:[B&&a.jsxs("div",{className:"flex items-center justify-center py-8 text-slate-600",children:[a.jsx(Ku,{className:"w-6 h-6 animate-spin mr-2"}),"Loading students..."]}),!B&&L.length===0&&a.jsx("div",{className:"text-center py-8 text-slate-600",children:"No students for selected assignments"}),!B&&L.length>0&&a.jsx("div",{className:"space-y-1",children:L.map(Z=>a.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:!!W[Z.id],onChange:pe=>z(Oe=>({...Oe,[Z.id]:!Oe[Z.id]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),a.jsxs("span",{className:"text-sm text-slate-900",children:[Z.reg_no,"  ",Z.username]})]},Z.id))})]})]})]}),a.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 px-6 py-4 flex gap-3 rounded-b-xl",children:[a.jsxs("button",{onClick:async()=>{var Ae,ke,_e,De;const Z=Object.keys(T).filter(We=>T[We]);if(!Z.length){alert("Select at least one date");return}const pe=[];for(const We of S){const Ct=We.id?String(We.id):`${We._day}_${We.period_id}_${((Ae=We.section)==null?void 0:Ae.id)||We.section_id}`;if(!j[Ct])continue;const _t=We.section_id||We.section&&(We.section.id||We.section.pk)||((ke=We.section)==null?void 0:ke.pk)||((_e=We.section)==null?void 0:_e.id),Xe=We.period_id||We.period&&(We.period.id||We.period_id)||((De=We.period)==null?void 0:De.id)||We.period_id,nt=Number(_t),Ne=Number(Xe);!Number.isFinite(nt)||!Number.isFinite(Ne)||pe.push({section_id:nt,period_id:Ne})}const Oe=Object.keys(W).filter(We=>W[Number(We)]).map(We=>Number(We));if(!pe.length){alert("No assignments selected");return}if(!Oe.length){alert("No students selected");return}try{const We=await yr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify({assignments:pe,dates:Z,student_ids:Oe})});if(!We.ok){let Ct="Failed";try{const _t=await We.json();Ct=JSON.stringify(_t)}catch{try{Ct=await We.text()}catch{}}alert("Failed: "+Ct);return}alert("Bulk attendance saved"),b(!1)}catch(We){console.error("bulk save",We),alert("Failed to save bulk attendance")}},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[a.jsx(nd,{className:"w-4 h-4"}),"Save Bulk"]}),a.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Close"})]})]})}),U&&re&&C&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md shadow-2xl",children:[a.jsx("div",{className:"bg-gradient-to-br from-amber-500 to-orange-600 px-6 py-4 rounded-t-xl",children:a.jsxs("div",{className:"flex items-center gap-3 text-white",children:[a.jsx(td,{className:"w-6 h-6"}),a.jsx("h3",{className:"text-xl font-bold",children:"Consecutive Periods Detected"})]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[a.jsxs("p",{className:"text-sm text-slate-700 mb-3",children:["The same subject has consecutive periods",Math.abs(C.period.index-re.period.index)>1?" (with break/lunch in between)":"",":"]}),a.jsxs("div",{className:"space-y-2 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:re.period.label||`Period ${re.period.index}`}),a.jsxs("span",{className:"text-slate-600",children:["(",re.period.start_time," - ",re.period.end_time,")"]})]}),Math.abs(C.period.index-re.period.index)>1&&a.jsx("div",{className:"flex items-center gap-2 text-sm pl-4",children:a.jsxs("span",{className:"text-slate-500 italic",children:[" ",Math.abs(C.period.index-re.period.index)-1," period(s) in between (break/lunch)"]})}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:C.period.label||`Period ${C.period.index}`}),a.jsxs("span",{className:"text-slate-600",children:["(",C.period.start_time," - ",C.period.end_time,")"]})]})]}),a.jsxs("p",{className:"text-sm font-medium text-slate-900",children:["Subject: ",a.jsx("span",{className:"text-indigo-600",children:re.subject||re.subject_display||"Same Subject"})]})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Would you like to mark attendance for both periods at once (all students Present), or just the selected period?"})]}),a.jsxs("div",{className:"px-6 pb-6 flex flex-col gap-3",children:[a.jsxs("button",{onClick:le,className:"w-full px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[a.jsx(qf,{className:"w-5 h-5"}),"Mark Both Periods (All Present)"]}),a.jsx("button",{onClick:O,className:"w-full px-4 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Single Period Only"}),a.jsx("button",{onClick:()=>{G(!1),X(null),K(null)},className:"w-full px-4 py-2 text-slate-600 hover:text-slate-800 text-sm font-medium transition-colors",children:"Cancel"})]})]})})]})}const GOe=()=>{const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState(!1),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState([]),[h,p]=x.useState(null),[m,g]=x.useState("overall"),[y,b]=x.useState(!1),[v,w]=x.useState(null),[S,k]=x.useState([]),[j,A]=x.useState([]),[L,P]=x.useState(null),[B,E]=x.useState({}),[T,F]=x.useState(!1);x.useEffect(()=>{z()},[]),x.useEffect(()=>{se()},[]),x.useEffect(()=>{de()},[]),x.useEffect(()=>{W()},[]),x.useEffect(()=>{h&&(h==="all"||h==="department"?g("overall"):h==="class"&&g("assigned"))},[h]);async function W(){try{const X=await yr("/api/academics/analytics/filters/");if(!X.ok)return p(null);const C=await X.json().catch(()=>null);p((C==null?void 0:C.permission_level)||null),k((C==null?void 0:C.departments)||[]),A((C==null?void 0:C.sections)||[]),((C==null?void 0:C.departments)||[]).length>0&&P((C.departments[0]||{}).id||null)}catch(X){console.error("Failed to load analytics filters",X),p(null)}}async function z(){t(!0);try{const X=await yr("/api/academics/analytics/today-periods/"),C=await X.json().catch(()=>null);X.ok?n(C):n(null)}catch(X){console.error("Failed to load today periods",X),n(null)}finally{t(!1)}}async function se(){s(!0);try{const X=new Date().toISOString().split("T")[0],C=await yr(`/api/academics/staff/periods/?date=${X}`),K=await C.json().catch(()=>({results:[]}));C.ok?l(K.results||[]):l([])}catch(X){console.error("Failed to load assigned periods",X),l([])}finally{s(!1)}}async function de(){u(!0);try{const X=new Date().toISOString().split("T")[0],C=await yr(`/api/academics/analytics/overall-section/?date=${X}`);if(!C.ok){f([]),u(!1);return}const K=await C.json().catch(()=>({sections:[]}));f(K.sections||[])}catch(X){console.error("Failed to load overall sections",X),f([])}finally{u(!1)}}async function U(X){if(!X)return;F(!0);const C=new Date().toISOString().split("T")[0],K=j.filter(R=>String(R.batch__course__department__id)===String(X)),V={};try{await Promise.all(K.map(async R=>{try{const J=await yr(`/api/academics/analytics/class-report/?section_id=${R.id}&date=${C}&period_index=1`);if(!J.ok)return;const q=await J.json().catch(()=>null);q&&(V[R.id]=q)}catch{}})),E(R=>({...R,...V}))}finally{F(!1)}}const G=async X=>{if(!X)return alert("No session available");if(confirm("Request unlock for this session?"))try{const C=await yr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:X,note:""})});if(!C.ok){const K=await C.json().catch(()=>({}));C.status===400&&K.detail&&String(K.detail).includes("already pending")?alert("An unlock request for this session is already pending."):alert("Failed to create unlock request: "+(K.detail||C.status));return}alert("Unlock request submitted successfully")}catch(C){console.error(C),alert("Failed to submit request")}};async function re(X){if(X){b(!0),w(null);try{const C=new Date().toISOString().split("T")[0],K=await yr(`/api/academics/analytics/class-report/?section_id=${X}&date=${C}`);if(!K.ok){const R=await K.json().catch(()=>({}));alert("Failed to load section report: "+(R.detail||K.status)),b(!1);return}const V=await K.json().catch(()=>null);w(V),g("section")}catch(C){console.error("Failed to load section report",C),alert("Failed to load section report")}finally{b(!1)}}}return a.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Unlock Requests"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Request unlock for a locked attendance session from the list below."})]}),e&&a.jsx("div",{className:"py-6 text-gray-600",children:"Loading today's periods"}),a.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[(h==="all"||h==="department")&&a.jsx("button",{onClick:()=>g("overall"),className:`px-3 py-1 rounded ${m==="overall"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Overall"}),a.jsx("button",{onClick:()=>g("assigned"),className:`px-3 py-1 rounded ${m==="assigned"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"My Assigned"})]}),m==="overall"&&!c&&a.jsx("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-sm text-gray-700",children:"Overall sections (permissioned)"}),S&&S.length>0&&a.jsxs("select",{value:L??"",onChange:X=>{const C=X.target.value,K=C?Number(C):null;P(K),K&&U(K)},className:"px-2 py-1 border rounded",children:[a.jsx("option",{value:"",children:"-- Select department --"}),S.map(X=>a.jsx("option",{value:X.id,children:X.short_name||X.name},X.id))]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:de,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[a.jsx(O2,{className:"w-4 h-4"})," Refresh"]}),L&&a.jsx("button",{onClick:()=>L&&U(L),className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:"Load Dept Sections"})]})]}),a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:L?j.filter(X=>String(X.batch__course__department__id)===String(L)).map(X=>{const C=B[X.id];return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:X.name}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:(C==null?void 0:C.present)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:(C==null?void 0:C.absent)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:(C==null?void 0:C.on_duty)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:(C==null?void 0:C.total_strength)??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:C!=null&&C.is_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(n0,{className:"w-3 h-3 mr-1"}),"Locked"]}):C!=null&&C.total_marked?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>re(X.id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},X.id)}):d.map(X=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(X.department_short||X.department_name?`${X.department_short||X.department_name} - `:"")+(X.section_name||"")}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:X.present??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:X.absent??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:X.on_duty??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:X.total_strength??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:X.is_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(n0,{className:"w-3 h-3 mr-1"}),"Locked"]}):X.marked_at?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>re(X.section_id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},X.section_id))})]})]})}),m==="section"&&v&&a.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg font-medium",children:v.section_name}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Date: ",v.date]})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>g("overall"),className:"px-3 py-1 rounded bg-gray-100",children:"Back"})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Present",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.present})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Absent",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.absent})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["OD",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.on_duty})]})]})]}),!i&&o&&o.length>0&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"text-sm text-gray-700"}),a.jsxs("button",{onClick:se,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[a.jsx(O2,{className:"w-4 h-4"})," Refresh"]})]}),a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Period"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Subject"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(X=>{var C,K;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:((C=X.period)==null?void 0:C.label)||((K=X.period)==null?void 0:K.index)||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:X.subject_display||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:X.section_name||"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:X.present??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:X.absent??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:X.on_duty??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:X.total_strength??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:X.attendance_session_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(n0,{className:"w-3 h-3 mr-1"}),"Locked"]}):X.present!==null?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>{var V;return G(X.attendance_session_id||((V=X.attendance_session)==null?void 0:V.id)||X.session_id)},className:`px-3 py-1 rounded text-sm ${X.attendance_session_locked?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-100 text-gray-600 cursor-not-allowed"}`,disabled:!X.attendance_session_locked,children:"Request Unlock"})})]},X.id||X.session_id)})})]})]})}),!e&&(!r||r.periods.length===0)&&a.jsx("div",{className:"text-gray-600 py-6",children:"No periods available for today."})]})};function KOe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[i,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(!1);x.useEffect(()=>{const p=new Date,m=p.toISOString().slice(0,10),g=new Date(p.getTime()-1e3*60*60*24*30).toISOString().slice(0,10);t(g),n(m)},[]),x.useEffect(()=>{e&&r&&d()},[e,r]);async function d(){u(!0);try{const p=`?start_date=${e}&end_date=${r}`;console.log("Fetching student attendance:",{startDate:e,endDate:r,url:`/api/academics/student/attendance/${p}`});const m=await yr(`/api/academics/student/attendance/${p}`);if(!m.ok){const y=await m.text();throw console.error("Failed to fetch attendance:",m.status,y),new Error(`Failed to fetch (${m.status})`)}const g=await m.json();console.log("Student attendance response:",{recordCount:(g.results||[]).length,summary:g.summary,records:g.results}),s(g.results||[]),l(g.summary||null)}catch(p){console.error("fetchRecords error:",p),s([]),alert("Failed to load attendance records: "+(p instanceof Error?p.message:String(p)))}finally{u(!1)}}function f(p){switch(p){case"P":return"bg-green-100 text-green-800 border-green-200";case"A":return"bg-red-100 text-red-800 border-red-200";case"LEAVE":return"bg-blue-100 text-blue-800 border-blue-200";case"OD":return"bg-purple-100 text-purple-800 border-purple-200";case"LATE":return"bg-amber-100 text-amber-800 border-amber-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}function h(p){switch(p){case"P":return a.jsx(qf,{className:"h-3.5 w-3.5"});case"A":return a.jsx(b3,{className:"h-3.5 w-3.5"});default:return a.jsx(td,{className:"h-3.5 w-3.5"})}}return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(qf,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Attendance"}),a.jsx("p",{className:"text-gray-600",children:"View your attendance records and statistics"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(xs,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Date Range"})]}),a.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-[200px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"From Date"}),a.jsx("input",{type:"date",value:e,onChange:p=>t(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsxs("div",{className:"flex-1 min-w-[200px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"To Date"}),a.jsx("input",{type:"date",value:r,onChange:p=>n(p.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsx("button",{onClick:d,disabled:c,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors font-medium flex items-center gap-2",children:c?a.jsxs(a.Fragment,{children:[a.jsx(Ku,{className:"h-4 w-4 animate-spin"}),"Loading..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xs,{className:"h-4 w-4"}),"Refresh"]})})]}),!c&&i.length>0&&a.jsxs("div",{className:"mt-3 text-sm text-gray-600 flex items-center gap-2",children:[a.jsx(qf,{className:"h-4 w-4 text-green-600"}),"Showing ",i.length," attendance record",i.length!==1?"s":""," from ",e," to ",r]})]}),c?a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx(Ku,{className:"animate-spin h-5 w-5 text-indigo-600"}),a.jsx("span",{children:"Loading attendance records..."})]})})}):a.jsx("div",{children:i.length===0?a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(td,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Records Found"}),a.jsx("p",{className:"text-gray-600",children:"No attendance records found for the selected date range."})]})}):a.jsxs("div",{className:"space-y-6",children:[o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Fte,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Overall Attendance"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200",children:[a.jsx("div",{className:"text-sm text-green-700 font-medium mb-1",children:"Attendance Rate"}),a.jsx("div",{className:"text-3xl font-bold text-green-900",children:o.overall.percentage!=null?`${o.overall.percentage.toFixed(1)}%`:"N/A"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[a.jsx("div",{className:"text-sm text-blue-700 font-medium mb-1",children:"Present"}),a.jsx("div",{className:"text-3xl font-bold text-blue-900",children:o.overall.present})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200",children:[a.jsx("div",{className:"text-sm text-purple-700 font-medium mb-1",children:"Total Periods"}),a.jsx("div",{className:"text-3xl font-bold text-purple-900",children:o.overall.total_marked_periods})]})]})]}),o&&o.by_subject&&o.by_subject.length>0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(ms,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Subject-wise Breakdown"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.by_subject.map(p=>{const m=p.percentage!=null?p.percentage:0,g=p.counts||{};return a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsx("div",{className:"font-semibold text-gray-900",children:p.subject_display||p.subject_key}),a.jsx("div",{className:"text-lg font-bold text-indigo-600",children:m!=null?`${m.toFixed(1)}%`:"N/A"})]}),a.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full overflow-hidden mb-3",children:a.jsx("div",{className:`h-full transition-all ${m>=75?"bg-green-500":m>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(0,Math.min(100,m))}%`}})}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded border border-green-200",children:["P: ",g.P||0]}),a.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded border border-red-200",children:["A: ",g.A||0]}),a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded border border-blue-200",children:["LEAVE: ",g.LEAVE||0]}),a.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded border border-purple-200",children:["OD: ",g.OD||0]}),a.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded border border-amber-200",children:["LATE: ",g.LATE||0]})]})]},p.subject_key)})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(rc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Attendance Records"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Period"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Section"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Marked By"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:i.map(p=>{var m,g,y;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xs,{className:"h-4 w-4 text-gray-400"}),p.date]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((m=p.period)==null?void 0:m.label)||((g=p.period)!=null&&g.index?`Period ${p.period.index}`:"")}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((y=p.section)==null?void 0:y.name)||""}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 font-medium",children:p.subject_display||""}),a.jsx("td",{className:"px-6 py-4 text-sm",children:a.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-md text-xs font-medium border ${f(p.status)}`,children:[h(p.status),p.status]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(z0,{className:"h-3.5 w-3.5 text-gray-400"}),p.marked_by||""]})})]},p.id)})})]})})]})]})})]})})}const kg="";async function YOe(){const e=await yr(`${kg}/api/academics/mentor/staff/`);return e.ok?e.json():{results:[]}}async function XOe(e){const t=await yr(`${kg}/api/academics/mentor/staff/${e}/students/`);return t.ok?t.json():{results:[]}}async function QOe(e,t){return await yr(`${kg}/api/academics/mentor/map/`,{method:"POST",body:JSON.stringify({mentor_id:e,student_ids:t})})}async function nF(){const e=await yr(`${kg}/api/academics/my-students/`);return e.ok?e.json():{results:[]}}async function JOe(e,t){const r={student_ids:[e]};return t&&(r.mentor_id=t),await yr(`${kg}/api/academics/mentor/unmap/`,{method:"POST",body:JSON.stringify(r)})}async function ZOe(){const e=await yr(`${kg}/api/academics/mentor/my-mentees/`);return e.ok?e.json():{results:[]}}function eMe(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(!1);x.useEffect(()=>{d()},[]);async function d(){const y=await YOe();t(y.results||[])}async function f(){const b=(await nF()).results||[],v=[];b.forEach(w=>{(w.students||[]).forEach(k=>v.push(k))}),s(v)}async function h(y){n(y),l([]),s([]);const v=(await XOe(y)).results||[],S=(await nF()).results||[],k=[];S.forEach(L=>{(L.students||[]).forEach(B=>k.push(B))});const j=new Set(v.map(L=>L.id)),A=k.filter(L=>!j.has(L.id)&&!L.has_mentor);l(v),s(A)}async function p(y){if(!r)return alert("Select a mentor first");u(!0);const b=await QOe(r,[y]);if(b.ok)await f(),r&&await h(r);else{const v=await b.json().catch(()=>null);alert("Failed: "+(v&&v.detail?v.detail:b.statusText))}u(!1)}async function m(y){if(!r)return;u(!0);const b=await JOe(y,r);if(b.ok)await f(),r&&await h(r);else{const v=await b.json().catch(()=>null);alert("Failed to remove: "+(v&&v.detail?v.detail:b.statusText))}u(!1)}const g=e.find(y=>y.id===r);return a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(zv,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mentor Assignment"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Assign and manage mentor mappings for your students"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsxs("h3",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-600"}),"Staff Members",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})}),a.jsx("div",{className:"p-4 max-h-[600px] overflow-y-auto",children:e.length===0?a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No staff members available"}):a.jsx("div",{className:"space-y-2",children:e.map(y=>a.jsx("div",{className:`p-4 rounded-lg border transition-all cursor-pointer ${r===y.id?"bg-gradient-to-r from-indigo-50 to-blue-50 border-indigo-300 shadow-md":"bg-white border-slate-200 hover:border-indigo-200 hover:shadow-sm"}`,onClick:()=>h(y.id),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:`font-medium ${r===y.id?"text-indigo-900":"text-slate-900"}`,children:y.username}),a.jsx("div",{className:"text-sm text-slate-600 mt-1",children:a.jsx("span",{className:"font-mono",children:y.staff_id||"N/A"})})]}),a.jsxs("button",{onClick:b=>{b.stopPropagation(),h(y.id)},className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${r===y.id?"bg-indigo-600 text-white":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"}`,children:[a.jsx(i9,{className:"w-4 h-4"}),"View"]})]})},y.id))})})]})}),a.jsx("div",{className:"lg:col-span-3",children:r?a.jsxs("div",{className:"space-y-6",children:[g&&a.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-4 shadow-lg",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(zv,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:["Selected Mentor: ",g.username]}),a.jsxs("div",{className:"text-sm opacity-90",children:["Staff ID: ",g.staff_id||"N/A"]})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-green-50",children:a.jsxs("h4",{className:"text-base font-semibold text-green-900 flex items-center gap-2",children:[a.jsx(ey,{className:"w-5 h-5 text-green-700"}),"Assigned Students",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-green-200 text-green-800 text-xs font-medium rounded-full",children:o.length})]})}),a.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:o.length>0?a.jsx("div",{className:"space-y-2",children:o.map(y=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[y.reg_no,"  ",y.username]}),a.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:y.section_name})]}),a.jsxs("button",{className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-red-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>m(y.id),disabled:c,children:[a.jsx(Wte,{className:"w-4 h-4"}),"Remove"]})]},y.id))}):a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No students currently assigned to this mentor"})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-blue-50",children:a.jsxs("h4",{className:"text-base font-semibold text-blue-900 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-blue-700"}),"Available to Assign",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-blue-200 text-blue-800 text-xs font-medium rounded-full",children:i.length})]})}),a.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:i.length>0?a.jsx("div",{className:"space-y-2",children:i.map(y=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[y.reg_no,"  ",y.username]}),a.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:y.section_name})]}),a.jsxs("button",{className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-green-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>p(y.id),disabled:c||!r,children:[c?a.jsx(Ku,{className:"w-4 h-4 animate-spin"}):a.jsx(Ute,{className:"w-4 h-4"}),"Assign"]})]},y.id))}):a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No available students to assign"})})]})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:a.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(zv,{className:"w-16 h-16 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"Select a Staff Member"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Click on a staff member to view and manage their mentee assignments"})]})})})]})]})}function tMe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1);x.useEffect(()=>{i()},[]);async function i(){n(!0);try{const s=await ZOe();t(s.results||[])}catch(s){console.error(s),alert("Failed to load mentees")}finally{n(!1)}}return a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(ys,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Mentees"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Students assigned to you as mentor"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(zv,{className:"w-5 h-5 text-indigo-600"}),"Mentees List",!r&&e.length>0&&a.jsx("span",{className:"ml-2 px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})})}),a.jsxs("div",{className:"p-6",children:[r&&a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx(Ku,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"ml-3 text-slate-600",children:"Loading mentees..."})]}),!r&&e.length===0&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(ys,{className:"w-12 h-12 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Mentees Assigned"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned as mentees yet."})]}),!r&&e.length>0&&a.jsx("div",{children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Section"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:e.map(s=>a.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-medium text-slate-900",children:s.reg_no})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm text-slate-700",children:s.username})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:s.section_name||"N/A"})})]},s.id))})]})})]})]})]})}async function rMe(){var t;return((t=(await tl.get("notification-templates/")).data)==null?void 0:t.templates)||[]}async function nMe(e){return(await tl.put("notification-templates/",{templates:e})).data}const Av=[{label:"{otp}",value:"{otp}",description:"Auto-generated OTP code",category:"auth"},{label:"{username}",value:"{username}",description:"User's username",category:"user"},{label:"{email}",value:"{email}",description:"User's email",category:"user"},{label:"{mobile}",value:"{mobile}",description:"Mobile number",category:"user"},{label:"{name}",value:"{name}",description:"Full name",category:"user"},{label:"{expiry}",value:"{expiry}",description:"OTP/time expiry",category:"time"},{label:"{subject}",value:"{subject}",description:"Subject/course name",category:"academic"},{label:"{assessment}",value:"{assessment}",description:"Assessment type (CIA1, CIA2, etc.)",category:"academic"},{label:"{percentage}",value:"{percentage}",description:"Percentage value",category:"academic"},{label:"{time}",value:"{time}",description:"Timestamp",category:"time"},{label:"{date}",value:"{date}",description:"Date",category:"time"}],Aj=[{id:"mobile_verify",name:"Mobile Number Verification OTP",template:"Your OTP is {otp}. It is valid for {expiry} minutes. - IQAC",enabled:!0,expiry_minutes:5},{id:"password_reset",name:"Password Reset OTP",template:"Hello {username}, your password reset OTP is {otp}. Valid for {expiry} minutes. - IQAC",enabled:!1,expiry_minutes:10},{id:"login_alert",name:"Login Alert Notification",template:"Hello {name}, a login was detected on your account from a new device at {time}.",enabled:!1},{id:"obe_approval",name:"OBE Edit Request Approved",template:"Your OBE edit request for {subject} ({assessment}) has been approved. Edit until: {expiry}",enabled:!1},{id:"attendance_alert",name:"Low Attendance Alert",template:"Dear {name}, your attendance is {percentage}% in {subject}. Please improve to meet requirements.",enabled:!1}];function iMe(){const[e,t]=x.useState(Aj),[r,n]=x.useState("mobile_verify"),[i,s]=x.useState(null),[o,l]=x.useState(!0),[c,u]=x.useState(null),d=e.find(S=>S.id===r),f=x.useMemo(()=>{const S=d==null?void 0:d.expiry_minutes;return typeof S=="number"&&Number.isFinite(S)&&S>0?String(S):"5"},[d]);x.useEffect(()=>{let S=!0;return l(!0),u(null),rMe().then(k=>{var j;if(S&&k&&k.length){const A=new Map(k.map(T=>[T.code,{id:T.code,name:T.name,template:T.template,enabled:!!T.enabled,expiry_minutes:T.expiry_minutes??null,updated_at:T.updated_at}])),L=Aj.map(T=>A.get(T.id)||T),P=k.filter(T=>!Aj.some(F=>F.id===T.code)).map(T=>A.get(T.code)).filter(Boolean),B=[...L,...P];t(B);const E=B.some(T=>T.id==="mobile_verify")?"mobile_verify":((j=B[0])==null?void 0:j.id)||null;n(E)}}).catch(k=>{var j,A;S&&u(String(((A=(j=k==null?void 0:k.response)==null?void 0:j.data)==null?void 0:A.detail)||(k==null?void 0:k.message)||k||"Failed to load templates"))}).finally(()=>{S&&l(!1)}),()=>{S=!1}},[]);const h=S=>{r&&t(k=>k.map(j=>j.id===r?{...j,template:j.template+" "+S}:j))},p=(S,k)=>{t(j=>j.map(A=>A.id===S?{...A,template:k}:A))},m=S=>{t(k=>k.map(j=>j.id===S?{...j,enabled:!j.enabled}:j))},g=async()=>{var S,k;s("saving");try{await nMe(e.map(j=>({code:j.id,name:j.name,template:j.template,enabled:!!j.enabled,expiry_minutes:j.expiry_minutes??null,updated_at:j.updated_at}))),s("saved"),setTimeout(()=>s(null),2e3)}catch(j){s("error"),setTimeout(()=>s(null),2500),alert(String(((k=(S=j==null?void 0:j.response)==null?void 0:S.data)==null?void 0:k.detail)||(j==null?void 0:j.message)||j||"Failed to save"))}},y=()=>{const S=`template_${Date.now()}`,k={id:S,name:"New Message Template",template:"Enter your message here...",enabled:!1,expiry_minutes:null};t(j=>[...j,k]),n(S)},b=S=>{var k;confirm("Are you sure you want to delete this template?")&&(t(j=>j.filter(A=>A.id!==S)),r===S&&n(((k=e[0])==null?void 0:k.id)||null))},v=(S,k)=>{t(j=>j.map(A=>A.id===S?{...A,name:k}:A))},w=(S,k)=>{const j=String(k??"").trim(),A=j===""?null:Number(j);t(L=>L.map(P=>P.id!==S?P:A===null?{...P,expiry_minutes:null}:!Number.isFinite(A)||A<=0?P:{...P,expiry_minutes:Math.floor(A)}))};return a.jsx(Zh,{children:a.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[a.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Nx,{className:"w-8 h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notification Templates"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Configure message templates for OTP, alerts, and notifications"})]})]}),a.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Mm,{className:"w-4 h-4"}),"Add Template"]})]}),c?a.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-800 rounded-lg p-3 text-sm",children:c}):null,a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[a.jsx("div",{className:"lg:col-span-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:a.jsx("h2",{className:"font-semibold text-gray-900",children:"Message Templates"})}),a.jsx("div",{className:"divide-y divide-gray-200",children:e.map(S=>a.jsx("div",{onClick:()=>n(S.id),className:`p-4 cursor-pointer transition-colors ${r===S.id?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-gray-900 truncate",children:S.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:S.template})]}),a.jsx("div",{className:"ml-2 flex items-center gap-2",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded ${S.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:S.enabled?"Active":"Inactive"})})]})},S.id))})]})}),a.jsx("div",{className:"lg:col-span-8",children:o?a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 text-gray-600",children:"Loading templates"}):d?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("input",{type:"text",value:d.name,onChange:S=>v(d.id,S.target.value),className:"text-lg font-semibold text-gray-900 bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 -mx-2"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>m(d.id),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${d.enabled?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:d.enabled?"Enabled":"Disabled"}),a.jsx("button",{onClick:()=>b(d.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete template",children:a.jsx(gu,{className:"w-5 h-5"})})]})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[d.template.includes("{expiry}")?a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-blue-900",children:"Validity Time"}),a.jsxs("div",{className:"text-xs text-blue-800",children:["Controls ","{expiry}"," and OTP expiry minutes."]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",min:1,value:String(d.expiry_minutes??""),onChange:S=>w(d.id,S.target.value),className:"w-24 px-3 py-2 border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"5"}),a.jsx("span",{className:"text-sm text-blue-900",children:"minutes"})]})]})}):null,a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Template"}),a.jsx("textarea",{value:d.template,onChange:S=>p(d.id,S.target.value),rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"Enter your message template here..."}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Use placeholders from the buttons below to insert dynamic values"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Insert Placeholders"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"User Information"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Av.filter(S=>S.category==="user").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Authentication"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Av.filter(S=>S.category==="auth").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Academic"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Av.filter(S=>S.category==="academic").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Date & Time"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Av.filter(S=>S.category==="time").map(S=>a.jsxs("button",{onClick:()=>h(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Preview (valid for ",f," minutes)"]}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:a.jsx("div",{className:"text-sm text-gray-700 font-mono whitespace-pre-wrap",children:d.template.replace(/{otp}/g,"123456").replace(/{username}/g,"john_doe").replace(/{email}/g,"john@example.com").replace(/{mobile}/g,"+91XXXXXXXXXX").replace(/{name}/g,"John Doe").replace(/{expiry}/g,f).replace(/{subject}/g,"Mathematics").replace(/{assessment}/g,"CIA1").replace(/{percentage}/g,"75").replace(/{time}/g,new Date().toLocaleTimeString()).replace(/{date}/g,new Date().toLocaleDateString())})}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"This is how your message will look with sample data"})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[a.jsx("div",{className:"text-sm text-gray-600",children:i==="saved"&&a.jsx("span",{className:"text-green-600 font-medium",children:" Template saved successfully"})}),a.jsxs("button",{onClick:g,disabled:i==="saving",className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[a.jsx(nd,{className:"w-4 h-4"}),i==="saving"?"Saving...":"Save Template"]})]})]})]}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[a.jsx(Nx,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Select a template from the list or create a new one"})]})})]})]})})}function aMe(){const[e,t]=x.useState(null),[r,n]=x.useState(!0),{collapsed:i}=w3();return x.useEffect(()=>{y0().then(o=>{const l={...o,roles:Array.isArray(o.roles)?o.roles.map(c=>typeof c=="string"?c:c.name):[],permissions:Array.isArray(o.permissions)?o.permissions:[],profile_type:o.profile_type||null,profile:o.profile||null};t(l)}).catch(()=>t(null)).finally(()=>n(!1))},[]),r?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("p",{className:"text-gray-600",children:"Loading..."})}):((Array.isArray(e==null?void 0:e.permissions)?e==null?void 0:e.permissions:[]).map(o=>String(o||"").toLowerCase()),a.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-x-hidden",children:[a.jsx(s9,{user:e}),e?a.jsxs("div",{className:"flex",children:[a.jsx(wre,{}),a.jsx("main",{className:`flex-1 min-w-0 transition-all duration-300 pt-20 overflow-x-hidden ${i?"lg:pl-20":"lg:pl-64"}`,children:a.jsx("div",{className:"app-main-zoom",children:a.jsxs(v4,{children:[a.jsx(ni,{path:"/",element:a.jsx(Jp,{to:"/dashboard",replace:!0})}),a.jsx(ni,{path:"/dashboard",element:a.jsx(dOe,{})}),a.jsx(ni,{path:"/profile",element:a.jsx(hOe,{user:e})}),a.jsx(ni,{path:"/notifications",element:a.jsx(iMe,{})}),a.jsx(ni,{path:"/import/questions",element:a.jsx(_Oe,{})}),a.jsx(ni,{path:"/curriculum/master",element:a.jsx(pOe,{})}),a.jsx(ni,{path:"/curriculum/master/:id",element:a.jsx(KB,{})}),a.jsx(ni,{path:"/curriculum/master/new",element:a.jsx(KB,{})}),a.jsx(ni,{path:"/curriculum/department",element:a.jsx(mOe,{})}),a.jsx(ni,{path:"/curriculum/elective-import",element:a.jsx(va,{user:e,requiredPermissions:["curriculum.import_elective_choices"],element:a.jsx(gOe,{})})}),a.jsx(ni,{path:"/obe",element:a.jsx(PK,{})}),a.jsx(ni,{path:"/obe/course/:code/lca/cotarget",element:a.jsx(sMe,{})}),a.jsx(ni,{path:"/obe/course/:code/*",element:a.jsx(OOe,{})}),a.jsx(ni,{path:"/obe/request",element:a.jsx(va,{user:e,requiredProfile:"STAFF",element:a.jsx(MOe,{})})}),a.jsx(ni,{path:"/obe/master/requests",element:a.jsx(va,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(cOe,{})})}),a.jsx(ni,{path:"/obe/master/due-dates",element:a.jsx(va,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(j3,{})})}),a.jsx(ni,{path:"/academic",element:a.jsx(wOe,{})}),a.jsx(ni,{path:"/hod/advisors",element:a.jsx(va,{user:e,requiredRoles:["HOD"],requiredPermissions:["academics.assign_advisor"],element:a.jsx(LOe,{})})}),a.jsx(ni,{path:"/hod/obe-requests",element:a.jsx(va,{user:e,requiredRoles:["HOD"],requiredPermissions:["academics.assign_advisor"],element:a.jsx(BOe,{})})}),a.jsx(ni,{path:"/advisor/teaching",element:a.jsx(va,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_teaching"],element:a.jsx(ROe,{})})}),a.jsx(ni,{path:"/iqac/timetable",element:a.jsx(va,{user:e,requiredPermissions:["timetable.manage_templates"],element:a.jsx(jre,{})})}),a.jsx(ni,{path:"/iqac/academic-controller",element:a.jsx(va,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(nne,{})})}),a.jsx(ni,{path:"/iqac/academic-controller/course/:courseCode",element:a.jsx(va,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(sne,{})})}),a.jsx(ni,{path:"/iqac/academic-controller/course/:courseCode/marks/:taId",element:a.jsx(va,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(OPe,{})})}),a.jsx(ni,{path:"/iqac/academic-controller/course/:courseCode/internal-mark/:taId",element:a.jsx(va,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(lOe,{})})}),a.jsx(ni,{path:"/iqac/academic-controller/course/:courseCode/obe/:taId/*",element:a.jsx(va,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(oOe,{})})}),a.jsx(ni,{path:"/iqac/obe-requests",element:a.jsx(va,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(F9,{})})}),a.jsx(ni,{path:"/advisor/timetable",element:a.jsx(va,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["timetable.assign"],element:a.jsx(kre,{})})}),a.jsx(ni,{path:"/advisor/students",element:a.jsx(va,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.view_my_students"],element:a.jsx(FOe,{})})}),a.jsx(ni,{path:"/advisor/mentor",element:a.jsx(va,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_mentor"],element:a.jsx(eMe,{})})}),a.jsx(ni,{path:"/student/timetable",element:a.jsx(va,{user:e,requiredProfile:"STUDENT",requiredPermissions:["timetable.view"],element:a.jsx(DOe,{})})}),a.jsx(ni,{path:"/student/attendance",element:a.jsx(va,{user:e,requiredProfile:"STUDENT",element:a.jsx(KOe,{})})}),a.jsx(ni,{path:"/staff/timetable",element:a.jsx(va,{user:e,requiredProfile:"STAFF",requiredPermissions:["timetable.view"],element:a.jsx(zOe,{})})}),a.jsx(ni,{path:"/staff/assigned-subjects",element:a.jsx(va,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_assigned_subjects"],element:a.jsx(HOe,{})})}),a.jsx(ni,{path:"/staff/period-attendance",element:a.jsx(va,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.mark_attendance"],element:a.jsx(VOe,{})})}),a.jsx(ni,{path:"/staff/analytics",element:a.jsx(va,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_all_attendance","academics.view_attendance_overall","academics.view_all_departments","academics.view_department_attendance","academics.view_class_attendance","academics.view_section_attendance"],element:a.jsx(GOe,{})})}),a.jsx(ni,{path:"/staff/mentees",element:a.jsx(va,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_mentees"],element:a.jsx(tMe,{})})}),a.jsx(ni,{path:"*",element:e?a.jsx(Jp,{to:"/dashboard",replace:!0}):a.jsx(vj,{user:e})})]})})})]}):a.jsx("div",{className:"pt-16",children:a.jsxs(v4,{children:[a.jsx(ni,{path:"/",element:e?a.jsx(Jp,{to:"/dashboard",replace:!0}):a.jsx(vj,{user:e})}),a.jsx(ni,{path:"*",element:e?a.jsx(Jp,{to:"/dashboard",replace:!0}):a.jsx(vj,{user:e})})]})})]}))}function sMe(){const{code:e}=U0(),t=e?decodeURIComponent(e):void 0;return a.jsx(AK,{courseCode:t})}function oMe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(!1),d=go();function f(p){if(typeof p!="object"||p===null)return null;const g=p.response;if(!g)return null;const y=g.data;if(!y)return null;const b=y.non_field_errors;return Array.isArray(b)&&b.length>0?String(b[0]):typeof y.detail=="string"?y.detail:null}const h=async p=>{p.preventDefault(),l(null),u(!0);try{await JD(e,r),d("/dashboard")}catch(m){const g=f(m)||"Login failed";l(g)}finally{u(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx(s9,{user:null}),a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"max-w-md w-full",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 sm:p-10",children:[a.jsxs("div",{className:"mb-8 text-center",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),a.jsx("p",{className:"text-gray-600",children:"Sign in to access your account"})]}),a.jsxs("form",{className:"space-y-6",onSubmit:h,children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"identifier",children:"Email or Register No"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(v3,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"identifier",type:"text",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"College Email or Reg. No.",value:e,onChange:p=>t(p.target.value),required:!0,disabled:c})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"password",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(n0,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",type:i?"text":"password",className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter your password",value:r,onChange:p=>n(p.target.value),required:!0,disabled:c}),a.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",onClick:()=>s(!i),"aria-label":i?"Hide password":"Show password",children:i?a.jsx(ete,{className:"h-5 w-5"}):a.jsx(i9,{className:"h-5 w-5"})})]})]}),a.jsx("div",{className:"flex items-center justify-end",children:a.jsx(es,{to:"/forgot-password",className:"text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:"Forgot Password?"})}),o&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[a.jsx(td,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-800",children:o})]}),a.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed transform hover:scale-[1.02] active:scale-[0.98]",disabled:c,children:c?a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing In..."]}):"Sign In"}),a.jsx("div",{className:"text-center pt-4",children:a.jsx(es,{to:"/",className:"text-sm text-gray-600 hover:text-gray-900 font-medium transition-colors",children:" Back to Home"})})]})]})})})]})}xD(document.getElementById("root")).render(a.jsx(hn.StrictMode,{children:a.jsx(UJ,{children:a.jsx(Qte,{children:a.jsxs(v4,{children:[a.jsx(ni,{path:"/login",element:a.jsx(oMe,{})}),a.jsx(ni,{path:"/*",element:a.jsx(aMe,{})})]})})})}));export{zi as _,cMe as c,af as g};
