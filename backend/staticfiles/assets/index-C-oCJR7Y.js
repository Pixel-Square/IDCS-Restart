var KK=Object.defineProperty;var XK=(e,t,r)=>t in e?KK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ya=(e,t,r)=>XK(e,typeof t!="symbol"?t+"":t,r);function YK(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var jOe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Wd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var $R={exports:{}},Iw={},UR={exports:{}},Zn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M1=Symbol.for("react.element"),QK=Symbol.for("react.portal"),JK=Symbol.for("react.fragment"),ZK=Symbol.for("react.strict_mode"),eX=Symbol.for("react.profiler"),tX=Symbol.for("react.provider"),rX=Symbol.for("react.context"),nX=Symbol.for("react.forward_ref"),aX=Symbol.for("react.suspense"),iX=Symbol.for("react.memo"),sX=Symbol.for("react.lazy"),K6=Symbol.iterator;function oX(e){return e===null||typeof e!="object"?null:(e=K6&&e[K6]||e["@@iterator"],typeof e=="function"?e:null)}var zR={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},WR=Object.assign,qR={};function Dm(e,t,r){this.props=e,this.context=t,this.refs=qR,this.updater=r||zR}Dm.prototype.isReactComponent={};Dm.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Dm.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function HR(){}HR.prototype=Dm.prototype;function Z4(e,t,r){this.props=e,this.context=t,this.refs=qR,this.updater=r||zR}var e3=Z4.prototype=new HR;e3.constructor=Z4;WR(e3,Dm.prototype);e3.isPureReactComponent=!0;var X6=Array.isArray,VR=Object.prototype.hasOwnProperty,t3={current:null},GR={key:!0,ref:!0,__self:!0,__source:!0};function KR(e,t,r){var n,a={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)VR.call(t,n)&&!GR.hasOwnProperty(n)&&(a[n]=t[n]);var l=arguments.length-2;if(l===1)a.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];a.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)a[n]===void 0&&(a[n]=l[n]);return{$$typeof:M1,type:e,key:s,ref:o,props:a,_owner:t3.current}}function lX(e,t){return{$$typeof:M1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function r3(e){return typeof e=="object"&&e!==null&&e.$$typeof===M1}function cX(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Y6=/\/+/g;function n5(e,t){return typeof e=="object"&&e!==null&&e.key!=null?cX(""+e.key):t.toString(36)}function pv(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case M1:case QK:o=!0}}if(o)return o=e,a=a(o),e=n===""?"."+n5(o,0):n,X6(a)?(r="",e!=null&&(r=e.replace(Y6,"$&/")+"/"),pv(a,t,r,"",function(u){return u})):a!=null&&(r3(a)&&(a=lX(a,r+(!a.key||o&&o.key===a.key?"":(""+a.key).replace(Y6,"$&/")+"/")+e)),t.push(a)),1;if(o=0,n=n===""?".":n+":",X6(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+n5(s,l);o+=pv(s,t,r,c,a)}else if(c=oX(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+n5(s,l++),o+=pv(s,t,r,c,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Ky(e,t,r){if(e==null)return e;var n=[],a=0;return pv(e,n,"","",function(s){return t.call(r,s,a++)}),n}function uX(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Go={current:null},mv={transition:null},dX={ReactCurrentDispatcher:Go,ReactCurrentBatchConfig:mv,ReactCurrentOwner:t3};function XR(){throw Error("act(...) is not supported in production builds of React.")}Zn.Children={map:Ky,forEach:function(e,t,r){Ky(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ky(e,function(){t++}),t},toArray:function(e){return Ky(e,function(t){return t})||[]},only:function(e){if(!r3(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Zn.Component=Dm;Zn.Fragment=JK;Zn.Profiler=eX;Zn.PureComponent=Z4;Zn.StrictMode=ZK;Zn.Suspense=aX;Zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dX;Zn.act=XR;Zn.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=WR({},e.props),a=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=t3.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)VR.call(t,c)&&!GR.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:M1,type:e.type,key:a,ref:s,props:n,_owner:o}};Zn.createContext=function(e){return e={$$typeof:rX,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:tX,_context:e},e.Consumer=e};Zn.createElement=KR;Zn.createFactory=function(e){var t=KR.bind(null,e);return t.type=e,t};Zn.createRef=function(){return{current:null}};Zn.forwardRef=function(e){return{$$typeof:nX,render:e}};Zn.isValidElement=r3;Zn.lazy=function(e){return{$$typeof:sX,_payload:{_status:-1,_result:e},_init:uX}};Zn.memo=function(e,t){return{$$typeof:iX,type:e,compare:t===void 0?null:t}};Zn.startTransition=function(e){var t=mv.transition;mv.transition={};try{e()}finally{mv.transition=t}};Zn.unstable_act=XR;Zn.useCallback=function(e,t){return Go.current.useCallback(e,t)};Zn.useContext=function(e){return Go.current.useContext(e)};Zn.useDebugValue=function(){};Zn.useDeferredValue=function(e){return Go.current.useDeferredValue(e)};Zn.useEffect=function(e,t){return Go.current.useEffect(e,t)};Zn.useId=function(){return Go.current.useId()};Zn.useImperativeHandle=function(e,t,r){return Go.current.useImperativeHandle(e,t,r)};Zn.useInsertionEffect=function(e,t){return Go.current.useInsertionEffect(e,t)};Zn.useLayoutEffect=function(e,t){return Go.current.useLayoutEffect(e,t)};Zn.useMemo=function(e,t){return Go.current.useMemo(e,t)};Zn.useReducer=function(e,t,r){return Go.current.useReducer(e,t,r)};Zn.useRef=function(e){return Go.current.useRef(e)};Zn.useState=function(e){return Go.current.useState(e)};Zn.useSyncExternalStore=function(e,t,r){return Go.current.useSyncExternalStore(e,t,r)};Zn.useTransition=function(){return Go.current.useTransition()};Zn.version="18.3.1";UR.exports=Zn;var x=UR.exports;const Zr=Wd(x),YR=YK({__proto__:null,default:Zr},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fX=x,hX=Symbol.for("react.element"),pX=Symbol.for("react.fragment"),mX=Object.prototype.hasOwnProperty,gX=fX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xX={key:!0,ref:!0,__self:!0,__source:!0};function QR(e,t,r){var n,a={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)mX.call(t,n)&&!xX.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:hX,type:e,key:s,ref:o,props:a,_owner:gX.current}}Iw.Fragment=pX;Iw.jsx=QR;Iw.jsxs=QR;$R.exports=Iw;var i=$R.exports,JR={exports:{}},ql={},ZR={exports:{}},eB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(V,K){var de=V.length;V.push(K);e:for(;0<de;){var ne=de-1>>>1,E=V[ne];if(0<a(E,K))V[ne]=K,V[de]=E,de=ne;else break e}}function r(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var K=V[0],de=V.pop();if(de!==K){V[0]=de;e:for(var ne=0,E=V.length,Z=E>>>1;ne<Z;){var H=2*(ne+1)-1,F=V[H],ee=H+1,z=V[ee];if(0>a(F,de))ee<E&&0>a(z,F)?(V[ne]=z,V[ee]=de,ne=ee):(V[ne]=F,V[H]=de,ne=H);else if(ee<E&&0>a(z,de))V[ne]=z,V[ee]=de,ne=ee;else break e}}return K}function a(V,K){var de=V.sortIndex-K.sortIndex;return de!==0?de:V.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,p=3,h=!1,m=!1,g=!1,b=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(V){for(var K=r(u);K!==null;){if(K.callback===null)n(u);else if(K.startTime<=V)n(u),K.sortIndex=K.expirationTime,t(c,K);else break;K=r(u)}}function _(V){if(g=!1,w(V),!m)if(r(c)!==null)m=!0,xe(C);else{var K=r(u);K!==null&&_e(_,K.startTime-V)}}function C(V,K){m=!1,g&&(g=!1,y(M),M=-1),h=!0;var de=p;try{for(w(K),f=r(c);f!==null&&(!(f.expirationTime>K)||V&&!N());){var ne=f.callback;if(typeof ne=="function"){f.callback=null,p=f.priorityLevel;var E=ne(f.expirationTime<=K);K=e.unstable_now(),typeof E=="function"?f.callback=E:f===r(c)&&n(c),w(K)}else n(c);f=r(c)}if(f!==null)var Z=!0;else{var H=r(u);H!==null&&_e(_,H.startTime-K),Z=!1}return Z}finally{f=null,p=de,h=!1}}var j=!1,A=null,M=-1,P=5,R=-1;function N(){return!(e.unstable_now()-R<P)}function T(){if(A!==null){var V=e.unstable_now();R=V;var K=!0;try{K=A(!0,V)}finally{K?B():(j=!1,A=null)}}else j=!1}var B;if(typeof v=="function")B=function(){v(T)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,re=G.port2;G.port1.onmessage=T,B=function(){re.postMessage(null)}}else B=function(){b(T,0)};function xe(V){A=V,j||(j=!0,B())}function _e(V,K){M=b(function(){V(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,xe(C))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(V){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var de=p;p=K;try{return V()}finally{p=de}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,K){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var de=p;p=V;try{return K()}finally{p=de}},e.unstable_scheduleCallback=function(V,K,de){var ne=e.unstable_now();switch(typeof de=="object"&&de!==null?(de=de.delay,de=typeof de=="number"&&0<de?ne+de:ne):de=ne,V){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=de+E,V={id:d++,callback:K,priorityLevel:V,startTime:de,expirationTime:E,sortIndex:-1},de>ne?(V.sortIndex=de,t(u,V),r(c)===null&&V===r(u)&&(g?(y(M),M=-1):g=!0,_e(_,de-ne))):(V.sortIndex=E,t(c,V),m||h||(m=!0,xe(C))),V},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(V){var K=p;return function(){var de=p;p=K;try{return V.apply(this,arguments)}finally{p=de}}}})(eB);ZR.exports=eB;var yX=ZR.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bX=x,$l=yX;function Wr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tB=new Set,Tx={};function O0(e,t){ym(e,t),ym(e+"Capture",t)}function ym(e,t){for(Tx[e]=t,e=0;e<t.length;e++)tB.add(t[e])}var Cd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),fj=Object.prototype.hasOwnProperty,vX=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Q6={},J6={};function wX(e){return fj.call(J6,e)?!0:fj.call(Q6,e)?!1:vX.test(e)?J6[e]=!0:(Q6[e]=!0,!1)}function SX(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function _X(e,t,r,n){if(t===null||typeof t>"u"||SX(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ko(e,t,r,n,a,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var io={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){io[e]=new Ko(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];io[t]=new Ko(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){io[e]=new Ko(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){io[e]=new Ko(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){io[e]=new Ko(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){io[e]=new Ko(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){io[e]=new Ko(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){io[e]=new Ko(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){io[e]=new Ko(e,5,!1,e.toLowerCase(),null,!1,!1)});var n3=/[\-:]([a-z])/g;function a3(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(n3,a3);io[t]=new Ko(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(n3,a3);io[t]=new Ko(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(n3,a3);io[t]=new Ko(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){io[e]=new Ko(e,1,!1,e.toLowerCase(),null,!1,!1)});io.xlinkHref=new Ko("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){io[e]=new Ko(e,1,!1,e.toLowerCase(),null,!0,!0)});function i3(e,t,r,n){var a=io.hasOwnProperty(t)?io[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(_X(t,r,a,n)&&(r=null),n||a===null?wX(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var qd=bX.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Xy=Symbol.for("react.element"),Op=Symbol.for("react.portal"),Lp=Symbol.for("react.fragment"),s3=Symbol.for("react.strict_mode"),hj=Symbol.for("react.profiler"),rB=Symbol.for("react.provider"),nB=Symbol.for("react.context"),o3=Symbol.for("react.forward_ref"),pj=Symbol.for("react.suspense"),mj=Symbol.for("react.suspense_list"),l3=Symbol.for("react.memo"),Sf=Symbol.for("react.lazy"),aB=Symbol.for("react.offscreen"),Z6=Symbol.iterator;function wg(e){return e===null||typeof e!="object"?null:(e=Z6&&e[Z6]||e["@@iterator"],typeof e=="function"?e:null)}var wi=Object.assign,a5;function Qg(e){if(a5===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);a5=t&&t[1]||""}return`
`+a5+e}var i5=!1;function s5(e,t){if(!e||i5)return"";i5=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var a=u.stack.split(`
`),s=n.stack.split(`
`),o=a.length-1,l=s.length-1;1<=o&&0<=l&&a[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(a[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||a[o]!==s[l]){var c=`
`+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{i5=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Qg(e):""}function kX(e){switch(e.tag){case 5:return Qg(e.type);case 16:return Qg("Lazy");case 13:return Qg("Suspense");case 19:return Qg("SuspenseList");case 0:case 2:case 15:return e=s5(e.type,!1),e;case 11:return e=s5(e.type.render,!1),e;case 1:return e=s5(e.type,!0),e;default:return""}}function gj(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Lp:return"Fragment";case Op:return"Portal";case hj:return"Profiler";case s3:return"StrictMode";case pj:return"Suspense";case mj:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case nB:return(e.displayName||"Context")+".Consumer";case rB:return(e._context.displayName||"Context")+".Provider";case o3:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case l3:return t=e.displayName||null,t!==null?t:gj(e.type)||"Memo";case Sf:t=e._payload,e=e._init;try{return gj(e(t))}catch{}}return null}function jX(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gj(t);case 8:return t===s3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Yf(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function iB(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function AX(e){var t=iB(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Yy(e){e._valueTracker||(e._valueTracker=AX(e))}function sB(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=iB(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Vv(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function xj(e,t){var r=t.checked;return wi({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function eT(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Yf(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function oB(e,t){t=t.checked,t!=null&&i3(e,"checked",t,!1)}function yj(e,t){oB(e,t);var r=Yf(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?bj(e,t.type,r):t.hasOwnProperty("defaultValue")&&bj(e,t.type,Yf(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function tT(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function bj(e,t,r){(t!=="number"||Vv(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Jg=Array.isArray;function Jp(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Yf(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function vj(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Wr(91));return wi({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function rT(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Wr(92));if(Jg(r)){if(1<r.length)throw Error(Wr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Yf(r)}}function lB(e,t){var r=Yf(t.value),n=Yf(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function nT(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function cB(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wj(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?cB(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Qy,uB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Qy=Qy||document.createElement("div"),Qy.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Qy.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Px(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var lx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},NX=["Webkit","ms","Moz","O"];Object.keys(lx).forEach(function(e){NX.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),lx[t]=lx[e]})});function dB(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||lx.hasOwnProperty(e)&&lx[e]?(""+t).trim():t+"px"}function fB(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=dB(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var CX=wi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Sj(e,t){if(t){if(CX[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Wr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Wr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Wr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Wr(62))}}function _j(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kj=null;function c3(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var jj=null,Zp=null,em=null;function aT(e){if(e=B1(e)){if(typeof jj!="function")throw Error(Wr(280));var t=e.stateNode;t&&(t=Ww(t),jj(e.stateNode,e.type,t))}}function hB(e){Zp?em?em.push(e):em=[e]:Zp=e}function pB(){if(Zp){var e=Zp,t=em;if(em=Zp=null,aT(e),t)for(e=0;e<t.length;e++)aT(t[e])}}function mB(e,t){return e(t)}function gB(){}var o5=!1;function xB(e,t,r){if(o5)return e(t,r);o5=!0;try{return mB(e,t,r)}finally{o5=!1,(Zp!==null||em!==null)&&(gB(),pB())}}function Ox(e,t){var r=e.stateNode;if(r===null)return null;var n=Ww(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Wr(231,t,typeof r));return r}var Aj=!1;if(Cd)try{var Sg={};Object.defineProperty(Sg,"passive",{get:function(){Aj=!0}}),window.addEventListener("test",Sg,Sg),window.removeEventListener("test",Sg,Sg)}catch{Aj=!1}function EX(e,t,r,n,a,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var cx=!1,Gv=null,Kv=!1,Nj=null,TX={onError:function(e){cx=!0,Gv=e}};function PX(e,t,r,n,a,s,o,l,c){cx=!1,Gv=null,EX.apply(TX,arguments)}function OX(e,t,r,n,a,s,o,l,c){if(PX.apply(this,arguments),cx){if(cx){var u=Gv;cx=!1,Gv=null}else throw Error(Wr(198));Kv||(Kv=!0,Nj=u)}}function L0(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function yB(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function iT(e){if(L0(e)!==e)throw Error(Wr(188))}function LX(e){var t=e.alternate;if(!t){if(t=L0(e),t===null)throw Error(Wr(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return iT(a),e;if(s===n)return iT(a),t;s=s.sibling}throw Error(Wr(188))}if(r.return!==n.return)r=a,n=s;else{for(var o=!1,l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o)throw Error(Wr(189))}}if(r.alternate!==n)throw Error(Wr(190))}if(r.tag!==3)throw Error(Wr(188));return r.stateNode.current===r?e:t}function bB(e){return e=LX(e),e!==null?vB(e):null}function vB(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=vB(e);if(t!==null)return t;e=e.sibling}return null}var wB=$l.unstable_scheduleCallback,sT=$l.unstable_cancelCallback,MX=$l.unstable_shouldYield,FX=$l.unstable_requestPaint,Gi=$l.unstable_now,RX=$l.unstable_getCurrentPriorityLevel,u3=$l.unstable_ImmediatePriority,SB=$l.unstable_UserBlockingPriority,Xv=$l.unstable_NormalPriority,BX=$l.unstable_LowPriority,_B=$l.unstable_IdlePriority,Dw=null,Iu=null;function IX(e){if(Iu&&typeof Iu.onCommitFiberRoot=="function")try{Iu.onCommitFiberRoot(Dw,e,void 0,(e.current.flags&128)===128)}catch{}}var Kc=Math.clz32?Math.clz32:UX,DX=Math.log,$X=Math.LN2;function UX(e){return e>>>=0,e===0?32:31-(DX(e)/$X|0)|0}var Jy=64,Zy=4194304;function Zg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Yv(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~a;l!==0?n=Zg(l):(s&=o,s!==0&&(n=Zg(s)))}else o=r&~a,o!==0?n=Zg(o):s!==0&&(n=Zg(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Kc(t),a=1<<r,n|=e[r],t&=~a;return n}function zX(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function WX(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-Kc(s),l=1<<o,c=a[o];c===-1?(!(l&r)||l&n)&&(a[o]=zX(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function Cj(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function kB(){var e=Jy;return Jy<<=1,!(Jy&4194240)&&(Jy=64),e}function l5(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function F1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Kc(t),e[t]=r}function qX(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Kc(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function d3(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Kc(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Ma=0;function jB(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var AB,f3,NB,CB,EB,Ej=!1,eb=[],If=null,Df=null,$f=null,Lx=new Map,Mx=new Map,Af=[],HX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function oT(e,t){switch(e){case"focusin":case"focusout":If=null;break;case"dragenter":case"dragleave":Df=null;break;case"mouseover":case"mouseout":$f=null;break;case"pointerover":case"pointerout":Lx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mx.delete(t.pointerId)}}function _g(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=B1(t),t!==null&&f3(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function VX(e,t,r,n,a){switch(t){case"focusin":return If=_g(If,e,t,r,n,a),!0;case"dragenter":return Df=_g(Df,e,t,r,n,a),!0;case"mouseover":return $f=_g($f,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Lx.set(s,_g(Lx.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Mx.set(s,_g(Mx.get(s)||null,e,t,r,n,a)),!0}return!1}function TB(e){var t=Ih(e.target);if(t!==null){var r=L0(t);if(r!==null){if(t=r.tag,t===13){if(t=yB(r),t!==null){e.blockedOn=t,EB(e.priority,function(){NB(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gv(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=Tj(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);kj=n,r.target.dispatchEvent(n),kj=null}else return t=B1(r),t!==null&&f3(t),e.blockedOn=r,!1;t.shift()}return!0}function lT(e,t,r){gv(e)&&r.delete(t)}function GX(){Ej=!1,If!==null&&gv(If)&&(If=null),Df!==null&&gv(Df)&&(Df=null),$f!==null&&gv($f)&&($f=null),Lx.forEach(lT),Mx.forEach(lT)}function kg(e,t){e.blockedOn===t&&(e.blockedOn=null,Ej||(Ej=!0,$l.unstable_scheduleCallback($l.unstable_NormalPriority,GX)))}function Fx(e){function t(a){return kg(a,e)}if(0<eb.length){kg(eb[0],e);for(var r=1;r<eb.length;r++){var n=eb[r];n.blockedOn===e&&(n.blockedOn=null)}}for(If!==null&&kg(If,e),Df!==null&&kg(Df,e),$f!==null&&kg($f,e),Lx.forEach(t),Mx.forEach(t),r=0;r<Af.length;r++)n=Af[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Af.length&&(r=Af[0],r.blockedOn===null);)TB(r),r.blockedOn===null&&Af.shift()}var tm=qd.ReactCurrentBatchConfig,Qv=!0;function KX(e,t,r,n){var a=Ma,s=tm.transition;tm.transition=null;try{Ma=1,h3(e,t,r,n)}finally{Ma=a,tm.transition=s}}function XX(e,t,r,n){var a=Ma,s=tm.transition;tm.transition=null;try{Ma=4,h3(e,t,r,n)}finally{Ma=a,tm.transition=s}}function h3(e,t,r,n){if(Qv){var a=Tj(e,t,r,n);if(a===null)y5(e,t,n,Jv,r),oT(e,n);else if(VX(a,e,t,r,n))n.stopPropagation();else if(oT(e,n),t&4&&-1<HX.indexOf(e)){for(;a!==null;){var s=B1(a);if(s!==null&&AB(s),s=Tj(e,t,r,n),s===null&&y5(e,t,n,Jv,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else y5(e,t,n,null,r)}}var Jv=null;function Tj(e,t,r,n){if(Jv=null,e=c3(n),e=Ih(e),e!==null)if(t=L0(e),t===null)e=null;else if(r=t.tag,r===13){if(e=yB(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Jv=e,null}function PB(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RX()){case u3:return 1;case SB:return 4;case Xv:case BX:return 16;case _B:return 536870912;default:return 16}default:return 16}}var Pf=null,p3=null,xv=null;function OB(){if(xv)return xv;var e,t=p3,r=t.length,n,a="value"in Pf?Pf.value:Pf.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===a[s-n];n++);return xv=a.slice(e,1<n?1-n:void 0)}function yv(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function tb(){return!0}function cT(){return!1}function Hl(e){function t(r,n,a,s,o){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?tb:cT,this.isPropagationStopped=cT,this}return wi(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=tb)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=tb)},persist:function(){},isPersistent:tb}),t}var $m={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},m3=Hl($m),R1=wi({},$m,{view:0,detail:0}),YX=Hl(R1),c5,u5,jg,$w=wi({},R1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:g3,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==jg&&(jg&&e.type==="mousemove"?(c5=e.screenX-jg.screenX,u5=e.screenY-jg.screenY):u5=c5=0,jg=e),c5)},movementY:function(e){return"movementY"in e?e.movementY:u5}}),uT=Hl($w),QX=wi({},$w,{dataTransfer:0}),JX=Hl(QX),ZX=wi({},R1,{relatedTarget:0}),d5=Hl(ZX),eY=wi({},$m,{animationName:0,elapsedTime:0,pseudoElement:0}),tY=Hl(eY),rY=wi({},$m,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),nY=Hl(rY),aY=wi({},$m,{data:0}),dT=Hl(aY),iY={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sY={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oY={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lY(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=oY[e])?!!t[e]:!1}function g3(){return lY}var cY=wi({},R1,{key:function(e){if(e.key){var t=iY[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=yv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?sY[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:g3,charCode:function(e){return e.type==="keypress"?yv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?yv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),uY=Hl(cY),dY=wi({},$w,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),fT=Hl(dY),fY=wi({},R1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:g3}),hY=Hl(fY),pY=wi({},$m,{propertyName:0,elapsedTime:0,pseudoElement:0}),mY=Hl(pY),gY=wi({},$w,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xY=Hl(gY),yY=[9,13,27,32],x3=Cd&&"CompositionEvent"in window,ux=null;Cd&&"documentMode"in document&&(ux=document.documentMode);var bY=Cd&&"TextEvent"in window&&!ux,LB=Cd&&(!x3||ux&&8<ux&&11>=ux),hT=" ",pT=!1;function MB(e,t){switch(e){case"keyup":return yY.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FB(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mp=!1;function vY(e,t){switch(e){case"compositionend":return FB(t);case"keypress":return t.which!==32?null:(pT=!0,hT);case"textInput":return e=t.data,e===hT&&pT?null:e;default:return null}}function wY(e,t){if(Mp)return e==="compositionend"||!x3&&MB(e,t)?(e=OB(),xv=p3=Pf=null,Mp=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return LB&&t.locale!=="ko"?null:t.data;default:return null}}var SY={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mT(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!SY[e.type]:t==="textarea"}function RB(e,t,r,n){hB(n),t=Zv(t,"onChange"),0<t.length&&(r=new m3("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var dx=null,Rx=null;function _Y(e){GB(e,0)}function Uw(e){var t=Bp(e);if(sB(t))return e}function kY(e,t){if(e==="change")return t}var BB=!1;if(Cd){var f5;if(Cd){var h5="oninput"in document;if(!h5){var gT=document.createElement("div");gT.setAttribute("oninput","return;"),h5=typeof gT.oninput=="function"}f5=h5}else f5=!1;BB=f5&&(!document.documentMode||9<document.documentMode)}function xT(){dx&&(dx.detachEvent("onpropertychange",IB),Rx=dx=null)}function IB(e){if(e.propertyName==="value"&&Uw(Rx)){var t=[];RB(t,Rx,e,c3(e)),xB(_Y,t)}}function jY(e,t,r){e==="focusin"?(xT(),dx=t,Rx=r,dx.attachEvent("onpropertychange",IB)):e==="focusout"&&xT()}function AY(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Uw(Rx)}function NY(e,t){if(e==="click")return Uw(t)}function CY(e,t){if(e==="input"||e==="change")return Uw(t)}function EY(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var eu=typeof Object.is=="function"?Object.is:EY;function Bx(e,t){if(eu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!fj.call(t,a)||!eu(e[a],t[a]))return!1}return!0}function yT(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function bT(e,t){var r=yT(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=yT(r)}}function DB(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?DB(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function $B(){for(var e=window,t=Vv();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Vv(e.document)}return t}function y3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function TY(e){var t=$B(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&DB(r.ownerDocument.documentElement,r)){if(n!==null&&y3(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=bT(r,s);var o=bT(r,n);a&&o&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var PY=Cd&&"documentMode"in document&&11>=document.documentMode,Fp=null,Pj=null,fx=null,Oj=!1;function vT(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Oj||Fp==null||Fp!==Vv(n)||(n=Fp,"selectionStart"in n&&y3(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),fx&&Bx(fx,n)||(fx=n,n=Zv(Pj,"onSelect"),0<n.length&&(t=new m3("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Fp)))}function rb(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Rp={animationend:rb("Animation","AnimationEnd"),animationiteration:rb("Animation","AnimationIteration"),animationstart:rb("Animation","AnimationStart"),transitionend:rb("Transition","TransitionEnd")},p5={},UB={};Cd&&(UB=document.createElement("div").style,"AnimationEvent"in window||(delete Rp.animationend.animation,delete Rp.animationiteration.animation,delete Rp.animationstart.animation),"TransitionEvent"in window||delete Rp.transitionend.transition);function zw(e){if(p5[e])return p5[e];if(!Rp[e])return e;var t=Rp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in UB)return p5[e]=t[r];return e}var zB=zw("animationend"),WB=zw("animationiteration"),qB=zw("animationstart"),HB=zw("transitionend"),VB=new Map,wT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oh(e,t){VB.set(e,t),O0(t,[e])}for(var m5=0;m5<wT.length;m5++){var g5=wT[m5],OY=g5.toLowerCase(),LY=g5[0].toUpperCase()+g5.slice(1);oh(OY,"on"+LY)}oh(zB,"onAnimationEnd");oh(WB,"onAnimationIteration");oh(qB,"onAnimationStart");oh("dblclick","onDoubleClick");oh("focusin","onFocus");oh("focusout","onBlur");oh(HB,"onTransitionEnd");ym("onMouseEnter",["mouseout","mouseover"]);ym("onMouseLeave",["mouseout","mouseover"]);ym("onPointerEnter",["pointerout","pointerover"]);ym("onPointerLeave",["pointerout","pointerover"]);O0("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));O0("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));O0("onBeforeInput",["compositionend","keypress","textInput","paste"]);O0("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));O0("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));O0("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ex="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MY=new Set("cancel close invalid load scroll toggle".split(" ").concat(ex));function ST(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,OX(n,t,void 0,e),e.currentTarget=null}function GB(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&a.isPropagationStopped())break e;ST(a,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&a.isPropagationStopped())break e;ST(a,l,u),s=c}}}if(Kv)throw e=Nj,Kv=!1,Nj=null,e}function Ja(e,t){var r=t[Bj];r===void 0&&(r=t[Bj]=new Set);var n=e+"__bubble";r.has(n)||(KB(t,e,2,!1),r.add(n))}function x5(e,t,r){var n=0;t&&(n|=4),KB(r,e,n,t)}var nb="_reactListening"+Math.random().toString(36).slice(2);function Ix(e){if(!e[nb]){e[nb]=!0,tB.forEach(function(r){r!=="selectionchange"&&(MY.has(r)||x5(r,!1,e),x5(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[nb]||(t[nb]=!0,x5("selectionchange",!1,t))}}function KB(e,t,r,n){switch(PB(t)){case 1:var a=KX;break;case 4:a=XX;break;default:a=h3}r=a.bind(null,t,r,e),a=void 0,!Aj||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function y5(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===a||l.nodeType===8&&l.parentNode===a)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===a||c.nodeType===8&&c.parentNode===a))return;o=o.return}for(;l!==null;){if(o=Ih(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}xB(function(){var u=s,d=c3(r),f=[];e:{var p=VB.get(e);if(p!==void 0){var h=m3,m=e;switch(e){case"keypress":if(yv(r)===0)break e;case"keydown":case"keyup":h=uY;break;case"focusin":m="focus",h=d5;break;case"focusout":m="blur",h=d5;break;case"beforeblur":case"afterblur":h=d5;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=uT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=JX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=hY;break;case zB:case WB:case qB:h=tY;break;case HB:h=mY;break;case"scroll":h=YX;break;case"wheel":h=xY;break;case"copy":case"cut":case"paste":h=nY;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=fT}var g=(t&4)!==0,b=!g&&e==="scroll",y=g?p!==null?p+"Capture":null:p;g=[];for(var v=u,w;v!==null;){w=v;var _=w.stateNode;if(w.tag===5&&_!==null&&(w=_,y!==null&&(_=Ox(v,y),_!=null&&g.push(Dx(v,_,w)))),b)break;v=v.return}0<g.length&&(p=new h(p,m,null,r,d),f.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==kj&&(m=r.relatedTarget||r.fromElement)&&(Ih(m)||m[Ed]))break e;if((h||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=u,m=m?Ih(m):null,m!==null&&(b=L0(m),m!==b||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(g=uT,_="onMouseLeave",y="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=fT,_="onPointerLeave",y="onPointerEnter",v="pointer"),b=h==null?p:Bp(h),w=m==null?p:Bp(m),p=new g(_,v+"leave",h,r,d),p.target=b,p.relatedTarget=w,_=null,Ih(d)===u&&(g=new g(y,v+"enter",m,r,d),g.target=w,g.relatedTarget=b,_=g),b=_,h&&m)t:{for(g=h,y=m,v=0,w=g;w;w=ap(w))v++;for(w=0,_=y;_;_=ap(_))w++;for(;0<v-w;)g=ap(g),v--;for(;0<w-v;)y=ap(y),w--;for(;v--;){if(g===y||y!==null&&g===y.alternate)break t;g=ap(g),y=ap(y)}g=null}else g=null;h!==null&&_T(f,p,h,g,!1),m!==null&&b!==null&&_T(f,b,m,g,!0)}}e:{if(p=u?Bp(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var C=kY;else if(mT(p))if(BB)C=CY;else{C=AY;var j=jY}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(C=NY);if(C&&(C=C(e,u))){RB(f,C,r,d);break e}j&&j(e,p,u),e==="focusout"&&(j=p._wrapperState)&&j.controlled&&p.type==="number"&&bj(p,"number",p.value)}switch(j=u?Bp(u):window,e){case"focusin":(mT(j)||j.contentEditable==="true")&&(Fp=j,Pj=u,fx=null);break;case"focusout":fx=Pj=Fp=null;break;case"mousedown":Oj=!0;break;case"contextmenu":case"mouseup":case"dragend":Oj=!1,vT(f,r,d);break;case"selectionchange":if(PY)break;case"keydown":case"keyup":vT(f,r,d)}var A;if(x3)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Mp?MB(e,r)&&(M="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(M="onCompositionStart");M&&(LB&&r.locale!=="ko"&&(Mp||M!=="onCompositionStart"?M==="onCompositionEnd"&&Mp&&(A=OB()):(Pf=d,p3="value"in Pf?Pf.value:Pf.textContent,Mp=!0)),j=Zv(u,M),0<j.length&&(M=new dT(M,e,null,r,d),f.push({event:M,listeners:j}),A?M.data=A:(A=FB(r),A!==null&&(M.data=A)))),(A=bY?vY(e,r):wY(e,r))&&(u=Zv(u,"onBeforeInput"),0<u.length&&(d=new dT("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=A))}GB(f,t)})}function Dx(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Zv(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=Ox(e,r),s!=null&&n.unshift(Dx(e,s,a)),s=Ox(e,t),s!=null&&n.push(Dx(e,s,a))),e=e.return}return n}function ap(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function _T(e,t,r,n,a){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,a?(c=Ox(r,s),c!=null&&o.unshift(Dx(r,c,l))):a||(c=Ox(r,s),c!=null&&o.push(Dx(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var FY=/\r\n?/g,RY=/\u0000|\uFFFD/g;function kT(e){return(typeof e=="string"?e:""+e).replace(FY,`
`).replace(RY,"")}function ab(e,t,r){if(t=kT(t),kT(e)!==t&&r)throw Error(Wr(425))}function e2(){}var Lj=null,Mj=null;function Fj(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Rj=typeof setTimeout=="function"?setTimeout:void 0,BY=typeof clearTimeout=="function"?clearTimeout:void 0,jT=typeof Promise=="function"?Promise:void 0,IY=typeof queueMicrotask=="function"?queueMicrotask:typeof jT<"u"?function(e){return jT.resolve(null).then(e).catch(DY)}:Rj;function DY(e){setTimeout(function(){throw e})}function b5(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),Fx(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Fx(t)}function Uf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function AT(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Um=Math.random().toString(36).slice(2),Ou="__reactFiber$"+Um,$x="__reactProps$"+Um,Ed="__reactContainer$"+Um,Bj="__reactEvents$"+Um,$Y="__reactListeners$"+Um,UY="__reactHandles$"+Um;function Ih(e){var t=e[Ou];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ed]||r[Ou]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=AT(e);e!==null;){if(r=e[Ou])return r;e=AT(e)}return t}e=r,r=e.parentNode}return null}function B1(e){return e=e[Ou]||e[Ed],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Bp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Wr(33))}function Ww(e){return e[$x]||null}var Ij=[],Ip=-1;function lh(e){return{current:e}}function ri(e){0>Ip||(e.current=Ij[Ip],Ij[Ip]=null,Ip--)}function Xa(e,t){Ip++,Ij[Ip]=e.current,e.current=t}var Qf={},Co=lh(Qf),ul=lh(!1),s0=Qf;function bm(e,t){var r=e.type.contextTypes;if(!r)return Qf;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function dl(e){return e=e.childContextTypes,e!=null}function t2(){ri(ul),ri(Co)}function NT(e,t,r){if(Co.current!==Qf)throw Error(Wr(168));Xa(Co,t),Xa(ul,r)}function XB(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(Wr(108,jX(e)||"Unknown",a));return wi({},r,n)}function r2(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Qf,s0=Co.current,Xa(Co,e),Xa(ul,ul.current),!0}function CT(e,t,r){var n=e.stateNode;if(!n)throw Error(Wr(169));r?(e=XB(e,t,s0),n.__reactInternalMemoizedMergedChildContext=e,ri(ul),ri(Co),Xa(Co,e)):ri(ul),Xa(ul,r)}var fd=null,qw=!1,v5=!1;function YB(e){fd===null?fd=[e]:fd.push(e)}function zY(e){qw=!0,YB(e)}function ch(){if(!v5&&fd!==null){v5=!0;var e=0,t=Ma;try{var r=fd;for(Ma=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}fd=null,qw=!1}catch(a){throw fd!==null&&(fd=fd.slice(e+1)),wB(u3,ch),a}finally{Ma=t,v5=!1}}return null}var Dp=[],$p=0,n2=null,a2=0,fc=[],hc=0,o0=null,gd=1,xd="";function Th(e,t){Dp[$p++]=a2,Dp[$p++]=n2,n2=e,a2=t}function QB(e,t,r){fc[hc++]=gd,fc[hc++]=xd,fc[hc++]=o0,o0=e;var n=gd;e=xd;var a=32-Kc(n)-1;n&=~(1<<a),r+=1;var s=32-Kc(t)+a;if(30<s){var o=a-a%5;s=(n&(1<<o)-1).toString(32),n>>=o,a-=o,gd=1<<32-Kc(t)+a|r<<a|n,xd=s+e}else gd=1<<s|r<<a|n,xd=e}function b3(e){e.return!==null&&(Th(e,1),QB(e,1,0))}function v3(e){for(;e===n2;)n2=Dp[--$p],Dp[$p]=null,a2=Dp[--$p],Dp[$p]=null;for(;e===o0;)o0=fc[--hc],fc[hc]=null,xd=fc[--hc],fc[hc]=null,gd=fc[--hc],fc[hc]=null}var Il=null,Fl=null,oi=!1,zc=null;function JB(e,t){var r=pc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function ET(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Il=e,Fl=Uf(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Il=e,Fl=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=o0!==null?{id:gd,overflow:xd}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=pc(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Il=e,Fl=null,!0):!1;default:return!1}}function Dj(e){return(e.mode&1)!==0&&(e.flags&128)===0}function $j(e){if(oi){var t=Fl;if(t){var r=t;if(!ET(e,t)){if(Dj(e))throw Error(Wr(418));t=Uf(r.nextSibling);var n=Il;t&&ET(e,t)?JB(n,r):(e.flags=e.flags&-4097|2,oi=!1,Il=e)}}else{if(Dj(e))throw Error(Wr(418));e.flags=e.flags&-4097|2,oi=!1,Il=e}}}function TT(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Il=e}function ib(e){if(e!==Il)return!1;if(!oi)return TT(e),oi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Fj(e.type,e.memoizedProps)),t&&(t=Fl)){if(Dj(e))throw ZB(),Error(Wr(418));for(;t;)JB(e,t),t=Uf(t.nextSibling)}if(TT(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Wr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Fl=Uf(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Fl=null}}else Fl=Il?Uf(e.stateNode.nextSibling):null;return!0}function ZB(){for(var e=Fl;e;)e=Uf(e.nextSibling)}function vm(){Fl=Il=null,oi=!1}function w3(e){zc===null?zc=[e]:zc.push(e)}var WY=qd.ReactCurrentBatchConfig;function Ag(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Wr(309));var n=r.stateNode}if(!n)throw Error(Wr(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=a.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Wr(284));if(!r._owner)throw Error(Wr(290,e))}return e}function sb(e,t){throw e=Object.prototype.toString.call(t),Error(Wr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function PT(e){var t=e._init;return t(e._payload)}function eI(e){function t(y,v){if(e){var w=y.deletions;w===null?(y.deletions=[v],y.flags|=16):w.push(v)}}function r(y,v){if(!e)return null;for(;v!==null;)t(y,v),v=v.sibling;return null}function n(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function a(y,v){return y=Hf(y,v),y.index=0,y.sibling=null,y}function s(y,v,w){return y.index=w,e?(w=y.alternate,w!==null?(w=w.index,w<v?(y.flags|=2,v):w):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return e&&y.alternate===null&&(y.flags|=2),y}function l(y,v,w,_){return v===null||v.tag!==6?(v=N5(w,y.mode,_),v.return=y,v):(v=a(v,w),v.return=y,v)}function c(y,v,w,_){var C=w.type;return C===Lp?d(y,v,w.props.children,_,w.key):v!==null&&(v.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Sf&&PT(C)===v.type)?(_=a(v,w.props),_.ref=Ag(y,v,w),_.return=y,_):(_=jv(w.type,w.key,w.props,null,y.mode,_),_.ref=Ag(y,v,w),_.return=y,_)}function u(y,v,w,_){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=C5(w,y.mode,_),v.return=y,v):(v=a(v,w.children||[]),v.return=y,v)}function d(y,v,w,_,C){return v===null||v.tag!==7?(v=Xh(w,y.mode,_,C),v.return=y,v):(v=a(v,w),v.return=y,v)}function f(y,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=N5(""+v,y.mode,w),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Xy:return w=jv(v.type,v.key,v.props,null,y.mode,w),w.ref=Ag(y,null,v),w.return=y,w;case Op:return v=C5(v,y.mode,w),v.return=y,v;case Sf:var _=v._init;return f(y,_(v._payload),w)}if(Jg(v)||wg(v))return v=Xh(v,y.mode,w,null),v.return=y,v;sb(y,v)}return null}function p(y,v,w,_){var C=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return C!==null?null:l(y,v,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Xy:return w.key===C?c(y,v,w,_):null;case Op:return w.key===C?u(y,v,w,_):null;case Sf:return C=w._init,p(y,v,C(w._payload),_)}if(Jg(w)||wg(w))return C!==null?null:d(y,v,w,_,null);sb(y,w)}return null}function h(y,v,w,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(w)||null,l(v,y,""+_,C);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Xy:return y=y.get(_.key===null?w:_.key)||null,c(v,y,_,C);case Op:return y=y.get(_.key===null?w:_.key)||null,u(v,y,_,C);case Sf:var j=_._init;return h(y,v,w,j(_._payload),C)}if(Jg(_)||wg(_))return y=y.get(w)||null,d(v,y,_,C,null);sb(v,_)}return null}function m(y,v,w,_){for(var C=null,j=null,A=v,M=v=0,P=null;A!==null&&M<w.length;M++){A.index>M?(P=A,A=null):P=A.sibling;var R=p(y,A,w[M],_);if(R===null){A===null&&(A=P);break}e&&A&&R.alternate===null&&t(y,A),v=s(R,v,M),j===null?C=R:j.sibling=R,j=R,A=P}if(M===w.length)return r(y,A),oi&&Th(y,M),C;if(A===null){for(;M<w.length;M++)A=f(y,w[M],_),A!==null&&(v=s(A,v,M),j===null?C=A:j.sibling=A,j=A);return oi&&Th(y,M),C}for(A=n(y,A);M<w.length;M++)P=h(A,y,M,w[M],_),P!==null&&(e&&P.alternate!==null&&A.delete(P.key===null?M:P.key),v=s(P,v,M),j===null?C=P:j.sibling=P,j=P);return e&&A.forEach(function(N){return t(y,N)}),oi&&Th(y,M),C}function g(y,v,w,_){var C=wg(w);if(typeof C!="function")throw Error(Wr(150));if(w=C.call(w),w==null)throw Error(Wr(151));for(var j=C=null,A=v,M=v=0,P=null,R=w.next();A!==null&&!R.done;M++,R=w.next()){A.index>M?(P=A,A=null):P=A.sibling;var N=p(y,A,R.value,_);if(N===null){A===null&&(A=P);break}e&&A&&N.alternate===null&&t(y,A),v=s(N,v,M),j===null?C=N:j.sibling=N,j=N,A=P}if(R.done)return r(y,A),oi&&Th(y,M),C;if(A===null){for(;!R.done;M++,R=w.next())R=f(y,R.value,_),R!==null&&(v=s(R,v,M),j===null?C=R:j.sibling=R,j=R);return oi&&Th(y,M),C}for(A=n(y,A);!R.done;M++,R=w.next())R=h(A,y,M,R.value,_),R!==null&&(e&&R.alternate!==null&&A.delete(R.key===null?M:R.key),v=s(R,v,M),j===null?C=R:j.sibling=R,j=R);return e&&A.forEach(function(T){return t(y,T)}),oi&&Th(y,M),C}function b(y,v,w,_){if(typeof w=="object"&&w!==null&&w.type===Lp&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Xy:e:{for(var C=w.key,j=v;j!==null;){if(j.key===C){if(C=w.type,C===Lp){if(j.tag===7){r(y,j.sibling),v=a(j,w.props.children),v.return=y,y=v;break e}}else if(j.elementType===C||typeof C=="object"&&C!==null&&C.$$typeof===Sf&&PT(C)===j.type){r(y,j.sibling),v=a(j,w.props),v.ref=Ag(y,j,w),v.return=y,y=v;break e}r(y,j);break}else t(y,j);j=j.sibling}w.type===Lp?(v=Xh(w.props.children,y.mode,_,w.key),v.return=y,y=v):(_=jv(w.type,w.key,w.props,null,y.mode,_),_.ref=Ag(y,v,w),_.return=y,y=_)}return o(y);case Op:e:{for(j=w.key;v!==null;){if(v.key===j)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){r(y,v.sibling),v=a(v,w.children||[]),v.return=y,y=v;break e}else{r(y,v);break}else t(y,v);v=v.sibling}v=C5(w,y.mode,_),v.return=y,y=v}return o(y);case Sf:return j=w._init,b(y,v,j(w._payload),_)}if(Jg(w))return m(y,v,w,_);if(wg(w))return g(y,v,w,_);sb(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(r(y,v.sibling),v=a(v,w),v.return=y,y=v):(r(y,v),v=N5(w,y.mode,_),v.return=y,y=v),o(y)):r(y,v)}return b}var wm=eI(!0),tI=eI(!1),i2=lh(null),s2=null,Up=null,S3=null;function _3(){S3=Up=s2=null}function k3(e){var t=i2.current;ri(i2),e._currentValue=t}function Uj(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function rm(e,t){s2=e,S3=Up=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(il=!0),e.firstContext=null)}function yc(e){var t=e._currentValue;if(S3!==e)if(e={context:e,memoizedValue:t,next:null},Up===null){if(s2===null)throw Error(Wr(308));Up=e,s2.dependencies={lanes:0,firstContext:e}}else Up=Up.next=e;return t}var Dh=null;function j3(e){Dh===null?Dh=[e]:Dh.push(e)}function rI(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,j3(t)):(r.next=a.next,a.next=r),t.interleaved=r,Td(e,n)}function Td(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var _f=!1;function A3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nI(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Sd(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zf(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,la&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Td(e,r)}return a=n.interleaved,a===null?(t.next=t,j3(n)):(t.next=a.next,a.next=t),n.interleaved=t,Td(e,r)}function bv(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,d3(e,r)}}function OT(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function o2(e,t,r,n){var a=e.updateQueue;_f=!1;var s=a.firstBaseUpdate,o=a.lastBaseUpdate,l=a.shared.pending;if(l!==null){a.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=a.baseState;o=0,d=u=c=null,l=s;do{var p=l.lane,h=l.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,g=l;switch(p=t,h=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(h,f,p);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,p=typeof m=="function"?m.call(h,f,p):m,p==null)break e;f=wi({},f,p);break e;case 2:_f=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,o|=p;if(l=l.next,l===null){if(l=a.shared.pending,l===null)break;p=l,l=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(d===null&&(c=f),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=d,t=a.shared.interleaved,t!==null){a=t;do o|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);c0|=o,e.lanes=o,e.memoizedState=f}}function LT(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(Wr(191,a));a.call(n)}}}var I1={},Du=lh(I1),Ux=lh(I1),zx=lh(I1);function $h(e){if(e===I1)throw Error(Wr(174));return e}function N3(e,t){switch(Xa(zx,t),Xa(Ux,e),Xa(Du,I1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:wj(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=wj(t,e)}ri(Du),Xa(Du,t)}function Sm(){ri(Du),ri(Ux),ri(zx)}function aI(e){$h(zx.current);var t=$h(Du.current),r=wj(t,e.type);t!==r&&(Xa(Ux,e),Xa(Du,r))}function C3(e){Ux.current===e&&(ri(Du),ri(Ux))}var gi=lh(0);function l2(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var w5=[];function E3(){for(var e=0;e<w5.length;e++)w5[e]._workInProgressVersionPrimary=null;w5.length=0}var vv=qd.ReactCurrentDispatcher,S5=qd.ReactCurrentBatchConfig,l0=0,vi=null,bs=null,Fs=null,c2=!1,hx=!1,Wx=0,qY=0;function co(){throw Error(Wr(321))}function T3(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!eu(e[r],t[r]))return!1;return!0}function P3(e,t,r,n,a,s){if(l0=s,vi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,vv.current=e===null||e.memoizedState===null?KY:XY,e=r(n,a),hx){s=0;do{if(hx=!1,Wx=0,25<=s)throw Error(Wr(301));s+=1,Fs=bs=null,t.updateQueue=null,vv.current=YY,e=r(n,a)}while(hx)}if(vv.current=u2,t=bs!==null&&bs.next!==null,l0=0,Fs=bs=vi=null,c2=!1,t)throw Error(Wr(300));return e}function O3(){var e=Wx!==0;return Wx=0,e}function Cu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Fs===null?vi.memoizedState=Fs=e:Fs=Fs.next=e,Fs}function bc(){if(bs===null){var e=vi.alternate;e=e!==null?e.memoizedState:null}else e=bs.next;var t=Fs===null?vi.memoizedState:Fs.next;if(t!==null)Fs=t,bs=e;else{if(e===null)throw Error(Wr(310));bs=e,e={memoizedState:bs.memoizedState,baseState:bs.baseState,baseQueue:bs.baseQueue,queue:bs.queue,next:null},Fs===null?vi.memoizedState=Fs=e:Fs=Fs.next=e}return Fs}function qx(e,t){return typeof t=="function"?t(e):t}function _5(e){var t=bc(),r=t.queue;if(r===null)throw Error(Wr(311));r.lastRenderedReducer=e;var n=bs,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var o=a.next;a.next=s.next,s.next=o}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((l0&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,vi.lanes|=d,c0|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,eu(n,t.memoizedState)||(il=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,vi.lanes|=s,c0|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function k5(e){var t=bc(),r=t.queue;if(r===null)throw Error(Wr(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var o=a=a.next;do s=e(s,o.action),o=o.next;while(o!==a);eu(s,t.memoizedState)||(il=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function iI(){}function sI(e,t){var r=vi,n=bc(),a=t(),s=!eu(n.memoizedState,a);if(s&&(n.memoizedState=a,il=!0),n=n.queue,L3(cI.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Fs!==null&&Fs.memoizedState.tag&1){if(r.flags|=2048,Hx(9,lI.bind(null,r,n,a,t),void 0,null),$s===null)throw Error(Wr(349));l0&30||oI(r,t,a)}return a}function oI(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=vi.updateQueue,t===null?(t={lastEffect:null,stores:null},vi.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function lI(e,t,r,n){t.value=r,t.getSnapshot=n,uI(t)&&dI(e)}function cI(e,t,r){return r(function(){uI(t)&&dI(e)})}function uI(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!eu(e,r)}catch{return!0}}function dI(e){var t=Td(e,1);t!==null&&Xc(t,e,1,-1)}function MT(e){var t=Cu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qx,lastRenderedState:e},t.queue=e,e=e.dispatch=GY.bind(null,vi,e),[t.memoizedState,e]}function Hx(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=vi.updateQueue,t===null?(t={lastEffect:null,stores:null},vi.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function fI(){return bc().memoizedState}function wv(e,t,r,n){var a=Cu();vi.flags|=e,a.memoizedState=Hx(1|t,r,void 0,n===void 0?null:n)}function Hw(e,t,r,n){var a=bc();n=n===void 0?null:n;var s=void 0;if(bs!==null){var o=bs.memoizedState;if(s=o.destroy,n!==null&&T3(n,o.deps)){a.memoizedState=Hx(t,r,s,n);return}}vi.flags|=e,a.memoizedState=Hx(1|t,r,s,n)}function FT(e,t){return wv(8390656,8,e,t)}function L3(e,t){return Hw(2048,8,e,t)}function hI(e,t){return Hw(4,2,e,t)}function pI(e,t){return Hw(4,4,e,t)}function mI(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function gI(e,t,r){return r=r!=null?r.concat([e]):null,Hw(4,4,mI.bind(null,t,e),r)}function M3(){}function xI(e,t){var r=bc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T3(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function yI(e,t){var r=bc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&T3(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function bI(e,t,r){return l0&21?(eu(r,t)||(r=kB(),vi.lanes|=r,c0|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,il=!0),e.memoizedState=r)}function HY(e,t){var r=Ma;Ma=r!==0&&4>r?r:4,e(!0);var n=S5.transition;S5.transition={};try{e(!1),t()}finally{Ma=r,S5.transition=n}}function vI(){return bc().memoizedState}function VY(e,t,r){var n=qf(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},wI(e))SI(t,r);else if(r=rI(e,t,r,n),r!==null){var a=zo();Xc(r,e,n,a),_I(r,t,n)}}function GY(e,t,r){var n=qf(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(wI(e))SI(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(a.hasEagerState=!0,a.eagerState=l,eu(l,o)){var c=t.interleaved;c===null?(a.next=a,j3(t)):(a.next=c.next,c.next=a),t.interleaved=a;return}}catch{}finally{}r=rI(e,t,a,n),r!==null&&(a=zo(),Xc(r,e,n,a),_I(r,t,n))}}function wI(e){var t=e.alternate;return e===vi||t!==null&&t===vi}function SI(e,t){hx=c2=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function _I(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,d3(e,r)}}var u2={readContext:yc,useCallback:co,useContext:co,useEffect:co,useImperativeHandle:co,useInsertionEffect:co,useLayoutEffect:co,useMemo:co,useReducer:co,useRef:co,useState:co,useDebugValue:co,useDeferredValue:co,useTransition:co,useMutableSource:co,useSyncExternalStore:co,useId:co,unstable_isNewReconciler:!1},KY={readContext:yc,useCallback:function(e,t){return Cu().memoizedState=[e,t===void 0?null:t],e},useContext:yc,useEffect:FT,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,wv(4194308,4,mI.bind(null,t,e),r)},useLayoutEffect:function(e,t){return wv(4194308,4,e,t)},useInsertionEffect:function(e,t){return wv(4,2,e,t)},useMemo:function(e,t){var r=Cu();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Cu();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=VY.bind(null,vi,e),[n.memoizedState,e]},useRef:function(e){var t=Cu();return e={current:e},t.memoizedState=e},useState:MT,useDebugValue:M3,useDeferredValue:function(e){return Cu().memoizedState=e},useTransition:function(){var e=MT(!1),t=e[0];return e=HY.bind(null,e[1]),Cu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=vi,a=Cu();if(oi){if(r===void 0)throw Error(Wr(407));r=r()}else{if(r=t(),$s===null)throw Error(Wr(349));l0&30||oI(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,FT(cI.bind(null,n,s,e),[e]),n.flags|=2048,Hx(9,lI.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=Cu(),t=$s.identifierPrefix;if(oi){var r=xd,n=gd;r=(n&~(1<<32-Kc(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Wx++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=qY++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},XY={readContext:yc,useCallback:xI,useContext:yc,useEffect:L3,useImperativeHandle:gI,useInsertionEffect:hI,useLayoutEffect:pI,useMemo:yI,useReducer:_5,useRef:fI,useState:function(){return _5(qx)},useDebugValue:M3,useDeferredValue:function(e){var t=bc();return bI(t,bs.memoizedState,e)},useTransition:function(){var e=_5(qx)[0],t=bc().memoizedState;return[e,t]},useMutableSource:iI,useSyncExternalStore:sI,useId:vI,unstable_isNewReconciler:!1},YY={readContext:yc,useCallback:xI,useContext:yc,useEffect:L3,useImperativeHandle:gI,useInsertionEffect:hI,useLayoutEffect:pI,useMemo:yI,useReducer:k5,useRef:fI,useState:function(){return k5(qx)},useDebugValue:M3,useDeferredValue:function(e){var t=bc();return bs===null?t.memoizedState=e:bI(t,bs.memoizedState,e)},useTransition:function(){var e=k5(qx)[0],t=bc().memoizedState;return[e,t]},useMutableSource:iI,useSyncExternalStore:sI,useId:vI,unstable_isNewReconciler:!1};function $c(e,t){if(e&&e.defaultProps){t=wi({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function zj(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:wi({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Vw={isMounted:function(e){return(e=e._reactInternals)?L0(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=zo(),a=qf(e),s=Sd(n,a);s.payload=t,r!=null&&(s.callback=r),t=zf(e,s,a),t!==null&&(Xc(t,e,a,n),bv(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=zo(),a=qf(e),s=Sd(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=zf(e,s,a),t!==null&&(Xc(t,e,a,n),bv(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=zo(),n=qf(e),a=Sd(r,n);a.tag=2,t!=null&&(a.callback=t),t=zf(e,a,n),t!==null&&(Xc(t,e,n,r),bv(t,e,n))}};function RT(e,t,r,n,a,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!Bx(r,n)||!Bx(a,s):!0}function kI(e,t,r){var n=!1,a=Qf,s=t.contextType;return typeof s=="object"&&s!==null?s=yc(s):(a=dl(t)?s0:Co.current,n=t.contextTypes,s=(n=n!=null)?bm(e,a):Qf),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Vw,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function BT(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Vw.enqueueReplaceState(t,t.state,null)}function Wj(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},A3(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=yc(s):(s=dl(t)?s0:Co.current,a.context=bm(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(zj(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&Vw.enqueueReplaceState(a,a.state,null),o2(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function _m(e,t){try{var r="",n=t;do r+=kX(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function j5(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function qj(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var QY=typeof WeakMap=="function"?WeakMap:Map;function jI(e,t,r){r=Sd(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){f2||(f2=!0,eA=n),qj(e,t)},r}function AI(e,t,r){r=Sd(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){qj(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){qj(e,t),typeof n!="function"&&(Wf===null?Wf=new Set([this]):Wf.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function IT(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new QY;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=dQ.bind(null,e,t,r),t.then(e,e))}function DT(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function $T(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Sd(-1,1),t.tag=2,zf(r,t,1))),r.lanes|=1),e)}var JY=qd.ReactCurrentOwner,il=!1;function Bo(e,t,r,n){t.child=e===null?tI(t,null,r,n):wm(t,e.child,r,n)}function UT(e,t,r,n,a){r=r.render;var s=t.ref;return rm(t,a),n=P3(e,t,r,n,s,a),r=O3(),e!==null&&!il?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Pd(e,t,a)):(oi&&r&&b3(t),t.flags|=1,Bo(e,t,n,a),t.child)}function zT(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!z3(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,NI(e,t,s,n,a)):(e=jv(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Bx,r(o,n)&&e.ref===t.ref)return Pd(e,t,a)}return t.flags|=1,e=Hf(s,n),e.ref=t.ref,e.return=t,t.child=e}function NI(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(Bx(s,n)&&e.ref===t.ref)if(il=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(il=!0);else return t.lanes=e.lanes,Pd(e,t,a)}return Hj(e,t,r,n,a)}function CI(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xa(Wp,El),El|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Xa(Wp,El),El|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,Xa(Wp,El),El|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,Xa(Wp,El),El|=n;return Bo(e,t,a,r),t.child}function EI(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Hj(e,t,r,n,a){var s=dl(r)?s0:Co.current;return s=bm(t,s),rm(t,a),r=P3(e,t,r,n,s,a),n=O3(),e!==null&&!il?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Pd(e,t,a)):(oi&&n&&b3(t),t.flags|=1,Bo(e,t,r,a),t.child)}function WT(e,t,r,n,a){if(dl(r)){var s=!0;r2(t)}else s=!1;if(rm(t,a),t.stateNode===null)Sv(e,t),kI(t,r,n),Wj(t,r,n,a),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=yc(u):(u=dl(r)?s0:Co.current,u=bm(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&BT(t,o,n,u),_f=!1;var p=t.memoizedState;o.state=p,o2(t,n,o,a),c=t.memoizedState,l!==n||p!==c||ul.current||_f?(typeof d=="function"&&(zj(t,r,d,n),c=t.memoizedState),(l=_f||RT(t,r,l,n,p,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,nI(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:$c(t.type,l),o.props=u,f=t.pendingProps,p=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=yc(c):(c=dl(r)?s0:Co.current,c=bm(t,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&BT(t,o,n,c),_f=!1,p=t.memoizedState,o.state=p,o2(t,n,o,a);var m=t.memoizedState;l!==f||p!==m||ul.current||_f?(typeof h=="function"&&(zj(t,r,h,n),m=t.memoizedState),(u=_f||RT(t,r,u,n,p,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Vj(e,t,r,n,s,a)}function Vj(e,t,r,n,a,s){EI(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return a&&CT(t,r,!1),Pd(e,t,s);n=t.stateNode,JY.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=wm(t,e.child,null,s),t.child=wm(t,null,l,s)):Bo(e,t,l,s),t.memoizedState=n.state,a&&CT(t,r,!0),t.child}function TI(e){var t=e.stateNode;t.pendingContext?NT(e,t.pendingContext,t.pendingContext!==t.context):t.context&&NT(e,t.context,!1),N3(e,t.containerInfo)}function qT(e,t,r,n,a){return vm(),w3(a),t.flags|=256,Bo(e,t,r,n),t.child}var Gj={dehydrated:null,treeContext:null,retryLane:0};function Kj(e){return{baseLanes:e,cachePool:null,transitions:null}}function PI(e,t,r){var n=t.pendingProps,a=gi.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(a&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Xa(gi,a&1),e===null)return $j(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Xw(o,n,0,null),e=Xh(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Kj(r),t.memoizedState=Gj,e):F3(t,o));if(a=e.memoizedState,a!==null&&(l=a.dehydrated,l!==null))return ZY(e,t,o,n,l,a,r);if(s){s=n.fallback,o=t.mode,a=e.child,l=a.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Hf(a,c),n.subtreeFlags=a.subtreeFlags&14680064),l!==null?s=Hf(l,s):(s=Xh(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?Kj(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=Gj,n}return s=e.child,e=s.sibling,n=Hf(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function F3(e,t){return t=Xw({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ob(e,t,r,n){return n!==null&&w3(n),wm(t,e.child,null,r),e=F3(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ZY(e,t,r,n,a,s,o){if(r)return t.flags&256?(t.flags&=-257,n=j5(Error(Wr(422))),ob(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Xw({mode:"visible",children:n.children},a,0,null),s=Xh(s,a,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&wm(t,e.child,null,o),t.child.memoizedState=Kj(o),t.memoizedState=Gj,s);if(!(t.mode&1))return ob(e,t,o,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Wr(419)),n=j5(s,n,void 0),ob(e,t,o,n)}if(l=(o&e.childLanes)!==0,il||l){if(n=$s,n!==null){switch(o&-o){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|o)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,Td(e,a),Xc(n,e,a,-1))}return U3(),n=j5(Error(Wr(421))),ob(e,t,o,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=fQ.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,Fl=Uf(a.nextSibling),Il=t,oi=!0,zc=null,e!==null&&(fc[hc++]=gd,fc[hc++]=xd,fc[hc++]=o0,gd=e.id,xd=e.overflow,o0=t),t=F3(t,n.children),t.flags|=4096,t)}function HT(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Uj(e.return,t,r)}function A5(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function OI(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Bo(e,t,n.children,r),n=gi.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&HT(e,r,t);else if(e.tag===19)HT(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Xa(gi,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&l2(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),A5(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&l2(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}A5(t,!0,r,null,s);break;case"together":A5(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Sv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Pd(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),c0|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Wr(153));if(t.child!==null){for(e=t.child,r=Hf(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Hf(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function eQ(e,t,r){switch(t.tag){case 3:TI(t),vm();break;case 5:aI(t);break;case 1:dl(t.type)&&r2(t);break;case 4:N3(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Xa(i2,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Xa(gi,gi.current&1),t.flags|=128,null):r&t.child.childLanes?PI(e,t,r):(Xa(gi,gi.current&1),e=Pd(e,t,r),e!==null?e.sibling:null);Xa(gi,gi.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return OI(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Xa(gi,gi.current),n)break;return null;case 22:case 23:return t.lanes=0,CI(e,t,r)}return Pd(e,t,r)}var LI,Xj,MI,FI;LI=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Xj=function(){};MI=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,$h(Du.current);var s=null;switch(r){case"input":a=xj(e,a),n=xj(e,n),s=[];break;case"select":a=wi({},a,{value:void 0}),n=wi({},n,{value:void 0}),s=[];break;case"textarea":a=vj(e,a),n=vj(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=e2)}Sj(r,n);var o;r=null;for(u in a)if(!n.hasOwnProperty(u)&&a.hasOwnProperty(u)&&a[u]!=null)if(u==="style"){var l=a[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Tx.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=a!=null?a[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Tx.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ja("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};FI=function(e,t,r,n){r!==n&&(t.flags|=4)};function Ng(e,t){if(!oi)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function uo(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function tQ(e,t,r){var n=t.pendingProps;switch(v3(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return uo(t),null;case 1:return dl(t.type)&&t2(),uo(t),null;case 3:return n=t.stateNode,Sm(),ri(ul),ri(Co),E3(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ib(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,zc!==null&&(nA(zc),zc=null))),Xj(e,t),uo(t),null;case 5:C3(t);var a=$h(zx.current);if(r=t.type,e!==null&&t.stateNode!=null)MI(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Wr(166));return uo(t),null}if(e=$h(Du.current),ib(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Ou]=t,n[$x]=s,e=(t.mode&1)!==0,r){case"dialog":Ja("cancel",n),Ja("close",n);break;case"iframe":case"object":case"embed":Ja("load",n);break;case"video":case"audio":for(a=0;a<ex.length;a++)Ja(ex[a],n);break;case"source":Ja("error",n);break;case"img":case"image":case"link":Ja("error",n),Ja("load",n);break;case"details":Ja("toggle",n);break;case"input":eT(n,s),Ja("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},Ja("invalid",n);break;case"textarea":rT(n,s),Ja("invalid",n)}Sj(r,s),a=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&ab(n.textContent,l,e),a=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&ab(n.textContent,l,e),a=["children",""+l]):Tx.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ja("scroll",n)}switch(r){case"input":Yy(n),tT(n,s,!0);break;case"textarea":Yy(n),nT(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=e2)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=cB(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Ou]=t,e[$x]=n,LI(e,t,!1,!1),t.stateNode=e;e:{switch(o=_j(r,n),r){case"dialog":Ja("cancel",e),Ja("close",e),a=n;break;case"iframe":case"object":case"embed":Ja("load",e),a=n;break;case"video":case"audio":for(a=0;a<ex.length;a++)Ja(ex[a],e);a=n;break;case"source":Ja("error",e),a=n;break;case"img":case"image":case"link":Ja("error",e),Ja("load",e),a=n;break;case"details":Ja("toggle",e),a=n;break;case"input":eT(e,n),a=xj(e,n),Ja("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=wi({},n,{value:void 0}),Ja("invalid",e);break;case"textarea":rT(e,n),a=vj(e,n),Ja("invalid",e);break;default:a=n}Sj(r,a),l=a;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?fB(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&uB(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Px(e,c):typeof c=="number"&&Px(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Tx.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Ja("scroll",e):c!=null&&i3(e,s,c,o))}switch(r){case"input":Yy(e),tT(e,n,!1);break;case"textarea":Yy(e),nT(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Yf(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Jp(e,!!n.multiple,s,!1):n.defaultValue!=null&&Jp(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=e2)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return uo(t),null;case 6:if(e&&t.stateNode!=null)FI(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Wr(166));if(r=$h(zx.current),$h(Du.current),ib(t)){if(n=t.stateNode,r=t.memoizedProps,n[Ou]=t,(s=n.nodeValue!==r)&&(e=Il,e!==null))switch(e.tag){case 3:ab(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ab(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Ou]=t,t.stateNode=n}return uo(t),null;case 13:if(ri(gi),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(oi&&Fl!==null&&t.mode&1&&!(t.flags&128))ZB(),vm(),t.flags|=98560,s=!1;else if(s=ib(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Wr(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Wr(317));s[Ou]=t}else vm(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;uo(t),s=!1}else zc!==null&&(nA(zc),zc=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||gi.current&1?Ss===0&&(Ss=3):U3())),t.updateQueue!==null&&(t.flags|=4),uo(t),null);case 4:return Sm(),Xj(e,t),e===null&&Ix(t.stateNode.containerInfo),uo(t),null;case 10:return k3(t.type._context),uo(t),null;case 17:return dl(t.type)&&t2(),uo(t),null;case 19:if(ri(gi),s=t.memoizedState,s===null)return uo(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)Ng(s,!1);else{if(Ss!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=l2(e),o!==null){for(t.flags|=128,Ng(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Xa(gi,gi.current&1|2),t.child}e=e.sibling}s.tail!==null&&Gi()>km&&(t.flags|=128,n=!0,Ng(s,!1),t.lanes=4194304)}else{if(!n)if(e=l2(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Ng(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!oi)return uo(t),null}else 2*Gi()-s.renderingStartTime>km&&r!==1073741824&&(t.flags|=128,n=!0,Ng(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Gi(),t.sibling=null,r=gi.current,Xa(gi,n?r&1|2:r&1),t):(uo(t),null);case 22:case 23:return $3(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?El&1073741824&&(uo(t),t.subtreeFlags&6&&(t.flags|=8192)):uo(t),null;case 24:return null;case 25:return null}throw Error(Wr(156,t.tag))}function rQ(e,t){switch(v3(t),t.tag){case 1:return dl(t.type)&&t2(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Sm(),ri(ul),ri(Co),E3(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return C3(t),null;case 13:if(ri(gi),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Wr(340));vm()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ri(gi),null;case 4:return Sm(),null;case 10:return k3(t.type._context),null;case 22:case 23:return $3(),null;case 24:return null;default:return null}}var lb=!1,wo=!1,nQ=typeof WeakSet=="function"?WeakSet:Set,nn=null;function zp(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Li(e,t,n)}else r.current=null}function Yj(e,t,r){try{r()}catch(n){Li(e,t,n)}}var VT=!1;function aQ(e,t){if(Lj=Qv,e=$B(),y3(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,p=null;t:for(;;){for(var h;f!==r||a!==0&&f.nodeType!==3||(l=o+a),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++u===a&&(l=o),p===s&&++d===n&&(c=o),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Mj={focusedElem:e,selectionRange:r},Qv=!1,nn=t;nn!==null;)if(t=nn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,nn=e;else for(;nn!==null;){t=nn;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,b=m.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:$c(t.type,g),b);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Wr(163))}}catch(_){Li(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,nn=e;break}nn=t.return}return m=VT,VT=!1,m}function px(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Yj(t,r,s)}a=a.next}while(a!==n)}}function Gw(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Qj(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function RI(e){var t=e.alternate;t!==null&&(e.alternate=null,RI(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ou],delete t[$x],delete t[Bj],delete t[$Y],delete t[UY])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function BI(e){return e.tag===5||e.tag===3||e.tag===4}function GT(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||BI(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Jj(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=e2));else if(n!==4&&(e=e.child,e!==null))for(Jj(e,t,r),e=e.sibling;e!==null;)Jj(e,t,r),e=e.sibling}function Zj(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Zj(e,t,r),e=e.sibling;e!==null;)Zj(e,t,r),e=e.sibling}var Zs=null,Uc=!1;function ff(e,t,r){for(r=r.child;r!==null;)II(e,t,r),r=r.sibling}function II(e,t,r){if(Iu&&typeof Iu.onCommitFiberUnmount=="function")try{Iu.onCommitFiberUnmount(Dw,r)}catch{}switch(r.tag){case 5:wo||zp(r,t);case 6:var n=Zs,a=Uc;Zs=null,ff(e,t,r),Zs=n,Uc=a,Zs!==null&&(Uc?(e=Zs,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):Zs.removeChild(r.stateNode));break;case 18:Zs!==null&&(Uc?(e=Zs,r=r.stateNode,e.nodeType===8?b5(e.parentNode,r):e.nodeType===1&&b5(e,r),Fx(e)):b5(Zs,r.stateNode));break;case 4:n=Zs,a=Uc,Zs=r.stateNode.containerInfo,Uc=!0,ff(e,t,r),Zs=n,Uc=a;break;case 0:case 11:case 14:case 15:if(!wo&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Yj(r,t,o),a=a.next}while(a!==n)}ff(e,t,r);break;case 1:if(!wo&&(zp(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Li(r,t,l)}ff(e,t,r);break;case 21:ff(e,t,r);break;case 22:r.mode&1?(wo=(n=wo)||r.memoizedState!==null,ff(e,t,r),wo=n):ff(e,t,r);break;default:ff(e,t,r)}}function KT(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new nQ),t.forEach(function(n){var a=hQ.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Rc(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:Zs=l.stateNode,Uc=!1;break e;case 3:Zs=l.stateNode.containerInfo,Uc=!0;break e;case 4:Zs=l.stateNode.containerInfo,Uc=!0;break e}l=l.return}if(Zs===null)throw Error(Wr(160));II(s,o,a),Zs=null,Uc=!1;var c=a.alternate;c!==null&&(c.return=null),a.return=null}catch(u){Li(a,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)DI(t,e),t=t.sibling}function DI(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Rc(t,e),hu(e),n&4){try{px(3,e,e.return),Gw(3,e)}catch(g){Li(e,e.return,g)}try{px(5,e,e.return)}catch(g){Li(e,e.return,g)}}break;case 1:Rc(t,e),hu(e),n&512&&r!==null&&zp(r,r.return);break;case 5:if(Rc(t,e),hu(e),n&512&&r!==null&&zp(r,r.return),e.flags&32){var a=e.stateNode;try{Px(a,"")}catch(g){Li(e,e.return,g)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&oB(a,s),_j(l,o);var u=_j(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?fB(a,f):d==="dangerouslySetInnerHTML"?uB(a,f):d==="children"?Px(a,f):i3(a,d,f,u)}switch(l){case"input":yj(a,s);break;case"textarea":lB(a,s);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?Jp(a,!!s.multiple,h,!1):p!==!!s.multiple&&(s.defaultValue!=null?Jp(a,!!s.multiple,s.defaultValue,!0):Jp(a,!!s.multiple,s.multiple?[]:"",!1))}a[$x]=s}catch(g){Li(e,e.return,g)}}break;case 6:if(Rc(t,e),hu(e),n&4){if(e.stateNode===null)throw Error(Wr(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(g){Li(e,e.return,g)}}break;case 3:if(Rc(t,e),hu(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Fx(t.containerInfo)}catch(g){Li(e,e.return,g)}break;case 4:Rc(t,e),hu(e);break;case 13:Rc(t,e),hu(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(I3=Gi())),n&4&&KT(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(wo=(u=wo)||d,Rc(t,e),wo=u):Rc(t,e),hu(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(nn=e,d=e.child;d!==null;){for(f=nn=d;nn!==null;){switch(p=nn,h=p.child,p.tag){case 0:case 11:case 14:case 15:px(4,p,p.return);break;case 1:zp(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Li(n,r,g)}}break;case 5:zp(p,p.return);break;case 22:if(p.memoizedState!==null){YT(f);continue}}h!==null?(h.return=p,nn=h):YT(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{a=f.stateNode,u?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=dB("display",o))}catch(g){Li(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){Li(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Rc(t,e),hu(e),n&4&&KT(e);break;case 21:break;default:Rc(t,e),hu(e)}}function hu(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(BI(r)){var n=r;break e}r=r.return}throw Error(Wr(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Px(a,""),n.flags&=-33);var s=GT(e);Zj(e,s,a);break;case 3:case 4:var o=n.stateNode.containerInfo,l=GT(e);Jj(e,l,o);break;default:throw Error(Wr(161))}}catch(c){Li(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function iQ(e,t,r){nn=e,$I(e)}function $I(e,t,r){for(var n=(e.mode&1)!==0;nn!==null;){var a=nn,s=a.child;if(a.tag===22&&n){var o=a.memoizedState!==null||lb;if(!o){var l=a.alternate,c=l!==null&&l.memoizedState!==null||wo;l=lb;var u=wo;if(lb=o,(wo=c)&&!u)for(nn=a;nn!==null;)o=nn,c=o.child,o.tag===22&&o.memoizedState!==null?QT(a):c!==null?(c.return=o,nn=c):QT(a);for(;s!==null;)nn=s,$I(s),s=s.sibling;nn=a,lb=l,wo=u}XT(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,nn=s):XT(e)}}function XT(e){for(;nn!==null;){var t=nn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:wo||Gw(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!wo)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:$c(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&LT(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}LT(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Fx(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Wr(163))}wo||t.flags&512&&Qj(t)}catch(p){Li(t,t.return,p)}}if(t===e){nn=null;break}if(r=t.sibling,r!==null){r.return=t.return,nn=r;break}nn=t.return}}function YT(e){for(;nn!==null;){var t=nn;if(t===e){nn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,nn=r;break}nn=t.return}}function QT(e){for(;nn!==null;){var t=nn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Gw(4,t)}catch(c){Li(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(c){Li(t,a,c)}}var s=t.return;try{Qj(t)}catch(c){Li(t,s,c)}break;case 5:var o=t.return;try{Qj(t)}catch(c){Li(t,o,c)}}}catch(c){Li(t,t.return,c)}if(t===e){nn=null;break}var l=t.sibling;if(l!==null){l.return=t.return,nn=l;break}nn=t.return}}var sQ=Math.ceil,d2=qd.ReactCurrentDispatcher,R3=qd.ReactCurrentOwner,gc=qd.ReactCurrentBatchConfig,la=0,$s=null,os=null,ao=0,El=0,Wp=lh(0),Ss=0,Vx=null,c0=0,Kw=0,B3=0,mx=null,al=null,I3=0,km=1/0,dd=null,f2=!1,eA=null,Wf=null,cb=!1,Of=null,h2=0,gx=0,tA=null,_v=-1,kv=0;function zo(){return la&6?Gi():_v!==-1?_v:_v=Gi()}function qf(e){return e.mode&1?la&2&&ao!==0?ao&-ao:WY.transition!==null?(kv===0&&(kv=kB()),kv):(e=Ma,e!==0||(e=window.event,e=e===void 0?16:PB(e.type)),e):1}function Xc(e,t,r,n){if(50<gx)throw gx=0,tA=null,Error(Wr(185));F1(e,r,n),(!(la&2)||e!==$s)&&(e===$s&&(!(la&2)&&(Kw|=r),Ss===4&&Nf(e,ao)),fl(e,n),r===1&&la===0&&!(t.mode&1)&&(km=Gi()+500,qw&&ch()))}function fl(e,t){var r=e.callbackNode;WX(e,t);var n=Yv(e,e===$s?ao:0);if(n===0)r!==null&&sT(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&sT(r),t===1)e.tag===0?zY(JT.bind(null,e)):YB(JT.bind(null,e)),IY(function(){!(la&6)&&ch()}),r=null;else{switch(jB(n)){case 1:r=u3;break;case 4:r=SB;break;case 16:r=Xv;break;case 536870912:r=_B;break;default:r=Xv}r=KI(r,UI.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function UI(e,t){if(_v=-1,kv=0,la&6)throw Error(Wr(327));var r=e.callbackNode;if(nm()&&e.callbackNode!==r)return null;var n=Yv(e,e===$s?ao:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=p2(e,n);else{t=n;var a=la;la|=2;var s=WI();($s!==e||ao!==t)&&(dd=null,km=Gi()+500,Kh(e,t));do try{cQ();break}catch(l){zI(e,l)}while(!0);_3(),d2.current=s,la=a,os!==null?t=0:($s=null,ao=0,t=Ss)}if(t!==0){if(t===2&&(a=Cj(e),a!==0&&(n=a,t=rA(e,a))),t===1)throw r=Vx,Kh(e,0),Nf(e,n),fl(e,Gi()),r;if(t===6)Nf(e,n);else{if(a=e.current.alternate,!(n&30)&&!oQ(a)&&(t=p2(e,n),t===2&&(s=Cj(e),s!==0&&(n=s,t=rA(e,s))),t===1))throw r=Vx,Kh(e,0),Nf(e,n),fl(e,Gi()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(Wr(345));case 2:Ph(e,al,dd);break;case 3:if(Nf(e,n),(n&130023424)===n&&(t=I3+500-Gi(),10<t)){if(Yv(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){zo(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Rj(Ph.bind(null,e,al,dd),t);break}Ph(e,al,dd);break;case 4:if(Nf(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var o=31-Kc(n);s=1<<o,o=t[o],o>a&&(a=o),n&=~s}if(n=a,n=Gi()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*sQ(n/1960))-n,10<n){e.timeoutHandle=Rj(Ph.bind(null,e,al,dd),n);break}Ph(e,al,dd);break;case 5:Ph(e,al,dd);break;default:throw Error(Wr(329))}}}return fl(e,Gi()),e.callbackNode===r?UI.bind(null,e):null}function rA(e,t){var r=mx;return e.current.memoizedState.isDehydrated&&(Kh(e,t).flags|=256),e=p2(e,t),e!==2&&(t=al,al=r,t!==null&&nA(t)),e}function nA(e){al===null?al=e:al.push.apply(al,e)}function oQ(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!eu(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Nf(e,t){for(t&=~B3,t&=~Kw,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Kc(t),n=1<<r;e[r]=-1,t&=~n}}function JT(e){if(la&6)throw Error(Wr(327));nm();var t=Yv(e,0);if(!(t&1))return fl(e,Gi()),null;var r=p2(e,t);if(e.tag!==0&&r===2){var n=Cj(e);n!==0&&(t=n,r=rA(e,n))}if(r===1)throw r=Vx,Kh(e,0),Nf(e,t),fl(e,Gi()),r;if(r===6)throw Error(Wr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ph(e,al,dd),fl(e,Gi()),null}function D3(e,t){var r=la;la|=1;try{return e(t)}finally{la=r,la===0&&(km=Gi()+500,qw&&ch())}}function u0(e){Of!==null&&Of.tag===0&&!(la&6)&&nm();var t=la;la|=1;var r=gc.transition,n=Ma;try{if(gc.transition=null,Ma=1,e)return e()}finally{Ma=n,gc.transition=r,la=t,!(la&6)&&ch()}}function $3(){El=Wp.current,ri(Wp)}function Kh(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,BY(r)),os!==null)for(r=os.return;r!==null;){var n=r;switch(v3(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&t2();break;case 3:Sm(),ri(ul),ri(Co),E3();break;case 5:C3(n);break;case 4:Sm();break;case 13:ri(gi);break;case 19:ri(gi);break;case 10:k3(n.type._context);break;case 22:case 23:$3()}r=r.return}if($s=e,os=e=Hf(e.current,null),ao=El=t,Ss=0,Vx=null,B3=Kw=c0=0,al=mx=null,Dh!==null){for(t=0;t<Dh.length;t++)if(r=Dh[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=a,n.next=o}r.pending=n}Dh=null}return e}function zI(e,t){do{var r=os;try{if(_3(),vv.current=u2,c2){for(var n=vi.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}c2=!1}if(l0=0,Fs=bs=vi=null,hx=!1,Wx=0,R3.current=null,r===null||r.return===null){Ss=1,Vx=t,os=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=ao,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=DT(o);if(h!==null){h.flags&=-257,$T(h,o,l,s,t),h.mode&1&&IT(s,u,t),t=h,c=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}else{if(!(t&1)){IT(s,u,t),U3();break e}c=Error(Wr(426))}}else if(oi&&l.mode&1){var b=DT(o);if(b!==null){!(b.flags&65536)&&(b.flags|=256),$T(b,o,l,s,t),w3(_m(c,l));break e}}s=c=_m(c,l),Ss!==4&&(Ss=2),mx===null?mx=[s]:mx.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var y=jI(s,c,t);OT(s,y);break e;case 1:l=c;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Wf===null||!Wf.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=AI(s,l,t);OT(s,_);break e}}s=s.return}while(s!==null)}HI(r)}catch(C){t=C,os===r&&r!==null&&(os=r=r.return);continue}break}while(!0)}function WI(){var e=d2.current;return d2.current=u2,e===null?u2:e}function U3(){(Ss===0||Ss===3||Ss===2)&&(Ss=4),$s===null||!(c0&268435455)&&!(Kw&268435455)||Nf($s,ao)}function p2(e,t){var r=la;la|=2;var n=WI();($s!==e||ao!==t)&&(dd=null,Kh(e,t));do try{lQ();break}catch(a){zI(e,a)}while(!0);if(_3(),la=r,d2.current=n,os!==null)throw Error(Wr(261));return $s=null,ao=0,Ss}function lQ(){for(;os!==null;)qI(os)}function cQ(){for(;os!==null&&!MX();)qI(os)}function qI(e){var t=GI(e.alternate,e,El);e.memoizedProps=e.pendingProps,t===null?HI(e):os=t,R3.current=null}function HI(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=rQ(r,t),r!==null){r.flags&=32767,os=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ss=6,os=null;return}}else if(r=tQ(r,t,El),r!==null){os=r;return}if(t=t.sibling,t!==null){os=t;return}os=t=e}while(t!==null);Ss===0&&(Ss=5)}function Ph(e,t,r){var n=Ma,a=gc.transition;try{gc.transition=null,Ma=1,uQ(e,t,r,n)}finally{gc.transition=a,Ma=n}return null}function uQ(e,t,r,n){do nm();while(Of!==null);if(la&6)throw Error(Wr(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Wr(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(qX(e,s),e===$s&&(os=$s=null,ao=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||cb||(cb=!0,KI(Xv,function(){return nm(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=gc.transition,gc.transition=null;var o=Ma;Ma=1;var l=la;la|=4,R3.current=null,aQ(e,r),DI(r,e),TY(Mj),Qv=!!Lj,Mj=Lj=null,e.current=r,iQ(r),FX(),la=l,Ma=o,gc.transition=s}else e.current=r;if(cb&&(cb=!1,Of=e,h2=a),s=e.pendingLanes,s===0&&(Wf=null),IX(r.stateNode),fl(e,Gi()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(f2)throw f2=!1,e=eA,eA=null,e;return h2&1&&e.tag!==0&&nm(),s=e.pendingLanes,s&1?e===tA?gx++:(gx=0,tA=e):gx=0,ch(),null}function nm(){if(Of!==null){var e=jB(h2),t=gc.transition,r=Ma;try{if(gc.transition=null,Ma=16>e?16:e,Of===null)var n=!1;else{if(e=Of,Of=null,h2=0,la&6)throw Error(Wr(331));var a=la;for(la|=4,nn=e.current;nn!==null;){var s=nn,o=s.child;if(nn.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(nn=u;nn!==null;){var d=nn;switch(d.tag){case 0:case 11:case 15:px(8,d,s)}var f=d.child;if(f!==null)f.return=d,nn=f;else for(;nn!==null;){d=nn;var p=d.sibling,h=d.return;if(RI(d),d===u){nn=null;break}if(p!==null){p.return=h,nn=p;break}nn=h}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var b=g.sibling;g.sibling=null,g=b}while(g!==null)}}nn=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,nn=o;else e:for(;nn!==null;){if(s=nn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:px(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,nn=y;break e}nn=s.return}}var v=e.current;for(nn=v;nn!==null;){o=nn;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,nn=w;else e:for(o=v;nn!==null;){if(l=nn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Gw(9,l)}}catch(C){Li(l,l.return,C)}if(l===o){nn=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,nn=_;break e}nn=l.return}}if(la=a,ch(),Iu&&typeof Iu.onPostCommitFiberRoot=="function")try{Iu.onPostCommitFiberRoot(Dw,e)}catch{}n=!0}return n}finally{Ma=r,gc.transition=t}}return!1}function ZT(e,t,r){t=_m(r,t),t=jI(e,t,1),e=zf(e,t,1),t=zo(),e!==null&&(F1(e,1,t),fl(e,t))}function Li(e,t,r){if(e.tag===3)ZT(e,e,r);else for(;t!==null;){if(t.tag===3){ZT(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Wf===null||!Wf.has(n))){e=_m(r,e),e=AI(t,e,1),t=zf(t,e,1),e=zo(),t!==null&&(F1(t,1,e),fl(t,e));break}}t=t.return}}function dQ(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=zo(),e.pingedLanes|=e.suspendedLanes&r,$s===e&&(ao&r)===r&&(Ss===4||Ss===3&&(ao&130023424)===ao&&500>Gi()-I3?Kh(e,0):B3|=r),fl(e,t)}function VI(e,t){t===0&&(e.mode&1?(t=Zy,Zy<<=1,!(Zy&130023424)&&(Zy=4194304)):t=1);var r=zo();e=Td(e,t),e!==null&&(F1(e,t,r),fl(e,r))}function fQ(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),VI(e,r)}function hQ(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Wr(314))}n!==null&&n.delete(t),VI(e,r)}var GI;GI=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ul.current)il=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return il=!1,eQ(e,t,r);il=!!(e.flags&131072)}else il=!1,oi&&t.flags&1048576&&QB(t,a2,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Sv(e,t),e=t.pendingProps;var a=bm(t,Co.current);rm(t,r),a=P3(null,t,n,e,a,r);var s=O3();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,dl(n)?(s=!0,r2(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,A3(t),a.updater=Vw,t.stateNode=a,a._reactInternals=t,Wj(t,n,e,r),t=Vj(null,t,n,!0,s,r)):(t.tag=0,oi&&s&&b3(t),Bo(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Sv(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=mQ(n),e=$c(n,e),a){case 0:t=Hj(null,t,n,e,r);break e;case 1:t=WT(null,t,n,e,r);break e;case 11:t=UT(null,t,n,e,r);break e;case 14:t=zT(null,t,n,$c(n.type,e),r);break e}throw Error(Wr(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:$c(n,a),Hj(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:$c(n,a),WT(e,t,n,a,r);case 3:e:{if(TI(t),e===null)throw Error(Wr(387));n=t.pendingProps,s=t.memoizedState,a=s.element,nI(e,t),o2(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=_m(Error(Wr(423)),t),t=qT(e,t,n,r,a);break e}else if(n!==a){a=_m(Error(Wr(424)),t),t=qT(e,t,n,r,a);break e}else for(Fl=Uf(t.stateNode.containerInfo.firstChild),Il=t,oi=!0,zc=null,r=tI(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(vm(),n===a){t=Pd(e,t,r);break e}Bo(e,t,n,r)}t=t.child}return t;case 5:return aI(t),e===null&&$j(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,o=a.children,Fj(n,a)?o=null:s!==null&&Fj(n,s)&&(t.flags|=32),EI(e,t),Bo(e,t,o,r),t.child;case 6:return e===null&&$j(t),null;case 13:return PI(e,t,r);case 4:return N3(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=wm(t,null,n,r):Bo(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:$c(n,a),UT(e,t,n,a,r);case 7:return Bo(e,t,t.pendingProps,r),t.child;case 8:return Bo(e,t,t.pendingProps.children,r),t.child;case 12:return Bo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,o=a.value,Xa(i2,n._currentValue),n._currentValue=o,s!==null)if(eu(s.value,o)){if(s.children===a.children&&!ul.current){t=Pd(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=Sd(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),Uj(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Wr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),Uj(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Bo(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,rm(t,r),a=yc(a),n=n(a),t.flags|=1,Bo(e,t,n,r),t.child;case 14:return n=t.type,a=$c(n,t.pendingProps),a=$c(n.type,a),zT(e,t,n,a,r);case 15:return NI(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:$c(n,a),Sv(e,t),t.tag=1,dl(n)?(e=!0,r2(t)):e=!1,rm(t,r),kI(t,n,a),Wj(t,n,a,r),Vj(null,t,n,!0,e,r);case 19:return OI(e,t,r);case 22:return CI(e,t,r)}throw Error(Wr(156,t.tag))};function KI(e,t){return wB(e,t)}function pQ(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pc(e,t,r,n){return new pQ(e,t,r,n)}function z3(e){return e=e.prototype,!(!e||!e.isReactComponent)}function mQ(e){if(typeof e=="function")return z3(e)?1:0;if(e!=null){if(e=e.$$typeof,e===o3)return 11;if(e===l3)return 14}return 2}function Hf(e,t){var r=e.alternate;return r===null?(r=pc(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function jv(e,t,r,n,a,s){var o=2;if(n=e,typeof e=="function")z3(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Lp:return Xh(r.children,a,s,t);case s3:o=8,a|=8;break;case hj:return e=pc(12,r,t,a|2),e.elementType=hj,e.lanes=s,e;case pj:return e=pc(13,r,t,a),e.elementType=pj,e.lanes=s,e;case mj:return e=pc(19,r,t,a),e.elementType=mj,e.lanes=s,e;case aB:return Xw(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case rB:o=10;break e;case nB:o=9;break e;case o3:o=11;break e;case l3:o=14;break e;case Sf:o=16,n=null;break e}throw Error(Wr(130,e==null?e:typeof e,""))}return t=pc(o,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Xh(e,t,r,n){return e=pc(7,e,n,t),e.lanes=r,e}function Xw(e,t,r,n){return e=pc(22,e,n,t),e.elementType=aB,e.lanes=r,e.stateNode={isHidden:!1},e}function N5(e,t,r){return e=pc(6,e,null,t),e.lanes=r,e}function C5(e,t,r){return t=pc(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function gQ(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=l5(0),this.expirationTimes=l5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=l5(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function W3(e,t,r,n,a,s,o,l,c){return e=new gQ(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=pc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},A3(s),e}function xQ(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Op,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function XI(e){if(!e)return Qf;e=e._reactInternals;e:{if(L0(e)!==e||e.tag!==1)throw Error(Wr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(dl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Wr(171))}if(e.tag===1){var r=e.type;if(dl(r))return XB(e,r,t)}return t}function YI(e,t,r,n,a,s,o,l,c){return e=W3(r,n,!0,e,a,s,o,l,c),e.context=XI(null),r=e.current,n=zo(),a=qf(r),s=Sd(n,a),s.callback=t??null,zf(r,s,a),e.current.lanes=a,F1(e,a,n),fl(e,n),e}function Yw(e,t,r,n){var a=t.current,s=zo(),o=qf(a);return r=XI(r),t.context===null?t.context=r:t.pendingContext=r,t=Sd(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=zf(a,t,o),e!==null&&(Xc(e,a,o,s),bv(e,a,o)),o}function m2(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function e8(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function q3(e,t){e8(e,t),(e=e.alternate)&&e8(e,t)}function yQ(){return null}var QI=typeof reportError=="function"?reportError:function(e){console.error(e)};function H3(e){this._internalRoot=e}Qw.prototype.render=H3.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Wr(409));Yw(e,t,null,null)};Qw.prototype.unmount=H3.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;u0(function(){Yw(null,e,null,null)}),t[Ed]=null}};function Qw(e){this._internalRoot=e}Qw.prototype.unstable_scheduleHydration=function(e){if(e){var t=CB();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Af.length&&t!==0&&t<Af[r].priority;r++);Af.splice(r,0,e),r===0&&TB(e)}};function V3(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Jw(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function t8(){}function bQ(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var u=m2(o);s.call(u)}}var o=YI(t,n,e,0,null,!1,!1,"",t8);return e._reactRootContainer=o,e[Ed]=o.current,Ix(e.nodeType===8?e.parentNode:e),u0(),o}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var l=n;n=function(){var u=m2(c);l.call(u)}}var c=W3(e,0,!1,null,null,!1,!1,"",t8);return e._reactRootContainer=c,e[Ed]=c.current,Ix(e.nodeType===8?e.parentNode:e),u0(function(){Yw(t,c,r,n)}),c}function Zw(e,t,r,n,a){var s=r._reactRootContainer;if(s){var o=s;if(typeof a=="function"){var l=a;a=function(){var c=m2(o);l.call(c)}}Yw(t,o,e,a)}else o=bQ(r,t,e,a,n);return m2(o)}AB=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Zg(t.pendingLanes);r!==0&&(d3(t,r|1),fl(t,Gi()),!(la&6)&&(km=Gi()+500,ch()))}break;case 13:u0(function(){var n=Td(e,1);if(n!==null){var a=zo();Xc(n,e,1,a)}}),q3(e,1)}};f3=function(e){if(e.tag===13){var t=Td(e,134217728);if(t!==null){var r=zo();Xc(t,e,134217728,r)}q3(e,134217728)}};NB=function(e){if(e.tag===13){var t=qf(e),r=Td(e,t);if(r!==null){var n=zo();Xc(r,e,t,n)}q3(e,t)}};CB=function(){return Ma};EB=function(e,t){var r=Ma;try{return Ma=e,t()}finally{Ma=r}};jj=function(e,t,r){switch(t){case"input":if(yj(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=Ww(n);if(!a)throw Error(Wr(90));sB(n),yj(n,a)}}}break;case"textarea":lB(e,r);break;case"select":t=r.value,t!=null&&Jp(e,!!r.multiple,t,!1)}};mB=D3;gB=u0;var vQ={usingClientEntryPoint:!1,Events:[B1,Bp,Ww,hB,pB,D3]},Cg={findFiberByHostInstance:Ih,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wQ={bundleType:Cg.bundleType,version:Cg.version,rendererPackageName:Cg.rendererPackageName,rendererConfig:Cg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qd.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=bB(e),e===null?null:e.stateNode},findFiberByHostInstance:Cg.findFiberByHostInstance||yQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ub=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ub.isDisabled&&ub.supportsFiber)try{Dw=ub.inject(wQ),Iu=ub}catch{}}ql.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vQ;ql.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!V3(t))throw Error(Wr(200));return xQ(e,t,null,r)};ql.createRoot=function(e,t){if(!V3(e))throw Error(Wr(299));var r=!1,n="",a=QI;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=W3(e,1,!1,null,null,r,!1,n,a),e[Ed]=t.current,Ix(e.nodeType===8?e.parentNode:e),new H3(t)};ql.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Wr(188)):(e=Object.keys(e).join(","),Error(Wr(268,e)));return e=bB(t),e=e===null?null:e.stateNode,e};ql.flushSync=function(e){return u0(e)};ql.hydrate=function(e,t,r){if(!Jw(t))throw Error(Wr(200));return Zw(null,e,t,!0,r)};ql.hydrateRoot=function(e,t,r){if(!V3(e))throw Error(Wr(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",o=QI;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=YI(t,null,e,1,r??null,a,!1,s,o),e[Ed]=t.current,Ix(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Qw(t)};ql.render=function(e,t,r){if(!Jw(t))throw Error(Wr(200));return Zw(null,e,t,!1,r)};ql.unmountComponentAtNode=function(e){if(!Jw(e))throw Error(Wr(40));return e._reactRootContainer?(u0(function(){Zw(null,null,e,!1,function(){e._reactRootContainer=null,e[Ed]=null})}),!0):!1};ql.unstable_batchedUpdates=D3;ql.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Jw(r))throw Error(Wr(200));if(e==null||e._reactInternals===void 0)throw Error(Wr(38));return Zw(e,t,r,!1,n)};ql.version="18.3.1-next-f1338f8080-20240426";function JI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(JI)}catch(e){console.error(e)}}JI(),JR.exports=ql;var eS=JR.exports,ZI,r8=eS;ZI=r8.createRoot,r8.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gx(){return Gx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gx.apply(this,arguments)}var Lf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Lf||(Lf={}));const n8="popstate";function SQ(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:o,hash:l}=n.location;return aA("",{pathname:s,search:o,hash:l},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:g2(a)}return kQ(t,r,null,e)}function Qi(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function G3(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function _Q(){return Math.random().toString(36).substr(2,8)}function a8(e,t){return{usr:e.state,key:e.key,idx:t}}function aA(e,t,r,n){return r===void 0&&(r=null),Gx({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?zm(t):t,{state:r,key:t&&t.key||n||_Q()})}function g2(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function zm(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function kQ(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,o=a.history,l=Lf.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(Gx({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){l=Lf.Pop;let b=d(),y=b==null?null:b-u;u=b,c&&c({action:l,location:g.location,delta:y})}function p(b,y){l=Lf.Push;let v=aA(g.location,b,y);u=d()+1;let w=a8(v,u),_=g.createHref(v);try{o.pushState(w,"",_)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;a.location.assign(_)}s&&c&&c({action:l,location:g.location,delta:1})}function h(b,y){l=Lf.Replace;let v=aA(g.location,b,y);u=d();let w=a8(v,u),_=g.createHref(v);o.replaceState(w,"",_),s&&c&&c({action:l,location:g.location,delta:0})}function m(b){let y=a.location.origin!=="null"?a.location.origin:a.location.href,v=typeof b=="string"?b:g2(b);return v=v.replace(/ $/,"%20"),Qi(y,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,y)}let g={get action(){return l},get location(){return e(a,o)},listen(b){if(c)throw new Error("A history only accepts one active listener");return a.addEventListener(n8,f),c=b,()=>{a.removeEventListener(n8,f),c=null}},createHref(b){return t(a,b)},createURL:m,encodeLocation(b){let y=m(b);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:p,replace:h,go(b){return o.go(b)}};return g}var i8;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(i8||(i8={}));function jQ(e,t,r){return r===void 0&&(r="/"),AQ(e,t,r)}function AQ(e,t,r,n){let a=typeof t=="string"?zm(t):t,s=K3(a.pathname||"/",r);if(s==null)return null;let o=eD(e);NQ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=DQ(s);l=RQ(o[c],u)}return l}function eD(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,o,l)=>{let c={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(Qi(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Vf([n,c.relativePath]),d=r.concat(c);s.children&&s.children.length>0&&(Qi(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),eD(s.children,t,d,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:MQ(u,s.index),routesMeta:d})};return e.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))a(s,o);else for(let c of tD(s.path))a(s,o,c)}),t}function tD(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let o=tD(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),a&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function NQ(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:FQ(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const CQ=/^:[\w-]+$/,EQ=3,TQ=2,PQ=1,OQ=10,LQ=-2,s8=e=>e==="*";function MQ(e,t){let r=e.split("/"),n=r.length;return r.some(s8)&&(n+=LQ),t&&(n+=TQ),r.filter(a=>!s8(a)).reduce((a,s)=>a+(CQ.test(s)?EQ:s===""?PQ:OQ),n)}function FQ(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function RQ(e,t,r){let{routesMeta:n}=e,a={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",f=BQ({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:Vf([s,f.pathname]),pathnameBase:qQ(Vf([s,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(s=Vf([s,f.pathnameBase]))}return o}function BQ(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=IQ(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],o=s.replace(/(.)\/+$/,"$1"),l=a.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:p,isOptional:h}=d;if(p==="*"){let g=l[f]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const m=l[f];return h&&!m?u[p]=void 0:u[p]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:e}}function IQ(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),G3(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function DQ(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return G3(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function K3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const $Q=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,UQ=e=>$Q.test(e);function zQ(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?zm(e):e,s;if(r)if(UQ(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),G3(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=o8(r.substring(1),"/"):s=o8(r,t)}else s=t;return{pathname:s,search:HQ(n),hash:VQ(a)}}function o8(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function E5(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function WQ(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function X3(e,t){let r=WQ(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Y3(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=zm(e):(a=Gx({},e),Qi(!a.pathname||!a.pathname.includes("?"),E5("?","pathname","search",a)),Qi(!a.pathname||!a.pathname.includes("#"),E5("#","pathname","hash",a)),Qi(!a.search||!a.search.includes("#"),E5("#","search","hash",a)));let s=e===""||a.pathname==="",o=s?"/":a.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;a.pathname=p.join("/")}l=f>=0?t[f]:"/"}let c=zQ(a,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Vf=e=>e.join("/").replace(/\/\/+/g,"/"),qQ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),HQ=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,VQ=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function GQ(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const rD=["post","put","patch","delete"];new Set(rD);const KQ=["get",...rD];new Set(KQ);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Kx(){return Kx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kx.apply(this,arguments)}const Q3=x.createContext(null),XQ=x.createContext(null),uh=x.createContext(null),tS=x.createContext(null),Hd=x.createContext({outlet:null,matches:[],isDataRoute:!1}),nD=x.createContext(null);function YQ(e,t){let{relative:r}=t===void 0?{}:t;Wm()||Qi(!1);let{basename:n,navigator:a}=x.useContext(uh),{hash:s,pathname:o,search:l}=iD(e,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:Vf([n,o])),a.createHref({pathname:c,search:l,hash:s})}function Wm(){return x.useContext(tS)!=null}function Xo(){return Wm()||Qi(!1),x.useContext(tS).location}function aD(e){x.useContext(uh).static||x.useLayoutEffect(e)}function so(){let{isDataRoute:e}=x.useContext(Hd);return e?cJ():QQ()}function QQ(){Wm()||Qi(!1);let e=x.useContext(Q3),{basename:t,future:r,navigator:n}=x.useContext(uh),{matches:a}=x.useContext(Hd),{pathname:s}=Xo(),o=JSON.stringify(X3(a,r.v7_relativeSplatPath)),l=x.useRef(!1);return aD(()=>{l.current=!0}),x.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let f=Y3(u,JSON.parse(o),s,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Vf([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,o,s,e])}function M0(){let{matches:e}=x.useContext(Hd),t=e[e.length-1];return t?t.params:{}}function iD(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=x.useContext(uh),{matches:a}=x.useContext(Hd),{pathname:s}=Xo(),o=JSON.stringify(X3(a,n.v7_relativeSplatPath));return x.useMemo(()=>Y3(e,JSON.parse(o),s,r==="path"),[e,o,s,r])}function JQ(e,t){return ZQ(e,t)}function ZQ(e,t,r,n){Wm()||Qi(!1);let{navigator:a}=x.useContext(uh),{matches:s}=x.useContext(Hd),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Xo(),d;if(t){var f;let b=typeof t=="string"?zm(t):t;c==="/"||(f=b.pathname)!=null&&f.startsWith(c)||Qi(!1),d=b}else d=u;let p=d.pathname||"/",h=p;if(c!=="/"){let b=c.replace(/^\//,"").split("/");h="/"+p.replace(/^\//,"").split("/").slice(b.length).join("/")}let m=jQ(e,{pathname:h}),g=aJ(m&&m.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:Vf([c,a.encodeLocation?a.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:Vf([c,a.encodeLocation?a.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),s,r,n);return t&&g?x.createElement(tS.Provider,{value:{location:Kx({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Lf.Pop}},g):g}function eJ(){let e=lJ(),t=GQ(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:a},r):null,null)}const tJ=x.createElement(eJ,null);class rJ extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?x.createElement(Hd.Provider,{value:this.props.routeContext},x.createElement(nD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function nJ(e){let{routeContext:t,match:r,children:n}=e,a=x.useContext(Q3);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(Hd.Provider,{value:t},n)}function aJ(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(a=r)==null?void 0:a.errors;if(l!=null){let d=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||Qi(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:p,errors:h}=r,m=f.route.loader&&p[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||m){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,p)=>{let h,m=!1,g=null,b=null;r&&(h=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||tJ,c&&(u<0&&p===0?(uJ("route-fallback"),m=!0,b=null):u===p&&(m=!0,b=f.route.hydrateFallbackElement||null)));let y=t.concat(o.slice(0,p+1)),v=()=>{let w;return h?w=g:m?w=b:f.route.Component?w=x.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=d,x.createElement(nJ,{match:f,routeContext:{outlet:d,matches:y,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?x.createElement(rJ,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:v(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):v()},null)}var sD=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(sD||{}),oD=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(oD||{});function iJ(e){let t=x.useContext(Q3);return t||Qi(!1),t}function sJ(e){let t=x.useContext(XQ);return t||Qi(!1),t}function oJ(e){let t=x.useContext(Hd);return t||Qi(!1),t}function lD(e){let t=oJ(),r=t.matches[t.matches.length-1];return r.route.id||Qi(!1),r.route.id}function lJ(){var e;let t=x.useContext(nD),r=sJ(),n=lD();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function cJ(){let{router:e}=iJ(sD.UseNavigateStable),t=lD(oD.UseNavigateStable),r=x.useRef(!1);return aD(()=>{r.current=!0}),x.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,Kx({fromRouteId:t},s)))},[e,t])}const l8={};function uJ(e,t,r){l8[e]||(l8[e]=!0)}function dJ(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function qp(e){let{to:t,replace:r,state:n,relative:a}=e;Wm()||Qi(!1);let{future:s,static:o}=x.useContext(uh),{matches:l}=x.useContext(Hd),{pathname:c}=Xo(),u=so(),d=Y3(t,X3(l,s.v7_relativeSplatPath),c,a==="path"),f=JSON.stringify(d);return x.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:a}),[u,f,a,r,n]),null}function qn(e){Qi(!1)}function fJ(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Lf.Pop,navigator:s,static:o=!1,future:l}=e;Wm()&&Qi(!1);let c=t.replace(/^\/*/,"/"),u=x.useMemo(()=>({basename:c,navigator:s,static:o,future:Kx({v7_relativeSplatPath:!1},l)}),[c,l,s,o]);typeof n=="string"&&(n=zm(n));let{pathname:d="/",search:f="",hash:p="",state:h=null,key:m="default"}=n,g=x.useMemo(()=>{let b=K3(d,c);return b==null?null:{location:{pathname:b,search:f,hash:p,state:h,key:m},navigationType:a}},[c,d,f,p,h,m,a]);return g==null?null:x.createElement(uh.Provider,{value:u},x.createElement(tS.Provider,{children:r,value:g}))}function iA(e){let{children:t,location:r}=e;return JQ(sA(t),r)}new Promise(()=>{});function sA(e,t){t===void 0&&(t=[]);let r=[];return x.Children.forEach(e,(n,a)=>{if(!x.isValidElement(n))return;let s=[...t,a];if(n.type===x.Fragment){r.push.apply(r,sA(n.props.children,s));return}n.type!==qn&&Qi(!1),!n.props.index||!n.props.children||Qi(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=sA(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function oA(){return oA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oA.apply(this,arguments)}function hJ(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function pJ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function mJ(e,t){return e.button===0&&(!t||t==="_self")&&!pJ(e)}function lA(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function gJ(e,t){let r=lA(e);return t&&t.forEach((n,a)=>{r.has(a)||t.getAll(a).forEach(s=>{r.append(a,s)})}),r}const xJ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],yJ="6";try{window.__reactRouterVersion=yJ}catch{}const bJ="startTransition",c8=YR[bJ];function vJ(e){let{basename:t,children:r,future:n,window:a}=e,s=x.useRef();s.current==null&&(s.current=SQ({window:a,v5Compat:!0}));let o=s.current,[l,c]=x.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=x.useCallback(f=>{u&&c8?c8(()=>c(f)):c(f)},[c,u]);return x.useLayoutEffect(()=>o.listen(d),[o,d]),x.useEffect(()=>dJ(n),[n]),x.createElement(fJ,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const wJ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",SJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Vi=x.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,p=hJ(t,xJ),{basename:h}=x.useContext(uh),m,g=!1;if(typeof u=="string"&&SJ.test(u)&&(m=u,wJ))try{let w=new URL(window.location.href),_=u.startsWith("//")?new URL(w.protocol+u):new URL(u),C=K3(_.pathname,h);_.origin===w.origin&&C!=null?u=C+_.search+_.hash:g=!0}catch{}let b=YQ(u,{relative:a}),y=_J(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:a,viewTransition:f});function v(w){n&&n(w),w.defaultPrevented||y(w)}return x.createElement("a",oA({},p,{href:m||b,onClick:g||s?n:v,ref:r,target:c}))});var u8;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(u8||(u8={}));var d8;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(d8||(d8={}));function _J(e,t){let{target:r,replace:n,state:a,preventScrollReset:s,relative:o,viewTransition:l}=t===void 0?{}:t,c=so(),u=Xo(),d=iD(e,{relative:o});return x.useCallback(f=>{if(mJ(f,r)){f.preventDefault();let p=n!==void 0?n:g2(u)===g2(d);c(e,{replace:p,state:a,preventScrollReset:s,relative:o,viewTransition:l})}},[u,c,d,n,a,r,e,s,o,l])}function kJ(e){let t=x.useRef(lA(e)),r=x.useRef(!1),n=Xo(),a=x.useMemo(()=>gJ(n.search,r.current?null:t.current),[n.search]),s=so(),o=x.useCallback((l,c)=>{const u=lA(typeof l=="function"?l(a):l);r.current=!0,s("?"+u,c)},[s,a]);return[a,o]}function cD(e,t){return function(){return e.apply(t,arguments)}}const{toString:jJ}=Object.prototype,{getPrototypeOf:J3}=Object,{iterator:rS,toStringTag:uD}=Symbol,nS=(e=>t=>{const r=jJ.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),au=e=>(e=e.toLowerCase(),t=>nS(t)===e),aS=e=>t=>typeof t===e,{isArray:qm}=Array,jm=aS("undefined");function D1(e){return e!==null&&!jm(e)&&e.constructor!==null&&!jm(e.constructor)&&hl(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const dD=au("ArrayBuffer");function AJ(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&dD(e.buffer),t}const NJ=aS("string"),hl=aS("function"),fD=aS("number"),$1=e=>e!==null&&typeof e=="object",CJ=e=>e===!0||e===!1,Av=e=>{if(nS(e)!=="object")return!1;const t=J3(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(uD in e)&&!(rS in e)},EJ=e=>{if(!$1(e)||D1(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},TJ=au("Date"),PJ=au("File"),OJ=au("Blob"),LJ=au("FileList"),MJ=e=>$1(e)&&hl(e.pipe),FJ=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||hl(e.append)&&((t=nS(e))==="formdata"||t==="object"&&hl(e.toString)&&e.toString()==="[object FormData]"))},RJ=au("URLSearchParams"),[BJ,IJ,DJ,$J]=["ReadableStream","Request","Response","Headers"].map(au),UJ=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function U1(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),qm(e))for(n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else{if(D1(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(n=0;n<o;n++)l=s[n],t.call(null,e[l],l,e)}}function hD(e,t){if(D1(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],t===a.toLowerCase())return a;return null}const Uh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,pD=e=>!jm(e)&&e!==Uh;function cA(){const{caseless:e,skipUndefined:t}=pD(this)&&this||{},r={},n=(a,s)=>{const o=e&&hD(r,s)||s;Av(r[o])&&Av(a)?r[o]=cA(r[o],a):Av(a)?r[o]=cA({},a):qm(a)?r[o]=a.slice():(!t||!jm(a))&&(r[o]=a)};for(let a=0,s=arguments.length;a<s;a++)arguments[a]&&U1(arguments[a],n);return r}const zJ=(e,t,r,{allOwnKeys:n}={})=>(U1(t,(a,s)=>{r&&hl(a)?e[s]=cD(a,r):e[s]=a},{allOwnKeys:n}),e),WJ=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),qJ=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},HJ=(e,t,r,n)=>{let a,s,o;const l={};if(t=t||{},e==null)return t;do{for(a=Object.getOwnPropertyNames(e),s=a.length;s-- >0;)o=a[s],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&J3(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},VJ=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},GJ=e=>{if(!e)return null;if(qm(e))return e;let t=e.length;if(!fD(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},KJ=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&J3(Uint8Array)),XJ=(e,t)=>{const n=(e&&e[rS]).call(e);let a;for(;(a=n.next())&&!a.done;){const s=a.value;t.call(e,s[0],s[1])}},YJ=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},QJ=au("HTMLFormElement"),JJ=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),f8=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),ZJ=au("RegExp"),mD=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};U1(r,(a,s)=>{let o;(o=t(a,s,e))!==!1&&(n[s]=o||a)}),Object.defineProperties(e,n)},eZ=e=>{mD(e,(t,r)=>{if(hl(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(hl(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},tZ=(e,t)=>{const r={},n=a=>{a.forEach(s=>{r[s]=!0})};return qm(e)?n(e):n(String(e).split(t)),r},rZ=()=>{},nZ=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function aZ(e){return!!(e&&hl(e.append)&&e[uD]==="FormData"&&e[rS])}const iZ=e=>{const t=new Array(10),r=(n,a)=>{if($1(n)){if(t.indexOf(n)>=0)return;if(D1(n))return n;if(!("toJSON"in n)){t[a]=n;const s=qm(n)?[]:{};return U1(n,(o,l)=>{const c=r(o,a+1);!jm(c)&&(s[l]=c)}),t[a]=void 0,s}}return n};return r(e,0)},sZ=au("AsyncFunction"),oZ=e=>e&&($1(e)||hl(e))&&hl(e.then)&&hl(e.catch),gD=((e,t)=>e?setImmediate:t?((r,n)=>(Uh.addEventListener("message",({source:a,data:s})=>{a===Uh&&s===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Uh.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",hl(Uh.postMessage)),lZ=typeof queueMicrotask<"u"?queueMicrotask.bind(Uh):typeof process<"u"&&process.nextTick||gD,cZ=e=>e!=null&&hl(e[rS]),lr={isArray:qm,isArrayBuffer:dD,isBuffer:D1,isFormData:FJ,isArrayBufferView:AJ,isString:NJ,isNumber:fD,isBoolean:CJ,isObject:$1,isPlainObject:Av,isEmptyObject:EJ,isReadableStream:BJ,isRequest:IJ,isResponse:DJ,isHeaders:$J,isUndefined:jm,isDate:TJ,isFile:PJ,isBlob:OJ,isRegExp:ZJ,isFunction:hl,isStream:MJ,isURLSearchParams:RJ,isTypedArray:KJ,isFileList:LJ,forEach:U1,merge:cA,extend:zJ,trim:UJ,stripBOM:WJ,inherits:qJ,toFlatObject:HJ,kindOf:nS,kindOfTest:au,endsWith:VJ,toArray:GJ,forEachEntry:XJ,matchAll:YJ,isHTMLForm:QJ,hasOwnProperty:f8,hasOwnProp:f8,reduceDescriptors:mD,freezeMethods:eZ,toObjectSet:tZ,toCamelCase:JJ,noop:rZ,toFiniteNumber:nZ,findKey:hD,global:Uh,isContextDefined:pD,isSpecCompliantForm:aZ,toJSONObject:iZ,isAsyncFn:sZ,isThenable:oZ,setImmediate:gD,asap:lZ,isIterable:cZ};function Dn(e,t,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}lr.inherits(Dn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:lr.toJSONObject(this.config),code:this.code,status:this.status}}});const xD=Dn.prototype,yD={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{yD[e]={value:e}});Object.defineProperties(Dn,yD);Object.defineProperty(xD,"isAxiosError",{value:!0});Dn.from=(e,t,r,n,a,s)=>{const o=Object.create(xD);lr.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Dn.call(o,l,c,r,n,a),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const uZ=null;function uA(e){return lr.isPlainObject(e)||lr.isArray(e)}function bD(e){return lr.endsWith(e,"[]")?e.slice(0,-2):e}function h8(e,t,r){return e?e.concat(t).map(function(a,s){return a=bD(a),!r&&s?"["+a+"]":a}).join(r?".":""):t}function dZ(e){return lr.isArray(e)&&!e.some(uA)}const fZ=lr.toFlatObject(lr,{},null,function(t){return/^is[A-Z]/.test(t)});function iS(e,t,r){if(!lr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=lr.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,b){return!lr.isUndefined(b[g])});const n=r.metaTokens,a=r.visitor||d,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&lr.isSpecCompliantForm(t);if(!lr.isFunction(a))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(lr.isDate(m))return m.toISOString();if(lr.isBoolean(m))return m.toString();if(!c&&lr.isBlob(m))throw new Dn("Blob is not supported. Use a Buffer instead.");return lr.isArrayBuffer(m)||lr.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,g,b){let y=m;if(m&&!b&&typeof m=="object"){if(lr.endsWith(g,"{}"))g=n?g:g.slice(0,-2),m=JSON.stringify(m);else if(lr.isArray(m)&&dZ(m)||(lr.isFileList(m)||lr.endsWith(g,"[]"))&&(y=lr.toArray(m)))return g=bD(g),y.forEach(function(w,_){!(lr.isUndefined(w)||w===null)&&t.append(o===!0?h8([g],_,s):o===null?g:g+"[]",u(w))}),!1}return uA(m)?!0:(t.append(h8(b,g,s),u(m)),!1)}const f=[],p=Object.assign(fZ,{defaultVisitor:d,convertValue:u,isVisitable:uA});function h(m,g){if(!lr.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(m),lr.forEach(m,function(y,v){(!(lr.isUndefined(y)||y===null)&&a.call(t,y,lr.isString(v)?v.trim():v,g,p))===!0&&h(y,g?g.concat(v):[v])}),f.pop()}}if(!lr.isObject(e))throw new TypeError("data must be an object");return h(e),t}function p8(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Z3(e,t){this._pairs=[],e&&iS(e,this,t)}const vD=Z3.prototype;vD.append=function(t,r){this._pairs.push([t,r])};vD.toString=function(t){const r=t?function(n){return t.call(this,n,p8)}:p8;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function hZ(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function wD(e,t,r){if(!t)return e;const n=r&&r.encode||hZ;lr.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let s;if(a?s=a(t,r):s=lr.isURLSearchParams(t)?t.toString():new Z3(t,r).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class m8{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){lr.forEach(this.handlers,function(n){n!==null&&t(n)})}}const SD={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},pZ=typeof URLSearchParams<"u"?URLSearchParams:Z3,mZ=typeof FormData<"u"?FormData:null,gZ=typeof Blob<"u"?Blob:null,xZ={isBrowser:!0,classes:{URLSearchParams:pZ,FormData:mZ,Blob:gZ},protocols:["http","https","file","blob","url","data"]},eN=typeof window<"u"&&typeof document<"u",dA=typeof navigator=="object"&&navigator||void 0,yZ=eN&&(!dA||["ReactNative","NativeScript","NS"].indexOf(dA.product)<0),bZ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",vZ=eN&&window.location.href||"http://localhost",wZ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:eN,hasStandardBrowserEnv:yZ,hasStandardBrowserWebWorkerEnv:bZ,navigator:dA,origin:vZ},Symbol.toStringTag,{value:"Module"})),ko={...wZ,...xZ};function SZ(e,t){return iS(e,new ko.classes.URLSearchParams,{visitor:function(r,n,a,s){return ko.isNode&&lr.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function _Z(e){return lr.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function kZ(e){const t={},r=Object.keys(e);let n;const a=r.length;let s;for(n=0;n<a;n++)s=r[n],t[s]=e[s];return t}function _D(e){function t(r,n,a,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&lr.isArray(a)?a.length:o,c?(lr.hasOwnProp(a,o)?a[o]=[a[o],n]:a[o]=n,!l):((!a[o]||!lr.isObject(a[o]))&&(a[o]=[]),t(r,n,a[o],s)&&lr.isArray(a[o])&&(a[o]=kZ(a[o])),!l)}if(lr.isFormData(e)&&lr.isFunction(e.entries)){const r={};return lr.forEachEntry(e,(n,a)=>{t(_Z(n),a,r,0)}),r}return null}function jZ(e,t,r){if(lr.isString(e))try{return(t||JSON.parse)(e),lr.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const z1={transitional:SD,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,s=lr.isObject(t);if(s&&lr.isHTMLForm(t)&&(t=new FormData(t)),lr.isFormData(t))return a?JSON.stringify(_D(t)):t;if(lr.isArrayBuffer(t)||lr.isBuffer(t)||lr.isStream(t)||lr.isFile(t)||lr.isBlob(t)||lr.isReadableStream(t))return t;if(lr.isArrayBufferView(t))return t.buffer;if(lr.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return SZ(t,this.formSerializer).toString();if((l=lr.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return iS(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||a?(r.setContentType("application/json",!1),jZ(t)):t}],transformResponse:[function(t){const r=this.transitional||z1.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(lr.isResponse(t)||lr.isReadableStream(t))return t;if(t&&lr.isString(t)&&(n&&!this.responseType||a)){const o=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?Dn.from(l,Dn.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ko.classes.FormData,Blob:ko.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};lr.forEach(["delete","get","head","post","put","patch"],e=>{z1.headers[e]={}});const AZ=lr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),NZ=e=>{const t={};let r,n,a;return e&&e.split(`
`).forEach(function(o){a=o.indexOf(":"),r=o.substring(0,a).trim().toLowerCase(),n=o.substring(a+1).trim(),!(!r||t[r]&&AZ[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},g8=Symbol("internals");function Eg(e){return e&&String(e).trim().toLowerCase()}function Nv(e){return e===!1||e==null?e:lr.isArray(e)?e.map(Nv):String(e)}function CZ(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const EZ=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function T5(e,t,r,n,a){if(lr.isFunction(n))return n.call(this,t,r);if(a&&(t=r),!!lr.isString(t)){if(lr.isString(n))return t.indexOf(n)!==-1;if(lr.isRegExp(n))return n.test(t)}}function TZ(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function PZ(e,t){const r=lr.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,s,o){return this[n].call(this,t,a,s,o)},configurable:!0})})}let pl=class{constructor(t){t&&this.set(t)}set(t,r,n){const a=this;function s(l,c,u){const d=Eg(c);if(!d)throw new Error("header name must be a non-empty string");const f=lr.findKey(a,d);(!f||a[f]===void 0||u===!0||u===void 0&&a[f]!==!1)&&(a[f||c]=Nv(l))}const o=(l,c)=>lr.forEach(l,(u,d)=>s(u,d,c));if(lr.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(lr.isString(t)&&(t=t.trim())&&!EZ(t))o(NZ(t),r);else if(lr.isObject(t)&&lr.isIterable(t)){let l={},c,u;for(const d of t){if(!lr.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?lr.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=Eg(t),t){const n=lr.findKey(this,t);if(n){const a=this[n];if(!r)return a;if(r===!0)return CZ(a);if(lr.isFunction(r))return r.call(this,a,n);if(lr.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Eg(t),t){const n=lr.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||T5(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let a=!1;function s(o){if(o=Eg(o),o){const l=lr.findKey(n,o);l&&(!r||T5(n,n[l],l,r))&&(delete n[l],a=!0)}}return lr.isArray(t)?t.forEach(s):s(t),a}clear(t){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const s=r[n];(!t||T5(this,this[s],s,t,!0))&&(delete this[s],a=!0)}return a}normalize(t){const r=this,n={};return lr.forEach(this,(a,s)=>{const o=lr.findKey(n,s);if(o){r[o]=Nv(a),delete r[s];return}const l=t?TZ(s):String(s).trim();l!==s&&delete r[s],r[l]=Nv(a),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return lr.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=t&&lr.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(a=>n.set(a)),n}static accessor(t){const n=(this[g8]=this[g8]={accessors:{}}).accessors,a=this.prototype;function s(o){const l=Eg(o);n[l]||(PZ(a,o),n[l]=!0)}return lr.isArray(t)?t.forEach(s):s(t),this}};pl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);lr.reduceDescriptors(pl.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});lr.freezeMethods(pl);function P5(e,t){const r=this||z1,n=t||r,a=pl.from(n.headers);let s=n.data;return lr.forEach(e,function(l){s=l.call(r,s,a.normalize(),t?t.status:void 0)}),a.normalize(),s}function kD(e){return!!(e&&e.__CANCEL__)}function Hm(e,t,r){Dn.call(this,e??"canceled",Dn.ERR_CANCELED,t,r),this.name="CanceledError"}lr.inherits(Hm,Dn,{__CANCEL__:!0});function jD(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Dn("Request failed with status code "+r.status,[Dn.ERR_BAD_REQUEST,Dn.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function OZ(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function LZ(e,t){e=e||10;const r=new Array(e),n=new Array(e);let a=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[s];o||(o=u),r[a]=c,n[a]=u;let f=s,p=0;for(;f!==a;)p+=r[f++],f=f%e;if(a=(a+1)%e,a===s&&(s=(s+1)%e),u-o<t)return;const h=d&&u-d;return h?Math.round(p*1e3/h):void 0}}function MZ(e,t){let r=0,n=1e3/t,a,s;const o=(u,d=Date.now())=>{r=d,a=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?o(u,d):(a=u,s||(s=setTimeout(()=>{s=null,o(a)},n-f)))},()=>a&&o(a)]}const x2=(e,t,r=3)=>{let n=0;const a=LZ(50,250);return MZ(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-n,u=a(c),d=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},x8=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},y8=e=>(...t)=>lr.asap(()=>e(...t)),FZ=ko.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ko.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ko.origin),ko.navigator&&/(msie|trident)/i.test(ko.navigator.userAgent)):()=>!0,RZ=ko.hasStandardBrowserEnv?{write(e,t,r,n,a,s,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];lr.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),lr.isString(n)&&l.push(`path=${n}`),lr.isString(a)&&l.push(`domain=${a}`),s===!0&&l.push("secure"),lr.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function BZ(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function IZ(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function AD(e,t,r){let n=!BZ(t);return e&&(n||r==!1)?IZ(e,t):t}const b8=e=>e instanceof pl?{...e}:e;function d0(e,t){t=t||{};const r={};function n(u,d,f,p){return lr.isPlainObject(u)&&lr.isPlainObject(d)?lr.merge.call({caseless:p},u,d):lr.isPlainObject(d)?lr.merge({},d):lr.isArray(d)?d.slice():d}function a(u,d,f,p){if(lr.isUndefined(d)){if(!lr.isUndefined(u))return n(void 0,u,f,p)}else return n(u,d,f,p)}function s(u,d){if(!lr.isUndefined(d))return n(void 0,d)}function o(u,d){if(lr.isUndefined(d)){if(!lr.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function l(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>a(b8(u),b8(d),f,!0)};return lr.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||a,p=f(e[d],t[d],d);lr.isUndefined(p)&&f!==l||(r[d]=p)}),r}const ND=e=>{const t=d0({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=pl.from(o),t.url=wD(AD(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),lr.isFormData(r)){if(ko.hasStandardBrowserEnv||ko.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(lr.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&o.set(d,f)})}}if(ko.hasStandardBrowserEnv&&(n&&lr.isFunction(n)&&(n=n(t)),n||n!==!1&&FZ(t.url))){const c=a&&s&&RZ.read(s);c&&o.set(a,c)}return t},DZ=typeof XMLHttpRequest<"u",$Z=DZ&&function(e){return new Promise(function(r,n){const a=ND(e);let s=a.data;const o=pl.from(a.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=a,d,f,p,h,m;function g(){h&&h(),m&&m(),a.cancelToken&&a.cancelToken.unsubscribe(d),a.signal&&a.signal.removeEventListener("abort",d)}let b=new XMLHttpRequest;b.open(a.method.toUpperCase(),a.url,!0),b.timeout=a.timeout;function y(){if(!b)return;const w=pl.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),C={data:!l||l==="text"||l==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:w,config:e,request:b};jD(function(A){r(A),g()},function(A){n(A),g()},C),b=null}"onloadend"in b?b.onloadend=y:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(y)},b.onabort=function(){b&&(n(new Dn("Request aborted",Dn.ECONNABORTED,e,b)),b=null)},b.onerror=function(_){const C=_&&_.message?_.message:"Network Error",j=new Dn(C,Dn.ERR_NETWORK,e,b);j.event=_||null,n(j),b=null},b.ontimeout=function(){let _=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const C=a.transitional||SD;a.timeoutErrorMessage&&(_=a.timeoutErrorMessage),n(new Dn(_,C.clarifyTimeoutError?Dn.ETIMEDOUT:Dn.ECONNABORTED,e,b)),b=null},s===void 0&&o.setContentType(null),"setRequestHeader"in b&&lr.forEach(o.toJSON(),function(_,C){b.setRequestHeader(C,_)}),lr.isUndefined(a.withCredentials)||(b.withCredentials=!!a.withCredentials),l&&l!=="json"&&(b.responseType=a.responseType),u&&([p,m]=x2(u,!0),b.addEventListener("progress",p)),c&&b.upload&&([f,h]=x2(c),b.upload.addEventListener("progress",f),b.upload.addEventListener("loadend",h)),(a.cancelToken||a.signal)&&(d=w=>{b&&(n(!w||w.type?new Hm(null,e,b):w),b.abort(),b=null)},a.cancelToken&&a.cancelToken.subscribe(d),a.signal&&(a.signal.aborted?d():a.signal.addEventListener("abort",d)));const v=OZ(a.url);if(v&&ko.protocols.indexOf(v)===-1){n(new Dn("Unsupported protocol "+v+":",Dn.ERR_BAD_REQUEST,e));return}b.send(s||null)})},UZ=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,a;const s=function(u){if(!a){a=!0,l();const d=u instanceof Error?u:this.reason;n.abort(d instanceof Dn?d:new Hm(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,s(new Dn(`timeout ${t} of ms exceeded`,Dn.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>lr.asap(l),c}},zZ=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,a;for(;n<r;)a=n+t,yield e.slice(n,a),n=a},WZ=async function*(e,t){for await(const r of qZ(e))yield*zZ(r,t)},qZ=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},v8=(e,t,r,n)=>{const a=WZ(e,t);let s=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await a.next();if(u){l(),c.close();return}let f=d.byteLength;if(r){let p=s+=f;r(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),a.return()}},{highWaterMark:2})},w8=64*1024,{isFunction:db}=lr,HZ=(({Request:e,Response:t})=>({Request:e,Response:t}))(lr.global),{ReadableStream:S8,TextEncoder:_8}=lr.global,k8=(e,...t)=>{try{return!!e(...t)}catch{return!1}},VZ=e=>{e=lr.merge.call({skipUndefined:!0},HZ,e);const{fetch:t,Request:r,Response:n}=e,a=t?db(t):typeof fetch=="function",s=db(r),o=db(n);if(!a)return!1;const l=a&&db(S8),c=a&&(typeof _8=="function"?(m=>g=>m.encode(g))(new _8):async m=>new Uint8Array(await new r(m).arrayBuffer())),u=s&&l&&k8(()=>{let m=!1;const g=new r(ko.origin,{body:new S8,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!g}),d=o&&l&&k8(()=>lr.isReadableStream(new n("").body)),f={stream:d&&(m=>m.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!f[m]&&(f[m]=(g,b)=>{let y=g&&g[m];if(y)return y.call(g);throw new Dn(`Response type '${m}' is not supported`,Dn.ERR_NOT_SUPPORT,b)})});const p=async m=>{if(m==null)return 0;if(lr.isBlob(m))return m.size;if(lr.isSpecCompliantForm(m))return(await new r(ko.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(lr.isArrayBufferView(m)||lr.isArrayBuffer(m))return m.byteLength;if(lr.isURLSearchParams(m)&&(m=m+""),lr.isString(m))return(await c(m)).byteLength},h=async(m,g)=>{const b=lr.toFiniteNumber(m.getContentLength());return b??p(g)};return async m=>{let{url:g,method:b,data:y,signal:v,cancelToken:w,timeout:_,onDownloadProgress:C,onUploadProgress:j,responseType:A,headers:M,withCredentials:P="same-origin",fetchOptions:R}=ND(m),N=t||fetch;A=A?(A+"").toLowerCase():"text";let T=UZ([v,w&&w.toAbortSignal()],_),B=null;const G=T&&T.unsubscribe&&(()=>{T.unsubscribe()});let re;try{if(j&&u&&b!=="get"&&b!=="head"&&(re=await h(M,y))!==0){let ne=new r(g,{method:"POST",body:y,duplex:"half"}),E;if(lr.isFormData(y)&&(E=ne.headers.get("content-type"))&&M.setContentType(E),ne.body){const[Z,H]=x8(re,x2(y8(j)));y=v8(ne.body,w8,Z,H)}}lr.isString(P)||(P=P?"include":"omit");const xe=s&&"credentials"in r.prototype,_e={...R,signal:T,method:b.toUpperCase(),headers:M.normalize().toJSON(),body:y,duplex:"half",credentials:xe?P:void 0};B=s&&new r(g,_e);let V=await(s?N(B,R):N(g,_e));const K=d&&(A==="stream"||A==="response");if(d&&(C||K&&G)){const ne={};["status","statusText","headers"].forEach(F=>{ne[F]=V[F]});const E=lr.toFiniteNumber(V.headers.get("content-length")),[Z,H]=C&&x8(E,x2(y8(C),!0))||[];V=new n(v8(V.body,w8,Z,()=>{H&&H(),G&&G()}),ne)}A=A||"text";let de=await f[lr.findKey(f,A)||"text"](V,m);return!K&&G&&G(),await new Promise((ne,E)=>{jD(ne,E,{data:de,headers:pl.from(V.headers),status:V.status,statusText:V.statusText,config:m,request:B})})}catch(xe){throw G&&G(),xe&&xe.name==="TypeError"&&/Load failed|fetch/i.test(xe.message)?Object.assign(new Dn("Network Error",Dn.ERR_NETWORK,m,B),{cause:xe.cause||xe}):Dn.from(xe,xe&&xe.code,m,B)}}},GZ=new Map,CD=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:a}=t,s=[n,a,r];let o=s.length,l=o,c,u,d=GZ;for(;l--;)c=s[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:VZ(t)),d=u;return u};CD();const tN={http:uZ,xhr:$Z,fetch:{get:CD}};lr.forEach(tN,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const j8=e=>`- ${e}`,KZ=e=>lr.isFunction(e)||e===null||e===!1;function XZ(e,t){e=lr.isArray(e)?e:[e];const{length:r}=e;let n,a;const s={};for(let o=0;o<r;o++){n=e[o];let l;if(a=n,!KZ(n)&&(a=tN[(l=String(n)).toLowerCase()],a===void 0))throw new Dn(`Unknown adapter '${l}'`);if(a&&(lr.isFunction(a)||(a=a.get(t))))break;s[l||"#"+o]=a}if(!a){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(j8).join(`
`):" "+j8(o[0]):"as no adapter specified";throw new Dn("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return a}const ED={getAdapter:XZ,adapters:tN};function O5(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Hm(null,e)}function A8(e){return O5(e),e.headers=pl.from(e.headers),e.data=P5.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),ED.getAdapter(e.adapter||z1.adapter,e)(e).then(function(n){return O5(e),n.data=P5.call(e,e.transformResponse,n),n.headers=pl.from(n.headers),n},function(n){return kD(n)||(O5(e),n&&n.response&&(n.response.data=P5.call(e,e.transformResponse,n.response),n.response.headers=pl.from(n.response.headers))),Promise.reject(n)})}const TD="1.13.2",sS={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{sS[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const N8={};sS.transitional=function(t,r,n){function a(s,o){return"[Axios v"+TD+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,l)=>{if(t===!1)throw new Dn(a(o," has been removed"+(r?" in "+r:"")),Dn.ERR_DEPRECATED);return r&&!N8[o]&&(N8[o]=!0,console.warn(a(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};sS.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function YZ(e,t,r){if(typeof e!="object")throw new Dn("options must be an object",Dn.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const s=n[a],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new Dn("option "+s+" must be "+c,Dn.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Dn("Unknown option "+s,Dn.ERR_BAD_OPTION)}}const Cv={assertOptions:YZ,validators:sS},pu=Cv.validators;let Yh=class{constructor(t){this.defaults=t||{},this.interceptors={request:new m8,response:new m8}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const s=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=d0(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:s}=r;n!==void 0&&Cv.assertOptions(n,{silentJSONParsing:pu.transitional(pu.boolean),forcedJSONParsing:pu.transitional(pu.boolean),clarifyTimeoutError:pu.transitional(pu.boolean)},!1),a!=null&&(lr.isFunction(a)?r.paramsSerializer={serialize:a}:Cv.assertOptions(a,{encode:pu.function,serialize:pu.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Cv.assertOptions(r,{baseUrl:pu.spelling("baseURL"),withXsrfToken:pu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&lr.merge(s.common,s[r.method]);s&&lr.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),r.headers=pl.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,f=0,p;if(!c){const m=[A8.bind(this),void 0];for(m.unshift(...l),m.push(...u),p=m.length,d=Promise.resolve(r);f<p;)d=d.then(m[f++],m[f++]);return d}p=l.length;let h=r;for(;f<p;){const m=l[f++],g=l[f++];try{h=m(h)}catch(b){g.call(this,b);break}}try{d=A8.call(this,h)}catch(m){return Promise.reject(m)}for(f=0,p=u.length;f<p;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=d0(this.defaults,t);const r=AD(t.baseURL,t.url,t.allowAbsoluteUrls);return wD(r,t.params,t.paramsSerializer)}};lr.forEach(["delete","get","head","options"],function(t){Yh.prototype[t]=function(r,n){return this.request(d0(n||{},{method:t,url:r,data:(n||{}).data}))}});lr.forEach(["post","put","patch"],function(t){function r(n){return function(s,o,l){return this.request(d0(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}Yh.prototype[t]=r(),Yh.prototype[t+"Form"]=r(!0)});let QZ=class PD{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(a=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](a);n._listeners=null}),this.promise.then=a=>{let s;const o=new Promise(l=>{n.subscribe(l),s=l}).then(a);return o.cancel=function(){n.unsubscribe(s)},o},t(function(s,o,l){n.reason||(n.reason=new Hm(s,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new PD(function(a){t=a}),cancel:t}}};function JZ(e){return function(r){return e.apply(null,r)}}function ZZ(e){return lr.isObject(e)&&e.isAxiosError===!0}const fA={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(fA).forEach(([e,t])=>{fA[t]=e});function OD(e){const t=new Yh(e),r=cD(Yh.prototype.request,t);return lr.extend(r,Yh.prototype,t,{allOwnKeys:!0}),lr.extend(r,t,null,{allOwnKeys:!0}),r.create=function(a){return OD(d0(e,a))},r}const Si=OD(z1);Si.Axios=Yh;Si.CanceledError=Hm;Si.CancelToken=QZ;Si.isCancel=kD;Si.VERSION=TD;Si.toFormData=iS;Si.AxiosError=Dn;Si.Cancel=Si.CanceledError;Si.all=function(t){return Promise.all(t)};Si.spread=JZ;Si.isAxiosError=ZZ;Si.mergeConfig=d0;Si.AxiosHeaders=pl;Si.formToJSON=e=>_D(lr.isHTMLForm(e)?new FormData(e):e);Si.getAdapter=ED.getAdapter;Si.HttpStatusCode=fA;Si.default=Si;const{Axios:COe,AxiosError:EOe,CanceledError:TOe,isCancel:POe,CancelToken:OOe,VERSION:LOe,all:MOe,Cancel:FOe,isAxiosError:ROe,spread:BOe,toFormData:IOe,AxiosHeaders:hA,HttpStatusCode:DOe,formToJSON:$Oe,getAdapter:UOe,mergeConfig:zOe}=Si;function eee(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.zynix.us"}const LD=`${eee()}/api/accounts/`,Yc=Si.create({baseURL:LD});let L5=!1,pA=[];function tee(e){pA.push(e)}function ree(e){pA.forEach(t=>t(e)),pA=[]}async function nee(){const e=localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await Si.post(`${LD}token/refresh/`,{refresh:e}),{access:r,refresh:n}=t.data;return r&&localStorage.setItem("access",r),n&&localStorage.setItem("refresh",n),r}Yc.interceptors.response.use(e=>e,async e=>{const t=e.config;if(e.response&&e.response.status===401&&!t._retry){if(t._retry=!0,L5)return new Promise(r=>{tee(n=>{const a=t.headers??{};a.Authorization=`Bearer ${n}`,t.headers=new hA(a),r(Yc(t))})});L5=!0;try{const r=await nee();ree(r);const n=t.headers??{};return n.Authorization=`Bearer ${r}`,t.headers=new hA(n),Yc(t)}catch(r){return rN(),Promise.reject(r)}finally{L5=!1}}return Promise.reject(e)});async function MD(e,t){const r=await Yc.post("token/",{identifier:e,password:t}),{access:n,refresh:a}=r.data;localStorage.setItem("access",n),localStorage.setItem("refresh",a);try{await W1()}catch{}return r.data}function rN(){localStorage.removeItem("access"),localStorage.removeItem("refresh"),localStorage.removeItem("roles"),localStorage.removeItem("permissions")}Yc.interceptors.request.use(e=>{const t=localStorage.getItem("access");if(t){const r=e.headers??{};r.Authorization=`Bearer ${t}`,e.headers=new hA(r)}return e});async function W1(){if(!localStorage.getItem("access"))throw new Error("no access token");const r=(await Yc.get("me/")).data;try{localStorage.setItem("roles",JSON.stringify(r.roles||[])),localStorage.setItem("permissions",JSON.stringify(r.permissions||[]))}catch{}return r}const aee=Object.freeze(Object.defineProperty({__proto__:null,apiClient:Yc,getMe:W1,login:MD,logout:rN},Symbol.toStringTag,{value:"Module"})),iee="/assets/idcs-logo-Ci6ccowJ.png";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FD=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const see=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oee=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C8=e=>{const t=oee(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lee={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cee=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uee=x.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:o,...l},c)=>x.createElement("svg",{ref:c,...lee,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:FD("lucide",a),...!s&&!cee(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,d])=>x.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nn=(e,t)=>{const r=x.forwardRef(({className:n,...a},s)=>x.createElement(uee,{ref:s,iconNode:t,className:FD(`lucide-${see(C8(e))}`,`lucide-${e}`,n),...a}));return r.displayName=C8(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dee=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],fee=Nn("bell",dee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hee=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],ls=Nn("book-open",hee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pee=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],mee=Nn("briefcase",pee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gee=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],xee=Nn("building",gee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yee=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],mA=Nn("calendar-clock",yee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],cs=Nn("calendar",bee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vee=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],wee=Nn("check",vee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const See=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],_ee=Nn("chevron-down",See);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],$u=Nn("circle-alert",kee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jee=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],RD=Nn("circle-check-big",jee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],zh=Nn("circle-check",Aee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nee=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Cee=Nn("circle-user-round",Nee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],BD=Nn("circle-x",Eee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tee=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],y2=Nn("clipboard-list",Tee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pee=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],tu=Nn("clock",Pee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oee=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],gA=Nn("download",Oee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lee=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Mee=Nn("eye-off",Lee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fee=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ID=Nn("eye",Fee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ree=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Bee=Nn("file-spreadsheet",Ree);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iee=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Dee=Nn("file-text",Iee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ee=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Uee=Nn("funnel",$ee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zee=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],q1=Nn("graduation-cap",zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wee=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],xA=Nn("grid-3x3",Wee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qee=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],b2=Nn("house",qee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hee=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Lu=Nn("loader-circle",Hee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vee=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],Gee=Nn("lock-open",Vee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kee=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Qh=Nn("lock",Kee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xee=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],Yee=Nn("log-in",Xee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qee=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Jee=Nn("log-out",Qee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zee=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],nN=Nn("mail",Zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ete=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],tte=Nn("menu",ete);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rte=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],E8=Nn("panels-top-left",rte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nte=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Xx=Nn("plus",nte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ate=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],yA=Nn("refresh-cw",ate);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ite=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Od=Nn("save",ite);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ste=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],ote=Nn("school",ste);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lte=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],cte=Nn("shield",lte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ute=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Jf=Nn("square-pen",ute);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dte=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Yx=Nn("trash-2",dte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fte=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],hte=Nn("trending-up",fte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pte=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],v2=Nn("upload",pte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mte=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ev=Nn("user-check",mte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],xte=Nn("user-plus",gte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],bte=Nn("user-x",yte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vte=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],F0=Nn("user",vte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],us=Nn("users",wte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ste=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],zu=Nn("x",Ste);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _te=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],kte=Nn("zoom-in",_te);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jte=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Ate=Nn("zoom-out",jte),DD=x.createContext(void 0);function Nte({children:e}){const[t,r]=x.useState(()=>typeof window<"u"?window.innerWidth<1024:!0),n=()=>r(a=>!a);return i.jsx(DD.Provider,{value:{collapsed:t,toggle:n,setCollapsed:r},children:e})}function aN(){const e=x.useContext(DD);if(!e)throw new Error("useSidebar must be used within SidebarProvider");return e}function $D({user:e}){const t=so(),n=Xo().pathname==="/login",{collapsed:a,toggle:s}=aN(),o=()=>{rN(),t("/login")};return i.jsx("nav",{className:"bg-white shadow-md border-b border-gray-200 fixed top-0 left-0 right-0 z-40 overflow-x-hidden",children:i.jsx("div",{className:"px-4 max-w-full",children:i.jsxs("div",{className:"flex items-center justify-between h-16",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("button",{className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:s,"aria-label":"Toggle sidebar",children:a?i.jsx(tte,{className:"h-6 w-6"}):i.jsx(zu,{className:"h-6 w-6"})}),i.jsx(Vi,{to:"/dashboard",className:"flex items-center gap-3 group",children:i.jsx("img",{src:iee,alt:"IDCS Logo",className:"h-12 w-12 object-contain transition-transform duration-200 group-hover:scale-110",onError:l=>{l.currentTarget.style.display="none"}})})]}),i.jsx("div",{className:"flex items-center gap-3",children:e?i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"hidden sm:block",children:i.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 rounded-lg",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-white font-semibold text-sm",children:e.username.charAt(0).toUpperCase()})}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.username})]})}),i.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg font-medium transition-colors",children:[i.jsx(Jee,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]}):n?i.jsxs(Vi,{to:"/",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[i.jsx(b2,{className:"h-4 w-4"}),i.jsx("span",{children:"Home"})]}):i.jsxs(Vi,{to:"/login",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[i.jsx(Yee,{className:"h-4 w-4"}),i.jsx("span",{children:"Login"})]})})]})})})}const Cte="https://db.zynix.us";let M5=!1,Tg=null;async function Ete(){return M5&&Tg||(M5=!0,Tg=(async()=>{try{const e=window.localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await fetch(`${Cte}/api/accounts/token/refresh/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})});if(!t.ok)throw window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh"),new Error("refresh failed");const r=await t.json();return r.access&&window.localStorage.setItem("access",r.access),r.refresh&&window.localStorage.setItem("refresh",r.refresh),r.access}finally{M5=!1,Tg=null}})()),Tg}async function mr(e,t={},r=!0){const n=window.localStorage.getItem("access"),a=t.body instanceof FormData,s=Object.assign({},t.headers||{});a||(s["Content-Type"]="application/json"),n?s.Authorization=`Bearer ${n}`:console.warn("No access token found in localStorage");let o=e;try{typeof e=="string"&&e.startsWith("/api")&&(o=`https://db.zynix.us${e}`)}catch{}const l=await fetch(o,{...t,headers:s});if(l.status===400){const c=await l.text();console.error("400 Bad Request:",{url:o,token:n,response:c})}if(l.status===401||l.status===403){let c="";try{c=await l.text()}catch{}const u={};try{l.headers.forEach((d,f)=>{u[f]=d})}catch{}console.error("Auth error from fetchWithAuth",{url:String(o),status:l.status,requestHeaders:s,responseHeaders:u,token:n,responseText:c})}if(l.status!==401||!r)return l;try{const c=await Ete(),u=Object.assign({},t.headers||{});return a||(u["Content-Type"]="application/json"),u.Authorization=`Bearer ${c}`,fetch(o,{...t,headers:u})}catch(c){try{window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh")}catch{}console.error("Token refresh failed:",c);try{typeof window<"u"&&setTimeout(()=>{try{window.location.href="/login"}catch{}},50)}catch{}return l}}async function Tte(e=""){const r=e?`${e}/api/accounts/dashboard/`:"https://db.zynix.us/api/accounts/dashboard/",n=await mr(r,{method:"GET"});if(!n.ok){const a=await n.text();throw new Error(`Dashboard fetch failed: ${n.status} ${a}`)}return n.json()}function Pte(e=""){const[t,r]=x.useState(null),[n,a]=x.useState(!0),[s,o]=x.useState(null),l=x.useCallback(async()=>{a(!0),o(null);try{const c=await Tte(e);r(c)}catch(c){o(c)}finally{a(!1)}},[e]);return x.useEffect(()=>{l()},[l]),{data:t,loading:n,error:s,refresh:l}}const Ote="modulepreload",Lte=function(e){return"/"+e},T8={},am=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));a=Promise.allSettled(r.map(c=>{if(c=Lte(c),c in T8)return;T8[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":Ote,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((p,h)=>{f.addEventListener("load",p),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};async function jc(){var t;const e=`${rn()}/api/academics/my-teaching-assignments/`;try{return(await Yc.get(e)).data}catch(r){if(((t=r==null?void 0:r.response)==null?void 0:t.status)===401)return[];throw r}}function rn(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.zynix.us"}function Bn(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}async function iN(e,t,r){const n=`${rn()}/api/obe/iqac/reset/${encodeURIComponent(String(e))}/${encodeURIComponent(String(t))}`;return(await Yc.post(n,{teaching_assignment_id:r})).data}async function UD(e){var a;const t=`${rn()}/api/obe/iqac/reset-notifications`,r=e?{teaching_assignment_id:e}:{};return((a=(await Yc.get(t,{params:r})).data)==null?void 0:a.notifications)||[]}async function zD(e){const t=`${rn()}/api/obe/iqac/reset-notifications/dismiss`;return(await Yc.post(t,{notification_ids:e})).data}async function Mte(){try{const e=rn(),t=localStorage.getItem("refresh");if(!t)return null;const r=await Si.post(`${e}/api/accounts/token/refresh/`,{refresh:t}),{access:n,refresh:a}=r.data||{};return n&&localStorage.setItem("access",n),a&&localStorage.setItem("refresh",a),n||null}catch{try{(await am(()=>Promise.resolve().then(()=>aee),void 0)).logout()}catch{}return null}}async function Ii(e,t){const r={"Content-Type":"application/json",...(t==null?void 0:t.headers)||{},...Bn()},n={...t||{},headers:r};let a=await fetch(e,n);if(a.status!==401)return a;const s=await Mte();if(!s)return a;const o={...n.headers,Authorization:`Bearer ${s}`},l={...n,headers:o};return a=await fetch(e,l),a}async function oS(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await Ii(a,{method:"GET"});return s.status===401?{assessment:e,subject_code:String(t),teaching_assignment_id:typeof r=="number"?r:null,academic_year:null,section_name:null,exists:!1,is_published:!1,published_blocked:!1,mark_entry_blocked:!1,mark_manager_locked:!1,mark_entry_unblocked_until:null,mark_manager_unlocked_until:null,entry_open:!1,mark_manager_editable:!0,updated_at:null}:(s.ok||await un(s,"Mark table lock fetch failed"),s.json())}async function Fte(e){const t=await im(e);return Array.isArray(t==null?void 0:t.enabled_assessments)?t.enabled_assessments.map(r=>String(r).trim().toLowerCase()).filter(Boolean):[]}async function im(e){const t=`${rn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,r=await Ii(t,{method:"GET"});if(r.status===401||r.status===404)return{enabled_assessments:[],meta:{locked:!1,can_edit:!1}};r.ok||await un(r,"Failed to fetch enabled assessments");const n=await r.json();return{enabled_assessments:Array.isArray(n==null?void 0:n.enabled_assessments)?n.enabled_assessments.map(a=>String(a).trim().toLowerCase()).filter(Boolean):[],meta:(n==null?void 0:n.meta)||void 0}}async function Rte(e,t){const r=`${rn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await Ii(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await un(n,"Failed to save enabled assessments");const a=await n.json();return Array.isArray(a==null?void 0:a.enabled_assessments)?a.enabled_assessments:[]}async function WD(e,t){const r=`${rn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await Ii(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await un(n,"Failed to save enabled assessments");const a=await n.json();return{enabled_assessments:Array.isArray(a==null?void 0:a.enabled_assessments)?a.enabled_assessments:[],meta:(a==null?void 0:a.meta)||void 0}}async function qD(e){const t=`${rn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/request-edit/`,r=await Ii(t,{method:"POST",body:JSON.stringify({})});if(r.status===401)throw new Error("Authentication required");return r.ok||await un(r,"Failed to request edit approval"),r.json()}async function lS(e,t){const r=t?`?academic_year_id=${encodeURIComponent(String(t))}`:"",n=`${rn()}/api/academics/special-courses/${encodeURIComponent(String(e))}/enabled_assessments/${r}`,a=await Ii(n,{method:"GET"});if(a.status===401)throw new Error("Authentication required");a.ok||await un(a,"Failed to fetch enabled assessments");const s=await a.json();return(Array.isArray(s==null?void 0:s.enabled_assessments)?s.enabled_assessments:[]).map(l=>String(l).trim().toLowerCase()).filter(Boolean)}async function Zf(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}/confirm-mark-manager${n}`,s=await Ii(a,{method:"POST",body:JSON.stringify({})});if(s.status===401)throw new Error("Authentication required");return s.ok||await un(s,"Mark Manager confirm failed"),s.json()}async function sN(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/publish-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return s.status===401?{assessment:e,subject_code:String(t),publish_allowed:!1,allowed_by_due:!1,allowed_by_approval:!1,global_override_active:!1,global_is_open:null,allowed_by_global:null,due_at:null,now:null,remaining_seconds:null,approval_until:null,academic_year:null,teaching_assignment_id:typeof r=="number"?r:null}:(s.ok||await un(s,"Publish window fetch failed"),s.json())}async function Qx(e,t,r,n){const a=[`scope=${encodeURIComponent(String(r))}`];n&&a.push(`teaching_assignment_id=${encodeURIComponent(String(n))}`);const s=a.length?`?${a.join("&")}`:"",o=`${rn()}/api/obe/edit-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${s}`,l=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return l.status===401?{assessment:e,subject_code:String(t),scope:r,allowed_by_approval:!1,approval_until:null,now:null,academic_year:null,teaching_assignment_id:typeof n=="number"?n:null}:(l.ok||await un(l,"Edit window fetch failed"),l.json())}async function tx(e,t){const r=[];e!=null&&e.length&&r.push(`semester_ids=${encodeURIComponent(e.join(","))}`),t!=null&&t.length&&r.push(`assessments=${encodeURIComponent(t.join(","))}`);const n=r.length?`?${r.join("&")}`:"",a=`${rn()}/api/obe/global-publish-controls${n}`,s=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return s.ok||await un(s,"Global publish controls fetch failed"),s.json()}async function bA(e){const t=`${rn()}/api/obe/global-publish-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify(e)});return r.ok||await un(r,"Bulk set global publish controls failed"),r.json()}async function HD(e){const t=`${rn()}/api/obe/global-publish-controls/bulk-reset`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify(e)});return r.ok||await un(r,"Bulk reset global publish controls failed"),r.json()}async function VD(){const e=`${rn()}/api/obe/semesters`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return t.ok||await un(t,"Semesters fetch failed"),t.json()}async function Tv(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${rn()}/api/obe/assessment-controls${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});if(!n.ok){if(n.status===404)throw new Error(`Assessment controls endpoint not found (404).

URL requested:
${r}

This usually means your frontend is calling an older backend that does not include /api/obe/assessment-controls.
- Deploy/restart the updated backend OR
- Set VITE_API_BASE to the backend instance that has the new endpoints.`);await un(n,"Assessment controls fetch failed")}return n.json()}async function vA(e){const t=`${rn()}/api/obe/assessment-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify(e)});if(!r.ok){if(r.status===404)throw new Error(`Assessment controls bulk-set endpoint not found (404).

URL requested:
${t}

Your backend is missing /api/obe/assessment-controls/bulk-set. Deploy/restart the updated backend or point VITE_API_BASE to the correct server.`);await un(r,"Bulk set assessment controls failed")}return r.json()}async function GD(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${rn()}/api/obe/due-schedules${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return n.ok||await un(n,"Due schedules fetch failed"),n.json()}async function KD(e){const t=`?semester_ids=${encodeURIComponent(e.join(","))}`,r=`${rn()}/api/obe/due-schedule-subjects${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return n.ok||await un(n,"Due schedule subjects fetch failed"),n.json()}async function Bte(e){const t=`${rn()}/api/obe/due-schedule-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify(e)});return r.ok||await un(r,"Due schedule save failed"),r.json()}async function XD(e){const t=`${rn()}/api/obe/due-schedule-bulk-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify(e)});return r.ok||await un(r,"Due schedule bulk save failed"),r.json()}async function YD(e){const t=`${rn()}/api/obe/due-schedule-bulk-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify(e)});return r.ok||await un(r,"Due schedule bulk delete failed"),r.json()}function QD(e){if(Array.isArray(e))return{marks:e.map(r=>Number(r)).filter(r=>Number.isFinite(r))};if(e&&typeof e=="object"){const r=(Array.isArray(e.marks)?e.marks:[]).map(o=>Number(o)).filter(o=>Number.isFinite(o)),n=Array.isArray(e.cos)?e.cos:void 0,a=n?n.map(o=>{if(typeof o=="string")return o;const l=Number(o);return Number.isFinite(l)?l:""}):void 0,s={marks:r};return a&&(s.cos=a.filter(o=>o!=="")),s}return{marks:[]}}async function Gf(e){const t=[];t.push(`class_type=${encodeURIComponent(String(e.class_type||"").trim())}`),e.question_paper_type&&t.push(`question_paper_type=${encodeURIComponent(String(e.question_paper_type||"").trim())}`),t.push(`exam=${encodeURIComponent(String(e.exam||"").trim())}`);const r=t.length?`?${t.join("&")}`:"",n=`${rn()}/api/obe/iqac/qp-pattern${r}`,a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});a.ok||await un(a,"QP pattern fetch failed");const s=await a.json(),o=QD(s==null?void 0:s.pattern);return{class_type:String((s==null?void 0:s.class_type)||""),question_paper_type:(s==null?void 0:s.question_paper_type)==null?null:String(s.question_paper_type),exam:(()=>{const l=String((s==null?void 0:s.exam)||"CIA").trim().toUpperCase();return l==="MODEL"?"MODEL":l==="CIA1"?"CIA1":l==="CIA2"?"CIA2":"CIA"})(),pattern:o,updated_at:(s==null?void 0:s.updated_at)??null,updated_by:typeof(s==null?void 0:s.updated_by)=="number"?s.updated_by:null}}async function JD(e){var o,l;const t=`${rn()}/api/obe/iqac/qp-pattern/save`,r={class_type:String(e.class_type||"").trim(),question_paper_type:e.question_paper_type?String(e.question_paper_type||"").trim():null,exam:e.exam,pattern:{marks:Array.isArray((o=e.pattern)==null?void 0:o.marks)?e.pattern.marks:[],cos:Array.isArray((l=e.pattern)==null?void 0:l.cos)?e.pattern.cos:void 0}},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify(r)});n.ok||await un(n,"QP pattern save failed");const a=await n.json(),s=QD(a==null?void 0:a.pattern);return{class_type:String((a==null?void 0:a.class_type)||""),question_paper_type:(a==null?void 0:a.question_paper_type)==null?null:String(a.question_paper_type),exam:(()=>{const c=String((a==null?void 0:a.exam)||"CIA").trim().toUpperCase();return c==="MODEL"?"MODEL":c==="CIA1"?"CIA1":c==="CIA2"?"CIA2":"CIA"})(),pattern:s,updated_at:(a==null?void 0:a.updated_at)??null,updated_by:typeof(a==null?void 0:a.updated_by)=="number"?a.updated_by:null}}async function cS(){const e=`${rn()}/api/obe/iqac/cqi-config`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});t.ok||await un(t,"CQI config fetch failed");const r=await t.json();return{options:Array.isArray(r==null?void 0:r.options)?r.options:[],divider:Number.isFinite(Number(r==null?void 0:r.divider))?Number(r==null?void 0:r.divider):2,multiplier:Number.isFinite(Number(r==null?void 0:r.multiplier))?Number(r==null?void 0:r.multiplier):.15,updated_at:(r==null?void 0:r.updated_at)??null,updated_by:typeof(r==null?void 0:r.updated_by)=="number"?r.updated_by:null}}async function ZD(e){const t=`${rn()}/api/obe/iqac/cqi-config/save`,r={options:Array.isArray(e.options)?e.options:[],divider:Number.isFinite(Number(e.divider))?Number(e.divider):2,multiplier:Number.isFinite(Number(e.multiplier))?Number(e.multiplier):.15},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify(r)});return n.ok||await un(n,"CQI config save failed"),n.json()}async function Ite(e){const t=`${rn()}/api/obe/due-schedule-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify(e)});return r.ok||await un(r,"Due schedule delete failed"),r.json()}async function R0(e){const t=`${rn()}/api/obe/publish-request`,r=await Ii(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await un(r,"Publish request failed"),r.json()}async function qo(e){const t=`${rn()}/api/obe/edit-request`,r=await Ii(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await un(r,"Edit request failed"),r.json()}async function Jx(e){const t=[];t.push(`assessment=${encodeURIComponent(String(e.assessment))}`),t.push(`subject_code=${encodeURIComponent(String(e.subject_code))}`),t.push(`scope=${encodeURIComponent(String(e.scope))}`),typeof e.teaching_assignment_id=="number"&&t.push(`teaching_assignment_id=${encodeURIComponent(String(e.teaching_assignment_id))}`);const r=t.length?`?${t.join("&")}`:"",n=`${rn()}/api/obe/edit-requests/my-latest${r}`,a=await Ii(n,{method:"GET"});return a.status===401?{result:null}:(a.ok||await un(a,"My edit request status fetch failed"),a.json())}async function e9(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${rn()}/api/obe/edit-requests/pending${t}`,n=await Ii(r,{method:"GET"});return n.status===401?{results:[]}:(n.ok||await un(n,"Pending edit requests fetch failed"),n.json())}async function t9(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`),e!=null&&e.scope&&n.push(`scope=${encodeURIComponent(e.scope)}`);const a=n.length?`?${n.join("&")}`:"",s=`${rn()}/api/obe/edit-requests/history${a}`,o=await Ii(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await un(o,"Edit requests history fetch failed"),o.json())}async function uS(){const e=`${rn()}/api/obe/iqac/class-type-weights`,t=await Ii(e,{method:"GET"});if(t.status===401)throw new Error("Authentication required to fetch class-type weights");t.ok||await un(t,"Fetch class-type weights failed");const r=await t.json();return(r==null?void 0:r.results)||{}}async function r9(e){const t=`${rn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}`,r=await Ii(t,{method:"GET"});if(r.status===401)throw new Error("Authentication required");return r.ok||await un(r,"Failed to fetch internal mark mapping"),r.json()}async function n9(e,t){const r=`${rn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}/save`,n=await Ii(r,{method:"POST",body:JSON.stringify({mapping:t})});if(n.status===401)throw new Error("Authentication required");return n.ok||await un(n,"Failed to save internal mark mapping"),n.json()}async function Dte(e){const t=`${rn()}/api/obe/iqac/class-type-weights/save`,r=await Ii(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");r.ok||await un(r,"Save class-type weights failed");const n=await r.json();return(n==null?void 0:n.results)||{}}async function $te(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${rn()}/api/obe/edit-requests/pending-count${t}`,n=await Ii(r,{method:"GET"});return n.status===401?{pending:0}:(n.ok||await un(n,"Pending edit requests count fetch failed"),n.json())}async function a9(e,t=120){const r=`${rn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({window_minutes:t})});return n.ok||await un(n,"Approve edit request failed"),n.json()}async function i9(e){const t=`${rn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()}});return r.ok||await un(r,"Reject edit request failed"),r.json()}async function Ute(){const e=`${rn()}/api/obe/publish-requests/pending`,t=await Ii(e,{method:"GET"});return t.status===401?{results:[]}:(t.ok||await un(t,"Pending requests fetch failed"),t.json())}async function zte(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`);const a=n.length?`?${n.join("&")}`:"",s=`${rn()}/api/obe/publish-requests/history${a}`,o=await Ii(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await un(o,"History requests fetch failed"),o.json())}async function wA(){const e=`${rn()}/api/obe/publish-requests/pending-count`,t=await Ii(e,{method:"GET"});return t.status===401?{pending:0}:(t.ok||await un(t,"Pending requests count fetch failed"),t.json())}async function Wte(e,t=120){const r=`${rn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({window_minutes:t})});return n.ok||await un(n,"Approve request failed"),n.json()}async function qte(e){const t=`${rn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...Bn()}});return r.ok||await un(r,"Reject request failed"),r.json()}async function un(e,t){const r=await e.text();try{const n=String(r??"").replace(/^\uFEFF/,"").trim(),a=JSON.parse(n),s=(a==null?void 0:a.detail)||t,o=Array.isArray(a==null?void 0:a.how_to_fix)?`
How to fix:
- ${a.how_to_fix.join(`
- `)}`:"",l=Array.isArray(a==null?void 0:a.errors)?`
Errors:
- ${a.errors.join(`
- `)}`:"",c=new Error(`${s}${o}${l}`);throw c.status=e.status,c.body=a,c}catch{const n=new Error(`${t}: ${e.status} ${r}`);throw n.status=e.status,n.bodyText=r,n}}async function Mn(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await Ii(a,{method:"GET"});return s.status===401?{subject:{code:String(t),name:""},draft:null,updated_at:null,updated_by:null}:(s.ok||await un(s,"Draft fetch failed"),s.json())}async function li(e,t,r){const n=`${rn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}`,a=await Ii(n,{method:"PUT",body:JSON.stringify({data:r})});if(a.status===401)throw new Error("Authentication required");return a.ok||await un(a,"Draft save failed"),a.json()}async function Vm(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${rn()}/api/obe/ssa1-published/${encodeURIComponent(e)}${r}`,a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return a.ok||await un(a,"SSA1 published fetch failed"),a.json()}async function s9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/ssa1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:t})});return s.ok||await un(s,"SSA1 publish failed"),s.json()}async function dS(e){const t=`${rn()}/api/obe/review1-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return r.ok||await un(r,"Review 1 published fetch failed"),r.json()}async function o9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/review1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:t})});return s.ok||await un(s,"Review 1 publish failed"),s.json()}async function H1(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${rn()}/api/obe/ssa2-published/${encodeURIComponent(e)}${r}`,a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return a.ok||await un(a,"SSA2 published fetch failed"),a.json()}async function l9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/ssa2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:t})});return s.ok||await un(s,"SSA2 publish failed"),s.json()}async function fS(e){const t=`${rn()}/api/obe/review2-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return r.ok||await un(r,"Review 2 published fetch failed"),r.json()}async function c9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/review2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:t})});return s.ok||await un(s,"Review 2 publish failed"),s.json()}async function hS(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${rn()}/api/obe/formative1-published/${encodeURIComponent(e)}${r}`,a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return a.ok||await un(a,"Formative1 published fetch failed"),a.json()}async function Hte(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/formative1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:t})});return s.ok||await un(s,"Formative1 publish failed"),s.json()}async function f0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/${encodeURIComponent(e)}-published/${encodeURIComponent(t)}${n}`,s=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return s.ok||await un(s,`${e} published fetch failed`),s.json()}async function u9(e,t,r,n){const a=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${rn()}/api/obe/${encodeURIComponent(e)}-publish/${encodeURIComponent(t)}${a}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:r})});return o.ok||await un(o,`${e} publish failed`),o.json()}async function no(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/lab-published-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return s.ok||await un(s,"Lab published sheet fetch failed"),s.json()}async function oN(e,t,r,n){const a=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${rn()}/api/obe/lab-publish-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${a}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:r})});return o.ok||await un(o,"Lab publish failed"),o.json()}async function V1(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${rn()}/api/obe/cia1-published-sheet/${encodeURIComponent(e)}${r}`,a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return a.ok||await un(a,"CIA1 published sheet fetch failed"),a.json()}async function Vte(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/cia1-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:t})});return s.ok||await un(s,"CIA1 publish failed"),s.json()}async function Am(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${rn()}/api/obe/model-published-sheet/${encodeURIComponent(e)}${r}`;try{const a=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});if(a.ok)return a.json();if(a.status===404){const s=await no("model",e,t);return{subject:s.subject,data:s.data}}await un(a,"MODEL published sheet fetch failed")}catch(a){throw a}}async function d9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/model-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:t})});return s.ok||await un(s,"MODEL publish failed"),s.json()}async function h0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${rn()}/api/obe/${encodeURIComponent(e)}-published-sheet/${encodeURIComponent(t)}${n}`,s=await fetch(a,{method:"GET",headers:{"Content-Type":"application/json",...Bn()}});return s.ok||await un(s,`${e} published sheet fetch failed`),s.json()}async function f9(e,t,r,n){const a=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${rn()}/api/obe/${encodeURIComponent(e)}-publish-sheet/${encodeURIComponent(t)}${a}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...Bn()},body:JSON.stringify({data:r})});return o.ok||await un(o,`${e} publish failed`),o.json()}async function h9(e,t,r){const n=(c,u=1200)=>{const d=String(c||""),h=d.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||d.replace(/\s+/g," ").trim();return h.length<=u?h:h.slice(0,u)+" (truncated)"},a=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",s=`${rn()}/api/obe/${encodeURIComponent(e)}-marks/${encodeURIComponent(t)}${a}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}}});if(!l.ok){const c=await l.text();try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`${e.toUpperCase()} roster fetch failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"";throw new Error(`${d}${f}`)}catch{const u=n(c);throw new Error(`${e.toUpperCase()} roster fetch failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}}return l.json()}async function Gte(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},a=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.zynix.us",s=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",o=`${a}/api/obe/cia1-marks/${encodeURIComponent(e)}${s}`,l=window.localStorage.getItem("access"),c=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}}});if(!c.ok){const u=await c.text();try{const d=JSON.parse(u),f=(d==null?void 0:d.detail)||`CIA1 roster fetch failed: ${c.status}`,p=Array.isArray(d==null?void 0:d.how_to_fix)?`
How to fix:
- ${d.how_to_fix.join(`
- `)}`:"";throw new Error(`${f}${p}`)}catch{const d=r(u);throw new Error(`CIA1 roster fetch failed: ${c.status}
${d||"Server returned a non-JSON error response."}`)}}return c.json()}async function Kte(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},s=`${typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.zynix.us"}/api/obe/cia1-marks/${encodeURIComponent(e)}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}},body:JSON.stringify({marks:t})}),c=await l.text();if(!l.ok)try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`CIA1 save failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"",p=Array.isArray(u==null?void 0:u.errors)?`
Errors:
- ${u.errors.join(`
- `)}`:"";throw new Error(`${d}${f}${p}`)}catch{const u=r(c);throw new Error(`CIA1 save failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}return JSON.parse(c)}const P8=Object.freeze(Object.defineProperty({__proto__:null,approveEditRequest:a9,approvePublishRequest:Wte,bulkDeleteDueSchedule:YD,bulkResetGlobalPublishControls:HD,bulkSetAssessmentControls:vA,bulkSetGlobalPublishControls:bA,bulkUpsertDueSchedule:XD,confirmMarkManagerLock:Zf,createEditRequest:qo,createPublishRequest:R0,deleteDueSchedule:Ite,dismissResetNotifications:zD,fetchAssessmentControls:Tv,fetchCia1Marks:Gte,fetchCiaMarks:h9,fetchClassTypeWeights:uS,fetchDraft:Mn,fetchDueScheduleSubjects:KD,fetchDueSchedules:GD,fetchEditRequestsHistory:t9,fetchEditWindow:Qx,fetchGlobalPublishControls:tx,fetchInternalMarkMapping:r9,fetchIqacCqiConfig:cS,fetchIqacQpPattern:Gf,fetchMarkTableLockStatus:oS,fetchMyLatestEditRequest:Jx,fetchMyTeachingAssignments:jc,fetchObeSemesters:VD,fetchPendingEditRequestCount:$te,fetchPendingEditRequests:e9,fetchPendingPublishRequestCount:wA,fetchPendingPublishRequests:Ute,fetchPublishRequestsHistory:zte,fetchPublishWindow:sN,fetchPublishedCia1Sheet:V1,fetchPublishedCiaSheet:h0,fetchPublishedFormative:f0,fetchPublishedFormative1:hS,fetchPublishedLabSheet:no,fetchPublishedModelSheet:Am,fetchPublishedReview1:dS,fetchPublishedReview2:fS,fetchPublishedSsa1:Vm,fetchPublishedSsa2:H1,fetchResetNotifications:UD,fetchSpecialCourseEnabledAssessments:lS,fetchTeachingAssignmentEnabledAssessments:Fte,fetchTeachingAssignmentEnabledAssessmentsInfo:im,iqacResetAssessment:iN,publishCia1Sheet:Vte,publishCiaSheet:f9,publishFormative:u9,publishFormative1:Hte,publishLabSheet:oN,publishModelSheet:d9,publishReview1:o9,publishReview2:c9,publishSsa1:s9,publishSsa2:l9,rejectEditRequest:i9,rejectPublishRequest:qte,requestTeachingAssignmentEnabledAssessmentsEdit:qD,saveCia1Marks:Kte,saveDraft:li,setTeachingAssignmentEnabledAssessments:Rte,setTeachingAssignmentEnabledAssessmentsInfo:WD,upsertClassTypeWeights:Dte,upsertDueSchedule:Bte,upsertInternalMarkMapping:n9,upsertIqacCqiConfig:ZD,upsertIqacQpPattern:JD},Symbol.toStringTag,{value:"Module"})),Xte={profile:F0,curriculum_master:ls,assigned_subjects:ls,department_curriculum:E8,elective_import:v2,student_curriculum_view:xA,home:b2,hod_advisors:us,hod_teaching:ls,advisor_students:q1,mentor_assign:us,timetable_templates:cs,timetable_assignments:cs,student_timetable:cs,staff_timetable:cs,student_attendance:y2,my_mentees:us,period_attendance:y2,obe:ls,obe_master:ls,obe_due_dates:mA,obe_requests:fee,academic_controller:E8};function Yte({baseUrl:e=""}){const{data:t,loading:r,error:n}=Pte(e),a=Xo(),{collapsed:s,toggle:o}=aN(),[l,c]=x.useState(0),[u,d]=x.useState({}),p=((t==null?void 0:t.permissions)||[]).map(_=>String(_||"").toLowerCase()).includes("obe.master.manage");if(x.useEffect(()=>{let _=!0;const C=window.localStorage.getItem("access");if(!p||!C)return c(0),()=>{_=!1};(async()=>{try{const A=await wA();if(!_)return;c(Number(A.pending||0))}catch{}})();const j=window.setInterval(()=>{(async()=>{try{const A=await wA();if(!_)return;c(Number(A.pending||0))}catch{}})()},3e4);return()=>{_=!1,window.clearInterval(j)}},[p]),x.useEffect(()=>{a.pathname.startsWith("/academic")&&d(_=>({..._,academic:!0}))},[a.pathname]),x.useEffect(()=>{a.pathname.startsWith("/iqac/academic-controller")&&d(_=>({..._,academic_controller:!0}))},[a.pathname]),r)return i.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:i.jsx("div",{className:"p-6 flex items-center justify-center h-full",children:i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(n)return i.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:i.jsx("div",{className:"p-6 text-red-600 text-sm",children:"Error loading sidebar"})});if(!t)return null;const h=t.entry_points||{},m=[],g=(t.permissions||[]).map(_=>(_||"").toString().toLowerCase()),b=(t.roles||[]).map(_=>(_||"").toString().toUpperCase()),y=t.flags||{},v=b.includes("IQAC");return h.curriculum_master&&(g.some(_=>_.includes("curriculum"))||h.curriculum_master)&&m.push({key:"curriculum_master",label:"Curriculum Master",to:"/curriculum/master"}),h.department_curriculum&&(g.some(_=>_.includes("curriculum"))||h.department_curriculum)&&m.push({key:"department_curriculum",label:"Department Curriculum",to:"/curriculum/department"}),g.includes("curriculum.import_elective_choices")&&m.push({key:"elective_import",label:"Elective Import",to:"/curriculum/elective-import"}),h.hod_advisors&&(b.includes("HOD")||g.includes("academics.assign_advisor"))&&m.push({key:"hod_advisors",label:"Advisor Assign",to:"/hod/advisors"}),h.hod_teaching&&(b.includes("ADVISOR")||g.includes("academics.assign_teaching"))&&m.push({key:"hod_teaching",label:"Teaching Assign",to:"/advisor/teaching"}),h.advisor_students&&(b.includes("ADVISOR")||g.includes("academics.view_my_students"))&&m.push({key:"advisor_students",label:"My Students",to:"/advisor/students"}),(b.includes("ADVISOR")||g.includes("academics.assign_mentor"))&&m.push({key:"mentor_assign",label:"Mentor Assign",to:"/advisor/mentor"}),h.student_curriculum_view&&g.some(_=>_.includes("curriculum"))&&m.push({key:"student_curriculum_view",label:"My Curriculum",to:"/curriculum/student"}),(y.can_manage_timetable_templates||g.includes("timetable.manage_templates"))&&h.timetable_templates&&m.push({key:"timetable_templates",label:"IQAC: Timetable Templates",to:"/iqac/timetable"}),(!!y.can_assign_timetable||g.includes("timetable.assign")||b.includes("ADVISOR"))&&h.timetable_assignments&&m.push({key:"timetable_assignments",label:"Timetable Assignments",to:"/advisor/timetable"}),y.can_view_timetable&&y.is_student&&g.includes("timetable.view")&&m.push({key:"student_timetable",label:"My Timetable",to:"/student/timetable"}),y.can_view_timetable&&y.is_staff&&g.includes("timetable.view")&&m.push({key:"staff_timetable",label:"My Timetable (Staff)",to:"/staff/timetable"}),y.is_student&&m.push({key:"student_attendance",label:"My Attendance",to:"/student/attendance"}),y.is_staff&&(g.includes("academics.view_assigned_subjects")||b.includes("HOD"))&&m.push({key:"assigned_subjects",label:"Assigned Subjects",to:"/staff/assigned-subjects"}),y.is_staff&&g.includes("academics.view_mentees")&&m.push({key:"my_mentees",label:"My Mentees",to:"/staff/mentees"}),y.is_staff&&(g.includes("academics.mark_attendance")||b.includes("HOD")||b.includes("ADVISOR"))&&m.push({key:"period_attendance",label:"Mark Attendance",to:"/staff/period-attendance"}),y.is_staff&&(g.includes("academics.view_all_attendance")||g.includes("academics.view_attendance_overall")||g.includes("academics.view_all_departments")||g.includes("academics.view_department_attendance")||g.includes("academics.view_class_attendance")||g.includes("academics.view_section_attendance"))&&m.push({key:"attendance_analytics",label:"Attendance Analytics",to:"/staff/analytics"}),m.unshift({key:"profile",label:"Profile",to:"/profile"}),y.is_staff&&!m.some(_=>_.key==="academic")&&m.push({key:"academic",label:"Academic",to:"/academic"}),v&&!m.some(_=>_.key==="academic_controller")&&m.push({key:"academic_controller",label:"Academic Controller",to:"/iqac/academic-controller"}),p&&!v&&!m.some(_=>_.key==="obe_due_dates")&&m.push({key:"obe_due_dates",label:"OBE: Due Dates",to:"/obe/master/due-dates"}),p&&!m.some(_=>_.key==="obe_requests")&&m.push({key:"obe_requests",label:"OBE: Requests",to:"/obe/master/requests"}),i.jsxs(i.Fragment,{children:[!s&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:o}),i.jsxs("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 overflow-y-auto ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:[i.jsx("div",{className:"hidden"}),i.jsx("nav",{className:"py-6",children:i.jsxs("ul",{className:"space-y-2 px-3",children:[i.jsx("li",{children:i.jsxs(Vi,{to:"/dashboard",className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${a.pathname==="/dashboard"?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o()},children:[i.jsx(b2,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),i.jsx("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:"Dashboard"})]})}),m.map(_=>{const C=Xte[_.key]||F0,j=a.pathname.startsWith(_.to);return i.jsxs("li",{className:"relative",children:[i.jsxs(Vi,{to:_.to,className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${j?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o(),_.key==="academic"&&d(A=>({...A,academic:!A.academic})),_.key==="academic_controller"&&d(A=>({...A,academic_controller:!A.academic_controller}))},children:[i.jsx(C,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),i.jsxs("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:[_.label,_.key==="obe_requests"&&l>0?i.jsx("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-medium rounded-full bg-red-600 text-white",children:l}):null]})]}),_.key==="academic"&&p&&u.academic?i.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[i.jsx("li",{children:i.jsxs(Vi,{to:"/academic?tab=obe_master",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${a.pathname.startsWith("/academic")&&new URLSearchParams(a.search).get("tab")==="obe_master"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[i.jsx(ls,{className:"w-4 h-4"})," ",i.jsx("span",{children:"OBE Master"})]})}),v?null:i.jsx("li",{children:i.jsxs(Vi,{to:"/academic?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${a.pathname.startsWith("/academic")&&new URLSearchParams(a.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[i.jsx(mA,{className:"w-4 h-4"})," ",i.jsx("span",{children:"OBE: Due Dates"})]})})]}):null,_.key==="academic_controller"&&u.academic_controller?i.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[i.jsx("li",{children:i.jsxs(Vi,{to:"/iqac/academic-controller?tab=dashboard",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${a.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(a.search).get("tab")==="dashboard"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[i.jsx(b2,{className:"w-4 h-4"})," ",i.jsx("span",{children:"Dashboard"})]})}),i.jsx("li",{children:i.jsxs(Vi,{to:"/iqac/academic-controller?tab=qp",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${a.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(a.search).get("tab")==="qp"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[i.jsx(xA,{className:"w-4 h-4"})," ",i.jsx("span",{children:"QP"})]})}),i.jsx("li",{children:i.jsxs(Vi,{to:"/iqac/academic-controller?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${a.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(a.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[i.jsx(mA,{className:"w-4 h-4"})," ",i.jsx("span",{children:"OBE Due Dates"})]})}),i.jsx("li",{children:i.jsxs(Vi,{to:"/iqac/academic-controller?tab=courses",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${a.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(a.search).get("tab")==="courses"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[i.jsx(xA,{className:"w-4 h-4"})," ",i.jsx("span",{children:"Courses"})]})})]}):null]},_.key)})]})})]})]})}const Qte=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function Jte({editingCell:e,periods:t,assignmentMap:r,specialName:n,setSpecialName:a,selectedSpecialId:s,setSelectedSpecialId:o,specialTimetables:l,specialDate:c,setSpecialDate:u,curriculum:d,currentSectionRegulation:f,editingCurriculumId:p,setEditingCurriculumId:h,customSubjectText:m,setCustomSubjectText:g,editingAvailableBatches:b,setEditingAvailableBatches:y,editingBatchId:v,setEditingBatchId:w,isCustomAssignment:_,setIsCustomAssignment:C,customAssignmentText:j,setCustomAssignmentText:A,selectedStaffId:M,setSelectedStaffId:P,staffList:R,sectionId:N,shortLabel:T,loadBatchesForCurriculum:B,handleDeleteSpecialEntry:G,handleDeleteAssignment:re,handleUpdateAssignment:xe,handleAssign:_e,loadTimetable:V,setShowCellPopup:K,customSubjectOptions:de,setEditingCell:ne,fetchWithAuth:E}){if(!e)return null;const Z=e.day,H=e.periodId,F=r[Z]&&r[Z][H]||[],ee=t.find(z=>z.id===H)||{};return i.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-3 text-white",children:[i.jsx(cs,{className:"h-5 w-5"}),i.jsxs("h3",{className:"text-lg font-semibold",children:["Day ",Z,"  ",ee.label||`${ee.start_time||""} - ${ee.end_time||""}`]})]}),i.jsx("button",{onClick:()=>{K(!1),ne(null)},className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-1.5 transition-colors",children:i.jsx(zu,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(ls,{className:"h-5 w-5 text-indigo-600"}),i.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Existing Assignments"})]}),F.length===0?i.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[i.jsx($u,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),i.jsx("p",{className:"text-gray-500",children:"No assignment yet"})]}):i.jsx("div",{className:"space-y-3",children:F.map(z=>{var X;return i.jsxs("div",{className:`rounded-lg p-4 border-2 ${z.is_special?"bg-amber-50 border-amber-200":"bg-blue-50 border-blue-200"}`,children:[i.jsxs("div",{className:"font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(ls,{className:"h-4 w-4"}),z.is_special?z.timetable_name||"Special":T(z.curriculum_row||z.subject_text),z.is_special&&i.jsxs("span",{className:"text-amber-600 text-sm",children:[" ",T(z.curriculum_row||z.subject_text)]})]}),i.jsxs("div",{className:"text-sm text-gray-700 mt-2 flex items-center gap-1",children:[i.jsx(us,{className:"h-3.5 w-3.5"}),((X=z.staff)==null?void 0:X.username)||"",z.subject_batch?`  Batch: ${z.subject_batch.name}`:""]}),z.is_special&&i.jsxs("div",{className:"text-xs text-amber-700 mt-2 flex items-center gap-1",children:[i.jsx(cs,{className:"h-3.5 w-3.5"}),"Date: ",z.date||"","  ",ee.label||`${ee.start_time||""}${ee.start_time&&ee.end_time?" - ":""}${ee.end_time||""}`]}),i.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[i.jsxs("button",{onClick:async()=>{var Y,L;const J=((Y=z.curriculum_row)==null?void 0:Y.id)||null,q=((L=z.subject_batch)==null?void 0:L.id)||null;if(h(J),w(q),J){const U=await B(J);if(q&&!U.find(ce=>ce.id===q))try{const ce=await E(`/api/academics/subject-batches/${q}/`);if(ce.ok){const W=await ce.json();y(ae=>ae.find(he=>he.id===W.id)?ae:[...ae,W])}}catch(ce){console.error("failed to load existing batch",ce)}}else if(q)try{const U=await E(`/api/academics/subject-batches/${q}/`);if(U.ok){const ce=await U.json();y(W=>W.find(ae=>ae.id===ce.id)?W:[...W,ce])}}catch(U){console.error("failed to load existing batch",U)}},className:"px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-1",children:[i.jsx(Jf,{className:"h-3.5 w-3.5"}),"Edit"]}),i.jsxs("button",{onClick:()=>{z.is_special?G(z.id):re(z.id)},className:"px-3 py-1.5 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors flex items-center gap-1",children:[i.jsx(Yx,{className:"h-3.5 w-3.5"}),"Delete"]}),i.jsxs("button",{onClick:async()=>{if(!p)return alert("Select new subject from right panel then click Update");const J={};p&&(J.curriculum_row=p),v!==null&&(J.subject_batch_id=v),await xe(z.id,J)},className:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors flex items-center gap-1",children:[i.jsx(Od,{className:"h-3.5 w-3.5"}),"Update"]})]})]},z.id)})})]}),i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Xx,{className:"h-5 w-5 text-green-600"}),i.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Assign / Edit"})]}),i.jsxs("div",{className:"space-y-4 bg-gray-50 rounded-lg p-4 border border-gray-200",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Type"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{C(!1),A(""),P(null)},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${_?"bg-white text-gray-700 border-gray-300 hover:border-indigo-300":"bg-indigo-600 text-white border-indigo-600"}`,children:"From Curriculum"}),i.jsx("button",{onClick:()=>{C(!0),h(null),w(null),y([])},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${_?"bg-indigo-600 text-white border-indigo-600":"bg-white text-gray-700 border-gray-300 hover:border-indigo-300"}`,children:"Custom Subject"})]})]}),_?i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject Name"}),i.jsxs("select",{value:j||"",onChange:z=>A(z.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[i.jsx("option",{value:"",children:"Select custom subject"}),de.map(z=>i.jsx("option",{value:z.label,children:z.label},z.value))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Staff (optional)"}),i.jsxs("select",{value:M||"",onChange:z=>P(Number(z.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[i.jsx("option",{value:"",children:"Select staff (optional)"}),R.map(z=>i.jsx("option",{value:z.id,children:(()=>{var Y,L,U;const X=((Y=z.user)==null?void 0:Y.first_name)||"",J=((L=z.user)==null?void 0:L.last_name)||"";return`${X} ${J}`.trim()||((U=z.user)==null?void 0:U.username)||z.staff_id})()},z.id))]})]})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),i.jsxs("select",{value:p||"",onChange:async z=>{const X=Number(z.target.value)||null;h(X),w(null),X?await B(X):y([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[i.jsx("option",{value:"",children:"Select subject"}),d.filter(z=>!(f!=null&&f.code)||z.regulation===f.code).map(z=>i.jsxs("option",{value:z.id,children:[z.course_code,"  ",z.course_name]},z.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),i.jsxs("select",{value:v||"",onChange:z=>w(Number(z.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[i.jsx("option",{value:"",children:"Select batch (optional)"}),b.map(z=>i.jsx("option",{value:z.id,children:z.name},z.id))]})]})]}),i.jsxs("button",{onClick:async()=>{if(_){if(!j.trim())return alert("Subject name is required");await _e(Z,H)}else{if(!p)return alert("Select a subject");await _e(Z,H,p)}K(!1),ne(null)},className:"w-full px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[i.jsx(Xx,{className:"h-4 w-4"}),"Assign to Period"]})]}),i.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx($u,{className:"h-5 w-5 text-amber-600"}),i.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Mark Special Period"})]}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a date-specific override for this period."}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Special timetable"}),i.jsxs("select",{value:s??"",onChange:z=>o(z.target.value?Number(z.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[i.jsx("option",{value:"",children:"Create new"}),l.map(z=>i.jsxs("option",{value:z.id,children:[z.name," ",z.is_active?"":"(inactive)"]},z.id))]}),!s&&i.jsx("input",{placeholder:"Name for new special timetable",value:n,onChange:z=>{z.preventDefault(),a(z.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"},"special-name-input")]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Date"}),i.jsx("input",{type:"date",value:c||"",onChange:z=>u(z.target.value||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),i.jsxs("select",{value:p??"",onChange:z=>{const X=Number(z.target.value)||null;h(X),g(""),w(null),X&&X!==-1&&B(X).catch(console.error)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[i.jsx("option",{value:"",children:"-- choose from section subjects --"}),d.filter(z=>!(f!=null&&f.code)||z.regulation===f.code).map(z=>i.jsxs("option",{value:z.id,children:[z.course_code,"  ",z.course_name]},z.id)),i.jsx("option",{value:"-1",children:"Custom text"})]}),p===-1&&i.jsxs("select",{value:m||"",onChange:z=>{z.preventDefault(),g(z.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[i.jsx("option",{value:"",children:"-- choose custom subject --"}),de.map(z=>i.jsx("option",{value:z.label,children:z.label},z.value))]},"custom-subject-input")]}),b&&b.length>0&&p&&p!==-1&&i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),i.jsxs("select",{value:v||"",onChange:z=>w(Number(z.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[i.jsx("option",{value:"",children:"None"}),b.map(z=>i.jsx("option",{value:z.id,children:z.name},z.id))]})]}),i.jsxs("button",{onClick:async()=>{if(!c)return alert("Select a date");try{let z=s;if(!z){const q=n||`Special - ${c}`,Y=await E("/api/timetable/special-timetables/",{method:"POST",body:JSON.stringify({name:q,section:N,is_active:!0})});if(!Y.ok){const U=await Y.text();return alert("Failed to create special timetable: "+U)}z=(await Y.json()).id}const X={timetable_id:z,timetable:z,date:c,period_id:H,period:H};p&&p!==-1&&(X.curriculum_row=p),p===-1&&m&&(X.subject_text=m),v&&(X.subject_batch_id=v);const J=await E("/api/timetable/special-entries/",{method:"POST",body:JSON.stringify(X)});if(!J.ok){const q=await J.text();return alert("Failed to create special entry: "+q)}alert("Special period created"),await V(),K(!1),ne(null)}catch(z){console.error(z),alert("Failed to create special entry")}},className:"w-full px-4 py-2.5 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[i.jsx($u,{className:"h-4 w-4"}),"Mark Special Period"]})]})]})]})]})})]})})}function Zte(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[a,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState([]),[b,y]=x.useState([]),[v,w]=x.useState([]),[_,C]=x.useState(null),[j,A]=x.useState(null),[M,P]=x.useState([]),[R,N]=x.useState(null),[T,B]=x.useState(!1),[G,re]=x.useState(new Date().toISOString().slice(0,10)),[xe,_e]=x.useState([]),[V,K]=x.useState(null),[de,ne]=x.useState(""),[E,Z]=x.useState(""),[H,F]=x.useState([]),[ee,z]=x.useState(!1),[X,J]=x.useState(""),[q,Y]=x.useState(null),[L,U]=x.useState([]);x.useEffect(()=>{mr("/api/academics/my-students/").then(Xe=>Xe.ok?Xe.json():[]).then(Xe=>{const Be=(Xe.results||[]).map(ct=>({id:ct.section_id,name:ct.section_name,batch:ct.batch,batch_regulation:ct.batch_regulation,department_id:ct.department_id}));t(Be),!o&&Be.length>0&&(l(Be[0].id),u(Be[0].department_id),f(Be[0].batch_regulation))}),mr("/api/timetable/templates/").then(Xe=>Xe.json()).then(Xe=>{const Be=Xe||[];n(Be);const ct=Be.find(nt=>nt.is_active)||Be[0];ct&&(h(ct.id),s(ct.periods||[]))}),mr("/api/academics/custom-subjects/").then(Xe=>Xe.ok?Xe.json():{results:[]}).then(Xe=>F(Xe.results||[])).catch(Xe=>console.error("Failed to load custom subjects",Xe))},[]),x.useEffect(()=>{if(o){const Xe=e.find(Be=>Be.id===o);Xe&&f(Xe.batch_regulation),mr(`/api/timetable/curriculum-for-section/?section_id=${o}`).then(Be=>Be.json()).then(Be=>g(Be.results||[])),ce(),mr(`/api/timetable/section/${o}/subjects-staff/`).then(Be=>Be.ok?Be.json():[]).then(Be=>w(Be.results||[])),mr(`/api/timetable/special-timetables/?section_id=${o}`).then(Be=>Be.ok?Be.json():[]).then(Be=>_e(Be.results||[])),c&&mr(`/api/academics/advisor-staff/?department=${c}`).then(Be=>Be.ok?Be.json():[]).then(Be=>U(Be.results||Be||[]))}},[o,c]);async function ce(){if(o)try{const Xe=await mr(`/api/timetable/section/${o}/timetable/`);if(!Xe.ok)return;const Be=await Xe.json();y(Be.results||[])}catch(Xe){console.error("loadTimetable failed",Xe)}}const W={};for(const Xe of b){const Be=Xe.day;W[Be]=W[Be]||{};for(const ct of Xe.assignments||[])W[Be][ct.period_id]=W[Be][ct.period_id]||[],W[Be][ct.period_id].push(ct)}function ae(Xe){if(!Xe)return"";if(typeof Xe=="string"){const nt=Xe.trim();return nt.length<=12?nt:nt.slice(0,12)+""}if(Xe.course_code)return Xe.course_code;const Be=Xe.course_name||Xe.course||Xe.subject_text||"",ct=String(Be).trim();return ct.length<=12?ct:ct.split(" ").map(nt=>nt[0]).slice(0,3).join("")||ct.slice(0,12)}function he(Xe){const Be=new Date,ct=Be.getDay(),nt=new Date(Be),Se=ct===0?-6:1-ct;nt.setDate(Be.getDate()+Se);const Te=new Date(nt);return Te.setDate(nt.getDate()+(Xe-1)),Te.toISOString().slice(0,10)}async function ze(Xe,Be,ct){if(!o)return alert("Section is required");const nt={period_id:Be,day:Xe,section_id:o};if(ee){if(!X.trim())return alert("Subject name is required");nt.subject_text=X.trim(),q&&(nt.staff_id=q)}else{if(!ct)return alert("Select a curriculum row first");nt.curriculum_row=ct,R&&(nt.subject_batch_id=R)}const Se=await mr("/api/timetable/assignments/",{method:"POST",body:JSON.stringify(nt)});if(!Se.ok){const Te=await Se.text();return alert("Failed: "+Te)}A(null),P([]),N(null),J(""),Y(null),await ce()}async function ke(Xe){if(P([]),!Xe)return[];try{const Be=await mr(`/api/academics/subject-batches/?curriculum_row_id=${Xe}&page_size=0&include_all=1`);if(Be.ok){const ct=await Be.json(),nt=ct.results||ct||[];return P(nt),nt}}catch(Be){console.error("loadBatches failed",Be)}return[]}function qe(Xe,Be){if(Be.is_break||Be.is_lunch)return i.jsx("div",{className:"flex items-center justify-center py-2",children:i.jsx("span",{className:"text-sm text-gray-500 italic",children:Be.label||(Be.is_break?"Break":"Lunch")})});const ct=W[Xe]&&W[Xe][Be.id];return i.jsx("div",{children:ct&&ct.length?i.jsx("div",{className:"space-y-2",children:ct.map((nt,Se)=>i.jsxs("div",{className:`rounded-lg p-2.5 cursor-pointer transition-all hover:shadow-md ${nt.is_special?"bg-amber-50 border border-amber-200 hover:border-amber-300":"bg-blue-50 border border-blue-200 hover:border-blue-300"}`,onClick:()=>{C({day:Xe,periodId:Be.id}),re(he(Xe)),B(!0)},children:[i.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[i.jsx(ls,{className:"h-3 w-3"}),nt.is_special?nt.timetable_name||"Special":ae(nt.curriculum_row||nt.subject_text),nt.is_special&&i.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",ae(nt.curriculum_row||nt.subject_text)]})]}),i.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[i.jsx(us,{className:"h-3 w-3"}),"Staff: ",(()=>{if(!nt.staff)return"";const Te=nt.staff.first_name||"",Dt=nt.staff.last_name||"";return`${Te} ${Dt}`.trim()||nt.staff.username||""})(),nt.subject_batch?`  Batch: ${nt.subject_batch.name}`:""]})]},Se))}):i.jsxs("div",{className:"py-4 text-gray-400 text-sm cursor-pointer hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-all flex items-center justify-center gap-1",onClick:()=>{C({day:Xe,periodId:Be.id}),re(he(Xe)),B(!0)},children:[i.jsx(Xx,{className:"h-4 w-4"}),"Click to assign"]})})}async function Ie(Xe){if(Xe&&confirm("Delete this assignment?"))try{const Be=await mr(`/api/timetable/assignments/${Xe}/`,{method:"DELETE"});if(!Be.ok){const ct=await Be.text();return alert("Failed: "+ct)}await ce()}catch(Be){console.error(Be),alert("Delete failed")}}async function Ve(Xe){if(!Xe||!confirm("Delete this special period?"))return;let Be=String(Xe);Be.startsWith("special-")&&(Be=Be.replace("special-",""));const ct=Number(Be);if(!ct)return alert("Invalid special entry id");try{const nt=await mr(`/api/timetable/special-entries/${ct}/`,{method:"DELETE"});if(!nt.ok){const Se=await nt.text();return alert("Failed: "+Se)}await ce()}catch(nt){console.error(nt),alert("Delete failed")}}async function Qe(Xe,Be){if(Xe)try{const ct=await mr(`/api/timetable/assignments/${Xe}/`,{method:"PATCH",body:JSON.stringify(Be)});if(!ct.ok){const nt=await ct.text();return alert("Failed: "+nt)}await ce(),B(!1),C(null)}catch(ct){console.error(ct),alert("Update failed")}}const vt=(()=>{if(!(d!=null&&d.code))return[];const Xe=m.filter(nt=>nt.regulation===d.code),Be=new Map;return v.forEach(nt=>{nt.id&&nt.staff&&Be.set(nt.id,nt.staff)}),Xe.map(nt=>({...nt,staff:Be.get(nt.id)||""}))})();return i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:i.jsx(cs,{className:"h-7 w-7 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Timetable Editor"}),i.jsx("p",{className:"text-gray-600",children:"Manage class schedules and assignments"})]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(q1,{className:"h-4 w-4 text-indigo-600"}),i.jsx("span",{className:"font-semibold text-indigo-900",children:(e.find(Xe=>Xe.id===o)||{name:"Section"}).name})]})}),d&&i.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-lg border border-emerald-200",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ls,{className:"h-4 w-4 text-emerald-600"}),i.jsxs("span",{className:"font-semibold text-emerald-900",children:["Regulation: ",d.code]})]})}),p&&i.jsx("div",{className:"px-4 py-2 bg-gray-50 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(tu,{className:"h-4 w-4 text-gray-600"}),i.jsx("span",{className:"text-sm font-medium text-gray-700",children:(r.find(Xe=>Xe.id===p)||{name:"Template"}).name})]})})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 mb-6 overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-100",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(tu,{className:"h-5 w-5 text-indigo-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[i.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[120px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),a.map(Xe=>i.jsxs("th",{className:"px-4 py-3 min-w-[160px]",children:[i.jsx("div",{className:"text-sm font-bold text-indigo-700",children:Xe.label||`Period ${Xe.index||""}`}),i.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:Xe.start_time?`${Xe.start_time}${Xe.end_time?" - "+Xe.end_time:""}`:Xe.is_break?"Break":""})]},Xe.id))]})}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:Qte.map((Xe,Be)=>i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:Xe}),a.map(ct=>{const nt=_&&_.day===Be+1&&_.periodId===ct.id;return i.jsx("td",{className:`px-4 py-3 align-top ${nt?"bg-indigo-50 border-2 border-indigo-300 shadow-md":""}`,children:qe(Be+1,ct)},ct.id)})]},Xe))})]})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-100",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(us,{className:"h-5 w-5 text-indigo-600"}),i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Subjects & Staff Reference",d&&i.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(Regulation: ",d.code,")"]})]})]})}),i.jsx("div",{className:"overflow-x-auto max-h-96",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50 sticky top-0",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),i.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Staff"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:vt.length===0?i.jsx("tr",{children:i.jsxs("td",{colSpan:2,className:"px-6 py-8 text-center",children:[i.jsx(ls,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),i.jsx("p",{className:"text-gray-500",children:d?`No subjects found for regulation ${d.code}`:"No subjects found"})]})}):vt.map(Xe=>i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-6 py-3 text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ls,{className:"h-4 w-4 text-indigo-600"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:Xe.course_code?`${Xe.course_code}  ${Xe.course_name}`:Xe.course_name}),Xe.class_type&&i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Xe.class_type," ",Xe.is_elective?" Elective":""]})]})]})}),i.jsx("td",{className:"px-6 py-3 text-sm text-gray-700",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(us,{className:"h-4 w-4 text-gray-500"}),i.jsx("span",{className:Xe.staff===""?"text-gray-400 italic":"",children:Xe.staff}),Xe.staff===""&&i.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Not Assigned"})]})})]},String(Xe.id)))})]})})]})]}),T?i.jsx(Jte,{editingCell:_,periods:a,assignmentMap:W,specialName:de,setSpecialName:ne,selectedSpecialId:V,setSelectedSpecialId:K,specialTimetables:xe,specialDate:G,setSpecialDate:re,curriculum:m,currentSectionRegulation:d,editingCurriculumId:j,setEditingCurriculumId:A,customSubjectText:E,setCustomSubjectText:Z,editingAvailableBatches:M,setEditingAvailableBatches:P,editingBatchId:R,setEditingBatchId:N,isCustomAssignment:ee,setIsCustomAssignment:z,customAssignmentText:X,setCustomAssignmentText:J,selectedStaffId:q,setSelectedStaffId:Y,staffList:L,sectionId:o,shortLabel:ae,loadBatchesForCurriculum:ke,handleDeleteSpecialEntry:Ve,handleDeleteAssignment:Ie,handleUpdateAssignment:Qe,handleAssign:ze,loadTimetable:ce,setShowCellPopup:B,setEditingCell:C,fetchWithAuth:mr,customSubjectOptions:H}):null]})}function ere(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[a,s]=x.useState(!1),[o,l]=x.useState({name:"",description:"",parity:"BOTH",is_public:!1,is_active:!1}),[c,u]=x.useState([]),[d,f]=x.useState({name:"",parity:"ODD",is_active:!1}),[p,h]=x.useState({index:1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""}),[m,g]=x.useState(null),[b,y]=x.useState({});x.useEffect(()=>{v()},[]),x.useEffect(()=>{w()},[]);async function v(){s(!0);try{const N=await mr("/api/timetable/templates/");if(!N.ok)throw new Error(await N.text());const T=await N.json(),B=Array.isArray(T)?T:T.results||T;if(t(B||[]),B&&B.length){const G=B.find(re=>re.is_active)||B[0];n(G);try{const re=G&&G.periods||[],xe=re.length?Math.max(...re.map(_e=>Number(_e.index||_e.position||0))):0;h(_e=>({..._e,index:Number(xe)+1}))}catch{}}}catch(N){console.error(N),alert("Failed to load templates")}finally{s(!1)}}async function w(){try{const N=await mr("/api/academics/academic-years/");if(!N.ok)throw new Error(await N.text());const T=await N.json(),B=Array.isArray(T)?T:T.results||T;u(B||[])}catch(N){console.error(N)}}async function _(){try{const N=await mr("/api/academics/academic-years/",{method:"POST",body:JSON.stringify(d)});if(!N.ok)throw new Error(await N.text());await w(),f({name:"",parity:"ODD",is_active:!1})}catch(N){console.error(N),alert("Failed to create academic year: "+String(N))}}async function C(N,T){try{const B=await mr(`/api/academics/academic-years/${N}/`,{method:"PATCH",body:JSON.stringify({is_active:T})});if(!B.ok)throw new Error(await B.text());await w(),await v()}catch(B){console.error(B),alert("Failed to update academic year: "+String(B))}}async function j(){if(!r)return alert("Select a template first");try{const N={...p,template:r.id},T=await mr("/api/timetable/slots/",{method:"POST",body:JSON.stringify(N)});if(!T.ok)throw new Error(await T.text());await v(),h({index:p.index+1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""})}catch(N){console.error(N),alert("Failed to add slot: "+String(N))}}async function A(N){if(confirm("Delete this period?"))try{const T=await mr(`/api/timetable/slots/${N}/`,{method:"DELETE"});if(!T.ok)throw new Error(await T.text());await v()}catch(T){console.error(T),alert("Failed to delete slot: "+String(T))}}function M(N){g(N.id),y({...N})}function P(){g(null),y({})}async function R(){if(!(!m||!b))try{const N=await mr(`/api/timetable/slots/${m}/`,{method:"PATCH",body:JSON.stringify(b)});if(!N.ok)throw new Error(await N.text());await v(),g(null),y({})}catch(N){console.error(N),alert("Failed to update slot: "+String(N))}}return i.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[i.jsx("span",{className:"p-3 bg-indigo-100 rounded-xl",children:i.jsxs("svg",{width:"28",height:"28",fill:"none",viewBox:"0 0 48 48",children:[i.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),i.jsx("path",{d:"M16 24h16M16 32h16M16 16h16",stroke:"#6366f1",strokeWidth:"2",strokeLinecap:"round"})]})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"IQAC  Timetable Templates"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage timetable templates and periods."})]})]}),a&&i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),"Loading templates..."]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-1",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(cs,{className:"w-5 h-5 text-indigo-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Academic Years"})]}),i.jsxs("div",{className:"space-y-3 mb-6 p-4 bg-gray-50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),i.jsx("input",{type:"text",placeholder:"e.g. 2025-26",value:d.name,onChange:N=>f({...d,name:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parity"}),i.jsxs("select",{value:d.parity,onChange:N=>f({...d,parity:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"ODD",children:"Odd"}),i.jsx("option",{value:"EVEN",children:"Even"})]})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",id:"activate",checked:d.is_active,onChange:N=>f({...d,is_active:N.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("label",{htmlFor:"activate",className:"ml-2 text-sm text-gray-700",children:"Activate on create"})]}),i.jsx("button",{onClick:_,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Create Academic Year"})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Existing Years"}),i.jsx("div",{className:"space-y-2",children:c.map(N=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[i.jsx("div",{children:i.jsxs("div",{className:"font-medium text-gray-900",children:[N.name," ",N.parity&&`(${N.parity})`,N.is_active&&i.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:"Active"})]})}),i.jsx("button",{onClick:()=>C(N.id,!N.is_active),className:`px-3 py-1 text-xs font-medium rounded-lg transition-colors ${N.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:N.is_active?"Deactivate":"Activate"})]},N.id))})]})]})}),i.jsx("div",{className:"lg:col-span-2",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[i.jsx(tu,{className:"w-5 h-5 text-indigo-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Template Management"})]}),!r&&i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(tu,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{children:"Select a template to manage its periods."})]}),r&&i.jsxs("div",{children:[i.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:r.name}),i.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-full",children:r.parity}),r.is_active&&i.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"Active"})]}),r.description&&i.jsx("p",{className:"text-gray-600",children:r.description})]}),i.jsxs("div",{className:"mb-6",children:[i.jsx("h5",{className:"text-lg font-medium text-gray-900 mb-3",children:"Periods"}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full border-collapse border border-gray-200 rounded-lg",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:[i.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Label"}),i.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Start Time"}),i.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"End Time"}),i.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Type"}),i.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white",children:(r.periods||[]).map(N=>i.jsx("tr",{className:"hover:bg-gray-50",children:m===N.id?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"border border-gray-200 px-4 py-3",children:i.jsx("input",{type:"text",value:b.label||"",onChange:T=>y({...b,label:T.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Label"})}),i.jsx("td",{className:"border border-gray-200 px-4 py-3",children:i.jsx("input",{type:"time",value:b.start_time||"",onChange:T=>y({...b,start_time:T.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"border border-gray-200 px-4 py-3",children:i.jsx("input",{type:"time",value:b.end_time||"",onChange:T=>y({...b,end_time:T.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"border border-gray-200 px-4 py-3",children:i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsxs("label",{className:"flex items-center text-xs",children:[i.jsx("input",{type:"checkbox",checked:b.is_break||!1,onChange:T=>y({...b,is_break:T.target.checked,is_lunch:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Break"]}),i.jsxs("label",{className:"flex items-center text-xs",children:[i.jsx("input",{type:"checkbox",checked:b.is_lunch||!1,onChange:T=>y({...b,is_lunch:T.target.checked,is_break:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Lunch"]})]})}),i.jsx("td",{className:"border border-gray-200 px-4 py-3",children:i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:R,className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Save Changes",children:i.jsx(Od,{className:"w-4 h-4"})}),i.jsx("button",{onClick:P,className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",title:"Cancel Edit",children:i.jsx(zu,{className:"w-4 h-4"})})]})})]}):i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:N.label||""}),i.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:N.start_time||""}),i.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:N.end_time||""}),i.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm",children:N.is_break?i.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"Break"}):N.is_lunch?i.jsx("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full",children:"Lunch"}):i.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Period"})}),i.jsx("td",{className:"border border-gray-200 px-4 py-3",children:i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>M(N),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Period",children:i.jsx(Jf,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>A(N.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Period",children:i.jsx(Yx,{className:"w-4 h-4"})})]})})]})},N.id))})]})})]}),i.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Xx,{className:"w-5 h-5 text-green-600"}),i.jsx("h5",{className:"text-lg font-medium text-gray-900",children:"Add New Period"})]}),i.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Index"}),i.jsx("input",{type:"number",value:p.index,onChange:N=>h({...p,index:Number(N.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),i.jsx("input",{type:"time",value:p.start_time,onChange:N=>h({...p,start_time:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),i.jsx("input",{type:"time",value:p.end_time,onChange:N=>h({...p,end_time:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),i.jsx("input",{type:"text",placeholder:"Period 1, Break, etc.",value:p.label,onChange:N=>h({...p,label:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.is_break,onChange:N=>h({...p,is_break:N.target.checked,is_lunch:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Break Period"})]}),i.jsxs("label",{className:"flex items-center",children:[i.jsx("input",{type:"checkbox",checked:p.is_lunch,onChange:N=>h({...p,is_lunch:N.target.checked,is_break:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Lunch Period"})]})]}),i.jsxs("button",{onClick:j,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center gap-2",children:[i.jsx(Xx,{className:"w-4 h-4"}),"Add Period"]})]})]})]})})]})]})}function p9(){var C,j,A,M,P;const[e,t]=x.useState(!1),[r,n]=x.useState(null),[a,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState({}),[d,f]=x.useState({}),[p,h]=x.useState(null);async function m(){t(!0),n(null);try{const[R,N]=await Promise.all([e9(),t9({statuses:["APPROVED","REJECTED"],limit:200})]),T=Array.isArray(R==null?void 0:R.results)?R.results:[],B=Array.isArray(N==null?void 0:N.results)?N.results:[];s(T),l(B),u(G=>{const re={...G};for(const xe of T)re[xe.id]==null&&(re[xe.id]=120);return re})}catch(R){n((R==null?void 0:R.message)||"Failed to load requests")}finally{t(!1)}}x.useEffect(()=>{m()},[]);const g=x.useMemo(()=>[...a].sort((R,N)=>String(N.requested_at||"").localeCompare(String(R.requested_at||""))),[a]),b=x.useMemo(()=>[...o].sort((R,N)=>String(N.reviewed_at||N.requested_at||"").localeCompare(String(R.reviewed_at||R.requested_at||""))),[o]);function y(R){const N=String(R||"").trim();if(!N)return"?";const T=N.split(/\s+/g).filter(Boolean);return T.length===1?T[0].slice(0,2).toUpperCase():(T[0][0]+T[T.length-1][0]).toUpperCase()}function v(R){if(!R)return"";const N=new Date(R);return Number.isNaN(N.getTime())?String(R):N.toLocaleString()}async function w(R){const N=Number(c[R]??120);f(T=>({...T,[R]:!0})),n(null);try{await a9(R,Number.isFinite(N)?N:120),await m()}catch(T){n((T==null?void 0:T.message)||"Approve failed")}finally{f(T=>({...T,[R]:!1}))}}async function _(R){f(N=>({...N,[R]:!0})),n(null);try{await i9(R),await m()}catch(N){n((N==null?void 0:N.message)||"Reject failed")}finally{f(N=>({...N,[R]:!1}))}}return i.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:20},children:[i.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:20},children:[i.jsx(tu,{size:24,color:"#9a3412"}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:24,fontWeight:950,color:"#111827"},children:"OBE Edit Requests"}),i.jsx("div",{style:{color:"#6b7280",fontSize:14},children:"Manage pending requests for Mark Entry and Mark Manager edits from faculty"})]}),i.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:i.jsxs("button",{className:"obe-btn obe-btn-secondary",onClick:m,disabled:e,children:[i.jsx(yA,{size:16,style:{marginRight:6}}),e?"Refreshing":"Refresh"]})})]}),r?i.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:12,borderRadius:12,marginBottom:20},children:[i.jsx(BD,{size:16,style:{marginRight:8,verticalAlign:"middle"}}),r]}):null,i.jsxs("div",{style:{display:"grid",gap:18},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"Answered Now"}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",g.length,")"]})]}),g.length===0?i.jsxs("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:[i.jsx(RD,{size:34,color:"#10b981",style:{marginBottom:8}}),i.jsx("div",{children:"No pending requests"})]}):i.jsx("div",{style:{display:"grid",gap:10},children:g.map(R=>{var G,re,xe;const N=!!d[R.id],T=String(((G=R.staff)==null?void 0:G.name)||((re=R.staff)==null?void 0:re.username)||"Unknown"),B=(xe=R.staff)==null?void 0:xe.department;return i.jsxs("div",{onClick:()=>h({kind:"pending",item:R}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[i.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#fff7ed",border:"1px solid #fed7aa",display:"grid",placeItems:"center",fontWeight:950,color:"#9a3412"},children:y(T)}),i.jsxs("div",{style:{flex:1,minWidth:220},children:[i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[i.jsx("div",{style:{fontWeight:900,color:"#111827"},children:T}),B?i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",B]}):null]}),i.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[R.subject_code,"  ",i.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:R.subject_name||R.subject_code})]}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",R.assessment.toUpperCase(),"  ",v(R.requested_at)]})]}),i.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[i.jsxs("div",{style:{background:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:800,whiteSpace:"nowrap"},children:[i.jsx(tu,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"Pending"]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},onClick:_e=>_e.stopPropagation(),children:[i.jsx("input",{type:"number",value:c[R.id]??120,onChange:_e=>u(V=>({...V,[R.id]:Number(_e.target.value)})),min:1,max:1440,style:{width:82,padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:10},disabled:N,title:"Window minutes"}),i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>w(R.id),disabled:N,children:N?"Approving":"Approve"}),i.jsx("button",{className:"obe-btn obe-btn-danger",onClick:()=>_(R.id),disabled:N,children:N?"Rejecting":"Reject"})]})]})]},R.id)})})]}),i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"History"}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",b.length,")"]})]}),b.length===0?i.jsx("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:i.jsx("div",{children:"No reviewed requests yet"})}):i.jsx("div",{style:{display:"grid",gap:10},children:b.map(R=>{var _e,V,K;const N=String(((_e=R.staff)==null?void 0:_e.name)||((V=R.staff)==null?void 0:V.username)||"Unknown"),T=(K=R.staff)==null?void 0:K.department,B=R.status==="APPROVED",G=B?"#ecfdf5":"#fef2f2",re=B?"#065f46":"#991b1b",xe=B?"#10b98133":"#ef444433";return i.jsxs("div",{onClick:()=>h({kind:"history",item:R}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[i.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#f9fafb",border:"1px solid #e5e7eb",display:"grid",placeItems:"center",fontWeight:950,color:"#111827"},children:y(N)}),i.jsxs("div",{style:{flex:1,minWidth:220},children:[i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[i.jsx("div",{style:{fontWeight:900,color:"#111827"},children:N}),T?i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",T]}):null]}),i.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[R.subject_code,"  ",i.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:R.subject_name||R.subject_code})]}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",R.assessment.toUpperCase(),"  Reviewed ",v(R.reviewed_at)]})]}),i.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:i.jsx("div",{style:{background:G,color:re,border:`1px solid ${xe}`,padding:"4px 10px",borderRadius:999,fontSize:12,fontWeight:900,whiteSpace:"nowrap"},children:B?"Approved":"Rejected"})})]},R.id)})})]})]}),p?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>h(null),children:i.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:16},onClick:R=>R.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Request Details"}),i.jsx("div",{style:{marginLeft:"auto"},children:i.jsx("button",{className:"obe-btn",onClick:()=>h(null),children:"Close"})})]}),i.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#f9fafb"},children:i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"160px 1fr",rowGap:8,columnGap:10,fontSize:13},children:[i.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Status"}),i.jsx("div",{style:{color:"#111827",fontWeight:900},children:p.item.status}),i.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Staff"}),i.jsxs("div",{style:{color:"#111827",fontWeight:900},children:[String(((C=p.item.staff)==null?void 0:C.name)||((j=p.item.staff)==null?void 0:j.username)||"Unknown"),(A=p.item.staff)!=null&&A.department?i.jsxs("span",{style:{color:"#6b7280",fontWeight:700},children:["  ",p.item.staff.department]}):null]}),i.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Subject"}),i.jsxs("div",{style:{color:"#111827"},children:[i.jsx("span",{style:{fontWeight:900},children:p.item.subject_code}),"  ",i.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:p.item.subject_name||p.item.subject_code})]}),i.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Assessment"}),i.jsx("div",{style:{color:"#111827",fontWeight:900},children:p.item.assessment.toUpperCase()}),i.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Requested At"}),i.jsx("div",{style:{color:"#111827"},children:v(p.item.requested_at)}),i.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reason"}),i.jsx("div",{style:{color:"#111827",whiteSpace:"pre-wrap"},children:p.item.reason||""}),"reviewed_at"in p.item?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed At"}),i.jsx("div",{style:{color:"#111827"},children:v(p.item.reviewed_at)}),i.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed By"}),i.jsx("div",{style:{color:"#111827"},children:String(((M=p.item.reviewed_by)==null?void 0:M.name)||((P=p.item.reviewed_by)==null?void 0:P.username)||"")}),i.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Approved Until"}),i.jsx("div",{style:{color:"#111827"},children:v(p.item.approved_until)})]}):null]})})]})}):null]})}const O8=[1,2,3,4,5,6,7,8],tre=["THEORY","LAB","TCPL","TCPR","PRACTICAL","PROJECT","AUDIT","SPECIAL"],hf={THEORY:"Theory",LAB:"Lab",TCPL:"TCPL",TCPR:"TCPR",PRACTICAL:"Practical",PROJECT:"Project",AUDIT:"Audit",SPECIAL:"Special"},rre=["ssa1","formative1","cia1","ssa2","formative2","cia2","model"],nre=["ssa1","review1","cia1","ssa2","review2","cia2","model"],are=["cia1","cia2","model"],ire=["cia1","cia2","model"],sre=["review1","review2","model"],L8=["ssa1","formative1","cia1","ssa2","formative2","cia2"],mu=["ssa1","review1","formative1","cia1","ssa2","review2","formative2","cia2","model"];function M8(e){var l;const{controls:t,semesterIds:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const a=new Set(r.map(c=>Number(c))),s=new Map;for(const c of t||[]){const u=Number((l=c==null?void 0:c.semester)==null?void 0:l.id);if(!Number.isFinite(u)||!a.has(u))continue;const d=String((c==null?void 0:c.assessment)||"").trim().toLowerCase();d&&s.set(`${u}::${d}`,!!(c!=null&&c.is_open))}const o=new Set;for(const c of r)for(const u of n){const d=`${Number(c)}::${String(u).toLowerCase()}`;if(!s.has(d))o.add("ON");else{const f=!!s.get(d);o.add(f?"UNLIMITED":"OFF")}}return o.size===1?Array.from(o)[0]:"MIXED"}function ore(e,t){if(e==="LAB")return are;if(e==="TCPR")return nre;if(e==="PRACTICAL")return ire;if(e==="PROJECT")return sre;if(e==="SPECIAL"){const r=[];for(const o of t){const l=Array.isArray(o==null?void 0:o.enabled_assessments)?o.enabled_assessments:[];for(const c of l)r.push(String(c||"").trim().toLowerCase())}const n=SA(r).filter(Boolean);if(!n.length)return[];const a=new Set(L8),s=[];for(const o of L8)n.includes(String(o))&&s.push(o);for(const o of n)a.has(o)&&!s.includes(o)&&s.push(o);return s}return rre}function F8(e,t){if(e==="TCPL"){if(t==="formative1")return"LAB 1";if(t==="formative2")return"LAB 2"}if(e==="LAB"){if(t==="cia1")return"CIA 1 LAB";if(t==="cia2")return"CIA 2 LAB";if(t==="model")return"MODEL LAB"}if(e==="PRACTICAL"){if(t==="cia1")return"CIA 1 Review";if(t==="cia2")return"CIA 2 Review";if(t==="model")return"MODEL Review"}return e==="PROJECT"&&t==="model"?"MODEL Review":t==="ssa1"?"SSA1":t==="ssa2"?"SSA2":t==="review1"?"Review 1":t==="review2"?"Review 2":t==="formative1"?"Formative 1":t==="formative2"?"Formative 2":t==="cia1"?"CIA 1":t==="cia2"?"CIA 2":t==="model"?"MODEL":String(t).toUpperCase()}function lre(e){const t=String(e||"").trim().toUpperCase();return t==="THEORY"?"THEORY":t==="LAB"?"LAB":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t==="PRACTICAL"?"PRACTICAL":t==="PROJECT"?"PROJECT":t==="AUDIT"?"AUDIT":t==="SPECIAL"?"SPECIAL":"THEORY"}function cre(e,t){const r=String(e||"").trim(),n=String(t||"").trim();return!r||!n?null:`${r}T${n}:00`}function SA(e){const t=new Set,r=[];for(const n of e)t.has(n)||(t.add(n),r.push(n));return r}function ure(e){const{controls:t,subjectCodes:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const a=new Map;for(const l of t||[]){const c=String(l.subject_code||"").trim(),u=String(l.assessment||"").trim().toLowerCase();!c||!u||a.set(`${c}::${u}`,{is_open:!!l.is_open,is_enabled:!!l.is_enabled})}let s=0,o=0;for(const l of r)for(const c of n){const u=`${l}::${String(c).toLowerCase()}`,d=a.get(u);(d?!!d.is_open:!0)?s+=1:o+=1}return s>0&&o>0?"MIXED":o>0?"READONLY":"EDITABLE"}function lN(){const[e,t]=x.useState([]),[r,n]=x.useState(1),[a,s]=x.useState({}),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[p,h]=x.useState([]),[m,g]=x.useState("THEORY"),[b,y]=x.useState([]),[v,w]=x.useState(""),[_,C]=x.useState(""),[j,A]=x.useState(!1),[M,P]=x.useState(null),[R,N]=x.useState(null),T=x.useCallback(Y=>({padding:"8px 12px",borderRadius:8,border:Y?"1px solid #10b981":"1px solid #e5e7eb",background:Y?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer",whiteSpace:"nowrap"}),[]);x.useEffect(()=>{let Y=!0;return(async()=>{try{const L=await VD(),U=Array.isArray(L==null?void 0:L.results)?L.results:[];if(!Y)return;const ce=U.map(W=>({id:Number(W.id),number:(W==null?void 0:W.number)===null||typeof(W==null?void 0:W.number)>"u"?null:Number(W.number)})).filter(W=>Number.isFinite(W.id));ce.sort((W,ae)=>Number(W.number??9999)-Number(ae.number??9999)||W.id-ae.id),t(ce)}catch(L){if(!Y)return;N((L==null?void 0:L.message)||"Failed to load semesters")}})(),()=>{Y=!1}},[]);const B=x.useMemo(()=>{const Y=new Map;for(const L of e){const U=L.number;typeof U=="number"&&Number.isFinite(U)&&Y.set(U,L.id)}return Y},[e]),G=B.get(r)??null,re=x.useMemo(()=>{const Y=[];for(const L of O8){const U=B.get(L);U&&Y.push(U)}return Y},[B]);x.useEffect(()=>{let Y=!0;return(async()=>{try{if(!re.length)return;const L=await tx(re,mu);if(!Y)return;h(Array.isArray(L==null?void 0:L.results)?L.results:[])}catch{}})(),()=>{Y=!1}},[re.join(",")]);const xe=x.useCallback(async()=>{A(!0),P(null),N(null);try{if(!G){s({}),l([]),u([]),f([]),P(`Semester ${r} is not available in the database.`);return}const[Y,L,U,ce]=await Promise.all([KD([G]),GD([G]),Tv([G]),tx([G],mu)]),W=(Y==null?void 0:Y.subjects_by_semester)||{},ae=Array.isArray(L==null?void 0:L.results)?L.results:[];s(W),l(ae),u(Array.isArray(U==null?void 0:U.results)?U.results:[]),f(Array.isArray(ce==null?void 0:ce.results)?ce.results:[])}catch(Y){N((Y==null?void 0:Y.message)||"Failed to load semester data")}finally{A(!1)}},[G,r,m]);x.useEffect(()=>{xe()},[xe]);const _e=x.useMemo(()=>{if(!G)return[];const Y=(a==null?void 0:a[String(G)])||[];return(Array.isArray(Y)?Y:[]).filter(L=>L&&L.subject_code)},[a,G]),V=x.useMemo(()=>tre.slice(),[]);x.useEffect(()=>{V.includes(m)||g(V[0]||"THEORY")},[V.join("|")]);const K=x.useMemo(()=>_e.filter(Y=>lre(Y==null?void 0:Y.class_type)===m),[_e,m]),de=x.useMemo(()=>SA(K.map(Y=>String(Y.subject_code||"").trim()).filter(Boolean)),[K]),ne=x.useMemo(()=>SA(_e.map(Y=>String(Y.subject_code||"").trim()).filter(Boolean)),[_e]),E=x.useMemo(()=>ore(m,K),[m,K]);x.useEffect(()=>{var ae;const Y=E;if(!Y.length){y([]);return}if(!G){y(Y);return}const L=new Set(de),U=new Map;for(const he of c||[]){const ze=String(he.subject_code||"").trim();if(!L.has(ze))continue;const ke=String(he.assessment||"").trim().toLowerCase();ke&&U.set(ke,!!he.is_enabled)}const ce=new Set;for(const he of o||[])he!=null&&he.is_active&&(!((ae=he==null?void 0:he.semester)!=null&&ae.id)||Number(he.semester.id)!==Number(G)||L.has(String(he.subject_code||"").trim())&&ce.add(String(he.assessment||"").trim().toLowerCase()));const W=Y.filter(he=>{const ze=String(he).toLowerCase();return U.has(ze)?!!U.get(ze):ce.has(ze)});y(W)},[G,m,c,o,E,de]);const Z=x.useMemo(()=>ure({controls:c,subjectCodes:de,assessments:b}),[c,de,b]),H=x.useMemo(()=>G?M8({controls:d,semesterIds:[G],assessments:mu}):"MIXED",[d,G]),F=x.useMemo(()=>re.length?M8({controls:p,semesterIds:re,assessments:mu}):"MIXED",[p,re.join(",")]),ee=x.useCallback(async(Y,L)=>{A(!0),P(null),N(null);try{const U=L==="ALL"?re:G?[G]:[];if(!U.length)throw new Error("No semester ids available for this action.");if(Y==="ON"?await HD({semester_ids:U,assessments:mu}):Y==="OFF"?await bA({semester_ids:U,assessments:mu,is_open:!1}):await bA({semester_ids:U,assessments:mu,is_open:!0}),G){const ce=await tx([G],mu);f(Array.isArray(ce==null?void 0:ce.results)?ce.results:[])}if(re.length){const ce=await tx(re,mu);h(Array.isArray(ce==null?void 0:ce.results)?ce.results:[])}P(`${L==="ALL"?"All Semesters":`SEM ${r}`}: Publish set to ${Y==="ON"?"On (Timed)":Y==="OFF"?"Off (Locked)":"Unlimited (No Time Limit)"}.`)}catch(U){N((U==null?void 0:U.message)||"Publish toggle failed")}finally{A(!1)}},[re,G,r]),z=x.useCallback(async Y=>{const L=!b.includes(Y);y(U=>L?[...U,Y]:U.filter(ce=>ce!==Y)),A(!0),P(null),N(null);try{if(!G)throw new Error(`Semester ${r} is not available in the database.`);if(!de.length)throw new Error(`No courses found for SEM ${r} (${hf[m]}).`);await vA({semester_id:G,subject_codes:de,assessments:[Y],is_enabled:L}),L||await YD({semester_id:G,subject_codes:de,assessments:[Y]});const U=await Tv([G]);u(Array.isArray(U==null?void 0:U.results)?U.results:[]),P(`SEM ${r}  ${hf[m]}: ${F8(m,Y)} ${L?"enabled":"disabled"}.`)}catch(U){N((U==null?void 0:U.message)||"Update failed")}finally{A(!1)}},[b,G,r,m,de]),X=x.useCallback(async()=>{A(!0),P(null),N(null);try{if(!G)throw new Error(`Semester ${r} is not available in the database.`);if(!ne.length)throw new Error(`No courses found for SEM ${r}.`);if(H!=="ON")throw new Error(H==="OFF"?"Publish is OFF (Locked). Set Publish to ON to use a timer.":H==="UNLIMITED"?"Publish is UNLIMITED (No Time Limit). Set Publish to ON to use a due-date timer.":"Publish mode is MIXED. Set a single Publish mode first.");const Y=cre(v,_);if(!Y)throw new Error("Select Due Date and Due Time");await XD({semester_id:G,subject_codes:ne,assessments:mu,due_at:Y}),P(`SEM ${r}: Timer applied to all class types.`),await xe()}catch(Y){N((Y==null?void 0:Y.message)||"Save failed")}finally{A(!1)}},[G,r,ne,v,_,xe,H]),J=x.useCallback(async Y=>{A(!0),P(null),N(null);try{if(!G)throw new Error(`Semester ${r} is not available in the database.`);if(!b.length)throw new Error("Select at least one exam/assessment");if(!de.length)throw new Error(`No courses found for SEM ${r} (${hf[m]}).`);await vA({semester_id:G,subject_codes:de,assessments:b,is_open:Y});const L=await Tv([G]);u(Array.isArray(L==null?void 0:L.results)?L.results:[]),P(`SEM ${r}  ${hf[m]}: ${Y?"Editable":"Read-only"}`)}catch(L){N((L==null?void 0:L.message)||"Lock toggle failed")}finally{A(!1)}},[G,r,b,m,de]),q=Y=>{const L=Y==="THIS"?H:F,U=Y==="THIS"&&F==="OFF",ce=j||Y==="ALL"&&!re.length||U;return i.jsxs("div",{className:`pub3${ce?" pub3--disabled":""}`,title:U?"Locked by Common Publish (Off)":void 0,children:[i.jsx("button",{className:`pub3__btn pub3__btn--off${L==="OFF"?" pub3__btn--active":""}`,onClick:()=>void ee("OFF",Y),disabled:ce,children:"Off"}),i.jsx("button",{className:`pub3__btn pub3__btn--on${L==="ON"?" pub3__btn--active":""}`,onClick:()=>void ee("ON",Y),disabled:ce,children:"On"}),i.jsx("button",{className:`pub3__btn pub3__btn--unlimited${L==="UNLIMITED"?" pub3__btn--active":""}`,onClick:()=>void ee("UNLIMITED",Y),disabled:ce,children:"Unlimited"})]})};return i.jsxs("main",{style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#f3f4f6"},children:[i.jsx("style",{children:`
        /*  Neon 3-state publish switch  */
        .pub3 {
          display: inline-flex;
          border-radius: 999px;
          background: #0f172a;
          padding: 4px;
          gap: 3px;
          box-shadow: 0 0 0 1px #1e293b, 0 4px 12px rgba(0,0,0,0.55);
        }
        .pub3--disabled { opacity: 0.4; pointer-events: none; }
        .pub3__btn {
          padding: 8px 18px;
          border-radius: 999px;
          border: none;
          font-weight: 900;
          font-size: 13px;
          cursor: pointer;
          background: transparent;
          color: #64748b;
          transition: background 0.35s cubic-bezier(0.65,0,0.35,1),
                      color 0.35s cubic-bezier(0.65,0,0.35,1),
                      box-shadow 0.35s cubic-bezier(0.65,0,0.35,1);
          letter-spacing: 0.02em;
          min-width: 64px;
        }
        .pub3__btn:disabled { cursor: not-allowed; }
        .pub3__btn--off.pub3__btn--active {
          background: #450a0a;
          color: #fca5a5;
          box-shadow: 0 0 6px #ef4444, 0 0 18px #ef444455, inset 0 0 8px #ef444418;
        }
        .pub3__btn--on.pub3__btn--active {
          background: #052e16;
          color: #86efac;
          box-shadow: 0 0 6px #22c55e, 0 0 18px #22c55e55, inset 0 0 8px #22c55e18;
        }
        .pub3__btn--unlimited.pub3__btn--active {
          background: #1e3a8a;
          color: #93c5fd;
          box-shadow: 0 0 6px #3b82f6, 0 0 18px #3b82f655, inset 0 0 8px #3b82f618;
        }
      `}),i.jsxs("div",{style:{padding:20,maxWidth:1100,margin:"0 auto"},children:[i.jsx("div",{className:"welcome",style:{marginBottom:18},children:i.jsxs("div",{className:"welcome-left",children:[i.jsx("h2",{className:"welcome-title",style:{fontSize:22,marginBottom:2},children:"OBE Master  Lock & Timer Controls"}),i.jsx("div",{className:"welcome-sub",children:"Common Publish  Semester  Publish & Timer  Class Type  Exams"})]})}),R&&i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:R}),M&&i.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:M}),i.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"16px 20px",marginBottom:16,display:"flex",alignItems:"center",gap:20,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:"0 0 auto"},children:[i.jsx("div",{style:{fontWeight:900,fontSize:14,marginBottom:4,color:"#111827"},children:"Common Publish  All Semesters"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Applies the same publish mode to every semester at once."})]}),i.jsxs("div",{style:{flex:"1 1 auto",display:"flex",alignItems:"center",gap:14,flexWrap:"wrap"},children:[q("ALL"),i.jsx("span",{style:{fontSize:13,fontWeight:700,color:F==="OFF"?"#991b1b":F==="ON"?"#065f46":F==="UNLIMITED"?"#1e40af":"#6b7280"},children:F==="OFF"?"All Locked":F==="ON"?"All Timer-based":F==="UNLIMITED"?"All Unlimited":"Mixed"})]})]}),i.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"14px 18px",marginBottom:0,borderBottomLeftRadius:0,borderBottomRightRadius:0,borderBottom:"2px solid #10b981"},children:[i.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:10,textTransform:"uppercase",letterSpacing:1},children:"Select Semester"}),i.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:O8.map(Y=>i.jsxs("button",{disabled:j,onClick:()=>n(Y),style:T(Y===r),children:["SEM ",Y]},Y))})]}),i.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderTop:0,borderRadius:14,borderTopLeftRadius:0,borderTopRightRadius:0,padding:"18px 20px",marginBottom:16},children:[i.jsxs("div",{style:{display:"flex",gap:18,alignItems:"center",flexWrap:"wrap",marginBottom:18,paddingBottom:16,borderBottom:"1px solid #f3f4f6"},children:[i.jsxs("div",{style:{flex:"0 0 auto"},children:[i.jsxs("div",{style:{fontWeight:900,fontSize:13,marginBottom:6,color:"#111827"},children:["Publish  SEM ",r]}),q("THIS")]}),F==="OFF"?i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px 16px",borderRadius:10,background:"#fef2f2",border:"1px solid #fecaca",color:"#991b1b",fontWeight:800,fontSize:13},children:[i.jsx("span",{style:{fontSize:16},children:""})," Locked  Common Publish is Off"]}):H==="ON"?i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",flex:"1 1 auto"},children:[i.jsx("input",{type:"date",value:v,onChange:Y=>w(Y.target.value),disabled:j,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),i.jsx("input",{type:"time",value:_,onChange:Y=>C(Y.target.value),disabled:j,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),i.jsx("button",{onClick:()=>void X(),disabled:j,className:"obe-btn obe-btn-primary",style:{padding:"9px 16px",borderRadius:8,fontWeight:900,fontSize:13},children:j?"Saving":`Apply Timer  SEM ${r}`}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["All ",ne.length," subjects  all class types"]})]}):H==="UNLIMITED"?i.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#eff6ff",color:"#1e40af",fontWeight:800,border:"1px solid #bfdbfe",fontSize:13},children:" No Time Limit  always open"}):H==="OFF"?i.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#fef2f2",color:"#991b1b",fontWeight:800,border:"1px solid #fecaca",fontSize:13},children:" This semester locked"}):null]}),i.jsxs("div",{style:{marginBottom:14},children:[i.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Class Type"}),i.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:V.map(Y=>i.jsx("button",{disabled:j,onClick:()=>g(Y),style:T(Y===m),children:hf[Y]},Y))}),i.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:[K.length," course",K.length!==1?"s":""," in SEM ",r,"  ",hf[m]]})]}),i.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:"14px 16px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,flexWrap:"wrap",gap:8},children:[i.jsxs("div",{style:{fontWeight:900,fontSize:14,color:"#111827"},children:["SEM ",r,"  ",hf[m]," Exams"]}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Mark Entry Mode:"}),i.jsxs("div",{style:{display:"inline-flex",border:"1px solid #e5e7eb",borderRadius:999,overflow:"hidden",background:"#fff"},children:[i.jsx("button",{onClick:()=>void J(!1),disabled:j||!b.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:Z==="READONLY"?"#fee2e2":"#fff",color:Z==="READONLY"?"#991b1b":"#374151",minWidth:100},children:"Read-only"}),i.jsx("button",{onClick:()=>void J(!0),disabled:j||!b.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:Z==="EDITABLE"?"#dcfce7":"#fff",color:Z==="EDITABLE"?"#065f46":"#374151",minWidth:90},children:"Editable"})]})]})]}),E.length?i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:E.map(Y=>i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center",fontSize:13,padding:"8px 14px",borderRadius:10,border:`2px solid ${b.includes(Y)?"#10b981":"#e5e7eb"}`,background:b.includes(Y)?"#ecfdf5":"#fff",color:b.includes(Y)?"#065f46":"#374151",cursor:"pointer",userSelect:"none",fontWeight:700},children:[i.jsx("input",{type:"checkbox",checked:b.includes(Y),onChange:()=>void z(Y),disabled:j,style:{accentColor:"#10b981",width:15,height:15}}),F8(m,Y)]},Y))}):i.jsxs("div",{style:{color:"#6b7280",fontSize:13,padding:"8px 0"},children:["No exams configured for ",hf[m],"."]}),i.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Uncheck an exam to hide it from staff (message-only). Selected exams also control the Mark Entry Mode lever above."})]})]})]})]})}const Vd="https://db.zynix.us";async function Ld(){const e=await mr(`${Vd}/api/curriculum/master/`);if(!e.ok)throw new Error("Failed to fetch masters");return e.json()}async function dre(e){const t=await mr(`${Vd}/api/curriculum/master/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function fre(e,t){const r=await mr(`${Vd}/api/curriculum/master/${e}/`,{method:"PATCH",body:JSON.stringify(t)});try{if(!r.ok){const n=r.headers.get("content-type");if(n&&n.includes("application/json")){const a=await r.json();throw new Error(a.detail||"An error occurred")}else throw new Error(await r.text())}return r.json()}catch(n){throw console.error("Error in updateMaster:",n),n}}async function sl(){const e=await mr(`${Vd}/api/curriculum/department/`);if(!e.ok)throw new Error("Failed to fetch dept rows");return e.json()}async function cN(e){const t=await mr(`${Vd}/api/curriculum/department/${encodeURIComponent(String(e))}/`);if(!t.ok)throw new Error("Failed to fetch dept row");return t.json()}async function sm(e){const t=new URLSearchParams;e!=null&&e.department_id&&t.set("department_id",String(e.department_id)),e!=null&&e.regulation&&t.set("regulation",e.regulation),e!=null&&e.semester&&t.set("semester",String(e.semester));const r=`${Vd}/api/curriculum/elective/?${t.toString()}`,n=await mr(r);if(!n.ok)throw new Error("Failed to fetch electives");return n.json()}async function hre(e){const t=await mr(`${Vd}/api/curriculum/elective/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function pre(e,t){const r=await mr(`${Vd}/api/curriculum/department/${e}/`,{method:"PATCH",body:JSON.stringify(t)});if(!r.ok)throw new Error(await r.text());return r.json()}async function mre(e,t){const r=await mr(`${Vd}/api/curriculum/department/${e}/approve/`,{method:"POST",body:JSON.stringify({action:t})});if(!r.ok)throw new Error(await r.text());return r.json()}function Pg(e){return String(e||"").trim()}function gre(){const e=so(),[t,r]=x.useState([]),[n,a]=x.useState(!0),[s,o]=x.useState(null),[l,c]=x.useState("");x.useEffect(()=>{let f=!0;return(async()=>{try{const p=await sl();if(!f)return;r(Array.isArray(p)?p:[]),o(null)}catch(p){if(!f)return;r([]),o((p==null?void 0:p.message)||"Failed to load courses")}finally{f&&a(!1)}})(),()=>{f=!1}},[]);const u=x.useMemo(()=>{const f=new Map;for(const p of t||[]){const h=Pg(p.course_code);if(!h)continue;const m={course_code:h,course_name:Pg(p.course_name),class_type:Pg(p.class_type)||null,question_paper_type:Pg(p.question_paper_type)||null},g=f.get(h);if(!g){f.set(h,m);continue}const b=y=>(y.course_name?1:0)+(y.class_type?1:0)+(y.question_paper_type?1:0)+(String(y.question_paper_type||"").trim().toUpperCase()&&String(y.question_paper_type||"").trim().toUpperCase()!=="QP1"?1:0);b(m)>b(g)&&f.set(h,m)}return Array.from(f.values()).sort((p,h)=>p.course_code.localeCompare(h.course_code))},[t]),d=x.useMemo(()=>{const f=Pg(l).toLowerCase();return f?u.filter(p=>`${p.course_code} ${p.course_name}`.toLowerCase().includes(f)):u},[u,l]);return n?i.jsx("div",{style:{color:"#6b7280"},children:"Loading courses"}):s?i.jsx("div",{style:{color:"#b91c1c"},children:s}):i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"Courses"}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Search and open a course to view sections and staff mappings."})]}),i.jsxs("div",{style:{minWidth:280},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Search"}),i.jsx("input",{value:l,onChange:f=>c(f.target.value),placeholder:"Course code or name",className:"obe-input"})]})]}),d.length===0?i.jsx("div",{style:{color:"#6b7280"},children:"No courses found."}):i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:12},children:d.map(f=>i.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:f.course_code}),i.jsx("div",{style:{color:"#374151",fontWeight:700},children:f.course_name||""}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[f.class_type?`Class type: ${f.class_type}`:"",f.question_paper_type?`    QP: ${f.question_paper_type}`:""]}),i.jsx("div",{style:{marginTop:6},children:i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>e(`/iqac/academic-controller/course/${encodeURIComponent(f.course_code)}`),children:"Open"})})]},f.course_code))})]})}function xre(){var M;const e=x.useMemo(()=>[{key:"THEORY_QP1",label:"Theory QP 1",class_type:"THEORY",question_paper_type:"QP1"},{key:"THEORY_QP2",label:"Theory QP 2",class_type:"THEORY",question_paper_type:"QP2"},{key:"TCPR",label:"TCPR",class_type:"TCPR"},{key:"TCPL",label:"TCPL",class_type:"TCPL"},{key:"LAB",label:"LAB",class_type:"LAB"}],[]),[t,r]=x.useState(((M=e[0])==null?void 0:M.key)||""),n=x.useMemo(()=>e.find(P=>P.key===t)||null,[e,t]),[a,s]=x.useState("CIA1"),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(!1),[m,g]=x.useState(!1),[b,y]=x.useState(null),v=x.useMemo(()=>{const P=(n==null?void 0:n.class_type)||"THEORY",R=(n==null?void 0:n.question_paper_type)||null;return{class_type:P,question_paper_type:R,exam:a}},[n,a]);x.useEffect(()=>{let P=!1;async function R(){var N,T;u(null),f(null),h(!0),y(null);try{const B=await Gf(v);if(P)return;const G=Array.isArray((N=B==null?void 0:B.pattern)==null?void 0:N.marks)?B.pattern.marks:[],re=Array.isArray((T=B==null?void 0:B.pattern)==null?void 0:T.cos)?B.pattern.cos:[],xe=G.map((_e,V)=>({marks:String(_e),co:re[V]==null?"":String(re[V])}));l(xe),y((B==null?void 0:B.updated_at)??null)}catch(B){if(P)return;f(String((B==null?void 0:B.message)||B||"Failed to load pattern.")),l([])}finally{P||h(!1)}}return R(),()=>{P=!0}},[v]);const w=()=>{l(P=>[...P,{marks:"",co:a==="CIA2"?"3":"1"}])},_=P=>{l(R=>R.filter((N,T)=>T!==P))},C=(P,R)=>{l(N=>{const T=[...N],B=T[P]||{marks:"",co:""};return T[P]={...B,marks:R},T})},j=(P,R)=>{l(N=>{const T=[...N],B=T[P]||{marks:"",co:""};return T[P]={...B,co:R},T})},A=async()=>{u(null),f(null);try{const P=o.map(G=>({marks:String(G.marks??"").trim(),co:String((G==null?void 0:G.co)??"").trim()}));if(P.length&&P.some(G=>!G.marks||!G.co)){f("Enter marks and CO for all rows (or delete empty rows).");return}for(const G of P){const re=Number(G.marks);if(!Number.isFinite(re)||re<0){f("Marks must be a non-negative number.");return}}const R=G=>{const re=String(G||"").trim();if(!re)return"";if(re==="both")return"both";if(re==="1&2")return 12;if(re==="3&4")return 34;const xe=Number(re);return Number.isFinite(xe)?Math.trunc(xe):""};g(!0);const N=P.map(G=>Number(G.marks)),T=P.map(G=>R(G.co)).filter(G=>G!=="");if(T.length!==N.length){f("CO values must be valid for all rows.");return}const B=await JD({class_type:v.class_type,question_paper_type:v.question_paper_type,exam:v.exam,pattern:{marks:N,cos:T}});y((B==null?void 0:B.updated_at)??null),u("Saved.")}catch(P){f((P==null?void 0:P.message)||"Save failed.")}finally{g(!1)}};return i.jsxs("div",{children:[i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"QP"}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Select the QP/class type option."})]}),i.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:e.map(P=>{const R=P.key===t;return i.jsx("button",{onClick:()=>r(P.key),className:R?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:P.label},P.key)})}),i.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:["CIA1","CIA2","MODEL"].map(P=>{const R=a===P;return i.jsx("button",{onClick:()=>s(P),className:R?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:P==="CIA1"?"CIA 1":P==="CIA2"?"CIA 2":"MODEL"},P)})}),n?i.jsxs("div",{className:"obe-card",style:{padding:12},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:800,marginBottom:6},children:"Selected"}),i.jsx("div",{style:{fontWeight:900,color:"#111827"},children:n.label}),i.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#374151"},children:["Class type: ",i.jsx("strong",{children:n.class_type}),n.question_paper_type?i.jsxs(i.Fragment,{children:[" "," QP: ",i.jsx("strong",{children:n.question_paper_type})]}):null," "," Exam: ",i.jsx("strong",{children:a==="CIA1"?"CIA 1":a==="CIA2"?"CIA 2":"MODEL"})]}),p?i.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Loading saved pattern"}):b?i.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:["Last saved: ",new Date(b).toLocaleString()]}):null]}):null,i.jsxs("div",{className:"obe-card",style:{padding:12,marginTop:12},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"baseline",flexWrap:"wrap",marginBottom:10},children:[i.jsx("div",{style:{fontWeight:900,color:"#111827"},children:"QP Pattern"}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[a==="CIA1"?"CIA 1":a==="CIA2"?"CIA 2":"MODEL","  ",(n==null?void 0:n.label)||t]})]}),d?i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:d}):null,c?i.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:10},children:c}):null,i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"S.No"}),i.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"Marks"}),i.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"CO"}),i.jsx("th",{style:{width:120,borderBottom:"1px solid #e5e7eb"}})]})}),i.jsx("tbody",{children:o.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,style:{padding:10,color:"#6b7280"},children:"No questions yet. Click + to add."})}):o.map((P,R)=>i.jsxs("tr",{children:[i.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6",fontWeight:800},children:R+1}),i.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:i.jsx("input",{className:"obe-input",type:"number",min:0,step:"0.5",value:P.marks,onChange:N=>C(R,N.target.value),placeholder:"Marks",style:{maxWidth:160}})}),i.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:i.jsxs("select",{className:"obe-input",value:String((P==null?void 0:P.co)??""),onChange:N=>j(R,N.target.value),style:{maxWidth:160},children:[i.jsx("option",{value:"",children:"Select"}),a==="MODEL"?i.jsxs(i.Fragment,{children:[i.jsx("option",{value:"1",children:"1"}),i.jsx("option",{value:"2",children:"2"}),i.jsx("option",{value:"3",children:"3"}),i.jsx("option",{value:"4",children:"4"}),i.jsx("option",{value:"5",children:"5"})]}):a==="CIA2"?i.jsxs(i.Fragment,{children:[i.jsx("option",{value:"3",children:"3"}),i.jsx("option",{value:"4",children:"4"}),i.jsx("option",{value:"3&4",children:"3&4"})]}):i.jsxs(i.Fragment,{children:[i.jsx("option",{value:"1",children:"1"}),i.jsx("option",{value:"2",children:"2"}),i.jsx("option",{value:"1&2",children:"1&2"})]})]})}),i.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:i.jsx("button",{type:"button",className:"obe-btn obe-btn-danger",onClick:()=>_(R),children:"Delete"})})]},R))})]})}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:12},children:[i.jsx("button",{type:"button",className:"obe-btn obe-btn-secondary",onClick:w,children:"+"}),i.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",onClick:A,disabled:m,children:m?"Saving":"Save"})]})]})]})}const Hp=["Theory","Lab","Tcpl","Tcpr","Practical","Project","Audit","Special"];function In(e){return String(e??"").trim().toUpperCase()}function uN(e){const t=In(e);return t?!!(t==="LAB"||t==="L"||t.startsWith("LAB")||t.includes("LAB")||t.includes("PRACTICAL")||t.includes("PRACT")):!1}function yre(e){return In(e)==="SPECIAL"}function Pn(e){try{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}}function Sn(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch{}}function gu(e){try{window.localStorage.removeItem(e)}catch{}}const Eu=[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],bre=["THEORY","TCPR","TCPL","LAB","AUDIT","PRACTICAL","SPECIAL"],F5=6,vre=64;function wre(e){const t=In(e);return t==="THEORY"?"Theory":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""}function m9(e){const t=Array.isArray(e)?[...e]:[...Eu];for(;t.length<17;)t.push("");return t.slice(0,17)}function R8(e,t,r,n){const a=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(a)||a<=0||!c)return[0,0,0];const u=Math.round(a*(s||0)/c*100)/100,d=Math.round(a*(o||0)/c*100)/100,f=Math.round(a*(l||0)/c*100)/100;return[u,d,f]}function R5(e,t){let r=Array.isArray(e)?[...e]:[...Eu];if(r.length===13){const[n,a,s]=R8(r[0]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5),[o,l,c]=R8(r[1]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5);r=[n,a,s,o,l,c,...r.slice(2)]}return r=m9(r),r}function Sre(e){const t=In(e);if(t==="LAB"||t==="PRACTICAL")return[{header:"CO1",cols:[{label:"CIA 1",index:1}]},{header:"CO2",cols:[{label:"CIA 1",index:4}]},{header:"CO3",cols:[{label:"CIA 2",index:7}]},{header:"CO4",cols:[{label:"CIA 2",index:10}]},{header:"ME",cols:[{label:"MODEL",index:16}]}];const r=o=>t==="TCPR"?o===1||o===2?"Review 1":"Review 2":t==="TCPL"?o===1||o===2?"LAB 1":"LAB 2":o===1||o===2?"Formative 1":"Formative 2",n=o=>o===1||o===2?"CIA 1":"CIA 2",a=o=>o===1||o===2?"SSA 1":"SSA 2",s=(o,l)=>({header:`CO${o}`,cols:[{label:a(o),index:l},{label:n(o),index:l+1},{label:r(o),index:l+2}]});return[s(1,0),s(2,3),s(3,6),s(4,9),{header:"ME",cols:[{label:"CO1",index:12},{label:"CO2",index:13},{label:"CO3",index:14},{label:"CO4",index:15},{label:"CO5",index:16}]}]}function _re(){const[e,t]=x.useState({}),[r,n]=x.useState(!1),[a,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(null);x.useEffect(()=>{n(!0),l(null),(async()=>{const h=()=>{const g={};for(const b of Hp){const y=In(String(b));let v=1.5,w=3,_=2.5;y==="TCPL"?(v=1,w=3.25,_=3.5):y==="TCPR"?(v=1,w=3.25,_=4):y==="LAB"&&(v=1,w=1,_=1);let C=[...Eu];if(y==="THEORY")C=[...Eu];else if(y==="TCPL"){C=[];for(let j=0;j<4;j++)C.push(v,w,_);C.push(3,3,3,3,7)}else if(y==="TCPR"){C=[];for(let j=0;j<4;j++)C.push(v,w,_);C.push(3,3,3,3,10)}g[y]={ssa1:v,cia1:w,formative1:_,internal_mark_weights:C}}return g.THEORY||(g.THEORY={ssa1:1.5,cia1:3,formative1:2.5,internal_mark_weights:[...Eu]}),g},m=g=>{const b=h();if(!g||typeof g!="object")return b;const y={...b},v=Array.from(new Set([...Hp.map(_=>In(String(_))),"THEORY"])),w=g.THEORY??g.Theory??g.theory??null;w&&typeof w=="object"&&(g.THEORY=w);for(const _ of v){const C=g[_]??g[String(_)]??g[String(_).toUpperCase()]??null;if(!C||typeof C!="object")continue;const j=Array.isArray(C.internal_mark_weights)?C.internal_mark_weights:null,A={ssa1:C.ssa1??y[_].ssa1,cia1:C.cia1??y[_].cia1,formative1:C.formative1??y[_].formative1};y[_]={ssa1:A.ssa1,cia1:A.cia1,formative1:A.formative1,internal_mark_weights:R5(j&&j.length?j:y[_].internal_mark_weights,A)}}return y};try{const b=await(await am(()=>Promise.resolve().then(()=>P8),void 0)).fetchClassTypeWeights(),y=m(b);t(y);return}catch{}try{const g=Pn("iqac_class_type_weights"),b=m(g);t(b)}catch{const g=h();t(g)}finally{n(!1)}})().finally(()=>n(!1))},[]);const d=(h,m,g)=>{t(b=>({...b,[h]:{...b[h],[m]:g}}))},f=(h,m,g)=>{t(b=>{const y=b[h]||{ssa1:"",cia1:"",formative1:"",internal_mark_weights:[...Eu]},v=Array.isArray(y.internal_mark_weights)?[...y.internal_mark_weights]:[...Eu];for(;v.length<17;)v.push("");return v[m]=g,{...b,[h]:{...y,internal_mark_weights:v}}})},p=async()=>{s(!0),l(null),u(null);try{const h={},m=Array.from(new Set([...Hp.map(b=>In(String(b))),"THEORY"]));for(const b of m){const y=e[b]??e[b.toLowerCase()]??e[b.toUpperCase()]??{},v=R5(Array.isArray(y==null?void 0:y.internal_mark_weights)?y.internal_mark_weights:Eu,{ssa1:y==null?void 0:y.ssa1,cia1:y==null?void 0:y.cia1,formative1:y==null?void 0:y.formative1});h[b]={ssa1:Number(y==null?void 0:y.ssa1)||0,cia1:Number(y==null?void 0:y.cia1)||0,formative1:Number(y==null?void 0:y.formative1)||0,internal_mark_weights:m9(v).map((w,_)=>{const C=Number(w);return Number.isFinite(C)?C:Eu[_]??0})}}h.THEORY||(h.THEORY=h.THEORY||null);let g=!1;try{await(await am(()=>Promise.resolve().then(()=>P8),void 0)).upsertClassTypeWeights(h),g=!0}catch{Sn("iqac_class_type_weights",h)}t(h),u(g?"Weights saved to server successfully.":"Saved locally (backend not reachable).")}catch(h){l((h==null?void 0:h.message)||"Failed to save weights")}finally{s(!1)}};return i.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:24},children:[i.jsx("h2",{children:"Class Type Weights"}),i.jsx("p",{children:"Set the weights for each class type. These weights are IQAC-controlled and are not editable by staff."}),r?i.jsx("div",{children:"Loading..."}):i.jsxs("form",{onSubmit:h=>{h.preventDefault(),p()},children:[i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"CO Attainment Weights"}),i.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Used in CO Attainment (SSA/CIA/Formative blend)."})]}),i.jsx("div",{style:{overflowX:"auto",marginBottom:24},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Class Type"}),i.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"SSA1"}),i.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"CIA1"}),i.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Formative1"})]})}),i.jsx("tbody",{children:Hp.map(h=>{var b,y,v;const m=In(String(h)),g=String(h).charAt(0).toUpperCase()+String(h).slice(1);return i.jsxs("tr",{children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:g}),i.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:i.jsx("input",{type:"number",step:"0.1",value:((b=e[m])==null?void 0:b.ssa1)??"",onChange:w=>d(m,"ssa1",w.target.value),required:!0})}),i.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:i.jsx("input",{type:"number",step:"0.1",value:((y=e[m])==null?void 0:y.cia1)??"",onChange:w=>d(m,"cia1",w.target.value),required:!0})}),i.jsxs("td",{style:{border:"1px solid #ccc",padding:8},children:[i.jsx("input",{type:"number",step:"0.1",value:((v=e[m])==null?void 0:v.formative1)??"",onChange:w=>d(m,"formative1",w.target.value),required:!0}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:m==="TCPL"?"Lab":m==="TCPR"?"Review":"Formative"})]})]},m)})})]})}),i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Internal Mark Weightage"}),i.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Inputs are mapped exactly to class-type exam assignments used in Internal Mark calculation."})]}),i.jsx("div",{style:{marginBottom:24},children:bre.map(h=>{const m=In(String(h)),g=e[m],b=R5(Array.isArray(g==null?void 0:g.internal_mark_weights)?g.internal_mark_weights:Eu,g),y=Sre(m),v=y.flatMap(w=>w.cols);return i.jsxs("div",{style:{marginBottom:18,overflowX:"auto"},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:8},children:wre(m)}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:y.map(w=>i.jsx("th",{colSpan:w.cols.length,style:{border:"1px solid #ccc",padding:F5,textAlign:"center",whiteSpace:"nowrap",fontSize:13},children:w.header},w.header))}),i.jsx("tr",{children:v.map(w=>i.jsx("th",{style:{border:"1px solid #ccc",padding:F5,textAlign:"center",whiteSpace:"nowrap",fontSize:12},children:w.label},`${w.label}_${w.index}`))})]}),i.jsx("tbody",{children:i.jsx("tr",{children:v.map(w=>i.jsx("td",{style:{border:"1px solid #ccc",padding:F5,textAlign:"center"},children:i.jsx("input",{type:"number",step:"0.1",value:b[w.index]??"",onChange:_=>f(m,w.index,_.target.value),required:!0,style:{width:vre}})},w.index))})})]})]},m)})}),i.jsx("button",{type:"submit",disabled:a,style:{padding:"8px 18px",fontWeight:700},children:a?"Saving...":"Save"}),o&&i.jsx("div",{style:{color:"red",marginTop:12},children:o}),c&&i.jsx("div",{style:{color:"green",marginTop:12},children:c})]})]})}const B5=[{id:"cia1_co1_co2",label:"CIA 1",cos:["CO1","CO2"],assessment:"cia1"},{id:"cia2_co3_co4",label:"CIA 2",cos:["CO3","CO4"],assessment:"cia2"},{id:"model_co1_co2_co3_co4_co5",label:"MODEL",cos:["CO1","CO2","CO3","CO4","CO5"],assessment:"model"},{id:"model_co3_co4_co5",label:"MODEL",cos:["CO3","CO4","CO5"],assessment:"model"},{id:"model_co5",label:"MODEL",cos:["CO5"],assessment:"model"}];function B8(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?"cia1_co1_co2":t==="cia2_co3_co4"?"cia2_co3_co4":t==="model_co1_co2_co3_co4_co5"?"model_co1_co2_co3_co4_co5":t==="model_co3_co4_co5"?"model_co3_co4_co5":t==="model_co5"?"model_co5":null}function I5(e){const t=new Set,r={cia1_co1_co2:"CIA 1",cia2_co3_co4:"CIA 2",model_co1_co2_co3_co4_co5:"MODEL",model_co3_co4_co5:"MODEL",model_co5:"MODEL"},n=Array.isArray(e)?e:[];for(const a of n){if(typeof a=="string"){const s=B8(a);s&&t.add(s);continue}if(a&&typeof a=="object"){const s=B8(a.id);if(!s)continue;t.add(s);const o=String(a.name||"").trim();o&&(r[s]=o)}}return{selected:t,names:r}}function kre({isOpen:e,onClose:t,onSave:r,currentSelection:n}){const a=I5(n.options),[s,o]=x.useState(a.selected),[l,c]=x.useState(a.names),[u,d]=x.useState(Number(n.divider)||2),[f,p]=x.useState(Number(n.multiplier)||.15),[h,m]=x.useState("");x.useEffect(()=>{const v=I5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),p(Number(n.multiplier)||.15),m("")},[n,e]);const g=v=>{const w=new Set(s);if(w.has(v))w.delete(v),o(w),m("");else{const _=B5.find(C=>C.id===v);if(_){const C=new Set;w.forEach(M=>{const P=B5.find(R=>R.id===M);P&&P.cos.forEach(R=>C.add(R))});const A=_.cos.filter(M=>C.has(M));if(A.length>0){m(`Cannot select this option: ${A.join(", ")} already selected in another option. Only one option per CO is allowed.`);return}w.add(v),o(w),m("")}}},b=()=>{const v=Number(u),w=Number(f);if(!Number.isFinite(v)||v<=0){m("Divider must be a number greater than 0.");return}if(!Number.isFinite(w)||w<0){m("Multiplier must be a number greater than or equal to 0.");return}m("");const _=Array.from(s).map(C=>({id:C,name:String((l==null?void 0:l[C])||"").trim()||void 0}));r({options:_,divider:v,multiplier:w}),t()},y=()=>{m("");const v=I5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),p(Number(n.multiplier)||.15),t()};return e?i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:y,children:i.jsxs("div",{style:{backgroundColor:"white",borderRadius:12,padding:24,maxWidth:500,width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},onClick:v=>v.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[i.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:"CQI Editor"}),i.jsx("button",{onClick:y,style:{background:"transparent",border:"none",fontSize:24,cursor:"pointer",color:"#64748b",padding:0,width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),i.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:20},children:"Select when to show the CQI buttons. Multiple options can be selected as long as COs don't overlap."}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL<58 Divider"}),i.jsx("input",{type:"number",value:String(u),onChange:v=>d(Number(v.target.value)),className:"obe-input",min:.1,step:.1})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL58 Multiplier"}),i.jsx("input",{type:"number",value:String(f),onChange:v=>p(Number(v.target.value)),className:"obe-input",min:0,step:.01})]})]}),h&&i.jsx("div",{style:{padding:12,marginBottom:16,backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,color:"#b91c1c",fontSize:13},children:h}),i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12,marginBottom:24},children:B5.map(v=>i.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:12,padding:16,border:"2px solid",borderColor:s.has(v.id)?"#3b82f6":"#e2e8f0",borderRadius:8,cursor:"pointer",backgroundColor:s.has(v.id)?"#eff6ff":"white",transition:"all 0.2s"},children:[i.jsx("input",{type:"checkbox",checked:s.has(v.id),onChange:()=>g(v.id),style:{marginTop:3,width:18,height:18,cursor:"pointer"}}),i.jsxs("div",{style:{flex:1},children:[i.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12,marginBottom:6},children:[i.jsxs("div",{style:{fontWeight:600,color:"#0f172a"},children:[v.label," - ",v.cos.join(" and ")]}),i.jsxs("div",{style:{minWidth:190},children:[i.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Display name"}),i.jsx("input",{type:"text",value:String((l==null?void 0:l[v.id])||v.label),onChange:w=>{const _=String(w.target.value||"");c(C=>({...C,[v.id]:_}))},className:"obe-input",style:{padding:8},placeholder:v.label})]})]}),i.jsxs("div",{style:{fontSize:13,color:"#64748b"},children:["Show CQI button after ",v.label," exam"]})]})]},v.id))}),i.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[i.jsx("button",{onClick:y,className:"obe-btn",style:{minWidth:80},children:"Cancel"}),i.jsx("button",{onClick:b,className:"obe-btn obe-btn-primary",style:{minWidth:80},children:"Save"})]})]})}):null}function jre(){const e={options:[],divider:2,multiplier:.15},[t,r]=x.useState(!1),[n,a]=x.useState(e),[s,o]=x.useState(!1);x.useEffect(()=>{let c=!0;return o(!0),cS().then(u=>{c&&a({options:Array.isArray(u.options)?u.options:[],divider:Number.isFinite(Number(u.divider))?Number(u.divider):2,multiplier:Number.isFinite(Number(u.multiplier))?Number(u.multiplier):.15})}).catch(()=>{}).finally(()=>{c&&o(!1)}),()=>{c=!1}},[]);const l=async c=>{a(c);try{await ZD({options:Array.isArray(c.options)?c.options:[],divider:c.divider,multiplier:c.multiplier}),window.alert("CQI configuration saved.")}catch{window.alert("Failed to save CQI configuration.")}};return i.jsxs("div",{style:{padding:18},children:[i.jsx("h3",{style:{marginTop:0},children:"CQI Editor"}),i.jsx("div",{style:{color:"#6b7280",marginBottom:12},children:"Edit global CQI defaults for courses."}),i.jsx("div",{style:{display:"flex",gap:8},children:i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>r(!0),disabled:s,children:s?"Loading":"Open CQI Editor"})}),i.jsx(kre,{isOpen:t,onClose:()=>r(!1),onSave:l,currentSelection:n})]})}function Are(){const e=Xo(),t=so(),n=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"dashboard",[a,s]=x.useState(n);x.useEffect(()=>{const l=new URLSearchParams(e.search).get("tab");l&&l!==a&&s(l)},[e.search]);const o=[{key:"dashboard",label:"Dashboard"},{key:"weights",label:"Weights"},{key:"due_dates",label:"OBE Due Dates"},{key:"courses",label:"Courses"},{key:"qp",label:"QP"},{key:"cqi",label:"CQI Editor"}];return i.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic Controller"}),i.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"IQAC tools for OBE oversight."})]}),i.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18,flexWrap:"wrap"},children:o.map(l=>i.jsx("button",{onClick:()=>{s(l.key),t(`/iqac/academic-controller?tab=${encodeURIComponent(l.key)}`)},style:{padding:"8px 12px",borderRadius:8,border:a===l.key?"1px solid #10b981":"1px solid #e5e7eb",background:a===l.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:l.label},l.key))}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a==="dashboard"&&i.jsx("div",{style:{color:"#6b7280"},children:"Dashboard coming soon."}),a==="weights"&&i.jsx(_re,{}),a==="due_dates"&&i.jsx(lN,{}),a==="courses"&&i.jsx(gre,{}),a==="qp"&&i.jsx(xre,{}),a==="cqi"&&i.jsx(jre,{})]})]})}const Nre="https://db.zynix.us",Cre=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":Nre;async function w2(e){const t=encodeURIComponent(String(e||"").trim()),r=await mr(`${Cre}/api/academics/iqac/course-teaching/${t}/`);if(!r.ok)throw new Error("Failed to fetch course teaching map");const n=await r.json();if(Array.isArray(n))return n;const a=n==null?void 0:n.results;return Array.isArray(a)?a:[]}function Ere(){var m;const{courseCode:e}=M0(),t=so(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),[n,a]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(!0),[u,d]=x.useState(null);x.useEffect(()=>{let g=!0;return(async()=>{if(r)try{const[b,y]=await Promise.all([w2(r),sl()]);if(!g)return;a(Array.isArray(b)?b:[]),o(Array.isArray(y)?y:[]),d(null)}catch(b){if(!g)return;a([]),d((b==null?void 0:b.message)||"Failed to load course mapping")}finally{g&&c(!1)}})(),()=>{g=!1}},[r]);const f=((m=n[0])==null?void 0:m.course_name)||r,p=x.useMemo(()=>{const g=new Map;for(const y of n||[]){const v=String((y==null?void 0:y.section_name)||"").trim()||"Section",w=y!=null&&y.academic_year?String(y.academic_year):null,_=`${v}__${w||""}`,C=g.get(_);C?C.items.push(y):g.set(_,{section_name:v,academic_year:w,items:[y]})}const b=Array.from(g.values());b.sort((y,v)=>{const w=y.section_name.localeCompare(v.section_name);return w!==0?w:String(y.academic_year||"").localeCompare(String(v.academic_year||""))});for(const y of b)y.items.sort((v,w)=>{var j,A,M,P;const _=String(((j=v.staff)==null?void 0:j.name)||((A=v.staff)==null?void 0:A.username)||"").trim(),C=String(((M=w.staff)==null?void 0:M.name)||((P=w.staff)==null?void 0:P.username)||"").trim();return _.localeCompare(C)});return b},[n]);async function h(g){if(!g||!window.confirm("Resetting this course will delete all entered exam data for this teaching assignment. This cannot be undone. Proceed?"))return;const y=["ssa1","review1","ssa2","review2","cia1","cia2","formative1","formative2","model"];try{for(const w of y)try{await iN(w,r,g)}catch(_){console.warn("reset assessment failed",w,_)}c(!0);const v=await w2(r);a(Array.isArray(v)?v:[]),d(null),window.alert("Reset completed.")}catch(v){window.alert("Reset failed: "+((v==null?void 0:v.message)||String(v)))}finally{c(!1)}}return i.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[i.jsxs("div",{children:[i.jsx("h2",{style:{margin:0,fontSize:20},children:r}),i.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:f}),i.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Sections and staff mapping."})]}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx(Vi,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"}),i.jsx("button",{className:"obe-btn",onClick:()=>t(`/obe/course/${encodeURIComponent(r)}`),children:"Open OBE (faculty view)"})]})]}),l?i.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):null,u?i.jsx("div",{style:{color:"#b91c1c"},children:u}):null,!l&&!u&&n.length===0?i.jsx("div",{style:{color:"#6b7280"},children:"No active teaching assignments found for this course."}):null,!l&&!u&&n.length>0?i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:p.map(g=>i.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:10},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"baseline"},children:[i.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:g.section_name}),i.jsx("div",{style:{color:"#6b7280",fontSize:13},children:g.academic_year||""})]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:10},children:g.items.map(b=>{var y,v;return i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:10,background:"#fff",display:"flex",flexDirection:"column",gap:8},children:[i.jsx("div",{style:{color:"#111827",fontWeight:800},children:((y=b.staff)==null?void 0:y.name)||((v=b.staff)==null?void 0:v.username)||""}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[b.section_name?`Section: ${b.section_name}`:"",b.academic_year?`    AY: ${b.academic_year}`:"",(()=>{var _,C;const w=(s||[]).find(j=>String((j==null?void 0:j.course_code)||"").trim().toUpperCase()===r.toUpperCase());return w?`    Dept: ${((_=w.department)==null?void 0:_.name)||((C=w.department)==null?void 0:C.code)||""}    Sem: ${w.semester||""}`:""})()]}),i.jsxs("div",{style:{marginTop:2,display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/marks/${encodeURIComponent(String(b.teaching_assignment_id))}`),children:"Open Mark Entry"}),i.jsx("button",{className:"obe-btn",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/obe/${encodeURIComponent(String(b.teaching_assignment_id))}/marks`),children:"Open OBE (view-only)"}),i.jsx("button",{className:"obe-btn",onClick:()=>h(Number(b.teaching_assignment_id)),children:"Reset Course"})]})]},String(b.teaching_assignment_id))})})]},`${g.section_name}__${g.academic_year||""}`))}):null]})}async function Ac(e){const t=`/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/students/`,r=(a,s=800)=>{const o=String(a||""),u=o.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||o.replace(/\s+/g," ").trim();return u.length<=s?u:u.slice(0,s)+" (truncated)"},n=await mr(t,{method:"GET"});if(!n.ok){const a=await n.text();throw new Error(`Roster fetch failed: ${n.status}
${r(a)}`)}return n.json()}const Tre="https://db.zynix.us",B0=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":Tre,S2="obe_assessment_master_config_cache";async function I0(e,t){const r=e.headers.get("content-type")||"";try{if(r.includes("application/json")){const s=await e.json(),o=(s==null?void 0:s.detail)||(s==null?void 0:s.message);if(o)return`${t}: ${o}`}}catch{}if(e.status===401)return`${t}: Authentication required. Please login.`;if(e.status===403)return`${t}: Permission required.`;if(e.status===404)return`${t}: No CDAP found for this course yet. Upload the Excel to create one.`;let n="";try{n=await e.text()}catch{}const a=(n||"").trim();return a&&!a.startsWith("<")?`${t}: ${a}`:`${t}: Server returned ${e.status}.`}async function g9(e,t){const r=typeof t=="number"?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${B0}/api/obe/cdap-revision/${encodeURIComponent(e)}${r}`,a=await mr(n,{method:"GET"});if(!a.ok){const s=await I0(a,"CDAP revision fetch failed");throw new Error(s)}return a.json()}async function I8(e,t){const n=`${B0}/api/obe/articulation-matrix/${encodeURIComponent(e)}`,a=await mr(n,{method:"GET"});if(!a.ok){const s=await I0(a,"Articulation Matrix fetch failed");throw new Error(s)}return a.json()}async function x9(e){const t=(e==null?void 0:e.subjectId)||(e==null?void 0:e.subject_id);if(!t)throw new Error("subjectId is required to save CDAP revision");const r=e==null?void 0:e.teaching_assignment_id,n=typeof r=="number"?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",a=`${B0}/api/obe/cdap-revision/${encodeURIComponent(t)}${n}`,s=await mr(a,{method:"PUT",body:JSON.stringify(e)});if(!s.ok){const o=await I0(s,"CDAP revision save failed");throw new Error(o)}return s.json()}async function y9(){const e=`${B0}/api/obe/active-learning-mapping`,t=await mr(e,{method:"GET"});if(!t.ok){try{const a=window.localStorage.getItem(S2);if(a){const s=JSON.parse(a);if(s&&typeof s=="object")return s}}catch{}const n=await I0(t,"Active learning mapping fetch failed");throw new Error(n)}const r=await t.json();return(r==null?void 0:r.mapping)||{}}async function Pre(e){const t=`${B0}/api/obe/active-learning-mapping`,r=await mr(t,{method:"PUT",body:JSON.stringify({mapping:e})});if(!r.ok){const a=await I0(r,"Active learning mapping save failed");throw new Error(a)}const n=await r.json();return(n==null?void 0:n.mapping)||{}}async function iu(){const e=`${B0}/api/obe/assessment-master-config`,t=await mr(e,{method:"GET"});if(!t.ok){try{const s=window.localStorage.getItem(S2);if(s){const o=JSON.parse(s);if(o&&typeof o=="object")return o}}catch{}const a=await I0(t,"Assessment master config fetch failed");throw new Error(a)}const r=await t.json(),n=(r==null?void 0:r.config)||{};try{window.localStorage.setItem(S2,JSON.stringify(n))}catch{}return n}async function Ore(e){const t=`${B0}/api/obe/assessment-master-config`,r=await mr(t,{method:"PUT",body:JSON.stringify({config:e})});if(!r.ok){const s=await I0(r,"Assessment master config save failed");throw new Error(s)}const n=await r.json(),a=(n==null?void 0:n.config)||{};try{window.localStorage.setItem(S2,JSON.stringify(a))}catch{}return a}function Lre(e,t=3e4){const r=window.setInterval(()=>e(),t);return()=>window.clearInterval(r)}function Mre(e,t){if(!e)return null;const r=new Date(e).getTime();if(!Number.isFinite(r))return null;const n=t?new Date(t).getTime():Date.now();return Number.isFinite(n)?Math.floor((r-n)/1e3):null}function D0(e){if(e==null)return"";const t=Math.max(0,Math.floor(e)),r=Math.floor(t/3600),n=Math.floor(t%3600/60),a=t%60;return r>0?`${r}h ${String(n).padStart(2,"0")}m`:`${n}m ${String(a).padStart(2,"0")}s`}function dh(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:a}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),[f,p]=x.useState(null),h=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),m=async b=>{if(!t||!r)return;const y=!!(b!=null&&b.silent);y||c(!0),y||d(null);try{const v=await sN(t,r,n);o(v);const w=v.remaining_seconds??Mre(v.due_at,v.now);p(w)}catch(v){d((v==null?void 0:v.message)||"Failed to check publish window")}finally{y||c(!1)}};x.useEffect(()=>{o(null),p(null),m()},[h]),x.useEffect(()=>{if((a==null?void 0:a.poll)===!1)return;const b=window.setInterval(()=>{m({silent:!0})},3e4);return()=>window.clearInterval(b)},[h,a==null?void 0:a.poll]),x.useEffect(()=>{if(f==null||f<=0)return;const b=window.setInterval(()=>{p(y=>y==null?y:y<=0?0:y-1)},1e3);return()=>window.clearInterval(b)},[f]);const g=(s==null?void 0:s.publish_allowed)??!0;return{data:s,loading:l,error:u,remainingSeconds:f,publishAllowed:g,refresh:m}}function Ul(e){const{assessment:t,subjectCode:r,scope:n,teachingAssignmentId:a,options:s}=e,[o,l]=x.useState(null),[c,u]=x.useState(!1),[d,f]=x.useState(null),p=x.useMemo(()=>`${t}|${r}|${n}|${a||""}`,[t,r,n,a]),h=async m=>{if(!t||!r||!n)return;const g=!!(m!=null&&m.silent);g||u(!0),g||f(null);try{const b=await Qx(t,r,n,a);l(b)}catch(b){f((b==null?void 0:b.message)||"Failed to check edit window")}finally{g||u(!1)}};return x.useEffect(()=>{l(null),h()},[p]),x.useEffect(()=>{if((s==null?void 0:s.poll)===!1)return;const m=window.setInterval(()=>{h({silent:!0})},3e4);return()=>window.clearInterval(m)},[p,s==null?void 0:s.poll]),{data:o,loading:c,error:d,refresh:h}}function fh(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:a}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),f=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),p=async h=>{if(!t||!r)return;const m=!!(h!=null&&h.silent);m||c(!0),m||d(null);try{const g=await oS(t,r,n);o(g)}catch(g){d((g==null?void 0:g.message)||"Failed to load lock status")}finally{m||c(!1)}};return x.useEffect(()=>{o(null),p()},[f]),x.useEffect(()=>{if((a==null?void 0:a.poll)===!1)return;const h=window.setInterval(()=>{p({silent:!0})},3e4);return()=>window.clearInterval(h)},[f,a==null?void 0:a.poll]),{data:s,loading:l,error:u,refresh:p}}function Fre({size:e=22}){return i.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,focusable:"false",children:[i.jsx("path",{d:"M7 10V8a5 5 0 0 1 10 0v2",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"}),i.jsx("path",{d:"M6.5 10h11A2.5 2.5 0 0 1 20 12.5v6A2.5 2.5 0 0 1 17.5 21h-11A2.5 2.5 0 0 1 4 18.5v-6A2.5 2.5 0 0 1 6.5 10Z",fill:"#F3F4F6",stroke:"#111827",strokeWidth:"1.2"}),i.jsx("path",{d:"M12 14.2v2.6",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"})]})}function Gm({locked:e,title:t,subtitle:r,children:n}){return e?i.jsxs("div",{style:{position:"relative"},children:[i.jsx("div",{children:n}),i.jsx("div",{style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",padding:16,background:"transparent",backdropFilter:"none",pointerEvents:"none"},children:i.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",background:"#ffffff",border:"2px solid #e5e7eb",borderRadius:14,padding:"14px 18px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",maxWidth:520},children:[i.jsx("div",{style:{width:38,height:38,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #fde68a",flex:"0 0 auto"},children:i.jsx(Fre,{size:22})}),i.jsxs("div",{style:{minWidth:0},children:[i.jsx("div",{style:{fontWeight:900,color:"#111827"},children:t||"Locked by IQAC"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:r||"Publishing is turned OFF globally for this assessment."})]})]})})]}):i.jsx(i.Fragment,{children:n})}function Km({children:e}){const t={minHeight:"100vh",background:"linear-gradient(180deg, #f0f9ff 0%, #ffffff 65%)",padding:"18px 14px"},r={maxWidth:1400,margin:"0 auto"},n={border:"1px solid rgba(15,23,42,0.08)",borderRadius:16,background:"rgba(255,255,255,0.88)",boxShadow:"0 12px 30px rgba(15,23,42,0.08)",padding:16,backdropFilter:"blur(10px)",overflowX:"hidden"};return i.jsx("div",{style:t,children:i.jsx("div",{style:{...r,...n},children:e})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var _2={};_2.version="0.18.5";var b9=1252,Rre=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],dN={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fN=function(e){Rre.indexOf(e)!=-1&&(b9=dN[0]=e)};function Bre(){fN(1252)}var Vc=function(e){fN(e)};function hN(){Vc(1200),Bre()}function D8(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Ire(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function v9(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var rx=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Ire(e.slice(2)):t==254&&r==255?v9(e.slice(2)):t==65279?e.slice(1):e},fb=function(t){return String.fromCharCode(t)},$8=function(t){return String.fromCharCode(t)},Zx,Mf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function e1(e){for(var t="",r=0,n=0,a=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,a=e.charCodeAt(u++),l=(n&15)<<2|a>>6,c=a&63,isNaN(n)?l=c=64:isNaN(a)&&(c=64),t+=Mf.charAt(s)+Mf.charAt(o)+Mf.charAt(l)+Mf.charAt(c);return t}function zl(e){var t="",r=0,n=0,a=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Mf.indexOf(e.charAt(u++)),o=Mf.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=Mf.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Mf.indexOf(e.charAt(u++)),a=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var Xn=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Gd=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function eh(e){return Xn?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function U8(e){return Xn?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ol=function(t){return Xn?Gd(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function pS(e){if(typeof ArrayBuffer>"u")return Ol(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function hh(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Dre(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function pN(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return pN(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Bs=Xn?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Gd(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function $re(e){for(var t=[],r=0,n=e.length+250,a=eh(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)a[r++]=o;else if(o<2048)a[r++]=192|o>>6&31,a[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;a[r++]=240|o>>8&7,a[r++]=128|o>>2&63,a[r++]=128|l>>6&15|(o&3)<<4,a[r++]=128|l&63}else a[r++]=224|o>>12&15,a[r++]=128|o>>6&63,a[r++]=128|o&63;r>n&&(t.push(a.slice(0,r)),r=0,a=eh(65535),n=65530)}return t.push(a.slice(0,r)),Bs(t)}var Wo=/\u0000/g,nx=/[\u0001-\u0006]/g;function om(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Gc(e,t){var r=""+e;return r.length>=t?r:Mi("0",t-r.length)+r}function mN(e,t){var r=""+e;return r.length>=t?r:Mi(" ",t-r.length)+r}function k2(e,t){var r=""+e;return r.length>=t?r:r+Mi(" ",t-r.length)}function Ure(e,t){var r=""+Math.round(e);return r.length>=t?r:Mi("0",t-r.length)+r}function zre(e,t){var r=""+e;return r.length>=t?r:Mi("0",t-r.length)+r}var z8=Math.pow(2,32);function ip(e,t){if(e>z8||e<-z8)return Ure(e,t);var r=Math.round(e);return zre(r,t)}function j2(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var W8=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],D5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Wre(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var kn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},q8={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qre={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function A2(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(a);u<t&&(f=Math.floor(a),l=f*o+s,d=f*u+c,!(a-f<5e-8));)a=1/(a-f),s=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var p=Math.floor(n*l/d);return[p,n*l-p*d,d]}function Wh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=Yre(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=s,l}var w9=new Date(1899,11,31,0,0,0),Hre=w9.getTime(),Vre=new Date(1900,2,1,0,0,0);function S9(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Vre&&(r+=24*60*60*1e3),(r-(Hre+(e.getTimezoneOffset()-w9.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function gN(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Gre(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Kre(e){var t=e<0?12:11,r=gN(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Xre(e){var t=gN(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function t1(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Kre(e):t===10?r=e.toFixed(10).substr(0,12):r=Xre(e),gN(Gre(r.toUpperCase()))}function p0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):t1(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return vc(14,S9(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Yre(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Qre(e,t,r,n){var a="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return D5[r.m-1][1];case 5:return D5[r.m-1][0];default:return D5[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return W8[r.q][0];default:return W8[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Gc(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(a=Gc(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?Gc(c,u):"";return d}function Ff(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var _9=/%/g;function Jre(e,t,r){var n=t.replace(_9,""),a=t.length-n.length;return _d(e,n,r*Math.pow(10,2*a))+Mi("%",a)}function Zre(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _d(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function k9(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+k9(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var j9=/# (\?+)( ?)\/( ?)(\d+)/;function ene(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),o=a-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?Mi(" ",e[1].length+1+e[4].length):mN(o,e[1].length)+e[2]+"/"+e[3]+Gc(l,e[4].length))}function tne(e,t,r){return r+(t===0?"":""+t)+Mi(" ",e[1].length+2+e[4].length)}var A9=/^#*0*\.([0#]+)/,N9=/\).*[0#]/,C9=/\(###\) ###\\?-####/;function Io(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function H8(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function V8(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function rne(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function nne(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ac(e,t,r){if(e.charCodeAt(0)===40&&!t.match(N9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ac("n",n,r):"("+ac("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Zre(e,t,r);if(t.indexOf("%")!==-1)return Jre(e,t,r);if(t.indexOf("E")!==-1)return k9(t,r);if(t.charCodeAt(0)===36)return"$"+ac(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ip(c,t.length);if(t.match(/^[#?]+$/))return a=ip(r,0),a==="0"&&(a=""),a.length>t.length?a:Io(t.substr(0,t.length-a.length))+a;if(s=t.match(j9))return ene(s,c,u);if(t.match(/^#+0+$/))return u+ip(c,t.length-t.indexOf("0"));if(s=t.match(A9))return a=H8(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Io(s[1])).replace(/\.$/,"."+Io(s[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+Mi("0",Io(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+H8(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Ff(ip(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ac(e,t,-r):Ff(""+(Math.floor(r)+rne(r,s[1].length)))+"."+Gc(V8(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return ac(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=om(ac(e,t.replace(/[\\-]/g,""),r)),o=0,om(om(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(t.match(C9))return a=ac(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=A2(c,Math.pow(10,o)-1,!1),a=""+u,d=_d("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=k2(l[2],o),d.length<s[4].length&&(d=Io(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=A2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?mN(l[1],o)+s[2]+"/"+s[3]+k2(l[2],o):Mi(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=ip(r,0),t.length<=a.length?a:Io(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=t.indexOf(".")-o,p=t.length-a.length-f;return Io(t.substr(0,f)+a+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=V8(r,s[1].length),r<0?"-"+ac(e,t,-r):Ff(nne(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Gc(0,3-m.length):"")+m})+"."+Gc(o,s[1].length);switch(t){case"###,##0.00":return ac(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Ff(ip(c,0));return h!=="0"?u+h:"";case"###,###.00":return ac(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ac(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ane(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return _d(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ine(e,t,r){var n=t.replace(_9,""),a=t.length-n.length;return _d(e,n,r*Math.pow(10,2*a))+Mi("%",a)}function E9(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+E9(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(a+s)%a)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ku(e,t,r){if(e.charCodeAt(0)===40&&!t.match(N9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ku("n",n,r):"("+ku("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ane(e,t,r);if(t.indexOf("%")!==-1)return ine(e,t,r);if(t.indexOf("E")!==-1)return E9(t,r);if(t.charCodeAt(0)===36)return"$"+ku(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Gc(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Io(t.substr(0,t.length-a.length))+a;if(s=t.match(j9))return tne(s,c,u);if(t.match(/^#+0+$/))return u+Gc(c,t.length-t.indexOf("0"));if(s=t.match(A9))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Io(s[1])).replace(/\.$/,"."+Io(s[1])),a=a.replace(/\.(\d*)$/,function(m,g){return"."+g+Mi("0",Io(s[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Ff(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ku(e,t,-r):Ff(""+r)+"."+Mi("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ku(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=om(ku(e,t.replace(/[\\-]/g,""),r)),o=0,om(om(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<a.length?a.charAt(o++):m==="0"?"0":""}));if(t.match(C9))return a=ku(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=A2(c,Math.pow(10,o)-1,!1),a=""+u,d=_d("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],d=k2(l[2],o),d.length<s[4].length&&(d=Io(s[4].substr(s[4].length-d.length))+d),a+=d,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=A2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?mN(l[1],o)+s[2]+"/"+s[3]+k2(l[2],o):Mi(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Io(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=t.indexOf(".")-o,p=t.length-a.length-f;return Io(t.substr(0,f)+a+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ku(e,t,-r):Ff(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Gc(0,3-m.length):"")+m})+"."+Gc(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Ff(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return ku(e,t.slice(0,t.lastIndexOf(".")),r)+Io(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _d(e,t,r){return(r|0)===r?ku(e,t,r):ac(e,t,r)}function sne(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var T9=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Xm(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":j2(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(T9))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function one(e,t,r,n){for(var a=[],s="",o=0,l="",c="t",u,d,f,p="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!j2(e,o))throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);a[a.length]={t:"t",v:s},++o;break;case"\\":var h=e.charAt(++o),m=h==="("||h===")"?h:"t";a[a.length]={t:m,v:h},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Wh(t,r,e.charAt(o+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Wh(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),a[a.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var g={t:l,v:l};if(u==null&&(u=Wh(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",o+=5,p="h"):(g.t="t",++o),u==null&&g.t==="T")return"";a[a.length]=g,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(T9)){if(u==null&&(u=Wh(t,r),u==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Xm(e)||(a[a.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;a[a.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;a[a.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);a[a.length]={t:"t",v:l},++o;break}var b=0,y=0,v;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=p,c="h",b<1&&(b=1);break;case"s":(v=a[o].v.match(/\.0+$/))&&(y=Math.max(y,v[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[o].v.match(/[Hh]/)&&(b=1),b<2&&a[o].v.match(/[Mm]/)&&(b=2),b<3&&a[o].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",_;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=Qre(a[o].t.charCodeAt(0),a[o].v,u,y),a[o].t="t";break;case"n":case"?":for(_=o+1;a[_]!=null&&((l=a[_].t)==="?"||l==="D"||(l===" "||l==="t")&&a[_+1]!=null&&(a[_+1].t==="?"||a[_+1].t==="t"&&a[_+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[_].v==="/"||a[_].v===" "&&a[_+1]!=null&&a[_+1].t=="?"));)a[o].v+=a[_].v,a[_]={v:"",t:";"},++_;w+=a[o].v,o=_-1;break;case"G":a[o].t="t",a[o].v=p0(t,r);break}var C="",j,A;if(w.length>0){w.charCodeAt(0)==40?(j=t<0&&w.charCodeAt(0)===45?-t:t,A=_d("n",w,j)):(j=t<0&&n>1?-t:t,A=_d("n",w,j),j<0&&a[0]&&a[0].t=="t"&&(A=A.substr(1),a[0].v="-"+a[0].v)),_=A.length-1;var M=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){M=o;break}var P=a.length;if(M===a.length&&A.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(_>=a[o].v.length-1?(_-=a[o].v.length,a[o].v=A.substr(_+1,a[o].v.length)):_<0?a[o].v="":(a[o].v=A.substr(0,_+1),_=-1),a[o].t="t",P=o);_>=0&&P<a.length&&(a[P].v=A.substr(0,_+1)+a[P].v)}else if(M!==a.length&&A.indexOf("E")===-1){for(_=A.indexOf(".")-1,o=M;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===M?a[o].v.indexOf(".")-1:a[o].v.length-1,C=a[o].v.substr(d+1);d>=0;--d)_>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(C=A.charAt(_--)+C);a[o].v=C,a[o].t="t",P=o}for(_>=0&&P<a.length&&(a[P].v=A.substr(0,_+1)+a[P].v),_=A.indexOf(".")+1,o=M;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==M)){for(d=a[o].v.indexOf(".")>-1&&o===M?a[o].v.indexOf(".")+1:0,C=a[o].v.substr(0,d);d<a[o].v.length;++d)_<A.length&&(C+=A.charAt(_++));a[o].v=C,a[o].t="t",P=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(j=n>1&&t<0&&o>0&&a[o-1].v==="-"?-t:t,a[o].v=_d(a[o].t,a[o].v,j),a[o].t="t");var R="";for(o=0;o!==a.length;++o)a[o]!=null&&(R+=a[o].v);return R}var G8=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function K8(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function lne(e,t){var r=sne(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(G8),l=r[1].match(G8);return K8(t,o)?[n,r[0]]:K8(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function vc(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:kn)[e],n==null&&(n=r.table&&r.table[q8[e]]||kn[q8[e]]),n==null&&(n=qre[e]||"General");break}if(j2(n,0))return p0(t,r);t instanceof Date&&(t=S9(t,r.date1904));var a=lne(n,t);if(j2(a[1]))return p0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return one(a[1],t,r,a[0])}function kd(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(kn[r]==null){t<0&&(t=r);continue}if(kn[r]==e){t=r;break}}t<0&&(t=391)}return kn[t]=e,t}function mS(e){for(var t=0;t!=392;++t)e[t]!==void 0&&kd(e[t],t)}function Ym(){kn=Wre()}var cne={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},P9=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function une(e){var t=typeof e=="number"?kn[e]:e;return t=t.replace(P9,"(\\d+)"),new RegExp("^"+t+"$")}function dne(e,t,r){var n=-1,a=-1,s=-1,o=-1,l=-1,c=-1;(t.match(P9)||[]).forEach(function(f,p){var h=parseInt(r[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:a=h;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&a==-1&&s==-1?d:u+"T"+d}var fne=function(){var e={};e.version="1.2.0";function t(){for(var A=0,M=new Array(256),P=0;P!=256;++P)A=P,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,M[P]=A;return typeof Int32Array<"u"?new Int32Array(M):M}var r=t();function n(A){var M=0,P=0,R=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)N[R]=A[R];for(R=0;R!=256;++R)for(P=A[R],M=256+R;M<4096;M+=256)P=N[M]=P>>>8^A[P&255];var T=[];for(R=1;R!=16;++R)T[R-1]=typeof Int32Array<"u"?N.subarray(R*256,R*256+256):N.slice(R*256,R*256+256);return T}var a=n(r),s=a[0],o=a[1],l=a[2],c=a[3],u=a[4],d=a[5],f=a[6],p=a[7],h=a[8],m=a[9],g=a[10],b=a[11],y=a[12],v=a[13],w=a[14];function _(A,M){for(var P=M^-1,R=0,N=A.length;R<N;)P=P>>>8^r[(P^A.charCodeAt(R++))&255];return~P}function C(A,M){for(var P=M^-1,R=A.length-15,N=0;N<R;)P=w[A[N++]^P&255]^v[A[N++]^P>>8&255]^y[A[N++]^P>>16&255]^b[A[N++]^P>>>24]^g[A[N++]]^m[A[N++]]^h[A[N++]]^p[A[N++]]^f[A[N++]]^d[A[N++]]^u[A[N++]]^c[A[N++]]^l[A[N++]]^o[A[N++]]^s[A[N++]]^r[A[N++]];for(R+=15;N<R;)P=P>>>8^r[(P^A[N++])&255];return~P}function j(A,M){for(var P=M^-1,R=0,N=A.length,T=0,B=0;R<N;)T=A.charCodeAt(R++),T<128?P=P>>>8^r[(P^T)&255]:T<2048?(P=P>>>8^r[(P^(192|T>>6&31))&255],P=P>>>8^r[(P^(128|T&63))&255]):T>=55296&&T<57344?(T=(T&1023)+64,B=A.charCodeAt(R++)&1023,P=P>>>8^r[(P^(240|T>>8&7))&255],P=P>>>8^r[(P^(128|T>>2&63))&255],P=P>>>8^r[(P^(128|B>>6&15|(T&3)<<4))&255],P=P>>>8^r[(P^(128|B&63))&255]):(P=P>>>8^r[(P^(224|T>>12&15))&255],P=P>>>8^r[(P^(128|T>>6&63))&255],P=P>>>8^r[(P^(128|T&63))&255]);return~P}return e.table=r,e.bstr=_,e.buf=C,e.str=j,e}(),wn=function(){var t={};t.version="1.2.1";function r(oe,ue){for(var Q=oe.split("/"),ye=ue.split("/"),je=0,Ce=0,ot=Math.min(Q.length,ye.length);je<ot;++je){if(Ce=Q[je].length-ye[je].length)return Ce;if(Q[je]!=ye[je])return Q[je]<ye[je]?-1:1}return Q.length-ye.length}function n(oe){if(oe.charAt(oe.length-1)=="/")return oe.slice(0,-1).indexOf("/")===-1?oe:n(oe.slice(0,-1));var ue=oe.lastIndexOf("/");return ue===-1?oe:oe.slice(0,ue+1)}function a(oe){if(oe.charAt(oe.length-1)=="/")return a(oe.slice(0,-1));var ue=oe.lastIndexOf("/");return ue===-1?oe:oe.slice(ue+1)}function s(oe,ue){typeof ue=="string"&&(ue=new Date(ue));var Q=ue.getHours();Q=Q<<6|ue.getMinutes(),Q=Q<<5|ue.getSeconds()>>>1,oe.write_shift(2,Q);var ye=ue.getFullYear()-1980;ye=ye<<4|ue.getMonth()+1,ye=ye<<5|ue.getDate(),oe.write_shift(2,ye)}function o(oe){var ue=oe.read_shift(2)&65535,Q=oe.read_shift(2)&65535,ye=new Date,je=Q&31;Q>>>=5;var Ce=Q&15;Q>>>=4,ye.setMilliseconds(0),ye.setFullYear(Q+1980),ye.setMonth(Ce-1),ye.setDate(je);var ot=ue&31;ue>>>=5;var it=ue&63;return ue>>>=6,ye.setHours(ue),ye.setMinutes(it),ye.setSeconds(ot<<1),ye}function l(oe){to(oe,0);for(var ue={},Q=0;oe.l<=oe.length-4;){var ye=oe.read_shift(2),je=oe.read_shift(2),Ce=oe.l+je,ot={};switch(ye){case 21589:Q=oe.read_shift(1),Q&1&&(ot.mtime=oe.read_shift(4)),je>5&&(Q&2&&(ot.atime=oe.read_shift(4)),Q&4&&(ot.ctime=oe.read_shift(4))),ot.mtime&&(ot.mt=new Date(ot.mtime*1e3));break}oe.l=Ce,ue[ye]=ot}return ue}var c;function u(){return c||(c={})}function d(oe,ue){if(oe[0]==80&&oe[1]==75)return ur(oe,ue);if((oe[0]|32)==109&&(oe[1]|32)==105)return Ne(oe,ue);if(oe.length<512)throw new Error("CFB file size "+oe.length+" < 512");var Q=3,ye=512,je=0,Ce=0,ot=0,it=0,We=0,De=[],pe=oe.slice(0,512);to(pe,0);var Je=f(pe);switch(Q=Je[0],Q){case 3:ye=512;break;case 4:ye=4096;break;case 0:if(Je[1]==0)return ur(oe,ue);default:throw new Error("Major Version: Expected 3 or 4 saw "+Q)}ye!==512&&(pe=oe.slice(0,ye),to(pe,28));var Ge=oe.slice(0,ye);p(pe,Q);var Ye=pe.read_shift(4,"i");if(Q===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);pe.l+=4,ot=pe.read_shift(4,"i"),pe.l+=4,pe.chk("00100000","Mini Stream Cutoff Size: "),it=pe.read_shift(4,"i"),je=pe.read_shift(4,"i"),We=pe.read_shift(4,"i"),Ce=pe.read_shift(4,"i");for(var ft=-1,bt=0;bt<109&&(ft=pe.read_shift(4,"i"),!(ft<0));++bt)De[bt]=ft;var Vt=h(oe,ye);b(We,Ce,Vt,ye,De);var Ft=v(Vt,ot,De,ye);Ft[ot].name="!Directory",je>0&&it!==B&&(Ft[it].name="!MiniFAT"),Ft[De[0]].name="!FAT",Ft.fat_addrs=De,Ft.ssz=ye;var gr={},Ar=[],kr=[],At=[];w(ot,Ft,Vt,Ar,je,gr,kr,it),m(kr,At,Ar),Ar.shift();var Ut={FileIndex:kr,FullPaths:At};return ue&&ue.raw&&(Ut.raw={header:Ge,sectors:Vt}),Ut}function f(oe){if(oe[oe.l]==80&&oe[oe.l+1]==75)return[0,0];oe.chk(G,"Header Signature: "),oe.l+=16;var ue=oe.read_shift(2,"u");return[oe.read_shift(2,"u"),ue]}function p(oe,ue){var Q=9;switch(oe.l+=2,Q=oe.read_shift(2)){case 9:if(ue!=3)throw new Error("Sector Shift: Expected 9 saw "+Q);break;case 12:if(ue!=4)throw new Error("Sector Shift: Expected 12 saw "+Q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Q)}oe.chk("0600","Mini Sector Shift: "),oe.chk("000000000000","Reserved: ")}function h(oe,ue){for(var Q=Math.ceil(oe.length/ue)-1,ye=[],je=1;je<Q;++je)ye[je-1]=oe.slice(je*ue,(je+1)*ue);return ye[Q-1]=oe.slice(Q*ue),ye}function m(oe,ue,Q){for(var ye=0,je=0,Ce=0,ot=0,it=0,We=Q.length,De=[],pe=[];ye<We;++ye)De[ye]=pe[ye]=ye,ue[ye]=Q[ye];for(;it<pe.length;++it)ye=pe[it],je=oe[ye].L,Ce=oe[ye].R,ot=oe[ye].C,De[ye]===ye&&(je!==-1&&De[je]!==je&&(De[ye]=De[je]),Ce!==-1&&De[Ce]!==Ce&&(De[ye]=De[Ce])),ot!==-1&&(De[ot]=ye),je!==-1&&ye!=De[ye]&&(De[je]=De[ye],pe.lastIndexOf(je)<it&&pe.push(je)),Ce!==-1&&ye!=De[ye]&&(De[Ce]=De[ye],pe.lastIndexOf(Ce)<it&&pe.push(Ce));for(ye=1;ye<We;++ye)De[ye]===ye&&(Ce!==-1&&De[Ce]!==Ce?De[ye]=De[Ce]:je!==-1&&De[je]!==je&&(De[ye]=De[je]));for(ye=1;ye<We;++ye)if(oe[ye].type!==0){if(it=ye,it!=De[it])do it=De[it],ue[ye]=ue[it]+"/"+ue[ye];while(it!==0&&De[it]!==-1&&it!=De[it]);De[ye]=-1}for(ue[0]+="/",ye=1;ye<We;++ye)oe[ye].type!==2&&(ue[ye]+="/")}function g(oe,ue,Q){for(var ye=oe.start,je=oe.size,Ce=[],ot=ye;Q&&je>0&&ot>=0;)Ce.push(ue.slice(ot*T,ot*T+T)),je-=T,ot=Rh(Q,ot*4);return Ce.length===0?yr(0):Bs(Ce).slice(0,oe.size)}function b(oe,ue,Q,ye,je){var Ce=B;if(oe===B){if(ue!==0)throw new Error("DIFAT chain shorter than expected")}else if(oe!==-1){var ot=Q[oe],it=(ye>>>2)-1;if(!ot)return;for(var We=0;We<it&&(Ce=Rh(ot,We*4))!==B;++We)je.push(Ce);b(Rh(ot,ye-4),ue-1,Q,ye,je)}}function y(oe,ue,Q,ye,je){var Ce=[],ot=[];je||(je=[]);var it=ye-1,We=0,De=0;for(We=ue;We>=0;){je[We]=!0,Ce[Ce.length]=We,ot.push(oe[We]);var pe=Q[Math.floor(We*4/ye)];if(De=We*4&it,ye<4+De)throw new Error("FAT boundary crossed: "+We+" 4 "+ye);if(!oe[pe])break;We=Rh(oe[pe],De)}return{nodes:Ce,data:sP([ot])}}function v(oe,ue,Q,ye){var je=oe.length,Ce=[],ot=[],it=[],We=[],De=ye-1,pe=0,Je=0,Ge=0,Ye=0;for(pe=0;pe<je;++pe)if(it=[],Ge=pe+ue,Ge>=je&&(Ge-=je),!ot[Ge]){We=[];var ft=[];for(Je=Ge;Je>=0;){ft[Je]=!0,ot[Je]=!0,it[it.length]=Je,We.push(oe[Je]);var bt=Q[Math.floor(Je*4/ye)];if(Ye=Je*4&De,ye<4+Ye)throw new Error("FAT boundary crossed: "+Je+" 4 "+ye);if(!oe[bt]||(Je=Rh(oe[bt],Ye),ft[Je]))break}Ce[Ge]={nodes:it,data:sP([We])}}return Ce}function w(oe,ue,Q,ye,je,Ce,ot,it){for(var We=0,De=ye.length?2:0,pe=ue[oe].data,Je=0,Ge=0,Ye;Je<pe.length;Je+=128){var ft=pe.slice(Je,Je+128);to(ft,64),Ge=ft.read_shift(2),Ye=_N(ft,0,Ge-De),ye.push(Ye);var bt={name:Ye,type:ft.read_shift(1),color:ft.read_shift(1),L:ft.read_shift(4,"i"),R:ft.read_shift(4,"i"),C:ft.read_shift(4,"i"),clsid:ft.read_shift(16),state:ft.read_shift(4,"i"),start:0,size:0},Vt=ft.read_shift(2)+ft.read_shift(2)+ft.read_shift(2)+ft.read_shift(2);Vt!==0&&(bt.ct=_(ft,ft.l-8));var Ft=ft.read_shift(2)+ft.read_shift(2)+ft.read_shift(2)+ft.read_shift(2);Ft!==0&&(bt.mt=_(ft,ft.l-8)),bt.start=ft.read_shift(4,"i"),bt.size=ft.read_shift(4,"i"),bt.size<0&&bt.start<0&&(bt.size=bt.type=0,bt.start=B,bt.name=""),bt.type===5?(We=bt.start,je>0&&We!==B&&(ue[We].name="!StreamData")):bt.size>=4096?(bt.storage="fat",ue[bt.start]===void 0&&(ue[bt.start]=y(Q,bt.start,ue.fat_addrs,ue.ssz)),ue[bt.start].name=bt.name,bt.content=ue[bt.start].data.slice(0,bt.size)):(bt.storage="minifat",bt.size<0?bt.size=0:We!==B&&bt.start!==B&&ue[We]&&(bt.content=g(bt,ue[We].data,(ue[it]||{}).data))),bt.content&&to(bt.content,0),Ce[Ye]=bt,ot.push(bt)}}function _(oe,ue){return new Date((Pl(oe,ue+4)/1e7*Math.pow(2,32)+Pl(oe,ue)/1e7-11644473600)*1e3)}function C(oe,ue){return u(),d(c.readFileSync(oe),ue)}function j(oe,ue){var Q=ue&&ue.type;switch(Q||Xn&&Buffer.isBuffer(oe)&&(Q="buffer"),Q||"base64"){case"file":return C(oe,ue);case"base64":return d(Ol(zl(oe)),ue);case"binary":return d(Ol(oe),ue)}return d(oe,ue)}function A(oe,ue){var Q=ue||{},ye=Q.root||"Root Entry";if(oe.FullPaths||(oe.FullPaths=[]),oe.FileIndex||(oe.FileIndex=[]),oe.FullPaths.length!==oe.FileIndex.length)throw new Error("inconsistent CFB structure");oe.FullPaths.length===0&&(oe.FullPaths[0]=ye+"/",oe.FileIndex[0]={name:ye,type:5}),Q.CLSID&&(oe.FileIndex[0].clsid=Q.CLSID),M(oe)}function M(oe){var ue="Sh33tJ5";if(!wn.find(oe,"/"+ue)){var Q=yr(4);Q[0]=55,Q[1]=Q[3]=50,Q[2]=54,oe.FileIndex.push({name:ue,type:2,content:Q,size:4,L:69,R:69,C:69}),oe.FullPaths.push(oe.FullPaths[0]+ue),P(oe)}}function P(oe,ue){A(oe);for(var Q=!1,ye=!1,je=oe.FullPaths.length-1;je>=0;--je){var Ce=oe.FileIndex[je];switch(Ce.type){case 0:ye?Q=!0:(oe.FileIndex.pop(),oe.FullPaths.pop());break;case 1:case 2:case 5:ye=!0,isNaN(Ce.R*Ce.L*Ce.C)&&(Q=!0),Ce.R>-1&&Ce.L>-1&&Ce.R==Ce.L&&(Q=!0);break;default:Q=!0;break}}if(!(!Q&&!ue)){var ot=new Date(1987,1,19),it=0,We=Object.create?Object.create(null):{},De=[];for(je=0;je<oe.FullPaths.length;++je)We[oe.FullPaths[je]]=!0,oe.FileIndex[je].type!==0&&De.push([oe.FullPaths[je],oe.FileIndex[je]]);for(je=0;je<De.length;++je){var pe=n(De[je][0]);ye=We[pe],ye||(De.push([pe,{name:a(pe).replace("/",""),type:1,clsid:xe,ct:ot,mt:ot,content:null}]),We[pe]=!0)}for(De.sort(function(Ye,ft){return r(Ye[0],ft[0])}),oe.FullPaths=[],oe.FileIndex=[],je=0;je<De.length;++je)oe.FullPaths[je]=De[je][0],oe.FileIndex[je]=De[je][1];for(je=0;je<De.length;++je){var Je=oe.FileIndex[je],Ge=oe.FullPaths[je];if(Je.name=a(Ge).replace("/",""),Je.L=Je.R=Je.C=-(Je.color=1),Je.size=Je.content?Je.content.length:0,Je.start=0,Je.clsid=Je.clsid||xe,je===0)Je.C=De.length>1?1:-1,Je.size=0,Je.type=5;else if(Ge.slice(-1)=="/"){for(it=je+1;it<De.length&&n(oe.FullPaths[it])!=Ge;++it);for(Je.C=it>=De.length?-1:it,it=je+1;it<De.length&&n(oe.FullPaths[it])!=n(Ge);++it);Je.R=it>=De.length?-1:it,Je.type=1}else n(oe.FullPaths[je+1]||"")==n(Ge)&&(Je.R=je+1),Je.type=2}}}function R(oe,ue){var Q=ue||{};if(Q.fileType=="mad")return dt(oe,Q);switch(P(oe),Q.fileType){case"zip":return Rr(oe,Q)}var ye=function(Ye){for(var ft=0,bt=0,Vt=0;Vt<Ye.FileIndex.length;++Vt){var Ft=Ye.FileIndex[Vt];if(Ft.content){var gr=Ft.content.length;gr>0&&(gr<4096?ft+=gr+63>>6:bt+=gr+511>>9)}}for(var Ar=Ye.FullPaths.length+3>>2,kr=ft+7>>3,At=ft+127>>7,Ut=kr+bt+Ar+At,Kr=Ut+127>>7,$t=Kr<=109?0:Math.ceil((Kr-109)/127);Ut+Kr+$t+127>>7>Kr;)$t=++Kr<=109?0:Math.ceil((Kr-109)/127);var fr=[1,$t,Kr,At,Ar,bt,ft,0];return Ye.FileIndex[0].size=ft<<6,fr[7]=(Ye.FileIndex[0].start=fr[0]+fr[1]+fr[2]+fr[3]+fr[4]+fr[5])+(fr[6]+7>>3),fr}(oe),je=yr(ye[7]<<9),Ce=0,ot=0;{for(Ce=0;Ce<8;++Ce)je.write_shift(1,re[Ce]);for(Ce=0;Ce<8;++Ce)je.write_shift(2,0);for(je.write_shift(2,62),je.write_shift(2,3),je.write_shift(2,65534),je.write_shift(2,9),je.write_shift(2,6),Ce=0;Ce<3;++Ce)je.write_shift(2,0);for(je.write_shift(4,0),je.write_shift(4,ye[2]),je.write_shift(4,ye[0]+ye[1]+ye[2]+ye[3]-1),je.write_shift(4,0),je.write_shift(4,4096),je.write_shift(4,ye[3]?ye[0]+ye[1]+ye[2]-1:B),je.write_shift(4,ye[3]),je.write_shift(-4,ye[1]?ye[0]-1:B),je.write_shift(4,ye[1]),Ce=0;Ce<109;++Ce)je.write_shift(-4,Ce<ye[2]?ye[1]+Ce:-1)}if(ye[1])for(ot=0;ot<ye[1];++ot){for(;Ce<236+ot*127;++Ce)je.write_shift(-4,Ce<ye[2]?ye[1]+Ce:-1);je.write_shift(-4,ot===ye[1]-1?B:ot+1)}var it=function(Ye){for(ot+=Ye;Ce<ot-1;++Ce)je.write_shift(-4,Ce+1);Ye&&(++Ce,je.write_shift(-4,B))};for(ot=Ce=0,ot+=ye[1];Ce<ot;++Ce)je.write_shift(-4,_e.DIFSECT);for(ot+=ye[2];Ce<ot;++Ce)je.write_shift(-4,_e.FATSECT);it(ye[3]),it(ye[4]);for(var We=0,De=0,pe=oe.FileIndex[0];We<oe.FileIndex.length;++We)pe=oe.FileIndex[We],pe.content&&(De=pe.content.length,!(De<4096)&&(pe.start=ot,it(De+511>>9)));for(it(ye[6]+7>>3);je.l&511;)je.write_shift(-4,_e.ENDOFCHAIN);for(ot=Ce=0,We=0;We<oe.FileIndex.length;++We)pe=oe.FileIndex[We],pe.content&&(De=pe.content.length,!(!De||De>=4096)&&(pe.start=ot,it(De+63>>6)));for(;je.l&511;)je.write_shift(-4,_e.ENDOFCHAIN);for(Ce=0;Ce<ye[4]<<2;++Ce){var Je=oe.FullPaths[Ce];if(!Je||Je.length===0){for(We=0;We<17;++We)je.write_shift(4,0);for(We=0;We<3;++We)je.write_shift(4,-1);for(We=0;We<12;++We)je.write_shift(4,0);continue}pe=oe.FileIndex[Ce],Ce===0&&(pe.start=pe.size?pe.start-1:B);var Ge=Ce===0&&Q.root||pe.name;if(De=2*(Ge.length+1),je.write_shift(64,Ge,"utf16le"),je.write_shift(2,De),je.write_shift(1,pe.type),je.write_shift(1,pe.color),je.write_shift(-4,pe.L),je.write_shift(-4,pe.R),je.write_shift(-4,pe.C),pe.clsid)je.write_shift(16,pe.clsid,"hex");else for(We=0;We<4;++We)je.write_shift(4,0);je.write_shift(4,pe.state||0),je.write_shift(4,0),je.write_shift(4,0),je.write_shift(4,0),je.write_shift(4,0),je.write_shift(4,pe.start),je.write_shift(4,pe.size),je.write_shift(4,0)}for(Ce=1;Ce<oe.FileIndex.length;++Ce)if(pe=oe.FileIndex[Ce],pe.size>=4096)if(je.l=pe.start+1<<9,Xn&&Buffer.isBuffer(pe.content))pe.content.copy(je,je.l,0,pe.size),je.l+=pe.size+511&-512;else{for(We=0;We<pe.size;++We)je.write_shift(1,pe.content[We]);for(;We&511;++We)je.write_shift(1,0)}for(Ce=1;Ce<oe.FileIndex.length;++Ce)if(pe=oe.FileIndex[Ce],pe.size>0&&pe.size<4096)if(Xn&&Buffer.isBuffer(pe.content))pe.content.copy(je,je.l,0,pe.size),je.l+=pe.size+63&-64;else{for(We=0;We<pe.size;++We)je.write_shift(1,pe.content[We]);for(;We&63;++We)je.write_shift(1,0)}if(Xn)je.l=je.length;else for(;je.l<je.length;)je.write_shift(1,0);return je}function N(oe,ue){var Q=oe.FullPaths.map(function(We){return We.toUpperCase()}),ye=Q.map(function(We){var De=We.split("/");return De[De.length-(We.slice(-1)=="/"?2:1)]}),je=!1;ue.charCodeAt(0)===47?(je=!0,ue=Q[0].slice(0,-1)+ue):je=ue.indexOf("/")!==-1;var Ce=ue.toUpperCase(),ot=je===!0?Q.indexOf(Ce):ye.indexOf(Ce);if(ot!==-1)return oe.FileIndex[ot];var it=!Ce.match(nx);for(Ce=Ce.replace(Wo,""),it&&(Ce=Ce.replace(nx,"!")),ot=0;ot<Q.length;++ot)if((it?Q[ot].replace(nx,"!"):Q[ot]).replace(Wo,"")==Ce||(it?ye[ot].replace(nx,"!"):ye[ot]).replace(Wo,"")==Ce)return oe.FileIndex[ot];return null}var T=64,B=-2,G="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],xe="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:xe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(oe,ue,Q){u();var ye=R(oe,Q);c.writeFileSync(ue,ye)}function K(oe){for(var ue=new Array(oe.length),Q=0;Q<oe.length;++Q)ue[Q]=String.fromCharCode(oe[Q]);return ue.join("")}function de(oe,ue){var Q=R(oe,ue);switch(ue&&ue.type||"buffer"){case"file":return u(),c.writeFileSync(ue.filename,Q),Q;case"binary":return typeof Q=="string"?Q:K(Q);case"base64":return e1(typeof Q=="string"?Q:K(Q));case"buffer":if(Xn)return Buffer.isBuffer(Q)?Q:Gd(Q);case"array":return typeof Q=="string"?Ol(Q):Q}return Q}var ne;function E(oe){try{var ue=oe.InflateRaw,Q=new ue;if(Q._processChunk(new Uint8Array([3,0]),Q._finishFlushFlag),Q.bytesRead)ne=oe;else throw new Error("zlib does not expose bytesRead")}catch(ye){console.error("cannot use native zlib: "+(ye.message||ye))}}function Z(oe,ue){if(!ne)return Pr(oe,ue);var Q=ne.InflateRaw,ye=new Q,je=ye._processChunk(oe.slice(oe.l),ye._finishFlushFlag);return oe.l+=ye.bytesRead,je}function H(oe){return ne?ne.deflateRawSync(oe):Se(oe)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],z=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function X(oe){var ue=(oe<<1|oe<<11)&139536|(oe<<5|oe<<15)&558144;return(ue>>16|ue>>8|ue)&255}for(var J=typeof Uint8Array<"u",q=J?new Uint8Array(256):[],Y=0;Y<256;++Y)q[Y]=X(Y);function L(oe,ue){var Q=q[oe&255];return ue<=8?Q>>>8-ue:(Q=Q<<8|q[oe>>8&255],ue<=16?Q>>>16-ue:(Q=Q<<8|q[oe>>16&255],Q>>>24-ue))}function U(oe,ue){var Q=ue&7,ye=ue>>>3;return(oe[ye]|(Q<=6?0:oe[ye+1]<<8))>>>Q&3}function ce(oe,ue){var Q=ue&7,ye=ue>>>3;return(oe[ye]|(Q<=5?0:oe[ye+1]<<8))>>>Q&7}function W(oe,ue){var Q=ue&7,ye=ue>>>3;return(oe[ye]|(Q<=4?0:oe[ye+1]<<8))>>>Q&15}function ae(oe,ue){var Q=ue&7,ye=ue>>>3;return(oe[ye]|(Q<=3?0:oe[ye+1]<<8))>>>Q&31}function he(oe,ue){var Q=ue&7,ye=ue>>>3;return(oe[ye]|(Q<=1?0:oe[ye+1]<<8))>>>Q&127}function ze(oe,ue,Q){var ye=ue&7,je=ue>>>3,Ce=(1<<Q)-1,ot=oe[je]>>>ye;return Q<8-ye||(ot|=oe[je+1]<<8-ye,Q<16-ye)||(ot|=oe[je+2]<<16-ye,Q<24-ye)||(ot|=oe[je+3]<<24-ye),ot&Ce}function ke(oe,ue,Q){var ye=ue&7,je=ue>>>3;return ye<=5?oe[je]|=(Q&7)<<ye:(oe[je]|=Q<<ye&255,oe[je+1]=(Q&7)>>8-ye),ue+3}function qe(oe,ue,Q){var ye=ue&7,je=ue>>>3;return Q=(Q&1)<<ye,oe[je]|=Q,ue+1}function Ie(oe,ue,Q){var ye=ue&7,je=ue>>>3;return Q<<=ye,oe[je]|=Q&255,Q>>>=8,oe[je+1]=Q,ue+8}function Ve(oe,ue,Q){var ye=ue&7,je=ue>>>3;return Q<<=ye,oe[je]|=Q&255,Q>>>=8,oe[je+1]=Q&255,oe[je+2]=Q>>>8,ue+16}function Qe(oe,ue){var Q=oe.length,ye=2*Q>ue?2*Q:ue+5,je=0;if(Q>=ue)return oe;if(Xn){var Ce=U8(ye);if(oe.copy)oe.copy(Ce);else for(;je<oe.length;++je)Ce[je]=oe[je];return Ce}else if(J){var ot=new Uint8Array(ye);if(ot.set)ot.set(oe);else for(;je<Q;++je)ot[je]=oe[je];return ot}return oe.length=ye,oe}function Tt(oe){for(var ue=new Array(oe),Q=0;Q<oe;++Q)ue[Q]=0;return ue}function vt(oe,ue,Q){var ye=1,je=0,Ce=0,ot=0,it=0,We=oe.length,De=J?new Uint16Array(32):Tt(32);for(Ce=0;Ce<32;++Ce)De[Ce]=0;for(Ce=We;Ce<Q;++Ce)oe[Ce]=0;We=oe.length;var pe=J?new Uint16Array(We):Tt(We);for(Ce=0;Ce<We;++Ce)De[je=oe[Ce]]++,ye<je&&(ye=je),pe[Ce]=0;for(De[0]=0,Ce=1;Ce<=ye;++Ce)De[Ce+16]=it=it+De[Ce-1]<<1;for(Ce=0;Ce<We;++Ce)it=oe[Ce],it!=0&&(pe[Ce]=De[it+16]++);var Je=0;for(Ce=0;Ce<We;++Ce)if(Je=oe[Ce],Je!=0)for(it=L(pe[Ce],ye)>>ye-Je,ot=(1<<ye+4-Je)-1;ot>=0;--ot)ue[it|ot<<Je]=Je&15|Ce<<4;return ye}var Xe=J?new Uint16Array(512):Tt(512),Be=J?new Uint16Array(32):Tt(32);if(!J){for(var ct=0;ct<512;++ct)Xe[ct]=0;for(ct=0;ct<32;++ct)Be[ct]=0}(function(){for(var oe=[],ue=0;ue<32;ue++)oe.push(5);vt(oe,Be,32);var Q=[];for(ue=0;ue<=143;ue++)Q.push(8);for(;ue<=255;ue++)Q.push(9);for(;ue<=279;ue++)Q.push(7);for(;ue<=287;ue++)Q.push(8);vt(Q,Xe,288)})();var nt=function(){for(var ue=J?new Uint8Array(32768):[],Q=0,ye=0;Q<z.length-1;++Q)for(;ye<z[Q+1];++ye)ue[ye]=Q;for(;ye<32768;++ye)ue[ye]=29;var je=J?new Uint8Array(259):[];for(Q=0,ye=0;Q<ee.length-1;++Q)for(;ye<ee[Q+1];++ye)je[ye]=Q;function Ce(it,We){for(var De=0;De<it.length;){var pe=Math.min(65535,it.length-De),Je=De+pe==it.length;for(We.write_shift(1,+Je),We.write_shift(2,pe),We.write_shift(2,~pe&65535);pe-- >0;)We[We.l++]=it[De++]}return We.l}function ot(it,We){for(var De=0,pe=0,Je=J?new Uint16Array(32768):[];pe<it.length;){var Ge=Math.min(65535,it.length-pe);if(Ge<10){for(De=ke(We,De,+(pe+Ge==it.length)),De&7&&(De+=8-(De&7)),We.l=De/8|0,We.write_shift(2,Ge),We.write_shift(2,~Ge&65535);Ge-- >0;)We[We.l++]=it[pe++];De=We.l*8;continue}De=ke(We,De,+(pe+Ge==it.length)+2);for(var Ye=0;Ge-- >0;){var ft=it[pe];Ye=(Ye<<5^ft)&32767;var bt=-1,Vt=0;if((bt=Je[Ye])&&(bt|=pe&-32768,bt>pe&&(bt-=32768),bt<pe))for(;it[bt+Vt]==it[pe+Vt]&&Vt<250;)++Vt;if(Vt>2){ft=je[Vt],ft<=22?De=Ie(We,De,q[ft+1]>>1)-1:(Ie(We,De,3),De+=5,Ie(We,De,q[ft-23]>>5),De+=3);var Ft=ft<8?0:ft-4>>2;Ft>0&&(Ve(We,De,Vt-ee[ft]),De+=Ft),ft=ue[pe-bt],De=Ie(We,De,q[ft]>>3),De-=3;var gr=ft<4?0:ft-2>>1;gr>0&&(Ve(We,De,pe-bt-z[ft]),De+=gr);for(var Ar=0;Ar<Vt;++Ar)Je[Ye]=pe&32767,Ye=(Ye<<5^it[pe])&32767,++pe;Ge-=Vt-1}else ft<=143?ft=ft+48:De=qe(We,De,1),De=Ie(We,De,q[ft]),Je[Ye]=pe&32767,++pe}De=Ie(We,De,0)-1}return We.l=(De+7)/8|0,We.l}return function(We,De){return We.length<8?Ce(We,De):ot(We,De)}}();function Se(oe){var ue=yr(50+Math.floor(oe.length*1.1)),Q=nt(oe,ue);return ue.slice(0,Q)}var Te=J?new Uint16Array(32768):Tt(32768),Dt=J?new Uint16Array(32768):Tt(32768),wt=J?new Uint16Array(128):Tt(128),Pt=1,Wt=1;function Ot(oe,ue){var Q=ae(oe,ue)+257;ue+=5;var ye=ae(oe,ue)+1;ue+=5;var je=W(oe,ue)+4;ue+=4;for(var Ce=0,ot=J?new Uint8Array(19):Tt(19),it=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],We=1,De=J?new Uint8Array(8):Tt(8),pe=J?new Uint8Array(8):Tt(8),Je=ot.length,Ge=0;Ge<je;++Ge)ot[F[Ge]]=Ce=ce(oe,ue),We<Ce&&(We=Ce),De[Ce]++,ue+=3;var Ye=0;for(De[0]=0,Ge=1;Ge<=We;++Ge)pe[Ge]=Ye=Ye+De[Ge-1]<<1;for(Ge=0;Ge<Je;++Ge)(Ye=ot[Ge])!=0&&(it[Ge]=pe[Ye]++);var ft=0;for(Ge=0;Ge<Je;++Ge)if(ft=ot[Ge],ft!=0){Ye=q[it[Ge]]>>8-ft;for(var bt=(1<<7-ft)-1;bt>=0;--bt)wt[Ye|bt<<ft]=ft&7|Ge<<3}var Vt=[];for(We=1;Vt.length<Q+ye;)switch(Ye=wt[he(oe,ue)],ue+=Ye&7,Ye>>>=3){case 16:for(Ce=3+U(oe,ue),ue+=2,Ye=Vt[Vt.length-1];Ce-- >0;)Vt.push(Ye);break;case 17:for(Ce=3+ce(oe,ue),ue+=3;Ce-- >0;)Vt.push(0);break;case 18:for(Ce=11+he(oe,ue),ue+=7;Ce-- >0;)Vt.push(0);break;default:Vt.push(Ye),We<Ye&&(We=Ye);break}var Ft=Vt.slice(0,Q),gr=Vt.slice(Q);for(Ge=Q;Ge<286;++Ge)Ft[Ge]=0;for(Ge=ye;Ge<30;++Ge)gr[Ge]=0;return Pt=vt(Ft,Te,286),Wt=vt(gr,Dt,30),ue}function Ht(oe,ue){if(oe[0]==3&&!(oe[1]&3))return[eh(ue),2];for(var Q=0,ye=0,je=U8(ue||1<<18),Ce=0,ot=je.length>>>0,it=0,We=0;!(ye&1);){if(ye=ce(oe,Q),Q+=3,ye>>>1)ye>>1==1?(it=9,We=5):(Q=Ot(oe,Q),it=Pt,We=Wt);else{Q&7&&(Q+=8-(Q&7));var De=oe[Q>>>3]|oe[(Q>>>3)+1]<<8;if(Q+=32,De>0)for(!ue&&ot<Ce+De&&(je=Qe(je,Ce+De),ot=je.length);De-- >0;)je[Ce++]=oe[Q>>>3],Q+=8;continue}for(;;){!ue&&ot<Ce+32767&&(je=Qe(je,Ce+32767),ot=je.length);var pe=ze(oe,Q,it),Je=ye>>>1==1?Xe[pe]:Te[pe];if(Q+=Je&15,Je>>>=4,!(Je>>>8&255))je[Ce++]=Je;else{if(Je==256)break;Je-=257;var Ge=Je<8?0:Je-4>>2;Ge>5&&(Ge=0);var Ye=Ce+ee[Je];Ge>0&&(Ye+=ze(oe,Q,Ge),Q+=Ge),pe=ze(oe,Q,We),Je=ye>>>1==1?Be[pe]:Dt[pe],Q+=Je&15,Je>>>=4;var ft=Je<4?0:Je-2>>1,bt=z[Je];for(ft>0&&(bt+=ze(oe,Q,ft),Q+=ft),!ue&&ot<Ye&&(je=Qe(je,Ye+100),ot=je.length);Ce<Ye;)je[Ce]=je[Ce-bt],++Ce}}}return ue?[je,Q+7>>>3]:[je.slice(0,Ce),Q+7>>>3]}function Pr(oe,ue){var Q=oe.slice(oe.l||0),ye=Ht(Q,ue);return oe.l+=ye[1],ye[0]}function jt(oe,ue){if(oe)typeof console<"u"&&console.error(ue);else throw new Error(ue)}function ur(oe,ue){var Q=oe;to(Q,0);var ye=[],je=[],Ce={FileIndex:ye,FullPaths:je};A(Ce,{root:ue.root});for(var ot=Q.length-4;(Q[ot]!=80||Q[ot+1]!=75||Q[ot+2]!=5||Q[ot+3]!=6)&&ot>=0;)--ot;Q.l=ot+4,Q.l+=4;var it=Q.read_shift(2);Q.l+=6;var We=Q.read_shift(4);for(Q.l=We,ot=0;ot<it;++ot){Q.l+=20;var De=Q.read_shift(4),pe=Q.read_shift(4),Je=Q.read_shift(2),Ge=Q.read_shift(2),Ye=Q.read_shift(2);Q.l+=8;var ft=Q.read_shift(4),bt=l(Q.slice(Q.l+Je,Q.l+Je+Ge));Q.l+=Je+Ge+Ye;var Vt=Q.l;Q.l=ft+4,Ir(Q,De,pe,Ce,bt),Q.l=Vt}return Ce}function Ir(oe,ue,Q,ye,je){oe.l+=2;var Ce=oe.read_shift(2),ot=oe.read_shift(2),it=o(oe);if(Ce&8257)throw new Error("Unsupported ZIP encryption");for(var We=oe.read_shift(4),De=oe.read_shift(4),pe=oe.read_shift(4),Je=oe.read_shift(2),Ge=oe.read_shift(2),Ye="",ft=0;ft<Je;++ft)Ye+=String.fromCharCode(oe[oe.l++]);if(Ge){var bt=l(oe.slice(oe.l,oe.l+Ge));(bt[21589]||{}).mt&&(it=bt[21589].mt),((je||{})[21589]||{}).mt&&(it=je[21589].mt)}oe.l+=Ge;var Vt=oe.slice(oe.l,oe.l+De);switch(ot){case 8:Vt=Z(oe,pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ot)}var Ft=!1;Ce&8&&(We=oe.read_shift(4),We==134695760&&(We=oe.read_shift(4),Ft=!0),De=oe.read_shift(4),pe=oe.read_shift(4)),De!=ue&&jt(Ft,"Bad compressed size: "+ue+" != "+De),pe!=Q&&jt(Ft,"Bad uncompressed size: "+Q+" != "+pe),Re(ye,Ye,Vt,{unsafe:!0,mt:it})}function Rr(oe,ue){var Q=ue||{},ye=[],je=[],Ce=yr(1),ot=Q.compression?8:0,it=0,We=0,De=0,pe=0,Je=0,Ge=oe.FullPaths[0],Ye=Ge,ft=oe.FileIndex[0],bt=[],Vt=0;for(We=1;We<oe.FullPaths.length;++We)if(Ye=oe.FullPaths[We].slice(Ge.length),ft=oe.FileIndex[We],!(!ft.size||!ft.content||Ye=="Sh33tJ5")){var Ft=pe,gr=yr(Ye.length);for(De=0;De<Ye.length;++De)gr.write_shift(1,Ye.charCodeAt(De)&127);gr=gr.slice(0,gr.l),bt[Je]=fne.buf(ft.content,0);var Ar=ft.content;ot==8&&(Ar=H(Ar)),Ce=yr(30),Ce.write_shift(4,67324752),Ce.write_shift(2,20),Ce.write_shift(2,it),Ce.write_shift(2,ot),ft.mt?s(Ce,ft.mt):Ce.write_shift(4,0),Ce.write_shift(-4,bt[Je]),Ce.write_shift(4,Ar.length),Ce.write_shift(4,ft.content.length),Ce.write_shift(2,gr.length),Ce.write_shift(2,0),pe+=Ce.length,ye.push(Ce),pe+=gr.length,ye.push(gr),pe+=Ar.length,ye.push(Ar),Ce=yr(46),Ce.write_shift(4,33639248),Ce.write_shift(2,0),Ce.write_shift(2,20),Ce.write_shift(2,it),Ce.write_shift(2,ot),Ce.write_shift(4,0),Ce.write_shift(-4,bt[Je]),Ce.write_shift(4,Ar.length),Ce.write_shift(4,ft.content.length),Ce.write_shift(2,gr.length),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(4,0),Ce.write_shift(4,Ft),Vt+=Ce.l,je.push(Ce),Vt+=gr.length,je.push(gr),++Je}return Ce=yr(22),Ce.write_shift(4,101010256),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(2,Je),Ce.write_shift(2,Je),Ce.write_shift(4,Vt),Ce.write_shift(4,pe),Ce.write_shift(2,0),Bs([Bs(ye),Bs(je),Ce])}var Nr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function zr(oe,ue){if(oe.ctype)return oe.ctype;var Q=oe.name||"",ye=Q.match(/\.([^\.]+)$/);return ye&&Nr[ye[1]]||ue&&(ye=(Q=ue).match(/[\.\\]([^\.\\])+$/),ye&&Nr[ye[1]])?Nr[ye[1]]:"application/octet-stream"}function _n(oe){for(var ue=e1(oe),Q=[],ye=0;ye<ue.length;ye+=76)Q.push(ue.slice(ye,ye+76));return Q.join(`\r
`)+`\r
`}function Yr(oe){var ue=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(De){var pe=De.charCodeAt(0).toString(16).toUpperCase();return"="+(pe.length==1?"0"+pe:pe)});ue=ue.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ue.charAt(0)==`
`&&(ue="=0D"+ue.slice(1)),ue=ue.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Q=[],ye=ue.split(`\r
`),je=0;je<ye.length;++je){var Ce=ye[je];if(Ce.length==0){Q.push("");continue}for(var ot=0;ot<Ce.length;){var it=76,We=Ce.slice(ot,ot+it);We.charAt(it-1)=="="?it--:We.charAt(it-2)=="="?it-=2:We.charAt(it-3)=="="&&(it-=3),We=Ce.slice(ot,ot+it),ot+=it,ot<Ce.length&&(We+="="),Q.push(We)}}return Q.join(`\r
`)}function pn(oe){for(var ue=[],Q=0;Q<oe.length;++Q){for(var ye=oe[Q];Q<=oe.length&&ye.charAt(ye.length-1)=="=";)ye=ye.slice(0,ye.length-1)+oe[++Q];ue.push(ye)}for(var je=0;je<ue.length;++je)ue[je]=ue[je].replace(/[=][0-9A-Fa-f]{2}/g,function(Ce){return String.fromCharCode(parseInt(Ce.slice(1),16))});return Ol(ue.join(`\r
`))}function ge(oe,ue,Q){for(var ye="",je="",Ce="",ot,it=0;it<10;++it){var We=ue[it];if(!We||We.match(/^\s*$/))break;var De=We.match(/^(.*?):\s*([^\s].*)$/);if(De)switch(De[1].toLowerCase()){case"content-location":ye=De[2].trim();break;case"content-type":Ce=De[2].trim();break;case"content-transfer-encoding":je=De[2].trim();break}}switch(++it,je.toLowerCase()){case"base64":ot=Ol(zl(ue.slice(it).join("")));break;case"quoted-printable":ot=pn(ue.slice(it));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+je)}var pe=Re(oe,ye.slice(Q.length),ot,{unsafe:!0});Ce&&(pe.ctype=Ce)}function Ne(oe,ue){if(K(oe.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Q=ue&&ue.root||"",ye=(Xn&&Buffer.isBuffer(oe)?oe.toString("binary"):K(oe)).split(`\r
`),je=0,Ce="";for(je=0;je<ye.length;++je)if(Ce=ye[je],!!/^Content-Location:/i.test(Ce)&&(Ce=Ce.slice(Ce.indexOf("file")),Q||(Q=Ce.slice(0,Ce.lastIndexOf("/")+1)),Ce.slice(0,Q.length)!=Q))for(;Q.length>0&&(Q=Q.slice(0,Q.length-1),Q=Q.slice(0,Q.lastIndexOf("/")+1),Ce.slice(0,Q.length)!=Q););var ot=(ye[1]||"").match(/boundary="(.*?)"/);if(!ot)throw new Error("MAD cannot find boundary");var it="--"+(ot[1]||""),We=[],De=[],pe={FileIndex:We,FullPaths:De};A(pe);var Je,Ge=0;for(je=0;je<ye.length;++je){var Ye=ye[je];Ye!==it&&Ye!==it+"--"||(Ge++&&ge(pe,ye.slice(Je,je),Q),Je=je)}return pe}function dt(oe,ue){var Q=ue||{},ye=Q.boundary||"SheetJS";ye="------="+ye;for(var je=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ye.slice(2)+'"',"","",""],Ce=oe.FullPaths[0],ot=Ce,it=oe.FileIndex[0],We=1;We<oe.FullPaths.length;++We)if(ot=oe.FullPaths[We].slice(Ce.length),it=oe.FileIndex[We],!(!it.size||!it.content||ot=="Sh33tJ5")){ot=ot.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Vt){return"_x"+Vt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Vt){return"_u"+Vt.charCodeAt(0).toString(16)+"_"});for(var De=it.content,pe=Xn&&Buffer.isBuffer(De)?De.toString("binary"):K(De),Je=0,Ge=Math.min(1024,pe.length),Ye=0,ft=0;ft<=Ge;++ft)(Ye=pe.charCodeAt(ft))>=32&&Ye<128&&++Je;var bt=Je>=Ge*4/5;je.push(ye),je.push("Content-Location: "+(Q.root||"file:///C:/SheetJS/")+ot),je.push("Content-Transfer-Encoding: "+(bt?"quoted-printable":"base64")),je.push("Content-Type: "+zr(it,ot)),je.push(""),je.push(bt?Yr(pe):_n(pe))}return je.push(ye+`--\r
`),je.join(`\r
`)}function Ue(oe){var ue={};return A(ue,oe),ue}function Re(oe,ue,Q,ye){var je=ye&&ye.unsafe;je||A(oe);var Ce=!je&&wn.find(oe,ue);if(!Ce){var ot=oe.FullPaths[0];ue.slice(0,ot.length)==ot?ot=ue:(ot.slice(-1)!="/"&&(ot+="/"),ot=(ot+ue).replace("//","/")),Ce={name:a(ue),type:2},oe.FileIndex.push(Ce),oe.FullPaths.push(ot),je||wn.utils.cfb_gc(oe)}return Ce.content=Q,Ce.size=Q?Q.length:0,ye&&(ye.CLSID&&(Ce.clsid=ye.CLSID),ye.mt&&(Ce.mt=ye.mt),ye.ct&&(Ce.ct=ye.ct)),Ce}function xt(oe,ue){A(oe);var Q=wn.find(oe,ue);if(Q){for(var ye=0;ye<oe.FileIndex.length;++ye)if(oe.FileIndex[ye]==Q)return oe.FileIndex.splice(ye,1),oe.FullPaths.splice(ye,1),!0}return!1}function at(oe,ue,Q){A(oe);var ye=wn.find(oe,ue);if(ye){for(var je=0;je<oe.FileIndex.length;++je)if(oe.FileIndex[je]==ye)return oe.FileIndex[je].name=a(Q),oe.FullPaths[je]=Q,!0}return!1}function er(oe){P(oe,!0)}return t.find=N,t.read=j,t.parse=d,t.write=de,t.writeFile=V,t.utils={cfb_new:Ue,cfb_add:Re,cfb_del:xt,cfb_mov:at,cfb_gc:er,ReadShift:xx,CheckField:Z9,prep_blob:to,bconcat:Bs,use_zlib:E,_deflateRaw:Se,_inflateRaw:Pr,consts:_e},t}();function hne(e){return typeof e=="string"?pS(e):Array.isArray(e)?Dre(e):e}function G1(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=pS(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Mu(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([hne(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=hh(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function pne(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Bi(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function X8(e,t){for(var r=[],n=Bi(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function gS(e){for(var t=[],r=Bi(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function xS(e){for(var t=[],r=Bi(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function mne(e){for(var t=[],r=Bi(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var N2=new Date(1899,11,30,0,0,0);function _s(e,t){var r=e.getTime(),n=N2.getTime()+(e.getTimezoneOffset()-N2.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var O9=new Date,gne=N2.getTime()+(O9.getTimezoneOffset()-N2.getTimezoneOffset())*6e4,Y8=O9.getTimezoneOffset();function yS(e){var t=new Date;return t.setTime(e*24*60*60*1e3+gne),t.getTimezoneOffset()!==Y8&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Y8)*6e4),t}function xne(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var Q8=new Date("2017-02-19T19:06:09.000Z"),L9=isNaN(Q8.getFullYear())?new Date("2/19/17"):Q8,yne=L9.getFullYear()==2017;function ni(e,t){var r=new Date(e);if(yne)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(L9.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function m0(e,t){if(Xn&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Mu(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Mu(v9(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Mu(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Mu(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ai(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ai(e[r]));return t}function Mi(e,t){for(var r="";r.length<t;)r+=e;return r}function Qc(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var bne=["january","february","march","april","may","june","july","august","september","october","november","december"];function Nm(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&bne.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var vne=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(a),o.push(s[l]);return o}}();function M9(e){return e?e.content&&e.type?m0(e.content,!0):e.data?rx(e.data):e.asNodeBuffer&&Xn?rx(e.asNodeBuffer().toString("binary")):e.asBinary?rx(e.asBinary()):e._data&&e._data.getContent?rx(m0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function F9(e){if(!e)return null;if(e.data)return D8(e.data);if(e.asNodeBuffer&&Xn)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?D8(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function wne(e){return e&&e.name.slice(-4)===".bin"?F9(e):M9(e)}function uc(e,t){for(var r=e.FullPaths||Bi(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||a==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function xN(e,t){var r=uc(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function is(e,t,r){if(!r)return wne(xN(e,t));if(!t)return null;try{return is(e,t)}catch{return null}}function Ll(e,t,r){if(!r)return M9(xN(e,t));if(!t)return null;try{return Ll(e,t)}catch{return null}}function Sne(e,t,r){return F9(xN(e,t))}function J8(e){for(var t=e.FullPaths||Bi(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Hn(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Xn?n=Gd(r):n=$re(r),wn.utils.cfb_add(e,t,n)}wn.utils.cfb_add(e,t,r)}else e.file(t,r)}function yN(){return wn.utils.cfb_new()}function R9(e,t){switch(t.type){case"base64":return wn.read(e,{type:"base64"});case"binary":return wn.read(e,{type:"binary"});case"buffer":case"array":return wn.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function ax(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Zi=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_ne=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Z8=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,kne=/<[^>]*>/g,Po=Zi.match(Z8)?Z8:kne,jne=/<\w*:/,Ane=/<(\/?)\w+:/;function Cn(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var o=e.match(_ne),l=0,c="",u=0,d="",f="",p=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(p=(a=f.charCodeAt(s+1))==34||a==39?1:0,c=f.slice(s+1+p,f.length-p),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[h]&&d.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function Ku(e){return e.replace(Ane,"<$1")}var B9={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},bN=gS(B9),ca=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(l,c){return B9[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,o)+r(a.slice(o+3))}}(),vN=/[&<>'"]/g,Nne=/[\u0000-\u0008\u000b-\u001f]/g;function La(e){var t=e+"";return t.replace(vN,function(r){return bN[r]}).replace(Nne,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function eP(e){return La(e).replace(/ /g,"_x0020_")}var I9=/[\u0000-\u001f]/g;function wN(e){var t=e+"";return t.replace(vN,function(r){return bN[r]}).replace(/\n/g,"<br/>").replace(I9,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Cne(e){var t=e+"";return t.replace(vN,function(r){return bN[r]}).replace(I9,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var tP=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Ene(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ei(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function $5(e){for(var t="",r=0,n=0,a=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=a&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(a&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function rP(e){var t=eh(2*e.length),r,n,a=1,s=0,o=0,l;for(n=0;n<e.length;n+=a)a=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),a=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function nP(e){return Gd(e,"binary").toString("utf8")}var hb="foo bar baz",$a=Xn&&(nP(hb)==$5(hb)&&nP||rP(hb)==$5(hb)&&rP)||$5,Mu=Xn?function(e){return Gd(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},r1=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),D9=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Tne=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Pne=/<\/?(?:vt:)?variant>/g,One=/<(?:vt:)([^>]*)>([\s\S]*)</;function aP(e,t){var r=Cn(e),n=e.match(Tne(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var o=s.replace(Pne,"").match(One);o&&a.push({v:$a(o[2]),t:o[1]})}),a}var $9=/(^\s|\s$|\n)/;function ro(e,t){return"<"+e+(t.match($9)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function n1(e){return Bi(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Gr(e,t,r){return"<"+e+(r!=null?n1(r):"")+(t!=null?(t.match($9)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function _A(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Lne(e,t){switch(typeof e){case"string":var r=Gr("vt:lpwstr",La(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Gr((e|0)==e?"vt:i4":"vt:r8",La(String(e)));case"boolean":return Gr("vt:bool",e?"true":"false")}if(e instanceof Date)return Gr("vt:filetime",_A(e));throw new Error("Unable to serialize "+e)}function SN(e){if(Xn&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return $a(hh(pN(e)));throw new Error("Bad input format: expected Buffer or string")}var a1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ws={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Tl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Mne(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function Fne(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,o=n?-t:t;isFinite(o)?o==0?a=s=0:(a=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var iP=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},sP=Xn?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Gd(t)})):iP(e)}:iP,oP=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(yd(e,a)));return n.join("").replace(Wo,"")},_N=Xn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Wo,""):oP(e,t,r)}:oP,lP=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},U9=Xn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):lP(e,t,r)}:lP,cP=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Np(e,a)));return n.join("")},K1=Xn?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):cP(t,r,n)}:cP,z9=function(e,t){var r=Pl(e,t);return r>0?K1(e,t+4,t+4+r-1):""},W9=z9,q9=function(e,t){var r=Pl(e,t);return r>0?K1(e,t+4,t+4+r-1):""},H9=q9,V9=function(e,t){var r=2*Pl(e,t);return r>0?K1(e,t+4,t+4+r-1):""},G9=V9,K9=function(t,r){var n=Pl(t,r);return n>0?_N(t,r+4,r+4+n):""},X9=K9,Y9=function(e,t){var r=Pl(e,t);return r>0?K1(e,t+4,t+4+r):""},Q9=Y9,J9=function(e,t){return Mne(e,t)},C2=J9,kN=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Xn&&(W9=function(t,r){if(!Buffer.isBuffer(t))return z9(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},H9=function(t,r){if(!Buffer.isBuffer(t))return q9(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},G9=function(t,r){if(!Buffer.isBuffer(t))return V9(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},X9=function(t,r){if(!Buffer.isBuffer(t))return K9(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Q9=function(t,r){if(!Buffer.isBuffer(t))return Y9(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},C2=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):J9(t,r)},kN=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Np=function(e,t){return e[t]},yd=function(e,t){return e[t+1]*256+e[t]},Rne=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Pl=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Rh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Bne=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function xx(e,t){var r="",n,a,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,Xn&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(yd(this,u)),u+=2;e*=2;break;case"utf8":r=K1(this,this.l,this.l+e);break;case"utf16le":e*=2,r=_N(this,this.l,this.l+e);break;case"wstr":return xx.call(this,e,"dbcs");case"lpstr-ansi":r=W9(this,this.l),e=4+Pl(this,this.l);break;case"lpstr-cp":r=H9(this,this.l),e=4+Pl(this,this.l);break;case"lpwstr":r=G9(this,this.l),e=4+2*Pl(this,this.l);break;case"lpp4":e=4+Pl(this,this.l),r=X9(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Pl(this,this.l),r=Q9(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Np(this,this.l+e++))!==0;)s.push(fb(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=yd(this,this.l+e))!==0;)s.push(fb(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Np(this,u),this.l=u+1,l=xx.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(fb(yd(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Np(this,u),this.l=u+1,l=xx.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(fb(Np(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Np(this,this.l),this.l++,n;case 2:return n=(t==="i"?Rne:yd)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Rh:Bne)(this,this.l),this.l+=4,n):(a=Pl(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=C2(this,this.l):a=C2([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=U9(this,this.l,e);break}}return this.l+=e,r}var Ine=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Dne=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},$ne=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Une(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)$ne(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var o=t.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Ine(this,t,this.l);break;case 8:if(n=8,r==="f"){Fne(this,t,this.l);break}case 16:break;case-4:n=4,Dne(this,t,this.l);break}return this.l+=n,this}function Z9(e,t){var r=U9(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function to(e,t){e.l=t,e.read_shift=xx,e.chk=Z9,e.write_shift=Une}function Eo(e,t){e.l+=t}function yr(e){var t=eh(e);return to(t,0),t}function Kd(e,t,r){if(e){var n,a,s;to(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=u1[l]||u1[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;c=e.l+s;var d=u.f&&u.f(e,s,r);if(e.l=c,t(d,u,l))return}}}function ml(){var e=[],t=Xn?256:2048,r=function(u){var d=yr(u);return to(d,0),d},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},o=function(){return a(),Bs(e)},l=function(u){a(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function Lr(e,t,r,n){var a=+t,s;if(!isNaN(a)){n||(n=u1[a].p||(r||[]).length||0),s=1+(a>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&kN(r)&&e.push(r)}}function yx(e,t,r){var n=ai(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function uP(e,t,r){var n=ai(e);return n.s=yx(n.s,t.s,r),n.e=yx(n.e,t.s,r),n}function bx(e,t){if(e.cRel&&e.c<0)for(e=ai(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ai(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=An(e);return!e.cRel&&e.cRel!=null&&(r=qne(r)),!e.rRel&&e.rRel!=null&&(r=zne(r)),r}function U5(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+xi(e.s.c)+":"+(e.e.cRel?"":"$")+xi(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Ji(e.s.r)+":"+(e.e.rRel?"":"$")+Ji(e.e.r):bx(e.s,t.biff)+":"+bx(e.e,t.biff)}function jN(e){return parseInt(Wne(e),10)-1}function Ji(e){return""+(e+1)}function zne(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Wne(e){return e.replace(/\$(\d+)$/,"$1")}function AN(e){for(var t=Hne(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function xi(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function qne(e){return e.replace(/^([A-Z])/,"$$$1")}function Hne(e){return e.replace(/^\$([A-Z])/,"$1")}function Vne(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yi(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function An(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function gl(e){var t=e.indexOf(":");return t==-1?{s:yi(e),e:yi(e)}:{s:yi(e.slice(0,t)),e:yi(e.slice(t+1))}}function $n(e,t){return typeof t>"u"||typeof t=="number"?$n(e.s,e.e):(typeof e!="string"&&(e=An(e)),typeof t!="string"&&(t=An(t)),e==t?e:e+":"+t)}function ua(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function dP(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=vc(e.z,r?_s(t):t)}catch{}try{return e.w=vc((e.XF||{}).numFmtId||(r?14:0),r?_s(t):t)}catch{return""+t}}function Md(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Xd[e.v]||e.v:t==null?dP(e,e.v):dP(e,t))}function ph(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function e$(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?yi(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=ua(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[f].length;++p)if(!(typeof t[f][p]>"u")){var h={v:t[f][p]},m=o+f,g=l+p;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),t[f][p]&&typeof t[f][p]=="object"&&!Array.isArray(t[f][p])&&!(t[f][p]instanceof Date))h=t[f][p];else if(Array.isArray(h.v)&&(h.f=t[f][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||kn[14],n.cellDates?(h.t="d",h.w=vc(h.z,_s(h.v))):(h.t="n",h.v=_s(h.v),h.w=vc(h.z,h.v))):h.t="s";if(a)s[m]||(s[m]=[]),s[m][g]&&s[m][g].z&&(h.z=s[m][g].z),s[m][g]=h;else{var b=An({c:g,r:m});s[b]&&s[b].z&&(h.z=s[b].z),s[b]=h}}}return u.s.c<1e7&&(s["!ref"]=$n(u)),s}function Qm(e,t){return e$(null,e,t)}function Gne(e){return e.read_shift(4,"i")}function Jc(e,t){return t||(t=yr(4)),t.write_shift(4,e),t}function Ao(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Is(e,t){var r=!1;return t==null&&(r=!0,t=yr(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Kne(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Xne(e,t){return t||(t=yr(4)),t.write_shift(2,0),t.write_shift(2,0),t}function NN(e,t){var r=e.l,n=e.read_shift(1),a=Ao(e),s=[],o={t:a,h:a};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(Kne(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function Yne(e,t){var r=!1;return t==null&&(r=!0,t=yr(15+4*e.t.length)),t.write_shift(1,0),Is(e.t,t),r?t.slice(0,t.l):t}var Qne=NN;function Jne(e,t){var r=!1;return t==null&&(r=!0,t=yr(23+4*e.t.length)),t.write_shift(1,1),Is(e.t,t),t.write_shift(4,1),Xne({},t),r?t.slice(0,t.l):t}function Nc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function U0(e,t){return t==null&&(t=yr(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function z0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function W0(e,t){return t==null&&(t=yr(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Zne=Ao,t$=Is;function CN(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function E2(e,t){var r=!1;return t==null&&(r=!0,t=yr(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var eae=Ao,kA=CN,EN=E2;function TN(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?C2([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Rh(t,0)>>2;return r?a/100:a}function r$(e,t){t==null&&(t=yr(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function n$(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function tae(e,t){return t||(t=yr(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var q0=n$,Jm=tae;function jo(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function g0(e,t){return(t||yr(8)).write_shift(8,e,"f")}function rae(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=Jh[a];u&&(t.rgb=s1(u));break;case 2:t.rgb=s1([o,l,c]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function T2(e,t){if(t||(t=yr(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function nae(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function aae(e,t){t||(t=yr(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function a$(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function iae(e){return a$(e,1)}function sae(e){return a$(e,2)}var PN=2,nl=3,pb=11,fP=12,P2=19,mb=64,oae=65,lae=71,cae=4108,uae=4126,Ls=80,i$=81,dae=[Ls,i$],jA={1:{n:"CodePage",t:PN},2:{n:"Category",t:Ls},3:{n:"PresentationFormat",t:Ls},4:{n:"ByteCount",t:nl},5:{n:"LineCount",t:nl},6:{n:"ParagraphCount",t:nl},7:{n:"SlideCount",t:nl},8:{n:"NoteCount",t:nl},9:{n:"HiddenCount",t:nl},10:{n:"MultimediaClipCount",t:nl},11:{n:"ScaleCrop",t:pb},12:{n:"HeadingPairs",t:cae},13:{n:"TitlesOfParts",t:uae},14:{n:"Manager",t:Ls},15:{n:"Company",t:Ls},16:{n:"LinksUpToDate",t:pb},17:{n:"CharacterCount",t:nl},19:{n:"SharedDoc",t:pb},22:{n:"HyperlinksChanged",t:pb},23:{n:"AppVersion",t:nl,p:"version"},24:{n:"DigSig",t:oae},26:{n:"ContentType",t:Ls},27:{n:"ContentStatus",t:Ls},28:{n:"Language",t:Ls},29:{n:"Version",t:Ls},255:{},2147483648:{n:"Locale",t:P2},2147483651:{n:"Behavior",t:P2},1919054434:{}},AA={1:{n:"CodePage",t:PN},2:{n:"Title",t:Ls},3:{n:"Subject",t:Ls},4:{n:"Author",t:Ls},5:{n:"Keywords",t:Ls},6:{n:"Comments",t:Ls},7:{n:"Template",t:Ls},8:{n:"LastAuthor",t:Ls},9:{n:"RevNumber",t:Ls},10:{n:"EditTime",t:mb},11:{n:"LastPrinted",t:mb},12:{n:"CreatedDate",t:mb},13:{n:"ModifiedDate",t:mb},14:{n:"PageCount",t:nl},15:{n:"WordCount",t:nl},16:{n:"CharCount",t:nl},17:{n:"Thumbnail",t:lae},18:{n:"Application",t:Ls},19:{n:"DocSecurity",t:nl},255:{},2147483648:{n:"Locale",t:P2},2147483651:{n:"Behavior",t:P2},1919054434:{}},hP={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},fae=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function hae(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var pae=hae([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Jh=ai(pae),Xd={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},s$={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},NA={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},gb={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function ON(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function mae(e){var t=ON();if(!e||!e.match)return t;var r={};if((e.match(Po)||[]).forEach(function(n){var a=Cn(n);switch(a[0].replace(jne,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[NA[a.ContentType]]!==void 0&&t[NA[a.ContentType]].push(a.PartName);break}}),t.xmlns!==ws.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function o$(e,t){var r=mne(NA),n=[],a;n[n.length]=Zi,n[n.length]=Gr("Types",null,{xmlns:ws.CT,"xmlns:xsd":ws.xsd,"xmlns:xsi":ws.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Gr("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=Gr("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:gb[c][t.bookType]||gb[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Gr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:gb[c][t.bookType]||gb[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Gr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Qn={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function i1(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function vx(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Po)||[]).forEach(function(a){var s=Cn(a);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:ax(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function lm(e){var t=[Zi,Gr("Relationships",null,{xmlns:ws.RELS})];return Bi(e["!id"]).forEach(function(r){t[t.length]=Gr("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ta(e,t,r,n,a,s){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Qn.HLINK,Qn.XPATH,Qn.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var gae="application/vnd.oasis.opendocument.spreadsheet";function xae(e,t){for(var r=SN(e),n,a;n=a1.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Cn(n[0],!1),a.path=="/"&&a.type!==gae)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function yae(e){var t=[Zi];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function pP(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function bae(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function vae(e){var t=[Zi];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(pP(e[r][0],e[r][1])),t.push(bae("",e[r][0]));return t.push(pP("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function l$(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+_2.version+"</meta:generator></office:meta></office:document-meta>"}var xc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],wae=function(){for(var e=new Array(xc.length),t=0;t<xc.length;++t){var r=xc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function c$(e){var t={};e=$a(e);for(var r=0;r<xc.length;++r){var n=xc[r],a=e.match(wae[r]);a!=null&&a.length>0&&(t[n[1]]=ca(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=ni(t[n[1]]))}return t}function z5(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=La(t),n[n.length]=r?Gr(e,t,r):ro(e,t))}function u$(e,t){var r=t||{},n=[Zi,Gr("cp:coreProperties",null,{"xmlns:cp":ws.CORE_PROPS,"xmlns:dc":ws.dc,"xmlns:dcterms":ws.dcterms,"xmlns:dcmitype":ws.dcmitype,"xmlns:xsi":ws.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&z5("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:_A(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&z5("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:_A(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var s=0;s!=xc.length;++s){var o=xc[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&z5(o[0],l,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Zh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],d$=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function f$(e,t,r,n){var a=[];if(typeof e=="string")a=aP(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(d){return{v:d}}));var o=typeof t=="string"?aP(t,n).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==a.length;u+=2){switch(c=+a[u+1].v,a[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function Sae(e,t,r){var n={};return t||(t={}),e=$a(e),Zh.forEach(function(a){var s=(e.match(r1(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=ca(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));o&&o.length>0&&(n[a[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&f$(n.HeadingPairs,n.TitlesOfParts,t,r),t}function h$(e){var t=[],r=Gr;return e||(e={}),e.Application="SheetJS",t[t.length]=Zi,t[t.length]=Gr("Properties",null,{xmlns:ws.EXT_PROPS,"xmlns:vt":ws.vt}),Zh.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=La(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+La(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var _ae=/<[^>]+>[^<]*/g;function kae(e,t){var r={},n="",a=e.match(_ae);if(a)for(var s=0;s!=a.length;++s){var o=a[s],l=Cn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ca(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=ca(d);break;case"bool":r[n]=ei(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=ni(d);break;case"cy":case"error":r[n]=ca(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function p$(e){var t=[Zi,Gr("Properties",null,{xmlns:ws.CUST_PROPS,"xmlns:vt":ws.vt})];if(!e)return t.join("");var r=1;return Bi(e).forEach(function(a){++r,t[t.length]=Gr("property",Lne(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:La(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var CA={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},W5;function jae(e,t,r){W5||(W5=gS(CA)),t=W5[t]||t,e[t]=r}function Aae(e,t){var r=[];return Bi(CA).map(function(n){for(var a=0;a<xc.length;++a)if(xc[a][1]==n)return xc[a];for(a=0;a<Zh.length;++a)if(Zh[a][1]==n)return Zh[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(ro(CA[n[1]]||n[1],a))}}),Gr("DocumentProperties",r.join(""),{xmlns:Tl.o})}function Nae(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Bi(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<xc.length;++o)if(s==xc[o][1])return;for(o=0;o<Zh.length;++o)if(s==Zh[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(Gr(eP(s),l,{"dt:dt":c}))}}),t&&Bi(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(Gr(eP(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Tl.o+'">'+a.join("")+"</"+n+">"}function LN(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Cae(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),a+=s);var o=yr(8);return o.write_shift(4,n),o.write_shift(4,a),o}function m$(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function g$(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function x$(e,t,r){return t===31?g$(e):m$(e,t,r)}function EA(e,t,r){return x$(e,t,r===!1?0:4)}function Eae(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return x$(e,t,0)}function Tae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Wo,""),e.l-a&2&&(e.l+=2)}return r}function Pae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Wo,"");return r}function Oae(e){var t=e.l,r=O2(e,i$);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=O2(e,nl);return[r,n]}function Lae(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Oae(e));return r}function mP(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Wo,"").replace(nx,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function y$(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function Mae(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function O2(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==fP&&n!==t&&dae.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===fP?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return m$(e,n,4).replace(Wo,"");case 31:return g$(e);case 64:return LN(e);case 65:return y$(e);case 71:return Mae(e);case 80:return EA(e,n,!s.raw).replace(Wo,"");case 81:return Eae(e,n).replace(Wo,"");case 4108:return Lae(e);case 4126:case 4127:return n==4127?Tae(e):Pae(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function gP(e,t){var r=yr(4),n=yr(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=yr(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Cae(t);break;case 31:case 80:for(n=yr(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Bs([r,n])}function xP(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=a;++o){var d=e.read_shift(4),f=e.read_shift(4);s[o]=[d,f+r]}s.sort(function(v,w){return v[1]-w[1]});var p={};for(o=0;o!=a;++o){if(e.l!==s[o][1]){var h=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],h=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],h=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(h=!1,e.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var m=t[s[o][0]];if(p[m.n]=O2(e,m.t,{raw:!0}),m.p==="version"&&(p[m.n]=String(p[m.n]>>16)+"."+("0000"+String(p[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(p[m.n]){case 0:p[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Vc(l=p[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[m.n])}}else if(s[o][0]===1){if(l=p.CodePage=O2(e,PN),Vc(l),c!==-1){var g=e.l;e.l=s[c][1],u=mP(e,l),e.l=g}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}u=mP(e,l)}else{var b=u[s[o][0]],y;switch(e[e.l]){case 65:e.l+=4,y=y$(e);break;case 30:e.l+=4,y=EA(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=EA(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Hi(e,4);break;case 64:e.l+=4,y=ni(LN(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[b]=y}}return e.l=r+n,p}var b$=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Fae(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function yP(e,t,r){var n=yr(8),a=[],s=[],o=8,l=0,c=yr(8),u=yr(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),a.push(u),o+=8+c.length,!t){u=yr(8),u.write_shift(4,0),a.unshift(u);var d=[yr(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=yr(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Bs(d),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(b$.indexOf(e[l][0])>-1||d$.indexOf(e[l][0])>-1)&&e[l][1]!=null){var p=e[l][1],h=0;if(t){h=+t[e[l][0]];var m=r[h];if(m.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}c=gP(m.t,p)}else{var b=Fae(p);b==-1&&(b=31,p=String(p)),c=gP(b,p)}s.push(c),u=yr(8),u.write_shift(4,t?h:2+l),a.push(u),o+=8+c.length}var y=8*(s.length+1);for(l=0;l<s.length;++l)a[l].write_shift(4,y),y+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Bs([n].concat(a).concat(s))}function bP(e,t,r){var n=e.content;if(!n)return{};to(n,0);var a,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==wn.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),l=n.read_shift(4),a===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);a===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=xP(n,t),p={SystemIdentifier:u};for(var h in f)p[h]=f[h];if(p.FMTID=s,a===1)return p;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=xP(n,null)}catch{}for(h in m)p[h]=m[h];return p.FMTID=[s,o],p}function vP(e,t,r,n,a,s){var o=yr(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,wn.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,a?68:48);var c=yP(e,r,n);if(l.push(c),a){var u=yP(a,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Bs(l)}function pf(e,t){return e.read_shift(t),null}function Rae(e,t){t||(t=yr(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Bae(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Hi(e,t){return e.read_shift(t)===1}function Do(e,t){return t||(t=yr(2)),t.write_shift(2,+!!e),t}function ss(e){return e.read_shift(2,"u")}function dc(e,t){return t||(t=yr(2)),t.write_shift(2,e),t}function v$(e,t){return Bae(e,t,ss)}function Iae(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function w$(e,t,r){return r||(r=yr(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function X1(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var o=n?e.read_shift(n,a):"";return o}function Dae(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),o=0,l,c={};a&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return a&&(e.l+=4*o),n&&(e.l+=l),c.t=d,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function $ae(e){var t=e.t||"",r=yr(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=yr(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Bs(a)}function x0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Y1(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):x0(e,n,r)}function H0(e,t,r){if(r.biff>5)return Y1(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function S$(e,t,r){return r||(r=yr(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Uae(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function zae(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Wo,"");return n&&(e.l+=24),a}function Wae(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(Wo,"");return r+o}function qae(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return zae(e);case"0303000000000000c000000000000046":return Wae(e);default:throw new Error("Unsupported Moniker "+r)}}function xb(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Wo,""):"";return r}function wP(e,t){t||(t=yr(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Hae(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,o,l,c,u="",d,f;a&16&&(s=xb(e,r-e.l)),a&128&&(o=xb(e,r-e.l)),(a&257)===257&&(l=xb(e,r-e.l)),(a&257)===1&&(c=qae(e,r-e.l)),a&8&&(u=xb(e,r-e.l)),a&32&&(d=e.read_shift(16)),a&64&&(f=LN(e)),e.l=r;var p=o||l||c||"";p&&u&&(p+="#"+u),p||(p="#"+u),a&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var h={Target:p};return d&&(h.guid=d),f&&(h.time=f),s&&(h.Tooltip=s),h}function Vae(e){var t=yr(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),s=a>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),wP(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&wP(a>-1?n.slice(a+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function _$(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function k$(e,t){var r=_$(e);return r[3]=0,r}function Xu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function y0(e,t,r,n){return n||(n=yr(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Gae(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Kae(e,t,r){return t===0?"":H0(e,t,r)}function Xae(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[a,s,o]}function j$(e){var t=e.read_shift(2),r=TN(e);return[t,r]}function Yae(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=X1(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function bS(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function A$(e,t){return t||(t=yr(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function N$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var Qae=N$;function C$(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Jae(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Zae(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function fo(e){e.l+=2,e.l+=e.read_shift(2)}var eie={0:fo,4:fo,5:fo,6:fo,7:Zae,8:fo,9:fo,10:fo,11:fo,12:fo,13:Jae,14:fo,15:fo,16:fo,17:fo,18:fo,19:fo,20:fo,21:C$};function tie(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(eie[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function yb(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function MN(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=yr(a);return s.write_shift(2,n),s.write_shift(2,t),a>4&&s.write_shift(2,29282),a>6&&s.write_shift(2,1997),a>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function rie(e,t){return t===0||e.read_shift(2),1200}function nie(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=H0(e,0,r);return e.read_shift(t+n-e.l),a}function aie(e,t){var r=!t||t.biff==8,n=yr(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function iie(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function sie(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=X1(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:a,dt:s,name:o}}function oie(e,t){var r=!t||t.biff>=8?2:1,n=yr(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function lie(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],o=0;o!=a&&e.l<r;++o)s.push(Dae(e));return s.Count=n,s.Unique=a,s}function cie(e,t){var r=yr(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=$ae(e[a]);var s=Bs([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function uie(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function die(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function fie(e){var t=Gae(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function hie(e){return e.read_shift(2),e.read_shift(4)}function SP(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function pie(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function mie(){var e=yr(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function gie(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function xie(e){var t=yr(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function yie(){}function bie(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=X1(e,0,r),n}function vie(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,s=yr(a);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function wie(e){var t=Xu(e);return t.isst=e.read_shift(4),t}function Sie(e,t,r,n){var a=yr(10);return y0(e,t,n,a),a.write_shift(4,r),a}function _ie(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Xu(e);r.biff==2&&e.l++;var s=Y1(e,n-e.l,r);return a.val=s,a}function kie(e,t,r,n,a){var s=!a||a.biff==8,o=yr(8+ +s+(1+s)*r.length);return y0(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function jie(e,t,r){var n=e.read_shift(2),a=H0(e,0,r);return[n,a]}function Aie(e,t,r,n){var a=r&&r.biff==5;n||(n=yr(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var Nie=H0;function _P(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c}}}function Cie(e,t){var r=t.biff==8||!t.biff?4:2,n=yr(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Eie(e){var t=e.read_shift(2),r=e.read_shift(2),n=j$(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Tie(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(j$(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:o,rkrec:s}}function Pie(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:o,ixfe:s}}function Oie(e,t,r,n){var a={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return a.patternType=fae[l>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=o&15,a.dgRight=o>>4&15,a.dgTop=o>>8&15,a.dgBottom=o>>12&15,a.icvLeft=o>>16&127,a.icvRight=o>>23&127,a.grbitDiag=o>>30&3,a.icvTop=l&127,a.icvBottom=l>>7&127,a.icvDiag=l>>14&127,a.dgDiag=l>>21&15,a.icvFore=c&127,a.icvBack=c>>7&127,a.fsxButton=c>>14&1),a}function Lie(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Oie(e,t,n.fStyle,r),n}function kP(e,t,r,n){var a=r&&r.biff==5;n||(n=yr(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&a&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function Mie(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Fie(e){var t=yr(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function jP(e,t,r){var n=Xu(e);(r.biff==2||t==9)&&++e.l;var a=Iae(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Rie(e,t,r,n,a,s){var o=yr(8);return y0(e,t,n,o),w$(r,s,o),o}function Bie(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Xu(e),a=jo(e);return n.val=a,n}function Iie(e,t,r,n){var a=yr(14);return y0(e,t,n,a),g0(r,a),a}var AP=Kae;function Die(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=x0(e,s),l=[];n>e.l;)l.push(Y1(e));return[s,a,o,l]}function NP(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=Yae(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var $ie=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function CP(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=x0(e,o,r);a&32&&(u=$ie[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||l===0||!(d>0)?[]:tue(e,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function E$(e,t,r){if(r.biff<8)return Uie(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(Xae(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Uie(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=X1(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function zie(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=x0(e,n,r),o=x0(e,a,r);return[s,o]}function Wie(e,t,r){var n=N$(e);e.l++;var a=e.read_shift(1);return t-=8,[rue(e,t,r),a,n]}function EP(e,t,r){var n=Qae(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Zce(e,t,r)]}function qie(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Hie(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=H0(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},l,o,s]}}function Vie(e,t,r){return Hie(e,t,r)}function Gie(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(bS(e));return r}function Kie(e){var t=yr(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)A$(e[r],t);return t}function Xie(e,t,r){if(r&&r.biff<8)return Qie(e,t,r);var n=C$(e),a=tie(e,t-22,n[1]);return{cmo:n,ft:a}}var Yie={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Qie(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Yie[n]||Eo)(e,t,r)),{cmo:[a,n,s],ft:o}}function Jie(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=Uae(e,6,r);var l=e.read_shift(2);e.read_shift(2),ss(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=x0(e,e.lens[u+1]-e.lens[u]-1);if(a+=f,a.length>=(d?l:2*l))break}if(a.length!==l&&a.length!==l*2)throw new Error("cchText: "+l+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function Zie(e,t){var r=bS(e);e.l+=16;var n=Hae(e,t-24);return[r,n]}function ese(e){var t=yr(24),r=yi(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Bs([t,Vae(e[1])])}function tse(e,t){e.read_shift(2);var r=bS(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Wo,""),[r,n]}function rse(e){var t=e[1].Tooltip,r=yr(10+2*(t.length+1));r.write_shift(2,2048);var n=yi(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function nse(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=hP[r]||r,r=e.read_shift(2),t[1]=hP[r]||r,t}function ase(e){return e||(e=yr(4)),e.write_shift(2,1),e.write_shift(2,1),e}function ise(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(k$(e));return r}function sse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(k$(e));return r}function ose(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function T$(e,t,r){if(!r.cellStyles)return Eo(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function lse(e,t){var r=yr(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function cse(e,t){var r={};return t<32||(e.l+=16,r.header=jo(e),r.footer=jo(e),e.l+=2),r}function use(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function dse(e){for(var t=yr(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var fse=Xu,hse=v$,pse=Y1;function mse(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function gse(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Xu(e);++e.l;var a=H0(e,t-7,r);return n.t="str",n.val=a,n}function xse(e){var t=Xu(e);++e.l;var r=jo(e);return t.t="n",t.val=r,t}function yse(e,t,r){var n=yr(15);return ey(n,e,t),n.write_shift(8,r,"f"),n}function bse(e){var t=Xu(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function vse(e,t,r){var n=yr(9);return ey(n,e,t),n.write_shift(2,r),n}function wse(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Sse(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function _se(e,t,r){var n=e.l+t,a=Xu(e),s=e.read_shift(2),o=x0(e,s,r);return e.l=n,a.t="str",a.val=o,a}var kse=[2,3,48,49,131,139,140,245],TA=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=gS({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=eh(1);switch(c.type){case"base64":d=Ol(zl(l));break;case"binary":d=Ol(l);break;case"buffer":case"array":d=l;break}to(d,0);var f=d.read_shift(1),p=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,b=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(b=d.read_shift(2));var y=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var w=[],_={},C=Math.min(d.length,f==2?521:b-10-(h?264:0)),j=m?32:11;d.l<C&&d[d.l]!=13;)switch(_={},_.name=Zx.utils.decode(v,d.slice(d.l,d.l+j)).replace(/[\u0000\r\n].*$/g,""),d.l+=j,_.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),f==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&w.push(_),f!=2&&(d.l+=m?13:14),_.type){case"B":(!h||_.len!=8)&&c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=b-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=b;var A=0,M=0;for(u[0]=[],M=0;M!=w.length;++M)u[0][M]=w[M].name;for(;g-- >0;){if(d[d.l]===42){d.l+=y;continue}for(++d.l,u[++A]=[],M=0,M=0;M!=w.length;++M){var P=d.slice(d.l,d.l+w[M].len);d.l+=w[M].len,to(P,0);var R=Zx.utils.decode(v,P);switch(w[M].type){case"C":R.trim().length&&(u[A][M]=R.replace(/\s+$/,""));break;case"D":R.length===8?u[A][M]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):u[A][M]=R;break;case"F":u[A][M]=parseFloat(R.trim());break;case"+":case"I":u[A][M]=m?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":u[A][M]=!0;break;case"N":case"F":u[A][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[A][M]="##MEMO##"+(m?parseInt(R.trim(),10):P.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(u[A][M]=+R||0);break;case"@":u[A][M]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[A][M]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[A][M]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][M]=-P.read_shift(-8,"f");break;case"B":if(h&&w[M].len==8){u[A][M]=P.read_shift(8,"f");break}case"G":case"P":P.l+=w[M].len;break;case"0":if(w[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[M].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Qm(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function a(l,c){try{return ph(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&Vc(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=ml(),f=F2(l,{header:1,raw:!0,cellDates:!0}),p=f[0],h=f.slice(1),m=l["!cols"]||[],g=0,b=0,y=0,v=1;for(g=0;g<p.length;++g){if(((m[g]||{}).DBF||{}).name){p[g]=m[g].DBF.name,++y;continue}if(p[g]!=null){if(++y,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(b=0;b<1024;++b)if(p.indexOf(p[g]+"_"+b)==-1){p[g]+="_"+b;break}}}}var w=ua(l["!ref"]),_=[],C=[],j=[];for(g=0;g<=w.e.c-w.s.c;++g){var A="",M="",P=0,R=[];for(b=0;b<h.length;++b)h[b][g]!=null&&R.push(h[b][g]);if(R.length==0||p[g]==null){_[g]="?";continue}for(b=0;b<R.length;++b){switch(typeof R[b]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=R[b]instanceof Date?"D":"C";break;default:M="C"}P=Math.max(P,String(R[b]).length),A=A&&A!=M?"C":M}P>250&&(P=250),M=((m[g]||{}).DBF||{}).type,M=="C"&&m[g].DBF.len>P&&(P=m[g].DBF.len),A=="B"&&M=="N"&&(A="N",j[g]=m[g].DBF.dec,P=m[g].DBF.len),C[g]=A=="C"||M=="N"?P:s[A]||0,v+=C[g],_[g]=A}var N=d.next(32);for(N.write_shift(4,318902576),N.write_shift(4,h.length),N.write_shift(2,296+32*y),N.write_shift(2,v),g=0;g<4;++g)N.write_shift(4,0);for(N.write_shift(4,0|(+t[b9]||3)<<8),g=0,b=0;g<p.length;++g)if(p[g]!=null){var T=d.next(32),B=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);T.write_shift(1,B,"sbcs"),T.write_shift(1,_[g]=="?"?"C":_[g],"sbcs"),T.write_shift(4,b),T.write_shift(1,C[g]||s[_[g]]||0),T.write_shift(1,j[g]||0),T.write_shift(1,2),T.write_shift(4,0),T.write_shift(1,0),T.write_shift(4,0),T.write_shift(4,0),b+=C[g]||s[_[g]]||0}var G=d.next(264);for(G.write_shift(4,13),g=0;g<65;++g)G.write_shift(4,0);for(g=0;g<h.length;++g){var re=d.next(v);for(re.write_shift(1,0),b=0;b<p.length;++b)if(p[b]!=null)switch(_[b]){case"L":re.write_shift(1,h[g][b]==null?63:h[g][b]?84:70);break;case"B":re.write_shift(8,h[g][b]||0,"f");break;case"N":var xe="0";for(typeof h[g][b]=="number"&&(xe=h[g][b].toFixed(j[b]||0)),y=0;y<C[b]-xe.length;++y)re.write_shift(1,32);re.write_shift(1,xe,"sbcs");break;case"D":h[g][b]?(re.write_shift(4,("0000"+h[g][b].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(h[g][b].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+h[g][b].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(h[g][b]!=null?h[g][b]:"").slice(0,C[b]);for(re.write_shift(1,_e,"sbcs"),y=0;y<C[b]-_e.length;++y)re.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:n,from_sheet:o}}(),P$=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Bi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var m=e[h];return typeof m=="number"?$8(m):m},n=function(p,h,m){var g=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?p:$8(g)};e["|"]=254;function a(p,h){switch(h.type){case"base64":return s(zl(p),h);case"binary":return s(p,h);case"buffer":return s(Xn&&Buffer.isBuffer(p)?p.toString("binary"):hh(p),h);case"array":return s(m0(p),h)}throw new Error("Unrecognized type "+h.type)}function s(p,h){var m=p.split(/[\n\r]+/),g=-1,b=-1,y=0,v=0,w=[],_=[],C=null,j={},A=[],M=[],P=[],R=0,N;for(+h.codepage>=0&&Vc(+h.codepage);y!==m.length;++y){R=0;var T=m[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),B=T.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),G=B[0],re;if(T.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&_.push(T.slice(3).replace(/;;/g,";"));break;case"C":var xe=!1,_e=!1,V=!1,K=!1,de=-1,ne=-1;for(v=1;v<B.length;++v)switch(B[v].charAt(0)){case"A":break;case"X":b=parseInt(B[v].slice(1))-1,_e=!0;break;case"Y":for(g=parseInt(B[v].slice(1))-1,_e||(b=0),N=w.length;N<=g;++N)w[N]=[];break;case"K":re=B[v].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(Qc(re))?isNaN(Nm(re).getDate())||(re=ni(re)):(re=Qc(re),C!==null&&Xm(C)&&(re=yS(re))),xe=!0;break;case"E":K=!0;var E=cm(B[v].slice(1),{r:g,c:b});w[g][b]=[w[g][b],E];break;case"S":V=!0,w[g][b]=[w[g][b],"S5S"];break;case"G":break;case"R":de=parseInt(B[v].slice(1))-1;break;case"C":ne=parseInt(B[v].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}if(xe&&(w[g][b]&&w[g][b].length==2?w[g][b][0]=re:w[g][b]=re,C=null),V){if(K)throw new Error("SYLK shared formula cannot have own formula");var Z=de>-1&&w[de][ne];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");w[g][b][1]=X$(Z[1],{r:g-de,c:b-ne})}break;case"F":var H=0;for(v=1;v<B.length;++v)switch(B[v].charAt(0)){case"X":b=parseInt(B[v].slice(1))-1,++H;break;case"Y":for(g=parseInt(B[v].slice(1))-1,N=w.length;N<=g;++N)w[N]=[];break;case"M":R=parseInt(B[v].slice(1))/20;break;case"F":break;case"G":break;case"P":C=_[parseInt(B[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=B[v].slice(1).split(" "),N=parseInt(P[0],10);N<=parseInt(P[1],10);++N)R=parseInt(P[2],10),M[N-1]=R===0?{hidden:!0}:{wch:R},th(M[N-1]);break;case"C":b=parseInt(B[v].slice(1))-1,M[b]||(M[b]={});break;case"R":g=parseInt(B[v].slice(1))-1,A[g]||(A[g]={}),R>0?(A[g].hpt=R,A[g].hpx=Em(R)):R===0&&(A[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}H<1&&(C=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+T)}}return A.length>0&&(j["!rows"]=A),M.length>0&&(j["!cols"]=M),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,j]}function o(p,h){var m=a(p,h),g=m[0],b=m[1],y=Qm(g,h);return Bi(b).forEach(function(v){y[v]=b[v]}),y}function l(p,h){return ph(o(p,h),h)}function c(p,h,m,g){var b="C;Y"+(m+1)+";X"+(g+1)+";K";switch(p.t){case"n":b+=p.v||0,p.f&&!p.F&&(b+=";E"+$N(p.f,{r:m,c:g}));break;case"b":b+=p.v?"TRUE":"FALSE";break;case"e":b+=p.w||p.v;break;case"d":b+='"'+(p.w||p.v)+'"';break;case"s":b+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function u(p,h){h.forEach(function(m,g){var b="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?b+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=o1(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=l1(m.wpx)),typeof m.wch=="number"&&(b+=Math.round(m.wch))),b.charAt(b.length-1)!=" "&&p.push(b)})}function d(p,h){h.forEach(function(m,g){var b="F;";m.hidden?b+="M0;":m.hpt?b+="M"+20*m.hpt+";":m.hpx&&(b+="M"+20*c1(m.hpx)+";"),b.length>2&&p.push(b+"R"+(g+1))})}function f(p,h){var m=["ID;PWXL;N;E"],g=[],b=ua(p["!ref"]),y,v=Array.isArray(p),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),p["!cols"]&&u(m,p["!cols"]),p["!rows"]&&d(m,p["!rows"]),m.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var _=b.s.r;_<=b.e.r;++_)for(var C=b.s.c;C<=b.e.c;++C){var j=An({r:_,c:C});y=v?(p[_]||[])[C]:p[j],!(!y||y.v==null&&(!y.f||y.F))&&g.push(c(y,p,_,C))}return m.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),O$=function(){function e(s,o){switch(o.type){case"base64":return t(zl(s),o);case"binary":return t(s,o);case"buffer":return t(Xn&&Buffer.isBuffer(s)?s.toString("binary"):hh(s),o);case"array":return t(m0(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var p=l[d].trim().split(","),h=p[0],m=p[1];++d;for(var g=l[d]||"";(g.match(/["]/g)||[]).length&1&&d<l.length-1;)g+=`
`+l[++d];switch(g=g.trim(),+h){case-1:if(g==="BOT"){f[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][u]=!0:g==="FALSE"?f[c][u]=!1:isNaN(Qc(m))?isNaN(Nm(m).getDate())?f[c][u]=m:f[c][u]=ni(m):f[c][u]=Qc(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return Qm(e(s,o),o)}function n(s,o){return ph(r(s,o),o)}var a=function(){var s=function(c,u,d,f,p){c.push(u),c.push(d+","+f),c.push('"'+p.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=ua(c["!ref"]),f,p=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var g=An({r:h,c:m});if(f=p?(c[h]||[])[m]:c[g],!f){o(u,1,0,"");continue}switch(f.t){case"n":var b=f.w;!b&&f.v!=null&&(b=f.v),b==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,b,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=vc(f.z||kn[14],_s(ni(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var y=`\r
`,v=u.join(y);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),L$=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,p){for(var h=f.split(`
`),m=-1,g=-1,b=0,y=[];b!==h.length;++b){var v=h[b].trim().split(":");if(v[0]==="cell"){var w=yi(v[1]);if(y.length<=w.r)for(m=y.length;m<=w.r;++m)y[m]||(y[m]=[]);switch(m=w.r,g=w.c,v[2]){case"t":y[m][g]=e(v[3]);break;case"v":y[m][g]=+v[3];break;case"vtf":var _=v[v.length-1];case"vtc":switch(v[3]){case"nl":y[m][g]=!!+v[4];break;default:y[m][g]=+v[4];break}v[2]=="vtf"&&(y[m][g]=[y[m][g],_])}}}return p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),y}function n(f,p){return Qm(r(f,p),p)}function a(f,p){return ph(n(f,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var p=[],h=[],m,g="",b=gl(f["!ref"]),y=Array.isArray(f),v=b.s.r;v<=b.e.r;++v)for(var w=b.s.c;w<=b.e.c;++w)if(g=An({r:v,c:w}),m=y?(f[v]||[])[w]:f[g],!(!m||m.v==null||m.t==="z")){switch(h=["cell",g,"t"],m.t){case"s":case"str":h.push(t(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=t(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var _=_s(ni(m.v));h[2]="vtc",h[3]="nd",h[4]=""+_,h[5]=m.w||vc(m.z||kn[14],_);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:d}}(),Cm=function(){function e(d,f,p,h,m){m.raw?f[p][h]=d:d===""||(d==="TRUE"?f[p][h]=!0:d==="FALSE"?f[p][h]=!1:isNaN(Qc(d))?isNaN(Nm(d).getDate())?f[p][h]=d:f[p][h]=ni(d):f[p][h]=Qc(d))}function t(d,f){var p=f||{},h=[];if(!d||d.length===0)return h;for(var m=d.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var b=10,y=0,v=0;v<=g;++v)y=m[v].indexOf(" "),y==-1?y=m[v].length:y++,b=Math.max(b,y);for(v=0;v<=g;++v){h[v]=[];var w=0;for(e(m[v].slice(0,b).trim(),h,v,w,p),w=1;w<=(m[v].length-b)/10+1;++w)e(m[v].slice(b+(w-1)*10,b+w*10).trim(),h,v,w,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(d){for(var f={},p=!1,h=0,m=0;h<d.length;++h)(m=d.charCodeAt(h))==34?p=!p:!p&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(g,b){return g[0]-b[0]||n[g[1]]-n[b[1]]}),r[m.pop()[1]]||44}function s(d,f){var p=f||{},h="",m=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=a(d.slice(0,1024)):p&&p.FS?h=p.FS:h=a(d.slice(0,1024));var b=0,y=0,v=0,w=0,_=0,C=h.charCodeAt(0),j=!1,A=0,M=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=p.dateNF!=null?une(p.dateNF):null;function R(){var N=d.slice(w,_),T={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)T.t="z";else if(p.raw)T.t="s",T.v=N;else if(N.trim().length===0)T.t="s",T.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(T.t="s",T.v=N.slice(2,-1).replace(/""/g,'"')):Dle(N)?(T.t="n",T.f=N.slice(1)):(T.t="s",T.v=N);else if(N=="TRUE")T.t="b",T.v=!0;else if(N=="FALSE")T.t="b",T.v=!1;else if(!isNaN(v=Qc(N)))T.t="n",p.cellText!==!1&&(T.w=N),T.v=v;else if(!isNaN(Nm(N).getDate())||P&&N.match(P)){T.z=p.dateNF||kn[14];var B=0;P&&N.match(P)&&(N=dne(N,p.dateNF,N.match(P)||[]),B=1),p.cellDates?(T.t="d",T.v=ni(N,B)):(T.t="n",T.v=_s(ni(N,B))),p.cellText!==!1&&(T.w=vc(T.z,T.v instanceof Date?_s(T.v):T.v)),p.cellNF||delete T.z}else T.t="s",T.v=N;if(T.t=="z"||(p.dense?(m[b]||(m[b]=[]),m[b][y]=T):m[An({c:y,r:b})]=T),w=_+1,M=d.charCodeAt(w),g.e.c<y&&(g.e.c=y),g.e.r<b&&(g.e.r=b),A==C)++y;else if(y=0,++b,p.sheetRows&&p.sheetRows<=b)return!0}e:for(;_<d.length;++_)switch(A=d.charCodeAt(_)){case 34:M===34&&(j=!j);break;case C:case 10:case 13:if(!j&&R())break e;break}return _-w>0&&R(),m["!ref"]=$n(g),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):Qm(t(d,f),f)}function l(d,f){var p="",h=f.type=="string"?[0,0,0,0]:KN(d,f);switch(f.type){case"base64":p=zl(d);break;case"binary":p=d;break;case"buffer":f.codepage==65001?p=d.toString("utf8"):f.codepage&&typeof Zx<"u"||(p=Xn&&Buffer.isBuffer(d)?d.toString("binary"):hh(d));break;case"array":p=m0(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=$a(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=$a(p):f.type=="binary"&&typeof Zx<"u",p.slice(0,19)=="socialcalc:version:"?L$.to_sheet(f.type=="string"?p:$a(p),f):o(p,f)}function c(d,f){return ph(l(d,f),f)}function u(d){for(var f=[],p=ua(d["!ref"]),h,m=Array.isArray(d),g=p.s.r;g<=p.e.r;++g){for(var b=[],y=p.s.c;y<=p.e.c;++y){var v=An({r:g,c:y});if(h=m?(d[g]||[])[y]:d[v],!h||h.v==null){b.push("          ");continue}for(var w=(h.w||(Md(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";b.push(w+(y===0?" ":""))}f.push(b.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function jse(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=P$.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Cm.to_workbook(e,t)}}var e0=function(){function e(E,Z,H){if(E){to(E,E.l||0);for(var F=H.Enum||de;E.l<E.length;){var ee=E.read_shift(2),z=F[ee]||F[65535],X=E.read_shift(2),J=E.l+X,q=z.f&&z.f(E,X,H);if(E.l=J,Z(q,z,ee))return}}}function t(E,Z){switch(Z.type){case"base64":return r(Ol(zl(E)),Z);case"binary":return r(Ol(E),Z);case"buffer":case"array":return r(E,Z)}throw"Unsupported type "+Z.type}function r(E,Z){if(!E)return E;var H=Z||{},F=H.dense?[]:{},ee="Sheet1",z="",X=0,J={},q=[],Y=[],L={s:{r:0,c:0},e:{r:0,c:0}},U=H.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)H.Enum=de,e(E,function(he,ze,ke){switch(ke){case 0:H.vers=he,he>=4096&&(H.qpro=!0);break;case 6:L=he;break;case 204:he&&(z=he);break;case 222:z=he;break;case 15:case 51:H.qpro||(he[1].v=he[1].v.slice(1));case 13:case 14:case 16:ke==14&&(he[2]&112)==112&&(he[2]&15)>1&&(he[2]&15)<15&&(he[1].z=H.dateNF||kn[14],H.cellDates&&(he[1].t="d",he[1].v=yS(he[1].v))),H.qpro&&he[3]>X&&(F["!ref"]=$n(L),J[ee]=F,q.push(ee),F=H.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},X=he[3],ee=z||"Sheet"+(X+1),z="");var qe=H.dense?(F[he[0].r]||[])[he[0].c]:F[An(he[0])];if(qe){qe.t=he[1].t,qe.v=he[1].v,he[1].z!=null&&(qe.z=he[1].z),he[1].f!=null&&(qe.f=he[1].f);break}H.dense?(F[he[0].r]||(F[he[0].r]=[]),F[he[0].r][he[0].c]=he[1]):F[An(he[0])]=he[1];break}},H);else if(E[2]==26||E[2]==14)H.Enum=ne,E[2]==14&&(H.qpro=!0,E.l=0),e(E,function(he,ze,ke){switch(ke){case 204:ee=he;break;case 22:he[1].v=he[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(he[3]>X&&(F["!ref"]=$n(L),J[ee]=F,q.push(ee),F=H.dense?[]:{},L={s:{r:0,c:0},e:{r:0,c:0}},X=he[3],ee="Sheet"+(X+1)),U>0&&he[0].r>=U)break;H.dense?(F[he[0].r]||(F[he[0].r]=[]),F[he[0].r][he[0].c]=he[1]):F[An(he[0])]=he[1],L.e.c<he[0].c&&(L.e.c=he[0].c),L.e.r<he[0].r&&(L.e.r=he[0].r);break;case 27:he[14e3]&&(Y[he[14e3][0]]=he[14e3][1]);break;case 1537:Y[he[0]]=he[1],he[0]==X&&(ee=he[1]);break}},H);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(F["!ref"]=$n(L),J[z||ee]=F,q.push(z||ee),!Y.length)return{SheetNames:q,Sheets:J};for(var ce={},W=[],ae=0;ae<Y.length;++ae)J[q[ae]]?(W.push(Y[ae]||q[ae]),ce[Y[ae]]=J[Y[ae]]||J[q[ae]]):(W.push(Y[ae]),ce[Y[ae]]={"!ref":"A1"});return{SheetNames:W,Sheets:ce}}function n(E,Z){var H=Z||{};if(+H.codepage>=0&&Vc(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var F=ml(),ee=ua(E["!ref"]),z=Array.isArray(E),X=[];Xr(F,0,s(1030)),Xr(F,6,c(ee));for(var J=Math.min(ee.e.r,8191),q=ee.s.r;q<=J;++q)for(var Y=Ji(q),L=ee.s.c;L<=ee.e.c;++L){q===ee.s.r&&(X[L]=xi(L));var U=X[L]+Y,ce=z?(E[q]||[])[L]:E[U];if(!(!ce||ce.t=="z"))if(ce.t=="n")(ce.v|0)==ce.v&&ce.v>=-32768&&ce.v<=32767?Xr(F,13,h(q,L,ce.v)):Xr(F,14,g(q,L,ce.v));else{var W=Md(ce);Xr(F,15,f(q,L,W.slice(0,239)))}}return Xr(F,1),F.end()}function a(E,Z){var H=Z||{};if(+H.codepage>=0&&Vc(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var F=ml();Xr(F,0,o(E));for(var ee=0,z=0;ee<E.SheetNames.length;++ee)(E.Sheets[E.SheetNames[ee]]||{})["!ref"]&&Xr(F,27,K(E.SheetNames[ee],z++));var X=0;for(ee=0;ee<E.SheetNames.length;++ee){var J=E.Sheets[E.SheetNames[ee]];if(!(!J||!J["!ref"])){for(var q=ua(J["!ref"]),Y=Array.isArray(J),L=[],U=Math.min(q.e.r,8191),ce=q.s.r;ce<=U;++ce)for(var W=Ji(ce),ae=q.s.c;ae<=q.e.c;++ae){ce===q.s.r&&(L[ae]=xi(ae));var he=L[ae]+W,ze=Y?(J[ce]||[])[ae]:J[he];if(!(!ze||ze.t=="z"))if(ze.t=="n")Xr(F,23,R(ce,ae,X,ze.v));else{var ke=Md(ze);Xr(F,22,A(ce,ae,X,ke.slice(0,239)))}}++X}}return Xr(F,1),F.end()}function s(E){var Z=yr(2);return Z.write_shift(2,E),Z}function o(E){var Z=yr(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var H=0,F=0,ee=0,z=0;z<E.SheetNames.length;++z){var X=E.SheetNames[z],J=E.Sheets[X];if(!(!J||!J["!ref"])){++ee;var q=gl(J["!ref"]);H<q.e.r&&(H=q.e.r),F<q.e.c&&(F=q.e.c)}}return H>8191&&(H=8191),Z.write_shift(2,H),Z.write_shift(1,ee),Z.write_shift(1,F),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function l(E,Z,H){var F={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&H.qpro?(F.s.c=E.read_shift(1),E.l++,F.s.r=E.read_shift(2),F.e.c=E.read_shift(1),E.l++,F.e.r=E.read_shift(2),F):(F.s.c=E.read_shift(2),F.s.r=E.read_shift(2),Z==12&&H.qpro&&(E.l+=2),F.e.c=E.read_shift(2),F.e.r=E.read_shift(2),Z==12&&H.qpro&&(E.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function c(E){var Z=yr(8);return Z.write_shift(2,E.s.c),Z.write_shift(2,E.s.r),Z.write_shift(2,E.e.c),Z.write_shift(2,E.e.r),Z}function u(E,Z,H){var F=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(F[0].c=E.read_shift(1),F[3]=E.read_shift(1),F[0].r=E.read_shift(2),E.l+=2):(F[2]=E.read_shift(1),F[0].c=E.read_shift(2),F[0].r=E.read_shift(2)),F}function d(E,Z,H){var F=E.l+Z,ee=u(E,Z,H);if(ee[1].t="s",H.vers==20768){E.l++;var z=E.read_shift(1);return ee[1].v=E.read_shift(z,"utf8"),ee}return H.qpro&&E.l++,ee[1].v=E.read_shift(F-E.l,"cstr"),ee}function f(E,Z,H){var F=yr(7+H.length);F.write_shift(1,255),F.write_shift(2,Z),F.write_shift(2,E),F.write_shift(1,39);for(var ee=0;ee<F.length;++ee){var z=H.charCodeAt(ee);F.write_shift(1,z>=128?95:z)}return F.write_shift(1,0),F}function p(E,Z,H){var F=u(E,Z,H);return F[1].v=E.read_shift(2,"i"),F}function h(E,Z,H){var F=yr(7);return F.write_shift(1,255),F.write_shift(2,Z),F.write_shift(2,E),F.write_shift(2,H,"i"),F}function m(E,Z,H){var F=u(E,Z,H);return F[1].v=E.read_shift(8,"f"),F}function g(E,Z,H){var F=yr(13);return F.write_shift(1,255),F.write_shift(2,Z),F.write_shift(2,E),F.write_shift(8,H,"f"),F}function b(E,Z,H){var F=E.l+Z,ee=u(E,Z,H);if(ee[1].v=E.read_shift(8,"f"),H.qpro)E.l=F;else{var z=E.read_shift(2);_(E.slice(E.l,E.l+z),ee),E.l+=z}return ee}function y(E,Z,H){var F=Z&32768;return Z&=-32769,Z=(F?E:0)+(Z>=8192?Z-16384:Z),(F?"":"$")+(H?xi(Z):Ji(Z))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(E,Z){to(E,0);for(var H=[],F=0,ee="",z="",X="",J="";E.l<E.length;){var q=E[E.l++];switch(q){case 0:H.push(E.read_shift(8,"f"));break;case 1:z=y(Z[0].c,E.read_shift(2),!0),ee=y(Z[0].r,E.read_shift(2),!1),H.push(z+ee);break;case 2:{var Y=y(Z[0].c,E.read_shift(2),!0),L=y(Z[0].r,E.read_shift(2),!1);z=y(Z[0].c,E.read_shift(2),!0),ee=y(Z[0].r,E.read_shift(2),!1),H.push(Y+L+":"+z+ee)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(E.read_shift(2));break;case 6:{for(var U="";q=E[E.l++];)U+=String.fromCharCode(q);H.push('"'+U.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:J=H.pop(),X=H.pop(),H.push(["AND","OR"][q-20]+"("+X+","+J+")");break;default:if(q<32&&w[q])J=H.pop(),X=H.pop(),H.push(X+w[q]+J);else if(v[q]){if(F=v[q][1],F==69&&(F=E[E.l++]),F>H.length){console.error("WK1 bad formula parse 0x"+q.toString(16)+":|"+H.join("|")+"|");return}var ce=H.slice(-F);H.length-=F,H.push(v[q][0]+"("+ce.join(",")+")")}else return q<=7?console.error("WK1 invalid opcode "+q.toString(16)):q<=24?console.error("WK1 unsupported op "+q.toString(16)):q<=30?console.error("WK1 invalid opcode "+q.toString(16)):q<=115?console.error("WK1 unsupported function opcode "+q.toString(16)):console.error("WK1 unrecognized opcode "+q.toString(16))}}H.length==1?Z[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function C(E){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=E.read_shift(2),Z[3]=E[E.l++],Z[0].c=E[E.l++],Z}function j(E,Z){var H=C(E);return H[1].t="s",H[1].v=E.read_shift(Z-4,"cstr"),H}function A(E,Z,H,F){var ee=yr(6+F.length);ee.write_shift(2,E),ee.write_shift(1,H),ee.write_shift(1,Z),ee.write_shift(1,39);for(var z=0;z<F.length;++z){var X=F.charCodeAt(z);ee.write_shift(1,X>=128?95:X)}return ee.write_shift(1,0),ee}function M(E,Z){var H=C(E);H[1].v=E.read_shift(2);var F=H[1].v>>1;if(H[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return H[1].v=F,H}function P(E,Z){var H=C(E),F=E.read_shift(4),ee=E.read_shift(4),z=E.read_shift(2);if(z==65535)return F===0&&ee===3221225472?(H[1].t="e",H[1].v=15):F===0&&ee===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var X=z&32768;return z=(z&32767)-16446,H[1].v=(1-X*2)*(ee*Math.pow(2,z+32)+F*Math.pow(2,z)),H}function R(E,Z,H,F){var ee=yr(14);if(ee.write_shift(2,E),ee.write_shift(1,H),ee.write_shift(1,Z),F==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var z=0,X=0,J=0,q=0;return F<0&&(z=1,F=-F),X=Math.log2(F)|0,F/=Math.pow(2,X-31),q=F>>>0,q&2147483648||(F/=2,++X,q=F>>>0),F-=q,q|=2147483648,q>>>=0,F*=Math.pow(2,32),J=F>>>0,ee.write_shift(4,J),ee.write_shift(4,q),X+=16383+(z?32768:0),ee.write_shift(2,X),ee}function N(E,Z){var H=P(E);return E.l+=Z-14,H}function T(E,Z){var H=C(E),F=E.read_shift(4);return H[1].v=F>>6,H}function B(E,Z){var H=C(E),F=E.read_shift(8,"f");return H[1].v=F,H}function G(E,Z){var H=B(E);return E.l+=Z-10,H}function re(E,Z){return E[E.l+Z-1]==0?E.read_shift(Z,"cstr"):""}function xe(E,Z){var H=E[E.l++];H>Z-1&&(H=Z-1);for(var F="";F.length<H;)F+=String.fromCharCode(E[E.l++]);return F}function _e(E,Z,H){if(!(!H.qpro||Z<21)){var F=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var ee=E.read_shift(Z-21,"cstr");return[F,ee]}}function V(E,Z){for(var H={},F=E.l+Z;E.l<F;){var ee=E.read_shift(2);if(ee==14e3){for(H[ee]=[0,""],H[ee][0]=E.read_shift(2);E[E.l];)H[ee][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return H}function K(E,Z){var H=yr(5+E.length);H.write_shift(2,14e3),H.write_shift(2,Z);for(var F=0;F<E.length;++F){var ee=E.charCodeAt(F);H[H.l++]=ee>127?95:ee}return H[H.l++]=0,H}var de={0:{n:"BOF",f:ss},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:xe},65535:{n:""}},ne={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:j},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:T},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function Ase(e){var t={},r=e.match(Po),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Cn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=dN[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var Nse=function(){var e=r1("t"),t=r1("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:ca(o[1])},c=s.match(t);return c&&(l.s=Ase(c[1])),l}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(a).map(r).filter(function(l){return l.v})}}(),Cse=function(){var t=/(\r\n|\n)/g;function r(a,s,o){var l=[];a.u&&l.push("text-decoration: underline;"),a.uval&&l.push("text-underline-style:"+a.uval+";"),a.sz&&l.push("font-size:"+a.sz+"pt;"),a.outline&&l.push("text-effect: outline;"),a.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),a.b&&(s.push("<b>"),o.push("</b>")),a.i&&(s.push("<i>"),o.push("</i>")),a.strike&&(s.push("<s>"),o.push("</s>"));var c=a.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),Ese=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Tse=/<(?:\w+:)?r>/,Pse=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function FN(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ca($a(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=$a(e),r&&(n.h=wN(n.t))):e.match(Tse)&&(n.r=$a(e),n.t=ca($a((e.replace(Pse,"").match(Ese)||[]).join("").replace(Po,""))),r&&(n.h=Cse(Nse(n.r)))),n):{t:""}}var Ose=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Lse=/<(?:\w+:)?(?:si|sstItem)>/g,Mse=/<\/(?:\w+:)?(?:si|sstItem)>/;function Fse(e,t){var r=[],n="";if(!e)return r;var a=e.match(Ose);if(a){n=a[2].replace(Lse,"").split(Mse);for(var s=0;s!=n.length;++s){var o=FN(n[s].trim(),t);o!=null&&(r[r.length]=o)}a=Cn(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var Rse=/^\s|\s$|[\t\n\r]/;function M$(e,t){if(!t.bookSST)return"";var r=[Zi];r[r.length]=Gr("sst",null,{xmlns:$0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],s="<si>";a.r?s+=a.r:(s+="<t",a.t||(a.t=""),a.t.match(Rse)&&(s+=' xml:space="preserve"'),s+=">"+La(a.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Bse(e){return[e.read_shift(4),e.read_shift(4)]}function Ise(e,t){var r=[],n=!1;return Kd(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function Dse(e,t){return t||(t=yr(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var $se=Yne;function Use(e){var t=ml();Lr(t,159,Dse(e));for(var r=0;r<e.length;++r)Lr(t,19,$se(e[r]));return Lr(t,160),t.end()}function F$(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function jd(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function zse(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=jd(e,4),t.U=jd(e,4),t.W=jd(e,4),t}function Wse(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function qse(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Wse(e));return t}function Hse(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Vse(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=jd(e,4),t.U=jd(e,4),t.W=jd(e,4),t}function Gse(e){var t=Vse(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function R$(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function B$(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Kse(e){var t=jd(e);switch(t.Minor){case 2:return[t.Minor,Xse(e)];case 3:return[t.Minor,Yse()];case 4:return[t.Minor,Qse(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Xse(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=R$(e,r),a=B$(e,e.length-e.l);return{t:"Std",h:n,v:a}}function Yse(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Qse(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Po,function(s){var o=Cn(s);switch(Ku(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Jse(e,t){var r={},n=r.EncryptionVersionInfo=jd(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=R$(e,a),t-=a,r.EncryptionVerifier=B$(e,t),r}function Zse(e){var t={},r=t.EncryptionVersionInfo=jd(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function RN(e){var t=0,r,n=F$(e),a=n.length+1,s,o,l,c,u;for(r=eh(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var I$=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},a=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=F$(o),c=s(l),u=l.length,d=eh(16),f=0;f!=16;++f)d[f]=0;var p,h,m;for((u&1)===1&&(p=c>>8,d[u]=a(e[0],p),--u,p=c&255,h=l[l.length-1],d[u]=a(h,p));u>0;)--u,p=c>>8,d[u]=a(l[u],p),--u,p=c&255,d[u]=a(l[u],p);for(u=15,m=15-l.length;m>0;)p=c>>8,d[u]=a(e[m],p),--u,--m,p=c&255,d[u]=a(l[u],p),--u,--m;return d}}(),eoe=function(e,t,r,n,a){a||(a=t),n||(n=I$(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,a[s]=o,++r;return[a,r,n]},toe=function(e){var t=0,r=I$(e);return function(n){var a=eoe("",n,t,r);return t=a[1],a[0]}};function roe(e,t,r,n){var a={key:ss(e),verificationBytes:ss(e)};return r.password&&(a.verifier=RN(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=toe(r.password)),a}function noe(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Zse(e):n.Data=Jse(e,t),n}function aoe(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?noe(e,t-2,n):roe(e,r.biff>=8?t:t-2,r,n),n}var D$=function(){function e(a,s){switch(s.type){case"base64":return t(zl(a),s);case"binary":return t(a,s);case"buffer":return t(Xn&&Buffer.isBuffer(a)?a.toString("binary"):hh(a),s);case"array":return t(m0(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var o=s||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var p=/\\\w+\b/g,h=0,m,g=-1;m=p.exec(d);){switch(m[0]){case"\\cell":var b=d.slice(h,p.lastIndex-m[0].length);if(b[0]==" "&&(b=b.slice(1)),++g,b.length){var y={v:b,t:"s"};Array.isArray(l)?l[f][g]=y:l[An({r:f,c:g})]=y}break}h=p.lastIndex}g>u.e.c&&(u.e.c=g)}),l["!ref"]=$n(u),l}function r(a,s){return ph(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],o=ua(a["!ref"]),l,c=Array.isArray(a),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=An({r:u,c:d});l=c?(a[u]||[])[d]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(Md(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function ioe(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function s1(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function soe(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),o=a-s;if(o===0)return[0,0,t];var l=0,c=0,u=a+s;switch(c=o/(u>1?2-u:u),a){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function ooe(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=a*l,o[0]+=a,o[1]+=c;break;case 1:c=a*(2-l),o[0]+=c,o[1]+=a;break;case 2:c=a*(l-2),o[1]+=a,o[2]+=c;break;case 3:c=a*(4-l),o[1]+=c,o[2]+=a;break;case 4:c=a*(l-4),o[2]+=a,o[0]+=c;break;case 5:c=a*(6-l),o[2]+=c,o[0]+=a;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function L2(e,t){if(t===0)return e;var r=soe(ioe(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),s1(ooe(r))}var $$=6,loe=15,coe=1,So=$$;function o1(e){return Math.floor((e+Math.round(128/So)/256)*So)}function l1(e){return Math.floor((e-5)/So*100+.5)/100}function M2(e){return Math.round((e*So+5)/So*256)/256}function q5(e){return M2(l1(o1(e)))}function BN(e){var t=Math.abs(e-q5(e)),r=So;if(t>.005)for(So=coe;So<loe;++So)Math.abs(e-q5(e))<=t&&(t=Math.abs(e-q5(e)),r=So);So=r}function th(e){e.width?(e.wpx=o1(e.width),e.wch=l1(e.wpx),e.MDW=So):e.wpx?(e.wch=l1(e.wpx),e.width=M2(e.wch),e.MDW=So):typeof e.wch=="number"&&(e.width=M2(e.wch),e.wpx=o1(e.width),e.MDW=So),e.customWidth&&delete e.customWidth}var uoe=96,U$=uoe;function c1(e){return e*96/U$}function Em(e){return e*U$/96}var doe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function foe(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Po)||[]).forEach(function(o){var l=Cn(o);switch(Ku(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},l.diagonalUp&&(a.diagonalUp=ei(l.diagonalUp)),l.diagonalDown&&(a.diagonalDown=ei(l.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function hoe(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Po)||[]).forEach(function(o){var l=Cn(o);switch(Ku(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":l.patternType&&(a.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),l.indexed&&(a.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(a.bgColor.theme=parseInt(l.theme,10)),l.tint&&(a.bgColor.tint=parseFloat(l.tint)),l.rgb&&(a.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),l.theme&&(a.fgColor.theme=parseInt(l.theme,10)),l.tint&&(a.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(a.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function poe(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Po)||[]).forEach(function(o){var l=Cn(o);switch(Ku(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":l.val&&(a.name=$a(l.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=l.val?ei(l.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=l.val?ei(l.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(l.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=l.val?ei(l.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=l.val?ei(l.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=l.val?ei(l.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=l.val?ei(l.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=l.val?ei(l.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":l.val&&(a.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(a.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(a.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(a.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=dN[parseInt(l.val,10)];break;case"<color":if(a.color||(a.color={}),l.auto&&(a.color.auto=ei(l.auto)),l.rgb)a.color.rgb=l.rgb.slice(-6);else if(l.indexed){a.color.index=parseInt(l.indexed,10);var c=Jh[a.color.index];a.color.index==81&&(c=Jh[1]),c||(c=Jh[1]),a.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(a.color.theme=parseInt(l.theme,10),l.tint&&(a.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=L2(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function moe(e,t,r){t.NumberFmt=[];for(var n=Bi(kn),a=0;a<n.length;++a)t.NumberFmt[n[a]]=kn[n[a]];var s=e[0].match(Po);if(s)for(a=0;a<s.length;++a){var o=Cn(s[a]);switch(Ku(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=ca($a(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}kd(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function goe(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Gr("numFmt",null,{numFmtId:n,formatCode:La(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Gr("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var bb=["numFmtId","fillId","fontId","borderId","xfId"],vb=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function xoe(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Po)||[]).forEach(function(s){var o=Cn(s),l=0;switch(Ku(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<bb.length;++l)n[bb[l]]&&(n[bb[l]]=parseInt(n[bb[l]],10));for(l=0;l<vb.length;++l)n[vb[l]]&&(n[vb[l]]=ei(n[vb[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=ei(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function yoe(e){var t=[];return t[t.length]=Gr("cellXfs",null),e.forEach(function(r){t[t.length]=Gr("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Gr("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var boe=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&moe(f,d,u),(f=l.match(a))&&poe(f,d,c,u),(f=l.match(n))&&hoe(f,d,c,u),(f=l.match(s))&&foe(f,d,c,u),(f=l.match(r))&&xoe(f,d,u),d}}();function z$(e,t){var r=[Zi,Gr("styleSheet",null,{xmlns:$0[0],"xmlns:vt":ws.vt})],n;return e.SSF&&(n=goe(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=yoe(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function voe(e,t){var r=e.read_shift(2),n=Ao(e);return[r,n]}function woe(e,t,r){r||(r=yr(6+4*t.length)),r.write_shift(2,e),Is(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Soe(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=nae(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=rae(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ao(e),n}function _oe(e,t){t||(t=yr(25+4*32)),t.write_shift(2,e.sz*20),aae(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),T2(e.color,t);var n=0;return n=2,t.write_shift(1,n),Is(e.name,t),t.length>t.l?t.slice(0,t.l):t}var koe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],H5,joe=Eo;function TP(e,t){t||(t=yr(4*3+8*7+16*1)),H5||(H5=gS(koe));var r=H5[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(T2({auto:1},t),T2({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Aoe(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function W$(e,t,r){r||(r=yr(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Og(e,t){return t||(t=yr(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Noe=Eo;function Coe(e,t){return t||(t=yr(51)),t.write_shift(1,0),Og(null,t),Og(null,t),Og(null,t),Og(null,t),Og(null,t),t.length>t.l?t.slice(0,t.l):t}function Eoe(e,t){return t||(t=yr(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),E2(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Toe(e,t,r){var n=yr(2052);return n.write_shift(4,e),E2(t,n),E2(r,n),n.length>n.l?n.slice(0,n.l):n}function Poe(e,t,r){var n={};n.NumberFmt=[];for(var a in kn)n.NumberFmt[a]=kn[a];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return Kd(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],kd(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=L2(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Ooe(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(Lr(e,615,Jc(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Lr(e,44,woe(a,t[a]))}),Lr(e,616))}}function Loe(e){var t=1;Lr(e,611,Jc(t)),Lr(e,43,_oe({sz:12,color:{theme:1},name:"Calibri",family:2})),Lr(e,612)}function Moe(e){var t=2;Lr(e,603,Jc(t)),Lr(e,45,TP({patternType:"none"})),Lr(e,45,TP({patternType:"gray125"})),Lr(e,604)}function Foe(e){var t=1;Lr(e,613,Jc(t)),Lr(e,46,Coe()),Lr(e,614)}function Roe(e){var t=1;Lr(e,626,Jc(t)),Lr(e,47,W$({numFmtId:0},65535)),Lr(e,627)}function Boe(e,t){Lr(e,617,Jc(t.length)),t.forEach(function(r){Lr(e,47,W$(r,0))}),Lr(e,618)}function Ioe(e){var t=1;Lr(e,619,Jc(t)),Lr(e,48,Eoe({xfId:0,name:"Normal"})),Lr(e,620)}function Doe(e){var t=0;Lr(e,505,Jc(t)),Lr(e,506)}function $oe(e){var t=0;Lr(e,508,Toe(t,"TableStyleMedium9","PivotStyleMedium4")),Lr(e,509)}function Uoe(e,t){var r=ml();return Lr(r,278),Ooe(r,e.SSF),Loe(r),Moe(r),Foe(r),Roe(r),Boe(r,t.cellXfs),Ioe(r),Doe(r),$oe(r),Lr(r,279),r.end()}var zoe=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Woe(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Po)||[]).forEach(function(a){var s=Cn(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[zoe.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function qoe(){}function Hoe(){}var Voe=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Goe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Koe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Xoe(e,t,r){t.themeElements={};var n;[["clrScheme",Voe,Woe],["fontScheme",Goe,qoe],["fmtScheme",Koe,Hoe]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Yoe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function q$(e,t){(!e||e.length===0)&&(e=IN());var r,n={};if(!(r=e.match(Yoe)))throw new Error("themeElements not found in theme");return Xoe(r[0],n,t),n.raw=e,n}function IN(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Zi];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Qoe(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=R9(s,{type:"array"})}catch{return}var l=Ll(o,"theme/theme/theme1.xml",!0);if(l)return q$(l,r)}}function Joe(e){return e.read_shift(4)}function Zoe(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=ele(e,4);break;case 2:t.xclrValue=_$(e);break;case 3:t.xclrValue=Joe(e);break;case 4:e.l+=4;break}return e.l+=8,t}function ele(e,t){return Eo(e,t)}function tle(e,t){return Eo(e,t)}function rle(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Zoe(e);break;case 6:n[1]=tle(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function nle(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(rle(e,r-e.l));return{ixfe:n,ext:s}}function ale(e,t){t.forEach(function(r){switch(r[0]){}})}function ile(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ao(e)}}function sle(e){var t=yr(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Is(e.name,t),t.slice(0,t.l)}function ole(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function lle(e){var t=yr(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function cle(e,t){var r=yr(8+2*t.length);return r.write_shift(4,e),Is(t,r),r.slice(0,r.l)}function ule(e){return e.l+=4,e.read_shift(4)!=0}function dle(e,t){var r=yr(8);return r.write_shift(4,e),r.write_shift(4,1),r}function fle(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],o=!1,l=2;return Kd(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function hle(){var e=ml();return Lr(e,332),Lr(e,334,Jc(1)),Lr(e,335,sle({name:"XLDAPR",version:12e4,flags:3496657072})),Lr(e,336),Lr(e,339,cle(1,"XLDAPR")),Lr(e,52),Lr(e,35,Jc(514)),Lr(e,4096,Jc(0)),Lr(e,4097,dc(1)),Lr(e,36),Lr(e,53),Lr(e,340),Lr(e,337,dle(1)),Lr(e,51,lle([[1,0]])),Lr(e,338),Lr(e,333),e.end()}function ple(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,o;return e.replace(Po,function(l){var c=Cn(l);switch(Ku(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function H$(){var e=[Zi];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function mle(e){var t=[];if(!e)return t;var r=1;return(e.match(Po)||[]).forEach(function(n){var a=Cn(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function gle(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=An(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function xle(e,t,r){var n=[];return Kd(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function yle(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Kd(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},a)}function ble(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Vp=1024;function V$(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Gr("xml",null,{"xmlns:v":Tl.v,"xmlns:o":Tl.o,"xmlns:x":Tl.x,"xmlns:mv":Tl.mv}).replace(/\/>/,">"),Gr("o:shapelayout",Gr("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Gr("v:shapetype",[Gr("v:stroke",null,{joinstyle:"miter"}),Gr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Vp<e*1e3;)Vp+=1e3;return t.forEach(function(s){var o=yi(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?Gr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Gr("v:fill",c,l),d={on:"t",obscured:"t"};++Vp,a=a.concat(["<v:shape"+n1({id:"_x0000_s"+Vp,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Gr("v:shadow",null,d),Gr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ro("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ro("x:AutoFill","False"),ro("x:Row",String(o.r)),ro("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function PP(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(o){var l=yi(o.ref);if(a?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},a?e[l.r][l.c]=s:e[o.ref]=s;var c=ua(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=$n(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function vle(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Cn(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=yi(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&FN(f[1])||{r:"",t:"",h:""};u.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=p.h),n.push(u)}}}}),n}function G$(e){var t=[Zi,Gr("comments",null,{xmlns:$0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var s=La(a.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(La(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),s.length<=1)t.push(ro("t",La(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(ro("t",La(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function wle(e,t){var r=[],n=!1,a={},s=0;return e.replace(Po,function(l,c){var u=Cn(l);switch(Ku(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":a.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function Sle(e,t,r){var n=[Zi,Gr("ThreadedComments",null,{xmlns:ws.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var s="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(Gr("threadedComment",ro("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function _le(e,t){var r=[],n=!1;return e.replace(Po,function(s){var o=Cn(s);switch(Ku(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function kle(e){var t=[Zi,Gr("personList",null,{xmlns:ws.TCMNT,"xmlns:x":$0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Gr("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function jle(e){var t={};t.iauthor=e.read_shift(4);var r=q0(e);return t.rfx=r.s,t.ref=An(r.s),e.l+=16,t}function Ale(e,t){return t==null&&(t=yr(36)),t.write_shift(4,e[1].iauthor),Jm(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Nle=Ao;function Cle(e){return Is(e.slice(0,54))}function Ele(e,t){var r=[],n=[],a={},s=!1;return Kd(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:a=l;break;case 637:a.t=l.t,a.h=l.h,a.r=l.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function Tle(e){var t=ml(),r=[];return Lr(t,628),Lr(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Lr(t,632,Cle(a.a)))})}),Lr(t,631),Lr(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var s={s:yi(n[0]),e:yi(n[0])};Lr(t,635,Ale([s,a])),a.t&&a.t.length>0&&Lr(t,637,Jne(a)),Lr(t,636),delete a.iauthor})}),Lr(t,634),Lr(t,629),t.end()}var Ple="application/vnd.ms-office.vbaProject";function Ole(e){var t=wn.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");wn.utils.cfb_add(t,a,e.FileIndex[n].content)}}),wn.write(t)}function Lle(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&wn.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var K$=["xlsb","xlsm","xlam","biff8","xla"];function Mle(){return{"!type":"dialog"}}function Fle(){return{"!type":"dialog"}}function Rle(){return{"!type":"macro"}}function Ble(){return{"!type":"macro"}}var cm=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,a+(l?"":"$")+xi(d)+(c?"":"$")+Ji(u)}return function(a,s){return t=s,a.replace(e,r)}}(),DN=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,$N=function(){return function(t,r){return t.replace(DN,function(n,a,s,o,l,c){var u=AN(o)-(s?0:r.c),d=jN(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",p=u==0?"":s?u+1:"["+u+"]";return a+"R"+f+"C"+p})}}();function X$(e,t){return e.replace(DN,function(r,n,a,s,o,l){return n+(a=="$"?a+s:xi(AN(s)+t.c))+(o=="$"?o+l:Ji(jN(l)+t.r))})}function Ile(e,t,r){var n=gl(t),a=n.s,s=yi(r),o={r:s.r-a.r,c:s.c-a.c};return X$(e,o)}function Dle(e){return e.length!=1}function OP(e){return e.replace(/_xlfn\./g,"")}function rs(e){e.l+=1}function rh(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Y$(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Q$(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),o=rh(e),l=rh(e);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function Q$(e){var t=rh(e),r=rh(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function $le(e,t,r){if(r.biff<8)return Q$(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=rh(e),o=rh(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function J$(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Ule(e);var n=e.read_shift(r&&r.biff==12?4:2),a=rh(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Ule(e){var t=rh(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function zle(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Wle(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return qle(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:o,rRel:l}}function qle(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Hle(e,t,r){var n=(e[e.l++]&96)>>5,a=Y$(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Vle(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=Y$(e,s,r);return[n,a,o]}function Gle(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Kle(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function Xle(e,t,r){var n=(e[e.l++]&96)>>5,a=$le(e,t-1,r);return[n,a]}function Yle(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function LP(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Qle(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Jle(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Zle(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function ece(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function tce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function Z$(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function rce(e){return e.read_shift(2),Z$(e)}function nce(e){return e.read_shift(2),Z$(e)}function ace(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=J$(e,0,r);return[n,a]}function ice(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Wle(e,0,r);return[n,a]}function sce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=J$(e,0,r);return[n,a,s]}function oce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[uue[a],rU[a],n]}function lce(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:cce(e);return[a,(s[0]===0?rU:cue)[s[1]]]}function cce(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function uce(e,t,r){e.l+=r&&r.biff==2?3:4}function dce(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function fce(e){return e.l++,Xd[e.read_shift(1)]}function hce(e){return e.l++,e.read_shift(2)}function pce(e){return e.l++,e.read_shift(1)!==0}function mce(e){return e.l++,jo(e)}function gce(e,t,r){return e.l++,X1(e,t-1,r)}function xce(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Hi(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Xd[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=jo(e);break;case 2:r[1]=H0(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function yce(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?q0:bS)(e));return a}function bce(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=a;++l)o[s][l]=xce(e,r.biff);return o}function vce(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function wce(e,t,r){if(r.biff==5)return Sce(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function Sce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function _ce(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function kce(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function jce(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Ace(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var Nce=Eo,Cce=Eo,Ece=Eo;function Q1(e,t,r){return e.l+=2,[zle(e)]}function UN(e){return e.l+=6,[]}var Tce=Q1,Pce=UN,Oce=UN,Lce=Q1;function eU(e){return e.l+=2,[ss(e),e.read_shift(2)&1]}var Mce=Q1,Fce=eU,Rce=UN,Bce=Q1,Ice=Q1,Dce=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function $ce(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),o=Dce[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:a,C:s}}function Uce(e){return e.l+=2,[e.read_shift(4)]}function zce(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Wce(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function qce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Hce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Vce(e){return e.l+=4,[0,0]}var MP={1:{n:"PtgExp",f:dce},2:{n:"PtgTbl",f:Ece},3:{n:"PtgAdd",f:rs},4:{n:"PtgSub",f:rs},5:{n:"PtgMul",f:rs},6:{n:"PtgDiv",f:rs},7:{n:"PtgPower",f:rs},8:{n:"PtgConcat",f:rs},9:{n:"PtgLt",f:rs},10:{n:"PtgLe",f:rs},11:{n:"PtgEq",f:rs},12:{n:"PtgGe",f:rs},13:{n:"PtgGt",f:rs},14:{n:"PtgNe",f:rs},15:{n:"PtgIsect",f:rs},16:{n:"PtgUnion",f:rs},17:{n:"PtgRange",f:rs},18:{n:"PtgUplus",f:rs},19:{n:"PtgUminus",f:rs},20:{n:"PtgPercent",f:rs},21:{n:"PtgParen",f:rs},22:{n:"PtgMissArg",f:rs},23:{n:"PtgStr",f:gce},26:{n:"PtgSheet",f:zce},27:{n:"PtgEndSheet",f:Wce},28:{n:"PtgErr",f:fce},29:{n:"PtgBool",f:pce},30:{n:"PtgInt",f:hce},31:{n:"PtgNum",f:mce},32:{n:"PtgArray",f:Yle},33:{n:"PtgFunc",f:oce},34:{n:"PtgFuncVar",f:lce},35:{n:"PtgName",f:vce},36:{n:"PtgRef",f:ace},37:{n:"PtgArea",f:Hle},38:{n:"PtgMemArea",f:_ce},39:{n:"PtgMemErr",f:Nce},40:{n:"PtgMemNoMem",f:Cce},41:{n:"PtgMemFunc",f:kce},42:{n:"PtgRefErr",f:jce},43:{n:"PtgAreaErr",f:Gle},44:{n:"PtgRefN",f:ice},45:{n:"PtgAreaN",f:Xle},46:{n:"PtgMemAreaN",f:qce},47:{n:"PtgMemNoMemN",f:Hce},57:{n:"PtgNameX",f:wce},58:{n:"PtgRef3d",f:sce},59:{n:"PtgArea3d",f:Vle},60:{n:"PtgRefErr3d",f:Ace},61:{n:"PtgAreaErr3d",f:Kle},255:{}},Gce={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Kce={1:{n:"PtgElfLel",f:eU},2:{n:"PtgElfRw",f:Bce},3:{n:"PtgElfCol",f:Tce},6:{n:"PtgElfRwV",f:Ice},7:{n:"PtgElfColV",f:Lce},10:{n:"PtgElfRadical",f:Mce},11:{n:"PtgElfRadicalS",f:Rce},13:{n:"PtgElfColS",f:Pce},15:{n:"PtgElfColSV",f:Oce},16:{n:"PtgElfRadicalLel",f:Fce},25:{n:"PtgList",f:$ce},29:{n:"PtgSxName",f:Uce},255:{}},Xce={0:{n:"PtgAttrNoop",f:Vce},1:{n:"PtgAttrSemi",f:tce},2:{n:"PtgAttrIf",f:Zle},4:{n:"PtgAttrChoose",f:Qle},8:{n:"PtgAttrGoto",f:Jle},16:{n:"PtgAttrSum",f:uce},32:{n:"PtgAttrBaxcel",f:LP},33:{n:"PtgAttrBaxcel",f:LP},64:{n:"PtgAttrSpace",f:rce},65:{n:"PtgAttrSpaceSemi",f:nce},128:{n:"PtgAttrIfError",f:ece},255:{}};function J1(e,t,r,n){if(n.biff<8)return Eo(e,t);for(var a=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=bce(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=yce(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=a-e.l,t!==0&&s.push(Eo(e,t)),s}function Z1(e,t,r){for(var n=e.l+t,a,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],a=MP[s]||MP[Gce[s]],(s===24||s===25)&&(a=(s===24?Kce:Xce)[e[e.l+1]]),!a||!a.f?Eo(e,t):o.push([a.n,a.f(e,t,r)]);return o}function Yce(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var Qce={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Jce(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function tU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function FP(e,t,r){var n=tU(e,t,r);return n=="#REF"?n:Jce(n,r)}function vo(e,t,r,n,a){var s=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,p=0,h,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,b="",y=0,v=e[0].length;y<v;++y){var w=e[0][y];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:b=Mi(" ",e[0][g][1][1]);break;case 1:b=Mi("\r",e[0][g][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+b,g=-1}l.push(u+Qce[w[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=yx(w[1][1],o,a),l.push(bx(d,s));break;case"PtgRefN":d=r?yx(w[1][1],r,a):w[1][1],l.push(bx(d,s));break;case"PtgRef3d":f=w[1][1],d=yx(w[1][2],o,a),m=FP(n,f,a),l.push(m+"!"+bx(d,s));break;case"PtgFunc":case"PtgFuncVar":var _=w[1][0],C=w[1][1];_||(_=0),_&=127;var j=_==0?[]:l.slice(-_);l.length-=_,C==="User"&&(C=j.shift()),l.push(C+"("+j.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":h=uP(w[1][1],r?{s:r}:o,a),l.push(U5(h,a));break;case"PtgArea":h=uP(w[1][1],o,a),l.push(U5(h,a));break;case"PtgArea3d":f=w[1][1],h=w[1][2],m=FP(n,f,a),l.push(m+"!"+U5(h,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=w[1][2];var A=(n.names||[])[p-1]||(n[0]||[])[p],M=A?A.Name:"SH33TJSNAME"+String(p);M&&M.slice(0,6)=="_xlfn."&&!a.xlfn&&(M=M.slice(6)),l.push(M);break;case"PtgNameX":var P=w[1][1];p=w[1][2];var R;if(a.biff<=5)P<0&&(P=-P),n[P]&&(R=n[P][p]);else{var N="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][p]&&n[P][p].itab>0&&(N=n.SheetNames[n[P][p].itab-1]+"!"):N=n.SheetNames[p-1]+"!"),n[P]&&n[P][p])N+=n[P][p].Name;else if(n[0]&&n[0][p])N+=n[0][p].Name;else{var T=(tU(n,P,a)||"").split(";;");T[p-1]?N=T[p-1]:N+="SH33TJSERRX"}l.push(N);break}R||(R={Name:"SH33TJSERRY"}),l.push(R.Name);break;case"PtgParen":var B="(",G=")";if(g>=0){switch(b="",e[0][g][1][0]){case 2:B=Mi(" ",e[0][g][1][1])+B;break;case 3:B=Mi("\r",e[0][g][1][1])+B;break;case 4:G=Mi(" ",e[0][g][1][1])+G;break;case 5:G=Mi("\r",e[0][g][1][1])+G;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(B+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[An(d)]){var xe=n.sharedf[An(d)];l.push(vo(xe,o,re,n,a))}else{var _e=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(vo(u[1],o,re,n,a)),_e=!0;break}_e||l.push(w[1])}break;case"PtgArray":l.push("{"+Yce(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&V.indexOf(e[0][y][0])==-1){w=e[0][g];var K=!0;switch(w[1][0]){case 4:K=!1;case 0:b=Mi(" ",w[1][1]);break;case 5:K=!1;case 1:b=Mi("\r",w[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((K?b:"")+l.pop()+(K?"":b)),g=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function Zce(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],Eo(e,t-2)];var l=Z1(e,o,r);return t!==o+a&&(s=J1(e,t-o-a,l,r)),e.l=n,[l,s]}function eue(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,o=e.read_shift(a);if(o==65535)return[[],Eo(e,t-2)];var l=Z1(e,o,r);return t!==o+a&&(s=J1(e,t-o-a,l,r)),e.l=n,[l,s]}function tue(e,t,r,n){var a=e.l+t,s=Z1(e,n,r),o;return a!==e.l&&(o=J1(e,a-e.l,s,r)),[s,o]}function rue(e,t,r){var n=e.l+t,a,s=e.read_shift(2),o=Z1(e,s,r);return s==65535?[[],Eo(e,t-2)]:(t!==s+2&&(a=J1(e,n-s-2,o,r)),[o,a])}function nue(e){var t;if(yd(e,e.l+6)!==65535)return[jo(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function aue(e){if(e==null){var t=yr(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return g0(e);return g0(0)}function V5(e,t,r){var n=e.l+t,a=Xu(e);r.biff==2&&++e.l;var s=nue(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=eue(e,n-e.l,r);return{cell:a,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function iue(e,t,r,n,a){var s=y0(t,r,a),o=aue(e.v),l=yr(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=yr(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Bs([s,o,l,u]);return f}function vS(e,t,r){var n=e.read_shift(4),a=Z1(e,n,r),s=e.read_shift(4),o=s>0?J1(e,s,a,r):null;return[a,o]}var sue=vS,wS=vS,oue=vS,lue=vS,cue={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},rU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},uue={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function RP(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function due(e){var t="of:="+e.replace(DN,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function G5(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function fue(e){return e.replace(/\./,"!")}var wx={},um={},Sx=typeof Map<"u";function zN(e,t,r){var n=0,a=e.length;if(r){if(Sx?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Sx?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(Sx?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function SS(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(So=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=l1(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=M2(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function t0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function mh(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,s=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){kd(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=s;++a)if(e[a].numFmtId===n)return a;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function nU(e,t,r,n,a,s){try{n.cellNF&&(e.z=kn[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ni(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(kn[t]==null&&kd(cne[t]||"General",t),e.t==="e")e.w=e.w||Xd[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=t1(e.v);else if(e.t==="d"){var o=_s(e.v);(o|0)===o?e.w=o.toString(10):e.w=t1(o)}else{if(e.v===void 0)return"";e.w=p0(e.v,um)}else e.t==="d"?e.w=vc(t,_s(e.v),um):e.w=vc(t,e.v,um)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=L2(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=L2(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function hue(e,t,r){if(e&&e["!ref"]){var n=ua(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function pue(e,t){var r=ua(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=$n(r))}var mue=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,gue=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,xue=/<(?:\w:)?hyperlink [^>]*>/mg,yue=/"(\w*:\w*)"/,bue=/<(?:\w:)?col\b[^>]*[\/]?>/g,vue=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,wue=/<(?:\w:)?pageMargins[^>]*\/>/g,aU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Sue=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,_ue=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kue(e,t,r,n,a,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(gue);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var p=u.match(aU);p?WN(p[0],l,a,r):(p=u.match(Sue))&&Aue(p[0],p[1]||"",l,a,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(yue);m&&pue(l,m[1])}var g=u.match(_ue);g&&g[1]&&Due(g[1],a);var b=[];if(t.cellStyles){var y=u.match(bue);y&&Mue(b,y)}f&&zue(f[1],l,t,c,s,o);var v=d.match(vue);v&&(l["!autofilter"]=Rue(v[0]));var w=[],_=d.match(mue);if(_)for(h=0;h!=_.length;++h)w[h]=ua(_[h].slice(_[h].indexOf('"')+1));var C=d.match(xue);C&&Pue(l,C,n);var j=d.match(wue);if(j&&(l["!margins"]=Oue(Cn(j[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=$n(c)),t.sheetRows>0&&l["!ref"]){var A=ua(l["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>c.e.r&&(A.e.r=c.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>c.e.c&&(A.e.c=c.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),l["!fullref"]=l["!ref"],l["!ref"]=$n(A))}return b.length>0&&(l["!cols"]=b),w.length>0&&(l["!merges"]=w),l}function jue(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+$n(e[r])+'"/>';return t+"</mergeCells>"}function WN(e,t,r,n){var a=Cn(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=ca($a(a.codeName)))}function Aue(e,t,r,n,a){WN(e.slice(0,e.indexOf(">")),r,n,a)}function Nue(e,t,r,n,a){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Mu(La(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+Gr("outlinePr",null,u)}!s&&!l||(a[a.length]=Gr("sheetPr",l,o))}var Cue=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Eue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Tue(e){var t={sheet:1};return Cue.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Eue.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=RN(e.password).toString(16).toUpperCase()),Gr("sheetProtection",null,t)}function Pue(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Cn($a(t[a]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+ca(s.location))):(s.Target="#"+ca(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=ua(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=An({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function Oue(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Lue(e){return t0(e),Gr("pageMargins",null,e)}function Mue(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Cn(t[n],!0);a.hidden&&(a.hidden=ei(a.hidden));var s=parseInt(a.min,10)-1,o=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,BN(a.width)),th(a);s<=o;)e[s++]=ai(a)}}function Fue(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Gr("col",null,SS(a,n)));return r[r.length]="</cols>",r.join("")}function Rue(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Bue(e,t,r,n){var a=typeof e.ref=="string"?e.ref:$n(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=gl(a);o.s.r==o.e.r&&(o.e.r=gl(t["!ref"]).e.r,a=$n(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Gr("autoFilter",null,{ref:a})}var Iue=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Due(e,t){t.Views||(t.Views=[{}]),(e.match(Iue)||[]).forEach(function(r,n){var a=Cn(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),ei(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function $ue(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Gr("sheetViews",Gr("sheetView",null,a),{})}function Uue(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Xd[e.v];break;case"d":n&&n.cellDates?a=ni(e.v,-1).toISOString():(e=ai(e),e.t="n",a=""+(e.v=_s(ni(e.v)))),typeof e.z>"u"&&(e.z=kn[14]);break;default:a=e.v;break}var l=ro("v",La(a)),c={r:t},u=mh(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=ro("v",""+zN(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=Gr("f",La(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Gr("c",l,c)}var zue=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=r1("v"),o=r1("f");return function(c,u,d,f,p,h){for(var m=0,g="",b=[],y=[],v=0,w=0,_=0,C="",j,A,M=0,P=0,R,N,T=0,B=0,G=Array.isArray(h.CellXf),re,xe=[],_e=[],V=Array.isArray(u),K=[],de={},ne=!1,E=!!d.sheetStubs,Z=c.split(t),H=0,F=Z.length;H!=F;++H){g=Z[H].trim();var ee=g.length;if(ee!==0){var z=0;e:for(m=0;m<ee;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(A=Cn(g.slice(z,m),!0),M=A.r!=null?parseInt(A.r,10):M+1,P=-1,d.sheetRows&&d.sheetRows<M)continue;de={},ne=!1,A.ht&&(ne=!0,de.hpt=parseFloat(A.ht),de.hpx=Em(de.hpt)),A.hidden=="1"&&(ne=!0,de.hidden=!0),A.outlineLevel!=null&&(ne=!0,de.level=+A.outlineLevel),ne&&(K[M-1]=de)}break;case"<":z=m;break}if(z>=m)break;if(A=Cn(g.slice(z,m),!0),M=A.r!=null?parseInt(A.r,10):M+1,P=-1,!(d.sheetRows&&d.sheetRows<M)){f.s.r>M-1&&(f.s.r=M-1),f.e.r<M-1&&(f.e.r=M-1),d&&d.cellStyles&&(de={},ne=!1,A.ht&&(ne=!0,de.hpt=parseFloat(A.ht),de.hpx=Em(de.hpt)),A.hidden=="1"&&(ne=!0,de.hidden=!0),A.outlineLevel!=null&&(ne=!0,de.level=+A.outlineLevel),ne&&(K[M-1]=de)),b=g.slice(m).split(e);for(var X=0;X!=b.length&&b[X].trim().charAt(0)=="<";++X);for(b=b.slice(X),m=0;m!=b.length;++m)if(g=b[m].trim(),g.length!==0){if(y=g.match(r),v=m,w=0,_=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,y!=null&&y.length===2){for(v=0,C=y[1],w=0;w!=C.length&&!((_=C.charCodeAt(w)-64)<1||_>26);++w)v=26*v+_;--v,P=v}else++P;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,A=Cn(g.slice(0,w),!0),A.r||(A.r=An({r:M-1,c:P})),C=g.slice(w),j={t:""},(y=C.match(s))!=null&&y[1]!==""&&(j.v=ca(y[1])),d.cellFormula){if((y=C.match(o))!=null&&y[1]!==""){if(j.f=ca($a(y[1])).replace(/\r\n/g,`
`),d.xlfn||(j.f=OP(j.f)),y[0].indexOf('t="array"')>-1)j.F=(C.match(a)||[])[1],j.F.indexOf(":")>-1&&xe.push([ua(j.F),j.F]);else if(y[0].indexOf('t="shared"')>-1){N=Cn(y[0]);var J=ca($a(y[1]));d.xlfn||(J=OP(J)),_e[parseInt(N.si,10)]=[N,J,A.r]}}else(y=C.match(/<f[^>]*\/>/))&&(N=Cn(y[0]),_e[N.si]&&(j.f=Ile(_e[N.si][1],_e[N.si][2],A.r)));var q=yi(A.r);for(w=0;w<xe.length;++w)q.r>=xe[w][0].s.r&&q.r<=xe[w][0].e.r&&q.c>=xe[w][0].s.c&&q.c<=xe[w][0].e.c&&(j.F=xe[w][1])}if(A.t==null&&j.v===void 0)if(j.f||j.F)j.v=0,j.t="n";else if(E)j.t="z";else continue;else j.t=A.t||"n";switch(f.s.c>P&&(f.s.c=P),f.e.c<P&&(f.e.c=P),j.t){case"n":if(j.v==""||j.v==null){if(!E)continue;j.t="z"}else j.v=parseFloat(j.v);break;case"s":if(typeof j.v>"u"){if(!E)continue;j.t="z"}else R=wx[parseInt(j.v,10)],j.v=R.t,j.r=R.r,d.cellHTML&&(j.h=R.h);break;case"str":j.t="s",j.v=j.v!=null?$a(j.v):"",d.cellHTML&&(j.h=wN(j.v));break;case"inlineStr":y=C.match(n),j.t="s",y!=null&&(R=FN(y[1]))?(j.v=R.t,d.cellHTML&&(j.h=R.h)):j.v="";break;case"b":j.v=ei(j.v);break;case"d":d.cellDates?j.v=ni(j.v,1):(j.v=_s(ni(j.v,1)),j.t="n");break;case"e":(!d||d.cellText!==!1)&&(j.w=j.v),j.v=s$[j.v];break}if(T=B=0,re=null,G&&A.s!==void 0&&(re=h.CellXf[A.s],re!=null&&(re.numFmtId!=null&&(T=re.numFmtId),d.cellStyles&&re.fillId!=null&&(B=re.fillId))),nU(j,T,B,d,p,h),d.cellDates&&G&&j.t=="n"&&Xm(kn[T])&&(j.t="d",j.v=yS(j.v)),A.cm&&d.xlmeta){var Y=(d.xlmeta.Cell||[])[+A.cm-1];Y&&Y.type=="XLDAPR"&&(j.D=!0)}if(V){var L=yi(A.r);u[L.r]||(u[L.r]=[]),u[L.r][L.c]=j}else u[A.r]=j}}}}K.length>0&&(u["!rows"]=K)}}();function Wue(e,t,r,n){var a=[],s=[],o=ua(e["!ref"]),l="",c,u="",d=[],f=0,p=0,h=e["!rows"],m=Array.isArray(e),g={r:u},b,y=-1;for(p=o.s.c;p<=o.e.c;++p)d[p]=xi(p);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=Ji(f),p=o.s.c;p<=o.e.c;++p){c=d[p]+u;var v=m?(e[f]||[])[p]:e[c];v!==void 0&&(l=Uue(v,c,e,t))!=null&&s.push(l)}(s.length>0||h&&h[f])&&(g={r:u},h&&h[f]&&(b=h[f],b.hidden&&(g.hidden=1),y=-1,b.hpx?y=c1(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(g.ht=y,g.customHeight=1),b.level&&(g.outlineLevel=b.level)),a[a.length]=Gr("row",s.join(""),g))}if(h)for(;f<h.length;++f)h&&h[f]&&(g={r:f+1},b=h[f],b.hidden&&(g.hidden=1),y=-1,b.hpx?y=c1(b.hpx):b.hpt&&(y=b.hpt),y>-1&&(g.ht=y,g.customHeight=1),b.level&&(g.outlineLevel=b.level),a[a.length]=Gr("row","",g));return a.join("")}function iU(e,t,r,n){var a=[Zi,Gr("worksheet",null,{xmlns:$0[0],"xmlns:r":ws.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=ua(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=$n(d)}n||(n={}),c["!comments"]=[];var f=[];Nue(c,r,e,t,a),a[a.length]=Gr("dimension",null,{ref:u}),a[a.length]=$ue(c,t,e,r),t.sheetFormat&&(a[a.length]=Gr("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=Fue(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Wue(c,t),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=Tue(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=Bue(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=jue(c["!merges"]));var p=-1,h,m=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(h={ref:g[0]},g[1].Target.charAt(0)!="#"&&(m=Ta(n,-1,La(g[1].Target).replace(/#.*$/,""),Qn.HLINK),h["r:id"]="rId"+m),(p=g[1].Target.indexOf("#"))>-1&&(h.location=La(g[1].Target.slice(p+1))),g[1].Tooltip&&(h.tooltip=La(g[1].Tooltip)),a[a.length]=Gr("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=Lue(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=ro("ignoredErrors",Gr("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=Ta(n,-1,"../drawings/drawing"+(e+1)+".xml",Qn.DRAW),a[a.length]=Gr("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=Ta(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Qn.VML),a[a.length]=Gr("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function que(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}function Hue(e,t,r){var n=yr(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;a.hpx?s=c1(a.hpx)*20:a.hpt&&(s=a.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,p=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[An(u)];m&&(f<0&&(f=h),p=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,p))}var g=n.l;return n.l=c,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function Vue(e,t,r,n){var a=Hue(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&Lr(e,0,a)}var Gue=q0,Kue=Jm;function Xue(){}function Yue(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Zne(e),r}function Que(e,t,r){r==null&&(r=yr(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return T2({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),t$(e,r),r.slice(0,r.l)}function Jue(e){var t=Nc(e);return[t]}function Zue(e,t,r){return r==null&&(r=yr(8)),U0(t,r)}function ede(e){var t=z0(e);return[t]}function tde(e,t,r){return r==null&&(r=yr(4)),W0(t,r)}function rde(e){var t=Nc(e),r=e.read_shift(1);return[t,r,"b"]}function nde(e,t,r){return r==null&&(r=yr(9)),U0(t,r),r.write_shift(1,e.v?1:0),r}function ade(e){var t=z0(e),r=e.read_shift(1);return[t,r,"b"]}function ide(e,t,r){return r==null&&(r=yr(5)),W0(t,r),r.write_shift(1,e.v?1:0),r}function sde(e){var t=Nc(e),r=e.read_shift(1);return[t,r,"e"]}function ode(e,t,r){return r==null&&(r=yr(9)),U0(t,r),r.write_shift(1,e.v),r}function lde(e){var t=z0(e),r=e.read_shift(1);return[t,r,"e"]}function cde(e,t,r){return r==null&&(r=yr(8)),W0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function ude(e){var t=Nc(e),r=e.read_shift(4);return[t,r,"s"]}function dde(e,t,r){return r==null&&(r=yr(12)),U0(t,r),r.write_shift(4,t.v),r}function fde(e){var t=z0(e),r=e.read_shift(4);return[t,r,"s"]}function hde(e,t,r){return r==null&&(r=yr(8)),W0(t,r),r.write_shift(4,t.v),r}function pde(e){var t=Nc(e),r=jo(e);return[t,r,"n"]}function mde(e,t,r){return r==null&&(r=yr(16)),U0(t,r),g0(e.v,r),r}function sU(e){var t=z0(e),r=jo(e);return[t,r,"n"]}function gde(e,t,r){return r==null&&(r=yr(12)),W0(t,r),g0(e.v,r),r}function xde(e){var t=Nc(e),r=TN(e);return[t,r,"n"]}function yde(e,t,r){return r==null&&(r=yr(12)),U0(t,r),r$(e.v,r),r}function bde(e){var t=z0(e),r=TN(e);return[t,r,"n"]}function vde(e,t,r){return r==null&&(r=yr(8)),W0(t,r),r$(e.v,r),r}function wde(e){var t=Nc(e),r=NN(e);return[t,r,"is"]}function Sde(e){var t=Nc(e),r=Ao(e);return[t,r,"str"]}function _de(e,t,r){return r==null&&(r=yr(12+4*e.v.length)),U0(t,r),Is(e.v,r),r.length>r.l?r.slice(0,r.l):r}function kde(e){var t=z0(e),r=Ao(e);return[t,r,"str"]}function jde(e,t,r){return r==null&&(r=yr(8+4*e.v.length)),W0(t,r),Is(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Ade(e,t,r){var n=e.l+t,a=Nc(e);a.r=r["!row"];var s=e.read_shift(1),o=[a,s,"b"];if(r.cellFormula){e.l+=2;var l=wS(e,n-e.l,r);o[3]=vo(l,null,a,r.supbooks,r)}else e.l=n;return o}function Nde(e,t,r){var n=e.l+t,a=Nc(e);a.r=r["!row"];var s=e.read_shift(1),o=[a,s,"e"];if(r.cellFormula){e.l+=2;var l=wS(e,n-e.l,r);o[3]=vo(l,null,a,r.supbooks,r)}else e.l=n;return o}function Cde(e,t,r){var n=e.l+t,a=Nc(e);a.r=r["!row"];var s=jo(e),o=[a,s,"n"];if(r.cellFormula){e.l+=2;var l=wS(e,n-e.l,r);o[3]=vo(l,null,a,r.supbooks,r)}else e.l=n;return o}function Ede(e,t,r){var n=e.l+t,a=Nc(e);a.r=r["!row"];var s=Ao(e),o=[a,s,"str"];if(r.cellFormula){e.l+=2;var l=wS(e,n-e.l,r);o[3]=vo(l,null,a,r.supbooks,r)}else e.l=n;return o}var Tde=q0,Pde=Jm;function Ode(e,t){return t==null&&(t=yr(4)),t.write_shift(4,e),t}function Lde(e,t){var r=e.l+t,n=q0(e),a=CN(e),s=Ao(e),o=Ao(e),l=Ao(e);e.l=r;var c={rfx:n,relId:a,loc:s,display:l};return o&&(c.Tooltip=o),c}function Mde(e,t){var r=yr(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Jm({s:yi(e[0]),e:yi(e[0])},r),EN("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Is(a||"",r),Is(e[1].Tooltip||"",r),Is("",r),r.slice(0,r.l)}function Fde(){}function Rde(e,t,r){var n=e.l+t,a=n$(e),s=e.read_shift(1),o=[a];if(o[2]=s,r.cellFormula){var l=sue(e,n-e.l,r);o[1]=l}else e.l=n;return o}function Bde(e,t,r){var n=e.l+t,a=q0(e),s=[a];if(r.cellFormula){var o=lue(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function Ide(e,t,r){r==null&&(r=yr(18));var n=SS(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var oU=["left","right","top","bottom","header","footer"];function Dde(e){var t={};return oU.forEach(function(r){t[r]=jo(e)}),t}function $de(e,t){return t==null&&(t=yr(6*8)),t0(e),oU.forEach(function(r){g0(e[r],t)}),t}function Ude(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function zde(e,t,r){r==null&&(r=yr(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Wde(e){var t=yr(24);return t.write_shift(4,4),t.write_shift(4,1),Jm(e,t),t}function qde(e,t){return t==null&&(t=yr(16*4+2)),t.write_shift(2,e.password?RN(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Hde(){}function Vde(){}function Gde(e,t,r,n,a,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,h,m,g,b,y,v,w,_,C,j=[];l.biff=12,l["!row"]=0;var A=0,M=!1,P=[],R={},N=l.supbooks||a.supbooks||[[]];if(N.sharedf=R,N.arrayf=P,N.SheetNames=a.SheetNames||a.Sheets.map(function(V){return V.name}),!l.supbooks&&(l.supbooks=N,a.Names))for(var T=0;T<a.Names.length;++T)N[0][T+1]=a.Names[T];var B=[],G=[],re=!1;u1[16]={n:"BrtShortReal",f:sU};var xe;if(Kd(e,function(K,de,ne){if(!p)switch(ne){case 148:u=K;break;case 0:h=K,l.sheetRows&&l.sheetRows<=h.r&&(p=!0),_=Ji(b=h.r),l["!row"]=h.r,(K.hidden||K.hpt||K.level!=null)&&(K.hpt&&(K.hpx=Em(K.hpt)),G[K.r]=K);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:K[2]},K[2]){case"n":m.v=K[1];break;case"s":w=wx[K[1]],m.v=w.t,m.r=w.r;break;case"b":m.v=!!K[1];break;case"e":m.v=K[1],l.cellText!==!1&&(m.w=Xd[m.v]);break;case"str":m.t="s",m.v=K[1];break;case"is":m.t="s",m.v=K[1].t;break}if((g=o.CellXf[K[0].iStyleRef])&&nU(m,g.numFmtId,null,l,s,o),y=K[0].c==-1?y+1:K[0].c,l.dense?(c[b]||(c[b]=[]),c[b][y]=m):c[xi(y)+_]=m,l.cellFormula){for(M=!1,A=0;A<P.length;++A){var E=P[A];h.r>=E[0].s.r&&h.r<=E[0].e.r&&y>=E[0].s.c&&y<=E[0].e.c&&(m.F=$n(E[0]),M=!0)}!M&&K.length>3&&(m.f=K[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>y&&(d.s.c=y),d.e.r<h.r&&(d.e.r=h.r),d.e.c<y&&(d.e.c=y),l.cellDates&&g&&m.t=="n"&&Xm(kn[g.numFmtId])){var Z=Wh(m.v);Z&&(m.t="d",m.v=new Date(Z.y,Z.m-1,Z.d,Z.H,Z.M,Z.S,Z.u))}xe&&(xe.type=="XLDAPR"&&(m.D=!0),xe=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},y=K[0].c==-1?y+1:K[0].c,l.dense?(c[b]||(c[b]=[]),c[b][y]=m):c[xi(y)+_]=m,d.s.r>h.r&&(d.s.r=h.r),d.s.c>y&&(d.s.c=y),d.e.r<h.r&&(d.e.r=h.r),d.e.c<y&&(d.e.c=y),xe&&(xe.type=="XLDAPR"&&(m.D=!0),xe=void 0);break;case 176:j.push(K);break;case 49:xe=((l.xlmeta||{}).Cell||[])[K-1];break;case 494:var H=n["!id"][K.relId];for(H?(K.Target=H.Target,K.loc&&(K.Target+="#"+K.loc),K.Rel=H):K.relId==""&&(K.Target="#"+K.loc),b=K.rfx.s.r;b<=K.rfx.e.r;++b)for(y=K.rfx.s.c;y<=K.rfx.e.c;++y)l.dense?(c[b]||(c[b]=[]),c[b][y]||(c[b][y]={t:"z",v:void 0}),c[b][y].l=K):(v=An({c:y,r:b}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=K);break;case 426:if(!l.cellFormula)break;P.push(K),C=l.dense?c[b][y]:c[xi(y)+_],C.f=vo(K[1],d,{r:h.r,c:y},N,l),C.F=$n(K[0]);break;case 427:if(!l.cellFormula)break;R[An(K[0].s)]=K[1],C=l.dense?c[b][y]:c[xi(y)+_],C.f=vo(K[1],d,{r:h.r,c:y},N,l);break;case 60:if(!l.cellStyles)break;for(;K.e>=K.s;)B[K.e--]={width:K.w/256,hidden:!!(K.flags&1),level:K.level},re||(re=!0,BN(K.w/256)),th(B[K.e+1]);break;case 161:c["!autofilter"]={ref:$n(K)};break;case 476:c["!margins"]=K;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),K.name&&(a.Sheets[r].CodeName=K.name),(K.above||K.left)&&(c["!outline"]={above:K.above,left:K.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),K.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!de.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+ne.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=$n(u||d)),l.sheetRows&&c["!ref"]){var _e=ua(c["!ref"]);l.sheetRows<=+_e.e.r&&(_e.e.r=l.sheetRows-1,_e.e.r>d.e.r&&(_e.e.r=d.e.r),_e.e.r<_e.s.r&&(_e.s.r=_e.e.r),_e.e.c>d.e.c&&(_e.e.c=d.e.c),_e.e.c<_e.s.c&&(_e.s.c=_e.e.c),c["!fullref"]=c["!ref"],c["!ref"]=$n(_e))}return j.length>0&&(c["!merges"]=j),B.length>0&&(c["!cols"]=B),G.length>0&&(c["!rows"]=G),c}function Kde(e,t,r,n,a,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=ai(t),t.z=t.z||kn[14],t.v=_s(ni(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=mh(a.cellXfs,t,a),t.l&&s["!links"].push([An(c),t.l]),t.c&&s["!comments"].push([An(c),t.c]),t.t){case"s":case"str":return a.bookSST?(l=zN(a.Strings,t.v,a.revStrings),c.t="s",c.v=l,o?Lr(e,18,hde(t,c)):Lr(e,7,dde(t,c))):(c.t="str",o?Lr(e,17,jde(t,c)):Lr(e,6,_de(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Lr(e,13,vde(t,c)):Lr(e,2,yde(t,c)):o?Lr(e,16,gde(t,c)):Lr(e,5,mde(t,c)),!0;case"b":return c.t="b",o?Lr(e,15,ide(t,c)):Lr(e,4,nde(t,c)),!0;case"e":return c.t="e",o?Lr(e,14,cde(t,c)):Lr(e,3,ode(t,c)),!0}return o?Lr(e,12,tde(t,c)):Lr(e,1,Zue(t,c)),!0}function Xde(e,t,r,n){var a=ua(t["!ref"]||"A1"),s,o="",l=[];Lr(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var d=a.s.r;d<=u;++d){o=Ji(d),Vue(e,t,a,d);var f=!1;if(d<=a.e.r)for(var p=a.s.c;p<=a.e.c;++p){d===a.s.r&&(l[p]=xi(p)),s=l[p]+o;var h=c?(t[d]||[])[p]:t[s];if(!h){f=!1;continue}f=Kde(e,h,d,p,n,t,f)}}Lr(e,146)}function Yde(e,t){!t||!t["!merges"]||(Lr(e,177,Ode(t["!merges"].length)),t["!merges"].forEach(function(r){Lr(e,176,Pde(r))}),Lr(e,178))}function Qde(e,t){!t||!t["!cols"]||(Lr(e,390),t["!cols"].forEach(function(r,n){r&&Lr(e,60,Ide(n,r))}),Lr(e,391))}function Jde(e,t){!t||!t["!ref"]||(Lr(e,648),Lr(e,649,Wde(ua(t["!ref"]))),Lr(e,650))}function Zde(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=Ta(r,-1,n[1].Target.replace(/#.*$/,""),Qn.HLINK);Lr(e,494,Mde(n,a))}}),delete t["!links"]}function efe(e,t,r,n){if(t["!comments"].length>0){var a=Ta(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Qn.VML);Lr(e,551,EN("rId"+a)),t["!legacy"]=a}}function tfe(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],s=typeof a.ref=="string"?a.ref:$n(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=gl(s);l.s.r==l.e.r&&(l.e.r=gl(t["!ref"]).e.r,s=$n(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Lr(e,161,Jm(ua(s))),Lr(e,162)}}function rfe(e,t,r){Lr(e,133),Lr(e,137,zde(t,r)),Lr(e,138),Lr(e,134)}function nfe(e,t){t["!protect"]&&Lr(e,535,qde(t["!protect"]))}function afe(e,t,r,n){var a=ml(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=ua(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Lr(a,129),(r.vbaraw||o["!outline"])&&Lr(a,147,Que(l,o["!outline"])),Lr(a,148,Kue(c)),rfe(a,o,r.Workbook),Qde(a,o),Xde(a,o,e,t),nfe(a,o),tfe(a,o,r,e),Yde(a,o),Zde(a,o,n),o["!margins"]&&Lr(a,476,$de(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Jde(a,o),efe(a,o,e,n),Lr(a,130),a.end()}function ife(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var a=ca((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function sfe(e,t,r,n,a,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=ife(f);d.s.r=d.s.c=0,d.e.c=l,u=xi(l),p[0].forEach(function(h,m){o[u+Ji(m)]={t:"n",v:h,z:p[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=$n(d)),o}function ofe(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(aU);return l&&WN(l[0],s,a,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function lfe(e,t){e.l+=10;var r=Ao(e);return{name:r}}function cfe(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Kd(e,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),c.name&&(a.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var qN=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ufe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],dfe=[],ffe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function BP(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=ei(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function IP(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ei(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function lU(e){IP(e.WBProps,qN),IP(e.CalcPr,ffe),BP(e.WBView,ufe),BP(e.Sheets,dfe),um.date1904=ei(e.WBProps.date1904)}function hfe(e){return!e.Workbook||!e.Workbook.WBProps?"false":ei(e.Workbook.WBProps.date1904)?"true":"false"}var pfe="][*?/\\".split("");function cU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return pfe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function mfe(e,t,r){e.forEach(function(n,a){cU(n);for(var s=0;s<a;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[a]&&t[a].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function gfe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];mfe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)hue(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var xfe=/<\w+:workbook/;function yfe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},o=0;if(e.replace(Po,function(c,u){var d=Cn(c);switch(Ku(d[0])){case"<?xml":break;case"<workbook":c.match(xfe)&&(a="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[a];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":qN.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=ei(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=$a(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=ca($a(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=$a(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),ei(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=ca($a(e.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),$0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return lU(r),r}function uU(e){var t=[Zi];t[t.length]=Gr("workbook",null,{xmlns:$0[0],"xmlns:r":ws.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(qN.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Gr("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],s=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!a[s]||!a[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:La(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),a[s])switch(a[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Gr("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=Gr("definedName",La(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function bfe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=kA(e),r.name=Ao(e),r}function vfe(e,t){return t||(t=yr(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),EN(e.strRelID,t),Is(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function wfe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Ao(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Sfe(e,t){t||(t=yr(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),t$(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function _fe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function kfe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=eae(e),o=oue(e,0,r),l=CN(e);e.l=n;var c={Name:s,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function jfe(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],u1[16]={n:"BrtFRTArchID$",f:_fe},Kd(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=vo(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(d),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!u.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),lU(r),r.Names=s,r.supbooks=o,r}function Afe(e,t){Lr(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Lr(e,156,vfe(a))}Lr(e,144)}function Nfe(e,t){t||(t=yr(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Is("SheetJS",t),Is(_2.version,t),Is(_2.version,t),Is("7262",t),t.length>t.l?t.slice(0,t.l):t}function Cfe(e,t){t||(t=yr(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Efe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&s==-1&&(s=n);s>a||(Lr(e,135),Lr(e,158,Cfe(a)),Lr(e,136))}}function Tfe(e,t){var r=ml();return Lr(r,131),Lr(r,128,Nfe()),Lr(r,153,Sfe(e.Workbook&&e.Workbook.WBProps||null)),Efe(r,e),Afe(r,e),Lr(r,132),r.end()}function Pfe(e,t,r){return t.slice(-4)===".bin"?jfe(e,r):yfe(e,r)}function Ofe(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?Gde(e,n,r,a,s,o,l):kue(e,n,r,a,s,o,l)}function Lfe(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?cfe(e,n,r,a,s):ofe(e,n,r,a,s)}function Mfe(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?Rle():Ble()}function Ffe(e,t,r,n,a,s,o,l){return t.slice(-4)===".bin"?Mle():Fle()}function Rfe(e,t,r,n){return t.slice(-4)===".bin"?Poe(e,r,n):boe(e,r,n)}function Bfe(e,t,r){return q$(e,r)}function Ife(e,t,r){return t.slice(-4)===".bin"?Ise(e,r):Fse(e,r)}function Dfe(e,t,r){return t.slice(-4)===".bin"?Ele(e,r):vle(e,r)}function $fe(e,t,r){return t.slice(-4)===".bin"?xle(e):mle(e)}function Ufe(e,t,r,n){return r.slice(-4)===".bin"?yle(e,t,r,n):void 0}function zfe(e,t,r){return t.slice(-4)===".bin"?fle(e,t,r):ple(e,t,r)}function Wfe(e,t,r){return(t.slice(-4)===".bin"?Tfe:uU)(e)}function qfe(e,t,r,n,a){return(t.slice(-4)===".bin"?afe:iU)(e,r,n,a)}function Hfe(e,t,r){return(t.slice(-4)===".bin"?Uoe:z$)(e,r)}function Vfe(e,t,r){return(t.slice(-4)===".bin"?Use:M$)(e,r)}function Gfe(e,t,r){return(t.slice(-4)===".bin"?Tle:G$)(e)}function Kfe(e){return(e.slice(-4)===".bin"?hle:H$)()}var dU=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,fU=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Bc(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(dU),s,o,l,c;if(a)for(c=0;c!=a.length;++c)s=a[c].match(fU),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function Xfe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(dU),a,s,o,l;if(n)for(l=0;l!=n.length;++l)a=n[l].match(fU),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(s+1),r[o]=a[2].slice(1,a[2].length-1));return r}var _x;function Yfe(e,t){var r=_x[e]||ca(e);return r==="General"?p0(t):vc(r,t)}function Qfe(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=ei(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=ni(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ca(t)]=a}function Jfe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Xd[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=t1(e.v):e.w=p0(e.v):e.w=Yfe(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=_x[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Xm(n)){var a=Wh(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function Zfe(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=doe[n.Pattern]||n.Pattern)}e[t.ID]=t}function ehe(e,t,r,n,a,s,o,l,c,u){var d="General",f=n.StyleID,p={};u=u||{};var h=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ei(e);break;case"String":n.t="s",n.r=tP(ca(e)),n.v=e.indexOf("<")>-1?ca(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ni(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ca(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=s$[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=tP(t||e));break}if(Jfe(n,d,u),u.cellFormula!==!1)if(n.Formula){var g=ca(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=cm(g,a),delete n.Formula,n.ArrayRange=="RC"?n.F=cm("RC:RC",a):n.ArrayRange&&(n.F=cm(n.ArrayRange,a),c.push([ua(n.F),n.F]))}else for(m=0;m<c.length;++m)a.r>=c[m][0].s.r&&a.r<=c[m][0].e.r&&a.c>=c[m][0].s.c&&a.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(h.forEach(function(b){!p.patternType&&b.patternType&&(p.patternType=b.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function the(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function K5(e,t){var r=t||{};Ym();var n=rx(SN(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=$a(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var o=ai(r);return o.type="string",Cm.to_workbook(n,o)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ze){a.indexOf("<"+ze)>=0&&(s=!0)}),s)return $he(n,r);_x={"General Number":"General","General Date":kn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":kn[15],"Short Date":kn[14],"Long Time":kn[19],"Medium Time":kn[18],"Short Time":kn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:kn[2],Standard:kn[4],Percent:kn[10],Scientific:kn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],p=r.dense?[]:{},h="",m={},g={},b=Bc('<Data ss:Type="String">'),y=0,v=0,w=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},j={},A="",M=0,P=[],R={},N={},T=0,B=[],G=[],re={},xe=[],_e,V=!1,K=[],de=[],ne={},E=0,Z=0,H={Sheets:[],WBProps:{date1904:!1}},F={};a1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";l=a1.exec(n);)switch(l[3]=(ee=l[3]).toLowerCase()){case"data":if(ee=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?ehe(n.slice(y,l.index),A,b,c[c.length-1][0]=="comment"?re:m,{c:v,r:w},C,xe[v],g,K,r):(A="",b=Bc(l[0]),y=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(G.length>0&&(m.c=G),(!r.sheetRows||r.sheetRows>w)&&m.v!==void 0&&(r.dense?(p[w]||(p[w]=[]),p[w][v]=m):p[xi(v)+Ji(w)]=m),m.HRef&&(m.l={Target:ca(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(E=v+(parseInt(m.MergeAcross,10)|0),Z=w+(parseInt(m.MergeDown,10)|0),P.push({s:{c:v,r:w},e:{c:E,r:Z}})),!r.sheetStubs)m.MergeAcross?v=E+1:++v;else if(m.MergeAcross||m.MergeDown){for(var z=v;z<=E;++z)for(var X=w;X<=Z;++X)(z>v||X>w)&&(r.dense?(p[X]||(p[X]=[]),p[X][z]={t:"z"}):p[xi(z)+Ji(X)]={t:"z"});v=E+1}else++v;else m=Xfe(l[0]),m.Index&&(v=+m.Index-1),v<_.s.c&&(_.s.c=v),v>_.e.c&&(_.e.c=v),l[0].slice(-2)==="/>"&&++v,G=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<_.s.r&&(_.s.r=w),w>_.e.r&&(_.e.r=w),l[0].slice(-2)==="/>"&&(g=Bc(l[0]),g.Index&&(w=+g.Index-1)),v=0,++w):(g=Bc(l[0]),g.Index&&(w=+g.Index-1),ne={},(g.AutoFitHeight=="0"||g.Height)&&(ne.hpx=parseInt(g.Height,10),ne.hpt=c1(ne.hpx),de[w]=ne),g.Hidden=="1"&&(ne.hidden=!0,de[w]=ne));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(h),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(p["!ref"]=$n(_),r.sheetRows&&r.sheetRows<=_.e.r&&(p["!fullref"]=p["!ref"],_.e.r=r.sheetRows-1,p["!ref"]=$n(_))),P.length&&(p["!merges"]=P),xe.length>0&&(p["!cols"]=xe),de.length>0&&(p["!rows"]=de),d[h]=p}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=v=0,c.push([l[3],!1]),u=Bc(l[0]),h=ca(u.Name),p=r.dense?[]:{},P=[],K=[],de=[],F={name:h,Hidden:0},H.Sheets.push(F);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),xe=[],V=!1}break;case"style":l[1]==="/"?Zfe(C,j,r):j=Bc(l[0]);break;case"numberformat":j.nf=ca(Bc(l[0]).Format||"General"),_x[j.nf]&&(j.nf=_x[j.nf]);for(var J=0;J!=392&&kn[J]!=j.nf;++J);if(J==392){for(J=57;J!=392;++J)if(kn[J]==null){kd(j.nf,J);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(_e=Bc(l[0]),_e.Hidden&&(_e.hidden=!0,delete _e.Hidden),_e.Width&&(_e.wpx=parseInt(_e.Width,10)),!V&&_e.wpx>10){V=!0,So=$$;for(var q=0;q<xe.length;++q)xe[q]&&th(xe[q])}V&&th(_e),xe[_e.Index-1||xe.length]=_e;for(var Y=0;Y<+_e.Span;++Y)xe[xe.length]=ai(_e);break;case"namedrange":if(l[1]==="/")break;H.Names||(H.Names=[]);var L=Cn(l[0]),U={Name:L.Name,Ref:cm(L.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(U.Sheet=H.Sheets.length-1),H.Names.push(U);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?A+=n.slice(M,l.index):M=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;j.Interior=Bc(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?jae(R,ee,n.slice(T,l.index)):T=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));the(re),G.push(re)}else c.push([l[3],!1]),u=Bc(l[0]),re={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ce=Bc(l[0]);p["!autofilter"]={ref:cm(ce.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return WP(n,r);var W=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:W=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:W=!1}break;case"excelworkbook":switch(l[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:W=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:W=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(T,l.index)){case"SheetHidden":F.Hidden=1;break;case"SheetVeryHidden":F.Hidden=2;break}else T=l.index+l[0].length;break;case"header":p["!margins"]||t0(p["!margins"]={},"xlml"),isNaN(+Cn(l[0]).Margin)||(p["!margins"].header=+Cn(l[0]).Margin);break;case"footer":p["!margins"]||t0(p["!margins"]={},"xlml"),isNaN(+Cn(l[0]).Margin)||(p["!margins"].footer=+Cn(l[0]).Margin);break;case"pagemargins":var ae=Cn(l[0]);p["!margins"]||t0(p["!margins"]={},"xlml"),isNaN(+ae.Top)||(p["!margins"].top=+ae.Top),isNaN(+ae.Left)||(p["!margins"].left=+ae.Left),isNaN(+ae.Right)||(p["!margins"].right=+ae.Right),isNaN(+ae.Bottom)||(p["!margins"].bottom=+ae.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:W=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:W=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:W=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:W=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:W=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:W=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:W=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:W=!1}break;case"smarttags":break;default:W=!1;break}if(W||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Qfe(N,ee,B,n.slice(T,l.index)):(B=l,T=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var he={};return!r.bookSheets&&!r.bookProps&&(he.Sheets=d),he.SheetNames=f,he.Workbook=H,he.SSF=ai(kn),he.Props=R,he.Custprops=N,he}function PA(e,t){switch(VN(t=t||{}),t.type||"base64"){case"base64":return K5(zl(e),t);case"binary":case"buffer":case"file":return K5(e,t);case"array":return K5(hh(e),t)}}function rhe(e,t){var r=[];return e.Props&&r.push(Aae(e.Props,t)),e.Custprops&&r.push(Nae(e.Props,e.Custprops)),r.join("")}function nhe(){return""}function ahe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var s=[];s.push(Gr("NumberFormat",null,{"ss:Format":La(kn[n.numFmtId])}));var o={"ss:ID":"s"+(21+a)};r.push(Gr("Style",s.join(""),o))}),Gr("Styles",r.join(""))}function hU(e){return Gr("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+$N(e.Ref,{r:0,c:0})})}function ihe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(hU(a)))}return Gr("Names",r.join(""))}function she(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,s=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(hU(l)))}return s.join("")}function ohe(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Gr("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Gr("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Gr("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Gr("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(ro("ProtectContents","True")),e["!protect"].objects&&a.push(ro("ProtectObjects","True")),e["!protect"].scenarios&&a.push(ro("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(ro("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(ro("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":Gr("WorksheetOptions",a.join(""),{xmlns:Tl.x})}function lhe(e){return e.map(function(t){var r=Ene(t.t||""),n=Gr("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Gr("Comment",n,{"ss:Author":t.a})}).join("")}function che(e,t,r,n,a,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+La($N(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=yi(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=La(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=La(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=Xd[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||kn[14]);break;case"s":f="String",p=Cne(e.v||"");break}var h=mh(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(g+=lhe(e.c)),Gr("Cell",g,l)}function uhe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Em(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function dhe(e,t,r,n){if(!e["!ref"])return"";var a=ua(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(b,y){th(b);var v=!!b.width,w=SS(y,b),_={"ss:Index":y+1};v&&(_["ss:Width"]=o1(w.width)),b.hidden&&(_["ss:Hidden"]="1"),l.push(Gr("Column",null,_))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var d=[uhe(u,(e["!rows"]||[])[u])],f=a.s.c;f<=a.e.c;++f){var p=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(p=!0);break}if(!p){var h={r:u,c:f},m=An(h),g=c?(e[u]||[])[f]:e[m];d.push(che(g,m,e,t,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function fhe(e,t,r){var n=[],a=r.SheetNames[e],s=r.Sheets[a],o=s?she(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?dhe(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(ohe(s,t,e,r)),n.join("")}function hhe(e,t){t||(t={}),e.SSF||(e.SSF=ai(kn)),e.SSF&&(Ym(),mS(e.SSF),t.revssf=xS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],mh(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(rhe(e,t)),r.push(nhe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Gr("Worksheet",fhe(n,t,e),{"ss:Name":La(e.SheetNames[n])}));return r[2]=ahe(e,t),r[3]=ihe(e),Zi+Gr("Workbook",r.join(""),{xmlns:Tl.ss,"xmlns:o":Tl.o,"xmlns:x":Tl.x,"xmlns:ss":Tl.ss,"xmlns:dt":Tl.dt,"xmlns:html":Tl.html})}function phe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=iae(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=sae(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var mhe=[60,1084,2066,2165,2175];function ghe(e,t,r,n,a){var s=n,o=[],l=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(l)}o.push(l),r.l+=s;for(var c=yd(r,r.l),u=OA[c],d=0;u!=null&&mhe.indexOf(c)>-1;)s=yd(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=OA[c=yd(r,r.l)];var f=Bs(o);to(f,0);var p=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(p),p+=o[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,a)}function xu(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=kn[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Xd[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=t1(e.v):e.w=p0(e.v):e.w=vc(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Xm(kn[n]||String(n))){var a=Wh(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function wb(e,t,r){return{v:e,ixfe:t,t:r}}function xhe(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,p="",h,m,g,b,y={},v=[],w,_,C=[],j=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},P=function(Se){return Se<8?Jh[Se]:Se<64&&j[Se-8]||Jh[Se]},R=function(Se,Te,Dt){var wt=Te.XF.data;if(!(!wt||!wt.patternType||!Dt||!Dt.cellStyles)){Te.s={},Te.s.patternType=wt.patternType;var Pt;(Pt=s1(P(wt.icvFore)))&&(Te.s.fgColor={rgb:Pt}),(Pt=s1(P(wt.icvBack)))&&(Te.s.bgColor={rgb:Pt})}},N=function(Se,Te,Dt){if(!(ne>1)&&!(Dt.sheetRows&&Se.r>=Dt.sheetRows)){if(Dt.cellStyles&&Te.XF&&Te.XF.data&&R(Se,Te,Dt),delete Te.ixfe,delete Te.XF,f=Se,p=An(Se),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Se.r<o.s.r&&(o.s.r=Se.r),Se.c<o.s.c&&(o.s.c=Se.c),Se.r+1>o.e.r&&(o.e.r=Se.r+1),Se.c+1>o.e.c&&(o.e.c=Se.c+1),Dt.cellFormula&&Te.f){for(var wt=0;wt<v.length;++wt)if(!(v[wt][0].s.c>Se.c||v[wt][0].s.r>Se.r)&&!(v[wt][0].e.c<Se.c||v[wt][0].e.r<Se.r)){Te.F=$n(v[wt][0]),(v[wt][0].s.c!=Se.c||v[wt][0].s.r!=Se.r)&&delete Te.f,Te.f&&(Te.f=""+vo(v[wt][1],o,Se,K,T));break}}Dt.dense?(a[Se.r]||(a[Se.r]=[]),a[Se.r][Se.c]=Te):a[p]=Te}},T={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(T.password=t.password);var B,G=[],re=[],xe=[],_e=[],V=!1,K=[];K.SheetNames=T.snames,K.sharedf=T.sharedf,K.arrayf=T.arrayf,K.names=[],K.XTI=[];var de=0,ne=0,E=0,Z=[],H=[],F;T.codepage=1200,Vc(1200);for(var ee=!1;e.l<e.length-1;){var z=e.l,X=e.read_shift(2);if(X===0&&de===10)break;var J=e.l===e.length?0:e.read_shift(2),q=OA[X];if(q&&q.f){if(t.bookSheets&&de===133&&X!==133)break;if(de=X,q.r===2||q.r==12){var Y=e.read_shift(2);if(J-=2,!T.enc&&Y!==X&&((Y&255)<<8|Y>>8)!==X)throw new Error("rt mismatch: "+Y+"!="+X);q.r==12&&(e.l+=10,J-=10)}var L={};if(X===10?L=q.f(e,J,T):L=ghe(X,q,e,J,T),ne==0&&[9,521,1033,2057].indexOf(de)===-1)continue;switch(X){case 34:r.opts.Date1904=A.WBProps.date1904=L;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=L,!t.password)throw new Error("File is password-protected");if(L.valid==null)throw new Error("Encryption scheme unsupported");if(!L.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=L;break;case 66:var U=Number(L);switch(U){case 21010:U=1200;break;case 32768:U=1e4;break;case 32769:U=1252;break}Vc(T.codepage=U),ee=!0;break;case 317:T.rrtabid=L;break;case 25:T.winlocked=L;break;case 439:r.opts.RefreshAll=L;break;case 12:r.opts.CalcCount=L;break;case 16:r.opts.CalcDelta=L;break;case 17:r.opts.CalcIter=L;break;case 13:r.opts.CalcMode=L;break;case 14:r.opts.CalcPrecision=L;break;case 95:r.opts.CalcSaveRecalc=L;break;case 15:T.CalcRefMode=L;break;case 2211:r.opts.FullCalc=L;break;case 129:L.fDialog&&(a["!type"]="dialog"),L.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),L.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:C.push(L);break;case 430:K.push([L]),K[K.length-1].XTI=[];break;case 35:case 547:K[K.length-1].push(L);break;case 24:case 536:F={Name:L.Name,Ref:vo(L.rgce,o,null,K,T)},L.itab>0&&(F.Sheet=L.itab-1),K.names.push(F),K[0]||(K[0]=[],K[0].XTI=[]),K[K.length-1].push(L),L.Name=="_xlnm._FilterDatabase"&&L.itab>0&&L.rgce&&L.rgce[0]&&L.rgce[0][0]&&L.rgce[0][0][0]=="PtgArea3d"&&(H[L.itab-1]={ref:$n(L.rgce[0][0][1][2])});break;case 22:T.ExternCount=L;break;case 23:K.length==0&&(K[0]=[],K[0].XTI=[]),K[K.length-1].XTI=K[K.length-1].XTI.concat(L),K.XTI=K.XTI.concat(L);break;case 2196:if(T.biff<8)break;F!=null&&(F.Comment=L[1]);break;case 18:a["!protect"]=L;break;case 19:L!==0&&T.WTF&&console.error("Password verifier: "+L);break;case 133:s[L.pos]=L,T.snames.push(L.name);break;case 10:{if(--ne)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,a["!ref"]=$n(o),t.sheetRows&&t.sheetRows<=o.e.r){var ce=o.e.r;o.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=$n(o),o.e.r=ce}o.e.r++,o.e.c++}G.length>0&&(a["!merges"]=G),re.length>0&&(a["!objects"]=re),xe.length>0&&(a["!cols"]=xe),_e.length>0&&(a["!rows"]=_e),A.Sheets.push(M)}u===""?d=a:n[u]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(T.biff===8&&(T.biff={9:2,521:3,1033:4}[X]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[L.BIFFVer]||8),T.biffguess=L.BIFFVer==0,L.BIFFVer==0&&L.dt==4096&&(T.biff=5,ee=!0,Vc(T.codepage=28591)),T.biff==8&&L.BIFFVer==0&&L.dt==16&&(T.biff=2),ne++)break;if(a=t.dense?[]:{},T.biff<8&&!ee&&(ee=!0,Vc(T.codepage=t.codepage||1252)),T.biff<5||L.BIFFVer==0&&L.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var W={pos:e.l-J,name:u};s[W.pos]=W,T.snames.push(u)}else u=(s[z]||{name:""}).name;L.dt==32&&(a["!type"]="chart"),L.dt==64&&(a["!type"]="macro"),G=[],re=[],T.arrayf=v=[],xe=[],_e=[],V=!1,M={Hidden:(s[z]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[L.r]||[])[L.c]:a[An({c:L.c,r:L.r})])&&++L.c,w={ixfe:L.ixfe,XF:C[L.ixfe]||{},v:L.val,t:"n"},E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N({c:L.c,r:L.r},w,t);break;case 5:case 517:w={ixfe:L.ixfe,XF:C[L.ixfe],v:L.val,t:L.t},E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N({c:L.c,r:L.r},w,t);break;case 638:w={ixfe:L.ixfe,XF:C[L.ixfe],v:L.rknum,t:"n"},E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N({c:L.c,r:L.r},w,t);break;case 189:for(var ae=L.c;ae<=L.C;++ae){var he=L.rkrec[ae-L.c][0];w={ixfe:he,XF:C[he],v:L.rkrec[ae-L.c][1],t:"n"},E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N({c:ae,r:L.r},w,t)}break;case 6:case 518:case 1030:{if(L.val=="String"){l=L;break}if(w=wb(L.val,L.cell.ixfe,L.tt),w.XF=C[w.ixfe],t.cellFormula){var ze=L.formula;if(ze&&ze[0]&&ze[0][0]&&ze[0][0][0]=="PtgExp"){var ke=ze[0][0][1][0],qe=ze[0][0][1][1],Ie=An({r:ke,c:qe});y[Ie]?w.f=""+vo(L.formula,o,L.cell,K,T):w.F=((t.dense?(a[ke]||[])[qe]:a[Ie])||{}).F}else w.f=""+vo(L.formula,o,L.cell,K,T)}E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N(L.cell,w,t),l=L}break;case 7:case 519:if(l)l.val=L,w=wb(L,l.cell.ixfe,"s"),w.XF=C[w.ixfe],t.cellFormula&&(w.f=""+vo(l.formula,o,l.cell,K,T)),E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(L);var Ve=An(L[0].s);if(h=t.dense?(a[L[0].s.r]||[])[L[0].s.c]:a[Ve],t.cellFormula&&h){if(!l||!Ve||!h)break;h.f=""+vo(L[1],o,L[0],K,T),h.F=$n(L[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!l)break;y[An(l.cell)]=L[0],h=t.dense?(a[l.cell.r]||[])[l.cell.c]:a[An(l.cell)],(h||{}).f=""+vo(L[0],o,f,K,T)}}break;case 253:w=wb(c[L.isst].t,L.ixfe,"s"),c[L.isst].h&&(w.h=c[L.isst].h),w.XF=C[w.ixfe],E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N({c:L.c,r:L.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:L.ixfe,XF:C[L.ixfe],t:"z"},E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N({c:L.c,r:L.r},w,t));break;case 190:if(t.sheetStubs)for(var Qe=L.c;Qe<=L.C;++Qe){var Tt=L.ixfe[Qe-L.c];w={ixfe:Tt,XF:C[Tt],t:"z"},E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N({c:Qe,r:L.r},w,t)}break;case 214:case 516:case 4:w=wb(L.val,L.ixfe,"s"),w.XF=C[w.ixfe],E>0&&(w.z=Z[w.ixfe>>8&63]),xu(w,t,r.opts.Date1904),N({c:L.c,r:L.r},w,t);break;case 0:case 512:ne===1&&(o=L);break;case 252:c=L;break;case 1054:if(T.biff==4){Z[E++]=L[1];for(var vt=0;vt<E+163&&kn[vt]!=L[1];++vt);vt>=163&&kd(L[1],E+163)}else kd(L[1],L[0]);break;case 30:{Z[E++]=L;for(var Xe=0;Xe<E+163&&kn[Xe]!=L;++Xe);Xe>=163&&kd(L,E+163)}break;case 229:G=G.concat(L);break;case 93:re[L.cmo[0]]=T.lastobj=L;break;case 438:T.lastobj.TxO=L;break;case 127:T.lastobj.ImData=L;break;case 440:for(b=L[0].s.r;b<=L[0].e.r;++b)for(g=L[0].s.c;g<=L[0].e.c;++g)h=t.dense?(a[b]||[])[g]:a[An({c:g,r:b})],h&&(h.l=L[1]);break;case 2048:for(b=L[0].s.r;b<=L[0].e.r;++b)for(g=L[0].s.c;g<=L[0].e.c;++g)h=t.dense?(a[b]||[])[g]:a[An({c:g,r:b})],h&&h.l&&(h.l.Tooltip=L[1]);break;case 28:{if(T.biff<=5&&T.biff>=2)break;h=t.dense?(a[L[0].r]||[])[L[0].c]:a[An(L[0])];var Be=re[L[2]];h||(t.dense?(a[L[0].r]||(a[L[0].r]=[]),h=a[L[0].r][L[0].c]={t:"z"}):h=a[An(L[0])]={t:"z"},o.e.r=Math.max(o.e.r,L[0].r),o.s.r=Math.min(o.s.r,L[0].r),o.e.c=Math.max(o.e.c,L[0].c),o.s.c=Math.min(o.s.c,L[0].c)),h.c||(h.c=[]),m={a:L[1],t:Be.TxO.t},h.c.push(m)}break;case 2173:ale(C[L.ixfe],L.ext);break;case 125:{if(!T.cellStyles)break;for(;L.e>=L.s;)xe[L.e--]={width:L.w/256,level:L.level||0,hidden:!!(L.flags&1)},V||(V=!0,BN(L.w/256)),th(xe[L.e+1])}break;case 520:{var ct={};L.level!=null&&(_e[L.r]=ct,ct.level=L.level),L.hidden&&(_e[L.r]=ct,ct.hidden=!0),L.hpt&&(_e[L.r]=ct,ct.hpt=L.hpt,ct.hpx=Em(L.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||t0(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[X]]=L;break;case 161:a["!margins"]||t0(a["!margins"]={}),a["!margins"].header=L.header,a["!margins"].footer=L.footer;break;case 574:L.RTL&&(A.Views[0].RTL=!0);break;case 146:j=L;break;case 2198:B=L;break;case 140:_=L;break;case 442:u?M.CodeName=L||M.name:A.WBProps.CodeName=L||"ThisWorkbook";break}}else q||console.error("Missing Info for XLS Record 0x"+X.toString(16)),e.l+=J}return r.SheetNames=Bi(s).sort(function(nt,Se){return Number(nt)-Number(Se)}).map(function(nt){return s[nt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&H.forEach(function(nt,Se){r.Sheets[r.SheetNames[Se]]["!autofilter"]=nt}),r.Strings=c,r.SSF=ai(kn),T.enc&&(r.Encryption=T.enc),B&&(r.Themes=B),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),K.names.length>0&&(A.Names=K.names),r.Workbook=A,r}var kx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function yhe(e,t,r){var n=wn.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=bP(n,jA,kx.DSI);for(var s in a)t[s]=a[s]}catch(u){if(r.WTF)throw u}var o=wn.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=bP(o,AA,kx.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(f$(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function bhe(e,t){var r=[],n=[],a=[],s=0,o,l=X8(jA,"n"),c=X8(AA,"n");if(e.Props)for(o=Bi(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Bi(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:a).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<a.length;++s)b$.indexOf(a[s][0])>-1||d$.indexOf(a[s][0])>-1||a[s][1]!=null&&u.push(a[s]);n.length&&wn.utils.cfb_add(t,"/SummaryInformation",vP(n,kx.SI,c,AA)),(r.length||u.length)&&wn.utils.cfb_add(t,"/DocumentSummaryInformation",vP(r,kx.DSI,l,jA,u.length?u:null,kx.UDI))}function pU(e,t){t||(t={}),VN(t),hN(),t.codepage&&fN(t.codepage);var r,n;if(e.FullPaths){if(wn.find(e,"/encryption"))throw new Error("File is password-protected");r=wn.find(e,"!CompObj"),n=wn.find(e,"/Workbook")||wn.find(e,"/Book")}else{switch(t.type){case"base64":e=Ol(zl(e));break;case"binary":e=Ol(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}to(e,0),n={content:e}}var a,s;if(r&&phe(r),t.bookProps&&!t.bookSheets)a={};else{var o=Xn?"buffer":"array";if(n&&n.content)a=xhe(n.content,t);else if((s=wn.find(e,"PerfectOffice_MAIN"))&&s.content)a=e0.to_workbook(s.content,(t.type=o,t));else if((s=wn.find(e,"NativeContent_MAIN"))&&s.content)a=e0.to_workbook(s.content,(t.type=o,t));else throw(s=wn.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&wn.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Ole(e))}var l={};return e.FullPaths&&yhe(e,l,t),a.Props=a.Custprops=l,t.bookFiles&&(a.cfb=e),a}function vhe(e,t){var r=t||{},n=wn.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return wn.utils.cfb_add(n,a,mU(e,r)),r.biff==8&&(e.Props||e.Custprops)&&bhe(e,n),r.biff==8&&e.vbaraw&&Lle(n,wn.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var u1={0:{f:que},1:{f:Jue},2:{f:xde},3:{f:sde},4:{f:rde},5:{f:pde},6:{f:Sde},7:{f:ude},8:{f:Ede},9:{f:Cde},10:{f:Ade},11:{f:Nde},12:{f:ede},13:{f:bde},14:{f:lde},15:{f:ade},16:{f:sU},17:{f:kde},18:{f:fde},19:{f:NN},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:kfe},40:{},42:{},43:{f:Soe},44:{f:voe},45:{f:joe},46:{f:Noe},47:{f:Aoe},48:{},49:{f:Gne},50:{},51:{f:ole},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:T$},62:{f:wde},63:{f:gle},64:{f:Hde},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Eo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ude},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Yue},148:{f:Gue,p:16},151:{f:Fde},152:{},153:{f:wfe},154:{},155:{},156:{f:bfe},157:{},158:{},159:{T:1,f:Bse},160:{T:-1},161:{T:1,f:q0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Tde},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:ile},336:{T:-1},337:{f:ule,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:kA},357:{},358:{},359:{},360:{T:1},361:{},362:{f:E$},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Rde},427:{f:Bde},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Dde},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Xue},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Lde},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:kA},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Nle},633:{T:1},634:{T:-1},635:{T:1,f:jle},636:{T:-1},637:{f:Qne},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lfe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Vde},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},OA={6:{f:V5},10:{f:pf},12:{f:ss},13:{f:ss},14:{f:Hi},15:{f:Hi},16:{f:jo},17:{f:Hi},18:{f:Hi},19:{f:ss},20:{f:AP},21:{f:AP},23:{f:E$},24:{f:CP},25:{f:Hi},26:{},27:{},28:{f:Vie},29:{},34:{f:Hi},35:{f:NP},38:{f:jo},39:{f:jo},40:{f:jo},41:{f:jo},42:{f:Hi},43:{f:Hi},47:{f:aoe},49:{f:bie},51:{f:ss},60:{},61:{f:pie},64:{f:Hi},65:{f:yie},66:{f:ss},77:{},80:{},81:{},82:{},85:{f:ss},89:{},90:{},91:{},92:{f:nie},93:{f:Xie},94:{},95:{f:Hi},96:{},97:{},99:{f:Hi},125:{f:T$},128:{f:Mie},129:{f:iie},130:{f:ss},131:{f:Hi},132:{f:Hi},133:{f:sie},134:{},140:{f:nse},141:{f:ss},144:{},146:{f:sse},151:{},152:{},153:{},154:{},155:{},156:{f:ss},157:{},158:{},160:{f:hse},161:{f:cse},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Tie},190:{f:Pie},193:{f:pf},197:{},198:{},199:{},200:{},201:{},202:{f:Hi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ss},220:{},221:{f:Hi},222:{},224:{f:Lie},225:{f:rie},226:{f:pf},227:{},229:{f:Gie},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:lie},253:{f:wie},255:{f:uie},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:v$},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Hi},353:{f:pf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Die},431:{f:Hi},432:{},433:{},434:{},437:{},438:{f:Jie},439:{f:Hi},440:{f:Zie},441:{},442:{f:Y1},443:{},444:{f:ss},445:{},446:{},448:{f:pf},449:{f:hie,r:2},450:{f:pf},512:{f:_P},513:{f:fse},515:{f:Bie},516:{f:_ie},517:{f:jP},519:{f:pse},520:{f:die},523:{},545:{f:EP},549:{f:SP},566:{},574:{f:gie},638:{f:Eie},659:{},1048:{},1054:{f:jie},1084:{},1212:{f:Wie},2048:{f:tse},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yb},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:pf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ose,r:12},2173:{f:nle,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Hi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:zie,r:12},2197:{},2198:{f:Qoe,r:12},2199:{},2200:{},2201:{},2202:{f:qie,r:12},2203:{f:pf},2204:{},2205:{},2206:{},2207:{},2211:{f:fie},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ss},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:use},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:ise},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_P},1:{},2:{f:bse},3:{f:xse},4:{f:gse},5:{f:jP},7:{f:wse},8:{},9:{f:yb},11:{},22:{f:ss},30:{f:Nie},31:{},32:{},33:{f:EP},36:{},37:{f:SP},50:{f:Sse},62:{},52:{},67:{},68:{f:ss},69:{},86:{},126:{},127:{f:mse},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:_se},223:{},234:{},354:{},421:{},518:{f:V5},521:{f:yb},536:{f:CP},547:{f:NP},561:{},579:{},1030:{f:V5},1033:{f:yb},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Xr(e,t,r,n){var a=t;if(!isNaN(a)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,a),o.write_shift(2,s),s>0&&kN(r)&&e.push(r)}}function whe(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return Xr(e,t,r,a);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function ey(e,t,r){return e||(e=yr(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function She(e,t,r,n){var a=yr(9);return ey(a,e,t),w$(r,n||"b",a),a}function _he(e,t,r){var n=yr(8+2*r.length);return ey(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function khe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?_s(ni(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?Xr(e,2,vse(r,n,a)):Xr(e,3,yse(r,n,a));return;case"b":case"e":Xr(e,5,She(r,n,t.v,t.t));return;case"s":case"str":Xr(e,4,_he(r,n,(t.v||"").slice(0,255)));return}Xr(e,1,ey(null,r,n))}function jhe(e,t,r,n){var a=Array.isArray(t),s=ua(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=$n(s)}for(var u=s.s.r;u<=s.e.r;++u){l=Ji(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=xi(d)),o=c[d]+l;var f=a?(t[u]||[])[d]:t[o];f&&khe(e,f,u,d)}}}function Ahe(e,t){for(var r=t||{},n=ml(),a=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(a=s);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Xr(n,r.biff==4?1033:r.biff==3?521:9,MN(e,16,r)),jhe(n,e.Sheets[e.SheetNames[a]],a,r),Xr(n,10),n.end()}function Nhe(e,t,r){Xr(e,49,vie({sz:12,name:"Arial"},r))}function Che(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&Xr(e,1054,Aie(a,t[a],r))})}function Ehe(e,t){var r=yr(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Xr(e,2151,r),r=yr(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),A$(ua(t["!ref"]||"A1"),r),r.write_shift(4,4),Xr(e,2152,r)}function The(e,t){for(var r=0;r<16;++r)Xr(e,224,kP({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Xr(e,224,kP(n,0,t))})}function Phe(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Xr(e,440,ese(n)),n[1].Tooltip&&Xr(e,2048,rse(n))}delete t["!links"]}function Ohe(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&Xr(e,125,lse(SS(a,n),a))})}}function Lhe(e,t,r,n,a){var s=16+mh(a.cellXfs,t,a);if(t.v==null&&!t.bf){Xr(e,513,y0(r,n,s));return}if(t.bf)Xr(e,6,iue(t,r,n,a,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?_s(ni(t.v)):t.v;Xr(e,515,Iie(r,n,o,s));break;case"b":case"e":Xr(e,517,Rie(r,n,t.v,s,a,t.t));break;case"s":case"str":if(a.bookSST){var l=zN(a.Strings,t.v,a.revStrings);Xr(e,253,Sie(r,n,l,s))}else Xr(e,516,kie(r,n,(t.v||"").slice(0,255),s,a));break;default:Xr(e,513,y0(r,n,s))}}function Mhe(e,t,r){var n=ml(),a=r.SheetNames[e],s=r.Sheets[a]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,f="",p=[],h=ua(s["!ref"]||"A1"),m=u?65536:16384;if(h.e.c>255||h.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}Xr(n,2057,MN(r,16,t)),Xr(n,13,dc(1)),Xr(n,12,dc(100)),Xr(n,15,Do(!0)),Xr(n,17,Do(!1)),Xr(n,16,g0(.001)),Xr(n,95,Do(!0)),Xr(n,42,Do(!1)),Xr(n,43,Do(!1)),Xr(n,130,dc(1)),Xr(n,128,Fie()),Xr(n,131,Do(!1)),Xr(n,132,Do(!1)),u&&Ohe(n,s["!cols"]),Xr(n,512,Cie(h,t)),u&&(s["!links"]=[]);for(var g=h.s.r;g<=h.e.r;++g){f=Ji(g);for(var b=h.s.c;b<=h.e.c;++b){g===h.s.r&&(p[b]=xi(b)),d=p[b]+f;var y=c?(s[g]||[])[b]:s[d];y&&(Lhe(n,y,g,b,t),u&&y.l&&s["!links"].push([d,y.l]))}}var v=l.CodeName||l.name||a;return u&&Xr(n,574,xie((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&Xr(n,229,Kie(s["!merges"])),u&&Phe(n,s),Xr(n,442,S$(v)),u&&Ehe(n,s),Xr(n,10),n.end()}function Fhe(e,t,r){var n=ml(),a=(e||{}).Workbook||{},s=a.Sheets||[],o=a.WBProps||{},l=r.biff==8,c=r.biff==5;if(Xr(n,2057,MN(e,5,r)),r.bookType=="xla"&&Xr(n,135),Xr(n,225,l?dc(1200):null),Xr(n,193,Rae(2)),c&&Xr(n,191),c&&Xr(n,192),Xr(n,226),Xr(n,92,aie("SheetJS",r)),Xr(n,66,dc(l?1200:1252)),l&&Xr(n,353,dc(0)),l&&Xr(n,448),Xr(n,317,dse(e.SheetNames.length)),l&&e.vbaraw&&Xr(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";Xr(n,442,S$(u))}Xr(n,156,dc(17)),Xr(n,25,Do(!1)),Xr(n,18,Do(!1)),Xr(n,19,dc(0)),l&&Xr(n,431,Do(!1)),l&&Xr(n,444,dc(0)),Xr(n,61,mie()),Xr(n,64,Do(!1)),Xr(n,141,dc(0)),Xr(n,34,Do(hfe(e)=="true")),Xr(n,14,Do(!0)),l&&Xr(n,439,Do(!1)),Xr(n,218,dc(0)),Nhe(n,e,r),Che(n,e.SSF,r),The(n,r),l&&Xr(n,352,Do(!1));var d=n.end(),f=ml();l&&Xr(f,140,ase()),l&&r.Strings&&whe(f,252,cie(r.Strings)),Xr(f,10);var p=f.end(),h=ml(),m=0,g=0;for(g=0;g<e.SheetNames.length;++g)m+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var b=d.length+m+p.length;for(g=0;g<e.SheetNames.length;++g){var y=s[g]||{};Xr(h,133,oie({pos:b,hs:y.Hidden||0,dt:0,name:e.SheetNames[g]},r)),b+=t[g].length}var v=h.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var w=[];return d.length&&w.push(d),v.length&&w.push(v),p.length&&w.push(p),Bs(w)}function Rhe(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ai(kn)),e&&e.SSF&&(Ym(),mS(e.SSF),r.revssf=xS(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,GN(r),r.cellXfs=[],mh(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=Mhe(a,r,e);return n.unshift(Fhe(e,n,r)),Bs(n)}function mU(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=gl(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return Rhe(e,t);case 4:case 3:case 2:return Ahe(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function DP(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=a.index,l=s&&s.index||e.length,c=vne(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var g=c[o].trim(),b=g.slice(0,3).toLowerCase();if(b=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(b!="<td"&&b!="<th")){var y=g.split(/<\/t[dh]>/i);for(l=0;l<y.length;++l){var v=y[l].trim();if(v.match(/<t[dh]/i)){for(var w=v,_=0;w.charAt(0)=="<"&&(_=w.indexOf(">"))>-1;)w=w.slice(_+1);for(var C=0;C<m.length;++C){var j=m[C];j.s.c==d&&j.s.r<u&&u<=j.e.r&&(d=j.e.c+1,C=-1)}var A=Cn(v.slice(0,v.indexOf(">")));p=A.colspan?+A.colspan:1,((f=+A.rowspan)>1||p>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+p-1}});var M=A.t||A["data-t"]||"";if(!w.length){d+=p;continue}if(w=D9(w),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!w.length){d+=p;continue}var P={t:"s",v:w};r.raw||!w.trim().length||M=="s"||(w==="TRUE"?P={t:"b",v:!0}:w==="FALSE"?P={t:"b",v:!1}:isNaN(Qc(w))?isNaN(Nm(w).getDate())||(P={t:"d",v:ni(w)},r.cellDates||(P={t:"n",v:_s(P.v)}),P.z=r.dateNF||kn[14]):P={t:"n",v:Qc(w)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=P):n[An({r:u,c:d})]=P,d+=p}}}}return n["!ref"]=$n(h),m.length&&(n["!merges"]=m),n}function Bhe(e,t,r,n){for(var a=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>o)&&!(a[u].e.r<r||a[u].e.c<o)){if(a[u].s.r<r||a[u].s.c<o){l=-1;break}l=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(l<0)){var d=An({r,c:o}),f=n.dense?(e[r]||[])[o]:e[d],p=f&&f.v!=null&&(f.h||wN(f.w||(Md(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+d,s.push(Gr("td",p,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var Ihe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Dhe="</body></html>";function $he(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ph(DP(r[0],t),t);var n=YN();return r.forEach(function(a,s){QN(n,DP(a,t),"Sheet"+(s+1))}),n}function Uhe(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function gU(e,t){var r=t||{},n=r.header!=null?r.header:Ihe,a=r.footer!=null?r.footer:Dhe,s=[n],o=gl(e["!ref"]);r.dense=Array.isArray(e),s.push(Uhe(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(Bhe(e,o,l,r));return s.push("</table>"+a),s.join("")}function xU(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var o=typeof n.origin=="string"?yi(n.origin):n.origin;a=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=gl(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),a==-1&&(u.e.r=a=d.e.r+1)}var f=[],p=0,h=e["!rows"]||(e["!rows"]=[]),m=0,g=0,b=0,y=0,v=0,w=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&g<c;++m){var _=l[m];if($P(_)){if(n.display)continue;h[g]={hidden:!0}}var C=_.children;for(b=y=0;b<C.length;++b){var j=C[b];if(!(n.display&&$P(j))){var A=j.hasAttribute("data-v")?j.getAttribute("data-v"):j.hasAttribute("v")?j.getAttribute("v"):D9(j.innerHTML),M=j.getAttribute("data-z")||j.getAttribute("z");for(p=0;p<f.length;++p){var P=f[p];P.s.c==y+s&&P.s.r<g+a&&g+a<=P.e.r&&(y=P.e.c+1-s,p=-1)}w=+j.getAttribute("colspan")||1,((v=+j.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:g+a,c:y+s},e:{r:g+a+(v||1)-1,c:y+s+(w||1)-1}});var R={t:"s",v:A},N=j.getAttribute("data-t")||j.getAttribute("t")||"";A!=null&&(A.length==0?R.t=N||"z":n.raw||A.trim().length==0||N=="s"||(A==="TRUE"?R={t:"b",v:!0}:A==="FALSE"?R={t:"b",v:!1}:isNaN(Qc(A))?isNaN(Nm(A).getDate())||(R={t:"d",v:ni(A)},n.cellDates||(R={t:"n",v:_s(R.v)}),R.z=n.dateNF||kn[14]):R={t:"n",v:Qc(A)})),R.z===void 0&&M!=null&&(R.z=M);var T="",B=j.getElementsByTagName("A");if(B&&B.length)for(var G=0;G<B.length&&!(B[G].hasAttribute("href")&&(T=B[G].getAttribute("href"),T.charAt(0)!="#"));++G);T&&T.charAt(0)!="#"&&(R.l={Target:T}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][y+s]=R):e[An({c:y+s,r:g+a})]=R,u.e.c<y+s&&(u.e.c=y+s),y+=w}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=$n(u),g>=c&&(e["!fullref"]=$n((u.e.r=l.length-m+g-1+a,u))),e}function yU(e,t){var r=t||{},n=r.dense?[]:{};return xU(n,e,t)}function zhe(e,t){return ph(yU(e,t),t)}function $P(e){var t="",r=Whe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Whe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function qhe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ca(t.replace(/<[^>]*>/g,""));return[r]}var UP={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function bU(e,t){var r=t||{},n=SN(e),a=[],s,o,l={name:""},c="",u=0,d,f,p={},h=[],m=r.dense?[]:{},g,b,y={value:""},v="",w=0,_=[],C=-1,j=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,P={},R=[],N={},T=0,B=0,G=[],re=1,xe=1,_e=[],V={Names:[]},K={},de=["",""],ne=[],E={},Z="",H=0,F=!1,ee=!1,z=0;for(a1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=a1.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?m["!ref"]=$n(A):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(m["!fullref"]=m["!ref"],A.e.r=r.sheetRows-1,m["!ref"]=$n(A)),R.length&&(m["!merges"]=R),G.length&&(m["!rows"]=G),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),p[d.name]=m,ee=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=Cn(g[0],!1),C=j=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,m=r.dense?[]:{},R=[],G=[],ee=!0);break;case"table-row-group":g[1]==="/"?--M:++M;break;case"table-row":case"":if(g[1]==="/"){C+=re,re=1;break}if(f=Cn(g[0],!1),f.?C=f.-1:C==-1&&(C=0),re=+f["number-rows-repeated"]||1,re<10)for(z=0;z<re;++z)M>0&&(G[C+z]={level:M});j=-1;break;case"covered-table-cell":g[1]!=="/"&&++j,r.sheetStubs&&(r.dense?(m[C]||(m[C]=[]),m[C][j]={t:"z"}):m[An({r:C,c:j})]={t:"z"}),v="",_=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++j,y=Cn(g[0],!1),xe=parseInt(y["number-columns-repeated"]||"1",10),b={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(b.f=RP(ca(y.formula))),(y.||y["value-type"])=="string"&&(b.t="s",b.v=ca(y["string-value"]||""),r.dense?(m[C]||(m[C]=[]),m[C][j]=b):m[An({r:C,c:j})]=b),j+=xe-1;else if(g[1]!=="/"){++j,v="",w=0,_=[],xe=1;var X=re?C+re-1:C;if(j>A.e.c&&(A.e.c=j),j<A.s.c&&(A.s.c=j),C<A.s.r&&(A.s.r=C),X>A.e.r&&(A.e.r=X),y=Cn(g[0],!1),ne=[],E={},b={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=ca(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(T=parseInt(y["number-matrix-rows-spanned"],10)||0,B=parseInt(y["number-matrix-columns-spanned"],10)||0,N={s:{r:C,c:j},e:{r:C+T-1,c:j+B-1}},b.F=$n(N),_e.push([N,b.F])),y.formula)b.f=RP(y.formula);else for(z=0;z<_e.length;++z)C>=_e[z][0].s.r&&C<=_e[z][0].e.r&&j>=_e[z][0].s.c&&j<=_e[z][0].e.c&&(b.F=_e[z][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(T=parseInt(y["number-rows-spanned"],10)||0,B=parseInt(y["number-columns-spanned"],10)||0,N={s:{r:C,c:j},e:{r:C+T-1,c:j+B-1}},R.push(N)),y["number-columns-repeated"]&&(xe=parseInt(y["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=ei(y["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(y.value);break;case"percentage":b.t="n",b.v=parseFloat(y.value);break;case"currency":b.t="n",b.v=parseFloat(y.value);break;case"date":b.t="d",b.v=ni(y["date-value"]),r.cellDates||(b.t="n",b.v=_s(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=xne(y["time-value"])/86400,r.cellDates&&(b.t="d",b.v=yS(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(y.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",y["string-value"]!=null&&(v=ca(y["string-value"]),_=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(F=!1,b.t==="s"&&(b.v=v||"",_.length&&(b.R=_),F=w==0),K.Target&&(b.l=K),ne.length>0&&(b.c=ne,ne=[]),v&&r.cellText!==!1&&(b.w=v),F&&(b.t="z",delete b.v),(!F||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=C))for(var J=0;J<re;++J){if(xe=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(m[C+J]||(m[C+J]=[]),m[C+J][j]=J==0?b:ai(b);--xe>0;)m[C+J][j+xe]=ai(b);else for(m[An({r:C+J,c:j})]=b;--xe>0;)m[An({r:C+J,c:j+xe})]=ai(b);A.e.c<=j&&(A.e.c=j)}xe=parseInt(y["number-columns-repeated"]||"1",10),j+=xe-1,xe=0,b={},v="",_=[]}K={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s;E.t=v,_.length&&(E.R=_),E.a=Z,ne.push(E)}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);Z="",H=0,v="",w=0,_=[];break;case"creator":g[1]==="/"?Z=n.slice(H,g.index):H=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&a.push([g[3],!1]);v="",w=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(P[l.name]=c,(s=a.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(c="",l=Cn(g[0],!1),a.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Cn(g[0],!1),c+=UP[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":o=Cn(g[0],!1),c+=UP[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":o=Cn(g[0],!1),de=G5(o["cell-range-address"]);var q={Name:o.name,Ref:de[0]+"!"+de[1]};ee&&(q.Sheet=h.length),V.Names.push(q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(g[1]==="/"&&(!y||!y["string-value"])){var Y=qhe(n.slice(w,g.index));v=(v.length>0?v+`
`:"")+Y[0]}else Cn(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{de=G5(Cn(g[0])["target-range-address"]),p[de[0]]["!autofilter"]={ref:de[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(K=Cn(g[0],!1),!K.href)break;K.Target=ca(K.href),delete K.href,K.Target.charAt(0)=="#"&&K.Target.indexOf(".")>-1?(de=G5(K.Target.slice(1)),K.Target="#"+de[0]+"!"+de[1]):K.Target.match(/^\.\.[\\\/]/)&&(K.Target=K.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var L={Sheets:p,SheetNames:h,Workbook:V};return r.bookSheets&&delete L.Sheets,L}function zP(e,t){t=t||{},uc(e,"META-INF/manifest.xml")&&xae(is(e,"META-INF/manifest.xml"),t);var r=Ll(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=bU($a(r),t);return uc(e,"meta.xml")&&(n.Props=c$(is(e,"meta.xml"))),n}function WP(e,t){return bU(e,t)}var Hhe=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+n1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Zi+t}}(),qP=function(){var e=function(s){return La(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+La(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=gl(s["!ref"]||"A1"),p=s["!merges"]||[],h=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",b=s["!rows"]||[];for(u=0;u<f.s.r;++u)g=b[u]?' table:style-name="ro'+b[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=f.e.r;++u){for(g=b[u]?' table:style-name="ro'+b[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var y=!1,v={},w="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>d)&&!(p[h].s.r>u)&&!(p[h].e.c<d)&&!(p[h].e.r<u)){(p[h].s.c!=d||p[h].s.r!=u)&&(y=!0),v["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,v["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(y){c.push(r);continue}var _=An({r:u,c:d}),C=m?(s[u]||[])[d]:s[_];if(C&&C.f&&(v["table:formula"]=La(due(C.f)),C.F&&C.F.slice(0,_.length)==_)){var j=gl(C.F);v["table:number-matrix-columns-spanned"]=j.e.c-j.s.c+1,v["table:number-matrix-rows-spanned"]=j.e.r-j.s.r+1}if(!C){c.push(t);continue}switch(C.t){case"b":w=C.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=C.v?"true":"false";break;case"n":w=C.w||String(C.v||0),v["office:value-type"]="float",v["office:value"]=C.v||0;break;case"s":case"str":w=C.v==null?"":C.v,v["office:value-type"]="string";break;case"d":w=C.w||ni(C.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=ni(C.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var A=e(w);if(C.l&&C.l.Target){var M=C.l.Target;M=M.charAt(0)=="#"?"#"+fue(M.slice(1)):M,M.charAt(0)!="#"&&!M.match(/^\w+:/)&&(M="../"+M),A=Gr("text:a",A,{"xlink:href":M.replace(/&/g,"&amp;")})}c.push("          "+Gr("table:table-cell",Gr("text:p",A,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;th(f),f.ods=l;var p=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Zi],u=n1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=n1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(l$().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function vU(e,t){if(t.bookType=="fods")return qP(e,t);var r=yN(),n="",a=[],s=[];return n="mimetype",Hn(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Hn(r,n,qP(e,t)),a.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Hn(r,n,Hhe(e,t)),a.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Hn(r,n,Zi+l$()),a.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Hn(r,n,vae(s)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Hn(r,n,yae(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function b0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function LA(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):$a(hh(e))}function Vhe(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ol(Mu(e))}function Ghe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function nh(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function HP(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Khe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Xhe(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;a>=1;++s,a/=256)e[t+s]=a&255;e[t+15]|=r>=0?0:128}function d1(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Ea(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ri(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function da(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=d1(e,r),s=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=d1(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var u={data:l,type:s};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Ys(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(Ea(n*8+a.type)),a.type==2&&t.push(Ea(a.data.length)),t.push(a.data))})}),nh(t)}function HN(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function ic(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=d1(e,n),s=da(e.slice(n[0],n[0]+a));n[0]+=a;var o={id:Ri(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=da(l.data),u=Ri(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=Ri(s[3][0].data)>>>0>0),r.push(o)}return r}function sp(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Ea(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Ea(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Ea(o.data.length)}],n[2].push({data:Ys(o.meta),type:2})});var s=Ys(n);t.push(Ea(s.length)),t.push(s),a.forEach(function(o){return t.push(o)})}),nh(t)}function Yhe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=d1(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}a.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[nh(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var d=nh(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function sc(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Yhe(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return nh(t)}function op(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var s=Ea(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,r+=n}return nh(t)}function Qhe(e,t,r,n){var a=b0(e),s=a.getUint32(4,!0),o=(n>1?12:8)+HP(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=a.getUint32(o,!0),o+=4),o+=HP(s&(n>1?12288:4096))*4,s&16&&(c=a.getUint32(o,!0),o+=4),s&32&&(u=a.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+a.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Jhe(e,t,r){var n=b0(e),a=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);a&1&&(c=Khe(e,s),s+=16),a&2&&(u=n.getFloat64(s,!0),s+=8),a&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(l=n.getUint32(s,!0),s+=4),a&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return f}function X5(e,t){var r=new Uint8Array(32),n=b0(r),a=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Xhe(r,a,e.v),s|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),s|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,a)}function Y5(e,t){var r=new Uint8Array(32),n=b0(r),a=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),s|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),s|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),s|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,a)}function Zhe(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Qhe(e,t,r,e[0]);case 5:return Jhe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function bo(e){var t=da(e);return d1(t[1][0].data)}function VP(e,t){var r=da(t.data),n=Ri(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(o){var l=da(o.data),c=Ri(l[1][0].data)>>>0;switch(n){case 1:s[c]=LA(l[3][0].data);break;case 8:{var u=e[bo(l[9][0].data)][0],d=da(u.data),f=e[bo(d[1][0].data)][0],p=Ri(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var h=da(f.data);s[c]=h[3].map(function(m){return LA(m.data)}).join("")}break}}),s}function e0e(e,t){var r,n,a,s,o,l,c,u,d,f,p,h,m,g,b=da(e),y=Ri(b[1][0].data)>>>0,v=Ri(b[2][0].data)>>>0,w=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&Ri(b[8][0].data)>0||!1,_,C;if((s=(a=b[7])==null?void 0:a[0])!=null&&s.data&&t!=0)_=(l=(o=b[7])==null?void 0:o[0])==null?void 0:l.data,C=(u=(c=b[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=b[4])==null?void 0:d[0])!=null&&f.data&&t!=1)_=(h=(p=b[4])==null?void 0:p[0])==null?void 0:h.data,C=(g=(m=b[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var j=w?4:1,A=b0(_),M=[],P=0;P<_.length/2;++P){var R=A.getUint16(P*2,!0);R<65535&&M.push([P,R])}if(M.length!=v)throw"Expected ".concat(v," cells, found ").concat(M.length);var N=[];for(P=0;P<M.length-1;++P)N[M[P][0]]=C.subarray(M[P][1]*j,M[P+1][1]*j);return M.length>=1&&(N[M[M.length-1][0]]=C.subarray(M[M.length-1][1]*j)),{R:y,cells:N}}function t0e(e,t){var r,n=da(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Ri(n[7][0].data)>>>0>0?1:0:-1,s=HN(n[5],function(o){return e0e(o,a)});return{nrows:Ri(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function r0e(e,t,r){var n,a=da(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ri(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Ri(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=$n(s);var o=da(a[4][0].data),l=VP(e,e[bo(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?VP(e,e[bo(o[17][0].data)][0]):[],u=da(o[3][0].data),d=0;u[1].forEach(function(f){var p=da(f.data),h=e[bo(p[2][0].data)][0],m=Ri(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=t0e(e,h);g.data.forEach(function(b,y){b.forEach(function(v,w){var _=An({r:d+y,c:w}),C=Zhe(v,l,c);C&&(r[_]=C)})}),d+=g.nrows})}function n0e(e,t){var r=da(t.data),n={"!ref":"A1"},a=e[bo(r[2][0].data)],s=Ri(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return r0e(e,a[0],n),n}function a0e(e,t){var r,n=da(t.data),a={name:(r=n[1])!=null&&r[0]?LA(n[1][0].data):"",sheets:[]},s=HN(n[2],bo);return s.forEach(function(o){e[o].forEach(function(l){var c=Ri(l.meta[1][0].data);c==6e3&&a.sheets.push(n0e(e,l))})}),a}function i0e(e,t){var r=YN(),n=da(t.data),a=HN(n[1],bo);if(a.forEach(function(s){e[s].forEach(function(o){var l=Ri(o.meta[1][0].data);if(l==2){var c=a0e(e,o);c.sheets.forEach(function(u,d){QN(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Q5(e){var t,r,n,a,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=sc(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=ic(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Ri(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=Ri(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return i0e(s,l)}function s0e(e,t,r){var n,a,s,o;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Ri(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=b0(e[7][0].data),d=0,f=[],p=b0(e[4][0].data),h=0,m=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),p.setUint16(g*2,h,!0);var b,y;switch(typeof t[g]){case"string":b=X5({t:"s",v:t[g]},r),y=Y5({t:"s",v:t[g]},r);break;case"number":b=X5({t:"n",v:t[g]},r),y=Y5({t:"n",v:t[g]},r);break;case"boolean":b=X5({t:"b",v:t[g]},r),y=Y5({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(b),d+=b.length,m.push(y),h+=y.length,++c}for(e[2][0].data=Ea(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=nh(f),e[3][0].data=nh(m),c}function o0e(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=gl(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat($n(n)));var s=F2(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(Z){return Z.forEach(function(H){typeof H=="string"&&o.push(H)})});var l={},c=[],u=wn.read(t.numbers,{type:"base64"});u.FileIndex.map(function(Z,H){return[Z,u.FullPaths[H]]}).forEach(function(Z){var H=Z[0],F=Z[1];if(H.type==2&&H.name.match(/\.iwa/)){var ee=H.content,z=sc(ee),X=ic(z);X.forEach(function(J){c.push(J.id),l[J.id]={deps:[],location:F,type:Ri(J.messages[0].meta[1][0].data)}})}}),c.sort(function(Z,H){return Z-H});var d=c.filter(function(Z){return Z>1}).map(function(Z){return[Z,Ea(Z)]});u.FileIndex.map(function(Z,H){return[Z,u.FullPaths[H]]}).forEach(function(Z){var H=Z[0];if(Z[1],!!H.name.match(/\.iwa/)){var F=ic(sc(H.content));F.forEach(function(ee){ee.messages.forEach(function(z){d.forEach(function(X){ee.messages.some(function(J){return Ri(J.meta[1][0].data)!=11006&&Ghe(J.data,X[1])})&&l[X[0]].deps.push(ee.id)})})})}});for(var f=wn.find(u,l[1].location),p=ic(sc(f.content)),h,m=0;m<p.length;++m){var g=p[m];g.id==1&&(h=g)}var b=bo(da(h.messages[0].data)[1][0].data);for(f=wn.find(u,l[b].location),p=ic(sc(f.content)),m=0;m<p.length;++m)g=p[m],g.id==b&&(h=g);for(b=bo(da(h.messages[0].data)[2][0].data),f=wn.find(u,l[b].location),p=ic(sc(f.content)),m=0;m<p.length;++m)g=p[m],g.id==b&&(h=g);for(b=bo(da(h.messages[0].data)[2][0].data),f=wn.find(u,l[b].location),p=ic(sc(f.content)),m=0;m<p.length;++m)g=p[m],g.id==b&&(h=g);var y=da(h.messages[0].data);{y[6][0].data=Ea(n.e.r+1),y[7][0].data=Ea(n.e.c+1);var v=bo(y[46][0].data),w=wn.find(u,l[v].location),_=ic(sc(w.content));{for(var C=0;C<_.length&&_[C].id!=v;++C);if(_[C].id!=v)throw"Bad ColumnRowUIDMapArchive";var j=da(_[C].messages[0].data);j[1]=[],j[2]=[],j[3]=[];for(var A=0;A<=n.e.c;++A){var M=[];M[1]=M[2]=[{type:0,data:Ea(A+420690)}],j[1].push({type:2,data:Ys(M)}),j[2].push({type:0,data:Ea(A)}),j[3].push({type:0,data:Ea(A)})}j[4]=[],j[5]=[],j[6]=[];for(var P=0;P<=n.e.r;++P)M=[],M[1]=M[2]=[{type:0,data:Ea(P+726270)}],j[4].push({type:2,data:Ys(M)}),j[5].push({type:0,data:Ea(P)}),j[6].push({type:0,data:Ea(P)});_[C].messages[0].data=Ys(j)}w.content=op(sp(_)),w.size=w.content.length,delete y[46];var R=da(y[4][0].data);{R[7][0].data=Ea(n.e.r+1);var N=da(R[1][0].data),T=bo(N[2][0].data);w=wn.find(u,l[T].location),_=ic(sc(w.content));{if(_[0].id!=T)throw"Bad HeaderStorageBucket";var B=da(_[0].messages[0].data);for(P=0;P<s.length;++P){var G=da(B[2][0].data);G[1][0].data=Ea(P),G[4][0].data=Ea(s[P].length),B[2][P]={type:B[2][0].type,data:Ys(G)}}_[0].messages[0].data=Ys(B)}w.content=op(sp(_)),w.size=w.content.length;var re=bo(R[2][0].data);w=wn.find(u,l[re].location),_=ic(sc(w.content));{if(_[0].id!=re)throw"Bad HeaderStorageBucket";for(B=da(_[0].messages[0].data),A=0;A<=n.e.c;++A)G=da(B[2][0].data),G[1][0].data=Ea(A),G[4][0].data=Ea(n.e.r+1),B[2][A]={type:B[2][0].type,data:Ys(G)};_[0].messages[0].data=Ys(B)}w.content=op(sp(_)),w.size=w.content.length;var xe=bo(R[4][0].data);(function(){for(var Z=wn.find(u,l[xe].location),H=ic(sc(Z.content)),F,ee=0;ee<H.length;++ee){var z=H[ee];z.id==xe&&(F=z)}var X=da(F.messages[0].data);{X[3]=[];var J=[];o.forEach(function(L,U){J[1]=[{type:0,data:Ea(U)}],J[2]=[{type:0,data:Ea(1)}],J[3]=[{type:2,data:Vhe(L)}],X[3].push({type:2,data:Ys(J)})})}F.messages[0].data=Ys(X);var q=sp(H),Y=op(q);Z.content=Y,Z.size=Z.content.length})();var _e=da(R[3][0].data);{var V=_e[1][0];delete _e[2];var K=da(V.data);{var de=bo(K[2][0].data);(function(){for(var Z=wn.find(u,l[de].location),H=ic(sc(Z.content)),F,ee=0;ee<H.length;++ee){var z=H[ee];z.id==de&&(F=z)}var X=da(F.messages[0].data);{delete X[6],delete _e[7];var J=new Uint8Array(X[5][0].data);X[5]=[];for(var q=0,Y=0;Y<=n.e.r;++Y){var L=da(J);q+=s0e(L,s[Y],o),L[1][0].data=Ea(Y),X[5].push({data:Ys(L),type:2})}X[1]=[{type:0,data:Ea(n.e.c+1)}],X[2]=[{type:0,data:Ea(n.e.r+1)}],X[3]=[{type:0,data:Ea(q)}],X[4]=[{type:0,data:Ea(n.e.r+1)}]}F.messages[0].data=Ys(X);var U=sp(H),ce=op(U);Z.content=ce,Z.size=Z.content.length})()}V.data=Ys(K)}R[3][0].data=Ys(_e)}y[4][0].data=Ys(R)}h.messages[0].data=Ys(y);var ne=sp(p),E=op(ne);return f.content=E,f.size=f.content.length,u}function wU(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function VN(e){wU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function GN(e){wU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function l0e(e){return Qn.WS.indexOf(e)>-1?"sheet":e==Qn.CS?"chart":e==Qn.DS?"dialog":e==Qn.MS?"macro":e&&e.length?e:"sheet"}function c0e(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,l0e(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function u0e(e,t,r,n,a,s,o,l,c,u,d,f){try{s[n]=vx(Ll(e,r,!0),t);var p=is(e,t),h;switch(l){case"sheet":h=Ofe(p,t,a,c,s[n],u,d,f);break;case"chart":if(h=Lfe(p,t,a,c,s[n],u,d,f),!h||!h["!drawel"])break;var m=ax(h["!drawel"].Target,t),g=i1(m),b=ble(Ll(e,m,!0),vx(Ll(e,g,!0),m)),y=ax(b,m),v=i1(y);h=sfe(Ll(e,y,!0),y,c,vx(Ll(e,v,!0),y),u,h);break;case"macro":h=Mfe(p,t,a,c,s[n],u,d,f);break;case"dialog":h=Ffe(p,t,a,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var w=[];s&&s[n]&&Bi(s[n]).forEach(function(_){var C="";if(s[n][_].Type==Qn.CMNT){C=ax(s[n][_].Target,t);var j=Dfe(is(e,C,!0),C,c);if(!j||!j.length)return;PP(h,j,!1)}s[n][_].Type==Qn.TCMNT&&(C=ax(s[n][_].Target,t),w=w.concat(wle(is(e,C,!0),c)))}),w&&w.length&&PP(h,w,!0,c.people||[])}catch(_){if(c.WTF)throw _}}function Zl(e){return e.charAt(0)=="/"?e.slice(1):e}function d0e(e,t){if(Ym(),t=t||{},VN(t),uc(e,"META-INF/manifest.xml")||uc(e,"objectdata.xml"))return zP(e,t);if(uc(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Q5<"u"){if(e.FileIndex)return Q5(e);var r=wn.utils.cfb_new();return J8(e).forEach(function(G){Hn(r,G,Sne(e,G))}),Q5(r)}throw new Error("Unsupported NUMBERS file")}if(!uc(e,"[Content_Types].xml"))throw uc(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):uc(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=J8(e),a=mae(Ll(e,"[Content_Types].xml")),s=!1,o,l;if(a.workbooks.length===0&&(l="xl/workbook.xml",is(e,l,!0)&&a.workbooks.push(l)),a.workbooks.length===0){if(l="xl/workbook.bin",!is(e,l,!0))throw new Error("Could not find workbook");a.workbooks.push(l),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(wx=[],a.sst)try{wx=Ife(is(e,Zl(a.sst)),a.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&a.themes.length&&(c=Bfe(Ll(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(u=Rfe(is(e,Zl(a.style)),a.style,c,t))}a.links.map(function(G){try{var re=vx(Ll(e,i1(Zl(G))),G);return Ufe(is(e,Zl(G)),re,G,t)}catch{}});var d=Pfe(is(e,Zl(a.workbooks[0])),a.workbooks[0],t),f={},p="";a.coreprops.length&&(p=is(e,Zl(a.coreprops[0]),!0),p&&(f=c$(p)),a.extprops.length!==0&&(p=is(e,Zl(a.extprops[0]),!0),p&&Sae(p,f,t)));var h={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(p=Ll(e,Zl(a.custprops[0]),!0),p&&(h=kae(p,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(re){return re.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=h),t.bookSheets&&typeof o<"u"&&(m.SheetNames=o),t.bookSheets?m.SheetNames:t.bookProps))return m;o={};var g={};t.bookDeps&&a.calcchain&&(g=$fe(is(e,Zl(a.calcchain)),a.calcchain));var b=0,y={},v,w;{var _=d.Sheets;f.Worksheets=_.length,f.SheetNames=[];for(var C=0;C!=_.length;++C)f.SheetNames[C]=_[C].name}var j=s?"bin":"xml",A=a.workbooks[0].lastIndexOf("/"),M=(a.workbooks[0].slice(0,A+1)+"_rels/"+a.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");uc(e,M)||(M="xl/_rels/workbook."+j+".rels");var P=vx(Ll(e,M,!0),M.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=zfe(is(e,Zl(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=_le(is(e,Zl(a.people[0])),t)),P&&(P=c0e(P,d.Sheets));var R=is(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=f.Worksheets;++b){var N="sheet";if(P&&P[b]?(v="xl/"+P[b][1].replace(/[\/]?xl\//,""),uc(e,v)||(v=P[b][1]),uc(e,v)||(v=M.replace(/_rels\/.*$/,"")+P[b][1]),N=P[b][2]):(v="xl/worksheets/sheet"+(b+1-R)+"."+j,v=v.replace(/sheet0\./,"sheet.")),w=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(f.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var T=!1,B=0;B!=t.sheets.length;++B)typeof t.sheets[B]=="number"&&t.sheets[B]==b&&(T=1),typeof t.sheets[B]=="string"&&t.sheets[B].toLowerCase()==f.SheetNames[b].toLowerCase()&&(T=1);if(!T)continue e}}u0e(e,v,w,f.SheetNames[b],b,y,o,N,t,d,c,u)}return m={Directory:a,Workbook:d,Props:f,Custprops:h,Deps:g,Sheets:o,SheetNames:f.SheetNames,Strings:wx,Styles:u,Themes:c,SSF:ai(kn)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(G,re){G=G.replace(/^Root Entry[\/]/,""),m.keys.push(G),m.files[G]=e.FileIndex[re]}))),t&&t.bookVBA&&(a.vba.length>0?m.vbaraw=is(e,Zl(a.vba[0]),!0):a.defaults&&a.defaults.bin===Ple&&(m.vbaraw=is(e,"xl/vbaProject.bin",!0))),m}function f0e(e,t){var r=t||{},n="Workbook",a=wn.find(e,n);try{if(n="/!DataSpaces/Version",a=wn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(zse(a.content),n="/!DataSpaces/DataSpaceMap",a=wn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=qse(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=wn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Hse(a.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=wn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Gse(a.content)}catch{}if(n="/EncryptionInfo",a=wn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=Kse(a.content);if(n="/EncryptedPackage",a=wn.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],a.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function h0e(e,t){return t.bookType=="ods"?vU(e,t):t.bookType=="numbers"?o0e(e,t):t.bookType=="xlsb"?p0e(e,t):m0e(e,t)}function p0e(e,t){Vp=1024,e&&!e.SSF&&(e.SSF=ai(kn)),e&&e.SSF&&(Ym(),mS(e.SSF),t.revssf=xS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Sx?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=K$.indexOf(t.bookType)>-1,a=ON();GN(t=t||{});var s=yN(),o="",l=0;if(t.cellXfs=[],mh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Hn(s,o,u$(e.Props,t)),a.coreprops.push(o),Ta(t.rels,2,o,Qn.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Hn(s,o,h$(e.Props)),a.extprops.push(o),Ta(t.rels,3,o,Qn.EXT_PROPS),e.Custprops!==e.Props&&Bi(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Hn(s,o,p$(e.Custprops)),a.custprops.push(o),Ta(t.rels,4,o,Qn.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Hn(s,o,qfe(l-1,o,t,e,d)),a.sheets.push(o),Ta(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Qn.WS[0])}if(f){var h=f["!comments"],m=!1,g="";h&&h.length>0&&(g="xl/comments"+l+"."+r,Hn(s,g,Gfe(h,g)),a.comments.push(g),Ta(d,-1,"../comments"+l+"."+r,Qn.CMNT),m=!0),f["!legacy"]&&m&&Hn(s,"xl/drawings/vmlDrawing"+l+".vml",V$(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Hn(s,i1(o),lm(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Hn(s,o,Vfe(t.Strings,o,t)),a.strs.push(o),Ta(t.wbrels,-1,"sharedStrings."+r,Qn.SST)),o="xl/workbook."+r,Hn(s,o,Wfe(e,o)),a.workbooks.push(o),Ta(t.rels,1,o,Qn.WB),o="xl/theme/theme1.xml",Hn(s,o,IN(e.Themes,t)),a.themes.push(o),Ta(t.wbrels,-1,"theme/theme1.xml",Qn.THEME),o="xl/styles."+r,Hn(s,o,Hfe(e,o,t)),a.styles.push(o),Ta(t.wbrels,-1,"styles."+r,Qn.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Hn(s,o,e.vbaraw),a.vba.push(o),Ta(t.wbrels,-1,"vbaProject.bin",Qn.VBA)),o="xl/metadata."+r,Hn(s,o,Kfe(o)),a.metadata.push(o),Ta(t.wbrels,-1,"metadata."+r,Qn.XLMETA),Hn(s,"[Content_Types].xml",o$(a,t)),Hn(s,"_rels/.rels",lm(t.rels)),Hn(s,"xl/_rels/workbook."+r+".rels",lm(t.wbrels)),delete t.revssf,delete t.ssf,s}function m0e(e,t){Vp=1024,e&&!e.SSF&&(e.SSF=ai(kn)),e&&e.SSF&&(Ym(),mS(e.SSF),t.revssf=xS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Sx?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=K$.indexOf(t.bookType)>-1,a=ON();GN(t=t||{});var s=yN(),o="",l=0;if(t.cellXfs=[],mh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Hn(s,o,u$(e.Props,t)),a.coreprops.push(o),Ta(t.rels,2,o,Qn.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Hn(s,o,h$(e.Props)),a.extprops.push(o),Ta(t.rels,3,o,Qn.EXT_PROPS),e.Custprops!==e.Props&&Bi(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Hn(s,o,p$(e.Custprops)),a.custprops.push(o),Ta(t.rels,4,o,Qn.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],h=(p||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,Hn(s,o,iU(l-1,t,e,f)),a.sheets.push(o),Ta(t.wbrels,-1,"worksheets/sheet"+l+"."+r,Qn.WS[0])}if(p){var m=p["!comments"],g=!1,b="";if(m&&m.length>0){var y=!1;m.forEach(function(v){v[1].forEach(function(w){w.T==!0&&(y=!0)})}),y&&(b="xl/threadedComments/threadedComment"+l+"."+r,Hn(s,b,Sle(m,d,t)),a.threadedcomments.push(b),Ta(f,-1,"../threadedComments/threadedComment"+l+"."+r,Qn.TCMNT)),b="xl/comments"+l+"."+r,Hn(s,b,G$(m)),a.comments.push(b),Ta(f,-1,"../comments"+l+"."+r,Qn.CMNT),g=!0}p["!legacy"]&&g&&Hn(s,"xl/drawings/vmlDrawing"+l+".vml",V$(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&Hn(s,i1(o),lm(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Hn(s,o,M$(t.Strings,t)),a.strs.push(o),Ta(t.wbrels,-1,"sharedStrings."+r,Qn.SST)),o="xl/workbook."+r,Hn(s,o,uU(e)),a.workbooks.push(o),Ta(t.rels,1,o,Qn.WB),o="xl/theme/theme1.xml",Hn(s,o,IN(e.Themes,t)),a.themes.push(o),Ta(t.wbrels,-1,"theme/theme1.xml",Qn.THEME),o="xl/styles."+r,Hn(s,o,z$(e,t)),a.styles.push(o),Ta(t.wbrels,-1,"styles."+r,Qn.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",Hn(s,o,e.vbaraw),a.vba.push(o),Ta(t.wbrels,-1,"vbaProject.bin",Qn.VBA)),o="xl/metadata."+r,Hn(s,o,H$()),a.metadata.push(o),Ta(t.wbrels,-1,"metadata."+r,Qn.XLMETA),d.length>1&&(o="xl/persons/person.xml",Hn(s,o,kle(d)),a.people.push(o),Ta(t.wbrels,-1,"persons/person.xml",Qn.PEOPLE)),Hn(s,"[Content_Types].xml",o$(a,t)),Hn(s,"_rels/.rels",lm(t.rels)),Hn(s,"xl/_rels/workbook."+r+".rels",lm(t.wbrels)),delete t.revssf,delete t.ssf,s}function KN(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=zl(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function g0e(e,t){return wn.find(e,"EncryptedPackage")?f0e(e,t):pU(e,t)}function x0e(e,t){var r,n=e,a=t||{};return a.type||(a.type=Xn&&Buffer.isBuffer(e)?"buffer":"base64"),r=R9(n,a),d0e(r,a)}function SU(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return PA(e.slice(r),t);default:break e}return Cm.to_workbook(e,t)}function y0e(e,t){var r="",n=KN(e,t);switch(t.type){case"base64":r=zl(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=m0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=$a(r)),t.type="binary",SU(r,t)}function b0e(e,t){var r=e;return t.type=="base64"&&(r=zl(r)),r=Zx.utils.decode(1200,r.slice(2),"str"),t.type="binary",SU(r,t)}function v0e(e){return e.match(/[^\x00-\x7F]/)?Mu(e):e}function J5(e,t,r,n){return n?(r.type="string",Cm.to_workbook(e,r)):Cm.to_workbook(t,r)}function v0(e,t){hN();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return v0(new Uint8Array(e),(r=ai(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),um={},r.dateNF&&(um.dateNF=r.dateNF),r.type||(r.type=Xn&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Xn?"buffer":"binary",n=pne(e),typeof Uint8Array<"u"&&!Xn&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=v0e(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ai(r),r.type="array",v0(pN(n),r)}switch((a=KN(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return g0e(wn.read(n,r),r);break;case 9:if(a[1]<=8)return pU(n,r);break;case 60:return PA(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return jse(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return O$.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?x0e(n,r):J5(e,n,r,s);case 239:return a[3]===60?PA(n,r):J5(e,n,r,s);case 255:if(a[1]===254)return b0e(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return e0.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return e0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return TA.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return D$.to_workbook(n,r);break;case 10:case 13:case 32:return y0e(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return kse.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?TA.to_workbook(n,r):J5(e,n,r,s)}function _U(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return G1(t.file,wn.write(e,{type:Xn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return wn.write(e,t)}function w0e(e,t){var r=ai(t||{}),n=h0e(e,r);return S0e(n,r)}function S0e(e,t){var r={},n=Xn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?wn.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(pS(a))}return t.password&&typeof encrypt_agile<"u"?_U(encrypt_agile(a,t.password),t):t.type==="file"?G1(t.file,a):t.type=="string"?$a(a):a}function _0e(e,t){var r=t||{},n=vhe(e,r);return _U(n,r)}function ju(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return e1(Mu(n));case"binary":return Mu(n);case"string":return e;case"file":return G1(t.file,n,"utf8");case"buffer":return Xn?Gd(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ju(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function k0e(e,t){switch(t.type){case"base64":return e1(e);case"binary":return e;case"string":return e;case"file":return G1(t.file,e,"binary");case"buffer":return Xn?Gd(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Sb(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?e1(r):t.type=="string"?$a(r):r;case"file":return G1(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function kU(e,t){hN(),gfe(e);var r=ai(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=kU(e,r);return r.type="array",pS(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ju(hhe(e,r),r);case"slk":case"sylk":return ju(P$.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return ju(gU(e.Sheets[e.SheetNames[a]],r),r);case"txt":return k0e(jU(e.Sheets[e.SheetNames[a]],r),r);case"csv":return ju(XN(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return ju(O$.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Sb(TA.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return ju(Cm.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return ju(D$.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return ju(L$.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return ju(vU(e,r),r);case"wk1":return Sb(e0.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Sb(e0.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Sb(mU(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),_0e(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return w0e(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function j0e(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function ty(e,t,r){var n={};return n.type="file",n.file=t,j0e(n),kU(e,n)}function A0e(e,t,r,n,a,s,o,l){var c=Ji(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var m=o?e[r][h]:e[n[h]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[h]!=null&&(p[s[h]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(g==null)if(m.t=="e"&&g===null)p[s[h]]=null;else if(u!==void 0)p[s[h]]=u;else if(d&&g===null)p[s[h]]=null;else continue;else p[s[h]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?g:Md(m,g,l);g!=null&&(f=!1)}}return{row:p,isempty:f}}function F2(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=ua(d);break;case"number":c=ua(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(a=0);var f=Ji(c.s.r),p=[],h=[],m=0,g=0,b=Array.isArray(e),y=c.s.r,v=0,w={};b&&!e[y]&&(e[y]=[]);var _=u.skipHidden&&e["!cols"]||[],C=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(_[v]||{}).hidden)switch(p[v]=xi(v),r=b?e[y][v]:e[p[v]+f],n){case 1:s[v]=v-c.s.c;break;case 2:s[v]=p[v];break;case 3:s[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Md(r,null,u),g=w[o]||0,!g)w[o]=1;else{do l=o+"_"+g++;while(w[l]);w[o]=g,w[l]=1}s[v]=l}for(y=c.s.r+a;y<=c.e.r;++y)if(!(C[y]||{}).hidden){var j=A0e(e,c,y,p,n,s,b,u);(j.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=j.row)}return h.length=m,h}var GP=/"/g;function N0e(e,t,r,n,a,s,o,l){for(var c=!0,u=[],d="",f=Ji(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=l.dense?(e[r]||[])[p]:e[n[p]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:Md(h,null,l));for(var m=0,g=0;m!==d.length;++m)if((g=d.charCodeAt(m))===a||g===s||g===34||l.forceQuotes){d='"'+d.replace(GP,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(GP,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function XN(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=ua(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(p[m]||{}).hidden||(f[m]=xi(m));for(var g=0,b=a.s.r;b<=a.e.r;++b)(h[b]||{}).hidden||(d=N0e(e,a,b,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?l:"")+d)));return delete n.dense,r.join("")}function jU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=XN(e,t);return r}function C0e(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=ua(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=a.s.c;l<=a.e.c;++l)o[l]=xi(l);for(var d=a.s.r;d<=a.e.r;++d)for(s=Ji(d),l=a.s.c;l<=a.e.c;++l)if(t=o[l]+s,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function AU(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?yi(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+a}};if(s["!ref"]){var f=ua(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+a)}else o==-1&&(o=0,d.e.r=t.length-1+a);var p=n.header||[],h=0;t.forEach(function(g,b){Bi(g).forEach(function(y){(h=p.indexOf(y))==-1&&(p[h=p.length]=y);var v=g[y],w="z",_="",C=An({c:l+h,r:o+b+a});u=f1(s,C),v&&typeof v=="object"&&!(v instanceof Date)?s[C]=v:(typeof v=="number"?w="n":typeof v=="boolean"?w="b":typeof v=="string"?w="s":v instanceof Date?(w="d",n.cellDates||(w="n",v=_s(v)),_=n.dateNF||kn[14]):v===null&&n.nullError&&(w="e",v=0),u?(u.t=w,u.v=v,delete u.w,delete u.R,_&&(u.z=_)):s[C]=u={t:w,v},_&&(u.z=_))})}),d.e.c=Math.max(d.e.c,l+p.length-1);var m=Ji(o);if(a)for(h=0;h<p.length;++h)s[xi(h+l)+m]={t:"s",v:p[h]};return s["!ref"]=$n(d),s}function E0e(e,t){return AU(null,e,t)}function f1(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=yi(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?f1(e,An(t)):f1(e,An({r:t,c:r||0}))}function T0e(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function YN(){return{SheetNames:[],Sheets:{}}}function QN(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var o=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=o+a)!=-1;++a);}if(cU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function P0e(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=T0e(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function O0e(e,t){return e.z=t,e}function NU(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function L0e(e,t,r){return NU(e,"#"+t,r)}function M0e(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function F0e(e,t,r,n){for(var a=typeof t!="string"?t:ua(t),s=typeof t=="string"?t:$n(t),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=f1(e,o,l);c.t="n",c.F=s,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var ds={encode_col:xi,encode_row:Ji,encode_cell:An,encode_range:$n,decode_col:AN,decode_row:jN,split_cell:Vne,decode_cell:yi,decode_range:gl,format_cell:Md,sheet_add_aoa:e$,sheet_add_json:AU,sheet_add_dom:xU,aoa_to_sheet:Qm,json_to_sheet:E0e,table_to_sheet:yU,table_to_book:zhe,sheet_to_csv:XN,sheet_to_txt:jU,sheet_to_json:F2,sheet_to_html:gU,sheet_to_formulae:C0e,sheet_to_row_object_array:F2,sheet_get_cell:f1,book_new:YN,book_append_sheet:QN,book_set_sheet_visibility:P0e,cell_set_number_format:O0e,cell_set_hyperlink:NU,cell_set_internal_link:L0e,cell_add_comment:M0e,sheet_set_array_formula:F0e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Oa(e){"@babel/helpers - typeof";return Oa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oa(e)}var ru=Uint8Array,Rl=Uint16Array,JN=Int32Array,ZN=new ru([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),eC=new ru([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),KP=new ru([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),CU=function(e,t){for(var r=new Rl(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new JN(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)a[s]=s-r[n]<<5|n;return{b:r,r:a}},EU=CU(ZN,2),R0e=EU.b,MA=EU.r;R0e[28]=258,MA[258]=28;var B0e=CU(eC,0),XP=B0e.r,FA=new Rl(32768);for(var ti=0;ti<32768;++ti){var mf=(ti&43690)>>1|(ti&21845)<<1;mf=(mf&52428)>>2|(mf&13107)<<2,mf=(mf&61680)>>4|(mf&3855)<<4,FA[ti]=((mf&65280)>>8|(mf&255)<<8)>>1}var jx=function(e,t,r){for(var n=e.length,a=0,s=new Rl(t);a<n;++a)e[a]&&++s[e[a]-1];var o=new Rl(t);for(a=1;a<t;++a)o[a]=o[a-1]+s[a-1]<<1;var l;if(r){l=new Rl(1<<t);var c=15-t;for(a=0;a<n;++a)if(e[a])for(var u=a<<4|e[a],d=t-e[a],f=o[e[a]-1]++<<d,p=f|(1<<d)-1;f<=p;++f)l[FA[f]>>c]=u}else for(l=new Rl(n),a=0;a<n;++a)e[a]&&(l[a]=FA[o[e[a]-1]++]>>15-e[a]);return l},w0=new ru(288);for(var ti=0;ti<144;++ti)w0[ti]=8;for(var ti=144;ti<256;++ti)w0[ti]=9;for(var ti=256;ti<280;++ti)w0[ti]=7;for(var ti=280;ti<288;++ti)w0[ti]=8;var R2=new ru(32);for(var ti=0;ti<32;++ti)R2[ti]=5;var I0e=jx(w0,9,0),D0e=jx(R2,5,0),TU=function(e){return(e+7)/8|0},$0e=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new ru(e.subarray(t,r))},id=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Lg=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},Z5=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,s=r.slice();if(!a)return{t:OU,l:0};if(a==1){var o=new ru(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(C,j){return C.f-j.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=a-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var p=s[0].s,n=1;n<a;++n)s[n].s>p&&(p=s[n].s);var h=new Rl(p+1),m=RA(r[d-1],h,0);if(m>t){var n=0,g=0,b=m-t,y=1<<b;for(s.sort(function(j,A){return h[A.s]-h[j.s]||j.f-A.f});n<a;++n){var v=s[n].s;if(h[v]>t)g+=y-(1<<m-h[v]),h[v]=t;else break}for(g>>=b;g>0;){var w=s[n].s;h[w]<t?g-=1<<t-h[w]++-1:++n}for(;n>=0&&g;--n){var _=s[n].s;h[_]==t&&(--h[_],++g)}m=t}return{t:new ru(h),l:m}},RA=function(e,t,r){return e.s==-1?Math.max(RA(e.l,t,r+1),RA(e.r,t,r+1)):t[e.s]=r},YP=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Rl(++t),n=0,a=e[0],s=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==a&&l!=t)++s;else{if(!a&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(a),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(a);s=1,a=e[l]}return{c:r.subarray(0,n),n:t}},Mg=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},PU=function(e,t,r){var n=r.length,a=TU(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var s=0;s<n;++s)e[a+s+4]=r[s];return(a+4+n)*8},QP=function(e,t,r,n,a,s,o,l,c,u,d){id(t,d++,r),++a[256];for(var f=Z5(a,15),p=f.t,h=f.l,m=Z5(s,15),g=m.t,b=m.l,y=YP(p),v=y.c,w=y.n,_=YP(g),C=_.c,j=_.n,A=new Rl(19),M=0;M<v.length;++M)++A[v[M]&31];for(var M=0;M<C.length;++M)++A[C[M]&31];for(var P=Z5(A,7),R=P.t,N=P.l,T=19;T>4&&!R[KP[T-1]];--T);var B=u+5<<3,G=Mg(a,w0)+Mg(s,R2)+o,re=Mg(a,p)+Mg(s,g)+o+14+3*T+Mg(A,R)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&B<=G&&B<=re)return PU(t,d,e.subarray(c,c+u));var xe,_e,V,K;if(id(t,d,1+(re<G)),d+=2,re<G){xe=jx(p,h,0),_e=p,V=jx(g,b,0),K=g;var de=jx(R,N,0);id(t,d,w-257),id(t,d+5,j-1),id(t,d+10,T-4),d+=14;for(var M=0;M<T;++M)id(t,d+3*M,R[KP[M]]);d+=3*T;for(var ne=[v,C],E=0;E<2;++E)for(var Z=ne[E],M=0;M<Z.length;++M){var H=Z[M]&31;id(t,d,de[H]),d+=R[H],H>15&&(id(t,d,Z[M]>>5&127),d+=Z[M]>>12)}}else xe=I0e,_e=w0,V=D0e,K=R2;for(var M=0;M<l;++M){var F=n[M];if(F>255){var H=F>>18&31;Lg(t,d,xe[H+257]),d+=_e[H+257],H>7&&(id(t,d,F>>23&31),d+=ZN[H]);var ee=F&31;Lg(t,d,V[ee]),d+=K[ee],ee>3&&(Lg(t,d,F>>5&8191),d+=eC[ee])}else Lg(t,d,xe[F]),d+=_e[F]}return Lg(t,d,xe[256]),d+_e[256]},U0e=new JN([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),OU=new ru(0),z0e=function(e,t,r,n,a,s){var o=s.z||e.length,l=new ru(n+o+5*(1+Math.ceil(o/7e3))+a),c=l.subarray(n,l.length-a),u=s.l,d=(s.r||0)&7;if(t){d&&(c[0]=s.r>>3);for(var f=U0e[t-1],p=f>>13,h=f&8191,m=(1<<r)-1,g=s.p||new Rl(32768),b=s.h||new Rl(m+1),y=Math.ceil(r/3),v=2*y,w=function(ce){return(e[ce]^e[ce+1]<<y^e[ce+2]<<v)&m},_=new JN(25e3),C=new Rl(288),j=new Rl(32),A=0,M=0,P=s.i||0,R=0,N=s.w||0,T=0;P+2<o;++P){var B=w(P),G=P&32767,re=b[B];if(g[G]=re,b[B]=G,N<=P){var xe=o-P;if((A>7e3||R>24576)&&(xe>423||!u)){d=QP(e,c,0,_,C,j,M,R,T,P-T,d),R=A=M=0,T=P;for(var _e=0;_e<286;++_e)C[_e]=0;for(var _e=0;_e<30;++_e)j[_e]=0}var V=2,K=0,de=h,ne=G-re&32767;if(xe>2&&B==w(P-ne))for(var E=Math.min(p,xe)-1,Z=Math.min(32767,P),H=Math.min(258,xe);ne<=Z&&--de&&G!=re;){if(e[P+V]==e[P+V-ne]){for(var F=0;F<H&&e[P+F]==e[P+F-ne];++F);if(F>V){if(V=F,K=ne,F>E)break;for(var ee=Math.min(ne,F-2),z=0,_e=0;_e<ee;++_e){var X=P-ne+_e&32767,J=g[X],q=X-J&32767;q>z&&(z=q,re=X)}}}G=re,re=g[G],ne+=G-re&32767}if(K){_[R++]=268435456|MA[V]<<18|XP[K];var Y=MA[V]&31,L=XP[K]&31;M+=ZN[Y]+eC[L],++C[257+Y],++j[L],N=P+V,++A}else _[R++]=e[P],++C[e[P]]}}for(P=Math.max(P,N);P<o;++P)_[R++]=e[P],++C[e[P]];d=QP(e,c,u,_,C,j,M,R,T,P-T,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=b,s.p=g,s.i=P,s.w=N)}else{for(var P=s.w||0;P<o+u;P+=65535){var U=P+65535;U>=o&&(c[d/8|0]=u,U=o),d=PU(c,d+1,e.subarray(P,U))}s.i=o}return $0e(l,0,n+TU(d)+a)},LU=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)a+=n+=r[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},W0e=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new ru(s.length+e.length);o.set(s),o.set(e,s.length),e=o,a.w=s.length}return z0e(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},MU=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},q0e=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=LU();a.p(t.dictionary),MU(e,2,a.d())}};function BA(e,t){t||(t={});var r=LU();r.p(e);var n=W0e(e,t,t.dictionary?6:2,4);return q0e(n,t),MU(n,n.length-4,r.d()),n}var H0e=typeof TextDecoder<"u"&&new TextDecoder,V0e=0;try{H0e.decode(OU,{stream:!0}),V0e=1}catch{}function G0e(e){if(Array.isArray(e))return e}function K0e(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,a=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw a}}return l}}function JP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function X0e(e,t){if(e){if(typeof e=="string")return JP(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?JP(e,t):void 0}}function Y0e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ZP(e,t){return G0e(e)||K0e(e,t)||X0e(e,t)||Y0e()}function eO(e,t="utf8"){return new TextDecoder(t).decode(e)}const Q0e=new TextEncoder;function J0e(e){return Q0e.encode(e)}const Z0e=1024*8,epe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),ek={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class tC{constructor(t=Z0e,r={}){ya(this,"buffer");ya(this,"byteLength");ya(this,"byteOffset");ya(this,"length");ya(this,"offset");ya(this,"lastWrittenByte");ya(this,"littleEndian");ya(this,"_data");ya(this,"_mark");ya(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,s=t.byteLength-a;let o=a;(ArrayBuffer.isView(t)||t instanceof tC)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=ek[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,s=this.buffer.slice(a,a+n);if(this.littleEndian===epe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(a,a+n));l.reverse();const c=new ek[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new ek[r](s);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return eO(this.readBytes(t))}decodeText(t=1,r="utf8"){return eO(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(J0e(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Zm(e){let t=e.length;for(;--t>=0;)e[t]=0}const tpe=3,rpe=258,FU=29,npe=256,ape=npe+1+FU,RU=30,ipe=512,spe=new Array((ape+2)*2);Zm(spe);const ope=new Array(RU*2);Zm(ope);const lpe=new Array(ipe);Zm(lpe);const cpe=new Array(rpe-tpe+1);Zm(cpe);const upe=new Array(FU);Zm(upe);const dpe=new Array(RU);Zm(dpe);const fpe=(e,t,r,n)=>{let a=e&65535|0,s=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do a=a+t[n++]|0,s=s+a|0;while(--o);a%=65521,s%=65521}return a|s<<16|0};var IA=fpe;const hpe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},ppe=new Uint32Array(hpe()),mpe=(e,t,r,n)=>{const a=ppe,s=n+r;e^=-1;for(let o=n;o<s;o++)e=e>>>8^a[(e^t[o])&255];return e^-1};var yu=mpe,DA={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},BU={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const gpe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var xpe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)gpe(r,n)&&(e[n]=r[n])}}return e},ype=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,s=e.length;n<s;n++){let o=e[n];r.set(o,a),a+=o.length}return r},IU={assign:xpe,flattenChunks:ype};let DU=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{DU=!1}const h1=new Uint8Array(256);for(let e=0;e<256;e++)h1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;h1[254]=h1[254]=1;var bpe=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,a,s,o=e.length,l=0;for(a=0;a<o;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),s=0,a=0;s<l;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<o&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const vpe=(e,t)=>{if(t<65534&&e.subarray&&DU)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var wpe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,a;const s=new Array(r*2);for(a=0,n=0;n<r;){let o=e[n++];if(o<128){s[a++]=o;continue}let l=h1[o];if(l>4){s[a++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){s[a++]=65533;continue}o<65536?s[a++]=o:(o-=65536,s[a++]=55296|o>>10&1023,s[a++]=56320|o&1023)}return vpe(s,a)},Spe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+h1[e[r]]>t?r:t},$A={string2buf:bpe,buf2string:wpe,utf8border:Spe};function _pe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var kpe=_pe;const _b=16209,jpe=16191;var Ape=function(t,r){let n,a,s,o,l,c,u,d,f,p,h,m,g,b,y,v,w,_,C,j,A,M,P,R;const N=t.state;n=t.next_in,P=t.input,a=n+(t.avail_in-5),s=t.next_out,R=t.output,o=s-(r-t.avail_out),l=s+(t.avail_out-257),c=N.dmax,u=N.wsize,d=N.whave,f=N.wnext,p=N.window,h=N.hold,m=N.bits,g=N.lencode,b=N.distcode,y=(1<<N.lenbits)-1,v=(1<<N.distbits)-1;e:do{m<15&&(h+=P[n++]<<m,m+=8,h+=P[n++]<<m,m+=8),w=g[h&y];t:for(;;){if(_=w>>>24,h>>>=_,m-=_,_=w>>>16&255,_===0)R[s++]=w&65535;else if(_&16){C=w&65535,_&=15,_&&(m<_&&(h+=P[n++]<<m,m+=8),C+=h&(1<<_)-1,h>>>=_,m-=_),m<15&&(h+=P[n++]<<m,m+=8,h+=P[n++]<<m,m+=8),w=b[h&v];r:for(;;){if(_=w>>>24,h>>>=_,m-=_,_=w>>>16&255,_&16){if(j=w&65535,_&=15,m<_&&(h+=P[n++]<<m,m+=8,m<_&&(h+=P[n++]<<m,m+=8)),j+=h&(1<<_)-1,j>c){t.msg="invalid distance too far back",N.mode=_b;break e}if(h>>>=_,m-=_,_=s-o,j>_){if(_=j-_,_>d&&N.sane){t.msg="invalid distance too far back",N.mode=_b;break e}if(A=0,M=p,f===0){if(A+=u-_,_<C){C-=_;do R[s++]=p[A++];while(--_);A=s-j,M=R}}else if(f<_){if(A+=u+f-_,_-=f,_<C){C-=_;do R[s++]=p[A++];while(--_);if(A=0,f<C){_=f,C-=_;do R[s++]=p[A++];while(--_);A=s-j,M=R}}}else if(A+=f-_,_<C){C-=_;do R[s++]=p[A++];while(--_);A=s-j,M=R}for(;C>2;)R[s++]=M[A++],R[s++]=M[A++],R[s++]=M[A++],C-=3;C&&(R[s++]=M[A++],C>1&&(R[s++]=M[A++]))}else{A=s-j;do R[s++]=R[A++],R[s++]=R[A++],R[s++]=R[A++],C-=3;while(C>2);C&&(R[s++]=R[A++],C>1&&(R[s++]=R[A++]))}}else if(_&64){t.msg="invalid distance code",N.mode=_b;break e}else{w=b[(w&65535)+(h&(1<<_)-1)];continue r}break}}else if(_&64)if(_&32){N.mode=jpe;break e}else{t.msg="invalid literal/length code",N.mode=_b;break e}else{w=g[(w&65535)+(h&(1<<_)-1)];continue t}break}}while(n<a&&s<l);C=m>>3,n-=C,m-=C<<3,h&=(1<<m)-1,t.next_in=n,t.next_out=s,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=s<l?257+(l-s):257-(s-l),N.hold=h,N.bits=m};const lp=15,tO=852,rO=592,nO=0,tk=1,aO=2,Npe=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Cpe=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Epe=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Tpe=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Ppe=(e,t,r,n,a,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,p=0,h=0,m=0,g=0,b=0,y=0,v=0,w,_,C,j,A,M=null,P;const R=new Uint16Array(lp+1),N=new Uint16Array(lp+1);let T=null,B,G,re;for(u=0;u<=lp;u++)R[u]=0;for(d=0;d<n;d++)R[t[r+d]]++;for(h=c,p=lp;p>=1&&R[p]===0;p--);if(h>p&&(h=p),p===0)return a[s++]=1<<24|64<<16|0,a[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<p&&R[f]===0;f++);for(h<f&&(h=f),b=1,u=1;u<=lp;u++)if(b<<=1,b-=R[u],b<0)return-1;if(b>0&&(e===nO||p!==1))return-1;for(N[1]=0,u=1;u<lp;u++)N[u+1]=N[u]+R[u];for(d=0;d<n;d++)t[r+d]!==0&&(o[N[t[r+d]]++]=d);if(e===nO?(M=T=o,P=20):e===tk?(M=Npe,T=Cpe,P=257):(M=Epe,T=Tpe,P=0),v=0,d=0,u=f,A=s,m=h,g=0,C=-1,y=1<<h,j=y-1,e===tk&&y>tO||e===aO&&y>rO)return 1;for(;;){B=u-g,o[d]+1<P?(G=0,re=o[d]):o[d]>=P?(G=T[o[d]-P],re=M[o[d]-P]):(G=96,re=0),w=1<<u-g,_=1<<m,f=_;do _-=w,a[A+(v>>g)+_]=B<<24|G<<16|re|0;while(_!==0);for(w=1<<u-1;v&w;)w>>=1;if(w!==0?(v&=w-1,v+=w):v=0,d++,--R[u]===0){if(u===p)break;u=t[r+o[d]]}if(u>h&&(v&j)!==C){for(g===0&&(g=h),A+=f,m=u-g,b=1<<m;m+g<p&&(b-=R[m+g],!(b<=0));)m++,b<<=1;if(y+=1<<m,e===tk&&y>tO||e===aO&&y>rO)return 1;C=v&j,a[C]=h<<24|m<<16|A-s|0}}return v!==0&&(a[A+v]=u-g<<24|64<<16|0),l.bits=h,0};var Ax=Ppe;const Ope=0,$U=1,UU=2,{Z_FINISH:iO,Z_BLOCK:Lpe,Z_TREES:kb,Z_OK:S0,Z_STREAM_END:Mpe,Z_NEED_DICT:Fpe,Z_STREAM_ERROR:wc,Z_DATA_ERROR:zU,Z_MEM_ERROR:WU,Z_BUF_ERROR:Rpe,Z_DEFLATED:sO}=BU,_S=16180,oO=16181,lO=16182,cO=16183,uO=16184,dO=16185,fO=16186,hO=16187,pO=16188,mO=16189,B2=16190,sd=16191,rk=16192,gO=16193,nk=16194,xO=16195,yO=16196,bO=16197,vO=16198,jb=16199,Ab=16200,wO=16201,SO=16202,_O=16203,kO=16204,jO=16205,ak=16206,AO=16207,NO=16208,ii=16209,qU=16210,HU=16211,Bpe=852,Ipe=592,Dpe=15,$pe=Dpe,CO=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function Upe(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const V0=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<_S||t.mode>HU?1:0},VU=e=>{if(V0(e))return wc;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=_S,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Bpe),t.distcode=t.distdyn=new Int32Array(Ipe),t.sane=1,t.back=-1,S0},GU=e=>{if(V0(e))return wc;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,VU(e)},KU=(e,t)=>{let r;if(V0(e))return wc;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?wc:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,GU(e))},XU=(e,t)=>{if(!e)return wc;const r=new Upe;e.state=r,r.strm=e,r.window=null,r.mode=_S;const n=KU(e,t);return n!==S0&&(e.state=null),n},zpe=e=>XU(e,$pe);let EO=!0,ik,sk;const Wpe=e=>{if(EO){ik=new Int32Array(512),sk=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ax($U,e.lens,0,288,ik,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ax(UU,e.lens,0,32,sk,0,e.work,{bits:5}),EO=!1}e.lencode=ik,e.lenbits=9,e.distcode=sk,e.distbits=5},YU=(e,t,r,n)=>{let a;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(t.subarray(r-n,r-n+a),s.wnext),n-=a,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0},qpe=(e,t)=>{let r,n,a,s,o,l,c,u,d,f,p,h,m,g,b=0,y,v,w,_,C,j,A,M;const P=new Uint8Array(4);let R,N;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(V0(e)||!e.output||!e.input&&e.avail_in!==0)return wc;r=e.state,r.mode===sd&&(r.mode=rk),o=e.next_out,a=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,f=l,p=c,M=S0;e:for(;;)switch(r.mode){case _S:if(r.wrap===0){r.mode=rk;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,P[0]=u&255,P[1]=u>>>8&255,r.check=yu(r.check,P,2,0),u=0,d=0,r.mode=oO;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=ii;break}if((u&15)!==sO){e.msg="unknown compression method",r.mode=ii;break}if(u>>>=4,d-=4,A=(u&15)+8,r.wbits===0&&(r.wbits=A),A>15||A>r.wbits){e.msg="invalid window size",r.mode=ii;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?mO:sd,u=0,d=0;break;case oO:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==sO){e.msg="unknown compression method",r.mode=ii;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=ii;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=yu(r.check,P,2,0)),u=0,d=0,r.mode=lO;case lO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,P[2]=u>>>16&255,P[3]=u>>>24&255,r.check=yu(r.check,P,4,0)),u=0,d=0,r.mode=cO;case cO:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=yu(r.check,P,2,0)),u=0,d=0,r.mode=uO;case uO:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=yu(r.check,P,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=dO;case dO:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+h),A)),r.flags&512&&r.wrap&4&&(r.check=yu(r.check,n,h,s)),l-=h,s+=h,r.length-=h),r.length))break e;r.length=0,r.mode=fO;case fO:if(r.flags&2048){if(l===0)break e;h=0;do A=n[s+h++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A));while(A&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=yu(r.check,n,h,s)),l-=h,s+=h,A)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=hO;case hO:if(r.flags&4096){if(l===0)break e;h=0;do A=n[s+h++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A));while(A&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=yu(r.check,n,h,s)),l-=h,s+=h,A)break e}else r.head&&(r.head.comment=null);r.mode=pO;case pO:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=ii;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=sd;break;case mO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}e.adler=r.check=CO(u),u=0,d=0,r.mode=B2;case B2:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,Fpe;e.adler=r.check=1,r.mode=sd;case sd:if(t===Lpe||t===kb)break e;case rk:if(r.last){u>>>=d&7,d-=d&7,r.mode=ak;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=gO;break;case 1:if(Wpe(r),r.mode=jb,t===kb){u>>>=2,d-=2;break e}break;case 2:r.mode=yO;break;case 3:e.msg="invalid block type",r.mode=ii}u>>>=2,d-=2;break;case gO:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=ii;break}if(r.length=u&65535,u=0,d=0,r.mode=nk,t===kb)break e;case nk:r.mode=xO;case xO:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;a.set(n.subarray(s,s+h),o),l-=h,s+=h,c-=h,o+=h,r.length-=h;break}r.mode=sd;break;case yO:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=ii;break}r.have=0,r.mode=bO;case bO:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[T[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[T[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,R={bits:r.lenbits},M=Ax(Ope,r.lens,0,19,r.lencode,0,r.work,R),r.lenbits=R.bits,M){e.msg="invalid code lengths set",r.mode=ii;break}r.have=0,r.mode=vO;case vO:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[u&(1<<r.lenbits)-1],y=b>>>24,v=b>>>16&255,w=b&65535,!(y<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(w<16)u>>>=y,d-=y,r.lens[r.have++]=w;else{if(w===16){for(N=y+2;d<N;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=y,d-=y,r.have===0){e.msg="invalid bit length repeat",r.mode=ii;break}A=r.lens[r.have-1],h=3+(u&3),u>>>=2,d-=2}else if(w===17){for(N=y+3;d<N;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=y,d-=y,A=0,h=3+(u&7),u>>>=3,d-=3}else{for(N=y+7;d<N;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=y,d-=y,A=0,h=11+(u&127),u>>>=7,d-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=ii;break}for(;h--;)r.lens[r.have++]=A}}if(r.mode===ii)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=ii;break}if(r.lenbits=9,R={bits:r.lenbits},M=Ax($U,r.lens,0,r.nlen,r.lencode,0,r.work,R),r.lenbits=R.bits,M){e.msg="invalid literal/lengths set",r.mode=ii;break}if(r.distbits=6,r.distcode=r.distdyn,R={bits:r.distbits},M=Ax(UU,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,R),r.distbits=R.bits,M){e.msg="invalid distances set",r.mode=ii;break}if(r.mode=jb,t===kb)break e;case jb:r.mode=Ab;case Ab:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,Ape(e,p),o=e.next_out,a=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,r.mode===sd&&(r.back=-1);break}for(r.back=0;b=r.lencode[u&(1<<r.lenbits)-1],y=b>>>24,v=b>>>16&255,w=b&65535,!(y<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(v&&!(v&240)){for(_=y,C=v,j=w;b=r.lencode[j+((u&(1<<_+C)-1)>>_)],y=b>>>24,v=b>>>16&255,w=b&65535,!(_+y<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=_,d-=_,r.back+=_}if(u>>>=y,d-=y,r.back+=y,r.length=w,v===0){r.mode=jO;break}if(v&32){r.back=-1,r.mode=sd;break}if(v&64){e.msg="invalid literal/length code",r.mode=ii;break}r.extra=v&15,r.mode=wO;case wO:if(r.extra){for(N=r.extra;d<N;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=SO;case SO:for(;b=r.distcode[u&(1<<r.distbits)-1],y=b>>>24,v=b>>>16&255,w=b&65535,!(y<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(v&240)){for(_=y,C=v,j=w;b=r.distcode[j+((u&(1<<_+C)-1)>>_)],y=b>>>24,v=b>>>16&255,w=b&65535,!(_+y<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=_,d-=_,r.back+=_}if(u>>>=y,d-=y,r.back+=y,v&64){e.msg="invalid distance code",r.mode=ii;break}r.offset=w,r.extra=v&15,r.mode=_O;case _O:if(r.extra){for(N=r.extra;d<N;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=ii;break}r.mode=kO;case kO:if(c===0)break e;if(h=p-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=ii;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),g=r.window}else g=a,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[o++]=g[m++];while(--h);r.length===0&&(r.mode=Ab);break;case jO:if(c===0)break e;a[o++]=r.length,c--,r.mode=Ab;break;case ak:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(p-=c,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?yu(r.check,a,p,o-p):IA(r.check,a,p,o-p)),p=c,r.wrap&4&&(r.flags?u:CO(u))!==r.check){e.msg="incorrect data check",r.mode=ii;break}u=0,d=0}r.mode=AO;case AO:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=ii;break}u=0,d=0}r.mode=NO;case NO:M=Mpe;break e;case ii:M=zU;break e;case qU:return WU;case HU:default:return wc}return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,(r.wsize||p!==e.avail_out&&r.mode<ii&&(r.mode<ak||t!==iO))&&YU(e,e.output,e.next_out,p-e.avail_out),f-=e.avail_in,p-=e.avail_out,e.total_in+=f,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?yu(r.check,a,p,e.next_out-p):IA(r.check,a,p,e.next_out-p)),e.data_type=r.bits+(r.last?64:0)+(r.mode===sd?128:0)+(r.mode===jb||r.mode===nk?256:0),(f===0&&p===0||t===iO)&&M===S0&&(M=Rpe),M},Hpe=e=>{if(V0(e))return wc;let t=e.state;return t.window&&(t.window=null),e.state=null,S0},Vpe=(e,t)=>{if(V0(e))return wc;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,S0):wc},Gpe=(e,t)=>{const r=t.length;let n,a,s;return V0(e)||(n=e.state,n.wrap!==0&&n.mode!==B2)?wc:n.mode===B2&&(a=1,a=IA(a,t,r,0),a!==n.check)?zU:(s=YU(e,t,r,r),s?(n.mode=qU,WU):(n.havedict=1,S0))};var Kpe=GU,Xpe=KU,Ype=VU,Qpe=zpe,Jpe=XU,Zpe=qpe,eme=Hpe,tme=Vpe,rme=Gpe,nme="pako inflate (from Nodeca project)",hd={inflateReset:Kpe,inflateReset2:Xpe,inflateResetKeep:Ype,inflateInit:Qpe,inflateInit2:Jpe,inflate:Zpe,inflateEnd:eme,inflateGetHeader:tme,inflateSetDictionary:rme,inflateInfo:nme};function ame(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var ime=ame;const QU=Object.prototype.toString,{Z_NO_FLUSH:sme,Z_FINISH:ome,Z_OK:p1,Z_STREAM_END:ok,Z_NEED_DICT:lk,Z_STREAM_ERROR:lme,Z_DATA_ERROR:TO,Z_MEM_ERROR:cme}=BU;function ry(e){this.options=IU.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kpe,this.strm.avail_out=0;let r=hd.inflateInit2(this.strm,t.windowBits);if(r!==p1)throw new Error(DA[r]);if(this.header=new ime,hd.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=$A.string2buf(t.dictionary):QU.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=hd.inflateSetDictionary(this.strm,t.dictionary),r!==p1)))throw new Error(DA[r])}ry.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?ome:sme,QU.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=hd.inflate(r,o),s===lk&&a&&(s=hd.inflateSetDictionary(r,a),s===p1?s=hd.inflate(r,o):s===TO&&(s=lk));r.avail_in>0&&s===ok&&r.state.wrap>0&&e[r.next_in]!==0;)hd.inflateReset(r),s=hd.inflate(r,o);switch(s){case lme:case TO:case lk:case cme:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===ok))if(this.options.to==="string"){let c=$A.utf8border(r.output,r.next_out),u=r.next_out-c,d=$A.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===p1&&l===0)){if(s===ok)return s=hd.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};ry.prototype.onData=function(e){this.chunks.push(e)};ry.prototype.onEnd=function(e){e===p1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=IU.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function ume(e,t){const r=new ry(t);if(r.push(e),r.err)throw r.msg||DA[r.err];return r.result}var dme=ry,fme=ume,hme={Inflate:dme,inflate:fme};const{Inflate:pme,inflate:mme}=hme;var PO=pme,gme=mme;const JU=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;JU[e]=t}const OO=4294967295;function xme(e,t,r){let n=e;for(let a=0;a<r;a++)n=JU[(n^t[a])&255]^n>>>8;return n}function yme(e,t){return(xme(OO,e,t)^OO)>>>0}function LO(e,t,r){const n=e.readUint32(),a=yme(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function ZU(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function ez(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function tz(e,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function rz(e,t,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-a]>>1)&255}else{for(;s<a;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-a]+r[s]>>1)&255}}function nz(e,t,r,n,a){let s=0;if(r.length===0){for(;s<a;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-a]&255}else{for(;s<a;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+bme(t[s-a],r[s],r[s-a])&255}}function bme(e,t,r){const n=e+t-r,a=Math.abs(n-e),s=Math.abs(n-t),o=Math.abs(n-r);return a<=s&&a<=o?e:s<=o?t:r}function vme(e,t,r,n,a,s){switch(e){case 0:ZU(t,r,a);break;case 1:ez(t,r,a,s);break;case 2:tz(t,r,n,a);break;case 3:rz(t,r,n,a,s);break;case 4:nz(t,r,n,a,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const wme=new Uint16Array([255]),Sme=new Uint8Array(wme.buffer),_me=Sme[0]===255;function kme(e){const{data:t,width:r,height:n,channels:a,depth:s}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*a,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],p=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(p<=0||h<=0)continue;const m=p*l,g=new Uint8Array(m);for(let b=0;b<h;b++){const y=t[u++],v=t.subarray(u,u+m);u+=m;const w=new Uint8Array(m);vme(y,v,w,g,m,l),g.set(w);for(let _=0;_<p;_++){const C=f.x+_*f.xStep,j=f.y+b*f.yStep;if(!(C>=r||j>=n))for(let A=0;A<l;A++)c[(j*r+C)*l+A]=w[_*l+A]}}}if(s===16){const d=new Uint16Array(c.buffer);if(_me)for(let f=0;f<d.length;f++)d[f]=jme(d[f]);return d}else return c}function jme(e){return(e&255)<<8|e>>8&255}const Ame=new Uint16Array([255]),Nme=new Uint8Array(Ame.buffer),Cme=Nme[0]===255,Eme=new Uint8Array(0);function MO(e){const{data:t,width:r,height:n,channels:a,depth:s}=e,o=Math.ceil(s/8)*a,l=Math.ceil(s/8*a*r),c=new Uint8Array(n*l);let u=Eme,d=0,f,p;for(let h=0;h<n;h++){switch(f=t.subarray(d+1,d+1+l),p=c.subarray(h*l,(h+1)*l),t[d]){case 0:ZU(f,p,l);break;case 1:ez(f,p,l,o);break;case 2:tz(f,p,u,l);break;case 3:rz(f,p,u,l,o);break;case 4:nz(f,p,u,l,o);break;default:throw new Error(`Unsupported filter: ${t[d]}`)}u=p,d+=l+1}if(s===16){const h=new Uint16Array(c.buffer);if(Cme)for(let m=0;m<h.length;m++)h[m]=Tme(h[m]);return h}else return c}function Tme(e){return(e&255)<<8|e>>8&255}const Pv=Uint8Array.of(137,80,78,71,13,10,26,10);function FO(e){if(!Pme(e.readBytes(Pv.length)))throw new Error("wrong PNG signature")}function Pme(e){if(e.length<Pv.length)return!1;for(let t=0;t<Pv.length;t++)if(e[t]!==Pv[t])return!1;return!0}const Ome="tEXt",Lme=0,az=new TextDecoder("latin1");function Mme(e){if(Rme(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const Fme=/^[\u0000-\u00FF]*$/;function Rme(e){if(!Fme.test(e))throw new Error("invalid latin1 text")}function Bme(e,t,r){const n=iz(t);e[n]=Ime(t,r-n.length-1)}function iz(e){for(e.mark();e.readByte()!==Lme;);const t=e.offset;e.reset();const r=az.decode(e.readBytes(t-e.offset-1));return e.skip(1),Mme(r),r}function Ime(e,t){return az.decode(e.readBytes(t))}const jl={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},ck={UNKNOWN:-1,DEFLATE:0},RO={UNKNOWN:-1,ADAPTIVE:0},uk={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Nb={NONE:0,BACKGROUND:1,PREVIOUS:2},dk={SOURCE:0,OVER:1};class Dme extends tC{constructor(r,n={}){super(r);ya(this,"_checkCrc");ya(this,"_inflator");ya(this,"_png");ya(this,"_apng");ya(this,"_end");ya(this,"_hasPalette");ya(this,"_palette");ya(this,"_hasTransparency");ya(this,"_transparency");ya(this,"_compressionMethod");ya(this,"_filterMethod");ya(this,"_interlaceMethod");ya(this,"_colorType");ya(this,"_isAnimated");ya(this,"_numberOfFrames");ya(this,"_numberOfPlays");ya(this,"_frames");ya(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new PO,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=ck.UNKNOWN,this._filterMethod=RO.UNKNOWN,this._interlaceMethod=uk.UNKNOWN,this._colorType=jl.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(FO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(FO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case Ome:Bme(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?LO(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?LO(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=$me(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case jl.GREYSCALE:a=1;break;case jl.TRUECOLOUR:a=3;break;case jl.INDEXED_COLOUR:a=1;break;case jl.GREYSCALE_ALPHA:a=2;break;case jl.TRUECOLOUR_ALPHA:a=4;break;case jl.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==ck.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let s=0;s<n;s++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case jl.GREYSCALE:case jl.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case jl.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case jl.UNKNOWN:case jl.GREYSCALE_ALPHA:case jl.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=iz(this),a=this.readUint8();if(a!==ck.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:gme(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=MO({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(a,s,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case Nb.NONE:break;case Nb.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[l+c]=0}break;case Nb.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case dk.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case dk.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/a,p=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(f*p+(1-f)*r.data[c+d]);r.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==RO.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===uk.NO_INTERLACE)this._png.data=MO({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===uk.ADAM7)this._png.data=kme({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Nb.NONE,blendOp:dk.SOURCE,data:r}),this._inflator=new PO,this._writingDataChunks=!1}}function $me(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var BO;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(BO||(BO={}));function Ume(e,t){return new Dme(e,t).decode()}var En=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function fk(){En.console&&typeof En.console.log=="function"&&En.console.log.apply(En.console,arguments)}var Ha={log:fk,warn:function(e){En.console&&(typeof En.console.warn=="function"?En.console.warn.apply(En.console,arguments):fk.call(null,arguments))},error:function(e){En.console&&(typeof En.console.error=="function"?En.console.error.apply(En.console,arguments):fk(e))}};function hk(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Oh(n.response,t,r)},n.onerror=function(){Ha.error("could not download file")},n.send()}function IO(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Cb(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Oh=En.saveAs||((typeof window>"u"?"undefined":Oa(window))!=="object"||window!==En?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=En.URL||En.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?IO(a.href)?hk(e,t,r):Cb(a,a.target="_blank"):Cb(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){Cb(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(IO(e))hk(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Cb(n)})}else navigator.msSaveOrOpenBlob(function(a,s){return s===void 0?s={autoBom:!1}:Oa(s)!=="object"&&(Ha.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return hk(e,t,r);var a=e.type==="application/octet-stream",s=/constructor/i.test(En.HTMLElement)||En.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&s)&&(typeof FileReader>"u"?"undefined":Oa(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(e)}else{var c=En.URL||En.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function sz(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,s=r[n].process,o=a.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Ov=En.atob.bind(En),DO=En.btoa.bind(En);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function pk(e,t){var r=e[0],n=e[1],a=e[2],s=e[3];r=ho(r,n,a,s,t[0],7,-680876936),s=ho(s,r,n,a,t[1],12,-389564586),a=ho(a,s,r,n,t[2],17,606105819),n=ho(n,a,s,r,t[3],22,-1044525330),r=ho(r,n,a,s,t[4],7,-176418897),s=ho(s,r,n,a,t[5],12,1200080426),a=ho(a,s,r,n,t[6],17,-1473231341),n=ho(n,a,s,r,t[7],22,-45705983),r=ho(r,n,a,s,t[8],7,1770035416),s=ho(s,r,n,a,t[9],12,-1958414417),a=ho(a,s,r,n,t[10],17,-42063),n=ho(n,a,s,r,t[11],22,-1990404162),r=ho(r,n,a,s,t[12],7,1804603682),s=ho(s,r,n,a,t[13],12,-40341101),a=ho(a,s,r,n,t[14],17,-1502002290),r=po(r,n=ho(n,a,s,r,t[15],22,1236535329),a,s,t[1],5,-165796510),s=po(s,r,n,a,t[6],9,-1069501632),a=po(a,s,r,n,t[11],14,643717713),n=po(n,a,s,r,t[0],20,-373897302),r=po(r,n,a,s,t[5],5,-701558691),s=po(s,r,n,a,t[10],9,38016083),a=po(a,s,r,n,t[15],14,-660478335),n=po(n,a,s,r,t[4],20,-405537848),r=po(r,n,a,s,t[9],5,568446438),s=po(s,r,n,a,t[14],9,-1019803690),a=po(a,s,r,n,t[3],14,-187363961),n=po(n,a,s,r,t[8],20,1163531501),r=po(r,n,a,s,t[13],5,-1444681467),s=po(s,r,n,a,t[2],9,-51403784),a=po(a,s,r,n,t[7],14,1735328473),r=mo(r,n=po(n,a,s,r,t[12],20,-1926607734),a,s,t[5],4,-378558),s=mo(s,r,n,a,t[8],11,-2022574463),a=mo(a,s,r,n,t[11],16,1839030562),n=mo(n,a,s,r,t[14],23,-35309556),r=mo(r,n,a,s,t[1],4,-1530992060),s=mo(s,r,n,a,t[4],11,1272893353),a=mo(a,s,r,n,t[7],16,-155497632),n=mo(n,a,s,r,t[10],23,-1094730640),r=mo(r,n,a,s,t[13],4,681279174),s=mo(s,r,n,a,t[0],11,-358537222),a=mo(a,s,r,n,t[3],16,-722521979),n=mo(n,a,s,r,t[6],23,76029189),r=mo(r,n,a,s,t[9],4,-640364487),s=mo(s,r,n,a,t[12],11,-421815835),a=mo(a,s,r,n,t[15],16,530742520),r=go(r,n=mo(n,a,s,r,t[2],23,-995338651),a,s,t[0],6,-198630844),s=go(s,r,n,a,t[7],10,1126891415),a=go(a,s,r,n,t[14],15,-1416354905),n=go(n,a,s,r,t[5],21,-57434055),r=go(r,n,a,s,t[12],6,1700485571),s=go(s,r,n,a,t[3],10,-1894986606),a=go(a,s,r,n,t[10],15,-1051523),n=go(n,a,s,r,t[1],21,-2054922799),r=go(r,n,a,s,t[8],6,1873313359),s=go(s,r,n,a,t[15],10,-30611744),a=go(a,s,r,n,t[6],15,-1560198380),n=go(n,a,s,r,t[13],21,1309151649),r=go(r,n,a,s,t[4],6,-145523070),s=go(s,r,n,a,t[11],10,-1120210379),a=go(a,s,r,n,t[2],15,718787259),n=go(n,a,s,r,t[9],21,-343485551),e[0]=Rf(r,e[0]),e[1]=Rf(n,e[1]),e[2]=Rf(a,e[2]),e[3]=Rf(s,e[3])}function kS(e,t,r,n,a,s){return t=Rf(Rf(t,e),Rf(n,s)),Rf(t<<a|t>>>32-a,r)}function ho(e,t,r,n,a,s,o){return kS(t&r|~t&n,e,t,a,s,o)}function po(e,t,r,n,a,s,o){return kS(t&n|r&~n,e,t,a,s,o)}function mo(e,t,r,n,a,s,o){return kS(t^r^n,e,t,a,s,o)}function go(e,t,r,n,a,s,o){return kS(r^(t|~n),e,t,a,s,o)}function oz(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)pk(n,zme(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(pk(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,pk(n,a),n}function zme(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var $O="0123456789abcdef".split("");function Wme(e){for(var t="",r=0;r<4;r++)t+=$O[e>>8*r+4&15]+$O[e>>8*r&15];return t}function qme(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function UA(e){return oz(e).map(qme).join("")}var Hme=function(e){for(var t=0;t<e.length;t++)e[t]=Wme(e[t]);return e.join("")}(oz("hello"))!="5d41402abc4b2a76b9719d911017c592";function Rf(e,t){if(Hme){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function zA(e,t){var r,n,a,s;if(e!==r){for(var o=(a=e,s=1+(256/e.length|0),new Array(s+1).join(a)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=e,n=l}else l=n;var f=t.length,p=0,h=0,m="";for(c=0;c<f;c++)h=(h+(d=l[p=(p+1)%256]))%256,l[p]=l[h],l[h]=d,o=l[(l[p]+l[h])%256],m+=String.fromCharCode(t.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var UO={print:4,modify:8,copy:16,"annot-forms":32};function Cp(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(l){if(UO.perm!==void 0)throw new Error("Invalid permission: "+l);a+=UO[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^a)),this.encryptionKey=UA(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=zA(this.encryptionKey,this.padding)}function Ep(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return t}function zO(e){if(Oa(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!a],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,n)}catch(l){En.console&&Ha.error("jsPDF PubSub Error",l.message,l)}o[1]&&a.push(s)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function I2(e){if(!(this instanceof I2))return new I2(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function lz(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Bh(e,t,r,n,a){if(!(this instanceof Bh))return new Bh(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,lz.call(this,n,a)}function Gp(e,t,r,n,a){if(!(this instanceof Gp))return new Gp(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,lz.call(this,n,a)}function bn(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;Oa(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,s=e.compress||e.compressPdf||s,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=zO;var m="1.3",g=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(O){m=O};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return b};var y=h.__private__.getPageFormat=function(O){return b[O]};a=a||"a4";var v="compat",w="advanced",_=v;function C(){this.saveGraphicsState(),W(new Ne(Se,0,0,-Se,0,Br()*Se).toString()+" cm"),this.setFontSize(this.getFontSize()/Se),u="n",_=w}function j(){this.restoreGraphicsState(),u="S",_=v}var A=h.__private__.combineFontStyleAndFontWeight=function(O,le){if(O=="bold"&&le=="normal"||O=="bold"&&le==400||O=="normal"&&le=="italic"||O=="bold"&&le=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return le&&(O=le==400||le==="normal"?O==="italic"?"italic":"normal":le!=700&&le!=="bold"||O!=="normal"?(le==700?"bold":le)+""+O:"bold"),O};h.advancedAPI=function(O){var le=_===v;return le&&C.call(this),typeof O!="function"||(O(this),le&&j.call(this)),this},h.compatAPI=function(O){var le=_===w;return le&&j.call(this),typeof O!="function"||(O(this),le&&C.call(this)),this},h.isAdvancedAPI=function(){return _===w};var M,P=function(O){if(_!==w)throw new Error(O+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},R=h.roundToPrecision=h.__private__.roundToPrecision=function(O,le){var Le=t||le;if(isNaN(O)||isNaN(Le))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return O.toFixed(Le).replace(/0+$/,"")};M=h.hpf=h.__private__.hpf=typeof c=="number"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return R(O,c)}:c==="smart"?function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return R(O,O>-1&&O<1?16:5)}:function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.hpf");return R(O,16)};var N=h.f2=h.__private__.f2=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f2");return R(O,2)},T=h.__private__.f3=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.f3");return R(O,3)},B=h.scale=h.__private__.scale=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.scale");return _===v?O*Se:_===w?O:void 0},G=function(O){return B(function(le){return _===v?Br()-le:_===w?le:void 0}(O))};h.__private__.setPrecision=h.setPrecision=function(O){typeof parseInt(O,10)=="number"&&(t=parseInt(O,10))};var re,xe="00000000000000000000000000000000",_e=h.__private__.getFileId=function(){return xe},V=h.__private__.setFileId=function(O){return xe=O!==void 0&&/^[a-fA-F0-9]{32}$/.test(O)?O.toUpperCase():xe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Rt=new Cp(d.userPermissions,d.userPassword,d.ownerPassword,xe)),xe};h.setFileId=function(O){return V(O),this},h.getFileId=function(){return _e()};var K=h.__private__.convertDateToPDFDate=function(O){var le=O.getTimezoneOffset(),Le=le<0?"+":"-",Ee=Math.floor(Math.abs(le/60)),Ze=Math.abs(le%60),lt=[Le,H(Ee),"'",H(Ze),"'"].join("");return["D:",O.getFullYear(),H(O.getMonth()+1),H(O.getDate()),H(O.getHours()),H(O.getMinutes()),H(O.getSeconds()),lt].join("")},de=h.__private__.convertPDFDateToDate=function(O){var le=parseInt(O.substr(2,4),10),Le=parseInt(O.substr(6,2),10)-1,Ee=parseInt(O.substr(8,2),10),Ze=parseInt(O.substr(10,2),10),lt=parseInt(O.substr(12,2),10),St=parseInt(O.substr(14,2),10);return new Date(le,Le,Ee,Ze,lt,St,0)},ne=h.__private__.setCreationDate=function(O){var le;if(O===void 0&&(O=new Date),O instanceof Date)le=K(O);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(O))throw new Error("Invalid argument passed to jsPDF.setCreationDate");le=O}return re=le},E=h.__private__.getCreationDate=function(O){var le=re;return O==="jsDate"&&(le=de(re)),le};h.setCreationDate=function(O){return ne(O),this},h.getCreationDate=function(O){return E(O)};var Z,H=h.__private__.padd2=function(O){return("0"+parseInt(O)).slice(-2)},F=h.__private__.padd2Hex=function(O){return("00"+(O=O.toString())).substr(O.length)},ee=0,z=[],X=[],J=0,q=[],Y=[],L=!1,U=X;h.__private__.setCustomOutputDestination=function(O){L=!0,U=O};var ce=function(O){L||(U=O)};h.__private__.resetCustomOutputDestination=function(){L=!1,U=X};var W=h.__private__.out=function(O){return O=O.toString(),J+=O.length+1,U.push(O),U},ae=h.__private__.write=function(O){return W(arguments.length===1?O.toString():Array.prototype.join.call(arguments," "))},he=h.__private__.getArrayBuffer=function(O){for(var le=O.length,Le=new ArrayBuffer(le),Ee=new Uint8Array(Le);le--;)Ee[le]=O.charCodeAt(le);return Le},ze=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return ze};var ke=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(O){return ke=_===w?O/Se:O,this};var qe,Ie=h.__private__.getFontSize=h.getFontSize=function(){return _===v?ke:ke*Se},Ve=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(O){return Ve=O,this},h.__private__.getR2L=h.getR2L=function(){return Ve};var Qe,Tt=h.__private__.setZoomMode=function(O){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(O))qe=O;else if(isNaN(O)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(O)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+O+'" is not recognized.');qe=O}else qe=parseInt(O,10)};h.__private__.getZoomMode=function(){return qe};var vt,Xe=h.__private__.setPageMode=function(O){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(O)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+O+'" is not recognized.');Qe=O};h.__private__.getPageMode=function(){return Qe};var Be=h.__private__.setLayoutMode=function(O){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(O)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+O+'" is not recognized.');vt=O};h.__private__.getLayoutMode=function(){return vt},h.__private__.setDisplayMode=h.setDisplayMode=function(O,le,Le){return Tt(O),Be(le),Xe(Le),this};var ct={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(O){if(Object.keys(ct).indexOf(O)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ct[O]},h.__private__.getDocumentProperties=function(){return ct},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(O){for(var le in ct)ct.hasOwnProperty(le)&&O[le]&&(ct[le]=O[le]);return this},h.__private__.setDocumentProperty=function(O,le){if(Object.keys(ct).indexOf(O)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ct[O]=le};var nt,Se,Te,Dt,wt,Pt={},Wt={},Ot=[],Ht={},Pr={},jt={},ur={},Ir=null,Rr=0,Nr=[],zr=new zO(h),_n=e.hotfixes||[],Yr={},pn={},ge=[],Ne=function O(le,Le,Ee,Ze,lt,St){if(!(this instanceof O))return new O(le,Le,Ee,Ze,lt,St);isNaN(le)&&(le=1),isNaN(Le)&&(Le=0),isNaN(Ee)&&(Ee=0),isNaN(Ze)&&(Ze=1),isNaN(lt)&&(lt=0),isNaN(St)&&(St=0),this._matrix=[le,Le,Ee,Ze,lt,St]};Object.defineProperty(Ne.prototype,"sx",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Ne.prototype,"shy",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Ne.prototype,"shx",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Ne.prototype,"sy",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Ne.prototype,"tx",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Ne.prototype,"ty",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Ne.prototype,"a",{get:function(){return this._matrix[0]},set:function(O){this._matrix[0]=O}}),Object.defineProperty(Ne.prototype,"b",{get:function(){return this._matrix[1]},set:function(O){this._matrix[1]=O}}),Object.defineProperty(Ne.prototype,"c",{get:function(){return this._matrix[2]},set:function(O){this._matrix[2]=O}}),Object.defineProperty(Ne.prototype,"d",{get:function(){return this._matrix[3]},set:function(O){this._matrix[3]=O}}),Object.defineProperty(Ne.prototype,"e",{get:function(){return this._matrix[4]},set:function(O){this._matrix[4]=O}}),Object.defineProperty(Ne.prototype,"f",{get:function(){return this._matrix[5]},set:function(O){this._matrix[5]=O}}),Object.defineProperty(Ne.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Ne.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Ne.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Ne.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Ne.prototype.join=function(O){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(M).join(O)},Ne.prototype.multiply=function(O){var le=O.sx*this.sx+O.shy*this.shx,Le=O.sx*this.shy+O.shy*this.sy,Ee=O.shx*this.sx+O.sy*this.shx,Ze=O.shx*this.shy+O.sy*this.sy,lt=O.tx*this.sx+O.ty*this.shx+this.tx,St=O.tx*this.shy+O.ty*this.sy+this.ty;return new Ne(le,Le,Ee,Ze,lt,St)},Ne.prototype.decompose=function(){var O=this.sx,le=this.shy,Le=this.shx,Ee=this.sy,Ze=this.tx,lt=this.ty,St=Math.sqrt(O*O+le*le),Zt=(O/=St)*Le+(le/=St)*Ee;Le-=O*Zt,Ee-=le*Zt;var tr=Math.sqrt(Le*Le+Ee*Ee);return Zt/=tr,O*(Ee/=tr)<le*(Le/=tr)&&(O=-O,le=-le,Zt=-Zt,St=-St),{scale:new Ne(St,0,0,tr,0,0),translate:new Ne(1,0,0,1,Ze,lt),rotate:new Ne(O,le,-le,O,0,0),skew:new Ne(1,0,Zt,1,0,0)}},Ne.prototype.toString=function(O){return this.join(" ")},Ne.prototype.inversed=function(){var O=this.sx,le=this.shy,Le=this.shx,Ee=this.sy,Ze=this.tx,lt=this.ty,St=1/(O*Ee-le*Le),Zt=Ee*St,tr=-le*St,jr=-Le*St,zt=O*St;return new Ne(Zt,tr,jr,zt,-Zt*Ze-jr*lt,-tr*Ze-zt*lt)},Ne.prototype.applyToPoint=function(O){var le=O.x*this.sx+O.y*this.shx+this.tx,Le=O.x*this.shy+O.y*this.sy+this.ty;return new yt(le,Le)},Ne.prototype.applyToRectangle=function(O){var le=this.applyToPoint(O),Le=this.applyToPoint(new yt(O.x+O.w,O.y+O.h));return new fe(le.x,le.y,Le.x-le.x,Le.y-le.y)},Ne.prototype.clone=function(){var O=this.sx,le=this.shy,Le=this.shx,Ee=this.sy,Ze=this.tx,lt=this.ty;return new Ne(O,le,Le,Ee,Ze,lt)},h.Matrix=Ne;var dt=h.matrixMult=function(O,le){return le.multiply(O)},Ue=new Ne(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Ue;var Re=function(O,le){if(!Pr[O]){var Le=(le instanceof Bh?"Sh":"P")+(Object.keys(Ht).length+1).toString(10);le.id=Le,Pr[O]=Le,Ht[Le]=le,zr.publish("addPattern",le)}};h.ShadingPattern=Bh,h.TilingPattern=Gp,h.addShadingPattern=function(O,le){return P("addShadingPattern()"),Re(O,le),this},h.beginTilingPattern=function(O){P("beginTilingPattern()"),He(O.boundingBox[0],O.boundingBox[1],O.boundingBox[2]-O.boundingBox[0],O.boundingBox[3]-O.boundingBox[1],O.matrix)},h.endTilingPattern=function(O,le){P("endTilingPattern()"),le.stream=Y[Z].join(`
`),Re(O,le),zr.publish("endTilingPattern",le),ge.pop().restore()};var xt,at=h.__private__.newObject=function(){var O=er();return oe(O,!0),O},er=h.__private__.newObjectDeferred=function(){return ee++,z[ee]=function(){return J},ee},oe=function(O,le){return le=typeof le=="boolean"&&le,z[O]=J,le&&W(O+" 0 obj"),O},ue=h.__private__.newAdditionalObject=function(){var O={objId:er(),content:""};return q.push(O),O},Q=er(),ye=er(),je=h.__private__.decodeColorString=function(O){var le=O.split(" ");if(le.length!==2||le[1]!=="g"&&le[1]!=="G")le.length!==5||le[4]!=="k"&&le[4]!=="K"||(le=[(1-le[0])*(1-le[3]),(1-le[1])*(1-le[3]),(1-le[2])*(1-le[3]),"r"]);else{var Le=parseFloat(le[0]);le=[Le,Le,Le,"r"]}for(var Ee="#",Ze=0;Ze<3;Ze++)Ee+=("0"+Math.floor(255*parseFloat(le[Ze])).toString(16)).slice(-2);return Ee},Ce=h.__private__.encodeColorString=function(O){var le;typeof O=="string"&&(O={ch1:O});var Le=O.ch1,Ee=O.ch2,Ze=O.ch3,lt=O.ch4,St=O.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Le=="string"&&Le.charAt(0)!=="#"){var Zt=new sz(Le);if(Zt.ok)Le=Zt.toHex();else if(!/^\d*\.?\d*$/.test(Le))throw new Error('Invalid color "'+Le+'" passed to jsPDF.encodeColorString.')}if(typeof Le=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Le)&&(Le="#"+Le[1]+Le[1]+Le[2]+Le[2]+Le[3]+Le[3]),typeof Le=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Le)){var tr=parseInt(Le.substr(1),16);Le=tr>>16&255,Ee=tr>>8&255,Ze=255&tr}if(Ee===void 0||lt===void 0&&Le===Ee&&Ee===Ze)le=typeof Le=="string"?Le+" "+St[0]:O.precision===2?N(Le/255)+" "+St[0]:T(Le/255)+" "+St[0];else if(lt===void 0||Oa(lt)==="object"){if(lt&&!isNaN(lt.a)&&lt.a===0)return["1.","1.","1.",St[1]].join(" ");le=typeof Le=="string"?[Le,Ee,Ze,St[1]].join(" "):O.precision===2?[N(Le/255),N(Ee/255),N(Ze/255),St[1]].join(" "):[T(Le/255),T(Ee/255),T(Ze/255),St[1]].join(" ")}else le=typeof Le=="string"?[Le,Ee,Ze,lt,St[2]].join(" "):O.precision===2?[N(Le),N(Ee),N(Ze),N(lt),St[2]].join(" "):[T(Le),T(Ee),T(Ze),T(lt),St[2]].join(" ");return le},ot=h.__private__.getFilters=function(){return o},it=h.__private__.putStream=function(O){var le=(O=O||{}).data||"",Le=O.filters||ot(),Ee=O.alreadyAppliedFilters||[],Ze=O.addLength1||!1,lt=le.length,St=O.objectId,Zt=function(Gn){return Gn};if(d!==null&&St===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Zt=Rt.encryptor(St,0));var tr={};Le===!0&&(Le=["FlateEncode"]);var jr=O.additionalKeyValues||[],zt=(tr=bn.API.processDataByFilters!==void 0?bn.API.processDataByFilters(le,Le):{data:le,reverseChain:[]}).reverseChain+(Array.isArray(Ee)?Ee.join(" "):Ee.toString());if(tr.data.length!==0&&(jr.push({key:"Length",value:tr.data.length}),Ze===!0&&jr.push({key:"Length1",value:lt})),zt.length!=0)if(zt.split("/").length-1==1)jr.push({key:"Filter",value:zt});else{jr.push({key:"Filter",value:"["+zt+"]"});for(var dr=0;dr<jr.length;dr+=1)if(jr[dr].key==="DecodeParms"){for(var en=[],mn=0;mn<tr.reverseChain.split("/").length-1;mn+=1)en.push("null");en.push(jr[dr].value),jr[dr].value="["+en.join(" ")+"]"}}W("<<");for(var vn=0;vn<jr.length;vn++)W("/"+jr[vn].key+" "+jr[vn].value);W(">>"),tr.data.length!==0&&(W("stream"),W(Zt(tr.data)),W("endstream"))},We=h.__private__.putPage=function(O){var le=O.number,Le=O.data,Ee=O.objId,Ze=O.contentsObjId;oe(Ee,!0),W("<</Type /Page"),W("/Parent "+O.rootDictionaryObjId+" 0 R"),W("/Resources "+O.resourceDictionaryObjId+" 0 R"),W("/MediaBox ["+parseFloat(M(O.mediaBox.bottomLeftX))+" "+parseFloat(M(O.mediaBox.bottomLeftY))+" "+M(O.mediaBox.topRightX)+" "+M(O.mediaBox.topRightY)+"]"),O.cropBox!==null&&W("/CropBox ["+M(O.cropBox.bottomLeftX)+" "+M(O.cropBox.bottomLeftY)+" "+M(O.cropBox.topRightX)+" "+M(O.cropBox.topRightY)+"]"),O.bleedBox!==null&&W("/BleedBox ["+M(O.bleedBox.bottomLeftX)+" "+M(O.bleedBox.bottomLeftY)+" "+M(O.bleedBox.topRightX)+" "+M(O.bleedBox.topRightY)+"]"),O.trimBox!==null&&W("/TrimBox ["+M(O.trimBox.bottomLeftX)+" "+M(O.trimBox.bottomLeftY)+" "+M(O.trimBox.topRightX)+" "+M(O.trimBox.topRightY)+"]"),O.artBox!==null&&W("/ArtBox ["+M(O.artBox.bottomLeftX)+" "+M(O.artBox.bottomLeftY)+" "+M(O.artBox.topRightX)+" "+M(O.artBox.topRightY)+"]"),typeof O.userUnit=="number"&&O.userUnit!==1&&W("/UserUnit "+O.userUnit),zr.publish("putPage",{objId:Ee,pageContext:Nr[le],pageNumber:le,page:Le}),W("/Contents "+Ze+" 0 R"),W(">>"),W("endobj");var lt=Le.join(`
`);return _===w&&(lt+=`
Q`),oe(Ze,!0),it({data:lt,filters:ot(),objectId:Ze}),W("endobj"),Ee},De=h.__private__.putPages=function(){var O,le,Le=[];for(O=1;O<=Rr;O++)Nr[O].objId=er(),Nr[O].contentsObjId=er();for(O=1;O<=Rr;O++)Le.push(We({number:O,data:Y[O],objId:Nr[O].objId,contentsObjId:Nr[O].contentsObjId,mediaBox:Nr[O].mediaBox,cropBox:Nr[O].cropBox,bleedBox:Nr[O].bleedBox,trimBox:Nr[O].trimBox,artBox:Nr[O].artBox,userUnit:Nr[O].userUnit,rootDictionaryObjId:Q,resourceDictionaryObjId:ye}));oe(Q,!0),W("<</Type /Pages");var Ee="/Kids [";for(le=0;le<Rr;le++)Ee+=Le[le]+" 0 R ";W(Ee+"]"),W("/Count "+Rr),W(">>"),W("endobj"),zr.publish("postPutPages")},pe=function(O){zr.publish("putFont",{font:O,out:W,newObject:at,putStream:it}),O.isAlreadyPutted!==!0&&(O.objectNumber=at(),W("<<"),W("/Type /Font"),W("/BaseFont /"+Ep(O.postScriptName)),W("/Subtype /Type1"),typeof O.encoding=="string"&&W("/Encoding /"+O.encoding),W("/FirstChar 32"),W("/LastChar 255"),W(">>"),W("endobj"))},Je=function(O){O.objectNumber=at();var le=[];le.push({key:"Type",value:"/XObject"}),le.push({key:"Subtype",value:"/Form"}),le.push({key:"BBox",value:"["+[M(O.x),M(O.y),M(O.x+O.width),M(O.y+O.height)].join(" ")+"]"}),le.push({key:"Matrix",value:"["+O.matrix.toString()+"]"});var Le=O.pages[1].join(`
`);it({data:Le,additionalKeyValues:le,objectId:O.objectNumber}),W("endobj")},Ge=function(O,le){le||(le=21);var Le=at(),Ee=function(St,Zt){var tr,jr=[],zt=1/(Zt-1);for(tr=0;tr<1;tr+=zt)jr.push(tr);if(jr.push(1),St[0].offset!=0){var dr={offset:0,color:St[0].color};St.unshift(dr)}if(St[St.length-1].offset!=1){var en={offset:1,color:St[St.length-1].color};St.push(en)}for(var mn="",vn=0,Gn=0;Gn<jr.length;Gn++){for(tr=jr[Gn];tr>St[vn+1].offset;)vn++;var Fn=St[vn].offset,On=(tr-Fn)/(St[vn+1].offset-Fn),Jn=St[vn].color,Kn=St[vn+1].color;mn+=F(Math.round((1-On)*Jn[0]+On*Kn[0]).toString(16))+F(Math.round((1-On)*Jn[1]+On*Kn[1]).toString(16))+F(Math.round((1-On)*Jn[2]+On*Kn[2]).toString(16))}return mn.trim()}(O.colors,le),Ze=[];Ze.push({key:"FunctionType",value:"0"}),Ze.push({key:"Domain",value:"[0.0 1.0]"}),Ze.push({key:"Size",value:"["+le+"]"}),Ze.push({key:"BitsPerSample",value:"8"}),Ze.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ze.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),it({data:Ee,additionalKeyValues:Ze,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Le}),W("endobj"),O.objectNumber=at(),W("<< /ShadingType "+O.type),W("/ColorSpace /DeviceRGB");var lt="/Coords ["+M(parseFloat(O.coords[0]))+" "+M(parseFloat(O.coords[1]))+" ";O.type===2?lt+=M(parseFloat(O.coords[2]))+" "+M(parseFloat(O.coords[3])):lt+=M(parseFloat(O.coords[2]))+" "+M(parseFloat(O.coords[3]))+" "+M(parseFloat(O.coords[4]))+" "+M(parseFloat(O.coords[5])),W(lt+="]"),O.matrix&&W("/Matrix ["+O.matrix.toString()+"]"),W("/Function "+Le+" 0 R"),W("/Extend [true true]"),W(">>"),W("endobj")},Ye=function(O,le){var Le=er(),Ee=at();le.push({resourcesOid:Le,objectOid:Ee}),O.objectNumber=Ee;var Ze=[];Ze.push({key:"Type",value:"/Pattern"}),Ze.push({key:"PatternType",value:"1"}),Ze.push({key:"PaintType",value:"1"}),Ze.push({key:"TilingType",value:"1"}),Ze.push({key:"BBox",value:"["+O.boundingBox.map(M).join(" ")+"]"}),Ze.push({key:"XStep",value:M(O.xStep)}),Ze.push({key:"YStep",value:M(O.yStep)}),Ze.push({key:"Resources",value:Le+" 0 R"}),O.matrix&&Ze.push({key:"Matrix",value:"["+O.matrix.toString()+"]"}),it({data:O.stream,additionalKeyValues:Ze,objectId:O.objectNumber}),W("endobj")},ft=function(O){for(var le in O.objectNumber=at(),W("<<"),O)switch(le){case"opacity":W("/ca "+N(O[le]));break;case"stroke-opacity":W("/CA "+N(O[le]))}W(">>"),W("endobj")},bt=function(O){oe(O.resourcesOid,!0),W("<<"),W("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var le in W("/Font <<"),Pt)Pt.hasOwnProperty(le)&&(f===!1||f===!0&&p.hasOwnProperty(le))&&W("/"+le+" "+Pt[le].objectNumber+" 0 R");W(">>")}(),function(){if(Object.keys(Ht).length>0){for(var le in W("/Shading <<"),Ht)Ht.hasOwnProperty(le)&&Ht[le]instanceof Bh&&Ht[le].objectNumber>=0&&W("/"+le+" "+Ht[le].objectNumber+" 0 R");zr.publish("putShadingPatternDict"),W(">>")}}(),function(le){if(Object.keys(Ht).length>0){for(var Le in W("/Pattern <<"),Ht)Ht.hasOwnProperty(Le)&&Ht[Le]instanceof h.TilingPattern&&Ht[Le].objectNumber>=0&&Ht[Le].objectNumber<le&&W("/"+Le+" "+Ht[Le].objectNumber+" 0 R");zr.publish("putTilingPatternDict"),W(">>")}}(O.objectOid),function(){if(Object.keys(jt).length>0){var le;for(le in W("/ExtGState <<"),jt)jt.hasOwnProperty(le)&&jt[le].objectNumber>=0&&W("/"+le+" "+jt[le].objectNumber+" 0 R");zr.publish("putGStateDict"),W(">>")}}(),function(){for(var le in W("/XObject <<"),Yr)Yr.hasOwnProperty(le)&&Yr[le].objectNumber>=0&&W("/"+le+" "+Yr[le].objectNumber+" 0 R");zr.publish("putXobjectDict"),W(">>")}(),W(">>"),W("endobj")},Vt=function(O){Wt[O.fontName]=Wt[O.fontName]||{},Wt[O.fontName][O.fontStyle]=O.id},Ft=function(O,le,Le,Ee,Ze){var lt={id:"F"+(Object.keys(Pt).length+1).toString(10),postScriptName:O,fontName:le,fontStyle:Le,encoding:Ee,isStandardFont:Ze||!1,metadata:{}};return zr.publish("addFont",{font:lt,instance:this}),Pt[lt.id]=lt,Vt(lt),lt.id},gr=h.__private__.pdfEscape=h.pdfEscape=function(O,le){return function(Le,Ee){var Ze,lt,St,Zt,tr,jr,zt,dr,en;if(St=(Ee=Ee||{}).sourceEncoding||"Unicode",tr=Ee.outputEncoding,(Ee.autoencode||tr)&&Pt[nt].metadata&&Pt[nt].metadata[St]&&Pt[nt].metadata[St].encoding&&(Zt=Pt[nt].metadata[St].encoding,!tr&&Pt[nt].encoding&&(tr=Pt[nt].encoding),!tr&&Zt.codePages&&(tr=Zt.codePages[0]),typeof tr=="string"&&(tr=Zt[tr]),tr)){for(zt=!1,jr=[],Ze=0,lt=Le.length;Ze<lt;Ze++)(dr=tr[Le.charCodeAt(Ze)])?jr.push(String.fromCharCode(dr)):jr.push(Le[Ze]),jr[Ze].charCodeAt(0)>>8&&(zt=!0);Le=jr.join("")}for(Ze=Le.length;zt===void 0&&Ze!==0;)Le.charCodeAt(Ze-1)>>8&&(zt=!0),Ze--;if(!zt)return Le;for(jr=Ee.noBOM?[]:[254,255],Ze=0,lt=Le.length;Ze<lt;Ze++){if((en=(dr=Le.charCodeAt(Ze))>>8)>>8)throw new Error("Character at position "+Ze+" of string '"+Le+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");jr.push(en),jr.push(dr-(en<<8))}return String.fromCharCode.apply(void 0,jr)}(O,le).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ar=h.__private__.beginPage=function(O){Y[++Rr]=[],Nr[Rr]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(O[0]),topRightY:Number(O[1])}},Ut(Rr),ce(Y[Z])},kr=function(O,le){var Le,Ee,Ze;switch(r=le||r,typeof O=="string"&&(Le=y(O.toLowerCase()),Array.isArray(Le)&&(Ee=Le[0],Ze=Le[1])),Array.isArray(O)&&(Ee=O[0]*Se,Ze=O[1]*Se),isNaN(Ee)&&(Ee=a[0],Ze=a[1]),(Ee>14400||Ze>14400)&&(Ha.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ee=Math.min(14400,Ee),Ze=Math.min(14400,Ze)),a=[Ee,Ze],r.substr(0,1)){case"l":Ze>Ee&&(a=[Ze,Ee]);break;case"p":Ee>Ze&&(a=[Ze,Ee])}Ar(a),mt(Sr),W(Qr),ta!==0&&W(ta+" J"),Tn!==0&&W(Tn+" j"),zr.publish("addPage",{pageNumber:Rr})},At=function(O){O>0&&O<=Rr&&(Y.splice(O,1),Nr.splice(O,1),Rr--,Z>Rr&&(Z=Rr),this.setPage(Z))},Ut=function(O){O>0&&O<=Rr&&(Z=O)},Kr=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Y.length-1},$t=function(O,le,Le){var Ee,Ze=void 0;return Le=Le||{},O=O!==void 0?O:Pt[nt].fontName,le=le!==void 0?le:Pt[nt].fontStyle,Ee=O.toLowerCase(),Wt[Ee]!==void 0&&Wt[Ee][le]!==void 0?Ze=Wt[Ee][le]:Wt[O]!==void 0&&Wt[O][le]!==void 0?Ze=Wt[O][le]:Le.disableWarning===!1&&Ha.warn("Unable to look up font label for font '"+O+"', '"+le+"'. Refer to getFontList() for available fonts."),Ze||Le.noFallback||(Ze=Wt.times[le])==null&&(Ze=Wt.times.normal),Ze},fr=h.__private__.putInfo=function(){var O=at(),le=function(Ee){return Ee};for(var Le in d!==null&&(le=Rt.encryptor(O,0)),W("<<"),W("/Producer ("+gr(le("jsPDF "+bn.version))+")"),ct)ct.hasOwnProperty(Le)&&ct[Le]&&W("/"+Le.substr(0,1).toUpperCase()+Le.substr(1)+" ("+gr(le(ct[Le]))+")");W("/CreationDate ("+gr(le(re))+")"),W(">>"),W("endobj")},Or=h.__private__.putCatalog=function(O){var le=(O=O||{}).rootDictionaryObjId||Q;switch(at(),W("<<"),W("/Type /Catalog"),W("/Pages "+le+" 0 R"),qe||(qe="fullwidth"),qe){case"fullwidth":W("/OpenAction [3 0 R /FitH null]");break;case"fullheight":W("/OpenAction [3 0 R /FitV null]");break;case"fullpage":W("/OpenAction [3 0 R /Fit]");break;case"original":W("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Le=""+qe;Le.substr(Le.length-1)==="%"&&(qe=parseInt(qe)/100),typeof qe=="number"&&W("/OpenAction [3 0 R /XYZ null null "+N(qe)+"]")}switch(vt||(vt="continuous"),vt){case"continuous":W("/PageLayout /OneColumn");break;case"single":W("/PageLayout /SinglePage");break;case"two":case"twoleft":W("/PageLayout /TwoColumnLeft");break;case"tworight":W("/PageLayout /TwoColumnRight")}Qe&&W("/PageMode /"+Qe),zr.publish("putCatalog"),W(">>"),W("endobj")},gt=h.__private__.putTrailer=function(){W("trailer"),W("<<"),W("/Size "+(ee+1)),W("/Root "+ee+" 0 R"),W("/Info "+(ee-1)+" 0 R"),d!==null&&W("/Encrypt "+Rt.oid+" 0 R"),W("/ID [ <"+xe+"> <"+xe+"> ]"),W(">>")},Jt=h.__private__.putHeader=function(){W("%PDF-"+m),W("%")},ht=h.__private__.putXRef=function(){var O="0000000000";W("xref"),W("0 "+(ee+1)),W("0000000000 65535 f ");for(var le=1;le<=ee;le++)typeof z[le]=="function"?W((O+z[le]()).slice(-10)+" 00000 n "):z[le]!==void 0?W((O+z[le]).slice(-10)+" 00000 n "):W("0000000000 00000 n ")},Ct=h.__private__.buildDocument=function(){var O;ee=0,J=0,X=[],z=[],q=[],Q=er(),ye=er(),ce(X),zr.publish("buildDocument"),Jt(),De(),function(){zr.publish("putAdditionalObjects");for(var Le=0;Le<q.length;Le++){var Ee=q[Le];oe(Ee.objId,!0),W(Ee.content),W("endobj")}zr.publish("postPutAdditionalObjects")}(),O=[],function(){for(var Le in Pt)Pt.hasOwnProperty(Le)&&(f===!1||f===!0&&p.hasOwnProperty(Le))&&pe(Pt[Le])}(),function(){var Le;for(Le in jt)jt.hasOwnProperty(Le)&&ft(jt[Le])}(),function(){for(var Le in Yr)Yr.hasOwnProperty(Le)&&Je(Yr[Le])}(),function(Le){var Ee;for(Ee in Ht)Ht.hasOwnProperty(Ee)&&(Ht[Ee]instanceof Bh?Ge(Ht[Ee]):Ht[Ee]instanceof Gp&&Ye(Ht[Ee],Le))}(O),zr.publish("putResources"),O.forEach(bt),bt({resourcesOid:ye,objectOid:Number.MAX_SAFE_INTEGER}),zr.publish("postPutResources"),d!==null&&(Rt.oid=at(),W("<<"),W("/Filter /Standard"),W("/V "+Rt.v),W("/R "+Rt.r),W("/U <"+Rt.toHexString(Rt.U)+">"),W("/O <"+Rt.toHexString(Rt.O)+">"),W("/P "+Rt.P),W(">>"),W("endobj")),fr(),Or();var le=J;return ht(),gt(),W("startxref"),W(""+le),W("%%EOF"),ce(Y[Z]),X.join(`
`)},rr=h.__private__.getBlob=function(O){return new Blob([he(O)],{type:"application/pdf"})},kt=h.output=h.__private__.output=(xt=function(O,le){switch(typeof(le=le||{})=="string"?le={filename:le}:le.filename=le.filename||"generated.pdf",O){case void 0:return Ct();case"save":h.save(le.filename);break;case"arraybuffer":return he(Ct());case"blob":return rr(Ct());case"bloburi":case"bloburl":if(En.URL!==void 0&&typeof En.URL.createObjectURL=="function")return En.URL&&En.URL.createObjectURL(rr(Ct()))||void 0;Ha.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Le="",Ee=Ct();try{Le=DO(Ee)}catch{Le=DO(unescape(encodeURIComponent(Ee)))}return"data:application/pdf;filename="+le.filename+";base64,"+Le;case"pdfobjectnewwindow":if(Object.prototype.toString.call(En)==="[object Window]"){var Ze="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",lt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';le.pdfObjectUrl&&(Ze=le.pdfObjectUrl,lt="");var St='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ze+'"'+lt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(le)+");<\/script></body></html>",Zt=En.open();return Zt!==null&&Zt.document.write(St),Zt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(En)==="[object Window]"){var tr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(le.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+le.filename+'" width="500px" height="400px" /></body></html>',jr=En.open();if(jr!==null){jr.document.write(tr);var zt=this;jr.document.documentElement.querySelector("#pdfViewer").onload=function(){jr.document.title=le.filename,jr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(zt.output("bloburl"))}}return jr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(En)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var dr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",le)+'"></iframe></body></html>',en=En.open();if(en!==null&&(en.document.write(dr),en.document.title=le.filename),en||typeof safari>"u")return en;break;case"datauri":case"dataurl":return En.document.location.href=this.output("datauristring",le);default:return null}},xt.foo=function(){try{return xt.apply(this,arguments)}catch(Le){var O=Le.stack||"";~O.indexOf(" at ")&&(O=O.split(" at ")[1]);var le="Error in function "+O.split(`
`)[0].split("<")[0]+": "+Le.message;if(!En.console)throw new Error(le);En.console.error(le,Le),En.alert&&alert(le)}},xt.foo.bar=xt,xt.foo),rt=function(O){return Array.isArray(_n)===!0&&_n.indexOf(O)>-1};switch(n){case"pt":Se=1;break;case"mm":Se=72/25.4;break;case"cm":Se=72/2.54;break;case"in":Se=72;break;case"px":Se=rt("px_scaling")==1?.75:96/72;break;case"pc":case"em":Se=12;break;case"ex":Se=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Se=n}var Rt=null;ne(),V();var Gt=h.__private__.getPageInfo=h.getPageInfo=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Nr[O].objId,pageNumber:O,pageContext:Nr[O]}},ir=h.__private__.getPageInfoByObjId=function(O){if(isNaN(O)||O%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var le in Nr)if(Nr[le].objId===O)break;return Gt(le)},Bt=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Nr[Z].objId,pageNumber:Z,pageContext:Nr[Z]}};h.addPage=function(){return kr.apply(this,arguments),this},h.setPage=function(){return Ut.apply(this,arguments),ce.call(this,Y[Z]),this},h.insertPage=function(O){return this.addPage(),this.movePage(Z,O),this},h.movePage=function(O,le){var Le,Ee;if(O>le){Le=Y[O],Ee=Nr[O];for(var Ze=O;Ze>le;Ze--)Y[Ze]=Y[Ze-1],Nr[Ze]=Nr[Ze-1];Y[le]=Le,Nr[le]=Ee,this.setPage(le)}else if(O<le){Le=Y[O],Ee=Nr[O];for(var lt=O;lt<le;lt++)Y[lt]=Y[lt+1],Nr[lt]=Nr[lt+1];Y[le]=Le,Nr[le]=Ee,this.setPage(le)}return this},h.deletePage=function(){return At.apply(this,arguments),this},h.__private__.text=h.text=function(O,le,Le,Ee,Ze){var lt,St,Zt,tr,jr,zt,dr,en,mn,vn=(Ee=Ee||{}).scope||this;if(typeof O=="number"&&typeof le=="number"&&(typeof Le=="string"||Array.isArray(Le))){var Gn=Le;Le=le,le=O,O=Gn}if(arguments[3]instanceof Ne==0?(Zt=arguments[4],tr=arguments[5],Oa(dr=arguments[3])==="object"&&dr!==null||(typeof Zt=="string"&&(tr=Zt,Zt=null),typeof dr=="string"&&(tr=dr,dr=null),typeof dr=="number"&&(Zt=dr,dr=null),Ee={flags:dr,angle:Zt,align:tr})):(P("The transform parameter of text() with a Matrix value"),mn=Ze),isNaN(le)||isNaN(Le)||O==null)throw new Error("Invalid arguments passed to jsPDF.text");if(O.length===0)return vn;var Fn,On="",Jn=typeof Ee.lineHeightFactor=="number"?Ee.lineHeightFactor:Lt,Kn=vn.internal.scaleFactor;function wa(Sa){return Sa=Sa.split("	").join(Array(Ee.TabLen||9).join(" ")),gr(Sa,dr)}function es(Sa){for(var Wa,zi=Sa.concat(),ps=[],td=zi.length;td--;)typeof(Wa=zi.shift())=="string"?ps.push(Wa):Array.isArray(Sa)&&(Wa.length===1||Wa[1]===void 0&&Wa[2]===void 0)?ps.push(Wa[0]):ps.push([Wa[0],Wa[1],Wa[2]]);return ps}function Ya(Sa,Wa){var zi;if(typeof Sa=="string")zi=Wa(Sa)[0];else if(Array.isArray(Sa)){for(var ps,td,pg=Sa.concat(),rp=[],Py=pg.length;Py--;)typeof(ps=pg.shift())=="string"?rp.push(Wa(ps)[0]):Array.isArray(ps)&&typeof ps[0]=="string"&&(td=Wa(ps[0],ps[1],ps[2]),rp.push([td[0],td[1],td[2]]));zi=rp}return zi}var ra=!1,Yn=!0;if(typeof O=="string")ra=!0;else if(Array.isArray(O)){var Ra=O.concat();St=[];for(var ja,dn=Ra.length;dn--;)(typeof(ja=Ra.shift())!="string"||Array.isArray(ja)&&typeof ja[0]!="string")&&(Yn=!1);ra=Yn}if(ra===!1)throw new Error('Type of text must be string or Array. "'+O+'" is not recognized.');typeof O=="string"&&(O=O.match(/[\r?\n]/)?O.split(/\r\n|\r|\n/g):[O]);var fi=ke/vn.internal.scaleFactor,$i=fi*(Jn-1);switch(Ee.baseline){case"bottom":Le-=$i;break;case"top":Le+=fi-$i;break;case"hanging":Le+=fi-2*$i;break;case"middle":Le+=fi/2-$i}if((zt=Ee.maxWidth||0)>0&&(typeof O=="string"?O=vn.splitTextToSize(O,zt):Object.prototype.toString.call(O)==="[object Array]"&&(O=O.reduce(function(Sa,Wa){return Sa.concat(vn.splitTextToSize(Wa,zt))},[]))),lt={text:O,x:le,y:Le,options:Ee,mutex:{pdfEscape:gr,activeFontKey:nt,fonts:Pt,activeFontSize:ke}},zr.publish("preProcessText",lt),O=lt.text,Zt=(Ee=lt.options).angle,mn instanceof Ne==0&&Zt&&typeof Zt=="number"){Zt*=Math.PI/180,Ee.rotationDirection===0&&(Zt=-Zt),_===w&&(Zt=-Zt);var ts=Math.cos(Zt),Ui=Math.sin(Zt);mn=new Ne(ts,Ui,-Ui,ts,0,0)}else Zt&&Zt instanceof Ne&&(mn=Zt);_!==w||mn||(mn=Ue),(jr=Ee.charSpace||ma)!==void 0&&(On+=M(B(jr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(en=Ee.horizontalScale)!==void 0&&(On+=M(100*en)+` Tz
`),Ee.lang;var xa=-1,Yo=Ee.renderingMode!==void 0?Ee.renderingMode:Ee.stroke,rf=vn.internal.getCurrentPageInfo().pageContext;switch(Yo){case 0:case!1:case"fill":xa=0;break;case 1:case!0:case"stroke":xa=1;break;case 2:case"fillThenStroke":xa=2;break;case 3:case"invisible":xa=3;break;case 4:case"fillAndAddForClipping":xa=4;break;case 5:case"strokeAndAddPathForClipping":xa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":xa=6;break;case 7:case"addToPathForClipping":xa=7}var tp=rf.usedRenderingMode!==void 0?rf.usedRenderingMode:-1;xa!==-1?On+=xa+` Tr
`:tp!==-1&&(On+=`0 Tr
`),xa!==-1&&(rf.usedRenderingMode=xa),tr=Ee.align||"left";var Qo,Zu=ke*Jn,vh=vn.internal.pageSize.getWidth(),wh=Pt[nt];jr=Ee.charSpace||ma,zt=Ee.maxWidth||0,dr=Object.assign({autoencode:!0,noBOM:!0},Ee.flags);var cu=[],ed=function(Sa){return vn.getStringUnitWidth(Sa,{font:wh,charSpace:jr,fontSize:ke,doKerning:!1})*ke/Kn};if(Object.prototype.toString.call(O)==="[object Array]"){var Oo;St=es(O),tr!=="left"&&(Qo=St.map(ed));var Cs,Ec=0;if(tr==="right"){le-=Qo[0],O=[],dn=St.length;for(var Gl=0;Gl<dn;Gl++)Gl===0?(Cs=pr(le),Oo=Dr(Le)):(Cs=B(Ec-Qo[Gl]),Oo=-Zu),O.push([St[Gl],Cs,Oo]),Ec=Qo[Gl]}else if(tr==="center"){le-=Qo[0]/2,O=[],dn=St.length;for(var Tc=0;Tc<dn;Tc++)Tc===0?(Cs=pr(le),Oo=Dr(Le)):(Cs=B((Ec-Qo[Tc])/2),Oo=-Zu),O.push([St[Tc],Cs,Oo]),Ec=Qo[Tc]}else if(tr==="left"){O=[],dn=St.length;for(var nf=0;nf<dn;nf++)O.push(St[nf])}else if(tr==="justify"&&wh.encoding==="Identity-H"){O=[],dn=St.length,zt=zt!==0?zt:vh;for(var Sh=0,Ba=0;Ba<dn;Ba++)if(Oo=Ba===0?Dr(Le):-Zu,Cs=Ba===0?pr(le):Sh,Ba<dn-1){var za=B((zt-Qo[Ba])/(St[Ba].split(" ").length-1)),ki=St[Ba].split(" ");O.push([ki[0]+" ",Cs,Oo]),Sh=0;for(var Jo=1;Jo<ki.length;Jo++){var _h=(ed(ki[Jo-1]+" "+ki[Jo])-ed(ki[Jo]))*Kn+za;Jo==ki.length-1?O.push([ki[Jo],_h,0]):O.push([ki[Jo]+" ",_h,0]),Sh-=_h}}else O.push([St[Ba],Cs,Oo]);O.push(["",Sh,0])}else{if(tr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(O=[],dn=St.length,zt=zt!==0?zt:vh,Ba=0;Ba<dn;Ba++){Oo=Ba===0?Dr(Le):-Zu,Cs=Ba===0?pr(le):0;var kh=St[Ba].split(" ").length-1,jh=kh>0?(zt-Qo[Ba])/kh:0;Ba<dn-1?cu.push(M(B(jh))):cu.push(0),O.push([St[Ba],Cs,Oo])}}}(typeof Ee.R2L=="boolean"?Ee.R2L:Ve)===!0&&(O=Ya(O,function(Sa,Wa,zi){return[Sa.split("").reverse().join(""),Wa,zi]})),lt={text:O,x:le,y:Le,options:Ee,mutex:{pdfEscape:gr,activeFontKey:nt,fonts:Pt,activeFontSize:ke}},zr.publish("postProcessText",lt),O=lt.text,Fn=lt.mutex.isHex||!1;var af=Pt[nt].encoding;af!=="WinAnsiEncoding"&&af!=="StandardEncoding"||(O=Ya(O,function(Sa,Wa,zi){return[wa(Sa),Wa,zi]})),St=es(O),O=[];for(var Pc,Kl,Xl,uu=Array.isArray(St[0])?1:0,Oc="",du=function(Sa,Wa,zi){var ps="";return zi instanceof Ne?(zi=typeof Ee.angle=="number"?dt(zi,new Ne(1,0,0,1,Sa,Wa)):dt(new Ne(1,0,0,1,Sa,Wa),zi),_===w&&(zi=dt(new Ne(1,0,0,-1,0,0),zi)),ps=zi.join(" ")+` Tm
`):ps=M(Sa)+" "+M(Wa)+` Td
`,ps},Yl=0;Yl<St.length;Yl++){switch(Oc="",uu){case 1:Xl=(Fn?"<":"(")+St[Yl][0]+(Fn?">":")"),Pc=parseFloat(St[Yl][1]),Kl=parseFloat(St[Yl][2]);break;case 0:Xl=(Fn?"<":"(")+St[Yl]+(Fn?">":")"),Pc=pr(le),Kl=Dr(Le)}cu!==void 0&&cu[Yl]!==void 0&&(Oc=cu[Yl]+` Tw
`),Yl===0?O.push(Oc+du(Pc,Kl,mn)+Xl):uu===0?O.push(Oc+Xl):uu===1&&O.push(Oc+du(Pc,Kl,mn)+Xl)}O=uu===0?O.join(` Tj
T* `):O.join(` Tj
`),O+=` Tj
`;var fu=`BT
/`;return fu+=nt+" "+ke+` Tf
`,fu+=M(ke*Jn)+` TL
`,fu+=gn+`
`,fu+=On,fu+=O,W(fu+="ET"),p[nt]=!0,vn};var vr=h.__private__.clip=h.clip=function(O){return W(O==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return vr("evenodd")},h.__private__.discardPath=h.discardPath=function(){return W("n"),this};var Cr=h.__private__.isValidStyle=function(O){var le=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(O)!==-1&&(le=!0),le};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(O){return Cr(O)&&(u=O),this};var Tr=h.__private__.getStyle=h.getStyle=function(O){var le=u;switch(O){case"D":case"S":le="S";break;case"F":le="f";break;case"FD":case"DF":le="B";break;case"f":case"f*":case"B":case"B*":le=O}return le},xr=h.close=function(){return W("h"),this};h.stroke=function(){return W("S"),this},h.fill=function(O){return Xt("f",O),this},h.fillEvenOdd=function(O){return Xt("f*",O),this},h.fillStroke=function(O){return Xt("B",O),this},h.fillStrokeEvenOdd=function(O){return Xt("B*",O),this};var Xt=function(O,le){Oa(le)==="object"?se(le,O):W(O)},ie=function(O){O===null||_===w&&O===void 0||(O=Tr(O),W(O))};function I(O,le,Le,Ee,Ze){var lt=new Gp(le||this.boundingBox,Le||this.xStep,Ee||this.yStep,this.gState,Ze||this.matrix);lt.stream=this.stream;var St=O+"$$"+this.cloneIndex+++"$$";return Re(St,lt),lt}var se=function(O,le){var Le=Pr[O.key],Ee=Ht[Le];if(Ee instanceof Bh)W("q"),W(ve(le)),Ee.gState&&h.setGState(Ee.gState),W(O.matrix.toString()+" cm"),W("/"+Le+" sh"),W("Q");else if(Ee instanceof Gp){var Ze=new Ne(1,0,0,-1,0,Br());O.matrix&&(Ze=Ze.multiply(O.matrix||Ue),Le=I.call(Ee,O.key,O.boundingBox,O.xStep,O.yStep,Ze).id),W("q"),W("/Pattern cs"),W("/"+Le+" scn"),Ee.gState&&h.setGState(Ee.gState),W(le),W("Q")}},ve=function(O){switch(O){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Pe=h.moveTo=function(O,le){return W(M(B(O))+" "+M(G(le))+" m"),this},Ke=h.lineTo=function(O,le){return W(M(B(O))+" "+M(G(le))+" l"),this},pt=h.curveTo=function(O,le,Le,Ee,Ze,lt){return W([M(B(O)),M(G(le)),M(B(Le)),M(G(Ee)),M(B(Ze)),M(G(lt)),"c"].join(" ")),this};h.__private__.line=h.line=function(O,le,Le,Ee,Ze){if(isNaN(O)||isNaN(le)||isNaN(Le)||isNaN(Ee)||!Cr(Ze))throw new Error("Invalid arguments passed to jsPDF.line");return _===v?this.lines([[Le-O,Ee-le]],O,le,[1,1],Ze||"S"):this.lines([[Le-O,Ee-le]],O,le,[1,1]).stroke()},h.__private__.lines=h.lines=function(O,le,Le,Ee,Ze,lt){var St,Zt,tr,jr,zt,dr,en,mn,vn,Gn,Fn,On;if(typeof O=="number"&&(On=Le,Le=le,le=O,O=On),Ee=Ee||[1,1],lt=lt||!1,isNaN(le)||isNaN(Le)||!Array.isArray(O)||!Array.isArray(Ee)||!Cr(Ze)||typeof lt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Pe(le,Le),St=Ee[0],Zt=Ee[1],jr=O.length,Gn=le,Fn=Le,tr=0;tr<jr;tr++)(zt=O[tr]).length===2?(Gn=zt[0]*St+Gn,Fn=zt[1]*Zt+Fn,Ke(Gn,Fn)):(dr=zt[0]*St+Gn,en=zt[1]*Zt+Fn,mn=zt[2]*St+Gn,vn=zt[3]*Zt+Fn,Gn=zt[4]*St+Gn,Fn=zt[5]*Zt+Fn,pt(dr,en,mn,vn,Gn,Fn));return lt&&xr(),ie(Ze),this},h.path=function(O){for(var le=0;le<O.length;le++){var Le=O[le],Ee=Le.c;switch(Le.op){case"m":Pe(Ee[0],Ee[1]);break;case"l":Ke(Ee[0],Ee[1]);break;case"c":pt.apply(this,Ee);break;case"h":xr()}}return this},h.__private__.rect=h.rect=function(O,le,Le,Ee,Ze){if(isNaN(O)||isNaN(le)||isNaN(Le)||isNaN(Ee)||!Cr(Ze))throw new Error("Invalid arguments passed to jsPDF.rect");return _===v&&(Ee=-Ee),W([M(B(O)),M(G(le)),M(B(Le)),M(B(Ee)),"re"].join(" ")),ie(Ze),this},h.__private__.triangle=h.triangle=function(O,le,Le,Ee,Ze,lt,St){if(isNaN(O)||isNaN(le)||isNaN(Le)||isNaN(Ee)||isNaN(Ze)||isNaN(lt)||!Cr(St))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Le-O,Ee-le],[Ze-Le,lt-Ee],[O-Ze,le-lt]],O,le,[1,1],St,!0),this},h.__private__.roundedRect=h.roundedRect=function(O,le,Le,Ee,Ze,lt,St){if(isNaN(O)||isNaN(le)||isNaN(Le)||isNaN(Ee)||isNaN(Ze)||isNaN(lt)||!Cr(St))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Zt=4/3*(Math.SQRT2-1);return Ze=Math.min(Ze,.5*Le),lt=Math.min(lt,.5*Ee),this.lines([[Le-2*Ze,0],[Ze*Zt,0,Ze,lt-lt*Zt,Ze,lt],[0,Ee-2*lt],[0,lt*Zt,-Ze*Zt,lt,-Ze,lt],[2*Ze-Le,0],[-Ze*Zt,0,-Ze,-lt*Zt,-Ze,-lt],[0,2*lt-Ee],[0,-lt*Zt,Ze*Zt,-lt,Ze,-lt]],O+Ze,le,[1,1],St,!0),this},h.__private__.ellipse=h.ellipse=function(O,le,Le,Ee,Ze){if(isNaN(O)||isNaN(le)||isNaN(Le)||isNaN(Ee)||!Cr(Ze))throw new Error("Invalid arguments passed to jsPDF.ellipse");var lt=4/3*(Math.SQRT2-1)*Le,St=4/3*(Math.SQRT2-1)*Ee;return Pe(O+Le,le),pt(O+Le,le-St,O+lt,le-Ee,O,le-Ee),pt(O-lt,le-Ee,O-Le,le-St,O-Le,le),pt(O-Le,le+St,O-lt,le+Ee,O,le+Ee),pt(O+lt,le+Ee,O+Le,le+St,O+Le,le),ie(Ze),this},h.__private__.circle=h.circle=function(O,le,Le,Ee){if(isNaN(O)||isNaN(le)||isNaN(Le)||!Cr(Ee))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(O,le,Le,Le,Ee)},h.setFont=function(O,le,Le){return Le&&(le=A(le,Le)),nt=$t(O,le,{disableWarning:!1}),this};var ut=h.__private__.getFont=h.getFont=function(){return Pt[$t.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var O,le,Le={};for(O in Wt)if(Wt.hasOwnProperty(O))for(le in Le[O]=[],Wt[O])Wt[O].hasOwnProperty(le)&&Le[O].push(le);return Le},h.addFont=function(O,le,Le,Ee,Ze){var lt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&lt.indexOf(arguments[3])!==-1?Ze=arguments[3]:arguments[3]&&lt.indexOf(arguments[3])==-1&&(Le=A(Le,Ee)),Ft.call(this,O,le,Le,Ze=Ze||"Identity-H")};var Lt,Sr=e.lineWidth||.200025,hr=h.__private__.getLineWidth=h.getLineWidth=function(){return Sr},mt=h.__private__.setLineWidth=h.setLineWidth=function(O){return Sr=O,W(M(B(O))+" w"),this};h.__private__.setLineDash=bn.API.setLineDash=bn.API.setLineDashPattern=function(O,le){if(O=O||[],le=le||0,isNaN(le)||!Array.isArray(O))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return O=O.map(function(Le){return M(B(Le))}).join(" "),le=M(B(le)),W("["+O+"] "+le+" d"),this};var _t=h.__private__.getLineHeight=h.getLineHeight=function(){return ke*Lt};h.__private__.getLineHeight=h.getLineHeight=function(){return ke*Lt};var cr=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(O){return typeof(O=O||1.15)=="number"&&(Lt=O),this},sr=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Lt};cr(e.lineHeight);var pr=h.__private__.getHorizontalCoordinate=function(O){return B(O)},Dr=h.__private__.getVerticalCoordinate=function(O){return _===w?O:Nr[Z].mediaBox.topRightY-Nr[Z].mediaBox.bottomLeftY-B(O)},qr=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(O){return M(pr(O))},Ur=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(O){return M(Dr(O))},Qr=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return je(Qr)},h.__private__.setStrokeColor=h.setDrawColor=function(O,le,Le,Ee){return Qr=Ce({ch1:O,ch2:le,ch3:Le,ch4:Ee,pdfColorType:"draw",precision:2}),W(Qr),this};var on=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return je(on)},h.__private__.setFillColor=h.setFillColor=function(O,le,Le,Ee){return on=Ce({ch1:O,ch2:le,ch3:Le,ch4:Ee,pdfColorType:"fill",precision:2}),W(on),this};var gn=e.textColor||"0 g",ea=h.__private__.getTextColor=h.getTextColor=function(){return je(gn)};h.__private__.setTextColor=h.setTextColor=function(O,le,Le,Ee){return gn=Ce({ch1:O,ch2:le,ch3:Le,ch4:Ee,pdfColorType:"text",precision:3}),this};var ma=e.charSpace,ga=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(ma||0)};h.__private__.setCharSpace=h.setCharSpace=function(O){if(isNaN(O))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ma=O,this};var ta=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(O){var le=h.CapJoinStyles[O];if(le===void 0)throw new Error("Line cap style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ta=le,W(le+" J"),this};var Tn=0;h.__private__.setLineJoin=h.setLineJoin=function(O){var le=h.CapJoinStyles[O];if(le===void 0)throw new Error("Line join style of '"+O+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tn=le,W(le+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(O){if(O=O||0,isNaN(O))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return W(M(B(O))+" M"),this},h.GState=I2,h.setGState=function(O){(O=typeof O=="string"?jt[ur[O]]:Me(null,O)).equals(Ir)||(W("/"+O.id+" gs"),Ir=O)};var Me=function(O,le){if(!O||!ur[O]){var Le=!1;for(var Ee in jt)if(jt.hasOwnProperty(Ee)&&jt[Ee].equals(le)){Le=!0;break}if(Le)le=jt[Ee];else{var Ze="GS"+(Object.keys(jt).length+1).toString(10);jt[Ze]=le,le.id=Ze}return O&&(ur[O]=le.id),zr.publish("addGState",le),le}};h.addGState=function(O,le){return Me(O,le),this},h.saveGraphicsState=function(){return W("q"),Ot.push({key:nt,size:ke,color:gn}),this},h.restoreGraphicsState=function(){W("Q");var O=Ot.pop();return nt=O.key,ke=O.size,gn=O.color,Ir=null,this},h.setCurrentTransformationMatrix=function(O){return W(O.toString()+" cm"),this},h.comment=function(O){return W("#"+O),this};var yt=function(O,le){var Le=O||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Le},set:function(lt){isNaN(lt)||(Le=parseFloat(lt))}});var Ee=le||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ee},set:function(lt){isNaN(lt)||(Ee=parseFloat(lt))}});var Ze="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ze},set:function(lt){Ze=lt.toString()}}),this},fe=function(O,le,Le,Ee){yt.call(this,O,le),this.type="rect";var Ze=Le||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ze},set:function(St){isNaN(St)||(Ze=parseFloat(St))}});var lt=Ee||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return lt},set:function(St){isNaN(St)||(lt=parseFloat(St))}}),this},be=function(){this.page=Rr,this.currentPage=Z,this.pages=Y.slice(0),this.pagesContext=Nr.slice(0),this.x=Te,this.y=Dt,this.matrix=wt,this.width=st(Z),this.height=Nt(Z),this.outputDestination=U,this.id="",this.objectNumber=-1};be.prototype.restore=function(){Rr=this.page,Z=this.currentPage,Nr=this.pagesContext,Y=this.pages,Te=this.x,Dt=this.y,wt=this.matrix,It(Z,this.width),or(Z,this.height),U=this.outputDestination};var He=function(O,le,Le,Ee,Ze){ge.push(new be),Rr=Z=0,Y=[],Te=O,Dt=le,wt=Ze,Ar([Le,Ee])};for(var Fe in h.beginFormObject=function(O,le,Le,Ee,Ze){return He(O,le,Le,Ee,Ze),this},h.endFormObject=function(O){return function(le){if(pn[le])ge.pop().restore();else{var Le=new be,Ee="Xo"+(Object.keys(Yr).length+1).toString(10);Le.id=Ee,pn[le]=Ee,Yr[Ee]=Le,zr.publish("addFormObject",Le),ge.pop().restore()}}(O),this},h.doFormObject=function(O,le){var Le=Yr[pn[O]];return W("q"),W(le.toString()+" cm"),W("/"+Le.id+" Do"),W("Q"),this},h.getFormObject=function(O){var le=Yr[pn[O]];return{x:le.x,y:le.y,width:le.width,height:le.height,matrix:le.matrix}},h.save=function(O,le){return O=O||"generated.pdf",(le=le||{}).returnPromise=le.returnPromise||!1,le.returnPromise===!1?(Oh(rr(Ct()),O),typeof Oh.unload=="function"&&En.setTimeout&&setTimeout(Oh.unload,911),this):new Promise(function(Le,Ee){try{var Ze=Oh(rr(Ct()),O);typeof Oh.unload=="function"&&En.setTimeout&&setTimeout(Oh.unload,911),Le(Ze)}catch(lt){Ee(lt.message)}})},bn.API)bn.API.hasOwnProperty(Fe)&&(Fe==="events"&&bn.API.events.length?function(O,le){var Le,Ee,Ze;for(Ze=le.length-1;Ze!==-1;Ze--)Le=le[Ze][0],Ee=le[Ze][1],O.subscribe.apply(O,[Le].concat(typeof Ee=="function"?[Ee]:Ee))}(zr,bn.API.events):h[Fe]=bn.API[Fe]);function st(O){return Nr[O].mediaBox.topRightX-Nr[O].mediaBox.bottomLeftX}function It(O,le){Nr[O].mediaBox.topRightX=le+Nr[O].mediaBox.bottomLeftX}function Nt(O){return Nr[O].mediaBox.topRightY-Nr[O].mediaBox.bottomLeftY}function or(O,le){Nr[O].mediaBox.topRightY=le+Nr[O].mediaBox.bottomLeftY}var nr=h.getPageWidth=function(O){return st(O=O||Z)/Se},Er=h.setPageWidth=function(O,le){It(O,le*Se)},Br=h.getPageHeight=function(O){return Nt(O=O||Z)/Se},Hr=h.setPageHeight=function(O,le){or(O,le*Se)};return h.internal={pdfEscape:gr,getStyle:Tr,getFont:ut,getFontSize:Ie,getCharSpace:ga,getTextColor:ea,getLineHeight:_t,getLineHeightFactor:sr,getLineWidth:hr,write:ae,getHorizontalCoordinate:pr,getVerticalCoordinate:Dr,getCoordinateString:qr,getVerticalCoordinateString:Ur,collections:{},newObject:at,newAdditionalObject:ue,newObjectDeferred:er,newObjectDeferredBegin:oe,getFilters:ot,putStream:it,events:zr,scaleFactor:Se,pageSize:{getWidth:function(){return nr(Z)},setWidth:function(O){Er(Z,O)},getHeight:function(){return Br(Z)},setHeight:function(O){Hr(Z,O)}},encryptionOptions:d,encryption:Rt,getEncryptor:function(O){return d!==null?Rt.encryptor(O,0):function(le){return le}},output:kt,getNumberOfPages:Kr,get pages(){return Y},out:W,f2:N,f3:T,getPageInfo:Gt,getPageInfoByObjId:ir,getCurrentPageInfo:Bt,getPDFVersion:g,Point:yt,Rectangle:fe,Matrix:Ne,hasHotfix:rt},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return nr(Z)},set:function(O){Er(Z,O)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Br(Z)},set:function(O){Hr(Z,O)},enumerable:!0,configurable:!0}),(function(O){for(var le=0,Le=ze.length;le<Le;le++){var Ee=Ft.call(this,O[le][0],O[le][1],O[le][2],ze[le][3],!0);f===!1&&(p[Ee]=!0);var Ze=O[le][0].split("-");Vt({id:Ee,fontName:Ze[0],fontStyle:Ze[1]||""})}zr.publish("addFonts",{fonts:Pt,dictionary:Wt})}).call(h,ze),nt="F1",kr(a,r),zr.publish("initialized"),h}Cp.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Cp.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Cp.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Cp.prototype.processOwnerPassword=function(e,t){return zA(UA(t).substr(0,5),e)},Cp.prototype.encryptor=function(e,t){var r=UA(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return zA(r,n)}},I2.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Oa(e)!==Oa(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},bn.API={events:[]},bn.version="4.1.0";var Ti=bn.API,rC=1,G0=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},cp=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},D2=function(e){return e.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(t){var r=t.charCodeAt(0).toString(16).toUpperCase();return"#"+(r.length===1?"0"+r:r)})},Ln=function(e){return e.toFixed(2)},gf=function(e){return e.toFixed(5)};Ti.__acroform__={};var xl=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},WO=function(e){return e*rC},Au=function(e){var t=new uz,r=cn.internal.getHeight(e)||0,n=cn.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Ln(n)),Number(Ln(r))],t},Vme=Ti.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},Gme=Ti.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},Kme=Ti.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Ki=Ti.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Kme(e,t-1)},Xi=Ti.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Vme(e,t-1)},Yi=Ti.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Gme(e,t-1)},Xme=Ti.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],s=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(a+o)||0,c.upperRight_Y=n(s)||0,[Number(Ln(c.lowerLeft_X)),Number(Ln(c.lowerLeft_Y)),Number(Ln(c.upperRight_X)),Number(Ln(c.upperRight_Y))]},Yme=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=WA(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Ln(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Au(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},WA=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(N){return N.split(`
`)}):a.map(function(N){return[N]});var s=r,o=cn.internal.getHeight(e)||0;o=o<0?-o:o;var l=cn.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(N,T,B){if(N+1<a.length){var G=T+" "+a[N+1][0];return Eb(G,e,B).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var u,d,f=Eb("3",e,s).height,p=e.multiline?o-s:(o-f)/2,h=p+=2,m=0,g=0,b=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Eb(t,e,s=12).width+", FieldWidth:"+l+`
`;break}for(var y="",v=0,w=0;w<a.length;w++)if(a.hasOwnProperty(w)){var _=!1;if(a[w].length!==1&&b!==a[w].length-1){if((f+2)*(v+2)+2>o)continue e;y+=a[w][b],_=!0,g=w,w--}else{y=(y+=a[w][b]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var C=parseInt(w),j=c(C,y,s),A=w>=a.length-1;if(j&&!A){y+=" ",b=0;continue}if(j||A){if(A)g=C;else if(e.multiline&&(f+2)*(v+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(v+2)+2>o)continue e;g=C}}for(var M="",P=m;P<=g;P++){var R=a[P];if(e.multiline){if(P===g){M+=R[b]+" ",b=(b+1)%R.length;continue}if(P===m){M+=R[R.length-1]+" ";continue}}M+=R[0]+" "}switch(M=M.substr(M.length-1)==" "?M.substr(0,M.length-1):M,d=Eb(M,e,s).width,e.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}t+=Ln(u)+" "+Ln(h)+` Td
`,t+="("+G0(M)+`) Tj
`,t+=-Ln(u)+` 0 Td
`,h=-(s+2),d=0,m=_?g:g+1,v++,y=""}break}return n.text=t,n.fontSize=s,n},Eb=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},Qme={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Jme=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Zme=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(su.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Qme)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");rC=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new dz,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var s=n[a];s.objId=void 0,s.hasAnnotation&&Jme(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var s=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=Xme(l.Rect,a)),a.internal.newObjectDeferredBegin(l.objId,!0),l.DA=cn.createDefaultAppearanceStream(l),Oa(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=Yme(l);c.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var p in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(p)){var h=l.appearanceStreamContent[p];if(f+="/"+p+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m+" ",a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(a,l)),f+="/"+o+" "+m,a.internal.acroformPlugin.xForms.indexOf(m)>=0||a.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:l.objId}),a.internal.out("endobj")}s&&function(g,b){for(var y in g)if(g.hasOwnProperty(y)){var v=y,w=g[y];b.internal.newObjectDeferredBegin(w.objId,!0),Oa(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[v]}}(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},cz=Ti.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var a="[",s=0;s<e.length;s++)switch(s!==0&&(a+=" "),Oa(e[s])){case"boolean":case"number":case"object":a+=e[s].toString();break;case"string":e[s].substr(0,1)==="/"?a+="/"+D2(e[s].substr(1)):(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+G0(n(e[s].toString()))+")")}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},mk=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+G0(n(e))+")"},Fu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Fu.prototype.toString=function(){return this.objId+" 0 R"},Fu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Fu.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:cz(a,this.objId,this.scope)}):a instanceof Fu?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var uz=function(){Fu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};xl(uz,Fu);var dz=function(){Fu.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+G0(r(e))+")"}},set:function(r){e=r}})};xl(dz,Fu);var su=function e(){Fu.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ki(t,3)},set:function(y){y?this.F=Xi(t,3):this.F=Yi(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof $2)return;s="FieldObject"+e.FieldNum++}var y=function(v){return v};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+G0(y(s))+")"},set:function(y){s=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(y){s=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(y){c=y}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/rC:u},set:function(y){u=y}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(y){d=y}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof $2||this instanceof r0))return mk(f,this.objId,this.scope)},set:function(y){y=y.toString(),f=y}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Rs==0?mk(p,this.objId,this.scope):p},set:function(y){y=y.toString(),p=this instanceof Rs==0?y.substr(0,1)==="("?cp(y.substr(1,y.length-2)):cp(y):y}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Rs==1?cp(p.substr(1,p.length-1)):p},set:function(y){y=y.toString(),p=this instanceof Rs==1?"/"+D2(y):y}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Rs==0?mk(h,this.objId,this.scope):h},set:function(y){y=y.toString(),h=this instanceof Rs==0?y.substr(0,1)==="("?cp(y.substr(1,y.length-2)):cp(y):y}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Rs==1?cp(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof Rs==1?"/"+D2(y):y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(y){y=!!y,g=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(y){m=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,1)},set:function(y){y?this.Ff=Xi(this.Ff,1):this.Ff=Yi(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,2)},set:function(y){y?this.Ff=Xi(this.Ff,2):this.Ff=Yi(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,3)},set:function(y){y?this.Ff=Xi(this.Ff,3):this.Ff=Yi(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');b=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(b){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:b=2;break;case"center":case 1:b=1;break;default:b=0}}})};xl(su,Fu);var dm=function(){su.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return cz(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,18)},set:function(r){r?this.Ff=Xi(this.Ff,18):this.Ff=Yi(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Xi(this.Ff,19):this.Ff=Yi(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,20)},set:function(r){r?(this.Ff=Xi(this.Ff,20),t.sort()):this.Ff=Yi(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,22)},set:function(r){r?this.Ff=Xi(this.Ff,22):this.Ff=Yi(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,23)},set:function(r){r?this.Ff=Xi(this.Ff,23):this.Ff=Yi(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,27)},set:function(r){r?this.Ff=Xi(this.Ff,27):this.Ff=Yi(this.Ff,27)}}),this.hasAppearanceStream=!1};xl(dm,su);var fm=function(){dm.call(this),this.fontName="helvetica",this.combo=!1};xl(fm,dm);var hm=function(){fm.call(this),this.combo=!0};xl(hm,fm);var Lv=function(){hm.call(this),this.edit=!0};xl(Lv,hm);var Rs=function(){su.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,15)},set:function(r){r?this.Ff=Xi(this.Ff,15):this.Ff=Yi(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,16)},set:function(r){r?this.Ff=Xi(this.Ff,16):this.Ff=Yi(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,17)},set:function(r){r?this.Ff=Xi(this.Ff,17):this.Ff=Yi(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,26)},set:function(r){r?this.Ff=Xi(this.Ff,26):this.Ff=Yi(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+G0(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){Oa(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+D2(r)}})};xl(Rs,su);var Mv=function(){Rs.call(this),this.pushButton=!0};xl(Mv,Rs);var pm=function(){Rs.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};xl(pm,Rs);var $2=function(){var e,t;su.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(l){return l};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+G0(a(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(a){Oa(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=cn.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};xl($2,su),pm.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},pm.prototype.createOption=function(e){var t=new $2;return t.Parent=this,t.optionName=e,this.Kids.push(t),ege.call(this.scope,t),t};var Fv=function(){Rs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=cn.CheckBox.createAppearanceStream()};xl(Fv,Rs);var r0=function(){su.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,13)},set:function(t){t?this.Ff=Xi(this.Ff,13):this.Ff=Yi(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,21)},set:function(t){t?this.Ff=Xi(this.Ff,21):this.Ff=Yi(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,23)},set:function(t){t?this.Ff=Xi(this.Ff,23):this.Ff=Yi(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,24)},set:function(t){t?this.Ff=Xi(this.Ff,24):this.Ff=Yi(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,25)},set:function(t){t?this.Ff=Xi(this.Ff,25):this.Ff=Yi(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,26)},set:function(t){t?this.Ff=Xi(this.Ff,26):this.Ff=Yi(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};xl(r0,su);var Rv=function(){r0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ki(this.Ff,14)},set:function(e){e?this.Ff=Xi(this.Ff,14):this.Ff=Yi(this.Ff,14)}}),this.password=!0};xl(Rv,r0);var cn={CheckBox:{createAppearanceStream:function(){return{N:{On:cn.CheckBox.YesNormal},D:{On:cn.CheckBox.YesPushDown,Off:cn.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Au(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),s=WA(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Ln(cn.internal.getWidth(e))+" "+Ln(cn.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Ln(s.fontSize)+" Tf "+a),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Au(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],s=cn.internal.getHeight(e),o=cn.internal.getWidth(e),l=WA(e,e.caption);return a.push("1 g"),a.push("0 0 "+Ln(o)+" "+Ln(s)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Ln(o-1)+" "+Ln(s-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Ln(l.fontSize)+" Tf "+n),a.push(l.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=Au(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ln(cn.internal.getWidth(e))+" "+Ln(cn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:cn.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=cn.RadioButton.Circle.YesNormal,t.D[e]=cn.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Au(e);t.scope=e.scope;var r=[],n=cn.internal.getWidth(e)<=cn.internal.getHeight(e)?cn.internal.getWidth(e)/4:cn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=cn.internal.Bezier_C,s=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+gf(cn.internal.getWidth(e)/2)+" "+gf(cn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Au(e);t.scope=e.scope;var r=[],n=cn.internal.getWidth(e)<=cn.internal.getHeight(e)?cn.internal.getWidth(e)/4:cn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*cn.internal.Bezier_C).toFixed(5)),o=Number((n*cn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+gf(cn.internal.getWidth(e)/2)+" "+gf(cn.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+gf(cn.internal.getWidth(e)/2)+" "+gf(cn.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Au(e);t.scope=e.scope;var r=[],n=cn.internal.getWidth(e)<=cn.internal.getHeight(e)?cn.internal.getWidth(e)/4:cn.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),s=Number((a*cn.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+gf(cn.internal.getWidth(e)/2)+" "+gf(cn.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:cn.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=cn.RadioButton.Cross.YesNormal,t.D[e]=cn.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Au(e);t.scope=e.scope;var r=[],n=cn.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Ln(cn.internal.getWidth(e)-2)+" "+Ln(cn.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Ln(n.x1.x)+" "+Ln(n.x1.y)+" m"),r.push(Ln(n.x2.x)+" "+Ln(n.x2.y)+" l"),r.push(Ln(n.x4.x)+" "+Ln(n.x4.y)+" m"),r.push(Ln(n.x3.x)+" "+Ln(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Au(e);t.scope=e.scope;var r=cn.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ln(cn.internal.getWidth(e))+" "+Ln(cn.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ln(cn.internal.getWidth(e)-2)+" "+Ln(cn.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Ln(r.x1.x)+" "+Ln(r.x1.y)+" m"),n.push(Ln(r.x2.x)+" "+Ln(r.x2.y)+" l"),n.push(Ln(r.x4.x)+" "+Ln(r.x4.y)+" m"),n.push(Ln(r.x3.x)+" "+Ln(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Au(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ln(cn.internal.getWidth(e))+" "+Ln(cn.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};cn.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=cn.internal.getWidth(e),r=cn.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},cn.internal.getWidth=function(e){var t=0;return Oa(e)==="object"&&(t=WO(e.Rect[2])),t},cn.internal.getHeight=function(e){var t=0;return Oa(e)==="object"&&(t=WO(e.Rect[3])),t};var ege=Ti.addField=function(e){if(Zme(this,e),!(e instanceof su))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Ti.AcroFormChoiceField=dm,Ti.AcroFormListBox=fm,Ti.AcroFormComboBox=hm,Ti.AcroFormEditBox=Lv,Ti.AcroFormButton=Rs,Ti.AcroFormPushButton=Mv,Ti.AcroFormRadioButton=pm,Ti.AcroFormCheckBox=Fv,Ti.AcroFormTextField=r0,Ti.AcroFormPasswordField=Rv,Ti.AcroFormAppearance=cn,Ti.AcroForm={ChoiceField:dm,ListBox:fm,ComboBox:hm,EditBox:Lv,Button:Rs,PushButton:Mv,RadioButton:pm,CheckBox:Fv,TextField:r0,PasswordField:Rv,Appearance:cn},bn.AcroForm={ChoiceField:dm,ListBox:fm,ComboBox:hm,EditBox:Lv,Button:Rs,PushButton:Mv,RadioButton:pm,CheckBox:Fv,TextField:r0,PasswordField:Rv,Appearance:cn};bn.AcroForm;function fz(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(N,T){var B,G,re,xe,_e,V=r;if((T=T||r)==="RGBA"||N.data!==void 0&&N.data instanceof Uint8ClampedArray&&"height"in N&&"width"in N)return"RGBA";if(j(N))for(_e in n)for(re=n[_e],B=0;B<re.length;B+=1){for(xe=!0,G=0;G<re[B].length;G+=1)if(re[B][G]!==void 0&&re[B][G]!==N[G]){xe=!1;break}if(xe===!0){V=_e;break}}else for(_e in n)for(re=n[_e],B=0;B<re.length;B+=1){for(xe=!0,G=0;G<re[B].length;G+=1)if(re[B][G]!==void 0&&re[B][G]!==N.charCodeAt(G)){xe=!1;break}if(xe===!0){V=_e;break}}return V===r&&T!==r&&(V=T),V},s=function N(T){for(var B=this.internal.write,G=this.internal.putStream,re=(0,this.internal.getFilters)();re.indexOf("FlateEncode")!==-1;)re.splice(re.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var xe=[];if(xe.push({key:"Type",value:"/XObject"}),xe.push({key:"Subtype",value:"/Image"}),xe.push({key:"Width",value:T.width}),xe.push({key:"Height",value:T.height}),T.colorSpace===y.INDEXED?xe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(xe.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===y.DEVICE_CMYK&&xe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),xe.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&xe.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var _e="",V=0,K=T.transparency.length;V<K;V++)_e+=T.transparency[V]+" "+T.transparency[V]+" ";xe.push({key:"Mask",value:"["+_e+"]"})}T.sMask!==void 0&&xe.push({key:"SMask",value:T.objectId+1+" 0 R"});var de=T.filter!==void 0?["/"+T.filter]:void 0;if(G({data:T.data,additionalKeyValues:xe,alreadyAppliedFilters:de,objectId:T.objectId}),B("endobj"),"sMask"in T&&T.sMask!==void 0){var ne,E=(ne=T.sMaskBitsPerComponent)!==null&&ne!==void 0?ne:T.bitsPerComponent,Z={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:E,data:T.sMask};"filter"in T&&(Z.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(E," /Columns ").concat(T.width),Z.filter=T.filter),N.call(this,Z)}if(T.colorSpace===y.INDEXED){var H=this.internal.newObject();G({data:M(new Uint8Array(T.palette)),objectId:H}),B("endobj")}},o=function(){var N=this.internal.collections[t+"images"];for(var T in N)s.call(this,N[T])},l=function(){var N,T=this.internal.collections[t+"images"],B=this.internal.write;for(var G in T)B("/I"+(N=T[G]).index,N.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var N=this.internal.collections[t+"images"];return c.call(this),N},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(N){return typeof e["process"+N.toUpperCase()]=="function"},p=function(N){return Oa(N)==="object"&&N.nodeType===1},h=function(N,T){if(N.nodeName==="IMG"&&N.hasAttribute("src")){var B=""+N.getAttribute("src");if(B.indexOf("data:image/")===0)return Ov(unescape(B).split("base64,").pop());var G=e.loadFile(B,!0);if(G!==void 0)return G}if(N.nodeName==="CANVAS"){if(N.width===0||N.height===0)throw new Error("Given canvas must have data. Canvas width: "+N.width+", height: "+N.height);var re;switch(T){case"PNG":re="image/png";break;case"WEBP":re="image/webp";break;default:re="image/jpeg"}return Ov(N.toDataURL(re,1).split("base64,").pop())}},m=function(N){var T=this.internal.collections[t+"images"];if(T){for(var B in T)if(N===T[B].alias)return T[B]}},g=function(N,T,B){return N||T||(N=-96,T=-96),N<0&&(N=-1*B.width*72/N/this.internal.scaleFactor),T<0&&(T=-1*B.height*72/T/this.internal.scaleFactor),N===0&&(N=T*B.width/B.height),T===0&&(T=N*B.height/B.width),[N,T]},b=function(N,T,B,G,re,xe){var _e=g.call(this,B,G,re),V=this.internal.getCoordinateString,K=this.internal.getVerticalCoordinateString,de=u.call(this);if(B=_e[0],G=_e[1],de[re.index]=re,xe){xe*=Math.PI/180;var ne=Math.cos(xe),E=Math.sin(xe),Z=function(F){return F.toFixed(4)},H=[Z(ne),Z(E),Z(-1*E),Z(ne),0,0,"cm"]}this.internal.write("q"),xe?(this.internal.write([1,"0","0",1,V(N),K(T+G),"cm"].join(" ")),this.internal.write(H.join(" ")),this.internal.write([V(B),"0","0",V(G),"0","0","cm"].join(" "))):this.internal.write([V(B),"0","0",V(G),V(N),K(T+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+re.index+" Do"),this.internal.write("Q")},y=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(N){var T,B,G=0;if(typeof N=="string")for(B=N.length,T=0;T<B;T++)G=(G<<5)-G+N.charCodeAt(T),G|=0;else if(j(N))for(B=N.byteLength/2,T=0;T<B;T++)G=(G<<5)-G+N[T],G|=0;return G},_=e.__addimage__.validateStringAsBase64=function(N){(N=N||"").toString().trim();var T=!0;return N.length===0&&(T=!1),N.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(N.substr(0,N.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(N.substr(-2))===!1&&(T=!1),T},C=e.__addimage__.extractImageFromDataUrl=function(N){if(N==null||!(N=N.trim()).startsWith("data:"))return null;var T=N.indexOf(",");return T<0?null:N.substring(0,T).trim().endsWith("base64")?N.substring(T+1):null};e.__addimage__.isArrayBuffer=function(N){return N instanceof ArrayBuffer};var j=e.__addimage__.isArrayBufferView=function(N){return N instanceof Int8Array||N instanceof Uint8Array||N instanceof Uint8ClampedArray||N instanceof Int16Array||N instanceof Uint16Array||N instanceof Int32Array||N instanceof Uint32Array||N instanceof Float32Array||N instanceof Float64Array},A=e.__addimage__.binaryStringToUint8Array=function(N){for(var T=N.length,B=new Uint8Array(T),G=0;G<T;G++)B[G]=N.charCodeAt(G);return B},M=e.__addimage__.arrayBufferToBinaryString=function(N){for(var T="",B=j(N)?N:new Uint8Array(N),G=0;G<B.length;G+=8192)T+=String.fromCharCode.apply(null,B.subarray(G,G+8192));return T};e.addImage=function(){var N,T,B,G,re,xe,_e,V,K;if(typeof arguments[1]=="number"?(T=r,B=arguments[1],G=arguments[2],re=arguments[3],xe=arguments[4],_e=arguments[5],V=arguments[6],K=arguments[7]):(T=arguments[1],B=arguments[2],G=arguments[3],re=arguments[4],xe=arguments[5],_e=arguments[6],V=arguments[7],K=arguments[8]),Oa(N=arguments[0])==="object"&&!p(N)&&"imageData"in N){var de=N;N=de.imageData,T=de.format||T||r,B=de.x||B||0,G=de.y||G||0,re=de.w||de.width||re,xe=de.h||de.height||xe,_e=de.alias||_e,V=de.compression||V,K=de.rotation||de.angle||K}var ne=this.internal.getFilters();if(V===void 0&&ne.indexOf("FlateEncode")!==-1&&(V="SLOW"),isNaN(B)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var E=P.call(this,N,T,_e,V);return b.call(this,B,G,re,xe,E,K),this};var P=function(N,T,B,G){var re,xe,_e;if(typeof N=="string"&&a(N)===r){N=unescape(N);var V=R(N,!1);(V!==""||(V=e.loadFile(N,!0))!==void 0)&&(N=V)}if(p(N)&&(N=h(N,T)),T=a(N,T),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((_e=B)==null||_e.length===0)&&(B=function(K){return typeof K=="string"||j(K)?w(K):j(K.data)?w(K.data):null}(N)),(re=m.call(this,B))||(N instanceof Uint8Array||T==="RGBA"||(xe=N,N=A(N)),re=this["process"+T.toUpperCase()](N,d.call(this),B,function(K){return K&&typeof K=="string"&&(K=K.toUpperCase()),K in e.image_compression?K:v.NONE}(G),xe)),!re)throw new Error("An unknown error occurred whilst processing the image.");return re},R=e.__addimage__.convertBase64ToBinaryString=function(N,T){T=typeof T!="boolean"||T;var B,G="";if(typeof N=="string"){var re;B=(re=C(N))!==null&&re!==void 0?re:N;try{G=Ov(B)}catch(xe){if(T)throw _(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+xe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};e.getImageProperties=function(N){var T,B,G="";if(p(N)&&(N=h(N)),typeof N=="string"&&a(N)===r&&((G=R(N,!1))===""&&(G=e.loadFile(N)||""),N=G),B=a(N),!f(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(N instanceof Uint8Array||(N=A(N)),!(T=this["process"+B.toUpperCase()](N)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=B,T}})(bn.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};bn.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){n=u[p];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(g.objId),v=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(y(n.contents))+")",s+=" /Popup "+b.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(y(v))+") >>",g.content=s;var w=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(s+=" /Open true"),s+=" >>",b.content=s,this.internal.write(g.objId,"0 R",b.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var _=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+_+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var C=this.annotations._nameMap[n.options.name];n.options.pageNumber=C.page,n.options.top=C.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var j=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+j+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+s)},options:o,type:"link"})},e.textWithLink=function(r,n,a,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,a,s),a+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,a-u,l,o,s),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(bn.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var b=0,y=r,v="",w=0;for(b=0;b<g.length;b+=1)y[g.charCodeAt(b)]!==void 0?(w++,typeof(y=y[g.charCodeAt(b)])=="number"&&(v+=String.fromCharCode(y),y=r,w=0),b===g.length-1&&(y=r,v+=g.charAt(b-(w-1)),b-=w-1,w=0)):(y=r,v+=g.charAt(b-w),b-=w,w=0);return v};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,b,y){return o(g)?s(g)===!1?-1:!u(g)||!o(b)&&!o(y)||!o(y)&&l(b)||l(g)&&!o(b)||l(g)&&c(b)||l(g)&&l(b)?0:d(g)&&o(b)&&!l(b)&&o(y)&&u(y)?3:l(g)||!o(y)?1:2:-1},h=function(g){var b=0,y=0,v=0,w="",_="",C="",j=(g=g||"").split("\\s+"),A=[];for(b=0;b<j.length;b+=1){for(A.push(""),y=0;y<j[b].length;y+=1)w=j[b][y],_=j[b][y-1],C=j[b][y+1],o(w)?(v=p(w,_,C),A[b]+=v!==-1?String.fromCharCode(t[w.charCodeAt(0)][v]):w):A[b]+=w;A[b]=f(A[b])}return A.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(b)){var v=0;for(y=[],v=0;v<b.length;v+=1)Array.isArray(b[v])?y.push([h(b[v][0]),b[v][1],b[v][2]]):y.push([h(b[v])]);g=y}else g=h(b);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])}(bn.API),bn.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(l){a=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(bn.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,h=0,m=0,g=0,b=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var y=u.maxWidth;y>0?typeof c=="string"?c=this.splitTextToSize(c,y):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,_){return w.concat(b.splitTextToSize(_,y))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)h<(g=this.getStringUnitWidth(c[v],{font:f})*d)&&(h=g);return h!==0&&(m=c.length),{w:h/=p,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&p&&(this.printHeaderRow(c.lineNumber,!0),c.y+=p[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,f,p){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,m,g,b,y=[],v=[],w=[],_={},C={},j=[],A=[],M=(p=p||{}).autoSize||!1,P=p.printHeaders!==!1,R=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,N=p.margins||Object.assign({width:this.getPageWidth()},t),T=typeof p.padding=="number"?p.padding:3,B=p.headerBackgroundColor||"#c8c8c8",G=p.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=N,this.internal.__cell__.table_font_size=R,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=G,this.setFontSize(R),f==null)v=y=Object.keys(d[0]),w=y.map(function(){return"left"});else if(Array.isArray(f)&&Oa(f[0])==="object")for(y=f.map(function(de){return de.name}),v=f.map(function(de){return de.prompt||de.name||""}),w=f.map(function(de){return de.align||"left"}),h=0;h<f.length;h+=1)C[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(v=y=f,w=y.map(function(){return"left"}));if(M||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<y.length;h+=1){for(_[b=y[h]]=d.map(function(de){return de[b]}),this.setFont(void 0,"bold"),j.push(this.getTextDimensions(v[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=_[b],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)j.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);C[b]=Math.max.apply(null,j)+T+T,j=[]}if(P){var re={};for(h=0;h<y.length;h+=1)re[y[h]]={},re[y[h]].text=v[h],re[y[h]].align=w[h];var xe=l.call(this,re,C);A=y.map(function(de){return new s(c,u,C[de],xe,re[de].text,void 0,re[de].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var _e=f.reduce(function(de,ne){return de[ne.name]=ne.align,de},{});for(h=0;h<d.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:d[h]},this);var V=l.call(this,d[h],C);for(g=0;g<y.length;g+=1){var K=d[h][y[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:g,data:K},this),o.call(this,new s(c,u,C[y[g]],V,K,h+2,_e[y[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/p+d+d},this).reduce(function(h,m){return Math.max(h,m)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(bn.API);var hz={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},pz=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],qA=fz(pz),mz=[100,200,300,400,500,600,700,800,900],tge=fz(mz);function gk(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return hz[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),a=function(s){return typeof qA[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function qO(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var rge={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},HO={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function VO(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function GO(e){return e.trimLeft()}function nge(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function age(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var up,Tb,KO,XO,YO,xk=["times"];function QO(e,t,r,n,a){var s=4,o=ZO;switch(a){case bn.API.image_compression.FAST:s=1,o=JO;break;case bn.API.image_compression.MEDIUM:s=6,o=eL;break;case bn.API.image_compression.SLOW:s=9,o=tL}e=function(c,u,d,f){for(var p,h=c.length/u,m=new Uint8Array(c.length+h),g=[ige,JO,ZO,eL,tL],b=0;b<h;b+=1){var y=b*u,v=c.subarray(y,y+u);if(f)m.set(f(v,d,p),y+b);else{for(var w=g.length,_=[],C=0;C<w;C+=1)_[C]=g[C](v,d,p);var j=oge(_.concat());m.set(_[j],y+b)}p=v}return m}(e,t,Math.ceil(r*n/8),o);var l=BA(e,{level:s});return bn.API.__addimage__.arrayBufferToBinaryString(l)}function ige(e){var t=Array.apply([],e);return t.unshift(0),t}function JO(e,t){var r=e.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var s=e[a-t]||0;n[a+1]=e[a]-s+256&255}return n}function ZO(e,t,r){var n=e.length,a=[];a[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;a[s+1]=e[s]-o+256&255}return a}function eL(e,t,r){var n=e.length,a=[];a[0]=3;for(var s=0;s<n;s+=1){var o=e[s-t]||0,l=r&&r[s]||0;a[s+1]=e[s]+256-(o+l>>>1)&255}return a}function tL(e,t,r){var n=e.length,a=[];a[0]=4;for(var s=0;s<n;s+=1){var o=sge(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);a[s+1]=e[s]-o+256&255}return a}function sge(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),a=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=a&&n<=s?e:a<=s?t:r}function oge(e){var t=e.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function yk(e,t,r){var n=t*r,a=Math.floor(n/8),s=16-(n-8*a+r),o=(1<<r)-1;return gz(e,a)>>s&o}function rL(e,t,r,n){var a=r*n,s=Math.floor(a/8),o=16-(a-8*s+n),l=(1<<n)-1,c=(t&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var p=f>>8&255;u.setUint8(d,p)}})(e,s,gz(e,s)&~(l<<o)&65535|c)}function gz(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function lge(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],s=a>>7,o=1<<1+(7&a);e[t++],e[t++];var l=null,c=null;s&&(l=t,c=o,t+=3*o);var u=!0,d=[],f=0,p=null,h=0,m=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,p=e[t++],1&g||(p=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var b=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,_=e[t++],C=_>>6&1,j=1<<1+(7&_),A=l,M=c,P=!1;_>>7&&(P=!0,A=t,M=j,t+=3*j);var R=t;for(t++;;){var N;if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}d.push({x:b,y,width:v,height:w,has_local_palette:P,palette_offset:A,palette_size:M,data_offset:R,data_length:t-R,transparent_index:p,interlaced:!!C,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(T){if(T<0||T>=d.length)throw new Error("Frame index out of range.");return d[T]},this.decodeAndBlitFrameBGRA=function(T,B){var G=this.frameInfo(T),re=G.width*G.height,xe=new Uint8Array(re);nL(e,G.data_offset,xe,re);var _e=G.palette_offset,V=G.transparent_index;V===null&&(V=256);var K=G.width,de=r-K,ne=K,E=4*(G.y*r+G.x),Z=4*((G.y+G.height)*r+G.x),H=E,F=4*de;G.interlaced===!0&&(F+=4*r*7);for(var ee=8,z=0,X=xe.length;z<X;++z){var J=xe[z];if(ne===0&&(ne=K,(H+=F)>=Z&&(F=4*de+4*r*(ee-1),H=E+(K+de)*(ee<<1),ee>>=1)),J===V)H+=4;else{var q=e[_e+3*J],Y=e[_e+3*J+1],L=e[_e+3*J+2];B[H++]=L,B[H++]=Y,B[H++]=q,B[H++]=255}--ne}},this.decodeAndBlitFrameRGBA=function(T,B){var G=this.frameInfo(T),re=G.width*G.height,xe=new Uint8Array(re);nL(e,G.data_offset,xe,re);var _e=G.palette_offset,V=G.transparent_index;V===null&&(V=256);var K=G.width,de=r-K,ne=K,E=4*(G.y*r+G.x),Z=4*((G.y+G.height)*r+G.x),H=E,F=4*de;G.interlaced===!0&&(F+=4*r*7);for(var ee=8,z=0,X=xe.length;z<X;++z){var J=xe[z];if(ne===0&&(ne=K,(H+=F)>=Z&&(F=4*de+4*r*(ee-1),H=E+(K+de)*(ee<<1),ee>>=1)),J===V)H+=4;else{var q=e[_e+3*J],Y=e[_e+3*J+1],L=e[_e+3*J+2];B[H++]=q,B[H++]=Y,B[H++]=L,B[H++]=255}--ne}}}function nL(e,t,r,n){for(var a=e[t++],s=1<<a,o=s+1,l=o+1,c=a+1,u=(1<<c)-1,d=0,f=0,p=0,h=e[t++],m=new Int32Array(4096),g=null;;){for(;d<16&&h!==0;)f|=e[t++]<<d,d+=8,h===1?h=e[t++]:--h;if(d<c)break;var b=f&u;if(f>>=c,d-=c,b!==s){if(b===o)break;for(var y=b<l?b:g,v=0,w=y;w>s;)w=m[w]>>8,++v;var _=w;if(p+v+(y!==b?1:0)>n)return void Ha.log("Warning, gif stream longer than expected.");r[p++]=_;var C=p+=v;for(y!==b&&(r[p++]=_),w=y;v--;)w=m[w],r[--C]=255&w,w>>=8;g!==null&&l<4096&&(m[l++]=g<<8|_,l>=u+1&&c<12&&(++c,u=u<<1|1)),g=b}else l=o+1,u=(1<<(c=a+1))-1,g=null}return p!==n&&Ha.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function bk(e){var t,r,n,a,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),p=new Array(65535),h=new Array(64),m=new Array(64),g=[],b=0,y=7,v=new Array(64),w=new Array(64),_=new Array(64),C=new Array(256),j=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],M=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],N=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],re=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function xe(E,Z){for(var H=0,F=0,ee=new Array,z=1;z<=16;z++){for(var X=1;X<=E[z];X++)ee[Z[F]]=[],ee[Z[F]][0]=H,ee[Z[F]][1]=z,F++,H++;H*=2}return ee}function _e(E){for(var Z=E[0],H=E[1]-1;H>=0;)Z&1<<H&&(b|=1<<y),H--,--y<0&&(b==255?(V(255),V(0)):V(b),y=7,b=0)}function V(E){g.push(E)}function K(E){V(E>>8&255),V(255&E)}function de(E,Z,H,F,ee){for(var z,X=ee[0],J=ee[240],q=function(ke,qe){var Ie,Ve,Qe,Tt,vt,Xe,Be,ct,nt,Se,Te=0;for(nt=0;nt<8;++nt){Ie=ke[Te],Ve=ke[Te+1],Qe=ke[Te+2],Tt=ke[Te+3],vt=ke[Te+4],Xe=ke[Te+5],Be=ke[Te+6];var Dt=Ie+(ct=ke[Te+7]),wt=Ie-ct,Pt=Ve+Be,Wt=Ve-Be,Ot=Qe+Xe,Ht=Qe-Xe,Pr=Tt+vt,jt=Tt-vt,ur=Dt+Pr,Ir=Dt-Pr,Rr=Pt+Ot,Nr=Pt-Ot;ke[Te]=ur+Rr,ke[Te+4]=ur-Rr;var zr=.707106781*(Nr+Ir);ke[Te+2]=Ir+zr,ke[Te+6]=Ir-zr;var _n=.382683433*((ur=jt+Ht)-(Nr=Wt+wt)),Yr=.5411961*ur+_n,pn=1.306562965*Nr+_n,ge=.707106781*(Rr=Ht+Wt),Ne=wt+ge,dt=wt-ge;ke[Te+5]=dt+Yr,ke[Te+3]=dt-Yr,ke[Te+1]=Ne+pn,ke[Te+7]=Ne-pn,Te+=8}for(Te=0,nt=0;nt<8;++nt){Ie=ke[Te],Ve=ke[Te+8],Qe=ke[Te+16],Tt=ke[Te+24],vt=ke[Te+32],Xe=ke[Te+40],Be=ke[Te+48];var Ue=Ie+(ct=ke[Te+56]),Re=Ie-ct,xt=Ve+Be,at=Ve-Be,er=Qe+Xe,oe=Qe-Xe,ue=Tt+vt,Q=Tt-vt,ye=Ue+ue,je=Ue-ue,Ce=xt+er,ot=xt-er;ke[Te]=ye+Ce,ke[Te+32]=ye-Ce;var it=.707106781*(ot+je);ke[Te+16]=je+it,ke[Te+48]=je-it;var We=.382683433*((ye=Q+oe)-(ot=at+Re)),De=.5411961*ye+We,pe=1.306562965*ot+We,Je=.707106781*(Ce=oe+at),Ge=Re+Je,Ye=Re-Je;ke[Te+40]=Ye+De,ke[Te+24]=Ye-De,ke[Te+8]=Ge+pe,ke[Te+56]=Ge-pe,Te++}for(nt=0;nt<64;++nt)Se=ke[nt]*qe[nt],h[nt]=Se>0?Se+.5|0:Se-.5|0;return h}(E,Z),Y=0;Y<64;++Y)m[A[Y]]=q[Y];var L=m[0]-H;H=m[0],L==0?_e(F[0]):(_e(F[p[z=32767+L]]),_e(f[z]));for(var U=63;U>0&&m[U]==0;)U--;if(U==0)return _e(X),H;for(var ce,W=1;W<=U;){for(var ae=W;m[W]==0&&W<=U;)++W;var he=W-ae;if(he>=16){ce=he>>4;for(var ze=1;ze<=ce;++ze)_e(J);he&=15}z=32767+m[W],_e(ee[(he<<4)+p[z]]),_e(f[z]),W++}return U!=63&&_e(X),H}function ne(E){E=Math.min(Math.max(E,1),100),s!=E&&(function(Z){for(var H=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],F=0;F<64;F++){var ee=o((H[F]*Z+50)/100);ee=Math.min(Math.max(ee,1),255),l[A[F]]=ee}for(var z=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],X=0;X<64;X++){var J=o((z[X]*Z+50)/100);J=Math.min(Math.max(J,1),255),c[A[X]]=J}for(var q=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Y=0,L=0;L<8;L++)for(var U=0;U<8;U++)u[Y]=1/(l[A[Y]]*q[L]*q[U]*8),d[Y]=1/(c[A[Y]]*q[L]*q[U]*8),Y++}(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),s=E)}this.encode=function(E,Z){Z&&ne(Z),g=new Array,b=0,y=7,K(65496),K(65504),K(16),V(74),V(70),V(73),V(70),V(0),V(1),V(1),V(0),K(1),K(1),V(0),V(0),function(){K(65499),K(132),V(0);for(var Ve=0;Ve<64;Ve++)V(l[Ve]);V(1);for(var Qe=0;Qe<64;Qe++)V(c[Qe])}(),function(Ve,Qe){K(65472),K(17),V(8),K(Qe),K(Ve),V(3),V(1),V(17),V(0),V(2),V(17),V(1),V(3),V(17),V(1)}(E.width,E.height),function(){K(65476),K(418),V(0);for(var Ve=0;Ve<16;Ve++)V(M[Ve+1]);for(var Qe=0;Qe<=11;Qe++)V(P[Qe]);V(16);for(var Tt=0;Tt<16;Tt++)V(R[Tt+1]);for(var vt=0;vt<=161;vt++)V(N[vt]);V(1);for(var Xe=0;Xe<16;Xe++)V(T[Xe+1]);for(var Be=0;Be<=11;Be++)V(B[Be]);V(17);for(var ct=0;ct<16;ct++)V(G[ct+1]);for(var nt=0;nt<=161;nt++)V(re[nt])}(),K(65498),K(12),V(3),V(1),V(0),V(2),V(17),V(3),V(17),V(0),V(63),V(0);var H=0,F=0,ee=0;b=0,y=7,this.encode.displayName="_encode_";for(var z,X,J,q,Y,L,U,ce,W,ae=E.data,he=E.width,ze=E.height,ke=4*he,qe=0;qe<ze;){for(z=0;z<ke;){for(Y=ke*qe+z,U=-1,ce=0,W=0;W<64;W++)L=Y+(ce=W>>3)*ke+(U=4*(7&W)),qe+ce>=ze&&(L-=ke*(qe+1+ce-ze)),z+U>=ke&&(L-=z+U-ke+4),X=ae[L++],J=ae[L++],q=ae[L++],v[W]=(j[X]+j[J+256|0]+j[q+512|0]>>16)-128,w[W]=(j[X+768|0]+j[J+1024|0]+j[q+1280|0]>>16)-128,_[W]=(j[X+1280|0]+j[J+1536|0]+j[q+1792|0]>>16)-128;H=de(v,u,H,t,n),F=de(w,d,F,r,a),ee=de(_,d,ee,r,a),z+=32}qe+=8}if(y>=0){var Ie=[];Ie[1]=y+1,Ie[0]=(1<<y+1)-1,_e(Ie)}return K(65497),new Uint8Array(g)},e=e||50,function(){for(var E=String.fromCharCode,Z=0;Z<256;Z++)C[Z]=E(Z)}(),t=xe(M,P),r=xe(T,B),n=xe(R,N),a=xe(G,re),function(){for(var E=1,Z=2,H=1;H<=15;H++){for(var F=E;F<Z;F++)p[32767+F]=H,f[32767+F]=[],f[32767+F][1]=H,f[32767+F][0]=F;for(var ee=-(Z-1);ee<=-E;ee++)p[32767+ee]=H,f[32767+ee]=[],f[32767+ee][1]=H,f[32767+ee][0]=Z-1+ee;E<<=1,Z<<=1}}(),function(){for(var E=0;E<256;E++)j[E]=19595*E,j[E+256|0]=38470*E,j[E+512|0]=7471*E+32768,j[E+768|0]=-11059*E,j[E+1024|0]=-21709*E,j[E+1280|0]=32768*E+8421375,j[E+1536|0]=-27439*E,j[E+1792|0]=-5329*E}(),ne(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ic(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function aL(e){function t(P){if(!P)throw Error("assert :P")}function r(P,R,N){for(var T=0;4>T;T++)if(P[R+T]!=N.charCodeAt(T))return!0;return!1}function n(P,R,N,T,B){for(var G=0;G<B;G++)P[R+G]=N[T+G]}function a(P,R,N,T){for(var B=0;B<T;B++)P[R+B]=N}function s(P){return new Int32Array(P)}function o(P,R){for(var N=[],T=0;T<P;T++)N.push(new R);return N}function l(P,R){var N=[];return function T(B,G,re){for(var xe=re[G],_e=0;_e<xe&&(B.push(re.length>G+1?[]:new R),!(re.length<G+1));_e++)T(B[_e],G+1,re)}(N,0,P),N}var c=function(){var P=this;function R(S,k){for(var D=1<<k-1>>>0;S&D;)D>>>=1;return D?(S&D-1)+D:S}function N(S,k,D,te,me){t(!(te%D));do S[k+(te-=D)]=me;while(0<te)}function T(S,k,D,te,me){if(t(2328>=me),512>=me)var we=s(512);else if((we=s(me))==null)return 0;return function(Ae,Oe,$e,et,Et,Qt){var tt,Mt,qt=Oe,br=1<<$e,Yt=s(16),wr=s(16);for(t(Et!=0),t(et!=null),t(Ae!=null),t(0<$e),Mt=0;Mt<Et;++Mt){if(15<et[Mt])return 0;++Yt[et[Mt]]}if(Yt[0]==Et)return 0;for(wr[1]=0,tt=1;15>tt;++tt){if(Yt[tt]>1<<tt)return 0;wr[tt+1]=wr[tt]+Yt[tt]}for(Mt=0;Mt<Et;++Mt)tt=et[Mt],0<et[Mt]&&(Qt[wr[tt]++]=Mt);if(wr[15]==1)return(et=new B).g=0,et.value=Qt[0],N(Ae,qt,1,br,et),br;var _r,$r=-1,Mr=br-1,yn=0,ln=1,Un=1,fn=1<<$e;for(Mt=0,tt=1,Et=2;tt<=$e;++tt,Et<<=1){if(ln+=Un<<=1,0>(Un-=Yt[tt]))return 0;for(;0<Yt[tt];--Yt[tt])(et=new B).g=tt,et.value=Qt[Mt++],N(Ae,qt+yn,Et,fn,et),yn=R(yn,tt)}for(tt=$e+1,Et=2;15>=tt;++tt,Et<<=1){if(ln+=Un<<=1,0>(Un-=Yt[tt]))return 0;for(;0<Yt[tt];--Yt[tt]){if(et=new B,(yn&Mr)!=$r){for(qt+=fn,_r=1<<($r=tt)-$e;15>$r&&!(0>=(_r-=Yt[$r]));)++$r,_r<<=1;br+=fn=1<<(_r=$r-$e),Ae[Oe+($r=yn&Mr)].g=_r+$e,Ae[Oe+$r].value=qt-Oe-$r}et.g=tt-$e,et.value=Qt[Mt++],N(Ae,qt+(yn>>$e),Et,fn,et),yn=R(yn,tt)}}return ln!=2*wr[15]-1?0:br}(S,k,D,te,me,we)}function B(){this.value=this.g=0}function G(){this.value=this.g=0}function re(){this.G=o(5,B),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(ed,G)}function xe(S,k,D,te){t(S!=null),t(k!=null),t(2147483648>te),S.Ca=254,S.I=0,S.b=-8,S.Ka=0,S.oa=k,S.pa=D,S.Jd=k,S.Yc=D+te,S.Zc=4<=te?D+te-4+1:D,X(S)}function _e(S,k){for(var D=0;0<k--;)D|=q(S,128)<<k;return D}function V(S,k){var D=_e(S,k);return J(S)?-D:D}function K(S,k,D,te){var me,we=0;for(t(S!=null),t(k!=null),t(4294967288>te),S.Sb=te,S.Ra=0,S.u=0,S.h=0,4<te&&(te=4),me=0;me<te;++me)we+=k[D+me]<<8*me;S.Ra=we,S.bb=te,S.oa=k,S.pa=D}function de(S){for(;8<=S.u&&S.bb<S.Sb;)S.Ra>>>=8,S.Ra+=S.oa[S.pa+S.bb]<<Ec-8>>>0,++S.bb,S.u-=8;F(S)&&(S.h=1,S.u=0)}function ne(S,k){if(t(0<=k),!S.h&&k<=Cs){var D=H(S)&Oo[k];return S.u+=k,de(S),D}return S.h=1,S.u=0}function E(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Z(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function H(S){return S.Ra>>>(S.u&Ec-1)>>>0}function F(S){return t(S.bb<=S.Sb),S.h||S.bb==S.Sb&&S.u>Ec}function ee(S,k){S.u=k,S.h=F(S)}function z(S){S.u>=Gl&&(t(S.u>=Gl),de(S))}function X(S){t(S!=null&&S.oa!=null),S.pa<S.Zc?(S.I=(S.oa[S.pa++]|S.I<<8)>>>0,S.b+=8):(t(S!=null&&S.oa!=null),S.pa<S.Yc?(S.b+=8,S.I=S.oa[S.pa++]|S.I<<8):S.Ka?S.b=0:(S.I<<=8,S.b+=8,S.Ka=1))}function J(S){return _e(S,1)}function q(S,k){var D=S.Ca;0>S.b&&X(S);var te=S.b,me=D*k>>>8,we=(S.I>>>te>me)+0;for(we?(D-=me,S.I-=me+1<<te>>>0):D=me+1,te=D,me=0;256<=te;)me+=8,te>>=8;return te=7^me+Tc[te],S.b-=te,S.Ca=(D<<te)-1,we}function Y(S,k,D){S[k+0]=D>>24&255,S[k+1]=D>>16&255,S[k+2]=D>>8&255,S[k+3]=255&D}function L(S,k){return S[k+0]|S[k+1]<<8}function U(S,k){return L(S,k)|S[k+2]<<16}function ce(S,k){return L(S,k)|L(S,k+2)<<16}function W(S,k){var D=1<<k;return t(S!=null),t(0<k),S.X=s(D),S.X==null?0:(S.Mb=32-k,S.Xa=k,1)}function ae(S,k){t(S!=null),t(k!=null),t(S.Xa==k.Xa),n(k.X,0,S.X,0,1<<k.Xa)}function he(){this.X=[],this.Xa=this.Mb=0}function ze(S,k,D,te){t(D!=null),t(te!=null);var me=D[0],we=te[0];return me==0&&(me=(S*we+k/2)/k),we==0&&(we=(k*me+S/2)/S),0>=me||0>=we?0:(D[0]=me,te[0]=we,1)}function ke(S,k){return S+(1<<k)-1>>>k}function qe(S,k){return((4278255360&S)+(4278255360&k)>>>0&4278255360)+((16711935&S)+(16711935&k)>>>0&16711935)>>>0}function Ie(S,k){P[k]=function(D,te,me,we,Ae,Oe,$e){var et;for(et=0;et<Ae;++et){var Et=P[S](Oe[$e+et-1],me,we+et);Oe[$e+et]=qe(D[te+et],Et)}}}function Ve(){this.ud=this.hd=this.jd=0}function Qe(S,k){return((4278124286&(S^k))>>>1)+(S&k)>>>0}function Tt(S){return 0<=S&&256>S?S:0>S?0:255<S?255:void 0}function vt(S,k){return Tt(S+(S-k+.5>>1))}function Xe(S,k,D){return Math.abs(k-D)-Math.abs(S-D)}function Be(S,k,D,te,me,we,Ae){for(te=we[Ae-1],D=0;D<me;++D)we[Ae+D]=te=qe(S[k+D],te)}function ct(S,k,D,te,me){var we;for(we=0;we<D;++we){var Ae=S[k+we],Oe=Ae>>8&255,$e=16711935&($e=($e=16711935&Ae)+((Oe<<16)+Oe));te[me+we]=(4278255360&Ae)+$e>>>0}}function nt(S,k){k.jd=255&S,k.hd=S>>8&255,k.ud=S>>16&255}function Se(S,k,D,te,me,we){var Ae;for(Ae=0;Ae<te;++Ae){var Oe=k[D+Ae],$e=Oe>>>8,et=Oe,Et=255&(Et=(Et=Oe>>>16)+((S.jd<<24>>24)*($e<<24>>24)>>>5));et=255&(et=(et+=(S.hd<<24>>24)*($e<<24>>24)>>>5)+((S.ud<<24>>24)*(Et<<24>>24)>>>5)),me[we+Ae]=(4278255360&Oe)+(Et<<16)+et}}function Te(S,k,D,te,me){P[k]=function(we,Ae,Oe,$e,et,Et,Qt,tt,Mt){for($e=Qt;$e<tt;++$e)for(Qt=0;Qt<Mt;++Qt)et[Et++]=me(Oe[te(we[Ae++])])},P[S]=function(we,Ae,Oe,$e,et,Et,Qt){var tt=8>>we.b,Mt=we.Ea,qt=we.K[0],br=we.w;if(8>tt)for(we=(1<<we.b)-1,br=(1<<tt)-1;Ae<Oe;++Ae){var Yt,wr=0;for(Yt=0;Yt<Mt;++Yt)Yt&we||(wr=te($e[et++])),Et[Qt++]=me(qt[wr&br]),wr>>=tt}else P["VP8LMapColor"+D]($e,et,qt,br,Et,Qt,Ae,Oe,Mt)}}function Dt(S,k,D,te,me){for(D=k+D;k<D;){var we=S[k++];te[me++]=we>>16&255,te[me++]=we>>8&255,te[me++]=255&we}}function wt(S,k,D,te,me){for(D=k+D;k<D;){var we=S[k++];te[me++]=we>>16&255,te[me++]=we>>8&255,te[me++]=255&we,te[me++]=we>>24&255}}function Pt(S,k,D,te,me){for(D=k+D;k<D;){var we=(Ae=S[k++])>>16&240|Ae>>12&15,Ae=240&Ae|Ae>>28&15;te[me++]=we,te[me++]=Ae}}function Wt(S,k,D,te,me){for(D=k+D;k<D;){var we=(Ae=S[k++])>>16&248|Ae>>13&7,Ae=Ae>>5&224|Ae>>3&31;te[me++]=we,te[me++]=Ae}}function Ot(S,k,D,te,me){for(D=k+D;k<D;){var we=S[k++];te[me++]=255&we,te[me++]=we>>8&255,te[me++]=we>>16&255}}function Ht(S,k,D,te,me,we){if(we==0)for(D=k+D;k<D;)Y(te,((we=S[k++])[0]>>24|we[1]>>8&65280|we[2]<<8&16711680|we[3]<<24)>>>0),me+=32;else n(te,me,S,k,D)}function Pr(S,k){P[k][0]=P[S+"0"],P[k][1]=P[S+"1"],P[k][2]=P[S+"2"],P[k][3]=P[S+"3"],P[k][4]=P[S+"4"],P[k][5]=P[S+"5"],P[k][6]=P[S+"6"],P[k][7]=P[S+"7"],P[k][8]=P[S+"8"],P[k][9]=P[S+"9"],P[k][10]=P[S+"10"],P[k][11]=P[S+"11"],P[k][12]=P[S+"12"],P[k][13]=P[S+"13"],P[k][14]=P[S+"0"],P[k][15]=P[S+"0"]}function jt(S){return S==W_||S==q_||S==By||S==H_}function ur(){this.eb=[],this.size=this.A=this.fb=0}function Ir(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Rr(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ur,this.f.kb=new Ir,this.sd=null}function Nr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function zr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _n(S){return alert("todo:WebPSamplerProcessPlane"),S.T}function Yr(S,k){var D=S.T,te=k.ba.f.RGBA,me=te.eb,we=te.fb+S.ka*te.A,Ae=Jl[k.ba.S],Oe=S.y,$e=S.O,et=S.f,Et=S.N,Qt=S.ea,tt=S.W,Mt=k.cc,qt=k.dc,br=k.Mc,Yt=k.Nc,wr=S.ka,_r=S.ka+S.T,$r=S.U,Mr=$r+1>>1;for(wr==0?Ae(Oe,$e,null,null,et,Et,Qt,tt,et,Et,Qt,tt,me,we,null,null,$r):(Ae(k.ec,k.fc,Oe,$e,Mt,qt,br,Yt,et,Et,Qt,tt,me,we-te.A,me,we,$r),++D);wr+2<_r;wr+=2)Mt=et,qt=Et,br=Qt,Yt=tt,Et+=S.Rc,tt+=S.Rc,we+=2*te.A,Ae(Oe,($e+=2*S.fa)-S.fa,Oe,$e,Mt,qt,br,Yt,et,Et,Qt,tt,me,we-te.A,me,we,$r);return $e+=S.fa,S.j+_r<S.o?(n(k.ec,k.fc,Oe,$e,$r),n(k.cc,k.dc,et,Et,Mr),n(k.Mc,k.Nc,Qt,tt,Mr),D--):1&_r||Ae(Oe,$e,null,null,et,Et,Qt,tt,et,Et,Qt,tt,me,we+te.A,null,null,$r),D}function pn(S,k,D){var te=S.F,me=[S.J];if(te!=null){var we=S.U,Ae=k.ba.S,Oe=Ae==Ry||Ae==By;k=k.ba.f.RGBA;var $e=[0],et=S.ka;$e[0]=S.T,S.Kb&&(et==0?--$e[0]:(--et,me[0]-=S.width),S.j+S.ka+S.T==S.o&&($e[0]=S.o-S.j-et));var Et=k.eb;et=k.fb+et*k.A,S=y6(te,me[0],S.width,we,$e,Et,et+(Oe?0:3),k.A),t(D==$e),S&&jt(Ae)&&mg(Et,et,Oe,we,$e,k.A)}return 0}function ge(S){var k=S.ma,D=k.ba.S,te=11>D,me=D==My||D==Fy||D==Ry||D==z_||D==12||jt(D);if(k.memory=null,k.Ib=null,k.Jb=null,k.Nd=null,!vh(k.Oa,S,me?11:12))return 0;if(me&&jt(D)&&es(),S.da)alert("todo:use_scaling");else{if(te){if(k.Ib=_n,S.Kb){if(D=S.U+1>>1,k.memory=s(S.U+2*D),k.memory==null)return 0;k.ec=k.memory,k.fc=0,k.cc=k.ec,k.dc=k.fc+S.U,k.Mc=k.cc,k.Nc=k.dc+D,k.Ib=Yr,es()}}else alert("todo:EmitYUV");me&&(k.Jb=pn,te&&Kn())}if(te&&!M6){for(S=0;256>S;++S)EK[S]=89858*(S-128)+Dy>>Iy,OK[S]=-22014*(S-128)+Dy,PK[S]=-45773*(S-128),TK[S]=113618*(S-128)+Dy>>Iy;for(S=xg;S<K_;++S)k=76283*(S-16)+Dy>>Iy,LK[S-xg]=fr(k,255),MK[S-xg]=fr(k+8>>4,15);M6=1}return 1}function Ne(S){var k=S.ma,D=S.U,te=S.T;return t(!(1&S.ka)),0>=D||0>=te?0:(D=k.Ib(S,k),k.Jb!=null&&k.Jb(S,k,D),k.Dc+=D,1)}function dt(S){S.ma.memory=null}function Ue(S,k,D,te){return ne(S,8)!=47?0:(k[0]=ne(S,14)+1,D[0]=ne(S,14)+1,te[0]=ne(S,1),ne(S,3)!=0?0:!S.h)}function Re(S,k){if(4>S)return S+1;var D=S-2>>1;return(2+(1&S)<<D)+ne(k,D)+1}function xt(S,k){return 120<k?k-120:1<=(D=((D=mK[k-1])>>4)*S+(8-(15&D)))?D:1;var D}function at(S,k,D){var te=H(D),me=S[k+=255&te].g-8;return 0<me&&(ee(D,D.u+8),te=H(D),k+=S[k].value,k+=te&(1<<me)-1),ee(D,D.u+S[k].g),S[k].value}function er(S,k,D){return D.g+=S.g,D.value+=S.value<<k>>>0,t(8>=D.g),S.g}function oe(S,k,D){var te=S.xc;return t((k=te==0?0:S.vc[S.md*(D>>te)+(k>>te)])<S.Wb),S.Ya[k]}function ue(S,k,D,te){var me=S.ab,we=S.c*k,Ae=S.C;k=Ae+k;var Oe=D,$e=te;for(te=S.Ta,D=S.Ua;0<me--;){var et=S.gc[me],Et=Ae,Qt=k,tt=Oe,Mt=$e,qt=($e=te,Oe=D,et.Ea);switch(t(Et<Qt),t(Qt<=et.nc),et.hc){case 2:Ba(tt,Mt,(Qt-Et)*qt,$e,Oe);break;case 0:var br=Et,Yt=Qt,wr=$e,_r=Oe,$r=(fn=et).Ea;br==0&&(nf(tt,Mt,null,null,1,wr,_r),Be(tt,Mt+1,0,0,$r-1,wr,_r+1),Mt+=$r,_r+=$r,++br);for(var Mr=1<<fn.b,yn=Mr-1,ln=ke($r,fn.b),Un=fn.K,fn=fn.w+(br>>fn.b)*ln;br<Yt;){var aa=Un,ms=fn,zn=1;for(Sh(tt,Mt,wr,_r-$r,1,wr,_r);zn<$r;){var hn=(zn&~yn)+Mr;hn>$r&&(hn=$r),(0,kh[aa[ms++]>>8&15])(tt,Mt+ +zn,wr,_r+zn-$r,hn-zn,wr,_r+zn),zn=hn}Mt+=$r,_r+=$r,++br&yn||(fn+=ln)}Qt!=et.nc&&n($e,Oe-qt,$e,Oe+(Qt-Et-1)*qt,qt);break;case 1:for(qt=tt,Yt=Mt,$r=(tt=et.Ea)-(_r=tt&~(wr=(Mt=1<<et.b)-1)),br=ke(tt,et.b),Mr=et.K,et=et.w+(Et>>et.b)*br;Et<Qt;){for(yn=Mr,ln=et,Un=new Ve,fn=Yt+_r,aa=Yt+tt;Yt<fn;)nt(yn[ln++],Un),jh(Un,qt,Yt,Mt,$e,Oe),Yt+=Mt,Oe+=Mt;Yt<aa&&(nt(yn[ln++],Un),jh(Un,qt,Yt,$r,$e,Oe),Yt+=$r,Oe+=$r),++Et&wr||(et+=br)}break;case 3:if(tt==$e&&Mt==Oe&&0<et.b){for(Yt=$e,tt=qt=Oe+(Qt-Et)*qt-(_r=(Qt-Et)*ke(et.Ea,et.b)),Mt=$e,wr=Oe,br=[],_r=($r=_r)-1;0<=_r;--_r)br[_r]=Mt[wr+_r];for(_r=$r-1;0<=_r;--_r)Yt[tt+_r]=br[_r];za(et,Et,Qt,$e,qt,$e,Oe)}else za(et,Et,Qt,tt,Mt,$e,Oe)}Oe=te,$e=D}$e!=D&&n(te,D,Oe,$e,we)}function Q(S,k){var D=S.V,te=S.Ba+S.c*S.C,me=k-S.C;if(t(k<=S.l.o),t(16>=me),0<me){var we=S.l,Ae=S.Ta,Oe=S.Ua,$e=we.width;if(ue(S,me,D,te),me=Oe=[Oe],t((D=S.C)<(te=k)),t(we.v<we.va),te>we.o&&(te=we.o),D<we.j){var et=we.j-D;D=we.j,me[0]+=et*$e}if(D>=te?D=0:(me[0]+=4*we.v,we.ka=D-we.j,we.U=we.va-we.v,we.T=te-D,D=1),D){if(Oe=Oe[0],11>(D=S.ca).S){var Et=D.f.RGBA,Qt=(te=D.S,me=we.U,we=we.T,et=Et.eb,Et.A),tt=we;for(Et=Et.fb+S.Ma*Et.A;0<tt--;){var Mt=Ae,qt=Oe,br=me,Yt=et,wr=Et;switch(te){case Ly:af(Mt,qt,br,Yt,wr);break;case My:Pc(Mt,qt,br,Yt,wr);break;case W_:Pc(Mt,qt,br,Yt,wr),mg(Yt,wr,0,br,1,0);break;case j6:uu(Mt,qt,br,Yt,wr);break;case Fy:Ht(Mt,qt,br,Yt,wr,1);break;case q_:Ht(Mt,qt,br,Yt,wr,1),mg(Yt,wr,0,br,1,0);break;case Ry:Ht(Mt,qt,br,Yt,wr,0);break;case By:Ht(Mt,qt,br,Yt,wr,0),mg(Yt,wr,1,br,1,0);break;case z_:Kl(Mt,qt,br,Yt,wr);break;case H_:Kl(Mt,qt,br,Yt,wr),x6(Yt,wr,br,1,0);break;case A6:Xl(Mt,qt,br,Yt,wr);break;default:t(0)}Oe+=$e,Et+=Qt}S.Ma+=we}else alert("todo:EmitRescaledRowsYUVA");t(S.Ma<=D.height)}}S.C=k,t(S.C<=S.i)}function ye(S){var k;if(0<S.ua)return 0;for(k=0;k<S.Wb;++k){var D=S.Ya[k].G,te=S.Ya[k].H;if(0<D[1][te[1]+0].g||0<D[2][te[2]+0].g||0<D[3][te[3]+0].g)return 0}return 1}function je(S,k,D,te,me,we){if(S.Z!=0){var Ae=S.qd,Oe=S.rd;for(t(of[S.Z]!=null);k<D;++k)of[S.Z](Ae,Oe,te,me,te,me,we),Ae=te,Oe=me,me+=we;S.qd=Ae,S.rd=Oe}}function Ce(S,k){var D=S.l.ma,te=D.Z==0||D.Z==1?S.l.j:S.C;if(te=S.C<te?te:S.C,t(k<=S.l.o),k>te){var me=S.l.width,we=D.ca,Ae=D.tb+me*te,Oe=S.V,$e=S.Ba+S.c*te,et=S.gc;t(S.ab==1),t(et[0].hc==3),Jo(et[0],te,k,Oe,$e,we,Ae),je(D,te,k,we,Ae,me)}S.C=S.Ma=k}function ot(S,k,D,te,me,we,Ae){var Oe=S.$/te,$e=S.$%te,et=S.m,Et=S.s,Qt=D+S.$,tt=Qt;me=D+te*me;var Mt=D+te*we,qt=280+Et.ua,br=S.Pb?Oe:16777216,Yt=0<Et.ua?Et.Wa:null,wr=Et.wc,_r=Qt<Mt?oe(Et,$e,Oe):null;t(S.C<we),t(Mt<=me);var $r=!1;e:for(;;){for(;$r||Qt<Mt;){var Mr=0;if(Oe>=br){var yn=Qt-D;t((br=S).Pb),br.wd=br.m,br.xd=yn,0<br.s.ua&&ae(br.s.Wa,br.s.vb),br=Oe+xK}if($e&wr||(_r=oe(Et,$e,Oe)),t(_r!=null),_r.Qb&&(k[Qt]=_r.qb,$r=!0),!$r)if(z(et),_r.jc){Mr=et,yn=k;var ln=Qt,Un=_r.pd[H(Mr)&ed-1];t(_r.jc),256>Un.g?(ee(Mr,Mr.u+Un.g),yn[ln]=Un.value,Mr=0):(ee(Mr,Mr.u+Un.g-256),t(256<=Un.value),Mr=Un.value),Mr==0&&($r=!0)}else Mr=at(_r.G[0],_r.H[0],et);if(et.h)break;if($r||256>Mr){if(!$r)if(_r.nd)k[Qt]=(_r.qb|Mr<<8)>>>0;else{if(z(et),$r=at(_r.G[1],_r.H[1],et),z(et),yn=at(_r.G[2],_r.H[2],et),ln=at(_r.G[3],_r.H[3],et),et.h)break;k[Qt]=(ln<<24|$r<<16|Mr<<8|yn)>>>0}if($r=!1,++Qt,++$e>=te&&($e=0,++Oe,Ae!=null&&Oe<=we&&!(Oe%16)&&Ae(S,Oe),Yt!=null))for(;tt<Qt;)Mr=k[tt++],Yt.X[(506832829*Mr&4294967295)>>>Yt.Mb]=Mr}else if(280>Mr){if(Mr=Re(Mr-256,et),yn=at(_r.G[4],_r.H[4],et),z(et),yn=xt(te,yn=Re(yn,et)),et.h)break;if(Qt-D<yn||me-Qt<Mr)break e;for(ln=0;ln<Mr;++ln)k[Qt+ln]=k[Qt+ln-yn];for(Qt+=Mr,$e+=Mr;$e>=te;)$e-=te,++Oe,Ae!=null&&Oe<=we&&!(Oe%16)&&Ae(S,Oe);if(t(Qt<=me),$e&wr&&(_r=oe(Et,$e,Oe)),Yt!=null)for(;tt<Qt;)Mr=k[tt++],Yt.X[(506832829*Mr&4294967295)>>>Yt.Mb]=Mr}else{if(!(Mr<qt))break e;for($r=Mr-280,t(Yt!=null);tt<Qt;)Mr=k[tt++],Yt.X[(506832829*Mr&4294967295)>>>Yt.Mb]=Mr;Mr=Qt,t(!($r>>>(yn=Yt).Xa)),k[Mr]=yn.X[$r],$r=!0}$r||t(et.h==F(et))}if(S.Pb&&et.h&&Qt<me)t(S.m.h),S.a=5,S.m=S.wd,S.$=S.xd,0<S.s.ua&&ae(S.s.vb,S.s.Wa);else{if(et.h)break e;Ae!=null&&Ae(S,Oe>we?we:Oe),S.a=0,S.$=Qt-D}return 1}return S.a=3,0}function it(S){t(S!=null),S.vc=null,S.yc=null,S.Ya=null;var k=S.Wa;k!=null&&(k.X=null),S.vb=null,t(S!=null)}function We(){var S=new jr;return S==null?null:(S.a=0,S.xb=E6,Pr("Predictor","VP8LPredictors"),Pr("Predictor","VP8LPredictors_C"),Pr("PredictorAdd","VP8LPredictorsAdd"),Pr("PredictorAdd","VP8LPredictorsAdd_C"),Ba=ct,jh=Se,af=Dt,Pc=wt,Kl=Pt,Xl=Wt,uu=Ot,P.VP8LMapColor32b=ki,P.VP8LMapColor8b=_h,S)}function De(S,k,D,te,me){var we=1,Ae=[S],Oe=[k],$e=te.m,et=te.s,Et=null,Qt=0;e:for(;;){if(D)for(;we&&ne($e,1);){var tt=Ae,Mt=Oe,qt=te,br=1,Yt=qt.m,wr=qt.gc[qt.ab],_r=ne(Yt,2);if(qt.Oc&1<<_r)we=0;else{switch(qt.Oc|=1<<_r,wr.hc=_r,wr.Ea=tt[0],wr.nc=Mt[0],wr.K=[null],++qt.ab,t(4>=qt.ab),_r){case 0:case 1:wr.b=ne(Yt,3)+2,br=De(ke(wr.Ea,wr.b),ke(wr.nc,wr.b),0,qt,wr.K),wr.K=wr.K[0];break;case 3:var $r,Mr=ne(Yt,8)+1,yn=16<Mr?0:4<Mr?1:2<Mr?2:3;if(tt[0]=ke(wr.Ea,yn),wr.b=yn,$r=br=De(Mr,1,0,qt,wr.K)){var ln,Un=Mr,fn=wr,aa=1<<(8>>fn.b),ms=s(aa);if(ms==null)$r=0;else{var zn=fn.K[0],hn=fn.w;for(ms[0]=fn.K[0][0],ln=1;ln<1*Un;++ln)ms[ln]=qe(zn[hn+ln],ms[ln-1]);for(;ln<4*aa;++ln)ms[ln]=0;fn.K[0]=null,fn.K[0]=ms,$r=1}}br=$r;break;case 2:break;default:t(0)}we=br}}if(Ae=Ae[0],Oe=Oe[0],we&&ne($e,1)&&!(we=1<=(Qt=ne($e,4))&&11>=Qt)){te.a=3;break e}var Jr;if(Jr=we)t:{var Wi,Rn,ia,Qa=te,qs=Ae,Lo=Oe,ji=Qt,lo=D,Mo=Qa.m,gs=Qa.s,oa=[null],Aa=1,Ai=0,Na=gK[ji];r:for(;;){if(lo&&ne(Mo,1)){var Hs=ne(Mo,3)+2,Mc=ke(qs,Hs),qi=ke(Lo,Hs),Zo=Mc*qi;if(!De(Mc,qi,0,Qa,oa))break r;for(oa=oa[0],gs.xc=Hs,Wi=0;Wi<Zo;++Wi){var qa=oa[Wi]>>8&65535;oa[Wi]=qa,qa>=Aa&&(Aa=qa+1)}}if(Mo.h)break r;for(Rn=0;5>Rn;++Rn){var xs=N6[Rn];!Rn&&0<ji&&(xs+=1<<ji),Ai<xs&&(Ai=xs)}var vl=o(Aa*Na,B),Fo=Aa,wl=o(Fo,re);if(wl==null)var Sl=null;else t(65536>=Fo),Sl=wl;var el=s(Ai);if(Sl==null||el==null||vl==null){Qa.a=1;break r}var _l=vl;for(Wi=ia=0;Wi<Aa;++Wi){var Ga=Sl[Wi],kl=Ga.G,Fc=Ga.H,Ah=0,nd=1,Vs=0;for(Rn=0;5>Rn;++Rn){xs=N6[Rn],kl[Rn]=_l,Fc[Rn]=ia,!Rn&&0<ji&&(xs+=1<<ji);a:{var Uy,X_=xs,zy=Qa,yg=el,BK=_l,IK=ia,Y_=0,lf=zy.m,DK=ne(lf,1);if(a(yg,0,0,X_),DK){var $K=ne(lf,1)+1,UK=ne(lf,1),B6=ne(lf,UK==0?1:8);yg[B6]=1,$K==2&&(yg[B6=ne(lf,8)]=1);var Wy=1}else{var I6=s(19),D6=ne(lf,4)+4;if(19<D6){zy.a=3;var qy=0;break a}for(Uy=0;Uy<D6;++Uy)I6[pK[Uy]]=ne(lf,3);var Q_=void 0,bg=void 0,$6=zy,zK=I6,Hy=X_,U6=yg,J_=0,cf=$6.m,z6=8,W6=o(128,B);n:for(;T(W6,0,7,zK,19);){if(ne(cf,1)){var WK=2+2*ne(cf,3);if((Q_=2+ne(cf,WK))>Hy)break n}else Q_=Hy;for(bg=0;bg<Hy&&Q_--;){z(cf);var q6=W6[0+(127&H(cf))];ee(cf,cf.u+q6.g);var np=q6.value;if(16>np)U6[bg++]=np,np!=0&&(z6=np);else{var qK=np==16,H6=np-16,HK=fK[H6],V6=ne(cf,dK[H6])+HK;if(bg+V6>Hy)break n;for(var VK=qK?z6:0;0<V6--;)U6[bg++]=VK}}J_=1;break n}J_||($6.a=3),Wy=J_}(Wy=Wy&&!lf.h)&&(Y_=T(BK,IK,8,yg,X_)),Wy&&Y_!=0?qy=Y_:(zy.a=3,qy=0)}if(qy==0)break r;if(nd&&hK[Rn]==1&&(nd=_l[ia].g==0),Ah+=_l[ia].g,ia+=qy,3>=Rn){var vg,Z_=el[0];for(vg=1;vg<xs;++vg)el[vg]>Z_&&(Z_=el[vg]);Vs+=Z_}}if(Ga.nd=nd,Ga.Qb=0,nd&&(Ga.qb=(kl[3][Fc[3]+0].value<<24|kl[1][Fc[1]+0].value<<16|kl[2][Fc[2]+0].value)>>>0,Ah==0&&256>kl[0][Fc[0]+0].value&&(Ga.Qb=1,Ga.qb+=kl[0][Fc[0]+0].value<<8)),Ga.jc=!Ga.Qb&&6>Vs,Ga.jc){var Vy,ad=Ga;for(Vy=0;Vy<ed;++Vy){var uf=Vy,df=ad.pd[uf],Gy=ad.G[0][ad.H[0]+uf];256<=Gy.value?(df.g=Gy.g+256,df.value=Gy.value):(df.g=0,df.value=0,uf>>=er(Gy,8,df),uf>>=er(ad.G[1][ad.H[1]+uf],16,df),uf>>=er(ad.G[2][ad.H[2]+uf],0,df),er(ad.G[3][ad.H[3]+uf],24,df))}}}gs.vc=oa,gs.Wb=Aa,gs.Ya=Sl,gs.yc=vl,Jr=1;break t}Jr=0}if(!(we=Jr)){te.a=3;break e}if(0<Qt){if(et.ua=1<<Qt,!W(et.Wa,Qt)){te.a=1,we=0;break e}}else et.ua=0;var e5=te,G6=Ae,GK=Oe,t5=e5.s,r5=t5.xc;if(e5.c=G6,e5.i=GK,t5.md=ke(G6,r5),t5.wc=r5==0?-1:(1<<r5)-1,D){te.xb=kK;break e}if((Et=s(Ae*Oe))==null){te.a=1,we=0;break e}we=(we=ot(te,Et,0,Ae,Oe,Oe,null))&&!$e.h;break e}return we?(me!=null?me[0]=Et:(t(Et==null),t(D)),te.$=0,D||it(et)):it(et),we}function pe(S,k){var D=S.c*S.i,te=D+k+16*k;return t(S.c<=k),S.V=s(te),S.V==null?(S.Ta=null,S.Ua=0,S.a=1,0):(S.Ta=S.V,S.Ua=S.Ba+D+k,1)}function Je(S,k){var D=S.C,te=k-D,me=S.V,we=S.Ba+S.c*D;for(t(k<=S.l.o);0<te;){var Ae=16<te?16:te,Oe=S.l.ma,$e=S.l.width,et=$e*Ae,Et=Oe.ca,Qt=Oe.tb+$e*D,tt=S.Ta,Mt=S.Ua;ue(S,Ae,me,we),b6(tt,Mt,Et,Qt,et),je(Oe,D,D+Ae,Et,Qt,$e),te-=Ae,me+=Ae*S.c,D+=Ae}t(D==k),S.C=S.Ma=k}function Ge(){this.ub=this.yd=this.td=this.Rb=0}function Ye(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ft(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function bt(){this.Yb=function(){var S=[];return function k(D,te,me){for(var we=me[te],Ae=0;Ae<we&&(D.push(me.length>te+1?[]:0),!(me.length<te+1));Ae++)k(D[Ae],te+1,me)}(S,0,[3,11]),S}()}function Vt(){this.jb=s(3),this.Wc=l([4,8],bt),this.Xc=l([4,17],bt)}function Ft(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function gr(){this.ld=this.La=this.dd=this.tc=0}function Ar(){this.Na=this.la=0}function kr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function At(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ut(){this.uc=this.M=this.Nb=0,this.wa=Array(new gr),this.Y=0,this.ya=Array(new At),this.aa=0,this.l=new Or}function Kr(){this.y=s(16),this.f=s(8),this.ea=s(8)}function $t(){this.cb=this.a=0,this.sc="",this.m=new E,this.Od=new Ge,this.Kc=new Ye,this.ed=new Ft,this.Qa=new ft,this.Ic=this.$c=this.Aa=0,this.D=new Ut,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,E),this.ia=0,this.pb=o(4,kr),this.Pa=new Vt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Kr),this.Hd=0,this.rb=Array(new Ar),this.sb=0,this.wa=Array(new gr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new At),this.L=this.aa=0,this.gd=l([4,2],gr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function fr(S,k){return 0>S?0:S>k?k:S}function Or(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function gt(){var S=new $t;return S!=null&&(S.a=0,S.sc="OK",S.cb=0,S.Xb=0,gg||(gg=rr)),S}function Jt(S,k,D){return S.a==0&&(S.a=k,S.sc=D,S.cb=0),0}function ht(S,k,D){return 3<=D&&S[k+0]==157&&S[k+1]==1&&S[k+2]==42}function Ct(S,k){if(S==null)return 0;if(S.a=0,S.sc="OK",k==null)return Jt(S,2,"null VP8Io passed to VP8GetHeaders()");var D=k.data,te=k.w,me=k.ha;if(4>me)return Jt(S,7,"Truncated header.");var we=D[te+0]|D[te+1]<<8|D[te+2]<<16,Ae=S.Od;if(Ae.Rb=!(1&we),Ae.td=we>>1&7,Ae.yd=we>>4&1,Ae.ub=we>>5,3<Ae.td)return Jt(S,3,"Incorrect keyframe parameters.");if(!Ae.yd)return Jt(S,4,"Frame not displayable.");te+=3,me-=3;var Oe=S.Kc;if(Ae.Rb){if(7>me)return Jt(S,7,"cannot parse picture header");if(!ht(D,te,me))return Jt(S,3,"Bad code word");Oe.c=16383&(D[te+4]<<8|D[te+3]),Oe.Td=D[te+4]>>6,Oe.i=16383&(D[te+6]<<8|D[te+5]),Oe.Ud=D[te+6]>>6,te+=7,me-=7,S.za=Oe.c+15>>4,S.Ub=Oe.i+15>>4,k.width=Oe.c,k.height=Oe.i,k.Da=0,k.j=0,k.v=0,k.va=k.width,k.o=k.height,k.da=0,k.ib=k.width,k.hb=k.height,k.U=k.width,k.T=k.height,a((we=S.Pa).jb,0,255,we.jb.length),t((we=S.Qa)!=null),we.Cb=0,we.Bb=0,we.Fb=1,a(we.Zb,0,0,we.Zb.length),a(we.Lb,0,0,we.Lb)}if(Ae.ub>me)return Jt(S,7,"bad partition length");xe(we=S.m,D,te,Ae.ub),te+=Ae.ub,me-=Ae.ub,Ae.Rb&&(Oe.Ld=J(we),Oe.Kd=J(we)),Oe=S.Qa;var $e,et=S.Pa;if(t(we!=null),t(Oe!=null),Oe.Cb=J(we),Oe.Cb){if(Oe.Bb=J(we),J(we)){for(Oe.Fb=J(we),$e=0;4>$e;++$e)Oe.Zb[$e]=J(we)?V(we,7):0;for($e=0;4>$e;++$e)Oe.Lb[$e]=J(we)?V(we,6):0}if(Oe.Bb)for($e=0;3>$e;++$e)et.jb[$e]=J(we)?_e(we,8):255}else Oe.Bb=0;if(we.Ka)return Jt(S,3,"cannot parse segment header");if((Oe=S.ed).zd=J(we),Oe.Tb=_e(we,6),Oe.wb=_e(we,3),Oe.Pc=J(we),Oe.Pc&&J(we)){for(et=0;4>et;++et)J(we)&&(Oe.vd[et]=V(we,6));for(et=0;4>et;++et)J(we)&&(Oe.od[et]=V(we,6))}if(S.L=Oe.Tb==0?0:Oe.zd?1:2,we.Ka)return Jt(S,3,"cannot parse filter header");var Et=me;if(me=$e=te,te=$e+Et,Oe=Et,S.Xb=(1<<_e(S.m,2))-1,Et<3*(et=S.Xb))D=7;else{for($e+=3*et,Oe-=3*et,Et=0;Et<et;++Et){var Qt=D[me+0]|D[me+1]<<8|D[me+2]<<16;Qt>Oe&&(Qt=Oe),xe(S.Jc[+Et],D,$e,Qt),$e+=Qt,Oe-=Qt,me+=3}xe(S.Jc[+et],D,$e,Oe),D=$e<te?0:5}if(D!=0)return Jt(S,D,"cannot parse partitions");for(D=_e($e=S.m,7),me=J($e)?V($e,4):0,te=J($e)?V($e,4):0,Oe=J($e)?V($e,4):0,et=J($e)?V($e,4):0,$e=J($e)?V($e,4):0,Et=S.Qa,Qt=0;4>Qt;++Qt){if(Et.Cb){var tt=Et.Zb[Qt];Et.Fb||(tt+=D)}else{if(0<Qt){S.pb[Qt]=S.pb[0];continue}tt=D}var Mt=S.pb[Qt];Mt.Sc[0]=V_[fr(tt+me,127)],Mt.Sc[1]=G_[fr(tt+0,127)],Mt.Eb[0]=2*V_[fr(tt+te,127)],Mt.Eb[1]=101581*G_[fr(tt+Oe,127)]>>16,8>Mt.Eb[1]&&(Mt.Eb[1]=8),Mt.Qc[0]=V_[fr(tt+et,117)],Mt.Qc[1]=G_[fr(tt+$e,127)],Mt.lc=tt+$e}if(!Ae.Rb)return Jt(S,4,"Not a key frame.");for(J(we),Ae=S.Pa,D=0;4>D;++D){for(me=0;8>me;++me)for(te=0;3>te;++te)for(Oe=0;11>Oe;++Oe)et=q(we,SK[D][me][te][Oe])?_e(we,8):vK[D][me][te][Oe],Ae.Wc[D][me].Yb[te][Oe]=et;for(me=0;17>me;++me)Ae.Xc[D][me]=Ae.Wc[D][_K[me]]}return S.kc=J(we),S.kc&&(S.Bd=_e(we,8)),S.cb=1}function rr(S,k,D,te,me,we,Ae){var Oe=k[me].Yb[D];for(D=0;16>me;++me){if(!q(S,Oe[D+0]))return me;for(;!q(S,Oe[D+1]);)if(Oe=k[++me].Yb[0],D=0,me==16)return 16;var $e=k[me+1].Yb;if(q(S,Oe[D+2])){var et=S,Et=0;if(q(et,(tt=Oe)[(Qt=D)+3]))if(q(et,tt[Qt+6])){for(Oe=0,Qt=2*(Et=q(et,tt[Qt+8]))+(tt=q(et,tt[Qt+9+Et])),Et=0,tt=yK[Qt];tt[Oe];++Oe)Et+=Et+q(et,tt[Oe]);Et+=3+(8<<Qt)}else q(et,tt[Qt+7])?(Et=7+2*q(et,165),Et+=q(et,145)):Et=5+q(et,159);else Et=q(et,tt[Qt+4])?3+q(et,tt[Qt+5]):2;Oe=$e[2]}else Et=1,Oe=$e[1];$e=Ae+bK[me],0>(et=S).b&&X(et);var Qt,tt=et.b,Mt=(Qt=et.Ca>>1)-(et.I>>tt)>>31;--et.b,et.Ca+=Mt,et.Ca|=1,et.I-=(Qt+1&Mt)<<tt,we[$e]=((Et^Mt)-Mt)*te[(0<me)+0]}return 16}function kt(S){var k=S.rb[S.sb-1];k.la=0,k.Na=0,a(S.zc,0,0,S.zc.length),S.ja=0}function rt(S,k,D,te,me){me=S[k+D+32*te]+(me>>3),S[k+D+32*te]=-256&me?0>me?0:255:me}function Rt(S,k,D,te,me,we){rt(S,k,0,D,te+me),rt(S,k,1,D,te+we),rt(S,k,2,D,te-we),rt(S,k,3,D,te-me)}function Gt(S){return(20091*S>>16)+S}function ir(S,k,D,te){var me,we=0,Ae=s(16);for(me=0;4>me;++me){var Oe=S[k+0]+S[k+8],$e=S[k+0]-S[k+8],et=(35468*S[k+4]>>16)-Gt(S[k+12]),Et=Gt(S[k+4])+(35468*S[k+12]>>16);Ae[we+0]=Oe+Et,Ae[we+1]=$e+et,Ae[we+2]=$e-et,Ae[we+3]=Oe-Et,we+=4,k++}for(me=we=0;4>me;++me)Oe=(S=Ae[we+0]+4)+Ae[we+8],$e=S-Ae[we+8],et=(35468*Ae[we+4]>>16)-Gt(Ae[we+12]),rt(D,te,0,0,Oe+(Et=Gt(Ae[we+4])+(35468*Ae[we+12]>>16))),rt(D,te,1,0,$e+et),rt(D,te,2,0,$e-et),rt(D,te,3,0,Oe-Et),we++,te+=32}function Bt(S,k,D,te){var me=S[k+0]+4,we=35468*S[k+4]>>16,Ae=Gt(S[k+4]),Oe=35468*S[k+1]>>16;Rt(D,te,0,me+Ae,S=Gt(S[k+1]),Oe),Rt(D,te,1,me+we,S,Oe),Rt(D,te,2,me-we,S,Oe),Rt(D,te,3,me-Ae,S,Oe)}function vr(S,k,D,te,me){ir(S,k,D,te),me&&ir(S,k+16,D,te+4)}function Cr(S,k,D,te){du(S,k+0,D,te,1),du(S,k+32,D,te+128,1)}function Tr(S,k,D,te){var me;for(S=S[k+0]+4,me=0;4>me;++me)for(k=0;4>k;++k)rt(D,te,k,me,S)}function xr(S,k,D,te){S[k+0]&&Sa(S,k+0,D,te),S[k+16]&&Sa(S,k+16,D,te+4),S[k+32]&&Sa(S,k+32,D,te+128),S[k+48]&&Sa(S,k+48,D,te+128+4)}function Xt(S,k,D,te){var me,we=s(16);for(me=0;4>me;++me){var Ae=S[k+0+me]+S[k+12+me],Oe=S[k+4+me]+S[k+8+me],$e=S[k+4+me]-S[k+8+me],et=S[k+0+me]-S[k+12+me];we[0+me]=Ae+Oe,we[8+me]=Ae-Oe,we[4+me]=et+$e,we[12+me]=et-$e}for(me=0;4>me;++me)Ae=(S=we[0+4*me]+3)+we[3+4*me],Oe=we[1+4*me]+we[2+4*me],$e=we[1+4*me]-we[2+4*me],et=S-we[3+4*me],D[te+0]=Ae+Oe>>3,D[te+16]=et+$e>>3,D[te+32]=Ae-Oe>>3,D[te+48]=et-$e>>3,te+=64}function ie(S,k,D){var te,me=k-32,we=bl,Ae=255-S[me-1];for(te=0;te<D;++te){var Oe,$e=we,et=Ae+S[k-1];for(Oe=0;Oe<D;++Oe)S[k+Oe]=$e[et+S[me+Oe]];k+=32}}function I(S,k){ie(S,k,4)}function se(S,k){ie(S,k,8)}function ve(S,k){ie(S,k,16)}function Pe(S,k){var D;for(D=0;16>D;++D)n(S,k+32*D,S,k-32,16)}function Ke(S,k){var D;for(D=16;0<D;--D)a(S,k,S[k-1],16),k+=32}function pt(S,k,D){var te;for(te=0;16>te;++te)a(k,D+32*te,S,16)}function ut(S,k){var D,te=16;for(D=0;16>D;++D)te+=S[k-1+32*D]+S[k+D-32];pt(te>>5,S,k)}function Lt(S,k){var D,te=8;for(D=0;16>D;++D)te+=S[k-1+32*D];pt(te>>4,S,k)}function Sr(S,k){var D,te=8;for(D=0;16>D;++D)te+=S[k+D-32];pt(te>>4,S,k)}function hr(S,k){pt(128,S,k)}function mt(S,k,D){return S+2*k+D+2>>2}function _t(S,k){var D,te=k-32;for(te=new Uint8Array([mt(S[te-1],S[te+0],S[te+1]),mt(S[te+0],S[te+1],S[te+2]),mt(S[te+1],S[te+2],S[te+3]),mt(S[te+2],S[te+3],S[te+4])]),D=0;4>D;++D)n(S,k+32*D,te,0,te.length)}function cr(S,k){var D=S[k-1],te=S[k-1+32],me=S[k-1+64],we=S[k-1+96];Y(S,k+0,16843009*mt(S[k-1-32],D,te)),Y(S,k+32,16843009*mt(D,te,me)),Y(S,k+64,16843009*mt(te,me,we)),Y(S,k+96,16843009*mt(me,we,we))}function sr(S,k){var D,te=4;for(D=0;4>D;++D)te+=S[k+D-32]+S[k-1+32*D];for(te>>=3,D=0;4>D;++D)a(S,k+32*D,te,4)}function pr(S,k){var D=S[k-1+0],te=S[k-1+32],me=S[k-1+64],we=S[k-1-32],Ae=S[k+0-32],Oe=S[k+1-32],$e=S[k+2-32],et=S[k+3-32];S[k+0+96]=mt(te,me,S[k-1+96]),S[k+1+96]=S[k+0+64]=mt(D,te,me),S[k+2+96]=S[k+1+64]=S[k+0+32]=mt(we,D,te),S[k+3+96]=S[k+2+64]=S[k+1+32]=S[k+0+0]=mt(Ae,we,D),S[k+3+64]=S[k+2+32]=S[k+1+0]=mt(Oe,Ae,we),S[k+3+32]=S[k+2+0]=mt($e,Oe,Ae),S[k+3+0]=mt(et,$e,Oe)}function Dr(S,k){var D=S[k+1-32],te=S[k+2-32],me=S[k+3-32],we=S[k+4-32],Ae=S[k+5-32],Oe=S[k+6-32],$e=S[k+7-32];S[k+0+0]=mt(S[k+0-32],D,te),S[k+1+0]=S[k+0+32]=mt(D,te,me),S[k+2+0]=S[k+1+32]=S[k+0+64]=mt(te,me,we),S[k+3+0]=S[k+2+32]=S[k+1+64]=S[k+0+96]=mt(me,we,Ae),S[k+3+32]=S[k+2+64]=S[k+1+96]=mt(we,Ae,Oe),S[k+3+64]=S[k+2+96]=mt(Ae,Oe,$e),S[k+3+96]=mt(Oe,$e,$e)}function qr(S,k){var D=S[k-1+0],te=S[k-1+32],me=S[k-1+64],we=S[k-1-32],Ae=S[k+0-32],Oe=S[k+1-32],$e=S[k+2-32],et=S[k+3-32];S[k+0+0]=S[k+1+64]=we+Ae+1>>1,S[k+1+0]=S[k+2+64]=Ae+Oe+1>>1,S[k+2+0]=S[k+3+64]=Oe+$e+1>>1,S[k+3+0]=$e+et+1>>1,S[k+0+96]=mt(me,te,D),S[k+0+64]=mt(te,D,we),S[k+0+32]=S[k+1+96]=mt(D,we,Ae),S[k+1+32]=S[k+2+96]=mt(we,Ae,Oe),S[k+2+32]=S[k+3+96]=mt(Ae,Oe,$e),S[k+3+32]=mt(Oe,$e,et)}function Ur(S,k){var D=S[k+0-32],te=S[k+1-32],me=S[k+2-32],we=S[k+3-32],Ae=S[k+4-32],Oe=S[k+5-32],$e=S[k+6-32],et=S[k+7-32];S[k+0+0]=D+te+1>>1,S[k+1+0]=S[k+0+64]=te+me+1>>1,S[k+2+0]=S[k+1+64]=me+we+1>>1,S[k+3+0]=S[k+2+64]=we+Ae+1>>1,S[k+0+32]=mt(D,te,me),S[k+1+32]=S[k+0+96]=mt(te,me,we),S[k+2+32]=S[k+1+96]=mt(me,we,Ae),S[k+3+32]=S[k+2+96]=mt(we,Ae,Oe),S[k+3+64]=mt(Ae,Oe,$e),S[k+3+96]=mt(Oe,$e,et)}function Qr(S,k){var D=S[k-1+0],te=S[k-1+32],me=S[k-1+64],we=S[k-1+96];S[k+0+0]=D+te+1>>1,S[k+2+0]=S[k+0+32]=te+me+1>>1,S[k+2+32]=S[k+0+64]=me+we+1>>1,S[k+1+0]=mt(D,te,me),S[k+3+0]=S[k+1+32]=mt(te,me,we),S[k+3+32]=S[k+1+64]=mt(me,we,we),S[k+3+64]=S[k+2+64]=S[k+0+96]=S[k+1+96]=S[k+2+96]=S[k+3+96]=we}function on(S,k){var D=S[k-1+0],te=S[k-1+32],me=S[k-1+64],we=S[k-1+96],Ae=S[k-1-32],Oe=S[k+0-32],$e=S[k+1-32],et=S[k+2-32];S[k+0+0]=S[k+2+32]=D+Ae+1>>1,S[k+0+32]=S[k+2+64]=te+D+1>>1,S[k+0+64]=S[k+2+96]=me+te+1>>1,S[k+0+96]=we+me+1>>1,S[k+3+0]=mt(Oe,$e,et),S[k+2+0]=mt(Ae,Oe,$e),S[k+1+0]=S[k+3+32]=mt(D,Ae,Oe),S[k+1+32]=S[k+3+64]=mt(te,D,Ae),S[k+1+64]=S[k+3+96]=mt(me,te,D),S[k+1+96]=mt(we,me,te)}function gn(S,k){var D;for(D=0;8>D;++D)n(S,k+32*D,S,k-32,8)}function ea(S,k){var D;for(D=0;8>D;++D)a(S,k,S[k-1],8),k+=32}function ma(S,k,D){var te;for(te=0;8>te;++te)a(k,D+32*te,S,8)}function ga(S,k){var D,te=8;for(D=0;8>D;++D)te+=S[k+D-32]+S[k-1+32*D];ma(te>>4,S,k)}function ta(S,k){var D,te=4;for(D=0;8>D;++D)te+=S[k+D-32];ma(te>>3,S,k)}function Tn(S,k){var D,te=4;for(D=0;8>D;++D)te+=S[k-1+32*D];ma(te>>3,S,k)}function Me(S,k){ma(128,S,k)}function yt(S,k,D){var te=S[k-D],me=S[k+0],we=3*(me-te)+U_[1020+S[k-2*D]-S[k+D]],Ae=Oy[112+(we+4>>3)];S[k-D]=bl[255+te+Oy[112+(we+3>>3)]],S[k+0]=bl[255+me-Ae]}function fe(S,k,D,te){var me=S[k+0],we=S[k+D];return Ql[255+S[k-2*D]-S[k-D]]>te||Ql[255+we-me]>te}function be(S,k,D,te){return 4*Ql[255+S[k-D]-S[k+0]]+Ql[255+S[k-2*D]-S[k+D]]<=te}function He(S,k,D,te,me){var we=S[k-3*D],Ae=S[k-2*D],Oe=S[k-D],$e=S[k+0],et=S[k+D],Et=S[k+2*D],Qt=S[k+3*D];return 4*Ql[255+Oe-$e]+Ql[255+Ae-et]>te?0:Ql[255+S[k-4*D]-we]<=me&&Ql[255+we-Ae]<=me&&Ql[255+Ae-Oe]<=me&&Ql[255+Qt-Et]<=me&&Ql[255+Et-et]<=me&&Ql[255+et-$e]<=me}function Fe(S,k,D,te){var me=2*te+1;for(te=0;16>te;++te)be(S,k+te,D,me)&&yt(S,k+te,D)}function st(S,k,D,te){var me=2*te+1;for(te=0;16>te;++te)be(S,k+te*D,1,me)&&yt(S,k+te*D,1)}function It(S,k,D,te){var me;for(me=3;0<me;--me)Fe(S,k+=4*D,D,te)}function Nt(S,k,D,te){var me;for(me=3;0<me;--me)st(S,k+=4,D,te)}function or(S,k,D,te,me,we,Ae,Oe){for(we=2*we+1;0<me--;){if(He(S,k,D,we,Ae))if(fe(S,k,D,Oe))yt(S,k,D);else{var $e=S,et=k,Et=D,Qt=$e[et-2*Et],tt=$e[et-Et],Mt=$e[et+0],qt=$e[et+Et],br=$e[et+2*Et],Yt=27*(_r=U_[1020+3*(Mt-tt)+U_[1020+Qt-qt]])+63>>7,wr=18*_r+63>>7,_r=9*_r+63>>7;$e[et-3*Et]=bl[255+$e[et-3*Et]+_r],$e[et-2*Et]=bl[255+Qt+wr],$e[et-Et]=bl[255+tt+Yt],$e[et+0]=bl[255+Mt-Yt],$e[et+Et]=bl[255+qt-wr],$e[et+2*Et]=bl[255+br-_r]}k+=te}}function nr(S,k,D,te,me,we,Ae,Oe){for(we=2*we+1;0<me--;){if(He(S,k,D,we,Ae))if(fe(S,k,D,Oe))yt(S,k,D);else{var $e=S,et=k,Et=D,Qt=$e[et-Et],tt=$e[et+0],Mt=$e[et+Et],qt=Oy[112+(4+(br=3*(tt-Qt))>>3)],br=Oy[112+(br+3>>3)],Yt=qt+1>>1;$e[et-2*Et]=bl[255+$e[et-2*Et]+Yt],$e[et-Et]=bl[255+Qt+br],$e[et+0]=bl[255+tt-qt],$e[et+Et]=bl[255+Mt-Yt]}k+=te}}function Er(S,k,D,te,me,we){or(S,k,D,1,16,te,me,we)}function Br(S,k,D,te,me,we){or(S,k,1,D,16,te,me,we)}function Hr(S,k,D,te,me,we){var Ae;for(Ae=3;0<Ae;--Ae)nr(S,k+=4*D,D,1,16,te,me,we)}function O(S,k,D,te,me,we){var Ae;for(Ae=3;0<Ae;--Ae)nr(S,k+=4,1,D,16,te,me,we)}function le(S,k,D,te,me,we,Ae,Oe){or(S,k,me,1,8,we,Ae,Oe),or(D,te,me,1,8,we,Ae,Oe)}function Le(S,k,D,te,me,we,Ae,Oe){or(S,k,1,me,8,we,Ae,Oe),or(D,te,1,me,8,we,Ae,Oe)}function Ee(S,k,D,te,me,we,Ae,Oe){nr(S,k+4*me,me,1,8,we,Ae,Oe),nr(D,te+4*me,me,1,8,we,Ae,Oe)}function Ze(S,k,D,te,me,we,Ae,Oe){nr(S,k+4,1,me,8,we,Ae,Oe),nr(D,te+4,1,me,8,we,Ae,Oe)}function lt(){this.ba=new Rr,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new zr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function St(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Zt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function tr(){this.ua=0,this.Wa=new he,this.vb=new he,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new re,this.yc=new B}function jr(){this.xb=this.a=0,this.l=new Or,this.ca=new Rr,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Z,this.Pb=0,this.wd=new Z,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new tr,this.ab=0,this.gc=o(4,Zt),this.Oc=0}function zt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Or,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function dr(S,k,D,te,me,we,Ae){for(S=S==null?0:S[k+0],k=0;k<Ae;++k)me[we+k]=S+D[te+k]&255,S=me[we+k]}function en(S,k,D,te,me,we,Ae){var Oe;if(S==null)dr(null,null,D,te,me,we,Ae);else for(Oe=0;Oe<Ae;++Oe)me[we+Oe]=S[k+Oe]+D[te+Oe]&255}function mn(S,k,D,te,me,we,Ae){if(S==null)dr(null,null,D,te,me,we,Ae);else{var Oe,$e=S[k+0],et=$e,Et=$e;for(Oe=0;Oe<Ae;++Oe)et=Et+($e=S[k+Oe])-et,Et=D[te+Oe]+(-256&et?0>et?0:255:et)&255,et=$e,me[we+Oe]=Et}}function vn(S,k,D,te){var me=k.width,we=k.o;if(t(S!=null&&k!=null),0>D||0>=te||D+te>we)return null;if(!S.Cc){if(S.ga==null){var Ae;if(S.ga=new zt,(Ae=S.ga==null)||(Ae=k.width*k.o,t(S.Gb.length==0),S.Gb=s(Ae),S.Uc=0,S.Gb==null?Ae=0:(S.mb=S.Gb,S.nb=S.Uc,S.rc=null,Ae=1),Ae=!Ae),!Ae){Ae=S.ga;var Oe=S.Fa,$e=S.P,et=S.qc,Et=S.mb,Qt=S.nb,tt=$e+1,Mt=et-1,qt=Ae.l;if(t(Oe!=null&&Et!=null&&k!=null),of[0]=null,of[1]=dr,of[2]=en,of[3]=mn,Ae.ca=Et,Ae.tb=Qt,Ae.c=k.width,Ae.i=k.height,t(0<Ae.c&&0<Ae.i),1>=et)k=0;else if(Ae.$a=3&Oe[$e+0],Ae.Z=Oe[$e+0]>>2&3,Ae.Lc=Oe[$e+0]>>4&3,$e=Oe[$e+0]>>6&3,0>Ae.$a||1<Ae.$a||4<=Ae.Z||1<Ae.Lc||$e)k=0;else if(qt.put=Ne,qt.ac=ge,qt.bc=dt,qt.ma=Ae,qt.width=k.width,qt.height=k.height,qt.Da=k.Da,qt.v=k.v,qt.va=k.va,qt.j=k.j,qt.o=k.o,Ae.$a)e:{t(Ae.$a==1),k=We();t:for(;;){if(k==null){k=0;break e}if(t(Ae!=null),Ae.mc=k,k.c=Ae.c,k.i=Ae.i,k.l=Ae.l,k.l.ma=Ae,k.l.width=Ae.c,k.l.height=Ae.i,k.a=0,K(k.m,Oe,tt,Mt),!De(Ae.c,Ae.i,1,k,null)||(k.ab==1&&k.gc[0].hc==3&&ye(k.s)?(Ae.ic=1,Oe=k.c*k.i,k.Ta=null,k.Ua=0,k.V=s(Oe),k.Ba=0,k.V==null?(k.a=1,k=0):k=1):(Ae.ic=0,k=pe(k,Ae.c)),!k))break t;k=1;break e}Ae.mc=null,k=0}else k=Mt>=Ae.c*Ae.i;Ae=!k}if(Ae)return null;S.ga.Lc!=1?S.Ga=0:te=we-D}t(S.ga!=null),t(D+te<=we);e:{if(k=(Oe=S.ga).c,we=Oe.l.o,Oe.$a==0){if(tt=S.rc,Mt=S.Vc,qt=S.Fa,$e=S.P+1+D*k,et=S.mb,Et=S.nb+D*k,t($e<=S.P+S.qc),Oe.Z!=0)for(t(of[Oe.Z]!=null),Ae=0;Ae<te;++Ae)of[Oe.Z](tt,Mt,qt,$e,et,Et,k),tt=et,Mt=Et,Et+=k,$e+=k;else for(Ae=0;Ae<te;++Ae)n(et,Et,qt,$e,k),tt=et,Mt=Et,Et+=k,$e+=k;S.rc=tt,S.Vc=Mt}else{if(t(Oe.mc!=null),k=D+te,t((Ae=Oe.mc)!=null),t(k<=Ae.i),Ae.C>=k)k=1;else if(Oe.ic||Kn(),Oe.ic){Oe=Ae.V,tt=Ae.Ba,Mt=Ae.c;var br=Ae.i,Yt=(qt=1,$e=Ae.$/Mt,et=Ae.$%Mt,Et=Ae.m,Qt=Ae.s,Ae.$),wr=Mt*br,_r=Mt*k,$r=Qt.wc,Mr=Yt<_r?oe(Qt,et,$e):null;t(Yt<=wr),t(k<=br),t(ye(Qt));t:for(;;){for(;!Et.h&&Yt<_r;){if(et&$r||(Mr=oe(Qt,et,$e)),t(Mr!=null),z(Et),256>(br=at(Mr.G[0],Mr.H[0],Et)))Oe[tt+Yt]=br,++Yt,++et>=Mt&&(et=0,++$e<=k&&!($e%16)&&Ce(Ae,$e));else{if(!(280>br)){qt=0;break t}br=Re(br-256,Et);var yn,ln=at(Mr.G[4],Mr.H[4],Et);if(z(Et),!(Yt>=(ln=xt(Mt,ln=Re(ln,Et)))&&wr-Yt>=br)){qt=0;break t}for(yn=0;yn<br;++yn)Oe[tt+Yt+yn]=Oe[tt+Yt+yn-ln];for(Yt+=br,et+=br;et>=Mt;)et-=Mt,++$e<=k&&!($e%16)&&Ce(Ae,$e);Yt<_r&&et&$r&&(Mr=oe(Qt,et,$e))}t(Et.h==F(Et))}Ce(Ae,$e>k?k:$e);break t}!qt||Et.h&&Yt<wr?(qt=0,Ae.a=Et.h?5:3):Ae.$=Yt,k=qt}else k=ot(Ae,Ae.V,Ae.Ba,Ae.c,Ae.i,k,Je);if(!k){te=0;break e}}D+te>=we&&(S.Cc=1),te=1}if(!te)return null;if(S.Cc&&((te=S.ga)!=null&&(te.mc=null),S.ga=null,0<S.Ga))return alert("todo:WebPDequantizeLevels"),null}return S.nb+D*me}function Gn(S,k,D,te,me,we){for(;0<me--;){var Ae,Oe=S,$e=k+(D?1:0),et=S,Et=k+(D?0:3);for(Ae=0;Ae<te;++Ae){var Qt=et[Et+4*Ae];Qt!=255&&(Qt*=32897,Oe[$e+4*Ae+0]=Oe[$e+4*Ae+0]*Qt>>23,Oe[$e+4*Ae+1]=Oe[$e+4*Ae+1]*Qt>>23,Oe[$e+4*Ae+2]=Oe[$e+4*Ae+2]*Qt>>23)}k+=we}}function Fn(S,k,D,te,me){for(;0<te--;){var we;for(we=0;we<D;++we){var Ae=S[k+2*we+0],Oe=15&(et=S[k+2*we+1]),$e=4369*Oe,et=(240&et|et>>4)*$e>>16;S[k+2*we+0]=(240&Ae|Ae>>4)*$e>>16&240|(15&Ae|Ae<<4)*$e>>16>>4&15,S[k+2*we+1]=240&et|Oe}k+=me}}function On(S,k,D,te,me,we,Ae,Oe){var $e,et,Et=255;for(et=0;et<me;++et){for($e=0;$e<te;++$e){var Qt=S[k+$e];we[Ae+4*$e]=Qt,Et&=Qt}k+=D,Ae+=Oe}return Et!=255}function Jn(S,k,D,te,me){var we;for(we=0;we<me;++we)D[te+we]=S[k+we]>>8}function Kn(){mg=Gn,x6=Fn,y6=On,b6=Jn}function wa(S,k,D){P[S]=function(te,me,we,Ae,Oe,$e,et,Et,Qt,tt,Mt,qt,br,Yt,wr,_r,$r){var Mr,yn=$r-1>>1,ln=Oe[$e+0]|et[Et+0]<<16,Un=Qt[tt+0]|Mt[qt+0]<<16;t(te!=null);var fn=3*ln+Un+131074>>2;for(k(te[me+0],255&fn,fn>>16,br,Yt),we!=null&&(fn=3*Un+ln+131074>>2,k(we[Ae+0],255&fn,fn>>16,wr,_r)),Mr=1;Mr<=yn;++Mr){var aa=Oe[$e+Mr]|et[Et+Mr]<<16,ms=Qt[tt+Mr]|Mt[qt+Mr]<<16,zn=ln+aa+Un+ms+524296,hn=zn+2*(aa+Un)>>3;fn=hn+ln>>1,ln=(zn=zn+2*(ln+ms)>>3)+aa>>1,k(te[me+2*Mr-1],255&fn,fn>>16,br,Yt+(2*Mr-1)*D),k(te[me+2*Mr-0],255&ln,ln>>16,br,Yt+(2*Mr-0)*D),we!=null&&(fn=zn+Un>>1,ln=hn+ms>>1,k(we[Ae+2*Mr-1],255&fn,fn>>16,wr,_r+(2*Mr-1)*D),k(we[Ae+2*Mr+0],255&ln,ln>>16,wr,_r+(2*Mr+0)*D)),ln=aa,Un=ms}1&$r||(fn=3*ln+Un+131074>>2,k(te[me+$r-1],255&fn,fn>>16,br,Yt+($r-1)*D),we!=null&&(fn=3*Un+ln+131074>>2,k(we[Ae+$r-1],255&fn,fn>>16,wr,_r+($r-1)*D)))}}function es(){Jl[Ly]=jK,Jl[My]=T6,Jl[j6]=AK,Jl[Fy]=P6,Jl[Ry]=O6,Jl[z_]=L6,Jl[A6]=NK,Jl[W_]=T6,Jl[q_]=P6,Jl[By]=O6,Jl[H_]=L6}function Ya(S){return S&-16384?0>S?0:255:S>>CK}function ra(S,k){return Ya((19077*S>>8)+(26149*k>>8)-14234)}function Yn(S,k,D){return Ya((19077*S>>8)-(6419*k>>8)-(13320*D>>8)+8708)}function Ra(S,k){return Ya((19077*S>>8)+(33050*k>>8)-17685)}function ja(S,k,D,te,me){te[me+0]=ra(S,D),te[me+1]=Yn(S,k,D),te[me+2]=Ra(S,k)}function dn(S,k,D,te,me){te[me+0]=Ra(S,k),te[me+1]=Yn(S,k,D),te[me+2]=ra(S,D)}function fi(S,k,D,te,me){var we=Yn(S,k,D);k=we<<3&224|Ra(S,k)>>3,te[me+0]=248&ra(S,D)|we>>5,te[me+1]=k}function $i(S,k,D,te,me){var we=240&Ra(S,k)|15;te[me+0]=240&ra(S,D)|Yn(S,k,D)>>4,te[me+1]=we}function ts(S,k,D,te,me){te[me+0]=255,ja(S,k,D,te,me+1)}function Ui(S,k,D,te,me){dn(S,k,D,te,me),te[me+3]=255}function xa(S,k,D,te,me){ja(S,k,D,te,me),te[me+3]=255}function Yo(S,k,D){P[S]=function(te,me,we,Ae,Oe,$e,et,Et,Qt){for(var tt=Et+(-2&Qt)*D;Et!=tt;)k(te[me+0],we[Ae+0],Oe[$e+0],et,Et),k(te[me+1],we[Ae+0],Oe[$e+0],et,Et+D),me+=2,++Ae,++$e,Et+=2*D;1&Qt&&k(te[me+0],we[Ae+0],Oe[$e+0],et,Et)}}function rf(S,k,D){return D==0?S==0?k==0?6:5:k==0?4:0:D}function tp(S,k,D,te,me){switch(S>>>30){case 3:du(k,D,te,me,0);break;case 2:Yl(k,D,te,me);break;case 1:Sa(k,D,te,me)}}function Qo(S,k){var D,te,me=k.M,we=k.Nb,Ae=S.oc,Oe=S.pc+40,$e=S.oc,et=S.pc+584,Et=S.oc,Qt=S.pc+600;for(D=0;16>D;++D)Ae[Oe+32*D-1]=129;for(D=0;8>D;++D)$e[et+32*D-1]=129,Et[Qt+32*D-1]=129;for(0<me?Ae[Oe-1-32]=$e[et-1-32]=Et[Qt-1-32]=129:(a(Ae,Oe-32-1,127,21),a($e,et-32-1,127,9),a(Et,Qt-32-1,127,9)),te=0;te<S.za;++te){var tt=k.ya[k.aa+te];if(0<te){for(D=-1;16>D;++D)n(Ae,Oe+32*D-4,Ae,Oe+32*D+12,4);for(D=-1;8>D;++D)n($e,et+32*D-4,$e,et+32*D+4,4),n(Et,Qt+32*D-4,Et,Qt+32*D+4,4)}var Mt=S.Gd,qt=S.Hd+te,br=tt.ad,Yt=tt.Hc;if(0<me&&(n(Ae,Oe-32,Mt[qt].y,0,16),n($e,et-32,Mt[qt].f,0,8),n(Et,Qt-32,Mt[qt].ea,0,8)),tt.Za){var wr=Ae,_r=Oe-32+16;for(0<me&&(te>=S.za-1?a(wr,_r,Mt[qt].y[15],4):n(wr,_r,Mt[qt+1].y,0,4)),D=0;4>D;D++)wr[_r+128+D]=wr[_r+256+D]=wr[_r+384+D]=wr[_r+0+D];for(D=0;16>D;++D,Yt<<=2)wr=Ae,_r=Oe+F6[D],Lc[tt.Ob[D]](wr,_r),tp(Yt,br,16*+D,wr,_r)}else if(wr=rf(te,me,tt.Ob[0]),sf[wr](Ae,Oe),Yt!=0)for(D=0;16>D;++D,Yt<<=2)tp(Yt,br,16*+D,Ae,Oe+F6[D]);for(D=tt.Gc,wr=rf(te,me,tt.Dd),rd[wr]($e,et),rd[wr](Et,Qt),Yt=br,wr=$e,_r=et,255&(tt=0|D)&&(170&tt?fu(Yt,256,wr,_r):Wa(Yt,256,wr,_r)),tt=Et,Yt=Qt,255&(D>>=8)&&(170&D?fu(br,320,tt,Yt):Wa(br,320,tt,Yt)),me<S.Ub-1&&(n(Mt[qt].y,0,Ae,Oe+480,16),n(Mt[qt].f,0,$e,et+224,8),n(Mt[qt].ea,0,Et,Qt+224,8)),D=8*we*S.B,Mt=S.sa,qt=S.ta+16*te+16*we*S.R,br=S.qa,tt=S.ra+8*te+D,Yt=S.Ha,wr=S.Ia+8*te+D,D=0;16>D;++D)n(Mt,qt+D*S.R,Ae,Oe+32*D,16);for(D=0;8>D;++D)n(br,tt+D*S.B,$e,et+32*D,8),n(Yt,wr+D*S.B,Et,Qt+32*D,8)}}function Zu(S,k,D,te,me,we,Ae,Oe,$e){var et=[0],Et=[0],Qt=0,tt=$e!=null?$e.kd:0,Mt=$e??new St;if(S==null||12>D)return 7;Mt.data=S,Mt.w=k,Mt.ha=D,k=[k],D=[D],Mt.gb=[Mt.gb];e:{var qt=k,br=D,Yt=Mt.gb;if(t(S!=null),t(br!=null),t(Yt!=null),Yt[0]=0,12<=br[0]&&!r(S,qt[0],"RIFF")){if(r(S,qt[0]+8,"WEBP")){Yt=3;break e}var wr=ce(S,qt[0]+4);if(12>wr||4294967286<wr){Yt=3;break e}if(tt&&wr>br[0]-8){Yt=7;break e}Yt[0]=wr,qt[0]+=12,br[0]-=12}Yt=0}if(Yt!=0)return Yt;for(wr=0<Mt.gb[0],D=D[0];;){e:{var _r=S;br=k,Yt=D;var $r=et,Mr=Et,yn=qt=[0];if((fn=Qt=[Qt])[0]=0,8>Yt[0])Yt=7;else{if(!r(_r,br[0],"VP8X")){if(ce(_r,br[0]+4)!=10){Yt=3;break e}if(18>Yt[0]){Yt=7;break e}var ln=ce(_r,br[0]+8),Un=1+U(_r,br[0]+12);if(2147483648<=Un*(_r=1+U(_r,br[0]+15))){Yt=3;break e}yn!=null&&(yn[0]=ln),$r!=null&&($r[0]=Un),Mr!=null&&(Mr[0]=_r),br[0]+=18,Yt[0]-=18,fn[0]=1}Yt=0}}if(Qt=Qt[0],qt=qt[0],Yt!=0)return Yt;if(br=!!(2&qt),!wr&&Qt)return 3;if(we!=null&&(we[0]=!!(16&qt)),Ae!=null&&(Ae[0]=br),Oe!=null&&(Oe[0]=0),Ae=et[0],qt=Et[0],Qt&&br&&$e==null){Yt=0;break}if(4>D){Yt=7;break}if(wr&&Qt||!wr&&!Qt&&!r(S,k[0],"ALPH")){D=[D],Mt.na=[Mt.na],Mt.P=[Mt.P],Mt.Sa=[Mt.Sa];e:{ln=S,Yt=k,wr=D;var fn=Mt.gb;$r=Mt.na,Mr=Mt.P,yn=Mt.Sa,Un=22,t(ln!=null),t(wr!=null),_r=Yt[0];var aa=wr[0];for(t($r!=null),t(yn!=null),$r[0]=null,Mr[0]=null,yn[0]=0;;){if(Yt[0]=_r,wr[0]=aa,8>aa){Yt=7;break e}var ms=ce(ln,_r+4);if(4294967286<ms){Yt=3;break e}var zn=8+ms+1&-2;if(Un+=zn,0<fn&&Un>fn){Yt=3;break e}if(!r(ln,_r,"VP8 ")||!r(ln,_r,"VP8L")){Yt=0;break e}if(aa[0]<zn){Yt=7;break e}r(ln,_r,"ALPH")||($r[0]=ln,Mr[0]=_r+8,yn[0]=ms),_r+=zn,aa-=zn}}if(D=D[0],Mt.na=Mt.na[0],Mt.P=Mt.P[0],Mt.Sa=Mt.Sa[0],Yt!=0)break}D=[D],Mt.Ja=[Mt.Ja],Mt.xa=[Mt.xa];e:if(fn=S,Yt=k,wr=D,$r=Mt.gb[0],Mr=Mt.Ja,yn=Mt.xa,ln=Yt[0],_r=!r(fn,ln,"VP8 "),Un=!r(fn,ln,"VP8L"),t(fn!=null),t(wr!=null),t(Mr!=null),t(yn!=null),8>wr[0])Yt=7;else{if(_r||Un){if(fn=ce(fn,ln+4),12<=$r&&fn>$r-12){Yt=3;break e}if(tt&&fn>wr[0]-8){Yt=7;break e}Mr[0]=fn,Yt[0]+=8,wr[0]-=8,yn[0]=Un}else yn[0]=5<=wr[0]&&fn[ln+0]==47&&!(fn[ln+4]>>5),Mr[0]=wr[0];Yt=0}if(D=D[0],Mt.Ja=Mt.Ja[0],Mt.xa=Mt.xa[0],k=k[0],Yt!=0)break;if(4294967286<Mt.Ja)return 3;if(Oe==null||br||(Oe[0]=Mt.xa?2:1),Ae=[Ae],qt=[qt],Mt.xa){if(5>D){Yt=7;break}Oe=Ae,tt=qt,br=we,S==null||5>D?S=0:5<=D&&S[k+0]==47&&!(S[k+4]>>5)?(wr=[0],fn=[0],$r=[0],K(Mr=new Z,S,k,D),Ue(Mr,wr,fn,$r)?(Oe!=null&&(Oe[0]=wr[0]),tt!=null&&(tt[0]=fn[0]),br!=null&&(br[0]=$r[0]),S=1):S=0):S=0}else{if(10>D){Yt=7;break}Oe=qt,S==null||10>D||!ht(S,k+3,D-3)?S=0:(tt=S[k+0]|S[k+1]<<8|S[k+2]<<16,br=16383&(S[k+7]<<8|S[k+6]),S=16383&(S[k+9]<<8|S[k+8]),1&tt||3<(tt>>1&7)||!(tt>>4&1)||tt>>5>=Mt.Ja||!br||!S?S=0:(Ae&&(Ae[0]=br),Oe&&(Oe[0]=S),S=1))}if(!S||(Ae=Ae[0],qt=qt[0],Qt&&(et[0]!=Ae||Et[0]!=qt)))return 3;$e!=null&&($e[0]=Mt,$e.offset=k-$e.w,t(4294967286>k-$e.w),t($e.offset==$e.ha-D));break}return Yt==0||Yt==7&&Qt&&$e==null?(we!=null&&(we[0]|=Mt.na!=null&&0<Mt.na.length),te!=null&&(te[0]=Ae),me!=null&&(me[0]=qt),0):Yt}function vh(S,k,D){var te=k.width,me=k.height,we=0,Ae=0,Oe=te,$e=me;if(k.Da=S!=null&&0<S.Da,k.Da&&(Oe=S.cd,$e=S.bd,we=S.v,Ae=S.j,11>D||(we&=-2,Ae&=-2),0>we||0>Ae||0>=Oe||0>=$e||we+Oe>te||Ae+$e>me))return 0;if(k.v=we,k.j=Ae,k.va=we+Oe,k.o=Ae+$e,k.U=Oe,k.T=$e,k.da=S!=null&&0<S.da,k.da){if(!ze(Oe,$e,D=[S.ib],we=[S.hb]))return 0;k.ib=D[0],k.hb=we[0]}return k.ob=S!=null&&S.ob,k.Kb=S==null||!S.Sd,k.da&&(k.ob=k.ib<3*te/4&&k.hb<3*me/4,k.Kb=0),1}function wh(S){if(S==null)return 2;if(11>S.S){var k=S.f.RGBA;k.fb+=(S.height-1)*k.A,k.A=-k.A}else k=S.f.kb,S=S.height,k.O+=(S-1)*k.fa,k.fa=-k.fa,k.N+=(S-1>>1)*k.Ab,k.Ab=-k.Ab,k.W+=(S-1>>1)*k.Db,k.Db=-k.Db,k.F!=null&&(k.J+=(S-1)*k.lb,k.lb=-k.lb);return 0}function cu(S,k,D,te){if(te==null||0>=S||0>=k)return 2;if(D!=null){if(D.Da){var me=D.cd,we=D.bd,Ae=-2&D.v,Oe=-2&D.j;if(0>Ae||0>Oe||0>=me||0>=we||Ae+me>S||Oe+we>k)return 2;S=me,k=we}if(D.da){if(!ze(S,k,me=[D.ib],we=[D.hb]))return 2;S=me[0],k=we[0]}}te.width=S,te.height=k;e:{var $e=te.width,et=te.height;if(S=te.S,0>=$e||0>=et||!(S>=Ly&&13>S))S=2;else{if(0>=te.Rd&&te.sd==null){Ae=we=me=k=0;var Et=(Oe=$e*R6[S])*et;if(11>S||(we=(et+1)/2*(k=($e+1)/2),S==12&&(Ae=(me=$e)*et)),(et=s(Et+2*we+Ae))==null){S=1;break e}te.sd=et,11>S?(($e=te.f.RGBA).eb=et,$e.fb=0,$e.A=Oe,$e.size=Et):(($e=te.f.kb).y=et,$e.O=0,$e.fa=Oe,$e.Fd=Et,$e.f=et,$e.N=0+Et,$e.Ab=k,$e.Cd=we,$e.ea=et,$e.W=0+Et+we,$e.Db=k,$e.Ed=we,S==12&&($e.F=et,$e.J=0+Et+2*we),$e.Tc=Ae,$e.lb=me)}if(k=1,me=te.S,we=te.width,Ae=te.height,me>=Ly&&13>me)if(11>me)S=te.f.RGBA,k&=(Oe=Math.abs(S.A))*(Ae-1)+we<=S.size,k&=Oe>=we*R6[me],k&=S.eb!=null;else{S=te.f.kb,Oe=(we+1)/2,Et=(Ae+1)/2,$e=Math.abs(S.fa),et=Math.abs(S.Ab);var Qt=Math.abs(S.Db),tt=Math.abs(S.lb),Mt=tt*(Ae-1)+we;k&=$e*(Ae-1)+we<=S.Fd,k&=et*(Et-1)+Oe<=S.Cd,k=(k&=Qt*(Et-1)+Oe<=S.Ed)&$e>=we&et>=Oe&Qt>=Oe,k&=S.y!=null,k&=S.f!=null,k&=S.ea!=null,me==12&&(k&=tt>=we,k&=Mt<=S.Tc,k&=S.F!=null)}else k=0;S=k?0:2}}return S!=0||D!=null&&D.fd&&(S=wh(te)),S}var ed=64,Oo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Cs=24,Ec=32,Gl=8,Tc=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ie("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(S){return S},P.Predictor2=function(S,k,D){return k[D+0]},P.Predictor3=function(S,k,D){return k[D+1]},P.Predictor4=function(S,k,D){return k[D-1]},P.Predictor5=function(S,k,D){return Qe(Qe(S,k[D+1]),k[D+0])},P.Predictor6=function(S,k,D){return Qe(S,k[D-1])},P.Predictor7=function(S,k,D){return Qe(S,k[D+0])},P.Predictor8=function(S,k,D){return Qe(k[D-1],k[D+0])},P.Predictor9=function(S,k,D){return Qe(k[D+0],k[D+1])},P.Predictor10=function(S,k,D){return Qe(Qe(S,k[D-1]),Qe(k[D+0],k[D+1]))},P.Predictor11=function(S,k,D){var te=k[D+0];return 0>=Xe(te>>24&255,S>>24&255,(k=k[D-1])>>24&255)+Xe(te>>16&255,S>>16&255,k>>16&255)+Xe(te>>8&255,S>>8&255,k>>8&255)+Xe(255&te,255&S,255&k)?te:S},P.Predictor12=function(S,k,D){var te=k[D+0];return(Tt((S>>24&255)+(te>>24&255)-((k=k[D-1])>>24&255))<<24|Tt((S>>16&255)+(te>>16&255)-(k>>16&255))<<16|Tt((S>>8&255)+(te>>8&255)-(k>>8&255))<<8|Tt((255&S)+(255&te)-(255&k)))>>>0},P.Predictor13=function(S,k,D){var te=k[D-1];return(vt((S=Qe(S,k[D+0]))>>24&255,te>>24&255)<<24|vt(S>>16&255,te>>16&255)<<16|vt(S>>8&255,te>>8&255)<<8|vt(255&S,255&te))>>>0};var nf=P.PredictorAdd0;P.PredictorAdd1=Be,Ie("Predictor2","PredictorAdd2"),Ie("Predictor3","PredictorAdd3"),Ie("Predictor4","PredictorAdd4"),Ie("Predictor5","PredictorAdd5"),Ie("Predictor6","PredictorAdd6"),Ie("Predictor7","PredictorAdd7"),Ie("Predictor8","PredictorAdd8"),Ie("Predictor9","PredictorAdd9"),Ie("Predictor10","PredictorAdd10"),Ie("Predictor11","PredictorAdd11"),Ie("Predictor12","PredictorAdd12"),Ie("Predictor13","PredictorAdd13");var Sh=P.PredictorAdd2;Te("ColorIndexInverseTransform","MapARGB","32b",function(S){return S>>8&255},function(S){return S}),Te("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(S){return S},function(S){return S>>8&255});var Ba,za=P.ColorIndexInverseTransform,ki=P.MapARGB,Jo=P.VP8LColorIndexInverseTransformAlpha,_h=P.MapAlpha,kh=P.VP8LPredictorsAdd=[];kh.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var jh,af,Pc,Kl,Xl,uu,Oc,du,Yl,fu,Sa,Wa,zi,ps,td,pg,rp,Py,d6,f6,h6,p6,m6,g6,mg,x6,y6,b6,v6=s(511),w6=s(2041),S6=s(225),_6=s(767),k6=0,U_=w6,Oy=S6,bl=_6,Ql=v6,Ly=0,My=1,j6=2,Fy=3,Ry=4,z_=5,A6=6,W_=7,q_=8,By=9,H_=10,dK=[2,3,7],fK=[3,3,11],N6=[280,256,256,256,40],hK=[0,1,1,1,0],pK=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],mK=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],gK=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],xK=8,V_=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],G_=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],gg=null,yK=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],bK=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],C6=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],vK=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],wK=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],SK=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],_K=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],sf=[],Lc=[],rd=[],kK=1,E6=2,of=[],Jl=[];wa("UpsampleRgbLinePair",ja,3),wa("UpsampleBgrLinePair",dn,3),wa("UpsampleRgbaLinePair",xa,4),wa("UpsampleBgraLinePair",Ui,4),wa("UpsampleArgbLinePair",ts,4),wa("UpsampleRgba4444LinePair",$i,2),wa("UpsampleRgb565LinePair",fi,2);var jK=P.UpsampleRgbLinePair,AK=P.UpsampleBgrLinePair,T6=P.UpsampleRgbaLinePair,P6=P.UpsampleBgraLinePair,O6=P.UpsampleArgbLinePair,L6=P.UpsampleRgba4444LinePair,NK=P.UpsampleRgb565LinePair,Iy=16,Dy=1<<Iy-1,xg=-227,K_=482,CK=6,M6=0,EK=s(256),TK=s(256),PK=s(256),OK=s(256),LK=s(K_-xg),MK=s(K_-xg);Yo("YuvToRgbRow",ja,3),Yo("YuvToBgrRow",dn,3),Yo("YuvToRgbaRow",xa,4),Yo("YuvToBgraRow",Ui,4),Yo("YuvToArgbRow",ts,4),Yo("YuvToRgba4444Row",$i,2),Yo("YuvToRgb565Row",fi,2);var F6=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],$y=[0,2,8],FK=[8,7,6,4,4,2,2,2,1,1,1,1],RK=1;this.WebPDecodeRGBA=function(S,k,D,te,me){var we=My,Ae=new lt,Oe=new Rr;Ae.ba=Oe,Oe.S=we,Oe.width=[Oe.width],Oe.height=[Oe.height];var $e=Oe.width,et=Oe.height,Et=new Nr;if(Et==null||S==null)var Qt=2;else t(Et!=null),Qt=Zu(S,k,D,Et.width,Et.height,Et.Pd,Et.Qd,Et.format,null);if(Qt!=0?$e=0:($e!=null&&($e[0]=Et.width[0]),et!=null&&(et[0]=Et.height[0]),$e=1),$e){Oe.width=Oe.width[0],Oe.height=Oe.height[0],te!=null&&(te[0]=Oe.width),me!=null&&(me[0]=Oe.height);e:{if(te=new Or,(me=new St).data=S,me.w=k,me.ha=D,me.kd=1,k=[0],t(me!=null),((S=Zu(me.data,me.w,me.ha,null,null,null,k,null,me))==0||S==7)&&k[0]&&(S=4),(k=S)==0){if(t(Ae!=null),te.data=me.data,te.w=me.w+me.offset,te.ha=me.ha-me.offset,te.put=Ne,te.ac=ge,te.bc=dt,te.ma=Ae,me.xa){if((S=We())==null){Ae=1;break e}if(function(tt,Mt){var qt=[0],br=[0],Yt=[0];t:for(;;){if(tt==null)return 0;if(Mt==null)return tt.a=2,0;if(tt.l=Mt,tt.a=0,K(tt.m,Mt.data,Mt.w,Mt.ha),!Ue(tt.m,qt,br,Yt)){tt.a=3;break t}if(tt.xb=E6,Mt.width=qt[0],Mt.height=br[0],!De(qt[0],br[0],1,tt,null))break t;return 1}return t(tt.a!=0),0}(S,te)){if(te=(k=cu(te.width,te.height,Ae.Oa,Ae.ba))==0){t:{te=S;r:for(;;){if(te==null){te=0;break t}if(t(te.s.yc!=null),t(te.s.Ya!=null),t(0<te.s.Wb),t((D=te.l)!=null),t((me=D.ma)!=null),te.xb!=0){if(te.ca=me.ba,te.tb=me.tb,t(te.ca!=null),!vh(me.Oa,D,Fy)){te.a=2;break r}if(!pe(te,D.width)||D.da)break r;if((D.da||jt(te.ca.S))&&Kn(),11>te.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),te.ca.f.kb.F!=null&&Kn()),te.Pb&&0<te.s.ua&&te.s.vb.X==null&&!W(te.s.vb,te.s.Wa.Xa)){te.a=1;break r}te.xb=0}if(!ot(te,te.V,te.Ba,te.c,te.i,D.o,Q))break r;me.Dc=te.Ma,te=1;break t}t(te.a!=0),te=0}te=!te}te&&(k=S.a)}else k=S.a}else{if((S=new gt)==null){Ae=1;break e}if(S.Fa=me.na,S.P=me.P,S.qc=me.Sa,Ct(S,te)){if((k=cu(te.width,te.height,Ae.Oa,Ae.ba))==0){if(S.Aa=0,D=Ae.Oa,t((me=S)!=null),D!=null){if(0<($e=0>($e=D.Md)?0:100<$e?255:255*$e/100)){for(et=Et=0;4>et;++et)12>(Qt=me.pb[et]).lc&&(Qt.ia=$e*FK[0>Qt.lc?0:Qt.lc]>>3),Et|=Qt.ia;Et&&(alert("todo:VP8InitRandom"),me.ia=1)}me.Ga=D.Id,100<me.Ga?me.Ga=100:0>me.Ga&&(me.Ga=0)}(function(tt,Mt){if(tt==null)return 0;if(Mt==null)return Jt(tt,2,"NULL VP8Io parameter in VP8Decode().");if(!tt.cb&&!Ct(tt,Mt))return 0;if(t(tt.cb),Mt.ac==null||Mt.ac(Mt)){Mt.ob&&(tt.L=0);var qt=$y[tt.L];if(tt.L==2?(tt.yb=0,tt.zb=0):(tt.yb=Mt.v-qt>>4,tt.zb=Mt.j-qt>>4,0>tt.yb&&(tt.yb=0),0>tt.zb&&(tt.zb=0)),tt.Va=Mt.o+15+qt>>4,tt.Hb=Mt.va+15+qt>>4,tt.Hb>tt.za&&(tt.Hb=tt.za),tt.Va>tt.Ub&&(tt.Va=tt.Ub),0<tt.L){var br=tt.ed;for(qt=0;4>qt;++qt){var Yt;if(tt.Qa.Cb){var wr=tt.Qa.Lb[qt];tt.Qa.Fb||(wr+=br.Tb)}else wr=br.Tb;for(Yt=0;1>=Yt;++Yt){var _r=tt.gd[qt][Yt],$r=wr;if(br.Pc&&($r+=br.vd[0],Yt&&($r+=br.od[0])),0<($r=0>$r?0:63<$r?63:$r)){var Mr=$r;0<br.wb&&(Mr=4<br.wb?Mr>>2:Mr>>1)>9-br.wb&&(Mr=9-br.wb),1>Mr&&(Mr=1),_r.dd=Mr,_r.tc=2*$r+Mr,_r.ld=40<=$r?2:15<=$r?1:0}else _r.tc=0;_r.La=Yt}}}qt=0}else Jt(tt,6,"Frame setup failed"),qt=tt.a;if(qt=qt==0){if(qt){tt.$c=0,0<tt.Aa||(tt.Ic=RK);t:{qt=tt.Ic,br=4*(Mr=tt.za);var yn=32*Mr,ln=Mr+1,Un=0<tt.L?Mr*(0<tt.Aa?2:1):0,fn=(tt.Aa==2?2:1)*Mr;if((_r=br+832+(Yt=3*(16*qt+$y[tt.L])/2*yn)+(wr=tt.Fa!=null&&0<tt.Fa.length?tt.Kc.c*tt.Kc.i:0))!=_r)qt=0;else{if(_r>tt.Vb){if(tt.Vb=0,tt.Ec=s(_r),tt.Fc=0,tt.Ec==null){qt=Jt(tt,1,"no memory during frame initialization.");break t}tt.Vb=_r}_r=tt.Ec,$r=tt.Fc,tt.Ac=_r,tt.Bc=$r,$r+=br,tt.Gd=o(yn,Kr),tt.Hd=0,tt.rb=o(ln+1,Ar),tt.sb=1,tt.wa=Un?o(Un,gr):null,tt.Y=0,tt.D.Nb=0,tt.D.wa=tt.wa,tt.D.Y=tt.Y,0<tt.Aa&&(tt.D.Y+=Mr),t(!0),tt.oc=_r,tt.pc=$r,$r+=832,tt.ya=o(fn,At),tt.aa=0,tt.D.ya=tt.ya,tt.D.aa=tt.aa,tt.Aa==2&&(tt.D.aa+=Mr),tt.R=16*Mr,tt.B=8*Mr,Mr=(yn=$y[tt.L])*tt.R,yn=yn/2*tt.B,tt.sa=_r,tt.ta=$r+Mr,tt.qa=tt.sa,tt.ra=tt.ta+16*qt*tt.R+yn,tt.Ha=tt.qa,tt.Ia=tt.ra+8*qt*tt.B+yn,tt.$c=0,$r+=Yt,tt.mb=wr?_r:null,tt.nb=wr?$r:null,t($r+wr<=tt.Fc+tt.Vb),kt(tt),a(tt.Ac,tt.Bc,0,br),qt=1}}if(qt){if(Mt.ka=0,Mt.y=tt.sa,Mt.O=tt.ta,Mt.f=tt.qa,Mt.N=tt.ra,Mt.ea=tt.Ha,Mt.Vd=tt.Ia,Mt.fa=tt.R,Mt.Rc=tt.B,Mt.F=null,Mt.J=0,!k6){for(qt=-255;255>=qt;++qt)v6[255+qt]=0>qt?-qt:qt;for(qt=-1020;1020>=qt;++qt)w6[1020+qt]=-128>qt?-128:127<qt?127:qt;for(qt=-112;112>=qt;++qt)S6[112+qt]=-16>qt?-16:15<qt?15:qt;for(qt=-255;510>=qt;++qt)_6[255+qt]=0>qt?0:255<qt?255:qt;k6=1}Oc=Xt,du=vr,fu=Cr,Sa=Tr,Wa=xr,Yl=Bt,zi=Er,ps=Br,td=le,pg=Le,rp=Hr,Py=O,d6=Ee,f6=Ze,h6=Fe,p6=st,m6=It,g6=Nt,Lc[0]=sr,Lc[1]=I,Lc[2]=_t,Lc[3]=cr,Lc[4]=pr,Lc[5]=qr,Lc[6]=Dr,Lc[7]=Ur,Lc[8]=on,Lc[9]=Qr,sf[0]=ut,sf[1]=ve,sf[2]=Pe,sf[3]=Ke,sf[4]=Lt,sf[5]=Sr,sf[6]=hr,rd[0]=ga,rd[1]=se,rd[2]=gn,rd[3]=ea,rd[4]=Tn,rd[5]=ta,rd[6]=Me,qt=1}else qt=0}qt&&(qt=function(aa,ms){for(aa.M=0;aa.M<aa.Va;++aa.M){var zn,hn=aa.Jc[aa.M&aa.Xb],Jr=aa.m,Wi=aa;for(zn=0;zn<Wi.za;++zn){var Rn=Jr,ia=Wi,Qa=ia.Ac,qs=ia.Bc+4*zn,Lo=ia.zc,ji=ia.ya[ia.aa+zn];if(ia.Qa.Bb?ji.$b=q(Rn,ia.Pa.jb[0])?2+q(Rn,ia.Pa.jb[2]):q(Rn,ia.Pa.jb[1]):ji.$b=0,ia.kc&&(ji.Ad=q(Rn,ia.Bd)),ji.Za=!q(Rn,145)+0,ji.Za){var lo=ji.Ob,Mo=0;for(ia=0;4>ia;++ia){var gs,oa=Lo[0+ia];for(gs=0;4>gs;++gs){oa=wK[Qa[qs+gs]][oa];for(var Aa=C6[q(Rn,oa[0])];0<Aa;)Aa=C6[2*Aa+q(Rn,oa[Aa])];oa=-Aa,Qa[qs+gs]=oa}n(lo,Mo,Qa,qs,4),Mo+=4,Lo[0+ia]=oa}}else oa=q(Rn,156)?q(Rn,128)?1:3:q(Rn,163)?2:0,ji.Ob[0]=oa,a(Qa,qs,oa,4),a(Lo,0,oa,4);ji.Dd=q(Rn,142)?q(Rn,114)?q(Rn,183)?1:3:2:0}if(Wi.m.Ka)return Jt(aa,7,"Premature end-of-partition0 encountered.");for(;aa.ja<aa.za;++aa.ja){if(Wi=hn,Rn=(Jr=aa).rb[Jr.sb-1],Qa=Jr.rb[Jr.sb+Jr.ja],zn=Jr.ya[Jr.aa+Jr.ja],qs=Jr.kc?zn.Ad:0)Rn.la=Qa.la=0,zn.Za||(Rn.Na=Qa.Na=0),zn.Hc=0,zn.Gc=0,zn.ia=0;else{var Ai,Na;if(Rn=Qa,Qa=Wi,qs=Jr.Pa.Xc,Lo=Jr.ya[Jr.aa+Jr.ja],ji=Jr.pb[Lo.$b],ia=Lo.ad,lo=0,Mo=Jr.rb[Jr.sb-1],oa=gs=0,a(ia,lo,0,384),Lo.Za)var Hs=0,Mc=qs[3];else{Aa=s(16);var qi=Rn.Na+Mo.Na;if(qi=gg(Qa,qs[1],qi,ji.Eb,0,Aa,0),Rn.Na=Mo.Na=(0<qi)+0,1<qi)Oc(Aa,0,ia,lo);else{var Zo=Aa[0]+3>>3;for(Aa=0;256>Aa;Aa+=16)ia[lo+Aa]=Zo}Hs=1,Mc=qs[0]}var qa=15&Rn.la,xs=15&Mo.la;for(Aa=0;4>Aa;++Aa){var vl=1&xs;for(Zo=Na=0;4>Zo;++Zo)qa=qa>>1|(vl=(qi=gg(Qa,Mc,qi=vl+(1&qa),ji.Sc,Hs,ia,lo))>Hs)<<7,Na=Na<<2|(3<qi?3:1<qi?2:ia[lo+0]!=0),lo+=16;qa>>=4,xs=xs>>1|vl<<7,gs=(gs<<8|Na)>>>0}for(Mc=qa,Hs=xs>>4,Ai=0;4>Ai;Ai+=2){for(Na=0,qa=Rn.la>>4+Ai,xs=Mo.la>>4+Ai,Aa=0;2>Aa;++Aa){for(vl=1&xs,Zo=0;2>Zo;++Zo)qi=vl+(1&qa),qa=qa>>1|(vl=0<(qi=gg(Qa,qs[2],qi,ji.Qc,0,ia,lo)))<<3,Na=Na<<2|(3<qi?3:1<qi?2:ia[lo+0]!=0),lo+=16;qa>>=2,xs=xs>>1|vl<<5}oa|=Na<<4*Ai,Mc|=qa<<4<<Ai,Hs|=(240&xs)<<Ai}Rn.la=Mc,Mo.la=Hs,Lo.Hc=gs,Lo.Gc=oa,Lo.ia=43690&oa?0:ji.ia,qs=!(gs|oa)}if(0<Jr.L&&(Jr.wa[Jr.Y+Jr.ja]=Jr.gd[zn.$b][zn.Za],Jr.wa[Jr.Y+Jr.ja].La|=!qs),Wi.Ka)return Jt(aa,7,"Premature end-of-file encountered.")}if(kt(aa),Jr=ms,Wi=1,zn=(hn=aa).D,Rn=0<hn.L&&hn.M>=hn.zb&&hn.M<=hn.Va,hn.Aa==0)t:{if(zn.M=hn.M,zn.uc=Rn,Qo(hn,zn),Wi=1,zn=(Na=hn.D).Nb,Rn=(oa=$y[hn.L])*hn.R,Qa=oa/2*hn.B,Aa=16*zn*hn.R,Zo=8*zn*hn.B,qs=hn.sa,Lo=hn.ta-Rn+Aa,ji=hn.qa,ia=hn.ra-Qa+Zo,lo=hn.Ha,Mo=hn.Ia-Qa+Zo,xs=(qa=Na.M)==0,gs=qa>=hn.Va-1,hn.Aa==2&&Qo(hn,Na),Na.uc)for(vl=(qi=hn).D.M,t(qi.D.uc),Na=qi.yb;Na<qi.Hb;++Na){Hs=Na,Mc=vl;var Fo=(wl=(Vs=qi).D).Nb;Ai=Vs.R;var wl=wl.wa[wl.Y+Hs],Sl=Vs.sa,el=Vs.ta+16*Fo*Ai+16*Hs,_l=wl.dd,Ga=wl.tc;if(Ga!=0)if(t(3<=Ga),Vs.L==1)0<Hs&&p6(Sl,el,Ai,Ga+4),wl.La&&g6(Sl,el,Ai,Ga),0<Mc&&h6(Sl,el,Ai,Ga+4),wl.La&&m6(Sl,el,Ai,Ga);else{var kl=Vs.B,Fc=Vs.qa,Ah=Vs.ra+8*Fo*kl+8*Hs,nd=Vs.Ha,Vs=Vs.Ia+8*Fo*kl+8*Hs;Fo=wl.ld,0<Hs&&(ps(Sl,el,Ai,Ga+4,_l,Fo),pg(Fc,Ah,nd,Vs,kl,Ga+4,_l,Fo)),wl.La&&(Py(Sl,el,Ai,Ga,_l,Fo),f6(Fc,Ah,nd,Vs,kl,Ga,_l,Fo)),0<Mc&&(zi(Sl,el,Ai,Ga+4,_l,Fo),td(Fc,Ah,nd,Vs,kl,Ga+4,_l,Fo)),wl.La&&(rp(Sl,el,Ai,Ga,_l,Fo),d6(Fc,Ah,nd,Vs,kl,Ga,_l,Fo))}}if(hn.ia&&alert("todo:DitherRow"),Jr.put!=null){if(Na=16*qa,qa=16*(qa+1),xs?(Jr.y=hn.sa,Jr.O=hn.ta+Aa,Jr.f=hn.qa,Jr.N=hn.ra+Zo,Jr.ea=hn.Ha,Jr.W=hn.Ia+Zo):(Na-=oa,Jr.y=qs,Jr.O=Lo,Jr.f=ji,Jr.N=ia,Jr.ea=lo,Jr.W=Mo),gs||(qa-=oa),qa>Jr.o&&(qa=Jr.o),Jr.F=null,Jr.J=null,hn.Fa!=null&&0<hn.Fa.length&&Na<qa&&(Jr.J=vn(hn,Jr,Na,qa-Na),Jr.F=hn.mb,Jr.F==null&&Jr.F.length==0)){Wi=Jt(hn,3,"Could not decode alpha data.");break t}Na<Jr.j&&(oa=Jr.j-Na,Na=Jr.j,t(!(1&oa)),Jr.O+=hn.R*oa,Jr.N+=hn.B*(oa>>1),Jr.W+=hn.B*(oa>>1),Jr.F!=null&&(Jr.J+=Jr.width*oa)),Na<qa&&(Jr.O+=Jr.v,Jr.N+=Jr.v>>1,Jr.W+=Jr.v>>1,Jr.F!=null&&(Jr.J+=Jr.v),Jr.ka=Na-Jr.j,Jr.U=Jr.va-Jr.v,Jr.T=qa-Na,Wi=Jr.put(Jr))}zn+1!=hn.Ic||gs||(n(hn.sa,hn.ta-Rn,qs,Lo+16*hn.R,Rn),n(hn.qa,hn.ra-Qa,ji,ia+8*hn.B,Qa),n(hn.Ha,hn.Ia-Qa,lo,Mo+8*hn.B,Qa))}if(!Wi)return Jt(aa,6,"Output aborted.")}return 1}(tt,Mt)),Mt.bc!=null&&Mt.bc(Mt),qt&=1}return qt?(tt.cb=0,qt):0})(S,te)||(k=S.a)}}else k=S.a}k==0&&Ae.Oa!=null&&Ae.Oa.fd&&(k=wh(Ae.ba))}Ae=k}we=Ae!=0?null:11>we?Oe.f.RGBA.eb:Oe.f.kb.y}else we=null;return we};var R6=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(P,R){for(var N="",T=0;T<4;T++)N+=String.fromCharCode(P[R++]);return N}function d(P,R){return P[R+0]|P[R+1]<<8}function f(P,R){return(P[R+0]|P[R+1]<<8|P[R+2]<<16)>>>0}function p(P,R){return(P[R+0]|P[R+1]<<8|P[R+2]<<16|P[R+3]<<24)>>>0}new c;var h=[0],m=[0],g=[],b=new c,y=e,v=function(P,R){var N={},T=0,B=!1,G=0,re=0;if(N.frames=[],!function(E,Z){for(var H=0;H<4;H++)if(E[Z+H]!="RIFF".charCodeAt(H))return!0;return!1}(P,R)){for(p(P,R+=4),R+=8;R<P.length;){var xe=u(P,R),_e=p(P,R+=4);R+=4;var V=_e+(1&_e);switch(xe){case"VP8 ":case"VP8L":N.frames[T]===void 0&&(N.frames[T]={}),(ne=N.frames[T]).src_off=B?re:R-8,ne.src_size=G+_e+8,T++,B&&(B=!1,G=0,re=0);break;case"VP8X":(ne=N.header={}).feature_flags=P[R];var K=R+4;ne.canvas_width=1+f(P,K),K+=3,ne.canvas_height=1+f(P,K),K+=3;break;case"ALPH":B=!0,G=V+8,re=R-8;break;case"ANIM":(ne=N.header).bgcolor=p(P,R),K=R+4,ne.loop_count=d(P,K),K+=2;break;case"ANMF":var de,ne;(ne=N.frames[T]={}).offset_x=2*f(P,R),R+=3,ne.offset_y=2*f(P,R),R+=3,ne.width=1+f(P,R),R+=3,ne.height=1+f(P,R),R+=3,ne.duration=f(P,R),R+=3,de=P[R++],ne.dispose=1&de,ne.blend=de>>1&1}xe!="ANMF"&&(R+=V)}return N}}(y,0);v.response=y,v.rgbaoutput=!0,v.dataurl=!1;var w=v.header?v.header:null,_=v.frames?v.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],m=[w.canvas_width];for(var C=0;C<_.length&&_[C].blend!=0;C++);}var j=_[0],A=b.WebPDecodeRGBA(y,j.src_off,j.src_size,m,h);j.rgba=A,j.imgwidth=m[0],j.imgheight=h[0];for(var M=0;M<m[0]*h[0]*4;M++)g[M]=A[M];return this.width=m,this.height=h,this.data=g,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function cge(){var e,t=this.internal.__metadata__.metadata,r=unescape(encodeURIComponent(t));e=this.internal.__metadata__.rawXml?r:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+e.length+" >>"),this.internal.write("stream"),this.internal.write(e),this.internal.write("endstream"),this.internal.write("endobj")}function uge(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(e){var t,r,n,a,s,o,l,c,u,d=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new c,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new o,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new o,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Z=E;Object.defineProperty(this,"pdf",{get:function(){return Z}});var H=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return H},set:function(W){H=!!W}});var F=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return F},set:function(W){F=!!W}});var ee=0;Object.defineProperty(this,"posX",{get:function(){return ee},set:function(W){isNaN(W)||(ee=W)}});var z=0;Object.defineProperty(this,"posY",{get:function(){return z},set:function(W){isNaN(W)||(z=W)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(W){var ae;typeof W=="number"?ae=[W,W,W,W]:((ae=new Array(4))[0]=W[0],ae[1]=W.length>=2?W[1]:ae[0],ae[2]=W.length>=3?W[2]:ae[0],ae[3]=W.length>=4?W[3]:ae[1]),u.margin=ae}});var X=!1;Object.defineProperty(this,"autoPaging",{get:function(){return X},set:function(W){X=W}});var J=0;Object.defineProperty(this,"lastBreak",{get:function(){return J},set:function(W){J=W}});var q=[];Object.defineProperty(this,"pageBreaks",{get:function(){return q},set:function(W){q=W}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(W){W instanceof d&&(u=W)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(W){u.path=W}});var Y=[];Object.defineProperty(this,"ctxStack",{get:function(){return Y},set:function(W){Y=W}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(W){var ae;ae=p(W),this.ctx.fillStyle=ae.style,this.ctx.isFillTransparent=ae.a===0,this.ctx.fillOpacity=ae.a,this.pdf.setFillColor(ae.r,ae.g,ae.b,{a:ae.a}),this.pdf.setTextColor(ae.r,ae.g,ae.b,{a:ae.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(W){var ae=p(W);this.ctx.strokeStyle=ae.style,this.ctx.isStrokeTransparent=ae.a===0,this.ctx.strokeOpacity=ae.a,ae.a===0?this.pdf.setDrawColor(255,255,255):(ae.a,this.pdf.setDrawColor(ae.r,ae.g,ae.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(W){["butt","round","square"].indexOf(W)!==-1&&(this.ctx.lineCap=W,this.pdf.setLineCap(W))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(W){isNaN(W)||(this.ctx.lineWidth=W,this.pdf.setLineWidth(W))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(W){["bevel","round","miter"].indexOf(W)!==-1&&(this.ctx.lineJoin=W,this.pdf.setLineJoin(W))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(W){isNaN(W)||(this.ctx.miterLimit=W,this.pdf.setMiterLimit(W))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(W){this.ctx.textBaseline=W}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(W){["right","end","center","left","start"].indexOf(W)!==-1&&(this.ctx.textAlign=W)}});var L=null,U=null,ce=null;Object.defineProperty(this,"fontFaces",{get:function(){return ce},set:function(W){L=null,U=null,ce=W}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(W){var ae;if(this.ctx.font=W,(ae=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(W))!==null){var he=ae[1];ae[2];var ze=ae[3],ke=ae[4];ae[5];var qe=ae[6],Ie=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ke)[2];ke=Math.floor(Ie==="px"?parseFloat(ke)*this.pdf.internal.scaleFactor:Ie==="em"?parseFloat(ke)*this.pdf.getFontSize():parseFloat(ke)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ke);var Ve=function(Te){var Dt,wt,Pt=[],Wt=Te.trim();if(Wt==="")return xk;if(Wt in HO)return[HO[Wt]];for(;Wt!=="";){switch(wt=null,Dt=(Wt=GO(Wt)).charAt(0)){case'"':case"'":wt=nge(Wt.substring(1),Dt);break;default:wt=age(Wt)}if(wt===null||(Pt.push(wt[0]),(Wt=GO(wt[1]))!==""&&Wt.charAt(0)!==","))return xk;Wt=Wt.replace(/^,/,"")}return Pt}(qe);if(this.fontFaces){var Qe=function(Te,Dt){var wt=Te.getFontList(),Pt=JSON.stringify(wt);if(L===null||U!==Pt){var Wt=function(Ot){var Ht=[];return Object.keys(Ot).forEach(function(Pr){Ot[Pr].forEach(function(jt){var ur=null;switch(jt){case"bold":ur={family:Pr,weight:"bold"};break;case"italic":ur={family:Pr,style:"italic"};break;case"bolditalic":ur={family:Pr,weight:"bold",style:"italic"};break;case"":case"normal":ur={family:Pr}}ur!==null&&(ur.ref={name:Pr,style:jt},Ht.push(ur))})}),Ht}(wt);L=function(Ot){for(var Ht={},Pr=0;Pr<Ot.length;++Pr){var jt=gk(Ot[Pr]),ur=jt.family,Ir=jt.stretch,Rr=jt.style,Nr=jt.weight;Ht[ur]=Ht[ur]||{},Ht[ur][Ir]=Ht[ur][Ir]||{},Ht[ur][Ir][Rr]=Ht[ur][Ir][Rr]||{},Ht[ur][Ir][Rr][Nr]=jt}return Ht}(Wt.concat(Dt)),U=Pt}return L}(this.pdf,this.fontFaces),Tt=Ve.map(function(Te){return{family:Te,stretch:"normal",weight:ze,style:he}}),vt=function(Te,Dt,wt){for(var Pt=(wt=wt||{}).defaultFontFamily||"times",Wt=Object.assign({},rge,wt.genericFontFamilies||{}),Ot=null,Ht=null,Pr=0;Pr<Dt.length;++Pr)if(Wt[(Ot=gk(Dt[Pr])).family]&&(Ot.family=Wt[Ot.family]),Te.hasOwnProperty(Ot.family)){Ht=Te[Ot.family];break}if(!(Ht=Ht||Te[Pt]))throw new Error("Could not find a font-family for the rule '"+VO(Ot)+"' and default family '"+Pt+"'.");if(Ht=function(jt,ur){if(ur[jt])return ur[jt];var Ir=qA[jt],Rr=Ir<=qA.normal?-1:1,Nr=qO(ur,pz,Ir,Rr);if(!Nr)throw new Error("Could not find a matching font-stretch value for "+jt);return Nr}(Ot.stretch,Ht),Ht=function(jt,ur){if(ur[jt])return ur[jt];for(var Ir=hz[jt],Rr=0;Rr<Ir.length;++Rr)if(ur[Ir[Rr]])return ur[Ir[Rr]];throw new Error("Could not find a matching font-style for "+jt)}(Ot.style,Ht),!(Ht=function(jt,ur){if(ur[jt])return ur[jt];if(jt===400&&ur[500])return ur[500];if(jt===500&&ur[400])return ur[400];var Ir=tge[jt],Rr=qO(ur,mz,Ir,jt<400?-1:1);if(!Rr)throw new Error("Could not find a matching font-weight for value "+jt);return Rr}(Ot.weight,Ht)))throw new Error("Failed to resolve a font for the rule '"+VO(Ot)+"'.");return Ht}(Qe,Tt);this.pdf.setFont(vt.ref.name,vt.ref.style)}else{var Xe="";(ze==="bold"||parseInt(ze,10)>=700||he==="bold")&&(Xe="bold"),he==="italic"&&(Xe+="italic"),Xe.length===0&&(Xe="normal");for(var Be="",ct={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},nt=0;nt<Ve.length;nt++){if(this.pdf.internal.getFont(Ve[nt],Xe,{noFallback:!0,disableWarning:!0})!==void 0){Be=Ve[nt];break}if(Xe==="bolditalic"&&this.pdf.internal.getFont(Ve[nt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Be=Ve[nt],Xe="bold";else if(this.pdf.internal.getFont(Ve[nt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Be=Ve[nt],Xe="normal";break}}if(Be===""){for(var Se=0;Se<Ve.length;Se++)if(ct[Ve[Se]]){Be=ct[Ve[Se]];break}}Be=Be===""?"Times":Be,this.pdf.setFont(Be,Xe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(W){this.ctx.globalCompositeOperation=W}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(W){this.ctx.globalAlpha=W}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(W){this.ctx.lineDashOffset=W,ne.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(W){this.ctx.lineDash=W,ne.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(W){this.ctx.ignoreClearRect=!!W}})};f.prototype.setLineDash=function(E){this.lineDash=E},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){_.call(this,"fill",!1)},f.prototype.stroke=function(){_.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(E,Z){if(isNaN(E)||isNaN(Z))throw Ha.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var H=this.ctx.transform.applyToPoint(new o(E,Z));this.path.push({type:"mt",x:H.x,y:H.y}),this.ctx.lastPoint=new o(E,Z)},f.prototype.closePath=function(){var E=new o(0,0),Z=0;for(Z=this.path.length-1;Z!==-1;Z--)if(this.path[Z].type==="begin"&&Oa(this.path[Z+1])==="object"&&typeof this.path[Z+1].x=="number"){E=new o(this.path[Z+1].x,this.path[Z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(E.x,E.y)},f.prototype.lineTo=function(E,Z){if(isNaN(E)||isNaN(Z))throw Ha.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var H=this.ctx.transform.applyToPoint(new o(E,Z));this.path.push({type:"lt",x:H.x,y:H.y}),this.ctx.lastPoint=new o(H.x,H.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),_.call(this,null,!0)},f.prototype.quadraticCurveTo=function(E,Z,H,F){if(isNaN(H)||isNaN(F)||isNaN(E)||isNaN(Z))throw Ha.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ee=this.ctx.transform.applyToPoint(new o(H,F)),z=this.ctx.transform.applyToPoint(new o(E,Z));this.path.push({type:"qct",x1:z.x,y1:z.y,x:ee.x,y:ee.y}),this.ctx.lastPoint=new o(ee.x,ee.y)},f.prototype.bezierCurveTo=function(E,Z,H,F,ee,z){if(isNaN(ee)||isNaN(z)||isNaN(E)||isNaN(Z)||isNaN(H)||isNaN(F))throw Ha.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var X=this.ctx.transform.applyToPoint(new o(ee,z)),J=this.ctx.transform.applyToPoint(new o(E,Z)),q=this.ctx.transform.applyToPoint(new o(H,F));this.path.push({type:"bct",x1:J.x,y1:J.y,x2:q.x,y2:q.y,x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},f.prototype.arc=function(E,Z,H,F,ee,z){if(isNaN(E)||isNaN(Z)||isNaN(H)||isNaN(F)||isNaN(ee))throw Ha.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(z=!!z,!this.ctx.transform.isIdentity){var X=this.ctx.transform.applyToPoint(new o(E,Z));E=X.x,Z=X.y;var J=this.ctx.transform.applyToPoint(new o(0,H)),q=this.ctx.transform.applyToPoint(new o(0,0));H=Math.sqrt(Math.pow(J.x-q.x,2)+Math.pow(J.y-q.y,2))}Math.abs(ee-F)>=2*Math.PI&&(F=0,ee=2*Math.PI),this.path.push({type:"arc",x:E,y:Z,radius:H,startAngle:F,endAngle:ee,counterclockwise:z})},f.prototype.arcTo=function(E,Z,H,F,ee){throw new Error("arcTo not implemented.")},f.prototype.rect=function(E,Z,H,F){if(isNaN(E)||isNaN(Z)||isNaN(H)||isNaN(F))throw Ha.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,Z),this.lineTo(E+H,Z),this.lineTo(E+H,Z+F),this.lineTo(E,Z+F),this.lineTo(E,Z),this.lineTo(E+H,Z),this.lineTo(E,Z)},f.prototype.fillRect=function(E,Z,H,F){if(isNaN(E)||isNaN(Z)||isNaN(H)||isNaN(F))throw Ha.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var ee={};this.lineCap!=="butt"&&(ee.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ee.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,Z,H,F),this.fill(),ee.hasOwnProperty("lineCap")&&(this.lineCap=ee.lineCap),ee.hasOwnProperty("lineJoin")&&(this.lineJoin=ee.lineJoin)}},f.prototype.strokeRect=function(E,Z,H,F){if(isNaN(E)||isNaN(Z)||isNaN(H)||isNaN(F))throw Ha.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(E,Z,H,F),this.stroke())},f.prototype.clearRect=function(E,Z,H,F){if(isNaN(E)||isNaN(Z)||isNaN(H)||isNaN(F))throw Ha.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,Z,H,F))},f.prototype.save=function(E){E=typeof E!="boolean"||E;for(var Z=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("q");if(this.pdf.setPage(Z),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var F=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=F}},f.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var Z=this.pdf.internal.getCurrentPageInfo().pageNumber,H=0;H<this.pdf.internal.getNumberOfPages();H++)this.pdf.setPage(H+1),this.pdf.internal.out("Q");this.pdf.setPage(Z),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(E){var Z,H,F,ee;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))Z=0,H=0,F=0,ee=0;else{var z=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(z!==null)Z=parseInt(z[1]),H=parseInt(z[2]),F=parseInt(z[3]),ee=1;else if((z=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)Z=parseInt(z[1]),H=parseInt(z[2]),F=parseInt(z[3]),ee=parseFloat(z[4]);else{if(ee=1,typeof E=="string"&&E.charAt(0)!=="#"){var X=new sz(E);E=X.ok?X.toHex():"#000000"}E.length===4?(Z=E.substring(1,2),Z+=Z,H=E.substring(2,3),H+=H,F=E.substring(3,4),F+=F):(Z=E.substring(1,3),H=E.substring(3,5),F=E.substring(5,7)),Z=parseInt(Z,16),H=parseInt(H,16),F=parseInt(F,16)}}return{r:Z,g:H,b:F,a:ee,style:E}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(E,Z,H,F){if(isNaN(Z)||isNaN(H)||typeof E!="string")throw Ha.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(F=isNaN(F)?void 0:F,!h.call(this)){var ee=V(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;T.call(this,{text:E,x:Z,y:H,scale:z,angle:ee,align:this.textAlign,maxWidth:F})}},f.prototype.strokeText=function(E,Z,H,F){if(isNaN(Z)||isNaN(H)||typeof E!="string")throw Ha.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){F=isNaN(F)?void 0:F;var ee=V(this.ctx.transform.rotation),z=this.ctx.transform.scaleX;T.call(this,{text:E,x:Z,y:H,scale:z,renderingMode:"stroke",angle:ee,align:this.textAlign,maxWidth:F})}},f.prototype.measureText=function(E){if(typeof E!="string")throw Ha.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Z=this.pdf,H=this.pdf.internal.scaleFactor,F=Z.internal.getFontSize(),ee=Z.getStringUnitWidth(E)*F/Z.internal.scaleFactor;return new function(z){var X=(z=z||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return X}}),this}({width:ee*=Math.round(96*H/72*1e4)/1e4})},f.prototype.scale=function(E,Z){if(isNaN(E)||isNaN(Z))throw Ha.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var H=new c(E,0,0,Z,0,0);this.ctx.transform=this.ctx.transform.multiply(H)},f.prototype.rotate=function(E){if(isNaN(E))throw Ha.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Z=new c(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(Z)},f.prototype.translate=function(E,Z){if(isNaN(E)||isNaN(Z))throw Ha.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var H=new c(1,0,0,1,E,Z);this.ctx.transform=this.ctx.transform.multiply(H)},f.prototype.transform=function(E,Z,H,F,ee,z){if(isNaN(E)||isNaN(Z)||isNaN(H)||isNaN(F)||isNaN(ee)||isNaN(z))throw Ha.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var X=new c(E,Z,H,F,ee,z);this.ctx.transform=this.ctx.transform.multiply(X)},f.prototype.setTransform=function(E,Z,H,F,ee,z){E=isNaN(E)?1:E,Z=isNaN(Z)?0:Z,H=isNaN(H)?0:H,F=isNaN(F)?1:F,ee=isNaN(ee)?0:ee,z=isNaN(z)?0:z,this.ctx.transform=new c(E,Z,H,F,ee,z)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(E,Z,H,F,ee,z,X,J,q){var Y=this.pdf.getImageProperties(E),L=1,U=1,ce=1,W=1;F!==void 0&&J!==void 0&&(ce=J/F,W=q/ee,L=Y.width/F*J/F,U=Y.height/ee*q/ee),z===void 0&&(z=Z,X=H,Z=0,H=0),F!==void 0&&J===void 0&&(J=F,q=ee),F===void 0&&J===void 0&&(J=Y.width,q=Y.height);var ae=this.ctx.transform.decompose(),he=V(ae.rotate.shx),ze=new c,ke=(ze=(ze=(ze=ze.multiply(ae.translate)).multiply(ae.skew)).multiply(ae.scale)).applyToRectangle(new l(z-Z*ce,X-H*W,F*L,ee*U));if(this.autoPaging){for(var qe,Ie=b.call(this,ke),Ve=[],Qe=0;Qe<Ie.length;Qe+=1)Ve.indexOf(Ie[Qe])===-1&&Ve.push(Ie[Qe]);w(Ve);for(var Tt=Ve[0],vt=Ve[Ve.length-1],Xe=Tt;Xe<vt+1;Xe++){this.pdf.setPage(Xe);var Be=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ct=Xe===1?this.posY+this.margin[0]:this.margin[0],nt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Se=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Te=Xe===1?0:nt+(Xe-2)*Se;if(this.ctx.clip_path.length!==0){var Dt=this.path;qe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(qe,this.posX+this.margin[3],-Te+ct+this.ctx.prevPageLastElemOffset),C.call(this,"fill",!0),this.path=Dt}var wt=JSON.parse(JSON.stringify(ke));wt=v([wt],this.posX+this.margin[3],-Te+ct+this.ctx.prevPageLastElemOffset)[0];var Pt=(Xe>Tt||Xe<vt)&&g.call(this);Pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Be,Se,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",wt.x,wt.y,wt.w,wt.h,null,null,he),Pt&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(E,"JPEG",ke.x,ke.y,ke.w,ke.h,null,null,he)};var b=function(E,Z,H){var F=[];Z=Z||this.pdf.internal.pageSize.width,H=H||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ee=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":F.push(Math.floor((E.y+ee)/H)+1);break;case"arc":F.push(Math.floor((E.y+ee-E.radius)/H)+1),F.push(Math.floor((E.y+ee+E.radius)/H)+1);break;case"qct":var z=K(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);F.push(Math.floor((z.y+ee)/H)+1),F.push(Math.floor((z.y+z.h+ee)/H)+1);break;case"bct":var X=de(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);F.push(Math.floor((X.y+ee)/H)+1),F.push(Math.floor((X.y+X.h+ee)/H)+1);break;case"rect":F.push(Math.floor((E.y+ee)/H)+1),F.push(Math.floor((E.y+E.h+ee)/H)+1)}for(var J=0;J<F.length;J+=1)for(;this.pdf.internal.getNumberOfPages()<F[J];)y.call(this);return F},y=function(){var E=this.fillStyle,Z=this.strokeStyle,H=this.font,F=this.lineCap,ee=this.lineWidth,z=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=Z,this.font=H,this.lineCap=F,this.lineWidth=ee,this.lineJoin=z},v=function(E,Z,H){for(var F=0;F<E.length;F++)switch(E[F].type){case"bct":E[F].x2+=Z,E[F].y2+=H;case"qct":E[F].x1+=Z,E[F].y1+=H;default:E[F].x+=Z,E[F].y+=H}return E},w=function(E){return E.sort(function(Z,H){return Z-H})},_=function(E,Z){var H=this.fillStyle,F=this.strokeStyle,ee=this.lineCap,z=this.lineWidth,X=Math.abs(z*this.ctx.transform.scaleX),J=this.lineJoin;if(this.autoPaging){for(var q,Y,L=JSON.parse(JSON.stringify(this.path)),U=JSON.parse(JSON.stringify(this.path)),ce=[],W=0;W<U.length;W++)if(U[W].x!==void 0)for(var ae=b.call(this,U[W]),he=0;he<ae.length;he+=1)ce.indexOf(ae[he])===-1&&ce.push(ae[he]);for(var ze=0;ze<ce.length;ze++)for(;this.pdf.internal.getNumberOfPages()<ce[ze];)y.call(this);w(ce);for(var ke=ce[0],qe=ce[ce.length-1],Ie=ke;Ie<qe+1;Ie++){this.pdf.setPage(Ie),this.fillStyle=H,this.strokeStyle=F,this.lineCap=ee,this.lineWidth=X,this.lineJoin=J;var Ve=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Qe=Ie===1?this.posY+this.margin[0]:this.margin[0],Tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],vt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xe=Ie===1?0:Tt+(Ie-2)*vt;if(this.ctx.clip_path.length!==0){var Be=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(q,this.posX+this.margin[3],-Xe+Qe+this.ctx.prevPageLastElemOffset),C.call(this,E,!0),this.path=Be}if(Y=JSON.parse(JSON.stringify(L)),this.path=v(Y,this.posX+this.margin[3],-Xe+Qe+this.ctx.prevPageLastElemOffset),Z===!1||Ie===0){var ct=(Ie>ke||Ie<qe)&&g.call(this);ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ve,vt,null).clip().discardPath()),C.call(this,E,Z),ct&&this.pdf.restoreGraphicsState()}this.lineWidth=z}this.path=L}else this.lineWidth=X,C.call(this,E,Z),this.lineWidth=z},C=function(E,Z){if((E!=="stroke"||Z||!m.call(this))&&(E==="stroke"||Z||!h.call(this))){for(var H,F,ee=[],z=this.path,X=0;X<z.length;X++){var J=z[X];switch(J.type){case"begin":ee.push({begin:!0});break;case"close":ee.push({close:!0});break;case"mt":ee.push({start:J,deltas:[],abs:[]});break;case"lt":var q=ee.length;if(z[X-1]&&!isNaN(z[X-1].x)&&(H=[J.x-z[X-1].x,J.y-z[X-1].y],q>0)){for(;q>=0;q--)if(ee[q-1].close!==!0&&ee[q-1].begin!==!0){ee[q-1].deltas.push(H),ee[q-1].abs.push(J);break}}break;case"bct":H=[J.x1-z[X-1].x,J.y1-z[X-1].y,J.x2-z[X-1].x,J.y2-z[X-1].y,J.x-z[X-1].x,J.y-z[X-1].y],ee[ee.length-1].deltas.push(H);break;case"qct":var Y=z[X-1].x+2/3*(J.x1-z[X-1].x),L=z[X-1].y+2/3*(J.y1-z[X-1].y),U=J.x+2/3*(J.x1-J.x),ce=J.y+2/3*(J.y1-J.y),W=J.x,ae=J.y;H=[Y-z[X-1].x,L-z[X-1].y,U-z[X-1].x,ce-z[X-1].y,W-z[X-1].x,ae-z[X-1].y],ee[ee.length-1].deltas.push(H);break;case"arc":ee.push({deltas:[],abs:[],arc:!0}),Array.isArray(ee[ee.length-1].abs)&&ee[ee.length-1].abs.push(J)}}F=Z?null:E==="stroke"?"stroke":"fill";for(var he=!1,ze=0;ze<ee.length;ze++)if(ee[ze].arc)for(var ke=ee[ze].abs,qe=0;qe<ke.length;qe++){var Ie=ke[qe];Ie.type==="arc"?M.call(this,Ie.x,Ie.y,Ie.radius,Ie.startAngle,Ie.endAngle,Ie.counterclockwise,void 0,Z,!he):B.call(this,Ie.x,Ie.y),he=!0}else if(ee[ze].close===!0)this.pdf.internal.out("h"),he=!1;else if(ee[ze].begin!==!0){var Ve=ee[ze].start.x,Qe=ee[ze].start.y;G.call(this,ee[ze].deltas,Ve,Qe),he=!0}F&&P.call(this,F),Z&&R.call(this)}},j=function(E){var Z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,H=Z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-H;case"top":return E+Z-H;case"hanging":return E+Z-2*H;case"middle":return E+Z/2-H;default:return E}},A=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(Z,H){this.colorStops.push([Z,H])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var M=function(E,Z,H,F,ee,z,X,J,q){for(var Y=xe.call(this,H,F,ee,z),L=0;L<Y.length;L++){var U=Y[L];L===0&&(q?N.call(this,U.x1+E,U.y1+Z):B.call(this,U.x1+E,U.y1+Z)),re.call(this,E,Z,U.x2,U.y2,U.x3,U.y3,U.x4,U.y4)}J?R.call(this):P.call(this,X)},P=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},R=function(){this.pdf.clip(),this.pdf.discardPath()},N=function(E,Z){this.pdf.internal.out(r(E)+" "+n(Z)+" m")},T=function(E){var Z;switch(E.align){case"right":case"end":Z="right";break;case"center":Z="center";break;default:Z="left"}var H,F,ee,z=this.pdf.getTextDimensions(E.text),X=j.call(this,E.y),J=A.call(this,X)-z.h,q=this.ctx.transform.applyToPoint(new o(E.x,X));if(this.autoPaging){var Y=this.ctx.transform.decompose(),L=new c;L=(L=(L=L.multiply(Y.translate)).multiply(Y.skew)).multiply(Y.scale);for(var U=this.ctx.transform.applyToRectangle(new l(E.x,X,z.w,z.h)),ce=L.applyToRectangle(new l(E.x,J,z.w,z.h)),W=b.call(this,ce),ae=[],he=0;he<W.length;he+=1)ae.indexOf(W[he])===-1&&ae.push(W[he]);w(ae);for(var ze=ae[0],ke=ae[ae.length-1],qe=ze;qe<ke+1;qe++){this.pdf.setPage(qe);var Ie=qe===1?this.posY+this.margin[0]:this.margin[0],Ve=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Qe=this.pdf.internal.pageSize.height-this.margin[2],Tt=Qe-this.margin[0],vt=this.pdf.internal.pageSize.width-this.margin[1],Xe=vt-this.margin[3],Be=qe===1?0:Ve+(qe-2)*Tt;if(this.ctx.clip_path.length!==0){var ct=this.path;H=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(H,this.posX+this.margin[3],-1*Be+Ie),C.call(this,"fill",!0),this.path=ct}var nt=v([JSON.parse(JSON.stringify(ce))],this.posX+this.margin[3],-Be+Ie+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(F=this.pdf.internal.getFontSize(),this.pdf.setFontSize(F*E.scale),ee=this.lineWidth,this.lineWidth=ee*E.scale);var Se=this.autoPaging!=="text";if(Se||nt.y+nt.h<=Qe){if(Se||nt.y>=Ie&&nt.x<=vt){var Te=Se?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||vt-nt.x)[0],Dt=v([JSON.parse(JSON.stringify(U))],this.posX+this.margin[3],-Be+Ie+this.ctx.prevPageLastElemOffset)[0],wt=Se&&(qe>ze||qe<ke)&&g.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xe,Tt,null).clip().discardPath()),this.pdf.text(Te,Dt.x,Dt.y,{angle:E.angle,align:Z,renderingMode:E.renderingMode}),wt&&this.pdf.restoreGraphicsState()}}else nt.y<Qe&&(this.ctx.prevPageLastElemOffset+=Qe-nt.y);E.scale>=.01&&(this.pdf.setFontSize(F),this.lineWidth=ee)}}else E.scale>=.01&&(F=this.pdf.internal.getFontSize(),this.pdf.setFontSize(F*E.scale),ee=this.lineWidth,this.lineWidth=ee*E.scale),this.pdf.text(E.text,q.x+this.posX,q.y+this.posY,{angle:E.angle,align:Z,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(F),this.lineWidth=ee)},B=function(E,Z,H,F){H=H||0,F=F||0,this.pdf.internal.out(r(E+H)+" "+n(Z+F)+" l")},G=function(E,Z,H){return this.pdf.lines(E,Z,H,null,null)},re=function(E,Z,H,F,ee,z,X,J){this.pdf.internal.out([t(a(H+E)),t(s(F+Z)),t(a(ee+E)),t(s(z+Z)),t(a(X+E)),t(s(J+Z)),"c"].join(" "))},xe=function(E,Z,H,F){for(var ee=2*Math.PI,z=Math.PI/2;Z>H;)Z-=ee;var X=Math.abs(H-Z);X<ee&&F&&(X=ee-X);for(var J=[],q=F?-1:1,Y=Z;X>1e-5;){var L=Y+q*Math.min(X,z);J.push(_e.call(this,E,Y,L)),X-=Math.abs(L-Y),Y=L}return J},_e=function(E,Z,H){var F=(H-Z)/2,ee=E*Math.cos(F),z=E*Math.sin(F),X=ee,J=-z,q=X*X+J*J,Y=q+X*ee+J*z,L=4/3*(Math.sqrt(2*q*Y)-Y)/(X*z-J*ee),U=X-L*J,ce=J+L*X,W=U,ae=-ce,he=F+Z,ze=Math.cos(he),ke=Math.sin(he);return{x1:E*Math.cos(Z),y1:E*Math.sin(Z),x2:U*ze-ce*ke,y2:U*ke+ce*ze,x3:W*ze-ae*ke,y3:W*ke+ae*ze,x4:E*Math.cos(H),y4:E*Math.sin(H)}},V=function(E){return 180*E/Math.PI},K=function(E,Z,H,F,ee,z){var X=E+.5*(H-E),J=Z+.5*(F-Z),q=ee+.5*(H-ee),Y=z+.5*(F-z),L=Math.min(E,ee,X,q),U=Math.max(E,ee,X,q),ce=Math.min(Z,z,J,Y),W=Math.max(Z,z,J,Y);return new l(L,ce,U-L,W-ce)},de=function(E,Z,H,F,ee,z,X,J){var q,Y,L,U,ce,W,ae,he,ze,ke,qe,Ie,Ve,Qe,Tt=H-E,vt=F-Z,Xe=ee-H,Be=z-F,ct=X-ee,nt=J-z;for(Y=0;Y<41;Y++)ze=(ae=(L=E+(q=Y/40)*Tt)+q*((ce=H+q*Xe)-L))+q*(ce+q*(ee+q*ct-ce)-ae),ke=(he=(U=Z+q*vt)+q*((W=F+q*Be)-U))+q*(W+q*(z+q*nt-W)-he),Y==0?(qe=ze,Ie=ke,Ve=ze,Qe=ke):(qe=Math.min(qe,ze),Ie=Math.min(Ie,ke),Ve=Math.max(Ve,ze),Qe=Math.max(Qe,ke));return new l(Math.round(qe),Math.round(Ie),Math.round(Ve-qe),Math.round(Qe-Ie))},ne=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,Z,H=(E=this.ctx.lineDash,Z=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:Z}));this.prevLineDash!==H&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=H)}}})(bn.API),function(e){var t=function(o){var l,c,u,d,f,p,h,m,g,b;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(p=(f=((f=((f=((f=(f-(b=f%85))/85)-(g=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)%85,c.push(p+33,h+33,m+33,g+33,b+33)):c.push(122);return function(y,v){for(var w=v;w>0;w--)y.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,p=String,h="length",m=255,g="charCodeAt",b="slice",y="replace";for(o[b](-2),o=o[b](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[b](o[h]%5||5))[h];f>d;d+=5)c=52200625*(o[g](d)-33)+614125*(o[g](d+1)-33)+7225*(o[g](d+2)-33)+85*(o[g](d+3)-33)+(o[g](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(v,w){for(var _=w;_>0;_--)v.pop()}(u,l[h]),p.fromCharCode.apply(p,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=BA(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};e.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(bn.API),function(e){e.loadFile=function(t,r,n){return function(a,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,p=0,h=function(m){var g=m.length,b=[],y=String.fromCharCode;for(p=0;p<g;p+=1)b.push(y(255&m.charCodeAt(p)));return b.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(a,s,o)}catch{}return l}(t,r,n)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile}(bn.API),function(e){function t(){return(En.html2canvas?Promise.resolve(En.html2canvas):am(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(En.DOMPurify?Promise.resolve(En.DOMPurify):am(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Oa(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:a("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var m=d[h],g=m.src.find(function(b){return b.format==="truetype"});g&&u.addFont(g.url,m.ref.name,m.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,u.context2d.save(!0),c(this.prop.container,p)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||bn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(p){return u.updateProgress(null,d),p}).then(d,f).then(function(p){return u.updateProgress(1),p})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),p=u.call(f,l,c);return o.convert(p,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,bn.getPageSize=function(l,c,u){if(Oa(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,p=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,g=0,b=0;if(h.hasOwnProperty(p))g=h[p][1]/f,b=h[p][0]/f;else try{g=u[1],b=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",b>g&&(m=b,b=g,g=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>b&&(m=b,b=g,g=m)}return{width:b,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(gk):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(bn.API),bn.API.addJS=function(e){var t,r,n=e;return this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(t+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+n+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){t!==void 0&&r!==void 0&&this.internal.out("/Names <</JavaScript "+t+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),s=0;s<a.length;s++){var o=a[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var p=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,s){var o={title:a,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var s=0;s<a.children.length;s++)n.count++,this.count_r(n,a.children[s]);return n.count}}])}(bn.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var p,h=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,g={width:0,height:0,numcomponents:1},b=4;b<m;b+=2){if(b+=h,t.indexOf(f.charCodeAt(b+1))!==-1){p=256*f.charCodeAt(b+5)+f.charCodeAt(b+6),g={width:256*f.charCodeAt(b+7)+f.charCodeAt(b+8),height:p,numcomponents:f.charCodeAt(b+9)};break}h=256*f.charCodeAt(b+2)+f.charCodeAt(b+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}}(bn.API),bn.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,s=Ume(e,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;a=u&&c===1?function(M){for(var P=M.width,R=M.height,N=M.data,T=M.palette,B=M.depth,G=!1,re=[],xe=[],_e=void 0,V=!1,K=0,de=0;de<T.length;de++){var ne=ZP(T[de],4),E=ne[0],Z=ne[1],H=ne[2],F=ne[3];re.push(E,Z,H),F!=null&&(F===0?(K++,xe.length<1&&xe.push(de)):F<255&&(V=!0))}if(V||K>1){G=!0,xe=void 0;var ee=P*R;_e=new Uint8Array(ee);for(var z=new DataView(N.buffer),X=0;X<ee;X++){var J=yk(z,X,B),q=ZP(T[J],4)[3];_e[X]=q}}else K===0&&(xe=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:G?8:void 0,colorBytes:N,alphaBytes:_e,needSMask:G,palette:re,mask:xe}}(s):c===2||c===4?function(M){for(var P=M.data,R=M.width,N=M.height,T=M.channels,B=M.depth,G=T===2?"DeviceGray":"DeviceRGB",re=T-1,xe=R*N,_e=re,V=xe*_e,K=1*xe,de=Math.ceil(V*B/8),ne=Math.ceil(K*B/8),E=new Uint8Array(de),Z=new Uint8Array(ne),H=new DataView(P.buffer),F=new DataView(E.buffer),ee=new DataView(Z.buffer),z=!1,X=0;X<xe;X++){for(var J=X*T,q=0;q<_e;q++)rL(F,yk(H,J+q,B),X*_e+q,B);var Y=yk(H,J+_e,B);Y<(1<<B)-1&&(z=!0),rL(ee,Y,1*X,B)}return{colorSpace:G,colorsPerPixel:re,sMaskBitsPerComponent:z?B:void 0,colorBytes:E,alphaBytes:Z,needSMask:z}}(s):function(M){var P=M.data,R=M.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:R,colorsPerPixel:R==="DeviceGray"?1:3,colorBytes:P instanceof Uint16Array?function(N){for(var T=N.length,B=new Uint8Array(2*T),G=new DataView(B.buffer,B.byteOffset,B.byteLength),re=0;re<T;re++)G.setUint16(2*re,N[re],!1);return B}(P):P,needSMask:!1}}(s);var f,p,h,m=a,g=m.colorSpace,b=m.colorsPerPixel,y=m.sMaskBitsPerComponent,v=m.colorBytes,w=m.alphaBytes,_=m.needSMask,C=m.palette,j=m.mask,A=null;return n!==bn.API.image_compression.NONE&&typeof BA=="function"?(A=function(M){var P;switch(M){case bn.API.image_compression.FAST:P=11;break;case bn.API.image_compression.MEDIUM:P=13;break;case bn.API.image_compression.SLOW:P=14;break;default:P=12}return P}(n),f=this.decode.FLATE_DECODE,p="/Predictor ".concat(A," /Colors ").concat(b," /BitsPerComponent ").concat(d," /Columns ").concat(o),e=QO(v,Math.ceil(o*b*d/8),b,d,n),_&&(h=QO(w,Math.ceil(o*y/8),1,y,n))):(f=void 0,p=void 0,e=v,_&&(h=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:e,index:t,filter:f,decodeParameters:p,transparency:j,palette:C,sMask:h,predictor:A,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:y,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,a){var s=new lge(t),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new bk(100).encode(u,100);return e.processJPEG.call(this,d,r,n,a)},e.processGIF87A=e.processGIF89A}(bn.API),Ic.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ic.prototype.parseBGR=function(){this.pos=this.offset;var e="bit"+this.bitPP,t=this.width*this.height*4;if(t>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(t);try{this[e]()}catch(r){Ha.log("bit decode error:"+r)}},Ic.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,l=0;l<8&&8*a+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},Ic.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},Ic.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},Ic.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,u=s>>15?255:0,d=n*this.width*4+4*a;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=e}},Ic.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,d=a*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},Ic.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},Ic.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=a,this.data[l+2]=n,this.data[l+3]=o}},Ic.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var s=new Ic(t,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new bk(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}}(bn.API),aL.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var s=new aL(t),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new bk(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}}(bn.API),bn.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,s=new Uint8Array(a/4*3),o=new Uint8Array(a/4),l=0,c=0,u=0;u<a;u+=4){var d=n[u],f=n[u+1],p=n[u+2],h=n[u+3];s[l++]=d,s[l++]=f,s[l++]=p,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},bn.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},up=bn.API,Tb=up.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:a.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=t.doKerning!==!1,p=0,h=e.length,m=0,g=l[0]||c,b=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?b.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(p=f&&Oa(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,b.push((l[n]||g)/c+p)),m=n;return b},KO=up.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return up.processArabic&&(e=up.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:Tb.apply(this,arguments).reduce(function(s,o){return s+o},0)},XO=function(e,t,r,n){for(var a=[],s=0,o=e.length,l=0;s!==o&&l+t[s]<r;)l+=t[s],s++;a.push(e.slice(0,s));var c=s;for(l=0;s!==o;)l+t[s]>n&&(a.push(e.slice(c,s)),l=0,c=s),l+=t[s],s++;return c!==s&&a.push(e.slice(c,s)),a},YO=function(e,t,r){r||(r={});var n,a,s,o,l,c,u,d=[],f=[d],p=r.textIndent||0,h=0,m=0,g=e.split(" "),b=Tb.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var y=Array(c).join(" "),v=[];g.map(function(_){(_=_.split(/\s*\n/)).length>1?v=v.concat(_.map(function(C,j){return(j&&C.length?`
`:"")+C})):v.push(_[0])}),g=v,c=KO.apply(this,[y,r])}for(s=0,o=g.length;s<o;s++){var w=0;if(n=g[s],c&&n[0]==`
`&&(n=n.substr(1),w=1),p+h+(m=(a=Tb.apply(this,[n,r])).reduce(function(_,C){return _+C},0))>t||w){if(m>t){for(l=XO.apply(this,[n,a,t-(p+h),t]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(_,C){return _+C},0)}else d=[n];f.push(d),p=m+c,h=b}else d.push(n),p+=h+m,h=b}return u=c?function(_,C){return(C?y:"")+_.join(" ")}:function(_){return _.join(" ")},f.map(u)},up.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),p="Unicode";return f.metadata[p]?{widths:f.metadata[p].widths||{0:1},kerning:f.metadata[p].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/a;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(YO.apply(this,[n[l],o,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},s=0;s<16;s++)n[r[s]]=t[s],a[t[s]]=r[s];var o=function(p){return"0x"+parseInt(p,10).toString(16)},l=e.__fontmetrics__.compress=function(p){var h,m,g,b,y=["{"];for(var v in p){if(h=p[v],isNaN(parseInt(v,10))?m="'"+v+"'":(v=parseInt(v,10),m=(m=o(v).slice(2)).slice(0,-1)+a[m.slice(-1)]),typeof h=="number")h<0?(g=o(h).slice(3),b="-"):(g=o(h).slice(2),b=""),g=b+g.slice(0,-1)+a[g.slice(-1)];else{if(Oa(h)!=="object")throw new Error("Don't know what to do with value type "+Oa(h)+".");g=l(h)}y.push(m+g)}return y.push("}"),y.join("")},c=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,g,b,y={},v=1,w=y,_=[],C="",j="",A=p.length-1,M=1;M<A;M+=1)(b=p[M])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(b):b=="{"?(_.push([w,g]),w={},g=void 0):b=="}"?((m=_.pop())[0][m[1]]=w,g=void 0,w=m[0]):b=="-"?v=-1:g===void 0?n.hasOwnProperty(b)?(C+=n[b],g=parseInt(C,16)*v,v=1,C=""):C+=b:n.hasOwnProperty(b)?(j+=n[b],w[g]=parseInt(j,16)*v,v=1,g=void 0,j=""):j+=b;return y},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var h=p.font,m=f.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var g=d.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(bn.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),s=0;s<n;s++)a[s]=r.charCodeAt(s);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,s=r.instance;if(!a.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=s.existsFileInVFS(a.postScriptName)===!1?s.loadFile(a.postScriptName):s.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Ov(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(bn),bn.API.addSvgAsImage=function(e,t,r,n,a,s,o,l){if(isNaN(t)||isNaN(r))throw Ha.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw Ha.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(En.canvg?Promise.resolve(En.canvg):am(()=>import("./index.es-BQxnao7b.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(u,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,a,o,l)})},bn.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},bn.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function p(m,g){var b,y=!1;for(b=0;b<m.length;b+=1)m[b]===g&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Oa(e)==="object"){for(a in e)if(s=e[a],p(l,a)&&s!==void 0){if(r[a].type==="boolean"&&typeof s=="boolean")r[a].value=s;else if(r[a].type==="name"&&p(r[a].valueSet,s))r[a].value=s;else if(r[a].type==="integer"&&Number.isInteger(s))r[a].value=s;else if(r[a].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},bn.API.addMetadata=function(e,t){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:e,namespaceUri:t??"http://jspdf.default.namespaceuri/",rawXml:typeof t=="boolean"&&t},this.internal.events.subscribe("putCatalog",uge),this.internal.events.subscribe("postPutResources",cge)),this},function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,p=s.length;f<p;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,p=(l=Object.keys(s).sort(function(h,m){return h-m})).length;f<p;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,p=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<p.length;m++)h+=String.fromCharCode(p[m]);var g=u();d({data:h,addLength1:!0,objectId:g}),c("endobj");var b=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:b}),c("endobj");var y=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Ep(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var v=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Ep(l.fontName)),c("/FontDescriptor "+y+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+b+" 0 R"),c("/BaseFont /"+Ep(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,p="",h=0;h<f.length;h++)p+=String.fromCharCode(f[h]);var m=u();d({data:p,addLength1:!0,objectId:m}),c("endobj");var g=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var b=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Ep(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var y=0;y<l.metadata.hmtx.widths.length;y++)l.metadata.hmtx.widths[y]=parseInt(l.metadata.hmtx.widths[y]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Ep(l.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var a=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},p=f.pdfEscape,h=f.activeFontKey,m=f.fonts,g=h,b="",y=0,v="",w=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(v=l,g=h,Array.isArray(l)&&(v=l[0]),y=0;y<v.length;y+=1)m[g].metadata.hasOwnProperty("cmap")&&(o=m[g].metadata.cmap.unicode.codeMap[v[y].charCodeAt(0)]),o||v[y].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?b+=v[y]:b+="";var _="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?_=p(b,g).split("").map(function(C){return C.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(_=r(b,m[g])),f.isHex=!0,{text:_,x:c,y:u,options:d,mutex:f}};t.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([a(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(a(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=a(Object.assign({},c,{text:o})).text}])}(bn),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(bn.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,s,o,l,c,u,d,f=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,w=0;this.__bidiEngine__={};var _=function(N){var T=N.charCodeAt(),B=T>>8,G=g[B];return G!==void 0?f[256*G+(255&T)]:B===252||B===253?"AL":y.test(B)?"L":B===8?"R":"N"},C=function(N){for(var T,B=0;B<N.length;B++){if((T=_(N.charAt(B)))==="L")return!1;if(T==="R")return!0}return!1},j=function(N,T,B,G){var re,xe,_e,V,K=T[G];switch(K){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"N":case"AN":break;case"EN":v&&(K="AN");break;case"AL":v=!0,K="R";break;case"WS":case"BN":K="N";break;case"CS":G<1||G+1>=T.length||(re=B[G-1])!=="EN"&&re!=="AN"||(xe=T[G+1])!=="EN"&&xe!=="AN"?K="N":v&&(xe="AN"),K=xe===re?xe:"N";break;case"ES":K=(re=G>0?B[G-1]:"B")==="EN"&&G+1<T.length&&T[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&B[G-1]==="EN"){K="EN";break}if(v){K="N";break}for(_e=G+1,V=T.length;_e<V&&T[_e]==="ET";)_e++;K=_e<V&&T[_e]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(V=T.length,_e=G+1;_e<V&&T[_e]==="NSM";)_e++;if(_e<V){var de=N[G],ne=de>=1425&&de<=2303||de===64286;if(re=T[_e],ne&&(re==="R"||re==="AL")){K="R";break}}}K=G<1||(re=T[G-1])==="B"?"N":B[G-1];break;case"B":v=!1,a=!0,K=w;break;case"S":s=!0,K="N"}return K},A=function(N,T,B){var G=N.split("");return B&&M(G,B,{hiLevel:w}),G.reverse(),T&&T.reverse(),G.join("")},M=function(N,T,B){var G,re,xe,_e,V,K=-1,de=N.length,ne=0,E=[],Z=w?h:p,H=[];for(v=!1,a=!1,s=!1,re=0;re<de;re++)H[re]=_(N[re]);for(xe=0;xe<de;xe++){if(V=ne,E[xe]=j(N,H,E,xe),G=240&(ne=Z[V][m[E[xe]]]),ne&=15,T[xe]=_e=Z[ne][5],G>0)if(G===16){for(re=K;re<xe;re++)T[re]=1;K=-1}else K=-1;if(Z[ne][6])K===-1&&(K=xe);else if(K>-1){for(re=K;re<xe;re++)T[re]=_e;K=-1}H[xe]==="B"&&(T[xe]=0),B.hiLevel|=_e}s&&function(F,ee,z){for(var X=0;X<z;X++)if(F[X]==="S"){ee[X]=w;for(var J=X-1;J>=0&&F[J]==="WS";J--)ee[J]=w}}(H,T,de)},P=function(N,T,B,G,re){if(!(re.hiLevel<N)){if(N===1&&w===1&&!a)return T.reverse(),void(B&&B.reverse());for(var xe,_e,V,K,de=T.length,ne=0;ne<de;){if(G[ne]>=N){for(V=ne+1;V<de&&G[V]>=N;)V++;for(K=ne,_e=V-1;K<_e;K++,_e--)xe=T[K],T[K]=T[_e],T[_e]=xe,B&&(xe=B[K],B[K]=B[_e],B[_e]=xe);ne=V}ne++}}},R=function(N,T,B){var G=N.split(""),re={hiLevel:w};return B||(B=[]),M(G,B,re),function(xe,_e,V){if(V.hiLevel!==0&&d)for(var K,de=0;de<xe.length;de++)_e[de]===1&&(K=b.indexOf(xe[de]))>=0&&(xe[de]=b[K+1])}(G,B,re),P(2,G,T,B,re),P(1,G,T,B,re),G.join("")};return this.__bidiEngine__.doBidiReorder=function(N,T,B){if(function(re,xe){if(xe)for(var _e=0;_e<re.length;_e++)xe[_e]=_e;l===void 0&&(l=C(re)),u===void 0&&(u=C(re))}(N,T),o||!c||u)if(o&&c&&l^u)w=l?1:0,N=A(N,T,B);else if(!o&&c&&u)w=l?1:0,N=R(N,T,B),N=A(N,T);else if(!o||l||c||u){if(o&&!c&&l^u)N=A(N,T),l?(w=0,N=R(N,T,B)):(w=1,N=R(N,T,B),N=A(N,T));else if(o&&l&&!c&&u)w=1,N=R(N,T,B),N=A(N,T);else if(!o&&!c&&l^u){var G=d;l?(w=1,N=R(N,T,B),w=0,d=!1,N=R(N,T,B),d=G):(w=0,N=R(N,T,B),N=A(N,T),w=1,d=!1,N=R(N,T,B),d=G,N=A(N,T))}}else w=0,N=R(N,T,B);else w=l?1:0,N=R(N,T,B);return N},this.__bidiEngine__.setOptions=function(N){N&&(o=N.isInputVisual,c=N.isOutputVisual,l=N.isInputRtl,u=N.isOutputRtl,d=N.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(a)==="[object Array]"){var l=0;for(o=[],l=0;l<a.length;l+=1)Object.prototype.toString.call(a[l])==="[object Array]"?o.push([r.doBidiReorder(a[l][0]),a[l][1],a[l][2]]):o.push([r.doBidiReorder(a[l])]);n.text=o}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(bn),bn.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new ah(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new jge(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new dge(this.contents),this.head=new hge(this),this.name=new yge(this),this.cmap=new xz(this),this.toUnicode={},this.hhea=new pge(this),this.maxp=new bge(this),this.hmtx=new vge(this),this.post=new gge(this),this.os2=new mge(this),this.loca=new kge(this),this.glyf=new wge(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,s,o,l;for(o=0,s=0,l=(t=""+t).length;0<=l?s<l:s>l;s=0<=l?++s:--s)a=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var ou,ah=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,s,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*s+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,s;for(s=[],n=0,a=t.length;n<a;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),dge=function(){var e;function t(r){var n,a,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,s=this.tableCount;0<=s?a<s:a>s;a=0<=s?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,s,o,l,c,u,d,f,p,h,m,g;for(g in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),o=Math.floor(f/c),d=16*h-f,(a=new ah).writeInt(this.scalarType),a.writeShort(h),a.writeShort(f),a.writeShort(o),a.writeShort(d),s=16*h,u=a.pos+s,l=null,m=[],r)for(p=r[g],a.writeString(g),a.writeInt(e(p)),a.writeInt(u),a.writeInt(p.length),m=m.concat(p),g==="head"&&(l=u),u+=p.length;u%4;)m.push(0),u++;return a.write(m),n=2981146554-e(a.data),a.pos=l+8,a.writeUInt32(n),a.data},e=function(r){var n,a,s,o;for(r=yz.call(r);r.length%4;)r.push(0);for(s=new ah(r),a=0,n=0,o=r.length;n<o;n=n+=4)a+=s.readUInt32();return 4294967295&a},t}(),fge={}.hasOwnProperty,Yu=function(e,t){for(var r in t)fge.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};ou=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var hge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new ah).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),iL=function(){function e(t,r){var n,a,s,o,l,c,u,d,f,p,h,m,g,b,y,v,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),p=h/2,t.pos+=6,s=function(){var _,C;for(C=[],c=_=0;0<=p?_<p:_>p;c=0<=p?++_:--_)C.push(t.readUInt16());return C}(),t.pos+=2,g=function(){var _,C;for(C=[],c=_=0;0<=p?_<p:_>p;c=0<=p?++_:--_)C.push(t.readUInt16());return C}(),u=function(){var _,C;for(C=[],c=_=0;0<=p?_<p:_>p;c=0<=p?++_:--_)C.push(t.readUInt16());return C}(),d=function(){var _,C;for(C=[],c=_=0;0<=p?_<p:_>p;c=0<=p?++_:--_)C.push(t.readUInt16());return C}(),a=(this.length-t.pos+this.offset)/2,l=function(){var _,C;for(C=[],c=_=0;0<=a?_<a:_>a;c=0<=a?++_:--_)C.push(t.readUInt16());return C}(),c=y=0,w=s.length;y<w;c=++y)for(b=s[c],n=v=m=g[c];m<=b?v<=b:v>=b;n=m<=b?++v:--v)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(p-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}t.pos=f}return e.encode=function(t,r){var n,a,s,o,l,c,u,d,f,p,h,m,g,b,y,v,w,_,C,j,A,M,P,R,N,T,B,G,re,xe,_e,V,K,de,ne,E,Z,H,F,ee,z,X,J,q,Y,L;switch(G=new ah,o=Object.keys(t).sort(function(U,ce){return U-ce}),r){case"macroman":for(g=0,b=function(){var U=[];for(m=0;m<256;++m)U.push(0);return U}(),v={0:0},s={},re=0,K=o.length;re<K;re++)v[J=t[a=o[re]]]==null&&(v[J]=++g),s[a]={old:t[a],new:v[t[a]]},b[a]=v[t[a]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(b),{charMap:s,subtable:G.data,maxGlyphID:g+1};case"unicode":for(T=[],f=[],w=0,v={},n={},y=u=null,xe=0,de=o.length;xe<de;xe++)v[C=t[a=o[xe]]]==null&&(v[C]=++w),n[a]={old:C,new:v[C]},l=v[C]-a,y!=null&&l===u||(y&&f.push(y),T.push(a),u=l),y=a;for(y&&f.push(y),f.push(65535),T.push(65535),R=2*(P=T.length),M=2*Math.pow(Math.log(P)/Math.LN2,2),p=Math.log(M/2)/Math.LN2,A=2*P-M,c=[],j=[],h=[],m=_e=0,ne=T.length;_e<ne;m=++_e){if(N=T[m],d=f[m],N===65535){c.push(0),j.push(0);break}if(N-(B=n[N].new)>=32768)for(c.push(0),j.push(2*(h.length+P-m)),a=V=N;N<=d?V<=d:V>=d;a=N<=d?++V:--V)h.push(n[a].new);else c.push(B-N),j.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*P+2*h.length),G.writeUInt16(0),G.writeUInt16(R),G.writeUInt16(M),G.writeUInt16(p),G.writeUInt16(A),z=0,E=f.length;z<E;z++)a=f[z],G.writeUInt16(a);for(G.writeUInt16(0),X=0,Z=T.length;X<Z;X++)a=T[X],G.writeUInt16(a);for(q=0,H=c.length;q<H;q++)l=c[q],G.writeUInt16(l);for(Y=0,F=j.length;Y<F;Y++)_=j[Y],G.writeUInt16(_);for(L=0,ee=h.length;L<ee;L++)g=h[L],G.writeUInt16(g);return{charMap:n,subtable:G.data,maxGlyphID:w+1}}},e}(),xz=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new iL(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,a;return r==null&&(r="macroman"),n=iL.encode(t,r),(a=new ah).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},e}(),pge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),mge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),gge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)r=t.readByte(),a.push(this.names.push(t.readString(r)));return a;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),xge=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},yge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,a,s,o,l,c,u,d,f,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)a=n[s],t.pos=a.offset,u=t.readString(a.length),o=new xge(u,a),c[p=a.nameID]==null&&(c[p]=[]),c[a.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),bge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),vge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,a,s,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=a?u<a:u>a;r=0<=a?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,f,p;for(p=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],p.push(s.advance);return p}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=a?o<a:o>a;r=0<=a?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),yz=[].slice,wge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,a,s,o,l,c,u,d,f;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(a=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new ah(r.read(a))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new _ge(l,u,f,c,d):new Sge(l,o,u,f,c,d),this.cache[t]))},e.prototype.encode=function(t,r,n){var a,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)a=t[r[l]],s.push(o.length),a&&(o=o.concat(a.encode(n)));return s.push(o.length),{table:o,offsets:s}},e}(),Sge=function(){function e(t,r,n,a,s,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),_ge=function(){function e(t,r,n,a,s){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new ah(yz.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),kge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Yu(e,ou),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],n=0,a=this.length;n<a;n+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<n.length;++o)if(n[o]=a,s<r.length&&r[s]==o){++s,n[o]=a;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(a+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},e}(),jge=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,s;for(r in a=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,s,o,l,c;for(a={},o=0,l=t.length;o<l;o++)a[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],a)(n=a[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],a[s]=n;return a},e.prototype.encode=function(t,r){var n,a,s,o,l,c,u,d,f,p,h,m,g,b,y;for(a in n=xz.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),h={0:0},y=n.charMap)h[(c=y[a]).old]=c.new;for(m in p=n.maxGlyphID,o)m in h||(h[m]=p++);return d=function(v){var w,_;for(w in _={},v)_[v[w]]=w;return _}(h),f=Object.keys(d).sort(function(v,w){return v-w}),g=function(){var v,w,_;for(_=[],v=0,w=f.length;v<w;v++)l=f[v],_.push(d[l]);return _}(),s=this.font.glyf.encode(o,g,h),u=this.font.loca.encode(s.offsets,g),b={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},e}();bn.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in s=["<<"],r)o=r[a],s.push("/"+a+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();const Age="/assets/logo-BRcnjZP7.jpg",Nge="K RAMAKRISHNAN COLLEGE OF TECHNOLOGY, Autonomous";function bz(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,64)}function Pb(e,t,r){const n=String(t??"");if(!n)return"";if(e.getTextWidth(n)<=r)return n;const a="",s=e.getTextWidth(a);if(s>=r)return"";let o=0,l=n.length;for(;o<l;){const c=Math.ceil((o+l)/2),u=n.slice(0,c);e.getTextWidth(u)+s<=r?o=c:l=c-1}return n.slice(0,Math.max(0,o))+a}function sL(e,t){const r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=e,n.click(),setTimeout(()=>URL.revokeObjectURL(r),500)}async function Cge(){var e;try{const t=await mr("/api/accounts/me/",{method:"GET"});if(!t.ok)return"";const r=await t.json(),n=String((r==null?void 0:r.username)||"").trim(),a=String(((e=r==null?void 0:r.profile)==null?void 0:e.staff_id)||"").trim();return n||a||""}catch{return""}}function vz(e){const t=String(e.collegeName||Nge).trim(),r=String(e.courseName||"").trim(),n=String(e.courseCode||"").trim(),a=String(e.staffName||"").trim(),s=String(e.className||"").trim();return[t,`Course Name: ${r||"-"}`,`Course Code: ${n||"-"}`,`Staff Name: ${a||"-"}`,`Class Name: ${s||"-"}`]}function Ege(e,t){const r=vz(e),n=["S.No","Reg No","Name","Total"],a=t.map(s=>[s.sno,s.regNo,s.name,s.total]);return[...r.map(s=>[s,"","",""]),[""],[n[0],n[1],n[2],n[3]],...a]}function Tge(e,t,r){const a=ds.book_new(),s=[];for(let l=0;l<r.length;l+=45)s.push(r.slice(l,l+45));s.length===0&&s.push([]),s.forEach((l,c)=>{const u=ds.aoa_to_sheet(Ege(t,l));u["!freeze"]={xSplit:0,ySplit:7},u["!cols"]=[{wch:6},{wch:16},{wch:34},{wch:12}],ds.book_append_sheet(a,u,s.length>1?`Page_${c+1}`:"Sheet1")});const o=`${bz(e)||"marks"}_totals.xlsx`;ty(a,o)}function Pge(e,t){if(e.availableH=Math.max(60,e.bottomY-e.tableTopY),t.length<=1){e.colsNeeded=1,e.rowsPerCol=Math.max(1,t.length),e.colW=e.availableW;return}e.colsNeeded=2,e.colW=(e.availableW-e.colGap)/2;const r=Math.max(1,Math.ceil(t.length/2)),n=()=>e.headerRowH+r*e.rowH<=e.availableH;let a=0;for(;a++<30&&!n()&&e.rowH>6;)e.tableFont=Math.max(5,e.tableFont-.25),e.rowH=Math.max(6,e.rowH-1),e.headerRowH=Math.max(9,e.headerRowH-1);e.rowsPerCol=r}function oL(e,t,r){const n=new bn({orientation:e,unit:"pt",format:"a4"}),a=n.internal.pageSize.getWidth(),s=n.internal.pageSize.getHeight(),o=32,l=34,c=s-28,u=a-o*2,d=12,f=l,p=Math.max(60,c-f);let h=8,m=12,g=14;const b=10,y=()=>{const A=Math.max(1,Math.floor((p-g)/m)),M=Math.max(1,Math.ceil(r.length/A)),P=(u-b*(M-1))/M;return{rowsPerCol:A,colsNeeded:M,colW:P}};let{rowsPerCol:v,colsNeeded:w,colW:_}=y();const C=150;let j=0;for(;j++<12&&_<C&&w>1;)h=Math.max(6,h-.5),m=Math.max(9,m-1),g=Math.max(11,g-1),{rowsPerCol:v,colsNeeded:w,colW:_}=y();return{doc:n,marginX:o,topY:l,bottomY:c,tableTopY:f,availableW:u,availableH:p,tableFont:h,headerFont:d,rowH:m,headerRowH:g,colGap:b,colsNeeded:w,rowsPerCol:v,colW:_}}function Oge(e,t,r,n){const a=t.tableTopY,s={sno:.12,reg:.3,name:.43,total:.15},o=t.colW*s.sno,l=t.colW*s.reg,c=t.colW*s.name,u=t.colW*s.total,d=3;e.setFontSize(t.tableFont);const f=[17,24,39],p=[255,255,255],h=[180,180,180];for(let m=0;m<t.colsNeeded;m++){const g=t.marginX+m*(t.colW+t.colGap);let b=a;e.setFillColor(f[0],f[1],f[2]),e.rect(g,b,t.colW,t.headerRowH,"F"),e.setTextColor(p[0],p[1],p[2]);const y=b+t.headerRowH-4;e.text("S.No",g+d,y),e.text("Reg No",g+o+d,y),e.text("Name",g+o+l+d,y),e.text("Total",g+o+l+c+d,y),e.setDrawColor(h[0],h[1],h[2]),e.rect(g,b,t.colW,t.headerRowH),e.line(g+o,b,g+o,b+t.headerRowH),e.line(g+o+l,b,g+o+l,b+t.headerRowH),e.line(g+o+l+c,b,g+o+l+c,b+t.headerRowH),b+=t.headerRowH,e.setTextColor(0,0,0);const v=m*t.rowsPerCol,w=Math.min(n.length,v+t.rowsPerCol);for(let _=v;_<w;_++){const C=n[_],j=b+(_-v)*t.rowH;e.rect(g,j,t.colW,t.rowH),e.line(g+o,j,g+o,j+t.rowH),e.line(g+o+l,j,g+o+l,j+t.rowH),e.line(g+o+l+c,j,g+o+l+c,j+t.rowH);const A=j+t.rowH-3,M=Pb(e,String((C==null?void 0:C.sno)??""),Math.max(0,o-d*2)),P=Pb(e,String((C==null?void 0:C.regNo)??""),Math.max(0,l-d*2)),R=Pb(e,String((C==null?void 0:C.name)??""),Math.max(0,c-d*2)),N=Pb(e,String((C==null?void 0:C.total)??""),Math.max(0,u-d*2));e.text(M,g+d,A),e.text(P,g+o+d,A),e.text(R,g+o+l+d,A),e.text(N,g+o+l+c+d,A)}}}async function Lge(e){try{const t=await fetch(e,{cache:"no-cache"});if(!t.ok)return null;const r=await t.blob();return await new Promise(n=>{const a=new FileReader;a.onload=()=>n(String(a.result||"")),a.onerror=()=>n(null),a.readAsDataURL(r)})}catch{return null}}async function Mge(e,t,r,n){const a=String((r==null?void 0:r.bannerUrl)||Age),s=(r==null?void 0:r.bannerUrl)||a,o=await Lge(s),l=n.length>=55;let c=0;if(o)try{const p=new Image;p.src=o,await new Promise(A=>{p.onload=()=>A(!0),p.onerror=()=>A(!0)});const h=p.naturalWidth||p.width||1,m=p.naturalHeight||p.height||1,g=t.doc.internal.pageSize.getWidth(),b=l?135:170,y=g-2*t.marginX,v=h/m;let w=y,_=w/v;_>b&&(_=b,w=_*v);const C=(g-w)/2,j=12;t.doc.addImage(o,"PNG",C,j,w,_),c=_,t.tableTopY=j+_+(l?10:14)}catch{}else t.tableTopY=t.topY;const u=t.tableTopY;e.setFontSize(l?8:9),e.setTextColor(0,0,0);const d=[];r.courseName&&d.push(`Course Name: ${r.courseName}`),r.courseCode&&d.push(`Course Code: ${r.courseCode}`),r.staffName&&d.push(`Staff Name: ${r.staffName}`),r.className&&d.push(`Class Name: ${r.className}`);const f=l?10:11;for(let p=0;p<d.length;p++)e.text(d[p],t.marginX,u+p*f);return t.tableTopY=u+d.length*f+(l?6:10),Pge(t,n),Oge(e,t,r,n)}async function vk(e,t,r){const n=oL("portrait",t,r),s=n.colsNeeded>=4?oL("landscape",t,r):n;await Mge(s.doc,s,t,r);const o=s.doc.output("blob"),l=`${bz(e)||"marks"}_totals.pdf`;return{blob:o,filename:l}}function Fge(e,t,r){e.innerHTML="";const n=vz(t),a=document.createElement("div");a.style.display="flex",a.style.flexDirection="column",a.style.gap="2px",a.style.marginBottom="10px",n.forEach(d=>{const f=document.createElement("div");f.textContent=d,f.style.fontWeight=d===n[0]?"900":"700",f.style.fontSize=d===n[0]?"14px":"12px",a.appendChild(f)}),e.appendChild(a);const s=document.createElement("div");s.className="obe-table-wrapper",s.style.maxHeight="420px",s.style.overflow="auto";const o=document.createElement("table");o.className="obe-table",o.style.minWidth="unset";const l=document.createElement("thead"),c=document.createElement("tr");["S.No","Reg No","Name","Total"].forEach(d=>{const f=document.createElement("th");f.textContent=d,c.appendChild(f)}),l.appendChild(c),o.appendChild(l);const u=document.createElement("tbody");r.forEach(d=>{const f=document.createElement("tr");[d.sno,d.regNo,d.name,d.total].forEach(p=>{const h=document.createElement("td");h.textContent=String(p??""),f.appendChild(h)}),u.appendChild(f)}),o.appendChild(u),s.appendChild(o),e.appendChild(s)}function Rge(e,t){e.innerHTML="";const r=URL.createObjectURL(t),n=document.createElement("iframe");return n.src=r,n.style.width="100%",n.style.height="520px",n.style.border="1px solid rgba(226,232,240,0.9)",n.style.borderRadius="10px",e.appendChild(n),()=>URL.revokeObjectURL(r)}async function Bge(e){if(typeof document>"u"||typeof window>"u"){const{blob:_,filename:C}=await vk(e.filenameBase,e.meta,e.rows);sL(C,_);return}const t=document.createElement("div");t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.style.position="fixed",t.style.inset="0",t.style.background="rgba(0,0,0,0.35)",t.style.display="grid",t.style.placeItems="center",t.style.padding="16px",t.style.zIndex="9999";const r=document.createElement("div");r.className="obe-card",r.style.width="min(980px, 100%)",r.style.maxHeight="min(92vh, 900px)",r.style.overflow="auto";const n=document.createElement("div");n.textContent="Preview totals before download",n.style.fontWeight="950",n.style.fontSize="14px",n.style.marginBottom="10px";const a=document.createElement("div");a.style.display="flex",a.style.gap="8px",a.style.flexWrap="wrap",a.style.alignItems="center",a.style.justifyContent="space-between",a.style.marginBottom="10px";const s=document.createElement("div");s.style.display="flex",s.style.gap="8px",s.style.flexWrap="wrap";const o=document.createElement("button");o.className="obe-btn obe-btn-secondary",o.textContent="Excel preview";const l=document.createElement("button");l.className="obe-btn obe-btn-primary",l.textContent="PDF preview",s.appendChild(o),s.appendChild(l);const c=document.createElement("div");c.style.display="flex",c.style.gap="8px",c.style.flexWrap="wrap";const u=document.createElement("button");u.className="obe-btn",u.textContent="Close";const d=document.createElement("button");d.className="obe-btn obe-btn-success",d.textContent="Download",c.appendChild(u),c.appendChild(d),a.appendChild(s),a.appendChild(c);const f=document.createElement("div");r.appendChild(n),r.appendChild(a),r.appendChild(f),t.appendChild(r);let p="pdf",h=null,m=null;const g=()=>{o.className=p==="excel"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",l.className=p==="pdf"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary"},b=async()=>{if(h&&(h(),h=null),f.innerHTML="",g(),p==="excel"){m=null,Fge(f,e.meta,e.rows);return}m=await vk(e.filenameBase,e.meta,e.rows),h=Rge(f,m.blob)};let y=!1;const v=()=>{if(!y){y=!0,h&&h();try{window.removeEventListener("keydown",w),t.remove()}catch{}}},w=_=>{_.key==="Escape"&&v()};t.addEventListener("click",_=>{_.target===t&&v()}),u.addEventListener("click",v),o.addEventListener("click",()=>{p="excel",b()}),l.addEventListener("click",()=>{p="pdf",b()}),d.addEventListener("click",async()=>{if(p==="excel"){Tge(e.filenameBase,e.meta,e.rows);return}const _=m||await vk(e.filenameBase,e.meta,e.rows);sL(_.filename,_.blob)}),window.addEventListener("keydown",w),document.body.appendChild(t),b()}async function ny(e){const t={...e.meta};t.staffName||(t.staffName=await Cge());const r=(e.rows||[]).filter(n=>n&&n.regNo);await Bge({filenameBase:e.filenameBase,meta:t,rows:r})}const wk={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},lL=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function cL(e){if(e==="both")return"both";if(e==="1&2"||e==="3&4")return e;if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="5")return 5;if(r==="4")return 4;if(r==="3")return 3;if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(4))return 4;if(r.includes(3))return 3;if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===5?5:t===4?4:t===3?3:t===2?2:t===34?"3&4":t===12?"1&2":1}function Ige(e){return e==="cia2"?{a:3,b:4}:{a:1,b:2}}function HA(e){return e==="both"||e==="1&2"||e==="3&4"}function Dge(e,t){if(HA(e))return{a:.5,b:.5};const r=t.a===3,n=e===t.a||r&&e===1,a=e===t.b||r&&e===2;return n?{a:1,b:0}:a?{a:0,b:1}:{a:0,b:0}}function Ob(e,t,r){const n=e[t];if(!n)return{a:0,b:0};if(HA(n.co))return{a:.5,b:.5};const a=e.some(l=>HA(l.co)),s=t===e.length-1,o=String(n.key||"").toLowerCase()==="q9"||String(n.label||"").toLowerCase().includes("q9");return!a&&s&&o?{a:.5,b:.5}:Dge(n.co,r)}function Nh(e){return Object.fromEntries((e||[]).map(t=>[t.key,t.btl]))}function od(e,t,r){return Math.max(t,Math.min(r,e))}function ld(e,t){if(!t)return"-";const r=e/t*100;if(!Number.isFinite(r))return"-";const n=r.toFixed(1);return n.endsWith(".0")?n.slice(0,-2):n}function Lb(e,t){return`${e}_sheet_${t}`}function $ge(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),a=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function wz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,classType:n,questionPaperType:a}){const s=r||"cia1",o=s==="cia2"?"CIA 2":"CIA 1",l=x.useMemo(()=>Ige(s),[s]),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState(null),b=x.useMemo(()=>{const ie=String(In(n)||"").trim().toUpperCase();return ie?ie==="THEORY"?"THEORY":ie:""},[n]),y=x.useMemo(()=>{const ie=String(a??"").trim().toUpperCase();return ie==="QP2"?"QP2":ie==="QP1"?"QP1":""},[a]);x.useEffect(()=>{let ie=!0;return(async()=>{var pt,ut;if(!b){h(null);return}const se=b==="THEORY"&&y||null,ve=s==="cia2"?"CIA2":"CIA1";let Pe=null,Ke=[];try{Pe=await Gf({class_type:b,question_paper_type:se,exam:ve}),Ke=Array.isArray((pt=Pe==null?void 0:Pe.pattern)==null?void 0:pt.marks)?Pe.pattern.marks:[]}catch{}if(!Ke.length)try{Pe=await Gf({class_type:b,question_paper_type:se,exam:"CIA"}),Ke=Array.isArray((ut=Pe==null?void 0:Pe.pattern)==null?void 0:ut.marks)?Pe.pattern.marks:[]}catch{}ie&&h(Ke.length?Pe.pattern:null)})(),()=>{ie=!1}},[b,y,s]);const v=x.useMemo(()=>{var Pe,Ke,pt,ut;const ie=((Ke=(Pe=c==null?void 0:c.assessments)==null?void 0:Pe[s])==null?void 0:Ke.questions)??((ut=(pt=c==null?void 0:c.assessments)==null?void 0:pt.cia1)==null?void 0:ut.questions),I=Array.isArray(ie)&&ie.length?ie.map(Lt=>({key:String((Lt==null?void 0:Lt.key)||""),label:String((Lt==null?void 0:Lt.label)||(Lt==null?void 0:Lt.key)||""),max:Number((Lt==null?void 0:Lt.max)||0),co:cL(Lt==null?void 0:Lt.co),btl:Math.min(6,Math.max(1,Number((Lt==null?void 0:Lt.btl)||1)))})).filter(Lt=>Lt.key):lL,se=Array.isArray(p==null?void 0:p.marks)?p.marks:null,ve=Array.isArray(p==null?void 0:p.cos)?p.cos:null;return Array.isArray(se)&&se.length?se.map((Lt,Sr)=>{const hr=I[Sr],mt=ve?ve[Sr]:void 0;return{key:`q${Sr+1}`,label:`Q${Sr+1}`,max:Number(Lt)||0,co:mt!=null?cL(mt):(hr==null?void 0:hr.co)??l.a,btl:(hr==null?void 0:hr.btl)??1}}).filter(Lt=>!!Lt.key):I},[c,s,p,l.a]),[w,_]=x.useState(!1),[C,j]=x.useState(!1),[A,M]=x.useState(!1),[P,R]=x.useState(null),[N,T]=x.useState([]),[B,G]=x.useState({}),[re,xe]=x.useState(null),[_e,V]=x.useState(null),[K,de]=x.useState(!1),[ne,E]=x.useState(!1),[Z,H]=x.useState(null),[F,ee]=x.useState(null),z=x.useRef(null),[X,J]=x.useState(!1),[q,Y]=x.useState(""),[L,U]=x.useState(!1),[ce,W]=x.useState(null),[ae,he]=x.useState(!1),[ze,ke]=x.useState(null),[qe,Ie]=x.useState(null),{data:Ve,loading:Qe,error:Tt,remainingSeconds:vt,publishAllowed:Xe,refresh:Be}=dh({assessment:s,subjectCode:e,teachingAssignmentId:t}),ct=!!(Ve!=null&&Ve.global_override_active&&(Ve==null?void 0:Ve.global_is_open)===!1),{data:nt,refresh:Se}=fh({assessment:s,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:Te}=Ul({assessment:s,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:Dt}=Ul({assessment:s,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),[wt,Pt]=x.useState(""),[Wt,Ot]=x.useState(!1),[Ht,Pr]=x.useState(null),[jt,ur]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,questionBtl:Nh(lL),rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),Ir=x.useRef(null),[Rr,Nr]=x.useState(!1),[zr,_n]=x.useState(null),[Yr,pn]=x.useState(!1),[ge,Ne]=x.useState(null),[dt,Ue]=x.useState([]),[Re,xt]=x.useState([]),[at,er]=x.useState([]),[oe,ue]=x.useState(null);x.useEffect(()=>{ue(null),W(null)},[e]);const Q=!!_e||!!(nt!=null&&nt.exists&&(nt!=null&&nt.is_published)),ye=!!jt.markManagerLocked;jt.markManagerSnapshot!=null;const je=Dt!=null&&Dt.approval_until?String(Dt.approval_until):null,Ce=Te!=null&&Te.approval_until?String(Te.approval_until):null,ot=!!(Dt!=null&&Dt.allowed_by_approval)&&!!je&&je!==((oe==null?void 0:oe.markEntryApprovalUntil)??null),it=!!(Te!=null&&Te.allowed_by_approval)&&!!Ce&&Ce!==((oe==null?void 0:oe.markManagerApprovalUntil)??null),We=Q?!!(nt!=null&&nt.entry_open)||ot||it:!0,De=!!(Q&&!We),pe=!!(ct||(Q?!We:!ye));function Je(ie,I){return JSON.stringify({assessmentKey:s,totalsMax:Ft,questions:(v||[]).map(se=>({key:se.key,label:se.label,max:se.max})),questionBtl:ie,mark_manager:{questions:(I==null?void 0:I.questions)??[],marks:(I==null?void 0:I.marks)??[],btls:(I==null?void 0:I.btls)??[]}})}async function Ge(){if(e){pn(!0),Ne(null);try{await qo({assessment:s,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${o} ${e}`,teaching_assignment_id:t}),alert("Edit request sent to IQAC.")}catch(ie){Ne((ie==null?void 0:ie.message)||"Request failed"),alert((ie==null?void 0:ie.message)||"Request failed")}finally{pn(!1)}}}async function Ye(){if(e){U(!0);try{await qo({assessment:s,subject_code:String(e),scope:"MARK_ENTRY",reason:q||`Edit request: ${o} marks entry for ${e}`,teaching_assignment_id:t}),W("Request sent to IQAC for edit approval."),J(!1),Se({silent:!0})}catch(ie){alert((ie==null?void 0:ie.message)||"Request failed")}finally{U(!1)}}}x.useEffect(()=>{if(!e||!Q||We)return;const ie=window.setInterval(()=>{Se({silent:!0})},3e4);return()=>window.clearInterval(ie)},[We,Q,e,Se]);const ft=x.useRef(!!We);x.useEffect(()=>{if(!e||!Q)return;if(ft.current||!We){ft.current=!!We;return}let I=!0;return(async()=>{try{const se=await Mn(s,e);if(!I)return;const ve=se==null?void 0:se.draft;ve&&typeof ve=="object"?ur(Pe=>({...Pe,termLabel:String(ve.termLabel||Pe.termLabel),batchLabel:e,questionBtl:ve.questionBtl&&typeof ve.questionBtl=="object"?ve.questionBtl:Pe.questionBtl,rowsByStudentId:ve.rowsByStudentId&&typeof ve.rowsByStudentId=="object"?ve.rowsByStudentId:Pe.rowsByStudentId,markManagerLocked:ve.markManagerLocked??Pe.markManagerLocked,markManagerSnapshot:ve.markManagerSnapshot??Pe.markManagerSnapshot,markManagerApprovalUntil:ve.markManagerApprovalUntil??Pe.markManagerApprovalUntil})):bt(!0)}catch{try{bt(!0)}catch{}}})(),ft.current=!!We,()=>{I=!1}},[We,Q,e,s]);const bt=async ie=>{if(e){ie||(H(null),E(!0));try{const I=await h0(s,e,t),se=I&&I.data!=null?I.data:null;ee(se)}catch(I){ie||H((I==null?void 0:I.message)||"Failed to load published sheet")}finally{ie||E(!1)}}};x.useEffect(()=>{K&&(ee(null),bt(!1))},[K,e,s]);async function Vt(){if(e){pn(!0),Ne(null);try{const ie=Je(jt.questionBtl,{questions:dt,marks:Re,btls:at}),I=Te!=null&&Te.approval_until?String(Te.approval_until):jt.markManagerApprovalUntil||null,se={...jt,markManagerLocked:!0,markManagerSnapshot:ie,markManagerApprovalUntil:I},ve={termLabel:se.termLabel,batchLabel:e,questionBtl:se.questionBtl,rowsByStudentId:se.rowsByStudentId,markManagerLocked:se.markManagerLocked,markManagerSnapshot:se.markManagerSnapshot,markManagerApprovalUntil:se.markManagerApprovalUntil};ur(se),_n(null),await li(s,e,ve),xe(new Date().toLocaleString());try{await Zf(s,String(e),t),Se({silent:!0})}catch(Pe){console.warn("confirmMarkManagerLock failed",Pe)}}catch(ie){Ne((ie==null?void 0:ie.message)||"Save failed")}finally{pn(!1)}}}x.useEffect(()=>{if(!(!zr||zr.mode!=="confirm"))try{if(jt.markManagerSnapshot){const ie=JSON.parse(String(jt.markManagerSnapshot)),I=ie&&ie.mark_manager||{};Ue(Array.isArray(I.questions)?I.questions.map(se=>Number(se)).filter(se=>Number.isFinite(se)):[]),xt(Array.isArray(I.marks)?I.marks.map(se=>Number(se)).filter(se=>Number.isFinite(se)):[]),er(Array.isArray(I.btls)?I.btls.map(se=>Number(se)).filter(se=>Number.isFinite(se)):[])}else Ue([]),xt([]),er([])}catch{Ue([]),xt([]),er([])}},[zr]),x.useEffect(()=>{let ie=!0;return(async()=>{try{const I=await iu();if(!ie)return;u(I||null),f(null),ur(se=>({...se,termLabel:String((I==null?void 0:I.termLabel)||se.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch(I){if(!ie)return;u(null),f((I==null?void 0:I.message)||"Failed to load OBE Master config; using derived maxima from questions.")}})(),()=>{ie=!1}},[e]),x.useEffect(()=>{let ie=!0;return(async()=>{if(e){_(!0),R(null);try{let se=null,ve=null;try{ve=(await jc()||[]).find(_t=>{const cr=String(_t.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?_t.id===t:!1)||cr})}catch{}if(ve&&ve.elective_subject_id&&!ve.section_id)try{const mt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(ve.elective_subject_id))}`);if(mt.ok){const _t=await mt.json();se={students:((Array.isArray(_t.results)?_t.results:Array.isArray(_t)?_t:_t.items||[])||[]).map(sr=>({id:Number(sr.student_id??sr.id),reg_no:String(sr.reg_no??sr.regno??""),name:String(sr.name??sr.full_name??sr.username??""),section:sr.section_name??sr.section??null})),marks:{}}}}catch(mt){console.warn("Elective-choices fetch failed, falling back:",mt)}if(!se)try{se=await h9(s,e,t)}catch(mt){if(console.warn("CIA marks fetch failed:",mt),ve&&ve.id)try{se={students:(await Ac(ve.id)).students||[],marks:{}}}catch{console.warn("TA roster fallback failed")}if(!se)throw mt}if(!ie)return;let Pe=(se.students||[]).slice().sort((mt,_t)=>{const cr=String((mt==null?void 0:mt.name)||"").trim().toLowerCase(),sr=String((_t==null?void 0:_t.name)||"").trim().toLowerCase();if(cr&&sr){const pr=cr.localeCompare(sr);if(pr)return pr}else if(cr||sr)return cr?-1:1;return String((mt==null?void 0:mt.reg_no)||"").localeCompare(String((_t==null?void 0:_t.reg_no)||""),void 0,{numeric:!0,sensitivity:"base"})});T(Pe),g((se==null?void 0:se.subject)||null);const Ke=se.marks||{},pt={};for(const[mt,_t]of Object.entries(Ke)){const cr=Number(mt);if(!Number.isFinite(cr))continue;if(_t==null||_t===""){pt[cr]=null;continue}const sr=Number(_t);pt[cr]=Number.isFinite(sr)?sr:null}G(pt);try{let mt=null;if(s==="cia1"?mt=await V1(e):mt=await h0("cia2",e),mt&&mt.data&&typeof mt.data=="object"){const _t=mt.data,cr=_t.rowsByStudentId||_t.rows||_t.sheet&&_t.sheet.rowsByStudentId||{},sr={};for(const[qr,Ur]of Object.entries(cr||{})){const Qr=String(qr),on=Ur,gn={},ea=on.q||on.answers||on.questions||on;if(ea&&typeof ea=="object")for(const[ma,ga]of Object.entries(ea)){const ta=Number(ga);gn[ma]=Number.isFinite(ta)?ta:""}sr[Qr]={studentId:Number(Qr)||0,absent:!!on.absent,absentKind:on.absentKind||void 0,reg_no:String(on.reg_no||on.reg_no_text||""),q:gn}}const pr=Array.isArray(_t.questions)?Object.fromEntries(_t.questions.map(qr=>[String(qr.key||qr.label||""),Number(qr.btl||qr.btl_level||1)])):Nh(v),Dr=Object.fromEntries(Object.entries(pr).map(([qr,Ur])=>{const Qr=Number(Ur);return Number.isFinite(Qr)&&Qr>=1&&Qr<=6?[qr,Qr]:[qr,""]}));ur({termLabel:String(_t.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:Dr,rowsByStudentId:sr}),V(new Date().toLocaleString());try{Sn(Lb(s,e),{termLabel:String(_t.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:Dr,rowsByStudentId:sr})}catch{}}}catch{}const ut=Pn(Lb(s,e)),Lt=ut&&typeof ut=="object"?{termLabel:c!=null&&c.termLabel?String(c.termLabel):String(ut.termLabel||"KRCT AY25-26"),batchLabel:e,questionBtl:ut.questionBtl&&typeof ut.questionBtl=="object"?ut.questionBtl:Nh(v),rowsByStudentId:ut.rowsByStudentId&&typeof ut.rowsByStudentId=="object"?ut.rowsByStudentId:{}}:{termLabel:String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:Nh(v),rowsByStudentId:{}},Sr={...Nh(v),...Lt.questionBtl||{}};for(const mt of v){const _t=Sr[mt.key];_t===""||_t===1||_t===2||_t===3||_t===4||_t===5||_t===6||(Sr[mt.key]="")}const hr={...Lt.rowsByStudentId};for(const mt of se.students||[]){const _t=String(mt.id);if(hr[_t]){const cr=!!hr[_t].absent,sr=String(hr[_t].absentKind||"").toUpperCase(),pr=cr?sr==="ML"||sr==="SKL"||sr==="AL"?sr:"AL":void 0;hr[_t]={studentId:mt.id,absent:cr,absentKind:pr,reg_no:mt.reg_no||"",q:{...hr[_t].q}}}else hr[_t]={studentId:mt.id,absent:!1,absentKind:void 0,reg_no:mt.reg_no||"",q:Object.fromEntries(v.map(cr=>[cr.key,""]))};for(const cr of v)cr.key in(hr[_t].q||{})||(hr[_t].q[cr.key]="")}ur({...Lt,questionBtl:Sr,termLabel:Lt.termLabel||String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,rowsByStudentId:hr})}catch(se){if(!ie)return;R((se==null?void 0:se.message)||`Failed to load ${o} roster`)}finally{ie&&_(!1)}}})(),()=>{ie=!1}},[e,t,c,v,s,o]),x.useEffect(()=>{let ie=!0;return(async()=>{if(e)try{const I=await Mn(s,e);if(!ie)return;const se=I==null?void 0:I.draft;if(se&&typeof se=="object"){ur(ve=>({...ve,termLabel:String(se.termLabel||ve.termLabel),batchLabel:e,questionBtl:se.questionBtl&&typeof se.questionBtl=="object"?se.questionBtl:ve.questionBtl,rowsByStudentId:se.rowsByStudentId&&typeof se.rowsByStudentId=="object"?se.rowsByStudentId:ve.rowsByStudentId}));try{const ve=Lb(s,e);Sn(ve,{termLabel:String(se.termLabel||"KRCT AY25-26"),batchLabel:String(e),questionBtl:se.questionBtl&&typeof se.questionBtl=="object"?se.questionBtl:Nh(v),rowsByStudentId:se.rowsByStudentId&&typeof se.rowsByStudentId=="object"?se.rowsByStudentId:{}})}catch{}}}catch{if(!ie)return}})(),()=>{ie=!1}},[e,s,v]);const Ft=x.useMemo(()=>v.reduce((ie,I)=>ie+I.max,0),[v]),gr=x.useMemo(()=>{let ie=0,I=0;for(let se=0;se<v.length;se++){const ve=v[se],Pe=Ob(v,se,l);ie+=ve.max*Pe.a,I+=ve.max*Pe.b}return{a:ie,b:I}},[v,l]),Ar=x.useMemo(()=>{var ve,Pe,Ke,pt;const ie=((Pe=(ve=c==null?void 0:c.assessments)==null?void 0:ve[s])==null?void 0:Pe.coMax)??((pt=(Ke=c==null?void 0:c.assessments)==null?void 0:Ke.cia1)==null?void 0:pt.coMax),I=Number((ie==null?void 0:ie[`co${l.a}`])??(ie==null?void 0:ie.co1)),se=Number((ie==null?void 0:ie[`co${l.b}`])??(ie==null?void 0:ie.co2));return{a:Number.isFinite(I)?Math.max(0,I):gr.a,b:Number.isFinite(se)?Math.max(0,se):gr.b}},[c,gr,s,l]),kr=x.useMemo(()=>{const ie=new Set;for(const I of v){const se=(jt.questionBtl||{})[I.key];(se===1||se===2||se===3||se===4||se===5||se===6)&&ie.add(se)}return[1,2,3,4,5,6].filter(I=>ie.has(I))},[jt.questionBtl,v]),At=x.useMemo(()=>{const ie={1:0,2:0,3:0,4:0,5:0,6:0};for(const I of v){const se=(jt.questionBtl||{})[I.key];(se===1||se===2||se===3||se===4||se===5||se===6)&&(ie[se]+=I.max)}return ie},[jt.questionBtl,v]),Ut=x.useMemo(()=>{var se,ve,Pe,Ke;const ie=((ve=(se=c==null?void 0:c.assessments)==null?void 0:se[s])==null?void 0:ve.btlMax)??((Ke=(Pe=c==null?void 0:c.assessments)==null?void 0:Pe.cia1)==null?void 0:Ke.btlMax),I=(pt,ut)=>{const Lt=Number(ie==null?void 0:ie[pt]);return Number.isFinite(Lt)?Math.max(0,Lt):ut};return{1:I("1",At[1]),2:I("2",At[2]),3:I("3",At[3]),4:I("4",At[4]),5:I("5",At[5]),6:I("6",At[6])}},[c,At,s]),Kr=(ie,I)=>{A||pe||ur(se=>{const ve=String(ie),Pe=se.rowsByStudentId[ve]||{studentId:ie,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(pt=>[pt.key,""]))},Ke=I?{...Pe,absent:!0,absentKind:Pe.absentKind||"AL",q:Object.fromEntries(v.map(pt=>[pt.key,""]))}:{...Pe,absent:!1,absentKind:void 0};return{...se,rowsByStudentId:{...se.rowsByStudentId,[ve]:Ke}}})},$t=(ie,I)=>{A||pe||ur(se=>{const ve=String(ie),Pe=se.rowsByStudentId[ve]||{studentId:ie,absent:!0,absentKind:"AL",reg_no:"",q:Object.fromEntries(v.map(Ke=>[Ke.key,""]))};return{...se,rowsByStudentId:{...se.rowsByStudentId,[ve]:{...Pe,absent:!0,absentKind:I}}}})},fr=(ie,I)=>{if(A||ct)return;const se=jt.markManagerSnapshot!=null;ye&&se||De||ur(ve=>({...ve,questionBtl:{...ve.questionBtl||Nh(v),[ie]:I}}))};x.useEffect(()=>{if(!e)return;let ie=!1;const I=setTimeout(async()=>{try{const se={termLabel:jt.termLabel,batchLabel:e,questionBtl:jt.questionBtl,rowsByStudentId:jt.rowsByStudentId};await li(s,e,se);try{const ve=Lb(s,e);Sn(ve,{termLabel:jt.termLabel,batchLabel:e,questionBtl:jt.questionBtl,rowsByStudentId:jt.rowsByStudentId})}catch{}ie||xe(new Date().toLocaleString())}catch{}},700);return()=>{ie=!0,clearTimeout(I)}},[jt.questionBtl,e,jt.rowsByStudentId,s]);const Or=(ie,I,se)=>{A||pe||ur(ve=>{const Pe=String(ie),Ke=ve.rowsByStudentId[Pe]||{studentId:ie,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(sr=>[sr.key,""]))},pt=!!Ke.absent,ut=pt?String(Ke.absentKind||"AL").toUpperCase():"";if(pt&&!!!(ae&&pt))return ve;const Sr=v.find(sr=>sr.key===I),hr=(Sr==null?void 0:Sr.max)??Ft,mt=se===""?"":od(Number(se||0),0,hr),_t=Ke.absent?Ke.absentKind||"AL":null,cr=_t==="ML"?60:_t==="SKL"?75:null;return cr!=null&&v.reduce((pr,Dr)=>{const qr=Dr.key===I?mt:(Ke.q||{})[Dr.key];return pr+od(Number(qr||0),0,Dr.max)},0)>cr?(Ie({title:"Mark limit exceeded",message:ut==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"}),ve):{...ve,rowsByStudentId:{...ve.rowsByStudentId,[Pe]:{...Ke,q:{...Ke.q||{},[I]:mt}}}}})},gt=ie=>!ie||!ie.q?!1:v.some(I=>{const se=ie.q[I.key];return se!==""&&se!==null&&se!==void 0});x.useMemo(()=>{const ie={};for(const I of N){const se=jt.rowsByStudentId[String(I.id)];if(!se){ie[I.id]=null;continue}if(se.absent&&String(se.absentKind||"AL").toUpperCase()==="AL"){ie[I.id]=0;continue}const ve=v.reduce((Pe,Ke)=>{var pt;return Pe+od(Number(((pt=se.q)==null?void 0:pt[Ke.key])||0),0,Ke.max)},0);ie[I.id]=ve}return ie},[N,jt.rowsByStudentId,v]);const Jt=async()=>{j(!0),R(null);try{const ie={termLabel:jt.termLabel,batchLabel:e,questionBtl:jt.questionBtl,rowsByStudentId:jt.rowsByStudentId};await li(s,e,ie),xe(new Date().toLocaleString())}catch(ie){R((ie==null?void 0:ie.message)||`Failed to save ${o} draft`)}finally{j(!1)}},ht=async()=>{var ie;if(e){if(ct){R("Publishing is locked by IQAC.");return}if(!Xe){R("Publish window is closed. Please request IQAC approval.");return}if(Q&&De){J(!0);return}M(!0),R(null),W(null);try{const I={};for(const[ve,Pe]of Object.entries(jt.rowsByStudentId||{})){const Ke=Pe||{},pt=gt(Ke);Ke.absent&&pt?I[ve]={...Ke,absent:!1,absentKind:void 0}:I[ve]=Ke}const se={...jt,batchLabel:e,questions:v,rowsByStudentId:I};await f9(s,e,se,t),V(new Date().toLocaleString()),ue({markEntryApprovalUntil:je,markManagerApprovalUntil:Ce}),ur(ve=>({...ve,markManagerLocked:!0})),Be(),Se({silent:!0}),bt(!0);try{console.debug("obe:published dispatch",{assessment:s,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:s}}))}catch{}setTimeout(()=>{try{if(K&&z.current){const ve=z.current;ve.scrollTop=ve.scrollHeight}}catch{}},50)}catch(I){const se=I==null?void 0:I.status;if(String(((ie=I==null?void 0:I.body)==null?void 0:ie.detail)||(I==null?void 0:I.message)||""),se===423){V(ve=>ve||new Date().toLocaleString()),Be(),Se({silent:!0}),R(null),J(!0);return}R((I==null?void 0:I.message)||`Failed to publish ${o}`)}finally{M(!1)}}},Ct=async()=>{Ot(!0),Pr(null),R(null);try{await R0({assessment:s,subject_code:e,reason:wt,teaching_assignment_id:t}),Pr("Request sent to IQAC for approval.")}catch(ie){R((ie==null?void 0:ie.message)||"Failed to request approval")}finally{Ot(!1),Be()}},rr=()=>{const ie=N.map((I,se)=>{const ve=jt.rowsByStudentId[String(I.id)]||{studentId:I.id,absent:!1,absentKind:void 0,q:Object.fromEntries(v.map(sr=>[sr.key,""]))},Pe=gt(ve),Ke=!!(ve.absent&&!Pe),pt=Ke?String(ve.absentKind||"AL"):"";if(Ke){const sr=Object.fromEntries(v.map(pr=>[pr.key,""]));return{sno:se+1,registerNo:I.reg_no,name:I.name,absent:1,absentKind:pt,...sr,total:"ABSENT",[`co${l.a}_mark`]:"",[`co${l.a}_pct`]:"",[`co${l.b}_mark`]:"",[`co${l.b}_pct`]:"",...Object.fromEntries(kr.flatMap(pr=>[[`btl${pr}_mark`,""],[`btl${pr}_pct`,""]]))}}const ut=0,Lt="",Sr=Object.fromEntries(v.map(sr=>{var pr;return[sr.key,od(Number(((pr=ve.q)==null?void 0:pr[sr.key])||0),0,sr.max)]})),hr=v.reduce((sr,pr)=>sr+Number(Sr[pr.key]||0),0);let mt=0,_t=0;for(let sr=0;sr<v.length;sr++){const pr=v[sr],Dr=Ob(v,sr,l),qr=Number(Sr[pr.key]||0);mt+=qr*Dr.a,_t+=qr*Dr.b}const cr={1:0,2:0,3:0,4:0,5:0,6:0};for(const sr of v){const pr=(jt.questionBtl||{})[sr.key];(pr===1||pr===2||pr===3||pr===4||pr===5||pr===6)&&(cr[pr]+=Number(Sr[sr.key]||0))}return{sno:se+1,registerNo:I.reg_no,name:I.name,absent:ut,absentKind:Lt,...Sr,total:hr,[`co${l.a}_mark`]:mt,[`co${l.a}_pct`]:ld(mt,Ar.a),[`co${l.b}_mark`]:_t,[`co${l.b}_pct`]:ld(_t,Ar.b),...Object.fromEntries(kr.flatMap(sr=>[[`btl${sr}_mark`,cr[sr]],[`btl${sr}_pct`,ld(cr[sr],Ut[sr])]]))}});$ge(`${e}_${s.toUpperCase()}_sheet.csv`,ie)},kt=async()=>{try{const ie=new URLSearchParams;t&&ie.set("teaching_assignment_id",String(t)),y&&ie.set("question_paper_type",String(y));const ve=`${(wk==null?void 0:wk.VITE_API_BASE)||(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.zynix.us")}/api/obe/cia-export-template/${encodeURIComponent(s)}/${encodeURIComponent(e)}${ie.toString()?`?${ie.toString()}`:""}`,Pe=await mr(ve,{method:"GET"});if(!Pe.ok){const Lt=await Pe.text();throw new Error(Lt||`Export failed (${Pe.status})`)}const Ke=await Pe.blob(),pt=window.URL.createObjectURL(Ke),ut=document.createElement("a");ut.href=pt,ut.download=`${e}_${s.toUpperCase()}_template.xlsx`,document.body.appendChild(ut),ut.click(),window.URL.revokeObjectURL(pt),document.body.removeChild(ut)}catch(ie){alert((ie==null?void 0:ie.message)||"Failed to export Excel")}},rt=async()=>{const ie=N.map((ve,Pe)=>{const Ke=jt.rowsByStudentId[String(ve.id)]||{studentId:ve.id,absent:!1,q:Object.fromEntries(v.map(hr=>[hr.key,""]))},pt=gt(Ke);if(!!(Ke.absent&&!pt))return{sno:Pe+1,regNo:String(ve.reg_no||""),name:String(ve.name||""),total:"ABSENT"};const Lt=Object.fromEntries(v.map(hr=>{var mt;return[hr.key,od(Number(((mt=Ke.q)==null?void 0:mt[hr.key])||0),0,hr.max)]})),Sr=v.reduce((hr,mt)=>hr+Number(Lt[mt.key]||0),0);return{sno:Pe+1,regNo:String(ve.reg_no||""),name:String(ve.name||""),total:Sr}}),I=String((m==null?void 0:m.name)||"").trim(),se=String((m==null?void 0:m.code)||e||"").trim();await ny({filenameBase:`${e}_${o}`,meta:{courseName:I,courseCode:se,className:String((m==null?void 0:m.className)||"")},rows:ie})},Rt=async ie=>{if(!(A||pe||Rr)){Nr(!0);try{const I=await ie.arrayBuffer(),se=v0(I,{type:"array"}),ve=se.Sheets[se.SheetNames[0]],Pe=ds.sheet_to_json(ve,{header:1});if(Pe.length<2)throw new Error("Excel file is empty or has no data rows");const Ke=Pe[0],pt=Ke.findIndex(pr=>String(pr||"").toLowerCase().includes("register")),ut=Ke.findIndex(pr=>String(pr||"").toLowerCase().includes("status"));if(pt===-1)throw new Error('Could not find "Register No" column in Excel file');const Lt=2,Sr=ut!==-1?ut:Ke.length,hr=[];for(let pr=Lt;pr<Sr;pr++){const Dr=String(Ke[pr]||"").trim();if(!Dr)continue;const qr=Dr.match(/^([QqOo]\d+|[A-Za-z]\d*)/);if(!qr)continue;const Ur=qr[1].toUpperCase();if(y==="QP2"&&Ur==="Q10"){hr.push({colIdx:pr,qKey:"q9",mode:"sum"});continue}if(y==="QP2"&&Ur==="Q9"){hr.push({colIdx:pr,qKey:"q9",mode:"set"});continue}const Qr=v.find(on=>on.label.toUpperCase()===Ur||on.key.toUpperCase()===Ur.toUpperCase());Qr&&hr.push({colIdx:pr,qKey:Qr.key,mode:"set"})}if(hr.length===0)throw new Error("No matching question columns found in Excel file");const mt=new Map;N.forEach(pr=>{const Dr=String(pr.reg_no||"").trim().toUpperCase();Dr&&mt.set(Dr,pr)});let _t=0,cr=0;const sr={...jt.rowsByStudentId};for(let pr=1;pr<Pe.length;pr++){const Dr=Pe[pr];if(!Dr||Dr.length===0)continue;const qr=String(Dr[pt]||"").trim().toUpperCase();if(!qr)continue;const Ur=mt.get(qr);if(!Ur){cr++;continue}const Qr=String(Ur.id),on=sr[Qr]||{studentId:Ur.id,absent:!1,absentKind:void 0,reg_no:Ur.reg_no,q:Object.fromEntries(v.map(ta=>[ta.key,""]))},gn={...on.q};let ea=!1;const ma={};for(const{colIdx:ta,qKey:Tn,mode:Me}of hr){const yt=Dr[ta];if(yt==null||yt===""){Me==="set"&&(gn[Tn]="");continue}const fe=Number(yt);if(!Number.isFinite(fe)){Me==="set"&&(gn[Tn]="");continue}if(Me==="sum"){ma[Tn]=(ma[Tn]??0)+fe;continue}const be=v.find(Fe=>Fe.key===Tn),He=(be==null?void 0:be.max)??Ft;gn[Tn]=od(fe,0,He),ea=!0}for(const[ta,Tn]of Object.entries(ma)){const Me=Number(gn[ta]===""?0:gn[ta]||0),yt=v.find(He=>He.key===ta),fe=(yt==null?void 0:yt.max)??Ft,be=od(Me+Tn,0,fe);gn[ta]=be,ea=!0}let ga=on.absent;ut!==-1&&(ga=String(Dr[ut]||"").trim().toLowerCase()==="absent"),sr[Qr]={...on,q:gn,absent:ga},(ea||ga!==on.absent)&&_t++}ur(pr=>({...pr,rowsByStudentId:sr})),alert(`Import successful!
Imported: ${_t} students
Skipped: ${cr} rows (no matching register number)`)}catch(I){alert(`Failed to import Excel: ${(I==null?void 0:I.message)||"Unknown error"}`),console.error("Import error:",I)}finally{Nr(!1),Ir.current&&(Ir.current.value="")}}},Gt=ie=>{var se;const I=(se=ie.target.files)==null?void 0:se[0];I&&Rt(I)},ir=()=>{Ir.current&&Ir.current.click()};if(w)return i.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",o," roster"]});const Bt=N.some(ie=>{var I;return!!((I=jt.rowsByStudentId[String(ie.id)])!=null&&I.absent)}),vr=ae?N.filter(ie=>{var I;return ze&&ze.length?ze.includes(ie.id):!!((I=jt.rowsByStudentId[String(ie.id)])!=null&&I.absent)}):N,Cr={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Tr={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},xr={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11},Xt=32;return i.jsxs(Km,{children:[qe?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>Ie(null),children:i.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:ie=>ie.stopPropagation(),children:[i.jsx("div",{style:{fontWeight:900,marginBottom:6},children:qe.title}),i.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:qe.message}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{className:"obe-btn",onClick:()=>Ie(null),children:"Close"})})]})}):null,P&&i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:P}),d&&i.jsx("div",{style:{background:"#fffbeb",border:"1px solid #f59e0b55",color:"#92400e",padding:10,borderRadius:10,marginBottom:10},children:d}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!Bt,onClick:()=>{if(ae)return;const ie=N.filter(I=>{var se;return!!((se=jt.rowsByStudentId[String(I.id)])!=null&&se.absent)}).map(I=>I.id);ke(ie),he(!0)},title:Bt?"Filter the table to show only absentees":"No absentees marked yet",style:ae?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",ae?i.jsx("span",{onClick:ie=>{ie.stopPropagation(),he(!1),ke(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),i.jsx("button",{onClick:rr,className:"obe-btn obe-btn-secondary",disabled:N.length===0,children:"Export CSV"}),i.jsx("button",{onClick:kt,className:"obe-btn obe-btn-secondary",disabled:N.length===0,children:"Export Excel"}),i.jsx("button",{onClick:ir,className:"obe-btn obe-btn-secondary",disabled:Rr||N.length===0||pe||ct,children:Rr?"Importing":"Import Excel"}),i.jsx("input",{ref:Ir,type:"file",accept:".xlsx,.xls",onChange:Gt,style:{display:"none"}})]}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("button",{onClick:rt,className:"obe-btn obe-btn-secondary",disabled:N.length===0,children:"Download"}),i.jsx("button",{onClick:Jt,className:"obe-btn obe-btn-success",disabled:C||N.length===0||pe||ct,children:C?"Saving":"Save Draft"}),i.jsx("button",{onClick:ht,disabled:A||N.length===0||!Xe||pe||ct,className:"obe-btn obe-btn-primary",children:A?"Publishing":"Publish"}),re&&i.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",re]}),_e&&i.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",_e]})]})]}),i.jsx("div",{style:{marginBottom:10,fontSize:12,color:Xe?"#065f46":"#b91c1c"},children:Qe?"Checking publish due time":Tt||(Ve!=null&&Ve.due_at?i.jsxs(i.Fragment,{children:["Due: ",new Date(Ve.due_at).toLocaleString(),"  Remaining: ",D0(vt),Ve.allowed_by_approval&&Ve.approval_until?i.jsxs(i.Fragment,{children:["  Approved until ",new Date(Ve.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),ct?i.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),i.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:i.jsx("button",{className:"obe-btn",onClick:()=>Be(),disabled:Qe,children:"Refresh"})})]}):Xe?null:i.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),i.jsx("textarea",{value:wt,onChange:ie=>Pt(ie.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),i.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[i.jsx("button",{className:"obe-btn",onClick:()=>Be(),disabled:Wt||Qe,children:"Refresh"}),i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Ct,disabled:Wt,children:Wt?"Requesting":"Request Approval"})]}),Ht?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:Ht}):null]}),i.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[i.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Term",i.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:jt.termLabel})]}),i.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Sheet Label",i.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:jt.batchLabel})]}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Total max: ",Ft," | Questions: ",v.length," | COs: ",l.a,"",l.b," | BTLs: 16"]})]})}),N.length===0?i.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):i.jsxs("div",{style:{position:"relative"},children:[i.jsxs(Gm,{locked:ct,children:[i.jsxs("div",{style:{marginBottom:10},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Mark Manager"}),i.jsxs("div",{style:{border:"1px solid #fcd34d",background:ye?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"},children:[i.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"BTL configuration"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Set BTL per question in the BTL row, then confirm."}),i.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:i.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e||Yr,onClick:()=>_n({mode:ye?"request":"confirm"}),children:ye?"Edit":"Save"})})]}),ge?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:ge}):null]}),i.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:i.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto"},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:Cr,colSpan:4+v.length+1+4+kr.length*2,children:[jt.termLabel," | ",jt.batchLabel," | ",o]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...Cr,width:Xt,minWidth:Xt},rowSpan:3,children:"S.No"}),i.jsx("th",{style:{...Cr,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),i.jsx("th",{style:{...Cr,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),i.jsx("th",{style:{...Cr,minWidth:88},rowSpan:3,children:"AB"}),i.jsx("th",{style:Cr,colSpan:v.length,children:"QUESTIONS"}),i.jsx("th",{style:Cr,rowSpan:3,children:"Total"}),i.jsx("th",{style:Cr,colSpan:4,children:"CO ATTAINMENT"}),kr.length?i.jsx("th",{style:Cr,colSpan:kr.length*2,children:"BTL ATTAINMENT"}):null]}),i.jsxs("tr",{children:[v.map(ie=>i.jsx("th",{style:{...Cr,width:46,minWidth:46},children:ie.label},ie.key)),i.jsxs("th",{style:Cr,colSpan:2,children:["CO-",l.a]}),i.jsxs("th",{style:Cr,colSpan:2,children:["CO-",l.b]}),kr.map(ie=>i.jsxs("th",{style:Cr,colSpan:2,children:["BTL-",ie]},`btl-head-${ie}`))]}),i.jsxs("tr",{children:[v.map(ie=>i.jsx("th",{style:{...Cr,width:46,minWidth:46},children:ie.max},ie.key)),Array.from({length:2+kr.length}).flatMap((ie,I)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:Cr,children:i.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),i.jsx("th",{style:Cr,children:"%"})]},I))]})]}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},colSpan:3}),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:"BTL"}),v.map(ie=>i.jsx("td",{style:{...Tr,textAlign:"center"},children:(()=>{const I=(jt.questionBtl||{})[ie.key]??"",se=I===""?"-":String(I);return i.jsxs("div",{style:{position:"relative",minWidth:44},children:[i.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${se}`,children:se}),i.jsxs("select",{"aria-label":`BTL for ${ie.label}`,value:I,onChange:ve=>fr(ie.key,ve.target.value===""?"":Number(ve.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[i.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(ve=>i.jsx("option",{value:ve,children:ve},ve))]})]})})()},`btl-select-${ie.key}`)),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"}}),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},colSpan:4}),kr.map(ie=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"}}),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"}})]},`btl-pad-${ie}`))]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:"-"}),v.map(ie=>i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:ie.max},ie.key)),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:Ft}),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:Ar.a}),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:"%"}),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:Ar.b}),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:"%"}),kr.map(ie=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:Ut[ie]}),i.jsx("td",{style:{...Tr,fontWeight:700,textAlign:"center"},children:"%"})]},`btl-max-${ie}`))]}),vr.map((ie,I)=>{const se=jt.rowsByStudentId[String(ie.id)]||{studentId:ie.id,reg_no:ie.reg_no??"",absent:!1,absentKind:void 0,q:Object.fromEntries(v.map(_t=>[_t.key,""]))},ve=Object.fromEntries(v.map(_t=>{var cr;return[_t.key,od(Number(((cr=se.q)==null?void 0:cr[_t.key])||0),0,_t.max)]})),Pe=v.reduce((_t,cr)=>_t+Number(ve[cr.key]||0),0);let Ke=0,pt=0;for(let _t=0;_t<v.length;_t++){const cr=v[_t],sr=Ob(v,_t,l),pr=Number(ve[cr.key]||0);Ke+=pr*sr.a,pt+=pr*sr.b}const ut={1:0,2:0,3:0,4:0,5:0,6:0};for(const _t of v){const cr=(jt.questionBtl||{})[_t.key];(cr===1||cr===2||cr===3||cr===4||cr===5||cr===6)&&(ut[cr]+=Number(ve[_t.key]||0))}const Lt=se.absent?{background:"#f1f5f9"}:void 0;se.absent&&String(se.absentKind||"AL").toUpperCase();const Sr=!!(ae&&se.absent),hr=!!(A||pe||ct||De),mt=B[ie.id];return i.jsxs("tr",{style:Lt,children:[i.jsx("td",{style:{...Tr,textAlign:"center",width:Xt,minWidth:Xt,paddingLeft:2,paddingRight:2},children:I+1}),i.jsx("td",{style:{...Tr,minWidth:70,overflow:"visible",textOverflow:"clip"},children:uL(se.reg_no)}),i.jsx("td",{style:{...Tr,minWidth:240,overflow:"visible",textOverflow:"clip"},children:ie.name}),i.jsx("td",{style:{...Tr,textAlign:"center",minWidth:88},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:se.absent,disabled:hr,onChange:_t=>Kr(ie.id,_t.target.checked)}),se.absent?i.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[i.jsx("span",{className:"obe-ios-select-value",children:String(se.absentKind||"AL")}),i.jsxs("select",{"aria-label":"Absent type",value:se.absentKind||"AL",disabled:hr,onChange:_t=>$t(ie.id,_t.target.value),children:[i.jsx("option",{value:"AL",children:"AL"}),i.jsx("option",{value:"ML",children:"ML"}),i.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),v.map(_t=>{var cr,sr,pr;return i.jsx("td",{style:{...Tr,textAlign:"center",width:46,minWidth:46},children:i.jsx("input",{style:{...xr,textAlign:"center"},type:"number",min:0,max:_t.max,disabled:hr||se.absent&&!Sr,value:((cr=se.q)==null?void 0:cr[_t.key])===""||((sr=se.q)==null?void 0:sr[_t.key])==null?"":Number(((pr=se.q)==null?void 0:pr[_t.key])||0),onChange:Dr=>{const qr=Dr.target.value;if(qr==="")return Dr.currentTarget.setCustomValidity(""),Or(ie.id,_t.key,"");const Ur=Number(qr);if(Number.isFinite(Ur)){if(Ur>_t.max){Dr.currentTarget.setCustomValidity(`Max mark is ${_t.max}`),Dr.currentTarget.reportValidity(),window.setTimeout(()=>Dr.currentTarget.setCustomValidity(""),0);return}Dr.currentTarget.setCustomValidity(""),Or(ie.id,_t.key,Ur)}}})},_t.key)}),i.jsx("td",{style:{...Tr,textAlign:"center",fontWeight:700},title:mt!=null?`Server total: ${mt}`:void 0,children:Pe}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:Ke}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:i.jsx("span",{className:"obe-pct-badge",children:ld(Ke,Ar.a)})}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:pt}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:i.jsx("span",{className:"obe-pct-badge",children:ld(pt,Ar.b)})}),kr.map(_t=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Tr,textAlign:"center"},children:ut[_t]}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:i.jsx("span",{className:"obe-pct-badge",children:ld(ut[_t],Ut[_t])})})]},`btl-row-${ie.id}-${_t}`))]},ie.id)})]})]})})]}),pe&&!ct?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"absolute",inset:0,background:Q?"rgba(240,253,244,0.55)":"rgba(239,246,255,0.65)",border:`1px solid ${Q?"rgba(22,163,74,0.25)":"rgba(59,130,246,0.25)"}`,borderRadius:12,pointerEvents:"none"}}),i.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:950,color:"#111827"},children:Q?"Published  Locked":"Table Locked"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:Q?"Marks are published. Use View to inspect or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock student entry."}),Q&&ce?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:ce}):null]}),i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:Q?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"obe-btn",onClick:()=>de(!0),children:"View"}),i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{W(null),J(!0)},disabled:L,children:"Request Edit"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>_n({mode:"confirm"}),disabled:!e||Yr,children:"Save Mark Manager"}),i.jsx("button",{className:"obe-btn",onClick:()=>Ge(),disabled:Yr,children:"Request Access"})]})})]})]}):null]}),zr?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:9999},onClick:()=>{Yr||_n(null)},children:i.jsxs("div",{style:{width:"min(760px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ie=>ie.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:zr.mode==="confirm"?`Confirmation - ${o}`:`Request Edit - ${o}`}),i.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),zr.mode==="confirm"?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f9fafb"},children:[i.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Question"}),i.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max"}),i.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"BTL"})]})}),i.jsx("tbody",{children:v.map(ie=>i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:ie.label}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:ie.max}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:i.jsxs("select",{value:(jt.questionBtl||{})[ie.key]===""?"":String((jt.questionBtl||{})[ie.key]),onChange:I=>{const se=I.target.value===""?"":Number(I.target.value);fr(ie.key,se)},style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e5e7eb",background:"#fff"},disabled:Yr||ct,children:[i.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(I=>i.jsx("option",{value:String(I),children:I},I))]})})]},`mm_${ie.key}`))})]})})]}):i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{className:"obe-btn",disabled:Yr,onClick:()=>_n(null),children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:Yr||!e,onClick:async()=>{if(e){if(zr.mode==="request"){_n(null),await Ge();return}await Vt()}},children:zr.mode==="confirm"?"Confirm":"Send Request"})]})]})}):null,K?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>de(!1),children:i.jsxs("div",{style:{width:"min(1100px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:ie=>ie.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),i.jsx("button",{onClick:ie=>{ie.stopPropagation(),de(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),i.jsxs("div",{style:{padding:14},children:[ne?i.jsx("div",{style:{color:"#6b7280"},children:"Loading published sheet"}):null,Z?i.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:Z}):null]}),F&&(F.rowsByStudentId||F.rows_by_student_id)?i.jsx("div",{ref:z,style:{overflow:"auto",border:"1px solid #e5e7eb",borderRadius:12,maxHeight:"60vh"},children:i.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:Cr,colSpan:6+kr.length*2,children:[jt.termLabel," | ",jt.batchLabel," | ",o," (PUBLISHED)"]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...Cr,width:Xt,minWidth:Xt},children:"S.No"}),i.jsx("th",{style:{...Cr,minWidth:70,overflow:"visible",textOverflow:"clip"},children:"R.No"}),i.jsx("th",{style:{...Cr,minWidth:240,overflow:"visible",textOverflow:"clip"},children:"Name of the Students"}),i.jsx("th",{style:Cr,children:"Total"}),i.jsxs("th",{style:Cr,colSpan:2,children:["CO-",l.a]}),i.jsxs("th",{style:Cr,colSpan:2,children:["CO-",l.b]}),kr.map(ie=>i.jsxs("th",{style:Cr,colSpan:2,children:["BTL-",ie]},`pv_btl_${ie}`))]}),i.jsxs("tr",{children:[i.jsx("th",{style:Cr}),i.jsx("th",{style:Cr}),i.jsx("th",{style:Cr}),i.jsx("th",{style:Cr}),Array.from({length:2+kr.length}).flatMap((ie,I)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:Cr,children:"Mark"}),i.jsx("th",{style:Cr,children:"%"})]},`pv_hdr_${I}`))]})]}),i.jsx("tbody",{children:N.map((ie,I)=>{var hr;const se=F.rowsByStudentId||F.rows_by_student_id||{},ve=se[String(ie.id)]||se[ie.id]||{},Pe=ve.q||{},Ke=Object.fromEntries(v.map(mt=>[mt.key,od(Number((Pe==null?void 0:Pe[mt.key])||0),0,mt.max)])),pt=v.reduce((mt,_t)=>mt+Number(Ke[_t.key]||0),0);let ut=0,Lt=0;for(let mt=0;mt<v.length;mt++){const _t=v[mt],cr=Ob(v,mt,l),sr=Number(Ke[_t.key]||0);ut+=sr*cr.a,Lt+=sr*cr.b}const Sr={1:0,2:0,3:0,4:0,5:0,6:0};for(const mt of v){const _t=(F.questionBtl||F.question_btl||jt.questionBtl||{})[mt.key];if(_t===1||_t===2||_t===3||_t===4||_t===5||_t===6){const cr=_t;Sr[cr]+=Number(Ke[mt.key]||0)}}return i.jsxs("tr",{children:[i.jsx("td",{style:{...Tr,textAlign:"center",width:Xt,minWidth:Xt,paddingLeft:2,paddingRight:2},children:I+1}),i.jsx("td",{style:{...Tr,minWidth:70,overflow:"visible",textOverflow:"clip"},children:uL(ve.reg_no||((hr=jt.rowsByStudentId[String(ie.id)])==null?void 0:hr.reg_no)||"")}),i.jsx("td",{style:{...Tr,minWidth:240,overflow:"visible",textOverflow:"clip"},children:ie.name}),i.jsx("td",{style:{...Tr,textAlign:"center",fontWeight:900},children:pt}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:Math.round(ut)}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:i.jsx("span",{className:"obe-pct-badge",children:ld(ut,Ar.a)})}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:Math.round(Lt)}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:i.jsx("span",{className:"obe-pct-badge",children:ld(Lt,Ar.b)})}),kr.map(mt=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Tr,textAlign:"center"},children:Math.round(Sr[mt])}),i.jsx("td",{style:{...Tr,textAlign:"center"},children:i.jsx("span",{className:"obe-pct-badge",children:ld(Sr[mt],Ut[mt])})})]},`pv_btl_${ie.id}_${mt}`))]},`pv_${ie.id}`)})})]})}):ne?null:i.jsx("div",{style:{color:"#6b7280"},children:"No published sheet found."}),i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"obe-btn",onClick:()=>de(!1),children:"Close"})})]})}):null,X?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>{L||J(!1)},children:i.jsxs("div",{style:{width:"min(560px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ie=>ie.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Edit Request"}),i.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[o,"  ",String(e||"")]})]}),i.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:"This will send an edit request to IQAC for published marks. Once approved, the entry will open for editing until the approval expires."}),i.jsx("textarea",{value:q,onChange:ie=>Y(ie.target.value),placeholder:"Reason (optional)",rows:4,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),i.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[i.jsx("button",{className:"obe-btn",disabled:L,onClick:()=>J(!1),children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:L||!e,onClick:Ye,children:L?"Requesting":"Send Request"})]})]})}):null]})}function uL(e){return e.slice(-8)}function Uge(e){return i.jsx(wz,{...e,assessmentKey:"cia2"})}const zge=5,Wge=20,qge=10;function xn(e,t,r){return Math.max(t,Math.min(r,e))}function ec(e){return Math.round(e*10)/10}function ns(e){if(e===""||e==null)return"";const t=Number(e);return Number.isFinite(t)?t:""}function Mb(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function hi(e,t){if(!t)return"-";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Hge(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const a=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=a.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Vge(e,t){return`${e}_sheet_${t}`}function Gge(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),a=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function dp(e){return e.slice(-8)}function Sz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:n=!1}){var $t,fr,Or;const a=r||"formative1",s=a==="formative2"?"Formative 2":"Formative 1",o=a==="formative2"?3:1,l=a==="formative2"?4:2,[c,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,g]=x.useState(null),[b,y]=x.useState({skill1:3,skill2:4,att1:3,att2:4}),[v,w]=x.useState(!1),[_,C]=x.useState(!1),[j,A]=x.useState(null),[M,P]=x.useState(null),[R,N]=x.useState(!1),T=x.useRef(null),[B,G]=x.useState(!1),{data:re,loading:xe,error:_e,remainingSeconds:V,publishAllowed:K,refresh:de}=dh({assessment:a,subjectCode:String(e||""),teachingAssignmentId:t}),ne=!!(re!=null&&re.global_override_active&&(re==null?void 0:re.global_is_open)===!1),[E,Z]=x.useState(""),[H,F]=x.useState(!1),[ee,z]=x.useState(null),[X,J]=x.useState(null),[q,Y]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e||"",rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),{data:L,refresh:U}=fh({assessment:a,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ce,refresh:W}=Ul({assessment:a,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:ae,refresh:he}=Ul({assessment:a,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[ze,ke]=x.useState(null),qe=!!M||!!(L!=null&&L.exists&&(L!=null&&L.is_published)),Ie=n?!0:!!q.markManagerLocked,Ve=ae!=null&&ae.approval_until?String(ae.approval_until):null,Qe=ce!=null&&ce.approval_until?String(ce.approval_until):null,Tt=!!(ae!=null&&ae.allowed_by_approval)&&!!Ve&&Ve!==((ze==null?void 0:ze.markEntryApprovalUntil)??null),vt=!!(ce!=null&&ce.allowed_by_approval)&&!!Qe&&Qe!==((ze==null?void 0:ze.markManagerApprovalUntil)??null),Xe=qe?!!(L!=null&&L.entry_open)||Tt||vt:!0,Be=!!(qe&&!Xe),ct=!!(qe&&Be),nt=n?!!(ne||qe&&!Xe):!!(ne||(qe?!Xe:!Ie)),Se=n?!0:q.markManagerSnapshot!=null||!!qe,[Te,Dt]=x.useState(null),[wt,Pt]=x.useState(!1),Wt=qe,[Ot,Ht]=x.useState(!1),[Pr,jt]=x.useState(null),[ur,Ir]=x.useState(!1),[Rr,Nr]=x.useState(null),[zr,_n]=x.useState(!1),[Yr,pn]=x.useState(""),[ge,Ne]=x.useState(!1),dt=String((X==null?void 0:X.termLabel)||"KRCT AY25-26"),Ue=(($t=X==null?void 0:X.assessments)==null?void 0:$t[a])??((fr=X==null?void 0:X.assessments)==null?void 0:fr.formative1)??{},Re=Number.isFinite(Number(Ue==null?void 0:Ue.maxPart))?Number(Ue.maxPart):zge,xt=Number.isFinite(Number(Ue==null?void 0:Ue.maxTotal))?Number(Ue.maxTotal):Wge,at=Number.isFinite(Number(Ue==null?void 0:Ue.maxCo))?Number(Ue.maxCo):qge,er=x.useMemo(()=>{const gt=q.markManagerSnapshot;if(!gt)return null;try{const Jt=JSON.parse(String(gt)),ht=Jt==null?void 0:Jt.partBtl;if(!ht||typeof ht!="object")return null;const Ct={};for(const rr of["skill1","skill2","att1","att2"]){const kt=ht[rr];Ct[rr]=kt===""||kt==null?"":Number(kt),Ct[rr]===""||Number.isFinite(Ct[rr])&&Ct[rr]>=1&&Ct[rr]<=6||(Ct[rr]="")}return Ct}catch{return null}},[q.markManagerSnapshot]);x.useEffect(()=>{ke(null)},[e]);const oe=er||b,ue=async gt=>{if(e){gt||(Nr(null),Ir(!0));try{const Jt=await f0(a,e),ht=Jt&&Jt.marks&&typeof Jt.marks=="object"?Jt.marks:null;ht&&Object.keys(ht).length?jt(ht):jt(null)}catch(Jt){gt||Nr((Jt==null?void 0:Jt.message)||"Failed to load published marks")}finally{gt||Ir(!1)}}};x.useEffect(()=>{Ot&&(jt(null),ue(!1))},[Ot,e,a]);const Q=x.useRef(!!Xe);x.useEffect(()=>{if(!e||!qe)return;if(Q.current||!Xe){Q.current=!!Xe;return}let Jt=!0;return(async()=>{try{const ht=await Mn(a,String(e));if(!Jt)return;const Ct=ht==null?void 0:ht.draft,rr=Ct==null?void 0:Ct.sheet,kt=Ct==null?void 0:Ct.partBtl;if(rr&&typeof rr=="object"&&typeof rr.rowsByStudentId=="object"&&Y(rt=>({...rt,termLabel:String(rr.termLabel||dt||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:rr.rowsByStudentId||{},markManagerLocked:typeof rr.markManagerLocked=="boolean"?rr.markManagerLocked:!!(rr.markManagerSnapshot??rt.markManagerSnapshot),markManagerSnapshot:rr.markManagerSnapshot??rt.markManagerSnapshot??null,markManagerApprovalUntil:rr.markManagerApprovalUntil??rt.markManagerApprovalUntil??null})),kt&&typeof kt=="object"){const rt={};for(const Rt of["skill1","skill2","att1","att2"]){const Gt=kt[Rt];rt[Rt]=Gt===""||Gt==null?"":Number(Gt),rt[Rt]===""||Number.isFinite(rt[Rt])&&rt[Rt]>=1&&rt[Rt]<=6||(rt[Rt]="")}y(rt)}}catch{}})(),Q.current=!!Xe,()=>{Jt=!1}},[Xe,qe,e,a,dt]),x.useEffect(()=>{if(!e||!qe||Xe)return;const gt=window.setInterval(()=>{U({silent:!0});try{he==null||he({silent:!0}),W==null||W({silent:!0})}catch{}},3e4);return()=>window.clearInterval(gt)},[Xe,qe,e,U,he,W]);async function ye(){if(!e)return;Ne(!0);const gt=new Date,Jt=ae!=null&&ae.approval_until?String(ae.approval_until):null;try{const ht=await qo({assessment:a,subject_code:String(e),scope:"MARK_ENTRY",reason:Yr||`Edit request: ${s} marks for ${e}`,teaching_assignment_id:t});alert("Edit request sent to IQAC. Waiting for approval..."),_n(!1);const Ct=Number(ht==null?void 0:ht.id),kt=gt.getTime()-2e3;(async()=>{if(!e)return;const rt=36,Rt=5e3;for(let Gt=0;Gt<rt;Gt++){try{const ir=await Jx({assessment:a,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),Bt=ir==null?void 0:ir.result;if(!(Bt&&Number.isFinite(Ct)&&Bt.id!==Ct)){if((Bt==null?void 0:Bt.status)==="APPROVED"&&(Bt!=null&&Bt.is_active)){const vr=Bt.reviewed_at?new Date(Bt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(vr)||vr<kt)){try{he==null||he({silent:!0}),U({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}else if((Bt==null?void 0:Bt.status)==="REJECTED"){const vr=Bt.reviewed_at?new Date(Bt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(vr)||vr<kt)){alert("IQAC rejected the edit request.");return}}}}catch{try{const Bt=await Qx(a,String(e),"MARK_ENTRY",t),vr=Bt!=null&&Bt.approval_until?String(Bt.approval_until):null;if(Bt!=null&&Bt.allowed_by_approval&&vr&&vr!==Jt){try{he==null||he({silent:!0}),U({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(ir=>setTimeout(ir,Rt))}alert("Edit request still pending. Please try again later.")})()}catch(ht){alert((ht==null?void 0:ht.message)||"Request failed")}finally{Ne(!1)}}x.useEffect(()=>{let gt=!0;return(async()=>{try{const Jt=await iu();if(!gt)return;J(Jt||null),Y(ht=>({...ht,termLabel:String((Jt==null?void 0:Jt.termLabel)||ht.termLabel||"KRCT AY25-26"),batchLabel:e||ht.batchLabel}))}catch{}})(),()=>{gt=!1}},[e]);const je=x.useMemo(()=>e?Vge(a,e):"",[a,e]),Ce=x.useMemo(()=>[{key:"skill1",label:"Skill 1",max:Re},{key:"skill2",label:"Skill 2",max:Re},{key:"att1",label:"Attitude 1",max:Re},{key:"att2",label:"Attitude 2",max:Re}],[Re]);(Or=Ce[Ce.length-1])==null||Or.key;const ot=x.useMemo(()=>{const gt=new Set;for(const Jt of Object.keys(b)){const ht=b[Jt];(ht===1||ht===2||ht===3||ht===4||ht===5||ht===6)&&gt.add(ht)}return[1,2,3,4,5,6].filter(Jt=>gt.has(Jt))},[b]),it=x.useMemo(()=>12+ot.length*2,[ot.length]);x.useEffect(()=>{if(e){const gt=`${a}_part_btl_${e}`,Jt=Pn(gt);if(Jt&&typeof Jt=="object")try{const ht={};for(const Ct of Object.keys(b)){const rr=Jt[Ct];ht[Ct]=rr===""||rr==null?"":Number(rr),ht[Ct]===""||Number.isFinite(ht[Ct])&&ht[Ct]>=1&&ht[Ct]<=6||(ht[Ct]="")}y(ht)}catch{}}},[e,a]),x.useEffect(()=>{if(!e)return;const gt=`${a}_part_btl_${e}`;try{Sn(gt,b)}catch{}},[b,e,a]);const We=gt=>JSON.stringify({assessmentKey:a,partBtl:gt,maxPart:Re,maxTotal:xt});async function De(){if(e){Pt(!0);try{const gt=We(b),Jt=ce!=null&&ce.approval_until?String(ce.approval_until):q.markManagerApprovalUntil||null,ht={...q,markManagerLocked:!0,markManagerSnapshot:gt,markManagerApprovalUntil:Jt},Ct={sheet:ht,partBtl:b,markManagerLocked:ht.markManagerLocked,markManagerSnapshot:ht.markManagerSnapshot,markManagerApprovalUntil:ht.markManagerApprovalUntil};Y(ht),Dt(null),await li(a,String(e),Ct),A(new Date().toLocaleString());try{await Zf(a,String(e),t),U({silent:!0})}catch{}}catch{}finally{Pt(!1)}}}async function pe(){if(!e)return;Pt(!0);const gt=new Date,Jt=ce!=null&&ce.approval_until?String(ce.approval_until):null;try{const ht=await qo({assessment:a,subject_code:String(e),scope:"MARK_MANAGER",reason:`Request mark-manager edit for ${e}`,teaching_assignment_id:t});alert("Edit request sent to IQAC. Waiting for approval...");const Ct=Number(ht==null?void 0:ht.id),kt=gt.getTime()-2e3;(async()=>{if(!e)return;const rt=36,Rt=5e3;for(let Gt=0;Gt<rt;Gt++){try{const ir=await Jx({assessment:a,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),Bt=ir==null?void 0:ir.result;if(!(Bt&&Number.isFinite(Ct)&&Bt.id!==Ct)){if((Bt==null?void 0:Bt.status)==="APPROVED"&&(Bt!=null&&Bt.is_active)){const vr=Bt.reviewed_at?new Date(Bt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(vr)||vr<kt)){try{W==null||W({silent:!0}),U({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}else if((Bt==null?void 0:Bt.status)==="REJECTED"){const vr=Bt.reviewed_at?new Date(Bt.reviewed_at).getTime():NaN;if(!(!Number.isFinite(vr)||vr<kt)){alert("IQAC rejected the mark-manager edit request.");return}}}}catch{try{const Bt=await Qx(a,String(e),"MARK_MANAGER",t),vr=Bt!=null&&Bt.approval_until?String(Bt.approval_until):null;if(Bt!=null&&Bt.allowed_by_approval&&vr&&vr!==Jt){try{W==null||W({silent:!0}),U({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(ir=>setTimeout(ir,Rt))}alert("Edit request still pending. Please try again later.")})()}catch(ht){alert((ht==null?void 0:ht.message)||"Request failed")}finally{Pt(!1)}}x.useEffect(()=>{if(!e)return;let gt=!1;const Jt=setTimeout(async()=>{try{await li(a,e,{sheet:q,partBtl:b});try{je&&Sn(je,{termLabel:q.termLabel,batchLabel:q.batchLabel,rowsByStudentId:q.rowsByStudentId})}catch{}gt||A(new Date().toLocaleString())}catch{}},700);return()=>{gt=!0,clearTimeout(Jt)}},[b,e,a,q,je]),x.useEffect(()=>{let gt=!0;return(async()=>{if(e)try{const Jt=await Mn(a,e);if(!gt)return;const ht=Jt==null?void 0:Jt.draft,Ct=ht==null?void 0:ht.sheet,rr=ht==null?void 0:ht.partBtl,kt=ht==null?void 0:ht.selectedBtls;if(Ct&&typeof Ct=="object"&&typeof Ct.rowsByStudentId=="object"){Y({termLabel:String(Ct.termLabel||dt||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:Ct.rowsByStudentId||{},markManagerLocked:typeof Ct.markManagerLocked=="boolean"?Ct.markManagerLocked:!!Ct.markManagerSnapshot,markManagerSnapshot:Ct.markManagerSnapshot??null,markManagerApprovalUntil:Ct.markManagerApprovalUntil??null});try{je&&Sn(je,{termLabel:String(Ct.termLabel||dt||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:Ct.rowsByStudentId||{}})}catch{}}if(rr&&typeof rr=="object"){const rt={};for(const Rt of Object.keys(b)){const Gt=rr[Rt];rt[Rt]=Gt===""||Gt==null?"":Number(Gt),rt[Rt]===""||Number.isFinite(rt[Rt])&&rt[Rt]>=1&&rt[Rt]<=6||(rt[Rt]="")}y(rt);try{const Rt=`${a}_part_btl_${e}`;Sn(Rt,rt)}catch{}}else if(Array.isArray(kt)){const rt=Gt=>Number.isFinite(Gt)&&Gt>=1&&Gt<=6,Rt=kt.map(Gt=>Number(Gt)).filter(rt);if(Rt.length===1){const Gt={skill1:Rt[0],skill2:Rt[0],att1:Rt[0],att2:Rt[0]};y(Gt);try{const ir=`${a}_part_btl_${e}`;Sn(ir,Gt)}catch{}}else if(Rt.length>=2){const Gt={skill1:Rt[0],skill2:Rt[1],att1:Rt[0],att2:Rt[1]};y(Gt);try{const ir=`${a}_part_btl_${e}`;Sn(ir,Gt)}catch{}}}}catch{}})(),()=>{gt=!1}},[e,dt,a,je]),x.useEffect(()=>{let gt=!0;return(async()=>{if(e){u(!0),f(null);try{let ht=[],Ct=null;try{const Gt=await jc();console.log("[Formative] My TAs:",Gt==null?void 0:Gt.length,"for subject:",e,"teachingAssignmentId:",t),Ct=(Gt||[]).find(ir=>{const Bt=String(ir.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?ir.id===t:!1)||Bt}),Ct?console.log("[Formative] Found TA match:",Ct.id,"elective_subject_id:",Ct.elective_subject_id,"section_id:",Ct.section_id):console.log("[Formative] No TA match found in user TAs")}catch(Gt){console.warn("[Formative] My TAs fetch failed:",Gt)}if(Ct&&Ct.elective_subject_id&&!Ct.section_id){console.log("[Formative] Detected elective, fetching elective-choices for elective_subject_id:",Ct.elective_subject_id);try{const Gt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Ct.elective_subject_id))}`);if(Gt.ok){const ir=await Gt.json(),Bt=Array.isArray(ir.results)?ir.results:Array.isArray(ir)?ir:ir.items||[];console.log("[Formative] Elective choices returned:",Bt==null?void 0:Bt.length,"students"),ht=(Bt||[]).map(vr=>({id:Number(vr.student_id??vr.id),reg_no:String(vr.reg_no??vr.regno??""),name:String(vr.name??vr.full_name??vr.username??""),section:vr.section_name??vr.section??null})).filter(vr=>Number.isFinite(vr.id)),gt&&g({subject_name:Ct.subject_name,section:Ct.section_name||"Elective"})}else console.warn("[Formative] Elective-choices API returned error:",Gt.status)}catch(Gt){console.warn("[Formative] Elective-choices fetch failed:",Gt)}}if(!ht.length&&Ct&&Ct.id){console.log("[Formative] Fetching regular TA roster for TA ID:",Ct.id);try{ht=((await Ac(Ct.id)).students||[]).map(ir=>({id:Number(ir.id),reg_no:String(ir.reg_no??""),name:String(ir.name??""),section:ir.section??null})).filter(ir=>Number.isFinite(ir.id)),console.log("[Formative] Regular roster returned:",ht.length,"students"),gt&&g({subject_name:Ct.subject_name,section:Ct.section_name})}catch(Gt){console.warn("[Formative] TA roster fetch failed:",Gt)}}console.log("[Formative] Final roster count:",ht.length),ht.sort(Hge),gt&&h(ht);let rr=null;try{const Gt=await f0(a,e);Gt&&Gt.marks&&typeof Gt.marks=="object"&&Object.keys(Gt.marks||{}).length&&(rr=Gt.marks,P(new Date().toLocaleString()))}catch{}const kt=je?Pn(je):null,rt=rr?{termLabel:X!=null&&X.termLabel?String(X.termLabel):dt||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:Object.fromEntries(Object.entries(rr).map(([Gt,ir])=>[Gt,{studentId:Number(Gt),skill1:ns(ir==null?void 0:ir.skill1),skill2:ns(ir==null?void 0:ir.skill2),att1:ns(ir==null?void 0:ir.att1),att2:ns(ir==null?void 0:ir.att2)}]))}:kt&&typeof kt=="object"?{termLabel:X!=null&&X.termLabel?String(X.termLabel):String(kt.termLabel||"KRCT AY25-26"),batchLabel:String(e||kt.batchLabel||""),rowsByStudentId:kt.rowsByStudentId&&typeof kt.rowsByStudentId=="object"?kt.rowsByStudentId:{}}:{termLabel:dt||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:{}},Rt={...rt.rowsByStudentId};for(const Gt of ht){const ir=String(Gt.id),Bt=Rt[ir];Rt[ir]={studentId:Gt.id,skill1:typeof(Bt==null?void 0:Bt.skill1)=="number"?xn(Number(Bt==null?void 0:Bt.skill1),0,Re):"",skill2:typeof(Bt==null?void 0:Bt.skill2)=="number"?xn(Number(Bt==null?void 0:Bt.skill2),0,Re):"",att1:typeof(Bt==null?void 0:Bt.att1)=="number"?xn(Number(Bt==null?void 0:Bt.att1),0,Re):"",att2:typeof(Bt==null?void 0:Bt.att2)=="number"?xn(Number(Bt==null?void 0:Bt.att2),0,Re):""}}Y({...rt,termLabel:rt.termLabel||dt,batchLabel:String(e||rt.batchLabel||""),rowsByStudentId:Rt})}catch(ht){if(!gt)return;f((ht==null?void 0:ht.message)||`Failed to load ${s} roster`),h([])}finally{gt&&u(!1)}}})(),()=>{gt=!1}},[e,je,X,dt,Re,s]);const Je=(gt,Jt)=>{nt||Be||Y(ht=>{const Ct=String(gt),kt={...ht.rowsByStudentId[Ct]||{studentId:gt,skill1:"",skill2:"",att1:"",att2:""},...Jt,studentId:gt},rt=Rt=>{if(Rt===""||Rt==null)return"";const Gt=Number(Rt),ir=Number.isFinite(Gt)?Math.round(Gt):NaN,Bt=xn(ir,0,Re);return Number.isFinite(Bt)?Bt:""};return{...ht,rowsByStudentId:{...ht.rowsByStudentId,[Ct]:{...kt,skill1:rt(kt.skill1),skill2:rt(kt.skill2),att1:rt(kt.att1),att2:rt(kt.att2)}}}})},Ge=async()=>{if(e){w(!0),f(null);try{await li(a,e,{sheet:q,partBtl:b}),A(new Date().toLocaleString())}catch(gt){f((gt==null?void 0:gt.message)||`Failed to save ${s} draft`)}finally{w(!1)}}},Ye=async()=>{if(!e)return;if(ne){f("Publishing is locked by IQAC.");return}if(!K){f("Publish window is closed. Please request IQAC approval.");return}if(qe&&Be){_n(!0);return}C(!0),f(null);const gt=M,Jt=q.markManagerLocked,ht=ze,Ct={markEntryApprovalUntil:Ve,markManagerApprovalUntil:Qe};try{P(new Date().toLocaleString()),ke(Ct),Y(rr=>({...rr,markManagerLocked:!0})),await u9(a,e,q,t),de(),U({silent:!0}),ue(!0);try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:a}}))}catch{}}catch(rr){const kt=String((rr==null?void 0:rr.message)||"");kt.includes("locked after publish")||kt.includes("Marks entry is locked")?(P(new Date().toLocaleString()),ke(Ct),Y(rt=>({...rt,markManagerLocked:!0})),f(null)):(P(gt??null),Y(rt=>({...rt,markManagerLocked:Jt})),ke(ht??null),f(kt||`Failed to publish ${s}`))}finally{try{if(e){const rr=await oS(a,String(e),t);rr!=null&&rr.exists&&(rr!=null&&rr.is_published)&&(P(new Date().toLocaleString()),Y(kt=>({...kt,markManagerLocked:!0})),ke(kt=>kt??Ct),ue(!0),U({silent:!0}),de(),f(null))}}catch{}C(!1)}},ft=()=>{if(!e)return;const gt=p.map((Jt,ht)=>{const Ct=q.rowsByStudentId[String(Jt.id)]||{studentId:Jt.id,skill1:"",skill2:"",att1:"",att2:""},rr=typeof Ct.skill1=="number"?xn(Number(Ct.skill1),0,Re):null,kt=typeof Ct.skill2=="number"?xn(Number(Ct.skill2),0,Re):null,rt=typeof Ct.att1=="number"?xn(Number(Ct.att1),0,Re):null,Rt=typeof Ct.att2=="number"?xn(Number(Ct.att2),0,Re):null,Gt=rr!=null&&kt!=null&&rt!=null&&Rt!=null?xn(rr+kt+rt+Rt,0,xt):"",ir=rr!=null&&rt!=null?xn(rr+rt,0,at):"",Bt=kt!=null&&Rt!=null?xn(kt+Rt,0,at):"",vr=[0,0,0,0,0,0];for(const Xt of Ce){const ie=b[Xt.key];(ie===1||ie===2||ie===3||ie===4||ie===5||ie===6)&&(vr[ie-1]+=Xt.max)}const Cr=ot.map(Xt=>Xt-1),Tr=typeof Gt=="number"&&Cr.length?ec(Gt/Cr.length):"",xr=vr.map((Xt,ie)=>Tr===""||!Cr.includes(ie)?"":Xt>0?xn(Tr,0,Xt):ec(Tr));return{sno:ht+1,registerNo:Jt.reg_no,name:Jt.name,skill1:rr??"",skill2:kt??"",att1:rt??"",att2:Rt??"",total:Gt===""?"":Gt,[`co${o}_mark`]:ir===""?"":ir,[`co${o}_pct`]:ir===""?"":hi(ir,at),[`co${l}_mark`]:Bt===""?"":Bt,[`co${l}_pct`]:Bt===""?"":hi(Bt,at),btl1_mark:xr[0]??"",btl1_pct:xr[0]===""?"":hi(Number(xr[0]),vr[0]),btl2_mark:xr[1]??"",btl2_pct:xr[1]===""?"":hi(Number(xr[1]),vr[1]),btl3_mark:xr[2]??"",btl3_pct:xr[2]===""?"":hi(Number(xr[2]),vr[2]),btl4_mark:xr[3]??"",btl4_pct:xr[3]===""?"":hi(Number(xr[3]),vr[3]),btl5_mark:xr[4]??"",btl5_pct:xr[4]===""?"":hi(Number(xr[4]),vr[4]),btl6_mark:xr[5]??"",btl6_pct:xr[5]===""?"":hi(Number(xr[5]),vr[5])}});Gge(`${e}_${a.toUpperCase()}_sheet.csv`,gt)},bt=async()=>{if(!e)return;const gt=p.map((Jt,ht)=>{const Ct=q.rowsByStudentId[String(Jt.id)]||{studentId:Jt.id,skill1:"",skill2:"",att1:"",att2:""},rr=typeof Ct.skill1=="number"?xn(Number(Ct.skill1),0,Re):null,kt=typeof Ct.skill2=="number"?xn(Number(Ct.skill2),0,Re):null,rt=typeof Ct.att1=="number"?xn(Number(Ct.att1),0,Re):null,Rt=typeof Ct.att2=="number"?xn(Number(Ct.att2),0,Re):null,Gt=rr!=null&&kt!=null&&rt!=null&&Rt!=null?xn(rr+kt+rt+Rt,0,xt):"";return{sno:ht+1,regNo:String(Jt.reg_no||""),name:String(Jt.name||""),total:Gt===""?"":Gt}});await ny({filenameBase:`${e}_${s}`,meta:{courseName:String((m==null?void 0:m.subject_name)||""),courseCode:String(e||""),className:String((m==null?void 0:m.section)||"")},rows:gt})};function Vt(gt){return String(gt??"").trim().toLowerCase().replace(/\s+/g," ")}const Ft=()=>{if(!e||!p.length)return;const gt=kt=>`${kt} (${Number(Re).toFixed(2)})`,Jt=["Register No","Student Name",gt("Skill 1"),gt("Skill 2"),gt("Attitude 1"),gt("Attitude 2"),"Status"],ht=p.map(kt=>{const rt=q.rowsByStudentId[String(kt.id)];return[kt.reg_no,kt.name,(rt==null?void 0:rt.skill1)??"",(rt==null?void 0:rt.skill2)??"",(rt==null?void 0:rt.att1)??"",(rt==null?void 0:rt.att2)??"","present"]}),Ct=ds.aoa_to_sheet([Jt,...ht]);Ct["!freeze"]={xSplit:0,ySplit:1};const rr=ds.book_new();ds.book_append_sheet(rr,Ct,s),ty(rr,`${e}_${a.toUpperCase()}_template.xlsx`)},gr=()=>{var gt;nt||Be||(gt=T.current)==null||gt.click()},Ar=async gt=>{var Jt;if(e&&!(nt||Be)){G(!0);try{const ht=await gt.arrayBuffer(),Ct=v0(ht,{type:"array"}),rr=(Jt=Ct.SheetNames)==null?void 0:Jt[0];if(!rr)throw new Error("No sheet found in the Excel file.");const kt=Ct.Sheets[rr],rt=ds.sheet_to_json(kt,{header:1});if(!rt.length)throw new Error("Excel sheet is empty.");const Rt=(rt[0]||[]).map(Vt),Gt=I=>Rt.findIndex(se=>I(se)),ir=Gt(I=>I==="register no"||I==="reg no"||I.includes("register")),Bt=Gt(I=>I.startsWith("skill 1")||I.startsWith("skill1")),vr=Gt(I=>I.startsWith("skill 2")||I.startsWith("skill2")),Cr=Gt(I=>I.startsWith("attitude 1")||I.startsWith("att1")||I.startsWith("attitude1")),Tr=Gt(I=>I.startsWith("attitude 2")||I.startsWith("att2")||I.startsWith("attitude2")),xr=Gt(I=>I==="status"||I.includes("status"));if(ir<0)throw new Error("Could not find Register No column.");const Xt=new Map;for(const I of p){const se=String(I.reg_no||"").trim();se&&Xt.set(se,I.id);const ve=dp(se);ve&&Xt.set(ve,I.id)}const ie=I=>I==null||!Number.isFinite(I)||I<=0?"":xn(Number(I),1,Re);Y(I=>{const se={...I.rowsByStudentId};for(let ve=1;ve<rt.length;ve++){const Pe=rt[ve]||[],Ke=String(Pe[ir]??"").trim();if(!Ke)continue;const pt=Xt.get(Ke);if(!pt)continue;const Lt=(xr>=0?String(Pe[xr]??""):"").trim().toLowerCase(),Sr=Lt==="absent"||Lt==="ab"||Lt==="a",hr=se[String(pt)]||{studentId:pt,skill1:"",skill2:"",att1:"",att2:""};if(Sr){se[String(pt)]={...hr,skill1:"",skill2:"",att1:"",att2:""};continue}const mt=Bt>=0?ie(Mb(Pe[Bt])):hr.skill1,_t=vr>=0?ie(Mb(Pe[vr])):hr.skill2,cr=Cr>=0?ie(Mb(Pe[Cr])):hr.att1,sr=Tr>=0?ie(Mb(Pe[Tr])):hr.att2;se[String(pt)]={...hr,studentId:pt,skill1:mt,skill2:_t,att1:cr,att2:sr}}return{...I,rowsByStudentId:se}})}finally{G(!1)}}},kr=async gt=>{var ht;const Jt=(ht=gt.target.files)==null?void 0:ht[0];if(gt.target.value="",!!Jt)try{await Ar(Jt)}catch(Ct){f((Ct==null?void 0:Ct.message)||"Failed to import Excel")}};if(!e)return i.jsxs("div",{style:{color:"#6b7280"},children:["Select a course to start ",s," entry."]});if(c)return i.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",s," roster"]});const At={border:"1px solid #111",padding:"6px 6px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:12,whiteSpace:"nowrap"},Ut={border:"1px solid #111",padding:"6px 6px",fontSize:12,whiteSpace:"nowrap"},Kr={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:12,textAlign:"center"};return i.jsxs(Km,{children:[d&&i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:d}),i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("button",{onClick:ft,className:"obe-btn obe-btn-secondary",disabled:p.length===0,children:"Export CSV"}),i.jsx("button",{onClick:Ft,className:"obe-btn obe-btn-secondary",disabled:p.length===0,children:"Export Excel"}),i.jsx("button",{onClick:gr,className:"obe-btn obe-btn-secondary",disabled:p.length===0||nt||Be||B,children:B?"Importing":"Import Excel"}),i.jsx("input",{ref:T,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:kr})]}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("button",{onClick:bt,className:"obe-btn obe-btn-secondary",disabled:p.length===0,children:"Download"}),i.jsx("button",{onClick:Ge,className:"obe-btn obe-btn-success",disabled:v||p.length===0,children:v?"Saving":"Save Draft"}),i.jsx("button",{onClick:Ye,disabled:_||p.length===0||!K,className:"obe-btn obe-btn-primary",children:_?"Publishing":"Publish"}),j&&i.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Draft: ",j]}),M&&i.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",M]})]})]}),i.jsx("div",{style:{marginBottom:10,fontSize:12,color:K?"#065f46":"#b91c1c"},children:xe?"Checking publish due time":_e||(re!=null&&re.due_at?i.jsxs(i.Fragment,{children:["Due: ",new Date(re.due_at).toLocaleString(),"  Remaining: ",D0(V),re.allowed_by_approval&&re.approval_until?i.jsxs(i.Fragment,{children:["  Approved until ",new Date(re.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),ne?i.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),i.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:i.jsx("button",{className:"obe-btn",onClick:()=>de(),disabled:xe,children:"Refresh"})})]}):null,i.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[i.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Term",i.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:q.termLabel})]}),i.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Sheet Label",i.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:q.batchLabel})]}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Skill/Attitude max: ",Re," each | Total: ",xt," | CO-",o,": ",at," | CO-",l,": ",at]})]})}),p.length===0?i.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):i.jsx(Gm,{locked:ne,children:Se?R&&qe?i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),i.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),i.jsx("button",{className:"obe-btn",onClick:()=>N(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),ur?i.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,Rr?i.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:Rr}):null,Pr&&Object.keys(Pr).length||p.length?i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:i.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:At,colSpan:it,children:[q.termLabel," | ",q.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...At,width:42,minWidth:42},children:"S.No"}),i.jsx("th",{style:At,children:"Register No."}),i.jsx("th",{style:At,children:"Name of the Students"}),i.jsx("th",{style:At,children:"Skill 1"}),i.jsx("th",{style:At,children:"Skill 2"}),i.jsx("th",{style:At,children:"Att 1"}),i.jsx("th",{style:At,children:"Att 2"}),i.jsx("th",{style:At,children:"Total"}),i.jsxs("th",{style:At,colSpan:2,children:["CO-",o]}),i.jsxs("th",{style:At,colSpan:2,children:["CO-",l]}),ot.map(gt=>i.jsxs("th",{style:At,colSpan:2,children:["BTL-",gt]},`pv_btl_${gt}`))]}),i.jsxs("tr",{children:[i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At,children:"Mark"}),i.jsx("th",{style:At,children:"%"}),i.jsx("th",{style:At,children:"Mark"}),i.jsx("th",{style:At,children:"%"}),ot.map(gt=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:At,children:"Mark"}),i.jsx("th",{style:At,children:"%"})]},`pv_btl_sub_${gt}`))]})]}),i.jsx("tbody",{children:p.length?p.map((gt,Jt)=>{const ht=Pr&&Pr[String(gt.id)]||{},Ct=typeof ht.skill1=="number"?xn(Number(ht.skill1),1,Re):ns(ht.skill1),rr=typeof ht.skill2=="number"?xn(Number(ht.skill2),1,Re):ns(ht.skill2),kt=typeof ht.att1=="number"?xn(Number(ht.att1),1,Re):ns(ht.att1),rt=typeof ht.att2=="number"?xn(Number(ht.att2),1,Re):ns(ht.att2),Rt=Ct!==""&&rr!==""&&kt!==""&&rt!==""?xn(Ct+rr+kt+rt,0,xt):"",Gt=Ct!==""&&kt!==""?xn(Ct+kt,0,at):"",ir=rr!==""&&rt!==""?xn(rr+rt,0,at):"",Bt=[0,0,0,0,0,0];for(const xr of Ce){const Xt=oe[xr.key];(Xt===1||Xt===2||Xt===3||Xt===4||Xt===5||Xt===6)&&(Bt[Xt-1]+=xr.max)}const vr=ot.map(xr=>xr-1),Cr=typeof Rt=="number"&&vr.length?ec(Rt/vr.length):"",Tr=Bt.map((xr,Xt)=>Cr===""||!vr.includes(Xt)?"":xr>0?xn(Cr,0,xr):ec(Cr));return i.jsxs("tr",{children:[i.jsx("td",{style:{...Ut,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Jt+1}),i.jsx("td",{style:Ut,children:dp(gt.reg_no)}),i.jsx("td",{style:Ut,children:gt.name||""}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Ct}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:rr}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:kt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:rt}),i.jsx("td",{style:{...Ut,textAlign:"center",fontWeight:700},children:Rt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Gt,at)})}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(ir,at)})}),ot.map(xr=>{const Xt=xr-1,ie=Tr[Xt],I=Bt[Xt]??0;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Ut,textAlign:"center"},children:ie}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ie===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Number(ie),I)})})]},`pv_btl_cells_${gt.id}_${xr}`)})]},`pv_${gt.id}`)}):Object.keys(Pr||{}).map((gt,Jt)=>{const ht=Pr[gt]||{},Ct=typeof ht.skill1=="number"?xn(Number(ht.skill1),1,Re):ns(ht.skill1),rr=typeof ht.skill2=="number"?xn(Number(ht.skill2),1,Re):ns(ht.skill2),kt=typeof ht.att1=="number"?xn(Number(ht.att1),1,Re):ns(ht.att1),rt=typeof ht.att2=="number"?xn(Number(ht.att2),1,Re):ns(ht.att2),Rt=Ct!==""&&rr!==""&&kt!==""&&rt!==""?xn(Ct+rr+kt+rt,0,xt):"",Gt=Ct!==""&&kt!==""?xn(Ct+kt,0,at):"",ir=rr!==""&&rt!==""?xn(rr+rt,0,at):"",Bt=[0,0,0,0,0,0];for(const xr of Ce){const Xt=oe[xr.key];(Xt===1||Xt===2||Xt===3||Xt===4||Xt===5||Xt===6)&&(Bt[Xt-1]+=xr.max)}const vr=ot.map(xr=>xr-1),Cr=typeof Rt=="number"&&vr.length?ec(Rt/vr.length):"",Tr=Bt.map((xr,Xt)=>Cr===""||!vr.includes(Xt)?"":xr>0?xn(Cr,0,xr):ec(Cr));return i.jsxs("tr",{children:[i.jsx("td",{style:{...Ut,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Jt+1}),i.jsx("td",{style:Ut,children:dp(String(ht.reg_no??gt))}),i.jsx("td",{style:Ut,children:ht.name||""}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Ct}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:rr}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:kt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:rt}),i.jsx("td",{style:{...Ut,textAlign:"center",fontWeight:700},children:Rt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Gt,at)})}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(ir,at)})}),ot.map(xr=>{const Xt=xr-1,ie=Tr[Xt],I=Bt[Xt]??0;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Ut,textAlign:"center"},children:ie}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ie===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Number(ie),I)})})]},`pv_btl_cells_${gt}_${xr}`)})]},`pv_${gt}`)})})]})}):ur?null:i.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"obe-btn",onClick:()=>N(!1),children:"Close"})})]}):i.jsxs("div",{className:"obe-table-wrapper",style:{position:"relative"},children:[i.jsxs("table",{className:"obe-table",style:{minWidth:1200,pointerEvents:ct?"none":"auto"},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:At,colSpan:it,children:[q.termLabel," | ",q.batchLabel," | ",s.toUpperCase()]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...At,width:42,minWidth:42},rowSpan:3,children:"S.No"}),i.jsx("th",{style:At,rowSpan:3,children:"Register No."}),i.jsx("th",{style:At,rowSpan:3,children:"Name of the Students"}),i.jsx("th",{style:At,colSpan:2,children:"Skill"}),i.jsx("th",{style:At,colSpan:2,children:"Attitude"}),i.jsx("th",{style:At,rowSpan:3,children:"Total"}),i.jsx("th",{style:At,colSpan:4,children:"CIA 1"}),ot.length?i.jsx("th",{style:At,colSpan:ot.length*2,children:"BTL"}):null]}),i.jsxs("tr",{children:[i.jsx("th",{style:At,children:"1"}),i.jsx("th",{style:At,children:"2"}),i.jsx("th",{style:At,children:"1"}),i.jsx("th",{style:At,children:"2"}),i.jsxs("th",{style:At,colSpan:2,children:["CO-",o]}),i.jsxs("th",{style:At,colSpan:2,children:["CO-",l]}),ot.map(gt=>i.jsxs("th",{style:At,colSpan:2,children:["BTL-",gt]},`btlhead-${gt}`))]}),i.jsxs("tr",{children:[i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At,children:"Mark"}),i.jsx("th",{style:At,children:"%"}),i.jsx("th",{style:At,children:"Mark"}),i.jsx("th",{style:At,children:"%"}),ot.map(gt=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:At,children:"Mark"}),i.jsx("th",{style:At,children:"%"})]},`btl-sub-${gt}`))]})]}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"}}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"}}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:"BTL"}),Ce.map(gt=>i.jsx("td",{style:{...Ut,textAlign:"center"},children:(()=>{const Jt=b[gt.key]??"",ht=Jt===""?"-":String(Jt);return i.jsxs("div",{style:{position:"relative",minWidth:44},children:[i.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${ht}`,children:ht}),i.jsxs("select",{"aria-label":`BTL for ${gt.label}`,value:Jt,onChange:Ct=>{if(ne)return;const rr=q.markManagerSnapshot!=null;Ie&&rr||Be||y(kt=>({...kt||{},[gt.key]:Ct.target.value===""?"":Number(Ct.target.value)}))},style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[i.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Ct=>i.jsx("option",{value:Ct,children:Ct},Ct))]})]})})()},`btl-select-${gt.key}`)),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"}}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},colSpan:4}),ot.map(gt=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"}}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"}})]},`btl-pad-${gt}`))]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:Re}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:Re}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:Re}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:Re}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:xt}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:at}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:"%"}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:at}),i.jsx("td",{style:{...Ut,fontWeight:700,textAlign:"center"},children:"%"})]}),p.map((gt,Jt)=>{const ht=q.rowsByStudentId[String(gt.id)]||{studentId:gt.id,skill1:"",skill2:"",att1:"",att2:""},Ct=typeof ht.skill1=="number"?xn(Number(ht.skill1),0,Re):"",rr=typeof ht.skill2=="number"?xn(Number(ht.skill2),0,Re):"",kt=typeof ht.att1=="number"?xn(Number(ht.att1),0,Re):"",rt=typeof ht.att2=="number"?xn(Number(ht.att2),0,Re):"",Rt=Ct!==""&&rr!==""&&kt!==""&&rt!==""?xn(Ct+rr+kt+rt,0,xt):"",Gt=Ct!==""&&kt!==""?xn(Ct+kt,0,at):"",ir=rr!==""&&rt!==""?xn(rr+rt,0,at):"",Bt=[0,0,0,0,0,0];for(const ie of Ce){const I=b[ie.key];(I===1||I===2||I===3||I===4||I===5||I===6)&&(Bt[I-1]+=ie.max)}const vr=ot.map(ie=>ie-1),Cr=typeof Rt=="number"&&vr.length?ec(Rt/vr.length):"",Tr=Bt.map((ie,I)=>Cr===""||!vr.includes(I)?"":ie>0?xn(Cr,0,ie):ec(Cr)),Xt=ot.length===0||nt||Be||ne;return i.jsxs("tr",{children:[i.jsx("td",{style:{...Ut,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Jt+1}),i.jsx("td",{style:Ut,children:dp(gt.reg_no)}),i.jsx("td",{style:Ut,children:gt.name||""}),i.jsx("td",{style:Ut,children:i.jsx("input",{style:Kr,type:"number",min:0,max:Re,value:ht.skill1===""?"":ht.skill1,disabled:Xt,onChange:ie=>{const I=ie.target.value;if(I==="")return ie.currentTarget.setCustomValidity(""),Je(gt.id,{skill1:""});const se=Number(I);if(Number.isFinite(se)){if(se>Re){ie.currentTarget.setCustomValidity(`Max mark is ${Re}`),ie.currentTarget.reportValidity(),window.setTimeout(()=>ie.currentTarget.setCustomValidity(""),0);return}ie.currentTarget.setCustomValidity(""),Je(gt.id,{skill1:se})}}})}),i.jsx("td",{style:Ut,children:i.jsx("input",{style:Kr,type:"number",min:0,max:Re,value:ht.skill2===""?"":ht.skill2,disabled:Xt,onChange:ie=>{const I=ie.target.value;if(I==="")return ie.currentTarget.setCustomValidity(""),Je(gt.id,{skill2:""});const se=Number(I);if(Number.isFinite(se)){if(se>Re){ie.currentTarget.setCustomValidity(`Max mark is ${Re}`),ie.currentTarget.reportValidity(),window.setTimeout(()=>ie.currentTarget.setCustomValidity(""),0);return}ie.currentTarget.setCustomValidity(""),Je(gt.id,{skill2:se})}}})}),i.jsx("td",{style:Ut,children:i.jsx("input",{style:Kr,type:"number",min:0,max:Re,value:ht.att1===""?"":ht.att1,disabled:Xt,onChange:ie=>{const I=ie.target.value;if(I==="")return ie.currentTarget.setCustomValidity(""),Je(gt.id,{att1:""});const se=Number(I);if(Number.isFinite(se)){if(se>Re){ie.currentTarget.setCustomValidity(`Max mark is ${Re}`),ie.currentTarget.reportValidity(),window.setTimeout(()=>ie.currentTarget.setCustomValidity(""),0);return}ie.currentTarget.setCustomValidity(""),Je(gt.id,{att1:se})}}})}),i.jsx("td",{style:Ut,children:i.jsx("input",{style:Kr,type:"number",min:0,max:Re,value:ht.att2===""?"":ht.att2,disabled:Xt,onChange:ie=>{const I=ie.target.value;if(I==="")return ie.currentTarget.setCustomValidity(""),Je(gt.id,{att2:""});const se=Number(I);if(Number.isFinite(se)){if(se>Re){ie.currentTarget.setCustomValidity(`Max mark is ${Re}`),ie.currentTarget.reportValidity(),window.setTimeout(()=>ie.currentTarget.setCustomValidity(""),0);return}ie.currentTarget.setCustomValidity(""),Je(gt.id,{att2:se})}}})}),i.jsx("td",{style:{...Ut,textAlign:"center",fontWeight:700},children:Rt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Gt,at)})}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(ir,at)})}),ot.map(ie=>{const I=ie-1,se=Tr[I],ve=Bt[I]??0;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Ut,textAlign:"center"},children:se}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:se===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Number(se),ve)})})]},`btl-cells-${ie}`)})]},gt.id)})]})]}),ot.length===0&&i.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(255,255,255,0.85)",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:10,padding:20,borderRadius:6},children:[i.jsx("div",{style:{fontSize:16,fontWeight:700},children:"BTL values not selected"}),i.jsx("div",{style:{color:"#6b7280"},children:"Assign BTL values in the BTL row below Skill/Attitude to enable entry."}),i.jsx("div",{style:{display:"flex",gap:8},children:i.jsx("button",{onClick:()=>{if(ne)return;const gt=q.markManagerSnapshot!=null;Ie&&gt||Be||y({skill1:3,skill2:4,att1:3,att2:4})},style:{padding:"6px 10px"},children:"Quick: BTL-3/4"})})]}),nt&&!ne&&!ct?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(239,246,255,0.65)",border:"1px solid rgba(59,130,246,0.25)",borderRadius:6,pointerEvents:"none"}}),i.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:280,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Table Locked"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:"Confirm the Mark Manager to unlock the student list."})]}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Dt({mode:"confirm"}),disabled:!e||wt,children:"Save Mark Manager"}),i.jsx("button",{className:"obe-btn",onClick:()=>pe(),disabled:wt,children:"Request Access"})]})]})]}):null,ct&&!ne?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.26) 100%)",border:"1px solid rgba(22,163,74,0.25)",borderRadius:6,pointerEvents:"none"}}),i.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),i.jsx("div",{style:{fontSize:12,color:"#065f46",marginTop:4},children:"Marks are published. Use View or Request Edit to ask IQAC for access."})]}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[i.jsx("button",{className:"obe-btn",onClick:()=>{N(!0),jt(null);try{ue(!1)}catch{}},children:"View"}),i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>ye(),children:"Request Edit"})]})]})]}):null]}):i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:[i.jsx("div",{style:{fontWeight:900,fontSize:16},children:Wt?"Published  Locked":"Table Locked"}),i.jsx("div",{style:{color:"#6b7280",marginTop:8},children:Wt?"Marks published. Use View or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock the student list."}),i.jsx("div",{style:{display:"flex",gap:8,marginTop:12,justifyContent:"flex-end"},children:Wt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"obe-btn",onClick:()=>{N(!0),jt(null);try{ue(!1)}catch{}},children:"View"}),i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>ye(),children:"Request Edit"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Dt({mode:"confirm"}),disabled:!e||wt,children:"Save Mark Manager"}),i.jsx("button",{className:"obe-btn",onClick:()=>pe(),disabled:wt,children:"Request Access"})]})})]})}),Te&&!n?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:9999},onClick:()=>{wt||Dt(null)},children:i.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:gt=>gt.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Te.mode==="confirm"?`Confirmation - ${s}`:`Request Edit - ${s}`}),i.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),Te.mode==="confirm"?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f9fafb"},children:[i.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),i.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Skill/Attitude max"}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:Re})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Total max"}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:xt})]}),i.jsxs("tr",{children:[i.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",o," max"]}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:at})]}),i.jsxs("tr",{children:[i.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",l," max"]}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:at})]}),Ce.map(gt=>i.jsxs("tr",{children:[i.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:[gt.label," BTL"]}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:i.jsxs("select",{className:"obe-input","aria-label":`BTL for ${gt.label}`,value:b[gt.key]??"",disabled:wt||ne||Be,onChange:Jt=>{if(ne||Be)return;const ht=Jt.target.value;y(Ct=>({...Ct||{},[gt.key]:ht===""?"":Number(ht)}))},style:{minWidth:110},children:[i.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Jt=>i.jsx("option",{value:Jt,children:Jt},Jt))]})})]},`mm_${gt.key}`))]})]})})]}):i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{className:"obe-btn",disabled:wt,onClick:()=>Dt(null),children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:wt||!e,onClick:async()=>{if(e){if(Te.mode==="request"){Dt(null),await pe();return}await De()}},children:Te.mode==="confirm"?"Confirm":"Send Request"})]})]})}):null,Ot?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:60,overflowY:"auto"},onClick:()=>Ht(!1),children:i.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"90vh",overflowY:"auto",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:gt=>gt.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),i.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ht(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),ur?i.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,Rr?i.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:Rr}):null,Pr&&Object.keys(Pr).length||p.length?i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:i.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:At,colSpan:it,children:[q.termLabel," | ",q.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...At,width:42,minWidth:42},children:"S.No"}),i.jsx("th",{style:At,children:"Register No."}),i.jsx("th",{style:At,children:"Name of the Students"}),i.jsx("th",{style:At,children:"Skill 1"}),i.jsx("th",{style:At,children:"Skill 2"}),i.jsx("th",{style:At,children:"Att 1"}),i.jsx("th",{style:At,children:"Att 2"}),i.jsx("th",{style:At,children:"Total"}),i.jsxs("th",{style:At,colSpan:2,children:["CO-",o]}),i.jsxs("th",{style:At,colSpan:2,children:["CO-",l]}),ot.map(gt=>i.jsxs("th",{style:At,colSpan:2,children:["BTL-",gt]},`pv_btl_${gt}`))]}),i.jsxs("tr",{children:[i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At}),i.jsx("th",{style:At,children:"Mark"}),i.jsx("th",{style:At,children:"%"}),i.jsx("th",{style:At,children:"Mark"}),i.jsx("th",{style:At,children:"%"}),ot.map(gt=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:At,children:"Mark"}),i.jsx("th",{style:At,children:"%"})]},`pv_btl_sub_${gt}`))]})]}),i.jsx("tbody",{children:p.length?p.map((gt,Jt)=>{const ht=Pr&&Pr[String(gt.id)]||{},Ct=typeof ht.skill1=="number"?xn(Number(ht.skill1),1,Re):ns(ht.skill1),rr=typeof ht.skill2=="number"?xn(Number(ht.skill2),1,Re):ns(ht.skill2),kt=typeof ht.att1=="number"?xn(Number(ht.att1),1,Re):ns(ht.att1),rt=typeof ht.att2=="number"?xn(Number(ht.att2),1,Re):ns(ht.att2),Rt=Ct!==""&&rr!==""&&kt!==""&&rt!==""?xn(Ct+rr+kt+rt,0,xt):"",Gt=Ct!==""&&kt!==""?xn(Ct+kt,0,at):"",ir=rr!==""&&rt!==""?xn(rr+rt,0,at):"",Bt=[0,0,0,0,0,0];for(const xr of Ce){const Xt=oe[xr.key];(Xt===1||Xt===2||Xt===3||Xt===4||Xt===5||Xt===6)&&(Bt[Xt-1]+=xr.max)}const vr=ot.map(xr=>xr-1),Cr=typeof Rt=="number"&&vr.length?ec(Rt/vr.length):"",Tr=Bt.map((xr,Xt)=>Cr===""||!vr.includes(Xt)?"":xr>0?xn(Cr,0,xr):ec(Cr));return i.jsxs("tr",{children:[i.jsx("td",{style:{...Ut,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Jt+1}),i.jsx("td",{style:Ut,children:dp(gt.reg_no)}),i.jsx("td",{style:Ut,children:gt.name||""}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Ct}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:rr}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:kt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:rt}),i.jsx("td",{style:{...Ut,textAlign:"center",fontWeight:700},children:Rt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Gt,at)})}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(ir,at)})}),ot.map(xr=>{const Xt=xr-1,ie=Tr[Xt],I=Bt[Xt]??0;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Ut,textAlign:"center"},children:ie}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ie===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Number(ie),I)})})]},`pv_btl_cells_${gt.id}_${xr}`)})]},`pv_${gt.id}`)}):Object.keys(Pr||{}).map((gt,Jt)=>{const ht=Pr[gt]||{},Ct=typeof ht.skill1=="number"?xn(Number(ht.skill1),1,Re):ns(ht.skill1),rr=typeof ht.skill2=="number"?xn(Number(ht.skill2),1,Re):ns(ht.skill2),kt=typeof ht.att1=="number"?xn(Number(ht.att1),1,Re):ns(ht.att1),rt=typeof ht.att2=="number"?xn(Number(ht.att2),1,Re):ns(ht.att2),Rt=Ct!==""&&rr!==""&&kt!==""&&rt!==""?xn(Ct+rr+kt+rt,0,xt):"",Gt=Ct!==""&&kt!==""?xn(Ct+kt,0,at):"",ir=rr!==""&&rt!==""?xn(rr+rt,0,at):"",Bt=[0,0,0,0,0,0];for(const xr of Ce){const Xt=oe[xr.key];(Xt===1||Xt===2||Xt===3||Xt===4||Xt===5||Xt===6)&&(Bt[Xt-1]+=xr.max)}const vr=ot.map(xr=>xr-1),Cr=typeof Rt=="number"&&vr.length?ec(Rt/vr.length):"",Tr=Bt.map((xr,Xt)=>Cr===""||!vr.includes(Xt)?"":xr>0?xn(Cr,0,xr):ec(Cr));return i.jsxs("tr",{children:[i.jsx("td",{style:{...Ut,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Jt+1}),i.jsx("td",{style:Ut,children:dp(String(ht.reg_no??gt))}),i.jsx("td",{style:Ut,children:ht.name||""}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Ct}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:rr}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:kt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:rt}),i.jsx("td",{style:{...Ut,textAlign:"center",fontWeight:700},children:Rt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:Gt===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Gt,at)})}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ir===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(ir,at)})}),ot.map(xr=>{const Xt=xr-1,ie=Tr[Xt],I=Bt[Xt]??0;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Ut,textAlign:"center"},children:ie}),i.jsx("td",{style:{...Ut,textAlign:"center"},children:ie===""?"":i.jsx("span",{className:"obe-pct-badge",children:hi(Number(ie),I)})})]},`pv_btl_cells_${gt}_${xr}`)})]},`pv_${gt}`)})})]})}):ur?null:i.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ht(!1),children:"Close"})})]})}):null,zr?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>{ge||_n(!1)},children:i.jsxs("div",{style:{width:"min(560px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:gt=>gt.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Edit Request"}),i.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[s,"  ",String(e||"")]})]}),i.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:"This will send an edit request to IQAC for published marks. Once approved, the entry will open for editing until the approval expires."}),i.jsx("textarea",{value:Yr,onChange:gt=>pn(gt.target.value),placeholder:"Reason (optional)",rows:4,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),i.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[i.jsx("button",{className:"obe-btn",disabled:ge,onClick:()=>_n(!1),children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:ge||!e,onClick:ye,children:ge?"Requesting":"Send Request"})]})]})}):null,je&&i.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",i.jsx("span",{style:{fontFamily:"monospace"},children:je})]})]})}function Kge(e){return i.jsx(Sz,{...e,assessmentKey:"formative2"})}const Xge=new URL("https://static.vecteezy.com/system/resources/thumbnails/014/585/778/small/gold-locked-padlock-png.png",import.meta.url).href,Ni=5,Ro=25,Fb={1:9,2:9,3:4.5},Rb={1:3,2:3,3:1.5},bu={1:20,2:20,3:10},Bb={1:12,2:12,3:6};function Yge(e,t){const r=String(e??"").trim(),n=String(t??"").trim(),a=r.replace(/[^0-9]/g,""),s=n.replace(/[^0-9]/g,"");if(a&&s)try{const o=BigInt(a),l=BigInt(s);if(o<l)return-1;if(o>l)return 1}catch{if(a.length!==s.length)return a.length-s.length;if(a<s)return-1;if(a>s)return 1}else{if(a&&!s)return-1;if(!a&&s)return 1}return r<n?-1:r>n?1:0}function Qge(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const a=r.localeCompare(n);if(a)return a}else if(r||n)return r?-1:1;return Yge(e==null?void 0:e.reg_no,t==null?void 0:t.reg_no)}function _a(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function Jge(e,t){return`${e}_sheet_${t}`}function tc(e,t){const r=Array.isArray(e)?e:[],n=[];for(let a=0;a<t;a++){const s=r[a];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function Es(e,t){const r=Array.isArray(e)?e:[],n=[];for(let a=0;a<t;a++){const s=r[a],o=typeof s=="number"?s:Number(s);o===1||o===2||o===3||o===4||o===5||o===6?n.push(o):n.push(1)}return n}function Ib(e){return e.reduce((t,r)=>t+(typeof r=="number"&&Number.isFinite(r)?r:0),0)}function dL(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Fg(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const a=t[n];if(a===""||a==null){r[n]="";continue}const s=typeof a=="number"?a:Number(a);r[n]=Number.isFinite(s)?s:""}return r}function fp(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function fL({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:a,coB:s,showCia1Embed:o,cia1Embed:l}){const[c,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,g]=x.useState(null),[b,y]=x.useState(!1),[v,w]=x.useState(null),[_,C]=x.useState(null),[j,A]=x.useState(!1),[M,P]=x.useState(null),[R,N]=x.useState(!1),[T,B]=x.useState(!1),[G,re]=x.useState(null),[xe,_e]=x.useState(!1),[V,K]=x.useState(null),[de,ne]=x.useState(null),[E,Z]=x.useState(!1),[H,F]=x.useState(null),[ee,z]=x.useState(!1),[X,J]=x.useState({sheet:{termLabel:"KRCT AY25-26",batchLabel:e||"",coAEnabled:!0,coBEnabled:!0,ciaExamEnabled:!0,expCountA:Ni,expCountB:Ni,btlsA:Array.from({length:Ni},()=>1),btlsB:Array.from({length:Ni},()=>1),rowsByStudentId:{},expMaxA:Ro,expMaxB:Ro,markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}}),q=x.useMemo(()=>e?Jge(r,e):"",[r,e]),{data:Y,publishAllowed:L,remainingSeconds:U,refresh:ce}=dh({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t}),{data:W,refresh:ae}=fh({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:he}=Ul({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),ze=!!M||!!(W!=null&&W.exists&&(W!=null&&W.is_published)),ke=W!=null&&W.exists?!!(W!=null&&W.entry_open):!0,qe=!!(ze&&!ke),Ie=!!(Y!=null&&Y.global_override_active&&(Y==null?void 0:Y.global_is_open)===!1);x.useEffect(()=>{let pe=!0;return(async()=>{try{const Je=await iu();if(!pe)return;g(Je||null),J(Ge=>({...Ge,sheet:{...Ge.sheet,termLabel:String((Je==null?void 0:Je.termLabel)||Ge.sheet.termLabel||"KRCT AY25-26"),batchLabel:e||Ge.sheet.batchLabel}}))}catch{}})(),()=>{pe=!1}},[e]),x.useEffect(()=>{let pe=!0;return(async()=>{if(e)try{const Je=await Mn(r,e);if(!pe)return;const Ge=Je==null?void 0:Je.draft;if(Ge&&typeof Ge=="object"&&Ge.sheet&&typeof Ge.sheet=="object"){const Ye=!!(Ge.sheet.coAEnabled??!0),ft=!!(Ge.sheet.coBEnabled??!0),bt=!!(Ge.sheet.ciaExamEnabled??!0),Vt=_a(Number(Ge.sheet.expCountA??Ni),0,12),Ft=_a(Number(Ge.sheet.expCountB??Ni),0,12),gr=Es(Ge.sheet.btlsA,Vt),Ar=Es(Ge.sheet.btlsB,Ft),kr={},At=Ge.sheet.rowsByStudentId&&typeof Ge.sheet.rowsByStudentId=="object"?Ge.sheet.rowsByStudentId:{};for(const[Jt,ht]of Object.entries(At)){const Ct=ht&&typeof ht=="object"?ht:{},rr=tc(Ct.marksA,Vt),kt=tc(Ct.marksB,Ft),rt=Ct.ciaExam,Rt=rt===""||rt==null?"":Number(rt),Gt=Rt===""?"":Number.isFinite(Rt)?Rt:"";kr[String(Jt)]={...Ct,studentId:Number.isFinite(Number(Ct.studentId))?Number(Ct.studentId):Number(Jt),marksA:rr,marksB:kt,ciaExam:Gt,caaExamByCo:Fg(Ct.caaExamByCo)}}const Ut=Ge.sheet.markManagerSnapshot??null,Kr=Ge.sheet.markManagerApprovalUntil??null,$t=Ge.sheet.markManagerLocked,fr=typeof $t=="boolean"?$t:!!Ut;J({sheet:{termLabel:String(Ge.sheet.termLabel||(m==null?void 0:m.termLabel)||"KRCT AY25-26"),batchLabel:String(e),coAEnabled:Ye,coBEnabled:ft,ciaExamEnabled:bt,expCountA:Vt,expCountB:Ft,btlsA:gr,btlsB:Ar,rowsByStudentId:kr,markManagerLocked:fr,markManagerSnapshot:Ut,markManagerApprovalUntil:Kr}});try{q&&Sn(q,{rowsByStudentId:Ge.sheet.rowsByStudentId||{}})}catch{}const Or=(Je==null?void 0:Je.updated_at)??null,gt=(Je==null?void 0:Je.updated_by)??null;if(Or)try{w(new Date(String(Or)).toLocaleString())}catch{w(String(Or))}gt&&C(String(gt.name||gt.username||gt.id||""))}else{const Ye=q?Pn(q):null,ft=Ye!=null&&Ye.rowsByStudentId&&typeof Ye.rowsByStudentId=="object"?Ye.rowsByStudentId:{};J(bt=>({...bt,sheet:{...bt.sheet,batchLabel:String(e),rowsByStudentId:ft}}))}}catch{}})(),()=>{pe=!1}},[r,e,q,m]),x.useEffect(()=>{let pe=!0;return(async()=>{if(!t){h([]);return}u(!0),f(null);try{const Je=await Ac(t);if(!pe)return;const Ye=[...(Je==null?void 0:Je.students)||[]].sort((ft,bt)=>Qge(ft,bt));h(Ye)}catch(Je){if(!pe)return;h([]),f((Je==null?void 0:Je.message)||"Failed to load roster")}finally{pe&&u(!1)}})(),()=>{pe=!1}},[t]),x.useEffect(()=>{e&&p.length!==0&&J(pe=>{const Je=_a(Number(pe.sheet.expCountA??Ni),0,12),Ge=_a(Number(pe.sheet.expCountB??Ni),0,12),Ye=Es(pe.sheet.btlsA,Je),ft=Es(pe.sheet.btlsB,Ge),bt={...pe.sheet.rowsByStudentId||{}};for(const Vt of p){const Ft=String(Vt.id),gr=bt[Ft];if(!gr)bt[Ft]={studentId:Vt.id,marksA:Array.from({length:Je},()=>""),marksB:Array.from({length:Ge},()=>""),caaExamByCo:{},ciaExam:""};else{const Ar=tc(gr.marksA,Je),kr=tc(gr.marksB,Ge),At=gr.ciaExam,Ut=At===""||At==null?"":Number(At),Kr=Ut===""?"":Number.isFinite(Ut)?Ut:"",$t=Fg(gr.caaExamByCo);bt[Ft]={...gr,marksA:Ar,marksB:kr,ciaExam:Kr,caaExamByCo:$t}}}return{...pe,sheet:{...pe.sheet,batchLabel:String(e),expCountA:Je,expCountB:Ge,btlsA:Ye,btlsB:ft,rowsByStudentId:bt}}})},[p,e]),x.useEffect(()=>{if(q)try{Sn(q,{rowsByStudentId:X.sheet.rowsByStudentId})}catch{}},[X.sheet.rowsByStudentId,q]),x.useEffect(()=>{if(!e)return;if(W!=null&&W.exists){const Ge=!!(W!=null&&W.mark_manager_locked);!!X.sheet.markManagerLocked!==Ge&&J(Ye=>({...Ye,sheet:{...Ye.sheet,markManagerLocked:Ge}}));return}const pe=!!(he!=null&&he.allowed_by_approval),Je=he!=null&&he.approval_until?String(he.approval_until):null;if(pe&&Je){(X.sheet.markManagerApprovalUntil?String(X.sheet.markManagerApprovalUntil):null)!==Je&&J(Ye=>({...Ye,sheet:{...Ye.sheet,markManagerLocked:!1,markManagerApprovalUntil:Je}}));return}},[e,W==null?void 0:W.exists,W==null?void 0:W.mark_manager_locked,he==null?void 0:he.allowed_by_approval,he==null?void 0:he.approval_until,X.sheet.markManagerLocked,X.sheet.markManagerApprovalUntil]),x.useEffect(()=>{if(!e)return;let pe=!1;const Je=setTimeout(async()=>{try{await li(r,e,X),pe||w(new Date().toLocaleString())}catch{}},900);return()=>{pe=!0,clearTimeout(Je)}},[r,e,X]);const Ve=_a(Number(X.sheet.expCountA??Ni),0,12),Qe=_a(Number(X.sheet.expCountB??Ni),0,12),Tt=!!X.sheet.coAEnabled,vt=!!X.sheet.coBEnabled,Xe=Tt?Ve:0,Be=vt?Qe:0,ct=Xe+Be,nt=x.useMemo(()=>{const pe=[];return Tt&&pe.push(a),vt&&pe.push(s),pe},[Tt,vt,a,s]),Se=X.sheet.ciaExamEnabled!==!1,Te=x.useMemo(()=>nt.filter(pe=>Number.isFinite(Number(bu[pe]))),[nt]),Dt=Se?Math.max(Te.length,1):0,wt=x.useMemo(()=>{if(ct===0)return[];const pe=Es(X.sheet.btlsA,Ve).slice(0,Xe),Je=Es(X.sheet.btlsB,Qe).slice(0,Be),Ge=new Set;for(const Ye of pe)Ge.add(Ye);for(const Ye of Je)Ge.add(Ye);return[1,2,3,4,5,6].filter(Ye=>Ge.has(Ye))},[X.sheet,Ve,Qe,ct,Xe,Be]),Pt=!!X.sheet.markManagerLocked,Wt=Pt,Ot=!!(Ie||W!=null&&W.exists&&!(W!=null&&W.entry_open));function Ht(pe,Je){J(Ge=>Ge.sheet.markManagerLocked?Ge:{...Ge,sheet:{...Ge.sheet,coAEnabled:pe==="A"?Je:Ge.sheet.coAEnabled,coBEnabled:pe==="B"?Je:Ge.sheet.coBEnabled}})}function Pr(pe,Je){const Ge=_a(Number(Je),0,100);J(Ye=>Ye.sheet.markManagerLocked?Ye:{...Ye,sheet:{...Ye.sheet,expMaxA:pe==="A"?Ge:Ye.sheet.expMaxA,expMaxB:pe==="B"?Ge:Ye.sheet.expMaxB}})}function jt(pe,Je){const Ge=_a(Je,0,12);J(Ye=>{if(Ye.sheet.markManagerLocked)return Ye;const ft={...Ye.sheet.rowsByStudentId||{}};for(const Ar of Object.keys(ft)){const kr=ft[Ar];if(pe==="A"){const At=tc(kr==null?void 0:kr.marksA,Ge);ft[Ar]={...kr,marksA:At}}else{const At=tc(kr==null?void 0:kr.marksB,Ge);ft[Ar]={...kr,marksB:At}}}const bt=pe==="A"?Ge:_a(Number(Ye.sheet.expCountA??Ni),0,12),Vt=pe==="B"?Ge:_a(Number(Ye.sheet.expCountB??Ni),0,12),Ft=Es(Ye.sheet.btlsA,bt),gr=Es(Ye.sheet.btlsB,Vt);return{...Ye,sheet:{...Ye.sheet,expCountA:pe==="A"?Ge:Ye.sheet.expCountA,expCountB:pe==="B"?Ge:Ye.sheet.expCountB,btlsA:Ft,btlsB:gr,rowsByStudentId:ft}}})}function ur(pe,Je,Ge){J(Ye=>{if(qe||Ie)return Ye;const ft=_a(Number(Ye.sheet.expCountA??Ni),0,12),bt=_a(Number(Ye.sheet.expCountB??Ni),0,12),Vt=Es(Ye.sheet.btlsA,ft),Ft=Es(Ye.sheet.btlsB,bt);return pe==="A"?Vt[Je]=Ge:Ft[Je]=Ge,{...Ye,sheet:{...Ye.sheet,btlsA:Vt,btlsB:Ft}}})}function Ir(pe){J(Je=>Je.sheet.markManagerLocked?Je:{...Je,sheet:{...Je.sheet,ciaExamEnabled:!!pe}})}function Rr(pe){const Je=_a(Number(pe.expCountA??Ni),0,12),Ge=_a(Number(pe.expCountB??Ni),0,12),Ye=Es(pe.btlsA,Je).slice(0,Je),ft=Es(pe.btlsB,Ge).slice(0,Ge);return JSON.stringify({coAEnabled:!!pe.coAEnabled,coBEnabled:!!pe.coBEnabled,ciaExamEnabled:!!(pe.ciaExamEnabled??!0),expCountA:Je,expMaxA:_a(Number(pe.expMaxA??Ro),0,100),expCountB:Ge,expMaxB:_a(Number(pe.expMaxB??Ro),0,100),btlsA:Ye,btlsB:ft})}async function Nr(){if(e){Z(!0),F(null);try{await qo({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t}),alert("Edit request sent to IQAC.")}catch(pe){F((pe==null?void 0:pe.message)||"Request failed"),alert((pe==null?void 0:pe.message)||"Request failed")}finally{Z(!1)}}}function zr(pe,Je,Ge,Ye){J(ft=>{var fr;const bt=String(pe),Vt=_a(Number(ft.sheet.expCountA??Ni),0,12),Ft=_a(Number(ft.sheet.expCountB??Ni),0,12),gr=_a(Number(ft.sheet.expMaxA??Ro),0,100),Ar=_a(Number(ft.sheet.expMaxB??Ro),0,100),kr=(fr=ft.sheet.rowsByStudentId)==null?void 0:fr[bt],At=kr?tc(kr.marksA,Vt):Array.from({length:Vt},()=>""),Ut=kr?tc(kr.marksB,Ft):Array.from({length:Ft},()=>""),Kr=[...At],$t=[...Ut];if(Je==="A")if(Ye===""||Ye==null)Kr[Ge]="";else{const Or=Number(Ye);Kr[Ge]=Number.isFinite(Or)?Math.max(0,Math.min(gr,Math.trunc(Or))):""}else if(Ye===""||Ye==null)$t[Ge]="";else{const Or=Number(Ye);$t[Ge]=Number.isFinite(Or)?Math.max(0,Math.min(Ar,Math.trunc(Or))):""}return{...ft,sheet:{...ft.sheet,rowsByStudentId:{...ft.sheet.rowsByStudentId,[bt]:{...kr||{studentId:pe},marksA:Kr,marksB:$t,ciaExam:kr&&(typeof kr.ciaExam=="number"||kr.ciaExam==="")?kr.ciaExam:""}}}}})}function _n(pe,Je,Ge){J(Ye=>{var kr;const ft=String(pe),bt=(kr=Ye.sheet.rowsByStudentId)==null?void 0:kr[ft];if(!bt)return Ye;const Vt=String(_a(Number(Je),1,5)),Ft=Number(bu[Number(Vt)]||0),gr=Ge===""?"":_a(Number(Ge),0,Ft>0?Ft:0),Ar={...Fg(bt.caaExamByCo),[Vt]:gr};return{...Ye,sheet:{...Ye.sheet,rowsByStudentId:{...Ye.sheet.rowsByStudentId,[ft]:{...bt,caaExamByCo:Ar}}}}})}async function Yr(){if(e){y(!0);try{await li(r,e,X),w(new Date().toLocaleString()),alert("Draft saved.")}catch(pe){alert((pe==null?void 0:pe.message)||"Draft save failed")}finally{y(!1)}}}async function pn(){if(!e||!window.confirm("Reset all lab marks for this sheet? This clears the draft (students + experiments + CIA Exam)."))return;const Je=_a(Number(X.sheet.expCountA??Ni),0,12),Ge=_a(Number(X.sheet.expCountB??Ni),0,12),Ye={};for(const bt of p)Ye[String(bt.id)]={studentId:bt.id,marksA:Array.from({length:Je},()=>""),marksB:Array.from({length:Ge},()=>""),caaExamByCo:{},ciaExam:""};const ft={sheet:{...X.sheet,rowsByStudentId:Ye}};J(ft);try{q&&Sn(q,{rowsByStudentId:{}})}catch{}try{await li(r,e,ft),w(new Date().toLocaleString())}catch{}}async function ge(){if(e){if(Ie){alert("Publishing is locked by IQAC.");return}if(!L){alert("Publish window is closed. Please request IQAC approval.");return}if(!M){A(!0);try{await oN(r,e,X,t),P(new Date().toLocaleString()),await Ne(!1),ce(),ae({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(pe){alert((pe==null?void 0:pe.message)||"Publish failed")}finally{A(!1)}}}}async function Ne(pe){if(e){pe&&_e(!0),K(null);try{const Je=await no(r,String(e),t),Ge=(Je==null?void 0:Je.data)??null;Ge&&typeof Ge=="object"&&re(Ge)}catch(Je){pe&&K((Je==null?void 0:Je.message)||"Failed to load published marks")}finally{pe&&_e(!1)}}}x.useEffect(()=>{e&&Ne(!1)},[e,r]);const dt=Zr.useRef(!!ke);x.useEffect(()=>{if(!e||!ze)return;if(dt.current||!ke){dt.current=!!ke;return}let Je=!0;return(async()=>{try{const Ge=await Mn(r,String(e),t),Ye=(Ge==null?void 0:Ge.data)??null;if(!Je)return;if(Ye&&typeof Ye=="object"&&Ye.sheet){J(Ye);return}}catch{}Je&&G&&G.sheet&&J(G)})(),dt.current=!!ke,()=>{Je=!1}},[ke,ze,e,r,G]),x.useEffect(()=>{if(!e||!ze||ke)return;const pe=window.setInterval(()=>{ae({silent:!0})},3e4);return()=>window.clearInterval(pe)},[ke,ze,e,ae]),x.useEffect(()=>{T&&e&&(re(null),Ne(!0))},[T,e,r]);const Ue=3+ct+1+Dt+4+wt.length*2,Re=_a(Number(X.sheet.expMaxA??Ro),0,100),xt=_a(Number(X.sheet.expMaxB??Ro),0,100),at=Number(Bb[a]||0),er=Number(Bb[s]||0),oe=Math.max(Re,xt,Ro),ue={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Q={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},ye={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},je={position:"relative",border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},Ce="100%",ot={display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},it={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},We=ee?"markManagerGlitch 2s ease-in-out":void 0,De={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"};return i.jsxs(Km,{children:[i.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),i.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),i.jsxs("div",{style:{...ot,border:"1px solid #fcd34d",background:Pt?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:We,position:"relative",overflow:"hidden"},children:[ee?i.jsx(i.Fragment,{children:Array.from({length:20},(pe,Je)=>i.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},Je))}):null,i.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(y2,{size:20,color:Pt?"#6b7280":"#9a3412"}),i.jsx("div",{style:{fontWeight:950,color:"#111827",fontSize:14},children:"Mark Manager"}),Pt&&i.jsx("span",{style:{fontSize:11,color:"#fff",background:"#dc2626",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"LOCKED"}),!Pt&&i.jsx("span",{style:{fontSize:11,color:"#fff",background:"#16a34a",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"EDITABLE"})]}),i.jsx("button",{onClick:()=>ne({mode:Pt?"request":"confirm"}),className:"obe-btn obe-btn-success",disabled:!e||E,style:{minWidth:100},children:E?"Saving...":Pt?"Request Edit":"Save & Lock"})]}),i.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[i.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[i.jsx("input",{type:"checkbox",checked:Tt,disabled:Pt,onChange:pe=>Ht("A",pe.target.checked),style:it}),"CO-",a]}),i.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[i.jsx("input",{type:"checkbox",checked:vt,disabled:Pt,onChange:pe=>Ht("B",pe.target.checked),style:it}),"CO-",s]}),i.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[i.jsx("input",{type:"checkbox",checked:Se,disabled:Pt,onChange:pe=>Ir(pe.target.checked),style:it}),"CAA Exam"]})]}),i.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[Tt?i.jsxs("div",{style:{width:200},children:[i.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of experiments (CO-",a,")"]}),i.jsx("input",{type:"number",className:"obe-input",value:Ve,onChange:pe=>jt("A",Number(pe.target.value)),min:0,max:12,disabled:Pt}),i.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:6},children:"Max marks (per experiment)"}),i.jsx("input",{type:"number",className:"obe-input",value:X.sheet.expMaxA??Ro,onChange:pe=>Pr("A",Number(pe.target.value)),min:0,max:100,disabled:Pt})]}):null,vt?i.jsxs("div",{style:{width:200},children:[i.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of experiments (CO-",s,")"]}),i.jsx("input",{type:"number",className:"obe-input",value:Qe,onChange:pe=>jt("B",Number(pe.target.value)),min:0,max:12,disabled:Pt}),i.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:6},children:"Max marks (per experiment)"}),i.jsx("input",{type:"number",className:"obe-input",value:X.sheet.expMaxB??Ro,onChange:pe=>Pr("B",Number(pe.target.value)),min:0,max:100,disabled:Pt})]}):null]})]}),H?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:H}):null]}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center",marginBottom:12},children:[i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[i.jsx("button",{onClick:Yr,className:"obe-btn obe-btn-success",disabled:b||!e||!Wt||Ot,style:!Wt||Ot?{opacity:.6,cursor:"not-allowed"}:void 0,title:Wt?Ot?"Table locked after publish":"Save current draft":"Save & Lock Mark Manager first to enable table",children:b?"Saving":"Save Draft"}),i.jsx("button",{onClick:pn,className:"obe-btn obe-btn-danger",disabled:!e||!Wt||Ot,style:!Wt||Ot?{opacity:.6,cursor:"not-allowed"}:void 0,title:Wt?Ot?"Table locked after publish":"Clear all marks":"Save & Lock Mark Manager first to enable table",children:"Reset All"}),i.jsx("button",{onClick:ge,className:"obe-btn obe-btn-primary",disabled:!e||j||!Wt||Ot||Ie||!L,style:!Wt||Ot?{opacity:.6,cursor:"not-allowed"}:void 0,title:Wt?Ot?"Table locked after publish":L?Ie?"Publishing locked by IQAC":"Publish marks":"Publish window closed":"Save & Lock Mark Manager first",children:j?"Publishing":"Publish"})]}),i.jsx("div",{style:{flex:1}}),i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",fontSize:12,color:"#6b7280",alignItems:"center"},children:[v?i.jsxs("div",{title:"Last saved",children:[" ",v]}):null,M?i.jsxs("div",{title:"Published",children:[" ",M]}):null,U!=null&&!L?i.jsxs("div",{title:"Publish window opens in",children:[" ",D0(U)]}):null]})]}),d&&i.jsx("div",{style:{marginBottom:10,color:"#b91c1c"},children:d}),c?i.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):p.length===0?i.jsx("div",{style:{color:"#6b7280"},children:"Select a Teaching Assignment to load students."}):Wt?i.jsx("div",{style:je,children:i.jsxs(Gm,{locked:Ie,children:[i.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:i.jsxs("table",{className:"obe-table",style:{minWidth:Ce,width:"100%",borderCollapse:"collapse"},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:ue,colSpan:Ue,children:[X.sheet.termLabel," | ",X.sheet.batchLabel," | ",n]})}),i.jsxs("tr",{children:[i.jsx("th",{style:ue,rowSpan:5,children:"S.No"}),i.jsx("th",{style:ue,rowSpan:5,children:"Register No."}),i.jsx("th",{style:ue,rowSpan:5,children:"Name of the Students"}),i.jsx("th",{style:ue,colSpan:Math.max(1,ct),children:"Experiments"}),i.jsx("th",{style:ue,rowSpan:5,children:"Total (Avg)"}),Se?i.jsx("th",{style:ue,colSpan:Math.max(Te.length,1),children:"CAA EXAM"}):null,i.jsx("th",{style:ue,colSpan:4,children:"CO ATTAINMENT"}),wt.length?i.jsx("th",{style:ue,colSpan:wt.length*2,children:"BTL ATTAINMENT"}):null]}),i.jsxs("tr",{children:[ct===0?i.jsx("th",{style:ue,children:""}):i.jsxs(i.Fragment,{children:[Array.from({length:Xe},(pe,Je)=>i.jsx("th",{style:ue,children:a},`coa_${Je}`)),Array.from({length:Be},(pe,Je)=>i.jsx("th",{style:ue,children:s},`cob_${Je}`))]}),Se?Te.length?Te.map(pe=>i.jsxs("th",{style:ue,children:["CO-",pe]},`caa_hdr_${pe}`)):i.jsx("th",{style:ue,children:""}):null,i.jsxs("th",{style:ue,colSpan:2,children:["CO-",a]}),i.jsxs("th",{style:ue,colSpan:2,children:["CO-",s]}),wt.map(pe=>i.jsxs("th",{style:ue,colSpan:2,children:["BTL-",pe]},`btl_${pe}`))]}),i.jsxs("tr",{children:[ct===0?i.jsx("th",{style:ue,children:""}):i.jsxs(i.Fragment,{children:[Array.from({length:Xe},(pe,Je)=>i.jsx("th",{style:ue,children:Re},`max_a_${Je}`)),Array.from({length:Be},(pe,Je)=>i.jsx("th",{style:ue,children:xt},`max_b_${Je}`))]}),Se?Te.length?Te.map(pe=>i.jsx("th",{style:ue,children:bu[pe]??0},`caa_max_${pe}`)):i.jsx("th",{style:ue,children:""}):null,i.jsx("th",{style:ue,children:at}),i.jsx("th",{style:ue,children:"%"}),i.jsx("th",{style:ue,children:er}),i.jsx("th",{style:ue,children:"%"}),wt.map(pe=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:ue,children:oe}),i.jsx("th",{style:ue,children:"%"})]},`btlmax_${pe}`))]}),i.jsxs("tr",{children:[ct===0?i.jsx("th",{style:ue,children:"No experiments"}):i.jsxs(i.Fragment,{children:[Array.from({length:Xe},(pe,Je)=>i.jsxs("th",{style:ue,children:["E",Je+1]},`ea_${Je}`)),Array.from({length:Be},(pe,Je)=>i.jsxs("th",{style:ue,children:["E",Je+1]},`eb_${Je}`))]}),i.jsx("th",{style:ue,colSpan:4+wt.length*2+Dt})]}),i.jsxs("tr",{children:[ct===0?i.jsx("th",{style:ue,children:""}):i.jsxs(i.Fragment,{children:[Array.from({length:Xe},(pe,Je)=>{const Ge=Es(X.sheet.btlsA,Ve)[Je]??1;return i.jsx("th",{style:ue,children:i.jsxs("div",{style:{position:"relative",display:"grid",placeItems:"center"},title:`BTL: ${Ge}`,children:[i.jsx("div",{style:{width:"100%",padding:"2px 4px",textAlign:"center",userSelect:"none",fontWeight:800,fontSize:11,color:"#0f172a",background:"#ecfdf5",borderRadius:4},children:Ge}),i.jsx("select",{"aria-label":`BTL for CO${a} E${Je+1}`,value:Ge,onChange:Ye=>ur("A",Je,Number(Ye.target.value)),disabled:qe||Ie,style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:Pt?"not-allowed":"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[1,2,3,4,5,6].map(Ye=>i.jsx("option",{value:Ye,children:Ye},Ye))})]})},`btla_${Je}`)}),Array.from({length:Be},(pe,Je)=>{const Ge=Es(X.sheet.btlsB,Qe)[Je]??1;return i.jsx("th",{style:ue,children:i.jsxs("div",{style:{position:"relative",display:"grid",placeItems:"center"},title:`BTL: ${Ge}`,children:[i.jsx("div",{style:{width:"100%",padding:"2px 4px",textAlign:"center",userSelect:"none",fontWeight:800,fontSize:11,color:"#0f172a",background:"#ecfdf5",borderRadius:4},children:Ge}),i.jsx("select",{"aria-label":`BTL for CO${s} E${Je+1}`,value:Ge,onChange:Ye=>ur("B",Je,Number(Ye.target.value)),disabled:qe||Ie,style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:Pt?"not-allowed":"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[1,2,3,4,5,6].map(Ye=>i.jsx("option",{value:Ye,children:Ye},Ye))})]})},`btlb_${Je}`)})]}),i.jsx("th",{style:ue,colSpan:4+wt.length*2+Dt})]})]}),i.jsx("tbody",{children:qe?i.jsx("tr",{children:i.jsx("td",{colSpan:Ue,style:{padding:14,textAlign:"center",color:"#065f46",fontWeight:900},children:"Published  students hidden"})}):i.jsxs(i.Fragment,{children:[p.map((pe,Je)=>{var ie;const Ge=(ie=X.sheet.rowsByStudentId)==null?void 0:ie[String(pe.id)],Ye=tc(Ge==null?void 0:Ge.marksA,Ve),ft=tc(Ge==null?void 0:Ge.marksB,Qe),bt=Fg(Ge==null?void 0:Ge.caaExamByCo),Vt=Ye.slice(0,Xe),Ft=ft.slice(0,Be),gr=Vt.concat(Ft),Ar=Es(X.sheet.btlsA,Ve).slice(0,Xe),kr=Es(X.sheet.btlsB,Qe).slice(0,Be),At=dL(gr),Ut=Ib(Vt),Kr=Ib(Ft),$t=Xe*Re,fr=Be*xt,Or=Number(Fb[a]||0),gt=Number(Fb[s]||0),Jt=$t>0?Ut/$t*Or:0,ht=fr>0?Kr/fr*gt:0,Ct=typeof bt[String(a)]=="number"?Number(bt[String(a)]):0,rr=typeof bt[String(s)]=="number"?Number(bt[String(s)]):0,kt=Number(bu[a]||0),rt=Number(bu[s]||0),Rt=Number(Rb[a]||0),Gt=Number(Rb[s]||0),ir=Se&&kt>0?Ct/kt*Rt:0,Bt=Se&&rt>0?rr/rt*Gt:0,vr=Ut>0||Ct>0,Cr=Kr>0||rr>0,Tr=vr?Jt+ir:null,xr=Cr?ht+Bt:null,Xt={};for(const I of wt){const se=[];for(let ve=0;ve<Vt.length;ve++)if(Ar[ve]===I){const Pe=Vt[ve];typeof Pe=="number"&&Number.isFinite(Pe)&&se.push(Pe)}for(let ve=0;ve<Ft.length;ve++)if(kr[ve]===I){const Pe=Ft[ve];typeof Pe=="number"&&Number.isFinite(Pe)&&se.push(Pe)}Xt[I]=se.length?se.reduce((ve,Pe)=>ve+Pe,0)/se.length:null}return i.jsxs("tr",{children:[i.jsx("td",{style:{...Q,width:"30px",minWidth:"30px",fontWeight:700},children:Je+1}),i.jsx("td",{style:{...Q,width:"70px",minWidth:"70px",fontWeight:600},children:String(pe.reg_no||"").slice(-8)}),i.jsx("td",{style:{...Q,fontWeight:600,whiteSpace:"nowrap"},children:String(pe.name||"")}),Array.from({length:Xe},(I,se)=>i.jsx("td",{style:{...Q,padding:"2px"},children:i.jsx("input",{type:"number",value:Ye[se],onChange:ve=>{const Pe=ve.target.value;if(Pe==="")return ve.currentTarget.setCustomValidity(""),zr(pe.id,"A",se,"");const Ke=Number(Pe);if(Number.isFinite(Ke)){if(Ke>Re){ve.currentTarget.setCustomValidity(`Max mark is ${Re}`),ve.currentTarget.reportValidity(),window.setTimeout(()=>ve.currentTarget.setCustomValidity(""),0);return}ve.currentTarget.setCustomValidity(""),zr(pe.id,"A",se,Ke)}},style:ye,min:0,max:Re,disabled:!Wt||Ot})},`ma${pe.id}_${se}`)),Array.from({length:Be},(I,se)=>i.jsx("td",{style:{...Q,padding:"2px"},children:i.jsx("input",{type:"number",value:ft[se],onChange:ve=>{const Pe=ve.target.value;if(Pe==="")return ve.currentTarget.setCustomValidity(""),zr(pe.id,"B",se,"");const Ke=Number(Pe);if(Number.isFinite(Ke)){if(Ke>xt){ve.currentTarget.setCustomValidity(`Max mark is ${xt}`),ve.currentTarget.reportValidity(),window.setTimeout(()=>ve.currentTarget.setCustomValidity(""),0);return}ve.currentTarget.setCustomValidity(""),zr(pe.id,"B",se,Ke)}},style:ye,min:0,max:xt,disabled:!Wt||Ot})},`mb${pe.id}_${se}`)),i.jsx("td",{style:{...Q,fontWeight:700,fontSize:"clamp(10px, 0.9vw, 11px)"},children:At==null?"":At.toFixed(1)}),Se?Te.length?Te.map(I=>{const se=Number(bu[I]||0),ve=bt[String(I)]??"";return i.jsx("td",{style:{...Q,padding:"2px"},children:i.jsx("input",{type:"number",value:ve,onChange:Pe=>{const Ke=Pe.target.value;if(Ke==="")return Pe.currentTarget.setCustomValidity(""),_n(pe.id,I,"");const pt=Number(Ke);if(Number.isFinite(pt)){if(pt>se){Pe.currentTarget.setCustomValidity(`Max mark is ${se}`),Pe.currentTarget.reportValidity(),window.setTimeout(()=>Pe.currentTarget.setCustomValidity(""),0);return}Pe.currentTarget.setCustomValidity(""),_n(pe.id,I,pt)}},style:ye,min:0,max:se,disabled:!Wt||Ot})},`caa_${pe.id}_${I}`)}):i.jsx("td",{style:{...Q,textAlign:"center",color:"#6b7280"},children:""}):null,i.jsx("td",{style:{...Q,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:Tr==null?"":Tr.toFixed(1)}),i.jsx("td",{style:{...Q,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:fp(Tr,at)}),i.jsx("td",{style:{...Q,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:xr==null?"":xr.toFixed(1)}),i.jsx("td",{style:{...Q,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:fp(xr,er)}),wt.map(I=>{const se=Xt[I]??null,ve=Math.max(Re,xt,Ro);return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Q,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:se==null?"":se.toFixed(1)}),i.jsx("td",{style:{...Q,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:fp(se,ve)})]},`btlcell_${pe.id}_${I}`)})]},pe.id)}),p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:Ue,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})})]})}),qe?i.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,Pt?null:i.jsxs("div",{style:De,children:[i.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:i.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]}),qe?i.jsxs("div",{style:De,children:[i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),i.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[i.jsx("button",{type:"button",className:"obe-btn",onClick:()=>B(!0),children:"View Marks"}),i.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:()=>{N(!0)},children:"Edit"})]}),i.jsx("div",{style:{width:170,height:92,display:"grid",placeItems:"center",background:"#fff",borderRadius:10,border:"1px solid rgba(2,6,23,0.08)"},children:i.jsx("img",{src:new URL("/assets/lockong-CpAqbAhU.png",import.meta.url).toString(),alt:"locked",style:{maxWidth:150,maxHeight:80,display:"block"},onError:pe=>{pe.currentTarget.onerror=null,pe.currentTarget.src=Xge}})})]}):null]})}):i.jsxs("div",{style:{padding:"20px",textAlign:"center",background:"#fff7ed",borderRadius:12,border:"1px solid #fcd34d"},children:[i.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#92400e",marginBottom:8},children:" Mark Manager Configuration Required"}),i.jsx("div",{style:{fontSize:12,color:"#78350f"},children:"Please configure and lock the Mark Manager above to enable the table."})]}),i.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[v?i.jsxs("div",{children:["Draft saved: ",v,_?i.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",i.jsx("strong",{children:_})]}):null]}):null,M?i.jsxs("div",{children:["Last published: ",M]}):null]}),R?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>N(!1),children:i.jsxs("div",{style:{width:"min(560px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:pe=>pe.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Edit Request"}),i.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),i.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Subject:"})," ",n]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Code:"})," ",String(e||"")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Published:"})," ",M||""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Saved:"})," ",v||""]})]}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"obe-btn",onClick:()=>N(!1),children:"Close"}),i.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",onClick:async()=>{if(e)try{await qo({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:`Edit request: Marks entry for ${n}`,teaching_assignment_id:t}),alert("Edit request sent to IQAC."),N(!1),ae({silent:!0})}catch(pe){alert((pe==null?void 0:pe.message)||"Request failed")}},children:"Request Edit"})]})]})}):null,de?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:9999},onClick:()=>{E||ne(null)},children:i.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:pe=>pe.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:de.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),i.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(r).toUpperCase()})]}),de.mode==="confirm"?i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{background:"#fffbeb",border:"1px solid #fbbf24",borderRadius:8,padding:12,marginBottom:12},children:[i.jsx("div",{style:{fontWeight:700,color:"#92400e",marginBottom:4},children:" Important"}),i.jsxs("div",{style:{fontSize:12,color:"#78350f",lineHeight:1.5},children:["After confirming, Mark Manager will be ",i.jsx("strong",{children:"locked"}),". You'll need IQAC approval to change CO selection, experiment count, or max marks."]})]}),i.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:8,fontWeight:600},children:"Review your settings:"}),i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f9fafb"},children:[i.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Item"}),i.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Experiments"}),i.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Max marks"})]})}),i.jsxs("tbody",{children:[Tt?i.jsxs("tr",{children:[i.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:["CO-",a]}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:Xe}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:Re})]}):null,vt?i.jsxs("tr",{children:[i.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:["CO-",s]}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:Be}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:xt})]}):null,!Tt&&!vt?i.jsx("tr",{children:i.jsx("td",{colSpan:3,style:{padding:10,color:"#dc2626",fontWeight:600},children:" No COs selected"})}):null,i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:"CAA Exam"}),i.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:Se?" Enabled":" Disabled"})]})]})]})})]}):i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{className:"obe-btn",disabled:E,onClick:()=>ne(null),children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:E||!e,onClick:async()=>{if(e){if(de.mode==="request"){ne(null),await Nr();return}Z(!0),F(null),z(!0);try{const pe=Rr(X.sheet),Je=he!=null&&he.approval_until?String(he.approval_until):X.sheet.markManagerApprovalUntil||null,Ge={...X,sheet:{...X.sheet,markManagerLocked:!0,markManagerSnapshot:pe,markManagerApprovalUntil:Je}};await li(r,String(e),Ge),w(new Date().toLocaleString()),await Zf(r,String(e),t),await ae({silent:!1}),J(Ge),ne(null),alert(" Mark Manager saved and locked successfully! You can now proceed with mark entry."),setTimeout(()=>z(!1),1500)}catch(pe){F((pe==null?void 0:pe.message)||"Save failed"),z(!1),J(Je=>({...Je,sheet:{...Je.sheet,markManagerLocked:!1}}))}finally{Z(!1)}}},children:E?"Saving...":de.mode==="confirm"?" Confirm & Lock":" Send Request"})]})]})}):null,T?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:70},onClick:()=>B(!1),children:i.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflow:"auto",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:pe=>pe.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Marks"}),i.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),xe?i.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,V?i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:V}):null,(()=>{const pe=G&&G.sheet?G.sheet:X.sheet,Je=pe.ciaExamEnabled!==!1,Ge=_a(Number(pe.expCountA??Ni),0,12),Ye=_a(Number(pe.expCountB??Ni),0,12),ft=!!pe.coAEnabled,bt=!!pe.coBEnabled,Vt=ft?Ge:0,Ft=bt?Ye:0,gr=Vt+Ft,Ar=Es(pe.btlsA,Ge).slice(0,Vt),kr=Es(pe.btlsB,Ye).slice(0,Ft),At=new Set;for(const rt of Ar)At.add(rt);for(const rt of kr)At.add(rt);const Ut=[1,2,3,4,5,6].filter(rt=>At.has(rt)),Kr=_a(Number(pe.expMaxA??Ro),0,100),$t=_a(Number(pe.expMaxB??Ro),0,100),fr=Number(Bb[a]||0),Or=Number(Bb[s]||0),gt=Math.max(Kr,$t,Ro),ht=[ft?a:null,bt?s:null].filter(rt=>typeof rt=="number").filter(rt=>Number.isFinite(Number(bu[rt]))),Ct=Je?Math.max(ht.length,1):0,rr=3+gr+1+Ct+4+Ut.length*2,kt=Math.max(920,360+(gr+Ut.length*2+Ct)*80);return i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:i.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:kt,tableLayout:"auto",borderCollapse:"collapse"},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsx("th",{style:ue,colSpan:rr,children:n})}),i.jsxs("tr",{children:[i.jsx("th",{style:ue,rowSpan:5,children:"S.No"}),i.jsx("th",{style:ue,rowSpan:5,children:"Register No."}),i.jsx("th",{style:ue,rowSpan:5,children:"Name of the Students"}),i.jsx("th",{style:ue,colSpan:Math.max(1,gr),children:"Experiments"}),i.jsx("th",{style:ue,rowSpan:5,children:"Total (Avg)"}),Je?i.jsx("th",{style:ue,colSpan:Math.max(ht.length,1),children:"CAA EXAM"}):null,i.jsx("th",{style:ue,colSpan:4,children:"CO ATTAINMENT"}),Ut.length?i.jsx("th",{style:ue,colSpan:Ut.length*2,children:"BTL ATTAINMENT"}):null]}),i.jsxs("tr",{children:[gr===0?i.jsx("th",{style:ue,children:""}):i.jsxs(i.Fragment,{children:[Array.from({length:Vt},(rt,Rt)=>i.jsx("th",{style:ue,children:a},`v_coa_${Rt}`)),Array.from({length:Ft},(rt,Rt)=>i.jsx("th",{style:ue,children:s},`v_cob_${Rt}`))]}),Je?ht.length?ht.map(rt=>i.jsxs("th",{style:ue,children:["CO-",rt]},`v_caa_${rt}`)):i.jsx("th",{style:ue,children:""}):null,i.jsxs("th",{style:ue,colSpan:2,children:["CO-",a]}),i.jsxs("th",{style:ue,colSpan:2,children:["CO-",s]}),Ut.map(rt=>i.jsxs("th",{style:ue,colSpan:2,children:["BTL-",rt]},`v_btl_${rt}`))]}),i.jsxs("tr",{children:[gr===0?i.jsx("th",{style:ue,children:""}):i.jsx(i.Fragment,{children:Array.from({length:gr},(rt,Rt)=>i.jsx("th",{style:ue,children:gt},`v_max_${Rt}`))}),Je?ht.length?ht.map(rt=>i.jsx("th",{style:ue,children:bu[rt]??0},`v_caa_max_${rt}`)):i.jsx("th",{style:ue,children:""}):null,i.jsx("th",{style:ue,children:fr}),i.jsx("th",{style:ue,children:"%"}),i.jsx("th",{style:ue,children:Or}),i.jsx("th",{style:ue,children:"%"}),Ut.map(rt=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:ue,children:gt}),i.jsx("th",{style:ue,children:"%"})]},`v_btlmax_${rt}`))]}),i.jsxs("tr",{children:[gr===0?i.jsx("th",{style:ue,children:"No experiments"}):i.jsxs(i.Fragment,{children:[Array.from({length:Vt},(rt,Rt)=>i.jsxs("th",{style:ue,children:["E",Rt+1]},`v_ea_${Rt}`)),Array.from({length:Ft},(rt,Rt)=>i.jsxs("th",{style:ue,children:["E",Rt+1]},`v_eb_${Rt}`))]}),i.jsx("th",{style:ue,colSpan:4+Ut.length*2+Ct})]}),i.jsxs("tr",{children:[gr===0?i.jsx("th",{style:ue,children:"BTL"}):i.jsxs(i.Fragment,{children:[Array.from({length:Vt},(rt,Rt)=>i.jsx("th",{style:ue,children:Ar[Rt]??1},`v_btla_${Rt}`)),Array.from({length:Ft},(rt,Rt)=>i.jsx("th",{style:ue,children:kr[Rt]??1},`v_btlb_${Rt}`))]}),i.jsx("th",{style:ue,colSpan:4+Ut.length*2+Ct})]})]}),i.jsxs("tbody",{children:[p.map((rt,Rt)=>{var qr;const Gt=(qr=pe==null?void 0:pe.rowsByStudentId)==null?void 0:qr[String(rt.id)],ir=tc(Gt==null?void 0:Gt.marksA,Ge).slice(0,Vt),Bt=tc(Gt==null?void 0:Gt.marksB,Ye).slice(0,Ft),vr=ir.concat(Bt),Cr=dL(vr),Tr=Fg(Gt==null?void 0:Gt.caaExamByCo),xr=Ib(ir),Xt=Ib(Bt),ie=Vt*Kr,I=Ft*$t,se=Number(Fb[a]||0),ve=Number(Fb[s]||0),Pe=ie>0?xr/ie*se:0,Ke=I>0?Xt/I*ve:0,pt=typeof Tr[String(a)]=="number"?Number(Tr[String(a)]):0,ut=typeof Tr[String(s)]=="number"?Number(Tr[String(s)]):0,Lt=Number(bu[a]||0),Sr=Number(bu[s]||0),hr=Number(Rb[a]||0),mt=Number(Rb[s]||0),_t=Je&&Lt>0?pt/Lt*hr:0,cr=Je&&Sr>0?ut/Sr*mt:0,sr=xr>0||pt>0?Pe+_t:null,pr=Xt>0||ut>0?Ke+cr:null,Dr={};for(const Ur of Ut){const Qr=[];for(let on=0;on<ir.length;on++)if(Ar[on]===Ur){const gn=ir[on];typeof gn=="number"&&Number.isFinite(gn)&&Qr.push(gn)}for(let on=0;on<Bt.length;on++)if(kr[on]===Ur){const gn=Bt[on];typeof gn=="number"&&Number.isFinite(gn)&&Qr.push(gn)}Dr[Ur]=Qr.length?Qr.reduce((on,gn)=>on+gn,0)/Qr.length:null}return i.jsxs("tr",{children:[i.jsx("td",{style:{...Q,textAlign:"center",width:42,minWidth:42},children:Rt+1}),i.jsx("td",{style:Q,children:String(rt.reg_no||"")}),i.jsx("td",{style:Q,children:String(rt.name||"")}),gr===0?i.jsx("td",{style:{...Q,textAlign:"center",color:"#6b7280"},children:""}):i.jsxs(i.Fragment,{children:[Array.from({length:Vt},(Ur,Qr)=>i.jsx("td",{style:{...Q,width:78,minWidth:78,background:"#fff7ed",textAlign:"center",fontWeight:800},children:ir[Qr]??""},`v_ma_${rt.id}_${Qr}`)),Array.from({length:Ft},(Ur,Qr)=>i.jsx("td",{style:{...Q,width:78,minWidth:78,background:"#fff7ed",textAlign:"center",fontWeight:800},children:Bt[Qr]??""},`v_mb_${rt.id}_${Qr}`))]}),i.jsx("td",{style:{...Q,textAlign:"right",fontWeight:800},children:Cr==null?"":Cr.toFixed(1)}),Je?ht.length?ht.map(Ur=>i.jsx("td",{style:{...Q,width:90,minWidth:90,background:"#fff7ed",textAlign:"center",fontWeight:800},children:Tr[String(Ur)]??""},`v_caa_cell_${rt.id}_${Ur}`)):i.jsx("td",{style:{...Q,textAlign:"center",color:"#6b7280"},children:""}):null,i.jsx("td",{style:{...Q,textAlign:"right"},children:sr==null?"":sr.toFixed(1)}),i.jsx("td",{style:{...Q,textAlign:"right"},children:fp(sr,fr)}),i.jsx("td",{style:{...Q,textAlign:"right"},children:pr==null?"":pr.toFixed(1)}),i.jsx("td",{style:{...Q,textAlign:"right"},children:fp(pr,Or)}),Ut.map(Ur=>{const Qr=Dr[Ur]??null;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Q,textAlign:"right"},children:Qr==null?"":Qr.toFixed(1)}),i.jsx("td",{style:{...Q,textAlign:"right"},children:fp(Qr,gt)})]},`v_btl_${rt.id}_${Ur}`)})]},`v_${rt.id}`)}),p.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:rr,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})})(),i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{type:"button",className:"obe-btn",onClick:()=>B(!1),children:"Close"})})]})}):null]})}new URL("https://static.vecteezy.com/system/resources/thumbnails/014/585/778/small/gold-locked-padlock-png.png",import.meta.url).href;const Sk={co1:42,co2:42,co3:58,co4:42,co5:42},_k={1:9,2:9,3:4.5},kk={1:3,2:3,3:1.5},xf={1:20,2:20,3:10},hp={1:12,2:12,3:6},ba=5,Ca=25,yf=30;function Fr(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function hL(e){return Math.round(e*10)/10}function Zge(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const a=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return a.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function Ci(e,t){const r=Array.isArray(e)?e:[],n=[];for(let a=0;a<t;a++){const s=r[a];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function vu(e,t,r=1){const n=Array.isArray(e)?e:[],a=[];for(let s=0;s<t;s++){const o=n[s];if(o===""||o==null){a.push(r);continue}const l=typeof o=="number"?o:Number(o);a.push(Number.isFinite(l)&&l>=1&&l<=6?Math.trunc(l):r)}return a}function Rg(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Db(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function jk(e){return e.reduce((t,r)=>t+(typeof r=="number"&&Number.isFinite(r)?r:0),0)}function pp(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const a=t[n];if(a===""||a==null){r[n]="";continue}const s=typeof a=="number"?a:Number(a);r[n]=Number.isFinite(s)?s:""}return r}function pL(e,t=7){const r=String(e??"").trim();return r?r.length<=t?r:r.slice(-t):""}function exe(e,t){return`${e}_sheet_${t}`}function Bv({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:a,coB:s,skipMarkManager:o=!1,itemLabel:l,itemLabelPlural:c,itemAbbrev:u,ciaExamAvailable:d,absentEnabled:f,autoSaveDraft:p,autoSaveDelayMs:h,viewerMode:m,floatPanelOnTable:g}){const[b,y]=x.useState([]),[v,w]=x.useState(!1),[_,C]=x.useState(null),[j,A]=x.useState(null),[M,P]=x.useState(!1),[R,N]=x.useState(null),[T,B]=x.useState(null),[G,re]=x.useState(!1),[xe,_e]=x.useState(null),[V,K]=x.useState(!1),[de,ne]=x.useState(!1),[E,Z]=x.useState(""),[H,F]=x.useState(!1),[ee,z]=x.useState(null),[X,J]=x.useState(!1),[q,Y]=x.useState(null),[L,U]=x.useState(!1),[ce,W]=x.useState(null),[ae,he]=x.useState(!1),[ze,ke]=x.useState(null),[qe,Ie]=x.useState(!1),[Ve,Qe]=x.useState(null),[Tt,vt]=x.useState(null),Xe=String(l||"Experiment"),Be=String(c||"Experiments"),ct=String(u||"E"),nt=d!==!1,Se=!!(f??r==="model"),Te=!!p,Dt=Fr(Number(h??900),250,5e3),wt=x.useRef(null),Pt=x.useRef(null),Wt=x.useMemo(()=>e?exe(r,String(e)):"",[r,e]),{data:Ot,publishAllowed:Ht,refresh:Pr}=dh({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:jt,refresh:ur}=fh({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:Ir}=Ul({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:Rr,refresh:Nr}=Ul({assessment:r,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[zr,_n]=x.useState(null),Yr=!!xe||!!(jt!=null&&jt.exists&&(jt!=null&&jt.is_published)),pn=jt!=null&&jt.mark_entry_unblocked_until?String(jt.mark_entry_unblocked_until):null,ge=jt!=null&&jt.mark_manager_unlocked_until?String(jt.mark_manager_unlocked_until):null,Ne=!!pn&&!!(jt!=null&&jt.entry_open)&&(zr==null||pn!==(zr.markEntryUnblockedUntil??null)),dt=!!ge&&(zr==null||ge!==(zr.markManagerUnlockedUntil??null)),Ue=Yr?!!(jt!=null&&jt.entry_open)&&(zr==null||Ne||dt):!0,Re=!!(Yr&&!Ue),xt=!!(Ot!=null&&Ot.global_override_active&&(Ot==null?void 0:Ot.global_is_open)===!1),[at,er]=x.useState(()=>({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:Fr(Number(a??1),1,5),coBNum:s==null?null:Fr(Number(s),1,5),coAEnabled:!0,coBEnabled:!!s,ciaExamEnabled:!!nt,expCountA:ba,expCountB:s?ba:0,expMaxA:Ca,expMaxB:s?Ca:0,btlA:Array.from({length:ba},()=>1),btlB:s?Array.from({length:ba},()=>1):[],coConfigs:{[String(Fr(Number(a??1),1,5))]:{enabled:!0,expCount:ba,expMax:Ca,btl:Array.from({length:ba},()=>1)},...s==null?{}:{[String(Fr(Number(s),1,5))]:{enabled:!0,expCount:ba,expMax:Ca,btl:Array.from({length:ba},()=>1)}}},rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null}})),[oe,ue]=x.useState(null),Q=x.useMemo(()=>In(oe),[oe]),ye=x.useMemo(()=>uN(oe),[oe]),je=x.useMemo(()=>Q==="LAB"||Q==="TCPL"||Q==="TCPR"||Q==="PRACTICAL"||Q==="PROJECT",[Q]);x.useEffect(()=>{let fe=!0;return(async()=>{try{const be=await iu();if(!fe)return;er(He=>({...He,sheet:{...He.sheet,termLabel:String((be==null?void 0:be.termLabel)||He.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e||He.sheet.batchLabel||"")}}))}catch{}})(),()=>{fe=!1}},[e]),x.useEffect(()=>{let fe=!0;return(async()=>{if(e)try{const be=String(e).trim().toUpperCase(),He=await sl();if(!fe)return;const Fe=(He||[]).find(Nt=>String(Nt.course_code||"").trim().toUpperCase()===be);if(Fe&&(Fe!=null&&Fe.class_type)){ue((Fe==null?void 0:Fe.class_type)??null);return}const st=await Ld();if(!fe)return;const It=(st||[]).find(Nt=>String(Nt.course_code||"").trim().toUpperCase()===be);ue((It==null?void 0:It.class_type)??null)}catch{fe&&ue(null)}})(),()=>{fe=!1}},[e]),x.useEffect(()=>{let fe=!0;return(async()=>{var be,He;if(e)try{const Fe=await Mn(r,String(e));if(!fe)return;const st=Fe==null?void 0:Fe.draft;if(st&&typeof st=="object"&&st.sheet&&typeof st.sheet=="object"){const It=Fr(Number(a??1),1,5),Nt=s==null?null:Fr(Number(s),1,5),or=It,nr=Nt,Er=!!(st.sheet.coAEnabled??!0),Br=!!(st.sheet.coBEnabled??!!nr),Hr=nt?!!(st.sheet.ciaExamEnabled??!0):!1,O=Fr(Number(st.sheet.expCountA??ba),0,12),le=Fr(Number(st.sheet.expCountB??(Br?ba:0)),0,12),Le=Number.isFinite(Number(st.sheet.expMaxA))?Number(st.sheet.expMaxA):Ca,Ee=Number.isFinite(Number(st.sheet.expMaxB))?Number(st.sheet.expMaxB):Br?Ca:0,Ze=vu(st.sheet.btlA,O,1),lt=vu(st.sheet.btlB,le,1),St=st.sheet.coConfigs,Zt={};if(St&&typeof St=="object")for(const Jn of Object.keys(St)){const Kn=St[Jn]||{},wa=Fr(Number(Kn.expCount??ba),0,12);Zt[Jn]={enabled:!!Kn.enabled,expCount:wa,expMax:Number.isFinite(Number(Kn.expMax))?Number(Kn.expMax):Ca,btl:vu(Kn.btl,wa,1)}}const tr=String(or);if(Zt[tr]||(Zt[tr]={enabled:Er,expCount:O,expMax:Le,btl:Ze}),nr!=null){const Jn=String(nr);Zt[Jn]||(Zt[Jn]={enabled:Br,expCount:le,expMax:Ee,btl:lt})}const jr=!!(((be=Zt[String(or)])==null?void 0:be.enabled)??Er),zt=!!(nr!=null&&(((He=Zt[String(nr)])==null?void 0:He.enabled)??Br)),dr=Jn=>{const Kn=Jn&&typeof Jn=="object"?Jn:{},wa={};for(const[es,Ya]of Object.entries(Kn)){const ra=Ya&&typeof Ya=="object"?Ya:{},Yn=ra!=null&&ra.marksByCo&&typeof ra.marksByCo=="object"?{...ra.marksByCo}:{},Ra=Ci(ra==null?void 0:ra.marksA,O),ja=Ci(ra==null?void 0:ra.marksB,le),dn=Ci(Yn[tr],O),fi=nr!=null?Ci(Yn[String(nr)],le):[],$i=xa=>xa.some(Yo=>Yo!==""&&Yo!=null),ts=$i(Ra)?Ra:$i(dn)?dn:Ra,Ui=le?$i(ja)?ja:$i(fi)?fi:ja:ja;Yn[tr]=dn,nr!=null&&(Yn[String(nr)]=fi),wa[String(es)]={...ra,studentId:Number.isFinite(Number(ra==null?void 0:ra.studentId))?Number(ra.studentId):Number(es),marksA:ts,marksB:Ui,marksByCo:Yn,caaExamByCo:pp(ra==null?void 0:ra.caaExamByCo)}}return wa},en=st.sheet.markManagerSnapshot??null,mn=st.sheet.markManagerApprovalUntil??null,vn=st.sheet.markManagerLocked,Gn=typeof vn=="boolean"?vn:!!en;er({sheet:{termLabel:String(st.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e),coANum:or,coBNum:nr,coAEnabled:jr,coBEnabled:zt,ciaExamEnabled:Hr,expCountA:O,expCountB:le,expMaxA:Le,expMaxB:Ee,btlA:Ze,btlB:lt,coConfigs:Zt,rowsByStudentId:dr(st.sheet.rowsByStudentId),markManagerLocked:Gn,markManagerSnapshot:en,markManagerApprovalUntil:mn}});const Fn=(Fe==null?void 0:Fe.updated_at)??null,On=(Fe==null?void 0:Fe.updated_by)??null;if(Fn)try{N(new Date(String(Fn)).toLocaleString())}catch{N(String(Fn))}On&&B(String(On.name||On.username||On.id||""));try{Wt&&Sn(Wt,{rowsByStudentId:st.sheet.rowsByStudentId||{}})}catch{}}else{const It=Wt?Pn(Wt):null,Nt=It!=null&&It.rowsByStudentId&&typeof It.rowsByStudentId=="object"?It.rowsByStudentId:{},or=Fr(Number(a??1),1,5),nr=s==null?null:Fr(Number(s),1,5),Er=ba,Br=nr!=null?ba:0,Hr=Ca,O=nr!=null?Ca:0,le=Array.from({length:Er},()=>1),Le=nr!=null?Array.from({length:Br},()=>1):[],Ee={[String(or)]:{enabled:!0,expCount:Er,expMax:Hr,btl:le},...nr==null?{}:{[String(nr)]:{enabled:!0,expCount:Br,expMax:O,btl:Le}}};er({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:or,coBNum:nr,coAEnabled:!0,coBEnabled:!!nr,ciaExamEnabled:!!nt,expCountA:Er,expCountB:Br,expMaxA:Hr,expMaxB:O,btlA:le,btlB:Le,coConfigs:Ee,rowsByStudentId:Nt,markManagerLocked:!1,markManagerSnapshot:null}})}}catch{}})(),()=>{fe=!1}},[r,e,Wt,a,s]),x.useEffect(()=>{let fe=!0;return(async()=>{var be,He,Fe;if(!t){y([]);return}w(!0),C(null);try{let st=null;try{const Nt=await mr(`/api/academics/teaching-assignments/${t}/`);if(Nt.ok){const or=await Nt.json();if(or&&or.elective_subject_id&&!or.section_id){const nr=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(or.elective_subject_id))}`);if(nr.ok){const Er=await nr.json();st=(Array.isArray(Er.results)?Er.results:Array.isArray(Er)?Er:Er.items||[]).map(Hr=>({id:Number(Hr.student_id??Hr.id),reg_no:String(Hr.reg_no??Hr.regno??""),name:String(Hr.name??Hr.full_name??Hr.username??""),section:Hr.section_name??Hr.section??null}))}}}}catch{}if(!st){const Nt=await Ac(t);A({courseName:String(((be=Nt==null?void 0:Nt.teaching_assignment)==null?void 0:be.subject_name)||""),courseCode:String(((He=Nt==null?void 0:Nt.teaching_assignment)==null?void 0:He.subject_code)||e||""),className:String(((Fe=Nt==null?void 0:Nt.teaching_assignment)==null?void 0:Fe.section_name)||"")}),st=((Nt==null?void 0:Nt.students)||[]).map(nr=>({id:Number(nr.id),reg_no:String(nr.reg_no??""),name:String(nr.name??""),section:nr.section??null}))}if(!fe)return;const It=(st||[]).filter(Nt=>Number.isFinite(Nt.id)).sort(Zge);y(It),er(Nt=>{const or=Fr(Number(Nt.sheet.expCountA??ba),0,12),nr=Fr(Number(Nt.sheet.expCountB??0),0,12),Er={...Nt.sheet.rowsByStudentId||{}};for(const Br of It){const Hr=String(Br.id);Er[Hr]||(Er[Hr]={studentId:Br.id,absent:!1,absentKind:void 0,marksA:Array.from({length:or},()=>""),marksB:Array.from({length:nr},()=>""),marksByCo:{},caaExamByCo:{},ciaExam:""})}return{...Nt,sheet:{...Nt.sheet,rowsByStudentId:Er}}})}catch(st){if(!fe)return;y([]),C((st==null?void 0:st.message)||"Failed to load roster")}finally{fe&&w(!1)}})(),()=>{fe=!1}},[t]),x.useEffect(()=>{if(Wt)try{Sn(Wt,{rowsByStudentId:at.sheet.rowsByStudentId})}catch{}},[at.sheet.rowsByStudentId,Wt]),x.useEffect(()=>{if(!e||!!!at.sheet.markManagerSnapshot)return;if(Yr&&(jt!=null&&jt.exists)){const Fe=!!(jt!=null&&jt.mark_manager_locked);!!at.sheet.markManagerLocked!==Fe&&er(st=>({...st,sheet:{...st.sheet,markManagerLocked:Fe}}));return}const be=!!(Ir!=null&&Ir.allowed_by_approval),He=Ir!=null&&Ir.approval_until?String(Ir.approval_until):null;if(be&&He){const Fe=at.sheet.markManagerApprovalUntil?String(at.sheet.markManagerApprovalUntil):null;at.sheet.markManagerLocked&&Fe!==He&&er(st=>({...st,sheet:{...st.sheet,markManagerLocked:!1,markManagerApprovalUntil:He}}));return}at.sheet.markManagerLocked||er(Fe=>({...Fe,sheet:{...Fe.sheet,markManagerLocked:!0}}))},[e,Yr,jt==null?void 0:jt.exists,jt==null?void 0:jt.mark_manager_locked,Ir==null?void 0:Ir.allowed_by_approval,Ir==null?void 0:Ir.approval_until,at.sheet.markManagerLocked,at.sheet.markManagerSnapshot,at.sheet.markManagerApprovalUntil]);const Ce=Fr(Number(at.sheet.coANum??a??1),1,5),ot=at.sheet.coBNum??s??null,it=ot==null?null:Fr(Number(ot),1,5),We=x.useMemo(()=>[1,2,3,4,5],[]),De=x.useMemo(()=>new Set(We.map(fe=>String(fe))),[We]);Fr(Number(at.sheet.expCountA??ba),0,12),Fr(Number(at.sheet.expCountB??0),0,12),at.sheet.coAEnabled,at.sheet.coBEnabled&&it!=null;const pe=x.useMemo(()=>Kr(at.sheet),[at.sheet]),Je=!!at.sheet.markManagerLocked,Ge=nt?at.sheet.ciaExamEnabled!==!1:!1;x.useMemo(()=>$t(pe,Ge),[pe,Ge]);const Ye=!Ue,ft=x.useMemo(()=>Object.entries(pe||{}).filter(([fe,be])=>De.has(String(fe))&&!!(be&&be.enabled)).map(([fe,be])=>({coNumber:Number(fe),expCount:Fr(Number(be.expCount??0),0,12),expMax:Fr(Number(be.expMax??0),0,100),btl:be.btl??[]})),[pe,De]),bt=x.useMemo(()=>ft.reduce((fe,be)=>fe+be.expCount,0),[ft]),Vt=Math.max(bt,1),Ft=ft.length>0,gr=x.useMemo(()=>ft.filter(fe=>Number.isFinite(Number(xf[fe.coNumber]))),[ft]),Ar=gr.length,kr=Ge?je?Math.max(Ar,1):1:0,At=Ft?ft.length*2:2,Ut=x.useMemo(()=>ft.reduce((fe,be)=>Math.max(fe,be.expMax),0),[ft]);x.useMemo(()=>{if(!Se)return!1;const fe=at.sheet.rowsByStudentId||{};return Object.values(fe).some(be=>!!(be!=null&&be.absent))},[Se,at.sheet.rowsByStudentId]),x.useMemo(()=>!m&&Yr&&!Ue?[]:!Se||!L?b:b.filter(fe=>{var be,He;return!!((He=(be=at.sheet.rowsByStudentId)==null?void 0:be[String(fe.id)])!=null&&He.absent)}),[m,Yr,Ue,Se,b,L,at.sheet.rowsByStudentId]),x.useEffect(()=>{if(!Te||!e||Ye||Re)return;Pt.current!=null&&(window.clearTimeout(Pt.current),Pt.current=null);const fe=JSON.stringify(at);if(fe!==wt.current)return Pt.current=window.setTimeout(async()=>{if(e)try{P(!0),await li(r,String(e),at),wt.current=fe,N(new Date().toLocaleString())}catch{}finally{P(!1)}},Dt),()=>{Pt.current!=null&&(window.clearTimeout(Pt.current),Pt.current=null)}},[Te,Dt,r,at,Re,e,Ye]);function Kr(fe){const He={...fe.coConfigs&&typeof fe.coConfigs=="object"?fe.coConfigs:{}};for(const Fe of[1,2,3,4,5]){const st=String(Fe),It=He[st];if(!It)He[st]={enabled:!1,expCount:ba,expMax:Ca,btl:Array.from({length:ba},()=>1)};else{const Nt=Fr(Number(It.expCount??ba),0,12);He[st]={enabled:!!It.enabled,expCount:Nt,expMax:Fr(Number(It.expMax??Ca),0,100),btl:vu(It.btl,Nt,1)}}}return He}function $t(fe,be){const He=Object.entries(fe).filter(([Fe,st])=>De.has(String(Fe))&&!!(st!=null&&st.enabled)).map(([Fe,st])=>({co:Fr(Number(Fe),1,5),expCount:Fr(Number((st==null?void 0:st.expCount)??0),0,12),expMax:Fr(Number((st==null?void 0:st.expMax)??0),0,100)})).sort((Fe,st)=>Fe.co-st.co);return JSON.stringify({enabled:He,ciaExamEnabled:!!be})}function fr(fe){if(!fe)return null;try{const be=JSON.parse(String(fe)),He=Array.isArray(be==null?void 0:be.enabled)?be.enabled:[],Fe={};for(const st of[1,2,3,4,5])Fe[String(st)]={enabled:!1,expCount:ba,expMax:Ca,btl:Array.from({length:ba},()=>1)};for(const st of He){const It=Fr(Number(st==null?void 0:st.co),1,5);Fe[String(It)]={...Fe[String(It)],enabled:!0,expCount:Fr(Number((st==null?void 0:st.expCount)??ba),0,12),expMax:Fr(Number((st==null?void 0:st.expMax)??Ca),0,100)}}return Fe}catch{return null}}function Or(fe,be,He,Fe){if(!fe)return 0;const st=new Set(be.map(Nt=>String(Nt)));let It=0;for(const Nt of Object.values(fe)){if(!Nt||typeof Nt!="object")continue;const or=Nt.marksByCo&&typeof Nt.marksByCo=="object"?Nt.marksByCo:{};let nr=!1;for(const Er of be){const Br=String(Er);if(!st.has(Br))continue;const Hr=or[Br];if(Array.isArray(Hr)&&Hr.some(O=>O!==""&&O!=null)){nr=!0;break}if(!nr&&Er===He&&Array.isArray(Nt.marksA)&&Nt.marksA.some(O=>O!==""&&O!=null)&&(nr=!0),!nr&&Fe!=null&&Er===Fe&&Array.isArray(Nt.marksB)&&Nt.marksB.some(O=>O!==""&&O!=null)&&(nr=!0),nr)break}nr&&It++}return It}function gt(fe){return Object.entries(fe).filter(([be,He])=>De.has(String(be))&&!!(He!=null&&He.enabled)).map(([be])=>Fr(Number(be),1,5)).sort((be,He)=>be-He)}function Jt(fe,be){const He=[],Fe=[],st=[];for(const It of[1,2,3,4,5]){const Nt=String(It),or=fe[Nt],nr=be[Nt],Er=!!(or!=null&&or.enabled),Br=!!(nr!=null&&nr.enabled);if(!or&&nr){Br&&He.push(It);continue}if(or&&!nr){Er&&Fe.push(It);continue}if(or&&nr){const Hr=Fr(Number(or.expCount??0),0,12),O=Fr(Number(nr.expCount??0),0,12),le=Fr(Number(or.expMax??0),0,100),Le=Fr(Number(nr.expMax??0),0,100);(Er!==Br||Hr!==O||le!==Le)&&st.push(It)}}return{added:He,removed:Fe,changed:st}}function ht(fe,be){if(!fe)return 0;let He=0;for(const Fe of Object.values(fe)){if(!Fe||typeof Fe!="object")continue;if(Array.isArray(Fe.marksA)&&Fe.marksA.some(or=>or!==""&&or!=null)||Array.isArray(Fe.marksB)&&Fe.marksB.some(or=>or!==""&&or!=null)||Fe.ciaExam!==""&&Fe.ciaExam!=null){He++;continue}const It=Fe.marksByCo&&typeof Fe.marksByCo=="object"?Fe.marksByCo:{};let Nt=!1;for(const or of be){const nr=It[String(or)];if(Array.isArray(nr)&&nr.some(Er=>Er!==""&&Er!=null)){Nt=!0;break}}Nt&&He++}return He}function Ct(fe){er(be=>!nt||be.sheet.markManagerLocked?be:{...be,sheet:{...be.sheet,ciaExamEnabled:!!fe}})}function rr(fe,be){er(He=>{var or;const Fe=String(fe),st=(or=He.sheet.rowsByStudentId)==null?void 0:or[Fe];if(!st)return He;const It=Fr(Number(He.sheet.expCountA??ba),0,12),Nt=Fr(Number(He.sheet.expCountB??0),0,12);return be?{...He,sheet:{...He.sheet,rowsByStudentId:{...He.sheet.rowsByStudentId,[Fe]:{...st,absent:!0,absentKind:st.absentKind||"AL",marksA:Array.from({length:It},()=>""),marksB:Array.from({length:Nt},()=>""),caaExamByCo:{},ciaExam:""}}}}:{...He,sheet:{...He.sheet,rowsByStudentId:{...He.sheet.rowsByStudentId,[Fe]:{...st,absent:!1,absentKind:void 0}}}}})}function kt(fe,be){er(He=>{var It;const Fe=String(fe),st=(It=He.sheet.rowsByStudentId)==null?void 0:It[Fe];return st?{...He,sheet:{...He.sheet,rowsByStudentId:{...He.sheet.rowsByStudentId,[Fe]:{...st,absent:!0,absentKind:be}}}}:He})}function rt(fe,be){const He=Fr(Number(fe),1,5);er(Fe=>{if(Fe.sheet.markManagerLocked)return Fe;const st=Kr(Fe.sheet),It=String(He),Nt=st[It],or=Fr(Number((Nt==null?void 0:Nt.expCount)??ba),0,12),nr=Fr(Number((Nt==null?void 0:Nt.expMax)??Ca),0,100),Er=vu((Nt==null?void 0:Nt.btl)??[],or,1);st[It]={enabled:!!be,expCount:or,expMax:nr,btl:Er};const Br=Fr(Number(Fe.sheet.coANum??a??1),1,5),Hr=Fe.sheet.coBNum??s??null,O=Hr==null?null:Fr(Number(Hr),1,5),le={...Fe.sheet,coConfigs:st};return He===Br&&(le.coAEnabled=!!be),O!=null&&He===O&&(le.coBEnabled=!!be),{...Fe,sheet:le}})}async function Rt(){if(!e)return;he(!0),ke(null);const fe=new Date,be=jt!=null&&jt.mark_manager_unlocked_until?String(jt.mark_manager_unlocked_until):null;try{const He=await qo({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t});alert("Edit request sent to IQAC. Waiting for approval...");const Fe=Number(He==null?void 0:He.id),st=fe.getTime()-2e3;(async()=>{for(let or=0;or<36;or++){try{const nr=await Jx({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),Er=nr==null?void 0:nr.result;if(!Er)throw new Error("No status");if(Number.isFinite(Fe)&&Fe>0&&Number(Er.id)!==Fe)throw new Error("Different request");const Br=Er.reviewed_at?new Date(String(Er.reviewed_at)).getTime():0,Hr=String(Er.status||"").toUpperCase();if(Hr==="APPROVED"&&Br>=st){try{ur({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}if(Hr==="REJECTED"&&Br>=st){alert("IQAC rejected the mark-manager edit request.");return}}catch{try{const nr=jt!=null&&jt.mark_manager_unlocked_until?String(jt.mark_manager_unlocked_until):null;if(nr&&be&&nr!==be){try{ur({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(nr=>setTimeout(nr,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(He){ke((He==null?void 0:He.message)||"Request failed"),alert((He==null?void 0:He.message)||"Request failed")}finally{he(!1)}}async function Gt(fe,be=[]){if(e){he(!0),ke(null);try{const He=Fr(Number(a??1),1,5),Fe=s==null?null:Fr(Number(s),1,5),st=$t(pe,Ge),It=Ir!=null&&Ir.approval_until?String(Ir.approval_until):at.sheet.markManagerApprovalUntil||null,Nt=pe[String(He)],or=Fe==null?null:pe[String(Fe)],nr=!!(Nt!=null&&Nt.enabled),Er=!!(Fe!=null&&(or!=null&&or.enabled)),Br=Fr(Number((Nt==null?void 0:Nt.expCount)??at.sheet.expCountA??ba),0,12),Hr=Fr(Number((Nt==null?void 0:Nt.expMax)??at.sheet.expMaxA??Ca),0,100),O=vu((Nt==null?void 0:Nt.btl)??at.sheet.btlA,Br,1),le=Fe==null?0:Fr(Number((or==null?void 0:or.expCount)??at.sheet.expCountB??ba),0,12),Le=Fe==null?0:Fr(Number((or==null?void 0:or.expMax)??at.sheet.expMaxB??Ca),0,100),Ee=Fe==null?[]:vu((or==null?void 0:or.btl)??at.sheet.btlB,le,1),Ze=new Set(fe==="full"?[1,2,3,4,5].map(String):fe==="partial"?be.map(tr=>String(Fr(Number(tr),1,5))):[]),lt=(tr,jr,zt)=>{const dr=tr!=null&&tr.marksByCo&&typeof tr.marksByCo=="object"?tr.marksByCo:{};return Ci(dr[jr],zt)},St=tr=>tr.some(jr=>jr!==""&&jr!=null),Zt={...at,sheet:{...at.sheet,coANum:He,coBNum:Fe,coAEnabled:nr,coBEnabled:Er,expCountA:Br,expCountB:le,expMaxA:Hr,expMaxB:Le,btlA:O,btlB:Ee,coConfigs:pe,markManagerLocked:!0,markManagerSnapshot:st,markManagerApprovalUntil:It,rowsByStudentId:Object.fromEntries(Object.entries(at.sheet.rowsByStudentId||{}).map(([tr,jr])=>{const zt=jr&&typeof jr=="object"?jr:{};let dr=zt!=null&&zt.marksByCo&&typeof zt.marksByCo=="object"?{...zt.marksByCo}:{};if(fe==="full")dr={},zt.marksA=Array.from({length:Br},()=>""),zt.marksB=Array.from({length:le},()=>""),zt.caaExamByCo={},zt.ciaExam="";else if(fe==="partial"&&Ze.size){const Jn=pp(zt.caaExamByCo);for(const Kn of Array.from(Ze)){const wa=pe[String(Kn)],es=Fr(Number((wa==null?void 0:wa.expCount)??0),0,12);es>0?dr[String(Kn)]=Array.from({length:es},()=>""):delete dr[String(Kn)],Object.prototype.hasOwnProperty.call(Jn,String(Kn))&&(Jn[String(Kn)]=""),Number(Kn)===He&&(zt.marksA=Array.from({length:Br},()=>"")),Fe!=null&&Number(Kn)===Fe&&(zt.marksB=Array.from({length:le},()=>""))}zt.caaExamByCo=Jn}const en=Ci(zt==null?void 0:zt.marksA,Br),mn=Ci(zt==null?void 0:zt.marksB,le),vn=Ci(dr[String(He)]??lt(zt,String(He),Br),Br),Gn=Fe==null?[]:Ci(dr[String(Fe)]??lt(zt,String(Fe),le),le),Fn=St(en)?en:St(vn)?vn:en,On=le?St(mn)?mn:St(Gn)?Gn:mn:mn;return dr[String(He)]=vn,Fe!=null&&(dr[String(Fe)]=Gn),[tr,{...zt,marksA:Fn,marksB:On,marksByCo:dr}]}))}};er(Zt),W(null),vt(null),Ie(!0),await li(r,String(e),Zt),N(new Date().toLocaleString());try{await Zf(r,String(e),t),ur({silent:!0})}catch(tr){console.warn("confirmMarkManagerLock failed",tr)}}catch(He){ke((He==null?void 0:He.message)||"Save failed")}finally{he(!1),setTimeout(()=>Ie(!1),2e3)}}}function ir(fe,be){const He=Fr(Number(be),0,12);er(Fe=>{if(Fe.sheet.markManagerLocked)return Fe;const st=Kr(Fe.sheet),It=String(fe),Nt=st[It],or=Fr(Number((Nt==null?void 0:Nt.expMax)??Ca),0,100);st[It]={enabled:!!((Nt==null?void 0:Nt.enabled)??!0),expCount:He,expMax:or,btl:vu((Nt==null?void 0:Nt.btl)??[],He,1)};const nr=Fr(Number(Fe.sheet.coANum??a??1),1,5),Er=Fe.sheet.coBNum??s??null,Br=Er==null?null:Fr(Number(Er),1,5),Hr={...Fe.sheet.rowsByStudentId||{}};for(const O of Object.keys(Hr)){const le=Hr[O],Le=le!=null&&le.marksByCo&&typeof le.marksByCo=="object"?{...le.marksByCo}:{};Le[It]=Ci(Le[It],He);const Ee={...le,marksByCo:Le};fe===nr&&(Ee.marksA=Ci(le.marksA,He)),Br!=null&&fe===Br&&(Ee.marksB=Ci(le.marksB,He)),Hr[O]=Ee}return{...Fe,sheet:{...Fe.sheet,coConfigs:st,expCountA:fe===nr?He:Fe.sheet.expCountA,expCountB:fe===Br?He:Fe.sheet.expCountB,btlA:fe===nr?st[It].btl:Fe.sheet.btlA,btlB:fe===Br?st[It].btl:Fe.sheet.btlB,rowsByStudentId:Hr}}})}function Bt(fe,be){const He=Fr(Number(be),0,100);er(Fe=>{if(Fe.sheet.markManagerLocked)return Fe;const st=Kr(Fe.sheet),It=String(fe),Nt=st[It],or=Fr(Number((Nt==null?void 0:Nt.expCount)??ba),0,12);st[It]={enabled:!!((Nt==null?void 0:Nt.enabled)??!0),expCount:or,expMax:He,btl:vu((Nt==null?void 0:Nt.btl)??[],or,1)};const nr=Fr(Number(Fe.sheet.coANum??a??1),1,5),Er=Fe.sheet.coBNum??s??null,Br=Er==null?null:Fr(Number(Er),1,5),Hr=fe===nr?He:Fr(Number(Fe.sheet.expMaxA??Ca),0,100),O=fe===Br?He:Fr(Number(Fe.sheet.expMaxB??0),0,100),le=Fr(Number(Fe.sheet.expCountA??ba),0,12),Le=Fr(Number(Fe.sheet.expCountB??0),0,12),Ee={};for(const[Ze,lt]of Object.entries(Fe.sheet.rowsByStudentId||{})){const St=Ci(lt.marksA,le).map(jr=>typeof jr=="number"?Fr(jr,0,Hr):""),Zt=Ci(lt.marksB,Le).map(jr=>typeof jr=="number"?Fr(jr,0,O):""),tr=lt!=null&&lt.marksByCo&&typeof lt.marksByCo=="object"?{...lt.marksByCo}:{};tr[It]=Ci(tr[It],or).map(jr=>typeof jr=="number"?Fr(jr,0,He):""),Ee[Ze]={...lt,marksA:St,marksB:Zt,marksByCo:tr}}return{...Fe,sheet:{...Fe.sheet,coConfigs:st,expMaxA:Hr,expMaxB:O,rowsByStudentId:Ee}}})}function vr(fe,be,He){er(Fe=>{if(Fe.sheet.markManagerLocked)return Fe;const st=Kr(Fe.sheet),It=String(Fr(Number(fe),1,5)),Nt=st[It],or=Fr(Number((Nt==null?void 0:Nt.expCount)??ba),0,12),nr=vu((Nt==null?void 0:Nt.btl)??[],or,1);be>=0&&be<nr.length&&(nr[be]=He),st[It]={enabled:!!((Nt==null?void 0:Nt.enabled)??!1),expCount:or,expMax:Fr(Number((Nt==null?void 0:Nt.expMax)??Ca),0,100),btl:nr};const Er=Fr(Number(Fe.sheet.coANum??a??1),1,5),Br=Fe.sheet.coBNum??s??null,Hr=Br==null?null:Fr(Number(Br),1,5);return{...Fe,sheet:{...Fe.sheet,coConfigs:st,btlA:fe===Er?nr:Fe.sheet.btlA,btlB:fe===Hr?nr:Fe.sheet.btlB}}})}function Cr(fe,be,He,Fe){er(st=>{var Zt;const It=String(fe),Nt=(Zt=st.sheet.rowsByStudentId)==null?void 0:Zt[It];if(!Nt||Se&&r!=="model"&&Nt.absent)return st;if(r==="model"){const tr=!!Nt.absent,jr=tr?String(Nt.absentKind||"AL").toUpperCase():"";if(tr&&!!!(L&&tr&&(jr==="ML"||jr==="SKL")))return st}const or=Kr(st.sheet),nr=String(Fr(Number(be),1,5)),Er=or[nr],Br=Fr(Number((Er==null?void 0:Er.expCount)??0),0,12),Hr=Fr(Number((Er==null?void 0:Er.expMax)??Ca),0,100),O=Nt!=null&&Nt.marksByCo&&typeof Nt.marksByCo=="object"?{...Nt.marksByCo}:{},le=Ci(O[nr],Br),Le=Fe===""?"":Fr(Number(Fe),0,Hr);He>=0&&He<le.length&&(le[He]=Le),O[nr]=le;const Ee=Fr(Number(st.sheet.coANum??a??1),1,5),Ze=st.sheet.coBNum??s??null,lt=Ze==null?null:Fr(Number(Ze),1,5),St={...Nt,marksByCo:O};return be===Ee&&(St.marksA=Ci(Nt.marksA,Br).map((tr,jr)=>jr===He?Le:tr)),lt!=null&&be===lt&&(St.marksB=Ci(Nt.marksB,Br).map((tr,jr)=>jr===He?Le:tr)),{...st,sheet:{...st.sheet,rowsByStudentId:{...st.sheet.rowsByStudentId,[It]:St}}}})}function Tr(fe,be){er(He=>{var Nt;const Fe=String(fe),st=(Nt=He.sheet.rowsByStudentId)==null?void 0:Nt[Fe];if(!st||!nt||Se&&r!=="model"&&st.absent)return He;if(r==="model"){const or=!!st.absent,nr=or?String(st.absentKind||"AL").toUpperCase():"";if(or&&!!!(L&&or&&(nr==="ML"||nr==="SKL")))return He}const It=be===""?"":Fr(Number(be),0,yf);return{...He,sheet:{...He.sheet,rowsByStudentId:{...He.sheet.rowsByStudentId,[Fe]:{...st,ciaExam:It}}}}})}function xr(fe,be,He){er(Fe=>{var Br;const st=String(fe),It=(Br=Fe.sheet.rowsByStudentId)==null?void 0:Br[st];if(!It||Se&&r!=="model"&&It.absent)return Fe;if(r==="model"){const Hr=!!It.absent,O=Hr?String(It.absentKind||"AL").toUpperCase():"";if(Hr&&!!!(L&&Hr&&(O==="ML"||O==="SKL")))return Fe}const Nt=String(Fr(Number(be),1,5)),or=Number(xf[Number(Nt)]||0),nr=He===""?"":Fr(Number(He),0,or>0?or:0),Er={...pp(It==null?void 0:It.caaExamByCo),[Nt]:nr};return{...Fe,sheet:{...Fe.sheet,rowsByStudentId:{...Fe.sheet.rowsByStudentId,[st]:{...It,caaExamByCo:Er}}}}})}async function Xt(){if(e){P(!0);try{await li(r,String(e),at),N(new Date().toLocaleString()),alert("Draft saved.")}catch(fe){alert((fe==null?void 0:fe.message)||"Draft save failed")}finally{P(!1)}}}async function ie(){if(!e||!window.confirm(`Reset all marks for ${n}? This clears the draft for all students.`))return;const be=Fr(Number(at.sheet.expCountA??ba),0,12),He=Fr(Number(at.sheet.expCountB??0),0,12),Fe={};for(const It of b)Fe[String(It.id)]={studentId:It.id,absent:!1,absentKind:void 0,marksA:Array.from({length:be},()=>""),marksB:Array.from({length:He},()=>""),marksByCo:{},caaExamByCo:{},ciaExam:""};const st={sheet:{...at.sheet,btlA:Array.from({length:be},()=>1),btlB:Array.from({length:He},()=>1),rowsByStudentId:Fe}};er(st);try{Wt&&Sn(Wt,{rowsByStudentId:{}})}catch{}try{await li(r,String(e),st),N(new Date().toLocaleString())}catch{}}async function I(){if(!e)return;if(xt){alert("Publishing is locked by IQAC.");return}if(!Ht){alert("Publish window is closed. Please request IQAC approval.");return}if(Yr&&Re&&!m){K(!0);return}re(!0);const fe=xe,be=zr,He={markEntryUnblockedUntil:pn,markManagerUnlockedUntil:ge};try{console.debug("publish called",{assessment:r,subjectId:e,entryOpen:Ue,publishAllowed:Ht,globalLocked:xt}),_e(new Date().toLocaleString()),_n(He),await oN(r,String(e),at,t),console.debug("publish succeeded",{assessment:r,subjectId:e}),await se(!1),Pr(),ur({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(Fe){_e(fe),_n(be),alert((Fe==null?void 0:Fe.message)||"Publish failed")}finally{re(!1)}}async function se(fe){if(e){fe&&J(!0),Y(null);try{const be=await no(r,String(e),t),He=(be==null?void 0:be.data)??null;He&&typeof He=="object"&&z(He)}catch(be){fe&&Y((be==null?void 0:be.message)||"Failed to load published marks")}finally{fe&&J(!1)}}}x.useEffect(()=>{if(e){if(!(jt!=null&&jt.exists)||!(jt!=null&&jt.is_published)){z(null);return}se(!1)}},[e,r,jt==null?void 0:jt.exists,jt==null?void 0:jt.is_published]);const ve=Zr.useRef(!!Ue);x.useEffect(()=>{if(!e||!Yr)return;if(ve.current||!Ue){ve.current=!!Ue;return}let be=!0;return(async()=>{try{const He=await Mn(r,String(e),t),Fe=(He==null?void 0:He.data)??null;if(!be)return;if(Fe&&typeof Fe=="object"&&Fe.sheet){er(Fe);return}}catch{}be&&ee&&ee.sheet&&er(ee)})(),ve.current=!!Ue,()=>{be=!1}},[Ue,Yr,e,r,ee]),x.useEffect(()=>{if(!e||!Yr||Ue)return;const fe=window.setInterval(()=>{ur({silent:!0});try{Nr==null||Nr({silent:!0})}catch{}},3e4);return()=>window.clearInterval(fe)},[Ue,Yr,e,ur,Nr]),x.useEffect(()=>{_n(null)},[e]);async function Pe(){if(!e)return;F(!0);const fe=new Date,be=Rr!=null&&Rr.approval_until?String(Rr.approval_until):null;try{const He=await qo({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:E||`Edit request: ${n} marks for ${String(e)}`,teaching_assignment_id:t});alert("Edit request sent to IQAC. Waiting for approval..."),K(!1);const Fe=Number(He==null?void 0:He.id),st=fe.getTime()-2e3;(async()=>{for(let or=0;or<36;or++){try{const nr=await Jx({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),Er=nr==null?void 0:nr.result;if(!Er)throw new Error("No status");if(Number.isFinite(Fe)&&Fe>0&&Number(Er.id)!==Fe)throw new Error("Different request");const Br=Er.reviewed_at?new Date(String(Er.reviewed_at)).getTime():0,Hr=String(Er.status||"").toUpperCase();if(Hr==="APPROVED"&&Br>=st){try{ur({silent:!0}),Nr==null||Nr({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}if(Hr==="REJECTED"&&Br>=st){alert("IQAC rejected the edit request.");return}}catch{try{const nr=await Qx(r,String(e),"MARK_ENTRY",t),Er=nr!=null&&nr.approval_until?String(nr.approval_until):null;if(nr!=null&&nr.allowed_by_approval&&Er&&Er!==be){try{ur({silent:!0}),Nr==null||Nr({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(nr=>setTimeout(nr,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(He){alert((He==null?void 0:He.message)||"Request failed")}finally{F(!1)}}x.useEffect(()=>{de&&e&&(z(null),se(!0))},[de,e,r]);const Ke=x.useMemo(()=>{if(bt===0)return[];const fe=new Set;for(const be of ft)for(let He=0;He<be.expCount;He++){const Fe=be.btl[He];(Fe===1||Fe===2||Fe===3||Fe===4||Fe===5||Fe===6)&&fe.add(Fe)}return[1,2,3,4,5,6].filter(be=>fe.has(be))},[ft,bt]),pt=3+(Se?1:0)+Vt+1+kr+At+Ke.length*2,ut={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Lt={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Sr={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},hr={border:"1px solid #e5e7eb",borderRadius:12,background:"#fff",padding:12},mt=40,_t=90,cr=180,sr=56,pr=52,Dr=72,qr=80,Ur=x.useMemo(()=>[...Array.from({length:Vt},()=>qr),pr,...kr>0?Array.from({length:kr},()=>qr):[],...Array.from({length:At+Ke.length*2},()=>qr)],[Vt,kr,At,Ke.length]),Qr=x.useMemo(()=>{const fe=mt+_t+cr+(Se?sr:0),be=Ur.reduce((He,Fe)=>He+Fe,0);return Math.max(900,fe+be)},[Se,Ur]),on=x.useMemo(()=>{const fe=mt+_t+cr,be=Ur.reduce((He,Fe)=>He+Fe,0);return Math.max(900,fe+be)},[Ur]),gn=(fe,be)=>({position:"sticky",left:fe,zIndex:40,...be!=null?{width:be,minWidth:be,maxWidth:be}:null,background:ut.background}),ea=(fe,be)=>({position:"sticky",left:fe,zIndex:25,...be!=null?{width:be,minWidth:be,maxWidth:be}:null,background:"#fff"});function ma(fe,be,He){const Fe=3+(be?1:0),st=Math.max(0,fe-Fe);return i.jsxs("colgroup",{children:[i.jsx("col",{style:{width:mt}}),i.jsx("col",{style:{width:_t}}),i.jsx("col",{style:{width:cr}}),be?i.jsx("col",{style:{width:sr}}):null,Array.from({length:st}).map((It,Nt)=>{const or=(He==null?void 0:He[Nt])??qr;return i.jsx("col",{style:{width:or,minWidth:or,maxWidth:or}},`rest_${Nt}`)})]})}const ga={display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},ta={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},Tn=qe?"markManagerGlitch 2s ease-in-out":void 0,Me={position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"},yt=async()=>{var He;if(!e)return;const fe=Object.entries(((He=at.sheet)==null?void 0:He.coConfigs)||{}).filter(([,Fe])=>!!(Fe!=null&&Fe.enabled)).map(([Fe])=>String(Fe)),be=b.map((Fe,st)=>{var Le,Ee,Ze;const It=(Le=at.sheet.rowsByStudentId)==null?void 0:Le[String(Fe.id)],Nt=It==null?void 0:It.marksByCo,or=[];for(const lt of fe){const St=(Ze=(Ee=at.sheet)==null?void 0:Ee.coConfigs)==null?void 0:Ze[lt],Zt=Fr(Number((St==null?void 0:St.expCount)??0),0,12),tr=Nt&&typeof Nt=="object"?Nt[String(lt)]:void 0,jr=Number(lt)===Ce?It==null?void 0:It.marksA:Number(lt)===Number(ot)?It==null?void 0:It.marksB:void 0,zt=Ci(tr??jr,Zt);for(const dr of zt)typeof dr=="number"&&Number.isFinite(dr)&&or.push(dr)}const nr=Rg(or),Er=Ge&&typeof(It==null?void 0:It.ciaExam)=="number"&&Number.isFinite(It.ciaExam)?Number(It.ciaExam):null,Br=pp(It==null?void 0:It.caaExamByCo),Hr=nr!=null||Ge&&Er!=null,O=!!(Se&&(It!=null&&It.absent)&&!Hr),le=(()=>{var lt,St;if(O)return"ABSENT";if(je){let Zt=0,tr=!1;for(const jr of fe.map(zt=>Number(zt))){const zt=(St=(lt=at.sheet)==null?void 0:lt.coConfigs)==null?void 0:St[String(jr)],dr=Fr(Number((zt==null?void 0:zt.expCount)??0),0,12),en=Fr(Number((zt==null?void 0:zt.expMax)??0),0,100),mn=Nt&&typeof Nt=="object"?Nt[String(jr)]:void 0,vn=jr===Ce?It==null?void 0:It.marksA:jr===Number(ot)?It==null?void 0:It.marksB:void 0,Gn=Ci(mn??vn,dr),Fn=jk(Gn),On=Number(_k[jr]||0),Jn=dr>0&&en>0?Fn/(dr*en)*On:0,Kn=Number(kk[jr]||0),wa=Number(xf[jr]||0),es=Br[String(jr)],Ya=typeof es=="number"&&Number.isFinite(es)?es:0,ra=wa>0?Ya/wa*Kn:0;(Fn>0||Ya>0)&&(tr=!0),Zt+=Jn+ra}return tr?hL(Zt):""}return nr==null&&Er==null?"":hL((nr??0)+(Er??0))})();return{sno:st+1,regNo:String(Fe.reg_no||""),name:String(Fe.name||""),total:le}});await ny({filenameBase:`${String(e)}_${n}`,meta:{courseName:(j==null?void 0:j.courseName)||"",courseCode:(j==null?void 0:j.courseCode)||String(e),className:(j==null?void 0:j.className)||""},rows:be})};return i.jsxs(Km,{children:[i.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0% { background: #fff7ed; transform: translateX(0); }
          10% { background: #f3f4f6; transform: translateX(-2px); }
          20% { background: #fff7ed; transform: translateX(2px); }
          30% { background: #f3f4f6; transform: translateX(-1px); }
          40% { background: #fff7ed; transform: translateX(1px); }
          50% { background: #f3f4f6; transform: translateX(0); }
          60% { background: #fff7ed; transform: translateX(-1px); }
          70% { background: #f3f4f6; transform: translateX(1px); }
          80% { background: #fff7ed; transform: translateX(0); }
          90% { background: #f3f4f6; transform: translateX(-1px); }
          100% { background: #f3f4f6; transform: translateX(0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 1; transform: scale(1) rotate(0deg); }
          50% { opacity: 0.8; transform: scale(1.1) rotate(180deg); }
          100% { opacity: 0; transform: scale(0.5) rotate(360deg); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),i.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),i.jsxs("div",{style:{...ga,border:"1px solid #fcd34d",background:Je?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:Tn,position:"relative",overflow:"hidden"},children:[qe&&i.jsx(i.Fragment,{children:Array.from({length:20},(fe,be)=>i.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},be))}),i.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",gap:10,flexWrap:"wrap"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx(y2,{size:18,color:Je?"#6b7280":"#9a3412"}),i.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Mark Manager"})]}),i.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:i.jsx("button",{onClick:()=>{if(Je){W({mode:"request"});return}const fe=fr(at.sheet.markManagerSnapshot??null);if(fe){const be=gt(fe),He=gt(pe),Fe=be.filter(st=>!He.includes(st));if(Fe.length){const st=Fr(Number(a??1),1,5),It=s==null?null:Fr(Number(s),1,5),Nt=Or(at.sheet.rowsByStudentId,Fe,st,It);vt({visible:!0,removed:Fe,affected:Nt});return}}W({mode:"confirm"})},className:"obe-btn obe-btn-success",disabled:!e||ae,style:ae?{opacity:.6,cursor:"not-allowed"}:void 0,children:Je?"Edit":"Save"})})]}),i.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[We.map(fe=>{const be=pe[String(fe)],He=!!(be!=null&&be.enabled);return i.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[i.jsx("input",{type:"checkbox",checked:He,disabled:Je,onChange:Fe=>rt(fe,Fe.target.checked),style:ta}),"CO-",fe]},fe)}),i.jsx("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:nt?i.jsxs(i.Fragment,{children:[i.jsx("input",{type:"checkbox",checked:Ge,disabled:Je,onChange:fe=>Ct(fe.target.checked),style:ta}),"CIA Exam"]}):null})]}),i.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:10,marginTop:8},children:We.map(fe=>{const be=pe[String(fe)];if(!!!(be!=null&&be.enabled))return null;const Fe=Fr(Number((be==null?void 0:be.expCount)??ba),0,12),st=Fr(Number((be==null?void 0:be.expMax)??Ca),0,100);return i.jsxs("div",{style:{width:"100%",minWidth:0,display:"flex",flexDirection:"column",gap:6,padding:"10px 10px",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:[i.jsxs("div",{style:{fontSize:12,fontWeight:950},children:["CO-",fe]}),i.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of ",Be.toLowerCase()]}),i.jsx("input",{type:"number",className:"obe-input",value:Fe,onChange:It=>ir(fe,Number(It.target.value)),min:0,max:12,disabled:Je}),i.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Max marks"}),i.jsx("input",{type:"number",className:"obe-input",value:st,onChange:It=>Bt(fe,Number(It.target.value)),min:0,max:100,disabled:Je})]},`cfg_${fe}`)})})]}),ze?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:ze}):null]}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center",marginBottom:12},children:[i.jsx("button",{onClick:Xt,className:"obe-btn obe-btn-success",disabled:M||!e||Ye,style:Ye?{opacity:.6,cursor:"not-allowed"}:void 0,title:Ye?"Table locked  confirm Mark Manager to enable actions":void 0,children:M?"Saving":"Save Draft"}),i.jsx("button",{onClick:yt,className:"obe-btn obe-btn-secondary",disabled:!e||b.length===0,children:"Download"}),i.jsx("button",{onClick:ie,className:"obe-btn obe-btn-danger",disabled:!e||Ye,style:Ye?{opacity:.6,cursor:"not-allowed"}:void 0,title:Ye?"Table locked  confirm Mark Manager to enable actions":void 0,children:"Reset"}),i.jsx("button",{onClick:I,className:"obe-btn obe-btn-primary",disabled:!e||G||Ye||xt,style:Ye?{opacity:.6,cursor:"not-allowed"}:void 0,title:Ye?"Table locked  confirm Mark Manager to enable actions":Ht?xt?"Publishing locked":"Publish":"Publish window closed",children:G?"Publishing":"Publish"})]}),v?i.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,_?i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:_}):null,i.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginBottom:12},children:[i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),i.jsx("div",{style:{fontWeight:700},children:at.sheet.termLabel||""})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),i.jsx("div",{style:{fontWeight:700},children:at.sheet.batchLabel||""})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),i.jsx("div",{style:{fontWeight:700},children:R||""}),T?i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",i.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:T})]}):null]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),i.jsx("div",{style:{fontWeight:700},children:xe||""})]})]}),i.jsx("div",{style:hr,children:i.jsx(Gm,{locked:xt,children:i.jsxs("div",{className:"obe-table-wrapper",style:{overflowX:"auto",position:"relative",filter:Ye?"grayscale(5%)":void 0,opacity:Ye?.78:1},children:[i.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:Qr,tableLayout:"fixed",borderCollapse:"collapse"},children:[ma(pt,Se,Ur),i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsx("th",{style:ut,colSpan:pt,children:n})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...ut,...gn(0,mt)},rowSpan:5,children:"S.No"}),i.jsx("th",{style:{...ut,...gn(mt,_t)},rowSpan:5,children:"R.No"}),i.jsx("th",{style:{...ut,...gn(mt+_t,cr),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),Se?i.jsx("th",{style:{...ut,...gn(mt+_t+cr,sr)},rowSpan:5,children:"AB"}):null,i.jsx("th",{style:ut,colSpan:Vt,children:Be}),i.jsx("th",{style:{...ut,width:pr,minWidth:pr,maxWidth:pr},rowSpan:5,children:"AVG"}),Ge?je?i.jsx("th",{style:ut,colSpan:Math.max(Ar,1),children:"CAA EXAM"}):i.jsx("th",{style:{...ut,width:Dr,minWidth:Dr,maxWidth:Dr,whiteSpace:"pre-line",overflow:"visible",textOverflow:"clip",lineHeight:1.05},rowSpan:5,title:"CIA Exam",children:`CIA
EXAM`}):null,i.jsx("th",{style:ut,colSpan:At,children:"CO ATTAINMENT"}),Ke.length?i.jsx("th",{style:ut,colSpan:Ke.length*2,children:"BTL ATTAINMENT"}):null]}),i.jsxs("tr",{children:[bt===0?i.jsx("th",{style:ut,children:""}):i.jsx(i.Fragment,{children:ft.map(fe=>Array.from({length:fe.expCount},(be,He)=>i.jsx("th",{style:ut,children:fe.coNumber},`co_${fe.coNumber}_${He}`)))}),Ge&&je?Ar>0?gr.map(fe=>i.jsxs("th",{style:ut,children:["CO-",fe.coNumber]},`caa_co_${fe.coNumber}`)):i.jsx("th",{style:ut,children:""}):null,Ft?ft.map(fe=>i.jsxs("th",{style:ut,colSpan:2,children:["CO-",fe.coNumber]},`coatt_${fe.coNumber}`)):i.jsx("th",{style:ut,colSpan:2,children:""}),Ke.map(fe=>i.jsxs("th",{style:ut,colSpan:2,children:["BTL-",fe]},`btl_${fe}`))]}),i.jsxs("tr",{children:[bt===0?i.jsx("th",{style:ut,children:""}):i.jsx(i.Fragment,{children:ft.map(fe=>Array.from({length:fe.expCount},(be,He)=>i.jsx("th",{style:ut,children:fe.expMax},`max_${fe.coNumber}_${He}`)))}),Ge&&je?Ar>0?gr.map(fe=>i.jsx("th",{style:ut,children:xf[fe.coNumber]??0},`caa_max_${fe.coNumber}`)):i.jsx("th",{style:ut,children:""}):null,Ft?ft.map(fe=>{const be=Number(hp[fe.coNumber]||0),He=Sk[`co${fe.coNumber}`],Fe=Array.from({length:Fr(Number(fe.expCount??0),0,12)}).map(()=>Fr(Number(fe.expMax??Ca),0,100)),st=Fe.length?Fe.reduce((or,nr)=>or+nr,0)/Fe.length:0,It=ye&&Number.isFinite(Number(He))?Number(He):st,Nt=je&&be>0?be:Math.round(It+(Ge?yf/2:0)||0);return i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:ut,children:Nt}),i.jsx("th",{style:ut,children:"%"})]},`comax_${fe.coNumber}`)}):i.jsxs(i.Fragment,{children:[i.jsx("th",{style:ut,children:""}),i.jsx("th",{style:ut,children:"%"})]}),Ke.map(fe=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:ut,children:Ut||Ca}),i.jsx("th",{style:ut,children:"%"})]},`btlmax_${fe}`))]}),i.jsxs("tr",{children:[bt===0?i.jsxs("th",{style:ut,children:["No ",Be.toLowerCase()]}):i.jsx(i.Fragment,{children:ft.map(fe=>Array.from({length:fe.expCount},(be,He)=>i.jsxs("th",{style:ut,children:[ct,He+1]},`e_${fe.coNumber}_${He}`)))}),i.jsx("th",{style:ut,colSpan:At+Ke.length*2+(Ge&&je?Math.max(Ar,1):0)})]}),i.jsxs("tr",{children:[bt===0?i.jsx("th",{style:ut,children:"BTL"}):i.jsx(i.Fragment,{children:ft.map(fe=>Array.from({length:fe.expCount},(be,He)=>i.jsx("th",{style:ut,children:(()=>{var Nt;const Fe=((Nt=fe.btl)==null?void 0:Nt[He])??1,st=Fe===""?"-":String(Fe),It=!m&&!Ye&&!Re&&!xt;return i.jsxs("div",{style:{position:"relative",display:"grid",placeItems:"center",minWidth:44},title:`BTL: ${st}`,children:[i.jsx("div",{style:{width:"100%",padding:"4px 6px",background:"#fff",textAlign:"center",userSelect:"none",fontWeight:800,cursor:It?"pointer":"default"},children:st}),It?i.jsxs("select",{"aria-label":`BTL for ${Xe} ${He+1} (CO-${fe.coNumber})`,value:Fe,onChange:or=>{const nr=or.target.value,Er=nr===""?"":Number(nr);vr(fe.coNumber,He,Er)},style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[i.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(or=>i.jsx("option",{value:or,children:or},or))]}):null]})})()},`btl_${fe.coNumber}_${He}`)))}),i.jsx("th",{style:ut,colSpan:At+Ke.length*2+(Ge&&je?Math.max(Ar,1):0)})]})]}),i.jsxs("tbody",{children:[(!Ye&&!Re?b:[]).map((fe,be)=>{var le,Le;const He=(le=at.sheet.rowsByStudentId)==null?void 0:le[String(fe.id)],Fe=He==null?void 0:He.ciaExam,st=Ge&&typeof Fe=="number"&&Number.isFinite(Fe)?Fe:null,It=pp(He==null?void 0:He.caaExamByCo),Nt=He==null?void 0:He.marksByCo,or=ft.map(Ee=>{const Ze=Nt&&typeof Nt=="object"?Nt[String(Ee.coNumber)]:void 0,lt=Ee.coNumber===Ce?He==null?void 0:He.marksA:Ee.coNumber===it?He==null?void 0:He.marksB:void 0,St=Ci(Ze??lt,Ee.expCount);return{coNumber:Ee.coNumber,marks:St}}),nr=or.flatMap(Ee=>Ee.marks),Er=Rg(nr),Br=Er!=null||Ge&&st!=null,Hr=Ft?ft.map(Ee=>{var Fn;const Ze=((Fn=or.find(On=>On.coNumber===Ee.coNumber))==null?void 0:Fn.marks)??[],lt=Fr(Number(Ee.expCount??0),0,12),St=Fr(Number(Ee.expMax??Ca),0,100),Zt=lt*St,tr=jk(Ze);if(je&&Number.isFinite(Number(hp[Ee.coNumber]))){const On=Number(_k[Ee.coNumber]||0),Jn=Number(kk[Ee.coNumber]||0),Kn=Number(xf[Ee.coNumber]||0),wa=Number(hp[Ee.coNumber]||0),es=Zt>0?tr/Zt*On:0,Ya=It[String(Ee.coNumber)],ra=typeof Ya=="number"&&Number.isFinite(Ya)?Ya:0,Yn=Kn>0?ra/Kn*Jn:0,Ra=Br?es+Yn:null;return{coNumber:Ee.coNumber,mark:Ra,coMax:wa}}const jr=Rg(Ze),zt=Br?(jr??0)+(Ge?(st??0)/2:0):null,dr=Sk[`co${Ee.coNumber}`],en=Array.from({length:Fr(Number(Ee.expCount??0),0,12)}).map(()=>Fr(Number(Ee.expMax??Ca),0,100)),mn=en.length?en.reduce((On,Jn)=>On+Jn,0)/en.length:0,vn=ye&&Number.isFinite(Number(dr))?Number(dr):mn,Gn=Math.round(vn+(Ge?yf/2:0)||0);return{coNumber:Ee.coNumber,mark:zt,coMax:Gn}}):[],O={};for(const Ee of Ke){const Ze=[];for(const lt of ft){const St=((Le=or.find(Zt=>Zt.coNumber===lt.coNumber))==null?void 0:Le.marks)??[];for(let Zt=0;Zt<Math.min(lt.expCount,St.length);Zt++)if(lt.btl[Zt]===Ee){const tr=St[Zt];typeof tr=="number"&&Number.isFinite(tr)&&Ze.push(tr)}}O[Ee]=Ze.length?Ze.reduce((lt,St)=>lt+St,0)/Ze.length:null}return i.jsxs("tr",{style:Ye&&be<3?{position:"relative",zIndex:35,background:"#fff"}:void 0,children:[i.jsx("td",{style:{...Lt,...ea(0,mt),textAlign:"center"},children:be+1}),i.jsx("td",{style:{...Lt,...ea(mt,_t),textAlign:"center"},title:String(fe.reg_no||""),children:pL(fe.reg_no,7)}),i.jsx("td",{style:{...Lt,...ea(mt+_t,cr)},title:String(fe.name||""),children:i.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(fe.name||"")})}),Se?i.jsx("td",{style:{...Lt,...ea(mt+_t+cr,sr),textAlign:"center"},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:!!(He!=null&&He.absent),onChange:Ee=>rr(fe.id,Ee.target.checked),disabled:Ye}),He!=null&&He.absent?i.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[i.jsx("span",{className:"obe-ios-select-value",children:String(He.absentKind||"AL")}),i.jsxs("select",{"aria-label":"Absent type",value:He.absentKind||"AL",onChange:Ee=>kt(fe.id,Ee.target.value),disabled:Ye,children:[i.jsx("option",{value:"AL",children:"AL"}),i.jsx("option",{value:"ML",children:"ML"}),i.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}):null,bt===0?i.jsx("td",{style:{...Lt,textAlign:"center",color:"#6b7280"},children:""}):ft.map(Ee=>{var lt;const Ze=((lt=or.find(St=>St.coNumber===Ee.coNumber))==null?void 0:lt.marks)??[];return Array.from({length:Ee.expCount},(St,Zt)=>i.jsx("td",{style:{...Lt,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:i.jsx("input",{type:"number",value:Ze[Zt]??"",onChange:tr=>{const jr=tr.target.value;if(jr==="")return tr.currentTarget.setCustomValidity(""),Cr(fe.id,Ee.coNumber,Zt,"");const zt=Number(jr);if(Number.isFinite(zt)){if(zt>Ee.expMax){tr.currentTarget.setCustomValidity(`Max mark is ${Ee.expMax}`),tr.currentTarget.reportValidity(),window.setTimeout(()=>tr.currentTarget.setCustomValidity(""),0);return}tr.currentTarget.setCustomValidity(""),Cr(fe.id,Ee.coNumber,Zt,zt)}},style:Sr,min:0,max:Ee.expMax,disabled:Ye})},`m_${fe.id}_${Ee.coNumber}_${Zt}`))}),i.jsx("td",{style:{...Lt,width:pr,minWidth:0,textAlign:"right",fontWeight:800},children:Er==null?"":Er.toFixed(1)}),Ge?je?Ar>0?gr.map(Ee=>{const Ze=Number(xf[Ee.coNumber]||0),lt=It[String(Ee.coNumber)]??"";return i.jsx("td",{style:{...Lt,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:i.jsx("input",{type:"number",value:lt,onChange:St=>{const Zt=St.target.value;if(Zt==="")return St.currentTarget.setCustomValidity(""),xr(fe.id,Ee.coNumber,"");const tr=Number(Zt);if(Number.isFinite(tr)){if(tr>Ze){St.currentTarget.setCustomValidity(`Max mark is ${Ze}`),St.currentTarget.reportValidity(),window.setTimeout(()=>St.currentTarget.setCustomValidity(""),0);return}St.currentTarget.setCustomValidity(""),xr(fe.id,Ee.coNumber,tr)}},style:Sr,min:0,max:Ze,disabled:Ye})},`caa_${fe.id}_${Ee.coNumber}`)}):i.jsx("td",{style:{...Lt,textAlign:"center",color:"#6b7280"},children:""}):i.jsx("td",{style:{...Lt,width:Dr,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:i.jsx("input",{type:"number",value:(He==null?void 0:He.ciaExam)??"",onChange:Ee=>{const Ze=Ee.target.value;if(Ze==="")return Ee.currentTarget.setCustomValidity(""),Tr(fe.id,"");const lt=Number(Ze);if(Number.isFinite(lt)){if(lt>yf){Ee.currentTarget.setCustomValidity(`Max mark is ${yf}`),Ee.currentTarget.reportValidity(),window.setTimeout(()=>Ee.currentTarget.setCustomValidity(""),0);return}Ee.currentTarget.setCustomValidity(""),Tr(fe.id,lt)}},style:Sr,min:0,max:yf,disabled:Ye})}):null,Ft?Hr.map(Ee=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Lt,textAlign:"right"},children:Ee.mark==null?"":Ee.mark.toFixed(1)}),i.jsx("td",{style:{...Lt,textAlign:"right"},children:Db(Ee.mark,Ee.coMax)})]},`coattrow_${fe.id}_${Ee.coNumber}`)):i.jsxs(i.Fragment,{children:[i.jsx("td",{style:{...Lt,textAlign:"right"}}),i.jsx("td",{style:{...Lt,textAlign:"right"}})]}),Ke.map(Ee=>{const Ze=O[Ee]??null;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Lt,textAlign:"right"},children:Ze==null?"":Ze.toFixed(1)}),i.jsx("td",{style:{...Lt,textAlign:"right"},children:Db(Ze,Ut||Ca)})]},`btlcell_${fe.id}_${Ee}`)})]},fe.id)}),b.length===0&&i.jsx("tr",{children:i.jsx("td",{colSpan:pt,style:{padding:10,color:"#6b7280"},children:"No students."})})]})]}),Ye&&!Re&&!m?i.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(72, 113, 195, 0.92) 0%, rgba(51, 55, 64, 0.96) 100%)"}}):null,Re&&!m?i.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,Ye&&!Re&&!m&&!g?i.jsxs("div",{style:Me,children:[i.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:i.jsx("img",{id:"mark-manager-float-gif",src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"gif",style:{maxWidth:72,maxHeight:72,display:"block"},onError:fe=>{console.warn("Failed to load lock GIF:",fe.currentTarget.src),fe.currentTarget.onerror=null,fe.currentTarget.src="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif" width="72" height="72" viewBox="0 0 24 24" fill="none" stroke="#0f172a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="10" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>')}})}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]}),i.jsx("div",{style:{display:"flex",gap:8,marginTop:4}})]}):null,Re&&!m&&!g?i.jsxs("div",{style:Me,children:[i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),i.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Table is locked. Request IQAC approval to edit."})]}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[i.jsx("button",{type:"button",className:"obe-btn",onClick:()=>ne(!0),children:"View"}),i.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:()=>{K(!0)},children:"Request Edit"})]}),i.jsx("div",{style:{width:170,height:92,display:"grid",placeItems:"center",background:"#fff",borderRadius:10,border:"1px solid rgba(2,6,23,0.08)"},children:i.jsx("img",{id:"published-lock-image",src:new URL("/assets/lockong-CpAqbAhU.png",import.meta.url).toString(),alt:"locked",style:{maxWidth:150,maxHeight:80,display:"block"},onError:fe=>{fe.currentTarget.onerror=null,fe.currentTarget.src="https://media.lordicon.com/icons/wired/flat/1103-check-mark.gif"}})})]}):null]})})}),i.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[R?i.jsxs("div",{children:["Draft saved: ",R,T?i.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",i.jsx("strong",{children:T})]}):null]}):null,xe?i.jsxs("div",{children:["Last published: ",xe]}):null]}),ce?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:50},onClick:()=>{ae||W(null)},children:i.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:fe=>fe.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:ce.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),i.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:r.toUpperCase()})]}),ce.mode==="confirm"?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected COs and their settings. After confirming, the Mark Manager box will be locked."}),i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f9fafb"},children:[i.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"CO"}),i.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:Be}),i.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max marks"})]})}),i.jsxs("tbody",{children:[Object.entries(pe).filter(([fe,be])=>De.has(String(fe))&&!!(be!=null&&be.enabled)).map(([fe,be])=>({co:Fr(Number(fe),1,5),expCount:Fr(Number((be==null?void 0:be.expCount)??0),0,12),expMax:Fr(Number((be==null?void 0:be.expMax)??0),0,100)})).sort((fe,be)=>fe.co-be.co).map(fe=>i.jsxs("tr",{children:[i.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",fe.co]}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:fe.expCount}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:fe.expMax})]},fe.co)),Object.entries(pe).filter(([fe,be])=>De.has(String(fe))&&!!(be!=null&&be.enabled)).length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,style:{padding:10,color:"#6b7280"},children:"No COs selected."})}):null,nt?i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CIA Exam"}),i.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:Ge?"Enabled":"Disabled"})]}):null]})]})})]}):i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. The Mark Manager will remain locked until IQAC approves."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{className:"obe-btn",disabled:ae,onClick:()=>W(null),children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:ae||!e,onClick:async()=>{if(!e)return;if(ce.mode==="request"){he(!0),ke(null);try{const be=ee,He=pe;if(be&&be.sheet&&be.sheet.coConfigs){const Fe=Jt(Kr(be.sheet),He),st=ht(be.sheet.rowsByStudentId,[...Fe.removed,...Fe.changed]);if((Fe.removed.length||Fe.changed.length||Fe.added.length)&&st>0){Qe({visible:!0,diff:Fe,affected:st,mode:"request"}),he(!1);return}}W(null),await Rt()}finally{he(!1)}return}const fe=fr(at.sheet.markManagerSnapshot??null);if(fe){const be=gt(fe),He=gt(pe),Fe=be.filter(st=>!He.includes(st));if(Fe.length){const st=Fr(Number(a??1),1,5),It=s==null?null:Fr(Number(s),1,5),Nt=Or(at.sheet.rowsByStudentId,Fe,st,It);vt({visible:!0,removed:Fe,affected:Nt});return}}await Gt("none")},children:ce.mode==="confirm"?"Confirm":"Send Request"})]})]})}):null,Ve&&Ve.visible?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:90},onClick:()=>{ae||Qe(null)},children:i.jsxs("div",{style:{width:"min(640px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:fe=>fe.stopPropagation(),children:[i.jsx("div",{style:{fontWeight:900,marginBottom:8},children:"Mark Manager conflict with published marks"}),i.jsxs("div",{style:{color:"#374151",marginBottom:12},children:["The selected CO settings differ from the published mark sheet. ",Ve.affected," student rows contain marks that may be lost."]}),i.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Added COs:"})," ",Ve.diff.added.join(", ")||""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Removed COs:"})," ",Ve.diff.removed.join(", ")||""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Changed COs:"})," ",Ve.diff.changed.join(", ")||""]})]}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"obe-btn",onClick:()=>Qe(null),disabled:ae,children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-danger",disabled:ae,onClick:async()=>{if(e){he(!0);try{const fe=at,be=Object.fromEntries(Object.entries(fe.sheet.rowsByStudentId||{}).map(([Fe,st])=>{var Br;const It=st&&typeof st=="object"?st:{},Nt=Fr(Number(fe.sheet.expCountA??ba),0,12),or=Fr(Number(fe.sheet.expCountB??0),0,12),nr={...It};nr.marksA=Array.from({length:Nt},()=>""),nr.marksB=Array.from({length:or},()=>""),nr.caaExamByCo={},nr.ciaExam="";const Er=nr.marksByCo&&typeof nr.marksByCo=="object"?{...nr.marksByCo}:{};for(const Hr of[...Ve.diff.removed.map(String),...Ve.diff.changed.map(String)])Er[Hr]&&(Er[Hr]=Array.from({length:((Br=pe[Hr])==null?void 0:Br.expCount)??0},()=>""));return nr.marksByCo=Er,[Fe,nr]})),He={sheet:{...fe.sheet,rowsByStudentId:be}};if(er(He),await li(r,String(e),He),N(new Date().toLocaleString()),Ve.mode==="request")Qe(null),W(null),await Rt();else{try{await Zf(r,String(e),t),ur({silent:!0})}catch(Fe){console.warn("confirmMarkManagerLock failed after reset",Fe)}Qe(null)}}catch(fe){alert((fe==null?void 0:fe.message)||"Failed to reset marks")}finally{he(!1)}}},children:"Reset & Continue"})]})]})}):null,Tt&&Tt.visible?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:95},onClick:()=>{ae||vt(null)},children:i.jsxs("div",{style:{width:"min(660px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:fe=>fe.stopPropagation(),children:[i.jsx("div",{style:{fontWeight:900,marginBottom:8},children:Tt.removed.length===1?`Shall I reset the CO${Tt.removed[0]} column?`:"Shall I reset the removed CO columns?"}),i.jsxs("div",{style:{color:"#374151",marginBottom:10},children:["The new Mark Manager selection removed old COs.",Tt.affected>0?` ${Tt.affected} student rows contain marks in these columns.`:" No marks were found in these columns."]}),i.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:i.jsxs("div",{children:[i.jsx("strong",{children:"Removed COs:"})," ",Tt.removed.join(", ")||""]})}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[i.jsx("button",{className:"obe-btn",onClick:()=>vt(null),disabled:ae,children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-primary",disabled:ae,onClick:async()=>{const fe=Tt.removed;vt(null),await Gt("partial",fe)},children:Tt.removed.length===1?`Reset CO${Tt.removed[0]} column`:"Reset removed CO columns"}),i.jsx("button",{className:"obe-btn obe-btn-danger",disabled:ae,onClick:async()=>{vt(null),await Gt("full")},children:"Reset full data"})]})]})}):null,V?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>{H||K(!1)},children:i.jsxs("div",{style:{width:"min(560px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:fe=>fe.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Edit Request"}),i.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),i.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Subject:"})," ",n]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Code:"})," ",String(e||"")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Published:"})," ",xe||""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Saved:"})," ",R||""]})]}),i.jsx("textarea",{value:E,onChange:fe=>Z(fe.target.value),placeholder:"Reason (optional)",rows:4,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),i.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[i.jsx("button",{type:"button",className:"obe-btn",disabled:H,onClick:()=>K(!1),children:"Cancel"}),i.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:H||!e,onClick:Pe,children:H?"Requesting":"Send Request"})]})]})}):null,de?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:70},onClick:()=>ne(!1),children:i.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflow:"auto",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:fe=>fe.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),i.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[n,"  ",String(e||"")]}),i.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:()=>ne(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),X?i.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,q?i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:q}):null,i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,position:"relative"},children:(()=>{const fe=3+Vt+1+kr+At+Ke.length*2;return i.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:on,tableLayout:"fixed",borderCollapse:"collapse"},children:[ma(fe,!1,Ur),i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsx("th",{style:ut,colSpan:fe,children:n})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...ut,...gn(0,mt)},rowSpan:5,children:"S.No"}),i.jsx("th",{style:{...ut,...gn(mt,_t)},rowSpan:5,children:"R.No"}),i.jsx("th",{style:{...ut,...gn(mt+_t,cr),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),i.jsx("th",{style:ut,colSpan:Vt,children:"Experiments"}),i.jsx("th",{style:{...ut,width:pr,minWidth:pr,maxWidth:pr},rowSpan:5,children:"AVG"}),Ge?je?i.jsx("th",{style:ut,colSpan:Math.max(Ar,1),children:"CAA EXAM"}):i.jsx("th",{style:{...ut,width:Dr,minWidth:Dr,maxWidth:Dr,whiteSpace:"pre-line",overflow:"visible",textOverflow:"clip",lineHeight:1.05},rowSpan:5,title:"CIA Exam",children:`CIA
EXAM`}):null,i.jsx("th",{style:ut,colSpan:At,children:"CO ATTAINMENT"}),Ke.length?i.jsx("th",{style:ut,colSpan:Ke.length*2,children:"BTL ATTAINMENT"}):null]}),i.jsxs("tr",{children:[bt===0?i.jsx("th",{style:ut,children:""}):i.jsx(i.Fragment,{children:ft.map(be=>Array.from({length:be.expCount},(He,Fe)=>i.jsx("th",{style:ut,children:be.coNumber},`co_view_${be.coNumber}_${Fe}`)))}),Ge&&je?Ar>0?gr.map(be=>i.jsxs("th",{style:ut,children:["CO-",be.coNumber]},`caa_co_view_${be.coNumber}`)):i.jsx("th",{style:ut,children:""}):null,Ft?ft.map(be=>i.jsxs("th",{style:ut,colSpan:2,children:["CO-",be.coNumber]},`coatt_view_${be.coNumber}`)):i.jsx("th",{style:ut,colSpan:2,children:""}),Ke.map(be=>i.jsxs("th",{style:ut,colSpan:2,children:["BTL-",be]},`btl_view_${be}`))]}),i.jsxs("tr",{children:[bt===0?i.jsx("th",{style:ut,children:""}):i.jsx(i.Fragment,{children:ft.map(be=>Array.from({length:be.expCount},(He,Fe)=>i.jsx("th",{style:ut,children:be.expMax},`max_view_${be.coNumber}_${Fe}`)))}),Ge&&je?Ar>0?gr.map(be=>i.jsx("th",{style:ut,children:xf[be.coNumber]??0},`caa_max_view_${be.coNumber}`)):i.jsx("th",{style:ut,children:""}):null,Ft?ft.map(be=>{const He=Number(hp[be.coNumber]||0),Fe=je&&He>0?He:be.expMax+(Ge?yf/2:0);return i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:ut,children:Fe}),i.jsx("th",{style:ut,children:"%"})]},`comax_view_${be.coNumber}`)}):i.jsxs(i.Fragment,{children:[i.jsx("th",{style:ut,children:""}),i.jsx("th",{style:ut,children:"%"})]}),Ke.map(be=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:ut,children:Ut||Ca}),i.jsx("th",{style:ut,children:"%"})]},`btlmax_view_${be}`))]}),i.jsxs("tr",{children:[bt===0?i.jsx("th",{style:ut,children:"No experiments"}):i.jsx(i.Fragment,{children:ft.map(be=>Array.from({length:be.expCount},(He,Fe)=>i.jsxs("th",{style:ut,children:["E",Fe+1]},`e_view_${be.coNumber}_${Fe}`)))}),i.jsx("th",{style:ut,colSpan:At+Ke.length*2+(Ge&&je?Math.max(Ar,1):0)})]}),i.jsxs("tr",{children:[bt===0?i.jsx("th",{style:ut,children:"BTL"}):i.jsx(i.Fragment,{children:ft.map(be=>Array.from({length:be.expCount},(He,Fe)=>i.jsx("th",{style:ut,children:be.btl[Fe]||1},`btlhdr_view_${be.coNumber}_${Fe}`)))}),i.jsx("th",{style:ut,colSpan:At+Ke.length*2+(Ge&&je?Math.max(Ar,1):0)})]})]}),i.jsxs("tbody",{children:[b.map((be,He)=>{var Ee,Ze;const Fe=ee&&ee.sheet?ee.sheet:at.sheet,st=(Ee=Fe==null?void 0:Fe.rowsByStudentId)==null?void 0:Ee[String(be.id)],It=st==null?void 0:st.ciaExam,Nt=Ge&&typeof It=="number"&&Number.isFinite(It)?It:null,or=pp(st==null?void 0:st.caaExamByCo),nr=st==null?void 0:st.marksByCo,Er=ft.map(lt=>{const St=nr&&typeof nr=="object"?nr[String(lt.coNumber)]:void 0,Zt=lt.coNumber===Ce?st==null?void 0:st.marksA:lt.coNumber===it?st==null?void 0:st.marksB:void 0,tr=Ci(St??Zt,lt.expCount);return{coNumber:lt.coNumber,marks:tr}}),Br=Er.flatMap(lt=>lt.marks),Hr=Rg(Br),O=Hr!=null||Ge&&Nt!=null,le=Ft?ft.map(lt=>{var Fn;const St=((Fn=Er.find(On=>On.coNumber===lt.coNumber))==null?void 0:Fn.marks)??[],Zt=Fr(Number(lt.expCount??0),0,12),tr=Fr(Number(lt.expMax??Ca),0,100),jr=Zt*tr,zt=jk(St);if(je&&Number.isFinite(Number(hp[lt.coNumber]))){const On=Number(_k[lt.coNumber]||0),Jn=Number(kk[lt.coNumber]||0),Kn=Number(xf[lt.coNumber]||0),wa=Number(hp[lt.coNumber]||0),es=jr>0?zt/jr*On:0,Ya=or[String(lt.coNumber)],ra=typeof Ya=="number"&&Number.isFinite(Ya)?Ya:0,Yn=Kn>0?ra/Kn*Jn:0,Ra=O?es+Yn:null;return{coNumber:lt.coNumber,mark:Ra,coMax:wa}}const dr=Rg(St),en=O?(dr??0)+(Ge?(Nt??0)/2:0):null,mn=Sk[`co${lt.coNumber}`],Gn=(ye&&Number.isFinite(Number(mn))?Number(mn):lt.expMax)+(Ge?yf/2:0);return{coNumber:lt.coNumber,mark:en,coMax:Gn}}):[],Le={};for(const lt of Ke){const St=[];for(const Zt of ft){const tr=((Ze=Er.find(jr=>jr.coNumber===Zt.coNumber))==null?void 0:Ze.marks)??[];for(let jr=0;jr<Math.min(Zt.expCount,tr.length);jr++)if(Zt.btl[jr]===lt){const zt=tr[jr];typeof zt=="number"&&Number.isFinite(zt)&&St.push(zt)}}Le[lt]=St.length?St.reduce((Zt,tr)=>Zt+tr,0)/St.length:null}return i.jsxs("tr",{children:[i.jsx("td",{style:{...Lt,...ea(0,mt),textAlign:"center"},children:He+1}),i.jsx("td",{style:{...Lt,...ea(mt,_t)},title:String(be.reg_no||""),children:pL(be.reg_no,7)}),i.jsx("td",{style:{...Lt,...ea(mt+_t,cr)},title:String(be.name||""),children:i.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(be.name||"")})}),bt===0?i.jsx("td",{style:{...Lt,textAlign:"center",color:"#6b7280"},children:""}):ft.map(lt=>{var Zt;const St=((Zt=Er.find(tr=>tr.coNumber===lt.coNumber))==null?void 0:Zt.marks)??[];return Array.from({length:lt.expCount},(tr,jr)=>i.jsx("td",{style:{...Lt,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:St[jr]??""},`view_m_${be.id}_${lt.coNumber}_${jr}`))}),i.jsx("td",{style:{...Lt,width:pr,minWidth:0,textAlign:"right",fontWeight:800},children:Hr==null?"":Hr.toFixed(1)}),Ge?je?Ar>0?gr.map(lt=>i.jsx("td",{style:{...Lt,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:or[String(lt.coNumber)]??""},`view_caa_${be.id}_${lt.coNumber}`)):i.jsx("td",{style:{...Lt,textAlign:"center",color:"#6b7280"},children:""}):i.jsx("td",{style:{...Lt,width:Dr,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:(st==null?void 0:st.ciaExam)??""}):null,Ft?le.map(lt=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Lt,textAlign:"right"},children:lt.mark==null?"":lt.mark.toFixed(1)}),i.jsx("td",{style:{...Lt,textAlign:"right"},children:Db(lt.mark,lt.coMax)})]},`view_coatt_${be.id}_${lt.coNumber}`)):i.jsxs(i.Fragment,{children:[i.jsx("td",{style:{...Lt,textAlign:"right"}}),i.jsx("td",{style:{...Lt,textAlign:"right"}})]}),Ke.map(lt=>{const St=Le[lt]??null;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Lt,textAlign:"right"},children:St==null?"":St.toFixed(1)}),i.jsx("td",{style:{...Lt,textAlign:"right"},children:Db(St,Ut||Ca)})]},`view_btl_${be.id}_${lt}`)})]},`view_${be.id}`)}),b.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:pt,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})()}),i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{type:"button",className:"obe-btn",onClick:()=>ne(!1),children:"Close"})})]})}):null]})}const txe=[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:16},{key:"q8",label:"Q8",max:16},{key:"q9",label:"Q9",max:16}];function $b(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function rxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),a=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function nxe(e){return String(e??"").trim().toLowerCase().replace(/\s+/g," ")}function axe({subjectId:e,classType:t,teachingAssignmentId:r,questionPaperType:n}){const a=x.useMemo(()=>[1,2,3,4,5,6],[]),s=Me=>{const yt=String(Me??"AL").trim().toUpperCase();return yt==="ML"||yt==="MALPRACTICE"?"ML":yt==="SKL"||yt==="SICK"||yt==="SICKLEAVE"||yt==="SL"?"SKL":"AL"},o={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},l={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},c=32,[u,d]=x.useState([]),[f,p]=x.useState(!1),[h,m]=x.useState(null),[g,b]=x.useState(null),[y,v]=x.useState(!1),[w,_]=x.useState(!1),[C,j]=x.useState(!1),[A,M]=x.useState(null),[P,R]=x.useState(null),[N,T]=x.useState(null),[B,G]=x.useState(null),[re,xe]=x.useState(!1),[_e,V]=x.useState(null),K=x.useRef(!1),[de,ne]=x.useState(!1),E=x.useRef(!1),[Z,H]=x.useState(!1),[F,ee]=x.useState(null),[z,X]=x.useState(null),[J,q]=x.useState({}),[Y,L]=x.useState({}),[U,ce]=x.useState(null),[W,ae]=x.useState(""),[he,ze]=x.useState(!1),[ke,qe]=x.useState(null),[Ie,Ve]=x.useState(!1),[Qe,Tt]=x.useState(""),[vt,Xe]=x.useState(!1),[Be,ct]=x.useState(!1),nt=x.useRef(null),[Se,Te]=x.useState(!1),Dt=x.useMemo(()=>In(t),[t]),wt=Dt==="THEORY",Pt=Dt==="TCPL"||Dt==="TCPR",Wt=Dt==="TCPR"?"TCPR":"TCPL",{data:Ot,loading:Ht,error:Pr,remainingSeconds:jt,publishAllowed:ur,refresh:Ir}=dh({assessment:"model",subjectCode:e,teachingAssignmentId:r}),{data:Rr,refresh:Nr}=fh({assessment:"model",subjectCode:String(e||""),teachingAssignmentId:r,options:{poll:!1}}),{data:zr,refresh:_n}=Ul({assessment:"model",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:r,options:{poll:!1}}),Yr=!!N||!!(Rr!=null&&Rr.exists&&(Rr!=null&&Rr.is_published))||!!B,pn=!!(zr!=null&&zr.allowed_by_approval),ge=Yr?pn:!0,Ne=!!(Yr&&!pn),dt=!!(Ot!=null&&Ot.global_override_active&&(Ot==null?void 0:Ot.global_is_open)===!1),Ue=!!(dt||Yr&&!ge);x.useEffect(()=>{ct(!1)},[e,r,Ne]);const Re=x.useMemo(()=>`model_qp_type_${e}_${String(r??"none")}`,[e,r]),[xt,at]=x.useState("");x.useEffect(()=>{const Me=He=>{const Fe=String(He??"").trim().toUpperCase();return Fe==="QP2"?"QP2":Fe==="QP1"?"QP1":""},yt=Me(n);if(yt){at(yt);try{Sn(Re,yt)}catch{}return}const fe=Pn(Re),be=Me(fe);at(be||"QP1")},[Re,n]);const er=String(xt??"").trim().toUpperCase();x.useEffect(()=>{let Me=!0;return(async()=>{var Fe;let fe=String(Dt||"").trim().toUpperCase();if(fe.startsWith("THEORY")&&(fe="THEORY"),!fe){ce(null);return}const be=er==="QP2"?"QP2":er==="QP1"?"QP1":"",He=fe==="THEORY"&&be||null;try{const st=await Gf({class_type:fe,question_paper_type:He,exam:"MODEL"}),It=Array.isArray((Fe=st==null?void 0:st.pattern)==null?void 0:Fe.marks)?st.pattern.marks:[];if(!Me)return;ce(It.length?st.pattern:null)}catch{if(!Me)return;ce(null)}})(),()=>{Me=!1}},[Dt,er]);const oe=x.useMemo(()=>{const Me=Array.isArray(U==null?void 0:U.marks)?U.marks:null;return Array.isArray(Me)&&Me.length?Me.map((yt,fe)=>({key:`q${fe+1}`,label:`Q${fe+1}`,max:Number(yt)||0})):txe},[U]),ue=4+oe.length+1+4+a.length*2,Q=Pt?J||{}:Y||{},ye={width:"100%",border:"none",outline:"none",background:"transparent",padding:0,margin:0,fontSize:11,textAlign:"center"},je=async Me=>{const yt=!!(Me!=null&&Me.silent);if(!r){d([]),yt||m(null);return}yt||p(!0),yt||m(null);try{try{const Fe=await mr(`/api/academics/teaching-assignments/${r}/`);if(Fe.ok){const st=await Fe.json();if(st&&st.elective_subject_id&&!st.section_id){const It=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(st.elective_subject_id))}`);if(!It.ok)throw new Error(`Elective-choices fetch failed: ${It.status}`);const Nt=await It.json(),Er=((Array.isArray(Nt.results)?Nt.results:Array.isArray(Nt)?Nt:Nt.items||[])||[]).map(Br=>({id:Number(Br.student_id??Br.id),reg_no:String(Br.reg_no??Br.registration_no??Br.regno??""),name:String(Br.name??Br.full_name??Br.username??""),section:Br.section_name??Br.section??null})).filter(Br=>Number.isFinite(Br.id)).sort((Br,Hr)=>String(Br.name||"").localeCompare(String(Hr.name||"")));d(Er);return}}}catch{}const fe=await Ac(r),He=[...(fe==null?void 0:fe.students)||[]].sort((Fe,st)=>String(Fe.name||"").localeCompare(String(st.name||"")));d(He)}catch(fe){d([]),yt||m((fe==null?void 0:fe.message)||"Failed to load roster")}finally{yt||p(!1)}};x.useEffect(()=>{je()},[r]);const Ce=()=>({version:1,qpType:String(xt??""),classType:String(Dt??""),tcplLikeKind:Wt,theoryQuestionBtl:rt||{},tcplQuestionBtl:Xt||{},theorySheet:Y||{},tcplSheet:J||{}}),ot=Me=>{if(!Me||typeof Me!="object")return;E.current=!0;const yt=typeof Me.qpType=="string"?Me.qpType:null;if(yt!=null){const be=String(yt||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";at(be);try{Sn(Re,be)}catch{}}if(Me.theoryQuestionBtl&&typeof Me.theoryQuestionBtl=="object"){Rt({...kt,...Me.theoryQuestionBtl});try{Sn(rr,{...kt,...Me.theoryQuestionBtl})}catch{}}if(Me.tcplQuestionBtl&&typeof Me.tcplQuestionBtl=="object"){ie({...xr,...Me.tcplQuestionBtl});try{Sn(Tr,{...xr,...Me.tcplQuestionBtl})}catch{}}if(Me.tcplSheet&&typeof Me.tcplSheet=="object"){q(Me.tcplSheet);try{Sn(se,Me.tcplSheet)}catch{}}if(Me.theorySheet&&typeof Me.theorySheet=="object"){L(Me.theorySheet);try{Sn(ve,Me.theorySheet)}catch{}}window.setTimeout(()=>{E.current=!1},0)},it=async Me=>{if(!e)return;const yt=!!(Me!=null&&Me.silent);yt||j(!0),yt||b(null);try{const fe=await Mn("model",e,r);fe!=null&&fe.draft&&ot(fe.draft),M(fe!=null&&fe.updated_at?new Date(fe.updated_at).toLocaleString():null);const be=fe==null?void 0:fe.updated_by;R(typeof(be==null?void 0:be.name)=="string"?be.name:typeof(be==null?void 0:be.username)=="string"?be.username:null)}catch(fe){yt||b((fe==null?void 0:fe.message)||"Failed to refresh draft")}finally{yt||j(!1)}};x.useEffect(()=>{ne(!1);let Me=!0;return(async()=>{try{await it({silent:!0})}finally{Me&&ne(!0)}})(),()=>{Me=!1}},[e,r]);const We=async()=>{j(!0),b(null);try{await Promise.all([je({silent:!0}),it({silent:!0}),Ir({silent:!0}),Nr({silent:!0})]);try{await ft(!1)}catch{}}catch(Me){b((Me==null?void 0:Me.message)||"Refresh failed")}finally{j(!1)}},De=()=>{try{Sn(Re,String(xt??"")),Sn(rr,rt),Sn(Tr,Xt),Sn(se,J),Sn(ve,Y),alert("Saved locally.")}catch(Me){alert((Me==null?void 0:Me.message)||"Local save failed")}},pe=async()=>{if(e){v(!0),b(null);try{await li("model",e,Ce()),M(new Date().toLocaleString())}catch(Me){b((Me==null?void 0:Me.message)||"Draft save failed")}finally{v(!1)}}},Je=async()=>{if(e){if(Yr){if(Ne){Ve(!0);return}b("Editing is already open for this published sheet.");return}if(dt){b("Publishing is locked by IQAC.");return}if(!ur){b("Publish window is closed. Please request IQAC approval.");return}_(!0),b(null);try{await d9(e,Ce(),r),T(new Date().toLocaleString()),await ft(!1),Ir({silent:!0}),Nr({silent:!0});try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:"model"}}))}catch{}}catch(Me){b((Me==null?void 0:Me.message)||"Publish failed")}finally{_(!1)}}},Ge=async()=>{if(e){ze(!0),qe(null),b(null);try{await R0({assessment:"model",subject_code:e,reason:W,teaching_assignment_id:r}),qe("Request sent to IQAC for approval.")}catch(Me){b((Me==null?void 0:Me.message)||"Failed to request approval")}finally{ze(!1),Ir({silent:!0})}}},Ye=async()=>{if(e){Xe(!0),b(null);try{await qo({assessment:"model",subject_code:String(e),scope:"MARK_ENTRY",reason:Qe||`Edit request: MODEL marks entry for ${e}`,teaching_assignment_id:r}),alert("Edit request sent to IQAC. Waiting for approval..."),Ve(!1),Tt(""),Nr({silent:!0}),_n({silent:!0})}catch(Me){b((Me==null?void 0:Me.message)||"Failed to request edit")}finally{Xe(!1)}}};async function ft(Me,yt){if(e){Me&&xe(!0),V(null);try{const fe=await Am(String(e),r),be=(fe==null?void 0:fe.data)??null;!!(be&&typeof be=="object"&&Number(be.version)===1&&(typeof be.classType=="string"||typeof be.qpType=="string")&&("theorySheet"in be||"tcplSheet"in be))?(G(be),(yt!=null&&yt.applyToMain||Ne)&&ot(be)):(G(null),(Me||yt!=null&&yt.applyToMain)&&V("No published snapshot found."))}catch(fe){(Me||yt!=null&&yt.applyToMain)&&V((fe==null?void 0:fe.message)||"Failed to load published sheet")}finally{Me&&xe(!1)}}}x.useEffect(()=>{e&&ft(!1)},[e,r]),x.useEffect(()=>{if(e){if(!Ne){K.current=!1;return}if(!K.current){if(K.current=!0,B&&typeof B=="object"){ot(B);return}ft(!0,{applyToMain:!0})}}},[Ne,e,r]),x.useEffect(()=>{if(!e||!Yr||ge)return;const Me=window.setInterval(()=>{Nr({silent:!0})},3e4);return()=>window.clearInterval(Me)},[ge,Yr,e,Nr]);const bt=x.useMemo(()=>u.length?u:Array.from({length:5},(Me,yt)=>({id:-(yt+1),reg_no:"",name:"",section:null})),[u]),Vt=x.useMemo(()=>Object.values(Q||{}).some(yt=>!!(yt!=null&&yt.absent)),[Q]),Ft=x.useMemo(()=>{const Me=Array.isArray(U==null?void 0:U.marks)?U.marks:null;if(Array.isArray(Me)&&Me.length&&Pt)return Me.map((be,He)=>({key:`q${He+1}`,label:`Q${He+1}`,max:Number(be)||0}));const yt=Wt==="TCPR"?12:15,fe=Wt==="TCPR"?8:10;return Array.from({length:yt},(be,He)=>{const Fe=He+1;return{key:`q${Fe}`,label:`Q${Fe}`,max:Fe<=fe?2:16}})},[Wt,U,Pt]),gr=x.useMemo(()=>Ft.reduce((Me,yt)=>Me+yt.max,0),[Ft]),Ar=30,kr=Wt==="TCPR",At=5,Ut=kr?0:Ar/At,Kr=Wt==="TCPR"?"REVIEW":"LAB",$t=x.useMemo(()=>{const Me=Array.isArray(U==null?void 0:U.marks)?U.marks:null;return Array.isArray(Me)&&Me.length&&wt?Me.map((yt,fe)=>({key:`q${fe+1}`,label:`Q${fe+1}`,max:Number(yt)||0})):[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:2},{key:"q8",label:"Q8",max:2},{key:"q9",label:"Q9",max:2},{key:"q10",label:"Q10",max:2},{key:"q11",label:"Q11",max:14},{key:"q12",label:"Q12",max:14},{key:"q13",label:"Q13",max:14},{key:"q14",label:"Q14",max:14},{key:"q15",label:"Q15",max:14},{key:"q16",label:"Q16",max:10}]},[U,wt]),fr=5,Or=x.useMemo(()=>$t.reduce((Me,yt)=>Me+yt.max,0),[$t]),gt=x.useMemo(()=>{const Me=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],yt=Array.isArray(U==null?void 0:U.cos)?U.cos:null;return wt&&Array.isArray(yt)&&yt.length===$t.length?yt.map(fe=>{const be=Number(fe);return Number.isFinite(be)?Math.max(1,Math.min(5,Math.trunc(be))):1}):$t.length===Me.length?Me:Array.from({length:$t.length},(fe,be)=>Me[be%Me.length])},[U,wt,$t.length]),Jt=x.useMemo(()=>{const Me=[2,2,3,3,3,2,2,3,3,3,4,4,3,3,3,5];return $t.length===Me.length?Me:Array.from({length:$t.length},(yt,fe)=>Me[fe%Me.length])},[$t.length]),ht=x.useMemo(()=>{const Me=Array.from({length:fr},()=>0);return $t.forEach((yt,fe)=>{const be=gt[fe]??1;be>=1&&be<=fr&&(Me[be-1]+=yt.max)}),Me},[$t,gt]),Ct=x.useMemo(()=>ht,[ht]),rr=x.useMemo(()=>`model_theory_questionBtl_${e}`,[e]),kt=x.useMemo(()=>Object.fromEntries($t.map((Me,yt)=>{const fe=Jt[yt];return[Me.key,typeof fe=="number"?fe:""]})),[$t,Jt]),[rt,Rt]=x.useState(kt);x.useEffect(()=>{if(!wt)return;const Me=Pn(rr);Rt(Me&&typeof Me=="object"?{...kt,...Me}:kt)},[wt,rr,kt]);const Gt=(Me,yt)=>{Rt(fe=>{const be={...fe||{},[Me]:yt};return Sn(rr,be),be})},ir=x.useMemo(()=>$t.map((Me,yt)=>{const fe=(rt||{})[Me.key];if(fe===""||fe===1||fe===2||fe===3||fe===4||fe===5||fe===6)return fe;const be=Jt[yt];return typeof be=="number"?be:""}),[$t,rt,Jt]),Bt=x.useMemo(()=>{const Me=[0,0,0,0,0,0];return $t.forEach((yt,fe)=>{const be=ir[fe];typeof be=="number"&&be>=1&&be<=6&&(Me[be-1]+=yt.max)}),Me},[$t,ir]),vr=x.useMemo(()=>{const Me=Wt==="TCPR"?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5],yt=Array.isArray(U==null?void 0:U.cos)?U.cos:null;return Pt&&Array.isArray(yt)&&yt.length===Ft.length?yt.map(fe=>{const be=Number(fe);return Number.isFinite(be)?Math.max(1,Math.min(5,Math.trunc(be))):1}):Ft.length===Me.length?Me:Array.from({length:Ft.length},(fe,be)=>Me[be%Me.length])},[U,Pt,Wt,Ft.length]),Cr=Wt==="TCPR"?"tcpr":"tcpl",Tr=x.useMemo(()=>`model_${Cr}_questionBtl_${e}`,[e,Cr]),xr=x.useMemo(()=>Object.fromEntries(Ft.map(Me=>[Me.key,""])),[Ft]),[Xt,ie]=x.useState(xr);x.useEffect(()=>{if(!Pt)return;const Me=Pn(Tr);ie(Me&&typeof Me=="object"?{...xr,...Me}:xr)},[Pt,Tr,xr]);const I=(Me,yt)=>{ie(fe=>{const be={...fe||{},[Me]:yt};return Sn(Tr,be),be})},se=x.useMemo(()=>`model_${Cr}_sheet_${e}_${String(r??"none")}`,[e,r,Cr]);x.useEffect(()=>{if(!Pt)return;const Me=Pn(se);q(Me&&typeof Me=="object"?Me:{})},[Pt,se]);const ve=x.useMemo(()=>`model_theory_sheet_${e}_${String(r??"none")}`,[e,r]);x.useEffect(()=>{if(Pt)return;const Me=Pn(ve);L(Me&&typeof Me=="object"?Me:{})},[Pt,ve]);const Pe=(Me,yt)=>{q(fe=>{const be={...fe||{},[Me]:yt};return Sn(se,be),be})},Ke=(Me,yt)=>{L(fe=>{const be={...fe||{},[Me]:yt};return Sn(ve,be),be})},pt=Me=>{if(Pt){q(Me),Sn(se,Me);return}L(Me),Sn(ve,Me)};x.useEffect(()=>{if(!de||!e||Ne||E.current)return;let Me=!1;const yt=window.setTimeout(async()=>{try{await li("model",e,Ce()),Me||M(new Date().toLocaleString())}catch{}},700);return()=>{Me=!0,window.clearTimeout(yt)}},[de,e,r,Ne,xt,Dt,rt,Xt,Y,J]);const ut=(Me,yt)=>{const fe=String(Me??"");if(fe.trim()==="")return"";const be=Number(fe);return Number.isFinite(be)?Math.max(0,Math.min(yt,be)):""},Lt=Me=>{const fe=(Math.round((Me+Number.EPSILON)*10)/10).toFixed(1);return fe.endsWith(".0")?fe.slice(0,-2):fe},Sr=()=>Pt?Ft:$t,hr=()=>{const Me=Sr(),yt=(u||[]).map((be,He)=>{const Fe=Qr(be,He),st=(Q||{})[Fe]||{},It=st.q&&typeof st.q=="object"?st.q:{},Nt={sno:He+1,registerNo:String(be.reg_no||""),name:String(be.name||""),absent:st.absent?"YES":"",absentKind:st.absent?s(st.absentKind):""};if(Me.forEach(or=>{const nr=It[or.key],Er=Number(nr);Nt[or.label]=Number.isFinite(Er)?Math.max(0,Math.min(or.max,Er)):""}),Pt){const or=Number(st.lab);Nt[Kr]=Number.isFinite(or)?Math.max(0,Math.min(Ar,or)):""}return Nt}),fe=Pt?String(Dt||"TCPL"):"THEORY";rxe(`${$b(e)}_MODEL_${$b(fe)}.csv`,yt)},mt=()=>{const Me=Sr();if(!u.length)return;const yt=["Register No","Student Name",...Me.map(It=>`${It.label} (${It.max})`)];Pt&&yt.push(`${Kr} (${Ar})`),yt.push("Status","Absence Kind");const fe=u.map(It=>{const Nt=[String(It.reg_no||""),String(It.name||"")],or=Me.map(()=>"");return Pt?[...Nt,...or,"","present","AL"]:[...Nt,...or,"present","AL"]}),be=ds.aoa_to_sheet([yt,...fe]);be["!freeze"]={xSplit:0,ySplit:1};const He=ds.book_new();ds.book_append_sheet(He,be,"MODEL");const Fe=Pt?String(Dt||"TCPL"):"THEORY",st=`${$b(e)}_MODEL_${$b(Fe)}_template.xlsx`;ty(He,st)},_t=()=>{var Me;Ne||(Me=nt.current)==null||Me.click()},cr=async Me=>{var yt;if(Me){Te(!0);try{const fe=Sr(),be=await Me.arrayBuffer(),He=v0(be,{type:"array"}),Fe=(yt=He.SheetNames)==null?void 0:yt[0];if(!Fe)throw new Error("No sheet found in the Excel file.");const st=He.Sheets[Fe],It=ds.sheet_to_json(st,{header:1});if(!It.length)throw new Error("Excel sheet is empty.");const Nt=(It[0]||[]).map(nxe),or=Ee=>Nt.findIndex(Ze=>Ee(Ze)),nr=or(Ee=>Ee==="register no"||Ee==="reg no"||Ee.includes("register")),Er=or(Ee=>Ee==="status"||Ee.includes("status")),Br=or(Ee=>Ee==="absence kind"||Ee==="absent kind"||Ee==="kind");if(nr<0)throw new Error("Could not find Register No column.");const Hr=fe.map(Ee=>{const Ze=String(Ee.label||"").toLowerCase(),lt=or(St=>St===Ze||St.startsWith(Ze));return{q:Ee,col:lt}}),O=Pt?or(Ee=>Ee===String(Kr||"").toLowerCase()||Ee.startsWith(String(Kr||"").toLowerCase())):-1,le=new Map;u.forEach((Ee,Ze)=>{const lt=String(Ee.reg_no||"").trim();lt&&le.set(lt,Qr(Ee,Ze))});const Le={...Q||{}};for(let Ee=1;Ee<It.length;Ee++){const Ze=It[Ee]||[],lt=String(Ze[nr]??"").trim();if(!lt)continue;const St=le.get(lt);if(!St)continue;const Zt=Le[St]||{},tr={...Zt.q||{}};Hr.forEach(({q:vn,col:Gn})=>{if(Gn<0)return;const Fn=Ze[Gn],On=Number(Fn);tr[vn.key]=Number.isFinite(On)?Math.max(0,Math.min(vn.max,On)):""});const jr=Er>=0?String(Ze[Er]??"").trim().toLowerCase():"",zt=jr==="absent"||jr==="ab"||jr==="a",dr=Br>=0?Ze[Br]:"AL",en=s(dr),mn={...Zt,q:tr,absent:zt,absentKind:en};if(Pt&&O>=0){const vn=Number(Ze[O]);mn.lab=Number.isFinite(vn)?Math.max(0,Math.min(Ar,vn)):""}Le[St]=mn}pt(Le)}finally{Te(!1)}}},sr=async Me=>{var fe;const yt=(fe=Me.target.files)==null?void 0:fe[0];if(Me.target.value="",!!yt)try{await cr(yt)}catch(be){alert((be==null?void 0:be.message)||"Failed to import Excel")}},pr=x.useMemo(()=>{const Me=Array.from({length:At},()=>0);return Ft.forEach((yt,fe)=>{const be=vr[fe]??1;be>=1&&be<=At&&(Me[be-1]+=yt.max)}),Me},[Ft,vr,At]),Dr=x.useMemo(()=>kr?pr.map((Me,yt)=>yt===4?Ar:Me):pr.map(Me=>Me+Ut),[pr,Ut,kr,Ar]),qr=x.useMemo(()=>{const Me=[0,0,0,0,0,0];return Ft.forEach(yt=>{const fe=(Xt||{})[yt.key]??"";typeof fe=="number"&&fe>=1&&fe<=6&&(Me[fe-1]+=yt.max)}),Me},[Ft,Xt]),Ur=x.useMemo(()=>{const Me=new Set;return Ft.forEach(yt=>{const fe=(Xt||{})[yt.key]??"";(fe===1||fe===2||fe===3||fe===4||fe===5||fe===6)&&Me.add(fe)}),Me.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(yt=>Me.has(yt))},[Ft,Xt]),Qr=(Me,yt)=>{const fe=Me==null?void 0:Me.id;if(typeof fe=="number"&&fe>0)return`id:${fe}`;const be=String((Me==null?void 0:Me.reg_no)||"").trim();return be?`reg:${be}`:`idx:${yt}`},on=x.useRef({}),gn=Me=>yt=>{on.current[Me]=yt},ea=Me=>{const yt=on.current[Me];if(yt){yt.focus();try{yt.select()}catch{}}},ma=4+Ft.length+1+1+At*2+Ur.length*2,ga=x.useMemo(()=>{const Me=new Set;return $t.forEach(yt=>{const fe=(rt||{})[yt.key]??"";(fe===1||fe===2||fe===3||fe===4||fe===5||fe===6)&&Me.add(fe)}),Me.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(yt=>Me.has(yt))},[$t,rt]),ta=4+$t.length+1+fr*2+ga.length*2,Tn=x.useMemo(()=>Z?bt.filter((Me,yt)=>{var be;const fe=Qr(Me,yt);return F&&F.length?F.includes(fe):!!((be=(Q||{})[fe])!=null&&be.absent)}):bt,[bt,Z,Q,F]);return i.jsxs("div",{children:[z?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>X(null),children:i.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:Me=>Me.stopPropagation(),children:[i.jsx("div",{style:{fontWeight:900,marginBottom:6},children:z.title}),i.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:z.message}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{className:"obe-btn",onClick:()=>X(null),children:"Close"})})]})}):null,i.jsxs("div",{style:{marginBottom:10,color:"#6b7280",fontSize:12},children:["Subject: ",i.jsx("b",{children:e})," | Assessment: ",i.jsx("b",{children:"MODEL"}),Dt?i.jsxs(i.Fragment,{children:[" ","| Class: ",i.jsx("b",{children:Dt})]}):null," ","| QP: ",i.jsx("b",{children:er||"QP1"})]}),f?i.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,h?i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:h}):null,g?i.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fed7aa",color:"#9a3412",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:g}):null,i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:10},children:[i.jsx("button",{onClick:pe,className:"obe-btn obe-btn-success",disabled:y||!e||Ne,title:Ne?"Published sheets are locked (IQAC must open editing).":void 0,children:y?"Saving":"Save Draft"}),i.jsx("button",{onClick:De,className:"obe-btn",disabled:!e||Ne,children:"Save"}),i.jsx("button",{onClick:hr,className:"obe-btn obe-btn-secondary",disabled:!u.length,children:"Export CSV"}),i.jsx("button",{onClick:mt,className:"obe-btn obe-btn-secondary",disabled:!u.length,children:"Export Excel"}),i.jsx("button",{onClick:_t,className:"obe-btn obe-btn-secondary",disabled:!u.length||Ne||Se,children:Se?"Importing":"Import Excel"}),i.jsx("input",{ref:nt,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:sr}),i.jsx("button",{onClick:We,className:"obe-btn",disabled:C||!e,children:C?"Refreshing":"Refresh"}),i.jsx("button",{onClick:Je,className:"obe-btn obe-btn-primary",disabled:w||u.length===0||!ur||Ue||dt,title:u.length===0?"No students in roster":ur?dt?"Publishing locked by IQAC":void 0:"Publish window is closed.",children:w?"Publishing":Yr?"Edit Request":"Publish"})]}),i.jsx("div",{style:{marginBottom:10,fontSize:12,color:ur?"#065f46":"#b91c1c"},children:Ht?"Checking publish due time":Pr||(Ot!=null&&Ot.due_at?i.jsxs(i.Fragment,{children:["Due: ",new Date(Ot.due_at).toLocaleString(),"  Remaining: ",D0(jt)]}):"Due time not set by IQAC.")}),dt?i.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Locked by IQAC"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Publishing is currently locked globally by IQAC."})]}):ur?null:i.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish window closed"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Request IQAC approval to open the publish window."}),i.jsx("textarea",{value:W,onChange:Me=>ae(Me.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),i.jsx("div",{style:{marginTop:10,display:"flex",gap:8,flexWrap:"wrap"},children:i.jsx("button",{className:"obe-btn obe-btn-success",onClick:Ge,disabled:he||!e,children:he?"Requesting":"Request Approval"})}),ke?i.jsx("div",{style:{marginTop:10,fontSize:12,color:"#065f46"},children:ke}):null]}),i.jsxs("div",{style:{marginBottom:10,display:"flex",gap:12,flexWrap:"wrap"},children:[i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),i.jsx("div",{style:{fontWeight:700},children:A||""}),P?i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",i.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:P})]}):null]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),i.jsx("div",{style:{fontWeight:700},children:N||""}),i.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("button",{className:"obe-btn",disabled:!Yr||!e,onClick:()=>ft(!0,{applyToMain:!0}),title:Yr?void 0:"Publish first to view the published snapshot.",children:re?"Loading":"View Published"}),i.jsx("button",{className:"obe-btn",onClick:()=>Nr(),disabled:!e,children:"Refresh Lock"})]}),_e?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:_e}):null]})]}),Ne?i.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Published & locked"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Editing and auto-save are disabled until IQAC opens the edit window."})]}):null,Ie?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:80},onClick:()=>Ve(!1),children:i.jsxs("div",{style:{width:"min(520px, 96vw)",background:"#fff",borderRadius:16,border:"1px solid #e5e7eb",padding:14,boxShadow:"0 12px 30px rgba(0,0,0,0.18)"},onClick:Me=>Me.stopPropagation(),children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Edit Request"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:6},children:"This will send an edit request to IQAC for published MODEL marks. Once approved, the entry will open for editing until the approval expires."}),i.jsx("textarea",{value:Qe,onChange:Me=>Tt(Me.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical",marginTop:10}}),i.jsxs("div",{style:{marginTop:10,display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{className:"obe-btn",disabled:vt,onClick:()=>Ve(!1),children:"Close"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:vt||!e,onClick:Ye,children:vt?"Sending":"Send Request"})]})]})}):null,i.jsx(i.Fragment,{children:i.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:10},children:i.jsxs("button",{className:"obe-btn",disabled:!Vt,onClick:()=>{if(Z)return;const Me=(bt||[]).map((yt,fe)=>{var be;return{key:Qr(yt,fe),isAbsent:!!((be=(Q||{})[Qr(yt,fe)])!=null&&be.absent)}}).filter(yt=>yt.isAbsent).map(yt=>yt.key);ee(Me),H(!0)},title:Vt?"Filter the table to show only absentees":"No absentees marked yet",style:Z?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",Z?i.jsx("span",{onClick:Me=>{Me.stopPropagation(),H(!1),ee(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]})})}),i.jsxs("div",{style:{position:"relative",minHeight:Ne&&!Be?220:void 0},children:[Yr&&Ne?i.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.24) 100%)"}}):null,Yr&&Ne?i.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,background:"#fff",border:"1px solid #e5e7eb",padding:"10px 14px",borderRadius:999,display:"flex",alignItems:"center",gap:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",pointerEvents:"auto",maxWidth:"min(720px, 96vw)"},children:[i.jsx("div",{style:{width:34,height:34,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #f59e0b33",color:"#92400e"},"aria-hidden":"true",children:i.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[i.jsx("path",{d:"M7 11V8a5 5 0 0 1 10 0v3",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),i.jsx("path",{d:"M6 11h12a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2Z",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),i.jsxs("div",{style:{minWidth:0},children:[i.jsx("div",{style:{fontWeight:900,fontSize:18,color:"#111827",lineHeight:1.1},children:"Published  Locked"}),i.jsx("div",{style:{fontSize:13,color:"#6b7280",marginTop:2},children:re?"Loading published marks":_e||"Marks are published. IQAC approval is required to edit."})]}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("button",{className:"obe-btn",disabled:!Yr||!e,onClick:async()=>{ct(Me=>!Me);try{await ft(!0,{applyToMain:!0})}catch{}},title:Yr?void 0:"Publish first to view the published snapshot.",children:re?"Loading":"View"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e,onClick:()=>Ve(!0),title:"Ask IQAC to open editing for published marks",children:"Edit"})]})]}):null,i.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:i.jsx("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto",pointerEvents:Ne?"none":void 0,opacity:Ne?.78:1,display:Ne&&!Be?"none":void 0},children:Pt?i.jsxs(i.Fragment,{children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:o,colSpan:ma,children:["MODEL (",Dt||"TCPL"," Header Template)"]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),i.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),i.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),i.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"AB"}),Ft.map(Me=>i.jsx("th",{style:{...o,width:40,minWidth:40},children:Me.label},Me.key)),i.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),i.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:Kr}),i.jsx("th",{style:o,colSpan:At*2,children:"CO ATTAINMENT"}),i.jsx("th",{style:o,colSpan:Ur.length*2,children:"BTL ATTAINMENT"})]}),i.jsxs("tr",{children:[i.jsx("th",{style:{...o,fontWeight:800},colSpan:Ft.length,children:"COS"}),i.jsx("th",{style:o,colSpan:At*2,children:""}),i.jsx("th",{style:o,colSpan:Ur.length*2,children:""})]}),i.jsxs("tr",{children:[vr.map((Me,yt)=>i.jsx("th",{style:{...o,width:40,minWidth:40},children:Me},`co-map-${yt}`)),Array.from({length:At}).map((Me,yt)=>i.jsxs("th",{style:o,colSpan:2,children:["CO-",yt+1]},`co-head-${yt}`)),Ur.map(Me=>i.jsxs("th",{style:o,colSpan:2,children:["BTL-",Me]},`btl-head-${Me}`))]}),i.jsxs("tr",{children:[i.jsx("th",{style:{...o,fontWeight:800},colSpan:Ft.length,children:"BTL"}),i.jsx("th",{style:o,children:""}),i.jsx("th",{style:o,children:""}),Array.from({length:At+Ur.length}).flatMap((Me,yt)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:{...o,minWidth:52},children:i.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),i.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`mkpct-${yt}`))]}),i.jsxs("tr",{children:[Ft.map(Me=>{const yt=(Xt||{})[Me.key]??"",fe=yt===""?"-":String(yt);return i.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:i.jsxs("div",{style:{position:"relative",minWidth:40},children:[i.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${fe}`,children:fe}),i.jsxs("select",{"aria-label":`BTL for ${Me.label}`,value:yt,onChange:be=>I(Me.key,be.target.value===""?"":Number(be.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[i.jsx("option",{value:"",children:"-"}),i.jsx("option",{value:"1",children:"1"}),i.jsx("option",{value:"2",children:"2"}),i.jsx("option",{value:"3",children:"3"}),i.jsx("option",{value:"4",children:"4"}),i.jsx("option",{value:"5",children:"5"}),i.jsx("option",{value:"6",children:"6"})]})]})},`btl-map-${Me.key}`)}),i.jsx("th",{style:o,children:""}),i.jsx("th",{style:o,children:""}),Array.from({length:At*2+Ur.length*2}).map((Me,yt)=>i.jsx("th",{style:o,children:""},`tailblank-${yt}`))]}),i.jsxs("tr",{children:[i.jsx("th",{style:o,children:"S.No"}),i.jsx("th",{style:o,children:"Register No."}),i.jsx("th",{style:o,children:"Name / Max Marks"}),i.jsx("th",{style:o,children:""}),Ft.map(Me=>i.jsx("th",{style:{...o,width:40,minWidth:40},children:Me.max},`qmax-${Me.key}`)),i.jsx("th",{style:o,children:gr}),i.jsx("th",{style:o,children:"30"}),Dr.flatMap((Me,yt)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:o,children:Lt(Me)}),i.jsx("th",{style:o,children:"%"})]},`co-max-mm-${yt}`)),Ur.flatMap(Me=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:o,children:Lt(qr[Me-1]||0)}),i.jsx("th",{style:o,children:"%"})]},`btl-max-mm-${Me}`))]})]}),i.jsx("tbody",{children:Tn.map((Me,yt)=>i.jsx("tr",{children:(()=>{const fe=Qr(Me,yt),be=(J||{})[fe]||{},He=!!be.absent,Fe=be.lab??"",st=He?s(be.absentKind):null,It=!!(Z&&He&&(st==="ML"||st==="SKL")),Nt=He&&st==="AL"?0:null,or=He&&st==="ML"?60:He&&st==="SKL"?75:null,nr={};Ft.forEach(zt=>{const dr=(be.q||{})[zt.key]??"",en=typeof dr=="number"&&Number.isFinite(dr)?dr:0;nr[zt.key]=Math.max(0,Math.min(zt.max,en))});const Er=typeof Fe=="number"&&Number.isFinite(Fe)?Math.max(0,Math.min(Ar,Fe)):0,Br=Object.values(nr).reduce((zt,dr)=>zt+dr,0),Hr=Array.from({length:At},()=>0);if(Ft.forEach((zt,dr)=>{const en=vr[dr]??1;en>=1&&en<=At&&(Hr[en-1]+=nr[zt.key]||0)}),kr)Hr[4]+=Er;else for(let zt=0;zt<At;zt++)Hr[zt]+=Er/At;const O=Hr.map((zt,dr)=>{const en=Dr[dr]||0;return en?zt/en*100:0}),le=[0,0,0,0,0,0];Ft.forEach(zt=>{const dr=(Xt||{})[zt.key]??"";typeof dr=="number"&&dr>=1&&dr<=6&&(le[dr-1]+=nr[zt.key]||0)});const Le=le.map((zt,dr)=>{const en=qr[dr]||0;return en?zt/en*100:0}),Ee=zt=>{if(zt){Pe(fe,{...be,absent:!0,absentKind:s(be.absentKind),q:Object.fromEntries(Ft.map(dr=>[dr.key,""])),lab:""});return}Pe(fe,{...be,absent:!1,absentKind:void 0})},Ze=zt=>{Pe(fe,{...be,absent:!0,absentKind:s(zt)})},lt=zt=>{He&&!It||Pe(fe,{...be,lab:ut(zt,Ar)})},St=(zt,dr,en)=>{if(He&&!It)return;const mn=ut(dr,en),vn={...be.q||{},[zt]:mn};if(or!=null&&Ft.reduce((Fn,On)=>{const Jn=vn[On.key]??"",Kn=typeof Jn=="number"&&Number.isFinite(Jn)?Jn:0;return Fn+Math.max(0,Math.min(On.max,Kn))},0)>or){X({title:"Mark limit exceeded",message:st==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}Pe(fe,{...be,q:vn})},Zt=[...Ft.map(zt=>zt.key),"lab"],tr=(zt,dr)=>{const en=Zt.indexOf(zt),mn=dr==="left"?Math.max(0,en-1):dr==="right"?Math.min(Zt.length-1,en+1):en,vn=dr==="up"?Math.max(0,yt-1):dr==="down"?Math.min(Tn.length-1,yt+1):yt,Fn=`${Qr(Tn[vn],vn)}|${Zt[mn]}`;ea(Fn)},jr=zt=>dr=>{dr.key==="Tab"?(dr.preventDefault(),tr(zt,dr.shiftKey?"left":"right")):dr.key==="ArrowLeft"?(dr.preventDefault(),tr(zt,"left")):dr.key==="ArrowRight"?(dr.preventDefault(),tr(zt,"right")):dr.key==="ArrowUp"||dr.key==="Enter"&&dr.shiftKey?(dr.preventDefault(),tr(zt,"up")):(dr.key==="ArrowDown"||dr.key==="Enter")&&(dr.preventDefault(),tr(zt,"down"))};return i.jsxs(i.Fragment,{children:[i.jsx("td",{style:{...l,textAlign:"center"},children:yt+1}),i.jsx("td",{style:l,children:Me.reg_no||""}),i.jsx("td",{style:l,children:Me.name||""}),i.jsx("td",{style:{...l,textAlign:"center"},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:He,onChange:zt=>Ee(zt.target.checked)}),He?i.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[i.jsx("span",{className:"obe-ios-select-value",children:st||"AL"}),i.jsxs("select",{"aria-label":"Absent type",value:st||"AL",onChange:zt=>Ze(s(zt.target.value)),children:[i.jsx("option",{value:"AL",children:"AL"}),i.jsx("option",{value:"ML",children:"ML"}),i.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),Ft.map(zt=>{const dr=(be.q||{})[zt.key]??"",en=`${fe}|${zt.key}`;return i.jsx("td",{style:{...l,textAlign:"center"},children:i.jsx("input",{ref:gn(en),type:"text",inputMode:"decimal",disabled:He&&!It,value:dr===""?"":String(dr),onChange:mn=>St(zt.key,mn.target.value,zt.max),onFocus:mn=>mn.currentTarget.select(),onKeyDown:jr(zt.key),style:ye})},`${yt}-${zt.key}`)}),i.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:Lt(Nt??Br)}),i.jsx("td",{style:{...l,textAlign:"center"},children:i.jsx("input",{ref:gn(`${fe}|lab`),type:"text",inputMode:"decimal",disabled:He&&!It,value:Fe===""?"":String(Fe),onChange:zt=>lt(zt.target.value),onFocus:zt=>zt.currentTarget.select(),onKeyDown:jr("lab"),style:ye})}),Hr.flatMap((zt,dr)=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...l,textAlign:"center"},children:Lt(zt)}),i.jsx("td",{style:{...l,textAlign:"center"},children:Lt(O[dr])})]},`co-${yt}-${dr}`)),Ur.flatMap(zt=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...l,textAlign:"center"},children:Lt(le[zt-1]||0)}),i.jsx("td",{style:{...l,textAlign:"center"},children:Lt(Le[zt-1]||0)})]},`btl-${yt}-${zt}`))]})})()},String(Me.id??yt)))})]}):i.jsx(i.Fragment,{children:wt?i.jsxs(i.Fragment,{children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsx("th",{style:o,colSpan:ta,children:"MODEL (THEORY Header Template)"})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),i.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),i.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),i.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"ABSENT"}),$t.map(Me=>i.jsx("th",{style:{...o,width:40,minWidth:40},children:Me.label},Me.key)),i.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),i.jsx("th",{style:o,colSpan:fr*2,children:"CO ATTAINMENT"}),i.jsx("th",{style:o,colSpan:ga.length*2,children:"BTL ATTAINMENT"})]}),i.jsxs("tr",{children:[i.jsx("th",{style:{...o,fontWeight:800},colSpan:$t.length,children:"COs"}),i.jsx("th",{style:o,colSpan:fr*2,children:""}),i.jsx("th",{style:o,colSpan:ga.length*2,children:""})]}),i.jsxs("tr",{children:[gt.map((Me,yt)=>i.jsx("th",{style:{...o,width:40,minWidth:40},children:Me},`theory-co-map-${yt}`)),Array.from({length:fr}).map((Me,yt)=>i.jsxs("th",{style:o,colSpan:2,children:["CO-",yt+1]},`theory-co-head-${yt}`)),ga.map(Me=>i.jsxs("th",{style:o,colSpan:2,children:["BTL-",Me]},`theory-btl-head-${Me}`))]}),i.jsxs("tr",{children:[i.jsx("th",{style:{...o,fontWeight:800},colSpan:$t.length,children:"BTL"}),i.jsx("th",{style:o,children:""}),Array.from({length:fr+ga.length}).flatMap((Me,yt)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:{...o,minWidth:52},children:i.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),i.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`theory-mkpct-${yt}`))]}),i.jsxs("tr",{children:[$t.map((Me,yt)=>{const fe=(rt||{})[Me.key]??"",be=fe===""?"-":String(fe);return i.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:i.jsxs("div",{style:{position:"relative",minWidth:40},children:[i.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${be}`,children:be}),i.jsxs("select",{"aria-label":`BTL for ${Me.label}`,value:fe,onChange:He=>Gt(Me.key,He.target.value===""?"":Number(He.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[i.jsx("option",{value:"",children:"-"}),i.jsx("option",{value:"1",children:"1"}),i.jsx("option",{value:"2",children:"2"}),i.jsx("option",{value:"3",children:"3"}),i.jsx("option",{value:"4",children:"4"}),i.jsx("option",{value:"5",children:"5"}),i.jsx("option",{value:"6",children:"6"})]})]})},`theory-btl-map-${Me.key}`)}),i.jsx("th",{style:o,children:""}),Array.from({length:fr*2+ga.length*2}).map((Me,yt)=>i.jsx("th",{style:o,children:""},`theory-tailblank-${yt}`))]}),i.jsxs("tr",{children:[i.jsx("th",{style:o,children:"S.No"}),i.jsx("th",{style:o,children:"Register No."}),i.jsx("th",{style:o,children:"Name / Max Marks"}),i.jsx("th",{style:o,children:""}),$t.map(Me=>i.jsx("th",{style:{...o,width:40,minWidth:40},children:Me.max},`theory-qmax-${Me.key}`)),i.jsx("th",{style:o,children:Or}),Ct.flatMap((Me,yt)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:o,children:Lt(Me)}),i.jsx("th",{style:o,children:"%"})]},`theory-co-max-mm-${yt}`)),ga.flatMap(Me=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:o,children:Lt(Bt[Me-1]||0)}),i.jsx("th",{style:o,children:"%"})]},`theory-btl-max-mm-${Me}`))]})]}),i.jsx("tbody",{children:Tn.map((Me,yt)=>i.jsx("tr",{children:(()=>{const fe=Qr(Me,yt),be=(Q||{})[fe]||{},He=!!be.absent,Fe=He?s(be.absentKind):null,st=!!(Z&&He&&(Fe==="ML"||Fe==="SKL")),It=He&&Fe==="AL"?0:null,Nt=He&&Fe==="ML"?60:He&&Fe==="SKL"?75:null,or={};$t.forEach(Ze=>{const lt=(be.q||{})[Ze.key]??"",St=typeof lt=="number"&&Number.isFinite(lt)?lt:0;or[Ze.key]=Math.max(0,Math.min(Ze.max,St))});const nr=Object.values(or).reduce((Ze,lt)=>Ze+lt,0),Er=Array.from({length:fr},()=>0);$t.forEach((Ze,lt)=>{const St=gt[lt]??1;St>=1&&St<=fr&&(Er[St-1]+=or[Ze.key]||0)});const Br=Er.map((Ze,lt)=>{const St=Ct[lt]||0;return St?Ze/St*100:0}),Hr=[0,0,0,0,0,0];$t.forEach((Ze,lt)=>{const St=ir[lt];typeof St=="number"&&St>=1&&St<=6&&(Hr[St-1]+=or[Ze.key]||0)});const O=Hr.map((Ze,lt)=>{const St=Bt[lt]||0;return St?Ze/St*100:0}),le=Ze=>{if(Ze){Ke(fe,{...be,absent:!0,absentKind:s(be.absentKind),q:Object.fromEntries($t.map(lt=>[lt.key,""]))});return}Ke(fe,{...be,absent:!1,absentKind:void 0})},Le=Ze=>{Ke(fe,{...be,absent:!0,absentKind:s(Ze)})},Ee=(Ze,lt,St)=>{if(He&&!st)return;const Zt=ut(lt,St),tr={...be.q||{},[Ze]:Zt};if(Nt!=null&&$t.reduce((zt,dr)=>{const en=tr[dr.key]??"",mn=typeof en=="number"&&Number.isFinite(en)?en:0;return zt+Math.max(0,Math.min(dr.max,mn))},0)>Nt){X({title:"Mark limit exceeded",message:Fe==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}Ke(fe,{...be,q:tr})};return i.jsxs(i.Fragment,{children:[i.jsx("td",{style:{...l,textAlign:"center"},children:yt+1}),i.jsx("td",{style:l,children:Me.reg_no||""}),i.jsx("td",{style:l,children:Me.name||""}),i.jsx("td",{style:{...l,textAlign:"center"},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:He,onChange:Ze=>le(Ze.target.checked)}),He?i.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[i.jsx("span",{className:"obe-ios-select-value",children:Fe||"AL"}),i.jsxs("select",{"aria-label":"Absent type",value:Fe||"AL",onChange:Ze=>Le(s(Ze.target.value)),children:[i.jsx("option",{value:"AL",children:"AL"}),i.jsx("option",{value:"ML",children:"ML"}),i.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),$t.map(Ze=>{const lt=(be.q||{})[Ze.key]??"",St=`${fe}|${Ze.key}`,Zt=$t.map(zt=>zt.key),tr=(zt,dr)=>{const en=Math.max(0,Zt.indexOf(zt)),mn=dr==="left"?Math.max(0,en-1):dr==="right"?Math.min(Zt.length-1,en+1):en,vn=dr==="up"?Math.max(0,yt-1):dr==="down"?Math.min(Tn.length-1,yt+1):yt,Gn=Qr(Tn[vn],vn);ea(`${Gn}|${Zt[mn]}`)},jr=zt=>dr=>{dr.key==="Tab"?(dr.preventDefault(),tr(zt,dr.shiftKey?"left":"right")):dr.key==="ArrowLeft"?(dr.preventDefault(),tr(zt,"left")):dr.key==="ArrowRight"?(dr.preventDefault(),tr(zt,"right")):dr.key==="ArrowUp"||dr.key==="Enter"&&dr.shiftKey?(dr.preventDefault(),tr(zt,"up")):(dr.key==="ArrowDown"||dr.key==="Enter")&&(dr.preventDefault(),tr(zt,"down"))};return i.jsx("td",{style:{...l,textAlign:"center"},children:i.jsx("input",{ref:gn(St),type:"text",inputMode:"decimal",disabled:He&&!st,value:lt===""?"":String(lt),onChange:zt=>Ee(Ze.key,zt.target.value,Ze.max),onFocus:zt=>zt.currentTarget.select(),onKeyDown:jr(Ze.key),style:ye})},`${yt}-${Ze.key}`)}),i.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:Lt(It??nr)}),Er.flatMap((Ze,lt)=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...l,textAlign:"center"},children:Lt(Ze)}),i.jsx("td",{style:{...l,textAlign:"center"},children:Lt(Br[lt])})]},`theory-co-${yt}-${lt}`)),ga.flatMap(Ze=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...l,textAlign:"center"},children:Lt(Hr[Ze-1]||0)}),i.jsx("td",{style:{...l,textAlign:"center"},children:Lt(O[Ze-1]||0)})]},`theory-btl-${yt}-${Ze}`))]})})()},String(Me.id??yt)))})]}):i.jsxs(i.Fragment,{children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsx("th",{style:o,colSpan:ue,children:"MODEL (Blank Template)"})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:3,children:"S.No"}),i.jsx("th",{style:{...o,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),i.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),i.jsx("th",{style:{...o,minWidth:32},rowSpan:3,children:"AB"}),i.jsx("th",{style:o,colSpan:oe.length,children:"QUESTIONS"}),i.jsx("th",{style:o,rowSpan:3,children:"Total"}),i.jsx("th",{style:o,colSpan:4,children:"CO ATTAINMENT"}),i.jsx("th",{style:o,colSpan:a.length*2,children:"BTL ATTAINMENT"})]}),i.jsxs("tr",{children:[oe.map(Me=>i.jsx("th",{style:{...o,width:46,minWidth:46},children:Me.label},Me.key)),i.jsx("th",{style:o,colSpan:2,children:"CO-1"}),i.jsx("th",{style:o,colSpan:2,children:"CO-2"}),a.map(Me=>i.jsxs("th",{style:o,colSpan:2,children:["BTL-",Me]},`btl-head-${Me}`))]}),i.jsxs("tr",{children:[oe.map(Me=>i.jsx("th",{style:{...o,width:46,minWidth:46},children:Me.max},Me.key)),Array.from({length:2+a.length}).flatMap((Me,yt)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:{...o,minWidth:52},children:i.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),i.jsx("th",{style:{...o,minWidth:34},children:"%"})]},yt))]})]}),i.jsx("tbody",{children:Tn.map((Me,yt)=>i.jsxs("tr",{children:[(()=>{const fe=Qr(Me,yt),be=(Q||{})[fe]||{},He=!!be.absent,Fe=He?s(be.absentKind):null,st=!!(Z&&He&&(Fe==="ML"||Fe==="SKL")),It=He&&Fe==="AL"?0:null,Nt=He&&Fe==="ML"?60:He&&Fe==="SKL"?75:null,or={};oe.forEach(O=>{const le=(be.q||{})[O.key]??"",Le=typeof le=="number"&&Number.isFinite(le)?le:0;or[O.key]=Math.max(0,Math.min(O.max,Le))});const nr=Object.values(or).reduce((O,le)=>O+le,0),Er=O=>{if(O){Ke(fe,{...be,absent:!0,absentKind:s(be.absentKind),q:Object.fromEntries(oe.map(le=>[le.key,""]))});return}Ke(fe,{...be,absent:!1,absentKind:void 0})},Br=O=>{Ke(fe,{...be,absent:!0,absentKind:s(O)})},Hr=(O,le,Le)=>{if(He&&!st)return;const Ee=ut(le,Le),Ze={...be.q||{},[O]:Ee};if(Nt!=null&&oe.reduce((St,Zt)=>{const tr=Ze[Zt.key]??"",jr=typeof tr=="number"&&Number.isFinite(tr)?tr:0;return St+Math.max(0,Math.min(Zt.max,jr))},0)>Nt){X({title:"Mark limit exceeded",message:Fe==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}Ke(fe,{...be,q:Ze})};return i.jsxs(i.Fragment,{children:[i.jsx("td",{style:{...l,textAlign:"center"},children:yt+1}),i.jsx("td",{style:l,children:Me.reg_no||""}),i.jsx("td",{style:l,children:Me.name||""}),i.jsx("td",{style:{...l,textAlign:"center"},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[i.jsx("input",{type:"checkbox",checked:He,onChange:O=>Er(O.target.checked)}),He?i.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[i.jsx("span",{className:"obe-ios-select-value",children:Fe||"AL"}),i.jsxs("select",{"aria-label":"Absent type",value:Fe||"AL",onChange:O=>Br(s(O.target.value)),children:[i.jsx("option",{value:"AL",children:"AL"}),i.jsx("option",{value:"ML",children:"ML"}),i.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),oe.map(O=>{const le=(be.q||{})[O.key]??"",Le=`${fe}|${O.key}`,Ee=oe.map(St=>St.key),Ze=(St,Zt)=>{const tr=Math.max(0,Ee.indexOf(St)),jr=Zt==="left"?Math.max(0,tr-1):Zt==="right"?Math.min(Ee.length-1,tr+1):tr,zt=Zt==="up"?Math.max(0,yt-1):Zt==="down"?Math.min(Tn.length-1,yt+1):yt,dr=Qr(Tn[zt],zt);ea(`${dr}|${Ee[jr]}`)},lt=St=>Zt=>{Zt.key==="Tab"?(Zt.preventDefault(),Ze(St,Zt.shiftKey?"left":"right")):Zt.key==="ArrowLeft"?(Zt.preventDefault(),Ze(St,"left")):Zt.key==="ArrowRight"?(Zt.preventDefault(),Ze(St,"right")):Zt.key==="ArrowUp"||Zt.key==="Enter"&&Zt.shiftKey?(Zt.preventDefault(),Ze(St,"up")):(Zt.key==="ArrowDown"||Zt.key==="Enter")&&(Zt.preventDefault(),Ze(St,"down"))};return i.jsx("td",{style:{...l,textAlign:"center"},children:i.jsx("input",{ref:gn(Le),type:"text",inputMode:"decimal",disabled:He&&!st,value:le===""?"":String(le),onChange:St=>Hr(O.key,St.target.value,O.max),onFocus:St=>St.currentTarget.select(),onKeyDown:lt(O.key),style:ye})},`${yt}-${O.key}`)}),i.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:Lt(It??nr)})]})})(),i.jsx("td",{style:{...l,textAlign:"center"},children:""}),i.jsx("td",{style:{...l,textAlign:"center"},children:""}),i.jsx("td",{style:{...l,textAlign:"center"},children:""}),i.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.flatMap(fe=>i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...l,textAlign:"center"},children:""}),i.jsx("td",{style:{...l,textAlign:"center"},children:""})]},`${yt}-btl-${fe}`))]},String(Me.id??yt)))})]})})})})]})]})}function Ak({subjectId:e,teachingAssignmentId:t,assessmentKey:r,viewerMode:n}){const a=r==="cia1"?{label:"CIA 1 Review",coA:1,coB:2}:r==="cia2"?{label:"CIA 2 Review",coA:3,coB:4}:{label:"MODEL Review",coA:5,coB:null};return i.jsx(Bv,{subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:!0,floatPanelOnTable:!0,label:a.label,coA:a.coA,coB:a.coB,viewerMode:!!n,itemLabel:"Content",itemLabelPlural:"Content",itemAbbrev:"C",ciaExamAvailable:!0,absentEnabled:!0,autoSaveDraft:!0})}const ixe=20,mL={co1:10,co2:10},mp={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},Tp=10;function Gs(e,t,r){return Math.max(t,Math.min(r,e))}function Al(e){return Math.round(e*10)/10}function tl(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Iv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function gp(e,t,r){const n=e==null?void 0:e.btlMax,a=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Iv(a);return s??r}function sxe(e){const t=Number(e);return Number.isFinite(t)&&t>0?t:Tp}function oxe(e,t){return`${t}_sheet_${e}`}function gL(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function lxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),a=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function cxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const a=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=a.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Nk(e){return e.slice(-8)}function _z({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa1"}){var xr,Xt,ie;const a=String(r||"SSA1"),s=n==="review1",o=!1,l=x.useMemo(()=>oxe(e,n),[e,n]),c=n==="review1"?dS:Vm,u=n==="review1"?o9:s9,[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),b=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),y=((xr=d==null?void 0:d.assessments)==null?void 0:xr.ssa1)||{},v=Number.isFinite(Number(y==null?void 0:y.maxTotal))?Number(y.maxTotal):ixe,w=s?30:v,_={co1:Number.isFinite(Number((Xt=y==null?void 0:y.coMax)==null?void 0:Xt.co1))?Number(y.coMax.co1):mL.co1,co2:Number.isFinite(Number((ie=y==null?void 0:y.coMax)==null?void 0:ie.co2))?Number(y.coMax.co2):mL.co2},C=s?{co1:15,co2:15}:_,j={btl1:gp(y,1,mp.btl1),btl2:gp(y,2,mp.btl2),btl3:gp(y,3,mp.btl3),btl4:gp(y,4,mp.btl4),btl5:gp(y,5,mp.btl5),btl6:gp(y,6,mp.btl6)},A=s?30:Tp,M=x.useRef(null),[P,R]=x.useState(!1);x.useEffect(()=>{let I=!0;return(async()=>{try{const se=await iu();if(!I)return;f(se||null),g(ve=>({...ve,termLabel:String((se==null?void 0:se.termLabel)||ve.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{I=!1}},[e]);const[N,T]=x.useState(!1),[B,G]=x.useState(null),[re,xe]=x.useState(()=>s?[3,4]:[]),[_e,V]=x.useState(!1),[K,de]=x.useState(!1),[ne,E]=x.useState(null),[Z,H]=x.useState(null),[F,ee]=x.useState(null),[z,X]=x.useState(null),[J,q]=x.useState(!1),[Y,L]=x.useState(null),[U,ce]=x.useState(!1),[W,ae]=x.useState(null),[he,ze]=x.useState(!1),[ke,qe]=x.useState(null),{data:Ie,loading:Ve,error:Qe,remainingSeconds:Tt,publishAllowed:vt,refresh:Xe}=dh({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:Be,loading:ct,error:nt,refresh:Se}=fh({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:Te}=Ul({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:Dt}=Ul({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),wt=!!(Ie!=null&&Ie.global_override_active&&(Ie==null?void 0:Ie.global_is_open)===!1),[Pt,Wt]=x.useState(""),[Ot,Ht]=x.useState(!1),[Pr,jt]=x.useState(null),[ur,Ir]=x.useState(null),[Rr,Nr]=x.useState(!1),[zr,_n]=x.useState(null),[Yr,pn]=x.useState(!1),ge=!!z||!!(Be!=null&&Be.exists&&(Be!=null&&Be.is_published))||!!Y,dt=!!!(e&&!Rr)&&ge,[Ue,Re]=x.useState(null);x.useEffect(()=>{Re(null),X(null),L(null),ae(null)},[e,n,t]);const xt=!!m.markManagerLocked,at=Dt!=null&&Dt.approval_until?String(Dt.approval_until):null,er=Te!=null&&Te.approval_until?String(Te.approval_until):null,oe=!!(Dt!=null&&Dt.allowed_by_approval)&&!!at&&at!==((Ue==null?void 0:Ue.markEntryApprovalUntil)??null),ue=!!(Te!=null&&Te.allowed_by_approval)&&!!er&&er!==((Ue==null?void 0:Ue.markManagerApprovalUntil)??null),Q=ge?!!(Be!=null&&Be.entry_open)||oe||ue:!0,ye=!!(ge&&!Q),je=!!e&&(ct||!!nt||Be==null),Ce=!!(wt||je||(Be?!Be.entry_open:ge?!Q:!xt)),ot=!!(wt||ye||Ce),it=m.markManagerSnapshot!=null,We=x.useMemo(()=>{const I=new Set(re);return[1,2,3,4,5,6].filter(se=>I.has(se))},[re]),De=x.useMemo(()=>8+We.length*2,[We.length,o]),pe=x.useMemo(()=>{try{return m.rows.some(I=>!!I.absent||Object.values(I).some(se=>typeof se=="string"&&String(se).toLowerCase().includes("absent")))}catch{return!1}},[m.rows]),Je=x.useMemo(()=>he?ke&&ke.length?m.rows.filter(I=>ke.includes(Number(I.studentId))):m.rows.filter(I=>!!I.absent||Object.values(I).some(se=>typeof se=="string"&&String(se).toLowerCase().includes("absent"))):m.rows,[m.rows,he,ke]);x.useEffect(()=>{if(!e)return;try{const ve=`${n}_selected_btls_${e}`;Sn(ve,re)}catch{}let I=!1;const se=setTimeout(async()=>{try{await li(n,e,{sheet:m,selectedBtls:re});try{l&&Sn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}I||H(new Date().toLocaleString())}catch{}},700);return()=>{I=!0,clearTimeout(se)}},[re,e,m,n,l]),x.useEffect(()=>{if(!e)return;const I=Pn(l);I&&typeof I=="object"&&Array.isArray(I.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(I.termLabel||"KRCT AY25-26"),batchLabel:e,rows:I.rows}):g({termLabel:b||"KRCT AY25-26",batchLabel:e,rows:[]})},[l,e,d,b]),x.useEffect(()=>{let I=!0;return(async()=>{if(e)try{const se=await Mn(n,e);if(!I)return;const ve=se==null?void 0:se.draft,Pe=ve==null?void 0:ve.sheet,Ke=ve==null?void 0:ve.selectedBtls;if(Pe&&typeof Pe=="object"&&Array.isArray(Pe.rows)){g(Lt=>({...Lt,termLabel:String(Pe.termLabel||b||"KRCT AY25-26"),batchLabel:e,rows:Pe.rows,markManagerSnapshot:(Pe==null?void 0:Pe.markManagerSnapshot)??Lt.markManagerSnapshot??null,markManagerApprovalUntil:(Pe==null?void 0:Pe.markManagerApprovalUntil)??Lt.markManagerApprovalUntil??null,markManagerLocked:typeof(Pe==null?void 0:Pe.markManagerLocked)=="boolean"?Pe.markManagerLocked:!!((Pe==null?void 0:Pe.markManagerSnapshot)??Lt.markManagerSnapshot)}));const pt=(se==null?void 0:se.updated_at)??null,ut=(se==null?void 0:se.updated_by)??null;if(pt)try{H(new Date(String(pt)).toLocaleString())}catch{H(String(pt))}ut&&ee(String(ut.name||ut.username||ut.id||""));try{l&&Sn(l,{termLabel:String(Pe.termLabel||b||"KRCT AY25-26"),batchLabel:e,rows:Pe.rows})}catch{}}if(Array.isArray(Ke)){xe(Ke.map(pt=>Number(pt)).filter(pt=>Number.isFinite(pt)));try{const pt=`${n}_selected_btls_${e}`;Sn(pt,Ke.map(ut=>Number(ut)).filter(ut=>Number.isFinite(ut)))}catch{}}}catch{}})(),()=>{I=!1}},[e,b,n,l]),x.useEffect(()=>{if(!e)return;if((!!(Be!=null&&Be.exists&&(Be!=null&&Be.is_published))||!!z)&&(Be!=null&&Be.exists)){const Pe=!!(Be!=null&&Be.mark_manager_locked);!!m.markManagerLocked!==Pe&&g(Ke=>({...Ke,markManagerLocked:Pe}));return}const se=!!(Te!=null&&Te.allowed_by_approval),ve=Te!=null&&Te.approval_until?String(Te.approval_until):null;if(se&&ve){if(ve===((Ue==null?void 0:Ue.markManagerApprovalUntil)??null))return;const Pe=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&Pe!==ve&&g(Ke=>({...Ke,markManagerLocked:!1,markManagerApprovalUntil:ve}));return}},[e,Be==null?void 0:Be.exists,Be==null?void 0:Be.mark_manager_locked,Te==null?void 0:Te.allowed_by_approval,Te==null?void 0:Te.approval_until,m.markManagerLocked,z,Ue==null?void 0:Ue.markManagerApprovalUntil,m.markManagerApprovalUntil]);const Ge=I=>{g(se=>{const ve=new Map,Pe=new Map;for(const pt of se.rows||[])typeof pt.studentId=="number"&&ve.set(pt.studentId,pt),pt.registerNo&&Pe.set(String(pt.registerNo),pt);const Ke=(I||[]).slice().sort(cxe).map(pt=>{const ut=ve.get(pt.id)||Pe.get(String(pt.reg_no||""));return{studentId:pt.id,section:String(pt.section||""),registerNo:String(pt.reg_no||""),name:String(pt.name||""),total:typeof(ut==null?void 0:ut.total)=="number"?Gs(Number(ut.total),0,w):((ut==null?void 0:ut.total)==="","")}});return{...se,rows:Ke}})},Ye=async()=>{var I,se,ve;if(!e){G("Subject ID is required.");return}T(!0),G(null);try{let Pe=[],Ke=null;try{const pt=await jc();console.log("[SSA1] My TAs:",pt==null?void 0:pt.length,"for subject:",e,"teachingAssignmentId:",t),Ke=(pt||[]).find(ut=>{const Lt=String(ut.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?ut.id===t:!1)||Lt}),Ke?console.log("[SSA1] Found TA match:",Ke.id,"elective_subject_id:",Ke.elective_subject_id,"section_id:",Ke.section_id):console.log("[SSA1] No TA match found in user TAs")}catch(pt){console.warn("[SSA1] My TAs fetch failed:",pt)}if(Ke&&Ke.elective_subject_id&&!Ke.section_id){console.log("[SSA1] Detected elective, fetching elective-choices for elective_subject_id:",Ke.elective_subject_id);try{const pt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Ke.elective_subject_id))}`);if(pt.ok){const ut=await pt.json(),Lt=Array.isArray(ut.results)?ut.results:Array.isArray(ut)?ut:ut.items||[];console.log("[SSA1] Elective choices returned:",Lt==null?void 0:Lt.length,"students"),Pe=(Lt||[]).map(Sr=>({id:Number(Sr.student_id??Sr.id),reg_no:String(Sr.reg_no??Sr.regno??""),name:String(Sr.name??Sr.full_name??Sr.username??""),section:Sr.section_name??Sr.section??null}))}else console.warn("[SSA1] Elective-choices API returned error:",pt.status)}catch(pt){console.warn("[SSA1] Elective-choices fetch failed:",pt)}}if(!Pe.length&&Ke&&Ke.id){console.log("[SSA1] Fetching regular TA roster for TA ID:",Ke.id);try{const pt=await Ac(Ke.id);Pe=pt.students||[],h({courseName:String(((I=pt==null?void 0:pt.teaching_assignment)==null?void 0:I.subject_name)||(Ke==null?void 0:Ke.subject_name)||""),courseCode:String(((se=pt==null?void 0:pt.teaching_assignment)==null?void 0:se.subject_code)||(Ke==null?void 0:Ke.subject_code)||e||""),className:String(((ve=pt==null?void 0:pt.teaching_assignment)==null?void 0:ve.section_name)||(Ke==null?void 0:Ke.section_name)||"")}),console.log("[SSA1] Regular roster returned:",Pe.length,"students")}catch(pt){console.warn("[SSA1] TA roster fetch failed:",pt)}}console.log("[SSA1] Final roster count:",Pe.length),Ge(Pe)}catch(Pe){G((Pe==null?void 0:Pe.message)||"Failed to load roster")}finally{T(!1)}};x.useEffect(()=>{e&&Ye()},[t,e]);async function ft(I){if(e){I&&ce(!0),ae(null);try{const se=await c(String(e));L(se||null)}catch(se){I&&ae((se==null?void 0:se.message)||`Failed to load published ${a} marks`)}finally{I&&ce(!1)}}}x.useEffect(()=>{e&&ft(!1)},[e,n,t]);const bt=x.useRef(!!Q);x.useEffect(()=>{bt.current=!!Q},[e,n,t,Q]),x.useEffect(()=>{if(!e||!ge)return;if(bt.current||!Q){bt.current=!!Q;return}let se=!0;return(async()=>{try{const ve=await Mn(n,String(e));if(!se)return;const Pe=ve==null?void 0:ve.draft,Ke=Pe==null?void 0:Pe.sheet,pt=Pe==null?void 0:Pe.selectedBtls;Ke&&typeof Ke=="object"&&Array.isArray(Ke.rows)&&g(ut=>({...ut,termLabel:String(Ke.termLabel||b||"KRCT AY25-26"),batchLabel:e,rows:Ke.rows,markManagerSnapshot:(Ke==null?void 0:Ke.markManagerSnapshot)??ut.markManagerSnapshot??null,markManagerApprovalUntil:(Ke==null?void 0:Ke.markManagerApprovalUntil)??ut.markManagerApprovalUntil??null,markManagerLocked:typeof(Ke==null?void 0:Ke.markManagerLocked)=="boolean"?Ke.markManagerLocked:!!((Ke==null?void 0:Ke.markManagerSnapshot)??ut.markManagerSnapshot)})),Array.isArray(pt)&&xe(pt.map(ut=>Number(ut)).filter(ut=>Number.isFinite(ut)));return}catch{}se&&ft(!1)})(),bt.current=!!Q,()=>{se=!1}},[Q,ge,e,n,b]),x.useEffect(()=>{if(!e||!ge||Q)return;const I=window.setInterval(()=>{Se({silent:!0})},3e4);return()=>window.clearInterval(I)},[Q,ge,e,Se]),x.useEffect(()=>{J&&e&&(L(null),ft(!0))},[J,e]);const Vt=async()=>{V(!0),E(null);try{await li(n,e,{sheet:m,selectedBtls:re}),H(new Date().toLocaleString())}catch(I){E((I==null?void 0:I.message)||`Failed to save ${a} draft`)}finally{V(!1)}},Ft=async()=>{if(e){if(wt){E("Publishing is locked by IQAC.");return}if(!vt){E("Publish window is closed. Please request IQAC approval.");return}de(!0),E(null);try{await u(e,m,t),X(new Date().toLocaleString()),Re({markEntryApprovalUntil:at,markManagerApprovalUntil:er}),g(I=>({...I,markManagerLocked:!0})),Xe(),Se({silent:!0}),ft(!1);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}}catch(I){E((I==null?void 0:I.message)||`Failed to publish ${a}`)}finally{de(!1)}}},gr=async()=>{Ht(!0),jt(null),E(null);try{await R0({assessment:n,subject_code:e,reason:Pt,teaching_assignment_id:t}),jt("Request sent to IQAC for approval.")}catch(I){E((I==null?void 0:I.message)||"Failed to request approval")}finally{Ht(!1),Xe()}};function Ar(I){return JSON.stringify({maxTotal:w,coMax:C,selectedBtls:re.slice(),btlMax:j})}async function kr(){if(e){Nr(!0),_n(null);try{await qo({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${a} ${e}`,teaching_assignment_id:t}),alert("Edit request sent to IQAC.")}catch(I){_n((I==null?void 0:I.message)||"Request failed"),alert((I==null?void 0:I.message)||"Request failed")}finally{Nr(!1)}}}async function At(){if(e)try{await qo({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:`Edit request: ${a} marks entry for ${e}`,teaching_assignment_id:t}),alert("Edit request sent to IQAC."),Se({silent:!0}),Xe()}catch(I){alert((I==null?void 0:I.message)||"Request failed")}}async function Ut(){if(e){Nr(!0),_n(null);try{const I=Ar(m),se=Te!=null&&Te.approval_until?String(Te.approval_until):m.markManagerApprovalUntil||null,ve={...m,markManagerLocked:!0,markManagerSnapshot:I,markManagerApprovalUntil:se},Pe={sheet:ve,selectedBtls:re};g(ve),Ir(null),pn(!0),await li(n,String(e),Pe),H(new Date().toLocaleString());try{await Zf(n,String(e),t),Se({silent:!0})}catch(Ke){console.warn("confirmMarkManagerLock failed",Ke)}}catch(I){_n((I==null?void 0:I.message)||"Save failed")}finally{Nr(!1),setTimeout(()=>pn(!1),2e3)}}}const Kr=()=>{confirm(`Reset ${a} marks for all students in this section?`)&&(Ce||g(I=>({...I,rows:(I.rows||[]).map(se=>({...se,total:""}))})))},$t=(I,se)=>{g(ve=>{const Pe=ve.rows.slice(),Ke=Pe[I]||{studentId:0,section:"",registerNo:"",name:"",total:""};return Pe[I]={...Ke,...se},{...ve,rows:Pe}})},fr=()=>{const I=m.rows.map((se,ve)=>{const Pe=typeof se.total=="number"?Gs(Number(se.total),0,w):null,Ke=Pe==null?"":Al(Pe),ut=Pe==null?null:Al(Pe/2),Lt=ut==null?null:Gs(ut,0,C.co1),Sr=ut==null?null:Gs(ut,0,C.co2),hr=We.map(Dr=>Dr-1),_t=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((Dr,qr)=>hr.includes(qr)?s?A:Dr>0?Dr:Tp:Dr),cr=Pe==null?null:hr.length?Al(Pe/hr.length):0,sr=_t.map((Dr,qr)=>Pe==null||!hr.includes(qr)?null:Dr>0?Gs(cr,0,Dr):Al(cr)),pr={sno:ve+1,registerNo:se.registerNo,name:se.name,co1_mark:Lt??"",co1_pct:tl(Lt,C.co1),co2_mark:Sr??"",co2_pct:tl(Sr,C.co2),btl1_mark:sr[0]??"",btl1_pct:tl(sr[0],_t[0]),btl2_mark:sr[1]??"",btl2_pct:tl(sr[1],_t[1]),btl3_mark:sr[2]??"",btl3_pct:tl(sr[2],_t[2]),btl4_mark:sr[3]??"",btl4_pct:tl(sr[3],_t[3]),btl5_mark:sr[4]??"",btl5_pct:tl(sr[4],_t[4]),btl6_mark:sr[5]??"",btl6_pct:tl(sr[5],_t[5])};return pr[a]=Ke,pr});lxe(`${e}_${gL(a)||"SSA1"}_sheet.csv`,I)},Or=()=>{if(!m.rows.length)return;const I=Number.isFinite(Number(C.co1))?Number(C.co1):0,se=Number.isFinite(Number(C.co2))?Number(C.co2):0,ve=["Register No","Student Name",`Q1 (${I.toFixed(2)})`,`Q2 (${se.toFixed(2)})`,"Status"],Pe=m.rows.map(Lt=>[Lt.registerNo,Lt.name,"","","present"]),Ke=ds.aoa_to_sheet([ve,...Pe]);Ke["!freeze"]={xSplit:0,ySplit:1};const pt=ds.book_new();ds.book_append_sheet(pt,Ke,a||"SSA1");const ut=`${e}_${gL(a)||"SSA1"}_template.xlsx`;ty(pt,ut)},gt=async()=>{const I=m.rows.map((se,ve)=>({sno:ve+1,regNo:String(se.registerNo||""),name:String(se.name||""),total:se.total===""?"":Number(se.total)}));await ny({filenameBase:`${e}_${a}`,meta:{courseName:(p==null?void 0:p.courseName)||"",courseCode:(p==null?void 0:p.courseCode)||e,className:(p==null?void 0:p.className)||""},rows:I})};function Jt(I){return String(I??"").trim().toLowerCase().replace(/\s+/g," ")}const ht=()=>{var I;Ce||(I=M.current)==null||I.click()},Ct=async I=>{var se;if(I){R(!0);try{const ve=await I.arrayBuffer(),Pe=v0(ve,{type:"array"}),Ke=(se=Pe.SheetNames)==null?void 0:se[0];if(!Ke)throw new Error("No sheet found in the Excel file.");const pt=Pe.Sheets[Ke],ut=ds.sheet_to_json(pt,{header:1});if(!ut.length)throw new Error("Excel sheet is empty.");const Lt=(ut[0]||[]).map(Jt),Sr=Ur=>Lt.findIndex(Qr=>Ur(Qr)),hr=Sr(Ur=>Ur==="register no"||Ur==="reg no"||Ur.includes("register")),mt=Sr(Ur=>Ur.startsWith("q1")),_t=Sr(Ur=>Ur.startsWith("q2")),cr=Sr(Ur=>Ur==="total"||Ur.includes("total")),sr=Sr(Ur=>Ur==="status"||Ur.includes("status"));if(hr<0)throw new Error("Could not find Register No column.");const pr=Number.isFinite(Number(C.co1))?Number(C.co1):0,Dr=Number.isFinite(Number(C.co2))?Number(C.co2):0,qr=new Map;m.rows.forEach((Ur,Qr)=>{const on=String(Ur.registerNo||"").trim();on&&qr.set(on,Qr);const gn=Nk(on);gn&&qr.set(gn,Qr)}),g(Ur=>{const Qr=Ur.rows.slice();for(let on=1;on<ut.length;on++){const gn=ut[on]||[],ea=String(gn[hr]??"").trim();if(!ea)continue;const ma=qr.get(ea);if(ma==null)continue;const ta=(sr>=0?String(gn[sr]??""):"").trim().toLowerCase(),Tn=ta==="absent"||ta==="ab"||ta==="a",Me=mt>=0?Iv(gn[mt]):null,yt=_t>=0?Iv(gn[_t]):null,fe=cr>=0?Iv(gn[cr]):null,be=Me==null?0:Gs(Me,0,pr),He=yt==null?0:Gs(yt,0,Dr),Fe=fe??be+He,st=Tn?0:Gs(Fe,0,w);Qr[ma]={...Qr[ma],total:Al(st)}}return{...Ur,rows:Qr}})}finally{R(!1)}}},rr=async I=>{var ve;const se=(ve=I.target.files)==null?void 0:ve[0];if(I.target.value="",!!se)try{await Ct(se)}catch(Pe){alert((Pe==null?void 0:Pe.message)||"Failed to import Excel")}},kt={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},rt={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Rt={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},Gt={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},ir={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},Bt=I=>{if(wt||Rr)return;const se=m.markManagerSnapshot!=null;xt&&se||xe(ve=>ve.includes(I)?ve.filter(Pe=>Pe!==I):ve.concat(I).sort((Pe,Ke)=>Pe-Ke))},vr=!!(ge&&ye),Cr=vr?At:Ft,Tr=vr?!1:!!(K||!vt||Ce);return i.jsx(i.Fragment,{children:i.jsxs(Km,{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx("button",{onClick:Ye,className:"obe-btn obe-btn-secondary",disabled:N,children:N?"Loading roster":"Load/Refresh Roster"}),i.jsx("button",{onClick:Kr,className:"obe-btn obe-btn-danger",disabled:!m.rows.length,children:"Reset Marks"}),i.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!pe,onClick:()=>{if(he)return;const I=m.rows.filter(se=>!!se.absent||Object.values(se).some(ve=>typeof ve=="string"&&String(ve).toLowerCase().includes("absent"))).map(se=>Number(se.studentId)).filter(se=>Number.isFinite(se));qe(I.length?I:null),ze(!0)},title:pe?"Filter the table to show only absentees":"No absentees marked yet",style:he?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",he?i.jsx("span",{onClick:I=>{I.stopPropagation(),ze(!1),qe(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),i.jsx("button",{onClick:fr,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export CSV"}),i.jsx("button",{onClick:Or,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export Excel"}),i.jsx("button",{onClick:ht,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length||Ce||P,children:P?"Importing":"Import Excel"}),i.jsx("input",{ref:M,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:rr})]}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("button",{onClick:gt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Download"}),i.jsx("button",{onClick:Vt,className:"obe-btn obe-btn-success",disabled:_e||Ce,title:Ce?"Table locked  confirm Mark Manager to enable actions":void 0,children:_e?"Saving":"Save Draft"}),i.jsx("button",{onClick:Cr,className:"obe-btn obe-btn-primary",disabled:Tr,title:Ce?"Table locked  confirm Mark Manager to enable actions":void 0,children:vr?"Request Edit":K?"Publishing":"Publish"})]})]}),i.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:[i.jsxs("div",{style:ir,children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),i.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),i.jsxs("div",{style:ir,children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),i.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),i.jsxs("div",{style:ir,children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),i.jsx("div",{style:{fontWeight:700},children:Z||""}),F?i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",i.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:F})]}):null]}),i.jsxs("div",{style:ir,children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),i.jsx("div",{style:{fontWeight:700},children:z||""})]})]}),i.jsx("div",{style:{marginTop:10,fontSize:12,color:vt?"#065f46":"#b91c1c"},children:Ve?"Checking publish due time":Qe||(Ie!=null&&Ie.due_at?i.jsxs(i.Fragment,{children:["Due: ",new Date(Ie.due_at).toLocaleString(),"  Remaining: ",D0(Tt),Ie.allowed_by_approval&&Ie.approval_until?i.jsxs(i.Fragment,{children:["  Approved until ",new Date(Ie.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),wt?i.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),i.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:i.jsx("button",{className:"obe-btn",onClick:()=>Xe(),disabled:Ve,children:"Refresh"})})]}):vt?null:i.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),i.jsx("textarea",{value:Pt,onChange:I=>Wt(I.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),i.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[i.jsx("button",{className:"obe-btn",onClick:()=>Xe(),disabled:Ot||Ve,children:"Refresh"}),i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:gr,disabled:Ot,children:Ot?"Requesting":"Request Approval"})]}),Pr?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:Pr}):null]}),J?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:70},onClick:()=>q(!1),children:i.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflow:"auto",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:I=>I.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsxs("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:["View Published ",a]}),i.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:a}),i.jsx("button",{onClick:I=>{I.stopPropagation(),q(!1)},"aria-label":"Close",style:{marginLeft:8,border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),U?i.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,W?i.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:W}):null,i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:i.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:kt,colSpan:De,children:[m.termLabel," | ",m.batchLabel," | ",a]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...kt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),i.jsx("th",{style:kt,rowSpan:4,children:"Register No."}),i.jsx("th",{style:kt,rowSpan:3,children:"Name of the Students"}),i.jsx("th",{style:kt,children:a}),null,i.jsx("th",{style:kt,colSpan:4,children:"CO ATTAINMENT"}),We.length?i.jsx("th",{style:kt,colSpan:We.length*2,children:"BTL ATTAINMENT"}):null]}),i.jsxs("tr",{children:[i.jsxs("th",{style:kt,children:[i.jsx("div",{style:{fontWeight:800},children:"COs"}),i.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,i.jsx("th",{style:kt,colSpan:2,children:"CO-1"}),i.jsx("th",{style:kt,colSpan:2,children:"CO-2"}),We.map(I=>i.jsxs("th",{style:kt,colSpan:2,children:["BTL-",I]},`btl-head-${I}`))]}),i.jsxs("tr",{children:[i.jsxs("th",{style:kt,children:[i.jsx("div",{style:{fontWeight:800},children:"BTL"}),i.jsx("div",{style:{fontSize:12},children:We.length?We.join(","):"-"})]}),null,Array.from({length:2+We.length}).flatMap((I,se)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:kt,children:"Mark"}),i.jsx("th",{style:kt,children:"%"})]},se))]}),i.jsxs("tr",{children:[i.jsx("th",{style:kt,children:"Name / Max Marks"}),i.jsx("th",{style:kt,children:w}),null,i.jsx("th",{style:kt,children:C.co1}),i.jsx("th",{style:kt,children:"%"}),i.jsx("th",{style:kt,children:C.co2}),i.jsx("th",{style:kt,children:"%"}),We.flatMap(I=>[i.jsx("th",{style:kt,children:String(s?A:Math.max(Number(j[`btl${I}`]??0)||0,Tp))},`btl-max-${I}`),i.jsx("th",{style:kt,children:"%"},`btl-pct-${I}`)])]})]}),i.jsx("tbody",{children:m.rows.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:De,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):Je.map((I,se)=>{var sr;const ve=((sr=Y==null?void 0:Y.marks)==null?void 0:sr[String(I.studentId)])??null,Pe=ve==null||ve===""?null:Gs(Number(ve),0,w),pt=Pe==null?null:Al(Pe/2),ut=pt==null?null:Gs(pt,0,C.co1),Lt=pt==null?null:Gs(pt,0,C.co2),Sr=We.map(pr=>pr-1),mt=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((pr,Dr)=>Sr.includes(Dr)?s?A:pr>0?pr:Tp:pr),_t=Pe==null?null:Sr.length?Al(Pe/Sr.length):0,cr=mt.map((pr,Dr)=>Pe==null||!Sr.includes(Dr)?null:pr>0?Gs(_t,0,pr):Al(_t));return i.jsxs("tr",{style:{background:se%2===1?"#f8fafc":"#fff"},children:[i.jsx("td",{style:{...rt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:se+1}),i.jsx("td",{style:rt,children:Nk(I.registerNo)}),i.jsx("td",{style:rt,children:I.name}),i.jsx("td",{style:{...rt,width:90,background:"#fff7ed",textAlign:"center"},children:Pe==null?"":Al(Pe)}),null,i.jsx("td",{style:{...rt,textAlign:"center"},children:ut??""}),i.jsx("td",{style:{...rt,textAlign:"center"},children:tl(ut,C.co1)}),i.jsx("td",{style:{...rt,textAlign:"center"},children:Lt??""}),i.jsx("td",{style:{...rt,textAlign:"center"},children:tl(Lt,C.co2)}),We.map(pr=>{const Dr=pr-1,qr=cr[Dr],Ur=mt[Dr];return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...rt,textAlign:"center"},children:qr??""}),i.jsx("td",{style:{...rt,textAlign:"center"},children:tl(qr,Ur)})]},pr)})]},String(I.studentId||se))})})]})}),i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"obe-btn",onClick:()=>q(!1),children:"Close"})})]})}):null,(B||ne)&&i.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:B||ne}),i.jsxs("div",{style:{marginTop:12,...ir},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),i.jsx("div",{children:i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const I=m.markManagerSnapshot!=null;Ir({mode:I?"request":"confirm"})},disabled:!e||Rr,children:m.markManagerSnapshot?"Edit":"Save"})})]}),i.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[i.jsxs("div",{children:["Max ",a,": ",i.jsx("strong",{style:{color:"#111"},children:w})]}),i.jsxs("div",{children:["CO-1 max: ",i.jsx("strong",{style:{color:"#111"},children:C.co1}),"  CO-2 max: ",i.jsx("strong",{style:{color:"#111"},children:C.co2})]}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),i.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(I=>{const se=re.includes(I),ve=!!(xt&&m.markManagerSnapshot!=null);return i.jsxs("div",{onClick:()=>Bt(I),style:{...Gt,borderColor:se?"#16a34a":"#cbd5e1",background:se?"#ecfdf5":"#fff",cursor:ve||Rr?"not-allowed":"pointer",opacity:ve?.6:1,padding:"6px 8px"},"aria-disabled":ve||Rr,children:[i.jsx("input",{type:"checkbox",checked:se,readOnly:!0,style:{marginRight:6}}),i.jsxs("span",{style:{fontWeight:800},children:["BTL",I]})]},`card_btl_${I}`)})})]})]}),zr?i.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:zr}):null]}),i.jsx("div",{style:{marginTop:14},children:it?i.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:i.jsx(Gm,{locked:!!(wt||ye||ge&&je),title:wt?"Locked by IQAC":dt?"Published  Locked":"Table Locked",subtitle:wt?"Publishing is turned OFF globally for this assessment.":dt?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:i.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:kt,colSpan:De,children:[m.termLabel," | ",m.batchLabel," | ",a]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...kt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),i.jsx("th",{style:kt,rowSpan:4,children:"Register No."}),i.jsx("th",{style:kt,rowSpan:3,children:"Name of the Students"}),i.jsx("th",{style:kt,children:a}),null,i.jsx("th",{style:kt,colSpan:4,children:"CO ATTAINMENT"}),We.length?i.jsx("th",{style:kt,colSpan:We.length*2,children:"BTL ATTAINMENT"}):null]}),i.jsxs("tr",{children:[i.jsxs("th",{style:kt,children:[i.jsx("div",{style:{fontWeight:800},children:"COs"}),i.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,i.jsx("th",{style:kt,colSpan:2,children:"CO-1"}),i.jsx("th",{style:kt,colSpan:2,children:"CO-2"}),We.map(I=>i.jsxs("th",{style:kt,colSpan:2,children:["BTL-",I]},`btl-head-${I}`))]}),i.jsxs("tr",{children:[i.jsxs("th",{style:kt,children:[i.jsx("div",{style:{fontWeight:800},children:"BTL"}),i.jsx("div",{style:{fontSize:12},children:We.length?We.join(","):"-"})]}),null,Array.from({length:2+We.length}).flatMap((I,se)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:kt,children:"Mark"}),i.jsx("th",{style:kt,children:"%"})]},se))]}),i.jsxs("tr",{children:[i.jsx("th",{style:kt,children:"Name / Max Marks"}),i.jsx("th",{style:kt,children:w}),null,i.jsx("th",{style:kt,children:C.co1}),i.jsx("th",{style:kt,children:"%"}),i.jsx("th",{style:kt,children:C.co2}),i.jsx("th",{style:kt,children:"%"}),We.flatMap(I=>[i.jsx("th",{style:kt,children:String(s?A:sxe(j[`btl${I}`]))},`btl-max-${I}`),i.jsx("th",{style:kt,children:"%"},`btl-pct-${I}`)])]})]}),i.jsx("tbody",{children:m.rows.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:De,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):Ce&&!ye?i.jsx("tr",{children:i.jsx("td",{colSpan:De,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):Je.map((I,se)=>{const ve=typeof I.total=="number"?Gs(Number(I.total),0,w):null,Pe=ve==null?null:Al(ve/2),Ke=Pe==null?null:Gs(Pe,0,C.co1),pt=Pe==null?null:Gs(Pe,0,C.co2),ut=We.map(_t=>_t-1),Sr=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((_t,cr)=>ut.includes(cr)?s?A:_t>0?_t:Tp:_t),hr=ve==null?null:ut.length?Al(ve/ut.length):0,mt=Sr.map((_t,cr)=>ve==null||!ut.includes(cr)?null:_t>0?Gs(hr,0,_t):Al(hr));return i.jsxs("tr",{style:{background:se%2===1?"#f8fafc":"#fff"},children:[i.jsx("td",{style:{...rt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:se+1}),i.jsx("td",{style:rt,children:Nk(I.registerNo)}),i.jsx("td",{style:rt,children:I.name}),i.jsx("td",{style:{...rt,width:90,background:"#fff7ed"},children:ot?i.jsx("div",{style:Rt,children:typeof I.total=="number"?Al(I.total):""}):i.jsx("input",{style:Rt,type:"number",value:I.total,min:0,max:w,onChange:_t=>{if(ot)return;const cr=_t.target.value;if(cr==="")return $t(se,{total:""});const sr=Number(cr);if(!Number.isFinite(sr))return $t(se,{total:""});if(sr>w){_t.currentTarget.setCustomValidity(`Max mark is ${w}`),_t.currentTarget.reportValidity(),window.setTimeout(()=>_t.currentTarget.setCustomValidity(""),0);return}_t.currentTarget.setCustomValidity("");const pr=Gs(sr,0,w);$t(se,{total:pr})}})}),null,i.jsx("td",{style:{...rt,textAlign:"center"},children:Ke??""}),i.jsx("td",{style:{...rt,textAlign:"center"},children:tl(Ke,C.co1)}),i.jsx("td",{style:{...rt,textAlign:"center"},children:pt??""}),i.jsx("td",{style:{...rt,textAlign:"center"},children:tl(pt,C.co2)}),We.map(_t=>{const cr=_t-1,sr=mt[cr],pr=Sr[cr];return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...rt,textAlign:"center"},children:sr??""}),i.jsx("td",{style:{...rt,textAlign:"center"},children:tl(sr,pr)})]},_t)})]},String(I.studentId||se))})})]})})}):i.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:i.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[i.jsx("div",{style:{fontSize:40},children:""}),i.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:dt?"Published  Locked":"Table Locked"}),i.jsx("div",{style:{color:"#6b7280",marginTop:6},children:dt?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),i.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:dt?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"obe-btn",onClick:()=>q(!0),children:"View"}),i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>At(),children:"Request Edit"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ir({mode:"confirm"}),disabled:!e||Rr,children:"Save Mark Manager"}),i.jsx("button",{className:"obe-btn",onClick:()=>kr(),disabled:Rr,children:"Request Access"})]})})]})})}),i.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }

        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),i.jsxs("div",{style:{position:"relative"},children:[xt?null:i.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"rgba(107, 114, 128, 0.15)"}}),xt?null:i.jsxs("div",{style:{position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[i.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:i.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),i.jsxs("div",{style:{textAlign:"center"},children:[i.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]})]}),ur?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:9999},onClick:()=>{Rr||Ir(null)},children:i.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:I=>I.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:ur.mode==="confirm"?`Confirmation - ${a}`:`Request Edit - ${a}`}),i.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:a})]}),ur.mode==="confirm"?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f9fafb"},children:[i.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),i.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",a]}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-1 max"}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:C.co1})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-2 max"}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:C.co2})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(I=>{const se=re.includes(I);return i.jsxs("div",{onClick:()=>xe(ve=>ve.includes(I)?ve.filter(Pe=>Pe!==I):[...ve,I].sort((Pe,Ke)=>Pe-Ke)),style:{...Gt,borderColor:se?"#16a34a":"#cbd5e1",background:se?"#ecfdf5":"#fff",cursor:Rr?"not-allowed":"pointer",padding:"6px 8px"},children:[i.jsx("input",{type:"checkbox",checked:se,readOnly:!0,style:{marginRight:6}}),i.jsxs("span",{style:{fontWeight:800},children:["BTL",I]})]},`modal_btl_${I}`)})})})]})]})]})})]}):i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{className:"obe-btn",disabled:Rr,onClick:()=>Ir(null),children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:Rr||!e,onClick:async()=>{if(e){if(ur.mode==="request"){Ir(null),await kr();return}await Ut()}},children:ur.mode==="confirm"?"Confirm":"Send Request"})]})]})}):null]})})}function uxe({subjectId:e,teachingAssignmentId:t,label:r}){return i.jsx(_z,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review1",label:r||"Review 1"})}const dxe=20,xL={co3:10,co4:10},xp={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},yp=10;function Ks(e,t,r){return Math.max(t,Math.min(r,e))}function Nl(e){return Math.round(e*10)/10}function rl(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Dv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function bp(e,t,r){const n=e==null?void 0:e.btlMax,a=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Dv(a);return s??r}function fxe(e,t){return`${t}_sheet_${e}`}function yL(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function hxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),a=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function pxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const a=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=a.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Ub(e){return e.slice(-8)}function kz({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa2"}){var vr,Cr,Tr,xr,Xt;const a=String(r||"SSA2"),s=n==="review2",o=!1,l=x.useMemo(()=>fxe(e,n),[e,n]),c=n==="review2"?fS:H1,u=n==="review2"?c9:l9,[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),b=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),y=((vr=d==null?void 0:d.assessments)==null?void 0:vr.ssa2)||{},v=Number.isFinite(Number(y==null?void 0:y.maxTotal))?Number(y.maxTotal):dxe,w=s?30:v,_={co3:Number.isFinite(Number((Cr=y==null?void 0:y.coMax)==null?void 0:Cr.co3))?Number(y.coMax.co3):Number.isFinite(Number((Tr=y==null?void 0:y.coMax)==null?void 0:Tr.co1))?Number(y.coMax.co1):xL.co3,co4:Number.isFinite(Number((xr=y==null?void 0:y.coMax)==null?void 0:xr.co4))?Number(y.coMax.co4):Number.isFinite(Number((Xt=y==null?void 0:y.coMax)==null?void 0:Xt.co2))?Number(y.coMax.co2):xL.co4},C=s?{co3:15,co4:15}:_,j={btl1:bp(y,1,xp.btl1),btl2:bp(y,2,xp.btl2),btl3:bp(y,3,xp.btl3),btl4:bp(y,4,xp.btl4),btl5:bp(y,5,xp.btl5),btl6:bp(y,6,xp.btl6)},A=s?30:yp,M=x.useRef(null),[P,R]=x.useState(!1);x.useEffect(()=>{let ie=!0;return(async()=>{try{const I=await iu();if(!ie)return;f(I||null),g(se=>({...se,termLabel:String((I==null?void 0:I.termLabel)||se.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{ie=!1}},[e]);const[N,T]=x.useState(!1),[B,G]=x.useState(null),[re,xe]=x.useState(()=>s?[3,4]:[]),[_e,V]=x.useState(!1),[K,de]=x.useState(!1),[ne,E]=x.useState(null),[Z,H]=x.useState(null),[F,ee]=x.useState(null),[z,X]=x.useState(null),[J,q]=x.useState(!1),[Y,L]=x.useState(!1),[U,ce]=x.useState(null),[W,ae]=x.useState(!1),[he,ze]=x.useState(null),[ke,qe]=x.useState(!1),{data:Ie,loading:Ve,error:Qe,remainingSeconds:Tt,publishAllowed:vt,refresh:Xe}=dh({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:Be,loading:ct,error:nt,refresh:Se}=fh({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:Te,refresh:Dt}=Ul({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:wt,refresh:Pt}=Ul({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),Wt=!!(Ie!=null&&Ie.global_override_active&&(Ie==null?void 0:Ie.global_is_open)===!1),[Ot,Ht]=x.useState(""),[Pr,jt]=x.useState(!1),[ur,Ir]=x.useState(null),[Rr,Nr]=x.useState(null),[zr,_n]=x.useState(!1),[Yr,pn]=x.useState(null),ge=!!(e&&!zr),[Ne,dt]=x.useState(null);x.useEffect(()=>{dt(null),X(null),ce(null),ze(null)},[e,n,t]);const Ue=!!z||!!(Be!=null&&Be.exists&&(Be!=null&&Be.is_published))||!!U,Re=!ge&&Ue,xt=!!m.markManagerLocked,at=wt!=null&&wt.approval_until?String(wt.approval_until):null,er=Te!=null&&Te.approval_until?String(Te.approval_until):null,oe=!!(wt!=null&&wt.allowed_by_approval)&&!!at&&at!==((Ne==null?void 0:Ne.markEntryApprovalUntil)??null),ue=!!(Te!=null&&Te.allowed_by_approval)&&!!er&&er!==((Ne==null?void 0:Ne.markManagerApprovalUntil)??null),Q=Ue?!!(Be!=null&&Be.entry_open)||oe||ue:!0,ye=!!(Ue&&!Q),je=!!e&&(ct||!!nt||Be==null),Ce=!!(Wt||je||(Be?!Be.entry_open:Ue?!Q:!xt)),ot=m.markManagerSnapshot!=null,it=!!(Wt||ye||Ce),We=!!(Ue&&ye&&xt),De=x.useMemo(()=>{const ie=new Set(re);return[1,2,3,4,5,6].filter(I=>ie.has(I))},[re]),pe=x.useMemo(()=>8+De.length*2,[o,De.length]);x.useEffect(()=>{if(!e)return;try{const se=`${n}_selected_btls_${e}`;Sn(se,re)}catch{}let ie=!1;const I=setTimeout(async()=>{try{await li(n,e,{sheet:m,selectedBtls:re});try{l&&Sn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}ie||H(new Date().toLocaleString())}catch{}},700);return()=>{ie=!0,clearTimeout(I)}},[re,e,m,l,n]),x.useEffect(()=>{if(!e)return;const ie=Pn(l);ie&&typeof ie=="object"&&Array.isArray(ie.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(ie.termLabel||"KRCT AY25-26"),batchLabel:e,rows:ie.rows,markManagerSnapshot:(ie==null?void 0:ie.markManagerSnapshot)??null,markManagerApprovalUntil:(ie==null?void 0:ie.markManagerApprovalUntil)??null,markManagerLocked:typeof(ie==null?void 0:ie.markManagerLocked)=="boolean"?ie.markManagerLocked:!!(ie!=null&&ie.markManagerSnapshot)}):g({termLabel:b||"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null})},[l,e,d,b]),x.useEffect(()=>{let ie=!0;return(async()=>{if(e)try{const I=await Mn(n,e);if(!ie)return;const se=I==null?void 0:I.draft,ve=se==null?void 0:se.sheet,Pe=se==null?void 0:se.selectedBtls;if(ve&&typeof ve=="object"&&Array.isArray(ve.rows)){g(ut=>({...ut,termLabel:String(ve.termLabel||b||"KRCT AY25-26"),batchLabel:e,rows:ve.rows,markManagerSnapshot:(ve==null?void 0:ve.markManagerSnapshot)??ut.markManagerSnapshot??null,markManagerApprovalUntil:(ve==null?void 0:ve.markManagerApprovalUntil)??ut.markManagerApprovalUntil??null,markManagerLocked:typeof(ve==null?void 0:ve.markManagerLocked)=="boolean"?ve.markManagerLocked:!!((ve==null?void 0:ve.markManagerSnapshot)??ut.markManagerSnapshot)}));const Ke=(I==null?void 0:I.updated_at)??null,pt=(I==null?void 0:I.updated_by)??null;if(Ke)try{H(new Date(String(Ke)).toLocaleString())}catch{H(String(Ke))}pt&&ee(String(pt.name||pt.username||pt.id||""));try{l&&Sn(l,{termLabel:String(ve.termLabel||b||"KRCT AY25-26"),batchLabel:e,rows:ve.rows})}catch{}}if(Array.isArray(Pe)){const Ke=Pe.map(pt=>Number(pt)).filter(pt=>Number.isFinite(pt));xe(Ke);try{const pt=`${n}_selected_btls_${e}`;Sn(pt,Ke)}catch{}}}catch{}})(),()=>{ie=!1}},[e,b,l,n]),x.useEffect(()=>{if(!e)return;if((!!(Be!=null&&Be.exists&&(Be!=null&&Be.is_published))||!!z)&&(Be!=null&&Be.exists)){const ve=!!(Be!=null&&Be.mark_manager_locked);!!m.markManagerLocked!==ve&&g(Pe=>({...Pe,markManagerLocked:ve}));return}const I=!!(Te!=null&&Te.allowed_by_approval),se=Te!=null&&Te.approval_until?String(Te.approval_until):null;if(I&&se){if(se===((Ne==null?void 0:Ne.markManagerApprovalUntil)??null))return;const ve=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&ve!==se&&g(Pe=>({...Pe,markManagerLocked:!1,markManagerApprovalUntil:se}));return}},[e,Be==null?void 0:Be.exists,Be==null?void 0:Be.is_published,Be==null?void 0:Be.mark_manager_locked,Te==null?void 0:Te.allowed_by_approval,Te==null?void 0:Te.approval_until,m.markManagerLocked,m.markManagerApprovalUntil,z,Ne==null?void 0:Ne.markManagerApprovalUntil]);const Je=ie=>{g(I=>{const se=new Map,ve=new Map;for(const Ke of I.rows||[])typeof Ke.studentId=="number"&&se.set(Ke.studentId,Ke),Ke.registerNo&&ve.set(String(Ke.registerNo),Ke);const Pe=(ie||[]).slice().sort(pxe).map(Ke=>{const pt=se.get(Ke.id)||ve.get(String(Ke.reg_no||""));return{studentId:Ke.id,section:String(Ke.section||""),registerNo:String(Ke.reg_no||""),name:String(Ke.name||""),total:typeof(pt==null?void 0:pt.total)=="number"?Ks(Number(pt.total),0,w):((pt==null?void 0:pt.total)==="","")}});return{...I,rows:Pe}})},Ge=async()=>{var ie,I,se;if(!e){G("Subject ID is required.");return}T(!0),G(null);try{let ve=[],Pe=null;try{const Ke=await jc();console.log("[SSA2] My TAs:",Ke==null?void 0:Ke.length,"for subject:",e,"teachingAssignmentId:",t),Pe=(Ke||[]).find(pt=>{const ut=String(pt.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?pt.id===t:!1)||ut}),Pe?console.log("[SSA2] Found TA match:",Pe.id,"elective_subject_id:",Pe.elective_subject_id,"section_id:",Pe.section_id):console.log("[SSA2] No TA match found in user TAs")}catch(Ke){console.warn("[SSA2] My TAs fetch failed:",Ke)}if(Pe&&Pe.elective_subject_id&&!Pe.section_id){console.log("[SSA2] Detected elective, fetching elective-choices for elective_subject_id:",Pe.elective_subject_id);try{const Ke=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Pe.elective_subject_id))}`);if(Ke.ok){const pt=await Ke.json(),ut=Array.isArray(pt.results)?pt.results:Array.isArray(pt)?pt:pt.items||[];console.log("[SSA2] Elective choices returned:",ut==null?void 0:ut.length,"students"),ve=(ut||[]).map(Lt=>({id:Number(Lt.student_id??Lt.id),reg_no:String(Lt.reg_no??Lt.regno??""),name:String(Lt.name??Lt.full_name??Lt.username??""),section:Lt.section_name??Lt.section??null}))}else console.warn("[SSA2] Elective-choices API returned error:",Ke.status)}catch(Ke){console.warn("[SSA2] Elective-choices fetch failed:",Ke)}}if(!ve.length&&Pe&&Pe.id){console.log("[SSA2] Fetching regular TA roster for TA ID:",Pe.id);try{const Ke=await Ac(Pe.id);ve=Ke.students||[],h({courseName:String(((ie=Ke==null?void 0:Ke.teaching_assignment)==null?void 0:ie.subject_name)||(Pe==null?void 0:Pe.subject_name)||""),courseCode:String(((I=Ke==null?void 0:Ke.teaching_assignment)==null?void 0:I.subject_code)||(Pe==null?void 0:Pe.subject_code)||e||""),className:String(((se=Ke==null?void 0:Ke.teaching_assignment)==null?void 0:se.section_name)||(Pe==null?void 0:Pe.section_name)||"")}),console.log("[SSA2] Regular roster returned:",ve.length,"students")}catch(Ke){console.warn("[SSA2] TA roster fetch failed:",Ke)}}console.log("[SSA2] Final roster count:",ve.length),Je(ve)}catch(ve){G((ve==null?void 0:ve.message)||"Failed to load roster")}finally{T(!1)}};x.useEffect(()=>{e&&Ge()},[t,e]);async function Ye(ie){if(e){ie&&ae(!0),ze(null);try{const I=await c(String(e));ce(I||null)}catch(I){ie&&ze((I==null?void 0:I.message)||`Failed to load published ${a} marks`)}finally{ie&&ae(!1)}}}x.useEffect(()=>{e&&Ye(!1)},[e,n,t]);const ft=x.useRef(!!Q);x.useEffect(()=>{ft.current=!!Q},[e,n,t,Q]);const bt=x.useRef(null);async function Vt(ie=!0){try{if(Xe(),Se({silent:!1}),await Ye(ie),t)try{await Ge()}catch{}}catch{}}x.useEffect(()=>{if(!e||!Ue)return;if(ft.current||!Q){ft.current=!!Q;return}let I=!0;return(async()=>{try{const se=await Mn(n,String(e));if(!I)return;const ve=se==null?void 0:se.draft,Pe=ve==null?void 0:ve.sheet,Ke=ve==null?void 0:ve.selectedBtls;Pe&&typeof Pe=="object"&&Array.isArray(Pe.rows)&&g(pt=>({...pt,termLabel:String(Pe.termLabel||b||"KRCT AY25-26"),batchLabel:e,rows:Pe.rows,markManagerSnapshot:(Pe==null?void 0:Pe.markManagerSnapshot)??pt.markManagerSnapshot??null,markManagerApprovalUntil:(Pe==null?void 0:Pe.markManagerApprovalUntil)??pt.markManagerApprovalUntil??null,markManagerLocked:typeof(Pe==null?void 0:Pe.markManagerLocked)=="boolean"?Pe.markManagerLocked:!!((Pe==null?void 0:Pe.markManagerSnapshot)??pt.markManagerSnapshot)})),Array.isArray(Ke)&&xe(Ke.map(pt=>Number(pt)).filter(pt=>Number.isFinite(pt)));return}catch{}I&&Ye(!1)})(),ft.current=!!Q,()=>{I=!1}},[Q,Ue,e,n,b]),x.useEffect(()=>{if(!e||!Ue||Q)return;const ie=window.setInterval(()=>{Se({silent:!0})},3e4);return()=>window.clearInterval(ie)},[Q,Ue,e,Se]),x.useEffect(()=>{Y&&e&&(ce(null),Ye(!0))},[Y,e]);const Ft=async()=>{V(!0),E(null);try{await li(n,e,{sheet:m,selectedBtls:re}),H(new Date().toLocaleString())}catch(ie){E((ie==null?void 0:ie.message)||`Failed to save ${a} draft`)}finally{V(!1)}},gr=async()=>{if(e){if(Wt){E("Publishing is locked by IQAC.");return}if(!vt){E("Publish window is closed. Please request IQAC approval.");return}if(Ue&&ye){q(!0);return}de(!0),E(null);try{await u(e,m,t),X(new Date().toLocaleString()),dt({markEntryApprovalUntil:at,markManagerApprovalUntil:er}),g(ie=>({...ie,markManagerLocked:!0})),Xe(),Se({silent:!0}),Ye(!1),setTimeout(()=>{try{if(Y&&bt.current){const ie=bt.current;ie.scrollTop=ie.scrollHeight}}catch{}},50);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}setTimeout(()=>{Vt(!0),qe(!0),setTimeout(()=>qe(!1),5e3)},2e3)}catch(ie){E((ie==null?void 0:ie.message)||`Failed to publish ${a}`)}finally{de(!1)}}},Ar=async()=>{jt(!0),Ir(null),E(null);try{await R0({assessment:n,subject_code:e,reason:Ot,teaching_assignment_id:t}),Ir("Request sent to IQAC for approval.")}catch(ie){E((ie==null?void 0:ie.message)||"Failed to request approval")}finally{jt(!1),Xe()}},kr=()=>{confirm(`Reset ${a} marks for all students in this section?`)&&(Ce||g(ie=>({...ie,rows:(ie.rows||[]).map(I=>({...I,total:""}))})))};function At(ie){return JSON.stringify({maxTotal:w,coMax:C,selectedBtls:re.slice(),btlMax:j})}async function Ut(){if(e){_n(!0),pn(null);try{await qo({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${a} ${e}`,teaching_assignment_id:t}),alert("Edit request sent to IQAC.");try{await(Dt?Dt({silent:!0}):Promise.resolve())}catch{}}catch(ie){pn((ie==null?void 0:ie.message)||"Request failed"),alert((ie==null?void 0:ie.message)||"Request failed")}finally{_n(!1)}}}async function Kr(){if(e)try{await qo({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:`Edit request: ${a} marks entry for ${e}`,teaching_assignment_id:t}),alert("Edit request sent to IQAC."),Se({silent:!0});try{await(Pt?Pt({silent:!0}):Promise.resolve())}catch{}}catch(ie){alert((ie==null?void 0:ie.message)||"Request failed")}}async function $t(){if(e){_n(!0),pn(null);try{const ie=At(m),I=Te!=null&&Te.approval_until?String(Te.approval_until):m.markManagerApprovalUntil||null,se={...m,markManagerLocked:!0,markManagerSnapshot:ie,markManagerApprovalUntil:I},ve={sheet:se,selectedBtls:re};g(se),Nr(null),await li(n,String(e),ve),H(new Date().toLocaleString());try{await Zf(n,String(e),t),Se({silent:!0})}catch(Pe){console.warn("confirmMarkManagerLock failed",Pe)}}catch(ie){pn((ie==null?void 0:ie.message)||"Save failed")}finally{_n(!1)}}}const fr=(ie,I)=>{g(se=>{const ve=se.rows.slice(),Pe=ve[ie]||{studentId:0,section:"",registerNo:"",name:"",total:""};return ve[ie]={...Pe,...I},{...se,rows:ve}})},Or=()=>{const ie=m.rows.map((I,se)=>{const ve=typeof I.total=="number"?Ks(Number(I.total),0,w):null,Pe=ve==null?"":Nl(ve),pt=ve==null?null:Nl(ve/2),ut=pt==null?null:Ks(pt,0,C.co3),Lt=pt==null?null:Ks(pt,0,C.co4),Sr=De.map(pr=>pr-1),mt=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((pr,Dr)=>Sr.includes(Dr)?s?A:pr>0?pr:yp:pr),_t=ve==null?null:Sr.length?Nl(ve/Sr.length):0,cr=mt.map((pr,Dr)=>ve==null||!Sr.includes(Dr)?null:pr>0?Ks(_t,0,pr):Nl(_t)),sr={sno:se+1,registerNo:Ub(I.registerNo),name:I.name,co3_mark:ut??"",co3_pct:rl(ut,C.co3),co4_mark:Lt??"",co4_pct:rl(Lt,C.co4),btl1_mark:cr[0]??"",btl1_pct:rl(cr[0],mt[0]),btl2_mark:cr[1]??"",btl2_pct:rl(cr[1],mt[1]),btl3_mark:cr[2]??"",btl3_pct:rl(cr[2],mt[2]),btl4_mark:cr[3]??"",btl4_pct:rl(cr[3],mt[3]),btl5_mark:cr[4]??"",btl5_pct:rl(cr[4],mt[4]),btl6_mark:cr[5]??"",btl6_pct:rl(cr[5],mt[5])};return sr[a]=Pe,sr});hxe(`${e}_${yL(a)||"SSA2"}_sheet.csv`,ie)},gt=()=>{if(!m.rows.length)return;const ie=Number.isFinite(Number(C.co3))?Number(C.co3):0,I=Number.isFinite(Number(C.co4))?Number(C.co4):0,se=["Register No","Student Name",`Q1 (${ie.toFixed(2)})`,`Q2 (${I.toFixed(2)})`,"Status"],ve=m.rows.map(ut=>[ut.registerNo,ut.name,"","","present"]),Pe=ds.aoa_to_sheet([se,...ve]);Pe["!freeze"]={xSplit:0,ySplit:1};const Ke=ds.book_new();ds.book_append_sheet(Ke,Pe,a||"SSA2");const pt=`${e}_${yL(a)||"SSA2"}_template.xlsx`;ty(Ke,pt)},Jt=async()=>{const ie=m.rows.map((I,se)=>({sno:se+1,regNo:String(I.registerNo||""),name:String(I.name||""),total:I.total===""?"":Number(I.total)}));await ny({filenameBase:`${e}_${a}`,meta:{courseName:(p==null?void 0:p.courseName)||"",courseCode:(p==null?void 0:p.courseCode)||e,className:(p==null?void 0:p.className)||""},rows:ie})};function ht(ie){return String(ie??"").trim().toLowerCase().replace(/\s+/g," ")}const Ct=()=>{var ie;Ce||(ie=M.current)==null||ie.click()},rr=async ie=>{var I;if(ie){R(!0);try{const se=await ie.arrayBuffer(),ve=v0(se,{type:"array"}),Pe=(I=ve.SheetNames)==null?void 0:I[0];if(!Pe)throw new Error("No sheet found in the Excel file.");const Ke=ve.Sheets[Pe],pt=ds.sheet_to_json(Ke,{header:1});if(!pt.length)throw new Error("Excel sheet is empty.");const ut=(pt[0]||[]).map(ht),Lt=qr=>ut.findIndex(Ur=>qr(Ur)),Sr=Lt(qr=>qr==="register no"||qr==="reg no"||qr.includes("register")),hr=Lt(qr=>qr.startsWith("q1")),mt=Lt(qr=>qr.startsWith("q2")),_t=Lt(qr=>qr==="total"||qr.includes("total")),cr=Lt(qr=>qr==="status"||qr.includes("status"));if(Sr<0)throw new Error("Could not find Register No column.");const sr=Number.isFinite(Number(C.co3))?Number(C.co3):0,pr=Number.isFinite(Number(C.co4))?Number(C.co4):0,Dr=new Map;m.rows.forEach((qr,Ur)=>{const Qr=String(qr.registerNo||"").trim();Qr&&Dr.set(Qr,Ur);const on=Ub(Qr);on&&Dr.set(on,Ur)}),g(qr=>{const Ur=qr.rows.slice();for(let Qr=1;Qr<pt.length;Qr++){const on=pt[Qr]||[],gn=String(on[Sr]??"").trim();if(!gn)continue;const ea=Dr.get(gn);if(ea==null)continue;const ga=(cr>=0?String(on[cr]??""):"").trim().toLowerCase(),ta=ga==="absent"||ga==="ab"||ga==="a",Tn=hr>=0?Dv(on[hr]):null,Me=mt>=0?Dv(on[mt]):null,yt=_t>=0?Dv(on[_t]):null,fe=Tn==null?0:Ks(Tn,0,sr),be=Me==null?0:Ks(Me,0,pr),He=yt??fe+be,Fe=ta?0:Ks(He,0,w);Ur[ea]={...Ur[ea],total:Nl(Fe)}}return{...qr,rows:Ur}})}finally{R(!1)}}},kt=async ie=>{var se;const I=(se=ie.target.files)==null?void 0:se[0];if(ie.target.value="",!!I)try{await rr(I)}catch(ve){alert((ve==null?void 0:ve.message)||"Failed to import Excel")}},rt={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Rt={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Gt={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},ir={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},Bt={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"};return i.jsx(i.Fragment,{children:i.jsxs(Km,{children:[i.jsx(AssessmentControls,{rosterLoading:N,onLoadRoster:Ge,onResetMarks:kr,onExportCsv:Or,onExportExcel:gt,onTriggerExcelImport:Ct,excelFileInputRef:M,onExcelFileSelect:kt,excelBusy:P,onDownload:Jt,onSaveDraft:Ft,savingDraft:_e,publishButtonOnClick:gr,publishButtonDisabled:K||!vt||Ce,publishing:K,savedAt:Z,publishedAt:z,publishWindowLoading:Ve,publishWindowError:Qe,publishWindow:Ie,remainingSeconds:Tt,publishAllowed:vt,globalLocked:Wt}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("button",{onClick:()=>Vt(!0),className:"obe-btn",disabled:!e,children:"Refresh"}),i.jsx("button",{onClick:gr,className:"obe-btn obe-btn-primary",disabled:K||!vt,children:K?"Publishing":"Publish"})]}),ke?i.jsx("div",{style:{marginTop:8,padding:8,background:"#ecfdf5",border:"1px solid #bbf7d0",borderRadius:8,color:"#065f46",fontWeight:700},children:"Name list locked"}):null,i.jsx("div",{style:{marginTop:10,fontSize:12,color:vt?"#065f46":"#b91c1c"},children:Ve?"Checking publish due time":Qe||(Ie!=null&&Ie.due_at?i.jsxs(i.Fragment,{children:["Due: ",new Date(Ie.due_at).toLocaleString(),"  Remaining: ",D0(Tt),Ie.allowed_by_approval&&Ie.approval_until?i.jsxs(i.Fragment,{children:["  Approved until ",new Date(Ie.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Wt?i.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),i.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:i.jsx("button",{className:"obe-btn",onClick:()=>Xe(),disabled:Ve,children:"Refresh"})})]}):vt?null:i.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),i.jsx("textarea",{value:Ot,onChange:ie=>Ht(ie.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),i.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[i.jsx("button",{className:"obe-btn",onClick:()=>Xe(),disabled:Pr||Ve,children:"Refresh"}),i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Ar,disabled:Pr,children:Pr?"Requesting":"Request Approval"})]}),ur?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:ur}):null]}),(B||ne)&&i.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:B||ne}),i.jsxs("div",{style:{marginTop:10,display:"flex",gap:12,flexWrap:"wrap"},children:[i.jsxs("div",{style:Bt,children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),i.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),i.jsxs("div",{style:Bt,children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),i.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),i.jsxs("div",{style:Bt,children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),i.jsx("div",{style:{fontWeight:700},children:Z||""}),F?i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",i.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:F})]}):null]}),i.jsxs("div",{style:Bt,children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),i.jsx("div",{style:{fontWeight:700},children:z||""})]})]}),i.jsxs("div",{style:{marginTop:12,...Bt},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),i.jsx("div",{children:i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const ie=m.markManagerSnapshot!=null;Nr({mode:ie?"request":"confirm"})},disabled:!e||zr,children:m.markManagerSnapshot?"Edit":"Save"})})]}),i.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[i.jsxs("div",{children:["Max ",a,": ",i.jsx("strong",{style:{color:"#111"},children:w})]}),i.jsxs("div",{children:["CO-3 max: ",i.jsx("strong",{style:{color:"#111"},children:C.co3}),"  CO-4 max: ",i.jsx("strong",{style:{color:"#111"},children:C.co4})]}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),i.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(ie=>{const I=re.includes(ie),se=!!(xt&&m.markManagerSnapshot!=null);return i.jsxs("div",{onClick:()=>{if(Wt||zr)return;const ve=m.markManagerSnapshot!=null;xt&&ve||xe(Pe=>Pe.includes(ie)?Pe.filter(Ke=>Ke!==ie):Pe.concat(ie).sort((Ke,pt)=>Ke-pt))},style:{...ir,borderColor:I?"#16a34a":"#cbd5e1",background:I?"#ecfdf5":"#fff",cursor:se||zr?"not-allowed":"pointer",opacity:se?.6:1,padding:"6px 8px"},"aria-disabled":se||zr,children:[i.jsx("input",{type:"checkbox",checked:I,readOnly:!0,style:{marginRight:6}}),i.jsxs("span",{style:{fontWeight:800},children:["BTL",ie]})]},`card_btl_${ie}`)})})]})]}),Yr?i.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:Yr}):null]}),i.jsx("div",{style:{marginTop:14},children:ot?i.jsxs("div",{style:{position:"relative"},children:[i.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:i.jsx(Gm,{locked:!!(Wt||ye||Ue&&je),title:Wt?"Locked by IQAC":Re?"Published  Locked":"Table Locked",subtitle:Wt?"Publishing is turned OFF globally for this assessment.":Re?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:i.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:rt,colSpan:pe,children:[m.termLabel," | ",m.batchLabel," | ",a]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...rt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),i.jsx("th",{style:rt,rowSpan:4,children:"Register No."}),i.jsx("th",{style:rt,rowSpan:3,children:"Name of the Students"}),i.jsx("th",{style:rt,children:a}),null,i.jsx("th",{style:rt,colSpan:4,children:"CO ATTAINMENT"}),De.length?i.jsx("th",{style:rt,colSpan:De.length*2,children:"BTL ATTAINMENT"}):null]}),i.jsxs("tr",{children:[i.jsxs("th",{style:rt,children:[i.jsx("div",{style:{fontWeight:800},children:"COs"}),i.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,i.jsx("th",{style:rt,colSpan:2,children:"CO-3"}),i.jsx("th",{style:rt,colSpan:2,children:"CO-4"}),De.map(ie=>i.jsxs("th",{style:rt,colSpan:2,children:["BTL-",ie]},`btl-head-${ie}`))]}),i.jsxs("tr",{children:[i.jsxs("th",{style:rt,children:[i.jsx("div",{style:{fontWeight:800},children:"BTL"}),i.jsx("div",{style:{fontSize:12},children:De.length?De.join(","):"-"})]}),null,Array.from({length:2+De.length}).flatMap((ie,I)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:rt,children:"Mark"}),i.jsx("th",{style:rt,children:"%"})]},I))]}),i.jsxs("tr",{children:[i.jsx("th",{style:rt,children:"Name / Max Marks"}),i.jsx("th",{style:rt,children:w}),null,i.jsx("th",{style:rt,children:C.co3}),i.jsx("th",{style:rt,children:"%"}),i.jsx("th",{style:rt,children:C.co4}),i.jsx("th",{style:rt,children:"%"}),De.flatMap(ie=>[i.jsx("th",{style:rt,children:String(s?A:Math.max(Number(j[`btl${ie}`]??0)||0,yp))},`btl-max-${ie}`),i.jsx("th",{style:rt,children:"%"},`btl-pct-${ie}`)])]})]}),i.jsx("tbody",{children:m.rows.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:pe,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):Ce&&!ye?i.jsx("tr",{children:i.jsx("td",{colSpan:pe,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):m.rows.map((ie,I)=>{const se=typeof ie.total=="number"?Ks(Number(ie.total),0,w):null,ve=se==null?null:Nl(se/2),Pe=ve==null?null:Ks(ve,0,C.co3),Ke=ve==null?null:Ks(ve,0,C.co4),pt=De.map(mt=>mt-1),Lt=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((mt,_t)=>pt.includes(_t)?s?A:mt>0?mt:yp:mt),Sr=se==null?null:pt.length?Nl(se/pt.length):0,hr=Lt.map((mt,_t)=>se==null||!pt.includes(_t)?null:mt>0?Ks(Sr,0,mt):Nl(Sr));return i.jsxs("tr",{style:{background:I%2===1?"#f8fafc":"#fff"},children:[i.jsx("td",{style:{...Rt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:I+1}),i.jsx("td",{style:Rt,children:Ub(ie.registerNo)}),i.jsx("td",{style:Rt,children:ie.name}),i.jsx("td",{style:{...Rt,width:90,background:"#fff7ed"},children:it?i.jsx("div",{style:Gt,children:typeof ie.total=="number"?Nl(ie.total):""}):i.jsx("input",{style:Gt,type:"number",value:ie.total,min:0,max:w,onChange:mt=>{if(it)return;const _t=mt.target.value;if(_t==="")return fr(I,{total:""});const cr=Number(_t);if(!Number.isFinite(cr))return fr(I,{total:""});if(cr>w){mt.currentTarget.setCustomValidity(`Max mark is ${w}`),mt.currentTarget.reportValidity(),window.setTimeout(()=>mt.currentTarget.setCustomValidity(""),0);return}mt.currentTarget.setCustomValidity("");const sr=Ks(cr,0,w);fr(I,{total:sr})}})}),null,i.jsx("td",{style:{...Rt,textAlign:"center"},children:Pe??""}),i.jsx("td",{style:{...Rt,textAlign:"center"},children:rl(Pe,C.co3)}),i.jsx("td",{style:{...Rt,textAlign:"center"},children:Ke??""}),i.jsx("td",{style:{...Rt,textAlign:"center"},children:rl(Ke,C.co4)}),De.map(mt=>{const _t=mt-1,cr=hr[_t],sr=Lt[_t];return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Rt,textAlign:"center"},children:cr??""}),i.jsx("td",{style:{...Rt,textAlign:"center"},children:rl(cr,sr)})]},mt)})]},String(ie.studentId||I))})})]})})}),We&&ot?i.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[i.jsx("div",{style:{textAlign:"center"},children:Re?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),i.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Table Locked"}),i.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Confirm the Mark Manager"})]})}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[i.jsx("button",{className:"obe-btn",onClick:()=>L(!0),children:"View"}),i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>q(!0),children:"Request Edit"})]})]}):null]}):i.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:i.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[i.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:Re&&ot?"Published  Locked":"Table Locked"}),i.jsx("div",{style:{color:"#6b7280",marginTop:6},children:Re&&ot?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),i.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:Re&&ot?i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"obe-btn",onClick:()=>L(!0),children:"View"}),i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>q(!0),children:"Request Edit"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Nr({mode:"confirm"}),disabled:!e||zr,children:"Save Mark Manager"}),i.jsx("button",{className:"obe-btn",onClick:()=>Ut(),disabled:zr,children:"Request Access"})]})})]})})}),Y?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:70},onClick:()=>L(!1),children:i.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:ie=>ie.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),i.jsx("button",{onClick:ie=>{ie.stopPropagation(),L(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),i.jsxs("div",{style:{padding:14},children:[W?i.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,he?i.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:he}):null]}),i.jsx("div",{ref:bt,style:{overflow:"auto",borderTop:"1px solid #e5e7eb",borderBottom:"1px solid #e5e7eb",borderLeft:"1px solid #e5e7eb",borderRight:"1px solid #e5e7eb",borderRadius:0,maxHeight:"60vh",background:"#fff"},children:i.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:i.jsxs("th",{style:rt,colSpan:pe,children:[m.termLabel," | ",m.batchLabel," | ",a]})}),i.jsxs("tr",{children:[i.jsx("th",{style:{...rt,width:42,minWidth:42},rowSpan:4,children:"S.No"}),i.jsx("th",{style:rt,rowSpan:4,children:"Register No."}),i.jsx("th",{style:rt,rowSpan:3,children:"Name of the Students"}),i.jsx("th",{style:rt,children:a}),null,i.jsx("th",{style:rt,colSpan:4,children:"CO ATTAINMENT"}),De.length?i.jsx("th",{style:rt,colSpan:De.length*2,children:"BTL ATTAINMENT"}):null]}),i.jsxs("tr",{children:[i.jsxs("th",{style:rt,children:[i.jsx("div",{style:{fontWeight:800},children:"COs"}),i.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,i.jsx("th",{style:rt,colSpan:2,children:"CO-3"}),i.jsx("th",{style:rt,colSpan:2,children:"CO-4"}),De.map(ie=>i.jsxs("th",{style:rt,colSpan:2,children:["BTL-",ie]},`btl-head-${ie}`))]}),i.jsxs("tr",{children:[i.jsxs("th",{style:rt,children:[i.jsx("div",{style:{fontWeight:800},children:"BTL"}),i.jsx("div",{style:{fontSize:12},children:De.length?De.join(","):"-"})]}),null,Array.from({length:2+De.length}).flatMap((ie,I)=>i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:rt,children:"Mark"}),i.jsx("th",{style:rt,children:"%"})]},I))]}),i.jsxs("tr",{children:[i.jsx("th",{style:rt,children:"Name / Max Marks"}),i.jsx("th",{style:rt,children:w}),null,i.jsx("th",{style:rt,children:C.co3}),i.jsx("th",{style:rt,children:"%"}),i.jsx("th",{style:rt,children:C.co4}),i.jsx("th",{style:rt,children:"%"}),De.flatMap(ie=>[i.jsx("th",{style:rt,children:String(s?A:Math.max(Number(j[`btl${ie}`]??0)||0,yp))},`btl-max-${ie}`),i.jsx("th",{style:rt,children:"%"},`btl-pct-${ie}`)])]})]}),i.jsx("tbody",{children:m.rows.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:pe,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):m.rows.map((ie,I)=>{var cr;const se=((cr=U==null?void 0:U.marks)==null?void 0:cr[String(ie.studentId)])??null,ve=se==null||se===""?null:Ks(Number(se),0,w),Ke=ve==null?null:Nl(ve/2),pt=Ke==null?null:Ks(Ke,0,C.co3),ut=Ke==null?null:Ks(Ke,0,C.co4),Lt=De.map(sr=>sr-1),hr=[j.btl1,j.btl2,j.btl3,j.btl4,j.btl5,j.btl6].map((sr,pr)=>Lt.includes(pr)?s?A:sr>0?sr:yp:sr),mt=ve==null?null:Lt.length?Nl(ve/Lt.length):0,_t=hr.map((sr,pr)=>ve==null||!Lt.includes(pr)?null:sr>0?Ks(mt,0,sr):Nl(mt));return i.jsxs("tr",{style:{background:I%2===1?"#f8fafc":"#fff"},children:[i.jsx("td",{style:{...Rt,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:I+1}),i.jsx("td",{style:Rt,children:Ub(ie.registerNo)}),i.jsx("td",{style:Rt,children:ie.name}),i.jsx("td",{style:{...Rt,width:90,background:"#fff7ed",textAlign:"center"},children:ve==null?"":Nl(ve)}),null,i.jsx("td",{style:{...Rt,textAlign:"center"},children:pt??""}),i.jsx("td",{style:{...Rt,textAlign:"center"},children:rl(pt,C.co3)}),i.jsx("td",{style:{...Rt,textAlign:"center"},children:ut??""}),i.jsx("td",{style:{...Rt,textAlign:"center"},children:rl(ut,C.co4)}),De.map(sr=>{const pr=sr-1,Dr=_t[pr],qr=hr[pr];return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...Rt,textAlign:"center"},children:Dr??""}),i.jsx("td",{style:{...Rt,textAlign:"center"},children:rl(Dr,qr)})]},sr)})]},String(ie.studentId||I))})})]})}),i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:i.jsx("button",{className:"obe-btn",onClick:()=>L(!1),children:"Close"})})]})}):null,Rr?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:9999},onClick:()=>{zr||Nr(null)},children:i.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ie=>ie.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:Rr.mode==="confirm"?`Confirmation - ${a}`:`Request Edit - ${a}`}),i.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:a})]}),Rr.mode==="confirm"?i.jsxs(i.Fragment,{children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{background:"#f9fafb"},children:[i.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),i.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",a]}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-3 max"}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:C.co3})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-4 max"}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:C.co4})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),i.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:i.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(ie=>{const I=re.includes(ie);return i.jsxs("div",{onClick:()=>{zr||xe(se=>se.includes(ie)?se.filter(ve=>ve!==ie):[...se,ie].sort((ve,Pe)=>ve-Pe))},style:{...ir,borderColor:I?"#16a34a":"#cbd5e1",background:I?"#ecfdf5":"#fff",cursor:zr?"not-allowed":"pointer",padding:"6px 8px"},children:[i.jsx("input",{type:"checkbox",checked:I,readOnly:!0,style:{marginRight:6}}),i.jsxs("span",{style:{fontWeight:800},children:["BTL",ie]})]},`modal_btl_${ie}`)})})})]})]})]})})]}):i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[i.jsx("button",{className:"obe-btn",disabled:zr,onClick:()=>Nr(null),children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-success",disabled:zr||!e,onClick:async()=>{if(e){if(Rr.mode==="request"){Nr(null),await Ut();return}await $t()}},children:Rr.mode==="confirm"?"Confirm":"Send Request"})]})]})}):null,J?i.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>q(!1),children:i.jsxs("div",{style:{width:"min(560px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:ie=>ie.stopPropagation(),children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[i.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Edit Request"}),i.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:a})]}),i.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[i.jsxs("div",{children:[i.jsx("strong",{children:"Subject:"})," ",String(e||"")]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Published:"})," ",z||""]}),i.jsxs("div",{children:[i.jsx("strong",{children:"Saved:"})," ",Z||""]})]}),i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{type:"button",className:"obe-btn",onClick:()=>q(!1),children:"Close"}),i.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",onClick:async()=>{await Kr(),q(!1)},children:"Request Edit"})]})]})}):null,i.jsx("style",{children:`
        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),i.jsx("div",{style:{marginTop:14},children:ot?i.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"}}):null})]})})}function mxe({subjectId:e,teachingAssignmentId:t,label:r}){return i.jsx(kz,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review2",label:r||"Review 2"})}function gxe({subjectId:e,teachingAssignmentId:t,label:r}){return i.jsx(_z,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa1",label:r||"SSA1"})}function xxe({subjectId:e,teachingAssignmentId:t,label:r}){return i.jsx(kz,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa2",label:r||"SSA2"})}const zb=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],bL=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function cd(e,t,r){return Math.max(t,Math.min(r,e))}function yxe(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function vL(e,t){if(Array.isArray(e)){const r=e.slice(0,t).map(n=>typeof n=="number"&&Number.isFinite(n)?n:"");for(;r.length<t;)r.push("");return r}return new Array(t).fill("")}function wL(e){const t=(e||[]).filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function ys(e){return Math.round(e*100)/100}function bxe(e,t){const r=String(t||"").toLowerCase();return r==="ssa"?"SSA":r==="cia"?"CIA":r==="fa"?"FA":r==="review"?"REVIEW":r==="me"?"ME":r==="lab1"?"LAB1":r==="lab2"?"LAB2":String(t||"").toUpperCase()}function Dc(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function vxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const a=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return a.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function SL(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),a=n.includes("1"),s=n.includes("2");if(a&&s||n==="1&2"||n==="1,2"||n==="1/2"||n==="2/1"||n==="CO1&CO2"||n==="CO1,CO2"||n==="CO1/CO2"||n==="CO2/CO1")return"1&2";if(n==="CO2"||n==="2")return 2;if(n==="CO1"||n==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const a=n.match(/\d+/);return Number(a?a[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===2?2:t===12?"1&2":1}function _L(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),a=n.includes("3"),s=n.includes("4");if(a&&s)return"3&4";if(s)return 4;if(a)return 3;if(n==="3&4"||n==="3,4"||n==="3/4"||n==="4/3"||n==="CO3&CO4"||n==="CO3,CO4"||n==="CO3/CO4"||n==="CO4/CO3")return"3&4";if(n==="CO4"||n==="4")return 4;if(n==="CO3"||n==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const a=n.match(/\d+/);return Number(a?a[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===4?4:t===3?3:t===34?"3&4":3}function wxe(e,t){const r=e[t];if(!r)return{co1:0,co2:0};const n=SL(r.co);if(n==="1&2")return{co1:.5,co2:.5};const a=e.some(u=>SL(u==null?void 0:u.co)==="1&2"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!a&&s&&c?{co1:.5,co2:.5}:n===2?{co1:0,co2:1}:{co1:1,co2:0}}function Sxe(e,t){const r=e[t];if(!r)return{co3:0,co4:0};const n=_L(r.co);if(n==="3&4")return{co3:.5,co4:.5};const a=e.some(u=>_L(u==null?void 0:u.co)==="3&4"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!a&&s&&c?{co3:.5,co4:.5}:n===4?{co3:0,co4:1}:{co3:1,co4:0}}function _xe({subjectId:e,teachingAssignmentId:t,classType:r,enabledAssessments:n,assessmentType:a,cos:s,cqiDivider:o,cqiMultiplier:l}){var F,ee;const[c,u]=x.useState([]),[d,f]=x.useState(!1),[p,h]=x.useState(null),[m,g]=x.useState({}),[b,y]=x.useState({}),[v,w]=x.useState({}),[_,C]=x.useState(null),[j,A]=x.useState(null),M=58,P=x.useMemo(()=>{const z=Number(o);if(Number.isFinite(z)&&z>0)return z;const X=Number(j==null?void 0:j.divider);return Number.isFinite(X)&&X>0?X:2},[o,j]),R=x.useMemo(()=>{const z=Number(l);if(Number.isFinite(z)&&z>=0)return z;const X=Number(j==null?void 0:j.multiplier);return Number.isFinite(X)&&X>=0?X:.15},[l,j]),[N,T]=x.useState(!0),[B,G]=x.useState(!0),[re,xe]=x.useState(null),[_e,V]=x.useState(!0),[K,de]=x.useState(!1);x.useEffect(()=>{let z=!0;return(async()=>{try{const X=await cS();if(!z)return;const J=Number(X==null?void 0:X.divider),q=Number(X==null?void 0:X.multiplier);A({options:Array.isArray(X==null?void 0:X.options)?X.options:[],divider:Number.isFinite(J)?J:2,multiplier:Number.isFinite(q)?q:.15})}catch{z&&A(null)}})(),()=>{z=!1}},[]);const ne=x.useMemo(()=>!s||!Array.isArray(s)?[]:s.map(z=>{const X=z.match(/\d+/);return X?parseInt(X[0]):null}).filter(z=>z!==null).sort((z,X)=>z-X),[s]),E=x.useMemo(()=>{const z={};return ne.forEach(X=>{const J=`co${X}`;let q=null;Object.values(m).forEach(Y=>{const L=Y&&Y[J];if(L&&typeof L.max=="number"){const U=L.max;(q==null||U>q)&&(q=U)}}),z[X]=q}),z},[m,ne]);x.useEffect(()=>{let z=!0;return(async()=>{try{const X=await iu();if(!z)return;C(X||null)}catch{}})(),()=>{z=!1}},[e]),x.useEffect(()=>{if(!t)return;let z=!0;return f(!0),h(null),(async()=>{try{const X=await Ac(t);if(!z)return;const J=(X.students||[]).map(q=>({id:Number(q.id),reg_no:String(q.reg_no??""),name:String(q.name??""),section:q.section??null})).filter(q=>Number.isFinite(q.id)).sort(vxe);u(J)}catch(X){if(!z)return;h((X==null?void 0:X.message)||"Failed to load roster")}finally{z&&f(!1)}})(),()=>{z=!1}},[t]),x.useEffect(()=>{if(!e||!t)return;const z=`cqi_entries_${e}_${t}`,X=Pn(z);X&&typeof X=="object"&&(y(X),de(!1)),(async()=>{try{const J=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",q=await fetchWithAuth(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${J}`,{method:"GET"}).catch(()=>null);if(q&&q.ok){const Y=await q.json().catch(()=>null);Y!=null&&Y.draft&&(y(Y.draft.entries||Y.draft||{}),xe({updated_at:Y.updated_at||null,updated_by:Y.updated_by||null}),de(!1))}}catch{}})()},[e,t]),x.useEffect(()=>{if(!e||!t||c.length===0||ne.length===0)return;let z=!0;return(async()=>{var X,J,q,Y,L,U,ce,W,ae,he,ze,ke,qe,Ie,Ve,Qe,Tt,vt,Xe,Be,ct,nt,Se,Te,Dt,wt;try{f(!0);const Pt=In(r),Wt=yxe(n),Ot=Pt==="SPECIAL"&&Wt.size,Ht=$t=>Ot?Wt.has(String($t).toLowerCase()):!0,Pr=Pt==="TCPR",jt=Pt==="TCPL",ur=Pt==="LAB"||Pt==="PRACTICAL",Rr=!ur&&Pt!=="SPECIAL"&&ne.some($t=>$t>=1&&$t<=5),Nr=(()=>{if(!Rr)return null;const $t=String(t??"none"),fr=[];Pt==="THEORY"?(fr.push(`model_theory_sheet_${e}_${$t}`),fr.push(`model_theory_sheet_${e}_none`)):Pt==="TCPL"?(fr.push(`model_tcpl_sheet_${e}_${$t}`),fr.push(`model_tcpl_sheet_${e}_none`)):Pt==="TCPR"&&(fr.push(`model_tcpr_sheet_${e}_${$t}`),fr.push(`model_tcpr_sheet_${e}_none`)),fr.push(`model_sheet_${e}`);for(const Or of fr){const gt=Pn(Or);if(gt&&typeof gt=="object")return gt}return null})(),zr=(()=>{const $t={co1:0,co2:0,co3:0,co4:0,co5:0};for(let fr=0;fr<zb.length;fr++){const Or=zb[fr],gt=bL[fr];gt===1?$t.co1+=Or.max:gt===2?$t.co2+=Or.max:gt===3?$t.co3+=Or.max:gt===4?$t.co4+=Or.max:gt===5&&($t.co5+=Or.max)}return $t})(),_n=$t=>{if(!Nr)return null;const fr=`id:${String($t.id)}`,Or=$t.reg_no?`reg:${String($t.reg_no).trim()}`:"",gt=Nr[fr]||(Or?Nr[Or]:null)||null;if(!gt||typeof gt!="object")return null;const Jt=!!gt.absent,ht=String(gt.absentKind||"AL").toUpperCase();if(Jt&&ht==="AL")return null;const Ct=gt.q&&typeof gt.q=="object"?gt.q:gt;let rr=!1;const kt={co1:0,co2:0,co3:0,co4:0,co5:0};for(let Rt=0;Rt<zb.length;Rt++){const Gt=zb[Rt],ir=Dc(Ct[Gt.key]);if(ir==null)continue;rr=!0;const Bt=bL[Rt];Bt===1?kt.co1+=ir:Bt===2?kt.co2+=ir:Bt===3?kt.co3+=ir:Bt===4?kt.co4+=ir:Bt===5&&(kt.co5+=ir)}if(!rr)return null;const rt=(Rt,Gt,ir)=>!Gt||!Number.isFinite(Gt)||Gt<=0?0:cd(cd(Rt,0,Gt)/Gt*ir,0,ir);return{co1:rt(kt.co1,zr.co1,2),co2:rt(kt.co2,zr.co2,2),co3:rt(kt.co3,zr.co3,2),co4:rt(kt.co4,zr.co4,2),co5:rt(kt.co5,zr.co5,4)}},Yr=ne.some($t=>$t===1||$t===2),pn=ne.some($t=>$t===3||$t===4),ge=ne.some($t=>$t===5),[Ne,dt,Ue,Re,xt,at,er,oe,ue,Q,ye,je,Ce]=await Promise.all([Yr&&Ht("ssa1")&&!ur?Vm(e,t).catch(()=>({marks:{}})):{marks:{}},pn&&Ht("ssa2")&&!ur?H1(e,t).catch(()=>({marks:{}})):{marks:{}},Yr&&Ht("formative1")&&!ur&&!Pr&&!jt?hS(e,t).catch(()=>({marks:{}})):{marks:{}},pn&&Ht("formative2")&&!ur&&!Pr&&!jt?f0("formative2",e,t).catch(()=>({marks:{}})):{marks:{}},Yr&&Ht("cia1")&&!ur?V1(e,t).catch(()=>({data:null})):{data:null},pn&&Ht("cia2")&&!ur?h0("cia2",e,t).catch(()=>({data:null})):{data:null},Yr&&Ht("review1")&&Pr?dS(e).catch(()=>({marks:{}})):{marks:{}},pn&&Ht("review2")&&Pr?fS(e).catch(()=>({marks:{}})):{marks:{}},Yr&&Ht("formative1")&&jt?(async()=>{try{const $t=await Mn("formative1",e,t);if($t!=null&&$t.draft)return{data:$t.draft.data??$t.draft}}catch{}return no("formative1",e,t).catch(()=>({data:null}))})():{data:null},pn&&Ht("formative2")&&jt?(async()=>{try{const $t=await Mn("formative2",e,t);if($t!=null&&$t.draft)return{data:$t.draft.data??$t.draft}}catch{}return no("formative2",e,t).catch(()=>({data:null}))})():{data:null},Yr&&Ht("cia1")&&ur?(async()=>{try{const $t=await Mn("cia1",e,t);if($t!=null&&$t.draft)return{data:$t.draft.data??$t.draft}}catch{}return no("cia1",e,t).catch(()=>({data:null}))})():{data:null},pn&&Ht("cia2")&&ur?(async()=>{try{const $t=await Mn("cia2",e,t);if($t!=null&&$t.draft)return{data:$t.draft.data??$t.draft}}catch{}return no("cia2",e,t).catch(()=>({data:null}))})():{data:null},ge&&Ht("model")&&ur?(async()=>{try{const $t=await Mn("model",e,t);if($t!=null&&$t.draft)return{data:$t.draft.data??$t.draft}}catch{}return Am(e,t).catch(()=>({data:null}))})():{data:null}]);if(!z)return;const ot={ssa:1.5,cia:3,fa:2.5},it={ssa:ot.ssa,cia:ot.cia,fa:ot.fa},We=((X=_==null?void 0:_.assessments)==null?void 0:X.ssa1)||{},De=((J=_==null?void 0:_.assessments)==null?void 0:J.ssa2)||{},pe=((q=_==null?void 0:_.assessments)==null?void 0:q.formative1)||{},Je=((Y=_==null?void 0:_.assessments)==null?void 0:Y.formative2)||{},Ge=((L=_==null?void 0:_.assessments)==null?void 0:L.cia1)||{},Ye=((U=_==null?void 0:_.assessments)==null?void 0:U.cia2)||{},ft=((ce=_==null?void 0:_.assessments)==null?void 0:ce.review1)||{},bt=((W=_==null?void 0:_.assessments)==null?void 0:W.review2)||{},Vt={ssa1:{co1:Number((ae=We==null?void 0:We.coMax)==null?void 0:ae.co1)||10,co2:Number((he=We==null?void 0:We.coMax)==null?void 0:he.co2)||10},ssa2:{co3:Number(((ze=De==null?void 0:De.coMax)==null?void 0:ze.co3)??((ke=De==null?void 0:De.coMax)==null?void 0:ke.co1))||10,co4:Number(((qe=De==null?void 0:De.coMax)==null?void 0:qe.co4)??((Ie=De==null?void 0:De.coMax)==null?void 0:Ie.co2))||10},cia1:{co1:Number((Ve=Ge==null?void 0:Ge.coMax)==null?void 0:Ve.co1)||30,co2:Number((Qe=Ge==null?void 0:Ge.coMax)==null?void 0:Qe.co2)||30},cia2:{co3:Number(((Tt=Ye==null?void 0:Ye.coMax)==null?void 0:Tt.co3)??((vt=Ye==null?void 0:Ye.coMax)==null?void 0:vt.co1))||30,co4:Number(((Xe=Ye==null?void 0:Ye.coMax)==null?void 0:Xe.co4)??((Be=Ye==null?void 0:Ye.coMax)==null?void 0:Be.co2))||30},f1:{co1:Number(pe==null?void 0:pe.maxCo)||10,co2:Number(pe==null?void 0:pe.maxCo)||10},f2:{co3:Number(Je==null?void 0:Je.maxCo)||10,co4:Number(Je==null?void 0:Je.maxCo)||10},review1:{co1:Number((ct=ft==null?void 0:ft.coMax)==null?void 0:ct.co1)||15,co2:Number((nt=ft==null?void 0:ft.coMax)==null?void 0:nt.co2)||15},review2:{co3:Number(((Se=bt==null?void 0:bt.coMax)==null?void 0:Se.co3)??((Te=bt==null?void 0:bt.coMax)==null?void 0:Te.co1))||15,co4:Number(((Dt=bt==null?void 0:bt.coMax)==null?void 0:Dt.co4)??((wt=bt==null?void 0:bt.coMax)==null?void 0:wt.co2))||15}},Ft=$t=>{const fr=$t!=null&&$t.sheet&&typeof $t.sheet=="object"?$t.sheet:{},Or=fr!=null&&fr.rowsByStudentId&&typeof fr.rowsByStudentId=="object"?fr.rowsByStudentId:{},gt=cd(Number((fr==null?void 0:fr.expCountA)??0),0,12),Jt=cd(Number((fr==null?void 0:fr.expCountB)??0),0,12),ht=Number.isFinite(Number(fr==null?void 0:fr.expMaxA))?Number(fr.expMaxA):25,Ct=Number.isFinite(Number(fr==null?void 0:fr.expMaxB))?Number(fr.expMaxB):25,rr=(fr==null?void 0:fr.ciaExamEnabled)!==!1,kt=30/2,rt=ht+(rr?kt:0),Rt=Ct+(rr?kt:0);return{get:ir=>{const Bt=Or[String(ir)]||{},vr=vL(Bt==null?void 0:Bt.marksA,gt),Cr=vL(Bt==null?void 0:Bt.marksB,Jt),Tr=wL(vr),xr=wL(Cr),Xt=Bt==null?void 0:Bt.ciaExam,ie=typeof Xt=="number"&&Number.isFinite(Xt)?Xt:null,I=Tr!=null||xr!=null||ie!=null,se=I?(Tr??0)+(rr?(ie??0)/2:0):null,ve=I?(xr??0)+(rr?(ie??0)/2:0):null;return{a:se==null?null:cd(se,0,rt),b:ve==null?null:cd(ve,0,Rt)}},CO_MAX_A:rt,CO_MAX_B:Rt}},gr=jt?Ft((ue==null?void 0:ue.data)??null):null,Ar=jt?Ft((Q==null?void 0:Q.data)??null):null,kr=ur?Ft((ye==null?void 0:ye.data)??null):null,At=ur?Ft((je==null?void 0:je.data)??null):null,Ut=ur?Ft((Ce==null?void 0:Ce.data)??null):null,Kr={};c.forEach($t=>{Kr[$t.id]={};const fr=Rr?_n($t):null;ne.forEach(Or=>{let gt=null,Jt=0,ht=null,Ct=0,rr=null,kt=0,rt=null,Rt=0,Gt=null,ir=0;if(fr){const vr=`co${Or}`;vr in fr&&(Gt=Number(fr[vr]),ir=Or===5?4:2)}if(Or===1||Or===2)if(ur){if(kr){const vr=kr.get($t.id),Cr=Or===1?vr.a:vr.b;Cr!=null&&(ht=Cr,Ct=Or===1?kr.CO_MAX_A:kr.CO_MAX_B)}}else{const vr=Dc(Ne.marks[String($t.id)]);gt=vr==null?null:Number(vr)/2,Jt=Or===1?Vt.ssa1.co1:Vt.ssa1.co2;const Tr=xt.data;if(Tr){const Xt=(Tr.rowsByStudentId||{})[String($t.id)]||{},ie=Tr.questions||[],I=Xt!=null&&Xt.q&&typeof Xt.q=="object"?Xt.q:Xt;let se=!1,ve=0,Pe=0;ie.forEach((Ke,pt)=>{const ut=Number((Ke==null?void 0:Ke.max)||0),Lt=wxe(ie,pt),Sr=Or===2?Lt.co2:Lt.co1;Sr>0&&ut>0&&(Pe+=ut*Sr);const hr=Dc(I==null?void 0:I[Ke.key]);if(hr==null||Sr<=0)return;se=!0;const mt=ut>0?cd(hr,0,ut):hr;ve+=mt*Sr}),se&&(ht=ve,Ct=Pe>0?Pe:Or===1?Vt.cia1.co1:Vt.cia1.co2)}if(Pr){const xr=Dc(er.marks[String($t.id)]),Xt=xr==null?null:Number(xr)/2;Xt!=null&&(rr=Xt,kt=Or===1?Vt.review1.co1:Vt.review1.co2)}if(jt&&gr){const xr=gr.get($t.id),Xt=Or===1?xr.a:xr.b;Xt!=null&&(rt=Xt,Rt=Or===1?gr.CO_MAX_A:gr.CO_MAX_B)}if(!Pr&&!jt){const xr=(Ue.marks||{})[String($t.id)]||{},Xt=Or===1?"skill1":"skill2",ie=Or===1?"att1":"att2",I=Dc(xr[Xt]),se=Dc(xr[ie]);I!==null&&se!==null&&(rt=I+se,Rt=Or===1?Vt.f1.co1:Vt.f1.co2)}}else if(Or===3||Or===4)if(ur){if(At){const vr=At.get($t.id),Cr=Or===3?vr.a:vr.b;Cr!=null&&(ht=Cr,Ct=Or===3?At.CO_MAX_A:At.CO_MAX_B)}}else{const vr=Dc(dt.marks[String($t.id)]);gt=vr==null?null:Number(vr)/2,Jt=Or===3?Vt.ssa2.co3:Vt.ssa2.co4;const Tr=at.data;if(Tr){const Xt=(Tr.rowsByStudentId||{})[String($t.id)]||{},ie=Tr.questions||[],I=Xt!=null&&Xt.q&&typeof Xt.q=="object"?Xt.q:Xt;let se=!1,ve=0,Pe=0;ie.forEach((Ke,pt)=>{const ut=Number((Ke==null?void 0:Ke.max)||0),Lt=Sxe(ie,pt),Sr=Or===4?Lt.co4:Lt.co3;Sr>0&&ut>0&&(Pe+=ut*Sr);const hr=Dc(I==null?void 0:I[Ke.key]);if(hr==null||Sr<=0)return;se=!0;const mt=ut>0?cd(hr,0,ut):hr;ve+=mt*Sr}),se&&(ht=ve,Ct=Pe>0?Pe:Or===3?Vt.cia2.co3:Vt.cia2.co4)}if(Pr){const xr=Dc(oe.marks[String($t.id)]),Xt=xr==null?null:Number(xr)/2;Xt!=null&&(rr=Xt,kt=Or===3?Vt.review2.co3:Vt.review2.co4)}if(jt&&Ar){const xr=Ar.get($t.id),Xt=Or===3?xr.a:xr.b;Xt!=null&&(rt=Xt,Rt=Or===3?Ar.CO_MAX_A:Ar.CO_MAX_B)}if(!Pr&&!jt){const xr=(Re.marks||{})[String($t.id)]||{},Xt=Or===3?"skill1":"skill2",ie=Or===3?"att1":"att2",I=Dc(xr[Xt]),se=Dc(xr[ie]);I!==null&&se!==null&&(rt=I+se,Rt=Or===3?Vt.f2.co3:Vt.f2.co4)}}if(ur&&Or===5&&Ut){const vr=Ut.get($t.id);vr.a!=null&&(Gt=vr.a,ir=Ut.CO_MAX_A)}const Bt=[];if(gt!==null&&Jt>0&&Bt.push({key:"ssa",mark:gt,max:Jt,w:it.ssa}),ht!==null&&Ct>0&&Bt.push({key:"cia",mark:ht,max:Ct,w:it.cia}),rr!==null&&kt>0&&Bt.push({key:"review",mark:rr,max:kt,w:it.fa}),rt!==null&&Rt>0){const vr=jt?Or===1||Or===2?"lab1":Or===3||Or===4?"lab2":"fa":"fa";Bt.push({key:vr,mark:rt,max:Rt,w:it.fa})}if(Gt!==null&&ir>0&&Bt.push({key:"me",mark:Gt,max:ir,w:ir}),Bt.length>0){const Cr=Bt.reduce((Xt,ie)=>Xt+ie.w,0),Tr=Bt.reduce((Xt,ie)=>{const I=ie.mark/ie.max;return Xt+I*ie.w},0),xr=Bt.map(Xt=>({...Xt,contrib:ys(Xt.mark/Xt.max*Xt.w)}));Kr[$t.id][`co${Or}`]={value:ys(Tr),max:ys(Cr),breakdown:xr}}else Kr[$t.id][`co${Or}`]=null})}),g(Kr)}catch(Pt){if(!z)return;h((Pt==null?void 0:Pt.message)||"Failed to calculate CO totals")}finally{z&&f(!1)}})(),()=>{z=!1}},[e,t,r,n,c,ne,_]);const Z=(z,X,J)=>{if(J===""){w(U=>{const ce={...U};return delete ce[`${z}_${X}`],ce}),y(U=>({...U,[z]:{...U[z],[X]:null}}));return}const q=Number(J);if(!(Number.isFinite(q)&&Math.floor(q)===q)){w(U=>({...U,[`${z}_${X}`]:"Enter an integer between 0 and 10"})),y(U=>({...U,[z]:{...U[z],[X]:null}}));return}const L=q;if(L<0||L>10){w(U=>({...U,[`${z}_${X}`]:"Value must be between 0 and 10"})),y(U=>({...U,[z]:{...U[z],[X]:L}}));return}w(U=>{const ce={...U};return delete ce[`${z}_${X}`],ce}),y(U=>{const ce={...U,[z]:{...U[z],[X]:L}};if(e&&t){const W=`cqi_entries_${e}_${t}`;try{Sn(W,ce)}catch{}}return de(!0),ce})},H=()=>{if(!(!e||!t)){if(Object.keys(v).length){alert("Fix CQI input errors before saving");return}(async()=>{const z=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"";try{const J=await fetchWithAuth(`/api/obe/cqi-save/${encodeURIComponent(String(e))}${z}`,{method:"PUT",body:JSON.stringify({entries:b})}).catch(()=>null);if(J&&J.ok){alert("CQI entries saved to server"),de(!1);try{const q=await J.json().catch(()=>null);q&&xe(q)}catch{}return}}catch{}const X=`cqi_entries_${e}_${t}`;try{Sn(X,b),de(!1),alert("CQI entries saved locally")}catch(J){alert("Failed to save CQI entries: "+String((J==null?void 0:J.message)||J))}})()}};return!e||!t?i.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"Missing subject ID or teaching assignment ID"}):d?i.jsx("div",{style:{padding:24,textAlign:"center",color:"#6b7280"},children:"Loading CQI data..."}):p?i.jsxs("div",{style:{padding:24,color:"#b91c1c"},children:["Error: ",p]}):ne.length===0?i.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"No course outcomes selected for CQI entry"}):i.jsxs("div",{style:{padding:12},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:16,background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",borderRadius:12,border:"1px solid #bae6fd"},children:[i.jsxs("div",{children:[i.jsxs("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:["CQI Entry - ",s==null?void 0:s.join(", ")]}),i.jsxs("div",{style:{marginTop:4,fontSize:14,color:"#64748b"},children:["Students below ",M,"% threshold require CQI intervention"]})]}),i.jsx("button",{onClick:H,className:"obe-btn obe-btn-primary",style:{minWidth:100},children:"Save CQI"}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("button",{type:"button",onClick:()=>T(z=>!z),className:"obe-btn",style:{minWidth:90,background:N?"#fef3c7":void 0},children:N?"DEBUG ON":"DEBUG"}),i.jsx("button",{type:"button",onClick:()=>G(z=>!z),className:"obe-btn",style:{minWidth:120},children:B?"Hide Header Max":"Show Header Max"}),i.jsx("button",{type:"button",onClick:async()=>{if(!e||!t)return alert("Missing subject/teaching assignment");try{const z={entries:b},X=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",J=await fetchWithAuth(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${X}`,{method:"PUT",body:JSON.stringify(z)}).catch(()=>null);if(J&&J.ok){const q=await J.json().catch(()=>null);xe(q||{updated_at:new Date().toISOString(),updated_by:null}),de(!1),alert("Draft saved to server")}else{const q=`cqi_entries_${e}_${t}`;try{Sn(q,b),de(!1),alert("Draft saved locally")}catch{alert("Failed to save draft")}}}catch(z){alert("Failed to save draft: "+String((z==null?void 0:z.message)||z))}},className:"obe-btn",style:{minWidth:110},children:"Save Draft"}),i.jsx("button",{type:"button",onClick:async()=>{if(!e)return alert("Missing subject");if(confirm("Publish CQI to DB? This action cannot be undone."))try{const z=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",X=await fetchWithAuth(`/api/obe/cqi-publish/${encodeURIComponent(String(e))}${z}`,{method:"POST"}).catch(()=>null);X&&X.ok?alert("CQI published"):alert("Publish failed (server may not support CQI publish)")}catch(z){alert("Publish failed: "+String((z==null?void 0:z.message)||z))}},className:"obe-btn obe-btn-primary",style:{minWidth:110},children:"Publish"})]})]}),i.jsxs("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",background:"#f8fafc",borderBottom:"1px solid #e6eef8"},children:[i.jsxs("div",{style:{fontSize:13,color:"#475569"},children:["Draft: ",re!=null&&re.updated_at?new Date(String(re.updated_at)).toLocaleString():"never"," ",re!=null&&re.updated_by?`by ${((F=re.updated_by)==null?void 0:F.name)||((ee=re.updated_by)==null?void 0:ee.username)||re.updated_by}`:"",K?"  unsaved changes":""]}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsxs("label",{style:{fontSize:13,color:"#475569"},children:[i.jsx("input",{type:"checkbox",checked:_e,onChange:()=>V(z=>!z)})," Auto-save"]}),i.jsx("button",{className:"obe-btn",onClick:()=>{(async()=>{if(!e||!t)return alert("Missing subject/TA");try{const z=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",X=await fetchWithAuth(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${z}`,{method:"PUT",body:JSON.stringify({entries:b})}).catch(()=>null);if(X&&X.ok){const J=await X.json().catch(()=>null);xe(J||null),de(!1),alert("Draft synced to server")}else alert("Server save failed")}catch(z){alert("Server save failed: "+String((z==null?void 0:z.message)||z))}})()},children:"Sync Draft"})]})]}),i.jsxs("table",{className:"cqi-table",style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[i.jsx("thead",{children:i.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},children:[i.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:60},children:"S.No"}),i.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:120},children:"Reg No"}),i.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:200},children:"Name"}),i.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["BEFORE CQI",i.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),i.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["AFTER CQI",i.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),i.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:120},children:["TOTAL",i.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Sum of selected COs"})]}),ne.map(z=>i.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:150},children:["CO",z,i.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:B?i.jsxs(i.Fragment,{children:["Max: ",E[z]!=null?ys(E[z]):""]}):i.jsx(i.Fragment,{children:""})})]},z))]})}),i.jsx("tbody",{children:c.map((z,X)=>{const J=m[z.id]||{};let q=0,Y=0;ne.forEach(Ie=>{const Ve=J[`co${Ie}`];Ve&&(q+=Ve.value,Y+=Ve.max)});const L=q,U=Y,ce=U?L/U*100:0,W=Y?q/Y*100:0,ae=U?ce:W,he=Y;let ze=q,ke=0;ne.forEach(Ie=>{var nt;const Ve=`co${Ie}`,Qe=J[Ve],Tt=(nt=b[z.id])==null?void 0:nt[Ve];if(!Qe||Tt==null||!((Qe.max?Number(Qe.value)/Number(Qe.max)*100:0)<M))return;const Be=Number(Tt)/10*Number(Qe.max),ct=ae<M?Be/P:Be*R;Number.isFinite(ct)&&ct>0&&(ke+=ct,ze+=ct)}),ze=Number.isFinite(ze)?cd(ze,0,he||ze):q;const qe=he?ze/he*100:0;return i.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:X%2===0?"white":"#f9fafb"},children:[i.jsx("td",{style:{padding:"10px 8px",color:"#64748b"},children:X+1}),i.jsx("td",{style:{padding:"10px 8px",fontFamily:"monospace",color:"#0f172a"},children:z.reg_no}),i.jsx("td",{style:{padding:"10px 8px",color:"#0f172a"},children:z.name}),i.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600},children:Y>0?i.jsxs("div",{children:[i.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[ys(q),!N&&Y>0?i.jsxs(i.Fragment,{children:[" / ",ys(Y)]}):null]}),i.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",ys(W),"%)"]})]}):i.jsx("span",{style:{color:"#94a3b8"},children:""})}),i.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600,backgroundColor:ze>q?"#f0fdf4":"transparent"},children:he>0?i.jsxs("div",{children:[i.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[ys(ze),!N&&he>0?i.jsxs(i.Fragment,{children:[" / ",ys(he)]}):null]}),i.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",ys(qe),"%)"]}),ke>0&&i.jsxs("div",{style:{fontSize:11,color:"#16a34a",marginTop:2},children:["+",ys(ke)]})]}):i.jsx("span",{style:{color:"#94a3b8"},children:""})}),i.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:700},children:U>0?i.jsxs("div",{style:{backgroundColor:ce<M?"#fff1f2":"transparent",padding:6,borderRadius:6},children:[i.jsxs("div",{style:{color:ce<M?"#ef4444":"#0f172a",fontSize:14,fontWeight:800},children:[ys(ce),"%"]}),i.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:6},children:[ys(L),!N&&U>0?i.jsxs(i.Fragment,{children:[" / ",ys(U)]}):null]})]}):i.jsx("span",{style:{color:"#94a3b8"},children:""})}),ne.map(Ie=>{var Be;const Ve=`co${Ie}`,Qe=J[Ve];if(!Qe)return i.jsx("td",{style:{padding:"10px 8px",textAlign:"center",color:"#94a3b8"},children:""},Ie);const Tt=Qe.max?Qe.value/Qe.max*100:0,vt=Tt<M,Xe=(Be=b[z.id])==null?void 0:Be[Ve];return i.jsxs("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:vt?"#fef2f2":"#f0fdf4"},children:[i.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:6},children:[i.jsxs("div",{children:[ys(Qe.value)," (",ys(Tt),"%)"]}),N?null:Array.isArray(Qe.breakdown)&&i.jsx("div",{style:{marginTop:6,fontSize:11,color:"#94a3b8"},children:Qe.breakdown.map(ct=>i.jsxs("div",{style:{display:"inline-block",marginRight:8},children:[bxe(In(r),String(ct.key||"")),": ",ys(ct.mark)," / ",ys(ct.max)," =",ys(ct.contrib)]},ct.key))})]}),vt?i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:11,color:"#dc2626",fontWeight:600,marginBottom:4},children:"CQI ATTAINED"}),i.jsx("input",{type:"number",value:Xe??"",onChange:ct=>Z(z.id,Ve,ct.target.value),placeholder:"Enter CQI",className:"obe-input",style:{width:90,padding:"4px 8px",fontSize:13,textAlign:"center"}}),v[`${z.id}_${Ve}`]&&i.jsx("div",{style:{color:"#dc2626",fontSize:11,marginTop:6},children:v[`${z.id}_${Ve}`]})]}):i.jsx("div",{style:{fontSize:12,color:"#16a34a",fontWeight:600},children:" NO CQI"})]},Ie)})]},z.id)})})]})]}),c.length===0&&i.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8"},children:"No students found in this section"})]})}function jz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=jz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function sa(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=jz(e))&&(n&&(n+=" "),n+=t);return n}var kxe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function nC(e){if(typeof e!="string")return!1;var t=kxe;return t.includes(e)}var jxe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],Axe=new Set(jxe);function Az(e){return typeof e!="string"?!1:Axe.has(e)}function Nz(e){return typeof e=="string"&&e.startsWith("data-")}function Ho(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Az(r)||Nz(r))&&(t[r]=e[r]);return t}function ih(e){if(e==null)return null;if(x.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Ho(t)}return typeof e=="object"&&!Array.isArray(e)?Ho(e):null}function To(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Az(r)||Nz(r)||nC(r))&&(t[r]=e[r]);return t}function Nxe(e){return e==null?null:x.isValidElement(e)?To(e.props):typeof e=="object"&&!Array.isArray(e)?To(e):null}var Cxe=["children","width","height","viewBox","className","style","title","desc"];function VA(){return VA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},VA.apply(null,arguments)}function Exe(e,t){if(e==null)return{};var r,n,a=Txe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Txe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var aC=x.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:s,className:o,style:l,title:c,desc:u}=e,d=Exe(e,Cxe),f=s||{width:n,height:a,x:0,y:0},p=sa("recharts-surface",o);return x.createElement("svg",VA({},To(d),{className:p,width:n,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),x.createElement("title",null,c),x.createElement("desc",null,u),r)}),Pxe=["children","className"];function GA(){return GA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},GA.apply(null,arguments)}function Oxe(e,t){if(e==null)return{};var r,n,a=Lxe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Lxe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ui=x.forwardRef((e,t)=>{var{children:r,className:n}=e,a=Oxe(e,Pxe),s=sa("recharts-layer",n);return x.createElement("g",GA({className:s},To(a),{ref:t}),r)}),Cz=x.createContext(null),Mxe=()=>x.useContext(Cz);function Ka(e){return function(){return e}}const Ez=Math.cos,U2=Math.sin,lu=Math.sqrt,z2=Math.PI,jS=2*z2,KA=Math.PI,XA=2*KA,Lh=1e-6,Fxe=XA-Lh;function Tz(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Rxe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Tz;const r=10**t;return function(n){this._+=n[0];for(let a=1,s=n.length;a<s;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class Bxe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?Tz:Rxe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,s,o){this._append`C${+t},${+r},${+n},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(t,r,n,a,s){if(t=+t,r=+r,n=+n,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-t,u=a-r,d=o-t,f=l-r,p=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>Lh)if(!(Math.abs(f*c-u*d)>Lh)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-o,m=a-l,g=c*c+u*u,b=h*h+m*m,y=Math.sqrt(g),v=Math.sqrt(p),w=s*Math.tan((KA-Math.acos((g+p-b)/(2*y*v)))/2),_=w/v,C=w/y;Math.abs(_-1)>Lh&&this._append`L${t+_*d},${r+_*f}`,this._append`A${s},${s},0,0,${+(f*h>d*m)},${this._x1=t+C*c},${this._y1=r+C*u}`}}arc(t,r,n,a,s,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(a),c=n*Math.sin(a),u=t+l,d=r+c,f=1^o,p=o?a-s:s-a;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Lh||Math.abs(this._y1-d)>Lh)&&this._append`L${u},${d}`,n&&(p<0&&(p=p%XA+XA),p>Fxe?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:p>Lh&&this._append`A${n},${n},0,${+(p>=KA)},${f},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function iC(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Bxe(t)}function sC(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Pz(e){this._context=e}Pz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function AS(e){return new Pz(e)}function Oz(e){return e[0]}function Lz(e){return e[1]}function Mz(e,t){var r=Ka(!0),n=null,a=AS,s=null,o=iC(l);e=typeof e=="function"?e:e===void 0?Oz:Ka(e),t=typeof t=="function"?t:t===void 0?Lz:Ka(t);function l(c){var u,d=(c=sC(c)).length,f,p=!1,h;for(n==null&&(s=a(h=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===p&&((p=!p)?s.lineStart():s.lineEnd()),p&&s.point(+e(f,u,c),+t(f,u,c));if(h)return s=null,h+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Ka(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Ka(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Ka(!!c),l):r},l.curve=function(c){return arguments.length?(a=c,n!=null&&(s=a(n)),l):a},l.context=function(c){return arguments.length?(c==null?n=s=null:s=a(n=c),l):n},l}function Wb(e,t,r){var n=null,a=Ka(!0),s=null,o=AS,l=null,c=iC(u);e=typeof e=="function"?e:e===void 0?Oz:Ka(+e),t=typeof t=="function"?t:Ka(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?Lz:Ka(+r);function u(f){var p,h,m,g=(f=sC(f)).length,b,y=!1,v,w=new Array(g),_=new Array(g);for(s==null&&(l=o(v=c())),p=0;p<=g;++p){if(!(p<g&&a(b=f[p],p,f))===y)if(y=!y)h=p,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=p-1;m>=h;--m)l.point(w[m],_[m]);l.lineEnd(),l.areaEnd()}y&&(w[p]=+e(b,p,f),_[p]=+t(b,p,f),l.point(n?+n(b,p,f):w[p],r?+r(b,p,f):_[p]))}if(v)return l=null,v+""||null}function d(){return Mz().defined(a).curve(o).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:Ka(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:Ka(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:Ka(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:Ka(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:Ka(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:Ka(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(a=typeof f=="function"?f:Ka(!!f),u):a},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class Fz{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Ixe(e){return new Fz(e,!0)}function Dxe(e){return new Fz(e,!1)}const oC={draw(e,t){const r=lu(t/z2);e.moveTo(r,0),e.arc(0,0,r,0,jS)}},$xe={draw(e,t){const r=lu(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},Rz=lu(1/3),Uxe=Rz*2,zxe={draw(e,t){const r=lu(t/Uxe),n=r*Rz;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},Wxe={draw(e,t){const r=lu(t),n=-r/2;e.rect(n,n,r,r)}},qxe=.8908130915292852,Bz=U2(z2/10)/U2(7*z2/10),Hxe=U2(jS/10)*Bz,Vxe=-Ez(jS/10)*Bz,Gxe={draw(e,t){const r=lu(t*qxe),n=Hxe*r,a=Vxe*r;e.moveTo(0,-r),e.lineTo(n,a);for(let s=1;s<5;++s){const o=jS*s/5,l=Ez(o),c=U2(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*a,c*n+l*a)}e.closePath()}},Ck=lu(3),Kxe={draw(e,t){const r=-lu(t/(Ck*3));e.moveTo(0,r*2),e.lineTo(-Ck*r,-r),e.lineTo(Ck*r,-r),e.closePath()}},rc=-.5,nc=lu(3)/2,YA=1/lu(12),Xxe=(YA/2+1)*3,Yxe={draw(e,t){const r=lu(t/Xxe),n=r/2,a=r*YA,s=n,o=r*YA+r,l=-s,c=o;e.moveTo(n,a),e.lineTo(s,o),e.lineTo(l,c),e.lineTo(rc*n-nc*a,nc*n+rc*a),e.lineTo(rc*s-nc*o,nc*s+rc*o),e.lineTo(rc*l-nc*c,nc*l+rc*c),e.lineTo(rc*n+nc*a,rc*a-nc*n),e.lineTo(rc*s+nc*o,rc*o-nc*s),e.lineTo(rc*l+nc*c,rc*c-nc*l),e.closePath()}};function Qxe(e,t){let r=null,n=iC(a);e=typeof e=="function"?e:Ka(e||oC),t=typeof t=="function"?t:Ka(t===void 0?64:+t);function a(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return a.type=function(s){return arguments.length?(e=typeof s=="function"?s:Ka(s),a):e},a.size=function(s){return arguments.length?(t=typeof s=="function"?s:Ka(+s),a):t},a.context=function(s){return arguments.length?(r=s??null,a):r},a}function W2(){}function q2(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function Iz(e){this._context=e}Iz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:q2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:q2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Jxe(e){return new Iz(e)}function Dz(e){this._context=e}Dz.prototype={areaStart:W2,areaEnd:W2,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:q2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Zxe(e){return new Dz(e)}function $z(e){this._context=e}$z.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:q2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function e1e(e){return new $z(e)}function Uz(e){this._context=e}Uz.prototype={areaStart:W2,areaEnd:W2,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function t1e(e){return new Uz(e)}function kL(e){return e<0?-1:1}function jL(e,t,r){var n=e._x1-e._x0,a=t-e._x1,s=(e._y1-e._y0)/(n||a<0&&-0),o=(r-e._y1)/(a||n<0&&-0),l=(s*a+o*n)/(n+a);return(kL(s)+kL(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function AL(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Ek(e,t,r){var n=e._x0,a=e._y0,s=e._x1,o=e._y1,l=(s-n)/3;e._context.bezierCurveTo(n+l,a+l*t,s-l,o-l*r,s,o)}function H2(e){this._context=e}H2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ek(this,this._t0,AL(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ek(this,AL(this,r=jL(this,e,t)),r);break;default:Ek(this,this._t0,r=jL(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function zz(e){this._context=new Wz(e)}(zz.prototype=Object.create(H2.prototype)).point=function(e,t){H2.prototype.point.call(this,t,e)};function Wz(e){this._context=e}Wz.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,s){this._context.bezierCurveTo(t,e,n,r,s,a)}};function r1e(e){return new H2(e)}function n1e(e){return new zz(e)}function qz(e){this._context=e}qz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=NL(e),a=NL(t),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],a[0][s],n[1][s],a[1][s],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function NL(e){var t,r=e.length-1,n,a=new Array(r),s=new Array(r),o=new Array(r);for(a[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,s[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/s[t-1],s[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/s[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/s[t];for(s[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-a[t+1];return[a,s]}function a1e(e){return new qz(e)}function NS(e,t){this._context=e,this._t=t}NS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function i1e(e){return new NS(e,.5)}function s1e(e){return new NS(e,0)}function o1e(e){return new NS(e,1)}function _0(e,t){if((o=e.length)>1)for(var r=1,n,a,s=e[t[0]],o,l=s.length;r<o;++r)for(a=s,s=e[t[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function QA(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function l1e(e,t){return e[t]}function c1e(e){const t=[];return t.key=e,t}function u1e(){var e=Ka([]),t=QA,r=_0,n=l1e;function a(s){var o=Array.from(e.apply(this,arguments),c1e),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=sC(t(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return a.keys=function(s){return arguments.length?(e=typeof s=="function"?s:Ka(Array.from(s)),a):e},a.value=function(s){return arguments.length?(n=typeof s=="function"?s:Ka(+s),a):n},a.order=function(s){return arguments.length?(t=s==null?QA:typeof s=="function"?s:Ka(Array.from(s)),a):t},a.offset=function(s){return arguments.length?(r=s??_0,a):r},a}function d1e(e,t){if((n=e.length)>0){for(var r,n,a=0,s=e[0].length,o;a<s;++a){for(o=r=0;r<n;++r)o+=e[r][a][1]||0;if(o)for(r=0;r<n;++r)e[r][a][1]/=o}_0(e,t)}}function f1e(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,s=n.length;r<s;++r){for(var o=0,l=0;o<a;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}_0(e,t)}}function h1e(e,t){if(!(!((o=e.length)>0)||!((s=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],f=d[n][1]||0,p=d[n-1][1]||0,h=(f-p)/2,m=0;m<l;++m){var g=e[t[m]],b=g[n][1]||0,y=g[n-1][1]||0;h+=b-y}c+=f,u+=h*f}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,_0(e,t)}}var CS={},Hz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Hz);var lC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(lC);var ES={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(ES);var TS={},Vz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(Vz);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vz,r=ES;function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=a[l];u?f==="\\"&&l+1<o?(l++,c+=a[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}e.toPath=n})(TS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hz,r=lC,n=ES,a=TS;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,a.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=s})(CS);var p1e=CS.get;const k0=Wd(p1e);var m1e=4;function Bf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m1e,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function Oi(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((a,s,o)=>{var l=r[o-1];return typeof l=="string"?a+l+s:l!==void 0?a+Bf(l)+s:a+s},"")}var Ds=e=>e===0?0:e>0?1:-1,Wu=e=>typeof e=="number"&&e!=+e,j0=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,an=e=>(typeof e=="number"||e instanceof Number)&&!Wu(e),Sc=e=>an(e)||typeof e=="string",g1e=0,m1=e=>{var t=++g1e;return"".concat(e||"").concat(t)},No=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!an(t)&&typeof t!="string")return n;var s;if(j0(t)){if(r==null)return n;var o=t.indexOf("%");s=r*parseFloat(t.slice(0,o))/100}else s=+t;return Wu(s)&&(s=n),a&&r!=null&&s>r&&(s=r),s},Gz=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Ia(e,t,r){return an(e)&&an(t)?Bf(e+r*(t-e)):t}function Kz(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):k0(n,t))===r)}var x1e=e=>{for(var t=e.length,r=0,n=0,a=0,s=0,o=1/0,l=-1/0,c=0,u=0,d=0;d<t;d++){var f,p;c=((f=e[d])===null||f===void 0?void 0:f.cx)||0,u=((p=e[d])===null||p===void 0?void 0:p.cy)||0,r+=c,n+=u,a+=c*u,s+=c*c,o=Math.min(o,c),l=Math.max(l,c)}var h=t*s!==r*r?(t*a-r*n)/(t*s-r*r):0;return{xmin:o,xmax:l,a:h,b:(n-h*r)/t}},Da=e=>e===null||typeof e>"u",ay=e=>Da(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function ol(e){return e!=null}function K0(){}var y1e=["type","size","sizeType"];function JA(){return JA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JA.apply(null,arguments)}function CL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function EL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CL(Object(r),!0).forEach(function(n){b1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b1e(e,t,r){return(t=v1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v1e(e){var t=w1e(e,"string");return typeof t=="symbol"?t:t+""}function w1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S1e(e,t){if(e==null)return{};var r,n,a=_1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function _1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Xz={symbolCircle:oC,symbolCross:$xe,symbolDiamond:zxe,symbolSquare:Wxe,symbolStar:Gxe,symbolTriangle:Kxe,symbolWye:Yxe},k1e=Math.PI/180,j1e=e=>{var t="symbol".concat(ay(e));return Xz[t]||oC},A1e=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*k1e;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},N1e=(e,t)=>{Xz["symbol".concat(ay(e))]=t},PS=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=S1e(e,y1e),s=EL(EL({},a),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var p=j1e(o),h=Qxe().type(p).size(A1e(r,n,o)),m=h();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=To(s);return an(u)&&an(d)&&an(r)?x.createElement("path",JA({},f,{className:sa("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};PS.registerSymbol=N1e;var Yz=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,cC=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(x.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{nC(a)&&(n[a]=s=>r[a](r,s))}),n},C1e=(e,t,r)=>n=>(e(t,r,n),null),eg=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var s=e[a];nC(a)&&typeof s=="function"&&(n||(n={}),n[a]=C1e(s,t,r))}),n},E1e=e=>Array.isArray(e)&&e.length>0;function TL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function T1e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TL(Object(r),!0).forEach(function(n){P1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P1e(e,t,r){return(t=O1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O1e(e){var t=L1e(e,"string");return typeof t=="symbol"?t:t+""}function L1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function di(e,t){var r=T1e({},e),n=t,a=Object.keys(t),s=a.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function V2(){return V2=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V2.apply(null,arguments)}function PL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function M1e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PL(Object(r),!0).forEach(function(n){F1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F1e(e,t,r){return(t=R1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R1e(e){var t=B1e(e,"string");return typeof t=="symbol"?t:t+""}function B1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lc=32,I1e={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function D1e(e){var{data:t,iconType:r,inactiveColor:n}=e,a=lc/2,s=lc/6,o=lc/3,l=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline"){var u;return x.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=t.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:a,x2:lc,y2:a,className:"recharts-legend-icon"})}if(c==="line")return x.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(a,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(a,`
            H`).concat(lc,"M").concat(2*o,",").concat(a,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(a),className:"recharts-legend-icon"});if(c==="rect")return x.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(lc/8,"h").concat(lc,"v").concat(lc*3/4,"h").concat(-lc,"z"),className:"recharts-legend-icon"});if(x.isValidElement(t.legendIcon)){var d=M1e({},t);return delete d.legendIcon,x.cloneElement(t.legendIcon,d)}return x.createElement(PS,{fill:l,cx:a,cy:a,size:lc,sizeType:"diameter",type:c})}function $1e(e){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:s,iconType:o}=e,l={x:0,y:0,width:lc,height:lc},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,f)=>{var p=d.formatter||a,h=sa({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,g=p?p(d.value,d,f):d.value;return x.createElement("li",V2({className:h,style:c,key:"legend-item-".concat(f)},eg(e,d,f)),x.createElement(aC,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(g," legend icon")},x.createElement(D1e,{data:d,iconType:o,inactiveColor:s})),x.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},g))})}var U1e=e=>{var t=di(e,I1e),{payload:r,layout:n,align:a}=t;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return x.createElement("ul",{className:"recharts-default-legend",style:s},x.createElement($1e,V2({},t,{payload:r})))},Qz={},Jz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o,s,r);a.has(l)||a.set(l,o)}return Array.from(a.values())}e.uniqBy=t})(Jz);var Zz={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...a){return r.apply(this,a.slice(0,n))}}e.ary=t})(Zz);var uC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(uC);var eW={},OS={},tW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(tW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tW;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(OS);var rW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(rW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OS,r=rW;function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(eW);var nW={},aW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CS;function r(n){return function(a){return t.get(a,n)}}e.property=r})(aW);var iW={},dC={},sW={},fC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(fC);var hC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(hC);var pC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(pC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fC,r=hC,n=pC;function a(d,f,p){return typeof p!="function"?a(d,f,()=>{}):s(d,f,function h(m,g,b,y,v,w){const _=p(m,g,b,y,v,w);return _!==void 0?!!_:s(m,g,h,w)},new Map)}function s(d,f,p,h){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,p,h);case"function":return Object.keys(f).length>0?s(d,{...f},p,h):n.isEqualsSameValueZero(d,f);default:return t.isObject(d)?typeof f=="string"?f==="":!0:n.isEqualsSameValueZero(d,f)}}function o(d,f,p,h){if(f==null)return!0;if(Array.isArray(f))return c(d,f,p,h);if(f instanceof Map)return l(d,f,p,h);if(f instanceof Set)return u(d,f,p,h);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(h!=null&&h.has(f))return h.get(f)===d;h==null||h.set(f,d);try{for(let g=0;g<m.length;g++){const b=m[g];if(!r.isPrimitive(d)&&!(b in d)||f[b]===void 0&&d[b]!==void 0||f[b]===null&&d[b]!==null||!p(d[b],f[b],b,d,f,h))return!1}return!0}finally{h==null||h.delete(f)}}function l(d,f,p,h){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,g]of f.entries()){const b=d.get(m);if(p(b,g,m,d,f,h)===!1)return!1}return!0}function c(d,f,p,h){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let g=0;g<f.length;g++){const b=f[g];let y=!1;for(let v=0;v<d.length;v++){if(m.has(v))continue;const w=d[v];let _=!1;if(p(w,b,g,d,f,h)&&(_=!0),_){m.add(v),y=!0;break}}if(!y)return!1}return!0}function u(d,f,p,h){return f.size===0?!0:d instanceof Set?c([...d],[...f],p,h):!1}e.isMatchWith=a,e.isSetMatch=u})(sW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sW;function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})(dC);var oW={},mC={},lW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(lW);var LS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(LS);var gC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",p="[object ArrayBuffer]",h="[object Object]",m="[object Error]",g="[object DataView]",b="[object Uint8Array]",y="[object Uint8ClampedArray]",v="[object Uint16Array]",w="[object Uint32Array]",_="[object BigUint64Array]",C="[object Int8Array]",j="[object Int16Array]",A="[object Int32Array]",M="[object BigInt64Array]",P="[object Float32Array]",R="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=p,e.arrayTag=d,e.bigInt64ArrayTag=M,e.bigUint64ArrayTag=_,e.booleanTag=a,e.dataViewTag=g,e.dateTag=l,e.errorTag=m,e.float32ArrayTag=P,e.float64ArrayTag=R,e.functionTag=f,e.int16ArrayTag=j,e.int32ArrayTag=A,e.int8ArrayTag=C,e.mapTag=c,e.numberTag=n,e.objectTag=h,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=v,e.uint32ArrayTag=w,e.uint8ArrayTag=b,e.uint8ClampedArrayTag=y})(gC);var cW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(cW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lW,r=LS,n=gC,a=hC,s=cW;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,p,h=new Map,m=void 0){const g=m==null?void 0:m(d,f,p,h);if(g!==void 0)return g;if(a.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const b=new Array(d.length);h.set(d,b);for(let y=0;y<d.length;y++)b[y]=l(d[y],y,p,h,m);return Object.hasOwn(d,"index")&&(b.index=d.index),Object.hasOwn(d,"input")&&(b.input=d.input),b}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const b=new RegExp(d.source,d.flags);return b.lastIndex=d.lastIndex,b}if(d instanceof Map){const b=new Map;h.set(d,b);for(const[y,v]of d)b.set(y,l(v,y,p,h,m));return b}if(d instanceof Set){const b=new Set;h.set(d,b);for(const y of d)b.add(l(y,void 0,p,h,m));return b}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const b=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,b);for(let y=0;y<d.length;y++)b[y]=l(d[y],y,p,h,m);return b}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const b=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,b),c(b,d,p,h,m),b}if(typeof File<"u"&&d instanceof File){const b=new File([d],d.name,{type:d.type});return h.set(d,b),c(b,d,p,h,m),b}if(typeof Blob<"u"&&d instanceof Blob){const b=new Blob([d],{type:d.type});return h.set(d,b),c(b,d,p,h,m),b}if(d instanceof Error){const b=new d.constructor;return h.set(d,b),b.message=d.message,b.name=d.name,b.stack=d.stack,b.cause=d.cause,c(b,d,p,h,m),b}if(d instanceof Boolean){const b=new Boolean(d.valueOf());return h.set(d,b),c(b,d,p,h,m),b}if(d instanceof Number){const b=new Number(d.valueOf());return h.set(d,b),c(b,d,p,h,m),b}if(d instanceof String){const b=new String(d.valueOf());return h.set(d,b),c(b,d,p,h,m),b}if(typeof d=="object"&&u(d)){const b=Object.create(Object.getPrototypeOf(d));return h.set(d,b),c(b,d,p,h,m),b}return d}function c(d,f,p=d,h,m){const g=[...Object.keys(f),...t.getSymbols(f)];for(let b=0;b<g.length;b++){const y=g[b],v=Object.getOwnPropertyDescriptor(d,y);(v==null||v.writable)&&(d[y]=l(f[y],y,p,h,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(mC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mC;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(oW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dC,r=oW;function n(a){return a=r.cloneDeep(a),s=>t.isMatch(s,a)}e.matches=n})(iW);var uW={},dW={},fW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mC,r=LS,n=gC;function a(s,o){return t.cloneDeepWith(s,(l,c,u,d)=>{const f=o==null?void 0:o(l,c,u,d);if(f!==void 0)return f;if(typeof s=="object"){if(r.getTag(s)===n.objectTag&&typeof s.constructor!="function"){const p={};return d.set(s,p),t.copyProperties(p,s,u,d),p}switch(Object.prototype.toString.call(s)){case n.numberTag:case n.stringTag:case n.booleanTag:{const p=new s.constructor(s==null?void 0:s.valueOf());return t.copyProperties(p,s),p}case n.argumentsTag:{const p={};return t.copyProperties(p,s),p.length=s.length,p[Symbol.iterator]=s[Symbol.iterator],p}default:return}}})}e.cloneDeepWith=a})(fW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fW;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(dW);var hW={},xC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(xC);var pW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LS;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(pW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lC,r=xC,n=pW,a=TS;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=a.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=s})(hW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dC,r=ES,n=dW,a=CS,s=hW;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=a.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=o})(uW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uC,r=aW,n=iW,a=uW;function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=s})(nW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Jz,r=Zz,n=uC,a=eW,s=nW;function o(l,c=n.identity){return a.isArrayLikeObject(l)?t.uniqBy(Array.from(l),r.ary(s.iteratee(c),1)):[]}e.uniqBy=o})(Qz);var z1e=Qz.uniqBy;const OL=Wd(z1e);function mW(e,t,r){return t===!0?OL(e,r):typeof t=="function"?OL(e,t):e}var gW={exports:{}},xW={},yW={exports:{}},bW={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tm=x;function W1e(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var q1e=typeof Object.is=="function"?Object.is:W1e,H1e=Tm.useState,V1e=Tm.useEffect,G1e=Tm.useLayoutEffect,K1e=Tm.useDebugValue;function X1e(e,t){var r=t(),n=H1e({inst:{value:r,getSnapshot:t}}),a=n[0].inst,s=n[1];return G1e(function(){a.value=r,a.getSnapshot=t,Tk(a)&&s({inst:a})},[e,r,t]),V1e(function(){return Tk(a)&&s({inst:a}),e(function(){Tk(a)&&s({inst:a})})},[e]),K1e(r),r}function Tk(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!q1e(e,r)}catch{return!0}}function Y1e(e,t){return t()}var Q1e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Y1e:X1e;bW.useSyncExternalStore=Tm.useSyncExternalStore!==void 0?Tm.useSyncExternalStore:Q1e;yW.exports=bW;var J1e=yW.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MS=x,Z1e=J1e;function eye(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tye=typeof Object.is=="function"?Object.is:eye,rye=Z1e.useSyncExternalStore,nye=MS.useRef,aye=MS.useEffect,iye=MS.useMemo,sye=MS.useDebugValue;xW.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var s=nye(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=iye(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,tye(d,h))return m;var g=n(h);return a!==void 0&&a(m,g)?(d=h,m):(d=h,f=g)}var u=!1,d,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,a]);var l=rye(e,s[0],s[1]);return aye(function(){o.hasValue=!0,o.value=l},[l]),sye(l),l};gW.exports=xW;var oye=gW.exports,yC=x.createContext(null),lye=e=>e,Ua=()=>{var e=x.useContext(yC);return e?e.store.dispatch:lye},$v=()=>{},cye=()=>$v,uye=(e,t)=>e===t;function tn(e){var t=x.useContext(yC),r=x.useMemo(()=>t?n=>{if(n!=null)return e(n)}:$v,[t,e]);return oye.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:cye,t?t.store.getState:$v,t?t.store.getState:$v,r,uye)}function dye(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function fye(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function hye(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var LL=e=>Array.isArray(e)?e:[e];function pye(e){const t=Array.isArray(e[0])?e[0]:e;return hye(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function mye(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var gye=class{constructor(e){this.value=e}deref(){return this.value}},xye=typeof WeakRef<"u"?WeakRef:gye,yye=0,ML=1;function qb(){return{s:yye,v:void 0,o:null,p:null}}function vW(e,t={}){let r=qb();const{resultEqualityCheck:n}=t;let a,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let p=0,h=c;p<h;p++){const m=arguments[p];if(typeof m=="function"||typeof m=="object"&&m!==null){let g=l.o;g===null&&(l.o=g=new WeakMap);const b=g.get(m);b===void 0?(l=qb(),g.set(m,l)):l=b}else{let g=l.p;g===null&&(l.p=g=new Map);const b=g.get(m);b===void 0?(l=qb(),g.set(m,l)):l=b}}const u=l;let d;if(l.s===ML)d=l.v;else if(d=e.apply(null,arguments),s++,n){const p=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;p!=null&&n(p,d)&&(d=p,s!==0&&s--),a=typeof d=="object"&&d!==null||typeof d=="function"?new xye(d):d}return u.s=ML,u.v=d,d}return o.clearCache=()=>{r=qb(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function bye(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let s=0,o=0,l,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),dye(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:p=[],argsMemoize:h=vW,argsMemoizeOptions:m=[]}=d,g=LL(p),b=LL(m),y=pye(a),v=f(function(){return s++,u.apply(null,arguments)},...g),w=h(function(){o++;const C=mye(y,arguments);return l=v.apply(null,C),l},...b);return Object.assign(w,{resultFunc:u,memoizedResultFunc:v,dependencies:y,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var Kt=bye(vW),vye=Object.assign((e,t=Kt)=>{fye(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(s=>e[s]);return t(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>vye}),wW={},SW={},_W={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,s)=>{if(n!==a){const o=t(n),l=t(a);if(o===l&&o===0){if(n<a)return s==="desc"?1:-1;if(n>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};e.compareValues=r})(_W);var kW={},bC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(bC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bC,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=a})(kW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_W,r=kW,n=TS;function a(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const u=(h,m)=>{let g=h;for(let b=0;b<m.length&&g!=null;++b)g=g[m[b]];return g},d=(h,m)=>m==null||h==null?m:typeof h=="object"&&"key"in h?Object.hasOwn(m,h.key)?m[h.key]:u(m,h.path):typeof h=="function"?h(m):Array.isArray(h)?u(m,h):typeof m=="object"?m[h]:m,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return s.map(h=>({original:h,criteria:f.map(m=>d(m,h))})).slice().sort((h,m)=>{for(let g=0;g<f.length;g++){const b=t.compareValues(h.criteria[g],m.criteria[g],l[g]);if(b!==0)return b}return 0}).map(h=>h.original)}e.orderBy=a})(SW);var jW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):a.push(d)}};return o(r,0),a}e.flatten=t})(jW);var vC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xC,r=OS,n=fC,a=pC;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.isEqualsSameValueZero(c[l],o):!1}e.isIterateeCall=s})(vC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SW,r=jW,n=vC;function a(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,r.flatten(o),["asc"])}e.sortBy=a})(wW);var wye=wW.sortBy;const FS=Wd(wye);var AW=e=>e.legend.settings,Sye=e=>e.legend.size,_ye=e=>e.legend.payload,kye=Kt([_ye,AW],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?FS(n,r):n});function jye(){return tn(kye)}var Hb=1;function NW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=x.useState({height:0,left:0,top:0,width:0}),n=x.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>Hb||Math.abs(o.left-t.left)>Hb||Math.abs(o.top-t.top)>Hb||Math.abs(o.width-t.width)>Hb)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Js(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Aye=typeof Symbol=="function"&&Symbol.observable||"@@observable",FL=Aye,Pk=()=>Math.random().toString(36).substring(7).split("").join("."),Nye={INIT:`@@redux/INIT${Pk()}`,REPLACE:`@@redux/REPLACE${Pk()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Pk()}`},G2=Nye;function wC(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function CW(e,t,r){if(typeof e!="function")throw new Error(Js(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Js(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Js(1));return r(CW)(e,t)}let n=e,a=t,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((b,y)=>{o.set(y,b)}))}function d(){if(c)throw new Error(Js(3));return a}function f(b){if(typeof b!="function")throw new Error(Js(4));if(c)throw new Error(Js(5));let y=!0;u();const v=l++;return o.set(v,b),function(){if(y){if(c)throw new Error(Js(6));y=!1,u(),o.delete(v),s=null}}}function p(b){if(!wC(b))throw new Error(Js(7));if(typeof b.type>"u")throw new Error(Js(8));if(typeof b.type!="string")throw new Error(Js(17));if(c)throw new Error(Js(9));try{c=!0,a=n(a,b)}finally{c=!1}return(s=o).forEach(v=>{v()}),b}function h(b){if(typeof b!="function")throw new Error(Js(10));n=b,p({type:G2.REPLACE})}function m(){const b=f;return{subscribe(y){if(typeof y!="object"||y===null)throw new Error(Js(11));function v(){const _=y;_.next&&_.next(d())}return v(),{unsubscribe:b(v)}},[FL](){return this}}}return p({type:G2.INIT}),{dispatch:p,subscribe:f,getState:d,replaceReducer:h,[FL]:m}}function Cye(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:G2.INIT})>"u")throw new Error(Js(12));if(typeof r(void 0,{type:G2.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Js(13))})}function EW(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let a;try{Cye(r)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],p=r[f],h=o[f],m=p(h,l);if(typeof m>"u")throw l&&l.type,new Error(Js(14));u[f]=m,c=c||m!==h}return c=c||n.length!==Object.keys(o).length,c?u:o}}function K2(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Eye(...e){return t=>(r,n)=>{const a=t(r,n);let s=()=>{throw new Error(Js(15))};const o={getState:a.getState,dispatch:(c,...u)=>s(c,...u)},l=e.map(c=>c(o));return s=K2(...l)(a.dispatch),{...a,dispatch:s}}}function TW(e){return wC(e)&&"type"in e&&typeof e.type=="string"}var PW=Symbol.for("immer-nothing"),RL=Symbol.for("immer-draftable"),Vo=Symbol.for("immer-state");function Wc(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Bl=Object,Pm=Bl.getPrototypeOf,X2="constructor",RS="prototype",ZA="configurable",Y2="enumerable",Uv="writable",g1="value",Fd=e=>!!e&&!!e[Vo];function nu(e){var t;return e?OW(e)||IS(e)||!!e[RL]||!!((t=e[X2])!=null&&t[RL])||DS(e)||$S(e):!1}var Tye=Bl[RS][X2].toString(),BL=new WeakMap;function OW(e){if(!e||!SC(e))return!1;const t=Pm(e);if(t===null||t===Bl[RS])return!0;const r=Bl.hasOwnProperty.call(t,X2)&&t[X2];if(r===Object)return!0;if(!Pp(r))return!1;let n=BL.get(r);return n===void 0&&(n=Function.toString.call(r),BL.set(r,n)),n===Tye}function BS(e,t,r=!0){iy(e)===0?(r?Reflect.ownKeys(e):Bl.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function iy(e){const t=e[Vo];return t?t.type_:IS(e)?1:DS(e)?2:$S(e)?3:0}var IL=(e,t,r=iy(e))=>r===2?e.has(t):Bl[RS].hasOwnProperty.call(e,t),e4=(e,t,r=iy(e))=>r===2?e.get(t):e[t],Q2=(e,t,r,n=iy(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function Pye(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var IS=Array.isArray,DS=e=>e instanceof Map,$S=e=>e instanceof Set,SC=e=>typeof e=="object",Pp=e=>typeof e=="function",Ok=e=>typeof e=="boolean";function Oye(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var pd=e=>e.copy_||e.base_,_C=e=>e.modified_?e.copy_:e.base_;function t4(e,t){if(DS(e))return new Map(e);if($S(e))return new Set(e);if(IS(e))return Array[RS].slice.call(e);const r=OW(e);if(t===!0||t==="class_only"&&!r){const n=Bl.getOwnPropertyDescriptors(e);delete n[Vo];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l[Uv]===!1&&(l[Uv]=!0,l[ZA]=!0),(l.get||l.set)&&(n[o]={[ZA]:!0,[Uv]:!0,[Y2]:l[Y2],[g1]:e[o]})}return Bl.create(Pm(e),n)}else{const n=Pm(e);if(n!==null&&r)return{...e};const a=Bl.create(n);return Bl.assign(a,e)}}function kC(e,t=!1){return US(e)||Fd(e)||!nu(e)||(iy(e)>1&&Bl.defineProperties(e,{set:Vb,add:Vb,clear:Vb,delete:Vb}),Bl.freeze(e),t&&BS(e,(r,n)=>{kC(n,!0)},!1)),e}function Lye(){Wc(2)}var Vb={[g1]:Lye};function US(e){return e===null||!SC(e)?!0:Bl.isFrozen(e)}var J2="MapSet",r4="Patches",DL="ArrayMethods",LW={};function A0(e){const t=LW[e];return t||Wc(0,e),t}var $L=e=>!!LW[e],x1,MW=()=>x1,Mye=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:$L(J2)?A0(J2):void 0,arrayMethodsPlugin_:$L(DL)?A0(DL):void 0});function UL(e,t){t&&(e.patchPlugin_=A0(r4),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function n4(e){a4(e),e.drafts_.forEach(Fye),e.drafts_=null}function a4(e){e===x1&&(x1=e.parent_)}var zL=e=>x1=Mye(x1,e);function Fye(e){const t=e[Vo];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function WL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[Vo].modified_&&(n4(t),Wc(4)),nu(e)&&(e=qL(t,e));const{patchPlugin_:a}=t;a&&a.generateReplacementPatches_(r[Vo].base_,e,t)}else e=qL(t,r);return Rye(t,e,!0),n4(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==PW?e:void 0}function qL(e,t){if(US(t))return t;const r=t[Vo];if(!r)return Z2(t,e.handledSet_,e);if(!zS(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);BW(r,e)}return r.copy_}function Rye(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&kC(t,r)}function FW(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var zS=(e,t)=>e.scope_===t,Bye=[];function RW(e,t,r,n){const a=pd(e),s=e.type_;if(n!==void 0&&e4(a,n,s)===t){Q2(a,n,r,s);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;BS(a,(c,u)=>{if(Fd(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=e.draftLocations_.get(t)??Bye;for(const l of o)Q2(a,l,r,s)}function Iye(e,t,r){e.callbacks_.push(function(a){var l;const s=t;if(!s||!zS(s,a))return;(l=a.mapSetPlugin_)==null||l.fixSetContents(s);const o=_C(s);RW(e,s.draft_??s,o,r),BW(s,a)})}function BW(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=t;if(a){const s=a.getPath(e);s&&a.generatePatches_(e,s,t)}FW(e)}}function Dye(e,t,r){const{scope_:n}=e;if(Fd(r)){const a=r[Vo];zS(a,n)&&a.callbacks_.push(function(){zv(e);const o=_C(a);RW(e,r,o,t)})}else nu(r)&&e.callbacks_.push(function(){const s=pd(e);e.type_===3?s.has(r)&&Z2(r,n.handledSet_,n):e4(s,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&Z2(e4(e.copy_,t,e.type_),n.handledSet_,n)})}function Z2(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Fd(e)||t.has(e)||!nu(e)||US(e)||(t.add(e),BS(e,(n,a)=>{if(Fd(a)){const s=a[Vo];if(zS(s,r)){const o=_C(s);Q2(e,n,o,e.type_),FW(s)}}else nu(a)&&Z2(a,t,r)})),e}function $ye(e,t){const r=IS(e),n={type_:r?1:0,scope_:t?t.scope_:MW(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,s=ew;r&&(a=[n],s=y1);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,[l,n]}var ew={get(e,t){if(t===Vo)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const a=pd(e);if(!IL(a,t,e.type_))return Uye(e,a,t);const s=a[t];if(e.finalized_||!nu(s)||n&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&Oye(t))return s;if(s===Lk(e.base_,t)){zv(e);const o=e.type_===1?+t:t,l=s4(e.scope_,s,e,o);return e.copy_[o]=l}return s},has(e,t){return t in pd(e)},ownKeys(e){return Reflect.ownKeys(pd(e))},set(e,t,r){const n=IW(pd(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Lk(pd(e),t),s=a==null?void 0:a[Vo];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(Pye(r,a)&&(r!==void 0||IL(e.base_,t,e.type_)))return!0;zv(e),i4(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),Dye(e,t,r)),!0},deleteProperty(e,t){return zv(e),Lk(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),i4(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=pd(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Uv]:!0,[ZA]:e.type_!==1||t!=="length",[Y2]:n[Y2],[g1]:r[t]}},defineProperty(){Wc(11)},getPrototypeOf(e){return Pm(e.base_)},setPrototypeOf(){Wc(12)}},y1={};for(let e in ew){let t=ew[e];y1[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}y1.deleteProperty=function(e,t){return y1.set.call(this,e,t,void 0)};y1.set=function(e,t,r){return ew.set.call(this,e[0],t,r,e[0])};function Lk(e,t){const r=e[Vo];return(r?pd(r):e)[t]}function Uye(e,t,r){var a;const n=IW(t,r);return n?g1 in n?n[g1]:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function IW(e,t){if(!(t in e))return;let r=Pm(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Pm(r)}}function i4(e){e.modified_||(e.modified_=!0,e.parent_&&i4(e.parent_))}function zv(e){e.copy_||(e.assigned_=new Map,e.copy_=t4(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var zye=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(Pp(r)&&!Pp(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}Pp(n)||Wc(6),a!==void 0&&!Pp(a)&&Wc(7);let s;if(nu(r)){const o=zL(this),l=s4(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?n4(o):a4(o)}return UL(o,a),WL(s,o)}else if(!r||!SC(r)){if(s=n(r),s===void 0&&(s=r),s===PW&&(s=void 0),this.autoFreeze_&&kC(s,!0),a){const o=[],l=[];A0(r4).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),a(o,l)}return s}else Wc(1,r)},this.produceWithPatches=(r,n)=>{if(Pp(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let a,s;return[this.produce(r,n,(l,c)=>{a=l,s=c}),a,s]},Ok(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Ok(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Ok(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){nu(t)||Wc(8),Fd(t)&&(t=Zc(t));const r=zL(this),n=s4(r,t,void 0);return n[Vo].isManual_=!0,a4(r),n}finishDraft(t,r){const n=t&&t[Vo];(!n||!n.isManual_)&&Wc(9);const{scope_:a}=n;return UL(a,r),WL(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(r=r.slice(n+1));const a=A0(r4).applyPatches_;return Fd(t)?a(t,r):this.produce(t,s=>a(s,r))}};function s4(e,t,r,n){const[a,s]=DS(t)?A0(J2).proxyMap_(t,r):$S(t)?A0(J2).proxySet_(t,r):$ye(t,r);return((r==null?void 0:r.scope_)??MW()).drafts_.push(a),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?Iye(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),a}function Zc(e){return Fd(e)||Wc(10,e),DW(e)}function DW(e){if(!nu(e)||US(e))return e;const t=e[Vo];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=t4(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=t4(e,!0);return BS(r,(a,s)=>{Q2(r,a,DW(s))},n),t&&(t.finalized_=!1),r}var Wye=new zye,$W=Wye.produce;function UW(e){return({dispatch:r,getState:n})=>a=>s=>typeof s=="function"?s(r,n,e):a(s)}var qye=UW(),Hye=UW,Vye=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?K2:K2.apply(null,arguments)};function _c(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Dl(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>TW(n)&&n.type===e,r}var zW=class ix extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,ix.prototype)}static get[Symbol.species](){return ix}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new ix(...t[0].concat(this)):new ix(...t.concat(this))}};function HL(e){return nu(e)?$W(e,()=>{}):e}function Gb(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Gye(e){return typeof e=="boolean"}var Kye=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=t??{};let o=new zW;return r&&(Gye(r)?o.push(qye):o.push(Hye(r.extraArgument))),o},WW="RTK_autoBatch",si=()=>e=>({payload:e,meta:{[WW]:!0}}),VL=e=>t=>{setTimeout(t,e)},qW=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,s=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:VL(10):e.type==="callback"?e.queueNotification:VL(e.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>a&&d(),p=n.subscribe(f);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){var f;try{return a=!((f=d==null?void 0:d.meta)!=null&&f[WW]),s=!a,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{a=!0}}})},Xye=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new zW(e);return n&&a.push(qW(typeof n=="object"?n:void 0)),a};function Yye(e){const t=Kye(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(wC(r))l=EW(r);else throw new Error(Dl(1));let c;typeof n=="function"?c=n(t):c=t();let u=K2;a&&(u=Vye({trace:!1,...typeof a=="object"&&a}));const d=Eye(...c),f=Xye(d);let p=typeof o=="function"?o(f):f();const h=u(...p);return CW(l,s,h)}function HW(e){const t={},r=[];let n;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Dl(28));if(l in t)throw new Error(Dl(29));return t[l]=o,a},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return r.push({matcher:s,reducer:o}),a},addDefaultCase(s){return n=s,a}};return e(a),[t,r,n]}function Qye(e){return typeof e=="function"}function Jye(e,t){let[r,n,a]=HW(t),s;if(Qye(e))s=()=>HL(e());else{const l=HL(e);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[a]),u.reduce((d,f)=>{if(f)if(Fd(d)){const h=f(d,c);return h===void 0?d:h}else{if(nu(d))return $W(d,p=>f(p,c));{const p=f(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return o.getInitialState=s,o}var Zye="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",ebe=(e=21)=>{let t="",r=e;for(;r--;)t+=Zye[Math.random()*64|0];return t},tbe=Symbol.for("rtk-slice-createasyncthunk");function rbe(e,t){return`${e}/${t}`}function nbe({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[tbe];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(Dl(11));const l=(typeof a.reducers=="function"?a.reducers(ibe()):a.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(_,C){const j=typeof _=="string"?_:_.type;if(!j)throw new Error(Dl(12));if(j in u.sliceCaseReducersByType)throw new Error(Dl(13));return u.sliceCaseReducersByType[j]=C,d},addMatcher(_,C){return u.sliceMatchers.push({matcher:_,reducer:C}),d},exposeAction(_,C){return u.actionCreators[_]=C,d},exposeCaseReducer(_,C){return u.sliceCaseReducersByName[_]=C,d}};c.forEach(_=>{const C=l[_],j={reducerName:_,type:rbe(s,_),createNotation:typeof a.reducers=="function"};obe(C)?cbe(j,C,d,t):sbe(j,C,d)});function f(){const[_={},C=[],j=void 0]=typeof a.extraReducers=="function"?HW(a.extraReducers):[a.extraReducers],A={..._,...u.sliceCaseReducersByType};return Jye(a.initialState,M=>{for(let P in A)M.addCase(P,A[P]);for(let P of u.sliceMatchers)M.addMatcher(P.matcher,P.reducer);for(let P of C)M.addMatcher(P.matcher,P.reducer);j&&M.addDefaultCase(j)})}const p=_=>_,h=new Map,m=new WeakMap;let g;function b(_,C){return g||(g=f()),g(_,C)}function y(){return g||(g=f()),g.getInitialState()}function v(_,C=!1){function j(M){let P=M[_];return typeof P>"u"&&C&&(P=Gb(m,j,y)),P}function A(M=p){const P=Gb(h,C,()=>new WeakMap);return Gb(P,M,()=>{const R={};for(const[N,T]of Object.entries(a.selectors??{}))R[N]=abe(T,M,()=>Gb(m,M,y),C);return R})}return{reducerPath:_,getSelectors:A,get selectors(){return A(j)},selectSlice:j}}const w={name:s,reducer:b,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:y,...v(o),injectInto(_,{reducerPath:C,...j}={}){const A=C??o;return _.inject({reducerPath:A,reducer:b},j),{...w,...v(A,!0)}}};return w}}function abe(e,t,r,n){function a(s,...o){let l=t(s);return typeof l>"u"&&n&&(l=r()),e(l,...o)}return a.unwrapped=e,a}var yl=nbe();function ibe(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function sbe({type:e,reducerName:t,createNotation:r},n,a){let s,o;if("reducer"in n){if(r&&!lbe(n))throw new Error(Dl(17));s=n.reducer,o=n.prepare}else s=n;a.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?_c(e,o):_c(e))}function obe(e){return e._reducerDefinitionType==="asyncThunk"}function lbe(e){return e._reducerDefinitionType==="reducerWithPrepare"}function cbe({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Dl(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=a(e,s,d);n.exposeAction(t,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:o||Kb,pending:l||Kb,rejected:c||Kb,settled:u||Kb})}function Kb(){}var ube="task",VW="listener",GW="completed",jC="cancelled",dbe=`task-${jC}`,fbe=`task-${GW}`,o4=`${VW}-${jC}`,hbe=`${VW}-${GW}`,WS=class{constructor(e){ya(this,"name","TaskAbortError");ya(this,"message");this.code=e,this.message=`${ube} ${jC} (reason: ${e})`}},AC=(e,t)=>{if(typeof e!="function")throw new TypeError(Dl(32))},tw=()=>{},KW=(e,t=tw)=>(e.catch(t),e),XW=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),n0=e=>{if(e.aborted)throw new WS(e.reason)};function YW(e,t){let r=tw;return new Promise((n,a)=>{const s=()=>a(new WS(e.reason));if(e.aborted){s();return}r=XW(e,s),t.finally(()=>r()).then(n,a)}).finally(()=>{r=tw})}var pbe=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof WS?"cancelled":"rejected",error:r}}finally{t==null||t()}},rw=e=>t=>KW(YW(e,t).then(r=>(n0(e),r))),QW=e=>{const t=rw(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:mm}=Object,GL={},qS="listenerMiddleware",mbe=(e,t)=>{const r=n=>XW(e,()=>n.abort(e.reason));return(n,a)=>{AC(n);const s=new AbortController;r(s);const o=pbe(async()=>{n0(e),n0(s.signal);const l=await n({pause:rw(s.signal),delay:QW(s.signal),signal:s.signal});return n0(s.signal),l},()=>s.abort(fbe));return a!=null&&a.autoJoin&&t.push(o.catch(tw)),{result:rw(e)(o),cancel(){s.abort(dbe)}}}},gbe=(e,t)=>{const r=async(n,a)=>{n0(t);let s=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,p)=>{p.unsubscribe(),c([f,p.getState(),p.getOriginalState()])}});s=()=>{d(),u()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await YW(t,Promise.race(l));return n0(t),c}finally{s()}};return(n,a)=>KW(r(n,a))},JW=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:s}=e;if(t)a=_c(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Dl(21));return AC(s),{predicate:a,type:t,effect:s}},ZW=mm(e=>{const{type:t,predicate:r,effect:n}=JW(e);return{id:ebe(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Dl(22))}}},{withTypes:()=>ZW}),KL=(e,t)=>{const{type:r,effect:n,predicate:a}=JW(t);return Array.from(e.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===a)&&s.effect===n)},l4=e=>{e.pending.forEach(t=>{t.abort(o4)})},xbe=(e,t)=>()=>{for(const r of t.keys())l4(r);e.clear()},XL=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},eq=mm(_c(`${qS}/add`),{withTypes:()=>eq}),ybe=_c(`${qS}/removeAll`),tq=mm(_c(`${qS}/remove`),{withTypes:()=>tq}),bbe=(...e)=>{console.error(`${qS}/error`,...e)},sy=(e={})=>{const t=new Map,r=new Map,n=h=>{const m=r.get(h)??0;r.set(h,m+1)},a=h=>{const m=r.get(h)??1;m===1?r.delete(h):r.set(h,m-1)},{extra:s,onError:o=bbe}=e;AC(o);const l=h=>(h.unsubscribe=()=>t.delete(h.id),t.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&l4(h)}),c=h=>{const m=KL(t,h)??ZW(h);return l(m)};mm(c,{withTypes:()=>c});const u=h=>{const m=KL(t,h);return m&&(m.unsubscribe(),h.cancelActive&&l4(m)),!!m};mm(u,{withTypes:()=>u});const d=async(h,m,g,b)=>{const y=new AbortController,v=gbe(c,y.signal),w=[];try{h.pending.add(y),n(h),await Promise.resolve(h.effect(m,mm({},g,{getOriginalState:b,condition:(_,C)=>v(_,C).then(Boolean),take:v,delay:QW(y.signal),pause:rw(y.signal),extra:s,signal:y.signal,fork:mbe(y.signal,w),unsubscribe:h.unsubscribe,subscribe:()=>{t.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((_,C,j)=>{_!==y&&(_.abort(o4),j.delete(_))})},cancel:()=>{y.abort(o4),h.pending.delete(y)},throwIfCancelled:()=>{n0(y.signal)}})))}catch(_){_ instanceof WS||XL(o,_,{raisedBy:"effect"})}finally{await Promise.all(w),y.abort(hbe),a(h),h.pending.delete(y)}},f=xbe(t,r);return{middleware:h=>m=>g=>{if(!TW(g))return m(g);if(eq.match(g))return c(g.payload);if(ybe.match(g)){f();return}if(tq.match(g))return u(g.payload);let b=h.getState();const y=()=>{if(b===GL)throw new Error(Dl(23));return b};let v;try{if(v=m(g),t.size>0){const w=h.getState(),_=Array.from(t.values());for(const C of _){let j=!1;try{j=C.predicate(g,w,b)}catch(A){j=!1,XL(o,A,{raisedBy:"predicate"})}j&&d(C,g,h,y)}}}finally{b=GL}return v},startListening:c,stopListening:u,clearListeners:f}};function Dl(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var vbe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},rq=yl({name:"chartLayout",initialState:vbe,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,s;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:wbe,setLayout:Sbe,setChartSize:_be,setScale:kbe}=rq.actions,jbe=rq.reducer;function nq(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Vn(e){return Number.isFinite(e)}function qu(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function YL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YL(Object(r),!0).forEach(function(n){Abe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Abe(e,t,r){return(t=Nbe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nbe(e){var t=Cbe(e,"string");return typeof t=="symbol"?t:t+""}function Cbe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fa(e,t,r){return Da(e)||Da(t)?r:Sc(t)?k0(e,t,r):typeof t=="function"?t(e):r}var Ebe=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:s,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&an(e[s]))return Kp(Kp({},e),{},{[s]:e[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&an(e[o]))return Kp(Kp({},e),{},{[o]:e[o]+(a||0)})}return e},Yd=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",aq=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var a,s,o=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===r&&(s=!0),l.coordinate));return a||o.push(t),s||o.push(r),o},iq=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:s,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:p,axisType:h}=e;if(!o)return null;var m=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,g=a==="category"&&o.bandwidth?o.bandwidth()/m:0;if(g=h==="angleAxis"&&s&&s.length>=2?Ds(s[0]-s[1])*2*g:g,f||p){var b=(f||p||[]).map((y,v)=>{var w=n?n.indexOf(y):y,_=o.map(w);return Vn(_)?{coordinate:_+g,value:y,offset:g,index:v}:null}).filter(ol);return b}return c&&u?u.map((y,v)=>{var w=o.map(y);return Vn(w)?{coordinate:w+g,value:y,index:v,offset:g}:null}).filter(ol):o.ticks&&d!=null?o.ticks(d).map((y,v)=>{var w=o.map(y);return Vn(w)?{coordinate:w+g,value:y,index:v,offset:g}:null}).filter(ol):o.domain().map((y,v)=>{var w=o.map(y);return Vn(w)?{coordinate:w+g,value:n?n[y]:y,index:v,offset:g}:null}).filter(ol)},Tbe=(e,t)=>{if(!t||t.length!==2||!an(t[0])||!an(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!an(e[0])||e[0]<r)&&(a[0]=r),(!an(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},Pbe=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0,l=0;l<r;++l){var c=e[l],u=c==null?void 0:c[a];if(u!=null){var d=u[1],f=u[0],p=Wu(d)?f:d;p>=0?(u[0]=s,s+=p,u[1]=s):(u[0]=o,o+=p,u[1]=o)}}}},Obe=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var s=0,o=0;o<r;++o){var l=e[o],c=l==null?void 0:l[a];if(c!=null){var u=Wu(c[1])?c[0]:c[1];u>=0?(c[0]=s,s+=u,c[1]=s):(c[0]=0,c[1]=0)}}}},Lbe={sign:Pbe,expand:d1e,none:_0,silhouette:f1e,wiggle:h1e,positive:Obe},Mbe=(e,t,r)=>{var n,a=(n=Lbe[r])!==null&&n!==void 0?n:_0,s=u1e().keys(t).value((l,c)=>Number(fa(l,c,0))).order(QA).offset(a),o=s(e);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=fa(e[d],t[c],0);Array.isArray(f)&&f.length===2&&an(f[0])&&an(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function Fbe(e){return e==null?void 0:String(e)}function nw(e){var{axis:t,ticks:r,bandSize:n,entry:a,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Da(a[t.dataKey])){var l=Kz(r,"value",a[t.dataKey]);if(l)return l.coordinate+n/2}return r!=null&&r[s]?r[s].coordinate+n/2:null}var c=fa(a,Da(o)?t.dataKey:o),u=t.scale.map(c);return an(u)?u:null}var QL=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:s,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var l=fa(s,t.dataKey,t.scale.domain()[o]);if(Da(l))return null;var c=t.scale.map(l);return an(c)?c-a/2+n:null},Rbe=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},Bbe=e=>{var t=e.flat(2).filter(an);return[Math.min(...t),Math.max(...t)]},Ibe=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Dbe=(e,t,r)=>{if(e!=null)return Ibe(Object.keys(e).reduce((n,a)=>{var s=e[a];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=nq(u,t,r),f=Bbe(d);return!Vn(f[0])||!Vn(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},JL=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ZL=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Om=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=FS(t,d=>d.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],u=a[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function eM(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:s}=e;return Kp(Kp({},t),{},{dataKey:r,payload:n,value:a,name:s})}function gh(e,t){if(e)return String(e);if(typeof t=="string")return t}var $be=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},Ube=(e,t)=>t==="centric"?e.angle:e.radius,Qd=e=>e.layout.width,Jd=e=>e.layout.height,zbe=e=>e.layout.scale,sq=e=>e.layout.margin,HS=Kt(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),VS=Kt(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),oq="data-recharts-item-index",NC="data-recharts-item-id",oy=60;function tM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tM(Object(r),!0).forEach(function(n){Wbe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Wbe(e,t,r){return(t=qbe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qbe(e){var t=Hbe(e,"string");return typeof t=="symbol"?t:t+""}function Hbe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vbe=e=>e.brush.height;function Gbe(e){var t=VS(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:oy;return r+a}return r},0)}function Kbe(e){var t=VS(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:oy;return r+a}return r},0)}function Xbe(e){var t=HS(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Ybe(e){var t=HS(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var ks=Kt([Qd,Jd,sq,Vbe,Gbe,Kbe,Xbe,Ybe,AW,Sye],(e,t,r,n,a,s,o,l,c,u)=>{var d={left:(r.left||0)+a,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},p=Xb(Xb({},f),d),h=p.bottom;p.bottom+=n,p=Ebe(p,c,u);var m=e-p.left-p.right,g=t-p.top-p.bottom;return Xb(Xb({brushBottom:h},p),{},{width:Math.max(m,0),height:Math.max(g,0)})}),Qbe=Kt(ks,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),CC=Kt(Qd,Jd,(e,t)=>({x:0,y:0,width:e,height:t})),Jbe=x.createContext(null),js=()=>x.useContext(Jbe)!=null,GS=e=>e.brush,KS=Kt([GS,ks,sq],(e,t,r)=>({height:e.height,x:an(e.x)?e.x:t.left,y:an(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:an(e.width)?e.width:t.width})),lq={},cq={},uq={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),g()};let p=null;const h=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,f()},n)},m=()=>{p!==null&&(clearTimeout(p),p=null)},g=()=>{m(),o=void 0,l=null},b=()=>{d()},y=function(...v){if(a!=null&&a.aborted)return;o=this,l=v;const w=p==null;h(),c&&w&&d()};return y.schedule=h,y.cancel=g,y.flush=b,a==null||a.addEventListener("abort",g,{once:!0}),y}e.debounce=t})(uq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uq;function r(n,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const p=t.debounce(function(...g){d=n.apply(this,g),f=null},a,{edges:u}),h=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,g),f=Date.now(),p.cancel(),p.schedule(),d):(p.apply(this,g),d)},m=()=>(p.flush(),d);return h.cancel=p.cancel,h.flush=m,h}e.debounce=r})(cq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cq;function r(n,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return t.debounce(n,a,{leading:o,maxWait:a,trailing:l})}e.throttle=r})(lq);var Zbe=lq.throttle;const eve=Wd(Zbe);var aw=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>a[o++]))}},Ru={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},dq=(e,t,r)=>{var{width:n=Ru.width,height:a=Ru.height,aspect:s,maxHeight:o}=r,l=j0(n)?e:Number(n),c=j0(a)?t:Number(a);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},tve={width:0,height:0,overflow:"visible"},rve={width:0,overflowX:"visible"},nve={height:0,overflowY:"visible"},ave={},ive=e=>{var{width:t,height:r}=e,n=j0(t),a=j0(r);return n&&a?tve:n?rve:a?nve:ave};function sve(e){var{width:t,height:r,aspect:n}=e,a=t,s=r;return a===void 0&&s===void 0?(a=Ru.width,s=Ru.height):a===void 0?a=n&&n>0?void 0:Ru.width:s===void 0&&(s=n&&n>0?void 0:Ru.height),{width:a,height:s}}function c4(){return c4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c4.apply(null,arguments)}function rM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rM(Object(r),!0).forEach(function(n){ove(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ove(e,t,r){return(t=lve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lve(e){var t=cve(e,"string");return typeof t=="symbol"?t:t+""}function cve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fq=x.createContext(Ru.initialDimension);function uve(e){return qu(e.width)&&qu(e.height)}function hq(e){var{children:t,width:r,height:n}=e,a=x.useMemo(()=>({width:r,height:n}),[r,n]);return uve(a)?x.createElement(fq.Provider,{value:a},t):null}var EC=()=>x.useContext(fq),dve=x.forwardRef((e,t)=>{var{aspect:r,initialDimension:n=Ru.initialDimension,width:a,height:s,minWidth:o=Ru.minWidth,minHeight:l,maxHeight:c,children:u,debounce:d=Ru.debounce,id:f,className:p,onResize:h,style:m={}}=e,g=x.useRef(null),b=x.useRef();b.current=h,x.useImperativeHandle(t,()=>g.current);var[y,v]=x.useState({containerWidth:n.width,containerHeight:n.height}),w=x.useCallback((M,P)=>{v(R=>{var N=Math.round(M),T=Math.round(P);return R.containerWidth===N&&R.containerHeight===T?R:{containerWidth:N,containerHeight:T}})},[]);x.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return K0;var M=T=>{var B,G=T[0];if(G!=null){var{width:re,height:xe}=G.contentRect;w(re,xe),(B=b.current)===null||B===void 0||B.call(b,re,xe)}};d>0&&(M=eve(M,d,{trailing:!0,leading:!1}));var P=new ResizeObserver(M),{width:R,height:N}=g.current.getBoundingClientRect();return w(R,N),P.observe(g.current),()=>{P.disconnect()}},[w,d]);var{containerWidth:_,containerHeight:C}=y;aw(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:j,calculatedHeight:A}=dq(_,C,{width:a,height:s,aspect:r,maxHeight:c});return aw(j!=null&&j>0||A!=null&&A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,j,A,a,s,o,l,r),x.createElement("div",{id:f?"".concat(f):void 0,className:sa("recharts-responsive-container",p),style:nM(nM({},m),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:g},x.createElement("div",{style:ive({width:a,height:s})},x.createElement(hq,{width:j,height:A},u)))}),ly=x.forwardRef((e,t)=>{var r=EC();if(qu(r.width)&&qu(r.height))return e.children;var{width:n,height:a}=sve({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:o}=dq(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return an(s)&&an(o)?x.createElement(hq,{width:s,height:o},e.children):x.createElement(dve,c4({},e,{width:n,height:a,ref:t}))});function TC(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var tg=()=>{var e,t=js(),r=tn(Qbe),n=tn(KS),a=(e=tn(GS))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},fve={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},pq=()=>{var e;return(e=tn(ks))!==null&&e!==void 0?e:fve},PC=()=>tn(Qd),OC=()=>tn(Jd),hve=()=>tn(e=>e.layout.margin),pa=e=>e.layout.layoutType,X0=()=>tn(pa),mq=()=>{var e=X0();if(e==="horizontal"||e==="vertical")return e},gq=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},pve=()=>{var e=X0();return e!==void 0},cy=e=>{var t=Ua(),r=js(),{width:n,height:a}=e,s=EC(),o=n,l=a;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:a),x.useEffect(()=>{!r&&qu(o)&&qu(l)&&t(_be({width:o,height:l}))},[t,r,o,l]),null},xq=Symbol.for("immer-nothing"),aM=Symbol.for("immer-draftable"),Wl=Symbol.for("immer-state");function qc(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var b1=Object.getPrototypeOf;function Lm(e){return!!e&&!!e[Wl]}function N0(e){var t;return e?yq(e)||Array.isArray(e)||!!e[aM]||!!((t=e.constructor)!=null&&t[aM])||uy(e)||YS(e):!1}var mve=Object.prototype.constructor.toString(),iM=new WeakMap;function yq(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=iM.get(r);return n===void 0&&(n=Function.toString.call(r),iM.set(r,n)),n===mve}function iw(e,t,r=!0){XS(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function XS(e){const t=e[Wl];return t?t.type_:Array.isArray(e)?1:uy(e)?2:YS(e)?3:0}function u4(e,t){return XS(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function bq(e,t,r){const n=XS(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function gve(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function uy(e){return e instanceof Map}function YS(e){return e instanceof Set}function Mh(e){return e.copy_||e.base_}function d4(e,t){if(uy(e))return new Map(e);if(YS(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=yq(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Wl];let a=Reflect.ownKeys(n);for(let s=0;s<a.length;s++){const o=a[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(b1(e),n)}else{const n=b1(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function LC(e,t=!1){return QS(e)||Lm(e)||!N0(e)||(XS(e)>1&&Object.defineProperties(e,{set:Yb,add:Yb,clear:Yb,delete:Yb}),Object.freeze(e),t&&Object.values(e).forEach(r=>LC(r,!0))),e}function xve(){qc(2)}var Yb={value:xve};function QS(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var yve={};function C0(e){const t=yve[e];return t||qc(0,e),t}var v1;function vq(){return v1}function bve(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function sM(e,t){t&&(C0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function f4(e){h4(e),e.drafts_.forEach(vve),e.drafts_=null}function h4(e){e===v1&&(v1=e.parent_)}function oM(e){return v1=bve(v1,e)}function vve(e){const t=e[Wl];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function lM(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Wl].modified_&&(f4(t),qc(4)),N0(e)&&(e=sw(t,e),t.parent_||ow(t,e)),t.patches_&&C0("Patches").generateReplacementPatches_(r[Wl].base_,e,t.patches_,t.inversePatches_)):e=sw(t,r,[]),f4(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==xq?e:void 0}function sw(e,t,r){if(QS(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[Wl];if(!a)return iw(t,(s,o)=>cM(e,a,t,s,o,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return ow(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let o=s,l=!1;a.type_===3&&(o=new Set(s),s.clear(),l=!0),iw(o,(c,u)=>cM(e,a,s,c,u,r,l),n),ow(e,s,!1),r&&e.patches_&&C0("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function cM(e,t,r,n,a,s,o){if(a==null||typeof a!="object"&&!o)return;const l=QS(a);if(!(l&&!o)){if(Lm(a)){const c=s&&t&&t.type_!==3&&!u4(t.assigned_,n)?s.concat(n):void 0,u=sw(e,a,c);if(bq(r,n,u),Lm(u))e.canAutoFreeze_=!1;else return}else o&&r.add(a);if(N0(a)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&l)return;sw(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(uy(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&ow(e,a)}}}function ow(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&LC(t,r)}function wve(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:vq(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,s=MC;r&&(a=[n],s=w1);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return n.draft_=l,n.revoke_=o,l}var MC={get(e,t){if(t===Wl)return e;const r=Mh(e);if(!u4(r,t))return Sve(e,r,t);const n=r[t];return e.finalized_||!N0(n)?n:n===Mk(e.base_,t)?(Fk(e),e.copy_[t]=m4(n,e)):n},has(e,t){return t in Mh(e)},ownKeys(e){return Reflect.ownKeys(Mh(e))},set(e,t,r){const n=wq(Mh(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Mk(Mh(e),t),s=a==null?void 0:a[Wl];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(gve(r,a)&&(r!==void 0||u4(e.base_,t)))return!0;Fk(e),p4(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Mk(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Fk(e),p4(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Mh(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){qc(11)},getPrototypeOf(e){return b1(e.base_)},setPrototypeOf(){qc(12)}},w1={};iw(MC,(e,t)=>{w1[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});w1.deleteProperty=function(e,t){return w1.set.call(this,e,t,void 0)};w1.set=function(e,t,r){return MC.set.call(this,e[0],t,r,e[0])};function Mk(e,t){const r=e[Wl];return(r?Mh(r):e)[t]}function Sve(e,t,r){var a;const n=wq(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function wq(e,t){if(!(t in e))return;let r=b1(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=b1(r)}}function p4(e){e.modified_||(e.modified_=!0,e.parent_&&p4(e.parent_))}function Fk(e){e.copy_||(e.copy_=d4(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var _ve=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&qc(6),n!==void 0&&typeof n!="function"&&qc(7);let a;if(N0(t)){const s=oM(this),o=m4(t,void 0);let l=!0;try{a=r(o),l=!1}finally{l?f4(s):h4(s)}return sM(s,n),lM(a,s)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===xq&&(a=void 0),this.autoFreeze_&&LC(a,!0),n){const s=[],o=[];C0("Patches").generateReplacementPatches_(t,a,s,o),n(s,o)}return a}else qc(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let n,a;return[this.produce(t,r,(o,l)=>{n=o,a=l}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){N0(e)||qc(8),Lm(e)&&(e=kve(e));const t=oM(this),r=m4(e,void 0);return r[Wl].isManual_=!0,h4(t),r}finishDraft(e,t){const r=e&&e[Wl];(!r||!r.isManual_)&&qc(9);const{scope_:n}=r;return sM(n,t),lM(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=C0("Patches").applyPatches_;return Lm(e)?n(e,t):this.produce(e,a=>n(a,t))}};function m4(e,t){const r=uy(e)?C0("MapSet").proxyMap_(e,t):YS(e)?C0("MapSet").proxySet_(e,t):wve(e,t);return(t?t.scope_:vq()).drafts_.push(r),r}function kve(e){return Lm(e)||qc(10,e),Sq(e)}function Sq(e){if(!N0(e)||QS(e))return e;const t=e[Wl];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=d4(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=d4(e,!0);return iw(r,(a,s)=>{bq(r,a,Sq(s))},n),t&&(t.finalized_=!1),r}var jve=new _ve;jve.produce;var Ave={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},_q=yl({name:"legend",initialState:Ave,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:si()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Zc(e).payload.indexOf(r);a>-1&&(e.payload[a]=n)},prepare:si()},removeLegendPayload:{reducer(e,t){var r=Zc(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:si()}}}),{setLegendSize:uM,setLegendSettings:Nve,addLegendPayload:kq,replaceLegendPayload:jq,removeLegendPayload:Aq}=_q.actions,Cve=_q.reducer,Eve=["contextPayload"];function g4(){return g4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},g4.apply(null,arguments)}function dM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dM(Object(r),!0).forEach(function(n){Tve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Tve(e,t,r){return(t=Pve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pve(e){var t=Ove(e,"string");return typeof t=="symbol"?t:t+""}function Ove(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lve(e,t){if(e==null)return{};var r,n,a=Mve(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Mve(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Fve(e){return e.value}function Rve(e){var{contextPayload:t}=e,r=Lve(e,Eve),n=mW(t,e.payloadUniqBy,Fve),a=Mm(Mm({},r),{},{payload:n});return x.isValidElement(e.content)?x.cloneElement(e.content,a):typeof e.content=="function"?x.createElement(e.content,a):x.createElement(U1e,a)}function Bve(e,t,r,n,a,s){var{layout:o,align:l,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((a||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Mm(Mm({},u),d)}function Ive(e){var t=Ua();return x.useEffect(()=>{t(Nve(e))},[t,e]),null}function Dve(e){var t=Ua();return x.useEffect(()=>(t(uM(e)),()=>{t(uM({width:0,height:0}))}),[t,e]),null}function $ve(e,t,r,n){return e==="vertical"&&t!=null?{height:t}:e==="horizontal"?{width:r||n}:null}var Uve={align:"center",iconSize:14,inactiveColor:"#ccc",itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function FC(e){var t=di(e,Uve),r=jye(),n=Mxe(),a=hve(),{width:s,height:o,wrapperStyle:l,portal:c}=t,[u,d]=NW([r]),f=PC(),p=OC();if(f==null||p==null)return null;var h=f-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),m=$ve(t.layout,o,s,h),g=c?l:Mm(Mm({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},Bve(l,t,a,f,p,u)),l),b=c??n;if(b==null||r==null)return null;var y=x.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:d},x.createElement(Ive,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!c&&x.createElement(Dve,{width:u.width,height:u.height}),x.createElement(Rve,g4({},t,m,{margin:a,chartWidth:f,chartHeight:p,contextPayload:r})));return eS.createPortal(y,b)}FC.displayName="Legend";function x4(){return x4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},x4.apply(null,arguments)}function fM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fM(Object(r),!0).forEach(function(n){zve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zve(e,t,r){return(t=Wve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Wve(e){var t=qve(e,"string");return typeof t=="symbol"?t:t+""}function qve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Hve(e){return Array.isArray(e)&&Sc(e[0])&&Sc(e[1])?e.join(" ~ "):e}var vp={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},Vve=e=>{var{separator:t=vp.separator,contentStyle:r,itemStyle:n,labelStyle:a=vp.labelStyle,payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:p=vp.accessibilityLayer}=e,h=()=>{if(s&&s.length){var C={padding:0,margin:0},j=(l?FS(s,l):s).map((A,M)=>{if(A.type==="none")return null;var P=A.formatter||o||Hve,{value:R,name:N}=A,T=R,B=N;if(P){var G=P(R,N,A,M,s);if(Array.isArray(G))[T,B]=G;else if(G!=null)T=G;else return null}var re=Bg(Bg({},vp.itemStyle),{},{color:A.color||vp.itemStyle.color},n);return x.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(M),style:re},Sc(B)?x.createElement("span",{className:"recharts-tooltip-item-name"},B):null,Sc(B)?x.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,x.createElement("span",{className:"recharts-tooltip-item-value"},T),x.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return x.createElement("ul",{className:"recharts-tooltip-item-list",style:C},j)}return null},m=Bg(Bg({},vp.contentStyle),r),g=Bg({margin:0},a),b=!Da(d),y=b?d:"",v=sa("recharts-default-tooltip",c),w=sa("recharts-tooltip-label",u);b&&f&&s!==void 0&&s!==null&&(y=f(d,s));var _=p?{role:"status","aria-live":"assertive"}:{};return x.createElement("div",x4({className:v,style:m},_),x.createElement("p",{className:w,style:g},x.isValidElement(y)?y:"".concat(y)),h())},Ig="recharts-tooltip-wrapper",Gve={visibility:"hidden"};function Kve(e){var{coordinate:t,translateX:r,translateY:n}=e;return sa(Ig,{["".concat(Ig,"-right")]:an(r)&&t&&an(t.x)&&r>=t.x,["".concat(Ig,"-left")]:an(r)&&t&&an(t.x)&&r<t.x,["".concat(Ig,"-bottom")]:an(n)&&t&&an(t.y)&&n>=t.y,["".concat(Ig,"-top")]:an(n)&&t&&an(t.y)&&n<t.y})}function hM(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offset:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(s&&an(s[n]))return s[n];var d=r[n]-l-(a>0?a:0),f=r[n]+a;if(t[n])return o[n]?d:f;var p=c[n];if(p==null)return 0;if(o[n]){var h=d,m=p;return h<m?Math.max(f,p):Math.max(d,p)}if(u==null)return 0;var g=f+l,b=p+u;return g>b?Math.max(d,p):Math.max(f,p)}function Xve(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Yve(e){var{allowEscapeViewBox:t,coordinate:r,offsetTop:n,offsetLeft:a,position:s,reverseDirection:o,tooltipBox:l,useTranslate3d:c,viewBox:u}=e,d,f,p;return l.height>0&&l.width>0&&r?(f=hM({allowEscapeViewBox:t,coordinate:r,key:"x",offset:a,position:s,reverseDirection:o,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),p=hM({allowEscapeViewBox:t,coordinate:r,key:"y",offset:n,position:s,reverseDirection:o,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),d=Xve({translateX:f,translateY:p,useTranslate3d:c})):d=Gve,{cssProperties:d,cssClasses:Kve({translateX:f,translateY:p,coordinate:r})}}function pM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pM(Object(r),!0).forEach(function(n){y4(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y4(e,t,r){return(t=Qve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qve(e){var t=Jve(e,"string");return typeof t=="symbol"?t:t+""}function Jve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Zve extends x.PureComponent{constructor(){super(...arguments),y4(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),y4(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:p,viewBox:h,wrapperStyle:m,lastBoundingBox:g,innerRef:b,hasPortalFromProps:y}=this.props,v=typeof u=="number"?u:u.x,w=typeof u=="number"?u:u.y,{cssClasses:_,cssProperties:C}=Yve({allowEscapeViewBox:r,coordinate:o,offsetLeft:v,offsetTop:w,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:p,viewBox:h}),j=y?{}:Qb(Qb({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},C),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),A=Qb(Qb({},j),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},m);return x.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:_,style:A,ref:b},s)}}var Nq=()=>{var e;return(e=tn(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function b4(){return b4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b4.apply(null,arguments)}function mM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mM(Object(r),!0).forEach(function(n){e2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e2e(e,t,r){return(t=t2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t2e(e){var t=r2e(e,"string");return typeof t=="symbol"?t:t+""}function r2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xM={curveBasisClosed:Zxe,curveBasisOpen:e1e,curveBasis:Jxe,curveBumpX:Ixe,curveBumpY:Dxe,curveLinearClosed:t1e,curveLinear:AS,curveMonotoneX:r1e,curveMonotoneY:n1e,curveNatural:a1e,curveStep:i1e,curveStepAfter:o1e,curveStepBefore:s1e},lw=e=>Vn(e.x)&&Vn(e.y),yM=e=>e.base!=null&&lw(e.base)&&lw(e),Dg=e=>e.x,$g=e=>e.y,n2e=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(ay(e));if((r==="curveMonotone"||r==="curveBump")&&t){var n=xM["".concat(r).concat(t==="vertical"?"Y":"X")];if(n)return n}return xM[r]||AS},bM={connectNulls:!1,type:"linear"},a2e=e=>{var{type:t=bM.type,points:r=[],baseLine:n,layout:a,connectNulls:s=bM.connectNulls}=e,o=n2e(t,a),l=s?r.filter(lw):r;if(Array.isArray(n)){var c,u=r.map((m,g)=>gM(gM({},m),{},{base:n[g]}));a==="vertical"?c=Wb().y($g).x1(Dg).x0(m=>m.base.x):c=Wb().x(Dg).y1($g).y0(m=>m.base.y);var d=c.defined(yM).curve(o),f=s?u.filter(yM):u;return d(f)}var p;a==="vertical"&&an(n)?p=Wb().y($g).x1(Dg).x0(n):an(n)?p=Wb().x(Dg).y1($g).y0(n):p=Mz().x(Dg).y($g);var h=p.defined(lw).curve(o);return h(l)},JS=e=>{var{className:t,points:r,path:n,pathRef:a}=e,s=X0();if((!r||!r.length)&&!n)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||s,connectNulls:e.connectNulls},l=r&&r.length?a2e(o):n;return x.createElement("path",b4({},Ho(e),cC(e),{className:sa("recharts-curve",t),d:l===null?void 0:l,ref:a}))},i2e=["x","y","top","left","width","height","className"];function v4(){return v4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},v4.apply(null,arguments)}function vM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function s2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vM(Object(r),!0).forEach(function(n){o2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function o2e(e,t,r){return(t=l2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l2e(e){var t=c2e(e,"string");return typeof t=="symbol"?t:t+""}function c2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function u2e(e,t){if(e==null)return{};var r,n,a=d2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function d2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var f2e=(e,t,r,n,a,s)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(s,",").concat(t,"h").concat(r),h2e=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:s=0,height:o=0,className:l}=e,c=u2e(e,i2e),u=s2e({x:t,y:r,top:n,left:a,width:s,height:o},c);return!an(t)||!an(r)||!an(s)||!an(o)||!an(n)||!an(a)?null:x.createElement("path",v4({},To(u),{className:sa("recharts-cross",l),d:f2e(t,r,s,o,n,a)}))};function p2e(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function wM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function SM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wM(Object(r),!0).forEach(function(n){m2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function m2e(e,t,r){return(t=g2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function g2e(e){var t=x2e(e,"string");return typeof t=="symbol"?t:t+""}function x2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var y2e=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Cq=(e,t,r)=>e.map(n=>"".concat(y2e(n)," ").concat(t,"ms ").concat(r)).join(","),b2e=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),S1=(e,t)=>Object.keys(t).reduce((r,n)=>SM(SM({},r),{},{[n]:e(n,t[n])}),{});function _M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_M(Object(r),!0).forEach(function(n){v2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_M(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v2e(e,t,r){return(t=w2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w2e(e){var t=S2e(e,"string");return typeof t=="symbol"?t:t+""}function S2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cw=(e,t,r)=>e+(t-e)*r,w4=e=>{var{from:t,to:r}=e;return t!==r},Eq=(e,t,r)=>{var n=S1((a,s)=>{if(w4(s)){var[o,l]=e(s.from,s.to,s.velocity);return vs(vs({},s),{},{from:o,velocity:l})}return s},t);return r<1?S1((a,s)=>w4(s)&&n[a]!=null?vs(vs({},s),{},{velocity:cw(s.velocity,n[a].velocity,r),from:cw(s.from,n[a].from,r)}):s,t):Eq(e,n,r-1)};function _2e(e,t,r,n,a,s){var o,l=n.reduce((p,h)=>vs(vs({},p),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>S1((p,h)=>h.from,l),u=()=>!Object.values(l).filter(w4).length,d=null,f=p=>{o||(o=p);var h=p-o,m=h/r.dt;l=Eq(r,l,m),a(vs(vs(vs({},e),t),c())),o=p,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var p;(p=d)===null||p===void 0||p()})}function k2e(e,t,r,n,a,s,o){var l=null,c=a.reduce((f,p)=>{var h=e[p],m=t[p];return h==null||m==null?f:vs(vs({},f),{},{[p]:[h,m]})},{}),u,d=f=>{u||(u=f);var p=(f-u)/n,h=S1((g,b)=>cw(...b,r(p)),c);if(s(vs(vs(vs({},e),t),h)),p<1)l=o.setTimeout(d);else{var m=S1((g,b)=>cw(...b,r(1)),c);s(vs(vs(vs({},e),t),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const j2e=(e,t,r,n,a,s)=>{var o=b2e(e,t);return r==null?()=>(a(vs(vs({},e),t)),()=>{}):r.isStepper===!0?_2e(e,t,r,o,a,s):k2e(e,t,r,n,o,a,s)};var uw=1e-4,Tq=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],Pq=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),kM=(e,t)=>r=>{var n=Tq(e,t);return Pq(n,r)},A2e=(e,t)=>r=>{var n=Tq(e,t),a=[...n.map((s,o)=>s*o).slice(1),0];return Pq(a,r)},N2e=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var a=n.map(s=>parseFloat(s));return[a[0],a[1],a[2],a[3]]},C2e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=N2e(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},E2e=(e,t,r,n)=>{var a=kM(e,r),s=kM(t,n),o=A2e(e,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,p=0;p<8;++p){var h=a(f)-d,m=o(f);if(Math.abs(h-d)<uw||m<uw)return s(f);f=l(f-h/m)}return s(f)};return c.isStepper=!1,c},jM=function(){return E2e(...C2e(...arguments))},T2e=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*a/1e3,p=c*a/1e3+o;return Math.abs(p-l)<uw&&Math.abs(f)<uw?[l,0]:[p,f]};return s.isStepper=!0,s.dt=a,s},P2e=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return jM(e);case"spring":return T2e();default:if(e.split("(")[0]==="cubic-bezier")return jM(e)}return typeof e=="function"?e:null};function O2e(e){var t,r=()=>null,n=!1,a=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){a=e.setTimeout(s.bind(null,u),c);return}s(c),a=e.setTimeout(s.bind(null,u));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,a&&(a(),a=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class L2e{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,s=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function M2e(){return O2e(new L2e)}var F2e=x.createContext(M2e);function R2e(e,t){var r=x.useContext(F2e);return x.useMemo(()=>t??r(e),[e,t,r])}var B2e=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),ZS={isSsr:B2e()},I2e={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},AM={t:0},Rk={t:1};function rg(e){var t=di(e,I2e),{isActive:r,canBegin:n,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=r==="auto"?!ZS.isSsr:r,f=R2e(t.animationId,t.animationManager),[p,h]=x.useState(d?AM:Rk),m=x.useRef(null);return x.useEffect(()=>{d||h(Rk)},[d]),x.useEffect(()=>{if(!d||!n)return K0;var g=j2e(AM,Rk,P2e(s),a,h,f.getTimeoutController()),b=()=>{m.current=g()};return f.start([c,o,b,a,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,a,s,o,c,l,f]),u(p.t)}function ng(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=x.useRef(m1(t)),n=x.useRef(e);return n.current!==e&&(r.current=m1(t),n.current=e),r.current}var D2e=["radius"],$2e=["radius"],NM,CM,EM,TM,PM,OM,LM,MM,FM,RM;function BM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function IM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BM(Object(r),!0).forEach(function(n){U2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U2e(e,t,r){return(t=z2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z2e(e){var t=W2e(e,"string");return typeof t=="symbol"?t:t+""}function W2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dw(){return dw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dw.apply(null,arguments)}function DM(e,t){if(e==null)return{};var r,n,a=q2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function q2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function wu(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var $M=(e,t,r,n,a)=>{var s=Bf(r),o=Bf(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&Array.isArray(a)){for(var p=[0,0,0,0],h=0,m=4;h<m;h++){var g,b=(g=a[h])!==null&&g!==void 0?g:0;p[h]=b>l?l:b}f=Oi(NM||(NM=wu(["M",",",""])),e,t+c*p[0]),p[0]>0&&(f+=Oi(CM||(CM=wu(["A ",",",",0,0,",",",",",""])),p[0],p[0],d,e+u*p[0],t)),f+=Oi(EM||(EM=wu(["L ",",",""])),e+r-u*p[1],t),p[1]>0&&(f+=Oi(TM||(TM=wu(["A ",",",",0,0,",`,
        `,",",""])),p[1],p[1],d,e+r,t+c*p[1])),f+=Oi(PM||(PM=wu(["L ",",",""])),e+r,t+n-c*p[2]),p[2]>0&&(f+=Oi(OM||(OM=wu(["A ",",",",0,0,",`,
        `,",",""])),p[2],p[2],d,e+r-u*p[2],t+n)),f+=Oi(LM||(LM=wu(["L ",",",""])),e+u*p[3],t+n),p[3]>0&&(f+=Oi(MM||(MM=wu(["A ",",",",0,0,",`,
        `,",",""])),p[3],p[3],d,e,t+n-c*p[3])),f+="Z"}else if(l>0&&a===+a&&a>0){var y=Math.min(l,a);f=Oi(FM||(FM=wu(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*y,y,y,d,e+u*y,t,e+r-u*y,t,y,y,d,e+r,t+c*y,e+r,t+n-c*y,y,y,d,e+r-u*y,t+n,e+u*y,t+n,y,y,d,e,t+n-c*y)}else f=Oi(RM||(RM=wu(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return f},UM={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Oq=e=>{var t=di(e,UM),r=x.useRef(null),[n,a]=x.useState(-1);x.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var _e=r.current.getTotalLength();_e&&a(_e)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:p,animationBegin:h,isAnimationActive:m,isUpdateAnimationActive:g}=t,b=x.useRef(l),y=x.useRef(c),v=x.useRef(s),w=x.useRef(o),_=x.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),C=ng(_,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var j=sa("recharts-rectangle",d);if(!g){var A=To(t),{radius:M}=A,P=DM(A,D2e);return x.createElement("path",dw({},P,{x:Bf(s),y:Bf(o),width:Bf(l),height:Bf(c),radius:typeof u=="number"?u:void 0,className:j,d:$M(s,o,l,c,u)}))}var R=b.current,N=y.current,T=v.current,B=w.current,G="0px ".concat(n===-1?1:n,"px"),re="".concat(n,"px 0px"),xe=Cq(["strokeDasharray"],p,typeof f=="string"?f:UM.animationEasing);return x.createElement(rg,{animationId:C,key:C,canBegin:n>0,duration:p,easing:f,isActive:g,begin:h},_e=>{var V=Ia(R,l,_e),K=Ia(N,c,_e),de=Ia(T,s,_e),ne=Ia(B,o,_e);r.current&&(b.current=V,y.current=K,v.current=de,w.current=ne);var E;m?_e>0?E={transition:xe,strokeDasharray:re}:E={strokeDasharray:G}:E={strokeDasharray:re};var Z=To(t),{radius:H}=Z,F=DM(Z,$2e);return x.createElement("path",dw({},F,{radius:typeof u=="number"?u:void 0,className:j,d:$M(de,ne,V,K,u),ref:r,style:IM(IM({},E),t.style)}))})};function zM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function WM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zM(Object(r),!0).forEach(function(n){H2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H2e(e,t,r){return(t=V2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V2e(e){var t=G2e(e,"string");return typeof t=="symbol"?t:t+""}function G2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fw=Math.PI/180,K2e=e=>e*180/Math.PI,fs=(e,t,r,n)=>({x:e+Math.cos(-fw*n)*r,y:t+Math.sin(-fw*n)*r}),Lq=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},X2e=(e,t)=>{var{x:r,y:n}=e,{x:a,y:s}=t;return Math.sqrt((r-a)**2+(n-s)**2)},Y2e=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:s}=t,o=X2e({x:r,y:n},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-a)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:K2e(c),angleInRadian:c}},Q2e=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),s=Math.min(n,a);return{startAngle:t-s*360,endAngle:r-s*360}},J2e=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(a,s);return e+o*360},Z2e=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:a,angle:s}=Y2e({x:r,y:n},t),{innerRadius:o,outerRadius:l}=t;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:u}=Q2e(t),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?WM(WM({},t),{},{radius:a,angle:J2e(d,t)}):null};function Mq(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:s}=e,o=fs(t,r,n,a),l=fs(t,r,n,s);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:a,endAngle:s}}var qM,HM,VM,GM,KM,XM,YM;function S4(){return S4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S4.apply(null,arguments)}function qh(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ewe=(e,t)=>{var r=Ds(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},Jb=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,u=l*(o?1:-1)+n,d=Math.asin(l/u)/fw,f=c?a:a+s*d,p=fs(t,r,u,f),h=fs(t,r,n,f),m=c?a-s*d:a,g=fs(t,r,u*Math.cos(d*fw),m);return{center:p,circleTangency:h,lineTangency:g,theta:d}},Fq=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:s,endAngle:o}=e,l=ewe(s,o),c=s+l,u=fs(t,r,a,s),d=fs(t,r,a,c),f=Oi(qM||(qM=qh(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,a,a,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var p=fs(t,r,n,s),h=fs(t,r,n,c);f+=Oi(HM||(HM=qh(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(l)>180),+(s<=c),p.x,p.y)}else f+=Oi(VM||(VM=qh(["L ",","," Z"])),t,r);return f},twe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=Ds(u-c),{circleTangency:f,lineTangency:p,theta:h}=Jb({cx:t,cy:r,radius:a,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:g,theta:b}=Jb({cx:t,cy:r,radius:a,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),y=l?Math.abs(c-u):Math.abs(c-u)-h-b;if(y<0)return o?Oi(GM||(GM=qh(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),p.x,p.y,s,s,s*2,s,s,-s*2):Fq({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var v=Oi(KM||(KM=qh(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),p.x,p.y,s,s,+(d<0),f.x,f.y,a,a,+(y>180),+(d<0),m.x,m.y,s,s,+(d<0),g.x,g.y);if(n>0){var{circleTangency:w,lineTangency:_,theta:C}=Jb({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:j,lineTangency:A,theta:M}=Jb({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),P=l?Math.abs(c-u):Math.abs(c-u)-C-M;if(P<0&&s===0)return"".concat(v,"L").concat(t,",").concat(r,"Z");v+=Oi(XM||(XM=qh(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),A.x,A.y,s,s,+(d<0),j.x,j.y,n,n,+(P>180),+(d>0),w.x,w.y,s,s,+(d<0),_.x,_.y)}else v+=Oi(YM||(YM=qh(["L",",","Z"])),t,r);return v},rwe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Rq=e=>{var t=di(e,rwe),{cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(s<a||u===d)return null;var p=sa("recharts-sector",f),h=s-a,m=No(o,h,0,!0),g;return m>0&&Math.abs(u-d)<360?g=twe({cx:r,cy:n,innerRadius:a,outerRadius:s,cornerRadius:Math.min(m,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):g=Fq({cx:r,cy:n,innerRadius:a,outerRadius:s,startAngle:u,endAngle:d}),x.createElement("path",S4({},To(t),{className:p,d:g}))};function nwe(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(Yz(t)){if(e==="centric"){var{cx:n,cy:a,innerRadius:s,outerRadius:o,angle:l}=t,c=fs(n,a,s,l),u=fs(n,a,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return Mq(t)}}var Bq={},Iq={},Dq={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bC;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(Dq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Dq;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(Iq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vC,r=Iq;function n(a,s,o){o&&typeof o!="number"&&t.isIterateeCall(a,s,o)&&(s=o=void 0),a=r.toFinite(a),s===void 0?(s=a,a=0):s=r.toFinite(s),o=o===void 0?a<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=a,a+=o;return c}e.range=n})(Bq);var awe=Bq.range;const $q=Wd(awe);function Kf(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function iwe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function RC(e){let t,r,n;e.length!==2?(t=Kf,r=(l,c)=>Kf(e(l),c),n=(l,c)=>e(l)-c):(t=e===Kf||e===iwe?e:swe,r=e,n=e);function a(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=a(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:a,center:o,right:s}}function swe(){return 0}function Uq(e){return e===null?NaN:+e}function*owe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const lwe=RC(Kf),dy=lwe.right;RC(Uq).center;class QM extends Map{constructor(t,r=dwe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(JM(this,t))}has(t){return super.has(JM(this,t))}set(t,r){return super.set(cwe(this,t),r)}delete(t){return super.delete(uwe(this,t))}}function JM({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function cwe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function uwe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function dwe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function fwe(e=Kf){if(e===Kf)return zq;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function zq(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const hwe=Math.sqrt(50),pwe=Math.sqrt(10),mwe=Math.sqrt(2);function hw(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),s=n/Math.pow(10,a),o=s>=hwe?10:s>=pwe?5:s>=mwe?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?hw(e,t,r*2):[l,c,u]}function _4(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,s,o]=n?hw(t,e,r):hw(e,t,r);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(a+u)/-o;else for(let u=0;u<l;++u)c[u]=(a+u)*o;return c}function k4(e,t,r){return t=+t,e=+e,r=+r,hw(e,t,r)[2]}function j4(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?k4(t,e,r):k4(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function ZM(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function e7(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Wq(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?zq:fwe(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(t-u*f/c+p)),m=Math.min(n,Math.floor(t+(c-u)*f/c+p));Wq(e,t,h,m,a)}const s=e[t];let o=r,l=n;for(Ug(e,r,t),a(e[n],s)>0&&Ug(e,r,n);o<l;){for(Ug(e,o,l),++o,--l;a(e[o],s)<0;)++o;for(;a(e[l],s)>0;)--l}a(e[r],s)===0?Ug(e,r,l):(++l,Ug(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Ug(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function gwe(e,t,r){if(e=Float64Array.from(owe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return e7(e);if(t>=1)return ZM(e);var n,a=(n-1)*t,s=Math.floor(a),o=ZM(Wq(e,s).subarray(0,s+1)),l=e7(e.subarray(s+1));return o+(l-o)*(a-s)}}function xwe(e,t,r=Uq){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,s=Math.floor(a),o=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return o+(l-o)*(a-s)}}function ywe(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(a);++n<a;)s[n]=e+n*r;return s}function Cc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Zd(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const A4=Symbol("implicit");function BC(){var e=new QM,t=[],r=[],n=A4;function a(s){let o=e.get(s);if(o===void 0){if(n!==A4)return n;e.set(s,o=t.push(s)-1)}return r[o%r.length]}return a.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new QM;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(s){return arguments.length?(r=Array.from(s),a):r.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return BC(t,r).unknown(n)},Cc.apply(a,arguments),a}function IC(){var e=BC().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,s,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var p=t().length,h=a<n,m=h?a:n,g=h?n:a;s=(g-m)/Math.max(1,p-c+u*2),l&&(s=Math.floor(s)),m+=(g-m-s*(p-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var b=ywe(p).map(function(y){return m+s*y});return r(h?b.reverse():b)}return e.domain=function(p){return arguments.length?(t(p),f()):t()},e.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,f()):[n,a]},e.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(p){return arguments.length?(l=!!p,f()):l},e.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),f()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),f()):c},e.paddingOuter=function(p){return arguments.length?(u=+p,f()):u},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),f()):d},e.copy=function(){return IC(t(),[n,a]).round(l).paddingInner(c).paddingOuter(u).align(d)},Cc.apply(f(),arguments)}function qq(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return qq(t())},e}function bwe(){return qq(IC.apply(null,arguments).paddingInner(1))}function DC(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Hq(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function fy(){}var _1=.7,pw=1/_1,gm="\\s*([+-]?\\d+)\\s*",k1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Uu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vwe=/^#([0-9a-f]{3,8})$/,wwe=new RegExp(`^rgb\\(${gm},${gm},${gm}\\)$`),Swe=new RegExp(`^rgb\\(${Uu},${Uu},${Uu}\\)$`),_we=new RegExp(`^rgba\\(${gm},${gm},${gm},${k1}\\)$`),kwe=new RegExp(`^rgba\\(${Uu},${Uu},${Uu},${k1}\\)$`),jwe=new RegExp(`^hsl\\(${k1},${Uu},${Uu}\\)$`),Awe=new RegExp(`^hsla\\(${k1},${Uu},${Uu},${k1}\\)$`),t7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};DC(fy,j1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:r7,formatHex:r7,formatHex8:Nwe,formatHsl:Cwe,formatRgb:n7,toString:n7});function r7(){return this.rgb().formatHex()}function Nwe(){return this.rgb().formatHex8()}function Cwe(){return Vq(this).formatHsl()}function n7(){return this.rgb().formatRgb()}function j1(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=vwe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?a7(t):r===3?new ll(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Zb(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Zb(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=wwe.exec(e))?new ll(t[1],t[2],t[3],1):(t=Swe.exec(e))?new ll(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=_we.exec(e))?Zb(t[1],t[2],t[3],t[4]):(t=kwe.exec(e))?Zb(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=jwe.exec(e))?o7(t[1],t[2]/100,t[3]/100,1):(t=Awe.exec(e))?o7(t[1],t[2]/100,t[3]/100,t[4]):t7.hasOwnProperty(e)?a7(t7[e]):e==="transparent"?new ll(NaN,NaN,NaN,0):null}function a7(e){return new ll(e>>16&255,e>>8&255,e&255,1)}function Zb(e,t,r,n){return n<=0&&(e=t=r=NaN),new ll(e,t,r,n)}function Ewe(e){return e instanceof fy||(e=j1(e)),e?(e=e.rgb(),new ll(e.r,e.g,e.b,e.opacity)):new ll}function N4(e,t,r,n){return arguments.length===1?Ewe(e):new ll(e,t,r,n??1)}function ll(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}DC(ll,N4,Hq(fy,{brighter(e){return e=e==null?pw:Math.pow(pw,e),new ll(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?_1:Math.pow(_1,e),new ll(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ll(a0(this.r),a0(this.g),a0(this.b),mw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:i7,formatHex:i7,formatHex8:Twe,formatRgb:s7,toString:s7}));function i7(){return`#${Hh(this.r)}${Hh(this.g)}${Hh(this.b)}`}function Twe(){return`#${Hh(this.r)}${Hh(this.g)}${Hh(this.b)}${Hh((isNaN(this.opacity)?1:this.opacity)*255)}`}function s7(){const e=mw(this.opacity);return`${e===1?"rgb(":"rgba("}${a0(this.r)}, ${a0(this.g)}, ${a0(this.b)}${e===1?")":`, ${e})`}`}function mw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function a0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Hh(e){return e=a0(e),(e<16?"0":"")+e.toString(16)}function o7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Hc(e,t,r,n)}function Vq(e){if(e instanceof Hc)return new Hc(e.h,e.s,e.l,e.opacity);if(e instanceof fy||(e=j1(e)),!e)return new Hc;if(e instanceof Hc)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-a,c=(s+a)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new Hc(o,l,c,e.opacity)}function Pwe(e,t,r,n){return arguments.length===1?Vq(e):new Hc(e,t,r,n??1)}function Hc(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}DC(Hc,Pwe,Hq(fy,{brighter(e){return e=e==null?pw:Math.pow(pw,e),new Hc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?_1:Math.pow(_1,e),new Hc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new ll(Bk(e>=240?e-240:e+120,a,n),Bk(e,a,n),Bk(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Hc(l7(this.h),ev(this.s),ev(this.l),mw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=mw(this.opacity);return`${e===1?"hsl(":"hsla("}${l7(this.h)}, ${ev(this.s)*100}%, ${ev(this.l)*100}%${e===1?")":`, ${e})`}`}}));function l7(e){return e=(e||0)%360,e<0?e+360:e}function ev(e){return Math.max(0,Math.min(1,e||0))}function Bk(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const $C=e=>()=>e;function Owe(e,t){return function(r){return e+r*t}}function Lwe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function Mwe(e){return(e=+e)==1?Gq:function(t,r){return r-t?Lwe(t,r,e):$C(isNaN(t)?r:t)}}function Gq(e,t){var r=t-e;return r?Owe(e,r):$C(isNaN(e)?t:e)}const c7=function e(t){var r=Mwe(t);function n(a,s){var o=r((a=N4(a)).r,(s=N4(s)).r),l=r(a.g,s.g),c=r(a.b,s.b),u=Gq(a.opacity,s.opacity);return function(d){return a.r=o(d),a.g=l(d),a.b=c(d),a.opacity=u(d),a+""}}return n.gamma=e,n}(1);function Fwe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(s){for(a=0;a<r;++a)n[a]=e[a]*(1-s)+t[a]*s;return n}}function Rwe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Bwe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)a[o]=ag(e[o],t[o]);for(;o<r;++o)s[o]=t[o];return function(l){for(o=0;o<n;++o)s[o]=a[o](l);return s}}function Iwe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function gw(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Dwe(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=ag(e[a],t[a]):n[a]=t[a];return function(s){for(a in r)n[a]=r[a](s);return n}}var C4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ik=new RegExp(C4.source,"g");function $we(e){return function(){return e}}function Uwe(e){return function(t){return e(t)+""}}function zwe(e,t){var r=C4.lastIndex=Ik.lastIndex=0,n,a,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=C4.exec(e))&&(a=Ik.exec(t));)(s=a.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:gw(n,a)})),r=Ik.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?Uwe(c[0].x):$we(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function ag(e,t){var r=typeof t,n;return t==null||r==="boolean"?$C(t):(r==="number"?gw:r==="string"?(n=j1(t))?(t=n,c7):zwe:t instanceof j1?c7:t instanceof Date?Iwe:Rwe(t)?Fwe:Array.isArray(t)?Bwe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Dwe:gw)(e,t)}function UC(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function Wwe(e,t){t===void 0&&(t=e,e=ag);for(var r=0,n=t.length-1,a=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(a,a=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function qwe(e){return function(){return e}}function xw(e){return+e}var u7=[0,1];function Uo(e){return e}function E4(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:qwe(isNaN(t)?NaN:.5)}function Hwe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function Vwe(e,t,r){var n=e[0],a=e[1],s=t[0],o=t[1];return a<n?(n=E4(a,n),s=r(o,s)):(n=E4(n,a),s=r(s,o)),function(l){return s(n(l))}}function Gwe(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),s=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)a[o]=E4(e[o],e[o+1]),s[o]=r(t[o],t[o+1]);return function(l){var c=dy(e,l,1,n)-1;return s[c](a[c](l))}}function hy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function e_(){var e=u7,t=u7,r=ag,n,a,s,o=Uo,l,c,u;function d(){var p=Math.min(e.length,t.length);return o!==Uo&&(o=Hwe(e[0],e[p-1])),l=p>2?Gwe:Vwe,c=u=null,f}function f(p){return p==null||isNaN(p=+p)?s:(c||(c=l(e.map(n),t,r)))(n(o(p)))}return f.invert=function(p){return o(a((u||(u=l(t,e.map(n),gw)))(p)))},f.domain=function(p){return arguments.length?(e=Array.from(p,xw),d()):e.slice()},f.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},f.rangeRound=function(p){return t=Array.from(p),r=UC,d()},f.clamp=function(p){return arguments.length?(o=p?!0:Uo,d()):o!==Uo},f.interpolate=function(p){return arguments.length?(r=p,d()):r},f.unknown=function(p){return arguments.length?(s=p,f):s},function(p,h){return n=p,a=h,d()}}function zC(){return e_()(Uo,Uo)}function Kwe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function yw(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Fm(e){return e=yw(Math.abs(e)),e?e[1]:NaN}function Xwe(e,t){return function(r,n){for(var a=r.length,s=[],o=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(a-=l,a+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return s.reverse().join(t)}}function Ywe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Qwe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function A1(e){if(!(t=Qwe.exec(e)))throw new Error("invalid format: "+e);var t;return new WC({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}A1.prototype=WC.prototype;function WC(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}WC.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Jwe(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var bw;function Zwe(e,t){var r=yw(e,t);if(!r)return bw=void 0,e.toPrecision(t);var n=r[0],a=r[1],s=a-(bw=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+yw(e,Math.max(0,t+s-1))[0]}function d7(e,t){var r=yw(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const f7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Kwe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>d7(e*100,t),r:d7,s:Zwe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function h7(e){return e}var p7=Array.prototype.map,m7=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function eSe(e){var t=e.grouping===void 0||e.thousands===void 0?h7:Xwe(p7.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?h7:Ywe(p7.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f,p){f=A1(f);var h=f.fill,m=f.align,g=f.sign,b=f.symbol,y=f.zero,v=f.width,w=f.comma,_=f.precision,C=f.trim,j=f.type;j==="n"?(w=!0,j="g"):f7[j]||(_===void 0&&(_=12),C=!0,j="g"),(y||h==="0"&&m==="=")&&(y=!0,h="0",m="=");var A=(p&&p.prefix!==void 0?p.prefix:"")+(b==="$"?r:b==="#"&&/[boxX]/.test(j)?"0"+j.toLowerCase():""),M=(b==="$"?n:/[%p]/.test(j)?o:"")+(p&&p.suffix!==void 0?p.suffix:""),P=f7[j],R=/[defgprs%]/.test(j);_=_===void 0?6:/[gprs]/.test(j)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function N(T){var B=A,G=M,re,xe,_e;if(j==="c")G=P(T)+G,T="";else{T=+T;var V=T<0||1/T<0;if(T=isNaN(T)?c:P(Math.abs(T),_),C&&(T=Jwe(T)),V&&+T==0&&g!=="+"&&(V=!1),B=(V?g==="("?g:l:g==="-"||g==="("?"":g)+B,G=(j==="s"&&!isNaN(T)&&bw!==void 0?m7[8+bw/3]:"")+G+(V&&g==="("?")":""),R){for(re=-1,xe=T.length;++re<xe;)if(_e=T.charCodeAt(re),48>_e||_e>57){G=(_e===46?a+T.slice(re+1):T.slice(re))+G,T=T.slice(0,re);break}}}w&&!y&&(T=t(T,1/0));var K=B.length+T.length+G.length,de=K<v?new Array(v-K+1).join(h):"";switch(w&&y&&(T=t(de+T,de.length?v-G.length:1/0),de=""),m){case"<":T=B+T+G+de;break;case"=":T=B+de+T+G;break;case"^":T=de.slice(0,K=de.length>>1)+B+T+G+de.slice(K);break;default:T=de+B+T+G;break}return s(T)}return N.toString=function(){return f+""},N}function d(f,p){var h=Math.max(-8,Math.min(8,Math.floor(Fm(p)/3)))*3,m=Math.pow(10,-h),g=u((f=A1(f),f.type="f",f),{suffix:m7[8+h/3]});return function(b){return g(m*b)}}return{format:u,formatPrefix:d}}var tv,qC,Kq;tSe({thousands:",",grouping:[3],currency:["$",""]});function tSe(e){return tv=eSe(e),qC=tv.format,Kq=tv.formatPrefix,tv}function rSe(e){return Math.max(0,-Fm(Math.abs(e)))}function nSe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Fm(t)/3)))*3-Fm(Math.abs(e)))}function aSe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Fm(t)-Fm(e))+1}function Xq(e,t,r,n){var a=j4(e,t,r),s;switch(n=A1(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=nSe(a,o))&&(n.precision=s),Kq(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=aSe(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=rSe(a))&&(n.precision=s-(n.type==="%")*2);break}}return qC(n)}function xh(e){var t=e.domain;return e.ticks=function(r){var n=t();return _4(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return Xq(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,s=n.length-1,o=n[a],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=a,a=s,s=u);d-- >0;){if(u=k4(o,l,r),u===c)return n[a]=o,n[s]=l,t(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function Yq(){var e=zC();return e.copy=function(){return hy(e,Yq())},Cc.apply(e,arguments),xh(e)}function Qq(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,xw),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return Qq(e).unknown(t)},e=arguments.length?Array.from(e,xw):[0,1],xh(r)}function Jq(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],s=e[n],o;return s<a&&(o=r,r=n,n=o,o=a,a=s,s=o),e[r]=t.floor(a),e[n]=t.ceil(s),e}function g7(e){return Math.log(e)}function x7(e){return Math.exp(e)}function iSe(e){return-Math.log(-e)}function sSe(e){return-Math.exp(-e)}function oSe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function lSe(e){return e===10?oSe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function cSe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function y7(e){return(t,r)=>-e(-t,r)}function HC(e){const t=e(g7,x7),r=t.domain;let n=10,a,s;function o(){return a=cSe(n),s=lSe(n),r()[0]<0?(a=y7(a),s=y7(s),e(iSe,sSe)):e(g7,x7),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let p=a(u),h=a(d),m,g;const b=l==null?10:+l;let y=[];if(!(n%1)&&h-p<b){if(p=Math.floor(p),h=Math.ceil(h),u>0){for(;p<=h;++p)for(m=1;m<n;++m)if(g=p<0?m/s(-p):m*s(p),!(g<u)){if(g>d)break;y.push(g)}}else for(;p<=h;++p)for(m=n-1;m>=1;--m)if(g=p>0?m/s(-p):m*s(p),!(g<u)){if(g>d)break;y.push(g)}y.length*2<b&&(y=_4(u,d,b))}else y=_4(p,h,Math.min(h-p,b)).map(s);return f?y.reverse():y},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=A1(c)).precision==null&&(c.trim=!0),c=qC(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/s(Math.round(a(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(Jq(r(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),t}function Zq(){const e=HC(e_()).domain([1,10]);return e.copy=()=>hy(e,Zq()).base(e.base()),Cc.apply(e,arguments),e}function b7(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function v7(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function VC(e){var t=1,r=e(b7(t),v7(t));return r.constant=function(n){return arguments.length?e(b7(t=+n),v7(t)):t},xh(r)}function eH(){var e=VC(e_());return e.copy=function(){return hy(e,eH()).constant(e.constant())},Cc.apply(e,arguments)}function w7(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function uSe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function dSe(e){return e<0?-e*e:e*e}function GC(e){var t=e(Uo,Uo),r=1;function n(){return r===1?e(Uo,Uo):r===.5?e(uSe,dSe):e(w7(r),w7(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},xh(t)}function KC(){var e=GC(e_());return e.copy=function(){return hy(e,KC()).exponent(e.exponent())},Cc.apply(e,arguments),e}function fSe(){return KC.apply(null,arguments).exponent(.5)}function S7(e){return Math.sign(e)*e*e}function hSe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function tH(){var e=zC(),t=[0,1],r=!1,n;function a(s){var o=hSe(e(s));return isNaN(o)?n:r?Math.round(o):o}return a.invert=function(s){return e.invert(S7(s))},a.domain=function(s){return arguments.length?(e.domain(s),a):e.domain()},a.range=function(s){return arguments.length?(e.range((t=Array.from(s,xw)).map(S7)),a):t.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(r=!!s,a):r},a.clamp=function(s){return arguments.length?(e.clamp(s),a):e.clamp()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return tH(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Cc.apply(a,arguments),xh(a)}function rH(){var e=[],t=[],r=[],n;function a(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=xwe(e,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:t[dy(r,o)]}return s.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Kf),a()},s.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return rH().domain(e).range(t).unknown(n)},Cc.apply(s,arguments)}function nH(){var e=0,t=1,r=1,n=[.5],a=[0,1],s;function o(c){return c!=null&&c<=c?a[dy(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return nH().domain([e,t]).range(a).unknown(s)},Cc.apply(xh(o),arguments)}function aH(){var e=[.5],t=[0,1],r,n=1;function a(s){return s!=null&&s<=s?t[dy(e,s,0,n)]:r}return a.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},a.unknown=function(s){return arguments.length?(r=s,a):r},a.copy=function(){return aH().domain(e).range(t).unknown(r)},Cc.apply(a,arguments)}const Dk=new Date,$k=new Date;function As(e,t,r,n){function a(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(e(s=new Date(+s)),s),a.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),t(s,l),e(s);while(u<s&&s<o);return c},a.filter=s=>As(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!s(o););else for(;--l>=0;)for(;t(o,1),!s(o););}),r&&(a.count=(s,o)=>(Dk.setTime(+s),$k.setTime(+o),e(Dk),e($k),Math.floor(r(Dk,$k))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(n?o=>n(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const vw=As(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);vw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?As(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):vw);vw.range;const bd=1e3,mc=bd*60,vd=mc*60,Rd=vd*24,XC=Rd*7,_7=Rd*30,Uk=Rd*365,Vh=As(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*bd)},(e,t)=>(t-e)/bd,e=>e.getUTCSeconds());Vh.range;const YC=As(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*bd)},(e,t)=>{e.setTime(+e+t*mc)},(e,t)=>(t-e)/mc,e=>e.getMinutes());YC.range;const QC=As(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*mc)},(e,t)=>(t-e)/mc,e=>e.getUTCMinutes());QC.range;const JC=As(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*bd-e.getMinutes()*mc)},(e,t)=>{e.setTime(+e+t*vd)},(e,t)=>(t-e)/vd,e=>e.getHours());JC.range;const ZC=As(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*vd)},(e,t)=>(t-e)/vd,e=>e.getUTCHours());ZC.range;const py=As(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*mc)/Rd,e=>e.getDate()-1);py.range;const t_=As(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Rd,e=>e.getUTCDate()-1);t_.range;const iH=As(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Rd,e=>Math.floor(e/Rd));iH.range;function Y0(e){return As(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*mc)/XC)}const r_=Y0(0),ww=Y0(1),pSe=Y0(2),mSe=Y0(3),Rm=Y0(4),gSe=Y0(5),xSe=Y0(6);r_.range;ww.range;pSe.range;mSe.range;Rm.range;gSe.range;xSe.range;function Q0(e){return As(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/XC)}const n_=Q0(0),Sw=Q0(1),ySe=Q0(2),bSe=Q0(3),Bm=Q0(4),vSe=Q0(5),wSe=Q0(6);n_.range;Sw.range;ySe.range;bSe.range;Bm.range;vSe.range;wSe.range;const eE=As(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());eE.range;const tE=As(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());tE.range;const Bd=As(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Bd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:As(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Bd.range;const Id=As(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Id.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:As(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Id.range;function sH(e,t,r,n,a,s){const o=[[Vh,1,bd],[Vh,5,5*bd],[Vh,15,15*bd],[Vh,30,30*bd],[s,1,mc],[s,5,5*mc],[s,15,15*mc],[s,30,30*mc],[a,1,vd],[a,3,3*vd],[a,6,6*vd],[a,12,12*vd],[n,1,Rd],[n,2,2*Rd],[r,1,XC],[t,1,_7],[t,3,3*_7],[e,1,Uk]];function l(u,d,f){const p=d<u;p&&([u,d]=[d,u]);const h=f&&typeof f.range=="function"?f:c(u,d,f),m=h?h.range(u,+d+1):[];return p?m.reverse():m}function c(u,d,f){const p=Math.abs(d-u)/f,h=RC(([,,b])=>b).right(o,p);if(h===o.length)return e.every(j4(u/Uk,d/Uk,f));if(h===0)return vw.every(Math.max(j4(u,d,f),1));const[m,g]=o[p/o[h-1][2]<o[h][2]/p?h-1:h];return m.every(g)}return[l,c]}const[SSe,_Se]=sH(Id,tE,n_,iH,ZC,QC),[kSe,jSe]=sH(Bd,eE,r_,py,JC,YC);function zk(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Wk(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function zg(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function ASe(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,s=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=Wg(a),d=qg(a),f=Wg(s),p=qg(s),h=Wg(o),m=qg(o),g=Wg(l),b=qg(l),y=Wg(c),v=qg(c),w={a:_e,A:V,b:K,B:de,c:null,d:E7,e:E7,f:XSe,g:i_e,G:o_e,H:VSe,I:GSe,j:KSe,L:oH,m:YSe,M:QSe,p:ne,q:E,Q:O7,s:L7,S:JSe,u:ZSe,U:e_e,V:t_e,w:r_e,W:n_e,x:null,X:null,y:a_e,Y:s_e,Z:l_e,"%":P7},_={a:Z,A:H,b:F,B:ee,c:null,d:T7,e:T7,f:f_e,g:S_e,G:k_e,H:c_e,I:u_e,j:d_e,L:cH,m:h_e,M:p_e,p:z,q:X,Q:O7,s:L7,S:m_e,u:g_e,U:x_e,V:y_e,w:b_e,W:v_e,x:null,X:null,y:w_e,Y:__e,Z:j_e,"%":P7},C={a:R,A:N,b:T,B,c:G,d:N7,e:N7,f:zSe,g:A7,G:j7,H:C7,I:C7,j:ISe,L:USe,m:BSe,M:DSe,p:P,q:RSe,Q:qSe,s:HSe,S:$Se,u:PSe,U:OSe,V:LSe,w:TSe,W:MSe,x:re,X:xe,y:A7,Y:j7,Z:FSe,"%":WSe};w.x=j(r,w),w.X=j(n,w),w.c=j(t,w),_.x=j(r,_),_.X=j(n,_),_.c=j(t,_);function j(J,q){return function(Y){var L=[],U=-1,ce=0,W=J.length,ae,he,ze;for(Y instanceof Date||(Y=new Date(+Y));++U<W;)J.charCodeAt(U)===37&&(L.push(J.slice(ce,U)),(he=k7[ae=J.charAt(++U)])!=null?ae=J.charAt(++U):he=ae==="e"?" ":"0",(ze=q[ae])&&(ae=ze(Y,he)),L.push(ae),ce=U+1);return L.push(J.slice(ce,U)),L.join("")}}function A(J,q){return function(Y){var L=zg(1900,void 0,1),U=M(L,J,Y+="",0),ce,W;if(U!=Y.length)return null;if("Q"in L)return new Date(L.Q);if("s"in L)return new Date(L.s*1e3+("L"in L?L.L:0));if(q&&!("Z"in L)&&(L.Z=0),"p"in L&&(L.H=L.H%12+L.p*12),L.m===void 0&&(L.m="q"in L?L.q:0),"V"in L){if(L.V<1||L.V>53)return null;"w"in L||(L.w=1),"Z"in L?(ce=Wk(zg(L.y,0,1)),W=ce.getUTCDay(),ce=W>4||W===0?Sw.ceil(ce):Sw(ce),ce=t_.offset(ce,(L.V-1)*7),L.y=ce.getUTCFullYear(),L.m=ce.getUTCMonth(),L.d=ce.getUTCDate()+(L.w+6)%7):(ce=zk(zg(L.y,0,1)),W=ce.getDay(),ce=W>4||W===0?ww.ceil(ce):ww(ce),ce=py.offset(ce,(L.V-1)*7),L.y=ce.getFullYear(),L.m=ce.getMonth(),L.d=ce.getDate()+(L.w+6)%7)}else("W"in L||"U"in L)&&("w"in L||(L.w="u"in L?L.u%7:"W"in L?1:0),W="Z"in L?Wk(zg(L.y,0,1)).getUTCDay():zk(zg(L.y,0,1)).getDay(),L.m=0,L.d="W"in L?(L.w+6)%7+L.W*7-(W+5)%7:L.w+L.U*7-(W+6)%7);return"Z"in L?(L.H+=L.Z/100|0,L.M+=L.Z%100,Wk(L)):zk(L)}}function M(J,q,Y,L){for(var U=0,ce=q.length,W=Y.length,ae,he;U<ce;){if(L>=W)return-1;if(ae=q.charCodeAt(U++),ae===37){if(ae=q.charAt(U++),he=C[ae in k7?q.charAt(U++):ae],!he||(L=he(J,Y,L))<0)return-1}else if(ae!=Y.charCodeAt(L++))return-1}return L}function P(J,q,Y){var L=u.exec(q.slice(Y));return L?(J.p=d.get(L[0].toLowerCase()),Y+L[0].length):-1}function R(J,q,Y){var L=h.exec(q.slice(Y));return L?(J.w=m.get(L[0].toLowerCase()),Y+L[0].length):-1}function N(J,q,Y){var L=f.exec(q.slice(Y));return L?(J.w=p.get(L[0].toLowerCase()),Y+L[0].length):-1}function T(J,q,Y){var L=y.exec(q.slice(Y));return L?(J.m=v.get(L[0].toLowerCase()),Y+L[0].length):-1}function B(J,q,Y){var L=g.exec(q.slice(Y));return L?(J.m=b.get(L[0].toLowerCase()),Y+L[0].length):-1}function G(J,q,Y){return M(J,t,q,Y)}function re(J,q,Y){return M(J,r,q,Y)}function xe(J,q,Y){return M(J,n,q,Y)}function _e(J){return o[J.getDay()]}function V(J){return s[J.getDay()]}function K(J){return c[J.getMonth()]}function de(J){return l[J.getMonth()]}function ne(J){return a[+(J.getHours()>=12)]}function E(J){return 1+~~(J.getMonth()/3)}function Z(J){return o[J.getUTCDay()]}function H(J){return s[J.getUTCDay()]}function F(J){return c[J.getUTCMonth()]}function ee(J){return l[J.getUTCMonth()]}function z(J){return a[+(J.getUTCHours()>=12)]}function X(J){return 1+~~(J.getUTCMonth()/3)}return{format:function(J){var q=j(J+="",w);return q.toString=function(){return J},q},parse:function(J){var q=A(J+="",!1);return q.toString=function(){return J},q},utcFormat:function(J){var q=j(J+="",_);return q.toString=function(){return J},q},utcParse:function(J){var q=A(J+="",!0);return q.toString=function(){return J},q}}}var k7={"-":"",_:" ",0:"0"},Us=/^\s*\d+/,NSe=/^%/,CSe=/[\\^$*+?|[\]().{}]/g;function ha(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",s=a.length;return n+(s<r?new Array(r-s+1).join(t)+a:a)}function ESe(e){return e.replace(CSe,"\\$&")}function Wg(e){return new RegExp("^(?:"+e.map(ESe).join("|")+")","i")}function qg(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function TSe(e,t,r){var n=Us.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function PSe(e,t,r){var n=Us.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function OSe(e,t,r){var n=Us.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function LSe(e,t,r){var n=Us.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function MSe(e,t,r){var n=Us.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function j7(e,t,r){var n=Us.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function A7(e,t,r){var n=Us.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function FSe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function RSe(e,t,r){var n=Us.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function BSe(e,t,r){var n=Us.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function N7(e,t,r){var n=Us.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function ISe(e,t,r){var n=Us.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function C7(e,t,r){var n=Us.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function DSe(e,t,r){var n=Us.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function $Se(e,t,r){var n=Us.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function USe(e,t,r){var n=Us.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function zSe(e,t,r){var n=Us.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function WSe(e,t,r){var n=NSe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function qSe(e,t,r){var n=Us.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function HSe(e,t,r){var n=Us.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function E7(e,t){return ha(e.getDate(),t,2)}function VSe(e,t){return ha(e.getHours(),t,2)}function GSe(e,t){return ha(e.getHours()%12||12,t,2)}function KSe(e,t){return ha(1+py.count(Bd(e),e),t,3)}function oH(e,t){return ha(e.getMilliseconds(),t,3)}function XSe(e,t){return oH(e,t)+"000"}function YSe(e,t){return ha(e.getMonth()+1,t,2)}function QSe(e,t){return ha(e.getMinutes(),t,2)}function JSe(e,t){return ha(e.getSeconds(),t,2)}function ZSe(e){var t=e.getDay();return t===0?7:t}function e_e(e,t){return ha(r_.count(Bd(e)-1,e),t,2)}function lH(e){var t=e.getDay();return t>=4||t===0?Rm(e):Rm.ceil(e)}function t_e(e,t){return e=lH(e),ha(Rm.count(Bd(e),e)+(Bd(e).getDay()===4),t,2)}function r_e(e){return e.getDay()}function n_e(e,t){return ha(ww.count(Bd(e)-1,e),t,2)}function a_e(e,t){return ha(e.getFullYear()%100,t,2)}function i_e(e,t){return e=lH(e),ha(e.getFullYear()%100,t,2)}function s_e(e,t){return ha(e.getFullYear()%1e4,t,4)}function o_e(e,t){var r=e.getDay();return e=r>=4||r===0?Rm(e):Rm.ceil(e),ha(e.getFullYear()%1e4,t,4)}function l_e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+ha(t/60|0,"0",2)+ha(t%60,"0",2)}function T7(e,t){return ha(e.getUTCDate(),t,2)}function c_e(e,t){return ha(e.getUTCHours(),t,2)}function u_e(e,t){return ha(e.getUTCHours()%12||12,t,2)}function d_e(e,t){return ha(1+t_.count(Id(e),e),t,3)}function cH(e,t){return ha(e.getUTCMilliseconds(),t,3)}function f_e(e,t){return cH(e,t)+"000"}function h_e(e,t){return ha(e.getUTCMonth()+1,t,2)}function p_e(e,t){return ha(e.getUTCMinutes(),t,2)}function m_e(e,t){return ha(e.getUTCSeconds(),t,2)}function g_e(e){var t=e.getUTCDay();return t===0?7:t}function x_e(e,t){return ha(n_.count(Id(e)-1,e),t,2)}function uH(e){var t=e.getUTCDay();return t>=4||t===0?Bm(e):Bm.ceil(e)}function y_e(e,t){return e=uH(e),ha(Bm.count(Id(e),e)+(Id(e).getUTCDay()===4),t,2)}function b_e(e){return e.getUTCDay()}function v_e(e,t){return ha(Sw.count(Id(e)-1,e),t,2)}function w_e(e,t){return ha(e.getUTCFullYear()%100,t,2)}function S_e(e,t){return e=uH(e),ha(e.getUTCFullYear()%100,t,2)}function __e(e,t){return ha(e.getUTCFullYear()%1e4,t,4)}function k_e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Bm(e):Bm.ceil(e),ha(e.getUTCFullYear()%1e4,t,4)}function j_e(){return"+0000"}function P7(){return"%"}function O7(e){return+e}function L7(e){return Math.floor(+e/1e3)}var wp,dH,fH;A_e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function A_e(e){return wp=ASe(e),dH=wp.format,wp.parse,fH=wp.utcFormat,wp.utcParse,wp}function N_e(e){return new Date(e)}function C_e(e){return e instanceof Date?+e:+new Date(+e)}function rE(e,t,r,n,a,s,o,l,c,u){var d=zC(),f=d.invert,p=d.domain,h=u(".%L"),m=u(":%S"),g=u("%I:%M"),b=u("%I %p"),y=u("%a %d"),v=u("%b %d"),w=u("%B"),_=u("%Y");function C(j){return(c(j)<j?h:l(j)<j?m:o(j)<j?g:s(j)<j?b:n(j)<j?a(j)<j?y:v:r(j)<j?w:_)(j)}return d.invert=function(j){return new Date(f(j))},d.domain=function(j){return arguments.length?p(Array.from(j,C_e)):p().map(N_e)},d.ticks=function(j){var A=p();return e(A[0],A[A.length-1],j??10)},d.tickFormat=function(j,A){return A==null?C:u(A)},d.nice=function(j){var A=p();return(!j||typeof j.range!="function")&&(j=t(A[0],A[A.length-1],j??10)),j?p(Jq(A,j)):d},d.copy=function(){return hy(d,rE(e,t,r,n,a,s,o,l,c,u))},d}function E_e(){return Cc.apply(rE(kSe,jSe,Bd,eE,r_,py,JC,YC,Vh,dH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function T_e(){return Cc.apply(rE(SSe,_Se,Id,tE,n_,t_,ZC,QC,Vh,fH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function a_(){var e=0,t=1,r,n,a,s,o=Uo,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(s(f)-r)*a,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),n=s(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(p){var h,m;return arguments.length?([h,m]=p,o=f(h,m),u):[o(0),o(1)]}}return u.range=d(ag),u.rangeRound=d(UC),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(e),n=f(t),a=r===n?0:1/(n-r),u}}function yh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function hH(){var e=xh(a_()(Uo));return e.copy=function(){return yh(e,hH())},Zd.apply(e,arguments)}function pH(){var e=HC(a_()).domain([1,10]);return e.copy=function(){return yh(e,pH()).base(e.base())},Zd.apply(e,arguments)}function mH(){var e=VC(a_());return e.copy=function(){return yh(e,mH()).constant(e.constant())},Zd.apply(e,arguments)}function nE(){var e=GC(a_());return e.copy=function(){return yh(e,nE()).exponent(e.exponent())},Zd.apply(e,arguments)}function P_e(){return nE.apply(null,arguments).exponent(.5)}function gH(){var e=[],t=Uo;function r(n){if(n!=null&&!isNaN(n=+n))return t((dy(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Kf),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,s)=>gwe(e,s/n))},r.copy=function(){return gH(t).domain(e)},Zd.apply(r,arguments)}function i_(){var e=0,t=.5,r=1,n=1,a,s,o,l,c,u=Uo,d,f=!1,p;function h(g){return isNaN(g=+g)?p:(g=.5+((g=+d(g))-s)*(n*g<n*s?l:c),u(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,r]=g,a=d(e=+e),s=d(t=+t),o=d(r=+r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h):[e,t,r]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(u=g,h):u};function m(g){return function(b){var y,v,w;return arguments.length?([y,v,w]=b,u=Wwe(g,[y,v,w]),h):[u(0),u(.5),u(1)]}}return h.range=m(ag),h.rangeRound=m(UC),h.unknown=function(g){return arguments.length?(p=g,h):p},function(g){return d=g,a=g(e),s=g(t),o=g(r),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),n=s<a?-1:1,h}}function xH(){var e=xh(i_()(Uo));return e.copy=function(){return yh(e,xH())},Zd.apply(e,arguments)}function yH(){var e=HC(i_()).domain([.1,1,10]);return e.copy=function(){return yh(e,yH()).base(e.base())},Zd.apply(e,arguments)}function bH(){var e=VC(i_());return e.copy=function(){return yh(e,bH()).constant(e.constant())},Zd.apply(e,arguments)}function aE(){var e=GC(i_());return e.copy=function(){return yh(e,aE()).exponent(e.exponent())},Zd.apply(e,arguments)}function O_e(){return aE.apply(null,arguments).exponent(.5)}const sx=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:IC,scaleDiverging:xH,scaleDivergingLog:yH,scaleDivergingPow:aE,scaleDivergingSqrt:O_e,scaleDivergingSymlog:bH,scaleIdentity:Qq,scaleImplicit:A4,scaleLinear:Yq,scaleLog:Zq,scaleOrdinal:BC,scalePoint:bwe,scalePow:KC,scaleQuantile:rH,scaleQuantize:nH,scaleRadial:tH,scaleSequential:hH,scaleSequentialLog:pH,scaleSequentialPow:nE,scaleSequentialQuantile:gH,scaleSequentialSqrt:P_e,scaleSequentialSymlog:mH,scaleSqrt:fSe,scaleSymlog:eH,scaleThreshold:aH,scaleTime:E_e,scaleUtc:T_e,tickFormat:Xq},Symbol.toStringTag,{value:"Module"}));var ef=e=>e.chartData,s_=Kt([ef],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),o_=(e,t,r,n)=>n?s_(e):ef(e),L_e=(e,t,r)=>r?s_(e):ef(e);function Dd(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Vn(t)&&Vn(r))return!0}return!1}function M7(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function vH(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,s;if(Vn(r))a=r;else if(typeof r=="function")return;if(Vn(n))s=n;else if(typeof n=="function")return;var o=[a,s];if(Dd(o))return o}}function M_e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Dd(n))return M7(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,s]=e,o,l;if(a==="auto")t!=null&&(o=Math.min(...t));else if(an(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&JL.test(a)){var c=JL.exec(a);if(c==null||c[1]==null||t==null)o=void 0;else{var u=+c[1];o=t[0]-u}}else o=t==null?void 0:t[0];if(s==="auto")t!=null&&(l=Math.max(...t));else if(an(s))l=s;else if(typeof s=="function")try{t!=null&&(l=s(t==null?void 0:t[1]))}catch{}else if(typeof s=="string"&&ZL.test(s)){var d=ZL.exec(s);if(d==null||d[1]==null||t==null)l=void 0;else{var f=+d[1];l=t[1]+f}}else l=t==null?void 0:t[1];var p=[o,l];if(Dd(p))return t==null?p:M7(p,t,r)}}}var ig=1e9,F_e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},sE,ci=!0,kc="[DecimalError] ",i0=kc+"Invalid argument: ",iE=kc+"Exponent out of range: ",sg=Math.floor,Fh=Math.pow,R_e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ml,Ms=1e7,Za=7,wH=9007199254740991,_w=sg(wH/Za),sn={};sn.absoluteValue=sn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};sn.comparedTo=sn.cmp=function(e){var t,r,n,a,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===a?0:n>a^s.s<0?1:-1};sn.decimalPlaces=sn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Za;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};sn.dividedBy=sn.div=function(e){return Ad(this,new this.constructor(e))};sn.dividedToIntegerBy=sn.idiv=function(e){var t=this,r=t.constructor;return Va(Ad(t,new r(e),0,1),r.precision)};sn.equals=sn.eq=function(e){return!this.cmp(e)};sn.exponent=function(){return hs(this)};sn.greaterThan=sn.gt=function(e){return this.cmp(e)>0};sn.greaterThanOrEqualTo=sn.gte=function(e){return this.cmp(e)>=0};sn.isInteger=sn.isint=function(){return this.e>this.d.length-2};sn.isNegative=sn.isneg=function(){return this.s<0};sn.isPositive=sn.ispos=function(){return this.s>0};sn.isZero=function(){return this.s===0};sn.lessThan=sn.lt=function(e){return this.cmp(e)<0};sn.lessThanOrEqualTo=sn.lte=function(e){return this.cmp(e)<1};sn.logarithm=sn.log=function(e){var t,r=this,n=r.constructor,a=n.precision,s=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ml))throw Error(kc+"NaN");if(r.s<1)throw Error(kc+(r.s?"NaN":"-Infinity"));return r.eq(Ml)?new n(0):(ci=!1,t=Ad(N1(r,s),N1(e,s),s),ci=!0,Va(t,a))};sn.minus=sn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?kH(t,e):SH(t,(e.s=-e.s,e))};sn.modulo=sn.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(kc+"NaN");return r.s?(ci=!1,t=Ad(r,e,0,1).times(e),ci=!0,r.minus(t)):Va(new n(r),a)};sn.naturalExponential=sn.exp=function(){return _H(this)};sn.naturalLogarithm=sn.ln=function(){return N1(this)};sn.negated=sn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};sn.plus=sn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?SH(t,e):kH(t,(e.s=-e.s,e))};sn.precision=sn.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(i0+e);if(t=hs(a)+1,n=a.d.length-1,r=n*Za+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};sn.squareRoot=sn.sqrt=function(){var e,t,r,n,a,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(kc+"NaN")}for(e=hs(l),ci=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=Bu(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=sg((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=o=r+3;;)if(s=n,n=s.plus(Ad(l,s,o+2)).times(.5),Bu(s.d).slice(0,o)===(t=Bu(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(Va(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(t!="9999")break;o+=4}return ci=!0,Va(n,r)};sn.times=sn.mul=function(e){var t,r,n,a,s,o,l,c,u,d=this,f=d.constructor,p=d.d,h=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=p.length,u=h.length,c<u&&(s=p,p=h,h=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)l=s[a]+h[n]*p[a-n-1]+t,s[a--]=l%Ms|0,t=l/Ms|0;s[a]=(s[a]+t)%Ms|0}for(;!s[--o];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,ci?Va(e,f.precision):e};sn.toDecimalPlaces=sn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Hu(e,0,ig),t===void 0?t=n.rounding:Hu(t,0,8),Va(r,e+hs(r)+1,t))};sn.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=E0(n,!0):(Hu(e,0,ig),t===void 0?t=a.rounding:Hu(t,0,8),n=Va(new a(n),e+1,t),r=E0(n,!0,e+1)),r};sn.toFixed=function(e,t){var r,n,a=this,s=a.constructor;return e===void 0?E0(a):(Hu(e,0,ig),t===void 0?t=s.rounding:Hu(t,0,8),n=Va(new s(a),e+hs(a)+1,t),r=E0(n.abs(),!1,e+hs(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};sn.toInteger=sn.toint=function(){var e=this,t=e.constructor;return Va(new t(e),hs(e)+1,t.rounding)};sn.toNumber=function(){return+this};sn.toPower=sn.pow=function(e){var t,r,n,a,s,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Ml);if(l=new c(l),!l.s){if(e.s<1)throw Error(kc+"Infinity");return l}if(l.eq(Ml))return l;if(n=c.precision,e.eq(Ml))return Va(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,s=l.s,o){if((r=d<0?-d:d)<=wH){for(a=new c(Ml),t=Math.ceil(n/Za+4),ci=!1;r%2&&(a=a.times(l),R7(a.d,t)),r=sg(r/2),r!==0;)l=l.times(l),R7(l.d,t);return ci=!0,e.s<0?new c(Ml).div(a):Va(a,n)}}else if(s<0)throw Error(kc+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,ci=!1,a=e.times(N1(l,n+u)),ci=!0,a=_H(a),a.s=s,a};sn.toPrecision=function(e,t){var r,n,a=this,s=a.constructor;return e===void 0?(r=hs(a),n=E0(a,r<=s.toExpNeg||r>=s.toExpPos)):(Hu(e,1,ig),t===void 0?t=s.rounding:Hu(t,0,8),a=Va(new s(a),e,t),r=hs(a),n=E0(a,e<=r||r<=s.toExpNeg,e)),n};sn.toSignificantDigits=sn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Hu(e,1,ig),t===void 0?t=n.rounding:Hu(t,0,8)),Va(new n(r),e,t)};sn.toString=sn.valueOf=sn.val=sn.toJSON=sn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=hs(e),r=e.constructor;return E0(e,t<=r.toExpNeg||t>=r.toExpPos)};function SH(e,t){var r,n,a,s,o,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),ci?Va(t,f):t;if(c=e.d,u=t.d,o=e.e,a=t.e,c=c.slice(),s=o-a,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,a=o,l=c.length),o=Math.ceil(f/Za),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/Ms|0,c[s]%=Ms;for(r&&(c.unshift(r),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,ci?Va(t,f):t}function Hu(e,t,r){if(e!==~~e||e<t||e>r)throw Error(i0+e)}function Bu(e){var t,r,n,a=e.length-1,s="",o=e[0];if(a>0){for(s+=o,t=1;t<a;t++)n=e[t]+"",r=Za-n.length,r&&(s+=kf(r)),s+=n;o=e[t],n=o+"",r=Za-n.length,r&&(s+=kf(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Ad=function(){function e(n,a){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*a+o,n[l]=s%Ms|0,o=s/Ms|0;return o&&n.unshift(o),n}function t(n,a,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=a[l]){c=n[l]>a[l]?1:-1;break}return c}function r(n,a,s){for(var o=0;s--;)n[s]-=o,o=n[s]<a[s]?1:0,n[s]=o*Ms+n[s]-a[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,s,o){var l,c,u,d,f,p,h,m,g,b,y,v,w,_,C,j,A,M,P=n.constructor,R=n.s==a.s?1:-1,N=n.d,T=a.d;if(!n.s)return new P(n);if(!a.s)throw Error(kc+"Division by zero");for(c=n.e-a.e,A=T.length,C=N.length,h=new P(R),m=h.d=[],u=0;T[u]==(N[u]||0);)++u;if(T[u]>(N[u]||0)&&--c,s==null?v=s=P.precision:o?v=s+(hs(n)-hs(a))+1:v=s,v<0)return new P(0);if(v=v/Za+2|0,u=0,A==1)for(d=0,T=T[0],v++;(u<C||d)&&v--;u++)w=d*Ms+(N[u]||0),m[u]=w/T|0,d=w%T|0;else{for(d=Ms/(T[0]+1)|0,d>1&&(T=e(T,d),N=e(N,d),A=T.length,C=N.length),_=A,g=N.slice(0,A),b=g.length;b<A;)g[b++]=0;M=T.slice(),M.unshift(0),j=T[0],T[1]>=Ms/2&&++j;do d=0,l=t(T,g,A,b),l<0?(y=g[0],A!=b&&(y=y*Ms+(g[1]||0)),d=y/j|0,d>1?(d>=Ms&&(d=Ms-1),f=e(T,d),p=f.length,b=g.length,l=t(f,g,p,b),l==1&&(d--,r(f,A<p?M:T,p))):(d==0&&(l=d=1),f=T.slice()),p=f.length,p<b&&f.unshift(0),r(g,f,b),l==-1&&(b=g.length,l=t(T,g,A,b),l<1&&(d++,r(g,A<b?M:T,b))),b=g.length):l===0&&(d++,g=[0]),m[u++]=d,l&&g[0]?g[b++]=N[_]||0:(g=[N[_]],b=1);while((_++<C||g[0]!==void 0)&&v--)}return m[0]||m.shift(),h.e=c,Va(h,o?s+hs(h)+1:s)}}();function _H(e,t){var r,n,a,s,o,l,c=0,u=0,d=e.constructor,f=d.precision;if(hs(e)>16)throw Error(iE+hs(e));if(!e.s)return new d(Ml);for(ci=!1,l=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Fh(2,u))/Math.LN10*2+5|0,l+=n,r=a=s=new d(Ml),d.precision=l;;){if(a=Va(a.times(e),l),r=r.times(++c),o=s.plus(Ad(a,r,l)),Bu(o.d).slice(0,l)===Bu(s.d).slice(0,l)){for(;u--;)s=Va(s.times(s),l);return d.precision=f,t==null?(ci=!0,Va(s,f)):s}s=o}}function hs(e){for(var t=e.e*Za,r=e.d[0];r>=10;r/=10)t++;return t}function qk(e,t,r){if(t>e.LN10.sd())throw ci=!0,r&&(e.precision=r),Error(kc+"LN10 precision limit exceeded");return Va(new e(e.LN10),t)}function kf(e){for(var t="";e--;)t+="0";return t}function N1(e,t){var r,n,a,s,o,l,c,u,d,f=1,p=10,h=e,m=h.d,g=h.constructor,b=g.precision;if(h.s<1)throw Error(kc+(h.s?"NaN":"-Infinity"));if(h.eq(Ml))return new g(0);if(t==null?(ci=!1,u=b):u=t,h.eq(10))return t==null&&(ci=!0),qk(g,u);if(u+=p,g.precision=u,r=Bu(m),n=r.charAt(0),s=hs(h),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(e),r=Bu(h.d),n=r.charAt(0),f++;s=hs(h),n>1?(h=new g("0."+r),s++):h=new g(n+"."+r.slice(1))}else return c=qk(g,u+2,b).times(s+""),h=N1(new g(n+"."+r.slice(1)),u-p).plus(c),g.precision=b,t==null?(ci=!0,Va(h,b)):h;for(l=o=h=Ad(h.minus(Ml),h.plus(Ml),u),d=Va(h.times(h),u),a=3;;){if(o=Va(o.times(d),u),c=l.plus(Ad(o,new g(a),u)),Bu(c.d).slice(0,u)===Bu(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(qk(g,u+2,b).times(s+""))),l=Ad(l,new g(f),u),g.precision=b,t==null?(ci=!0,Va(l,b)):l;l=c,a+=2}}function F7(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=sg(r/Za),e.d=[],n=(r+1)%Za,r<0&&(n+=Za),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Za;n<a;)e.d.push(+t.slice(n,n+=Za));t=t.slice(n),n=Za-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),ci&&(e.e>_w||e.e<-_w))throw Error(iE+r)}else e.s=0,e.e=0,e.d=[0];return e}function Va(e,t,r){var n,a,s,o,l,c,u,d,f=e.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=t-o,n<0)n+=Za,a=t,u=f[d=0];else{if(d=Math.ceil((n+1)/Za),s=f.length,d>=s)return e;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=Za,a=n-Za+o}if(r!==void 0&&(s=Fh(10,o-a-1),l=u/s%10|0,c=t<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?a>0?u/Fh(10,o-a):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(s=hs(e),f.length=1,t=t-s-1,f[0]=Fh(10,(Za-t%Za)%Za),e.e=sg(-t/Za)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=Fh(10,Za-n),f[d]=a>0?(u/Fh(10,o-a)%Fh(10,a)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==Ms&&(f[0]=1,++e.e);break}else{if(f[d]+=s,f[d]!=Ms)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(ci&&(e.e>_w||e.e<-_w))throw Error(iE+hs(e));return e}function kH(e,t){var r,n,a,s,o,l,c,u,d,f,p=e.constructor,h=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),ci?Va(t,h):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),a=Math.max(Math.ceil(h/Za),l)+2,o>a&&(o=a,r.length=1),r.reverse(),a=o;a--;)r.push(0);r.reverse()}else{for(a=c.length,l=f.length,d=a<l,d&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){d=c[a]<f[a];break}o=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=Ms-1;--c[s],c[a]+=Ms}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,ci?Va(t,h):t):new p(0)}function E0(e,t,r){var n,a=hs(e),s=Bu(e.d),o=s.length;return t?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+kf(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+kf(-a-1)+s,r&&(n=r-o)>0&&(s+=kf(n))):a>=o?(s+=kf(a+1-o),r&&(n=r-a-1)>0&&(s=s+"."+kf(n))):((n=a+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(a+1===o&&(s+="."),s+=kf(n))),e.s<0?"-"+s:s}function R7(e,t){if(e.length>t)return e.length=t,!0}function jH(e){var t,r,n;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(i0+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return F7(o,s.toString())}else if(typeof s!="string")throw Error(i0+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,R_e.test(s))F7(o,s);else throw Error(i0+s)}if(a.prototype=sn,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=jH,a.config=a.set=B_e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function B_e(e){if(!e||typeof e!="object")throw Error(kc+"Object expected");var t,r,n,a=["precision",1,ig,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(sg(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(i0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(i0+r+": "+n);return this}var sE=jH(F_e);Ml=new sE(1);const Pa=sE;function AH(e){var t;return e===0?t=1:t=Math.floor(new Pa(e).abs().log(10).toNumber())+1,t}function NH(e,t,r){for(var n=new Pa(e),a=0,s=[];n.lt(t)&&a<1e5;)s.push(n.toNumber()),n=n.add(r),a++;return s}var CH=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},EH=(e,t,r)=>{if(e.lte(0))return new Pa(0);var n=AH(e.toNumber()),a=new Pa(10).pow(n),s=e.div(a),o=n!==1?.05:.1,l=new Pa(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(a);return t?new Pa(c.toNumber()):new Pa(Math.ceil(c.toNumber()))},I_e=(e,t,r)=>{var n=new Pa(1),a=new Pa(e);if(!a.isint()&&r){var s=Math.abs(e);s<1?(n=new Pa(10).pow(AH(e)-1),a=new Pa(Math.floor(a.div(n).toNumber())).mul(n)):s>1&&(a=new Pa(Math.floor(e)))}else e===0?a=new Pa(Math.floor((t-1)/2)):r||(a=new Pa(Math.floor(e)));for(var o=Math.floor((t-1)/2),l=[],c=0;c<t;c++)l.push(a.add(new Pa(c-o).mul(n)).toNumber());return l},TH=function(t,r,n,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Pa(0),tickMin:new Pa(0),tickMax:new Pa(0)};var o=EH(new Pa(r).sub(t).div(n-1),a,s),l;t<=0&&r>=0?l=new Pa(0):(l=new Pa(t).add(r).div(2),l=l.sub(new Pa(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),u=Math.ceil(new Pa(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?TH(t,r,n,a,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new Pa(c).mul(o)),tickMax:l.add(new Pa(u).mul(o))})},D_e=function(t){var[r,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(a,2),[l,c]=CH([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...Array(a-1).fill(1/0)]:[...Array(a-1).fill(-1/0),c];return r>n?u.reverse():u}if(l===c)return I_e(l,a,s);var{step:d,tickMin:f,tickMax:p}=TH(l,c,o,s,0),h=NH(f,p.add(new Pa(.1).mul(d)),d);return r>n?h.reverse():h},$_e=function(t,r){var[n,a]=t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=CH([n,a]);if(o===-1/0||l===1/0)return[n,a];if(o===l)return[o];var c=Math.max(r,2),u=EH(new Pa(l).sub(o).div(c-1),s,0),d=[...NH(new Pa(o),new Pa(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>a?d.reverse():d},PH=e=>e.rootProps.maxBarSize,U_e=e=>e.rootProps.barGap,OH=e=>e.rootProps.barCategoryGap,z_e=e=>e.rootProps.barSize,my=e=>e.rootProps.stackOffset,LH=e=>e.rootProps.reverseStackOrder,oE=e=>e.options.chartName,lE=e=>e.rootProps.syncId,MH=e=>e.rootProps.syncMethod,cE=e=>e.options.eventEmitter,bi={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Ch={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Su={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},l_=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function c_(e,t,r){if(r!=="auto")return r;if(e!=null)return Yd(e,t)?"category":"number"}function B7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function kw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?B7(Object(r),!0).forEach(function(n){W_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W_e(e,t,r){return(t=q_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q_e(e){var t=H_e(e,"string");return typeof t=="symbol"?t:t+""}function H_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var I7={allowDataOverflow:Ch.allowDataOverflow,allowDecimals:Ch.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ch.angleAxisId,includeHidden:!1,name:void 0,reversed:Ch.reversed,scale:Ch.scale,tick:Ch.tick,tickCount:void 0,ticks:void 0,type:Ch.type,unit:void 0},D7={allowDataOverflow:Su.allowDataOverflow,allowDecimals:Su.allowDecimals,allowDuplicatedCategory:Su.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Su.radiusAxisId,includeHidden:Su.includeHidden,name:void 0,reversed:Su.reversed,scale:Su.scale,tick:Su.tick,tickCount:Su.tickCount,ticks:void 0,type:Su.type,unit:void 0},V_e=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},uE=Kt([V_e,gq],(e,t)=>{var r;if(e!=null)return e;var n=(r=c_(t,"angleAxis",I7.type))!==null&&r!==void 0?r:"category";return kw(kw({},I7),{},{type:n})}),G_e=(e,t)=>e.polarAxis.radiusAxis[t],dE=Kt([G_e,gq],(e,t)=>{var r;if(e!=null)return e;var n=(r=c_(t,"radiusAxis",D7.type))!==null&&r!==void 0?r:"category";return kw(kw({},D7),{},{type:n})}),u_=e=>e.polarOptions,fE=Kt([Qd,Jd,ks],Lq),FH=Kt([u_,fE],(e,t)=>{if(e!=null)return No(e.innerRadius,t,0)}),RH=Kt([u_,fE],(e,t)=>{if(e!=null)return No(e.outerRadius,t,t*.8)}),K_e=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},BH=Kt([u_],K_e);Kt([uE,BH],l_);var IH=Kt([fE,FH,RH],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Kt([dE,IH],l_);var DH=Kt([pa,u_,FH,RH,Qd,Jd],(e,t,r,n,a,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=t;return{cx:No(o,a,a/2),cy:No(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),_i=(e,t)=>t,gy=(e,t,r)=>r;function hE(e){return e==null?void 0:e.id}function $H(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:s}=r,o=new Map;return e.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=hE(l);u.forEach((f,p)=>{var h=s==null||a?p:String(fa(f,s,null)),m=fa(f,l.dataKey,0),g;o.has(h)?g=o.get(h):g={},Object.assign(g,{[d]:m}),o.set(h,g)})}}),Array.from(o.values())}function d_(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var f_=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function h_(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function X_e(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var zs=e=>{var t=pa(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},og=e=>e.tooltip.settings.axisId;function Y_e(e){if(e in sx)return sx[e]();var t="scale".concat(ay(e));if(t in sx)return sx[t]()}function $7(e){var t=e.ticks,r=e.bandwidth,n=e.range(),a=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:function(s){function o(){return s.apply(this,arguments)}return o.toString=function(){return s.toString()},o}(()=>a),rangeMin:()=>a[0],rangeMax:()=>a[1],isInRange(s){var o=a[0],l=a[1];return o<=l?s>=o&&s<=l:s>=l&&s<=o},bandwidth:r?()=>r.call(e):void 0,ticks:t?s=>t.call(e,s):void 0,map:(s,o)=>{var l=e(s);if(l!=null){if(e.bandwidth&&o!==null&&o!==void 0&&o.position){var c=e.bandwidth();switch(o.position){case"middle":l+=c/2;break;case"end":l+=c;break}}return l}}}}function U7(e,t,r){if(typeof e=="function")return $7(e.copy().domain(t).range(r));if(e!=null){var n=Y_e(e);if(n!=null)return n.domain(t).range(r),$7(n)}}var UH=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!Dd(t)){for(var r,n,a=0;a<t.length;a++){var s=t[a];Vn(s)&&((r===void 0||s<r)&&(r=s),(n===void 0||s>n)&&(n=s))}return r!==void 0&&n!==void 0?[r,n]:void 0}return t}default:return t}};function z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function jw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?z7(Object(r),!0).forEach(function(n){Q_e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q_e(e,t,r){return(t=J_e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J_e(e){var t=Z_e(e,"string");return typeof t=="symbol"?t:t+""}function Z_e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T4=[0,"auto"],Ps={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},zH=(e,t)=>e.cartesianAxis.xAxis[t],Qu=(e,t)=>{var r=zH(e,t);return r??Ps},Os={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:T4,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:oy},WH=(e,t)=>e.cartesianAxis.yAxis[t],Ju=(e,t)=>{var r=WH(e,t);return r??Os},wd={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},pE=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??wd},Di=(e,t,r)=>{switch(t){case"xAxis":return Qu(e,r);case"yAxis":return Ju(e,r);case"zAxis":return pE(e,r);case"angleAxis":return uE(e,r);case"radiusAxis":return dE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},e5e=(e,t,r)=>{switch(t){case"xAxis":return Qu(e,r);case"yAxis":return Ju(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},lg=(e,t,r)=>{switch(t){case"xAxis":return Qu(e,r);case"yAxis":return Ju(e,r);case"angleAxis":return uE(e,r);case"radiusAxis":return dE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},qH=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function mE(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var xy=e=>e.graphicalItems.cartesianItems,t5e=Kt([_i,gy],mE),gE=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),yy=Kt([xy,Di,t5e],gE,{memoizeOptions:{resultEqualityCheck:h_}}),HH=Kt([yy],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(d_)),VH=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),r5e=Kt([yy],VH),xE=e=>e.map(t=>t.data).filter(Boolean).flat(1),n5e=Kt([yy],xE,{memoizeOptions:{resultEqualityCheck:h_}}),yE=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},bE=Kt([n5e,o_],yE),vE=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:fa(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:fa(a,n)}))):e.map(n=>({value:n})),p_=Kt([bE,Di,yy],vE);function GH(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Wv(e){if(Sc(e)||e instanceof Date){var t=Number(e);if(Vn(t))return t}}function W7(e){if(Array.isArray(e)){var t=[Wv(e[0]),Wv(e[1])];return Dd(t)?t:void 0}var r=Wv(e);if(r!=null)return[r,r]}function $d(e){return e.map(Wv).filter(ol)}function a5e(e,t,r){return!r||typeof t!="number"||Wu(t)?[]:r.length?$d(r.flatMap(n=>{var a=fa(e,n.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!Vn(s)||!Vn(o)))return[t-s,t+o]})):[]}var Ns=e=>{var t=zs(e),r=og(e);return lg(e,t,r)},by=Kt([Ns],e=>e==null?void 0:e.dataKey),i5e=Kt([HH,o_,Ns],$H),KH=(e,t,r,n)=>{var a={},s=t.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},a);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(hE);return[l,{stackedData:Mbe(e,d,r),graphicalItems:u}]}))},P4=Kt([i5e,HH,my,LH],KH),XH=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:s}=t;if(n==null&&r!=="zAxis"){var o=Dbe(e,a,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},s5e=Kt([Di],e=>e.allowDataOverflow),wE=e=>{var t;if(e==null||!("domain"in e))return T4;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=$d(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:T4},SE=Kt([Di],wE),_E=Kt([SE,s5e],vH),o5e=Kt([P4,ef,_i,_E],XH,{memoizeOptions:{resultEqualityCheck:f_}}),m_=e=>e.errorBars,l5e=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>GH(r,n)),Aw=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},kE=(e,t,r,n,a)=>{var s,o;if(r.length>0&&e.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(y=>GH(a,y)),p=fa(l,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),h=a5e(l,p,f);if(h.length>=2){var m=Math.min(...h),g=Math.max(...h);(s==null||m<s)&&(s=m),(o==null||g>o)&&(o=g)}var b=W7(p);b!=null&&(s=s==null?b[0]:Math.min(s,b[0]),o=o==null?b[1]:Math.max(o,b[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(l=>{var c=W7(fa(l,t.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),Vn(s)&&Vn(o))return[s,o]},c5e=Kt([bE,Di,r5e,m_,_i],kE,{memoizeOptions:{resultEqualityCheck:f_}});function u5e(e){var{value:t}=e;if(Sc(t)||t instanceof Date)return t}var d5e=(e,t,r)=>{var n=e.map(u5e).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&Gz(n))?$q(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},YH=e=>e.referenceElements.dots,cg=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),f5e=Kt([YH,_i,gy],cg),QH=e=>e.referenceElements.areas,h5e=Kt([QH,_i,gy],cg),JH=e=>e.referenceElements.lines,p5e=Kt([JH,_i,gy],cg),ZH=(e,t)=>{if(e!=null){var r=$d(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},m5e=Kt(f5e,_i,ZH),eV=(e,t)=>{if(e!=null){var r=$d(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},g5e=Kt([h5e,_i],eV);function x5e(e){var t;if(e.x!=null)return $d([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:$d(r)}function y5e(e){var t;if(e.y!=null)return $d([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:$d(r)}var tV=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?x5e(n):y5e(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},b5e=Kt([p5e,_i],tV),v5e=Kt(m5e,b5e,g5e,(e,t,r)=>Aw(e,r,t)),jE=(e,t,r,n,a,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?Aw(n,s,a):Aw(s,a);return M_e(t,u,e.allowDataOverflow)},w5e=Kt([Di,SE,_E,o5e,c5e,v5e,pa,_i],jE,{memoizeOptions:{resultEqualityCheck:f_}}),S5e=[0,1],AE=(e,t,r,n,a,s,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,u=Yd(t,s);if(u&&l==null){var d;return $q(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?d5e(n,e,u):a==="expand"?S5e:o}},NE=Kt([Di,pa,bE,p_,my,_i,w5e],AE);function _5e(e){return e in sx}var rV=(e,t,r)=>{if(e!=null){var{scale:n,type:a}=e;if(n==="auto")return a==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!t)?"point":a==="category"?"band":"linear";if(typeof n=="string"){var s="scale".concat(ay(n));return _5e(s)?s:"point"}}},bh=Kt([Di,qH,oE],rV);function CE(e,t,r,n){if(!(r==null||n==null))return typeof e.scale=="function"?U7(e.scale,r,n):U7(t,r,n)}var EE=(e,t,r)=>{var n=wE(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Dd(e))return D_e(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Dd(e))return $_e(e,t.tickCount,t.allowDecimals)}},TE=Kt([NE,lg,bh],EE),PE=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&Dd(t)&&Array.isArray(r)&&r.length>0){var a,s,o=t[0],l=(a=r[0])!==null&&a!==void 0?a:0,c=t[1],u=(s=r[r.length-1])!==null&&s!==void 0?s:0;return[Math.min(o,l),Math.max(c,u)]}return t},k5e=Kt([Di,NE,TE,_i],PE),j5e=Kt(p_,Di,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from($d(e.map(f=>f.value))).sort((f,p)=>f-p),a=n[0],s=n[n.length-1];if(a==null||s==null)return 1/0;var o=s-a;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),nV=Kt(j5e,pa,OH,ks,(e,t,r,n,a)=>a,(e,t,r,n,a)=>{if(!Vn(e))return 0;var s=t==="vertical"?n.height:n.width;if(a==="gap")return e*s/2;if(a==="no-gap"){var o=No(r,e*s),l=e*s/2;return l-o-(l-o)/s*o}return 0}),A5e=(e,t,r)=>{var n=Qu(e,t);return n==null||typeof n.padding!="string"?0:nV(e,"xAxis",t,r,n.padding)},N5e=(e,t,r)=>{var n=Ju(e,t);return n==null||typeof n.padding!="string"?0:nV(e,"yAxis",t,r,n.padding)},C5e=Kt(Qu,A5e,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),E5e=Kt(Ju,N5e,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),T5e=Kt([ks,C5e,KS,GS,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:s}=n;return a?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),P5e=Kt([ks,pa,E5e,KS,GS,(e,t,r)=>r],(e,t,r,n,a,s)=>{var{padding:o}=a;return s?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),vy=(e,t,r,n)=>{var a;switch(t){case"xAxis":return T5e(e,r,n);case"yAxis":return P5e(e,r,n);case"zAxis":return(a=pE(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return BH(e);case"radiusAxis":return IH(e,r);default:return}},aV=Kt([Di,vy],l_),O5e=Kt([bh,k5e],UH),Im=Kt([Di,bh,O5e,aV],CE);Kt([yy,m_,_i],l5e);function iV(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var g_=(e,t)=>t,x_=(e,t,r)=>r,L5e=Kt(HS,g_,x_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(iV)),M5e=Kt(VS,g_,x_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(iV)),sV=(e,t)=>({width:e.width,height:t.height}),F5e=(e,t)=>{var r=typeof t.width=="number"?t.width:oy;return{width:r,height:e.height}},oV=Kt(ks,Qu,sV),R5e=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},B5e=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},I5e=Kt(Jd,ks,L5e,g_,x_,(e,t,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=sV(t,l);o==null&&(o=R5e(t,n,e));var u=n==="top"&&!a||n==="bottom"&&a;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),D5e=Kt(Qd,ks,M5e,g_,x_,(e,t,r,n,a)=>{var s={},o;return r.forEach(l=>{var c=F5e(t,l);o==null&&(o=B5e(t,n,e));var u=n==="left"&&!a||n==="right"&&a;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),$5e=(e,t)=>{var r=Qu(e,t);if(r!=null)return I5e(e,r.orientation,r.mirror)},U5e=Kt([ks,Qu,$5e,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),z5e=(e,t)=>{var r=Ju(e,t);if(r!=null)return D5e(e,r.orientation,r.mirror)},W5e=Kt([ks,Ju,z5e,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),lV=Kt(ks,Ju,(e,t)=>{var r=typeof t.width=="number"?t.width:oy;return{width:r,height:e.height}}),q7=(e,t,r)=>{switch(t){case"xAxis":return oV(e,r).width;case"yAxis":return lV(e,r).height;default:return}},cV=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=r,l=Yd(e,n),c=t.map(u=>u.value);if(o&&l&&s==="category"&&a&&Gz(c))return c}},OE=Kt([pa,p_,Di,_i],cV),uV=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:s}=r,o=Yd(e,n);if(o&&(a==="number"||s!=="auto"))return t.map(l=>l.value)}},LE=Kt([pa,p_,lg,_i],uV),H7=Kt([pa,e5e,bh,Im,OE,LE,vy,TE,_i],(e,t,r,n,a,s,o,l,c)=>{if(t!=null){var u=Yd(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}}),q5e=(e,t,r,n,a,s,o,l,c)=>{if(!(t==null||n==null)){var u=Yd(e,c),{type:d,ticks:f,tickCount:p}=t,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/h:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Ds(s[0]-s[1])*2*m:m;var g=f||a;return g?g.map((b,y)=>{var v=o?o.indexOf(b):b,w=n.map(v);return Vn(w)?{index:y,coordinate:w+m,value:b,offset:m}:null}).filter(ol):u&&l?l.map((b,y)=>{var v=n.map(b);return Vn(v)?{coordinate:v+m,value:b,index:y,offset:m}:null}).filter(ol):n.ticks?n.ticks(p).map((b,y)=>{var v=n.map(b);return Vn(v)?{coordinate:v+m,value:b,index:y,offset:m}:null}).filter(ol):n.domain().map((b,y)=>{var v=n.map(b);return Vn(v)?{coordinate:v+m,value:o?o[b]:b,index:y,offset:m}:null}).filter(ol)}},dV=Kt([pa,lg,bh,Im,TE,vy,OE,LE,_i],q5e),H5e=(e,t,r,n,a,s,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=Yd(e,o),{tickCount:c}=t,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Ds(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>{var p=r.map(d);return Vn(p)?{coordinate:p+u,value:d,index:f,offset:u}:null}).filter(ol):r.ticks?r.ticks(c).map((d,f)=>{var p=r.map(d);return Vn(p)?{coordinate:p+u,value:d,index:f,offset:u}:null}).filter(ol):r.domain().map((d,f)=>{var p=r.map(d);return Vn(p)?{coordinate:p+u,value:a?a[d]:d,index:f,offset:u}:null}).filter(ol)}},Vu=Kt([pa,lg,Im,vy,OE,LE,_i],H5e),Gu=Kt(Di,Im,(e,t)=>{if(!(e==null||t==null))return jw(jw({},e),{},{scale:t})}),V5e=Kt([Di,bh,NE,aV],CE),G5e=Kt((e,t,r)=>pE(e,r),V5e,(e,t)=>{if(!(e==null||t==null))return jw(jw({},e),{},{scale:t})}),K5e=Kt([pa,HS,VS],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),fV=e=>e.options.defaultTooltipEventType,hV=e=>e.options.validateTooltipEventTypes;function pV(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function ME(e,t){var r=fV(e),n=hV(e);return pV(t,r,n)}function X5e(e){return tn(t=>ME(t,e))}var mV=(e,t)=>{var r,n=Number(t);if(!(Wu(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},Y5e=e=>e.tooltip.settings,Cf={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},Q5e={itemInteraction:{click:Cf,hover:Cf},axisInteraction:{click:Cf,hover:Cf},keyboardInteraction:Cf,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},gV=yl({name:"tooltip",initialState:Q5e,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:si()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Zc(e).tooltipItemPayloads.indexOf(r);a>-1&&(e.tooltipItemPayloads[a]=n)},prepare:si()},removeTooltipEntrySettings:{reducer(e,t){var r=Zc(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:si()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:J5e,replaceTooltipEntrySettings:Z5e,removeTooltipEntrySettings:eke,setTooltipSettingsState:tke,setActiveMouseOverItemIndex:xV,mouseLeaveItem:rke,mouseLeaveChart:yV,setActiveClickItemIndex:nke,setMouseOverAxisIndex:bV,setMouseClickAxisIndex:ake,setSyncInteraction:O4,setKeyboardInteraction:L4}=gV.actions,ike=gV.reducer;function V7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function rv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?V7(Object(r),!0).forEach(function(n){ske(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ske(e,t,r){return(t=oke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oke(e){var t=lke(e,"string");return typeof t=="symbol"?t:t+""}function lke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cke(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function uke(e){return e.index!=null}var vV=(e,t,r,n)=>{if(t==null)return Cf;var a=cke(e,t,r);if(a==null)return Cf;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(uke(a)){if(s)return rv(rv({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return rv(rv({},Cf),{},{coordinate:a.coordinate})};function dke(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function fke(e,t){var r=dke(e),n=t[0],a=t[1];if(r===void 0)return!1;var s=Math.min(n,a),o=Math.max(n,a);return r>=s&&r<=o}function hke(e,t,r){if(r==null||t==null)return!0;var n=fa(e,t);return n==null||!Dd(r)?!0:fke(n,r)}var FE=(e,t,r,n)=>{var a=e==null?void 0:e.index;if(a==null)return null;var s=Number(a);if(!Vn(s))return a;var o=0,l=1/0;t.length>0&&(l=t.length-1);var c=Math.max(o,Math.min(s,l)),u=t[c];return u==null||hke(u,r,n)?String(c):null},wV=(e,t,r,n,a,s,o)=>{if(s!=null){var l=o[0],c=l==null?void 0:l.getPosition(s);if(c!=null)return c;var u=a==null?void 0:a[Number(s)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:u.coordinate}}}},SV=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=e.itemInteraction.hover.graphicalItemId:a=e.itemInteraction.click.graphicalItemId,a==null&&n!=null){var s=e.tooltipItemPayloads[0];return s!=null?[s]:[]}return e.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===a})},_V=e=>e.options.tooltipPayloadSearcher,ug=e=>e.tooltip;function G7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function K7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?G7(Object(r),!0).forEach(function(n){pke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pke(e,t,r){return(t=mke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mke(e){var t=gke(e,"string");return typeof t=="symbol"?t:t+""}function gke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xke(e,t){return e??t}var kV=(e,t,r,n,a,s,o)=>{if(!(t==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((p,h)=>{var m,{dataDefinedOnItem:g,settings:b}=h,y=xke(g,l),v=Array.isArray(y)?nq(y,u,d):y,w=(m=b==null?void 0:b.dataKey)!==null&&m!==void 0?m:n,_=b==null?void 0:b.nameKey,C;if(n&&Array.isArray(v)&&!Array.isArray(v[0])&&o==="axis"?C=Kz(v,n,a):C=s(v,t,c,_),Array.isArray(C))C.forEach(A=>{var M=K7(K7({},b),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});p.push(eM({tooltipEntrySettings:M,dataKey:A.dataKey,payload:A.payload,value:fa(A.payload,A.dataKey),name:A.name}))});else{var j;p.push(eM({tooltipEntrySettings:b,dataKey:w,payload:C,value:fa(C,w),name:(j=fa(C,_))!==null&&j!==void 0?j:b==null?void 0:b.name}))}return p},f)}},RE=Kt([Ns,qH,oE],rV),yke=Kt([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),bke=Kt([zs,og],mE),dg=Kt([yke,Ns,bke],gE,{memoizeOptions:{resultEqualityCheck:h_}}),vke=Kt([dg],e=>e.filter(d_)),wke=Kt([dg],xE,{memoizeOptions:{resultEqualityCheck:h_}}),fg=Kt([wke,ef],yE),Ske=Kt([vke,ef,Ns],$H),BE=Kt([fg,Ns,dg],vE),jV=Kt([Ns],wE),_ke=Kt([Ns],e=>e.allowDataOverflow),AV=Kt([jV,_ke],vH),kke=Kt([dg],e=>e.filter(d_)),jke=Kt([Ske,kke,my,LH],KH),Ake=Kt([jke,ef,zs,AV],XH),Nke=Kt([dg],VH),Cke=Kt([fg,Ns,Nke,m_,zs],kE,{memoizeOptions:{resultEqualityCheck:f_}}),Eke=Kt([YH,zs,og],cg),Tke=Kt([Eke,zs],ZH),Pke=Kt([QH,zs,og],cg),Oke=Kt([Pke,zs],eV),Lke=Kt([JH,zs,og],cg),Mke=Kt([Lke,zs],tV),Fke=Kt([Tke,Mke,Oke],Aw),Rke=Kt([Ns,jV,AV,Ake,Cke,Fke,pa,zs],jE),wy=Kt([Ns,pa,fg,BE,my,zs,Rke],AE),Bke=Kt([wy,Ns,RE],EE),Ike=Kt([Ns,wy,Bke,zs],PE),NV=e=>{var t=zs(e),r=og(e),n=!1;return vy(e,t,r,n)},CV=Kt([Ns,NV],l_),EV=Kt([Ns,RE,Ike,CV],CE),Dke=Kt([pa,BE,Ns,zs],cV),$ke=Kt([pa,BE,Ns,zs],uV),Uke=(e,t,r,n,a,s,o,l)=>{if(t){var{type:c}=t,u=Yd(e,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Ds(a[0]-a[1])*2*f:f,u&&o?o.map((p,h)=>{var m=n.map(p);return Vn(m)?{coordinate:m+f,value:p,index:h,offset:f}:null}).filter(ol):n.domain().map((p,h)=>{var m=n.map(p);return Vn(m)?{coordinate:m+f,value:s?s[p]:p,index:h,offset:f}:null}).filter(ol)}}},tf=Kt([pa,Ns,RE,EV,NV,Dke,$ke,zs],Uke),IE=Kt([fV,hV,Y5e],(e,t,r)=>pV(r.shared,e,t)),TV=e=>e.tooltip.settings.trigger,DE=e=>e.tooltip.settings.defaultIndex,Sy=Kt([ug,IE,TV,DE],vV),Ud=Kt([Sy,fg,by,wy],FE),PV=Kt([tf,Ud],mV),$E=Kt([Sy],e=>{if(e)return e.dataKey}),zke=Kt([Sy],e=>{if(e)return e.graphicalItemId}),OV=Kt([ug,IE,TV,DE],SV),Wke=Kt([Qd,Jd,pa,ks,tf,DE,OV],wV),qke=Kt([Sy,Wke],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Hke=Kt([Sy],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),Vke=Kt([OV,Ud,ef,by,PV,_V,IE],kV),Gke=Kt([Vke],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function X7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Y7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?X7(Object(r),!0).forEach(function(n){Kke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Kke(e,t,r){return(t=Xke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xke(e){var t=Yke(e,"string");return typeof t=="symbol"?t:t+""}function Yke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qke=()=>tn(Ns),Jke=()=>{var e=Qke(),t=tn(tf),r=tn(EV);return Om(!e||!r?void 0:Y7(Y7({},e),{},{scale:r}),t)};function Q7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Q7(Object(r),!0).forEach(function(n){Zke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zke(e,t,r){return(t=eje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eje(e){var t=tje(e,"string");return typeof t=="symbol"?t:t+""}function tje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rje=(e,t,r,n)=>{var a=t.find(s=>s&&s.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},nje=(e,t,r,n)=>{var a=t.find(u=>u&&u.index===r);if(a){if(e==="centric"){var s=a.coordinate,{radius:o}=n;return Sp(Sp(Sp({},n),fs(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:c}=n;return Sp(Sp(Sp({},n),fs(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function aje(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var LV=(e,t,r,n,a)=>{var s,o=(s=t==null?void 0:t.length)!==null&&s!==void 0?s:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,p,h=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,g=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(p=r[l+1])===null||p===void 0?void 0:p.coordinate,b=void 0;if(!(h==null||m==null||g==null))if(Ds(m-h)!==Ds(g-m)){var y=[];if(Ds(g-m)===Ds(a[1]-a[0])){b=g;var v=m+a[1]-a[0];y[0]=Math.min(v,(v+h)/2),y[1]=Math.max(v,(v+h)/2)}else{b=h;var w=g+a[1]-a[0];y[0]=Math.min(m,(w+m)/2),y[1]=Math.max(m,(w+m)/2)}var _=[Math.min(m,(b+m)/2),Math.max(m,(b+m)/2)];if(e>_[0]&&e<=_[1]||e>=y[0]&&e<=y[1]){var C;return(C=r[l])===null||C===void 0?void 0:C.index}}else{var j=Math.min(h,g),A=Math.max(h,g);if(e>(j+m)/2&&e<=(A+m)/2){var M;return(M=r[l])===null||M===void 0?void 0:M.index}}}else if(t)for(var P=0;P<o;P++){var R=t[P];if(R!=null){var N=t[P+1],T=t[P-1];if(P===0&&N!=null&&e<=(R.coordinate+N.coordinate)/2||P===o-1&&T!=null&&e>(R.coordinate+T.coordinate)/2||P>0&&P<o-1&&T!=null&&N!=null&&e>(R.coordinate+T.coordinate)/2&&e<=(R.coordinate+N.coordinate)/2)return R.index}}return-1},ije=()=>tn(oE),UE=(e,t)=>t,MV=(e,t,r)=>r,zE=(e,t,r,n)=>n,sje=Kt(tf,e=>FS(e,t=>t.coordinate)),WE=Kt([ug,UE,MV,zE],vV),qE=Kt([WE,fg,by,wy],FE),oje=(e,t,r)=>{if(t!=null){var n=ug(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},FV=Kt([ug,UE,MV,zE],SV),Nw=Kt([Qd,Jd,pa,ks,tf,zE,FV],wV),lje=Kt([WE,Nw],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),RV=Kt([tf,qE],mV),cje=Kt([FV,qE,ef,by,RV,_V,UE],kV),uje=Kt([WE,qE],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),dje=(e,t,r,n,a,s,o)=>{if(!(!e||!r||!n||!a)&&aje(e,o)){var l=$be(e,t),c=LV(l,s,a,r,n),u=rje(t,a,c,e);return{activeIndex:String(c),activeCoordinate:u}}},fje=(e,t,r,n,a,s,o)=>{if(!(!e||!n||!a||!s||!r)){var l=Z2e(e,r);if(l){var c=Ube(l,t),u=LV(c,o,s,n,a),d=nje(t,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},hje=(e,t,r,n,a,s,o,l)=>{if(!(!e||!t||!n||!a||!s))return t==="horizontal"||t==="vertical"?dje(e,t,n,a,s,o,l):fje(e,t,r,n,a,s,o)},pje=Kt(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),mje=Kt(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(bi)),r=Array.from(new Set(t));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:X_e}});function J7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Z7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?J7(Object(r),!0).forEach(function(n){gje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gje(e,t,r){return(t=xje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xje(e){var t=yje(e,"string");return typeof t=="symbol"?t:t+""}function yje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bje={},vje={zIndexMap:Object.values(bi).reduce((e,t)=>Z7(Z7({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),bje)},wje=new Set(Object.values(bi));function Sje(e){return wje.has(e)}var BV=yl({name:"zIndex",initialState:vje,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:si()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!Sje(r)&&delete e.zIndexMap[r])},prepare:si()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:a}=t.payload;e.zIndexMap[r]?a?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:si()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:si()}}}),{registerZIndexPortal:_je,unregisterZIndexPortal:kje,registerZIndexPortalElement:jje,unregisterZIndexPortalElement:Aje}=BV.actions,Nje=BV.reducer;function oo(e){var{zIndex:t,children:r}=e,n=pve(),a=n&&t!==void 0&&t!==0,s=js(),o=Ua();x.useLayoutEffect(()=>a?(o(_je({zIndex:t})),()=>{o(kje({zIndex:t}))}):K0,[o,t,a]);var l=tn(c=>pje(c,t,s));return a?l?eS.createPortal(r,l):null:r}function M4(){return M4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},M4.apply(null,arguments)}function eF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eF(Object(r),!0).forEach(function(n){Cje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Cje(e,t,r){return(t=Eje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eje(e){var t=Tje(e,"string");return typeof t=="symbol"?t:t+""}function Tje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pje(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return x.isValidElement(t)?x.cloneElement(t,n):x.createElement(r,n)}function Oje(e){var t,{coordinate:r,payload:n,index:a,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=e,f=r,p=n,h=a;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,g,b;if(d==="ScatterChart")m=f,g=h2e,b=bi.cursorLine;else if(d==="BarChart")m=p2e(l,f,s,o),g=Oq,b=bi.cursorRectangle;else if(l==="radial"&&Yz(f)){var{cx:y,cy:v,radius:w,startAngle:_,endAngle:C}=Mq(f);m={cx:y,cy:v,startAngle:_,endAngle:C,innerRadius:w,outerRadius:w},g=Rq,b=bi.cursorLine}else m={points:nwe(l,f,s)},g=JS,b=bi.cursorLine;var j=typeof c=="object"&&"className"in c?c.className:void 0,A=nv(nv(nv(nv({stroke:"#ccc",pointerEvents:"none"},s),m),ih(c)),{},{payload:p,payloadIndex:h,className:sa("recharts-tooltip-cursor",j)});return x.createElement(oo,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:b},x.createElement(Pje,{cursor:c,cursorComp:g,cursorProps:A}))}function Lje(e){var t=Jke(),r=pq(),n=X0(),a=ije();return t==null||r==null||n==null||a==null?null:x.createElement(Oje,M4({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var IV=x.createContext(null),Mje=()=>x.useContext(IV),DV={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new a(d,f||c,p),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,h=f.length,m=new Array(h);p<h;p++)m[p]=f[p].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,p,h,m){var g=r?r+u:u;if(!this._events[g])return!1;var b=this._events[g],y=arguments.length,v,w;if(b.fn){switch(b.once&&this.removeListener(u,b.fn,void 0,!0),y){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,d),!0;case 3:return b.fn.call(b.context,d,f),!0;case 4:return b.fn.call(b.context,d,f,p),!0;case 5:return b.fn.call(b.context,d,f,p,h),!0;case 6:return b.fn.call(b.context,d,f,p,h,m),!0}for(w=1,v=new Array(y-1);w<y;w++)v[w-1]=arguments[w];b.fn.apply(b.context,v)}else{var _=b.length,C;for(w=0;w<_;w++)switch(b[w].once&&this.removeListener(u,b[w].fn,void 0,!0),y){case 1:b[w].fn.call(b[w].context);break;case 2:b[w].fn.call(b[w].context,d);break;case 3:b[w].fn.call(b[w].context,d,f);break;case 4:b[w].fn.call(b[w].context,d,f,p);break;default:if(!v)for(C=1,v=new Array(y-1);C<y;C++)v[C-1]=arguments[C];b[w].fn.apply(b[w].context,v)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,p){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return o(this,h),this;var m=this._events[h];if(m.fn)m.fn===d&&(!p||m.once)&&(!f||m.context===f)&&o(this,h);else{for(var g=0,b=[],y=m.length;g<y;g++)(m[g].fn!==d||p&&!m[g].once||f&&m[g].context!==f)&&b.push(m[g]);b.length?this._events[h]=b.length===1?b[0]:b:o(this,h)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(DV);var Fje=DV.exports;const Rje=Wd(Fje);var C1=new Rje,F4="recharts.syncEvent.tooltip",tF="recharts.syncEvent.brush",y_=(e,t)=>{if(t&&Array.isArray(e)){var r=Number.parseInt(t,10);if(!Wu(r))return e[r]}},Bje={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},$V=yl({name:"options",initialState:Bje,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),Ije=$V.reducer,{createEventEmitter:Dje}=$V.actions;function $je(e){return e.tooltip.syncInteraction}var Uje={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},UV=yl({name:"chartData",initialState:Uje,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:rF,setDataStartEndIndexes:zje,setComputedData:qOe}=UV.actions,Wje=UV.reducer,qje=["x","y"];function nF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _p(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nF(Object(r),!0).forEach(function(n){Hje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Hje(e,t,r){return(t=Vje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vje(e){var t=Gje(e,"string");return typeof t=="symbol"?t:t+""}function Gje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Kje(e,t){if(e==null)return{};var r,n,a=Xje(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Xje(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Yje(){var e=tn(lE),t=tn(cE),r=Ua(),n=tn(MH),a=tn(tf),s=X0(),o=tg(),l=tn(c=>c.rootProps.className);x.useEffect(()=>{if(e==null)return K0;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var p;if(o&&d!==null&&d!==void 0&&(p=d.payload)!==null&&p!==void 0&&p.coordinate&&d.payload.sourceViewBox){var h=d.payload.coordinate,{x:m,y:g}=h,b=Kje(h,qje),{x:y,y:v,width:w,height:_}=d.payload.sourceViewBox,C=_p(_p({},b),{},{x:o.x+(w?(m-y)/w:0)*o.width,y:o.y+(_?(g-v)/_:0)*o.height});r(_p(_p({},d),{},{payload:_p(_p({},d.payload),{},{coordinate:C})}))}else r(d);return}if(a!=null){var j;if(typeof n=="function"){var A={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},M=n(a,A);j=a[M]}else n==="value"&&(j=a.find(xe=>String(xe.value)===d.payload.label));var{coordinate:P}=d.payload;if(j==null||d.payload.active===!1||P==null||o==null){r(O4({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:R,y:N}=P,T=Math.min(R,o.x+o.width),B=Math.min(N,o.y+o.height),G={x:s==="horizontal"?j.coordinate:T,y:s==="horizontal"?B:j.coordinate},re=O4({active:d.payload.active,coordinate:G,dataKey:d.payload.dataKey,index:String(j.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(re)}}};return C1.on(F4,c),()=>{C1.off(F4,c)}},[l,r,t,e,n,a,s,o])}function Qje(){var e=tn(lE),t=tn(cE),r=Ua();x.useEffect(()=>{if(e==null)return K0;var n=(a,s,o)=>{t!==o&&e===a&&r(zje(s))};return C1.on(tF,n),()=>{C1.off(tF,n)}},[r,t,e])}function Jje(){var e=Ua();x.useEffect(()=>{e(Dje())},[e]),Yje(),Qje()}function Zje(e,t,r,n,a,s){var o=tn(h=>oje(h,e,t)),l=tn(cE),c=tn(lE),u=tn(MH),d=tn($je),f=d==null?void 0:d.active,p=tg();x.useEffect(()=>{if(!f&&c!=null&&l!=null){var h=O4({active:s,coordinate:r,dataKey:o,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:p,graphicalItemId:void 0});C1.emit(F4,c,h,l)}},[f,r,o,a,n,l,c,u,s,p])}function aF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function iF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aF(Object(r),!0).forEach(function(n){eAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eAe(e,t,r){return(t=tAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tAe(e){var t=rAe(e,"string");return typeof t=="symbol"?t:t+""}function rAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function nAe(e){return e.dataKey}function aAe(e,t){return x.isValidElement(e)?x.cloneElement(e,t):typeof e=="function"?x.createElement(e,t):x.createElement(Vve,t)}var sF=[],iAe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function _y(e){var t,r,n=di(e,iAe),{active:a,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:p,position:h,reverseDirection:m,useTranslate3d:g,wrapperStyle:b,cursor:y,shared:v,trigger:w,defaultIndex:_,portal:C,axisId:j}=n,A=Ua(),M=typeof _=="number"?String(_):_;x.useEffect(()=>{A(tke({shared:v,trigger:w,axisId:j,active:a,defaultIndex:M}))},[A,v,w,j,a,M]);var P=tg(),R=Nq(),N=X5e(v),{activeIndex:T,isActive:B}=(t=tn(z=>uje(z,N,w,M)))!==null&&t!==void 0?t:{},G=tn(z=>cje(z,N,w,M)),re=tn(z=>RV(z,N,w,M)),xe=tn(z=>lje(z,N,w,M)),_e=G,V=Mje(),K=(r=a??B)!==null&&r!==void 0?r:!1,[de,ne]=NW([_e,K]),E=N==="axis"?re:void 0;Zje(N,w,xe,E,T,K);var Z=C??V;if(Z==null||P==null||N==null)return null;var H=_e??sF;K||(H=sF),u&&H.length&&(H=mW(H.filter(z=>z.value!=null&&(z.hide!==!0||n.includeHidden)),p,nAe));var F=H.length>0,ee=x.createElement(Zve,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:K,coordinate:xe,hasPayload:F,offset:f,position:h,reverseDirection:m,useTranslate3d:g,viewBox:P,wrapperStyle:b,lastBoundingBox:de,innerRef:ne,hasPortalFromProps:!!C},aAe(c,iF(iF({},n),{},{payload:H,label:E,active:K,activeIndex:T,coordinate:xe,accessibilityLayer:R})));return x.createElement(x.Fragment,null,eS.createPortal(ee,Z),K&&x.createElement(Lje,{cursor:y,tooltipEventType:N,coordinate:xe,payload:H,index:T}))}var J0=e=>null;J0.displayName="Cell";function sAe(e,t,r){return(t=oAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oAe(e){var t=lAe(e,"string");return typeof t=="symbol"?t:t+""}function lAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class cAe{constructor(t){sAe(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function oF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function uAe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oF(Object(r),!0).forEach(function(n){dAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dAe(e,t,r){return(t=fAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fAe(e){var t=hAe(e,"string");return typeof t=="symbol"?t:t+""}function hAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pAe={cacheSize:2e3,enableCache:!0},zV=uAe({},pAe),lF=new cAe(zV.cacheSize),mAe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},cF="recharts_measurement_span";function gAe(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var uF=(e,t)=>{try{var r=document.getElementById(cF);r||(r=document.createElement("span"),r.setAttribute("id",cF),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,mAe,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Nx=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||ZS.isSsr)return{width:0,height:0};if(!zV.enableCache)return uF(t,r);var n=gAe(t,r),a=lF.get(n);if(a)return a;var s=uF(t,r);return lF.set(n,s),s},WV;function xAe(e,t,r){return(t=yAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yAe(e){var t=bAe(e,"string");return typeof t=="symbol"?t:t+""}function bAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,fF=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,vAe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,wAe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,SAe={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},_Ae=["cm","mm","pt","pc","in","Q","px"];function kAe(e){return _Ae.includes(e)}var Xp="NaN";function jAe(e,t){return e*SAe[t]}class eo{static parse(t){var r,[,n,a]=(r=wAe.exec(t))!==null&&r!==void 0?r:[];return n==null?eo.NaN:new eo(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Wu(t)&&(this.unit=""),r!==""&&!vAe.test(r)&&(this.num=NaN,this.unit=""),kAe(r)&&(this.num=jAe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new eo(NaN,""):new eo(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new eo(NaN,""):new eo(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new eo(NaN,""):new eo(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new eo(NaN,""):new eo(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Wu(this.num)}}WV=eo;xAe(eo,"NaN",new WV(NaN,""));function qV(e){if(e==null||e.includes(Xp))return Xp;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,s]=(r=dF.exec(t))!==null&&r!==void 0?r:[],o=eo.parse(n??""),l=eo.parse(s??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return Xp;t=t.replace(dF,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,p]=(u=fF.exec(t))!==null&&u!==void 0?u:[],h=eo.parse(d??""),m=eo.parse(p??""),g=f==="+"?h.add(m):h.subtract(m);if(g.isNaN())return Xp;t=t.replace(fF,g.toString())}return t}var hF=/\(([^()]*)\)/;function AAe(e){for(var t=e,r;(r=hF.exec(t))!=null;){var[,n]=r;t=t.replace(hF,qV(n))}return t}function NAe(e){var t=e.replace(/\s+/g,"");return t=AAe(t),t=qV(t),t}function CAe(e){try{return NAe(e)}catch{return Xp}}function Hk(e){var t=CAe(e.slice(5,-1));return t===Xp?"":t}var EAe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],TAe=["dx","dy","angle","className","breakAll"];function R4(){return R4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},R4.apply(null,arguments)}function pF(e,t){if(e==null)return{};var r,n,a=PAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var HV=/[ \f\n\r\t\v\u2028\u2029]+/,VV=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Da(t)||(r?a=t.toString().split(""):a=t.toString().split(HV));var s=a.map(l=>({word:l,width:Nx(l,n).width})),o=r?0:Nx("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function OAe(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var GV=(e,t,r,n)=>e.reduce((a,s)=>{var{word:o,width:l}=s,c=a[a.length-1];if(c&&l!=null&&(t==null||n||c.width+l+r<Number(t)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};a.push(u)}return a},[]),KV=e=>e.reduce((t,r)=>t.width>r.width?t:r),LAe="",mF=(e,t,r,n,a,s,o,l)=>{var c=e.slice(0,t),u=VV({breakAll:r,style:n,children:c+LAe});if(!u)return[!1,[]];var d=GV(u.wordsWithComputedWidth,s,o,l),f=d.length>a||KV(d).width>Number(s);return[f,d]},MAe=(e,t,r,n,a)=>{var{maxLines:s,children:o,style:l,breakAll:c}=e,u=an(s),d=String(o),f=GV(t,n,r,a);if(!u||a)return f;var p=f.length>s||KV(f).width>Number(n);if(!p)return f;for(var h=0,m=d.length-1,g=0,b;h<=m&&g<=d.length-1;){var y=Math.floor((h+m)/2),v=y-1,[w,_]=mF(d,v,c,l,s,n,r,a),[C]=mF(d,y,c,l,s,n,r,a);if(!w&&!C&&(h=y+1),w&&C&&(m=y-1),!w&&C){b=_;break}g++}return b||f},gF=e=>{var t=Da(e)?[]:e.toString().split(HV);return[{words:t,width:void 0}]},FAe=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:s,maxLines:o}=e;if((t||r)&&!ZS.isSsr){var l,c,u=VV({breakAll:s,children:n,style:a});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return gF(n);return MAe({breakAll:s,children:n,maxLines:o,style:a},l,c,t,!!r)}return gF(n)},XV="#808080",RAe={angle:0,breakAll:!1,capHeight:"0.71em",fill:XV,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},b_=x.forwardRef((e,t)=>{var r=di(e,RAe),{x:n,y:a,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=pF(r,EAe),p=x.useMemo(()=>FAe({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:h,dy:m,angle:g,className:b,breakAll:y}=f,v=pF(f,TAe);if(!Sc(n)||!Sc(a)||p.length===0)return null;var w=Number(n)+(an(h)?h:0),_=Number(a)+(an(m)?m:0);if(!Vn(w)||!Vn(_))return null;var C;switch(d){case"start":C=Hk("calc(".concat(o,")"));break;case"middle":C=Hk("calc(".concat((p.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:C=Hk("calc(".concat(p.length-1," * -").concat(s,")"));break}var j=[],A=p[0];if(c&&A!=null){var M=A.width,{width:P}=f;j.push("scale(".concat(an(P)&&an(M)?P/M:1,")"))}return g&&j.push("rotate(".concat(g,", ").concat(w,", ").concat(_,")")),j.length&&(v.transform=j.join(" ")),x.createElement("text",R4({},To(v),{ref:t,x:w,y:_,className:sa("recharts-text",b),textAnchor:u,fill:l.includes("url")?XV:l}),p.map((R,N)=>{var T=R.words.join(y?"":" ");return x.createElement("tspan",{x:w,dy:N===0?C:s,key:"".concat(T,"-").concat(N)},T)}))});b_.displayName="Text";function xF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _u(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xF(Object(r),!0).forEach(function(n){BAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BAe(e,t,r){return(t=IAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IAe(e){var t=DAe(e,"string");return typeof t=="symbol"?t:t+""}function DAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $Ae=e=>{var{viewBox:t,position:r,offset:n=0,parentViewBox:a}=e,{x:s,y:o,height:l,upperWidth:c,lowerWidth:u}=TC(t),d=s,f=s+(c-u)/2,p=(d+f)/2,h=(c+u)/2,m=d+c/2,g=l>=0?1:-1,b=g*n,y=g>0?"end":"start",v=g>0?"start":"end",w=c>=0?1:-1,_=w*n,C=w>0?"end":"start",j=w>0?"start":"end",A=a;if(r==="top"){var M={x:d+c/2,y:o-b,horizontalAnchor:"middle",verticalAnchor:y};return A&&(M.height=Math.max(o-A.y,0),M.width=c),M}if(r==="bottom"){var P={x:f+u/2,y:o+l+b,horizontalAnchor:"middle",verticalAnchor:v};return A&&(P.height=Math.max(A.y+A.height-(o+l),0),P.width=u),P}if(r==="left"){var R={x:p-_,y:o+l/2,horizontalAnchor:C,verticalAnchor:"middle"};return A&&(R.width=Math.max(R.x-A.x,0),R.height=l),R}if(r==="right"){var N={x:p+h+_,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"};return A&&(N.width=Math.max(A.x+A.width-N.x,0),N.height=l),N}var T=A?{width:h,height:l}:{};return r==="insideLeft"?_u({x:p+_,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"},T):r==="insideRight"?_u({x:p+h-_,y:o+l/2,horizontalAnchor:C,verticalAnchor:"middle"},T):r==="insideTop"?_u({x:d+c/2,y:o+b,horizontalAnchor:"middle",verticalAnchor:v},T):r==="insideBottom"?_u({x:f+u/2,y:o+l-b,horizontalAnchor:"middle",verticalAnchor:y},T):r==="insideTopLeft"?_u({x:d+_,y:o+b,horizontalAnchor:j,verticalAnchor:v},T):r==="insideTopRight"?_u({x:d+c-_,y:o+b,horizontalAnchor:C,verticalAnchor:v},T):r==="insideBottomLeft"?_u({x:f+_,y:o+l-b,horizontalAnchor:j,verticalAnchor:y},T):r==="insideBottomRight"?_u({x:f+u-_,y:o+l-b,horizontalAnchor:C,verticalAnchor:y},T):r&&typeof r=="object"&&(an(r.x)||j0(r.x))&&(an(r.y)||j0(r.y))?_u({x:s+No(r.x,h),y:o+No(r.y,l),horizontalAnchor:"end",verticalAnchor:"end"},T):_u({x:m,y:o+l/2,horizontalAnchor:"middle",verticalAnchor:"middle"},T)},UAe=["labelRef"],zAe=["content"];function yF(e,t){if(e==null)return{};var r,n,a=WAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function WAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function bF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ox(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bF(Object(r),!0).forEach(function(n){qAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qAe(e,t,r){return(t=HAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HAe(e){var t=VAe(e,"string");return typeof t=="symbol"?t:t+""}function VAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function md(){return md=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},md.apply(null,arguments)}var YV=x.createContext(null),QV=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:a,width:s,height:o,children:l}=e,c=x.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:a,width:s,height:o}),[t,r,n,a,s,o]);return x.createElement(YV.Provider,{value:c},l)},JV=()=>{var e=x.useContext(YV),t=tg();return e||(t?TC(t):void 0)},GAe=x.createContext(null),KAe=()=>{var e=x.useContext(GAe),t=tn(DH);return e||t},XAe=e=>{var{value:t,formatter:r}=e,n=Da(e.children)?t:e.children;return typeof r=="function"?r(n):n},HE=e=>e!=null&&typeof e=="function",YAe=(e,t)=>{var r=Ds(t-e),n=Math.min(Math.abs(t-e),360);return r*n},QAe=(e,t,r,n,a)=>{var{offset:s,className:o}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:p,clockWise:h}=a,m=(u+d)/2,g=YAe(f,p),b=g>=0?1:-1,y,v;switch(t){case"insideStart":y=f+b*s,v=h;break;case"insideEnd":y=p-b*s,v=!h;break;case"end":y=p+b*s,v=h;break;default:throw new Error("Unsupported position ".concat(t))}v=g<=0?v:!v;var w=fs(l,c,m,y),_=fs(l,c,m,y+(v?1:-1)*359),C="M".concat(w.x,",").concat(w.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(v?0:1,`,
    `).concat(_.x,",").concat(_.y),j=Da(e.id)?m1("recharts-radial-line-"):e.id;return x.createElement("text",md({},n,{dominantBaseline:"central",className:sa("recharts-radial-bar-label",o)}),x.createElement("defs",null,x.createElement("path",{id:j,d:C})),x.createElement("textPath",{xlinkHref:"#".concat(j)},r))},JAe=(e,t,r)=>{var{cx:n,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=fs(n,a,o+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var p=(s+o)/2,{x:h,y:m}=fs(n,a,p,u);return{x:h,y:m,textAnchor:"middle",verticalAnchor:"middle"}},qv=e=>e!=null&&"cx"in e&&an(e.cx),ZAe={angle:0,offset:5,zIndex:bi.label,position:"middle",textBreakAll:!1};function e4e(e){if(!qv(e))return e;var{cx:t,cy:r,outerRadius:n}=e,a=n*2;return{x:t-n,y:r-n,width:a,upperWidth:a,lowerWidth:a,height:a}}function jf(e){var t=di(e,ZAe),{viewBox:r,parentViewBox:n,position:a,value:s,children:o,content:l,className:c="",textBreakAll:u,labelRef:d}=t,f=KAe(),p=JV(),h=a==="center"?p:f??p,m,g,b;r==null?m=h:qv(r)?m=r:m=TC(r);var y=e4e(m);if(!m||Da(s)&&Da(o)&&!x.isValidElement(l)&&typeof l!="function")return null;var v=ox(ox({},t),{},{viewBox:m});if(x.isValidElement(l)){var{labelRef:w}=v,_=yF(v,UAe);return x.cloneElement(l,_)}if(typeof l=="function"){var{content:C}=v,j=yF(v,zAe);if(g=x.createElement(l,j),x.isValidElement(g))return g}else g=XAe(t);var A=To(t);if(qv(m)){if(a==="insideStart"||a==="insideEnd"||a==="end")return QAe(t,a,g,A,m);b=JAe(m,t.offset,t.position)}else{if(!y)return null;var M=$Ae({viewBox:y,position:a,offset:t.offset,parentViewBox:qv(n)?void 0:n});b=ox(ox({x:M.x,y:M.y,textAnchor:M.horizontalAnchor,verticalAnchor:M.verticalAnchor},M.width!==void 0?{width:M.width}:{}),M.height!==void 0?{height:M.height}:{})}return x.createElement(oo,{zIndex:t.zIndex},x.createElement(b_,md({ref:d,className:sa("recharts-label",c)},A,b,{textAnchor:OAe(A.textAnchor)?A.textAnchor:b.textAnchor,breakAll:u}),g))}jf.displayName="Label";var t4e=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?x.createElement(jf,md({key:"label-implicit"},n)):Sc(e)?x.createElement(jf,md({key:"label-implicit",value:e},n)):x.isValidElement(e)?e.type===jf?x.cloneElement(e,ox({key:"label-implicit"},n)):x.createElement(jf,md({key:"label-implicit",content:e},n)):HE(e)?x.createElement(jf,md({key:"label-implicit",content:e},n)):e&&typeof e=="object"?x.createElement(jf,md({},e,{key:"label-implicit"},n)):null};function ZV(e){var{label:t,labelRef:r}=e,n=JV();return t4e(t,n,r)||null}var eG={},tG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(tG);var rG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(rG);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tG,r=rG,n=OS;function a(s){if(n.isArrayLike(s))return t.last(r.toArray(s))}e.last=a})(eG);var r4e=eG.last;const n4e=Wd(r4e);var a4e=["valueAccessor"],i4e=["dataKey","clockWise","id","textBreakAll","zIndex"];function Cw(){return Cw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cw.apply(null,arguments)}function vF(e,t){if(e==null)return{};var r,n,a=s4e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function s4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var o4e=e=>Array.isArray(e.value)?n4e(e.value):e.value,nG=x.createContext(void 0),VE=nG.Provider,aG=x.createContext(void 0),l4e=aG.Provider;function c4e(){return x.useContext(nG)}function u4e(){return x.useContext(aG)}function Hv(e){var{valueAccessor:t=o4e}=e,r=vF(e,a4e),{dataKey:n,clockWise:a,id:s,textBreakAll:o,zIndex:l}=r,c=vF(r,i4e),u=c4e(),d=u4e(),f=u||d;return!f||!f.length?null:x.createElement(oo,{zIndex:l??bi.label},x.createElement(ui,{className:"recharts-label-list"},f.map((p,h)=>{var m,g=Da(n)?t(p,h):fa(p.payload,n),b=Da(s)?{}:{id:"".concat(s,"-").concat(h)};return x.createElement(jf,Cw({key:"label-".concat(h)},To(p),c,b,{fill:(m=r.fill)!==null&&m!==void 0?m:p.fill,parentViewBox:p.parentViewBox,value:g,textBreakAll:o,viewBox:p.viewBox,index:h,zIndex:0}))})))}Hv.displayName="LabelList";function v_(e){var{label:t}=e;return t?t===!0?x.createElement(Hv,{key:"labelList-implicit"}):x.isValidElement(t)||HE(t)?x.createElement(Hv,{key:"labelList-implicit",content:t}):typeof t=="object"?x.createElement(Hv,Cw({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function B4(){return B4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},B4.apply(null,arguments)}var iG=e=>{var{cx:t,cy:r,r:n,className:a}=e,s=sa("recharts-dot",a);return an(t)&&an(r)&&an(n)?x.createElement("circle",B4({},Ho(e),cC(e),{className:s,cx:t,cy:r,r:n})):null},sG=e=>e.graphicalItems.polarItems,d4e=Kt([_i,gy],mE),w_=Kt([sG,Di,d4e],gE),f4e=Kt([w_],xE),S_=Kt([f4e,s_],yE),h4e=Kt([S_,Di,w_],vE);Kt([S_,Di,w_],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var s,o=fa(n,(s=t.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:fa(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var wF=()=>{},p4e=Kt([S_,Di,w_,m_,_i],kE),m4e=Kt([Di,SE,_E,wF,p4e,wF,pa,_i],jE),oG=Kt([Di,pa,S_,h4e,my,_i,m4e],AE),g4e=Kt([oG,lg,bh],EE),x4e=Kt([Di,oG,g4e,_i],PE);Kt([bh,x4e],UH);var y4e={radiusAxis:{},angleAxis:{}},lG=yl({name:"polarAxis",initialState:y4e,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:HOe,removeRadiusAxis:VOe,addAngleAxis:GOe,removeAngleAxis:KOe}=lG.actions,b4e=lG.reducer;function cG(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function SF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _F(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SF(Object(r),!0).forEach(function(n){v4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function v4e(e,t,r){return(t=w4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w4e(e){var t=S4e(e,"string");return typeof t=="symbol"?t:t+""}function S4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _4e=(e,t)=>t,GE=Kt([sG,_4e],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),k4e=[],KE=(e,t,r)=>(r==null?void 0:r.length)===0?k4e:r,uG=Kt([s_,GE,KE],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(s=>_F(_F({},t.presentationProps),s.props))),a!=null)return a}}),j4e=Kt([uG,GE,KE],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var s,o=fa(n,t.nameKey,t.name),l;return r!=null&&(s=r[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:gh(o,t.dataKey),color:l,payload:n,type:t.legendType}})}),A4e=Kt([uG,GE,KE,ks],(e,t,r,n)=>{if(!(t==null||e==null))return C3e({offset:n,pieSettings:t,displayedData:e,cells:r})}),dG={exports:{}},Fa={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ws=typeof Symbol=="function"&&Symbol.for,XE=Ws?Symbol.for("react.element"):60103,YE=Ws?Symbol.for("react.portal"):60106,__=Ws?Symbol.for("react.fragment"):60107,k_=Ws?Symbol.for("react.strict_mode"):60108,j_=Ws?Symbol.for("react.profiler"):60114,A_=Ws?Symbol.for("react.provider"):60109,N_=Ws?Symbol.for("react.context"):60110,QE=Ws?Symbol.for("react.async_mode"):60111,C_=Ws?Symbol.for("react.concurrent_mode"):60111,E_=Ws?Symbol.for("react.forward_ref"):60112,T_=Ws?Symbol.for("react.suspense"):60113,N4e=Ws?Symbol.for("react.suspense_list"):60120,P_=Ws?Symbol.for("react.memo"):60115,O_=Ws?Symbol.for("react.lazy"):60116,C4e=Ws?Symbol.for("react.block"):60121,E4e=Ws?Symbol.for("react.fundamental"):60117,T4e=Ws?Symbol.for("react.responder"):60118,P4e=Ws?Symbol.for("react.scope"):60119;function Vl(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case XE:switch(e=e.type,e){case QE:case C_:case __:case j_:case k_:case T_:return e;default:switch(e=e&&e.$$typeof,e){case N_:case E_:case O_:case P_:case A_:return e;default:return t}}case YE:return t}}}function fG(e){return Vl(e)===C_}Fa.AsyncMode=QE;Fa.ConcurrentMode=C_;Fa.ContextConsumer=N_;Fa.ContextProvider=A_;Fa.Element=XE;Fa.ForwardRef=E_;Fa.Fragment=__;Fa.Lazy=O_;Fa.Memo=P_;Fa.Portal=YE;Fa.Profiler=j_;Fa.StrictMode=k_;Fa.Suspense=T_;Fa.isAsyncMode=function(e){return fG(e)||Vl(e)===QE};Fa.isConcurrentMode=fG;Fa.isContextConsumer=function(e){return Vl(e)===N_};Fa.isContextProvider=function(e){return Vl(e)===A_};Fa.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===XE};Fa.isForwardRef=function(e){return Vl(e)===E_};Fa.isFragment=function(e){return Vl(e)===__};Fa.isLazy=function(e){return Vl(e)===O_};Fa.isMemo=function(e){return Vl(e)===P_};Fa.isPortal=function(e){return Vl(e)===YE};Fa.isProfiler=function(e){return Vl(e)===j_};Fa.isStrictMode=function(e){return Vl(e)===k_};Fa.isSuspense=function(e){return Vl(e)===T_};Fa.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===__||e===C_||e===j_||e===k_||e===T_||e===N4e||typeof e=="object"&&e!==null&&(e.$$typeof===O_||e.$$typeof===P_||e.$$typeof===A_||e.$$typeof===N_||e.$$typeof===E_||e.$$typeof===E4e||e.$$typeof===T4e||e.$$typeof===P4e||e.$$typeof===C4e)};Fa.typeOf=Vl;dG.exports=Fa;var O4e=dG.exports,kF=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",jF=null,Vk=null,hG=e=>{if(e===jF&&Array.isArray(Vk))return Vk;var t=[];return x.Children.forEach(e,r=>{Da(r)||(O4e.isFragment(r)?t=t.concat(hG(r.props.children)):t.push(r))}),Vk=t,jF=e,t};function L_(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>kF(a)):n=[kF(t)],hG(e).forEach(a=>{var s=k0(a,"type.displayName")||k0(a,"type.name");s&&n.indexOf(s)!==-1&&r.push(a)}),r}var pG=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,mG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(mG);var L4e=mG.isPlainObject;const M4e=Wd(L4e);var AF,NF,CF,EF,TF;function PF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function OF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PF(Object(r),!0).forEach(function(n){F4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function F4e(e,t,r){return(t=R4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R4e(e){var t=B4e(e,"string");return typeof t=="symbol"?t:t+""}function B4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ew(){return Ew=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ew.apply(null,arguments)}function Hg(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var LF=(e,t,r,n,a)=>{var s=r-n,o;return o=Oi(AF||(AF=Hg(["M ",",",""])),e,t),o+=Oi(NF||(NF=Hg(["L ",",",""])),e+r,t),o+=Oi(CF||(CF=Hg(["L ",",",""])),e+r-s/2,t+a),o+=Oi(EF||(EF=Hg(["L ",",",""])),e+r-s/2-n,t+a),o+=Oi(TF||(TF=Hg(["L ",","," Z"])),e,t),o},I4e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},D4e=e=>{var t=di(e,I4e),{x:r,y:n,upperWidth:a,lowerWidth:s,height:o,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=t,p=x.useRef(null),[h,m]=x.useState(-1),g=x.useRef(a),b=x.useRef(s),y=x.useRef(o),v=x.useRef(r),w=x.useRef(n),_=ng(e,"trapezoid-");if(x.useEffect(()=>{if(p.current&&p.current.getTotalLength)try{var G=p.current.getTotalLength();G&&m(G)}catch{}},[]),r!==+r||n!==+n||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var C=sa("recharts-trapezoid",l);if(!f)return x.createElement("g",null,x.createElement("path",Ew({},To(t),{className:C,d:LF(r,n,a,s,o)})));var j=g.current,A=b.current,M=y.current,P=v.current,R=w.current,N="0px ".concat(h===-1?1:h,"px"),T="".concat(h,"px 0px"),B=Cq(["strokeDasharray"],u,c);return x.createElement(rg,{animationId:_,key:_,canBegin:h>0,duration:u,easing:c,isActive:f,begin:d},G=>{var re=Ia(j,a,G),xe=Ia(A,s,G),_e=Ia(M,o,G),V=Ia(P,r,G),K=Ia(R,n,G);p.current&&(g.current=re,b.current=xe,y.current=_e,v.current=V,w.current=K);var de=G>0?{transition:B,strokeDasharray:T}:{strokeDasharray:N};return x.createElement("path",Ew({},To(t),{className:C,d:LF(V,K,re,xe,_e),ref:p,style:OF(OF({},de),t.style)}))})},$4e=["option","shapeType","activeClassName"];function U4e(e,t){if(e==null)return{};var r,n,a=z4e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function z4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function MF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MF(Object(r),!0).forEach(function(n){W4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W4e(e,t,r){return(t=q4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q4e(e){var t=H4e(e,"string");return typeof t=="symbol"?t:t+""}function H4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V4e(e,t){return Tw(Tw({},t),e)}function G4e(e,t){return e==="symbols"}function FF(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return x.createElement(Oq,r);case"trapezoid":return x.createElement(D4e,r);case"sector":return x.createElement(Rq,r);case"symbols":if(G4e(t))return x.createElement(PS,r);break;case"curve":return x.createElement(JS,r);default:return null}}function K4e(e){return x.isValidElement(e)?e.props:e}function E1(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,a=U4e(e,$4e),s;if(x.isValidElement(t))s=x.cloneElement(t,Tw(Tw({},a),K4e(t)));else if(typeof t=="function")s=t(a,a.index);else if(M4e(t)&&typeof t!="boolean"){var o=V4e(t,a);s=x.createElement(FF,{shapeType:r,elementProps:o})}else{var l=a;s=x.createElement(FF,{shapeType:r,elementProps:l})}return a.isActive?x.createElement(ui,{className:n},s):s}var M_=(e,t,r)=>{var n=Ua();return(a,s)=>o=>{e==null||e(a,s,o),n(xV({activeIndex:String(s),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},F_=e=>{var t=Ua();return(r,n)=>a=>{e==null||e(r,n,a),t(rke())}},R_=(e,t,r)=>{var n=Ua();return(a,s)=>o=>{e==null||e(a,s,o),n(nke({activeIndex:String(s),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function B_(e){var{tooltipEntrySettings:t}=e,r=Ua(),n=js(),a=x.useRef(null);return x.useLayoutEffect(()=>{n||(a.current===null?r(J5e(t)):a.current!==t&&r(Z5e({prev:a.current,next:t})),a.current=t)},[t,r,n]),x.useLayoutEffect(()=>()=>{a.current&&(r(eke(a.current)),a.current=null)},[r]),null}function JE(e){var{legendPayload:t}=e,r=Ua(),n=js(),a=x.useRef(null);return x.useLayoutEffect(()=>{n||(a.current===null?r(kq(t)):a.current!==t&&r(jq({prev:a.current,next:t})),a.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{a.current&&(r(Aq(a.current)),a.current=null)},[r]),null}function X4e(e){var{legendPayload:t}=e,r=Ua(),n=tn(pa),a=x.useRef(null);return x.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(kq(t)):a.current!==t&&r(jq({prev:a.current,next:t})),a.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{a.current&&(r(Aq(a.current)),a.current=null)},[r]),null}var Gk,Y4e=()=>{var[e]=x.useState(()=>m1("uid-"));return e},Q4e=(Gk=YR.useId)!==null&&Gk!==void 0?Gk:Y4e;function J4e(e,t){var r=Q4e();return t||(e?"".concat(e,"-").concat(r):r)}var Z4e=x.createContext(void 0),I_=e=>{var{id:t,type:r,children:n}=e,a=J4e("recharts-".concat(r),t);return x.createElement(Z4e.Provider,{value:a},n(a))},e3e={cartesianItems:[],polarItems:[]},gG=yl({name:"graphicalItems",initialState:e3e,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:si()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=Zc(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:si()},removeCartesianGraphicalItem:{reducer(e,t){var r=Zc(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:si()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:si()},removePolarGraphicalItem:{reducer(e,t){var r=Zc(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:si()}}}),{addCartesianGraphicalItem:t3e,replaceCartesianGraphicalItem:r3e,removeCartesianGraphicalItem:n3e,addPolarGraphicalItem:a3e,removePolarGraphicalItem:i3e}=gG.actions,s3e=gG.reducer,o3e=e=>{var t=Ua(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(t3e(e)):r.current!==e&&t(r3e({prev:r.current,next:e})),r.current=e},[t,e]),x.useLayoutEffect(()=>()=>{r.current&&(t(n3e(r.current)),r.current=null)},[t]),null},ZE=x.memo(o3e);function l3e(e){var t=Ua();return x.useLayoutEffect(()=>(t(a3e(e)),()=>{t(i3e(e))}),[t,e]),null}var c3e=["key"],u3e=["onMouseEnter","onClick","onMouseLeave"],d3e=["id"],f3e=["id"];function RF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Fi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RF(Object(r),!0).forEach(function(n){h3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function h3e(e,t,r){return(t=p3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p3e(e){var t=m3e(e,"string");return typeof t=="symbol"?t:t+""}function m3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sh(){return sh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sh.apply(null,arguments)}function D_(e,t){if(e==null)return{};var r,n,a=g3e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function g3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function x3e(e){var t=x.useMemo(()=>L_(e.children,J0),[e.children]),r=tn(n=>j4e(n,e.id,t));return r==null?null:x.createElement(X4e,{legendPayload:r})}var y3e=x.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:n.map(p=>p.tooltipPayload),getPosition:p=>{var h;return(h=n[Number(p)])===null||h===void 0?void 0:h.tooltipPosition},settings:{stroke:a,strokeWidth:s,fill:o,dataKey:t,nameKey:r,name:gh(l,t),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return x.createElement(B_,{tooltipEntrySettings:f})}),b3e=(e,t)=>e>t?"start":e<t?"end":"middle",v3e=(e,t,r)=>No(typeof t=="function"?t(e):t,r,r*.8),w3e=(e,t,r)=>{var{top:n,left:a,width:s,height:o}=t,l=Lq(s,o),c=a+No(e.cx,s,s/2),u=n+No(e.cy,o,o/2),d=No(e.innerRadius,l,0),f=v3e(r,e.outerRadius,l),p=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:p}},S3e=(e,t)=>{var r=Ds(t-e),n=Math.min(Math.abs(t-e),360);return r*n},_3e=(e,t)=>{if(x.isValidElement(e))return x.cloneElement(e,t);if(typeof e=="function")return e(t);var r=sa("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,a=D_(t,c3e);return x.createElement(JS,sh({},a,{type:"linear",className:r}))},k3e=(e,t,r)=>{if(x.isValidElement(e))return x.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),x.isValidElement(n)))return n;var a=sa("recharts-pie-label-text",cG(e));return x.createElement(b_,sh({},t,{alignmentBaseline:"middle",className:a}),n)};function j3e(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:s,dataKey:o}=r;if(!n||!a||!t)return null;var l=Ho(r),c=ih(a),u=ih(s),d=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=t.map((p,h)=>{var m=(p.startAngle+p.endAngle)/2,g=fs(p.cx,p.cy,p.outerRadius+d,m),b=Fi(Fi(Fi(Fi({},l),p),{},{stroke:"none"},c),{},{index:h,textAnchor:b3e(g.x,p.cx)},g),y=Fi(Fi(Fi(Fi({},l),p),{},{fill:"none",stroke:p.fill},u),{},{index:h,points:[fs(p.cx,p.cy,p.outerRadius,m),g],key:"line"});return x.createElement(oo,{zIndex:bi.label,key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(h)},x.createElement(ui,null,s&&_3e(s,y),k3e(a,b,fa(p,o))))});return x.createElement(ui,{className:"recharts-pie-labels"},f)}function A3e(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?x.createElement(v_,{label:a}):x.createElement(j3e,{sectors:t,props:r,showLabels:n})}function N3e(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:s,id:o}=e,l=tn(Ud),c=tn($E),u=tn(zke),{onMouseEnter:d,onClick:f,onMouseLeave:p}=a,h=D_(a,u3e),m=M_(d,a.dataKey,o),g=F_(p),b=R_(f,a.dataKey,o);return t==null||t.length===0?null:x.createElement(x.Fragment,null,t.map((y,v)=>{if((y==null?void 0:y.startAngle)===0&&(y==null?void 0:y.endAngle)===0&&t.length!==1)return null;var w=u==null||u===o,_=String(v)===l&&(c==null||a.dataKey===c)&&w,C=l?n:null,j=r&&_?r:C,A=Fi(Fi({},y),{},{stroke:y.stroke,tabIndex:-1,[oq]:v,[NC]:o});return x.createElement(ui,sh({key:"sector-".concat(y==null?void 0:y.startAngle,"-").concat(y==null?void 0:y.endAngle,"-").concat(y.midAngle,"-").concat(v),tabIndex:-1,className:"recharts-pie-sector"},eg(h,y,v),{onMouseEnter:m(y,v),onMouseLeave:g(y,v),onClick:b(y,v)}),x.createElement(E1,sh({option:s??j,index:v,shapeType:"sector",isActive:_},A)))}))}function C3e(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:s}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,p=Math.abs(r.minAngle),h=S3e(l,c),m=Math.abs(h),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,b=n.filter(j=>fa(j,u,0)!==0).length,y=(m>=360?b:b-1)*g,v=m-b*p-y,w=n.reduce((j,A)=>{var M=fa(A,u,0);return j+(an(M)?M:0)},0),_;if(w>0){var C;_=n.map((j,A)=>{var M=fa(j,u,0),P=fa(j,d,A),R=w3e(r,s,j),N=(an(M)?M:0)/w,T,B=Fi(Fi({},j),a&&a[A]&&a[A].props);A?T=C.endAngle+Ds(h)*g*(M!==0?1:0):T=l;var G=T+Ds(h)*((M!==0?p:0)+N*v),re=(T+G)/2,xe=(R.innerRadius+R.outerRadius)/2,_e=[{name:P,value:M,payload:B,dataKey:u,type:f,graphicalItemId:r.id}],V=fs(R.cx,R.cy,xe,re);return C=Fi(Fi(Fi(Fi({},r.presentationProps),{},{percent:N,cornerRadius:typeof o=="string"?parseFloat(o):o,name:P,tooltipPayload:_e,midAngle:re,middleRadius:xe,tooltipPosition:V},B),R),{},{value:M,dataKey:u,startAngle:T,endAngle:G,payload:B,paddingAngle:Ds(h)*g}),C})}return _}function E3e(e){var{showLabels:t,sectors:r,children:n}=e,a=x.useMemo(()=>!t||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,t]);return x.createElement(l4e,{value:t?a:void 0},n)}function T3e(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:p}=t,h=ng(t,"recharts-pie-"),m=r.current,[g,b]=x.useState(!1),y=x.useCallback(()=>{typeof p=="function"&&p(),b(!1)},[p]),v=x.useCallback(()=>{typeof f=="function"&&f(),b(!0)},[f]);return x.createElement(E3e,{showLabels:!g,sectors:a},x.createElement(rg,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:v,onAnimationEnd:y,key:h},w=>{var _,C=[],j=a&&a[0],A=(_=j==null?void 0:j.startAngle)!==null&&_!==void 0?_:0;return a==null||a.forEach((M,P)=>{var R=m&&m[P],N=P>0?k0(M,"paddingAngle",0):0;if(R){var T=Ia(R.endAngle-R.startAngle,M.endAngle-M.startAngle,w),B=Fi(Fi({},M),{},{startAngle:A+N,endAngle:A+T+N});C.push(B),A=B.endAngle}else{var{endAngle:G,startAngle:re}=M,xe=Ia(0,G-re,w),_e=Fi(Fi({},M),{},{startAngle:A+N,endAngle:A+xe+N});C.push(_e),A=_e.endAngle}}),r.current=C,x.createElement(ui,null,x.createElement(N3e,{sectors:C,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:n}))}),x.createElement(A3e,{showLabels:!g,sectors:a,props:t}),t.children)}var P3e={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:bi.area};function O3e(e){var{id:t}=e,r=D_(e,d3e),{hide:n,className:a,rootTabIndex:s}=e,o=x.useMemo(()=>L_(e.children,J0),[e.children]),l=tn(d=>A4e(d,t,o)),c=x.useRef(null),u=sa("recharts-pie",a);return n||l==null?(c.current=null,x.createElement(ui,{tabIndex:s,className:u})):x.createElement(oo,{zIndex:e.zIndex},x.createElement(y3e,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:l,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),x.createElement(ui,{tabIndex:s,className:u},x.createElement(T3e,{props:Fi(Fi({},r),{},{sectors:l}),previousSectorsRef:c,id:t})))}function xG(e){var t=di(e,P3e),{id:r}=t,n=D_(t,f3e),a=Ho(n);return x.createElement(I_,{id:r,type:"pie"},s=>x.createElement(x.Fragment,null,x.createElement(l3e,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),x.createElement(x3e,sh({},n,{id:s})),x.createElement(O3e,sh({},n,{id:s}))))}xG.displayName="Pie";var L3e=["points"];function BF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BF(Object(r),!0).forEach(function(n){M3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M3e(e,t,r){return(t=F3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F3e(e){var t=R3e(e,"string");return typeof t=="symbol"?t:t+""}function R3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pw(){return Pw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pw.apply(null,arguments)}function B3e(e,t){if(e==null)return{};var r,n,a=I3e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function I3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function D3e(e){var{option:t,dotProps:r,className:n}=e;if(x.isValidElement(t))return x.cloneElement(t,r);if(typeof t=="function")return t(r);var a=sa(n,typeof t!="boolean"?t.className:""),s=r??{},{points:o}=s,l=B3e(s,L3e);return x.createElement(iG,Pw({},l,{className:a}))}function $3e(e,t){return e==null?!1:t?!0:e.length===1}function U3e(e){var{points:t,dot:r,className:n,dotClassName:a,dataKey:s,baseProps:o,needClip:l,clipPathId:c,zIndex:u=bi.scatter}=e;if(!$3e(t,r))return null;var d=pG(r),f=Nxe(r),p=t.map((m,g)=>{var b,y,v=Kk(Kk(Kk({r:3},o),f),{},{index:g,cx:(b=m.x)!==null&&b!==void 0?b:void 0,cy:(y=m.y)!==null&&y!==void 0?y:void 0,dataKey:s,value:m.value,payload:m.payload,points:t});return x.createElement(D3e,{key:"dot-".concat(g),option:r,dotProps:v,className:a})}),h={};return l&&c!=null&&(h.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),x.createElement(oo,{zIndex:u},x.createElement(ui,Pw({className:n},h),p))}function IF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IF(Object(r),!0).forEach(function(n){z3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function z3e(e,t,r){return(t=W3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W3e(e){var t=q3e(e,"string");return typeof t=="symbol"?t:t+""}function q3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yG=0,H3e={xAxis:{},yAxis:{},zAxis:{}},bG=yl({name:"cartesianAxis",initialState:H3e,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:si()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:si()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:si()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:si()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:si()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:si()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:si()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:si()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:si()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var s,o=a.widthHistory||[];if(o.length===3&&o[0]===o[2]&&n===o[1]&&n!==a.width&&Math.abs(n-((s=o[0])!==null&&s!==void 0?s:0))<=1)return;var l=[...o,n].slice(-3);e.yAxis[r]=DF(DF({},a),{},{width:n,widthHistory:l})}}}}),{addXAxis:V3e,replaceXAxis:G3e,removeXAxis:K3e,addYAxis:X3e,replaceYAxis:Y3e,removeYAxis:Q3e,addZAxis:J3e,replaceZAxis:Z3e,removeZAxis:eNe,updateYAxisWidth:tNe}=bG.actions,rNe=bG.reducer,nNe=Kt([ks],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),aNe=Kt([nNe,Qd,Jd],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),e6=()=>tn(aNe),iNe=()=>tn(Gke);function $F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$F(Object(r),!0).forEach(function(n){sNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$F(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sNe(e,t,r){return(t=oNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oNe(e){var t=lNe(e,"string");return typeof t=="symbol"?t:t+""}function lNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cNe=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:a,dataKey:s,clipPath:o}=e;if(a===!1||t.x==null||t.y==null)return null;var l={index:r,dataKey:s,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=Xk(Xk(Xk({},l),ih(a)),cC(a)),u;return x.isValidElement(a)?u=x.cloneElement(a,c):typeof a=="function"?u=a(c):u=x.createElement(iG,c),x.createElement(ui,{className:"recharts-active-dot",clipPath:o},u)};function uNe(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:a,clipPath:s,zIndex:o=bi.activeDot}=e,l=tn(Ud),c=iNe();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return Da(u)?null:x.createElement(oo,{zIndex:o},x.createElement(cNe,{point:u,childIndex:Number(l),mainColor:r,dataKey:a,activeDot:n,clipPath:s}))}var UF=(e,t,r)=>{var n=r??e;if(!Da(n))return No(n,t,0)},dNe=(e,t,r)=>{var n={},a=e.filter(d_),s=e.filter(u=>u.stackId==null),o=a.reduce((u,d)=>{var f=u[d.stackId];return f==null&&(f=[]),f.push(d),u[d.stackId]=f,u},n),l=Object.entries(o).map(u=>{var d,[f,p]=u,h=p.map(g=>g.dataKey),m=UF(t,r,(d=p[0])===null||d===void 0?void 0:d.barSize);return{stackId:f,dataKeys:h,barSize:m}}),c=s.map(u=>{var d=[u.dataKey].filter(p=>p!=null),f=UF(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function zF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function av(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zF(Object(r),!0).forEach(function(n){fNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fNe(e,t,r){return(t=hNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hNe(e){var t=pNe(e,"string");return typeof t=="symbol"?t:t+""}function pNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mNe(e,t,r,n,a){var s,o=n.length;if(!(o<1)){var l=No(e,r,0,!0),c,u=[];if(Vn((s=n[0])===null||s===void 0?void 0:s.barSize)){var d=!1,f=r/o,p=n.reduce((v,w)=>v+(w.barSize||0),0);p+=(o-1)*l,p>=r&&(p-=(o-1)*l,l=0),p>=r&&f>0&&(d=!0,f*=.9,p=o*f);var h=(r-p)/2>>0,m={offset:h-l,size:0};c=n.reduce((v,w)=>{var _,C={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:m.offset+m.size+l,size:d?f:(_=w.barSize)!==null&&_!==void 0?_:0}},j=[...v,C];return m=C.position,j},u)}else{var g=No(t,r,0,!0);r-2*g-(o-1)*l<=0&&(l=0);var b=(r-2*g-(o-1)*l)/o;b>1&&(b>>=0);var y=Vn(a)?Math.min(b,a):b;c=n.reduce((v,w,_)=>[...v,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:g+(b+l)*_+(b-y)/2,size:y}}],u)}return c}}var gNe=(e,t,r,n,a,s,o)=>{var l=Da(o)?t:o,c=mNe(r,n,a!==s?a:s,e,l);return a!==s&&c!=null&&(c=c.map(u=>av(av({},u),{},{position:av(av({},u.position),{},{offset:u.position.offset-a/2})}))),c},xNe=(e,t)=>{var r=hE(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===r)}}}},yNe=(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}};function bNe(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&Vn(e.zIndex)?e.zIndex:t}var vG=e=>{var{chartData:t}=e,r=Ua(),n=js();return x.useEffect(()=>n?()=>{}:(r(rF(t)),()=>{r(rF(void 0))}),[t,r,n]),null},WF={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},wG=yl({name:"brush",initialState:WF,reducers:{setBrushSettings(e,t){return t.payload==null?WF:t.payload}}}),{setBrushSettings:XOe}=wG.actions,vNe=wG.reducer,wNe=(e,t)=>{var{x:r,y:n}=e,{x:a,y:s}=t;return{x:Math.min(r,a),y:Math.min(n,s),width:Math.abs(a-r),height:Math.abs(s-n)}},SNe=e=>{var{x1:t,y1:r,x2:n,y2:a}=e;return wNe({x:t,y:r},{x:n,y:a})};function _Ne(e){return(e%180+180)%180}var kNe=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=_Ne(a),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},jNe={dots:[],areas:[],lines:[]},SG=yl({name:"referenceElements",initialState:jNe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Zc(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Zc(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Zc(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:YOe,removeDot:QOe,addArea:JOe,removeArea:ZOe,addLine:ANe,removeLine:NNe}=SG.actions,CNe=SG.reducer,_G=x.createContext(void 0),ENe=e=>{var{children:t}=e,[r]=x.useState("".concat(m1("recharts"),"-clip")),n=e6();if(n==null)return null;var{x:a,y:s,width:o,height:l}=n;return x.createElement(_G.Provider,{value:r},x.createElement("defs",null,x.createElement("clipPath",{id:r},x.createElement("rect",{x:a,y:s,height:l,width:o}))),t)},TNe=()=>x.useContext(_G);class PNe{constructor(t){var{x:r,y:n}=t;this.xAxisScale=r,this.yAxisScale=n}map(t,r){var n,a,{position:s}=r;return{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:0,y:(a=this.yAxisScale.map(t.y,{position:s}))!==null&&a!==void 0?a:0}}mapWithFallback(t,r){var n,a,{position:s,fallback:o}=r,l,c;return o==="rangeMin"?l=this.yAxisScale.rangeMin():o==="rangeMax"?l=this.yAxisScale.rangeMax():l=0,o==="rangeMin"?c=this.xAxisScale.rangeMin():o==="rangeMax"?c=this.xAxisScale.rangeMax():c=0,{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:c,y:(a=this.yAxisScale.map(t.y,{position:s}))!==null&&a!==void 0?a:l}}isInRange(t){var{x:r,y:n}=t,a=r==null||this.xAxisScale.isInRange(r),s=n==null||this.yAxisScale.isInRange(n);return a&&s}}function qF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function HF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qF(Object(r),!0).forEach(function(n){ONe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ONe(e,t,r){return(t=LNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LNe(e){var t=MNe(e,"string");return typeof t=="symbol"?t:t+""}function MNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ow(){return Ow=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ow.apply(null,arguments)}var FNe=(e,t)=>{var r;if(x.isValidElement(e))r=x.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{if(!Vn(t.x1)||!Vn(t.y1)||!Vn(t.x2)||!Vn(t.y2))return null;r=x.createElement("line",Ow({},t,{className:"recharts-reference-line-line"}))}return r},RNe=(e,t,r,n,a,s)=>{var{x:o,width:l}=s,c=a.map(e,{position:r});if(!Vn(c)||t==="discard"&&!a.isInRange(c))return null;var u=[{x:o+l,y:c},{x:o,y:c}];return n==="left"?u.reverse():u},BNe=(e,t,r,n,a,s)=>{var{y:o,height:l}=s,c=a.map(e,{position:r});if(!Vn(c)||t==="discard"&&!a.isInRange(c))return null;var u=[{x:c,y:o+l},{x:c,y:o}];return n==="top"?u.reverse():u},INe=(e,t,r,n)=>{var a=[n.mapWithFallback(e[0],{position:r,fallback:"rangeMin"}),n.mapWithFallback(e[1],{position:r,fallback:"rangeMax"})];return t==="discard"&&a.some(s=>!n.isInRange(s))?null:a},DNe=(e,t,r,n,a,s,o)=>{var{x:l,y:c,segment:u,ifOverflow:d}=o,f=Sc(l),p=Sc(c);return p?RNe(c,d,n,s,t,r):f?BNe(l,d,n,a,e,r):u!=null&&u.length===2?INe(u,d,n,new PNe({x:e,y:t})):null};function $Ne(e){var t=Ua();return x.useEffect(()=>(t(ANe(e)),()=>{t(NNe(e))})),null}function UNe(e){var{xAxisId:t,yAxisId:r,shape:n,className:a,ifOverflow:s}=e,o=js(),l=TNe(),c=tn(A=>Qu(A,t)),u=tn(A=>Ju(A,r)),d=tn(A=>Im(A,"xAxis",t,o)),f=tn(A=>Im(A,"yAxis",r,o)),p=tg();if(!l||!p||c==null||u==null||d==null||f==null)return null;var h=DNe(d,f,p,e.position,c.orientation,u.orientation,e);if(!h)return null;var m=h[0],g=h[1];if(m==null||g==null)return null;var{x:b,y}=m,{x:v,y:w}=g,_=s==="hidden"?"url(#".concat(l,")"):void 0,C=HF(HF({clipPath:_},To(e)),{},{x1:b,y1:y,x2:v,y2:w}),j=SNe({x1:b,y1:y,x2:v,y2:w});return x.createElement(oo,{zIndex:e.zIndex},x.createElement(ui,{className:sa("recharts-reference-line",a)},FNe(n,C),x.createElement(QV,Ow({},j,{lowerWidth:j.width,upperWidth:j.width}),x.createElement(ZV,{label:e.label}),e.children)))}var zNe={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",label:!1,stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:bi.line};function I4(e){var t=di(e,zNe);return x.createElement(x.Fragment,null,x.createElement($Ne,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y,segment:t.segment}),x.createElement(UNe,t))}I4.displayName="ReferenceLine";function kG(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var a=e[n];a!==void 0&&r.push(a)}return r}function WNe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return kNe(n,r)}function qNe(e,t,r){var n=r==="width",{x:a,y:s,width:o,height:l}=e;return t===1?{start:n?a:s,end:n?a+o:s+l}:{start:n?a+o:s+l,end:n?a:s}}function T1(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-a)<=0}function HNe(e,t){return kG(e,t+1)}function VNe(e,t,r,n,a){for(var s=(n||[]).slice(),{start:o,end:l}=t,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:kG(n,u)};var g=c,b,y=()=>(b===void 0&&(b=r(m,g)),b),v=m.coordinate,w=c===0||T1(e,v,y,d,l);w||(c=0,d=o,u+=1),w&&(d=v+e*(y()/2+a),c+=u)},p;u<=s.length;)if(p=f(),p)return p.v;return[]}function GNe(e,t,r,n,a){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=t,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,p=!0,h=function(){var _=n[g];if(_==null)return 0;var C=g,j,A=()=>(j===void 0&&(j=r(_,C)),j),M=_.coordinate,P=g===d||T1(e,M,A,f,c);if(!P)return p=!1,1;P&&(f=M+e*(A()/2+a))},m,g=d;g<o&&(m=h(),!(m!==0&&m===1));g+=u);if(p){for(var b=[],y=d;y<o;y+=u){var v=n[y];v!=null&&b.push(v)}return b}}return[]}function VF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function yo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VF(Object(r),!0).forEach(function(n){KNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KNe(e,t,r){return(t=XNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XNe(e){var t=YNe(e,"string");return typeof t=="symbol"?t:t+""}function YNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QNe(e,t,r,n,a){for(var s=(n||[]).slice(),o=s.length,{start:l}=t,{end:c}=t,u=function(p){var h=s[p];if(h==null)return 1;var m=h,g,b=()=>(g===void 0&&(g=r(h,p)),g);if(p===o-1){var y=e*(m.coordinate+e*b()/2-c);s[p]=m=yo(yo({},m),{},{tickCoord:y>0?m.coordinate-y*e:m.coordinate})}else s[p]=m=yo(yo({},m),{},{tickCoord:m.coordinate});if(m.tickCoord!=null){var v=T1(e,m.tickCoord,b,l,c);v&&(c=m.tickCoord-e*(b()/2+a),s[p]=yo(yo({},m),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function JNe(e,t,r,n,a,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=t;if(s){var d=n[l-1];if(d!=null){var f=r(d,l-1),p=e*(d.coordinate+e*f/2-u);if(o[l-1]=d=yo(yo({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate}),d.tickCoord!=null){var h=T1(e,d.tickCoord,()=>f,c,u);h&&(u=d.tickCoord-e*(f/2+a),o[l-1]=yo(yo({},d),{},{isShow:!0}))}}}for(var m=s?l-1:l,g=function(v){var w=o[v];if(w==null)return 1;var _=w,C,j=()=>(C===void 0&&(C=r(w,v)),C);if(v===0){var A=e*(_.coordinate-e*j()/2-c);o[v]=_=yo(yo({},_),{},{tickCoord:A<0?_.coordinate-A*e:_.coordinate})}else o[v]=_=yo(yo({},_),{},{tickCoord:_.coordinate});if(_.tickCoord!=null){var M=T1(e,_.tickCoord,j,c,u);M&&(c=_.tickCoord+e*(j()/2+a),o[v]=yo(yo({},_),{},{isShow:!0}))}},b=0;b<m;b++)g(b);return o}function t6(e,t,r){var{tick:n,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!a||!a.length||!n)return[];if(an(c)||ZS.isSsr){var p;return(p=HNe(a,an(c)?c:0))!==null&&p!==void 0?p:[]}var h=[],m=l==="top"||l==="bottom"?"width":"height",g=d&&m==="width"?Nx(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},b=(C,j)=>{var A=typeof u=="function"?u(C.value,j):C.value;return m==="width"?WNe(Nx(A,{fontSize:t,letterSpacing:r}),g,f):Nx(A,{fontSize:t,letterSpacing:r})[m]},y=a[0],v=a[1],w=a.length>=2&&y!=null&&v!=null?Ds(v.coordinate-y.coordinate):1,_=qNe(s,w,m);return c==="equidistantPreserveStart"?VNe(w,_,b,a,o):c==="equidistantPreserveEnd"?GNe(w,_,b,a,o):(c==="preserveStart"||c==="preserveStartEnd"?h=JNe(w,_,b,a,o,c==="preserveStartEnd"):h=QNe(w,_,b,a,o),h.filter(C=>C.isShow))}var ZNe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:s=0}=e,o=0;if(t){Array.from(t).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=a+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},eCe=["axisLine","width","height","className","hide","ticks","axisType"];function tCe(e,t){if(e==null)return{};var r,n,a=rCe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function T0(){return T0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},T0.apply(null,arguments)}function GF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GF(Object(r),!0).forEach(function(n){nCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nCe(e,t,r){return(t=aCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aCe(e){var t=iCe(e,"string");return typeof t=="symbol"?t:t+""}function iCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nd={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:bi.axis};function sCe(e){var{x:t,y:r,width:n,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=Pi(Pi(Pi({},c),Ho(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=Pi(Pi({},u),{},{x1:t,y1:r+d*a,x2:t+n,y2:r+d*a})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=Pi(Pi({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+a})}return x.createElement("line",T0({},u,{className:sa("recharts-cartesian-axis-line",k0(l,"className"))}))}function oCe(e,t,r,n,a,s,o,l,c){var u,d,f,p,h,m,g=l?-1:1,b=e.tickSize||o,y=an(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=d=e.coordinate,p=r+ +!l*a,f=p-g*b,m=f-g*c,h=y;break;case"left":f=p=e.coordinate,d=t+ +!l*n,u=d-g*b,h=u-g*c,m=y;break;case"right":f=p=e.coordinate,d=t+ +l*n,u=d+g*b,h=u+g*c,m=y;break;default:u=d=e.coordinate,p=r+ +l*a,f=p+g*b,m=f+g*c,h=y;break}return{line:{x1:u,y1:f,x2:d,y2:p},tick:{x:h,y:m}}}function lCe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function cCe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function uCe(e){var{option:t,tickProps:r,value:n}=e,a,s=sa(r.className,"recharts-cartesian-axis-tick-value");if(x.isValidElement(t))a=x.cloneElement(t,Pi(Pi({},r),{},{className:s}));else if(typeof t=="function")a=t(Pi(Pi({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=sa(o,cG(t))),a=x.createElement(b_,T0({},r,{className:o}),n)}return a}var dCe=x.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:p,y:h,width:m,height:g,tickSize:b,tickMargin:y,fontSize:v,letterSpacing:w,getTicksConfig:_,events:C,axisType:j}=e,A=t6(Pi(Pi({},_),{},{ticks:r}),v,w),M=lCe(d,f),P=cCe(d,f),R=Ho(_),N=ih(n),T={};typeof a=="object"&&(T=a);var B=Pi(Pi({},R),{},{fill:"none"},T),G=A.map(_e=>Pi({entry:_e},oCe(_e,p,h,m,g,d,b,f,y))),re=G.map(_e=>{var{entry:V,line:K}=_e;return x.createElement(ui,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(V.value,"-").concat(V.coordinate,"-").concat(V.tickCoord)},a&&x.createElement("line",T0({},B,K,{className:sa("recharts-cartesian-axis-tick-line",k0(a,"className"))})))}),xe=G.map((_e,V)=>{var K,de,{entry:ne,tick:E}=_e,Z=Pi(Pi(Pi(Pi({verticalAnchor:P},R),{},{textAnchor:M,stroke:"none",fill:s},E),{},{index:V,payload:ne,visibleTicksCount:A.length,tickFormatter:o,padding:c},u),{},{angle:(K=(de=u==null?void 0:u.angle)!==null&&de!==void 0?de:R.angle)!==null&&K!==void 0?K:0}),H=Pi(Pi({},Z),N);return x.createElement(ui,T0({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(ne.value,"-").concat(ne.coordinate,"-").concat(ne.tickCoord)},eg(C,ne,V)),n&&x.createElement(uCe,{option:n,tickProps:H,value:"".concat(typeof o=="function"?o(ne.value,V):ne.value).concat(l||"")}))});return x.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(j,"-ticks")},xe.length>0&&x.createElement(oo,{zIndex:bi.label},x.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(j,"-tick-labels"),ref:t},xe)),re.length>0&&x.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(j,"-tick-lines")},re))}),fCe=x.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:s,hide:o,ticks:l,axisType:c}=e,u=tCe(e,eCe),[d,f]=x.useState(""),[p,h]=x.useState(""),m=x.useRef(null);x.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var b;return ZNe({ticks:m.current,label:(b=e.labelRef)===null||b===void 0?void 0:b.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=x.useCallback(b=>{if(b){var y=b.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=y;var v=y[0];if(v){var w=window.getComputedStyle(v),_=w.fontSize,C=w.letterSpacing;(_!==d||C!==p)&&(f(_),h(C))}}},[d,p]);return o||n!=null&&n<=0||a!=null&&a<=0?null:x.createElement(oo,{zIndex:e.zIndex},x.createElement(ui,{className:sa("recharts-cartesian-axis",s)},x.createElement(sCe,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Ho(e)}),x.createElement(dCe,{ref:g,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:p,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),x.createElement(QV,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},x.createElement(ZV,{label:e.label,labelRef:e.labelRef}),e.children)))}),r6=x.forwardRef((e,t)=>{var r=di(e,Nd);return x.createElement(fCe,T0({},r,{ref:t}))});r6.displayName="CartesianAxis";var hCe=["x1","y1","x2","y2","key"],pCe=["offset"],mCe=["xAxisId","yAxisId"],gCe=["xAxisId","yAxisId"];function KF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function _o(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KF(Object(r),!0).forEach(function(n){xCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xCe(e,t,r){return(t=yCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yCe(e){var t=bCe(e,"string");return typeof t=="symbol"?t:t+""}function bCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gh(){return Gh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gh.apply(null,arguments)}function Lw(e,t){if(e==null)return{};var r,n,a=vCe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wCe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:s,height:o,ry:l}=e;return x.createElement("rect",{x:n,y:a,ry:l,width:s,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function jG(e){var{option:t,lineItemProps:r}=e,n;if(x.isValidElement(t))n=x.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var a,{x1:s,y1:o,x2:l,y2:c,key:u}=r,d=Lw(r,hCe),f=(a=Ho(d))!==null&&a!==void 0?a:{},{offset:p}=f,h=Lw(f,pCe);n=x.createElement("line",Gh({},h,{x1:s,y1:o,x2:l,y2:c,fill:"none",key:u}))}return n}function SCe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Lw(e,mCe),c=a.map((u,d)=>{var f=_o(_o({},l),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return x.createElement(jG,{key:"line-".concat(d),option:n,lineItemProps:f})});return x.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function _Ce(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Lw(e,gCe),c=a.map((u,d)=>{var f=_o(_o({},l),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return x.createElement(jG,{option:n,lineItemProps:f,key:"line-".concat(d)})});return x.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function kCe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:s,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var u=l.map(f=>Math.round(f+a-a)).sort((f,p)=>f-p);a!==u[0]&&u.unshift(0);var d=u.map((f,p)=>{var h=u[p+1],m=h==null,g=m?a+o-f:h-f;if(g<=0)return null;var b=p%t.length;return x.createElement("rect",{key:"react-".concat(p),y:f,x:n,height:g,width:s,stroke:"none",fill:t[b],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function jCe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:s,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+a-a)).sort((f,p)=>f-p);a!==u[0]&&u.unshift(0);var d=u.map((f,p)=>{var h=u[p+1],m=h==null,g=m?a+o-f:h-f;if(g<=0)return null;var b=p%r.length;return x.createElement("rect",{key:"react-".concat(p),x:f,y:s,width:g,height:l,stroke:"none",fill:r[b],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var ACe=(e,t)=>{var{xAxis:r,width:n,height:a,offset:s}=e;return aq(t6(_o(_o(_o({},Nd),r),{},{ticks:iq(r),viewBox:{x:0,y:0,width:n,height:a}})),s.left,s.left+s.width,t)},NCe=(e,t)=>{var{yAxis:r,width:n,height:a,offset:s}=e;return aq(t6(_o(_o(_o({},Nd),r),{},{ticks:iq(r),viewBox:{x:0,y:0,width:n,height:a}})),s.top,s.top+s.height,t)},CCe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:bi.grid};function ky(e){var t=PC(),r=OC(),n=pq(),a=_o(_o({},di(e,CCe)),{},{x:an(e.x)?e.x:n.left,y:an(e.y)?e.y:n.top,width:an(e.width)?e.width:n.width,height:an(e.height)?e.height:n.height}),{xAxisId:s,yAxisId:o,x:l,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:p,verticalValues:h}=a,m=js(),g=tn(P=>H7(P,"xAxis",s,m)),b=tn(P=>H7(P,"yAxis",o,m));if(!qu(u)||!qu(d)||!an(l)||!an(c))return null;var y=a.verticalCoordinatesGenerator||ACe,v=a.horizontalCoordinatesGenerator||NCe,{horizontalPoints:w,verticalPoints:_}=a;if((!w||!w.length)&&typeof v=="function"){var C=p&&p.length,j=v({yAxis:b?_o(_o({},b),{},{ticks:C?p:b.ticks}):void 0,width:t??u,height:r??d,offset:n},C?!0:f);aw(Array.isArray(j),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(w=j)}if((!_||!_.length)&&typeof y=="function"){var A=h&&h.length,M=y({xAxis:g?_o(_o({},g),{},{ticks:A?h:g.ticks}):void 0,width:t??u,height:r??d,offset:n},A?!0:f);aw(Array.isArray(M),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof M,"]")),Array.isArray(M)&&(_=M)}return x.createElement(oo,{zIndex:a.zIndex},x.createElement("g",{className:"recharts-cartesian-grid"},x.createElement(wCe,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),x.createElement(kCe,Gh({},a,{horizontalPoints:w})),x.createElement(jCe,Gh({},a,{verticalPoints:_})),x.createElement(SCe,Gh({},a,{offset:n,horizontalPoints:w,xAxis:g,yAxis:b})),x.createElement(_Ce,Gh({},a,{offset:n,verticalPoints:_,xAxis:g,yAxis:b}))))}ky.displayName="CartesianGrid";var ECe={},AG=yl({name:"errorBars",initialState:ECe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?a:s))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:eLe,replaceErrorBar:tLe,removeErrorBar:rLe}=AG.actions,TCe=AG.reducer,PCe=["children"];function OCe(e,t){if(e==null)return{};var r,n,a=LCe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function LCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var MCe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},FCe=x.createContext(MCe);function n6(e){var{children:t}=e,r=OCe(e,PCe);return x.createElement(FCe.Provider,{value:r},t)}function $_(e,t){var r,n,a=tn(u=>Qu(u,e)),s=tn(u=>Ju(u,t)),o=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:Ps.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:Os.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function a6(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=e6(),{needClipX:s,needClipY:o,needClip:l}=$_(t,r);if(!l||!a)return null;var{x:c,y:u,width:d,height:f}=a;return x.createElement("clipPath",{id:"clipPath-".concat(n)},x.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var NG=(e,t,r,n)=>Gu(e,"xAxis",t,n),CG=(e,t,r,n)=>Vu(e,"xAxis",t,n),EG=(e,t,r,n)=>Gu(e,"yAxis",r,n),TG=(e,t,r,n)=>Vu(e,"yAxis",r,n),RCe=Kt([pa,NG,EG,CG,TG],(e,t,r,n,a)=>Yd(e,"xAxis")?Om(t,n,!1):Om(r,a,!1)),BCe=(e,t,r,n,a)=>a;function ICe(e){return e.type==="line"}var DCe=Kt([xy,BCe],(e,t)=>e.filter(ICe).find(r=>r.id===t)),$Ce=Kt([pa,NG,EG,CG,TG,DCe,RCe,o_],(e,t,r,n,a,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=l;if(!(s==null||t==null||r==null||n==null||a==null||n.length===0||a.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:f,data:p}=s,h;if(p!=null&&p.length>0?h=p:h=c==null?void 0:c.slice(u,d+1),h!=null)return PEe({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:a,dataKey:f,bandSize:o,displayedData:h})}});function UCe(e){var t=ih(e),r=3,n=2;if(t!=null){var{r:a,strokeWidth:s}=t,o=Number(a),l=Number(s);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(l)||l<0)&&(l=n),{r:o,strokeWidth:l}}return{r,strokeWidth:n}}var zCe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jy=x;function WCe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var qCe=typeof Object.is=="function"?Object.is:WCe,HCe=jy.useSyncExternalStore,VCe=jy.useRef,GCe=jy.useEffect,KCe=jy.useMemo,XCe=jy.useDebugValue;zCe.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var s=VCe(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=KCe(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),a!==void 0&&o.hasValue){var m=o.value;if(a(m,h))return f=m}return f=h}if(m=f,qCe(d,h))return m;var g=n(h);return a!==void 0&&a(m,g)?(d=h,m):(d=h,f=g)}var u=!1,d,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,a]);var l=HCe(e,s[0],s[1]);return GCe(function(){o.hasValue=!0,o.value=l},[l]),XCe(l),l};function YCe(e){e()}function QCe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){YCe(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var XF={notify(){},get:()=>[]};function JCe(e,t){let r,n=XF,a=0,s=!1;function o(g){d();const b=n.subscribe(g);let y=!1;return()=>{y||(y=!0,b(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){a++,r||(r=e.subscribe(c),n=QCe())}function f(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=XF)}function p(){s||(s=!0,d())}function h(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:h,getListeners:()=>n};return m}var ZCe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",eEe=ZCe(),tEe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",rEe=tEe(),nEe=()=>eEe||rEe?x.useLayoutEffect:x.useEffect,aEe=nEe();function YF(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function iEe(e,t){if(YF(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!YF(e[r[a]],t[r[a]]))return!1;return!0}var Yk=Symbol.for("react-redux-context"),Qk=typeof globalThis<"u"?globalThis:{};function sEe(){if(!x.createContext)return{};const e=Qk[Yk]??(Qk[Yk]=new Map);let t=e.get(x.createContext);return t||(t=x.createContext(null),e.set(x.createContext,t)),t}var oEe=sEe();function lEe(e){const{children:t,context:r,serverState:n,store:a}=e,s=x.useMemo(()=>{const c=JCe(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),o=x.useMemo(()=>a.getState(),[a]);aEe(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||oEe;return x.createElement(l.Provider,{value:s},t)}var cEe=lEe,uEe=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function dEe(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function Ay(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(uEe.has(n)){if(e[n]==null&&t[n]==null)continue;if(!iEe(e[n],t[n]))return!1}else if(!dEe(e[n],t[n]))return!1;return!0}var fEe=["id"],hEe=["type","layout","connectNulls","needClip","shape"],pEe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function P1(){return P1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P1.apply(null,arguments)}function QF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QF(Object(r),!0).forEach(function(n){mEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mEe(e,t,r){return(t=gEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gEe(e){var t=xEe(e,"string");return typeof t=="symbol"?t:t+""}function xEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i6(e,t){if(e==null)return{};var r,n,a=yEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function yEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bEe=e=>{var{dataKey:t,name:r,stroke:n,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:n,value:gh(r,t),payload:e}]},vEe=x.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:a,fill:s,name:o,hide:l,unit:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:r,getPosition:K0,settings:{stroke:n,strokeWidth:a,fill:s,dataKey:t,nameKey:void 0,name:gh(o,t),hide:l,type:u,color:n,unit:c,graphicalItemId:d}};return x.createElement(B_,{tooltipEntrySettings:f})}),PG=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function wEe(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],a=0;a<t;++a)n=[...n,...r];return n}var SEe=(e,t,r)=>{var n=r.reduce((h,m)=>h+m);if(!n)return PG(t,e);for(var a=Math.floor(e/n),s=e%n,o=t-e,l=[],c=0,u=0;c<r.length;u+=(d=r[c])!==null&&d!==void 0?d:0,++c){var d,f=r[c];if(f!=null&&u+f>s){l=[...r.slice(0,c),s-u];break}}var p=l.length%2===0?[0,o]:[o];return[...wEe(r,a),...l,...p].map(h=>"".concat(h,"px")).join(", ")};function _Ee(e){var{clipPathId:t,points:r,props:n}=e,{dot:a,dataKey:s,needClip:o}=n,{id:l}=n,c=i6(n,fEe),u=Ho(c);return x.createElement(U3e,{points:r,dot:a,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:u,needClip:o,clipPathId:t})}function kEe(e){var{showLabels:t,children:r,points:n}=e,a=x.useMemo(()=>n==null?void 0:n.map(s=>{var o,l,c={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Pu(Pu({},c),{},{value:s.value,payload:s.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[n]);return x.createElement(VE,{value:t?a:void 0},r)}function JF(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:a,props:s}=e,{type:o,layout:l,connectNulls:c,needClip:u,shape:d}=s,f=i6(s,hEe),p=Pu(Pu({},To(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:o,layout:l,connectNulls:c,strokeDasharray:a??s.strokeDasharray});return x.createElement(x.Fragment,null,(n==null?void 0:n.length)>1&&x.createElement(E1,P1({shapeType:"curve",option:d},p,{pathRef:r})),x.createElement(_Ee,{points:n,clipPathId:t,props:s}))}function jEe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function AEe(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:a,longestAnimatedLengthRef:s}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:p,width:h,height:m,onAnimationEnd:g,onAnimationStart:b}=r,y=a.current,v=ng(o,"recharts-line-"),w=x.useRef(v),[_,C]=x.useState(!1),j=!_,A=x.useCallback(()=>{typeof g=="function"&&g(),C(!1)},[g]),M=x.useCallback(()=>{typeof b=="function"&&b(),C(!0)},[b]),P=jEe(n.current),R=x.useRef(0);w.current!==v&&(R.current=s.current,w.current=v);var N=R.current;return x.createElement(kEe,{points:o,showLabels:j},r.children,x.createElement(rg,{animationId:v,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:A,onAnimationStart:M,key:v},T=>{var B=Ia(N,P+N,T),G=Math.min(B,P),re;if(c)if(l){var xe="".concat(l).split(/[,\s]+/gim).map(K=>parseFloat(K));re=SEe(G,P,xe)}else re=PG(P,G);else re=l==null?void 0:String(l);if(T>0&&P>0&&(a.current=o,s.current=Math.max(s.current,G)),y){var _e=y.length/o.length,V=T===1?o:o.map((K,de)=>{var ne=Math.floor(de*_e);if(y[ne]){var E=y[ne];return Pu(Pu({},K),{},{x:Ia(E.x,K.x,T),y:Ia(E.y,K.y,T)})}return p?Pu(Pu({},K),{},{x:Ia(h*2,K.x,T),y:Ia(m/2,K.y,T)}):Pu(Pu({},K),{},{x:K.x,y:K.y})});return a.current=V,x.createElement(JF,{props:r,points:V,clipPathId:t,pathRef:n,strokeDasharray:re})}return x.createElement(JF,{props:r,points:o,clipPathId:t,pathRef:n,strokeDasharray:re})}),x.createElement(v_,{label:r.label}))}function NEe(e){var{clipPathId:t,props:r}=e,n=x.useRef(null),a=x.useRef(0),s=x.useRef(null);return x.createElement(AEe,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:a,pathRef:s})}var CEe=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:fa(e.payload,t)}};class EEe extends x.Component{render(){var{hide:t,dot:r,points:n,className:a,xAxisId:s,yAxisId:o,top:l,left:c,width:u,height:d,id:f,needClip:p,zIndex:h}=this.props;if(t)return null;var m=sa("recharts-line",a),g=f,{r:b,strokeWidth:y}=UCe(r),v=pG(r),w=b*2+y,_=p?"url(#clipPath-".concat(v?"":"dots-").concat(g,")"):void 0;return x.createElement(oo,{zIndex:h},x.createElement(ui,{className:m},p&&x.createElement("defs",null,x.createElement(a6,{clipPathId:g,xAxisId:s,yAxisId:o}),!v&&x.createElement("clipPath",{id:"clipPath-dots-".concat(g)},x.createElement("rect",{x:c-w/2,y:l-w/2,width:u+w,height:d+w}))),x.createElement(n6,{xAxisId:s,yAxisId:o,data:n,dataPointFormatter:CEe,errorBarOffset:0},x.createElement(NEe,{props:this.props,clipPathId:g}))),x.createElement(uNe,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:_}))}}var OG={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:bi.line,type:"linear"};function TEe(e){var t=di(e,OG),{activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:s,animationEasing:o,connectNulls:l,dot:c,hide:u,isAnimationActive:d,label:f,legendType:p,xAxisId:h,yAxisId:m,id:g}=t,b=i6(t,pEe),{needClip:y}=$_(h,m),v=e6(),w=X0(),_=js(),C=tn(R=>$Ce(R,h,m,_,g));if(w!=="horizontal"&&w!=="vertical"||C==null||v==null)return null;var{height:j,width:A,x:M,y:P}=v;return x.createElement(EEe,P1({},b,{id:g,connectNulls:l,dot:c,activeDot:r,animateNewValues:n,animationBegin:a,animationDuration:s,animationEasing:o,isAnimationActive:d,hide:u,label:f,legendType:p,xAxisId:h,yAxisId:m,points:C,layout:w,height:j,width:A,left:M,top:P,needClip:y}))}function PEe(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,dataKey:o,bandSize:l,displayedData:c}=e;return c.map((u,d)=>{var f=fa(u,o);if(t==="horizontal"){var p=nw({axis:r,ticks:a,bandSize:l,entry:u,index:d}),h=Da(f)?null:n.scale.map(f);return{x:p,y:h??null,value:f,payload:u}}var m=Da(f)?null:r.scale.map(f),g=nw({axis:n,ticks:s,bandSize:l,entry:u,index:d});return m==null||g==null?null:{x:m,y:g,value:f,payload:u}}).filter(Boolean)}function OEe(e){var t=di(e,OG),r=js();return x.createElement(I_,{id:t.id,type:"line"},n=>x.createElement(x.Fragment,null,x.createElement(JE,{legendPayload:bEe(t)}),x.createElement(vEe,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),x.createElement(ZE,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),x.createElement(TEe,P1({},t,{id:n}))))}var LG=x.memo(OEe,Ay);LG.displayName="Line";function Z0(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:yG}function ep(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:yG}var LEe="Invariant failed";function MEe(e,t){throw new Error(LEe)}function D4(){return D4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D4.apply(null,arguments)}function Mw(e){return x.createElement(E1,D4({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var FEe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(an(t))return t;var s=an(n)||Da(n);return s?t(n,a):(s||MEe(),r)}},REe=(e,t,r)=>r,BEe=(e,t)=>t,Ny=Kt([xy,BEe],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),IEe=Kt([Ny],e=>e==null?void 0:e.maxBarSize),DEe=(e,t,r,n)=>n,$Ee=Kt([pa,xy,Z0,ep,REe],(e,t,r,n,a)=>t.filter(s=>e==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),UEe=(e,t,r)=>{var n=pa(e),a=Z0(e,t),s=ep(e,t);if(!(a==null||s==null))return n==="horizontal"?P4(e,"yAxis",s,r):P4(e,"xAxis",a,r)},zEe=(e,t)=>{var r=pa(e),n=Z0(e,t),a=ep(e,t);if(!(n==null||a==null))return r==="horizontal"?q7(e,"xAxis",n):q7(e,"yAxis",a)},WEe=Kt([$Ee,z_e,zEe],dNe),qEe=(e,t,r)=>{var n,a,s=Ny(e,t);if(s==null)return 0;var o=Z0(e,t),l=ep(e,t);if(o==null||l==null)return 0;var c=pa(e),u=PH(e),{maxBarSize:d}=s,f=Da(d)?u:d,p,h;return c==="horizontal"?(p=Gu(e,"xAxis",o,r),h=Vu(e,"xAxis",o,r)):(p=Gu(e,"yAxis",l,r),h=Vu(e,"yAxis",l,r)),(n=(a=Om(p,h,!0))!==null&&a!==void 0?a:f)!==null&&n!==void 0?n:0},MG=(e,t,r)=>{var n=pa(e),a=Z0(e,t),s=ep(e,t);if(!(a==null||s==null)){var o,l;return n==="horizontal"?(o=Gu(e,"xAxis",a,r),l=Vu(e,"xAxis",a,r)):(o=Gu(e,"yAxis",s,r),l=Vu(e,"yAxis",s,r)),Om(o,l)}},HEe=Kt([WEe,PH,U_e,OH,qEe,MG,IEe],gNe),VEe=(e,t,r)=>{var n=Z0(e,t);if(n!=null)return Gu(e,"xAxis",n,r)},GEe=(e,t,r)=>{var n=ep(e,t);if(n!=null)return Gu(e,"yAxis",n,r)},KEe=(e,t,r)=>{var n=Z0(e,t);if(n!=null)return Vu(e,"xAxis",n,r)},XEe=(e,t,r)=>{var n=ep(e,t);if(n!=null)return Vu(e,"yAxis",n,r)},YEe=Kt([HEe,Ny],yNe),QEe=Kt([UEe,Ny],xNe),JEe=Kt([ks,CC,VEe,GEe,KEe,XEe,YEe,pa,L_e,MG,QEe,Ny,DEe],(e,t,r,n,a,s,o,l,c,u,d,f,p)=>{var{chartData:h,dataStartIndex:m,dataEndIndex:g}=c;if(!(f==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||a==null||s==null||u==null)){var{data:b}=f,y;if(b!=null&&b.length>0?y=b:y=h==null?void 0:h.slice(m,g+1),y!=null)return A6e({layout:l,barSettings:f,pos:o,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:s,stackedData:d,displayedData:y,offset:e,cells:p,dataStartIndex:m})}}),ZEe=["index"];function $4(){return $4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$4.apply(null,arguments)}function e6e(e,t){if(e==null)return{};var r,n,a=t6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function t6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var FG=x.createContext(void 0),r6e=e=>{var t=x.useContext(FG);if(t!=null)return t.stackId;if(e!=null)return Fbe(e)},n6e=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),a6e=e=>{var t=x.useContext(FG);if(t!=null){var{stackId:r}=t;return"url(#".concat(n6e(r,e),")")}},RG=e=>{var{index:t}=e,r=e6e(e,ZEe),n=a6e(t);return x.createElement(ui,$4({className:"recharts-bar-stack-layer",clipPath:n},r))},i6e=["onMouseEnter","onMouseLeave","onClick"],s6e=["value","background","tooltipPosition"],o6e=["id"],l6e=["onMouseEnter","onClick","onMouseLeave"];function zd(){return zd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zd.apply(null,arguments)}function ZF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $o(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZF(Object(r),!0).forEach(function(n){c6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c6e(e,t,r){return(t=u6e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u6e(e){var t=d6e(e,"string");return typeof t=="symbol"?t:t+""}function d6e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fw(e,t){if(e==null)return{};var r,n,a=f6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function f6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var h6e=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:n,value:gh(r,t),payload:e}]},p6e=x.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:s,hide:o,unit:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:void 0,getPosition:K0,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:gh(s,t),hide:o,type:c,color:a,unit:l,graphicalItemId:u}};return x.createElement(B_,{tooltipEntrySettings:d})});function m6e(e){var t=tn(Ud),{data:r,dataKey:n,background:a,allOtherBarProps:s}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=Fw(s,i6e),d=M_(o,n,s.id),f=F_(l),p=R_(c,n,s.id);if(!a||r==null)return null;var h=ih(a);return x.createElement(oo,{zIndex:bNe(a,bi.barBackground)},r.map((m,g)=>{var{value:b,background:y,tooltipPosition:v}=m,w=Fw(m,s6e);if(!y)return null;var _=d(m,g),C=f(m,g),j=p(m,g),A=$o($o($o($o($o({option:a,isActive:String(g)===t},w),{},{fill:"#eee"},y),h),eg(u,m,g)),{},{onMouseEnter:_,onMouseLeave:C,onClick:j,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return x.createElement(Mw,zd({key:"background-bar-".concat(g)},A))}))}function g6e(e){var{showLabels:t,children:r,rects:n}=e,a=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return $o($o({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return x.createElement(VE,{value:t?a:void 0},r)}function x6e(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:s,dataKey:o}=e,l=tn(Ud),c=tn($E),u=r&&String(s)===l&&(c==null||o===c),d=u?r:t;return u?x.createElement(oo,{zIndex:bi.activeBar},x.createElement(RG,{index:s},x.createElement(Mw,zd({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o})))):x.createElement(Mw,zd({},n,{name:String(n.name)},a,{isActive:u,option:d,index:s,dataKey:o}))}function y6e(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:s}=e;return x.createElement(Mw,zd({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:s}))}function b6e(e){var t,{data:r,props:n}=e,a=(t=Ho(n))!==null&&t!==void 0?t:{},{id:s}=a,o=Fw(a,o6e),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:p}=n,h=Fw(n,l6e),m=M_(d,c,s),g=F_(p),b=R_(f,c,s);return r?x.createElement(x.Fragment,null,r.map((y,v)=>x.createElement(RG,zd({index:v,key:"rectangle-".concat(y==null?void 0:y.x,"-").concat(y==null?void 0:y.y,"-").concat(y==null?void 0:y.value,"-").concat(v),className:"recharts-bar-rectangle"},eg(h,y,v),{onMouseEnter:m(y,v),onMouseLeave:g(y,v),onClick:b(y,v)}),u?x.createElement(x6e,{shape:l,activeBar:u,baseProps:o,entry:y,index:v,dataKey:c}):x.createElement(y6e,{shape:l,baseProps:o,entry:y,index:v,dataKey:c})))):null}function v6e(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,p=ng(t,"recharts-bar-"),[h,m]=x.useState(!1),g=!h,b=x.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),y=x.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return x.createElement(g6e,{showLabels:g,rects:n},x.createElement(rg,{animationId:p,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:b,onAnimationStart:y,key:p},v=>{var w=v===1?n:n==null?void 0:n.map((_,C)=>{var j=f&&f[C];if(j)return $o($o({},_),{},{x:Ia(j.x,_.x,v),y:Ia(j.y,_.y,v),width:Ia(j.width,_.width,v),height:Ia(j.height,_.height,v)});if(a==="horizontal"){var A=Ia(0,_.height,v),M=Ia(_.stackedBarStart,_.y,v);return $o($o({},_),{},{y:M,height:A})}var P=Ia(0,_.width,v),R=Ia(_.stackedBarStart,_.x,v);return $o($o({},_),{},{width:P,x:R})});return v>0&&(r.current=w??null),w==null?null:x.createElement(ui,null,x.createElement(b6e,{props:t,data:w}))}),x.createElement(v_,{label:t.label}),t.children)}function w6e(e){var t=x.useRef(null);return x.createElement(v6e,{previousRectanglesRef:t,props:e})}var BG=0,S6e=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:fa(e,t)}};class _6e extends x.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(t||r==null)return null;var d=sa("recharts-bar",a),f=u;return x.createElement(ui,{className:d,id:u},l&&x.createElement("defs",null,x.createElement(a6,{clipPathId:f,xAxisId:s,yAxisId:o})),x.createElement(ui,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},x.createElement(m6e,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),x.createElement(w6e,this.props)))}}var k6e={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:BG,xAxisId:0,yAxisId:0,zIndex:bi.bar};function j6e(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:f}=$_(t,r),p=X0(),h=js(),m=L_(e.children,J0),g=tn(v=>JEe(v,e.id,h,m));if(p!=="vertical"&&p!=="horizontal")return null;var b,y=g==null?void 0:g[0];return y==null||y.height==null||y.width==null?b=0:b=p==="vertical"?y.height/2:y.width/2,x.createElement(n6,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:S6e,errorBarOffset:b},x.createElement(_6e,zd({},e,{layout:p,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function A6e(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:p,cells:h,parentViewBox:m,dataStartIndex:g}=e,b=t==="horizontal"?l:o,y=d?b.scale.domain():null,v=Rbe({numericAxis:b}),w=b.scale.map(v);return f.map((_,C)=>{var j,A,M,P,R,N;if(d){var T=d[C+g];if(T==null)return null;j=Tbe(T,y)}else j=fa(_,r),Array.isArray(j)||(j=[v,j]);var B=FEe(n,BG)(j[1],C);if(t==="horizontal"){var G,re=l.scale.map(j[0]),xe=l.scale.map(j[1]);if(re==null||xe==null)return null;A=QL({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:_,index:C}),M=(G=xe??re)!==null&&G!==void 0?G:void 0,P=a.size;var _e=re-xe;if(R=Wu(_e)?0:_e,N={x:A,y:p.top,width:P,height:p.height},Math.abs(B)>0&&Math.abs(R)<Math.abs(B)){var V=Ds(R||B)*(Math.abs(B)-Math.abs(R));M-=V,R+=V}}else{var K=o.scale.map(j[0]),de=o.scale.map(j[1]);if(K==null||de==null)return null;if(A=K,M=QL({axis:l,ticks:u,bandSize:s,offset:a.offset,entry:_,index:C}),P=de-K,R=a.size,N={x:p.left,y:M,width:p.width,height:R},Math.abs(B)>0&&Math.abs(P)<Math.abs(B)){var ne=Ds(P||B)*(Math.abs(B)-Math.abs(P));P+=ne}}if(A==null||M==null||P==null||R==null)return null;var E=$o($o({},_),{},{stackedBarStart:w,x:A,y:M,width:P,height:R,value:d?j:j[1],payload:_,background:N,tooltipPosition:{x:A+P/2,y:M+R/2},parentViewBox:m},h&&h[C]&&h[C].props);return E}).filter(Boolean)}function N6e(e){var t=di(e,k6e),r=r6e(t.stackId),n=js();return x.createElement(I_,{id:t.id,type:"bar"},a=>x.createElement(x.Fragment,null,x.createElement(JE,{legendPayload:h6e(t)}),x.createElement(p6e,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:a}),x.createElement(ZE,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),x.createElement(oo,{zIndex:t.zIndex},x.createElement(j6e,zd({},t,{id:a})))))}var Cx=x.memo(N6e,Ay);Cx.displayName="Bar";var C6e=["option","isActive"];function Ex(){return Ex=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ex.apply(null,arguments)}function E6e(e,t){if(e==null)return{};var r,n,a=T6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function T6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function P6e(e){var{option:t,isActive:r}=e,n=E6e(e,C6e);return typeof t=="string"?x.createElement(E1,Ex({option:x.createElement(PS,Ex({type:t},n)),isActive:r,shapeType:"symbols"},n)):x.createElement(E1,Ex({option:t,isActive:r,shapeType:"symbols"},n))}var O6e=(e,t,r,n,a,s,o)=>Gu(e,"xAxis",t,o),L6e=(e,t,r,n,a,s,o)=>Vu(e,"xAxis",t,o),M6e=(e,t,r,n,a,s,o)=>Gu(e,"yAxis",r,o),F6e=(e,t,r,n,a,s,o)=>Vu(e,"yAxis",r,o),R6e=(e,t,r,n)=>G5e(e,"zAxis",n,!1),B6e=(e,t,r,n,a)=>a,I6e=(e,t,r,n,a,s)=>s,D6e=(e,t,r,n,a,s,o)=>o_(e,void 0,void 0,o),$6e=Kt([xy,B6e],(e,t)=>e.filter(r=>r.type==="scatter").find(r=>r.id===t)),U6e=Kt([D6e,O6e,L6e,M6e,F6e,R6e,$6e,I6e],(e,t,r,n,a,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=e;if(o!=null){var f;if((o==null?void 0:o.data)!=null&&o.data.length>0?f=o.data:f=c==null?void 0:c.slice(u,d+1),!(f==null||t==null||n==null||r==null||a==null||(r==null?void 0:r.length)===0||(a==null?void 0:a.length)===0))return tTe({displayedData:f,xAxis:t,yAxis:n,zAxis:s,scatterSettings:o,xAxisTicks:r,yAxisTicks:a,cells:l})}}),z6e=["id"],W6e=["onMouseEnter","onClick","onMouseLeave"],q6e=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function U4(e,t){if(e==null)return{};var r,n,a=H6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function H6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function P0(){return P0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},P0.apply(null,arguments)}function eR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eR(Object(r),!0).forEach(function(n){V6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function V6e(e,t,r){return(t=G6e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G6e(e){var t=K6e(e,"string");return typeof t=="symbol"?t:t+""}function K6e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var X6e=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:n,value:gh(r,t),payload:e}]},Y6e=x.memo(e=>{var{dataKey:t,points:r,stroke:n,strokeWidth:a,fill:s,name:o,hide:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:r==null?void 0:r.map(f=>f.tooltipPayload),getPosition:f=>{var p;return r==null||(p=r[Number(f)])===null||p===void 0?void 0:p.tooltipPosition},settings:{stroke:n,strokeWidth:a,fill:s,nameKey:void 0,dataKey:t,name:gh(o,t),hide:l,type:c,color:s,unit:"",graphicalItemId:u}};return x.createElement(B_,{tooltipEntrySettings:d})});function Q6e(e){var{points:t,props:r}=e,{line:n,lineType:a,lineJointType:s}=r;if(!n)return null;var o=Ho(r),l=ih(n),c,u;if(a==="joint")c=t.map(b=>{var y,v;return{x:(y=b.cx)!==null&&y!==void 0?y:null,y:(v=b.cy)!==null&&v!==void 0?v:null}});else if(a==="fitting"){var{xmin:d,xmax:f,a:p,b:h}=x1e(t),m=b=>p*b+h;c=[{x:d,y:m(d)},{x:f,y:m(f)}]}var g=cl(cl(cl({},o),{},{fill:"none",stroke:o&&o.fill},l),{},{points:c});return x.isValidElement(n)?u=x.cloneElement(n,g):typeof n=="function"?u=n(g):u=x.createElement(JS,P0({},g,{type:s})),x.createElement(ui,{className:"recharts-scatter-line",key:"recharts-scatter-line"},u)}function J6e(e){var{showLabels:t,points:r,children:n}=e,a=tg(),s=x.useMemo(()=>r==null?void 0:r.map(o=>{var l,c,u={x:(l=o.x)!==null&&l!==void 0?l:0,y:(c=o.y)!==null&&c!==void 0?c:0,width:o.width,height:o.height,lowerWidth:o.width,upperWidth:o.width};return cl(cl({},u),{},{value:void 0,payload:o.payload,viewBox:u,parentViewBox:a,fill:void 0})}),[a,r]);return x.createElement(VE,{value:t?s:void 0},n)}function Z6e(e){var{points:t,allOtherScatterProps:r}=e,{shape:n,activeShape:a,dataKey:s}=r,{id:o}=r,l=U4(r,z6e),c=tn(Ud),{onMouseEnter:u,onClick:d,onMouseLeave:f}=r,p=U4(r,W6e),h=M_(u,s,o),m=F_(f),g=R_(d,s,o);if(!E1e(t))return null;var b=Ho(l);return x.createElement(x.Fragment,null,x.createElement(Q6e,{points:t,props:l}),t.map((y,v)=>{var w=a!=null&&a!==!1,_=w&&c===String(v),C=w&&_?a:n,j=cl(cl(cl({},b),y),{},{index:v,[NC]:String(o)});return x.createElement(oo,{key:"symbol-".concat(y==null?void 0:y.cx,"-").concat(y==null?void 0:y.cy,"-").concat(y==null?void 0:y.size,"-").concat(v),zIndex:_?bi.activeDot:void 0},x.createElement(ui,P0({className:"recharts-scatter-symbol"},eg(p,y,v),{onMouseEnter:h(y,v),onMouseLeave:m(y,v),onClick:g(y,v)}),x.createElement(P6e,P0({option:C,isActive:_},j))))}))}function eTe(e){var{previousPointsRef:t,props:r}=e,{points:n,isAnimationActive:a,animationBegin:s,animationDuration:o,animationEasing:l}=r,c=t.current,u=ng(r,"recharts-scatter-"),[d,f]=x.useState(!1),p=x.useCallback(()=>{f(!1)},[]),h=x.useCallback(()=>{f(!0)},[]),m=!d;return x.createElement(J6e,{showLabels:m,points:n},r.children,x.createElement(rg,{animationId:u,begin:s,duration:o,isActive:a,easing:l,onAnimationEnd:p,onAnimationStart:h,key:u},g=>{var b=g===1?n:n==null?void 0:n.map((y,v)=>{var w=c&&c[v];return w?cl(cl({},y),{},{cx:y.cx==null?void 0:Ia(w.cx,y.cx,g),cy:y.cy==null?void 0:Ia(w.cy,y.cy,g),size:Ia(w.size,y.size,g)}):cl(cl({},y),{},{size:Ia(0,y.size,g)})});return g>0&&(t.current=b),x.createElement(ui,null,x.createElement(Z6e,{points:b,allOtherScatterProps:r,showLabels:m}))}),x.createElement(v_,{label:r.label}))}function tTe(e){var{displayedData:t,xAxis:r,yAxis:n,zAxis:a,scatterSettings:s,xAxisTicks:o,yAxisTicks:l,cells:c}=e,u=Da(r.dataKey)?s.dataKey:r.dataKey,d=Da(n.dataKey)?s.dataKey:n.dataKey,f=a&&a.dataKey,p=a?a.range:wd.range,h=p&&p[0],m=r.scale.bandwidth?r.scale.bandwidth():0,g=n.scale.bandwidth?n.scale.bandwidth():0;return t.map((b,y)=>{var v=fa(b,u),w=fa(b,d),_=!Da(f)&&fa(b,f)||"-",C=[{name:Da(r.dataKey)?s.name:r.name||String(r.dataKey),unit:r.unit||"",value:v,payload:b,dataKey:u,type:s.tooltipType},{name:Da(n.dataKey)?s.name:n.name||String(n.dataKey),unit:n.unit||"",value:w,payload:b,dataKey:d,type:s.tooltipType}];_!=="-"&&a!=null&&C.push({name:a.name||a.dataKey,unit:a.unit||"",value:_,payload:b,dataKey:f,type:s.tooltipType});var j=nw({axis:r,ticks:o,bandSize:m,entry:b,index:y,dataKey:u}),A=nw({axis:n,ticks:l,bandSize:g,entry:b,index:y,dataKey:d}),M=_!=="-"&&a!=null?a.scale.map(_):h,P=M==null?0:Math.sqrt(Math.max(M,0)/Math.PI);return cl(cl({},b),{},{cx:j,cy:A,x:j==null?void 0:j-P,y:A==null?void 0:A-P,width:2*P,height:2*P,size:M,node:{x:v,y:w,z:_},tooltipPayload:C,tooltipPosition:{x:j,y:A},payload:b},c&&c[y]&&c[y].props)})}var rTe=(e,t,r)=>({x:e.cx,y:e.cy,value:Number(r==="x"?e.node.x:e.node.y),errorVal:fa(e,t)});function nTe(e){var{hide:t,points:r,className:n,needClip:a,xAxisId:s,yAxisId:o,id:l}=e,c=x.useRef(null);if(t)return null;var u=sa("recharts-scatter",n),d=l;return x.createElement(oo,{zIndex:e.zIndex},x.createElement(ui,{className:u,clipPath:a?"url(#clipPath-".concat(d,")"):void 0,id:l},a&&x.createElement("defs",null,x.createElement(a6,{clipPathId:d,xAxisId:s,yAxisId:o})),x.createElement(n6,{xAxisId:s,yAxisId:o,data:r,dataPointFormatter:rTe,errorBarOffset:0},x.createElement(ui,{key:"recharts-scatter-symbols"},x.createElement(eTe,{props:e,previousPointsRef:c})))))}var IG={xAxisId:0,yAxisId:0,zAxisId:0,label:!1,line:!1,legendType:"circle",lineType:"joint",lineJointType:"linear",shape:"circle",hide:!1,isAnimationActive:"auto",animationBegin:0,animationDuration:400,animationEasing:"linear",zIndex:bi.scatter};function aTe(e){var t=di(e,IG),{animationBegin:r,animationDuration:n,animationEasing:a,hide:s,isAnimationActive:o,legendType:l,lineJointType:c,lineType:u,shape:d,xAxisId:f,yAxisId:p,zAxisId:h}=t,m=U4(t,q6e),{needClip:g}=$_(f,p),b=x.useMemo(()=>L_(e.children,J0),[e.children]),y=js(),v=tn(w=>U6e(w,f,p,h,e.id,b,y));return g==null||v==null?null:x.createElement(x.Fragment,null,x.createElement(Y6e,{dataKey:e.dataKey,points:v,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:e.id}),x.createElement(nTe,P0({},m,{xAxisId:f,yAxisId:p,zAxisId:h,lineType:u,lineJointType:c,legendType:l,shape:d,hide:s,isAnimationActive:o,animationBegin:r,animationDuration:n,animationEasing:a,points:v,needClip:g})))}function iTe(e){var t=di(e,IG),r=js();return x.createElement(I_,{id:t.id,type:"scatter"},n=>x.createElement(x.Fragment,null,x.createElement(JE,{legendPayload:X6e(t)}),x.createElement(ZE,{type:"scatter",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:t.zAxisId,dataKey:t.dataKey,hide:t.hide,name:t.name,tooltipType:t.tooltipType,isPanorama:r}),x.createElement(aTe,P0({},t,{id:n}))))}var DG=x.memo(iTe,Ay);DG.displayName="Scatter";var sTe=["domain","range"],oTe=["domain","range"];function tR(e,t){if(e==null)return{};var r,n,a=lTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function lTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function rR(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function $G(e,t){if(e===t)return!0;var{domain:r,range:n}=e,a=tR(e,sTe),{domain:s,range:o}=t,l=tR(t,oTe);return!rR(r,s)||!rR(n,o)?!1:Ay(a,l)}var cTe=["type"],uTe=["dangerouslySetInnerHTML","ticks","scale"],dTe=["id","scale"];function z4(){return z4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},z4.apply(null,arguments)}function nR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function aR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nR(Object(r),!0).forEach(function(n){fTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fTe(e,t,r){return(t=hTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hTe(e){var t=pTe(e,"string");return typeof t=="symbol"?t:t+""}function pTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function W4(e,t){if(e==null)return{};var r,n,a=mTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function mTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function gTe(e){var t=Ua(),r=x.useRef(null),n=mq(),{type:a}=e,s=W4(e,cTe),o=c_(n,"xAxis",a),l=x.useMemo(()=>{if(o!=null)return aR(aR({},s),{},{type:o})},[s,o]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(V3e(l)):r.current!==l&&t(G3e({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(K3e(r.current)),r.current=null)},[t]),null}var xTe=e=>{var{xAxisId:t,className:r}=e,n=tn(CC),a=js(),s="xAxis",o=tn(y=>dV(y,s,t,a)),l=tn(y=>oV(y,t)),c=tn(y=>U5e(y,t)),u=tn(y=>zH(y,t));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:p}=e,h=W4(e,uTe),{id:m,scale:g}=u,b=W4(u,dTe);return x.createElement(r6,z4({},h,b,{x:c.x,y:c.y,width:l.width,height:l.height,className:sa("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},yTe={allowDataOverflow:Ps.allowDataOverflow,allowDecimals:Ps.allowDecimals,allowDuplicatedCategory:Ps.allowDuplicatedCategory,angle:Ps.angle,axisLine:Nd.axisLine,height:Ps.height,hide:!1,includeHidden:Ps.includeHidden,interval:Ps.interval,label:!1,minTickGap:Ps.minTickGap,mirror:Ps.mirror,orientation:Ps.orientation,padding:Ps.padding,reversed:Ps.reversed,scale:Ps.scale,tick:Ps.tick,tickCount:Ps.tickCount,tickLine:Nd.tickLine,tickSize:Nd.tickSize,type:Ps.type,xAxisId:0},bTe=e=>{var t=di(e,yTe);return x.createElement(x.Fragment,null,x.createElement(gTe,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),x.createElement(xTe,t))},Cy=x.memo(bTe,$G);Cy.displayName="XAxis";var vTe=["type"],wTe=["dangerouslySetInnerHTML","ticks","scale"],STe=["id","scale"];function q4(){return q4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},q4.apply(null,arguments)}function iR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iR(Object(r),!0).forEach(function(n){_Te(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Te(e,t,r){return(t=kTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kTe(e){var t=jTe(e,"string");return typeof t=="symbol"?t:t+""}function jTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function H4(e,t){if(e==null)return{};var r,n,a=ATe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ATe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function NTe(e){var t=Ua(),r=x.useRef(null),n=mq(),{type:a}=e,s=H4(e,vTe),o=c_(n,"yAxis",a),l=x.useMemo(()=>{if(o!=null)return sR(sR({},s),{},{type:o})},[o,s]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(X3e(l)):r.current!==l&&t(Y3e({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(Q3e(r.current)),r.current=null)},[t]),null}function CTe(e){var{yAxisId:t,className:r,width:n,label:a}=e,s=x.useRef(null),o=x.useRef(null),l=tn(CC),c=js(),u=Ua(),d="yAxis",f=tn(j=>lV(j,t)),p=tn(j=>W5e(j,t)),h=tn(j=>dV(j,d,t,c)),m=tn(j=>WH(j,t));if(x.useLayoutEffect(()=>{if(!(n!=="auto"||!f||HE(a)||x.isValidElement(a)||m==null)){var j=s.current;if(j){var A=j.getCalculatedWidth();Math.round(f.width)!==Math.round(A)&&u(tNe({id:t,width:A}))}}},[h,f,u,a,t,n,m]),f==null||p==null||m==null)return null;var{dangerouslySetInnerHTML:g,ticks:b,scale:y}=e,v=H4(e,wTe),{id:w,scale:_}=m,C=H4(m,STe);return x.createElement(r6,q4({},v,C,{ref:s,labelRef:o,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:sa("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:h,axisType:d}))}var ETe={allowDataOverflow:Os.allowDataOverflow,allowDecimals:Os.allowDecimals,allowDuplicatedCategory:Os.allowDuplicatedCategory,angle:Os.angle,axisLine:Nd.axisLine,hide:!1,includeHidden:Os.includeHidden,interval:Os.interval,label:!1,minTickGap:Os.minTickGap,mirror:Os.mirror,orientation:Os.orientation,padding:Os.padding,reversed:Os.reversed,scale:Os.scale,tick:Os.tick,tickCount:Os.tickCount,tickLine:Nd.tickLine,tickSize:Nd.tickSize,type:Os.type,width:Os.width,yAxisId:0},TTe=e=>{var t=di(e,ETe);return x.createElement(x.Fragment,null,x.createElement(NTe,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),x.createElement(CTe,t))},Ey=x.memo(TTe,$G);Ey.displayName="YAxis";function PTe(e){var t=Ua(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(J3e(e)):r.current!==e&&t(Z3e({prev:r.current,next:e})),r.current=e},[e,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(eNe(r.current)),r.current=null)},[t]),null}var OTe={zAxisId:0,range:wd.range,scale:wd.scale,type:wd.type};function UG(e){var t=di(e,OTe);return x.createElement(PTe,{domain:t.domain,id:t.zAxisId,dataKey:t.dataKey,name:t.name,unit:t.unit,range:t.range,scale:t.scale,type:t.type,allowDuplicatedCategory:wd.allowDuplicatedCategory,allowDataOverflow:wd.allowDataOverflow,reversed:wd.reversed,includeHidden:wd.includeHidden})}UG.displayName="ZAxis";var LTe=(e,t)=>t,s6=Kt([LTe,pa,DH,zs,CV,tf,sje,ks],hje),o6=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},zG=_c("mouseClick"),WG=sy();WG.startListening({actionCreator:zG,effect:(e,t)=>{var r=e.payload,n=s6(t.getState(),o6(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(ake({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var V4=_c("mouseMove"),qG=sy(),iv=null;qG.startListening({actionCreator:V4,effect:(e,t)=>{var r=e.payload;iv!==null&&cancelAnimationFrame(iv);var n=o6(r);iv=requestAnimationFrame(()=>{var a=t.getState(),s=ME(a,a.tooltip.settings.shared);if(s==="axis"){var o=s6(a,n);(o==null?void 0:o.activeIndex)!=null?t.dispatch(bV({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(yV())}iv=null})}});function MTe(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var oR={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},HG=yl({name:"rootProps",initialState:oR,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:oR.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),FTe=HG.reducer,{updateOptions:RTe}=HG.actions,BTe=null,ITe={updatePolarOptions:(e,t)=>t.payload},VG=yl({name:"polarOptions",initialState:BTe,reducers:ITe}),{updatePolarOptions:DTe}=VG.actions,$Te=VG.reducer,GG=_c("keyDown"),KG=_c("focus"),l6=sy();l6.startListening({actionCreator:GG,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=FE(a,fg(r),by(r),wy(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=tf(r);if(s==="Enter"){var u=Nw(r,"axis","hover",String(a.index));t.dispatch(L4({active:!a.active,activeIndex:a.index,activeCoordinate:u}));return}var d=K5e(r),f=d==="left-to-right"?1:-1,p=s==="ArrowRight"?1:-1,h=l+p*f;if(!(c==null||h>=c.length||h<0)){var m=Nw(r,"axis","hover",String(h));t.dispatch(L4({active:!0,activeIndex:h.toString(),activeCoordinate:m}))}}}}}});l6.startListening({actionCreator:KG,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var s="0",o=Nw(r,"axis","hover",String(s));t.dispatch(L4({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var oc=_c("externalEvent"),XG=sy(),Jk=new Map;XG.startListening({actionCreator:oc,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var a=n.type,s=Jk.get(a);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=t.getState(),c={activeCoordinate:qke(l),activeDataKey:$E(l),activeIndex:Ud(l),activeLabel:PV(l),activeTooltipIndex:Ud(l),isTooltipActive:Hke(l)};r(c,n)}finally{Jk.delete(a)}});Jk.set(a,o)}}});var UTe=Kt([ug],e=>e.tooltipItemPayloads),zTe=Kt([UTe,(e,t)=>t,(e,t,r)=>r],(e,t,r)=>{if(t!=null){var n=e.find(s=>s.settings.graphicalItemId===r);if(n!=null){var{getPosition:a}=n;if(a!=null)return a(t)}}}),YG=_c("touchMove"),QG=sy();QG.startListening({actionCreator:YG,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),a=ME(n,n.tooltip.settings.shared);if(a==="axis"){var s=r.touches[0];if(s==null)return;var o=s6(n,o6({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&t.dispatch(bV({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(oq),f=(l=u.getAttribute(NC))!==null&&l!==void 0?l:void 0,p=dg(n).find(g=>g.id===f);if(d==null||p==null||f==null)return;var{dataKey:h}=p,m=zTe(n,d,f);t.dispatch(xV({activeDataKey:h,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var WTe=EW({brush:vNe,cartesianAxis:rNe,chartData:Wje,errorBars:TCe,graphicalItems:s3e,layout:jbe,legend:Cve,options:Ije,polarAxis:b4e,polarOptions:$Te,referenceElements:CNe,rootProps:FTe,tooltip:ike,zIndex:Nje}),qTe=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return Yye({reducer:WTe,preloadedState:t,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([WG.middleware,qG.middleware,l6.middleware,XG.middleware,QG.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(qW({type:"raf"}))},devTools:{serialize:{replacer:MTe},name:"recharts-".concat(r)}})};function JG(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=js(),s=x.useRef(null);if(a)return r;s.current==null&&(s.current=qTe(t,n));var o=yC;return x.createElement(cEe,{context:o,store:s.current},r)}function HTe(e){var{layout:t,margin:r}=e,n=Ua(),a=js();return x.useEffect(()=>{a||(n(Sbe(t)),n(wbe(r)))},[n,a,t,r]),null}var ZG=x.memo(HTe,Ay);function eK(e){var t=Ua();return x.useEffect(()=>{t(RTe(e))},[t,e]),null}function lR(e){var{zIndex:t,isPanorama:r}=e,n=x.useRef(null),a=Ua();return x.useLayoutEffect(()=>(n.current&&a(jje({zIndex:t,element:n.current,isPanorama:r})),()=>{a(Aje({zIndex:t,isPanorama:r}))}),[a,t,r]),x.createElement("g",{tabIndex:-1,ref:n})}function cR(e){var{children:t,isPanorama:r}=e,n=tn(mje);if(!n||n.length===0)return t;var a=n.filter(o=>o<0),s=n.filter(o=>o>0);return x.createElement(x.Fragment,null,a.map(o=>x.createElement(lR,{key:o,zIndex:o,isPanorama:r})),t,s.map(o=>x.createElement(lR,{key:o,zIndex:o,isPanorama:r})))}var VTe=["children"];function GTe(e,t){if(e==null)return{};var r,n,a=KTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function KTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Rw(){return Rw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Rw.apply(null,arguments)}var XTe={width:"100%",height:"100%",display:"block"},YTe=x.forwardRef((e,t)=>{var r=PC(),n=OC(),a=Nq();if(!qu(r)||!qu(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=e,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=a?0:void 0,typeof o.role=="string"?d=o.role:d=a?"application":void 0),x.createElement(aC,Rw({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:XTe,ref:t}),s)}),QTe=e=>{var{children:t}=e,r=tn(KS);if(!r)return null;var{width:n,height:a,y:s,x:o}=r;return x.createElement(aC,{width:n,height:a,x:o,y:s},t)},uR=x.forwardRef((e,t)=>{var{children:r}=e,n=GTe(e,VTe),a=js();return a?x.createElement(QTe,null,x.createElement(cR,{isPanorama:!0},r)):x.createElement(YTe,Rw({ref:t},n),x.createElement(cR,{isPanorama:!1},r))});function JTe(){var e=Ua(),[t,r]=x.useState(null),n=tn(zbe);return x.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),s=a.width/t.offsetWidth;Vn(s)&&s!==n&&e(kbe(s))}},[t,e,n]),r}function dR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ZTe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dR(Object(r),!0).forEach(function(n){e8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e8e(e,t,r){return(t=t8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t8e(e){var t=r8e(e,"string");return typeof t=="symbol"?t:t+""}function r8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Xf(){return Xf=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xf.apply(null,arguments)}var n8e=()=>(Jje(),null);function Bw(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var a8e=x.forwardRef((e,t)=>{var r,n,a=x.useRef(null),[s,o]=x.useState({containerWidth:Bw((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Bw((n=e.style)===null||n===void 0?void 0:n.height)}),l=x.useCallback((u,d)=>{o(f=>{var p=Math.round(u),h=Math.round(d);return f.containerWidth===p&&f.containerHeight===h?f:{containerWidth:p,containerHeight:h}})},[]),c=x.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var p=m=>{var g=m[0];if(g!=null){var{width:b,height:y}=g.contentRect;l(b,y)}},h=new ResizeObserver(p);h.observe(u),a.current=h}},[t,l]);return x.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[l]),x.createElement(x.Fragment,null,x.createElement(cy,{width:s.containerWidth,height:s.containerHeight}),x.createElement("div",Xf({ref:c},e)))}),i8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,s]=x.useState({containerWidth:Bw(r),containerHeight:Bw(n)}),o=x.useCallback((c,u)=>{s(d=>{var f=Math.round(c),p=Math.round(u);return d.containerWidth===f&&d.containerHeight===p?d:{containerWidth:f,containerHeight:p}})},[]),l=x.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[t,o]);return x.createElement(x.Fragment,null,x.createElement(cy,{width:a.containerWidth,height:a.containerHeight}),x.createElement("div",Xf({ref:l},e)))}),s8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return x.createElement(x.Fragment,null,x.createElement(cy,{width:r,height:n}),x.createElement("div",Xf({ref:t},e)))}),o8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return typeof r=="string"||typeof n=="string"?x.createElement(i8e,Xf({},e,{ref:t})):typeof r=="number"&&typeof n=="number"?x.createElement(s8e,Xf({},e,{width:r,height:n,ref:t})):x.createElement(x.Fragment,null,x.createElement(cy,{width:r,height:n}),x.createElement("div",Xf({ref:t},e)))});function l8e(e){return e?a8e:o8e}var c8e=x.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:p,onTouchEnd:h,onTouchMove:m,onTouchStart:g,style:b,width:y,responsive:v,dispatchTouchEvents:w=!0}=e,_=x.useRef(null),C=Ua(),[j,A]=x.useState(null),[M,P]=x.useState(null),R=JTe(),N=EC(),T=(N==null?void 0:N.width)>0?N.width:y,B=(N==null?void 0:N.height)>0?N.height:a,G=x.useCallback(J=>{R(J),typeof t=="function"&&t(J),A(J),P(J),J!=null&&(_.current=J)},[R,t,A,P]),re=x.useCallback(J=>{C(zG(J)),C(oc({handler:s,reactEvent:J}))},[C,s]),xe=x.useCallback(J=>{C(V4(J)),C(oc({handler:u,reactEvent:J}))},[C,u]),_e=x.useCallback(J=>{C(yV()),C(oc({handler:d,reactEvent:J}))},[C,d]),V=x.useCallback(J=>{C(V4(J)),C(oc({handler:f,reactEvent:J}))},[C,f]),K=x.useCallback(()=>{C(KG())},[C]),de=x.useCallback(J=>{C(GG(J.key))},[C]),ne=x.useCallback(J=>{C(oc({handler:o,reactEvent:J}))},[C,o]),E=x.useCallback(J=>{C(oc({handler:l,reactEvent:J}))},[C,l]),Z=x.useCallback(J=>{C(oc({handler:c,reactEvent:J}))},[C,c]),H=x.useCallback(J=>{C(oc({handler:p,reactEvent:J}))},[C,p]),F=x.useCallback(J=>{C(oc({handler:g,reactEvent:J}))},[C,g]),ee=x.useCallback(J=>{w&&C(YG(J)),C(oc({handler:m,reactEvent:J}))},[C,w,m]),z=x.useCallback(J=>{C(oc({handler:h,reactEvent:J}))},[C,h]),X=l8e(v);return x.createElement(IV.Provider,{value:j},x.createElement(Cz.Provider,{value:M},x.createElement(X,{width:T??(b==null?void 0:b.width),height:B??(b==null?void 0:b.height),className:sa("recharts-wrapper",n),style:ZTe({position:"relative",cursor:"default",width:T,height:B},b),onClick:re,onContextMenu:ne,onDoubleClick:E,onFocus:K,onKeyDown:de,onMouseDown:Z,onMouseEnter:xe,onMouseLeave:_e,onMouseMove:V,onMouseUp:H,onTouchEnd:z,onTouchMove:ee,onTouchStart:F,ref:G},x.createElement(n8e,null),r)))}),u8e=["width","height","responsive","children","className","style","compact","title","desc"];function d8e(e,t){if(e==null)return{};var r,n,a=f8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function f8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var tK=x.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:s,className:o,style:l,compact:c,title:u,desc:d}=e,f=d8e(e,u8e),p=Ho(f);return c?x.createElement(x.Fragment,null,x.createElement(cy,{width:r,height:n}),x.createElement(uR,{otherAttributes:p,title:u,desc:d},s)):x.createElement(c8e,{className:o,style:l,width:r,height:n,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},x.createElement(uR,{otherAttributes:p,title:u,desc:d,ref:t},x.createElement(ENe,null,s)))});function G4(){return G4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},G4.apply(null,arguments)}var h8e={top:5,right:5,bottom:5,left:5},p8e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:h8e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},c6=x.forwardRef(function(t,r){var n,a=di(t.categoricalChartProps,p8e),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return x.createElement(JG,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},x.createElement(vG,{chartData:u.data}),x.createElement(ZG,{layout:a.layout,margin:a.margin}),x.createElement(eK,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),x.createElement(tK,G4({},a,{ref:r})))}),m8e=["axis"],g8e=x.forwardRef((e,t)=>x.createElement(c6,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:m8e,tooltipPayloadSearcher:y_,categoricalChartProps:e,ref:t})),x8e=["axis","item"],rK=x.forwardRef((e,t)=>x.createElement(c6,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:x8e,tooltipPayloadSearcher:y_,categoricalChartProps:e,ref:t}));function y8e(e){var t=Ua();return x.useEffect(()=>{t(DTe(e))},[t,e]),null}var b8e=["layout"];function K4(){return K4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},K4.apply(null,arguments)}function v8e(e,t){if(e==null)return{};var r,n,a=w8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function w8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var S8e={top:5,right:5,bottom:5,left:5},nK={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:S8e,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},_8e=x.forwardRef(function(t,r){var n,a=di(t.categoricalChartProps,nK),{layout:s}=a,o=v8e(a,b8e),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return x.createElement(JG,{preloadedState:{options:f},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:l},x.createElement(vG,{chartData:a.data}),x.createElement(ZG,{layout:s,margin:a.margin}),x.createElement(eK,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),x.createElement(y8e,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),x.createElement(tK,K4({},o,{ref:r})))});function fR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fR(Object(r),!0).forEach(function(n){k8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k8e(e,t,r){return(t=j8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function j8e(e){var t=A8e(e,"string");return typeof t=="symbol"?t:t+""}function A8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N8e=["item"],C8e=hR(hR({},nK),{},{layout:"centric",startAngle:0,endAngle:360}),E8e=x.forwardRef((e,t)=>{var r=di(e,C8e);return x.createElement(_8e,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:N8e,tooltipPayloadSearcher:y_,categoricalChartProps:r,ref:t})}),T8e=["item"],P8e=x.forwardRef((e,t)=>x.createElement(c6,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:T8e,tooltipPayloadSearcher:y_,categoricalChartProps:e,ref:t}));function Zk(e,t){try{const r=Pn(`${t}_${e}`);if(!r)return null;if(r.rowsByStudentId&&typeof r.rowsByStudentId=="object")return r.rowsByStudentId;if(Array.isArray(r.rows)){const n={};return r.rows.forEach(a=>{n[String(a.studentId||a.id||"")]=a}),n}if(Array.isArray(r)){const n={};return r.forEach(a=>{n[String(a.studentId||a.id||"")]=a}),n}return typeof r=="object"?r:null}catch{return null}}function ej(e){if(!e)return null;for(const t of["total","mark","score","marks"])if(typeof e[t]=="number")return e[t];return null}const X4=58;function Vg({title:e,subtitle:t,children:r}){return i.jsxs("div",{className:"obe-card",style:{padding:"18px 18px 14px"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:14},children:[i.jsx("div",{style:{fontWeight:800,fontSize:15,color:"#0f172a"},children:e}),t&&i.jsx("div",{style:{fontSize:11,color:"#94a3b8",fontWeight:600},children:t})]}),r]})}function Ty(){return i.jsxs("div",{style:{textAlign:"center",padding:"32px 0",color:"#94a3b8",fontSize:13},children:[i.jsx("svg",{width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"#cbd5e1",strokeWidth:1.5,style:{margin:"0 auto 6px",display:"block"},children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v18h18M7 16l4-5 4 3 4-6"})}),"No marks saved yet"]})}function O8e(e){const t=Zk(e,"cia1_sheet"),r=Zk(e,"cia2_sheet"),n=Zk(e,"model_sheet"),a=new Set;return[t,r,n].forEach(s=>s&&Object.keys(s).forEach(o=>a.add(o))),Array.from(a).map(s=>{const o=t!=null&&t[s]?ej(t[s]):null,l=r!=null&&r[s]?ej(r[s]):null,c=n!=null&&n[s]?ej(n[s]):null,u=[o,l,c].filter(f=>f!==null),d=u.length?u.reduce((f,p)=>f+p,0)/u.length:null;return{id:s,cia1:o??void 0,cia2:l??void 0,model:c??void 0,avg:d??void 0}})}function L8e({students:e}){const t=e.filter(c=>typeof c.avg=="number"),r=t.length,n=t.filter(c=>(c.avg??0)>=X4).length,a=r?t.reduce((c,u)=>c+(u.avg??0),0)/r:0,s=r?Math.max(...t.map(c=>c.avg??0)):0,o=r?Math.min(...t.map(c=>c.avg??0)):0,l=[{label:"Total Students",value:r,color:"#0b74b8"},{label:"Passed",value:n,color:"#10b981"},{label:"Class Avg",value:a.toFixed(1),color:"#f59e0b"},{label:"Highest",value:s.toFixed(1),color:"#8b5cf6"},{label:"Lowest",value:o.toFixed(1),color:"#ef4444"}];return i.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12,marginBottom:14},children:l.map(c=>i.jsxs("div",{style:{flex:"1 1 120px",background:"#fff",borderRadius:12,padding:"14px 18px",boxShadow:"0 2px 8px rgba(0,0,0,0.07)",borderLeft:`4px solid ${c.color}`},children:[i.jsx("div",{style:{fontSize:22,fontWeight:900,color:c.color},children:c.value}),i.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:2,fontWeight:600},children:c.label})]},c.label))})}function M8e({students:e}){const t=n=>{const a=n.filter(s=>typeof s=="number");return a.length?Math.round(a.reduce((s,o)=>s+o,0)/a.length*10)/10:0},r=[{name:"CIA 1",average:t(e.map(n=>n.cia1))},{name:"CIA 2",average:t(e.map(n=>n.cia2))},{name:"Model",average:t(e.map(n=>n.model))}];return e.length===0?i.jsx(Ty,{}):i.jsx(ly,{width:"100%",height:220,children:i.jsxs(g8e,{data:r,margin:{top:10,right:20,left:0,bottom:5},children:[i.jsx(ky,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),i.jsx(Cy,{dataKey:"name",tick:{fontSize:12,fill:"#475569"}}),i.jsx(Ey,{domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),i.jsx(_y,{contentStyle:{borderRadius:10,fontSize:13}}),i.jsx(LG,{type:"monotone",dataKey:"average",stroke:"#0b74b8",strokeWidth:3,dot:{r:6,fill:"#ff8c42",stroke:"#fff",strokeWidth:2},activeDot:{r:8}})]})})}const pR=["#ef4444","#f59e0b","#06b6d4","#10b981"];function F8e({students:e}){const t={"Fail (<58)":0,"5864":0,"6574":0,"75+":0};e.forEach(s=>{const o=s.avg??0;o<58?t["Fail (<58)"]+=1:o<65?t["5864"]+=1:o<75?t["6574"]+=1:t["75+"]+=1});const r=Object.entries(t).map(([s,o])=>({name:s,value:o})).filter(s=>s.value>0),n=e.filter(s=>typeof s.avg=="number").length,a=n?Math.round((n-t["Fail (<58)"])/n*100):0;return r.length===0?i.jsx(Ty,{}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{textAlign:"center",marginBottom:4},children:[i.jsxs("span",{style:{fontSize:28,fontWeight:900,color:a>=75?"#10b981":"#f59e0b"},children:[a,"%"]}),i.jsx("span",{style:{fontSize:12,color:"#64748b",marginLeft:6},children:"Pass Rate"})]}),i.jsx(ly,{width:"100%",height:200,children:i.jsxs(E8e,{children:[i.jsx(xG,{data:r,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"value",label:({name:s,percent:o})=>`${s} ${(o*100).toFixed(0)}%`,labelLine:!1,children:r.map((s,o)=>i.jsx(J0,{fill:pR[o%pR.length]},o))}),i.jsx(_y,{}),i.jsx(FC,{iconType:"circle",iconSize:10})]})})]})}function R8e({students:e}){const t=[...e].filter(n=>typeof n.avg=="number").sort((n,a)=>(a.avg??0)-(n.avg??0)),r=[...t.slice(0,5).map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Top"})),...t.slice(-5).reverse().map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Bottom"}))];return r.length===0?i.jsx(Ty,{}):i.jsx(ly,{width:"100%",height:260,children:i.jsxs(rK,{data:r,layout:"vertical",margin:{top:4,right:24,left:8,bottom:4},children:[i.jsx(ky,{strokeDasharray:"3 3",horizontal:!1,stroke:"#e2e8f0"}),i.jsx(Cy,{type:"number",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),i.jsx(Ey,{dataKey:"id",type:"category",tick:{fontSize:11,fill:"#475569"},width:56}),i.jsx(_y,{contentStyle:{borderRadius:10,fontSize:13}}),i.jsx(Cx,{dataKey:"avg",radius:[0,6,6,0],children:r.map((n,a)=>i.jsx(J0,{fill:n.group==="Top"?"#0b74b8":"#ef4444"},a))})]})})}function B8e({students:e}){const t=e.filter(r=>r.cia1!=null||r.cia2!=null||r.model!=null).slice(0,25).map(r=>({id:r.id.slice(-5),CIA1:r.cia1!=null?+r.cia1.toFixed(1):null,CIA2:r.cia2!=null?+r.cia2.toFixed(1):null,Model:r.model!=null?+r.model.toFixed(1):null}));return t.length===0?i.jsx(Ty,{}):i.jsx(ly,{width:"100%",height:240,children:i.jsxs(rK,{data:t,margin:{top:10,right:10,left:0,bottom:20},children:[i.jsx(ky,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),i.jsx(Cy,{dataKey:"id",tick:{fontSize:9,fill:"#475569"},angle:-45,textAnchor:"end",interval:0}),i.jsx(Ey,{domain:[0,100],tick:{fontSize:10,fill:"#94a3b8"}}),i.jsx(_y,{contentStyle:{borderRadius:10,fontSize:12}}),i.jsx(FC,{iconType:"circle",iconSize:9}),i.jsx(Cx,{dataKey:"CIA1",fill:"#0b74b8",radius:[3,3,0,0]}),i.jsx(Cx,{dataKey:"CIA2",fill:"#06b6d4",radius:[3,3,0,0]}),i.jsx(Cx,{dataKey:"Model",fill:"#f59e0b",radius:[3,3,0,0]})]})})}function I8e({students:e}){const t=e.filter(r=>r.cia1!=null&&r.cia2!=null).map(r=>({x:+(r.cia1??0).toFixed(1),y:+(r.cia2??0).toFixed(1),id:r.id}));return t.length===0?i.jsx(Ty,{}):i.jsx(ly,{width:"100%",height:220,children:i.jsxs(P8e,{margin:{top:10,right:20,left:0,bottom:10},children:[i.jsx(ky,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),i.jsx(Cy,{type:"number",dataKey:"x",name:"CIA1",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 1",position:"insideBottom",offset:-6,fontSize:11,fill:"#475569"}}),i.jsx(Ey,{type:"number",dataKey:"y",name:"CIA2",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 2",angle:-90,position:"insideLeft",fontSize:11,fill:"#475569"}}),i.jsx(UG,{range:[40,40]}),i.jsx(_y,{cursor:{strokeDasharray:"3 3"},contentStyle:{borderRadius:10,fontSize:12},content:({payload:r})=>{var n,a,s,o,l,c;return r!=null&&r.length?i.jsxs("div",{style:{background:"#fff",padding:"6px 10px",borderRadius:8,fontSize:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[i.jsx("div",{children:i.jsx("b",{children:(a=(n=r[0])==null?void 0:n.payload)==null?void 0:a.id})}),i.jsxs("div",{children:["CIA1: ",(o=(s=r[0])==null?void 0:s.payload)==null?void 0:o.x,"  CIA2: ",(c=(l=r[0])==null?void 0:l.payload)==null?void 0:c.y]})]}):null}}),i.jsx(I4,{x:X4,stroke:"#ef4444",strokeDasharray:"5 3",label:{value:"Fail",fill:"#ef4444",fontSize:10}}),i.jsx(I4,{y:X4,stroke:"#ef4444",strokeDasharray:"5 3"}),i.jsx(DG,{data:t,fill:"#0b74b8",opacity:.75})]})})}function D8e({subjectId:e}){const t=String(e||""),r=x.useMemo(()=>O8e(t),[t]);return i.jsxs("div",{style:{padding:"4px 0"},children:[i.jsx(L8e,{students:r}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:16},children:[i.jsx(Vg,{title:"Trend Over Time",subtitle:"Class avg per assessment",children:i.jsx(M8e,{students:r})}),i.jsx(Vg,{title:"Grade Distribution",subtitle:"Pass rate (fail < 58)",children:i.jsx(F8e,{students:r})}),i.jsx(Vg,{title:"Top vs Bottom Performers",subtitle:"Avg marks (last 5 digits of ID)",children:i.jsx(R8e,{students:r})}),i.jsx(Vg,{title:"CIA1 vs CIA2 Scatter",subtitle:"Each dot = one student",children:i.jsx(I8e,{students:r})}),i.jsx(Vg,{title:"Per-Student Assessment Comparison",subtitle:"First 25 students  CIA1 / CIA2 / Model",children:i.jsx(B8e,{students:r})})]})]})}const $8e=["ssa1","formative1","ssa2","formative2","cia1","cia2"];function U8e({teachingAssignmentId:e,onSaved:t,onClose:r}){var N;const[n,a]=x.useState(!1),[s,o]=x.useState(!1),[l,c]=x.useState(new Set),[u,d]=x.useState(null),[f,p]=x.useState(!1),[h,m]=x.useState(null),g=x.useRef(null);x.useEffect(()=>{let T=!0;if(e)return(async()=>{a(!0);try{const B=await im(Number(e));if(!T)return;c(new Set((B==null?void 0:B.enabled_assessments)||[])),d((B==null?void 0:B.meta)||null),m(null)}catch(B){m((B==null?void 0:B.message)||"Failed to load")}finally{T&&a(!1)}})(),()=>{T=!1}},[e]),x.useEffect(()=>{var G;if(!e||(u==null?void 0:u.mode)!=="SPECIAL_GLOBAL"||((G=u==null?void 0:u.edit_request)==null?void 0:G.status)!=="PENDING")return;let T=!1;const B=window.setInterval(async()=>{try{const re=await im(Number(e));if(T)return;c(new Set((re==null?void 0:re.enabled_assessments)||[])),d((re==null?void 0:re.meta)||null)}catch{}},4e3);return()=>{T=!0,window.clearInterval(B)}},[e,u==null?void 0:u.mode,(N=u==null?void 0:u.edit_request)==null?void 0:N.status]);const b=!!(u!=null&&u.locked),y=(u==null?void 0:u.can_edit)!==!1,v=b&&!y,w=(u==null?void 0:u.edit_request)||null,C=String((w==null?void 0:w.status)||"").toUpperCase()==="PENDING";x.useEffect(()=>{if((u==null?void 0:u.mode)!=="SPECIAL_GLOBAL")return;const T=g.current;g.current=y,T===!1&&y===!0&&alert("IQAC approval granted. You can now edit and re-save the enabled exams.")},[y,u==null?void 0:u.mode]);const j=T=>{v||c(B=>{const G=new Set(B);return G.has(T)?G.delete(T):G.add(T),G})},A=async()=>{if(e){o(!0);try{const T=Array.from(l.values()),B=await WD(Number(e),T),G=(B==null?void 0:B.enabled_assessments)||[];c(new Set(G)),d((B==null?void 0:B.meta)||u),m(null),t&&t(G),alert("Saved enabled assessments.")}catch(T){m((T==null?void 0:T.message)||"Save failed"),alert("Save failed: "+((T==null?void 0:T.message)||""))}finally{o(!1)}}},M=async T=>{if(e){p(!0);try{const B=await qD(Number(e));d(G=>({...G||{},locked:!0,can_edit:!1,edit_request:B||{status:"PENDING"}})),alert(T?"Request is already pending. Synced status with server.":"Edit request sent to IQAC for approval.")}catch(B){m((B==null?void 0:B.message)||"Failed to request edit"),alert("Edit request failed: "+((B==null?void 0:B.message)||""))}finally{p(!1)}}},P=async()=>{await M(C),await R()},R=async()=>{if(e)try{a(!0);const T=await im(Number(e));c(new Set((T==null?void 0:T.enabled_assessments)||[])),d((T==null?void 0:T.meta)||null),m(null)}catch(T){m((T==null?void 0:T.message)||"Failed to refresh")}finally{a(!1)}};return i.jsxs("div",{style:{border:"1px solid #e5e7eb",padding:12,borderRadius:8,background:"#ffffff",maxWidth:520},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("div",{style:{fontWeight:700},children:"Select Exams for this Assignment"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"?"Special course (global lock)":"Faculty override"})]}),(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&b&&i.jsxs("div",{style:{fontSize:12,color:v?"#92400e":"#065f46",marginBottom:8},children:[v?"Locked after first save. Edit requires IQAC approval.":"Editing permitted (approved by IQAC/admin).",w!=null&&w.status?i.jsxs("span",{style:{marginLeft:8,color:"#6b7280"},children:["Request: ",String(w.status)]}):null]}),n?i.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0,1fr))",gap:8},children:$8e.map(T=>i.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("input",{type:"checkbox",checked:l.has(T),onChange:()=>j(T),disabled:v||s}),i.jsx("span",{style:{textTransform:"uppercase",fontSize:13},children:T.toUpperCase()})]},T))}),h&&i.jsx("div",{style:{color:"#b91c1c",marginTop:8},children:h}),i.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[!v&&i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:A,disabled:s||n||!e,children:s?"Saving":"Save"}),v&&(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{className:"obe-btn",onClick:P,disabled:f||s||n||!e,title:C?"Request already pending. Wait for IQAC approval.":void 0,children:f?"Requesting":C?"Edit Request Pending":"Edit (Request IQAC Approval)"}),i.jsx("button",{className:"obe-btn",onClick:R,disabled:s||n||!e,children:"Refresh"})]}),i.jsx("button",{className:"obe-btn",onClick:()=>r&&r(),disabled:s,children:"Close"})]})]})}function z8e({teachingAssignmentId:e}){var u,d,f;const[t,r]=x.useState([]),[n,a]=x.useState(!1);x.useEffect(()=>{let p=!0;return(async()=>{try{const h=await UD(e);if(!p)return;const m=h.filter(g=>g.teaching_assignment_id===e);r(m),m.length===0&&a(!0)}catch(h){console.error("Failed to fetch reset notifications:",h),p&&a(!0)}})(),()=>{p=!1}},[e]);const s=async()=>{if(t.length!==0)try{const p=t.map(h=>h.id);await zD(p),a(!0)}catch(p){console.error("Failed to dismiss notifications:",p),a(!0)}};if(n||t.length===0)return null;const o={ssa1:"SSA1",review1:"Review 1",ssa2:"SSA2",review2:"Review 2",cia1:"CIA1",cia2:"CIA2",formative1:"Formative 1",formative2:"Formative 2",model:"Model Exam"},c=[...new Set(t.map(p=>p.assessment))].map(p=>o[p]||p).join(", ");return i.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:s,children:i.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,maxWidth:500,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onClick:p=>p.stopPropagation(),children:[i.jsx("h3",{style:{margin:0,marginBottom:12,color:"#dc2626",fontSize:18,fontWeight:800},children:" Course Reset by IQAC"}),i.jsx("p",{style:{margin:0,marginBottom:16,color:"#374151",lineHeight:1.6},children:"The following assessment(s) have been reset by the IQAC administrator:"}),i.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:12,marginBottom:16},children:[i.jsxs("div",{style:{fontWeight:700,color:"#991b1b",marginBottom:6},children:[(u=t[0])==null?void 0:u.subject_code,"  ",(d=t[0])==null?void 0:d.subject_name]}),i.jsxs("div",{style:{fontSize:14,color:"#7f1d1d"},children:["Section: ",((f=t[0])==null?void 0:f.section_name)||""]}),i.jsxs("div",{style:{fontSize:14,color:"#7f1d1d",marginTop:4},children:["Assessments: ",c]})]}),i.jsx("p",{style:{margin:0,marginBottom:16,color:"#6b7280",fontSize:14},children:"All previously entered data for these assessment(s) has been cleared. You will need to re-enter the marks."}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:s,style:{minWidth:80},children:"OK"})})]})})}function W8e(e){return String(e).startsWith("cqi_")?null:e==="ssa1"?"ssa1":e==="review1"?"review1":e==="ssa2"?"ssa2":e==="review2"?"review2":e==="formative1"?"formative1":e==="formative2"?"formative2":e==="cia1"?"cia1":e==="cia2"?"cia2":e==="model"?"model":null}const Gg=[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"formative1",label:"Formative 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"formative2",label:"Formative 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}];function q8e(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?{showAfter:"cia1",assessmentType:"cia1",cos:["CO1","CO2"]}:t==="cia2_co3_co4"?{showAfter:"cia2",assessmentType:"cia2",cos:["CO3","CO4"]}:t==="model_co1_co2_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO1","CO2","CO3","CO4","CO5"]}:t==="model_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO3","CO4","CO5"]}:t==="model_co5"?{showAfter:"model",assessmentType:"model",cos:["CO5"]}:null}function H8e(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function V8e(e,t){const r=In(e),n=H8e(t);if(r==="SPECIAL"){const a=new Set(["dashboard"]);return["ssa1","ssa2","formative1","formative2","cia1","cia2"].forEach(s=>{n.has(s)&&a.add(s)}),Gg.filter(s=>a.has(s.key))}return r==="PRACTICAL"?Gg.filter(a=>["dashboard","cia1","cia2","model"].includes(a.key)).map(a=>a.key==="cia1"?{...a,label:"CIA 1 Review"}:a.key==="cia2"?{...a,label:"CIA 2 Review"}:a.key==="model"?{...a,label:"MODEL Review"}:a):r==="PROJECT"?[{key:"dashboard",label:"Dashboard"},{key:"review1",label:"Review 1"},{key:"review2",label:"Review 2"},{key:"model",label:"MODEL Review"}]:r==="TCPR"?[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"review1",label:"Review 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"review2",label:"Review 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}]:r==="TCPL"?Gg.map(a=>a.key==="formative1"?{...a,label:"LAB 1"}:a.key==="formative2"?{...a,label:"LAB 2"}:a):r==="LAB"?Gg.filter(a=>["dashboard","cia1","cia2","model"].includes(a.key)).map(a=>a.key==="cia1"?{...a,label:"CIA 1 LAB"}:a.key==="cia2"?{...a,label:"CIA 2 LAB"}:a.key==="model"?{...a,label:"MODEL LAB"}:a):Gg}function aK(e,t){return`marks_${e}_${t}`}function G8e(e,t){const r=String(t||"").trim().toLowerCase();gu(`marks_${e}_${r}`),r==="ssa1"&&gu(`ssa1_sheet_${e}`),r==="review1"&&gu(`review1_sheet_${e}`),r==="ssa2"&&gu(`ssa2_sheet_${e}`),r==="review2"&&gu(`review2_sheet_${e}`),r==="formative1"&&gu(`formative1_sheet_${e}`),r==="formative2"&&gu(`formative2_sheet_${e}`),r==="cia1"&&gu(`cia1_sheet_${e}`),r==="cia2"&&gu(`cia2_sheet_${e}`),r==="model"&&gu(`model_sheet_${e}`)}function K8e(e,t){const r=`studentId,mark
`,n=t.map(l=>`${String(l.studentId||"").replace(/\n/g," ")},${Number(l.mark||0)}`).join(`
`),a=new Blob([r+n],{type:"text/csv"}),s=URL.createObjectURL(a),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function X8e({active:e,label:t,onClick:r}){return i.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""}`,children:t})}function Y8e({active:e,label:t,onClick:r,isCqi:n,uniqueId:a}){return i.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""} ${n?"cqi-floating-btn":""}`,...a?{"data-cqi-id":a}:{},children:t})}function Q8e({subjectId:e,tab:t}){const r=x.useMemo(()=>aK(e,t),[e,t]),[n,a]=x.useState([]);x.useEffect(()=>{const d=Pn(r)||[];a(Array.isArray(d)?d:[])},[r]);const s=()=>a(d=>[...d,{studentId:"",mark:0}]),o=(d,f,p)=>{a(h=>{const m=[...h],g=m[d]||{studentId:"",mark:0};return m[d]={...g,[f]:p},m})},l=d=>{a(f=>f.filter((p,h)=>h!==d))},c=()=>{Sn(r,n),alert("Marks saved locally.")},u=()=>{K8e(`${e}_${t}_marks.csv`,n)};return i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:10,flexWrap:"wrap"},children:[i.jsx("button",{onClick:s,className:"obe-btn obe-btn-primary",children:"Add Row"}),i.jsx("button",{onClick:c,className:"obe-btn obe-btn-success",children:"Save Local"}),i.jsx("button",{onClick:u,className:"obe-btn obe-btn-secondary",disabled:!n.length,title:n.length?"Export as CSV":"Add at least one row to export",children:"Export CSV"})]}),n.length===0?i.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No rows yet. Click Add Row to start."}):i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((d,f)=>i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 120px 90px",gap:8,alignItems:"center"},children:[i.jsx("input",{value:d.studentId,onChange:p=>o(f,"studentId",p.target.value),placeholder:"Student ID",className:"obe-input"}),i.jsx("input",{type:"number",value:d.mark,onChange:p=>o(f,"mark",Number(p.target.value)),className:"obe-input"}),i.jsx("button",{onClick:()=>l(f),className:"obe-btn obe-btn-danger",children:"Remove"})]},f))}),i.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",i.jsx("span",{style:{fontFamily:"monospace"},children:r})]})]})}function u6({subjectId:e,classType:t,questionPaperType:r,enabledAssessments:n,teachingAssignmentsOverride:a,fixedTeachingAssignmentId:s,iqacResetEnabled:o,viewerMode:l}){var X,J;const[c,u]=x.useState("dashboard"),[d,f]=x.useState([]),[p,h]=x.useState(null),[m,g]=x.useState(null),[b,y]=x.useState(void 0),[v,w]=x.useState(!1),[_,C]=x.useState(!1),[j,A]=x.useState(0),[M,P]=x.useState(null),R=x.useMemo(()=>W8e(c),[c]),[N,T]=x.useState({loading:!1,enabled:!0,open:!0,error:null});x.useEffect(()=>{let q=!0;return(async()=>{if(!R){if(!q)return;T({loading:!1,enabled:!0,open:!0,error:null});return}if(q){T({loading:!0,enabled:!0,open:!0,error:null});try{const Y=await sN(R,String(e||""),m??void 0);if(!q)return;const L=(Y==null?void 0:Y.assessment_enabled)??!0,U=(Y==null?void 0:Y.assessment_open)??!0;T({loading:!1,enabled:!!L,open:!!U,error:null})}catch(Y){if(!q)return;T({loading:!1,enabled:!0,open:!0,error:(Y==null?void 0:Y.message)||"Failed to check exam availability"})}}})(),()=>{q=!1}},[R,e,m]);const B=R?!!N.enabled:!0,G=!!l||(R?!N.open:!1),re=x.useMemo(()=>m==null?null:(d||[]).find(q=>q.id===m)||null,[d,m]),[xe,_e]=x.useState(null),[V,K]=x.useState(null);x.useEffect(()=>{let q=!0;return(async()=>{if(_e(null),K(null),m==null)return;const Y=re||null,L=String((Y==null?void 0:Y.class_type)||"").trim(),U=!!String((Y==null?void 0:Y.academic_year)||"").trim(),ce=typeof(Y==null?void 0:Y.semester)<"u"&&(Y==null?void 0:Y.semester)!=null,W=!!(Y!=null&&Y.department||Y!=null&&Y.department_name),ae=!!String((Y==null?void 0:Y.section_name)||"").trim();if(L&&U&&ce&&W&&ae){_e(L);return}const he=String(t||"").trim();try{const ze=await Ac(Number(m));if(!q)return;const ke=(ze==null?void 0:ze.teaching_assignment)||{},qe=String((ke==null?void 0:ke.class_type)||"").trim();_e(qe||L||he||null),K({academic_year:(ke==null?void 0:ke.academic_year)||(ke==null?void 0:ke.academic_year_name)||(ke==null?void 0:ke.year)||null,semester:typeof(ke==null?void 0:ke.semester)<"u"?ke==null?void 0:ke.semester:null,department:(ke==null?void 0:ke.department)||(ke==null?void 0:ke.department_name)||null,section_name:(ke==null?void 0:ke.section_name)||(ke==null?void 0:ke.section)||null})}catch{if(!q)return;_e(L||he||null),K(null)}})(),()=>{q=!1}},[m,re,t]);const de=x.useMemo(()=>{const q=String((re==null?void 0:re.class_type)||"").trim();if(q)return q;const Y=String(xe||"").trim();return Y||String(t||"").trim()||null},[re,xe,t]),ne=x.useMemo(()=>In(de),[de]);x.useEffect(()=>{let q=!0;return(async()=>{try{const Y=await cS();if(!q)return;const U=(Array.isArray(Y==null?void 0:Y.options)?Y.options:[]).map(ce=>typeof ce=="string"?String(ce||""):ce&&typeof ce=="object"&&ce.id?String(ce.id||""):"").map(ce=>ce.trim()).filter(Boolean);P({options:U,divider:Number.isFinite(Number(Y==null?void 0:Y.divider))?Number(Y.divider):2,multiplier:Number.isFinite(Number(Y==null?void 0:Y.multiplier))?Number(Y.multiplier):.15})}catch{if(!q)return;P(null)}})(),()=>{q=!1}},[]);const E=x.useMemo(()=>ne==="SPECIAL",[ne]),Z=b===void 0?n:b,H=x.useMemo(()=>V8e(de,Z),[de,n,b]),F=x.useMemo(()=>(Array.isArray(M==null?void 0:M.options)?M.options:[]).map(Y=>q8e(Y)).filter(Y=>!!Y),[M]),ee=x.useMemo(()=>{const q=[...H];return F.length&&F.forEach((Y,L)=>{var ae,he,ze;const U=`CQI (${Y.assessmentType.toUpperCase()} ${Y.cos.join(", ")})`,ce={key:`cqi_${L}`,label:U,cqi:Y},W=q.findIndex(ke=>ke.key===Y.showAfter);if(W>=0){let ke=W+1;for(;ke<q.length&&String(((ae=q[ke])==null?void 0:ae.key)||"").startsWith("cqi_")&&((ze=(he=q[ke])==null?void 0:he.cqi)==null?void 0:ze.showAfter)===Y.showAfter;)ke+=1;q.splice(ke,0,ce)}else q.push(ce)}),q},[H,F]);x.useEffect(()=>{if(!e)return;const q=Pn(`markEntry_activeTab_${e}`);q&&ee.some(Y=>Y.key===q)&&u(q)},[e]),x.useEffect(()=>{ee.some(q=>q.key===c)||u("dashboard")},[ee,c]),x.useEffect(()=>{var L;if(!e||!a)return;const q=(a||[]).filter(U=>String(U.subject_code)===String(e));f(q),h(null);const Y=typeof s=="number"&&q.some(U=>U.id===s)&&s||(((L=q[0])==null?void 0:L.id)??null);g(Y)},[e,a,s]),x.useEffect(()=>{let q=!0;if(!(a&&Array.isArray(a)))return(async()=>{var Y;try{const L=await jc();if(!q)return;let U=(L||[]).filter(ae=>ae.subject_code===e);if(U.length===0)try{const ae=await mr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(ae.ok){const he=await ae.json();U=(Array.isArray(he.results)?he.results:Array.isArray(he)?he:he.items||[])||[]}}catch(ae){console.warn("Server TA list fetch failed:",ae)}f(U),h(null);const ce=Pn(`markEntry_selectedTa_${e}`),W=typeof s=="number"&&U.some(ae=>ae.id===s)&&s||typeof ce=="number"&&U.some(ae=>ae.id===ce)&&ce||(((Y=U[0])==null?void 0:Y.id)??null);g(W)}catch(L){if(!q)return;f([]),g(null),h((L==null?void 0:L.message)||"Failed to load teaching assignments")}})(),()=>{q=!1}},[e,a,s]),x.useEffect(()=>{e&&m!=null&&typeof s!="number"&&Sn(`markEntry_selectedTa_${e}`,m)},[e,m,s]),x.useEffect(()=>{let q=!0;if(e){if(m==null){y(void 0);return}if(!E){y(void 0);return}return(async()=>{try{const Y=await im(Number(m)),L=Y==null?void 0:Y.enabled_assessments;if(!q)return;y(Array.isArray(L)&&L.length?L:null)}catch(Y){if(!q)return;y(void 0),h((Y==null?void 0:Y.message)||"Failed to load faculty enabled assessments")}})(),()=>{q=!1}}},[e,m,E]),x.useEffect(()=>{e&&Sn(`markEntry_activeTab_${e}`,c)},[e,c]);const z=x.useMemo(()=>{if(!e)return{};const q={};for(const Y of ee){if(Y.key==="dashboard"||String(Y.key).startsWith("cqi_"))continue;if(Y.key==="ssa1"){const U=Pn(`ssa1_sheet_${e}`),ce=U==null?void 0:U.rows;q[Y.key]=Array.isArray(ce)?ce.length:0;continue}if(Y.key==="review1"){const U=Pn(`review1_sheet_${e}`),ce=U==null?void 0:U.rows;q[Y.key]=Array.isArray(ce)?ce.length:0;continue}if(Y.key==="ssa2"){const U=Pn(`ssa2_sheet_${e}`),ce=U==null?void 0:U.rows;q[Y.key]=Array.isArray(ce)?ce.length:0;continue}if(Y.key==="review2"){const U=Pn(`review2_sheet_${e}`),ce=U==null?void 0:U.rows;q[Y.key]=Array.isArray(ce)?ce.length:0;continue}if(Y.key==="formative1"){const U=Pn(`formative1_sheet_${e}`),ce=U==null?void 0:U.rowsByStudentId;q[Y.key]=ce&&typeof ce=="object"?Object.keys(ce).length:0;continue}if(Y.key==="formative2"){const U=Pn(`formative2_sheet_${e}`),ce=U==null?void 0:U.rowsByStudentId;q[Y.key]=ce&&typeof ce=="object"?Object.keys(ce).length:0;continue}if(Y.key==="cia1"){const U=Pn(`cia1_sheet_${e}`),ce=U==null?void 0:U.rowsByStudentId;q[Y.key]=ce&&typeof ce=="object"?Object.keys(ce).length:0;continue}if(Y.key==="cia2"){const U=Pn(`cia2_sheet_${e}`),ce=U==null?void 0:U.rowsByStudentId;q[Y.key]=ce&&typeof ce=="object"?Object.keys(ce).length:0;continue}if(Y.key==="model"){const U=Pn(`model_sheet_${e}`),ce=U==null?void 0:U.rowsByStudentId;q[Y.key]=ce&&typeof ce=="object"?Object.keys(ce).length:0;continue}const L=Pn(aK(e,Y.key))||[];q[Y.key]=Array.isArray(L)?L.length:0}return q},[e,c,ee,j]);return i.jsxs("div",{children:[m!=null&&i.jsx(z8e,{teachingAssignmentId:m}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[i.jsxs("div",{style:{minWidth:260},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Teaching Assignment (Section)"}),d.length===0?i.jsx("div",{className:"obe-input",children:"No teaching assignments"}):i.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,background:"#fff",border:"1px solid #e5e7eb"},children:[i.jsx("div",{style:{fontSize:14,fontWeight:600},children:((X=re||d[0])==null?void 0:X.section_name)||(V==null?void 0:V.section_name)||""}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(()=>{var ae,he,ze,ke,qe,Ie,Ve,Qe;const q=re||d[0]||{},Y=q.academic_year||(V==null?void 0:V.academic_year)||q.academic_year_name||q.year||"",L=typeof q.semester<"u"&&q.semester!=null?q.semester:typeof(V==null?void 0:V.semester)<"u"?V==null?void 0:V.semester:(ae=d[0])==null?void 0:ae.semester,U=q.department||((he=q.section_details)==null?void 0:he.department)||((qe=(ke=(ze=q.section_details)==null?void 0:ze.batch)==null?void 0:ke.course)==null?void 0:qe.department)||(V==null?void 0:V.department)||(q.department_name?{name:q.department_name}:null)||((Ie=d[0])==null?void 0:Ie.department)||((Qe=(Ve=d[0])==null?void 0:Ve.section_details)==null?void 0:Qe.department),ce=(U==null?void 0:U.short_name)||(U==null?void 0:U.code)||(U==null?void 0:U.name)||q.department_name||"",W=[];return W.push(Y||""),typeof L<"u"&&L!=null&&W.push(`Sem ${L}`),ce&&W.push(ce),W.filter(Boolean).join("  ")})()})]}),p&&i.jsx("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:p})]}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:"Student rows load from the selected section roster."}),i.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:E&&m?i.jsx("button",{className:"obe-btn",onClick:()=>w(q=>!q),children:"Show exams"}):null})]}),E&&v&&m?i.jsx("div",{style:{marginBottom:12},children:i.jsx(U8e,{teachingAssignmentId:m??void 0,onSaved:q=>{y(Array.isArray(q)&&q.length?q:null),w(!1)},onClose:()=>w(!1)})}):null,o&&R&&m!=null?i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:i.jsx("button",{className:"obe-btn obe-btn-danger",disabled:_,onClick:async()=>{const q=R;if(window.confirm(`Reset ${q.toUpperCase()} for this section? This clears draft + published data for that exam.`))try{C(!0),await iN(q,String(e),Number(m)),G8e(String(e),String(q)),A(L=>L+1),alert("Reset completed.")}catch(L){alert((L==null?void 0:L.message)||"Reset failed")}finally{C(!1)}},children:_?"Resetting":"Reset This Exam"})}):null,i.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%)",borderRadius:12,padding:"16px",marginBottom:20,border:"1px solid #cbd5e1",boxShadow:"0 2px 8px rgba(2,6,23,0.04), inset 0 1px 0 rgba(255,255,255,0.5)"},children:[i.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:12},children:"Assessment Exams"}),i.jsx("div",{className:"obe-sidebar-nav","aria-label":"Mark Entry sub-tabs",style:{display:"flex",flexWrap:"wrap",gap:8},children:ee.map((q,Y)=>i.jsx(Zr.Fragment,{children:q.cqi?i.jsx(Y8e,{active:c===q.key,label:q.label,onClick:()=>u(q.key),isCqi:!0,uniqueId:String(q.key)}):i.jsx(X8e,{active:c===q.key,label:q.label,onClick:()=>u(q.key)})},q.key))})]}),c==="dashboard"&&i.jsxs("div",{children:[i.jsx("h3",{style:{margin:"0 0 6px 0"},children:"Dashboard"}),i.jsxs("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:["Quick overview for ",i.jsx("b",{children:e}),". Use the tabs to enter marks."]}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12},children:ee.filter(q=>q.key!=="dashboard").map(q=>i.jsxs("div",{className:"obe-card",children:[i.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:q.label}),i.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#6b7280"},children:["Rows saved: ",String(q.key).startsWith("cqi_")?"":z[q.key]??0]})]},q.key))}),i.jsx("div",{style:{marginTop:14},children:i.jsx(D8e,{subjectId:e})})]}),c!=="dashboard"&&i.jsxs("div",{children:[i.jsx("h3",{style:{margin:"0 0 6px 0"},children:(J=ee.find(q=>q.key===c))==null?void 0:J.label}),(()=>{const q=ee.find(L=>L.key===c)||null,Y=(q==null?void 0:q.cqi)||null;return i.jsx("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:c==="formative1"?ne==="TCPL"?"Enter and manage LAB-1 marks (experiments + totals).":"Enter and manage Formative-1 assessment marks with BTL mapping.":c==="formative2"?ne==="TCPL"?"Enter and manage LAB-2 marks (experiments + totals).":"Enter and manage Formative-2 assessment marks with BTL mapping.":c==="ssa1"?"SSA1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review1"?"Review 1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="ssa2"?"SSA2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review2"?"Review 2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="cia1"?ne==="LAB"?"CIA 1 LAB entry (CO-1/CO-2 experiments + CIA exam)":ne==="PRACTICAL"?"CIA 1 Review (Practical) - enter review marks for practical content.":"CIA 1 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="cia2"?ne==="LAB"?"CIA 2 LAB entry (CO-3/CO-4 experiments + CIA exam).":"CIA 2 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="model"?ne==="LAB"?"MODEL LAB entry (CO-5 experiments + CIA exam).":"MODEL blank table template (same layout style as CIA sheets).":String(c).startsWith("cqi_")?`CQI view for ${((Y==null?void 0:Y.assessmentType)||"assessment").toUpperCase()} (${((Y==null?void 0:Y.cos)||[]).join(", ")})`:"Enter and save marks locally for this assessment."})})(),N.loading&&R?i.jsx("div",{style:{padding:"10px 0",color:"#6b7280",fontSize:13},children:"Checking availability"}):!B&&R?i.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fdba7433",color:"#9a3412",padding:12,borderRadius:12,fontWeight:800},children:"This exam is disabled by IQAC. Please contact IQAC to enable it."}):i.jsx("fieldset",{disabled:!!G,style:{border:0,padding:0,margin:0},children:(()=>{const q=ee.find(L=>L.key===c)||null,Y=(q==null?void 0:q.cqi)||null;return c==="formative1"?ne==="TCPL"?i.jsx(fL,{subjectId:e,teachingAssignmentId:m??void 0,assessmentKey:"formative1",label:"LAB 1",coA:1,coB:2}):i.jsx(Sz,{subjectId:e,teachingAssignmentId:m??void 0}):c==="formative2"?ne==="TCPL"?i.jsx(fL,{subjectId:e,teachingAssignmentId:m??void 0,assessmentKey:"formative2",label:"LAB 2",coA:2,coB:3}):i.jsx(Kge,{subjectId:e,teachingAssignmentId:m??void 0}):c==="ssa1"?i.jsx(gxe,{subjectId:e,teachingAssignmentId:m??void 0}):c==="review1"?i.jsx(uxe,{subjectId:e,teachingAssignmentId:m??void 0}):c==="ssa2"?i.jsx(xxe,{subjectId:e,teachingAssignmentId:m??void 0}):c==="review2"?i.jsx(mxe,{subjectId:e,teachingAssignmentId:m??void 0}):c==="cia1"?ne==="LAB"?i.jsx(Bv,{subjectId:e,teachingAssignmentId:m??void 0,assessmentKey:"cia1",label:"CIA 1 LAB",coA:1,coB:2,viewerMode:!!G}):ne==="PRACTICAL"||ne==="PROJECT"?i.jsx(Ak,{subjectId:e,teachingAssignmentId:m??void 0,assessmentKey:"cia1",viewerMode:!!G}):i.jsx(wz,{subjectId:e,teachingAssignmentId:m??void 0,classType:de??null,questionPaperType:r??null}):c==="cia2"?ne==="LAB"?i.jsx(Bv,{subjectId:e,teachingAssignmentId:m??void 0,assessmentKey:"cia2",label:"CIA 2 LAB",coA:3,coB:4,viewerMode:!!G}):ne==="PRACTICAL"||ne==="PROJECT"?i.jsx(Ak,{subjectId:e,teachingAssignmentId:m??void 0,assessmentKey:"cia2",viewerMode:!!G}):i.jsx(Uge,{subjectId:e,teachingAssignmentId:m??void 0,classType:de??null,questionPaperType:r??null}):c==="model"?ne==="LAB"?i.jsx(Bv,{subjectId:e,teachingAssignmentId:m??void 0,assessmentKey:"model",label:"MODEL LAB",coA:5,coB:null,viewerMode:!!G}):ne==="PRACTICAL"||ne==="PROJECT"?i.jsx(Ak,{subjectId:e,teachingAssignmentId:m??void 0,assessmentKey:"model",viewerMode:!!G}):i.jsx(axe,{subjectId:e,teachingAssignmentId:m??void 0,classType:de??null,questionPaperType:r??null}):String(c).startsWith("cqi_")?i.jsx(_xe,{subjectId:e,teachingAssignmentId:m??void 0,classType:de??null,enabledAssessments:Z??null,assessmentType:(Y==null?void 0:Y.assessmentType)||"model",cos:(Y==null?void 0:Y.cos)||["CO1","CO2","CO3","CO4","CO5"],cqiDivider:Number(M==null?void 0:M.divider)||2,cqiMultiplier:Number(M==null?void 0:M.multiplier)||.15}):i.jsx(Q8e,{subjectId:e,tab:c})})()})]},`${c}_${j}`)]})}function J8e(){var m,g,b,y;const{courseCode:e,taId:t}=M0(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),n=x.useMemo(()=>t?Number(t):NaN,[t]),[a,s]=x.useState(null),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null);x.useEffect(()=>{let v=!0;return(async()=>{if(r)try{const[w,_]=await Promise.all([sl(),Ld()]);if(!v)return;const j=(w||[]).filter(A=>String((A==null?void 0:A.course_code)||"").trim().toUpperCase()===r.toUpperCase())[0];if(j)if(l(j!=null&&j.class_type?String(j.class_type):null),u(j!=null&&j.question_paper_type?String(j.question_paper_type):null),String((j==null?void 0:j.class_type)||"").trim().toUpperCase()==="SPECIAL"){f([]);try{const M=await lS(r);f(Array.isArray(M)?M:[])}catch{const M=j==null?void 0:j.enabled_assessments;f(Array.isArray(M)?M.map(P=>String(P).trim().toLowerCase()).filter(Boolean):[])}}else f(null);else{const A=(_||[]).find(M=>String((M==null?void 0:M.course_code)||"").trim().toUpperCase()===r.toUpperCase());l(A!=null&&A.class_type?String(A.class_type):null),u(null),f(null)}}catch{}})(),()=>{v=!1}},[r]),x.useEffect(()=>{let v=!0;return(async()=>{if(!(!r||!Number.isFinite(n)))try{const w=await w2(r);if(!v)return;const _=(w||[]).find(C=>Number(C.teaching_assignment_id)===Number(n))||null;s(_)}catch{if(!v)return;s(null)}})(),()=>{v=!1}},[r,n]);const p=x.useMemo(()=>Number.isFinite(n)?[{id:n,subject_id:0,subject_code:r,subject_name:(a==null?void 0:a.course_name)||r,section_id:(a==null?void 0:a.section_id)||0,section_name:(a==null?void 0:a.section_name)||"Section",academic_year:(a==null?void 0:a.academic_year)||""}]:[],[n,r,a]),h=In(o);return!r||!Number.isFinite(n)?i.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[i.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),i.jsx("div",{style:{marginTop:10},children:i.jsx(Vi,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]}):i.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[i.jsxs("div",{children:[i.jsx("h2",{style:{margin:0,fontSize:20},children:"Mark Entry Viewer"}),i.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:r}),i.jsxs("div",{style:{color:"#6b7280",marginTop:4},children:[a?`${a.section_name}  ${a.academic_year}`:"",(m=a==null?void 0:a.staff)!=null&&m.name||(g=a==null?void 0:a.staff)!=null&&g.username?`    ${((b=a.staff)==null?void 0:b.name)||((y=a.staff)==null?void 0:y.username)}`:"",h?`    ${h}`:""]})]}),i.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:i.jsx(Vi,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(r)}`,children:"Back"})})]}),i.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:i.jsx(u6,{subjectId:r,classType:o,questionPaperType:c,enabledAssessments:d,teachingAssignmentsOverride:p,fixedTeachingAssignmentId:n,iqacResetEnabled:!0,viewerMode:!1})})]})}function Z8e(e){return e==="-"||e===null||e===void 0||e===""?" - ":String(e)}function kp(e,t){const r=Math.pow(10,t);return Math.round((e+Number.EPSILON)*r)/r}function Y4({headers:e,rows:t}){return i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:i.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:900},children:[i.jsx("thead",{children:i.jsx("tr",{children:e.map(r=>i.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#111827",background:"#f9fafb",padding:"10px 10px",borderBottom:"1px solid #e5e7eb",whiteSpace:"nowrap"},children:r},r))})}),i.jsx("tbody",{children:t.map((r,n)=>i.jsx("tr",{children:r.map((a,s)=>i.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid #f3f4f6",fontSize:12,color:"#111827",whiteSpace:s===3?"normal":"nowrap",maxWidth:s===3?360:void 0},children:Z8e(a)},s))},n))})]})})}function mR({title:e,headers:t,rows:r,collapsedByDefault:n=!1,showToggle:a=!0}){const[s,o]=x.useState(!n);return i.jsxs("section",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[i.jsx("h3",{style:{margin:"6px 0 10px 0",flex:1},children:e}),a?i.jsx("button",{"aria-label":s?"Collapse table":"Expand table",onClick:()=>o(l=>!l),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:18,padding:6,color:"#374151"},children:s?"":""}):null]}),s&&i.jsx(Y4,{headers:t,rows:r})]})}function ePe({subjectId:e,matrix:t}){var s,o,l;if(!e)return i.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Select a course to view the Articulation Matrix."});if(!t)return i.jsxs("div",{style:{border:"1px dashed #bbb",padding:16,borderRadius:8,color:"#666"},children:["No articulation matrix loaded yet for ",i.jsx("b",{children:e}),". Upload the Excel to parse page-2."]});const r=Array.isArray(t.units)?t.units:[],n=(s=t.summaries)==null?void 0:s.co_po_summary,a=["S. No","CO Mapped","Topic No.","Topic Name",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Hours"];return Array.from({length:a.length},()=>""),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[((o=t.meta)==null?void 0:o.sheet_used)&&i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Sheet: ",i.jsx("b",{children:t.meta.sheet_used})]}),r.map(c=>{const u=(c.rows||[]).map(d=>[d.s_no,d.co_mapped,d.topic_no,d.topic_name,...d.po||[],...d.pso||[],d.hours]);return i.jsxs("section",{children:[i.jsx("h3",{style:{margin:"6px 0 10px 0"},children:c.unit}),i.jsx(Y4,{headers:a,rows:u})]},c.unit)}),(()=>{const c=[],u=(f,p)=>{const h=r[f];if(!h||!Array.isArray(h.rows)||h.rows.length===0)return[p,...Array.from({length:11},()=>""),...Array.from({length:3},()=>""),""];const m=h.rows,g=m.reduce((v,w)=>{const _=Number(w.hours);return v+(Number.isFinite(_)?_:0)},0),b=[];for(let v=0;v<11;v++){const w=m.reduce((_,C)=>{const j=Number((C.po&&C.po[v])??0);return _+(Number.isFinite(j)?j:0)},0);if(g>0){const _=w/g,C=kp(_,2);b.push(C.toFixed(2))}else b.push("")}const y=[];for(let v=0;v<3;v++){const w=m.reduce((_,C)=>{const j=Number((C.pso&&C.pso[v])??0);return _+(Number.isFinite(j)?j:0)},0);if(g>0){const _=w/g,C=kp(_,2);y.push(C.toFixed(2))}else y.push("")}return[p,...b,...y,g||""]};for(let f=0;f<5;f++)c.push(u(f,`CO${f+1}`));const d=(()=>{const f=[];c.forEach(b=>{const y=b[0],w=b.slice(1,15).map(j=>{if(j===""||j===null||j===void 0)return"";const A=Number(String(j));if(!Number.isFinite(A))return"";const M=A*3,P=kp(M,2);return P===0?"":P.toFixed(2)}),_=w.map(j=>j===""?null:Number(j)).filter(j=>j!==null),C=_.length?kp(_.reduce((j,A)=>j+A,0)/_.length,2).toFixed(2):"";f.push([y,...w,C])});const h=[];for(let b=0;b<14;b++){const y=[];for(let v=0;v<f.length;v++){const w=f[v][1+b];if(w===""||w===null||w===void 0)continue;const _=Number(w);Number.isFinite(_)&&y.push(_)}y.length?h.push(kp(y.reduce((v,w)=>v+w,0)/y.length,2).toFixed(2)):h.push("")}const m=f.map(b=>b[b.length-1]).filter(b=>b!=="").map(Number),g=m.length?kp(m.reduce((b,y)=>b+y,0)/m.length,2).toFixed(2):"";return f.push(["Average",...h,g]),f})();return i.jsxs(i.Fragment,{children:[i.jsx(mR,{title:"CO  PO/PSO (Course Delivery)",headers:["COs",...Array.from({length:11},(f,p)=>`PO${p+1}`),...Array.from({length:3},(f,p)=>`PSO${p+1}`),"Course delivery"],rows:c,collapsedByDefault:!0}),i.jsx(mR,{title:"CO  PO/PSO Summary",headers:["COs",...Array.from({length:11},(f,p)=>`PO${p+1}`),...Array.from({length:3},(f,p)=>`PSO${p+1}`),"Average"],rows:d,collapsedByDefault:!1,showToggle:!1})]})})(),(l=n==null?void 0:n.rows)!=null&&l.length?i.jsxs("section",{children:[i.jsx("h3",{style:{margin:"6px 0 10px 0"},children:"CO  PO/PSO Summary"}),i.jsx(Y4,{headers:["CO",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Average"],rows:[...n.rows.map(c=>[c.label,...c.po,...c.pso,c.average]),...n.average?[[n.average.label,...n.average.po,...n.average.pso,n.average.average]]:[]]})]}):null]})}const Ei={container:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%)",padding:"2rem"},card:{maxWidth:"1400px",margin:"0 auto",background:"#ffffff",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07), 0 1px 3px rgba(0, 0, 0, 0.06)",overflow:"hidden"},header:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"2rem 2.5rem",borderBottom:"1px solid #e5e7eb"},title:{fontSize:"1.875rem",fontWeight:"700",color:"#ffffff",margin:"0",letterSpacing:"-0.025em"},subtitle:{fontSize:"0.95rem",color:"rgba(255, 255, 255, 0.9)",marginTop:"0.5rem",fontWeight:"400"},content:{padding:"2rem 2.5rem"},inputSection:{marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},label:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.025em"},input:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #e5e7eb",borderRadius:"6px",outline:"none",transition:"all 0.2s ease",fontFamily:"inherit"},inputFocus:{borderColor:"#667eea",boxShadow:"0 0 0 3px rgba(102, 126, 234, 0.1)"},actionBar:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap",marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px"},button:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:"600",color:"#ffffff",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)",outline:"none"},buttonHover:{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(102, 126, 234, 0.4)"},buttonDisabled:{background:"#9ca3af",cursor:"not-allowed",boxShadow:"none",opacity:.6},infoText:{fontSize:"0.875rem",color:"#6b7280",display:"flex",alignItems:"center",gap:"0.5rem"},infoIcon:{width:"16px",height:"16px",borderRadius:"50%",background:"#667eea",color:"#ffffff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"700"},alert:{padding:"1rem 1.25rem",borderRadius:"8px",fontSize:"0.925rem",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",fontWeight:"500"},alertSuccess:{background:"#d1fae5",color:"#065f46",border:"1px solid #6ee7b7"},alertError:{background:"#fee2e2",color:"#991b1b",border:"1px solid #fca5a5"},matrixContainer:{background:"#ffffff",borderRadius:"8px",border:"1px solid #e5e7eb",padding:"1.5rem",minHeight:"200px"},loadingSpinner:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid #ffffff",borderRadius:"50%",animation:"spin 0.6s linear infinite",marginRight:"0.5rem"}};function tPe({courseId:e,embedded:t=!1}){const[r,n]=x.useState(e||""),[a,s]=x.useState(null),[o,l]=x.useState("idle"),[c,u]=x.useState(null),[d,f]=x.useState(!1),[p,h]=x.useState(!1);x.useEffect(()=>{r&&(async()=>{l("loading"),u(null);try{const y=await I8(r);s(y),l("success")}catch(y){s(null),l("error"),u((y==null?void 0:y.message)||"Articulation Matrix fetch failed.")}})()},[r]);async function m(){if(r){l("loading"),u(null);try{const y=await I8(r);s(y),l("success");const v=Array.isArray(y==null?void 0:y.units)?y.units.length:0;u(`Loaded articulation matrix from saved CDAP. Units: ${v}.`)}catch(y){l("error"),u((y==null?void 0:y.message)||"Articulation Matrix fetch failed.")}}}const g=t?{padding:0}:Ei.container,b=t?{...Ei.card,maxWidth:"100%",margin:0,borderRadius:12,boxShadow:"none"}:Ei.card;return i.jsxs("div",{style:g,children:[i.jsx("style",{children:`
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `}),i.jsxs("div",{style:b,children:[!t&&i.jsxs("div",{style:Ei.header,children:[i.jsx("h1",{style:Ei.title,children:"Articulation Matrix"}),i.jsx("p",{style:Ei.subtitle,children:r?`Course: ${r}`:"Select a course to view the articulation matrix"})]}),i.jsxs("div",{style:t?{padding:0}:Ei.content,children:[!e&&i.jsxs("div",{style:Ei.inputSection,children:[i.jsx("label",{style:Ei.label,children:"Course ID"}),i.jsx("input",{value:r,onChange:y=>n(y.target.value),placeholder:"Enter course identifier (e.g., CS101)",style:{...Ei.input,...d?Ei.inputFocus:{}},onFocus:()=>f(!0),onBlur:()=>f(!1)})]}),i.jsxs("div",{style:Ei.actionBar,children:[i.jsxs("button",{onClick:m,disabled:o==="loading"||!r,style:{...Ei.button,...o==="loading"||!r?Ei.buttonDisabled:{},...p&&o!=="loading"&&r?Ei.buttonHover:{}},onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[o==="loading"&&i.jsx("span",{style:Ei.loadingSpinner}),o==="loading"?"Loading...":"Refresh Matrix"]}),i.jsxs("span",{style:Ei.infoText,children:[i.jsx("span",{style:Ei.infoIcon,children:"i"}),"Uses saved CDAP ticks + hours (no upload required)"]})]}),c&&i.jsxs("div",{style:{...Ei.alert,...o==="error"?Ei.alertError:Ei.alertSuccess},children:[i.jsx("span",{style:{fontSize:"1.25rem"},children:o==="error"?"":""}),c]}),i.jsx("div",{style:Ei.matrixContainer,children:i.jsx(ePe,{subjectId:r,matrix:a})})]})]})]})}const rPe="https://db.zynix.us",nPe=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":rPe;function aPe(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function iPe(e,t){if(e===401)return"Authentication required. Please login and try again.";if(e===403)return"Permission required to upload CDAP Excel files.";if(e===400)return"Invalid file. Please upload a valid CDAP Excel template.";if(e===404)return"Upload endpoint not found. Please contact admin.";const r=(t||"").trim();return r&&!r.startsWith("<")?r:`Upload failed with status ${e}. Please try again.`}function sPe({subjectId:e,onUpload:t}){const[r,n]=x.useState(null),[a,s]=x.useState("idle"),[o,l]=x.useState(null),[c,u]=x.useState(null);async function d(){var m,g,b;if(!r){s("error"),l("Please choose an Excel file first.");return}s("uploading"),l(null);const h=new FormData;h.append("file",r),e&&h.append("subject_id",e);try{const y={...aPe()},v=await fetch(`${nPe}/api/obe/upload-cdap`,{method:"POST",headers:y,body:h});if(!v.ok){const j=await v.text();s("error"),l(iPe(v.status,j));return}const w=await v.json(),_={rows:Array.isArray(w==null?void 0:w.rows)?w.rows:[],textbook:((m=w==null?void 0:w.books)==null?void 0:m.textbook)??(w==null?void 0:w.textbook)??"",reference:((g=w==null?void 0:w.books)==null?void 0:g.reference)??(w==null?void 0:w.reference)??"",activeLearningOptionsByRow:((b=w==null?void 0:w.active_learning)==null?void 0:b.optionsByRow)??(w==null?void 0:w.activeLearningOptions)??[],articulationExtras:(w==null?void 0:w.articulation_extras)??{}};u(_);const C=Array.isArray(w==null?void 0:w.rows)?w.rows.length:0;C?(s("success"),l(`Upload complete. Parsed ${C} rows from the Excel file.`)):(s("success"),l("Upload completed, but no rows were parsed. Please check the Excel template format.")),t&&t({revision:_,uploadedAt:new Date().toISOString()})}catch(y){s("error"),l((y==null?void 0:y.message)||"Upload failed. Please try again.")}}function f(h,m){for(const g of m){if(h==null)continue;if(h[g]!=null)return h[g];const b=String(g).toLowerCase();for(const y of Object.keys(h||{}))if(String(y).toLowerCase()===b)return h[y]}return""}function p(h){if(!h||!Array.isArray(h.rows)||!h.rows.length)return;const m=h.rows,g=["#","Content type","PART NO.","TOPICS TO BE COVERED (SYLLBUS TOPICS)","SUB TOPICS (WHAT TO BE TAUGHT)","BT LEVEL"],b=m.map((w,_)=>{const C=f(w,["content_type","contentType","Content type","content"]),j=f(w,["part_no","partNo","PART NO","part"]),A=f(w,["topics","topics_to_be_covered","Topics","TOPICS TO BE COVERED"]),M=f(w,["sub_topics","subTopics","Sub Topics","SUB TOPICS","sub_topics_to_be_taught"]),P=f(w,["bt_level","bt","BT LEVEL","btLevel"]);return`<tr>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${_+1}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(C??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(j??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(A??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(M??"")}</td>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${String(P??"")}</td>
      </tr>`}).join(`
`),y=`<!doctype html><html><head><meta charset="utf-8"><title>CDAP Export</title>
      <style>body{font-family:Arial,Helvetica,sans-serif;font-size:12px;padding:20px}table{border-collapse:collapse;width:100%}th{background:#f3f4f6;padding:8px;border:1px solid #ddd;text-align:left}td{vertical-align:top}</style>
      </head><body>
      <h2>CDAP Export</h2>
      <p>Exported rows: ${m.length}</p>
      <table>
        <thead><tr>${g.map(w=>`<th>${w}</th>`).join("")}</tr></thead>
        <tbody>
          ${b}
        </tbody>
      </table>
      </body></html>`,v=window.open("","_blank");if(!v){alert("Popup blocked  allow popups for this site to export PDF.");return}v.document.write(y),v.document.close(),v.focus(),setTimeout(()=>{v.print()},300)}return i.jsxs("div",{children:[i.jsx("div",{style:{marginBottom:8},children:i.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:h=>{var m;return n(((m=h.target.files)==null?void 0:m[0])||null)}})}),i.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("button",{id:"cdap-upload-button",onClick:d,disabled:a==="uploading","aria-label":"Upload CDAP Excel file",title:"Upload parsed CDAP Excel",style:{background:"#1d4ed8",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",boxShadow:"0 8px 20px rgba(29,78,216,0.24)",fontWeight:600,cursor:a==="uploading"?"default":"pointer",transition:"transform 120ms ease, box-shadow 120ms ease, opacity 120ms ease",opacity:a==="uploading"?.65:1},onMouseDown:h=>{h.currentTarget.style.transform="translateY(1px)"},onMouseUp:h=>{h.currentTarget.style.transform="translateY(0)"},children:a==="uploading"?"Uploading...":"Upload Excel"}),r&&i.jsx("span",{style:{fontSize:12,color:"#555"},children:r.name})]}),a==="success"&&c&&Array.isArray(c.rows)&&c.rows.length>0&&i.jsx("div",{style:{marginTop:10},children:i.jsx("button",{onClick:()=>p(c),style:{background:"#047857",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},"aria-label":"Export PDF",title:"Export CDAP to PDF (will open print dialog)",children:"Export PDF"})}),o&&i.jsx("div",{style:{marginTop:8,fontSize:12,color:a==="error"?"#b91c1c":"#166534"},children:o})]})}function Ef(e){return String(e??"").toLowerCase().replace(/[^a-z0-9]+/g,"").trim()}function oPe(){return{}}const Q4=["Technical magazine","Journal paper reading","Real time problems","Case study","Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition","Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment","Active Projects","Journal Preparation"],gR=[{key:"unit",label:"UNIT",type:"text"},{key:"unit_name",label:"SYLLABUS (UNIT NAME)",type:"text"},{key:"co",label:"OUTCOME (WRITE THE CO)",type:"text"},{key:"content_type",label:"Content type",type:"text"},{key:"part_no",label:"PART NO.",type:"text"},{key:"topics",label:"TOPICS TO BE COVERED (SYLLBUS TOPICS)",type:"text"},{key:"sub_topics",label:"SUB TOPICS (WHAT TO BE TAUGHT)",type:"text"},{key:"bt_level",label:"BT LEVEL",type:"text"}],xR=Array.from({length:11},(e,t)=>({key:`po${t+1}`,label:`PO${t+1}`,type:"checkbox",group:"po_pso"})),yR=Array.from({length:3},(e,t)=>({key:`pso${t+1}`,label:`PSO${t+1}`,type:"checkbox",group:"po_pso"})),Xs=["SSA1","SSA2","ACTIVE LEARNING 1 (SKILL)","ACTIVE LEARNING 2 (SKILL)","ACTIVE LEARNING 1 (ATTITUDE)","ACTIVE LEARNING 2 (ATTITUDE)","SPECIAL ACTIVITY"],bf=Array.from({length:11},(e,t)=>`PO${t+1}`),sv={SSA1:["Technical magazine","Journal paper reading","Real time problems","Case study"],SSA2:["Technical magazine","Journal paper reading","Real time problems","Case study"],"ACTIVE LEARNING 1 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 2 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 1 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"ACTIVE LEARNING 2 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"SPECIAL ACTIVITY":["Active Projects","Journal Preparation"]};function lPe({subjectId:e,imported:t,onLockChange:r}){const n=x.useMemo(()=>{if(e)try{const ge=localStorage.getItem(`markEntry_selectedTa_${e}`),Ne=ge==null?NaN:Number(ge);return Number.isFinite(Ne)?Ne:void 0}catch{return}},[e]),a=(ge,Ne)=>{const dt=[...Ne];for(let Ue=0;Ue<ge.length;Ue++){const Re=ge[Ue]??[];(!dt[Ue]||String(dt[Ue]).trim()==="")&&Array.isArray(Re)&&Re.length===1&&(dt[Ue]=String(Re[0]??"").trim())}return dt},s=x.useRef(null),[o,l]=x.useState(!0),[c,u]=x.useState(1),[d,f]=x.useState(()=>{if(!e)return 100;try{const ge=localStorage.getItem(`cdap_zoom_${e}`);return ge?parseInt(ge,10):100}catch{return 100}}),[p,h]=x.useState(""),[m,g]=x.useState(""),[b,y]=x.useState(()=>Xs.map(()=>bf.map(()=>!1))),[v,w]=x.useState(()=>Xs.map(()=>"")),[_,C]=x.useState(()=>oPe()),[j,A]=x.useState(()=>Xs.map(ge=>sv[ge]??[])),[M,P]=x.useState({}),[R,N]=x.useState(!1),[T,B]=x.useState(null),[G,re]=x.useState(!1),{data:xe,loading:_e,error:V,remainingSeconds:K,publishAllowed:de,refresh:ne}=dh({assessment:"cdap",subjectCode:String(e||""),teachingAssignmentId:n}),{data:E,loading:Z,error:H,refresh:F}=Ul({assessment:"cdap",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:n,options:{poll:!0}}),{data:ee,loading:z,error:X,refresh:J}=fh({assessment:"cdap",subjectCode:String(e||""),teachingAssignmentId:n,options:{poll:!1}}),q=!!(xe!=null&&xe.global_override_active&&(xe==null?void 0:xe.global_is_open)===!1),Y=!!G||!!(ee!=null&&ee.exists&&(ee!=null&&ee.is_published)),L=!!(E!=null&&E.allowed_by_approval),U=!!(Y&&!L),[ce,W]=x.useState(""),[ae,he]=x.useState(!1),[ze,ke]=x.useState(null),[qe,Ie]=x.useState(null),[Ve,Qe]=x.useState(!1),[Tt,vt]=x.useState(""),[Xe,Be]=x.useState(!1),[ct,nt]=x.useState(null);x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_active_learning_draft_${e}`,JSON.stringify({dropdowns:v,grid:b,ts:Date.now()})),window.dispatchEvent(new CustomEvent("cdap-active-learning-changed",{detail:{subjectId:e}}))}catch{}},[e,v,b]),x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_zoom_${e}`,d.toString())}catch{}},[e,d]);const Se=ge=>String(ge??"").replace(/\s+/g," ").trim().toUpperCase().includes("#N/A"),Te=ge=>ge.filter(Ne=>!Se(Ne==null?void 0:Ne.content_type)),Dt=x.useMemo(()=>[...gR,...xR,...yR],[]),wt=x.useMemo(()=>{const ge={};for(const Ne of Dt)ge[Ne.key]=Ne.type==="checkbox"?!1:"";return ge},[Dt]),[Pt,Wt]=x.useState(()=>[structuredClone(wt)]),Ot=ge=>{const Ne=Ef(ge);if(Ne===Ef("SPECIAL ACTIVITY")){const dt=Ef("Active Projects");if(Array.isArray(_==null?void 0:_[dt])&&_[dt].length===11)return _[dt]}if(Array.isArray(_==null?void 0:_[Ne])&&_[Ne].length===11)return _[Ne];for(const dt of Q4){const Ue=Ef(dt);if(Ue===Ne&&Array.isArray(_==null?void 0:_[Ue])&&_[Ue].length===11)return _[Ue]}for(const dt of Q4){const Ue=Ef(dt);if((Ue.includes(Ne)||Ne.includes(Ue))&&Array.isArray(_==null?void 0:_[Ue])&&_[Ue].length===11)return _[Ue]}return null},Ht=(ge,Ne)=>{const dt=ge.map(Ue=>[...Ue]);for(let Ue=0;Ue<Xs.length;Ue++){const Re=(Ne==null?void 0:Ne[Ue])??"";if(!Re)continue;const xt=Ot(Re);if(!(!Array.isArray(xt)||xt.length!==11))for(let at=0;at<bf.length;at++)dt[Ue][at]=!!xt[at]}return dt};x.useEffect(()=>{if(!e)return;let ge=!0;return(async()=>{try{B(null),N(!0);const dt=await g9(e,n);if(!ge)return;const Ue=String((dt==null?void 0:dt.status)||"").toLowerCase()==="published";if(re(Ue),Ue&&(Qe(!1),nt(null)),!dt){Wt([structuredClone(wt)]),h(""),g(""),y(Xs.map(()=>bf.map(()=>!1))),w(Xs.map(()=>"")),A(Xs.map(ot=>sv[ot]??[])),re(!1);return}const Re=Array.isArray(dt.rows)?dt.rows:[];Wt(Re.length?Te(Re):[structuredClone(wt)]);const xt=dt.books&&typeof dt.books=="object"?dt.books:{};h(typeof xt.textbook=="string"?xt.textbook:""),g(typeof xt.reference=="string"?xt.reference:"");const at=dt.active_learning&&typeof dt.active_learning=="object"?dt.active_learning:{},er=Array.isArray(at.dropdowns)?at.dropdowns.map(ot=>ot==null?"":String(ot)):[],oe=Array.isArray(at.grid)?at.grid:[],ue=Array.isArray(at.optionsByRow)?at.optionsByRow:null,Q=at.articulation_extras&&typeof at.articulation_extras=="object"?at.articulation_extras:{};P(Q);const ye=Xs.map((ot,it)=>bf.map((We,De)=>{var Je;const pe=(Je=oe==null?void 0:oe[it])==null?void 0:Je[De];return pe===!0||pe==="true"||pe===1||pe==="1"||String(pe).trim().toLowerCase()==="x"?!0:!!pe})),je=er.length===Xs.length?er.slice(0,Xs.length):Xs.map(()=>""),Ce=ue&&Array.isArray(ue)?a(ue,je):je;if(w(Ce),y(Ht(ye,Ce)),ue&&Array.isArray(ue)){const ot=Xs.map((it,We)=>{const De=ue==null?void 0:ue[We];return Array.isArray(De)?De.map(pe=>String(pe??"")).map(pe=>pe.trim()).filter(Boolean):[]});A(ot)}else A(Xs.map(ot=>sv[ot]??[]))}catch(dt){if(!ge)return;B((dt==null?void 0:dt.message)||"Failed to load CDAP from cloud"),Wt([structuredClone(wt)])}finally{ge&&N(!1)}})(),()=>{ge=!1}},[e,wt]),x.useEffect(()=>{r&&r(!!U)},[U,r]),x.useEffect(()=>{let ge=!0;const Ne=async()=>{try{const Ue=await y9();ge&&C(Ue)}catch{}};Ne();const dt=Lre(()=>Ne());return()=>{ge=!1,dt()}},[]),x.useEffect(()=>{if(t&&!U){if(Array.isArray(t.rows)&&t.rows.length&&Wt(Te(t.rows)),typeof t.textbook=="string"&&h(t.textbook),typeof t.reference=="string"&&g(t.reference),Array.isArray(t.activeLearningOptionsByRow)&&t.activeLearningOptionsByRow.length){const ge=Xs.map((Ue,Re)=>{var at;const xt=(at=t.activeLearningOptionsByRow)==null?void 0:at[Re];return Array.isArray(xt)?xt.map(er=>String(er??"")).map(er=>er.trim()).filter(Boolean):[]}),dt=a(ge,v);A(ge),w(dt),y(Ue=>Ht(Ue,dt))}t.articulationExtras&&typeof t.articulationExtras=="object"&&P(t.articulationExtras)}},[t,U]);const Pr=async()=>{if(e){he(!0),ke(null),Ie(null),B(null);try{await R0({assessment:"cdap",subject_code:e,reason:String(ce||"").trim()||void 0,teaching_assignment_id:n}),ke("Request sent to IQAC for approval.")}catch(ge){Ie((ge==null?void 0:ge.message)||"Failed to request approval")}finally{he(!1),ne()}}},jt=async()=>{if(!e)return;const ge=String(Tt||"").trim();if(!ge){nt("Reason is required.");return}Be(!0),nt(null);try{await qo({assessment:"cdap",subject_code:e,scope:"MARK_ENTRY",reason:ge,teaching_assignment_id:n}),alert("Edit request sent to IQAC."),Qe(!1)}catch(Ne){nt((Ne==null?void 0:Ne.message)||"Failed to request edit")}finally{Be(!1),F(),J({silent:!0}),ne()}};x.useEffect(()=>{y(ge=>Ht(ge,v))},[_]);const ur=x.useMemo(()=>{const ge=new Map;let Ne=null;return Pt.forEach((dt,Ue)=>{const Re=dt.unit??"",xt=Re!==""?String(Re):"";xt&&(Ne=xt);const at=xt||Ne||String(Math.floor(Ue/9)+1),er=ge.get(at)??{key:at,items:[]};er.items.push({row:dt,index:Ue}),ge.set(at,er)}),Array.from(ge.values()).sort((dt,Ue)=>{const Re=Number(dt.key),xt=Number(Ue.key);return!Number.isNaN(Re)&&!Number.isNaN(xt)?Re-xt:dt.key.localeCompare(Ue.key)})},[Pt]),Ir=(ge,Ne,dt)=>{if(Ne==="content_type"&&Se(dt)){Wt(Ue=>Ue.filter((Re,xt)=>xt!==ge));return}Wt(Ue=>{const Re=[...Ue];return Re[ge]={...Re[ge],[Ne]:dt},Re})},Rr=()=>Wt(ge=>[...ge,structuredClone(wt)]),Nr=ge=>Wt(Ne=>Ne.filter((dt,Ue)=>Ue!==ge)),zr=ge=>{Wt(Ne=>{const dt=structuredClone(wt);dt.unit=ge;let Ue=null,Re=-1,xt=-1;for(let er=0;er<Ne.length;er++){const oe=Ne[er].unit??"",ue=oe!==""?String(oe):"";ue&&(Ue=ue),(ue||Ue||String(Math.floor(er/9)+1))===String(ge)&&(xt===-1&&(xt=er),Re=er)}return xt!==-1&&(dt.unit_name=Ne[xt].unit_name??"",dt.co=Ne[xt].co??""),Re===-1?[...Ne,dt]:[...Ne.slice(0,Re+1),dt,...Ne.slice(Re+1)]})},_n=async()=>{if(!e){alert("No subject selected.");return}if(q){B("Publishing is disabled by IQAC.");return}if(!de){B("Publish window is closed. Please request IQAC approval.");return}try{B(null),N(!0),await x9({subjectId:e,status:"published",teaching_assignment_id:n,rows:Pt,books:{textbook:p,reference:m},active_learning:{grid:b,dropdowns:v,optionsByRow:j,articulation_extras:M}}),re(!0),alert("Published to cloud.")}catch(ge){alert((ge==null?void 0:ge.message)||"Failed to save to cloud")}finally{N(!1),ne(),F(),J({silent:!0})}};x.useEffect(()=>{if(!o){u(1);return}const ge=()=>{const Ue=s.current;if(!Ue)return;const Re=Ue.querySelector('table[data-cdap-table="1"]');if(!Re)return;const xt=Ue.clientWidth,at=Re.scrollWidth;if(!xt||!at)return;const oe=(xt-24)/at,ue=Math.min(1,Math.max(.35,oe));u(ue)};ge();const Ne=s.current;if(!Ne)return;const dt=new ResizeObserver(()=>ge());return dt.observe(Ne),()=>dt.disconnect()},[o,Pt]);const Yr=gR.slice(3,8),pn=[...xR,...yR];return i.jsxs("div",{style:{border:"1px solid #dbe4f0",borderRadius:14,padding:18,background:"#fff",boxShadow:"0 2px 8px rgba(15, 23, 42, 0.06)",width:"100%"},children:[i.jsx("style",{children:`
        .cdap-slider::-webkit-slider-thumb {
          appearance: none;
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .cdap-slider::-moz-range-thumb {
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          border: none;
        }
        .cdap-slider::-webkit-slider-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
        }
        .cdap-slider::-moz-range-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
          border: none;
        }
      `}),R?i.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#64748b"},children:"Loading from cloud"}):T?i.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#b91c1c"},children:T}):null,U?i.jsx("div",{style:{marginBottom:12,padding:"12px 16px",background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",border:"1px solid #fbbf24",borderRadius:10,color:"#92400e",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:i.jsx("span",{children:" Published  Document is read-only. Use Request Edit to make changes."})}):null,i.jsx("div",{style:{marginBottom:10,fontSize:12,color:de&&!q?"#065f46":"#b91c1c"},children:_e?"Checking publish due time":V||(xe!=null&&xe.due_at?i.jsxs(i.Fragment,{children:["Due: ",new Date(xe.due_at).toLocaleString(),"  Remaining: ",D0(K),xe.allowed_by_approval&&xe.approval_until?i.jsxs(i.Fragment,{children:["  Approved until ",new Date(xe.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Z||H?i.jsx("div",{style:{marginBottom:10,fontSize:12,color:H?"#b91c1c":"#64748b"},children:H||"Checking edit approval"}):Y&&L&&(E!=null&&E.approval_until)?i.jsxs("div",{style:{marginBottom:10,fontSize:12,color:"#065f46"},children:["Edit approved until ",new Date(E.approval_until).toLocaleString(),"."]}):null,z||X?i.jsx("div",{style:{marginBottom:10,fontSize:12,color:X?"#b91c1c":"#64748b"},children:X||"Checking lock status"}):null,q?i.jsxs("div",{style:{marginBottom:12,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the document, but editing and publishing are locked."}),i.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:i.jsx("button",{className:"obe-btn",onClick:()=>ne(),disabled:_e,children:"Refresh"})})]}):!de&&!Y?i.jsxs("div",{style:{marginBottom:12,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),i.jsx("textarea",{value:ce,onChange:ge=>W(ge.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),qe?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c",fontWeight:700},children:qe}):null,i.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[i.jsx("button",{className:"obe-btn",onClick:()=>ne(),disabled:ae||_e,children:"Refresh"}),i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Pr,disabled:ae,children:ae?"Requesting":"Request Approval"})]}),ze?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:ze}):null]}):null,i.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:12,padding:12,background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:12,marginBottom:16},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:"Revised CDP Editor"}),i.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"Interactive spreadsheet interface"})]}),i.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,background:"#fff",border:"1px solid #e2e8f0",borderRadius:10,padding:"6px 10px"},children:[i.jsx(Ate,{size:16,color:"#64748b"}),i.jsx("input",{type:"range",min:"50",max:"200",step:"10",value:d,onChange:ge=>f(parseInt(ge.target.value,10)),className:"cdap-slider",style:{width:110}}),i.jsx(kte,{size:16,color:"#64748b"}),i.jsxs("span",{style:{fontSize:12,color:"#334155",minWidth:36},children:[d,"%"]})]}),i.jsxs("button",{onClick:()=>l(ge=>!ge),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #cbd5f5",background:o?"#111827":"#fff",color:o?"#fff":"#111827",cursor:"pointer",fontWeight:600,fontSize:12},children:["Fit Screen: ",o?"ON":"OFF"]}),i.jsx("button",{onClick:Rr,disabled:U,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #059669",background:U?"#d1d5db":"#10b981",color:"#fff",cursor:U?"not-allowed":"pointer",fontWeight:600,fontSize:12,opacity:U?.5:1},children:"Add Row"}),i.jsx("button",{onClick:()=>{if(!U)return _n();Qe(ge=>!ge),nt(null)},disabled:Xe,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #2563eb",background:U?"#16a34a":"#2563eb",color:"#fff",cursor:Xe?"not-allowed":"pointer",fontWeight:600,fontSize:12,opacity:Xe?.6:1},children:U?"Request Edit":"Publish"})]})]}),U&&Ve?i.jsxs("div",{style:{marginBottom:16,border:"1px solid #e2e8f0",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontWeight:800,color:"#0f172a",marginBottom:8},children:"Reason (required)"}),i.jsx("textarea",{value:Tt,onChange:ge=>vt(ge.target.value),rows:3,style:{width:"100%",padding:10,border:"1px solid #cbd5e1",borderRadius:10,fontSize:13,background:"#fff"},placeholder:"Why do you need to edit this published CDAP?"}),ct?i.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c",fontWeight:700},children:ct}):null,i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:10},children:[i.jsx("button",{type:"button",className:"obe-btn",onClick:()=>Qe(!1),disabled:Xe,children:"Cancel"}),i.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:jt,disabled:Xe||!String(Tt||"").trim(),children:Xe?"Requesting":"Confirm Request"})]})]}):null,i.jsx("div",{ref:s,children:ur.map(ge=>{var dt;const Ne=(dt=ge.items[0])==null?void 0:dt.row;return Ne?i.jsxs("div",{style:{border:"1px solid #dbe4f0",borderRadius:14,padding:16,background:"#fff",marginBottom:16},children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(240px, 1fr))",gap:16,marginBottom:12},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:12,color:"#1f2937",fontWeight:600},children:"UNIT NUMBER"}),i.jsx("textarea",{value:Ne.unit??"",onChange:Ue=>ge.items.forEach(Re=>Ir(Re.index,"unit",Ue.target.value)),disabled:U,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,fontSize:12,background:U?"#f3f4f6":"#fff",cursor:U?"not-allowed":"text"},rows:2})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:12,color:"#1f2937",fontWeight:600},children:"SYLLABUS (UNIT NAME)"}),i.jsx("textarea",{value:Ne.unit_name??"",onChange:Ue=>ge.items.forEach(Re=>Ir(Re.index,"unit_name",Ue.target.value)),disabled:U,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,fontSize:12,background:U?"#f3f4f6":"#fff",cursor:U?"not-allowed":"text"},rows:2})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:12,color:"#1f2937",fontWeight:600},children:"COURSE OUTCOME (CO)"}),i.jsx("textarea",{value:Ne.co??"",onChange:Ue=>ge.items.forEach(Re=>Ir(Re.index,"co",Ue.target.value)),disabled:U,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,fontSize:12,background:U?"#f3f4f6":"#fff",cursor:U?"not-allowed":"text"},rows:2})]})]}),i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e2e8f0",borderRadius:10},children:i.jsx("div",{style:o?{transform:`scale(${c*(d/100)})`,transformOrigin:"left top",width:`${Math.max(1,100/(c*(d/100)))}%`}:{transform:`scale(${d/100})`,transformOrigin:"left top",width:`${Math.max(1,100/(d/100))}%`},children:i.jsxs("table",{"data-cdap-table":"1",style:{borderCollapse:"collapse",minWidth:1e3,width:"100%",fontSize:11},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{border:"1px solid #e2e8f0",padding:6,background:"#f8fafc"},children:"#"}),Yr.map(Ue=>i.jsx("th",{style:{border:"1px solid #e2e8f0",padding:6,background:"#f8fafc"},children:Ue.label},Ue.key)),pn.map(Ue=>i.jsx("th",{style:{border:"1px solid #e2e8f0",padding:6,background:"#fff7ed",textAlign:"center"},children:Ue.label},Ue.key)),i.jsx("th",{style:{border:"1px solid #e2e8f0",padding:6,background:"#f8fafc"},children:"TOTAL HOURS REQUIRED"}),i.jsx("th",{style:{border:"1px solid #e2e8f0",padding:6,background:"#f8fafc"},children:"Actions"})]})}),i.jsx("tbody",{children:ge.items.map((Ue,Re)=>i.jsx(x.Fragment,{children:i.jsxs("tr",{style:{background:Re%2===0?"#fff":"#f9fafb"},children:[i.jsx("td",{style:{border:"1px solid #e2e8f0",padding:6},children:Re+1}),Yr.map(xt=>i.jsx("td",{style:{border:"1px solid #e2e8f0",padding:4},children:i.jsx("textarea",{value:Ue.row[xt.key]??"",onChange:at=>Ir(Ue.index,xt.key,at.target.value),disabled:U,style:{width:"100%",border:"1px solid #cbd5e1",borderRadius:4,padding:4,fontSize:11,background:U?"#f3f4f6":"#fff",cursor:U?"not-allowed":"text"},rows:2})},xt.key)),pn.map(xt=>i.jsx("td",{style:{border:"1px solid #e2e8f0",padding:4,textAlign:"center"},children:i.jsx("input",{type:"checkbox",checked:!!Ue.row[xt.key],onChange:at=>Ir(Ue.index,xt.key,at.target.checked),disabled:U,style:{cursor:U?"not-allowed":"pointer"}})},xt.key)),i.jsx("td",{style:{border:"1px solid #e2e8f0",padding:4},children:i.jsx("input",{type:"text",value:Ue.row.total_hours_required??"",onChange:xt=>Ir(Ue.index,"total_hours_required",xt.target.value),disabled:U,style:{width:70,border:"1px solid #cbd5e1",borderRadius:4,padding:4,fontSize:11,background:U?"#f3f4f6":"#fff",cursor:U?"not-allowed":"text"}})}),i.jsx("td",{style:{border:"1px solid #e2e8f0",padding:4,textAlign:"center"},children:i.jsx("button",{type:"button",onClick:()=>Nr(Ue.index),disabled:U,style:{padding:"4px 8px",background:U?"#d1d5db":"#ef4444",color:"#fff",border:"none",borderRadius:6,cursor:U?"not-allowed":"pointer",fontSize:11,opacity:U?.5:1},children:"Delete"})})]})},Ue.index))})]})})}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("button",{type:"button",onClick:()=>zr(ge.key),disabled:U,style:{padding:"8px 12px",background:U?"#d1d5db":"#059669",color:"#fff",border:"none",borderRadius:8,cursor:U?"not-allowed":"pointer",fontWeight:600,opacity:U?.5:1},children:["Add Row to Unit ",ge.key]})})]},ge.key):null})}),i.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#f8fafc"},children:[i.jsx("h4",{style:{marginBottom:10},children:"Reference Materials"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:16},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Textbook Details"}),i.jsx("textarea",{value:p,onChange:ge=>h(ge.target.value),disabled:U,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:U?"#f3f4f6":"#fff",cursor:U?"not-allowed":"text"},placeholder:"Textbook details (Excel: Column B, Row 64)"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Reference Book Details"}),i.jsx("textarea",{value:m,onChange:ge=>g(ge.target.value),disabled:U,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:U?"#f3f4f6":"#fff",cursor:U?"not-allowed":"text"},placeholder:"Reference book details (Excel: Column B, Row 68)"})]})]})]}),i.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[i.jsxs("div",{children:[i.jsx("h4",{style:{margin:0},children:"Active Learning Mapping"}),i.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"7  11 PO mapping matrix"})]}),i.jsx("button",{type:"button",onClick:()=>{y(Xs.map(()=>bf.map(()=>!1))),w(Xs.map(()=>""))},disabled:U,style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e2e8f0",background:U?"#e5e7eb":"#f8fafc",cursor:U?"not-allowed":"pointer",opacity:U?.5:1},children:"Clear All"})]}),i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{borderCollapse:"collapse",minWidth:900,width:"100%"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Activity Type"}),i.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Specific Activity"}),bf.map(ge=>i.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#fff7ed",textAlign:"center"},children:ge},ge))]})}),i.jsx("tbody",{children:Xs.map((ge,Ne)=>i.jsxs("tr",{style:{background:Ne%2===0?"#fff":"#f9fafb"},children:[i.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,fontWeight:600},children:ge}),i.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8},children:i.jsxs("select",{value:v[Ne]??"",onChange:dt=>{const Ue=dt.target.value;w(Re=>{const xt=[...Re];return xt[Ne]=Ue,xt}),y(Re=>{const xt=Re.map(er=>[...er]),at=Ot(Ue);if(Array.isArray(at)&&at.length===11)for(let er=0;er<bf.length;er++)xt[Ne][er]=!!at[er];return xt})},disabled:U,style:{width:"100%",padding:6,border:"1px solid #cbd5e1",borderRadius:6,background:U?"#f3f4f6":"#fff",cursor:U?"not-allowed":"pointer"},children:[i.jsx("option",{value:"",children:"-- Select Activity --"}),(Array.isArray(j==null?void 0:j[Ne])&&(j!=null&&j[Ne].length)?j==null?void 0:j[Ne]:sv[ge]??[]).map(Re=>String(Re??"").trim()).filter(Boolean).filter((Re,xt,at)=>at.indexOf(Re)===xt).map(Re=>i.jsx("option",{value:Re,children:Re},Re))]})}),bf.map((dt,Ue)=>i.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,textAlign:"center"},children:i.jsx("input",{type:"checkbox",checked:!!b[Ne][Ue],disabled:U||(()=>{const Re=(v==null?void 0:v[Ne])??"";if(!Re)return!1;const xt=Ot(Re);return Array.isArray(xt)&&xt.length===11})(),onChange:Re=>{const xt=Re.target.checked;y(at=>{const er=at.map(oe=>[...oe]);return er[Ne][Ue]=xt,er})},style:{cursor:U?"not-allowed":"pointer"}})},dt))]},ge))})]})})]})]})}function cPe({courseId:e,showHeader:t=!0,showCourseInput:r=!0}){const[n,a]=x.useState(e||""),[s,o]=x.useState(null),[l,c]=x.useState("idle"),[u,d]=x.useState(null),[f,p]=x.useState(!1),h=Zr.useMemo(()=>{if(n)try{const m=localStorage.getItem(`markEntry_selectedTa_${n}`),g=m==null?NaN:Number(m);return Number.isFinite(g)?g:void 0}catch{return}},[n]);return x.useEffect(()=>{e&&a(e)},[e]),i.jsxs("div",{children:[t&&i.jsxs("h2",{children:["CDAP - ",n||"No course selected"]}),r&&!e&&i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("label",{style:{marginRight:8},children:"Course ID:"}),i.jsx("input",{value:n,onChange:m=>a(m.target.value),placeholder:"Enter course id",style:{padding:6,border:"1px solid #ccc",borderRadius:4}})]}),f?null:i.jsx("div",{style:{marginBottom:12},children:i.jsx(sPe,{subjectId:n,onUpload:async m=>{o(m);const g=(m==null?void 0:m.revision)||m;if(!(!n||!g)&&!(!Array.isArray(g==null?void 0:g.rows)||g.rows.length===0))try{c("saving"),d(null),await x9({subjectId:n,status:"draft",rows:g.rows,books:{textbook:g.textbook||"",reference:g.reference||""},teaching_assignment_id:h,active_learning:{grid:[],dropdowns:[],optionsByRow:g.activeLearningOptionsByRow||[],articulation_extras:g.articulationExtras||{}}}),c("saved"),d("Saved parsed CDAP to cloud (draft).")}catch(b){c("error"),d((b==null?void 0:b.message)||"Auto-save failed. You can still publish from the editor.")}}})}),u&&i.jsx("div",{style:{marginBottom:12,fontSize:12,color:l==="error"?"#b91c1c":"#166534"},children:u}),i.jsx("div",{style:{marginBottom:12},children:i.jsx(lPe,{subjectId:n,imported:(s==null?void 0:s.revision)||s,onLockChange:m=>p(!!m)})})]})}function jp({value:e,onChange:t,min:r,max:n}){return i.jsx("input",{type:"number",value:e,onChange:a=>{const s=a.target.value;t(s===""?"":Number(s))},min:r,max:n,style:{width:76,padding:"6px 8px",borderRadius:8,border:"1px solid #e6eef8",outline:"none",fontSize:13}})}function bR(e){const t=typeof e.band1=="number"?e.band1:0,r=typeof e.band2=="number"?e.band2:0,n=typeof e.band3=="number"?e.band3:0;if(!(t+r+n))return"-";const s=Math.max(t,r,n);return s===t?1:s===r?2:3}function uPe(e){return e===1?{label:"LOW LEVEL",code:"LL"}:e===2?{label:"MEDIUM LEVEL",code:"ML"}:e===3?{label:"HIGH LEVEL",code:"HL"}:{label:"",code:"-"}}const ar={page:{padding:20,width:"100%",boxSizing:"border-box",minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"flex-start",margin:0,fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947",background:"transparent"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)",width:"100%",maxWidth:1200,margin:"18px",flex:"1 1 auto"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},table:{width:"100%",borderCollapse:"collapse",marginTop:8,tableLayout:"auto",display:"table"},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13,whiteSpace:"nowrap"},thLeft:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"left",fontSize:13,whiteSpace:"nowrap",minWidth:220},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left",minWidth:220},cellYellow:{background:"#fef9c3"},cellGreen:{background:"#ecfdf3"},link:{color:"#0b4a6f",textDecoration:"underline",fontWeight:700},btn:{border:"1px solid #e6eef8",background:"#fbfdff",padding:"8px 10px",borderRadius:10,cursor:"pointer",fontWeight:700,color:"#0b4a6f"},pill:{display:"inline-flex",alignItems:"center",gap:8,padding:"8px 10px",borderRadius:10,background:"#fbfdff",border:"1px solid #e6eef8",fontSize:13,color:"#234451"}};function tj(e){return String(e||"").trim().toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9]/g,"")}function dPe(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=parseFloat(e.replace(/[^0-9.\-]/g,""));return Number.isFinite(t)?t:null}return null}function fPe(e){return e<=6?"HC":e<=8?"MC":"EC"}function hPe(e){return e==="EC"?"L1":e==="MC"?"L2":e==="HC"?"L3":"-"}async function pPe(e){var m;let t;try{t=await import("xlsx")}catch{throw new Error('Missing dependency "xlsx". Install it with: npm install xlsx  (or yarn add xlsx / pnpm add xlsx)')}const r=await e.arrayBuffer(),n=t.read(r,{type:"array"}),a=(m=n.SheetNames)==null?void 0:m[0];if(!a)throw new Error("No sheet found in the Excel file.");const s=n.Sheets[a],o=t.utils.sheet_to_json(s,{defval:""})||[];if(!o.length)throw new Error("Excel sheet is empty.");const l=Object.keys(o[0]||{}),c=new Map;l.forEach(g=>c.set(tj(g),g));const u=c.get("grade")||l.find(g=>tj(g).includes("grade"))||null,d=c.get("gpaconversion")||c.get("gpaconvert")||l.find(g=>{const b=tj(g);return b.includes("gpaconversion")||b.includes("gpaconvert")||b==="gpa"})||null;if(!u||!d)throw new Error('Excel must contain columns for "Grade" and "GPA conversion".');const f=[];for(const g of o){if(!String(g[u]??"").trim())continue;const y=dPe(g[d]);y!==null&&f.push(y)}if(!f.length)throw new Error('No numeric "GPA conversion" values found.');const p=f.reduce((g,b)=>g+b,0)/f.length,h=Number(p.toFixed(2));return{fileName:e.name,studentsCount:f.length,meanGpa:h,courseLevel:fPe(h)}}function mPe({courseId:e,courseCode:t,courseName:r,embedded:n}){const a=Xo(),s=so(),o=(a.pathname||"").toLowerCase().includes("/lca/pbr"),[l,c]=x.useState({courseCode:t??e??"",courseName:r??"",credit:"",courseModule:""});x.useEffect(()=>{c(de=>({...de,courseCode:t??e??de.courseCode,courseName:r??de.courseName}))},[e,t,r]);const[u,d]=x.useState({band1:"",band2:"",band3:""}),f=x.useMemo(()=>bR(u),[u]),[p,h]=x.useState([{name:"Prerequisite 1",band1:"",band2:"",band3:""}]),m=x.useMemo(()=>p.map(de=>bR({band1:de.band1,band2:de.band2,band3:de.band3})),[p]),g=x.useMemo(()=>{const de=m.filter(E=>E!=="-");if(!de.length)return"";const ne=de.reduce((E,Z)=>E+Z,0);return Number((ne/de.length).toFixed(2))},[m]),b=x.useMemo(()=>g===""?"":Math.floor(g),[g]),y=x.useMemo(()=>b===""||b===0?"-":b===1||b===2||b===3?b:"-",[b]),v=x.useMemo(()=>uPe(y),[y]),w=x.useMemo(()=>y==="-"?"-":`L${y}`,[y]),[_,C]=x.useState(null),[j,A]=x.useState(null),[M,P]=x.useState(null),[R,N]=x.useState(null),[T,B]=x.useState("-"),G=x.useMemo(()=>j?j.courseLevel:_?_.courseLevel:T&&T!=="-"?T:"-",[_,j,T]),re=x.useMemo(()=>hPe(G),[G]),xe=x.useMemo(()=>re!=="-"?re:w,[w,re]),_e=e?`/obe/course/${encodeURIComponent(e)}`:"/obe/course",V=async(de,ne)=>{if(P(null),!ne){de==="cay1"?C(null):A(null);return}try{N(de);const E=await pPe(ne);de==="cay1"?C(E):A(E)}catch(E){P(String((E==null?void 0:E.message)||E||"Failed to parse Excel")),de==="cay1"?C(null):A(null)}finally{N(null)}},K=de=>n?i.jsx(i.Fragment,{children:de}):i.jsx("div",{style:ar.page,children:i.jsx("div",{style:ar.card,children:de})});return K(o?i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12},children:[i.jsxs("div",{children:[i.jsx("h2",{style:ar.title,children:"Previous Batch Result (PBR)"}),i.jsx("div",{style:ar.subtitle,children:"Upload up to 2 Excel files (max 2)."})]}),i.jsx("button",{type:"button",onClick:()=>s(`${_e}/lca`),style:ar.btn,children:"Back"})]}),i.jsx("div",{style:{height:14}}),i.jsxs("div",{style:{marginBottom:8,display:"flex",gap:12,alignItems:"center"},children:[i.jsx("div",{style:{color:"#0b4a6f",fontWeight:700},children:"Fallback course level (if no Excel):"}),i.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"radio",name:"pbrManual",value:"HC",checked:T==="HC",onChange:()=>B("HC")}),"HARD COURSE (HC)"]}),i.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"radio",name:"pbrManual",value:"MC",checked:T==="MC",onChange:()=>B("MC")}),"MEDIUM COURSE (MC)"]}),i.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[i.jsx("input",{type:"radio",name:"pbrManual",value:"EC",checked:T==="EC",onChange:()=>B("EC")}),"EASY COURSE (EC)"]}),i.jsx("button",{type:"button",onClick:()=>B("-"),style:{marginLeft:8,...ar.btn,padding:"6px 8px"},children:"Clear"})]}),i.jsx("table",{style:ar.table,children:i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:800,width:220},children:"CAY-1 Excel"}),i.jsx("td",{style:{...ar.tdLeft,...ar.cellGreen},children:i.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:de=>{var ne;return V("cay1",((ne=de.target.files)==null?void 0:ne[0])||null)}})})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:800},children:"CAY-2 Excel"}),i.jsx("td",{style:{...ar.tdLeft,...ar.cellGreen},children:i.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:de=>{var ne;return V("cay2",((ne=de.target.files)==null?void 0:ne[0])||null)}})})]})]})}),R&&i.jsxs("div",{style:{marginTop:10,fontSize:13,color:"#3d5566"},children:["Parsing ",R.toUpperCase()," Excel"]}),M&&i.jsx("div",{style:{marginTop:10,fontSize:13,color:"#b42318",fontWeight:700},children:M}),i.jsx("div",{style:{height:14}}),i.jsxs("table",{style:ar.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:ar.thLeft,children:"DATASET"}),i.jsx("th",{style:ar.th,children:"FILE"}),i.jsx("th",{style:ar.th,children:"STUDENTS"}),i.jsx("th",{style:ar.th,children:"MEAN GPA"}),i.jsx("th",{style:ar.th,children:"COURSE LEVEL"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:900},children:"CAY-1"}),i.jsx("td",{style:ar.tdLeft,children:(_==null?void 0:_.fileName)||""}),i.jsx("td",{style:ar.td,children:(_==null?void 0:_.studentsCount)??""}),i.jsx("td",{style:ar.td,children:_?_.meanGpa:""}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:(_==null?void 0:_.courseLevel)||""})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:900},children:"CAY-2"}),i.jsx("td",{style:ar.tdLeft,children:(j==null?void 0:j.fileName)||""}),i.jsx("td",{style:ar.td,children:(j==null?void 0:j.studentsCount)??""}),i.jsx("td",{style:ar.td,children:j?j.meanGpa:""}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:(j==null?void 0:j.courseLevel)||""})]})]})]}),i.jsx("div",{style:{height:14}}),i.jsx("table",{style:ar.table,children:i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:900,width:220},children:"PREVIOUS BATCH RESULT (PBR)"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:G==="-"?"":G}),i.jsx("td",{style:{...ar.tdLeft,fontWeight:900},children:"Learner Centric Level"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:re==="-"?"":re})]}),i.jsx("tr",{children:i.jsx("td",{style:{...ar.tdLeft,color:"#557085"},colSpan:4,children:"Course level rule: mean GPA 06 = HC, 68 = MC, >8 = EC. PBR uses CAY-2 when provided; otherwise CAY-1."})})]})})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},children:[i.jsxs("div",{children:[i.jsx("h2",{style:ar.title,children:"Learner Centric Approach"}),i.jsx("div",{style:ar.subtitle,children:"Enter values in the highlighted cells; levels are computed automatically."})]}),i.jsx("div",{style:{...ar.pill,fontWeight:800},children:"INDEX"})]}),i.jsx("table",{style:ar.table,children:i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,width:220,fontWeight:700},children:"COURSE CODE"}),i.jsx("td",{style:{...ar.tdLeft,...ar.cellGreen},children:i.jsx("input",{value:l.courseCode,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course code is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:700},children:"COURSE NAME"}),i.jsx("td",{style:{...ar.tdLeft,...ar.cellGreen},children:i.jsx("input",{value:l.courseName,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course name is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:700},children:"CREDIT OF THE COURSE"}),i.jsx("td",{style:{...ar.tdLeft,...ar.cellGreen},children:i.jsx("input",{value:l.credit,onChange:de=>c(ne=>({...ne,credit:de.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:700},children:"COURSE MODULE"}),i.jsx("td",{style:{...ar.tdLeft,...ar.cellGreen},children:i.jsx("input",{value:l.courseModule,onChange:de=>c(ne=>({...ne,courseModule:de.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]})]})}),i.jsx("div",{style:{height:16}}),i.jsx("div",{style:ar.sectionTitle,children:"STEP 1: Identifying Learner profile"}),i.jsxs("table",{style:ar.table,children:[i.jsxs("colgroup",{children:[i.jsx("col",{style:{width:220}}),i.jsx("col",{style:{width:200}}),i.jsx("col",{style:{width:200}}),i.jsx("col",{style:{width:200}}),i.jsx("col",{style:{width:100}}),i.jsx("col",{style:{width:60}})]}),i.jsxs("thead",{children:[i.jsxs("tr",{children:[i.jsx("th",{style:ar.thLeft,colSpan:4,children:"1.1 CURRENT GPA PROFILE (CGP)"}),i.jsx("th",{style:ar.th,rowSpan:3,colSpan:2,children:"LEVEL"})]}),i.jsxs("tr",{children:[i.jsx("th",{style:ar.thLeft,children:"Current batch mean GPA"}),i.jsx("th",{style:ar.th,children:"1"}),i.jsx("th",{style:ar.th,children:"2"}),i.jsx("th",{style:ar.th,children:"3"})]}),i.jsxs("tr",{children:[i.jsx("th",{style:ar.thLeft,children:"GPA"}),i.jsx("th",{style:ar.th,children:"0 - 5"}),i.jsx("th",{style:ar.th,children:"5 - 7.5"}),i.jsx("th",{style:ar.th,children:"> 7.5"})]})]}),i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:700},children:"NUMBER OF STUDENTS (CAY-1)"}),i.jsx("td",{style:{...ar.td,...ar.cellYellow},children:i.jsx(jp,{value:u.band1,onChange:de=>d(ne=>({...ne,band1:de}))})}),i.jsx("td",{style:{...ar.td,...ar.cellYellow},children:i.jsx(jp,{value:u.band2,onChange:de=>d(ne=>({...ne,band2:de}))})}),i.jsx("td",{style:{...ar.td,...ar.cellYellow},children:i.jsx(jp,{value:u.band3,onChange:de=>d(ne=>({...ne,band3:de}))})}),i.jsx("td",{style:{...ar.td,fontWeight:800,color:"#0b4a6f"},colSpan:2,children:f})]})})]}),i.jsx("div",{style:{height:14}}),i.jsxs("table",{style:ar.table,children:[i.jsxs("colgroup",{children:[i.jsx("col",{style:{width:220}}),i.jsx("col",{style:{width:200}}),i.jsx("col",{style:{width:200}}),i.jsx("col",{style:{width:200}}),i.jsx("col",{style:{width:100}}),i.jsx("col",{style:{width:60}})]}),i.jsxs("thead",{children:[i.jsxs("tr",{children:[i.jsx("th",{style:ar.thLeft,colSpan:4,children:"1.2 PRE REQUISITE PROFILE (PRP)"}),i.jsx("th",{style:ar.th,children:"LEVEL"}),i.jsx("th",{style:ar.th,children:" "})]}),i.jsxs("tr",{children:[i.jsx("th",{style:ar.thLeft,children:" "}),i.jsx("th",{style:ar.th,children:"1"}),i.jsx("th",{style:ar.th,children:"2"}),i.jsx("th",{style:ar.th,children:"3"}),i.jsx("th",{style:ar.th,children:" "}),i.jsx("th",{style:ar.th,children:" "})]}),i.jsxs("tr",{children:[i.jsx("th",{style:ar.thLeft,children:" "}),i.jsx("th",{style:ar.th,children:"0 - 5"}),i.jsx("th",{style:ar.th,children:"5 - 7.5"}),i.jsx("th",{style:ar.th,children:"> 7.5"}),i.jsx("th",{style:ar.th,children:" "}),i.jsx("th",{style:ar.th,children:" "})]})]}),i.jsxs("tbody",{children:[p.map((de,ne)=>i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:700},children:de.name}),i.jsx("td",{style:{...ar.td,...ar.cellYellow},children:i.jsx(jp,{value:de.band1,onChange:E=>h(Z=>{const H=[...Z];return H[ne]={...H[ne],band1:E},H})})}),i.jsx("td",{style:{...ar.td,...ar.cellYellow},children:i.jsx(jp,{value:de.band2,onChange:E=>h(Z=>{const H=[...Z];return H[ne]={...H[ne],band2:E},H})})}),i.jsx("td",{style:{...ar.td,...ar.cellYellow},children:i.jsx(jp,{value:de.band3,onChange:E=>h(Z=>{const H=[...Z];return H[ne]={...H[ne],band3:E},H})})}),i.jsx("td",{style:{...ar.td,fontWeight:800,color:"#0b4a6f"},children:m[ne]}),i.jsx("td",{style:{...ar.td},children:i.jsx("button",{type:"button",title:"Delete prerequisite","aria-label":`Delete ${de.name}`,onClick:()=>h(E=>E.filter((Z,H)=>H!==ne)),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:16},children:""})})]},de.name)),i.jsx("tr",{children:i.jsxs("td",{style:{...ar.tdLeft},colSpan:6,children:[i.jsx("button",{type:"button",style:{...ar.btn,padding:"6px 10px"},onClick:()=>h(de=>[...de,{name:`Prerequisite ${de.length+1}`,band1:"",band2:"",band3:""}]),"aria-label":"Add prerequisite",children:"+"}),i.jsx("span",{style:{marginLeft:10,fontSize:13,color:"#557085"},children:"Add next prerequisite"})]})}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:700},colSpan:5,children:"AVERAGE"}),i.jsx("td",{style:{...ar.td,fontWeight:800},children:g===""?"-":g})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:700},colSpan:5,children:"Standardized level of Learner profile as per the above norms"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900,color:"#0b4a6f"},children:y==="-"?"-":y})]})]})]}),i.jsx("div",{style:{height:14}}),i.jsx("table",{style:ar.table,children:i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,...ar.cellGreen,fontWeight:900},children:"LOW LEVEL"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:"LL"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:"1"})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,...ar.cellGreen,fontWeight:900},children:"MEDIUM LEVEL"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:"ML"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:"2"})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,...ar.cellGreen,fontWeight:900},children:"HIGH LEVEL"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:"HL"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:"3"})]})]})}),i.jsx("div",{style:{height:14}}),i.jsx("table",{style:ar.table,children:i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:800,width:220},children:"The Learners are at"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:v.label}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:v.code})]})})}),i.jsx("div",{style:{height:14}}),i.jsx("table",{style:ar.table,children:i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:900,width:260},children:i.jsx(Vi,{style:ar.link,to:`${_e}/lca/pbr`,children:"PREVIOUS BATCH RESULT (PBR)"})}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:G==="-"?"":G}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:j?"COURSE LEVEL (CAY-2)":"COURSE LEVEL (CAY-1)"})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:700},children:" "}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:_?`Mean GPA: ${_.meanGpa}`:""}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:j?`Mean GPA: ${j.meanGpa}`:""})]})]})}),i.jsx("div",{style:{height:12}}),i.jsx("table",{style:ar.table,children:i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{style:{...ar.tdLeft,fontWeight:900,width:260},children:"Learner Centric Level"}),i.jsx("td",{style:{...ar.td,...ar.cellGreen,fontWeight:900},children:xe})]})})})]}))}const jn={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},headerRow:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap",marginBottom:12},label:{color:"#557085",fontSize:12,fontWeight:700},codeBox:{background:"#fbfdff",border:"1px solid #e6eef8",padding:"10px 14px",borderRadius:8,fontWeight:800,color:"#0b4a6f",fontSize:18},nameBox:{background:"#fff",padding:"6px 10px",color:"#234451"},sectionTitle:{marginTop:8,marginBottom:12,color:"#0b3b57",fontSize:16,fontWeight:700},table:{width:"100%",borderCollapse:"collapse",marginTop:12},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"12px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"12px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left"}};function iK({courseCode:e=" ",courseName:t=" ",embedded:r=!1,onClose:n}){const a=Xo(),s=so(),o=r?{padding:0,maxWidth:"100%",margin:0}:jn.page,[l,c]=x.useState(""),[u,d]=x.useState(()=>{var b;const h=t&&t.trim()?t.trim():"",m=((b=a.state)==null?void 0:b.courseName)||"",g=new URLSearchParams(a.search).get("name")||"";return h||m||g||""}),f=u||l||"";x.useEffect(()=>{let h=!0;return(async()=>{try{if(!l&&e){const m=await g9(e);if(!h||!m)return;const g=m.course_name||m.subject_name||m.courseName||m.revision&&(m.revision.course_name||m.revision.courseName||m.revision.subject_name)||"";g&&c(String(g))}}catch{}})(),()=>{h=!1}},[e,l]),x.useEffect(()=>{l&&!u&&d(l)},[l,u]),x.useEffect(()=>{let h=!0;return(async()=>{try{if(u||!e)return;try{const m=await jc();if(!h)return;const b=(m||[]).filter(y=>String(y.subject_code)===String(e))[0]||null;if(b&&b.subject_name){d(String(b.subject_name));return}}catch{}try{const m=await sl();if(!h)return;const g=String(e),b=g.toUpperCase(),y=(m||[]).find(v=>String((v==null?void 0:v.course_code)||"").trim()===g||String((v==null?void 0:v.course_code)||"").trim().toUpperCase()===b);if(y&&y.course_name){d(String(y.course_name));return}}catch{}}catch{}})(),()=>{h=!1}},[e,f]);const p=[{co:"CO1",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:68,scale:2.03},{co:"CO2",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:66,scale:1.99},{co:"CO3",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.01},{co:"CO4",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.02},{co:"CO5",ico:0,bco:.5,aco:0,api:0,iic:0,target:74,scale:2.22}];return i.jsx("div",{style:o,children:i.jsxs("div",{style:jn.card,children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,marginBottom:12},children:[i.jsxs("div",{style:jn.headerRow,children:[i.jsxs("div",{children:[i.jsx("div",{style:jn.label,children:"COURSE CODE"}),i.jsx("div",{style:jn.codeBox,children:e})]}),i.jsxs("div",{style:{marginLeft:12},children:[i.jsx("div",{style:jn.label,children:"COURSE NAME"}),i.jsx("div",{style:jn.nameBox,children:f})]})]}),i.jsx("div",{children:r?n?i.jsx("button",{onClick:n,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:"Close"}):null:i.jsx("button",{onClick:()=>s(-1),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:" Back"})})]}),i.jsxs("div",{style:{...jn.card,padding:14,marginTop:0},children:[i.jsx("div",{style:jn.sectionTitle,children:"Course Outcome Attainment  Targets"}),i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginTop:12},children:[i.jsxs("div",{style:{...jn.card,padding:16,minHeight:140},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"1. Rubrics for Impact (ICO)"}),i.jsxs("table",{style:jn.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:jn.th,children:"CO"}),i.jsx("th",{style:jn.th,children:"High (3)"}),i.jsx("th",{style:jn.th,children:"Medium (2)"}),i.jsx("th",{style:jn.th,children:"Low (1)"}),i.jsx("th",{style:jn.th,children:"Total"}),i.jsx("th",{style:jn.th,children:"ICO"})]})}),i.jsx("tbody",{children:p.map(h=>i.jsxs("tr",{children:[i.jsx("td",{style:jn.tdLeft,children:h.co}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td})]},h.co))})]})]}),i.jsxs("div",{style:{...jn.card,padding:16,minHeight:140},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"2. BTL Level (BCO)"}),i.jsxs("table",{style:jn.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:jn.th,children:"CO"}),i.jsx("th",{style:jn.th,children:"BTL-1"}),i.jsx("th",{style:jn.th,children:"BTL-2"}),i.jsx("th",{style:jn.th,children:"BTL-3"}),i.jsx("th",{style:jn.th,children:"BTL-4"}),i.jsx("th",{style:jn.th,children:"BTL-5"}),i.jsx("th",{style:jn.th,children:"BTL-6"}),i.jsx("th",{style:jn.th,children:"BCO"})]})}),i.jsx("tbody",{children:p.map(h=>i.jsxs("tr",{children:[i.jsx("td",{style:jn.tdLeft,children:h.co}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td}),i.jsx("td",{style:jn.td})]},h.co))})]})]}),i.jsxs("div",{style:{...jn.card,padding:16,minHeight:120},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"3. Last year's Average CO attainment (ACO)"}),i.jsxs("table",{style:jn.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:jn.th,children:"COs"}),i.jsx("th",{style:jn.th,children:"SUB"})]})}),i.jsx("tbody",{children:p.map(h=>i.jsxs("tr",{children:[i.jsx("td",{style:jn.tdLeft,children:h.co}),i.jsx("td",{style:jn.td})]},h.co))})]})]}),i.jsxs("div",{style:{...jn.card,padding:16,minHeight:120},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"4. Average Performance Index (API)"}),i.jsx("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:i.jsx("div",{style:{border:"1px solid #94a3b8",borderRadius:4,overflow:"hidden",flex:1},children:i.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{padding:8,minWidth:220,background:"#fff",fontWeight:700,borderRight:"1px solid #94a3b8"},children:"BATCH (CAY)"}),i.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"NO OF SUCCESSFUL"}),i.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"MEAN CGPA"}),i.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]})]})})})}),i.jsxs("div",{style:{marginTop:12,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[i.jsx("div",{style:{color:"#234451",fontWeight:700},children:"Average Performance Index of the student's batch (API) - GPA ="}),i.jsx("div",{style:{border:"2px solid #0b4a6f",padding:"6px 10px",fontWeight:900}}),i.jsx("div",{children:"/100"})]})]}),i.jsxs("div",{style:{...jn.card,padding:18,minHeight:180},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"5. The Improvement Index on CO attainment (IIC)"}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[i.jsx("div",{style:{border:"2px solid #0b3b57",borderRadius:4,overflow:"hidden",width:360,background:"#fff"},children:i.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:i.jsxs("tbody",{children:[i.jsx("tr",{children:i.jsx("td",{colSpan:2,style:{padding:12,background:"#f8fafc",fontWeight:800,color:"#0b3b57"},children:"Learner Centric Approach (LCA)"})}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L3"}),i.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L2"}),i.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L1"}),i.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]})]})})}),i.jsxs("div",{style:{flex:1,display:"flex",gap:12,alignItems:"flex-start"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:8,textAlign:"center",color:"#0b3b57"},children:"The Course Outcome Attainment Targets"}),i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"2px solid #0b3b57"},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f2ff",color:"#0b3b57"},children:"COs"}),i.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"ICO"}),i.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"BCO"}),i.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"ACO"}),i.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"API"}),i.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"IIC"}),i.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fff7d6",color:"#6b4a00"},children:"COs Targets"}),i.jsx("th",{style:{padding:10,background:"#fff7d6",color:"#6b4a00"},children:"CO TARGET IN 3 POINT SCALE"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderTop:"1px solid #e6eef8",background:"#f3f8ff",fontWeight:700},children:"Weight Values"}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}})]}),["CO-1","CO-2","CO-3","CO-4","CO-5"].map(h=>i.jsxs("tr",{children:[i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb",textAlign:"left",fontWeight:700},children:h}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),i.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}})]},h))]})]})]}),i.jsx("div",{style:{width:220,background:"#86efac",padding:12,borderRadius:4,border:"2px solid #16a34a",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontWeight:700},children:"TARGET TABLE WILL BE GENERATED AUTOMATICALLY"})]})]})]})]})]})]})})}const Vr={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},titleBlock:{display:"flex",flexDirection:"column"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},grid:{display:"grid",gap:16},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},paragraph:{color:"#334e68",lineHeight:1.45,margin:0},table:{width:"100%",borderCollapse:"collapse",marginTop:8},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},note:{color:"#6b8190",fontSize:13},kv:{background:"#fbfdff",padding:10,borderRadius:8,border:"1px solid #e9f3fb",minWidth:160},kvLabel:{fontSize:12,color:"#557085",marginBottom:6},kvValue:{fontWeight:700,color:"#0b4a6f"}};function gPe({title:e,columns:t,rows:r}){return i.jsxs("div",{children:[e&&i.jsx("div",{style:Vr.sectionTitle,children:e}),i.jsxs("table",{style:Vr.table,children:[i.jsx("thead",{children:i.jsx("tr",{children:t.map(n=>i.jsx("th",{style:Vr.th,children:n},n))})}),i.jsx("tbody",{children:r.map((n,a)=>i.jsx("tr",{children:n.map((s,o)=>i.jsx("td",{style:Vr.td,children:s},o))},a))})]})]})}function sK({courseCode:e,courseName:t,initialTab:r,viewerMode:n}){const a=x.useMemo(()=>e?String(e):"",[e]);so();const[s,o]=x.useState(r||"instructions");x.useEffect(()=>{r&&o(r)},[r]);const l=[{key:"instructions",label:"LCA Instructions"},{key:"lca",label:"LCA"},{key:"cdap",label:"CDAP"},{key:"articulation",label:"Articulation Matrix"},{key:"cotarget",label:"CO Target"}],c={display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},u=(d,f)=>{const p=s===d,h=()=>{if(d==="cotarget"){o(d);return}o(d)};return i.jsx("button",{onClick:h,style:{padding:"8px 12px",borderRadius:8,border:p?"2px solid #0b4a6f":"1px solid #e6eef8",background:p?"#0b4a6f":"#fbfdff",color:p?"#fff":"#0b4a6f",fontWeight:700,cursor:"pointer"},children:f},f)};return i.jsx("div",{style:Vr.page,children:i.jsxs("div",{style:{...Vr.card},children:[i.jsx("div",{style:Vr.header,children:i.jsxs("div",{style:Vr.titleBlock,children:[i.jsx("h2",{style:Vr.title,children:"Learner Centric Approach  Instructions"}),i.jsx("div",{style:Vr.subtitle,children:"Default LCA planning matrix and instruction-level guidance for course design and assessment."})]})}),i.jsxs("div",{style:{padding:12},children:[i.jsx("div",{style:c,children:l.map(d=>u(d.key,d.label))}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-start",gap:12,flexWrap:"wrap",marginBottom:12},children:i.jsxs("div",{style:Vr.kv,children:[i.jsx("div",{style:Vr.kvLabel,children:"Course"}),i.jsx("div",{style:Vr.kvValue,children:(e||"")+(t?`  ${t}`:"")})]})}),s==="instructions"&&i.jsxs("div",{style:Vr.grid,children:[i.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:16,alignItems:"start"},children:i.jsxs("div",{style:{...Vr.card,padding:14,gridColumn:"1 / -1"},children:[i.jsx("div",{style:Vr.sectionTitle,children:"Overview"}),i.jsx("p",{style:Vr.paragraph,children:"Use this page to map learner profiles (L1L3) to instruction levels (IL-1..IL-3) and to define assessment distribution. The tables below provide recommended mappings and a sample distribution for course planning."}),i.jsx("div",{style:{marginTop:12},children:i.jsx(gPe,{title:"Learner Profile  Quick Guide",columns:["Profile","Description"],rows:[["L1","Lower CGPA / limited prerequisites"],["L2","Average preparedness"],["L3","High CGPA / strong prerequisites"]]})})]})}),i.jsxs("div",{style:{...Vr.card,padding:14},children:[i.jsx("div",{style:Vr.sectionTitle,children:"Instruction Steps (recommended)"}),i.jsxs("ol",{style:{margin:0,paddingLeft:18,color:"#334e68"},children:[i.jsx("li",{style:{marginBottom:8},children:"Identify learner profile (L1 / L2 / L3) for the target offering."}),i.jsx("li",{style:{marginBottom:8},children:"Use IL mapping to determine instruction emphasis across IL-1..IL-3."}),i.jsx("li",{style:{marginBottom:8},children:"Apply distribution when preparing teaching plan and question banks (map PT / CO / BTL)."})]})]}),i.jsxs("div",{style:{display:"grid",gap:12},children:[i.jsxs("div",{style:{...Vr.card,padding:12},children:[i.jsx("div",{style:Vr.sectionTitle,children:"Sample Assessment Distribution by Learner Profile"}),i.jsxs("table",{style:Vr.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:Vr.th,children:"Learner Profile"}),i.jsx("th",{style:Vr.th,children:"IL-1 %"}),i.jsx("th",{style:Vr.th,children:"IL-2 %"}),i.jsx("th",{style:Vr.th,children:"IL-3 %"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:Vr.td,children:"L1"}),i.jsx("td",{style:Vr.td,children:"60"}),i.jsx("td",{style:Vr.td,children:"30"}),i.jsx("td",{style:Vr.td,children:"10"})]}),i.jsxs("tr",{children:[i.jsx("td",{style:Vr.td,children:"L2"}),i.jsx("td",{style:Vr.td,children:"30"}),i.jsx("td",{style:Vr.td,children:"50"}),i.jsx("td",{style:Vr.td,children:"20"})]}),i.jsxs("tr",{children:[i.jsx("td",{style:Vr.td,children:"L3"}),i.jsx("td",{style:Vr.td,children:"10"}),i.jsx("td",{style:Vr.td,children:"40"}),i.jsx("td",{style:Vr.td,children:"50"})]})]})]})]}),i.jsxs("div",{style:{...Vr.card,padding:12},children:[i.jsx("div",{style:Vr.sectionTitle,children:"Current Course  Example Breakdown"}),i.jsxs("table",{style:Vr.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:Vr.th,children:"Component"}),i.jsx("th",{style:Vr.th,children:"IL-1"}),i.jsx("th",{style:Vr.th,children:"IL-2"}),i.jsx("th",{style:Vr.th,children:"IL-3"}),i.jsx("th",{style:Vr.th,children:"Notes"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:Vr.td,children:"Teaching Hours"}),i.jsx("td",{style:Vr.td,children:"40%"}),i.jsx("td",{style:Vr.td,children:"40%"}),i.jsx("td",{style:Vr.td,children:"20%"}),i.jsx("td",{style:Vr.td,children:"Blend of lectures and labs"})]}),i.jsxs("tr",{children:[i.jsx("td",{style:Vr.td,children:"Question Bank"}),i.jsx("td",{style:Vr.td,children:"50%"}),i.jsx("td",{style:Vr.td,children:"30%"}),i.jsx("td",{style:Vr.td,children:"20%"}),i.jsx("td",{style:Vr.td,children:"Adjust difficulty by profile"})]})]})]}),i.jsx("div",{style:{marginTop:10},children:i.jsx("div",{style:Vr.note,children:"Tip: Use these templates as starting points and adapt percentages to the specific cohort."})})]}),i.jsxs("div",{style:{...Vr.card,padding:12},children:[i.jsx("div",{style:Vr.sectionTitle,children:"IL Mapping"}),i.jsxs("table",{style:Vr.table,children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:Vr.th,children:"IL"}),i.jsx("th",{style:Vr.th,children:"Instruction Focus"}),i.jsx("th",{style:Vr.th,children:"Typical Assessment Emphasis"})]})}),i.jsxs("tbody",{children:[i.jsxs("tr",{children:[i.jsx("td",{style:Vr.td,children:"IL-1"}),i.jsx("td",{style:Vr.td,children:"Foundation, concepts, scaffolding"}),i.jsx("td",{style:Vr.td,children:"More formative; MCQ / guided tasks"})]}),i.jsxs("tr",{children:[i.jsx("td",{style:Vr.td,children:"IL-2"}),i.jsx("td",{style:Vr.td,children:"Application and practice"}),i.jsx("td",{style:Vr.td,children:"Mixture of practical and theory"})]}),i.jsxs("tr",{children:[i.jsx("td",{style:Vr.td,children:"IL-3"}),i.jsx("td",{style:Vr.td,children:"Advanced, synthesis, independent work"}),i.jsx("td",{style:Vr.td,children:"Problem-solving, projects, high-level questions"})]})]})]})]})]})]}),s==="lca"&&i.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:a?i.jsx(mPe,{embedded:!0,courseId:a,courseCode:a,courseName:t??void 0}):i.jsxs("div",{style:{...Vr.card,padding:16},children:[i.jsx("div",{style:Vr.sectionTitle,children:"LCA"}),i.jsx("div",{style:Vr.paragraph,children:"Select a course to view the LCA worksheet."})]})}),s==="cdap"&&i.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:a?i.jsx("div",{style:{...Vr.card,padding:12},children:i.jsx(cPe,{courseId:a,showHeader:!1,showCourseInput:!1})}):i.jsxs("div",{style:{...Vr.card,padding:16},children:[i.jsx("div",{style:Vr.sectionTitle,children:"CDAP"}),i.jsx("div",{style:Vr.paragraph,children:"Select a course to open CDAP."})]})}),s==="articulation"&&i.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:a?i.jsx(tPe,{embedded:!0,courseId:a}):i.jsxs("div",{style:{...Vr.card,padding:16},children:[i.jsx("div",{style:Vr.sectionTitle,children:"Articulation Matrix"}),i.jsx("div",{style:Vr.paragraph,children:"Select a course to view the articulation matrix."})]})}),s==="cotarget"&&i.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:a?i.jsx("div",{style:{...Vr.card,padding:12},children:i.jsx(iK,{embedded:!0,courseCode:a,courseName:t??void 0,onClose:()=>o("instructions")})}):i.jsxs("div",{style:{...Vr.card,padding:16},children:[i.jsx("div",{style:Vr.sectionTitle,children:"CO Target"}),i.jsx("div",{style:Vr.paragraph,children:"Select a course to view CO Targets."})]})})]})]})})}const xPe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],yPe=[{key:"q1",label:"Q1",max:2,co:3,btl:1},{key:"q2",label:"Q2",max:2,co:3,btl:3},{key:"q3",label:"Q3",max:2,co:3,btl:4},{key:"q4",label:"Q4",max:2,co:4,btl:1},{key:"q5",label:"Q5",max:2,co:4,btl:1},{key:"q6",label:"Q6",max:2,co:4,btl:2},{key:"q7",label:"Q7",max:16,co:3,btl:2},{key:"q8",label:"Q8",max:16,co:4,btl:3},{key:"q9",label:"Q9",max:16,co:"3&4",btl:5}],rj=30,Kg={co1:42,co2:42,co3:58,co4:42,co5:42},J4=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],oK=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],nj=J4.reduce((e,t,r)=>e+(oK[r]===5?t.max:0),0),vR=10;function bPe(e,t,r){if(t)return 5;const n=In(e);return r.includes("model")&&(n==="THEORY"||n==="TCPL"||n==="TCPR")?5:4}function vPe(e){return Array.from({length:e},(t,r)=>r+1)}const Yp={ssa1:1.5,cia1:3,formative1:2.5},wPe={THEORY:{ssa1:1.5,cia1:3,formative1:2.5},TCPR:{ssa1:2,cia1:2.5,formative1:2},TCPL:{ssa1:1,cia1:2,formative1:3},LAB:{ssa1:1,cia1:1,formative1:1},PRACTICAL:{ssa1:1,cia1:1,formative1:1},SPECIAL:{ssa1:1.5,cia1:3,formative1:2.5},AUDIT:{ssa1:1.5,cia1:3,formative1:2.5}};function ov(e){if(!e)return Yp;const t=In(e);return wPe[t]||Yp}function na(e,t,r){return Math.max(t,Math.min(r,e))}function as(e){return Math.round(e*10)/10}function vf(e){return Math.round(e*100)/100}function Cl(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function Xg(e,t){const r=Array.isArray(e)?e:[],n=[];for(let a=0;a<t;a++){const s=r[a];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function lv(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function aj(e){const t=typeof e=="number"?e:Number(e);if(!Number.isFinite(t))return null;const r=Math.trunc(t);return r>=1&&r<=6?r:null}function wR(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function SR(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const r=e.trim();if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="4")return 4;if(r==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(e);return t===4?4:t===3?3:t===34?"3&4":3}function SPe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function _R(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),a=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&a&&s?{co1:.5,co2:.5}:SPe(r.co)}function _Pe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function kR(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),a=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&a&&s?{co3:.5,co4:.5}:_Pe(r.co)}function jR(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const a=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return a.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function cv(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:a,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u,outOf:d}=e,f=[{mark:t,max:a,w:l},{mark:r,max:s,w:c},{mark:n,max:o,w:u}].filter(g=>Number(g.w||0)>0);if(!f.length||!d||!Number.isFinite(Number(d))||f.some(g=>g.mark==null)||f.some(g=>!g.max||!Number.isFinite(Number(g.max))))return null;const p=f.reduce((g,b)=>g+b.w,0);if(!p)return null;const m=f.reduce((g,b)=>g+b.mark/b.max*b.w,0)/p*d;return Number.isFinite(m)?na(m,0,d):null}function lK({courseId:e,enabledAssessments:t,classType:r}){const[n,a]=x.useState(null),[s,o]=x.useState(r??null),l=x.useMemo(()=>Array.isArray(t),[t]),c=x.useMemo(()=>{const ge=Array.isArray(t)?t:[];return new Set(ge.map(Ne=>String(Ne||"").trim().toLowerCase()).filter(Boolean))},[t]),u=x.useMemo(()=>c.has("model"),[c]),[d,f]=x.useState(null),[p,h]=x.useState(null),m=x.useMemo(()=>l||yre(s),[l,s]),g=x.useMemo(()=>({ssa1:!m||c.has("ssa1"),ssa2:!m||c.has("ssa2"),formative1:!m||c.has("formative1"),formative2:!m||c.has("formative2"),cia1:!m||c.has("cia1"),cia2:!m||c.has("cia2"),model:!m||c.has("model")}),[m,c]),b=x.useMemo(()=>uN(s)&&!l,[s,l]),y=x.useMemo(()=>In(s)==="TCPL",[s]),v=x.useMemo(()=>{const ge=In(s);return(ge==="THEORY"||ge==="TCPL"||ge==="TCPR")&&!!g.model},[s,g.model]),w=x.useMemo(()=>{const ge=Object.entries(g).filter(([Ne,dt])=>dt).map(([Ne])=>Ne);return bPe(s,b,ge)},[s,b,g]),_=x.useMemo(()=>vPe(w),[w]),[C,j]=x.useState([]),[A,M]=x.useState(null),[P,R]=x.useState(null);x.useEffect(()=>{if(!e||P==null||!u){f(null),h(null);return}let ge=!0;return(async()=>{try{const Ne=await oS("model",String(e),Number(P));if(!ge)return;f(Ne),h(null)}catch(Ne){if(!ge)return;f(null),h((Ne==null?void 0:Ne.message)||"Failed to fetch MODEL publish status")}})(),()=>{ge=!1}},[e,P,u]);const[N,T]=x.useState(!1),[B,G]=x.useState(null),[re,xe]=x.useState([]),[_e,V]=x.useState(!1),[K,de]=x.useState(null),[ne,E]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[Z,H]=x.useState({}),[F,ee]=x.useState({cia1:null,cia2:null,model:null}),[z,X]=x.useState({lab1:null,lab2:null}),J=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[q,Y]=x.useState(!1),[L,U]=x.useState(()=>({ssa1:Yp.ssa1,cia1:Yp.cia1,formative1:Yp.formative1})),[ce,W]=x.useState(vR),ae=!!(u&&d&&d.is_published);x.useEffect(()=>{v&&W(ae?30:vR)},[v,ae]);const[he,ze]=x.useState("default"),ke=Zr.useRef(null),qe=Zr.useRef(null),[Ie,Ve]=x.useState(null),[Qe,Tt]=x.useState(null),[vt,Xe]=x.useState(null),[Be,ct]=x.useState(!1),[nt,Se]=x.useState(!1),[Te,Dt]=x.useState({});x.useEffect(()=>{try{const ge=localStorage.getItem("roles"),Ne=localStorage.getItem("permissions"),dt=ge?JSON.parse(ge):[],Ue=Ne?JSON.parse(Ne):[],Re=Array.isArray(dt)?dt.map(oe=>String(oe||"").toUpperCase()):[],xt=Array.isArray(Ue)?Ue.map(oe=>String(oe||"").toLowerCase()):[],at=Re.includes("IQAC"),er=xt.includes("obe.master.manage");Y(at||er)}catch{Y(!1)}},[]),x.useEffect(()=>{let ge=!0;const Ne=async dt=>{ge&&Ve("Loading IQAC weights");try{const Re=await uS();if(!ge)return;if(Re&&typeof Re=="object"){const xt={...Re};try{Object.defineProperty(xt,"__source",{value:"server",enumerable:!1})}catch{}ke.current=xt,Xe(Object.keys(xt||{}).length||0),Tt(null),Ve(`Server weights loaded (${Object.keys(xt||{}).length} class-types)`);const at=dt??s;if(at){const er=In(at),oe=xt[er];if(oe&&typeof oe=="object"){const ue=ov(at);U({ssa1:Number.isFinite(Number(oe.ssa1))?Number(oe.ssa1):ue.ssa1,cia1:Number.isFinite(Number(oe.cia1))?Number(oe.cia1):ue.cia1,formative1:Number.isFinite(Number(oe.formative1))?Number(oe.formative1):ue.formative1}),ze("server"),Ve(`Applied server weights for ${er}`);return}else Ve(`Server weights loaded (${Object.keys(xt||{}).length} keys) but no entry for ${er}`)}}}catch(Re){const xt=String((Re==null?void 0:Re.message)||Re||"Unknown error");Tt(xt),Ve(`Server fetch failed: ${xt}`)}try{const Re=Pn("iqac_class_type_weights");if(Re&&typeof Re=="object"){const xt={...Re};try{Object.defineProperty(xt,"__source",{value:"local",enumerable:!1})}catch{}ke.current=xt,Xe(Object.keys(xt||{}).length||0);const at=dt??s;if(at){const er=In(at),oe=xt[er];if(oe&&typeof oe=="object"){const ue=ov(at);U({ssa1:Number.isFinite(Number(oe.ssa1))?Number(oe.ssa1):ue.ssa1,cia1:Number.isFinite(Number(oe.cia1))?Number(oe.cia1):ue.cia1,formative1:Number.isFinite(Number(oe.formative1))?Number(oe.formative1):ue.formative1}),ze("local"),Ve(`Applied local weights for ${er}`);return}else Ve(`Local weights loaded (${Object.keys(xt||{}).length} keys) but no entry for ${er}`)}}}catch(Re){const xt=String((Re==null?void 0:Re.message)||Re||"Unknown error");Tt(xt),Ve(`Local weights read failed: ${xt}`)}const Ue=dt??s;if(Ue){const Re=ov(Ue);U(Re),ze("default"),Ve(`Applied class-type defaults for ${In(Ue)}`)}else U(Yp),ze("default"),Ve("Applied general defaults (no class type detected)")};return Ne(),qe.current=Ne,()=>{ge=!1}},[s]),x.useEffect(()=>{try{const ge=qe.current;typeof ge=="function"&&ge()}catch{}},[P]),x.useEffect(()=>{try{const ge=ke.current;if(s&&ge&&typeof ge=="object"){const Ne=In(s),dt=ge[Ne];if(dt&&typeof dt=="object"){const Ue=ov(s);U({ssa1:Number.isFinite(Number(dt.ssa1))?Number(dt.ssa1):Ue.ssa1,cia1:Number.isFinite(Number(dt.cia1))?Number(dt.cia1):Ue.cia1,formative1:Number.isFinite(Number(dt.formative1))?Number(dt.formative1):Ue.formative1}),ze(ge.__source==="server"?"server":"local"),Ve(`Applied cached mapping for ${Ne}`),Tt(null)}}}catch{}},[s]),x.useEffect(()=>{let ge=!0;return(async()=>{try{const Ne=await iu();if(!ge)return;a(Ne||null)}catch{}})(),()=>{ge=!1}},[e]),x.useEffect(()=>{let ge=!0;return(async()=>{var Ne;try{const dt=await jc();if(!ge)return;let Ue=(dt||[]).filter(at=>at.subject_code===e);if(Ue.length===0)try{const at=await mr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(at.ok){const er=await at.json();Ue=(Array.isArray(er.results)?er.results:Array.isArray(er)?er:er.items||[])||[]}}catch(at){console.warn("Server TA list fetch failed:",at)}j(Ue),M(null);const Re=Pn(`coAttainment_selectedTa_${e}`),xt=typeof Re=="number"&&Ue.some(at=>at.id===Re)&&Re||(((Ne=Ue[0])==null?void 0:Ne.id)??null);R(xt)}catch(dt){if(!ge)return;j([]),R(null),M((dt==null?void 0:dt.message)||"Failed to load teaching assignments")}})(),()=>{ge=!1}},[e]),x.useEffect(()=>{!e||P==null||Sn(`coAttainment_selectedTa_${e}`,P)},[e,P]),x.useEffect(()=>{if(r){o(r);return}let ge=!0;return(async()=>{try{const Ne=(C||[]).find(er=>er.id===P)||null,dt=(Ne==null?void 0:Ne.class_type)??null;if(dt){if(!ge)return;o(dt);return}const Ue=Ne==null?void 0:Ne.elective_subject_id;if(Ue&&!(Ne!=null&&Ne.section_id)){console.log("[COAttainment] Detected elective TA, fetching elective subject details for:",Ue);try{const er=await mr(`/api/curriculum/elective-subjects/${Ue}/`);if(er.ok){const oe=await er.json(),ue=oe==null?void 0:oe.class_type;if(console.log("[COAttainment] Elective subject class_type:",ue),ue){if(!ge)return;o(ue);return}}else console.warn("[COAttainment] Elective subject API returned error:",er.status)}catch(er){console.warn("[COAttainment] Failed to fetch elective subject:",er)}}const Re=Ne==null?void 0:Ne.curriculum_row_id;if(!Re)try{const er=String(e).trim().toUpperCase(),oe=await sl();if(!ge)return;const ue=(oe||[]).find(Ce=>String(Ce.course_code||"").trim().toUpperCase()===er),Q=(ue==null?void 0:ue.class_type)??null;if(Q){o(Q);return}const ye=await Ld();if(!ge)return;const je=(ye||[]).find(Ce=>String(Ce.course_code||"").trim().toUpperCase()===er);o((je==null?void 0:je.class_type)??null);return}catch{ge&&o(null);return}const xt=await cN(Number(Re));if(!ge)return;const at=(xt==null?void 0:xt.class_type)??null;if(at){o(at);return}try{const er=String(e).trim().toUpperCase(),oe=await Ld();if(!ge)return;const ue=(oe||[]).find(Q=>String(Q.course_code||"").trim().toUpperCase()===er);o((ue==null?void 0:ue.class_type)??null)}catch{o(null)}}catch{ge&&o(null)}})(),()=>{ge=!1}},[C,P,r]),x.useEffect(()=>{Sn(J,{weights:L})},[J,L]),x.useEffect(()=>{let ge=!0;return(async()=>{if(P){T(!0),G(null);try{const dt=(C||[]).find(Re=>Re.id===P)||null,Ue=[];if(dt&&dt.elective_subject_id&&!dt.section_id){const Re=dt.elective_subject_id,xt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Re))}`);if(!xt.ok)throw new Error(`Elective-choices fetch failed: ${xt.status}`);const at=await xt.json();if(!ge)return;const oe=((Array.isArray(at.results)?at.results:Array.isArray(at)?at:at.items||[])||[]).map(ue=>({id:Number(ue.student_id??ue.id),reg_no:String(ue.reg_no??ue.registration_no??ue.regno??""),name:String(ue.name??ue.full_name??ue.username??ue.student_name??""),section:ue.section_name??ue.section??null,section_id:ue.section_id??null}));if(!ge)return;xe(oe.filter(ue=>Number.isFinite(ue.id)).sort(jR))}else{const Re=await Ac(P);if(!ge)return;const xt=(Re.students||[]).map(at=>({id:Number(at.id),reg_no:String(at.reg_no??""),name:String(at.name??""),section:at.section??null})).filter(at=>Number.isFinite(at.id)).sort(jR);xe(xt)}}catch(dt){if(!ge)return;xe([]),G((dt==null?void 0:dt.message)||"Failed to load roster")}finally{ge&&T(!1)}}})(),()=>{ge=!1}},[P,C]);const wt=x.useMemo(()=>{var Ne,dt;const ge=(dt=(Ne=n==null?void 0:n.assessments)==null?void 0:Ne.cia1)==null?void 0:dt.questions;return Array.isArray(ge)&&ge.length?ge.map(Ue=>({key:String((Ue==null?void 0:Ue.key)||""),label:String((Ue==null?void 0:Ue.label)||(Ue==null?void 0:Ue.key)||""),max:Number((Ue==null?void 0:Ue.max)||0),co:wR(Ue==null?void 0:Ue.co),btl:Math.min(6,Math.max(1,Number((Ue==null?void 0:Ue.btl)||1)))})).filter(Ue=>Ue.key):xPe},[n]),Pt=x.useMemo(()=>{var Ne,dt;const ge=(dt=(Ne=n==null?void 0:n.assessments)==null?void 0:Ne.cia2)==null?void 0:dt.questions;return Array.isArray(ge)&&ge.length?ge.map(Ue=>({key:String((Ue==null?void 0:Ue.key)||""),label:String((Ue==null?void 0:Ue.label)||(Ue==null?void 0:Ue.key)||""),max:Number((Ue==null?void 0:Ue.max)||0),co:SR(Ue==null?void 0:Ue.co),btl:Math.min(6,Math.max(1,Number((Ue==null?void 0:Ue.btl)||1)))})).filter(Ue=>Ue.key):yPe},[n]),Wt=x.useMemo(()=>{let ge=0,Ne=0;const dt=wt||[];return dt.forEach((Ue,Re)=>{const xt=_R(dt,Re);ge+=(Number(Ue.max)||0)*xt.co1,Ne+=(Number(Ue.max)||0)*xt.co2}),{co1:ge,co2:Ne}},[wt]),Ot=x.useMemo(()=>{let ge=0,Ne=0;const dt=Pt||[];return dt.forEach((Ue,Re)=>{const xt=kR(dt,Re);ge+=(Number(Ue.max)||0)*xt.co3,Ne+=(Number(Ue.max)||0)*xt.co4}),{co3:ge,co4:Ne}},[Pt]),Ht=x.useMemo(()=>{var We,De,pe,Je,Ge,Ye,ft,bt,Vt,Ft,gr,Ar,kr,At,Ut,Kr,$t,fr;const ge=((We=n==null?void 0:n.assessments)==null?void 0:We.ssa1)||{},Ne=((De=n==null?void 0:n.assessments)==null?void 0:De.ssa2)||{},dt=((pe=n==null?void 0:n.assessments)==null?void 0:pe.formative1)||{},Ue=((Je=n==null?void 0:n.assessments)==null?void 0:Je.formative2)||{},Re=((Ge=n==null?void 0:n.assessments)==null?void 0:Ge.cia1)||{},xt=((Ye=n==null?void 0:n.assessments)==null?void 0:Ye.cia2)||{},at=Number((ft=ge==null?void 0:ge.coMax)==null?void 0:ft.co1),er=Number((bt=ge==null?void 0:ge.coMax)==null?void 0:bt.co2),oe=Number(((Vt=Ne==null?void 0:Ne.coMax)==null?void 0:Vt.co3)??((Ft=Ne==null?void 0:Ne.coMax)==null?void 0:Ft.co1)),ue=Number(((gr=Ne==null?void 0:Ne.coMax)==null?void 0:gr.co4)??((Ar=Ne==null?void 0:Ne.coMax)==null?void 0:Ar.co2)),Q=Number((kr=Re==null?void 0:Re.coMax)==null?void 0:kr.co1),ye=Number((At=Re==null?void 0:Re.coMax)==null?void 0:At.co2),je=Number(((Ut=xt==null?void 0:xt.coMax)==null?void 0:Ut.co3)??((Kr=xt==null?void 0:xt.coMax)==null?void 0:Kr.co1)),Ce=Number((($t=xt==null?void 0:xt.coMax)==null?void 0:$t.co4)??((fr=xt==null?void 0:xt.coMax)==null?void 0:fr.co2)),ot=Number(dt==null?void 0:dt.maxCo),it=Number(Ue==null?void 0:Ue.maxCo);return{ssa1:{co1:Number.isFinite(at)?Math.max(0,at):10,co2:Number.isFinite(er)?Math.max(0,er):10},ssa2:{co3:Number.isFinite(oe)?Math.max(0,oe):10,co4:Number.isFinite(ue)?Math.max(0,ue):10},cia1:{co1:Number.isFinite(Q)?Math.max(0,Q):Wt.co1,co2:Number.isFinite(ye)?Math.max(0,ye):Wt.co2},cia2:{co3:Number.isFinite(je)?Math.max(0,je):Ot.co3,co4:Number.isFinite(Ce)?Math.max(0,Ce):Ot.co4},f1:{co1:Number.isFinite(ot)?Math.max(0,ot):10,co2:Number.isFinite(ot)?Math.max(0,ot):10},f2:{co3:Number.isFinite(it)?Math.max(0,it):10,co4:Number.isFinite(it)?Math.max(0,it):10}}},[n,Wt,Ot]),Pr=x.useMemo(()=>{if(!b)return null;const ge=Kg.co1,Ne=Kg.co2,dt=Kg.co3,Ue=Kg.co4,Re=Kg.co5;return{co1:ge,co2:Ne,co3:dt,co4:Ue,co5:Re,total:as(ge+Ne+dt+Ue+Re)}},[b]),jt=async()=>{V(!0),de(null);const ge=typeof P=="number"?P:void 0;try{if(H({}),X({lab1:null,lab2:null}),b){let Ne=null,dt=null,Ue=null;try{Ne=await no("cia1",e,ge)}catch(Re){H(xt=>({...xt,lab_cia1:String((Re==null?void 0:Re.message)||Re)}))}try{dt=await no("cia2",e,ge)}catch(Re){H(xt=>({...xt,lab_cia2:String((Re==null?void 0:Re.message)||Re)}))}try{Ue=await Am(e,ge)}catch(Re){H(xt=>({...xt,lab_model:String((Re==null?void 0:Re.message)||Re)}))}ee({cia1:(Ne==null?void 0:Ne.data)??null,cia2:(dt==null?void 0:dt.data)??null,model:(Ue==null?void 0:Ue.data)??null});try{if(!(Ne!=null&&Ne.data))try{const Re=await Mn("cia1",e,ge);Re&&Re.draft&&ee(xt=>({...xt,cia1:Re.draft.data??Re.draft}))}catch(Re){H(xt=>({...xt,lab_cia1_draft:String((Re==null?void 0:Re.message)||Re)}))}if(!(dt!=null&&dt.data))try{const Re=await Mn("cia2",e,ge);Re&&Re.draft&&ee(xt=>({...xt,cia2:Re.draft.data??Re.draft}))}catch(Re){H(xt=>({...xt,lab_cia2_draft:String((Re==null?void 0:Re.message)||Re)}))}if(!(Ue!=null&&Ue.data))try{const Re=await Mn("model",e,ge);Re&&Re.draft&&ee(xt=>({...xt,model:Re.draft.data??Re.draft}))}catch(Re){H(xt=>({...xt,lab_model_draft:String((Re==null?void 0:Re.message)||Re)}))}}catch{}}if(b)E({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});else{const Ne=In(s)==="TCPL";let dt=null,Ue=null,Re=null,xt=null,at=null,er=null,oe=null,ue=null;if(g.ssa1)try{dt=await Vm(e,ge)}catch(Q){H(ye=>({...ye,ssa1:String((Q==null?void 0:Q.message)||Q)}))}if(g.ssa2)try{Ue=await H1(e,ge)}catch(Q){H(ye=>({...ye,ssa2:String((Q==null?void 0:Q.message)||Q)}))}if(g.formative1)if(Ne)try{at=await no("formative1",e,ge)}catch(Q){H(ye=>({...ye,tcpl_lab1:String((Q==null?void 0:Q.message)||Q)}))}else try{Re=await hS(e,ge)}catch(Q){H(ye=>({...ye,formative1:String((Q==null?void 0:Q.message)||Q)}))}if(g.formative2)if(Ne)try{er=await no("formative2",e,ge)}catch(Q){H(ye=>({...ye,tcpl_lab2:String((Q==null?void 0:Q.message)||Q)}))}else try{xt=await f0("formative2",e,ge)}catch(Q){H(ye=>({...ye,formative2:String((Q==null?void 0:Q.message)||Q)}))}if(g.cia1)try{oe=await V1(e,ge)}catch(Q){H(ye=>({...ye,cia1:String((Q==null?void 0:Q.message)||Q)}))}if(g.cia2)try{ue=await h0("cia2",e,ge)}catch(Q){H(ye=>({...ye,cia2:String((Q==null?void 0:Q.message)||Q)}))}try{if(g.ssa1&&(!dt||!(dt.marks&&Object.keys(dt.marks||{}).length)))try{const Q=await Mn("ssa1",e,ge);Q&&Q.draft&&Q.draft.marks&&(dt={marks:Q.draft.marks})}catch(Q){H(ye=>({...ye,ssa1_draft:String((Q==null?void 0:Q.message)||Q)}))}if(g.ssa2&&(!Ue||!(Ue.marks&&Object.keys(Ue.marks||{}).length)))try{const Q=await Mn("ssa2",e,ge);Q&&Q.draft&&Q.draft.marks&&(Ue={marks:Q.draft.marks})}catch(Q){H(ye=>({...ye,ssa2_draft:String((Q==null?void 0:Q.message)||Q)}))}if(g.formative1){if(Ne){if(!(at!=null&&at.data))try{const Q=await Mn("formative1",e,ge);Q&&Q.draft&&(at={data:Q.draft.data??Q.draft})}catch(Q){H(ye=>({...ye,tcpl_lab1_draft:String((Q==null?void 0:Q.message)||Q)}))}}else if(!Re||!(Re.marks&&Object.keys(Re.marks||{}).length))try{const Q=await Mn("formative1",e,ge);Q&&Q.draft&&Q.draft.marks&&(Re={marks:Q.draft.marks})}catch(Q){H(ye=>({...ye,formative1_draft:String((Q==null?void 0:Q.message)||Q)}))}}if(g.formative2){if(Ne){if(!(er!=null&&er.data))try{const Q=await Mn("formative2",e,ge);Q&&Q.draft&&(er={data:Q.draft.data??Q.draft})}catch(Q){H(ye=>({...ye,tcpl_lab2_draft:String((Q==null?void 0:Q.message)||Q)}))}}else if(!xt||!(xt.marks&&Object.keys(xt.marks||{}).length))try{const Q=await Mn("formative2",e,ge);Q&&Q.draft&&Q.draft.marks&&(xt={marks:Q.draft.marks})}catch(Q){H(ye=>({...ye,formative2_draft:String((Q==null?void 0:Q.message)||Q)}))}}if(g.cia1&&(!oe||!oe.data))try{const Q=await Mn("cia1",e,ge);Q&&Q.draft&&(oe={data:Q.draft.data??Q.draft})}catch(Q){H(ye=>({...ye,cia1_draft:String((Q==null?void 0:Q.message)||Q)}))}if(g.cia2&&(!ue||!ue.data))try{const Q=await Mn("cia2",e,ge);Q&&Q.draft&&(ue={data:Q.draft.data??Q.draft})}catch(Q){H(ye=>({...ye,cia2_draft:String((Q==null?void 0:Q.message)||Q)}))}}catch{}Ne&&X({lab1:(at==null?void 0:at.data)??null,lab2:(er==null?void 0:er.data)??null}),E({ssa1:dt!=null&&dt.marks&&typeof dt.marks=="object"?dt.marks:{},ssa2:Ue!=null&&Ue.marks&&typeof Ue.marks=="object"?Ue.marks:{},f1:!Ne&&(Re!=null&&Re.marks)&&typeof Re.marks=="object"?Re.marks:{},f2:!Ne&&(xt!=null&&xt.marks)&&typeof xt.marks=="object"?xt.marks:{},cia1:(oe==null?void 0:oe.data)??null,cia2:(ue==null?void 0:ue.data)??null})}}catch(Ne){E({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),ee({cia1:null,cia2:null,model:null}),X({lab1:null,lab2:null}),de((Ne==null?void 0:Ne.message)||"Failed to load published marks")}finally{V(!1)}};x.useEffect(()=>{e&&jt()},[e,P,b,g,s]),x.useEffect(()=>{const ge=Ne=>{try{const dt=(Ne==null?void 0:Ne.detail)||{},Ue=dt.subjectId,Re=dt.assessment;if(!Ue||String(Ue)!==String(e)||Re&&!["ssa1","formative1","cia1"].includes(String(Re)))return;jt()}catch{}};return window.addEventListener("obe:published",ge),()=>window.removeEventListener("obe:published",ge)},[e]);const ur=x.useMemo(()=>{const ge=new Map;if(b){const it=rj/2,We=(Ge,Ye,ft)=>{const bt=Ge!=null&&Ge.sheet&&typeof Ge.sheet=="object"?Ge.sheet:{},Vt=bt!=null&&bt.rowsByStudentId&&typeof bt.rowsByStudentId=="object"?bt.rowsByStudentId:{},Ft=na(Number((bt==null?void 0:bt.expCountA)??0),0,12),gr=na(Number((bt==null?void 0:bt.expCountB)??0),0,12),Ar=!!(bt!=null&&bt.coAEnabled),kr=!!(bt!=null&&bt.coBEnabled),At=!!(bt!=null&&bt.ciaExamEnabled),Ut=bt!=null&&bt.coConfigs&&typeof bt.coConfigs=="object"?bt.coConfigs:null,Kr=Ut?Ut[String(Ye)]:null,$t=ft!=null&&Ut?Ut[String(ft)]:null,fr=Kr?!!Kr.enabled:Ar,Or=ft!=null?$t?!!$t.enabled:kr:!1,gt=Kr?na(Number(Kr.expCount??0),0,12):Ft,Jt=ft!=null?$t?na(Number($t.expCount??0),0,12):gr:0,ht=Kr&&Number.isFinite(Number(Kr.expMax))?Number(Kr.expMax):Number.isFinite(Number(bt==null?void 0:bt.expMaxA))?Number(bt.expMaxA):25,Ct=ft!=null?$t&&Number.isFinite(Number($t.expMax))?Number($t.expMax):Number.isFinite(Number(bt==null?void 0:bt.expMaxB))?Number(bt.expMaxB):25:0,rr=ht+(At?it:0),kt=ft!=null?Ct+(At?it:0):0;return{get:Rt=>{const Gt=Vt[String(Rt)]||{},ir=Gt!=null&&Gt.marksByCo&&typeof Gt.marksByCo=="object"?Gt.marksByCo:{},Bt=(ir==null?void 0:ir[String(Ye)])??Gt.marksA,vr=ft!=null?(ir==null?void 0:ir[String(ft)])??Gt.marksB:[],Cr=Xg(Bt,gt).slice(0,fr?gt:0),Tr=Xg(vr,Jt).slice(0,Or?Jt:0),xr=lv(Cr),Xt=lv(Tr),ie=Gt==null?void 0:Gt.ciaExam,I=typeof ie=="number"&&Number.isFinite(ie)?ie:null,se=xr!=null||Xt!=null||I!=null,ve=se?(xr??0)+(At?(I??0)/2:0):null,Pe=se?(Xt??0)+(At?(I??0)/2:0):null;return{a:ve==null?null:na(ve,0,rr),b:Pe==null?null:na(Pe,0,kt)}},coA:Ye,coB:ft,CO_MAX_A:rr,CO_MAX_B:kt,expMaxA:ht,expMaxB:Ct,expCountA:gt,expCountB:Jt}},De=We(F.cia1,1,2),pe=We(F.cia2,3,4),Je=We(F.model,5,null);for(const Ge of re){const Ye=De.get(Ge.id),ft=pe.get(Ge.id),bt=Je.get(Ge.id);ge.set(Ge.id,{co1:Ye.a,co2:Ye.b,co3:ft.a,co4:ft.b,co5:bt.a,coMax1:De.CO_MAX_A,coMax2:De.CO_MAX_B,coMax3:pe.CO_MAX_A,coMax4:pe.CO_MAX_B,coMax5:Je.CO_MAX_A})}return ge}const Ne=In(s)==="TCPL",dt=it=>{const We=it!=null&&it.sheet&&typeof it.sheet=="object"?it.sheet:{},De=We!=null&&We.rowsByStudentId&&typeof We.rowsByStudentId=="object"?We.rowsByStudentId:{},pe=na(Number((We==null?void 0:We.expCountA)??0),0,12),Je=na(Number((We==null?void 0:We.expCountB)??0),0,12),Ge=Number.isFinite(Number(We==null?void 0:We.expMaxA))?Number(We.expMaxA):25,Ye=Number.isFinite(Number(We==null?void 0:We.expMaxB))?Number(We.expMaxB):25,ft=(We==null?void 0:We.ciaExamEnabled)!==!1,bt=rj/2,Vt=Ge+(ft?bt:0),Ft=Ye+(ft?bt:0);return{get:Ar=>{const kr=De[String(Ar)]||{},At=Xg(kr==null?void 0:kr.marksA,pe),Ut=Xg(kr==null?void 0:kr.marksB,Je),Kr=lv(At),$t=lv(Ut),fr=kr==null?void 0:kr.ciaExam,Or=typeof fr=="number"&&Number.isFinite(fr)?fr:null,gt=Kr!=null||$t!=null||Or!=null,Jt=gt?(Kr??0)+(ft?(Or??0)/2:0):null,ht=gt?($t??0)+(ft?(Or??0)/2:0):null;return{a:Jt==null?null:na(Jt,0,Vt),b:ht==null?null:na(ht,0,Ft)}},CO_MAX_A:Vt,CO_MAX_B:Ft}},Ue=Ne?dt(z.lab1):null,Re=Ne?dt(z.lab2):null,xt=(()=>{if(!v)return null;const it=String(P??"none"),We=In(s),De=[];We==="THEORY"?(De.push(`model_theory_sheet_${e}_${it}`),De.push(`model_theory_sheet_${e}_none`)):We==="TCPL"?(De.push(`model_tcpl_sheet_${e}_${it}`),De.push(`model_tcpl_sheet_${e}_none`)):We==="TCPR"&&(De.push(`model_tcpr_sheet_${e}_${it}`),De.push(`model_tcpr_sheet_${e}_none`)),De.push(`model_sheet_${e}`);for(const pe of De){const Je=Pn(pe);if(Je&&typeof Je=="object")return Je}return null})(),at=it=>{const We=In(s),De=xt&&typeof xt=="object"?xt:null,Ge=We==="THEORY"?nj:0;if(!v)return{mark:null,max:Ge};if(!De)return{mark:null,max:Ge};let Ye=Ge;const ft=`id:${String(it.id)}`,bt=it.reg_no?`reg:${String(it.reg_no).trim()}`:"",Vt=De[ft]||(bt?De[bt]:null)||null;if(!Vt||typeof Vt!="object")return{mark:null,max:Ye};const Ft=!!Vt.absent,gr=String(Vt.absentKind||"AL").toUpperCase(),Ar=Vt.q&&typeof Vt.q=="object"?Vt.q:{};let kr=!1,At=0;if(Ye=0,We==="THEORY"){Ye=nj;for(let Ut=0;Ut<J4.length;Ut++){const Kr=J4[Ut],$t=Ar[Kr.key],fr=Cl($t);if(fr==null)continue;kr=!0;const Or=na(fr,0,Kr.max);oK[Ut]===5&&(At+=Or)}}else if(We==="TCPL"||We==="TCPR"){const Ut=We==="TCPR",Kr=Ut?12:15,$t=Ut?8:10,fr=Ut?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];for(let Jt=0;Jt<Kr;Jt++){const ht=Jt+1,Ct=`q${ht}`,rr=ht<=$t?2:16,kt=fr[Jt]??1;kt===5&&(Ye+=rr);const rt=Ar[Ct],Rt=Cl(rt);if(Rt==null)continue;kr=!0;const Gt=na(Rt,0,rr);kt===5&&(At+=Gt)}const Or=Cl(Vt.lab);Or!=null&&(kr=!0);const gt=Or==null?null:na(Or,0,30);Ut?(Ye+=30,gt!=null&&(At+=gt)):(Ye+=30/5,gt!=null&&(At+=gt/5))}return kr?Ft&&gr==="AL"?{mark:0,max:Ye}:{mark:na(At,0,Ye),max:Ye}:Ft&&gr==="AL"?{mark:0,max:Ye}:{mark:null,max:Ye}},er=ne.f1&&typeof ne.f1=="object"?ne.f1:{},oe=ne.f2&&typeof ne.f2=="object"?ne.f2:{},ue=ne.cia1&&typeof ne.cia1=="object"?ne.cia1:null,Q=Array.isArray(ue==null?void 0:ue.questions)?ue.questions.map(it=>({key:String((it==null?void 0:it.key)||""),label:String((it==null?void 0:it.label)||(it==null?void 0:it.key)||""),max:Number((it==null?void 0:it.max)||0),co:wR(it==null?void 0:it.co),btl:Math.min(6,Math.max(1,Number((it==null?void 0:it.btl)||1)))})).filter(it=>it.key):wt,ye=ue!=null&&ue.rowsByStudentId&&typeof ue.rowsByStudentId=="object"?ue.rowsByStudentId:{},je=ne.cia2&&typeof ne.cia2=="object"?ne.cia2:null,Ce=Array.isArray(je==null?void 0:je.questions)?je.questions.map(it=>({key:String((it==null?void 0:it.key)||""),label:String((it==null?void 0:it.label)||(it==null?void 0:it.key)||""),max:Number((it==null?void 0:it.max)||0),co:SR(it==null?void 0:it.co),btl:Math.min(6,Math.max(1,Number((it==null?void 0:it.btl)||1)))})).filter(it=>it.key):Pt,ot=je!=null&&je.rowsByStudentId&&typeof je.rowsByStudentId=="object"?je.rowsByStudentId:{};for(const it of re){const We=(ne.ssa1&&typeof ne.ssa1=="object"?ne.ssa1[String(it.id)]:null)??null,De=We==null?null:Number(We)/2,pe=De==null?null:na(De,0,Ht.ssa1.co1),Je=De==null?null:na(De,0,Ht.ssa1.co2),Ge=(ne.ssa2&&typeof ne.ssa2=="object"?ne.ssa2[String(it.id)]:null)??null,Ye=Ge==null?null:Number(Ge)/2,ft=Ye==null?null:na(Ye,0,Ht.ssa2.co3),bt=Ye==null?null:na(Ye,0,Ht.ssa2.co4),Vt=Ne&&Ue?Ue.get(it.id):null,Ft=Ne&&Re?Re.get(it.id):null,gr=er[String(it.id)]||{},Ar=Cl(gr==null?void 0:gr.skill1),kr=Cl(gr==null?void 0:gr.skill2),At=Cl(gr==null?void 0:gr.att1),Ut=Cl(gr==null?void 0:gr.att2),Kr=Ne?(Vt==null?void 0:Vt.a)??null:Ar!=null&&At!=null?na(Ar+At,0,Ht.f1.co1):null,$t=Ne?(Vt==null?void 0:Vt.b)??null:kr!=null&&Ut!=null?na(kr+Ut,0,Ht.f1.co2):null,fr=oe[String(it.id)]||{},Or=Cl(fr==null?void 0:fr.skill1),gt=Cl(fr==null?void 0:fr.skill2),Jt=Cl(fr==null?void 0:fr.att1),ht=Cl(fr==null?void 0:fr.att2),Ct=Ne?(Ft==null?void 0:Ft.a)??null:Or!=null&&Jt!=null?na(Or+Jt,0,Ht.f2.co3):null,rr=Ne?(Ft==null?void 0:Ft.b)??null:gt!=null&&ht!=null?na(gt+ht,0,Ht.f2.co4):null,kt=ye[String(it.id)]||{},rt=!!(kt!=null&&kt.absent),Rt=kt!=null&&kt.q&&typeof kt.q=="object"?kt.q:{};let Gt=null,ir=null;if(!rt){let ie=0,I=0,se=!1;Q.forEach((ve,Pe)=>{const Ke=Rt==null?void 0:Rt[ve.key],pt=Cl(Ke);if(pt==null)return;se=!0;const ut=na(pt,0,Number(ve.max)||pt),Lt=_R(Q,Pe);ie+=ut*Lt.co1,I+=ut*Lt.co2}),se&&(Gt=na(ie,0,Ht.cia1.co1),ir=na(I,0,Ht.cia1.co2))}const Bt=ot[String(it.id)]||{},vr=!!(Bt!=null&&Bt.absent),Cr=Bt!=null&&Bt.q&&typeof Bt.q=="object"?Bt.q:{};let Tr=null,xr=null;if(!vr){let ie=0,I=0,se=!1;Ce.forEach((ve,Pe)=>{const Ke=Cr==null?void 0:Cr[ve.key],pt=Cl(Ke);if(pt==null)return;se=!0;const ut=na(pt,0,Number(ve.max)||pt),Lt=kR(Ce,Pe);ie+=ut*Lt.co3,I+=ut*Lt.co4}),se&&(Tr=na(ie,0,Ht.cia2.co3),xr=na(I,0,Ht.cia2.co4))}const Xt=v?at(it):{mark:null,max:0};ge.set(it.id,{ssaCo1:pe,ssaCo2:Je,ssaCo3:ft,ssaCo4:bt,ciaCo1:Gt,ciaCo2:ir,ciaCo3:Tr,ciaCo4:xr,f1Co1:Kr,f1Co2:$t,f2Co3:Ct,f2Co4:rr,modelCo5:Xt.mark,modelCo5Max:Xt.max})}return ge},[ne,F,z,re,Ht,wt,b,s,e,P,v]),Ir=x.useMemo(()=>{if(!y)return null;const ge=Ne=>{const dt=Ne!=null&&Ne.sheet&&typeof Ne.sheet=="object"?Ne.sheet:{},Ue=Number.isFinite(Number(dt==null?void 0:dt.expMaxA))?Number(dt.expMaxA):25,Re=Number.isFinite(Number(dt==null?void 0:dt.expMaxB))?Number(dt.expMaxB):25,xt=(dt==null?void 0:dt.ciaExamEnabled)!==!1,at=rj/2;return{a:Ue+(xt?at:0),b:Re+(xt?at:0)}};return{lab1:ge(z.lab1),lab2:ge(z.lab2)}},[y,z]),Rr=x.useMemo(()=>{var Q,ye,je,Ce;const ge=y?((Q=Ir==null?void 0:Ir.lab1)==null?void 0:Q.a)??Ht.f1.co1:Ht.f1.co1,Ne=y?((ye=Ir==null?void 0:Ir.lab1)==null?void 0:ye.b)??Ht.f1.co2:Ht.f1.co2,dt=y?((je=Ir==null?void 0:Ir.lab2)==null?void 0:je.a)??Ht.f2.co3:Ht.f2.co3,Ue=y?((Ce=Ir==null?void 0:Ir.lab2)==null?void 0:Ce.b)??Ht.f2.co4:Ht.f2.co4,Re=(g.ssa1?Ht.ssa1.co1:0)+(g.cia1?Ht.cia1.co1:0)+(g.formative1?ge:0),xt=(g.ssa1?Ht.ssa1.co2:0)+(g.cia1?Ht.cia1.co2:0)+(g.formative1?Ne:0),at=(g.ssa2?Ht.ssa2.co3:0)+(g.cia2?Ht.cia2.co3:0)+(g.formative2?dt:0),er=(g.ssa2?Ht.ssa2.co4:0)+(g.cia2?Ht.cia2.co4:0)+(g.formative2?Ue:0),oe=v?ce:0,ue=Re+xt+at+er+oe;return{f1MaxCo1:ge,f1MaxCo2:Ne,f2MaxCo3:dt,f2MaxCo4:Ue,co1:Re,co2:xt,co3:at,co4:er,co5:oe,total:ue}},[y,Ir,Ht,g,v,ce]),Nr=x.useMemo(()=>{if(b){const it=Pr||{co1:55,co2:55,co3:55,co4:55,co5:55},We=(Ge,Ye)=>Ge==null||!Ye?null:as(Ge/Ye*100),De=(Ge,Ye)=>Ge==null||!Ye?null:vf(Ge/Ye*3),pe=[F.cia1,F.cia2,F.model].filter(Boolean),Je=Ge=>{const Ye=[0,0,0,0,0,0,0],ft=[0,0,0,0,0,0,0];for(const Vt of pe){const Ft=Vt!=null&&Vt.sheet&&typeof Vt.sheet=="object"?Vt.sheet:{},Ar=(Ft!=null&&Ft.rowsByStudentId&&typeof Ft.rowsByStudentId=="object"?Ft.rowsByStudentId:{})[String(Ge)]||{},kr=Ft!=null&&Ft.coConfigs&&typeof Ft.coConfigs=="object"?Ft.coConfigs:null,At=Ar!=null&&Ar.marksByCo&&typeof Ar.marksByCo=="object"?Ar.marksByCo:{},Ut=!!(Ft!=null&&Ft.coAEnabled),Kr=!!(Ft!=null&&Ft.coBEnabled),$t=na(Number((Ft==null?void 0:Ft.expCountA)??0),0,12),fr=na(Number((Ft==null?void 0:Ft.expCountB)??0),0,12),Or=Number.isFinite(Number(Ft==null?void 0:Ft.expMaxA))?Number(Ft.expMaxA):25,gt=Number.isFinite(Number(Ft==null?void 0:Ft.expMaxB))?Number(Ft.expMaxB):25,Jt=Array.isArray(Ft==null?void 0:Ft.btlA)?Ft.btlA:[],ht=Array.isArray(Ft==null?void 0:Ft.btlB)?Ft.btlB:[],Ct=(rr,kt,rt,Rt,Gt,ir)=>{if(!kt||rt<=0||!Rt)return;const Bt=Xg(ir,rt);for(let vr=0;vr<rt;vr++){const Cr=aj(Gt[vr]),Tr=typeof Bt[vr]=="number"&&Number.isFinite(Bt[vr])?Bt[vr]:null;if(!Cr||Tr==null)continue;const xr=na(Tr,0,Rt)*(10/Rt);Ye[Cr]+=xr,ft[Cr]+=1}};if(kr)for(const[rr,kt]of Object.entries(kr)){const rt=Number(rr);if(!Number.isFinite(rt)||!kt||typeof kt!="object")continue;const Rt=!!kt.enabled,Gt=na(Number(kt.expCount??0),0,12),ir=Number.isFinite(Number(kt.expMax))?Number(kt.expMax):25,Bt=Array.isArray(kt.btl)?kt.btl:[],vr=(At==null?void 0:At[String(rt)])??[];Ct(rt,Rt,Gt,ir,Bt,vr)}else Ct(0,Ut,$t,Or,Jt,Ar.marksA),Ct(0,Kr,fr,gt,ht,Ar.marksB)}const bt={};for(let Vt=1;Vt<=6;Vt++)bt[`btl${Vt}`]=ft[Vt]?as(Ye[Vt]/ft[Vt]):null,bt[`btl${Vt}Pct`]=ft[Vt]?as(Ye[Vt]/ft[Vt]/10*100):null;return bt};return re.map((Ge,Ye)=>{const ft=ur.get(Ge.id)||{},bt=typeof ft.co1=="number"?ft.co1:null,Vt=typeof ft.co2=="number"?ft.co2:null,Ft=typeof ft.co3=="number"?ft.co3:null,gr=typeof ft.co4=="number"?ft.co4:null,Ar=typeof ft.co5=="number"?ft.co5:null,kr=Je(Ge.id),At=[bt,Vt,Ft,gr,Ar].every(Ut=>typeof Ut=="number")?as(bt+Vt+Ft+gr+Ar):null;return{sno:Ye+1,...Ge,co1:bt,co1Pct:We(bt,it.co1),co1_3pt:De(bt,it.co1),co2:Vt,co2Pct:We(Vt,it.co2),co2_3pt:De(Vt,it.co2),co3:Ft,co3Pct:We(Ft,it.co3),co3_3pt:De(Ft,it.co3),co4:gr,co4Pct:We(gr,it.co4),co4_3pt:De(gr,it.co4),co5:Ar,co5Pct:We(Ar,it.co5),co5_3pt:De(Ar,it.co5),...kr,total:At}})}const ge=g.ssa1?L.ssa1:0,Ne=g.cia1?L.cia1:0,dt=g.formative1?L.formative1:0,Ue=g.ssa2?L.ssa1:0,Re=g.cia2?L.cia1:0,xt=g.formative2?L.formative1:0,{f1MaxCo1:at,f1MaxCo2:er,f2MaxCo3:oe,f2MaxCo4:ue}=Rr,Q=Rr.co1,ye=Rr.co2,je=Rr.co3,Ce=Rr.co4,ot=Rr.co5;return re.map((it,We)=>{const De=ur.get(it.id),pe=cv({ssaMark:(De==null?void 0:De.ssaCo1)??null,ciaMark:(De==null?void 0:De.ciaCo1)??null,f1Mark:(De==null?void 0:De.f1Co1)??null,ssaMax:Ht.ssa1.co1,ciaMax:Ht.cia1.co1,f1Max:at,ssaW:ge,ciaW:Ne,f1W:dt,outOf:Q}),Je=cv({ssaMark:(De==null?void 0:De.ssaCo2)??null,ciaMark:(De==null?void 0:De.ciaCo2)??null,f1Mark:(De==null?void 0:De.f1Co2)??null,ssaMax:Ht.ssa1.co2,ciaMax:Ht.cia1.co2,f1Max:er,ssaW:ge,ciaW:Ne,f1W:dt,outOf:ye}),Ge=cv({ssaMark:(De==null?void 0:De.ssaCo3)??null,ciaMark:(De==null?void 0:De.ciaCo3)??null,f1Mark:(De==null?void 0:De.f2Co3)??null,ssaMax:Ht.ssa2.co3,ciaMax:Ht.cia2.co3,f1Max:oe,ssaW:Ue,ciaW:Re,f1W:xt,outOf:je}),Ye=cv({ssaMark:(De==null?void 0:De.ssaCo4)??null,ciaMark:(De==null?void 0:De.ciaCo4)??null,f1Mark:(De==null?void 0:De.f2Co4)??null,ssaMax:Ht.ssa2.co4,ciaMax:Ht.cia2.co4,f1Max:ue,ssaW:Ue,ciaW:Re,f1W:xt,outOf:Ce}),ft=pe==null||!Q?null:as(pe/Q*100),bt=Je==null||!ye?null:as(Je/ye*100),Vt=Ge==null||!je?null:as(Ge/je*100),Ft=Ye==null||!Ce?null:as(Ye/Ce*100),gr=typeof(De==null?void 0:De.modelCo5)=="number"&&Number.isFinite(De.modelCo5)?De.modelCo5:null,Ar=typeof(De==null?void 0:De.modelCo5Max)=="number"&&Number.isFinite(De.modelCo5Max)?Math.max(0,De.modelCo5Max):nj,kr=!v||gr==null||!Ar||!ot?null:na(gr/Ar*ot,0,ot),At=kr==null||!ot?null:as(kr/ot*100),Ut=pe==null||!Q?null:vf(pe/Q*3),Kr=Je==null||!ye?null:vf(Je/ye*3),$t=Ge==null||!je?null:vf(Ge/je*3),fr=Ye==null||!Ce?null:vf(Ye/Ce*3),Or=kr==null||!ot?null:vf(kr/ot*3),gt=[{enabled:Q>0,v:pe},{enabled:ye>0,v:Je},{enabled:je>0,v:Ge},{enabled:Ce>0,v:Ye},...v?[{enabled:ot>0,v:kr}]:[]];let Jt=!1,ht=!1,Ct=0;for(const kt of gt)if(kt.enabled){if(Jt=!0,typeof kt.v!="number"||!Number.isFinite(kt.v)){ht=!0;break}Ct+=kt.v}const rr=!Jt||ht?null:as(Ct);return{sno:We+1,...it,co1:pe,co1Pct:ft,co1_3pt:Ut,co2:Je,co2Pct:bt,co2_3pt:Kr,co3:Ge,co3Pct:Vt,co3_3pt:$t,co4:Ye,co4Pct:Ft,co4_3pt:fr,co5:kr,co5Pct:At,co5_3pt:Or,total:rr}})},[re,ur,Ht,L,g,v,ce,Rr,b,Pr,F]),zr=x.useMemo(()=>{if(b){const at=er=>{const oe=Nr.map(ue=>ue==null?void 0:ue[er]).filter(ue=>typeof ue=="number");return oe.length?vf(oe.reduce((ue,Q)=>ue+Q,0)/oe.length):null};return{strength:re.length,co1Avg3pt:at("co1_3pt"),co2Avg3pt:at("co2_3pt"),co3Avg3pt:at("co3_3pt"),co4Avg3pt:at("co4_3pt"),co5Avg3pt:at("co5_3pt")}}const ge=Nr.map(at=>at.co1_3pt).filter(at=>typeof at=="number"),Ne=Nr.map(at=>at.co2_3pt).filter(at=>typeof at=="number"),dt=Nr.map(at=>at.co3_3pt).filter(at=>typeof at=="number"),Ue=Nr.map(at=>at.co4_3pt).filter(at=>typeof at=="number"),Re=Nr.map(at=>at.co5_3pt).filter(at=>typeof at=="number"),xt=at=>at.length?vf(at.reduce((er,oe)=>er+oe,0)/at.length):null;return{strength:re.length,co1Avg3pt:xt(ge),co2Avg3pt:xt(Ne),co3Avg3pt:xt(dt),co4Avg3pt:xt(Ue),...v?{co5Avg3pt:xt(Re)}:{}}},[Nr,re.length,b,v]),_n=x.useMemo(()=>{const ge=Number(Pr==null?void 0:Pr.co1);return Number.isFinite(ge)&&ge>0?ge:55},[Pr]),Yr=x.useMemo(()=>{if(!b)return{1:0,2:0,3:0,4:0,5:0,6:0};const ge={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1},Ne=[F.cia1,F.cia2,F.model].filter(Boolean);for(const dt of Ne){const Ue=dt!=null&&dt.sheet&&typeof dt.sheet=="object"?dt.sheet:{},Re=na(Number((Ue==null?void 0:Ue.expCountA)??0),0,12),xt=na(Number((Ue==null?void 0:Ue.expCountB)??0),0,12),at=!!(Ue!=null&&Ue.coAEnabled),er=!!(Ue!=null&&Ue.coBEnabled),oe=Array.isArray(Ue==null?void 0:Ue.btlA)?Ue.btlA:[],ue=Array.isArray(Ue==null?void 0:Ue.btlB)?Ue.btlB:[];if(at)for(let Q=0;Q<Re;Q++){const ye=aj(oe[Q]);ye&&(ge[ye]=!0)}if(er)for(let Q=0;Q<xt;Q++){const ye=aj(ue[Q]);ye&&(ge[ye]=!0)}}return{1:ge[1]?10:0,2:ge[2]?10:0,3:ge[3]?10:0,4:ge[4]?10:0,5:ge[5]?10:0,6:ge[6]?10:0}},[b,F]),pn={padding:"8px 10px",borderRadius:10,border:"1px solid #e5e7eb",width:90};return i.jsxs("div",{style:{display:"grid",gap:14},children:[(_e||K)&&i.jsx("div",{style:{fontSize:12,color:K?"#b91c1c":"#6b7280"},children:_e?"Loading published marks":K}),Z&&Object.keys(Z).length>0&&i.jsx("div",{style:{marginTop:6,fontSize:12},children:Object.entries(Z).map(([ge,Ne])=>Ne?i.jsxs("div",{style:{color:"#b91c1c"},children:[ge,": ",String(Ne)]},ge):null)}),i.jsxs("div",{style:{padding:16,borderRadius:12,background:"linear-gradient(180deg,#ffffff, #f6fbff)",border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13, 60, 100, 0.06)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:18,fontWeight:800,color:"#0b4a6f"},children:b?"CO Attainment (LAB)":"CO Attainment (Summative + Formative)"}),i.jsx("div",{style:{marginTop:6,color:"#264653",fontSize:13},children:b?"Uses published LAB sheets: CIA1 LAB (CO1/CO2) + CIA2 LAB (CO3/CO4) + MODEL LAB (CO5).":"Uses weighted blending per CO: SSA1 + CIA1 + Formative1 (based on your Excel formula)."})]}),i.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Teaching Assignment / Section"}),i.jsxs("select",{value:P??"",onChange:ge=>R(ge.target.value?Number(ge.target.value):null),style:{padding:"10px 12px",borderRadius:10,border:"1px solid #e5e7eb",minWidth:320},children:[i.jsx("option",{value:"",children:"Select"}),C.map(ge=>{const Ne=ge.department,dt=(Ne==null?void 0:Ne.short_name)||(Ne==null?void 0:Ne.code)||(Ne==null?void 0:Ne.name)||ge.department_name||"",Ue=ge.semester;return i.jsxs("option",{value:ge.id,children:[ge.section_name," ",Ue?` Sem ${Ue}`:""," ",ge.academic_year?` ${ge.academic_year}`:""," ",dt?` ${dt}`:""]},ge.id)})]})]})})]}),A&&i.jsx("div",{style:{marginTop:10,background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:A}),b?i.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12,marginTop:12},children:i.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[i.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"LAB CO max"}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["CO max values are pulled from published LAB sheets only.",Pr?i.jsx(i.Fragment,{children:_.map((ge,Ne)=>{const dt=`co${ge}`;return i.jsxs(Zr.Fragment,{children:[Ne>0&&" | ","CO",ge,": ",i.jsx("b",{children:Pr[dt]})]},ge)})}):i.jsxs(i.Fragment,{children:[" Each CO max is ",i.jsx("b",{children:_n}),"."]})]}),i.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",i.jsx("b",{children:zr.strength}),_.map(ge=>{const Ne=`co${ge}Avg3pt`;return i.jsxs(Zr.Fragment,{children:["| CO",ge," avg (3pt): ",i.jsx("b",{children:zr[Ne]??"-"})]},ge)})]})]})}):i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr",gap:12,marginTop:12},children:[i.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[i.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Max marks per CO (P4:P6)"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 120px 120px 120px",gap:8,alignItems:"center"},children:[i.jsx("div",{}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"SSA1"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"CIA1"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"Formative1"}),i.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO1"}),i.jsx("div",{children:Ht.ssa1.co1}),i.jsx("div",{children:Ht.cia1.co1}),i.jsx("div",{children:Ht.f1.co1}),i.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO2"}),i.jsx("div",{children:Ht.ssa1.co2}),i.jsx("div",{children:Ht.cia1.co2}),i.jsx("div",{children:Ht.f1.co2})]}),i.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:_.filter(ge=>ge<=4||v).map((ge,Ne)=>{const dt=`co${ge}`,Ue=ge===5?ce:Rr[dt];return i.jsxs(Zr.Fragment,{children:[Ne>0&&i.jsx(i.Fragment,{children:"|"}),"CO",ge," total max: ",i.jsx("b",{children:Ue})]},ge)})})]}),i.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[i.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[i.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Weights (R4:R6)"}),i.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Source: ",i.jsx("b",{children:he==="server"?"IQAC (server)":he==="local"?"IQAC (local)":"Defaults"})]})]}),Ie&&i.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:Ie}),Qe&&i.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",Qe]}),vt!=null&&i.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#475569"},children:["Known class-types on server/local: ",vt]}),i.jsx("div",{style:{marginTop:6},children:i.jsxs("button",{onClick:()=>ct(ge=>!ge),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[Be?"Hide":"Show"," raw IQAC mapping"]})}),Be&&i.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(ke.current||{},null,2).slice(0,3200)}),i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[i.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1",i.jsx("input",{type:"number",step:"0.1",value:L.ssa1,onChange:ge=>U(Ne=>({...Ne,ssa1:Number(ge.target.value)})),disabled:!q,style:pn})]}),i.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1",i.jsx("input",{type:"number",step:"0.1",value:L.cia1,onChange:ge=>U(Ne=>({...Ne,cia1:Number(ge.target.value)})),disabled:!q,style:pn})]}),i.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1",i.jsx("input",{type:"number",step:"0.1",value:L.formative1,onChange:ge=>U(Ne=>({...Ne,formative1:Number(ge.target.value)})),disabled:!q,style:pn})]})]}),i.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",i.jsx("b",{children:zr.strength})," | CO1 avg (3pt): ",i.jsx("b",{children:zr.co1Avg3pt??"-"})," | CO2 avg (3pt): ",i.jsx("b",{children:zr.co2Avg3pt??"-"})]}),i.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Note: CIA1 CO marks are computed from the locally saved CIA1 question-wise sheet."})]})]}),i.jsx("div",{style:{marginTop:12},children:i.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[i.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[i.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Assessment Weights"}),i.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Class Type: ",i.jsx("b",{children:s||"Unknown"})," | Source: ",i.jsx("b",{children:he==="server"?"IQAC (server)":he==="local"?"IQAC (local)":"Defaults"})]})]}),Ie&&i.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:Ie}),Qe&&i.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",Qe]}),i.jsx("div",{style:{marginTop:6},children:i.jsxs("button",{onClick:()=>ct(ge=>!ge),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[Be?"Hide":"Show"," raw IQAC mapping"]})}),Be&&i.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(ke.current||{},null,2).slice(0,3200)}),i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:12},children:[i.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1 Weight",i.jsx("input",{type:"number",step:"0.1",value:L.ssa1,onChange:ge=>U(Ne=>({...Ne,ssa1:Number(ge.target.value)})),disabled:!q,style:pn})]}),i.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1 Weight",i.jsx("input",{type:"number",step:"0.1",value:L.cia1,onChange:ge=>U(Ne=>({...Ne,cia1:Number(ge.target.value)})),disabled:!q,style:pn})]}),i.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1 Weight",i.jsx("input",{type:"number",step:"0.1",value:L.formative1,onChange:ge=>U(Ne=>({...Ne,formative1:Number(ge.target.value)})),disabled:!q,style:pn})]}),v&&i.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CO5 Weightage (MODEL)",i.jsx("input",{type:"number",step:"1",value:ce,onChange:ge=>W(Number(ge.target.value)),disabled:!q,style:pn})]})]}),i.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["These weights determine how SSA1, CIA1, and Formative1 assessments contribute to CO attainment calculations.",!q&&i.jsxs("span",{style:{color:"#059669",fontWeight:600},children:[" Values shown are appropriate defaults for ",s||"this"," class type."]})]})]})})]}),B&&i.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:B}),i.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:i.jsx("button",{onClick:()=>Se(!nt),style:{padding:"8px 16px",backgroundColor:nt?"#059669":"#0ea5e9",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontWeight:600,fontSize:13},children:nt?"Show CO Columns":"Hide CO Columns"})}),N?i.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):i.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,overflow:"auto",background:"#fff"},children:b?i.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:2100},children:[i.jsxs("thead",{children:[i.jsxs("tr",{children:[i.jsx("th",{rowSpan:2,style:va,children:"S.No"}),i.jsx("th",{rowSpan:2,style:va,children:"Section"}),i.jsx("th",{rowSpan:2,style:va,children:"Register No"}),i.jsx("th",{rowSpan:2,style:va,children:"Name"}),!nt&&i.jsx(i.Fragment,{children:_.map(ge=>i.jsxs("th",{colSpan:3,style:wf,children:["CO",ge]},`co${ge}`))}),i.jsx("th",{rowSpan:2,style:va,children:"CQI Entry"}),i.jsx("th",{colSpan:2,style:wf,children:"BTL-1"}),i.jsx("th",{colSpan:2,style:wf,children:"BTL-2"}),i.jsx("th",{colSpan:2,style:wf,children:"BTL-3"}),i.jsx("th",{colSpan:2,style:wf,children:"BTL-4"}),i.jsx("th",{colSpan:2,style:wf,children:"BTL-5"}),i.jsx("th",{colSpan:2,style:wf,children:"BTL-6"}),i.jsxs("th",{rowSpan:2,style:va,children:["Total / ",as((Pr==null?void 0:Pr.total)??_n*5)]})]}),i.jsxs("tr",{children:[!nt&&i.jsx(i.Fragment,{children:_.map(ge=>{const Ne=`co${ge}`,dt=(Pr==null?void 0:Pr[Ne])??_n;return i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:va,children:dt}),i.jsx("th",{style:va,children:"%"}),i.jsx("th",{style:va,children:"3pt"})]},`co${ge}-cells`)})}),i.jsx("th",{style:va,children:Yr[1]}),i.jsx("th",{style:va,children:"%"}),i.jsx("th",{style:va,children:Yr[2]}),i.jsx("th",{style:va,children:"%"}),i.jsx("th",{style:va,children:Yr[3]}),i.jsx("th",{style:va,children:"%"}),i.jsx("th",{style:va,children:Yr[4]}),i.jsx("th",{style:va,children:"%"}),i.jsx("th",{style:va,children:Yr[5]}),i.jsx("th",{style:va,children:"%"}),i.jsx("th",{style:va,children:Yr[6]}),i.jsx("th",{style:va,children:"%"})]})]}),i.jsx("tbody",{children:Nr.map(ge=>i.jsxs("tr",{children:[i.jsx("td",{style:ka,children:ge.sno}),i.jsx("td",{style:ka,children:ge.section??""}),i.jsx("td",{style:ka,children:ge.reg_no}),i.jsx("td",{style:ka,children:ge.name}),!nt&&i.jsx(i.Fragment,{children:_.map(Ne=>{const dt=`co${Ne}`,Ue=`co${Ne}Pct`,Re=`co${Ne}_3pt`;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...ka,textAlign:"center"},children:ge[dt]==null?"":as(ge[dt])}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge[Ue]==null?"":ge[Ue]}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge[Re]==null?"":ge[Re]})]},`co${Ne}-row`)})}),i.jsx("td",{style:{...ka,textAlign:"center"},children:i.jsx("input",{type:"text",value:Te[ge.id]||"",onChange:Ne=>Dt({...Te,[ge.id]:Ne.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl1==null?"":as(ge.btl1)}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl1Pct==null?"":ge.btl1Pct}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl2==null?"":as(ge.btl2)}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl2Pct==null?"":ge.btl2Pct}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl3==null?"":as(ge.btl3)}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl3Pct==null?"":ge.btl3Pct}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl4==null?"":as(ge.btl4)}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl4Pct==null?"":ge.btl4Pct}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl5==null?"":as(ge.btl5)}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl5Pct==null?"":ge.btl5Pct}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl6==null?"":as(ge.btl6)}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge.btl6Pct==null?"":ge.btl6Pct}),i.jsx("td",{style:{...ka,textAlign:"center",fontWeight:700},children:ge.total==null?"":ge.total})]},ge.id))})]}):i.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:980},children:[i.jsxs("thead",{children:[i.jsxs("tr",{children:[i.jsx("th",{rowSpan:2,style:va,children:"S.No"}),i.jsx("th",{rowSpan:2,style:va,children:"Section"}),i.jsx("th",{rowSpan:2,style:va,children:"Register No"}),i.jsx("th",{rowSpan:2,style:va,children:"Name"}),!nt&&i.jsx(i.Fragment,{children:_.map(ge=>ge===5&&!v?null:i.jsxs("th",{colSpan:3,style:wf,children:["CO",ge]},`co${ge}`))}),i.jsx("th",{rowSpan:2,style:va,children:"CQI Entry"}),i.jsxs("th",{rowSpan:2,style:va,children:["Total / ",Rr.total]})]}),i.jsx("tr",{children:!nt&&i.jsx(i.Fragment,{children:_.map(ge=>{if(ge===5&&!v)return null;const Ne=`co${ge}`,dt=ge===5?ce:Rr[Ne];return i.jsxs(Zr.Fragment,{children:[i.jsx("th",{style:va,children:dt}),i.jsx("th",{style:va,children:"%"}),i.jsx("th",{style:va,children:"3pt"})]},`co${ge}-cells`)})})})]}),i.jsx("tbody",{children:Nr.map(ge=>i.jsxs("tr",{children:[i.jsx("td",{style:ka,children:ge.sno}),i.jsx("td",{style:ka,children:ge.section??""}),i.jsx("td",{style:ka,children:ge.reg_no}),i.jsx("td",{style:ka,children:ge.name}),!nt&&i.jsx(i.Fragment,{children:_.map(Ne=>{if(Ne===5&&!v)return null;const dt=`co${Ne}`,Ue=`co${Ne}Pct`,Re=`co${Ne}_3pt`;return i.jsxs(Zr.Fragment,{children:[i.jsx("td",{style:{...ka,textAlign:"center"},children:ge[dt]==null?"":as(ge[dt])}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge[Ue]==null?"":ge[Ue]}),i.jsx("td",{style:{...ka,textAlign:"center"},children:ge[Re]==null?"":ge[Re]})]},`co${Ne}-row`)})}),i.jsx("td",{style:{...ka,textAlign:"center"},children:i.jsx("input",{type:"text",value:Te[ge.id]||"",onChange:Ne=>Dt({...Te,[ge.id]:Ne.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),i.jsx("td",{style:{...ka,textAlign:"center",fontWeight:700},children:ge.total==null?"":ge.total})]},ge.id))})]})})]})}const va={border:"1px solid #111827",padding:"8px 8px",background:"#f3f4f6",textAlign:"center",fontWeight:800,fontSize:12,whiteSpace:"nowrap"},wf={...va,background:"#eaf2ff",color:"#0b4a6f"},ka={border:"1px solid #111827",padding:"7px 8px",fontSize:12,whiteSpace:"nowrap"},mi=[1,2,3,4,5];function Ts(e){return`co${e}`}function Qs(e){return{co1:e,co2:e,co3:e,co4:e,co5:e}}const kPe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],ud={ssa1:1.5,cia1:3,formative1:2.5},ij=1.74;function Nu(e,t,r){return Math.max(t,Math.min(r,e))}function AR(e){return Math.round(e*100)/100}function uv(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function NR(e){const t=s=>!Number.isFinite(s)||s<1||s>5?null:s;if(e==null||e==="")return[1];if(Array.isArray(e)){const s=[];for(const o of e){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}if(typeof e=="number")return[t(e)||1];const r=String(e).trim().toLowerCase();if(!r)return[1];if(r==="both")return[1,2];const n=r.replace(/[^0-9,\/\+&]+/g,"").split(/[,\/\+&]+/g).map(s=>s.trim()).filter(Boolean);if(n.length>1){const s=[];for(const o of n){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}return r==="12"?[1,2]:[t(Number(r))||1]}function jPe(e){const t=Qs(0),n=Array.from(new Set((e||[]).filter(Boolean))).filter(s=>mi.includes(s)),a=n.length||1;for(const s of n.length?n:[1])t[Ts(s)]=1/a;return t}function CR(e,t){const r=e[t];if(!r)return Qs(0);const n=NR(r.co),a=e.some(c=>NR(c.co).length>1),s=t===e.length-1,o=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return jPe(!a&&s&&o?[1,2]:n)}function ER(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const a=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return a.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function APe(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:a,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u}=e;if(t==null||r==null||n==null||!a||!s||!o)return null;const d=l+c+u,f=a+s+o;if(!d||!f)return null;const h=(t/a*l+r/s*c+n/o*u)/d*f;return Number.isFinite(h)?Nu(h,0,f):null}function NPe({courseId:e}){const[t,r]=x.useState(null),n=x.useMemo(()=>`cqi_visible_cos_${e}`,[e]),[a,s]=x.useState(()=>{try{const U=Pn(`cqi_visible_cos_${e}`);if(Array.isArray(U)){const ce=U.map(ae=>Number(ae)).filter(ae=>mi.includes(ae)),W=Array.from(new Set(ce));return W.length?W:[...mi]}}catch{}return[...mi]});x.useEffect(()=>{try{Sn(n,a)}catch{}},[n,a]);const[o,l]=x.useState(null);x.useMemo(()=>In(o),[o]);const c=x.useMemo(()=>uN(o),[o]),[u,d]=x.useState([]),[f,p]=x.useState(null),[h,m]=x.useState(null),[g,b]=x.useState(!1),[y,v]=x.useState(null),[w,_]=x.useState([]),[C,j]=x.useState(!1),[A,M]=x.useState(null),[P,R]=x.useState({ssa:{},f1:{},cia:null}),[N,T]=x.useState({cia1:null}),[B,G]=x.useState(""),re=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[xe,_e]=x.useState(()=>{const U=Pn(`co_attainment_cfg_${e}`),ce=U==null?void 0:U.weights;return{ssa1:Number.isFinite(Number(ce==null?void 0:ce.ssa1))?Number(ce.ssa1):ud.ssa1,cia1:Number.isFinite(Number(ce==null?void 0:ce.cia1))?Number(ce.cia1):ud.cia1,formative1:Number.isFinite(Number(ce==null?void 0:ce.formative1))?Number(ce.formative1):ud.formative1}}),[V,K]=x.useState("default"),[de,ne]=x.useState(null);x.useEffect(()=>{let U=!0;return(async()=>{try{const ce=await iu();if(!U)return;r(ce||null)}catch{}})(),()=>{U=!1}},[e]),x.useEffect(()=>{let U=!0;return(async()=>{var ce;try{const W=await jc();if(!U)return;const ae=(W||[]).filter(ke=>ke.subject_code===e);d(ae),p(null);const he=Pn(`coAttainment_selectedTa_${e}`),ze=typeof he=="number"&&ae.some(ke=>ke.id===he)&&he||(((ce=ae[0])==null?void 0:ce.id)??null);m(ze)}catch(W){if(!U)return;d([]),m(null),p((W==null?void 0:W.message)||"Failed to load teaching assignments")}})(),()=>{U=!1}},[e]),x.useEffect(()=>{!e||h==null||Sn(`coAttainment_selectedTa_${e}`,h)},[e,h]),x.useEffect(()=>{let U=!0;return(async()=>{try{const ce=(u||[]).find(ke=>ke.id===h)||null,W=String((ce==null?void 0:ce.class_type)||"").trim();if(W){U&&l(W);return}const ae=ce==null?void 0:ce.curriculum_row_id;if(!ae){U&&l(null);return}const he=await cN(Number(ae));if(!U)return;const ze=String((he==null?void 0:he.class_type)||"").trim();l(ze||null)}catch{U&&l(null)}})(),()=>{U=!1}},[h,u]),x.useEffect(()=>{let U=!0;return(async()=>{if(o){ne("Loading IQAC weights");try{const ce=await uS();if(!U)return;if(ce&&typeof ce=="object"){const W=In(o),ae=ce[W];if(ae&&typeof ae=="object"){const he={ssa1:Number.isFinite(Number(ae.ssa1))?Number(ae.ssa1):ud.ssa1,cia1:Number.isFinite(Number(ae.cia1))?Number(ae.cia1):ud.cia1,formative1:Number.isFinite(Number(ae.formative1))?Number(ae.formative1):ud.formative1};_e(he),K("server"),ne(`Applied server weights for ${W}`);try{Sn(re,{weights:he})}catch{}return}ne(`Server weights loaded but no entry for ${In(o)}`)}}catch(ce){ne(`Server fetch failed: ${String((ce==null?void 0:ce.message)||ce)}`)}try{const ce=Pn("iqac_class_type_weights");if(ce&&typeof ce=="object"){const W=In(o),ae=ce[W];if(ae&&typeof ae=="object"){const he={ssa1:Number.isFinite(Number(ae.ssa1))?Number(ae.ssa1):ud.ssa1,cia1:Number.isFinite(Number(ae.cia1))?Number(ae.cia1):ud.cia1,formative1:Number.isFinite(Number(ae.formative1))?Number(ae.formative1):ud.formative1};_e(he),K("local"),ne(`Applied local weights for ${W}`);try{Sn(re,{weights:he})}catch{}return}}}catch(ce){ne(`Local read failed: ${String((ce==null?void 0:ce.message)||ce)}`)}}})(),()=>{U=!1}},[o,re]);const E=x.useMemo(()=>{var ce,W;const U=(W=(ce=t==null?void 0:t.assessments)==null?void 0:ce.cia1)==null?void 0:W.questions;return Array.isArray(U)&&U.length?U.map(ae=>({key:String((ae==null?void 0:ae.key)||""),label:String((ae==null?void 0:ae.label)||(ae==null?void 0:ae.key)||""),max:Number((ae==null?void 0:ae.max)||0),co:ae==null?void 0:ae.co,btl:Math.min(6,Math.max(1,Number((ae==null?void 0:ae.btl)||1)))})).filter(ae=>ae.key):kPe},[t]),Z=x.useMemo(()=>{const U=Qs(0);return E.forEach((ce,W)=>{const ae=CR(E,W);for(const he of mi)U[Ts(he)]+=(Number(ce.max)||0)*(ae[Ts(he)]||0)}),U},[E]),H=x.useMemo(()=>{var Ie,Ve,Qe;const U=((Ie=t==null?void 0:t.assessments)==null?void 0:Ie.ssa1)||{},ce=((Ve=t==null?void 0:t.assessments)==null?void 0:Ve.formative1)||{},W=((Qe=t==null?void 0:t.assessments)==null?void 0:Qe.cia1)||{},ae=(Tt,vt)=>{var Be;const Xe=Qs(0);for(const ct of mi){const nt=Ts(ct),Se=Number((Be=Tt==null?void 0:Tt.coMax)==null?void 0:Be[nt]);Xe[nt]=Number.isFinite(Se)?Math.max(0,Se):vt[nt]}return Xe},he={...Qs(0),co1:10,co2:10},ze=Number(ce==null?void 0:ce.maxCo),ke={...Qs(0),co1:Number.isFinite(ze)?Math.max(0,ze):10,co2:Number.isFinite(ze)?Math.max(0,ze):10},qe=Z;return{ssa:ae(U,he),cia:ae(W,qe),f1:ae(ce,ke)}},[t,Z]),F=async()=>{j(!0),M(null);try{if(c){const U=await no("cia1",e);R({ssa:{},f1:{},cia:null}),T({cia1:(U==null?void 0:U.data)??null})}else{const[U,ce,W]=await Promise.all([Vm(e),hS(e),V1(e)]);R({ssa:U!=null&&U.marks&&typeof U.marks=="object"?U.marks:{},f1:ce!=null&&ce.marks&&typeof ce.marks=="object"?ce.marks:{},cia:(W==null?void 0:W.data)??null}),T({cia1:null})}}catch(U){R({ssa:{},f1:{},cia:null}),T({cia1:null}),M((U==null?void 0:U.message)||"Failed to load published marks")}finally{j(!1)}};x.useEffect(()=>{e&&F()},[e,c]),x.useEffect(()=>{const U=ce=>{try{const W=(ce==null?void 0:ce.detail)||{},ae=W.subjectId,he=W.assessment;if(!ae||String(ae)!==String(e)||he&&!["ssa1","formative1","cia1"].includes(String(he)))return;F()}catch{}};return window.addEventListener("obe:published",U),()=>window.removeEventListener("obe:published",U)},[e]),x.useEffect(()=>{let U=!0;return(async()=>{if(h){b(!0),v(null);try{const W=(u||[]).find(ae=>ae.id===h)||null;if(W&&W.elective_subject_id&&!W.section_id){const ae=W.elective_subject_id,he=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(ae))}`);if(!he.ok)throw new Error(`Elective-choices fetch failed: ${he.status}`);const ze=await he.json();if(!U)return;const qe=((Array.isArray(ze.results)?ze.results:Array.isArray(ze)?ze:ze.items||[])||[]).map(Ie=>({id:Number(Ie.student_id??Ie.id),reg_no:String(Ie.reg_no??Ie.registration_no??Ie.regno??""),name:String(Ie.name??Ie.full_name??Ie.username??""),section:Ie.section_name??Ie.section??null}));if(!U)return;_(qe.filter(Ie=>Number.isFinite(Ie.id)).sort(ER))}else{const ae=await Ac(h);if(!U)return;const he=(ae.students||[]).map(ze=>({id:Number(ze.id),reg_no:String(ze.reg_no??""),name:String(ze.name??""),section:ze.section??null})).filter(ze=>Number.isFinite(ze.id)).sort(ER);_(he)}}catch(W){if(!U)return;_([]),v((W==null?void 0:W.message)||"Failed to load roster")}finally{U&&b(!1)}}})(),()=>{U=!1}},[h,u]);const ee=x.useMemo(()=>{const U=new Map;if(c){const qe=N.cia1,Ie=qe!=null&&qe.sheet&&typeof qe.sheet=="object"?qe.sheet:{},Ve=Ie!=null&&Ie.rowsByStudentId&&typeof Ie.rowsByStudentId=="object"?Ie.rowsByStudentId:{},Qe=Nu(Number((Ie==null?void 0:Ie.expCountA)??0),0,12),Tt=Nu(Number((Ie==null?void 0:Ie.expCountB)??0),0,12),vt=!!(Ie!=null&&Ie.coAEnabled),Xe=!!(Ie!=null&&Ie.coBEnabled),Be=(nt,Se)=>{const Te=Array.isArray(nt)?nt:[],Dt=[];for(let wt=0;wt<Se;wt++){const Pt=Te[wt];if(Pt===""||Pt==null){Dt.push("");continue}const Wt=typeof Pt=="number"?Pt:Number(Pt);Dt.push(Number.isFinite(Wt)?Wt:"")}return Dt},ct=nt=>{const Se=nt.filter(Te=>typeof Te=="number"&&Number.isFinite(Te));return Se.length?Se.reduce((Te,Dt)=>Te+Dt,0)/Se.length:null};for(const nt of w){const Se=Ve[String(nt.id)]||{},Te=Be(Se.marksA,Qe).slice(0,vt?Qe:0),Dt=Be(Se.marksB,Tt).slice(0,Xe?Tt:0),wt=ct(Te),Pt=ct(Dt),Wt=Se==null?void 0:Se.ciaExam,Ot=typeof Wt=="number"&&Number.isFinite(Wt)?Wt:null,Ht=wt!=null||Pt!=null||Ot!=null,Pr=Ht?(wt??0)+(Ot??0)/2:null,jt=Ht?(Pt??0)+(Ot??0)/2:null;U.set(nt.id,{ssaCo1:null,ssaCo2:null,ciaCo1:Pr==null?null:Nu(Pr,0,40),ciaCo2:jt==null?null:Nu(jt,0,40),f1Co1:null,f1Co2:null,__labCoMax:40})}return U}const ce=new Map;for(const[ke,qe]of Object.entries(P.ssa||{})){const Ie=Number(ke);Number.isFinite(Ie)&&ce.set(Ie,uv(qe))}const W=P.f1&&typeof P.f1=="object"?P.f1:{},ae=P.cia&&typeof P.cia=="object"?P.cia:null,he=Array.isArray(ae==null?void 0:ae.questions)?ae.questions.map(ke=>({key:String((ke==null?void 0:ke.key)||""),label:String((ke==null?void 0:ke.label)||(ke==null?void 0:ke.key)||""),max:Number((ke==null?void 0:ke.max)||0),co:ke==null?void 0:ke.co,btl:Math.min(6,Math.max(1,Number((ke==null?void 0:ke.btl)||1)))})).filter(ke=>ke.key):E,ze=ae!=null&&ae.rowsByStudentId&&typeof ae.rowsByStudentId=="object"?ae.rowsByStudentId:{};for(const ke of w){const qe=ce.get(ke.id)??null,Ie=mi.reduce((Se,Te)=>Se+(H.ssa[Ts(Te)]||0),0),Ve=Qs(null);for(const Se of mi){const Te=Ts(Se),Dt=H.ssa[Te]||0;if(qe==null||!Ie||!Dt){Ve[Te]=null;continue}const wt=qe/Ie*Dt;Ve[Te]=Nu(wt,0,Dt)}const Qe=W[String(ke.id)]||{},Tt=Qs(null);for(const Se of mi){const Te=Ts(Se),Dt=H.f1[Te]||0,wt=uv(Qe==null?void 0:Qe[`skill${Se}`]),Pt=uv(Qe==null?void 0:Qe[`att${Se}`]);Dt&&wt!=null&&Pt!=null?Tt[Te]=Nu(wt+Pt,0,Dt):Tt[Te]=null}const vt=ze[String(ke.id)]||{},Xe=!!(vt!=null&&vt.absent),Be=vt!=null&&vt.q&&typeof vt.q=="object"?vt.q:{},ct=Qs(null);if(!Xe){const Se=Qs(0);let Te=!1;if(he.forEach((Dt,wt)=>{const Pt=Be==null?void 0:Be[Dt.key],Wt=uv(Pt);if(Wt==null)return;Te=!0;const Ot=Nu(Wt,0,Number(Dt.max)||Wt),Ht=CR(he,wt);for(const Pr of mi){const jt=Ts(Pr);Se[jt]+=Ot*(Ht[jt]||0)}}),Te)for(const Dt of mi){const wt=Ts(Dt),Pt=H.cia[wt]||0;ct[wt]=Pt?Nu(Se[wt],0,Pt):null}}const nt={};for(const Se of mi){const Te=Ts(Se);nt[`ssaCo${Se}`]=Ve[Te],nt[`f1Co${Se}`]=Tt[Te],nt[`ciaCo${Se}`]=ct[Te]}U.set(ke.id,nt)}return U},[P,N,w,H,E,c]),z=x.useMemo(()=>{var he;if(c){const ze=((he=w[0])==null?void 0:he.id)!=null?ee.get(w[0].id):null,ke=Number(ze==null?void 0:ze.__labCoMax),qe=Number.isFinite(ke)&&ke>0?ke:40,Ie=Qe=>Qe==null||!qe?null:AR(Qe/qe*3),Ve=(Qe,Tt)=>{if(Qe==null||Tt==null||!qe)return null;const vt=(Qe+Tt)/(2*qe)*100;return Number.isFinite(vt)?Math.round(Nu(vt,0,100)):null};return w.map((Qe,Tt)=>{const vt=ee.get(Qe.id)||{},Xe=Qs(null);Xe.co1=typeof vt.ciaCo1=="number"?vt.ciaCo1:null,Xe.co2=typeof vt.ciaCo2=="number"?vt.ciaCo2:null;const Be=Qs(null),ct=Qs(!1);for(const Dt of mi){const wt=Ts(Dt);Be[wt]=Ie(Xe[wt]),ct[wt]=typeof Be[wt]=="number"&&Be[wt]<ij}const nt=Ve(Xe.co1,Xe.co2),Se=mi.map(Dt=>ct[Ts(Dt)]?`CO${Dt}`:null).filter(Boolean).join("+"),Te={sno:Tt+1,...Qe,total:nt,cos:Se};for(const Dt of mi){const wt=Ts(Dt);Te[`${wt}_3pt`]=Be[wt],Te[`flagCO${Dt}`]=ct[wt]}return Te})}const U=xe.ssa1,ce=xe.cia1,W=xe.formative1,ae=Qs(0);for(const ze of mi){const ke=Ts(ze);ae[ke]=(H.ssa[ke]||0)+(H.cia[ke]||0)+(H.f1[ke]||0)}return w.map((ze,ke)=>{const qe=ee.get(ze.id),Ie=Qs(null),Ve=Qs(null),Qe=Qs(!1);for(const Be of mi){const ct=Ts(Be),nt=APe({ssaMark:(qe==null?void 0:qe[`ssaCo${Be}`])??null,ciaMark:(qe==null?void 0:qe[`ciaCo${Be}`])??null,f1Mark:(qe==null?void 0:qe[`f1Co${Be}`])??null,ssaMax:H.ssa[ct]||0,ciaMax:H.cia[ct]||0,f1Max:H.f1[ct]||0,ssaW:U,ciaW:ce,f1W:W});Ie[ct]=nt;const Se=ae[ct]||0;Ve[ct]=nt==null||!Se?null:AR(nt/Se*3),Qe[ct]=typeof Ve[ct]=="number"&&Ve[ct]<ij}const Tt=(()=>{const Be=mi.map(ct=>Ie[Ts(ct)]).filter(ct=>typeof ct=="number"&&Number.isFinite(ct));return Be.length?Math.round(Be.reduce((ct,nt)=>ct+nt,0)):null})(),vt=mi.map(Be=>Qe[Ts(Be)]?`CO${Be}`:null).filter(Boolean).join("+"),Xe={sno:ke+1,...ze,total:Tt,cos:vt};for(const Be of mi){const ct=Ts(Be);Xe[`${ct}_3pt`]=Ve[ct],Xe[`flagCO${Be}`]=Qe[ct]}return Xe})},[w,ee,H,xe,c]),X=x.useMemo(()=>{const U=B.trim().toLowerCase();return U?z.filter(ce=>{const W=String(ce.reg_no||"").toLowerCase(),ae=String(ce.name||"").toLowerCase(),he=String(ce.section||"").toLowerCase();return W.includes(U)||ae.includes(U)||he.includes(U)}):z},[z,B]),J=x.useMemo(()=>{const U=ae=>a.some(he=>!!(ae!=null&&ae[`flagCO${he}`])),ce=z.filter(ae=>U(ae)).length,W={strength:z.length,flagged:ce};for(const ae of mi)W[`co${ae}`]=z.filter(he=>!!he[`flagCO${ae}`]).length;return W},[z,a]),q={position:"sticky",top:0,zIndex:2,textAlign:"left",padding:"10px 12px",fontSize:12,letterSpacing:.2,textTransform:"uppercase",color:"#0f172a",background:"linear-gradient(180deg,#eaf6ff,#ffffff)",borderBottom:"1px solid rgba(148, 163, 184, 0.5)",whiteSpace:"nowrap"},Y={padding:"10px 12px",borderBottom:"1px solid rgba(226, 232, 240, 0.9)",fontSize:13,color:"#0f172a",verticalAlign:"middle",whiteSpace:"nowrap"},L=(U,ce)=>{const W=ce==="danger"?{background:"rgba(239, 68, 68, 0.12)",border:"1px solid rgba(239, 68, 68, 0.35)",color:"#991b1b"}:{background:"rgba(2, 132, 199, 0.08)",border:"1px solid rgba(2, 132, 199, 0.25)",color:"#0b4a6f"};return i.jsx("span",{style:{display:"inline-flex",alignItems:"center",height:24,padding:"0 10px",borderRadius:999,fontSize:12,fontWeight:800,...W},children:U})};return i.jsxs("div",{style:{display:"grid",gap:14},children:[i.jsxs("div",{style:{padding:16,borderRadius:14,background:"linear-gradient(135deg,#ffffff,#f0f9ff)",border:"1px solid rgba(226, 232, 240, 0.9)",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"flex-end"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:18,fontWeight:950,color:"#0b4a6f"},children:"C1-CQI"}),i.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#334155"},children:["Flags CO1CO5 when 3pt attainment is below ",i.jsx("b",{children:ij}),"."]})]}),i.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Teaching Assignment / Section"}),i.jsxs("select",{value:h??"",onChange:U=>m(U.target.value?Number(U.target.value):null),style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",minWidth:320,background:"#fff"},children:[i.jsx("option",{value:"",children:"Select"}),u.map(U=>{const ce=U.department,W=(ce==null?void 0:ce.short_name)||(ce==null?void 0:ce.code)||(ce==null?void 0:ce.name)||U.department_name||"",ae=U.semester;return i.jsxs("option",{value:U.id,children:[U.section_name," ",ae?` Sem ${ae}`:""," ",U.academic_year?` ${U.academic_year}`:""," ",W?` ${W}`:""]},U.id)})]})]}),i.jsxs("div",{style:{minWidth:320},children:[i.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Show CO columns"}),i.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff"},children:[mi.map(U=>{const ce=a.includes(U);return i.jsxs("label",{style:{display:"inline-flex",gap:8,alignItems:"center",cursor:"pointer",userSelect:"none"},children:[i.jsx("input",{type:"checkbox",checked:ce,onChange:W=>{const ae=W.target.checked?Array.from(new Set([...a,U])):a.filter(he=>he!==U);s(ae)}}),i.jsx("span",{style:{fontSize:12,fontWeight:800,color:"#0f172a"},children:`CO${U}`})]},U)}),i.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[i.jsx("button",{type:"button",onClick:()=>s([...mi]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",fontSize:12,fontWeight:800,color:"#0f172a"},children:"All"}),i.jsx("button",{type:"button",onClick:()=>s([]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",fontSize:12,fontWeight:800,color:"#0f172a"},children:"None"})]})]})]}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Search"}),i.jsx("input",{value:B,onChange:U=>G(U.target.value),placeholder:"Reg no / name / section",style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",width:260}})]})]})]}),(C||A||g||y||f)&&i.jsxs("div",{style:{marginTop:12,display:"grid",gap:8},children:[(C||A)&&i.jsx("div",{style:{fontSize:12,color:A?"#b91c1c":"#64748b"},children:C?"Loading published marks":A}),(g||y)&&i.jsx("div",{style:{fontSize:12,color:y?"#b91c1c":"#64748b"},children:g?"Loading roster":y}),f&&i.jsx("div",{style:{marginTop:4,background:"#fef2f2",border:"1px solid rgba(239, 68, 68, 0.25)",color:"#991b1b",padding:10,borderRadius:12},children:f})]}),i.jsxs("div",{style:{display:"flex",gap:10,marginTop:12,flexWrap:"wrap"},children:[L(`Strength: ${J.strength}`,"neutral"),L(`Flagged: ${J.flagged}`,J.flagged?"danger":"neutral"),a.map(U=>i.jsx(Zr.Fragment,{children:L(`CO${U} below: ${J[`co${U}`]??0}`,J[`co${U}`]?"danger":"neutral")},U))]})]}),i.jsx("div",{style:{borderRadius:14,border:"1px solid rgba(226, 232, 240, 0.9)",overflow:"hidden",background:"#fff",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:i.jsx("div",{style:{maxHeight:"70vh",overflow:"auto"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{...q,width:70},children:"slno"}),i.jsx("th",{style:{...q,width:70},children:"SEC"}),i.jsx("th",{style:{...q,width:160},children:"Reg number"}),i.jsx("th",{style:{...q,minWidth:260},children:"NAME"}),i.jsx("th",{style:{...q,width:140},children:"CO's"}),i.jsx("th",{style:{...q,width:90,textAlign:"center"},children:"100"}),a.map(U=>i.jsx("th",{style:{...q,width:90,textAlign:"center"},children:`CO${U} (3pt)`},U))]})}),i.jsxs("tbody",{children:[X.map((U,ce)=>{const W=a.some(qe=>!!U[`flagCO${qe}`]),ae=ce%2===0,he=W?"rgba(239, 68, 68, 0.10)":ae?"#ffffff":"#f8fafc",ze=qe=>({...Y,textAlign:"center",fontWeight:900,color:qe?"#991b1b":"#065f46",background:qe?"rgba(239, 68, 68, 0.10)":"rgba(34, 197, 94, 0.10)",borderBottom:"1px solid rgba(226, 232, 240, 0.9)"}),ke=U.total!=null&&U.total<=58;return i.jsxs("tr",{style:{background:he},children:[i.jsx("td",{style:{...Y,width:70,borderLeft:W?"4px solid rgba(239, 68, 68, 0.55)":"4px solid transparent"},children:U.sno}),i.jsx("td",{style:{...Y,width:70},children:U.section??""}),i.jsx("td",{style:{...Y,width:160,fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},children:U.reg_no}),i.jsx("td",{style:{...Y,minWidth:260,fontWeight:800},children:U.name}),i.jsx("td",{style:{...Y,width:140},children:a.some(qe=>!!U[`flagCO${qe}`])?i.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:a.filter(qe=>!!U[`flagCO${qe}`]).map(qe=>i.jsx(Zr.Fragment,{children:L(`CO${qe}`,"danger")},qe))}):""}),i.jsx("td",{style:{...Y,width:90,textAlign:"center",fontWeight:900,color:ke?"#991b1b":"#0f172a",background:ke?"rgba(239, 68, 68, 0.12)":"transparent"},children:U.total==null?"":Number.isFinite(Number(U.total))?String(Math.round(Number(U.total))):U.total}),a.map(qe=>i.jsx("td",{style:ze(!!U[`flagCO${qe}`]),children:U[`co${qe}_3pt`]==null?"":U[`co${qe}_3pt`]},qe))]},U.id)}),!X.length&&i.jsx("tr",{children:i.jsx("td",{colSpan:6+a.length,style:{padding:18,textAlign:"center",color:"#64748b"},children:"No rows."})})]})]})})})]})}function cK({courseId:e}){return i.jsx(NPe,{courseId:e})}function Eh(e){return String(e||"").trim()}function CPe(){var C,j;const{courseCode:e,taId:t}=M0(),r=so(),n=Xo(),a=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),s=x.useMemo(()=>t?Number(t):NaN,[t]),[o,l]=x.useState("marks"),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState(null);x.useEffect(()=>{if(!(n!=null&&n.pathname))return;const A=n.pathname.toLowerCase();A.includes("/lca/instructions")||A.includes("/lca_instructions")||A.includes("/lca")||A.includes("/cdap")||A.includes("/articulation")?l("lca_instructions"):A.includes("/marks")?l("marks"):A.includes("/co_attainment")?l("co_attainment"):A.includes("/cqi")?l("cqi"):l("marks")},[n]);const b=x.useMemo(()=>{const A=String((n==null?void 0:n.pathname)||"").toLowerCase();return A.includes("/cdap")?"cdap":A.includes("/articulation")?"articulation":A.includes("/lca")&&!(A.includes("/lca/instructions")||A.includes("/lca_instructions"))?"lca":"instructions"},[n==null?void 0:n.pathname]);x.useEffect(()=>{let A=!0;return(async()=>{if(a)try{const M=await w2(a);if(!A)return;const P=(M||[]).find(R=>Number(R.teaching_assignment_id)===Number(s))||null;u(P)}catch{if(!A)return;u(null)}})(),()=>{A=!1}},[a,s]),x.useEffect(()=>{let A=!0;return(async()=>{if(a)try{const[M,P]=await Promise.all([sl(),Ld()]);if(!A)return;const R=a.toUpperCase(),N=(M||[]).filter(re=>Eh(re==null?void 0:re.course_code).toUpperCase()===R),T=re=>Eh(re).toUpperCase(),B=N.find(re=>{const xe=T(re==null?void 0:re.question_paper_type);return xe&&xe!=="QP1"})||N.find(re=>T(re==null?void 0:re.question_paper_type))||N.find(re=>Eh(re==null?void 0:re.class_type))||N[0];if(B){if(f(B!=null&&B.class_type?Eh(B.class_type):null),h(B!=null&&B.question_paper_type?Eh(B.question_paper_type):null),In(B==null?void 0:B.class_type)==="SPECIAL"){g([]);try{const re=await lS(a);g(Array.isArray(re)?re:[])}catch{const re=B==null?void 0:B.enabled_assessments;g(Array.isArray(re)?re.map(xe=>String(xe).trim().toLowerCase()).filter(Boolean):[])}}else g(null);return}const G=(P||[]).find(re=>Eh(re==null?void 0:re.course_code).toUpperCase()===R);f(G!=null&&G.class_type?Eh(G.class_type):null),h(null),g(null)}catch{}})(),()=>{A=!1}},[a]);const y=x.useMemo(()=>Number.isFinite(s)?[{id:s,subject_id:0,subject_code:a,subject_name:(c==null?void 0:c.course_name)||a,section_id:(c==null?void 0:c.section_id)||0,section_name:(c==null?void 0:c.section_name)||"Section",academic_year:(c==null?void 0:c.academic_year)||""}]:[],[s,a,c]);if(!a||!Number.isFinite(s))return i.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[i.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),i.jsx("div",{style:{marginTop:10},children:i.jsx(Vi,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]});const v=(c==null?void 0:c.course_name)||a,w=[c==null?void 0:c.section_name,c==null?void 0:c.academic_year].filter(Boolean).join("  "),_=((C=c==null?void 0:c.staff)==null?void 0:C.name)||((j=c==null?void 0:c.staff)==null?void 0:j.username)||"";return i.jsx("main",{className:"obe-course-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:i.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[i.jsx("div",{style:{marginBottom:12,padding:18},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[i.jsxs("div",{children:[i.jsxs("h2",{style:{margin:0},children:["OBE Viewer - ",a]}),i.jsx("div",{style:{color:"#666",marginTop:6},children:"View-only (IQAC)"}),i.jsx("div",{style:{color:"#222",marginTop:6,fontWeight:800},children:v}),i.jsxs("div",{style:{color:"#374151",marginTop:4},children:[w||"",_?`    ${_}`:"",d?`    ${String(d).toUpperCase()}`:""]}),p?i.jsxs("div",{style:{color:"#374151",marginTop:2},children:["QP Type: ",i.jsx("strong",{style:{color:"#111827"},children:String(p)})]}):null]}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[i.jsx(Vi,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(a)}`,children:"Back"}),i.jsx("button",{onClick:()=>r(`/iqac/academic-controller/course/${encodeURIComponent(a)}/marks/${encodeURIComponent(String(s))}`),className:"obe-btn",children:"Mark Entry Only"})]})]})}),i.jsx("div",{className:"obe-tab-nav","aria-label":"OBE Tabs",style:{padding:"0 18px"},children:[{key:"lca_instructions",label:"LCA Instructions"},{key:"marks",label:"Mark Entry"},{key:"co_attainment",label:"CO ATTAINMENT"},{key:"cqi",label:"CQI"}].map(A=>{const M=o===A.key;return i.jsx("button",{onClick:()=>{l(A.key);const P=encodeURIComponent(a),R=encodeURIComponent(String(s)),N=A.key==="lca_instructions"?"lca/instructions":String(A.key);r(`/iqac/academic-controller/course/${P}/obe/${R}/${N}`)},className:`obe-tab-btn ${M?"active":""}`,children:A.label},A.key)})}),i.jsxs("div",{style:{border:"1px solid #eee",borderRadius:10,padding:12,margin:18},children:[o==="lca_instructions"&&i.jsx(sK,{courseCode:a,courseName:(c==null?void 0:c.course_name)||null,initialTab:b,viewerMode:!0}),o!=="lca_instructions"?i.jsxs("fieldset",{disabled:!0,style:{border:0,padding:0,margin:0},children:[o==="co_attainment"&&i.jsx(lK,{courseId:a,enabledAssessments:m}),o==="cqi"&&i.jsx(cK,{courseId:a})]}):null,o==="marks"?i.jsx("div",{children:i.jsx(u6,{subjectId:a,classType:d,questionPaperType:p,enabledAssessments:m,teachingAssignmentsOverride:y,fixedTeachingAssignmentId:s,iqacResetEnabled:!0,viewerMode:!1})}):null]})]})})}function EPe(){const{courseCode:e,taId:t}=M0(),r=String(e||""),n=so(),[a,s]=x.useState(!0),[o,l]=x.useState(!1),[c,u]=x.useState(null),[d,f]=x.useState(null),p={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},h=j=>{const A=Number(j);if(!Number.isFinite(A)||A<=0)return[0,0,0];const M=1.5,P=3,R=2.5,N=M+P+R,T=Math.round(A*M/N*100)/100,B=Math.round(A*P/N*100)/100,G=Math.round(A*R/N*100)/100;return[T,B,G]},m=j=>{const A=j&&typeof j=="object"?j:{};let M=Array.isArray(A.weights)?[...A.weights]:[];if(M=M.map(P=>{const R=Number(P);return Number.isFinite(R)?R:0}),M.length===13){const[P,R,N]=h(M[0]??0),[T,B,G]=h(M[1]??0);M=[P,R,N,T,B,G,...M.slice(2)]}for(;M.length<p.weights.length;)M.push(p.weights[M.length]??0);return M=M.slice(0,p.weights.length),{...A,header:p.header,cycles:p.cycles,weights:M}};x.useEffect(()=>{let j=!0;return(async()=>{s(!0);try{const A=await r9(r);if(!j)return;f(A!=null&&A.mapping?m(A.mapping):null)}catch(A){if(!j)return;u((A==null?void 0:A.message)||String(A))}finally{j&&s(!1)}})(),()=>{j=!1}},[r]);const g=()=>d?m(d):(f(p),p),b=(j,A)=>{const M=A===""?"":Number(A);f(P=>{const R={...P||g()},N=Array.isArray(R.weights)?[...R.weights]:[];return N[j]=M,R.weights=N,R})},y=async()=>{l(!0),u(null);try{const j=m(d??g());await n9(r,j);try{window.dispatchEvent(new CustomEvent("internal-mark:updated",{detail:{subjectId:r}}))}catch{}n(-1)}catch(j){u((j==null?void 0:j.message)||String(j))}finally{l(!1)}};if(a)return i.jsx("div",{style:{padding:18},children:"Loading"});const v=m(d??g()),w=v.header,_=v.weights,C=v.cycles;return i.jsxs("main",{style:{padding:18},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[i.jsxs("h2",{style:{margin:0},children:["Internal Mark Mapping - ",r]}),i.jsxs("div",{style:{display:"flex",gap:8},children:[i.jsx("button",{className:"obe-btn",onClick:()=>n(-1),children:"Back"}),i.jsx("button",{className:"obe-btn obe-btn-primary",onClick:y,disabled:o,children:o?"Saving...":"Save"})]})]}),i.jsx("div",{style:{overflowX:"auto"},children:i.jsxs("table",{style:{borderCollapse:"collapse",width:"100%"},children:[i.jsxs("thead",{children:[i.jsx("tr",{children:w.map((j,A)=>i.jsx("th",{style:{border:"1px solid #d1d5db",padding:8,background:"#f3f4f6"},children:j},A))}),i.jsx("tr",{children:C.map((j,A)=>i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb",fontWeight:600},children:j},`cy-${A}`))})]}),i.jsx("tbody",{children:i.jsx("tr",{children:_.map((j,A)=>i.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,background:"#f3f4f6"},children:i.jsx("input",{type:"number",step:"0.1",value:j===""?"":String(j),onChange:M=>b(A,M.target.value),style:{width:70,padding:6}})},A))})})]})}),c?i.jsx("div",{style:{color:"red",marginTop:12},children:c}):null]})}function TPe(){return i.jsx(p9,{})}function pi({user:e,element:t,requiredRoles:r,requiredPermissions:n,requiredProfile:a}){if(!e)return i.jsx(qp,{to:"/login",replace:!0});const s=(e.roles||[]).map(u=>(u||"").toString().toUpperCase()),o=(e.permissions||[]).map(u=>(u||"").toString().toLowerCase()),l=(e.profile_type||"").toString().toUpperCase();let c=!1;return a&&(a==="STUDENT"&&l==="STUDENT"&&(c=!0),a==="STAFF"&&l==="STAFF"&&(c=!0)),!c&&r&&r.length&&r.map(d=>d.toString().toUpperCase()).some(d=>s.includes(d))&&(c=!0),!c&&n&&n.length&&n.map(d=>d.toString().toLowerCase()).some(d=>o.includes(d))&&(c=!0),!a&&(!r||r.length===0)&&(!n||n.length===0)&&(c=!0),c?t:i.jsx(qp,{to:"/dashboard",replace:!0})}function sj({user:e}){return i.jsx("div",{className:"fixed inset-0 overflow-hidden bg-gradient-to-br from-blue-50 to-slate-100",children:i.jsx("section",{className:"relative h-full flex items-center justify-center bg-gradient-to-b from-indigo-50 to-white py-0 px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[i.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-gray-900 mb-6",children:"Welcome to IDCS"}),i.jsx("p",{className:"text-lg sm:text-xl text-gray-600 mb-8 max-w-2xl mx-auto",children:"Streamline your academic management with our comprehensive Education Resource Planning system"}),e?i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 max-w-md mx-auto",children:[i.jsxs("p",{className:"text-lg text-gray-700 mb-2",children:["Hello, ",i.jsx("strong",{className:"text-blue-600",children:e.username}),"!"]}),e.roles&&e.roles.length>0&&i.jsxs("p",{className:"text-sm text-gray-500",children:["Role: ",i.jsx("span",{className:"font-semibold text-indigo-600",children:e.roles.join(", ")})]})]}):i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[i.jsx("a",{href:"/login",className:"px-8 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105",children:"Get Started"}),i.jsx("a",{href:"#features",className:"px-8 py-3 bg-white text-blue-600 border-2 border-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition-all duration-200",children:"Learn More"})]})]})})})}function PPe(){return i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-14 h-14 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(F0,{className:"w-7 h-7 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Welcome back"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome to the dashboard."})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:i.jsx(ls,{className:"w-5 h-5 text-emerald-600"})}),i.jsx("h3",{className:"font-semibold text-gray-900",children:"Courses"})]}),i.jsx("p",{className:"text-sm text-gray-600",children:"View your enrolled courses"})]}),i.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:i.jsx(q1,{className:"w-5 h-5 text-purple-600"})}),i.jsx("h3",{className:"font-semibold text-gray-900",children:"Academics"})]}),i.jsx("p",{className:"text-sm text-gray-600",children:"Access academic resources"})]}),i.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow sm:col-span-2 lg:col-span-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(cs,{className:"w-5 h-5 text-blue-600"})}),i.jsx("h3",{className:"font-semibold text-gray-900",children:"Schedule"})]}),i.jsx("p",{className:"text-sm text-gray-600",children:"Check your timetable"})]})]})]})}function Qp({children:e}){return i.jsx(i.Fragment,{children:e})}function OPe(){return i.jsx(Qp,{children:i.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:[i.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6",children:"Dashboard"}),i.jsx(PPe,{})]})})}function LPe({user:e}){const[t,r]=x.useState(e===void 0?null:e),[n,a]=x.useState(!e),[s,o]=x.useState(null);if(x.useEffect(()=>{if(e)return;let c=!0;return a(!0),W1().then(u=>{if(!c)return;const d={...u,roles:Array.isArray(u.roles)?u.roles.map(f=>typeof f=="string"?f:f.name):[]};r(d)}).catch(u=>o(String(u))).finally(()=>a(!1)),()=>{c=!1}},[e]),n)return i.jsx(Qp,{children:i.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Loading profile"})]})})});if(s)return i.jsx(Qp,{children:i.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-800",children:["Error loading profile: ",s]})})});if(!t)return i.jsx(Qp,{children:i.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:i.jsx("div",{className:"text-center text-gray-500",children:"No profile available"})})});const l=(t.username||"U").slice(0,2).toUpperCase();return i.jsx(Qp,{children:i.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6 space-y-6",children:[i.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-white",children:l})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:t.username}),i.jsx("p",{className:"text-gray-600 mt-1",children:t.email||"No email provided"})]})]}),i.jsxs("div",{className:"bg-white rounded-lg px-4 py-2 shadow-sm",children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Profile Type"}),i.jsx("div",{className:"font-bold text-gray-900",children:t.profile_type||""})]})]})}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Details"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx(F0,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Account"}),i.jsxs("div",{className:"text-gray-900 font-medium truncate",children:["ID: ",t.id]})]})]})}),i.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx(nN,{className:"w-5 h-5 text-emerald-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Email"}),i.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.email||""})]})]})}),i.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx(cte,{className:"w-5 h-5 text-purple-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Roles"}),i.jsx("div",{className:"text-gray-900 font-medium truncate",children:(t.roles||[]).join(", ")||""})]})]})}),i.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx(xee,{className:"w-5 h-5 text-orange-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Department"}),i.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.department&&(t.profile.department.short_name||t.profile.department.code)||""})]})]})}),i.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx(mee,{className:"w-5 h-5 text-indigo-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Designation"}),i.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.designation||""})]})]})}),i.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx(ote,{className:"w-5 h-5 text-pink-600"})}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"College"}),i.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.college&&(t.college.short_name||t.college.name)||""})]})]})})]})]})]})})}function O1({children:e}){return i.jsx(Qp,{children:i.jsx("div",{className:"flex flex-col w-full max-w-full overflow-x-hidden",children:e})})}function MPe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),[a,s]=x.useState(null),o=Xo(),l=so(),c=e&&e.length?Array.from(new Set(e.map(y=>y.regulation))):[],u=e&&e.length?Array.from(new Set(e.map(y=>y.semester))).sort((y,v)=>y-v):[],[d,f]=x.useState(c.length===1?c[0]:c[0]??null),[p,h]=x.useState(u.length===1?u[0]:u[0]??null);x.useEffect(()=>{const y=e&&e.length?Array.from(new Set(e.map(w=>w.regulation))):[];y.length===1?f(y[0]):y.includes(d||"")||f(y[0]??null);const v=e&&e.length?Array.from(new Set(e.map(w=>w.semester))).sort((w,_)=>w-_):[];v.length===1?h(v[0]):v.includes(p||-1)||h(v[0]??null)},[e]),x.useEffect(()=>{Ld().then(y=>t(y)).catch(y=>console.error(y)).finally(()=>n(!1))},[]);function m(y){if(y==null)return"";const v=String(y);return v.includes(",")||v.includes('"')||v.includes(`
`)?'"'+v.replace(/"/g,'""')+'"':v}function g(){const y=e.filter(A=>(!d||A.regulation===d)&&(!p||A.semester===p)&&A.editable===!0);if(!y.length){alert("No editable subjects in current view");return}const w=[["regulation","semester","course_code","course_name","category","class_type","l","t","p","s","c","internal_mark","external_mark","for_all_departments","editable","departments"].join(",")];for(const A of y){const M=A.for_all_departments?"":(A.departments_display||[]).map(R=>R.short_name||R.shortname||R.code||R.name).join(","),P=[A.regulation,A.semester,A.course_code||"",A.course_name||"",A.category||"",A.class_type||"",A.l??0,A.t??0,A.p??0,A.s??0,A.c??0,A.internal_mark??"",A.external_mark??"",A.for_all_departments?"True":"False",A.editable?"True":"False",M];w.push(P.map(m).join(","))}const _=new Blob([w.join(`
`)],{type:"text/csv"}),C=URL.createObjectURL(_),j=document.createElement("a");j.href=C,j.download=`department_curriculum_editable_${d||"all"}_${p||"all"}.csv`,document.body.appendChild(j),j.click(),j.remove(),URL.revokeObjectURL(C)}async function b(y){const v=y.target.files&&y.target.files[0];if(v){if(!confirm(`Upload ${v.name} to import masters?`)){y.currentTarget.value="";return}try{const w=new FormData;w.append("csv_file",v,v.name);const _=await mr("/api/curriculum/master/import/",{method:"POST",body:w});if(_.status===401){alert("Your session has expired. Please refresh the page and try again.");return}if(_.ok)alert("Import request submitted; refresh to see changes."),n(!0),Ld().then(C=>t(C)).catch(()=>{}).finally(()=>n(!1));else{let C="";try{C=await _.text()}catch{C=_.statusText}alert("Import failed: "+(C||_.statusText))}}catch(w){console.error(w),alert("Import failed: "+(w.message||w))}try{const w=document.getElementById("master-import-file");w&&(w.value="")}catch{}}}return x.useEffect(()=>{const y=o.state;y&&y.savedMessage&&(s(y.savedMessage),l(location.pathname,{replace:!0,state:{}}),setTimeout(()=>s(null),2500))},[o,l]),r?i.jsx(O1,{children:i.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Loading masters"})]})})}):i.jsx(O1,{children:i.jsxs("div",{className:"px-4 pb-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx(ls,{className:"w-6 h-6 text-indigo-600"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Master Curriculum"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage all master curriculum entries."})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[(()=>{try{const y=JSON.parse(localStorage.getItem("roles")||"[]");if(Array.isArray(y)&&y.some(w=>String(w).toLowerCase()==="iqac"))return i.jsx(Vi,{to:"/curriculum/master/new",className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:"New Master"})}catch{}return null})(),i.jsxs("button",{onClick:()=>g(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[i.jsx(gA,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),i.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-all duration-200 shadow-sm hover:shadow-md cursor-pointer",children:[i.jsx(v2,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Import CSV"}),i.jsx("input",{id:"master-import-file",type:"file",accept:".csv",className:"hidden",onChange:y=>b(y)})]})]})]}),c.length>0&&i.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),i.jsx("select",{value:d??"",onChange:y=>f(y.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(y=>i.jsx("option",{value:y,children:y},y))})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),i.jsx("select",{value:p??"",onChange:y=>h(y.target.value?Number(y.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(y=>i.jsx("option",{value:y,children:y},y))})]})]}),a&&i.jsx("div",{className:"mb-4 inline-block bg-green-100 text-green-800 px-4 py-2 rounded-lg font-semibold",children:a}),i.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:i.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Code"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Course"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Class"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"L"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"T"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"P"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"S"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"C"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"INT"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Depts"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),i.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(y=>(!d||y.regulation===d)&&(!p||y.semester===p)).length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:16,className:"px-4 py-8 text-center text-gray-500",children:"No curriculum entries found for the selected filters."})}):e.filter(y=>(!d||y.regulation===d)&&(!p||y.semester===p)).map(y=>i.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${y.editable?"bg-blue-50/30":""}`,children:[i.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 whitespace-nowrap",children:y.course_code||"-"}),i.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 font-medium min-w-[200px]",children:y.course_name||"-"}),i.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:y.category||"-"}),i.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:y.class_type||"-"}),i.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:y.is_elective?i.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):i.jsx("span",{className:"text-gray-400",children:"No"})}),i.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:y.l??0}),i.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:y.t??0}),i.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:y.p??0}),i.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:y.s??0}),i.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:y.c??0}),i.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:y.internal_mark??"-"}),i.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:y.external_mark??"-"}),i.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 font-semibold whitespace-nowrap",children:y.total_mark??"-"}),i.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:y.for_all_departments?"ALL":y.departments_display&&y.departments_display.length>0?y.departments_display.map(v=>v.short_name||v.shortname||v.code||v.name).join(", "):"No Depts"}),i.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:y.editable?i.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):i.jsx("span",{className:"text-gray-400",children:"No"})}),i.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center justify-center gap-2",children:[i.jsx(Vi,{to:`/curriculum/master/${y.id}`,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:i.jsx(Jf,{className:"w-4 h-4"})}),y.status==="PENDING"&&i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",className:"px-3 py-1.5 text-green-600 hover:bg-green-50 text-xs font-medium rounded-lg transition-colors",children:"Approve"}),i.jsx("button",{type:"button",className:"px-3 py-1.5 text-red-600 hover:bg-red-50 text-xs font-medium rounded-lg transition-colors",children:"Reject"})]})]})})]},y.id))})]})})]})})}function TR(){const{id:e}=M0(),t=e??(window.location.pathname.endsWith("/new")?"new":void 0),r=so(),[n,a]=x.useState({regulation:"",semester:1,for_all_departments:!0,editable:!1,is_elective:!1}),[s,o]=x.useState(!1),[l,c]=x.useState([]),[u,d]=x.useState(null);x.useEffect(()=>{t&&t!=="new"&&(o(!0),Ld().then(p=>{const h=p.find(m=>String(m.id)===String(t));h&&a(h)}).finally(()=>o(!1)))},[t]),x.useEffect(()=>{sl().then(p=>{const h=new Map;p.forEach(m=>h.set(m.department.id,m.department)),c(Array.from(h.values()))}).catch(()=>c([]))},[]);async function f(){o(!0);try{if(!n.regulation)throw new Error("Regulation is required");if(!n.semester||n.semester<=0)throw new Error("Semester must be a positive number");if(!n.course_name)throw new Error("Course Name is required");if(n.internal_mark!==""&&n.internal_mark!=null&&n.internal_mark<0||n.external_mark!==""&&n.external_mark!=null&&n.external_mark<0)throw new Error("Marks cannot be negative");const p={...n};if(n.for_all_departments?p.departments=[]:p.departments=Array.isArray(n.departments)?n.departments:[],p.internal_mark=n.internal_mark===""||n.internal_mark==null?0:Number(n.internal_mark),p.external_mark=n.external_mark===""||n.external_mark==null?0:Number(n.external_mark),p.course_code=n.course_code===""||n.course_code==null?null:n.course_code,t==="new"){const h=await dre(p);r("/curriculum/master",{state:{savedMessage:"Saved",newId:h.id}})}else{const h=Number(t);if(Number.isNaN(h))throw new Error("Invalid master id");const m=await fre(h,p);a(m),d("Saved"),setTimeout(()=>d(null),2500)}}catch(p){alert(`Error: ${p.message}`)}finally{o(!1)}}return i.jsxs(O1,{children:[i.jsxs("div",{className:"px-2 sm:px-4 pb-4",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[i.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsx(ls,{className:"w-5 h-5 sm:w-6 sm:h-6 text-indigo-600"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:e==="new"?"New Master":"Edit Master"}),i.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-1",children:e==="new"?"Create a new master curriculum entry.":"Edit the selected master curriculum entry."})]})]}),i.jsxs("form",{onSubmit:p=>{p.preventDefault(),f()},className:"bg-white rounded-lg shadow-md p-3 sm:p-4 lg:p-6 space-y-4",autoComplete:"off",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Regulation"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.regulation||"",onChange:p=>a({...n,regulation:p.target.value}),required:!0})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Semester"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:1,value:n.semester||1,onChange:p=>a({...n,semester:Number(p.target.value)}),required:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Code"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_code??"",onChange:p=>a({...n,course_code:p.target.value}),placeholder:"Optional"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Name"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_name||"",onChange:p=>a({...n,course_name:p.target.value}),required:!0})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"CAT"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.category||"",onChange:p=>a({...n,category:p.target.value}),placeholder:"e.g. CORE"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Class"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.class_type||"",onChange:p=>a({...n,class_type:p.target.value}),placeholder:"e.g. Theory"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"L"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.l||0,onChange:p=>a({...n,l:Number(p.target.value)})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"T"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.t||0,onChange:p=>a({...n,t:Number(p.target.value)})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"P"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.p||0,onChange:p=>a({...n,p:Number(p.target.value)})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"S"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.s||0,onChange:p=>a({...n,s:Number(p.target.value)})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"C"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.c||0,onChange:p=>a({...n,c:Number(p.target.value)})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Internal Mark"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.internal_mark??"",onChange:p=>a({...n,internal_mark:p.target.value===""?"":Number(p.target.value)})})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"External Mark"}),i.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.external_mark??"",onChange:p=>a({...n,external_mark:p.target.value===""?"":Number(p.target.value)})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[i.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:p=>a({...n,for_all_departments:p.target.checked}),id:"forAllDepts",className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),i.jsx("label",{htmlFor:"forAllDepts",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"For All Departments"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Departments"}),n.for_all_departments?i.jsx("div",{className:"text-gray-600 text-xs sm:text-sm p-2 bg-gray-50 rounded-lg",children:"Applies to all departments"}):i.jsxs("div",{className:"max-h-32 overflow-y-auto p-2 border border-gray-300 rounded-lg bg-white",children:[l.length===0&&i.jsx("div",{className:"text-gray-400 text-xs",children:"No departments available"}),l.map(p=>i.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[i.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(p.id):!1,onChange:h=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(h.target.checked)m.includes(p.id)||m.push(p.id);else{const g=m.indexOf(p.id);g>=0&&m.splice(g,1)}a({...n,departments:m})},id:`dept-${p.id}`,className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),i.jsxs("label",{htmlFor:`dept-${p.id}`,className:"text-xs sm:text-sm text-gray-700",children:[p.code,"  ",p.name]})]},p.id))]})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[i.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:p=>a({...n,editable:p.target.checked}),id:"editable",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),i.jsx("label",{htmlFor:"editable",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Editable"})]}),i.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[i.jsx("input",{type:"checkbox",checked:!!n.is_elective,onChange:p=>a({...n,is_elective:p.target.checked}),id:"is_elective",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),i.jsx("label",{htmlFor:"is_elective",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Is Elective"})]})]}),u&&i.jsx("div",{className:"bg-green-100 text-green-800 px-3 py-1.5 rounded-lg font-semibold text-sm inline-block",children:u}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed text-sm",disabled:s,children:[i.jsx(Od,{className:"w-4 h-4"}),s?"Saving":"Save"]}),i.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors text-sm",onClick:()=>r("/curriculum/master"),children:[i.jsx(zu,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),i.jsxs("form",{onSubmit:p=>{p.preventDefault(),f()},style:{background:"#fff",borderRadius:10,boxShadow:"0 2px 8px #e5e7eb",padding:32,maxWidth:700,margin:"0 auto",display:"grid",gap:22},autoComplete:"off",children:[i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Regulation"}),i.jsx("input",{className:"input",value:n.regulation||"",onChange:p=>a({...n,regulation:p.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Semester"}),i.jsx("input",{className:"input",type:"number",min:1,value:n.semester||1,onChange:p=>a({...n,semester:Number(p.target.value)}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Code"}),i.jsx("input",{className:"input",value:n.course_code??"",onChange:p=>a({...n,course_code:p.target.value}),placeholder:"Optional",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Name"}),i.jsx("input",{className:"input",value:n.course_name||"",onChange:p=>a({...n,course_name:p.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"CAT"}),i.jsx("input",{className:"input",value:n.category||"",onChange:p=>a({...n,category:p.target.value}),placeholder:"e.g. CORE",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Class"}),i.jsxs("select",{className:"input",value:n.class_type||"",onChange:p=>a({...n,class_type:p.target.value}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4},children:[i.jsx("option",{value:"",children:"Select class type"}),Hp.map(p=>{const h=In(String(p)),m=String(p).charAt(0).toUpperCase()+String(p).slice(1);return i.jsx("option",{value:h,children:m},h)})]})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:18},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"L"}),i.jsx("input",{className:"input",type:"number",min:0,value:n.l||0,onChange:p=>a({...n,l:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"T"}),i.jsx("input",{className:"input",type:"number",min:0,value:n.t||0,onChange:p=>a({...n,t:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"P"}),i.jsx("input",{className:"input",type:"number",min:0,value:n.p||0,onChange:p=>a({...n,p:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"S"}),i.jsx("input",{className:"input",type:"number",min:0,value:n.s||0,onChange:p=>a({...n,s:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"C"}),i.jsx("input",{className:"input",type:"number",min:0,value:n.c||0,onChange:p=>a({...n,c:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Internal Mark"}),i.jsx("input",{className:"input",type:"number",min:0,value:n.internal_mark??"",onChange:p=>a({...n,internal_mark:p.target.value===""?"":Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"External Mark"}),i.jsx("input",{className:"input",type:"number",min:0,value:n.external_mark??"",onChange:p=>a({...n,external_mark:p.target.value===""?"":Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[i.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:p=>a({...n,for_all_departments:p.target.checked}),id:"forAllDepts"}),i.jsx("label",{htmlFor:"forAllDepts",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"For All Departments"})]}),i.jsxs("div",{children:[i.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Departments"}),n.for_all_departments?i.jsx("div",{style:{marginTop:6,color:"#6b7280"},children:"Applies to all departments"}):i.jsxs("div",{style:{marginTop:6,maxHeight:220,overflowY:"auto",padding:6,border:"1px solid #e5e7eb",borderRadius:6},children:[l.length===0&&i.jsx("div",{style:{color:"#9ca3af"},children:"No departments available"}),l.map(p=>i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[i.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(p.id):!1,onChange:h=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(h.target.checked)m.includes(p.id)||m.push(p.id);else{const g=m.indexOf(p.id);g>=0&&m.splice(g,1)}a({...n,departments:m})},id:`dept-${p.id}`}),i.jsxs("label",{htmlFor:`dept-${p.id}`,style:{marginBottom:0},children:[p.code,"  ",p.name]})]},p.id))]})]})]}),i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[i.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:p=>a({...n,editable:p.target.checked}),id:"editable"}),i.jsx("label",{htmlFor:"editable",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"Editable"})]}),u&&i.jsx("div",{style:{background:"#ecfccb",color:"#365314",padding:"8px 12px",borderRadius:8,fontWeight:600,display:"inline-block"},children:u}),i.jsxs("div",{style:{display:"flex",gap:10,marginTop:8},children:[i.jsx("button",{type:"submit",className:"btn-primary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},disabled:s,children:s?"Saving":"Save"}),i.jsx("button",{type:"button",className:"btn-secondary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},onClick:()=>r("/curriculum/master"),children:"Cancel"})]})]})]})}function FPe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),a=e&&e.length?Array.from(new Set(e.map(V=>V.regulation))):[],s=e&&e.length?Array.from(new Set(e.map(V=>V.semester))).sort((V,K)=>V-K):[],[o,l]=x.useState(a.length===1?a[0]:a[0]??null),[c,u]=x.useState(s.length===1?s[0]:s[0]??null),d=e&&e.length?Array.from(new Set(e.map(V=>V.department.id))):[];x.useEffect(()=>{const V=e&&e.length?Array.from(new Set(e.map(de=>de.regulation))):[];V.length===1?l(V[0]):V.includes(o||"")||l(V[0]??null);const K=e&&e.length?Array.from(new Set(e.map(de=>de.semester))).sort((de,ne)=>de-ne):[];K.length===1?u(K[0]):K.includes(c||-1)||u(K[0]??null)},[e]),x.useEffect(()=>{sl().then(V=>t(V)).catch(console.error).finally(()=>n(!1))},[]);async function f(V){try{const K=await pre(V.id,V);t(de=>de.map(ne=>ne.id===K.id?K:ne)),h(null),alert("Row updated successfully")}catch(K){alert(String(K))}}const[p,h]=x.useState(null),m=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),g=Array.isArray(m)&&(m.includes("curriculum.department.approve")||m.includes("CURRICULUM_DEPARTMENT_APPROVE"));async function b(V,K){try{await mre(V,K);const de=await sl();t(de),alert("OK")}catch(de){alert(String(de))}}const[y,v]=x.useState(null);x.useEffect(()=>{d.length===1?v(d[0]):d.includes(y||-1)||v(d[0]??null)},[e]);const w=e.filter(V=>V.is_elective&&(!y||V.department.id===y)&&(!o||V.regulation===o)&&(!c||V.semester===c)),[_,C]=x.useState([]);x.useEffect(()=>{sm({department_id:y??void 0,regulation:o??void 0,semester:c??void 0}).then(C).catch(()=>C([]))},[y,o,c,e]);const[j,A]=x.useState(!1),[M,P]=x.useState({parent:null,department_id:y||null,regulation:o||null,semester_id:c||null,course_code:"",course_name:"",class_type:"THEORY",category:"",is_elective:!0,l:0,t:0,p:0,s:0,c:0,internal_mark:null,external_mark:null,total_mark:null,total_hours:null,question_paper_type:"",editable:!1});function R(V){P(K=>({...K,parent:V.id,department_id:y||K.department_id,regulation:o||K.regulation,semester_id:c||K.semester_id,course_name:"",course_code:""})),A(!0)}async function N(){try{const V={...M};if(!V.parent)throw new Error("Parent curriculum id missing");V.course_code||delete V.course_code,V.course_name||delete V.course_name,await hre(V);const K=await sl();t(K);const de=await sm({department_id:y??void 0,regulation:o??void 0,semester:c??void 0});C(de),A(!1),alert("Elective subject added")}catch(V){alert(String(V))}}const[T,B]=x.useState(!1),[G,re]=x.useState(null);function xe(V){re({...V}),B(!0)}async function _e(){if(!(!G||!G.id))try{const V=await mr(`/api/curriculum/elective/${G.id}/`,{method:"PATCH",body:JSON.stringify(G)});if(!V.ok)throw new Error(await V.text());const K=await sl();t(K);const de=await sm({department_id:y??void 0,regulation:o??void 0,semester:c??void 0});C(de),B(!1),alert("Elective updated")}catch(V){alert(String(V))}}return r?i.jsx(O1,{children:i.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Loading department curriculum"})]})})}):i.jsx(O1,{children:i.jsxs("div",{className:"px-4 pb-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[i.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:i.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 48 48",children:[i.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),i.jsx("path",{d:"M16 32V16h16v16H16zm2-2h12V18H18v12zm2-2v-8h8v8h-8z",fill:"#6366f1"})]})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Department Curriculum"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage department-specific curriculum entries."})]})]}),a.length>0&&i.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),i.jsx("select",{value:o??"",onChange:V=>l(V.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:a.map(V=>i.jsx("option",{value:V,children:V},V))})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),i.jsx("select",{value:c??"",onChange:V=>u(V.target.value?Number(V.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:s.map(V=>i.jsx("option",{value:V,children:V},V))})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(V=>{var E;const K=y===V,de=(E=e.find(Z=>Z.department.id===V))==null?void 0:E.department,ne=(de==null?void 0:de.short_name)||(de==null?void 0:de.shortname)||(de==null?void 0:de.code)||(de==null?void 0:de.name)||`Dept ${V}`;return i.jsx("button",{onClick:()=>v(V),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${K?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:ne},V)})})]}),i.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:i.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Code"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap min-w-[200px]",children:"Course"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Class"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"L"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"T"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"P"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"S"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"C"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"INT"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Hours"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"QP Type"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),i.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(V=>(!y||V.department.id===y)&&(!o||V.regulation===o)&&(!c||V.semester===c)).map(V=>i.jsx("tr",{className:`hover:bg-gray-50 transition-colors ${V.editable?"bg-slate-50":""}`,children:p===V.id?i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{value:V.course_code||"",onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,course_code:K.target.value}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2",children:i.jsx("textarea",{value:V.course_name||"",onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,course_name:K.target.value}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",style:{minHeight:"32px"},placeholder:"Course Name",rows:1,onInput:K=>{const de=K.target;de.style.height="32px",de.style.height=de.scrollHeight+"px"}})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{value:V.category||"",onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,category:K.target.value}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("select",{value:V.class_type||"THEORY",onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,class_type:K.target.value}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input",style:{minWidth:90},children:Hp.map(K=>{const de=In(String(K)),ne=String(K).charAt(0).toUpperCase()+String(K).slice(1).toLowerCase();return i.jsx("option",{value:de,children:ne},de)})})}),i.jsx("td",{className:"px-3 py-2 text-center whitespace-nowrap",children:i.jsx("input",{type:"checkbox",checked:!!V.is_elective,onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,is_elective:K.target.checked}:ne)),className:"w-4 h-4"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{type:"number",value:V.l||0,onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,l:Number(K.target.value)}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{type:"number",value:V.t||0,onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,t:Number(K.target.value)}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{type:"number",value:V.p||0,onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,p:Number(K.target.value)}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{type:"number",value:V.s||0,onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,s:Number(K.target.value)}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{type:"number",value:V.c||0,onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,c:Number(K.target.value)}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{type:"number",value:V.internal_mark||"",onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,internal_mark:Number(K.target.value)}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{type:"number",value:V.external_mark||"",onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,external_mark:Number(K.target.value)}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{type:"number",value:V.total_mark||"",onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,total_mark:Number(K.target.value)}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{type:"number",value:V.total_hours||"",onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,total_hours:Number(K.target.value)}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("input",{value:V.question_paper_type||"",onChange:K=>t(de=>de.map(ne=>ne.id===V.id?{...ne,question_paper_type:K.target.value}:ne)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:V.editable?i.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):i.jsx("span",{className:"text-gray-400",children:"No"})}),i.jsxs("td",{className:"px-3 py-2 whitespace-nowrap",children:[i.jsx("button",{className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors mr-2",onClick:()=>f(V),title:"Save",children:i.jsx(Od,{className:"w-4 h-4"})}),i.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>h(null),title:"Cancel",children:i.jsx(zu,{className:"w-4 h-4"})})]})]}):i.jsxs(i.Fragment,{children:[i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.course_code||"-"}),i.jsx("td",{className:"px-3 py-2.5 text-sm text-gray-900 font-medium",children:V.course_name||"-"}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.category||"-"}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.class_type||"-"}),i.jsx("td",{className:"px-3 py-2.5 text-center whitespace-nowrap text-sm",children:V.is_elective?i.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):i.jsx("span",{className:"text-gray-400",children:"No"})}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.l??0}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.t??0}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.p??0}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.s??0}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.c??0}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.internal_mark??"-"}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.external_mark??"-"}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.total_mark??"-"}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.total_hours??"-"}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.question_paper_type||"-"}),i.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:V.editable?i.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):i.jsx("span",{className:"text-gray-400",children:"No"})}),i.jsxs("td",{className:"px-3 py-2.5 whitespace-nowrap",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[V.editable?i.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>h(V.id),title:"Edit",children:i.jsx(Jf,{className:"w-4 h-4"})}):i.jsx("div",{className:"w-8 h-8"}),g&&V.approval_status==="PENDING"?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>b(V.id,"approve"),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Approve",children:i.jsx(wee,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>b(V.id,"reject"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Reject",children:i.jsx(zu,{className:"w-4 h-4"})})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-8 h-8"}),i.jsx("div",{className:"w-8 h-8"})]})]}),i.jsxs("div",{className:"text-xs mt-1 text-gray-600",children:["Status: ",i.jsx("strong",{className:"text-gray-900",children:V.approval_status||"APPROVED"})]})]})]})},V.id))})]})}),i.jsxs("div",{className:"mt-6",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Elective Options"}),w.length===0?i.jsx("div",{className:"text-gray-400 py-4",children:"No elective options for selected department/semester."}):i.jsx("div",{className:"space-y-6",children:w.map(V=>{const K=_.filter(de=>de.parent===V.id);return i.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("div",{className:"text-lg font-bold text-gray-900",children:V.course_name||V.course_code||"Elective"}),i.jsx("button",{onClick:()=>R(V),className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Add Subject"})]}),i.jsx("div",{className:"w-full overflow-x-auto",children:i.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Code"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Course"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"CAT"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Class"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"L"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"T"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"P"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"S"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"C"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"INT"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"EXT"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"TTL"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Hours"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"QP Type"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:K.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:15,className:"px-3 py-4 text-gray-400 text-center",children:"No subjects added yet."})}):K.map(de=>i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.course_code||"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.course_name||"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.category||"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.class_type||"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.l??0}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.t??0}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.p??0}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.s??0}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.c??0}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.internal_mark??"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.external_mark??"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.total_mark??"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.total_hours??"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:de.question_paper_type||"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm",children:de.editable?i.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):i.jsx("span",{className:"text-gray-400",children:"No"})}),i.jsx("button",{onClick:()=>xe(de),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:i.jsx(Jf,{className:"w-4 h-4"})})]})})]},de.id))})]})})]},V.id)})})]}),j&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Add Elective Subject"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),i.jsx("input",{value:M.course_name||"",onChange:V=>P(K=>({...K,course_name:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),i.jsx("input",{value:M.course_code||"",onChange:V=>P(K=>({...K,course_code:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),i.jsxs("select",{value:M.class_type,onChange:V=>P(K=>({...K,class_type:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"THEORY",children:"THEORY"}),i.jsx("option",{value:"LAB",children:"LAB"}),i.jsx("option",{value:"TCPL",children:"TCPL"}),i.jsx("option",{value:"TCPR",children:"TCPR"}),i.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),i.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),i.jsx("input",{value:M.category||"",onChange:V=>P(K=>({...K,category:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),i.jsx("input",{type:"number",value:M.l??0,onChange:V=>P(K=>({...K,l:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),i.jsx("input",{type:"number",value:M.t??0,onChange:V=>P(K=>({...K,t:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),i.jsx("input",{type:"number",value:M.p??0,onChange:V=>P(K=>({...K,p:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),i.jsx("input",{type:"number",value:M.s??0,onChange:V=>P(K=>({...K,s:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),i.jsx("input",{type:"number",value:M.c??0,onChange:V=>P(K=>({...K,c:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),i.jsx("input",{type:"number",value:M.internal_mark??"",onChange:V=>P(K=>({...K,internal_mark:V.target.value?Number(V.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),i.jsx("input",{type:"number",value:M.external_mark??"",onChange:V=>P(K=>({...K,external_mark:V.target.value?Number(V.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),i.jsx("input",{type:"number",value:M.total_mark??"",onChange:V=>P(K=>({...K,total_mark:V.target.value?Number(V.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),i.jsx("input",{type:"number",value:M.total_hours??"",onChange:V=>P(K=>({...K,total_hours:V.target.value?Number(V.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),i.jsx("input",{value:M.question_paper_type||"",onChange:V=>P(K=>({...K,question_paper_type:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{id:"add-editable",type:"checkbox",checked:!!M.editable,onChange:V=>P(K=>({...K,editable:V.target.checked})),className:"w-4 h-4"}),i.jsx("label",{htmlFor:"add-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[i.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),i.jsx("button",{onClick:N,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})}),T&&G&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:i.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Edit Elective Subject"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),i.jsx("input",{value:G.course_name||"",onChange:V=>re(K=>({...K,course_name:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),i.jsx("input",{value:G.course_code||"",onChange:V=>re(K=>({...K,course_code:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),i.jsxs("select",{value:G.class_type||"THEORY",onChange:V=>re(K=>({...K,class_type:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"THEORY",children:"THEORY"}),i.jsx("option",{value:"LAB",children:"LAB"}),i.jsx("option",{value:"TCPL",children:"TCPL"}),i.jsx("option",{value:"TCPR",children:"TCPR"}),i.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),i.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),i.jsx("input",{value:G.category||"",onChange:V=>re(K=>({...K,category:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),i.jsx("input",{type:"number",value:G.l??0,onChange:V=>re(K=>({...K,l:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),i.jsx("input",{type:"number",value:G.t??0,onChange:V=>re(K=>({...K,t:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),i.jsx("input",{type:"number",value:G.p??0,onChange:V=>re(K=>({...K,p:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),i.jsx("input",{type:"number",value:G.s??0,onChange:V=>re(K=>({...K,s:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),i.jsx("input",{type:"number",value:G.c??0,onChange:V=>re(K=>({...K,c:Number(V.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),i.jsx("input",{type:"number",value:G.internal_mark??"",onChange:V=>re(K=>({...K,internal_mark:V.target.value?Number(V.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),i.jsx("input",{type:"number",value:G.external_mark??"",onChange:V=>re(K=>({...K,external_mark:V.target.value?Number(V.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),i.jsx("input",{type:"number",value:G.total_mark??"",onChange:V=>re(K=>({...K,total_mark:V.target.value?Number(V.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),i.jsx("input",{type:"number",value:G.total_hours??"",onChange:V=>re(K=>({...K,total_hours:V.target.value?Number(V.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"col-span-2",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),i.jsx("input",{value:G.question_paper_type||"",onChange:V=>re(K=>({...K,question_paper_type:V.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{id:"edit-editable",type:"checkbox",checked:!!G.editable,onChange:V=>re(K=>({...K,editable:V.target.checked})),className:"w-4 h-4"}),i.jsx("label",{htmlFor:"edit-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),i.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[i.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),i.jsx("button",{onClick:_e,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})})]})})}function RPe(){const[e,t]=x.useState(null),[r,n]=x.useState(!1),[a,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[p,h]=x.useState(""),[m,g]=x.useState(""),[b,y]=x.useState(""),[v,w]=x.useState([]),[_,C]=x.useState(!1);x.useEffect(()=>{j()},[p,m,b]),x.useEffect(()=>{A()},[]);const j=async()=>{C(!0);try{const B={};p&&(B.regulation=p),m&&(B.semester=m),b&&(B.department_id=b);const G=await sm(B);w(G||[])}catch(B){console.error("Failed to load electives:",B),w([])}finally{C(!1)}},A=async()=>{try{const B=await sm();if(!B||!Array.isArray(B))return;const G=[...new Set(B.map(_e=>_e.regulation))].filter(Boolean).sort(),re=[...new Set(B.map(_e=>_e.semester))].filter(Boolean).sort((_e,V)=>_e-V),xe=Array.from(new Map(B.map(_e=>_e.department).filter(Boolean).map(_e=>[_e.id,_e])).values()).sort((_e,V)=>(_e.code||"").localeCompare(V.code||""));l(G),u(re),f(xe)}catch(B){console.error("Failed to load filter options:",B)}},M=async()=>{try{const B=await mr("/api/curriculum/elective-choices/template/");if(!B.ok){alert("Failed to download template");return}const G=await B.blob(),re=window.URL.createObjectURL(G),xe=document.createElement("a");xe.href=re,xe.download="elective_choices_template.csv",document.body.appendChild(xe),xe.click(),window.URL.revokeObjectURL(re),document.body.removeChild(xe)}catch(B){console.error("Download error:",B),alert("Failed to download template")}},P=async()=>{try{const B=await mr("/api/curriculum/elective-choices/template/?format=excel");if(!B.ok){alert("Failed to download Excel template");return}const G=await B.blob(),re=window.URL.createObjectURL(G),xe=document.createElement("a");xe.href=re,xe.download="elective_choices_template.xlsx",document.body.appendChild(xe),xe.click(),window.URL.revokeObjectURL(re),document.body.removeChild(xe)}catch(B){console.error("Download error:",B),alert("Failed to download Excel template")}},R=B=>{var re;const G=(re=B.target.files)==null?void 0:re[0];if(G){if(![".csv",".xlsx",".xls"].some(V=>G.name.toLowerCase().endsWith(V))){alert("Please select a CSV or Excel file (.csv, .xlsx, .xls)");return}t(G),s(null)}},N=async()=>{if(!e){alert("Please select a file first");return}n(!0),s(null);try{const B=new FormData;B.append("csv_file",e);const G=await mr("/api/curriculum/elective-choices/import/",{method:"POST",body:B});if(G.status===401){alert("Your session has expired. Please refresh the page and try again.");return}let re;try{re=await G.json()}catch(xe){console.error("Failed to parse response:",xe),alert("Import failed: Invalid response from server");return}if(G.ok){s(re),t(null);const xe=document.getElementById("file-input");xe&&(xe.value=""),j()}else{const xe=re.error||re.detail||re.message||"Import failed";alert(typeof xe=="string"?xe:"Import failed: "+JSON.stringify(xe).substring(0,200))}}catch(B){console.error("Upload error:",B),alert("Failed to upload file. Please check your connection and try again.")}finally{n(!1)}},T=v.filter(B=>{var G;return!(p&&B.regulation!==p||m&&B.semester!==m||b&&((G=B.department)==null?void 0:G.id)!==b)});return i.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg",children:i.jsx(Bee,{className:"h-6 w-6 text-indigo-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Elective Import"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Import student elective choices from CSV or Excel"})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs("button",{onClick:M,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(gA,{className:"h-5 w-5"}),"CSV Template"]}),i.jsxs("button",{onClick:P,className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white font-medium rounded-lg hover:bg-emerald-700 transition-colors",children:[i.jsx(gA,{className:"h-5 w-5"}),"Excel Template"]})]})]}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upload File"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{children:i.jsxs("label",{htmlFor:"file-input",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[i.jsxs("div",{className:"flex flex-col items-center justify-center",children:[i.jsx(v2,{className:"h-8 w-8 text-gray-400 mb-2"}),i.jsx("p",{className:"text-sm text-gray-600",children:e?i.jsx("span",{className:"font-medium text-indigo-600",children:e.name}):i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]})}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"CSV or Excel files (.csv, .xlsx, .xls)"})]}),i.jsx("input",{id:"file-input",type:"file",className:"hidden",accept:".csv,.xlsx,.xls",onChange:R})]})}),i.jsxs("button",{onClick:N,disabled:!e||r,className:`w-full inline-flex items-center justify-center gap-2 px-6 py-3 font-medium rounded-lg transition-colors ${!e||r?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[i.jsx(v2,{className:"h-5 w-5"}),r?"Uploading...":"Upload and Import"]})]})]}),a&&i.jsx("div",{className:`rounded-lg shadow-sm p-6 mb-6 ${a.errors&&a.errors.length>0?"bg-yellow-50 border border-yellow-200":"bg-green-50 border border-green-200"}`,children:i.jsxs("div",{className:"flex items-start gap-3",children:[a.errors&&a.errors.length>0?i.jsx($u,{className:"h-6 w-6 text-yellow-600 flex-shrink-0 mt-0.5"}):i.jsx(RD,{className:"h-6 w-6 text-green-600 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:`text-lg font-semibold mb-2 ${a.errors&&a.errors.length>0?"text-yellow-900":"text-green-900"}`,children:a.message}),i.jsxs("div",{className:`space-y-1 text-sm ${a.errors&&a.errors.length>0?"text-yellow-800":"text-green-800"}`,children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Created:"})," ",a.created," entries"]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Updated:"})," ",a.updated," entries"]}),a.errors&&a.errors.length>0&&i.jsxs("div",{className:"mt-3",children:[i.jsxs("p",{className:"font-semibold text-red-700 mb-2",children:["Errors (",a.errors.length,"):"]}),i.jsx("ul",{className:"list-disc list-inside space-y-1 text-red-600 max-h-40 overflow-y-auto",children:a.errors.map((B,G)=>i.jsx("li",{className:"text-xs",children:B},G))})]})]})]})]})}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(Uee,{className:"h-5 w-5 text-gray-600"}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Elective Subjects"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Regulation"}),i.jsxs("select",{value:p,onChange:B=>h(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"All Regulations"}),o.map(B=>i.jsx("option",{value:B,children:B},B))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),i.jsxs("select",{value:m,onChange:B=>g(B.target.value?Number(B.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"All Semesters"}),c.map(B=>i.jsxs("option",{value:B,children:["Semester ",B]},B))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),i.jsxs("select",{value:b,onChange:B=>y(B.target.value?Number(B.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[i.jsx("option",{value:"",children:"All Departments"}),d.map(B=>i.jsxs("option",{value:B.id,children:[B.code," - ",B.short_name||B.name]},B.id))]})]})]}),_?i.jsx("div",{className:"text-center py-8 text-gray-600",children:"Loading electives..."}):T.length===0?i.jsx("div",{className:"text-center py-8 text-gray-500",children:"No electives found"}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Code"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Name"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Regulation"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Semester"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),i.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:i.jsxs("div",{className:"flex items-center justify-center gap-1",children:[i.jsx(us,{className:"h-4 w-4"}),"Students"]})})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(B=>{var G;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:B.course_code||""}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:B.course_name||""}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:B.regulation||""}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:B.semester||""}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:((G=B.department)==null?void 0:G.code)||""}),i.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:i.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${B.student_count>0?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-600"}`,children:B.student_count})})]},B.id)})})]})})]})]})})}function BPe(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.zynix.us"}const Ap=BPe();function Yg(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function uK(){var nt;const[e,t]=x.useState([]),[r,n]=x.useState("courses"),[a,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState(!1),[p,h]=x.useState(1),[m,g]=x.useState("idle"),[b,y]=x.useState(null),[v,w]=x.useState([]),[_,C]=x.useState(null),[j,A]=x.useState(""),[M,P]=x.useState(""),[R,N]=x.useState(""),[T,B]=x.useState(""),[G,re]=x.useState(""),[xe,_e]=x.useState(!1),[V,K]=x.useState(null),[de,ne]=x.useState(null),[E,Z]=x.useState([]),[H,F]=x.useState(!1),[ee,z]=x.useState(0),[X,J]=x.useState([]),[q,Y]=x.useState(null),[L,U]=x.useState(null),[ce,W]=x.useState(null);function ae(Se){try{if(typeof Se=="string"){let Te=Se;return!Te.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(Te)&&Te.length>100&&(Te=`data:image/png;base64,${Te.replace(/\s+/g,"")}`),Te}if(Se&&typeof Se=="object"){if(typeof Se.url=="string"&&Se.url)return Se.url;if(typeof Se.base64=="string"&&Se.base64)return Se.base64.startsWith("data:")?Se.base64:`data:image/png;base64,${Se.base64}`;if(Se.binary&&Se.binary instanceof Uint8Array){const Te=new Blob([Se.binary],{type:"image/png"});return URL.createObjectURL(Te)}}if(Se instanceof Uint8Array){const Te=new Blob([Se],{type:"image/png"});return URL.createObjectURL(Te)}return null}catch{return null}}x.useEffect(()=>{W1().then(Se=>s(Se)).catch(()=>s(null)),(async()=>{try{u(!0);const Se=await jc();Array.isArray(Se)&&l(Se)}catch(Se){console.warn("Failed to load teaching assignments",Se),l([])}finally{u(!1)}})(),(async()=>{try{const Se=await fetch(`${Ap}/api/obe/list-uploads`,{headers:{...Yg()}});if(!Se.ok)return;const Te=await Se.json();Array.isArray(Te==null?void 0:Te.files)&&J(Te.files||[])}catch{}})()},[]);const he=x.useMemo(()=>a?a.faculty_id??a.staff_id??a.employee_id??a.id??null:null,[a]),ze=Se=>{const Te=parseFloat(Se.replace(/[^0-9.\-]/g,""));return Number.isFinite(Te)?Te:0},ke=Se=>{const Te=`/obe/course/${encodeURIComponent(Se)}`;window.location.href=Te},qe=x.useMemo(()=>(v||[]).filter(Se=>{const Te=String((Se==null?void 0:Se.marks)??"").trim().toUpperCase(),Dt=String((Se==null?void 0:Se.btl)??"").trim().toUpperCase(),wt=String((Se==null?void 0:Se.course_outcomes)??"").trim().toUpperCase();return!(Te==="(OR)"&&Dt==="(OR)"&&wt==="(OR)")}),[v]),[Ie,Ve]=x.useState("idle"),[Qe,Tt]=x.useState(null);async function vt(Se){Ve("uploading"),Tt(null),g("idle"),y(null),K(null),ne(null);const Te=new FormData;Te.append("file",Se);try{const Dt=await fetch(`${Ap}/api/obe/upload-docx`,{method:"POST",headers:{...Yg()},body:Te});if(!Dt.ok){const ur=await Dt.text();Ve("error"),Tt(ur||`Upload failed (${Dt.status})`);return}const wt=await Dt.json();Ve("success");const Pt=(wt==null?void 0:wt.file_url)||(wt==null?void 0:wt.saved_path)||"";C(Pt||null),Tt(`Uploaded: ${Pt}`),f(!0),h(1),w([]),g("scanning"),y("Scanning DOCX");const Wt=new FormData;Wt.append("file",Se);const Ot=await fetch(`${Ap}/api/template/scan-docx`,{method:"POST",headers:{...Yg()},body:Wt});if(!Ot.ok){const ur=await Ot.text();g("error"),y(ur||`Scan failed (${Ot.status})`),w([]);return}const Ht=await Ot.json(),jt=(Array.isArray(Ht==null?void 0:Ht.questions)?Ht.questions:[]).map(ur=>({...ur,source_file_path:Pt||ur.source_file_path||null}));if(w(jt),g("success"),y(`Scanned ${jt.length} question(s).`),!j.trim()){const ur=Se.name.replace(/\.docx$/i,"");A(ur)}}catch(Dt){Ve("error"),Tt((Dt==null?void 0:Dt.message)||"Upload failed"),g("error"),y((Dt==null?void 0:Dt.message)||"Scan failed")}}function Xe(){f(!1),h(1)}async function Be(){if(!j.trim()){ne("Exam name is required."),h(2);return}if(!R.trim()){ne("Exam type is required."),h(2);return}if(!T.trim()){ne("Exam date is required."),h(2);return}_e(!0),ne(null),K(null);try{const Se=G.split(/\r?\n/).map(Wt=>Wt.trim()).filter(Boolean),Te=qe.map(Wt=>({...Wt,excel_type:Wt.excel_type||R,source_file_path:Wt.source_file_path||_||null})),Dt=await fetch(`${Ap}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...Yg()},body:JSON.stringify({title:j.trim(),status:"pending",exam_type:R.trim(),exam_date:T.trim(),sections:Se,faculty_id:he,questions:Te})});if(!Dt.ok){const Wt=await Dt.text();ne(Wt||`Import failed (${Dt.status})`);return}const wt=await Dt.json();K(wt);const Pt={title:j.trim(),inserted:wt.inserted||0,failed:Array.isArray(wt.failed)?wt.failed.length:0,source_file_path:_||null,title_id:wt.title_id||null,exam_date:T||null,exam_type:R||null,faculty_id:he||null,created_at:new Date().toISOString()};Z(Wt=>[Pt,...Wt]),F(!0),setTimeout(()=>F(!1),4e3),setTimeout(()=>Xe(),600)}catch(Se){ne((Se==null?void 0:Se.message)||"Import failed")}finally{_e(!1)}}const ct=e.length;return ct&&(e.reduce((Se,Te)=>Se+ze(Te.achieved),0)/ct).toFixed(1)+"",i.jsxs("main",{className:"obe-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[i.jsx("header",{style:{marginBottom:32,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:i.jsx("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",width:"100%"},children:i.jsxs("div",{style:{textAlign:"left"},children:[i.jsx("h1",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:"Outcome Based Education (OBE)"}),i.jsx("div",{style:{marginTop:8,color:"#64748b",fontSize:16,fontWeight:400},children:"Select a course, then work through CDAP, Articulation Matrix and Mark Entry."})]})})}),i.jsxs("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)"},children:[i.jsx("button",{onClick:()=>n("courses"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="courses"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="courses"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="courses"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="courses"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Courses"}),i.jsx("button",{onClick:()=>n("exam"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="exam"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="exam"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="exam"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="exam"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Exam Management"})]}),r==="courses"&&i.jsxs("section",{"aria-label":"Course selector",style:{marginBottom:32},children:[i.jsx("div",{style:{fontSize:14,color:"#475569",marginBottom:20,fontWeight:500},children:"Select a course to work on:"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:24,marginBottom:32},children:c?i.jsx("div",{style:{gridColumn:"1/-1",color:"#64748b",fontSize:16,textAlign:"center",padding:60,background:"#fff",borderRadius:12},children:" Loading courses"}):o.length===0?i.jsxs("div",{style:{gridColumn:"1/-1",color:"#94a3b8",fontSize:18,textAlign:"center",padding:60,background:"#fff",borderRadius:12,border:"2px dashed #e2e8f0"},children:[" No courses found. You have no teaching assignments.",i.jsx("br",{}),i.jsx("span",{style:{fontSize:14,marginTop:12,display:"block"},children:"(If you expect to see courses here, please check with your backend/API or contact admin.)"})]}):o.reduce((Se,Te)=>(Se.some(Dt=>Dt.subject_code===Te.subject_code)||Se.push(Te),Se),[]).map(Se=>i.jsxs("div",{onClick:()=>ke(Se.subject_code),role:"button",tabIndex:0,onKeyDown:Te=>{Te.key==="Enter"&&ke(Se.subject_code)},onMouseEnter:Te=>{Te.currentTarget.style.transform="translateY(-4px)",Te.currentTarget.style.boxShadow="0 12px 24px rgba(0,0,0,0.1), 0 4px 8px rgba(0,0,0,0.06)",Te.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:Te=>{Te.currentTarget.style.transform="translateY(0)",Te.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",Te.currentTarget.style.borderColor="#e2e8f0"},style:{border:"1px solid #e2e8f0",borderRadius:12,padding:24,background:"#fff",boxShadow:"0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"flex-start",minHeight:140,position:"relative",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer"},children:[i.jsx("div",{style:{fontWeight:700,fontSize:19,marginBottom:6,color:"#0f172a",lineHeight:1.3},children:Se.subject_name}),i.jsx("div",{style:{fontSize:14,color:"#3b82f6",marginBottom:16,fontWeight:600,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:Se.subject_code}),i.jsxs("div",{style:{marginTop:"auto",display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"},children:[i.jsx("button",{onClick:Te=>{Te.stopPropagation(),ke(Se.subject_code)},onMouseEnter:Te=>{Te.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)",Te.currentTarget.style.transform="scale(1.05)"},onMouseLeave:Te=>{Te.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",Te.currentTarget.style.transform="scale(1)"},style:{padding:"8px 18px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:"0 2px 4px rgba(37,99,235,0.2)",transition:"all 0.2s ease"},children:"Open Course"}),i.jsx("button",{onClick:Te=>{Te.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(Se.subject_code)}/lca`},onMouseEnter:Te=>{Te.currentTarget.style.background="#f8fafc",Te.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:Te=>{Te.currentTarget.style.background="#fff",Te.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"LCA"}),i.jsx("button",{onClick:Te=>{Te.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(Se.subject_code)}/co_attainment`},onMouseEnter:Te=>{Te.currentTarget.style.background="#f8fafc",Te.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:Te=>{Te.currentTarget.style.background="#fff",Te.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"CO"})]})]},Se.subject_code))})]}),r==="exam"&&i.jsx("section",{"aria-label":"Exam management",style:{background:"#fff",padding:28,borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:i.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[i.jsx("div",{style:{background:"#f8fafc",padding:20,borderRadius:12,border:"2px dashed #cbd5e1"},children:i.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center"},children:[i.jsx("input",{id:"exam-upload-input",type:"file",accept:".docx",style:{display:"none"},onChange:Se=>{const Te=Se.target.files&&Se.target.files[0];Te&&vt(Te),Se.currentTarget.value=""}}),i.jsx("label",{htmlFor:"exam-upload-input",style:{display:"inline-flex",alignItems:"center",gap:10,padding:"12px 20px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",borderRadius:10,cursor:"pointer",fontWeight:600,fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:Ie==="uploading"?" Uploading...":" Upload .docx"}),i.jsx("div",{style:{color:"#64748b",fontSize:14},children:"Upload exam spreadsheets or related files here."})]})}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[i.jsx("input",{type:"search",placeholder:" Search exams, courses, entries...",style:{flex:1,padding:"12px 16px",borderRadius:10,border:"1px solid #e2e8f0",fontSize:15,background:"#fff",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},onChange:()=>{}}),i.jsx("button",{style:{padding:"12px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#475569",transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:"Search"})]}),i.jsxs("div",{style:{marginTop:8},children:[i.jsx("h3",{style:{margin:"12px 0 16px 0",fontSize:18,fontWeight:700,color:"#0f172a"},children:" Recent"}),E.length===0?i.jsxs("div",{style:{color:"#666"},children:[i.jsx("div",{style:{marginBottom:8,fontSize:13},children:"Uploaded DOCX files"}),X.length===0?i.jsx("div",{style:{color:"#666"},children:"No uploaded DOCX files found."}):i.jsx("div",{style:{display:"grid",gap:8},children:X.map((Se,Te)=>i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:700},children:Se.name}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:Se.path})]}),i.jsx("div",{children:i.jsx("button",{onClick:()=>Y(Se),style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",padding:6},children:"Open"})})]},Te))})]}):i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr",gap:12},children:[i.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:E.slice(0,12).map((Se,Te)=>{const Dt=Te===ee;return i.jsxs("div",{onClick:()=>z(Te),role:"button",tabIndex:0,style:{border:Dt?"2px solid #2563eb":"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[i.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[i.jsx("path",{d:"M6 2h7l5 5v13a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1z",fill:"#e6f0ff",stroke:"#2563eb",strokeWidth:"0.5"}),i.jsx("path",{d:"M13 2v6h6",fill:"#fff"}),i.jsx("rect",{x:"7",y:"11",width:"10",height:"2.2",rx:"0.6",fill:"#2563eb"}),i.jsx("rect",{x:"7",y:"14",width:"6",height:"2.2",rx:"0.6",fill:"#2563eb"}),i.jsx("text",{x:"7",y:"18.8",fontSize:"2.8",fill:"#2563eb",fontFamily:"Arial, Helvetica, sans-serif",children:"DOCX"})]}),i.jsx("div",{style:{fontWeight:700},children:Se.title})]}),i.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[Se.exam_type||"","  ",Se.exam_date||""]})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsx("div",{style:{fontWeight:800,color:"#16a34a"},children:Se.inserted}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"questions"})]})]},Te)})}),i.jsx("div",{children:E[ee]&&i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Preview"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[i.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:a!=null&&a.username?String(a.username).slice(0,1).toUpperCase():"U"}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(a==null?void 0:a.username)||""}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),i.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",i.jsx("strong",{style:{color:"#111827"},children:he??""})]})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Course details"}),i.jsx("div",{style:{fontWeight:700},children:""}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""}),i.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:["Assignments: ",i.jsx("strong",{style:{color:"#111827"},children:""})]})]})]}),i.jsxs("div",{children:[i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Questions imported"}),i.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:E[ee].inserted})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Title"}),i.jsx("div",{style:{fontWeight:700},children:E[ee].title||""}),i.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Assessment"}),i.jsx("div",{style:{fontWeight:700},children:E[ee].exam_type||""})]})]}),i.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[i.jsxs("div",{children:[i.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam Type"}),i.jsx("div",{style:{fontWeight:700},children:E[ee].exam_type||""})]}),i.jsxs("div",{children:[i.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam date"}),i.jsx("div",{style:{fontWeight:700},children:E[ee].exam_date||""})]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Uploaded file"}),i.jsx("div",{style:{fontWeight:700,whiteSpace:"pre-wrap"},children:E[ee].source_file_path||""})]})]})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Questions preview"}),i.jsx("div",{children:i.jsx("button",{onClick:async()=>{var Se,Te;U(null);try{const Dt=(Se=E[ee])==null?void 0:Se.title_id;let wt="";Dt?wt=`${Ap}/api/import/questions/list?title_id=${Dt}`:wt=`${Ap}/api/import/questions/list?title=${encodeURIComponent(((Te=E[ee])==null?void 0:Te.title)||"")}`;const Pt=await fetch(wt,{headers:{...Yg()}});if(!Pt.ok){U([]);return}const Wt=await Pt.json();U(Array.isArray(Wt==null?void 0:Wt.questions)?Wt.questions:[])}catch{U([])}},style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Load questions"})})]}),i.jsx("div",{style:{maxHeight:220,overflow:"auto"},children:L===null?i.jsx("div",{style:{color:"#6b7280"},children:'Click "Load questions" to fetch saved questions for this import.'}):L.length===0?i.jsx("div",{style:{color:"#6b7280"},children:"No saved questions found for this title."}):L.slice(0,20).map((Se,Te)=>i.jsxs("div",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:[i.jsxs("div",{style:{fontWeight:700,color:"#111827"},children:[Te+1,"."]}),i.jsx("div",{style:{color:"#111827"},children:String(Se.question_text).slice(0,300)})]},Te))})]})]})]})]})})]})]}),Qe&&i.jsx("div",{style:{marginTop:12,fontSize:14,color:Ie==="error"?"#dc2626":"#16a34a",background:Ie==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${Ie==="error"?"#fecaca":"#bbf7d0"}`},children:Qe})]})}),d&&i.jsx("div",{role:"dialog","aria-modal":"true",onClick:Xe,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:i.jsxs("div",{onClick:Se=>Se.stopPropagation(),style:{width:"min(1000px, 100%)",background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.3)",overflow:"hidden",border:"1px solid #e2e8f0"},children:[i.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#0f172a"},children:" Question Import"}),i.jsxs("div",{style:{color:"#64748b",fontSize:14,marginTop:4},children:["Step ",p," of 3  ",m==="scanning"?"Scanning":m==="error"?"Scan failed":"Ready"]})]}),i.jsx("button",{onClick:Xe,onMouseEnter:Se=>{Se.currentTarget.style.background="#fee2e2"},onMouseLeave:Se=>{Se.currentTarget.style.background="#fff"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#64748b",transition:"all 0.2s ease"},children:" Close"})]}),i.jsx("div",{style:{overflow:"hidden",background:"#fafbfc"},children:i.jsxs("div",{style:{display:"flex",width:"300%",transform:`translateX(-${(p-1)*33.3333333}%)`,transition:"transform 360ms cubic-bezier(0.4, 0, 0.2, 1)"},children:[i.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[i.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,marginBottom:16},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#0f172a"},children:" Preview"}),i.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:_?`Source: ${_}`:"Source: (not available)"})]}),i.jsxs("div",{style:{fontSize:14,color:"#0f172a",background:"#eff6ff",padding:"6px 12px",borderRadius:8,fontWeight:600},children:["Questions: ",i.jsx("b",{style:{color:"#3b82f6"},children:qe.length})]})]}),b&&i.jsx("div",{style:{marginBottom:12,fontSize:14,color:m==="error"?"#dc2626":"#16a34a",background:m==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${m==="error"?"#fecaca":"#bbf7d0"}`},children:b}),i.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,maxHeight:420,overflow:"auto",background:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[m==="scanning"&&i.jsx("div",{style:{color:"#64748b",textAlign:"center",padding:40},children:" Scanning your DOCX"}),m!=="scanning"&&qe.length===0&&i.jsx("div",{style:{color:"#94a3b8",textAlign:"center",padding:40},children:" No questions to preview yet."}),qe.map((Se,Te)=>i.jsxs("div",{style:{padding:"14px 12px",borderBottom:Te<qe.length-1?"1px solid #f1f5f9":"none"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10,marginBottom:8},children:[i.jsxs("div",{style:{fontWeight:700,color:"#3b82f6",fontSize:15,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:["Q",Te+1]}),i.jsxs("div",{style:{fontSize:12,color:"#64748b",background:"#f8fafc",padding:"4px 10px",borderRadius:6},children:["Marks: ",String((Se==null?void 0:Se.marks)??"-")," "," BTL: ",String((Se==null?void 0:Se.btl)??"-")," "," CO: ",String((Se==null?void 0:Se.course_outcomes)??"-")]})]}),i.jsxs("div",{style:{marginTop:8,color:"#1e293b",whiteSpace:"pre-wrap",fontSize:14,lineHeight:1.6},children:[String((Se==null?void 0:Se.question_text)??"").slice(0,500),String((Se==null?void 0:Se.question_text)??"").length>500?"":""]}),Array.isArray(Se==null?void 0:Se.images)&&Se.images.length?i.jsx("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:Se.images.slice(0,4).map((Dt,wt)=>{const Pt=ae(Dt);return Pt?i.jsx("img",{src:Pt,alt:`q${Te+1}-img${wt+1}`,onClick:()=>W(Pt),style:{maxHeight:140,borderRadius:10,border:"2px solid #e2e8f0",cursor:"pointer",objectFit:"contain",background:"#fff",transition:"all 0.2s ease",boxShadow:"0 2px 6px rgba(0,0,0,0.08)"}},wt):null})}):null]},Te))]})]}),i.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Save details"}),de&&i.jsx("div",{style:{marginBottom:12,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:de}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam name"}),i.jsx("input",{value:j,onChange:Se=>A(Se.target.value),placeholder:"e.g., Unit 1 - Introduction",style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",boxShadow:"inset 0 1px 2px #00000008"}})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam (CIA / Model / ESE)"}),i.jsxs("select",{value:M,onChange:Se=>P(Se.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[i.jsx("option",{value:"",children:"Select assessment"}),i.jsx("option",{value:"CIA1",children:"CIA1"}),i.jsx("option",{value:"CIA2",children:"CIA2"}),i.jsx("option",{value:"MODEL",children:"MODEL"}),i.jsx("option",{value:"ESE",children:"ESE"})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam Type"}),i.jsxs("select",{value:R,onChange:Se=>N(Se.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[i.jsx("option",{value:"",children:"Select paper"}),i.jsx("option",{value:"QP1",children:"QP1"}),i.jsx("option",{value:"QP2",children:"QP2"})]})]}),i.jsxs("div",{children:[i.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam date"}),i.jsx("input",{type:"date",value:T,onChange:Se=>B(Se.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8"}})]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Sections"}),i.jsx("textarea",{value:G,onChange:Se=>re(Se.target.value),placeholder:"e.g., Part A\\nPart B\\nSection 1",rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",resize:"vertical"}})]})]}),i.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"This metadata is shown for confirmation. (Currently, only the exam name is used as the imported title.)"})]}),i.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Confirmation"}),i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:16},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[i.jsx("div",{style:{width:64,height:64,borderRadius:10,background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#3b82f6",fontSize:24},children:a!=null&&a.username?String(a.username).slice(0,1).toUpperCase():""}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#0f172a"},children:(a==null?void 0:a.username)||""}),i.jsx("div",{style:{fontSize:13,color:"#64748b"},children:"Faculty"})]})]}),i.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569",background:"#f8fafc",padding:"8px 12px",borderRadius:8},children:["Faculty ID: ",i.jsx("strong",{style:{color:"#0f172a"},children:he??""})]})]}),i.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsx("div",{style:{fontSize:13,color:"#64748b",marginBottom:10,fontWeight:600},children:" Course details"}),i.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:""}),i.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:""}),i.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569"},children:["Assignments: ",i.jsx("strong",{style:{color:"#0f172a"},children:""})]})]})]}),i.jsxs("div",{children:[i.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:16,flexWrap:"wrap"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Questions to import"}),i.jsx("div",{style:{fontSize:28,fontWeight:900,color:"#3b82f6",marginTop:4},children:qe.length})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Exam name"}),i.jsx("div",{style:{fontWeight:700,color:"#0f172a",fontSize:16,marginTop:2},children:j||""}),i.jsx("div",{style:{marginTop:8,fontSize:13,color:"#64748b",fontWeight:600},children:"Assessment"}),i.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:2},children:M||""})]})]}),i.jsxs("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,background:"#f8fafc",padding:12,borderRadius:8},children:[i.jsxs("div",{children:[i.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam Type"}),i.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:R||""})]}),i.jsxs("div",{children:[i.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam date"}),i.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:T||""})]}),i.jsxs("div",{style:{gridColumn:"1 / -1"},children:[i.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Sections"}),i.jsx("div",{style:{fontWeight:700,color:"#0f172a",whiteSpace:"pre-wrap",marginTop:4},children:G||""})]})]})]}),i.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[i.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:10,fontWeight:600},children:" Questions preview"}),i.jsx("div",{style:{maxHeight:240,overflow:"auto"},children:qe.slice(0,10).map((Se,Te)=>i.jsxs("div",{style:{padding:"10px 8px",borderBottom:Te<Math.min(qe.length,10)-1?"1px solid #f1f5f9":"none",display:"flex",gap:12,alignItems:"flex-start"},children:[i.jsx("div",{style:{fontWeight:700,color:"#3b82f6",minWidth:40,background:"#eff6ff",padding:"4px 8px",borderRadius:6,textAlign:"center"},children:Te+1}),i.jsxs("div",{style:{flex:1},children:[i.jsx("div",{style:{color:"#1e293b",fontSize:14,lineHeight:1.5},children:String(Se.question_text).slice(0,260)}),Array.isArray(Se.images)&&Se.images.length?i.jsx("div",{style:{display:"flex",gap:10,marginTop:8},children:Se.images.slice(0,2).map((Dt,wt)=>{const Pt=ae(Dt);return Pt?i.jsx("img",{src:Pt,style:{width:90,height:70,objectFit:"cover",borderRadius:8,border:"2px solid #e2e8f0",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>W(Pt)},wt):null})}):null]})]},Te))})]})]})]}),de&&i.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:[" ",de]}),V&&i.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#16a34a",background:"#f0fdf4",padding:"12px 16px",borderRadius:10,border:"1px solid #bbf7d0"},children:[" Imported ",V.inserted," question(s)",(nt=V.failed)!=null&&nt.length?`, failed ${V.failed.length}.`:"."]})]})]})}),i.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,background:"#fafbfc"},children:[i.jsx("button",{onClick:()=>h(Se=>Se===1?1:Se-1),disabled:p===1,onMouseEnter:Se=>{p!==1&&(Se.currentTarget.style.background="#f8fafc")},onMouseLeave:Se=>{p!==1&&(Se.currentTarget.style.background="#fff")},style:{padding:"10px 18px",borderRadius:10,border:"1px solid #e2e8f0",background:p===1?"#f1f5f9":"#fff",cursor:p===1?"not-allowed":"pointer",fontWeight:600,fontSize:14,color:p===1?"#94a3b8":"#475569",transition:"all 0.2s ease"},children:" Back"}),i.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:p<3?i.jsx("button",{onClick:()=>{if(ne(null),p===2){if(!j.trim()){ne("Exam name is required.");return}if(!R.trim()){ne("Exam type is required.");return}if(!T.trim()){ne("Exam date is required.");return}}h(Se=>Se+1)},disabled:p===1&&m==="scanning",onMouseEnter:Se=>{p===1&&m==="scanning"||(Se.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)")},onMouseLeave:Se=>{p===1&&m==="scanning"||(Se.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:700,cursor:"pointer",fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:"Next "}):i.jsx("button",{onClick:Be,disabled:xe||m==="scanning"||qe.length===0,onMouseEnter:Se=>{!xe&&m!=="scanning"&&qe.length>0&&(Se.currentTarget.style.background="linear-gradient(135deg, #15803d 0%, #166534 100%)")},onMouseLeave:Se=>{!xe&&m!=="scanning"&&qe.length>0&&(Se.currentTarget.style.background="linear-gradient(135deg, #16a34a 0%, #15803d 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:xe?"#cbd5e1":"linear-gradient(135deg, #16a34a 0%, #15803d 100%)",color:"#fff",fontWeight:800,fontSize:15,cursor:xe?"not-allowed":"pointer",boxShadow:xe?"none":"0 2px 8px rgba(22,163,74,0.25)",transition:"all 0.2s ease"},children:xe?" Importing":" Confirm & Import"})})]})]})}),ce&&i.jsx("div",{role:"dialog",onClick:()=>{W(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80},children:i.jsx("div",{onClick:Se=>Se.stopPropagation(),style:{maxWidth:"95%",maxHeight:"95%",padding:16,background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.5)"},children:i.jsx("img",{src:ce,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:12}})})}),q&&i.jsx("div",{role:"dialog",onClick:()=>{Y(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80,padding:16},children:i.jsxs("div",{onClick:Se=>Se.stopPropagation(),style:{width:"min(900px, 100%)",background:"#fff",borderRadius:12,boxShadow:"0 12px 40px rgba(0,0,0,0.25)",overflow:"hidden",border:"1px solid #e5e7eb"},children:[i.jsxs("div",{style:{padding:"14px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:800,fontSize:16},children:"Uploaded file preview"}),i.jsxs("div",{style:{color:"#6b7280",fontSize:12},children:["Preview of uploaded DOCX  ",q.name]})]}),i.jsx("button",{onClick:()=>Y(null),style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Close"})]}),i.jsx("div",{style:{padding:16},children:i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:12},children:[i.jsxs("div",{children:[i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[i.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:a!=null&&a.username?String(a.username).slice(0,1).toUpperCase():"U"}),i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(a==null?void 0:a.username)||""}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),i.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",i.jsx("strong",{style:{color:"#111827"},children:he??""})]})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"File details"}),i.jsx("div",{style:{fontWeight:700},children:q.name}),i.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:q.path}),i.jsx("div",{style:{marginTop:8},children:i.jsx("a",{href:q.url,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:"Download file"})})]})]}),i.jsxs("div",{children:[i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded file"}),i.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:q.name})]}),i.jsxs("div",{style:{textAlign:"right"},children:[i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded path"}),i.jsx("div",{style:{fontWeight:700},children:q.path})]})]}),i.jsx("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr",gap:10},children:i.jsxs("div",{children:[i.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Notes"}),i.jsx("div",{style:{fontWeight:700},children:"This preview shows file metadata. Open the file to view full content or import to parse questions."})]})})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Importer preview"}),i.jsx("div",{style:{maxHeight:260,overflow:"auto"},children:i.jsx("div",{style:{color:"#6b7280"},children:"To see a full questions preview, upload and scan this DOCX using the importer  then the Step 3 confirmation contains the parsed question list."})})]})]})]})})]})}),H&&i.jsx("div",{style:{position:"fixed",left:24,bottom:24,zIndex:120,animation:"slideIn 0.3s ease"},children:i.jsxs("div",{style:{background:"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)",color:"#065f46",border:"1px solid #6ee7b7",padding:"16px 20px",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:[i.jsx("div",{style:{fontWeight:800,fontSize:16,marginBottom:4},children:" Imported"}),i.jsxs("div",{style:{fontSize:14,color:"#047857"},children:[(V==null?void 0:V.inserted)??0," question(s) imported successfully."]})]})})]})}const Tu=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function xm(e){let t=0,r=0;for(const n of e||[]){const a=Number(n.max||0);n.co==="1&2"?(t+=a/2,r+=a/2):n.co===2?r+=a:t+=a}return{co1:t,co2:r}}function L1(e){const t={1:0,2:0,3:0,4:0,5:0,6:0};for(const r of e||[]){const n=String(r.btl);n in t&&(t[n]+=Number(r.max||0))}return t}function dv(e){var d,f;const t=xm(e.prevQuestions),r=xm(e.nextQuestions),n=L1(e.prevQuestions),a=L1(e.nextQuestions),s=Number((d=e.existingCoMax)==null?void 0:d.co1),o=Number((f=e.existingCoMax)==null?void 0:f.co2),l=!Number.isFinite(s)||s===t.co1?r.co1:Math.max(0,s),c=!Number.isFinite(o)||o===t.co2?r.co2:Math.max(0,o),u={...a};return["1","2","3","4","5","6"].forEach(p=>{var m;const h=Number((m=e.existingBtlMax)==null?void 0:m[p]);Number.isFinite(h)&&h!==n[p]&&(u[p]=Math.max(0,h))}),{coMax:{co1:l,co2:c},btlMax:u}}const oj={termLabel:"KRCT AY25-26",assessments:{ssa1:{maxTotal:20,coMax:{co1:10,co2:10},btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},formative1:{maxPart:5,maxTotal:20,maxCo:10,btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},cia1:{questions:Tu,coMax:xm(Tu),btlMax:L1(Tu)}}},IPe=Array.from({length:11},(e,t)=>`PO${t+1}`);function DPe(e,t){const r=Ef(t),n=e==null?void 0:e[r];return Array.isArray(n)&&n.length===11?n:Array.from({length:11},()=>!1)}function $Pe(){var M,P,R,N,T,B,G,re,xe,_e,V,K,de,ne,E,Z,H,F,ee,z;const[e,t]=x.useState({}),[r,n]=x.useState(oj),[a,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState("assessments"),[d,f]=x.useState({}),[p,h]=x.useState(""),[m,g]=x.useState(""),[b,y]=x.useState("");x.useEffect(()=>{let X=!0;return(async()=>{try{const J=await y9();X&&t(J||{})}catch(J){X&&l((J==null?void 0:J.message)||"Failed to load global mapping")}})(),()=>{X=!1}},[]),x.useEffect(()=>{let X=!0;return(async()=>{var J,q,Y,L,U,ce,W;try{const ae=await iu();if(!X)return;const he={...oj,...ae||{},assessments:{...oj.assessments||{},...(ae==null?void 0:ae.assessments)||{}}},ze=((q=(J=he.assessments)==null?void 0:J.cia1)==null?void 0:q.questions)||[],ke=Array.isArray(ze)&&ze.length?ze:Tu,qe=xm(ke),Ie=L1(ke),Ve=(L=(Y=he.assessments)==null?void 0:Y.cia1)==null?void 0:L.coMax,Qe=Number(Ve==null?void 0:Ve.co1),Tt=Number(Ve==null?void 0:Ve.co2),vt=(ce=(U=he.assessments)==null?void 0:U.cia1)==null?void 0:ce.btlMax,Xe=Be=>{const ct=Number(vt==null?void 0:vt[Be]);return Number.isFinite(ct)?Math.max(0,ct):Ie[Be]};he.assessments={...he.assessments||{},cia1:{...((W=he.assessments)==null?void 0:W.cia1)||{},questions:ke,coMax:{co1:Number.isFinite(Qe)?Math.max(0,Qe):qe.co1,co2:Number.isFinite(Tt)?Math.max(0,Tt):qe.co2},btlMax:{1:Xe("1"),2:Xe("2"),3:Xe("3"),4:Xe("4"),5:Xe("5"),6:Xe("6")}}},n(he)}catch(ae){X&&l((ae==null?void 0:ae.message)||"Failed to load assessment master config")}})(),()=>{X=!1}},[]);const v=x.useMemo(()=>Q4.map(X=>({label:X,key:Ef(X),values:DPe(e,X)})),[e]),w=(X,J,q)=>{const Y=Ef(X);t(L=>{const U=Array.isArray(L==null?void 0:L[Y])?[...L[Y]]:Array.from({length:11},()=>!1);return U[J]=q,{...L,[Y]:U}})},_=async()=>{s(!0),l(null);try{c==="po"?(await Pre(e),l("Saved global mapping.")):(await Ore(r),l("Saved assessment master config."))}catch(X){l((X==null?void 0:X.message)||"Failed to save global mapping")}finally{s(!1)}},C=x.useMemo(()=>{var J,q;const X=(q=(J=r==null?void 0:r.assessments)==null?void 0:J.cia1)==null?void 0:q.questions;return Array.isArray(X)&&X.length?X:Tu},[r]),j=x.useMemo(()=>C.filter(X=>d[X.key]),[C,d]),A=()=>{j.length&&n(X=>{var L,U,ce,W,ae,he,ze;const J=(((U=(L=X.assessments)==null?void 0:L.cia1)==null?void 0:U.questions)||Tu).slice(),q=J.map(ke=>{if(!d[ke.key])return ke;const qe={...ke};return p!==""&&Number.isFinite(Number(p))&&(qe.max=Math.max(0,Number(p))),(m==="1"||m==="2")&&(qe.co=Number(m)),m==="1&2"&&(qe.co="1&2"),b&&["1","2","3","4","5","6"].includes(b)&&(qe.btl=Number(b)),qe}),Y=dv({prevQuestions:J,nextQuestions:q,existingCoMax:(W=(ce=X.assessments)==null?void 0:ce.cia1)==null?void 0:W.coMax,existingBtlMax:(he=(ae=X.assessments)==null?void 0:ae.cia1)==null?void 0:he.btlMax});return{...X,assessments:{...X.assessments||{},cia1:{...((ze=X.assessments)==null?void 0:ze.cia1)||{},questions:q,coMax:Y.coMax,btlMax:Y.btlMax}}}})};return i.jsx("main",{className:"obe-master-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:i.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[i.jsxs("div",{style:{marginBottom:16},children:[i.jsx("h2",{style:{margin:0},children:"OBE Master"}),i.jsx("div",{style:{color:"#666",marginTop:4},children:"Global settings for OBE pages"})]}),i.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"},children:[i.jsx("button",{onClick:()=>u("assessments"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="assessments"?"#111827":"#fff",color:c==="assessments"?"#fff":"#111827"},children:"Assessment Headers"}),i.jsx("button",{onClick:()=>u("po"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="po"?"#111827":"#fff",color:c==="po"?"#fff":"#111827"},children:"Active Learning PO Mapping"})]}),o&&i.jsx("div",{style:{marginBottom:12,fontSize:12,color:o.startsWith("Saved")?"#166534":"#b91c1c"},children:o}),c==="po"?i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"left",background:"#f8fafc"},children:"Activity"}),IPe.map(X=>i.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"center",background:"#fff7ed"},children:X},X))]})}),i.jsx("tbody",{children:v.map((X,J)=>i.jsxs("tr",{style:{background:J%2===0?"#fff":"#f9fafb"},children:[i.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,fontWeight:600},children:X.label}),X.values.map((q,Y)=>i.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:i.jsx("input",{type:"checkbox",checked:!!q,onChange:L=>w(X.label,Y,L.target.checked)})},`${X.key}-${Y}`))]},X.key))})]})}):i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Global Term Label"}),i.jsx("input",{value:r.termLabel??"",onChange:X=>n(J=>({...J,termLabel:X.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db",width:260}})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"SSA1 Headers"}),i.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[i.jsxs("label",{style:{fontSize:12},children:["Total Max",i.jsx("input",{type:"number",value:String(((P=(M=r.assessments)==null?void 0:M.ssa1)==null?void 0:P.maxTotal)??20),onChange:X=>n(J=>{var q;return{...J,assessments:{...J.assessments||{},ssa1:{...((q=J.assessments)==null?void 0:q.ssa1)||{},maxTotal:Number(X.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),i.jsxs("label",{style:{fontSize:12},children:["CO1 Max",i.jsx("input",{type:"number",value:String(((T=(N=(R=r.assessments)==null?void 0:R.ssa1)==null?void 0:N.coMax)==null?void 0:T.co1)??10),onChange:X=>n(J=>{var q,Y,L;return{...J,assessments:{...J.assessments||{},ssa1:{...((q=J.assessments)==null?void 0:q.ssa1)||{},coMax:{...((L=(Y=J.assessments)==null?void 0:Y.ssa1)==null?void 0:L.coMax)||{},co1:Number(X.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),i.jsxs("label",{style:{fontSize:12},children:["CO2 Max",i.jsx("input",{type:"number",value:String(((re=(G=(B=r.assessments)==null?void 0:B.ssa1)==null?void 0:G.coMax)==null?void 0:re.co2)??10),onChange:X=>n(J=>{var q,Y,L;return{...J,assessments:{...J.assessments||{},ssa1:{...((q=J.assessments)==null?void 0:q.ssa1)||{},coMax:{...((L=(Y=J.assessments)==null?void 0:Y.ssa1)==null?void 0:L.coMax)||{},co2:Number(X.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Formative 1 Headers"}),i.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[i.jsxs("label",{style:{fontSize:12},children:["Part Max",i.jsx("input",{type:"number",value:String(((_e=(xe=r.assessments)==null?void 0:xe.formative1)==null?void 0:_e.maxPart)??5),onChange:X=>n(J=>{var q;return{...J,assessments:{...J.assessments||{},formative1:{...((q=J.assessments)==null?void 0:q.formative1)||{},maxPart:Number(X.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),i.jsxs("label",{style:{fontSize:12},children:["Total Max",i.jsx("input",{type:"number",value:String(((K=(V=r.assessments)==null?void 0:V.formative1)==null?void 0:K.maxTotal)??20),onChange:X=>n(J=>{var q;return{...J,assessments:{...J.assessments||{},formative1:{...((q=J.assessments)==null?void 0:q.formative1)||{},maxTotal:Number(X.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),i.jsxs("label",{style:{fontSize:12},children:["CO Max",i.jsx("input",{type:"number",value:String(((ne=(de=r.assessments)==null?void 0:de.formative1)==null?void 0:ne.maxCo)??10),onChange:X=>n(J=>{var q;return{...J,assessments:{...J.assessments||{},formative1:{...((q=J.assessments)==null?void 0:q.formative1)||{},maxCo:Number(X.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i.jsx("div",{style:{fontWeight:800,marginBottom:10},children:"CIA 1"}),i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"stretch",marginBottom:12},children:[i.jsxs("div",{style:{flex:"1 1 360px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fbfdff"},children:[i.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"CIA1 Limits"}),i.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:10},children:[i.jsxs("label",{style:{fontSize:12},children:["CO-1 Max",i.jsx("input",{type:"number",value:String(((H=(Z=(E=r.assessments)==null?void 0:E.cia1)==null?void 0:Z.coMax)==null?void 0:H.co1)??xm(C).co1),onChange:X=>n(J=>{var q,Y,L;return{...J,assessments:{...J.assessments||{},cia1:{...((q=J.assessments)==null?void 0:q.cia1)||{},coMax:{...(L=(Y=J.assessments)==null?void 0:Y.cia1)==null?void 0:L.coMax,co1:Math.max(0,Number(X.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]}),i.jsxs("label",{style:{fontSize:12},children:["CO-2 Max",i.jsx("input",{type:"number",value:String(((z=(ee=(F=r.assessments)==null?void 0:F.cia1)==null?void 0:ee.coMax)==null?void 0:z.co2)??xm(C).co2),onChange:X=>n(J=>{var q,Y,L;return{...J,assessments:{...J.assessments||{},cia1:{...((q=J.assessments)==null?void 0:q.cia1)||{},coMax:{...(L=(Y=J.assessments)==null?void 0:Y.cia1)==null?void 0:L.coMax,co2:Math.max(0,Number(X.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]})]}),i.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"BTL Max Marks (1 to 6)"}),i.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, minmax(70px, 1fr))",gap:8},children:["1","2","3","4","5","6"].map(X=>{var J,q,Y;return i.jsxs("label",{style:{fontSize:12,display:"flex",flexDirection:"column",gap:4},children:[i.jsxs("span",{style:{color:"#111827"},children:["BTL-",X]}),i.jsx("input",{type:"number",value:String(((Y=(q=(J=r.assessments)==null?void 0:J.cia1)==null?void 0:q.btlMax)==null?void 0:Y[X])??L1(C)[X]),onChange:L=>n(U=>{var ce,W,ae;return{...U,assessments:{...U.assessments||{},cia1:{...((ce=U.assessments)==null?void 0:ce.cia1)||{},btlMax:{...((ae=(W=U.assessments)==null?void 0:W.cia1)==null?void 0:ae.btlMax)||{},[X]:Math.max(0,Number(L.target.value||0))}}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",textAlign:"center"}})]},X)})})]}),i.jsxs("div",{style:{flex:"2 1 520px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fff"},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx("div",{style:{fontWeight:700},children:"CIA1 Question Headers"}),i.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Select question rows and apply Max / CO / BTL in bulk."})]}),i.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[i.jsx("input",{placeholder:"Max",value:p,onChange:X=>h(X.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}}),i.jsxs("select",{value:m,onChange:X=>g(X.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[i.jsx("option",{value:"",children:"CO"}),i.jsx("option",{value:"1",children:"CO-1"}),i.jsx("option",{value:"2",children:"CO-2"}),i.jsx("option",{value:"1&2",children:"CO-1&CO-2 (split)"})]}),i.jsxs("select",{value:b,onChange:X=>y(X.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[i.jsx("option",{value:"",children:"BTL"}),[1,2,3,4,5,6].map(X=>i.jsxs("option",{value:String(X),children:["BTL-",X]},X))]}),i.jsxs("button",{onClick:A,disabled:!j.length,style:{padding:"8px 10px"},children:["Apply to Selected (",j.length,")"]})]})]}),i.jsx("div",{style:{overflowX:"auto",marginTop:10,border:"1px solid #e5e7eb",borderRadius:10},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:720},children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Sel"}),i.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Key"}),i.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Label"}),i.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Max"}),i.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"CO"}),i.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"BTL"})]})}),i.jsx("tbody",{children:C.map((X,J)=>i.jsxs("tr",{style:{background:J%2===0?"#fff":"#f9fafb"},children:[i.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:i.jsx("input",{type:"checkbox",checked:!!d[X.key],onChange:q=>f(Y=>({...Y,[X.key]:q.target.checked}))})}),i.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:X.key}),i.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:i.jsx("input",{value:X.label,onChange:q=>n(Y=>{var ce,W,ae;const U=(((W=(ce=Y.assessments)==null?void 0:ce.cia1)==null?void 0:W.questions)||Tu).slice().map(he=>he.key===X.key?{...he,label:q.target.value}:he);return{...Y,assessments:{...Y.assessments||{},cia1:{...((ae=Y.assessments)==null?void 0:ae.cia1)||{},questions:U}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:"100%"}})}),i.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:i.jsx("input",{type:"number",value:String(X.max),onChange:q=>n(Y=>{var ae,he,ze,ke,qe,Ie,Ve;const L=Math.max(0,Number(q.target.value||0)),U=(((he=(ae=Y.assessments)==null?void 0:ae.cia1)==null?void 0:he.questions)||Tu).slice(),ce=U.map(Qe=>Qe.key===X.key?{...Qe,max:L}:Qe),W=dv({prevQuestions:U,nextQuestions:ce,existingCoMax:(ke=(ze=Y.assessments)==null?void 0:ze.cia1)==null?void 0:ke.coMax,existingBtlMax:(Ie=(qe=Y.assessments)==null?void 0:qe.cia1)==null?void 0:Ie.btlMax});return{...Y,assessments:{...Y.assessments||{},cia1:{...((Ve=Y.assessments)==null?void 0:Ve.cia1)||{},questions:ce,coMax:W.coMax,btlMax:W.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})}),i.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:i.jsxs("select",{value:String(X.co),onChange:q=>n(Y=>{var he,ze,ke,qe,Ie,Ve,Qe;const L=String(q.target.value),U=L==="1&2"?"1&2":Number(L)===2?2:1,ce=(((ze=(he=Y.assessments)==null?void 0:he.cia1)==null?void 0:ze.questions)||Tu).slice(),W=ce.map(Tt=>Tt.key===X.key?{...Tt,co:U}:Tt),ae=dv({prevQuestions:ce,nextQuestions:W,existingCoMax:(qe=(ke=Y.assessments)==null?void 0:ke.cia1)==null?void 0:qe.coMax,existingBtlMax:(Ve=(Ie=Y.assessments)==null?void 0:Ie.cia1)==null?void 0:Ve.btlMax});return{...Y,assessments:{...Y.assessments||{},cia1:{...((Qe=Y.assessments)==null?void 0:Qe.cia1)||{},questions:W,coMax:ae.coMax,btlMax:ae.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[i.jsx("option",{value:"1",children:"1"}),i.jsx("option",{value:"2",children:"2"}),i.jsx("option",{value:"1&2",children:"1&2"})]})}),i.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:i.jsx("select",{value:String(X.btl),onChange:q=>n(Y=>{var ae,he,ze,ke,qe,Ie,Ve;const L=Math.min(6,Math.max(1,Number(q.target.value||1))),U=(((he=(ae=Y.assessments)==null?void 0:ae.cia1)==null?void 0:he.questions)||Tu).slice(),ce=U.map(Qe=>Qe.key===X.key?{...Qe,btl:L}:Qe),W=dv({prevQuestions:U,nextQuestions:ce,existingCoMax:(ke=(ze=Y.assessments)==null?void 0:ze.cia1)==null?void 0:ke.coMax,existingBtlMax:(Ie=(qe=Y.assessments)==null?void 0:qe.cia1)==null?void 0:Ie.btlMax});return{...Y,assessments:{...Y.assessments||{},cia1:{...((Ve=Y.assessments)==null?void 0:Ve.cia1)||{},questions:ce,coMax:W.coMax,btlMax:W.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[1,2,3,4,5,6].map(q=>i.jsx("option",{value:String(q),children:q},q))})})]},X.key))})]})})]})]})]})]}),i.jsx("div",{style:{marginTop:16,display:"flex",gap:12},children:i.jsx("button",{onClick:_,disabled:a,style:{padding:"10px 14px",borderRadius:8,border:"1px solid #2563eb",background:"#2563eb",color:"#fff",fontWeight:600,cursor:"pointer"},children:a?"Saving...":c==="po"?"Save Global PO Mapping":"Save Assessment Headers"})})]})})}function UPe(){var u,d;const e=Xo(),r=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"obe",[n,a]=x.useState(r),s=((u=window.__APP_ME__)==null?void 0:u.permissions)||((d=window.__ME__)==null?void 0:d.permissions)||[],l=(Array.isArray(s)?s.map(f=>String(f||"").toLowerCase()):[]).includes("obe.master.manage"),c=x.useMemo(()=>{const f=[];return f.push({key:"obe",label:"OBE"}),l&&(f.push({key:"obe_master",label:"OBE Master"}),f.push({key:"due_dates",label:"OBE: Due Dates"})),f},[l]);return Zr.useEffect(()=>{var f;c.some(p=>p.key===n)||a(((f=c[0])==null?void 0:f.key)||"obe")},[c,n]),x.useEffect(()=>{const f=new URLSearchParams(e.search).get("tab");f&&c.some(p=>p.key===f)&&f!==n&&a(f)},[e.search]),i.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[i.jsxs("div",{style:{marginBottom:12},children:[i.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic"}),i.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"Quick access to OBE tools."})]}),i.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18},children:c.map(f=>i.jsx("button",{onClick:()=>a(f.key),style:{padding:"8px 12px",borderRadius:8,border:n===f.key?"1px solid #10b981":"1px solid #e5e7eb",background:n===f.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:f.label},f.key))}),i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[n==="obe"&&i.jsx(uK,{}),n==="obe_master"&&l&&i.jsx($Pe,{}),n==="due_dates"&&l&&i.jsx(lN,{})]})]})}const zPe="https://db.zynix.us",PR=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":zPe;function OR(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function WPe(){var P,R;const[e,t]=x.useState(null),[r,n]=x.useState(!1),[a,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(""),[p,h]=x.useState("pending"),[m,g]=x.useState(!1),[b,y]=x.useState(null),[v,w]=x.useState(null),[_,C]=x.useState(null),j=x.useMemo(()=>o.filter(N=>{const T=String(N.marks??"").trim().toUpperCase(),B=String(N.btl??"").trim().toUpperCase(),G=String(N.course_outcomes??"").trim().toUpperCase();return!(T==="(OR)"&&B==="(OR)"&&G==="(OR)")}),[o]);async function A(){if(!e){s("Please select a .docx file first.");return}n(!0),s(null),y(null),w(null);const N=new FormData;N.append("file",e);try{const T=await fetch(`${PR}/api/template/scan-docx`,{method:"POST",headers:{...OR()},body:N});if(!T.ok){const re=await T.text();s(re||`Scan failed (${T.status})`),l([]);return}const B=await T.json(),G=Array.isArray(B==null?void 0:B.questions)?B.questions:[];u((B==null?void 0:B.debug)??null);try{console.debug("scan_docx response: questions=",G.length,"sample=",G[0]?{q0:G[0].question_text,imgs:(G[0].images||[]).slice(0,2)}:null),G.length&&G.forEach((re,xe)=>{console.log(`Q#${xe+1} images:`,Array.isArray(re.images)?re.images.map(_e=>typeof _e=="string"?_e.slice(0,80):typeof _e):re.images)})}catch(re){console.warn("scan_docx debug log failed",re)}l(G)}catch(T){s((T==null?void 0:T.message)||"Scan failed"),l([])}finally{n(!1)}}async function M(){if(!d.trim()){w("Title is required to import.");return}g(!0),w(null),y(null);try{const N={title:d.trim(),status:p,questions:j},T=await fetch(`${PR}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...OR()},body:JSON.stringify(N)});if(!T.ok){const G=await T.text();w(G||`Import failed (${T.status})`);return}const B=await T.json();y(B)}catch(N){w((N==null?void 0:N.message)||"Import failed")}finally{g(!1)}}return i.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:24},children:[i.jsx("h1",{style:{marginTop:0},children:"Question Import"}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[i.jsx("input",{type:"file",accept:".docx",onChange:N=>{var T;return t(((T=N.target.files)==null?void 0:T[0])||null)}}),i.jsx("button",{onClick:A,disabled:r||!e,children:r?"Scanning":"Scan DOCX"}),i.jsx("div",{style:{color:"#666",fontSize:13},children:o.length?`${o.length} scanned (${j.length} visible)`:""})]}),a&&i.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:a}),c&&i.jsxs("div",{style:{marginTop:10,padding:10,background:"#f8fafc",border:"1px solid #e6eef8",borderRadius:8},children:[i.jsx("div",{style:{fontSize:13,color:"#0747a6",fontWeight:700},children:"Scan debug"}),i.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Questions parsed: ",c.parsed_questions??"-"]}),i.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Total images: ",c.total_images??0]}),i.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample questions: ",Array.isArray(c.sample_questions)?c.sample_questions.join(" | "):"-"]}),i.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample image prefix: ",i.jsx("code",{style:{background:"#fff",padding:"2px 6px",borderRadius:4},children:String(c.sample_image_prefix||"").slice(0,200)})]}),i.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["First questions' images (raw):",i.jsx("pre",{style:{whiteSpace:"pre-wrap",maxHeight:160,overflow:"auto",background:"#fff",padding:8,borderRadius:6},children:JSON.stringify(o.slice(0,3).map(N=>N.images),null,2)})]})]}),i.jsx("hr",{style:{margin:"20px 0"}}),i.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[i.jsx("input",{value:d,onChange:N=>f(N.target.value),placeholder:"Title (e.g., Midterm 2026)",style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6,minWidth:260}}),i.jsxs("select",{value:p,onChange:N=>h(N.target.value),style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6},children:[i.jsx("option",{value:"pending",children:"pending"}),i.jsx("option",{value:"approved",children:"approved"})]}),i.jsx("button",{onClick:M,disabled:m||j.length===0,children:m?"Importing":"Import to Bank"})]}),v&&i.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:v}),b&&i.jsxs("div",{style:{marginTop:10,color:"#166534"},children:["Imported ",b.inserted," question(s)",(P=b.failed)!=null&&P.length?`, ${b.failed.length} failed.`:"."]}),(R=b==null?void 0:b.failed)!=null&&R.length?i.jsxs("div",{style:{marginTop:10},children:[i.jsx("h3",{style:{margin:"10px 0"},children:"Failures"}),i.jsx("ul",{children:b.failed.map(N=>i.jsxs("li",{style:{color:"#b91c1c"},children:["#",N.index+1,": ",N.error]},N.index))})]}):null,i.jsx("hr",{style:{margin:"20px 0"}}),i.jsx("h2",{style:{margin:"10px 0"},children:"Preview"}),j.length===0?i.jsx("div",{style:{color:"#666"},children:"No questions to preview yet."}):i.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[j.slice(0,50).map((N,T)=>i.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:14},children:[i.jsxs("div",{style:{fontWeight:700,marginBottom:6},children:[T+1,". ",N.question_text]}),i.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",color:"#555",fontSize:13,marginBottom:8},children:[N.marks!=null&&i.jsxs("span",{children:["Marks: ",String(N.marks)]}),N.btl!=null&&i.jsxs("span",{children:["BTL: ",String(N.btl)]}),N.course_outcomes&&i.jsxs("span",{children:["CO: ",N.course_outcomes]}),N.chapter&&i.jsxs("span",{children:["Chapter: ",N.chapter]})]}),Array.isArray(N.options)&&N.options.length?i.jsx("ol",{type:"a",style:{marginTop:0},children:N.options.map((B,G)=>i.jsx("li",{children:String(B)},G))}):null,N.correct_answer?i.jsxs("div",{style:{marginTop:6,color:"#111",fontSize:13},children:[i.jsx("strong",{children:"Answer:"})," ",N.correct_answer]}):null,N.answer_text?i.jsxs("div",{style:{marginTop:4,color:"#444",fontSize:13},children:[i.jsx("strong",{children:"Explanation:"})," ",N.answer_text]}):null,Array.isArray(N.images)&&N.images.length?i.jsx("div",{style:{marginTop:10,display:"flex",gap:10,flexWrap:"wrap"},children:N.images.slice(0,6).map((B,G)=>{let re=null;try{if(typeof B=="string")re=B,!re.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(re)&&re.length>100&&(re=`data:image/png;base64,${re.replace(/\s+/g,"")}`);else if(B&&typeof B=="object"){if(B.url)re=B.url;else if(B.base64)re=B.base64.startsWith("data:")?B.base64:`data:image/png;base64,${B.base64}`;else if(B.binary&&B.binary instanceof Uint8Array){const xe=new Blob([B.binary],{type:"image/png"});re=URL.createObjectURL(xe)}}else if(B instanceof Uint8Array){const xe=new Blob([B],{type:"image/png"});re=URL.createObjectURL(xe)}}catch{re=null}return re?i.jsx("img",{src:re,alt:`q${T+1}-img${G+1}`,onClick:()=>C(re),style:{maxHeight:140,borderRadius:8,border:"1px solid #eee",cursor:"pointer",objectFit:"contain"}},G):null})}):null]},T)),j.length>50&&i.jsx("div",{style:{color:"#666"},children:"Showing first 50 questions."})]}),_&&i.jsx("div",{role:"dialog",onClick:()=>{C(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},children:i.jsx("div",{onClick:N=>N.stopPropagation(),style:{maxWidth:"90%",maxHeight:"90%",padding:12},children:i.jsx("img",{src:_,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:8}})})})]})}function qPe({courseId:e,classType:t,questionPaperType:r,enabledAssessments:n}){const[a,s]=x.useState(e||""),[o,l]=x.useState(!1);return x.useEffect(()=>{e&&e!==a&&s(e),!e&&a&&s("")},[e]),i.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #ecfdf5 0%, #ffffff 60%)",padding:"0"},children:i.jsxs("div",{style:{background:"#ffffff",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[i.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"#ffffff",padding:"20px 24px",flexShrink:0},children:[i.jsx("div",{style:{fontSize:24,fontWeight:800},children:"Mark Entry"}),i.jsxs("div",{style:{fontSize:14,opacity:.9},children:[" ",a?`Course: ${a}`:"No course selected"," "]})]}),i.jsxs("div",{style:{padding:"20px 24px",flex:1},children:[!e&&i.jsxs("div",{className:"obe-card",style:{marginBottom:12},children:[i.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:"#065f46",textTransform:"uppercase",letterSpacing:"0.03em"},children:"Course ID"}),i.jsx("input",{value:a,onChange:c=>s(c.target.value),placeholder:"Enter course id",className:"obe-input",style:{marginTop:6,...o?{boxShadow:"0 0 0 3px rgba(16,185,129,0.2)",borderColor:"#a7f3d0"}:{}},onFocus:()=>l(!0),onBlur:()=>l(!1)})]}),a?i.jsx(u6,{subjectId:a,classType:t,questionPaperType:r,enabledAssessments:n}):i.jsx("div",{style:{background:"#d1fae5",border:"1px solid #a7f3d0",color:"#065f46",fontSize:14,padding:12,borderRadius:10},children:"Select a course to start mark entry."})]})]})})}const cc={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},HPe=[{key:"q1",max:2,co:1},{key:"q2",max:2,co:1},{key:"q3",max:2,co:1},{key:"q4",max:2,co:2},{key:"q5",max:2,co:2},{key:"q6",max:2,co:2},{key:"q7",max:16,co:1},{key:"q8",max:16,co:2},{key:"q9",max:16,co:"1&2"}],VPe=[{key:"q1",max:2,co:3},{key:"q2",max:2,co:3},{key:"q3",max:2,co:3},{key:"q4",max:2,co:4},{key:"q5",max:2,co:4},{key:"q6",max:2,co:4},{key:"q7",max:16,co:3},{key:"q8",max:16,co:4},{key:"q9",max:16,co:"3&4"}],GPe=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],fv=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function Wn(e,t,r){return Math.max(t,Math.min(r,e))}function Tf(e){return Math.round(e*100)/100}function xo(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function LR(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const a=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return a.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function KPe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function XPe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function lj(e){if(e==="both"||e==="1&2")return"1&2";if(Array.isArray(e)){const r=e.map(s=>String(s??"").trim().toUpperCase());if(r.some(s=>s==="BOTH"))return"1&2";const n=r.some(s=>s==="1"||s==="CO1"),a=r.some(s=>s==="2"||s==="CO2");return n&&a?"1&2":a?2:1}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2")return"1&2";if(r==="2"||r==="CO2")return 2;if(r==="1"||r==="CO1")return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function cj(e){if(e==="both"||e==="3&4")return"3&4";if(Array.isArray(e)){const r=e.map(l=>String(l??"").trim().toUpperCase());if(r.some(l=>l==="BOTH"))return"3&4";const n=r.some(l=>l==="1"||l==="CO1"),a=r.some(l=>l==="2"||l==="CO2"),s=r.some(l=>l==="3"||l==="CO3"),o=r.some(l=>l==="4"||l==="CO4");return s&&o||n&&a?"3&4":o||a?4:3}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2"||r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3"||r==="CO3&CO4"||r==="CO3,CO4")return"3&4";if(r==="4"||r==="CO4")return 4;if(r==="3"||r==="CO3")return 3;if(r==="2"||r==="CO2")return 4;if(r==="1"||r==="CO1")return 3}const t=Number(e);return t===4?4:t===34?"3&4":t===2?4:t===1?3:t===12?"3&4":3}function uj(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),a=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&a&&s?{co1:.5,co2:.5}:KPe(r.co)}function dj(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),a=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&a&&s?{co3:.5,co4:.5}:XPe(r.co)}function MR(e,t,r,n){const a=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(a)||a<=0||!c)return[0,0,0];const u=Tf(a*(s||0)/c),d=Tf(a*(o||0)/c),f=Tf(a*(l||0)/c);return[u,d,f]}function YPe(e,t){const r=In(e),n=cc.header,a=cc.cycles,s=["CO1-SSA","CO1-CIA","CO1-FA","CO2-SSA","CO2-CIA","CO2-FA","CO3-SSA","CO3-CIA","CO3-FA","CO4-SSA","CO4-CIA","CO4-FA","ME-CO1","ME-CO2","ME-CO3","ME-CO4","ME-CO5"];let o=Array.from({length:17},(p,h)=>h),l=[...a],c=[...s];if(r==="TCPR"&&(l=l.map((p,h)=>h===2||h===5||h===8||h===11?"review":p),c=c.map((p,h)=>h===2||h===5||h===8||h===11?p.replace("-FA","-Review"):p)),r==="TCPL"&&(l=l.map((p,h)=>h===2||h===5||h===8||h===11?"lab":p),c=c.map((p,h)=>h===2||h===5?p.replace("-FA","-LAB1"):h===8||h===11?p.replace("-FA","-LAB2"):p)),r==="LAB"||r==="PRACTICAL")return o=[1,4,7,10,16],{visible:o,header:["CO1","CO2","CO3","CO4","ME"],cycles:["CIA 1","CIA 1","CIA 2","CIA 2","MODEL"],labels:["CO1-CIA1","CO2-CIA1","CO3-CIA2","CO4-CIA2","ME-CO5"]};if(r==="SPECIAL"&&t.size){const p=[],h=(m,g)=>{if(m)for(const b of g)p.push(b)};h(t.has("ssa1"),[0,3]),h(t.has("cia1"),[1,4]),h(t.has("formative1"),[2,5]),h(t.has("ssa2"),[6,9]),h(t.has("cia2"),[7,10]),h(t.has("formative2"),[8,11]),o=p}const u=o.map(p=>n[p]),d=o.map(p=>l[p]),f=o.map(p=>c[p]);return{visible:o,header:u,cycles:d,labels:f}}function QPe({courseId:e,enabledAssessments:t}){const r=x.useMemo(()=>new Set((t||[]).map(L=>String(L||"").trim().toLowerCase()).filter(Boolean)),[t]),[n,a]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(null),[u,d]=x.useState(null),[f,p]=x.useState(null),[h,m]=x.useState([]),[g,b]=x.useState(null),[y,v]=x.useState(!1),[w,_]=x.useState({ssa1:1.5,cia1:3,formative1:2.5}),[C,j]=x.useState([...cc.weights]),[A,M]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[P,R]=x.useState({r1:{},r2:{}}),[N,T]=x.useState({cia1:null,cia2:null,model:null}),[B,G]=x.useState({lab1:null,lab2:null}),[re,xe]=x.useState(null),[_e,V]=x.useState({cia1:null,cia2:null}),[K,de]=x.useState(null),[ne,E]=x.useState(!1),[Z,H]=x.useState(null);x.useEffect(()=>{let L=!0;return(async()=>{try{const U=await iu();if(!L)return;p(U||null)}catch{}})(),()=>{L=!1}},[e]),x.useEffect(()=>{let L=!0;return(async()=>{var U;try{const ce=await jc();if(!L)return;let W=(ce||[]).filter(ze=>String(ze.subject_code)===String(e));if(W.length===0)try{const ze=await mr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(ze.ok){const ke=await ze.json();W=(Array.isArray(ke.results)?ke.results:Array.isArray(ke)?ke:ke.items||[])||[]}}catch(ze){console.warn("Server TA list fetch failed:",ze)}a(W);const ae=Pn(`internalMark_selectedTa_${e}`),he=(typeof ae=="number"&&W.some(ze=>ze.id===ae)?ae:(U=W[0])==null?void 0:U.id)??null;o(he),c(null)}catch(ce){if(!L)return;a([]),o(null),c((ce==null?void 0:ce.message)||"Failed to load teaching assignments")}})(),()=>{L=!1}},[e]),x.useEffect(()=>{!e||s==null||Sn(`internalMark_selectedTa_${e}`,s)},[e,s]),x.useEffect(()=>{let L=!0;return(async()=>{try{const U=(n||[]).find(ae=>ae.id===s)||null,ce=U==null?void 0:U.curriculum_row_id;if(!ce){const ae=String(e).trim().toUpperCase(),he=await sl();if(!L)return;const ze=(he||[]).find(Ve=>String(Ve.course_code||"").trim().toUpperCase()===ae),ke=(ze==null?void 0:ze.class_type)??null;if(ke){d(ke);return}const qe=await Ld();if(!L)return;const Ie=(qe||[]).find(Ve=>String(Ve.course_code||"").trim().toUpperCase()===ae);d((Ie==null?void 0:Ie.class_type)??null);return}const W=await cN(Number(ce));if(!L)return;d((W==null?void 0:W.class_type)??null)}catch{L&&d(null)}})(),()=>{L=!1}},[n,s,e]),x.useEffect(()=>{let L=!0;return(async()=>{try{const U=In(u),ce=W=>{if(!W||typeof W!="object")return!1;const ae=Number.isFinite(Number(W.ssa1))?Number(W.ssa1):1.5,he=Number.isFinite(Number(W.cia1))?Number(W.cia1):3,ze=Number.isFinite(Number(W.formative1))?Number(W.formative1):2.5;_({ssa1:ae,cia1:he,formative1:ze});const ke=W.internal_mark_weights;if(Array.isArray(ke)&&ke.length){let qe=ke.map(Ie=>{const Ve=Number(Ie);return Number.isFinite(Ve)?Ve:0});if(qe.length===13&&cc.weights.length===17){const[Ie,Ve,Qe]=MR(qe[0]||0,ae,he,ze),[Tt,vt,Xe]=MR(qe[1]||0,ae,he,ze);qe=[Ie,Ve,Qe,Tt,vt,Xe,...qe.slice(2)]}for(;qe.length<cc.weights.length;)qe.push(cc.weights[qe.length]??0);j(qe.slice(0,cc.weights.length))}else j([...cc.weights]);return!0};try{const W=await uS();if(!L)return;const ae=W&&W[U]||null;if(ce(ae))return}catch{}try{const W=Pn("iqac_class_type_weights"),ae=W&&W[U]||null;if(ce(ae))return}catch{}}catch{}})(),()=>{L=!1}},[u]),x.useEffect(()=>{let L=!0;return(async()=>{if(s){v(!0),b(null);try{const ce=(n||[]).find(W=>W.id===s)||null;if(ce&&ce.elective_subject_id&&!ce.section_id){const W=ce.elective_subject_id,ae=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(W))}`);if(!ae.ok)throw new Error(`Elective-choices fetch failed: ${ae.status}`);const he=await ae.json();if(!L)return;const ke=((Array.isArray(he.results)?he.results:Array.isArray(he)?he:he.items||[])||[]).map(qe=>({id:Number(qe.student_id??qe.id),reg_no:String(qe.reg_no??qe.registration_no??qe.regno??""),name:String(qe.name??qe.full_name??qe.username??""),section:qe.section_name??qe.section??null}));if(!L)return;m(ke.filter(qe=>Number.isFinite(qe.id)).sort(LR))}else{const W=await Ac(s);if(!L)return;const ae=(W.students||[]).map(he=>({id:Number(he.id),reg_no:String(he.reg_no??""),name:String(he.name??""),section:he.section??null})).filter(he=>Number.isFinite(he.id)).sort(LR);m(ae)}}catch(ce){if(!L)return;m([]),b((ce==null?void 0:ce.message)||"Failed to load roster")}finally{L&&v(!1)}}})(),()=>{L=!1}},[s]),x.useEffect(()=>{let L=!0;return(async()=>{E(!0),H(null);try{const ce=In(u),W=s??void 0,ae=ce==="TCPL",he=ce==="TCPR",ze=ce==="LAB"||ce==="PRACTICAL",ke=ce==="SPECIAL"&&r.size,qe=Ot=>ke?r.has(String(Ot).toLowerCase()):!0;R({r1:{},r2:{}}),T({cia1:null,cia2:null,model:null}),G({lab1:null,lab2:null}),xe(null),V({cia1:null,cia2:null}),de(null);const Ie=async Ot=>{if(!ce)return null;try{const Ht=await Gf({class_type:String(ce).toUpperCase(),question_paper_type:null,exam:Ot}),Pr=Ht&&Ht.pattern;if(Pr&&Array.isArray(Pr.marks)&&Pr.marks.length)return Pr}catch{}try{const Ht=await Gf({class_type:String(ce).toUpperCase(),question_paper_type:null,exam:"CIA"}),Pr=Ht&&Ht.pattern;if(Pr&&Array.isArray(Pr.marks)&&Pr.marks.length)return Pr}catch{}return null};try{const[Ot,Ht]=await Promise.all([Ie("CIA1"),Ie("CIA2")]);L&&V({cia1:Ot,cia2:Ht})}catch{L&&V({cia1:null,cia2:null})}let Ve=null,Qe=null,Tt=null,vt=null,Xe=null,Be=null,ct=null,nt=null,Se=null,Te=null,Dt=null,wt=null,Pt=null,Wt=null;if(ze){try{const Ot=await Mn("cia1",e,W);Ot!=null&&Ot.draft&&(Se={data:Ot.draft.data??Ot.draft})}catch{}try{const Ot=await Mn("cia2",e,W);Ot!=null&&Ot.draft&&(Te={data:Ot.draft.data??Ot.draft})}catch{}try{const Ot=await Mn("model",e,W);Ot!=null&&Ot.draft&&(Dt={data:Ot.draft.data??Ot.draft})}catch{}if(!(Se!=null&&Se.data))try{Se=await no("cia1",e,W)}catch{Se=null}if(!(Te!=null&&Te.data))try{Te=await no("cia2",e,W)}catch{Te=null}if(!(Dt!=null&&Dt.data))try{Dt=await Am(e,W)}catch{Dt=null}if(!L)return;T({cia1:(Se==null?void 0:Se.data)??null,cia2:(Te==null?void 0:Te.data)??null,model:(Dt==null?void 0:Dt.data)??null}),M({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});return}if(qe("ssa1"))try{const Ot=await Mn("ssa1",e,W);Ot!=null&&Ot.draft&&Ot.draft.marks&&(Ve={marks:Ot.draft.marks})}catch{}if(qe("ssa2"))try{const Ot=await Mn("ssa2",e,W);Ot!=null&&Ot.draft&&Ot.draft.marks&&(Qe={marks:Ot.draft.marks})}catch{}if(qe("ssa1")&&!(Ve!=null&&Ve.marks))try{Ve=await Vm(e,W)}catch{Ve=null}if(qe("ssa2")&&!(Qe!=null&&Qe.marks))try{Qe=await H1(e,W)}catch{Qe=null}if(he){try{const Ot=await Mn("review1",e,W);Ot!=null&&Ot.draft&&Ot.draft.marks&&(ct={marks:Ot.draft.marks})}catch{}try{const Ot=await Mn("review2",e,W);Ot!=null&&Ot.draft&&Ot.draft.marks&&(nt={marks:Ot.draft.marks})}catch{}if(!(ct!=null&&ct.marks))try{ct=await dS(e)}catch{ct=null}if(!(nt!=null&&nt.marks))try{nt=await fS(e)}catch{nt=null}if(!L)return;R({r1:(ct==null?void 0:ct.marks)||{},r2:(nt==null?void 0:nt.marks)||{}})}if(ae){try{const Ot=await Mn("formative1",e,W);Ot!=null&&Ot.draft&&(wt={data:Ot.draft.data??Ot.draft})}catch{}try{const Ot=await Mn("formative2",e,W);Ot!=null&&Ot.draft&&(Pt={data:Ot.draft.data??Ot.draft})}catch{}if(!(wt!=null&&wt.data))try{wt=await no("formative1",e,W)}catch{wt=null}if(!(Pt!=null&&Pt.data))try{Pt=await no("formative2",e,W)}catch{Pt=null}if(!L)return;G({lab1:(wt==null?void 0:wt.data)??null,lab2:(Pt==null?void 0:Pt.data)??null})}else{if(!he&&qe("formative1")){try{const Ot=await Mn("formative1",e,W);Ot!=null&&Ot.draft&&Ot.draft.marks&&(Tt={marks:Ot.draft.marks})}catch{}if(!(Tt!=null&&Tt.marks))try{Tt=await f0("formative1",e,W)}catch{Tt=null}}if(!he&&qe("formative2")){try{const Ot=await Mn("formative2",e,W);Ot!=null&&Ot.draft&&Ot.draft.marks&&(vt={marks:Ot.draft.marks})}catch{}if(!(vt!=null&&vt.marks))try{vt=await f0("formative2",e,W)}catch{vt=null}}}if(qe("cia1")){try{const Ot=await Mn("cia1",e,W);Ot!=null&&Ot.draft&&(Xe={data:Ot.draft.data??Ot.draft})}catch{}if(!(Xe!=null&&Xe.data))try{Xe=await h0("cia1",e,W)}catch{Xe=null}}if(qe("cia2")){try{const Ot=await Mn("cia2",e,W);Ot!=null&&Ot.draft&&(Be={data:Ot.draft.data??Ot.draft})}catch{}if(!(Be!=null&&Be.data))try{Be=await h0("cia2",e,W)}catch{Be=null}}try{const Ot=await Mn("model",e,W);Ot!=null&&Ot.draft&&(Wt={data:Ot.draft.data??Ot.draft})}catch{}if(!(Wt!=null&&Wt.data))try{Wt=await Am(e,W)}catch{Wt=null}try{const Ot=Wt==null?void 0:Wt.data,Ht=String((Ot==null?void 0:Ot.qpType)||"").trim().toUpperCase(),Pr=Ht==="QP2"?"QP2":Ht==="QP1"?"QP1":null,jt=String(ce||"").toUpperCase(),ur=await Gf({class_type:jt,question_paper_type:jt==="THEORY"?Pr:null,exam:"MODEL"}),Ir=ur==null?void 0:ur.pattern;Ir&&Array.isArray(Ir.marks)&&Ir.marks.length&&L&&de(Ir)}catch{}if(!L)return;M({ssa1:(Ve==null?void 0:Ve.marks)||{},ssa2:(Qe==null?void 0:Qe.marks)||{},f1:(Tt==null?void 0:Tt.marks)||{},f2:(vt==null?void 0:vt.marks)||{},cia1:(Xe==null?void 0:Xe.data)||null,cia2:(Be==null?void 0:Be.data)||null}),xe((Wt==null?void 0:Wt.data)||null)}catch(ce){if(!L)return;H((ce==null?void 0:ce.message)||"Failed to load marks")}finally{L&&E(!1)}})(),()=>{L=!1}},[e,u,r,s]);const F=x.useMemo(()=>YPe(u,r),[u,r]),ee=x.useMemo(()=>{const U=(Array.isArray(C)&&C.length?C:cc.weights).slice(0,cc.weights.length);for(;U.length<cc.weights.length;)U.push(cc.weights[U.length]??0);const ce=F.visible.map(W=>U[W]??0);return{header:F.header,weights:ce,cycles:F.cycles,visible:F.visible,labels:F.labels}},[C,F]),z=x.useMemo(()=>ee.weights.map(U=>Number(U)||0).reduce((U,ce)=>U+ce,0),[ee]),X=x.useMemo(()=>{var Ut,Kr,$t,fr,Or,gt,Jt,ht,Ct,rr,kt,rt,Rt,Gt,ir,Bt,vr,Cr,Tr,xr,Xt,ie;const L=In(u),U=new Array(17).fill(0);for(let I=0;I<ee.visible.length;I++){const se=ee.visible[I];U[se]=Number(ee.weights[I])||0}const ce=U[0]||0,W=U[1]||0,ae=U[2]||0,he=U[3]||0,ze=U[4]||0,ke=U[5]||0,qe=U[6]||0,Ie=U[7]||0,Ve=U[8]||0,Qe=U[9]||0,Tt=U[10]||0,vt=U[11]||0,Xe=U[12]||0,Be=U[13]||0,ct=U[14]||0,nt=U[15]||0,Se=U[16]||0,Te=A.cia1&&typeof A.cia1=="object"?A.cia1:null,Dt=A.cia2&&typeof A.cia2=="object"?A.cia2:null,wt=_e==null?void 0:_e.cia1,Pt=_e==null?void 0:_e.cia2,Wt=Array.isArray((Kr=(Ut=f==null?void 0:f.assessments)==null?void 0:Ut.cia1)==null?void 0:Kr.questions)?f.assessments.cia1.questions.map(I=>({key:String((I==null?void 0:I.key)||""),max:Number((I==null?void 0:I.max)??(I==null?void 0:I.maxMarks)??0),co:lj(I==null?void 0:I.co)})).filter(I=>I.key):[],Ot=Array.isArray((fr=($t=f==null?void 0:f.assessments)==null?void 0:$t.cia2)==null?void 0:fr.questions)?f.assessments.cia2.questions.map(I=>({key:String((I==null?void 0:I.key)||""),max:Number((I==null?void 0:I.max)??(I==null?void 0:I.maxMarks)??0),co:cj(I==null?void 0:I.co)})).filter(I=>I.key):[],Ht=wt&&Array.isArray(wt.marks)&&wt.marks.length?wt.marks.map((I,se)=>{const ve=Wt[se],Pe=Array.isArray(wt.cos)?wt.cos[se]:void 0;return{key:`q${se+1}`,max:Number(I)||0,co:Pe!=null?lj(Pe):(ve==null?void 0:ve.co)??1}}).filter(I=>!!I.key):[],Pr=Pt&&Array.isArray(Pt.marks)&&Pt.marks.length?Pt.marks.map((I,se)=>{const ve=Ot[se],Pe=Array.isArray(Pt.cos)?Pt.cos[se]:void 0;return{key:`q${se+1}`,max:Number(I)||0,co:Pe!=null?cj(Pe):(ve==null?void 0:ve.co)??3}}).filter(I=>!!I.key):[],jt=Array.isArray(Te==null?void 0:Te.questions)?Te.questions.map(I=>({key:String((I==null?void 0:I.key)||""),max:Number((I==null?void 0:I.max)??(I==null?void 0:I.maxMarks)??0),co:lj(I==null?void 0:I.co)})).filter(I=>I.key):Ht.length?Ht:Wt.length?Wt:HPe,ur=Array.isArray(Dt==null?void 0:Dt.questions)?Dt.questions.map(I=>({key:String((I==null?void 0:I.key)||""),max:Number((I==null?void 0:I.max)??(I==null?void 0:I.maxMarks)??0),co:cj(I==null?void 0:I.co)})).filter(I=>I.key):Pr.length?Pr:Ot.length?Ot:VPe,Ir=Te!=null&&Te.rowsByStudentId&&typeof Te.rowsByStudentId=="object"?Te.rowsByStudentId:{},Rr=Dt!=null&&Dt.rowsByStudentId&&typeof Dt.rowsByStudentId=="object"?Dt.rowsByStudentId:{},Nr=jt.reduce((I,se,ve)=>{const Pe=uj(jt,ve);return I+se.max*Pe.co1},0),zr=jt.reduce((I,se,ve)=>{const Pe=uj(jt,ve);return I+se.max*Pe.co2},0),_n=ur.reduce((I,se,ve)=>{const Pe=dj(ur,ve);return I+se.max*Pe.co3},0),Yr=ur.reduce((I,se,ve)=>{const Pe=dj(ur,ve);return I+se.max*Pe.co4},0),pn=((Or=f==null?void 0:f.assessments)==null?void 0:Or.ssa1)||{},ge=((gt=f==null?void 0:f.assessments)==null?void 0:gt.ssa2)||{},Ne=((Jt=f==null?void 0:f.assessments)==null?void 0:Jt.formative1)||{},dt=((ht=f==null?void 0:f.assessments)==null?void 0:ht.formative2)||{},Ue=((Ct=f==null?void 0:f.assessments)==null?void 0:Ct.cia1)||{},Re=((rr=f==null?void 0:f.assessments)==null?void 0:rr.cia2)||{},xt=Number((kt=pn==null?void 0:pn.coMax)==null?void 0:kt.co1),at=Number((rt=pn==null?void 0:pn.coMax)==null?void 0:rt.co2),er=Number(((Rt=ge==null?void 0:ge.coMax)==null?void 0:Rt.co3)??((Gt=ge==null?void 0:ge.coMax)==null?void 0:Gt.co1)),oe=Number(((ir=ge==null?void 0:ge.coMax)==null?void 0:ir.co4)??((Bt=ge==null?void 0:ge.coMax)==null?void 0:Bt.co2)),ue=Number((vr=Ue==null?void 0:Ue.coMax)==null?void 0:vr.co1),Q=Number((Cr=Ue==null?void 0:Ue.coMax)==null?void 0:Cr.co2),ye=Number(((Tr=Re==null?void 0:Re.coMax)==null?void 0:Tr.co3)??((xr=Re==null?void 0:Re.coMax)==null?void 0:xr.co1)),je=Number(((Xt=Re==null?void 0:Re.coMax)==null?void 0:Xt.co4)??((ie=Re==null?void 0:Re.coMax)==null?void 0:ie.co2)),Ce=Number(Ne==null?void 0:Ne.maxCo),ot=Number(dt==null?void 0:dt.maxCo),it=L==="TCPL",We={ssa1:{co1:Number.isFinite(xt)?Math.max(0,xt):10,co2:Number.isFinite(at)?Math.max(0,at):10},ssa2:{co3:Number.isFinite(er)?Math.max(0,er):10,co4:Number.isFinite(oe)?Math.max(0,oe):10},cia1:{co1:it?Nr>0?Nr:Number.isFinite(ue)?Math.max(0,ue):30:Number.isFinite(ue)?Math.max(0,ue):Nr,co2:it?zr>0?zr:Number.isFinite(Q)?Math.max(0,Q):30:Number.isFinite(Q)?Math.max(0,Q):zr},cia2:{co3:it?_n>0?_n:Number.isFinite(ye)?Math.max(0,ye):30:Number.isFinite(ye)?Math.max(0,ye):_n,co4:it?Yr>0?Yr:Number.isFinite(je)?Math.max(0,je):30:Number.isFinite(je)?Math.max(0,je):Yr},f1:{co1:Number.isFinite(Ce)?Math.max(0,Ce):10,co2:Number.isFinite(Ce)?Math.max(0,Ce):10},f2:{co3:Number.isFinite(ot)?Math.max(0,ot):10,co4:Number.isFinite(ot)?Math.max(0,ot):10},review1:{co1:15,co2:15},review2:{co3:15,co4:15}},De=L==="TCPL",pe=L==="TCPR",Je=De||pe,Ge=Array.isArray(K==null?void 0:K.marks)?K.marks:null,Ye=(()=>{if(Array.isArray(Ge)&&Ge.length)return Ge.map((I,se)=>({key:`q${se+1}`,max:Number(I)||0}));if(Je){const I=pe?12:15,se=pe?8:10;return Array.from({length:I},(ve,Pe)=>{const Ke=Pe+1;return{key:`q${Ke}`,max:Ke<=se?2:16}})}return GPe})(),ft=(()=>{const I=Array.isArray(K==null?void 0:K.cos)?K.cos:null;if(Array.isArray(I)&&I.length===Ye.length)return I.map(se=>{const ve=Number(se);if(Number.isFinite(ve))return Wn(Math.round(ve),1,5);const Ke=String(se??"").toUpperCase().match(/\d+/);return Ke?Wn(Number(Ke[0]),1,5):1});if(pe){const se=[1,1,2,2,3,3,4,4,1,2,3,4];return Ye.length===se.length?se:Array.from({length:Ye.length},(ve,Pe)=>se[Pe%se.length])}if(De){const se=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];return Ye.length===se.length?se:Array.from({length:Ye.length},(ve,Pe)=>se[Pe%se.length])}return Ye.length===fv.length?[...fv]:Array.from({length:Ye.length},(se,ve)=>fv[ve%fv.length])})(),bt=(()=>{const I={co1:0,co2:0,co3:0,co4:0,co5:0};for(let se=0;se<Ye.length;se++){const ve=Ye[se],Pe=ft[se]??1;Pe===1?I.co1+=ve.max:Pe===2?I.co2+=ve.max:Pe===3?I.co3+=ve.max:Pe===4?I.co4+=ve.max:Pe===5&&(I.co5+=ve.max)}return I})(),Vt=(()=>{const I={...bt};return pe?{...I,co5:I.co5+30}:De?{co1:I.co1+6,co2:I.co2+6,co3:I.co3+6,co4:I.co4+6,co5:I.co5+6}:I})(),Ft=String(s??"none"),gr=re&&typeof re=="object"?re:null,Ar=(()=>{if(gr){const pr=In(gr==null?void 0:gr.classType),qr=pr==="TCPL"||pr==="TCPR"?gr==null?void 0:gr.tcplSheet:gr==null?void 0:gr.theorySheet;if(qr&&typeof qr=="object")return qr}const I=`model_theory_sheet_${e}_${Ft}`,se=`model_theory_sheet_${e}_none`,ve=`model_tcpl_sheet_${e}_${Ft}`,Pe=`model_tcpl_sheet_${e}_none`,Ke=`model_tcpr_sheet_${e}_${Ft}`,pt=`model_tcpr_sheet_${e}_none`,ut=`model_sheet_${e}`,Lt=Pn(I);if(Lt&&typeof Lt=="object")return Lt;const Sr=Pn(se);if(Sr&&typeof Sr=="object")return Sr;const hr=Pn(ve);if(hr&&typeof hr=="object")return hr;const mt=Pn(Pe);if(mt&&typeof mt=="object")return mt;const _t=Pn(Ke);if(_t&&typeof _t=="object")return _t;const cr=Pn(pt);if(cr&&typeof cr=="object")return cr;const sr=Pn(ut);return sr&&typeof sr=="object"?sr:null})(),kr=I=>{const se=Vt;if(!Ar)return{co1:null,co2:null,co3:null,co4:null,co5:null,max:se};const ve=`id:${String(I.id)}`,Pe=I.reg_no?`reg:${String(I.reg_no).trim()}`:"",Ke=Ar[ve]||(Pe?Ar[Pe]:null)||null;if(!Ke||typeof Ke!="object")return{co1:null,co2:null,co3:null,co4:null,co5:null,max:se};const pt=!!Ke.absent,ut=String(Ke.absentKind||"AL").toUpperCase(),Lt=Ke.q&&typeof Ke.q=="object"?Ke.q:{},Sr=xo(Ke.lab);let hr=!1;const mt={co1:0,co2:0,co3:0,co4:0,co5:0};for(let _t=0;_t<Ye.length;_t++){const cr=Ye[_t],sr=Lt[cr.key],pr=xo(sr);if(pr==null)continue;hr=!0;const Dr=Wn(pr,0,cr.max),qr=ft[_t]??1;qr===1?mt.co1+=Dr:qr===2?mt.co2+=Dr:qr===3?mt.co3+=Dr:qr===4?mt.co4+=Dr:qr===5&&(mt.co5+=Dr)}if(Je&&Sr!=null){hr=!0;const _t=Wn(Sr,0,30);if(pe)mt.co5+=_t;else{const cr=_t/5;mt.co1+=cr,mt.co2+=cr,mt.co3+=cr,mt.co4+=cr,mt.co5+=cr}}return hr?pt&&ut==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:se}:{co1:Wn(mt.co1,0,se.co1),co2:Wn(mt.co2,0,se.co2),co3:Wn(mt.co3,0,se.co3),co4:Wn(mt.co4,0,se.co4),co5:Wn(mt.co5,0,se.co5),max:se}:pt&&ut==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:se}:{co1:null,co2:null,co3:null,co4:null,co5:null,max:se}},At=(I,se,ve)=>I==null||!se||!Number.isFinite(se)?null:Wn(I/se*ve,0,ve);if(L==="LAB"||L==="PRACTICAL"){const se=(ut,Lt,Sr)=>{const hr=ut!=null&&ut.sheet&&typeof ut.sheet=="object"?ut.sheet:{},mt=hr!=null&&hr.rowsByStudentId&&typeof hr.rowsByStudentId=="object"?hr.rowsByStudentId:{},_t=Wn(Number((hr==null?void 0:hr.expCountA)??0),0,12),cr=Wn(Number((hr==null?void 0:hr.expCountB)??0),0,12),sr=!!(hr!=null&&hr.coAEnabled),pr=!!(hr!=null&&hr.coBEnabled),Dr=!!(hr!=null&&hr.ciaExamEnabled),qr=hr!=null&&hr.coConfigs&&typeof hr.coConfigs=="object"?hr.coConfigs:null,Ur=qr?qr[String(Lt)]:null,Qr=Sr!=null&&qr?qr[String(Sr)]:null,on=Ur?!!Ur.enabled:sr,gn=Sr!=null?Qr?!!Qr.enabled:pr:!1,ea=Ur?Wn(Number(Ur.expCount??0),0,12):_t,ma=Sr!=null?Qr?Wn(Number(Qr.expCount??0),0,12):cr:0,ga=Ur&&Number.isFinite(Number(Ur.expMax))?Number(Ur.expMax):Number.isFinite(Number(hr==null?void 0:hr.expMaxA))?Number(hr.expMaxA):25,ta=Sr!=null?Qr&&Number.isFinite(Number(Qr.expMax))?Number(Qr.expMax):Number.isFinite(Number(hr==null?void 0:hr.expMaxB))?Number(hr.expMaxB):25:0,Tn=ga+(Dr?15:0),Me=Sr!=null?ta+(Dr?15:0):0,yt=(He,Fe)=>Array.isArray(He)?He.map(st=>typeof st=="number"&&Number.isFinite(st)?st:null):He==null?[]:[],fe=He=>{const Fe=(He||[]).filter(st=>typeof st=="number"&&Number.isFinite(st));return Fe.length?Fe.reduce((st,It)=>st+It,0)/Fe.length:null};return{get:He=>{const Fe=mt[String(He)]||{},st=Fe!=null&&Fe.marksByCo&&typeof Fe.marksByCo=="object"?Fe.marksByCo:{},It=(st==null?void 0:st[String(Lt)])??Fe.marksA,Nt=Sr!=null?(st==null?void 0:st[String(Sr)])??Fe.marksB:[],or=yt(It).slice(0,on?ea:0),nr=yt(Nt).slice(0,gn?ma:0),Er=fe(or),Br=fe(nr),Hr=Fe==null?void 0:Fe.ciaExam,O=typeof Hr=="number"&&Number.isFinite(Hr)?Hr:null,le=Er!=null||Br!=null||O!=null,Le=le?(Er??0)+(Dr?(O??0)/2:0):null,Ee=le?(Br??0)+(Dr?(O??0)/2:0):null;return{a:Le==null?null:Wn(Le,0,Tn),b:Ee==null?null:Wn(Ee,0,Me)}},CO_MAX_A:Tn,CO_MAX_B:Me}},ve=se(N.cia1,1,2),Pe=se(N.cia2,3,4),Ke=se(N.model,5,null),pt=(ut,Lt,Sr)=>ut==null||!Lt||!Number.isFinite(Lt)?null:Wn(ut/Lt*Sr,0,Sr);return h.map((ut,Lt)=>{const Sr=ve.get(ut.id),hr=Pe.get(ut.id),mt=Ke.get(ut.id),_t=null,cr=pt(Sr.a,ve.CO_MAX_A,W),sr=null,pr=null,Dr=pt(Sr.b,ve.CO_MAX_B,ze),qr=null,Ur=null,Qr=pt(hr.a,Pe.CO_MAX_A,Ie),on=null,gn=null,ea=pt(hr.b,Pe.CO_MAX_B,Tt),ma=null,ga=null,ta=null,Tn=null,Me=null,yt=pt(mt.a,Ke.CO_MAX_A,Se),fe=[_t,cr,sr,pr,Dr,qr,Ur,Qr,on,gn,ea,ma,ga,ta,Tn,Me,yt],be=ee.visible.map(It=>fe[It]),Fe=be.some(It=>typeof It=="number"&&Number.isFinite(It))?Tf(be.reduce((It,Nt)=>It+(typeof Nt=="number"&&Number.isFinite(Nt)?Nt:0),0)):null,st=Fe==null||!z?null:Tf(Fe/z*100);return{sno:Lt+1,...ut,cells:be,total:Fe,pct:st}})}return h.map((I,se)=>{const ve=xo(A.ssa1[String(I.id)]),Pe=xo(A.ssa2[String(I.id)]),Ke=ve==null?null:Number(ve)/2,pt=Pe==null?null:Number(Pe)/2,ut=Ke==null?null:Wn(Ke,0,We.ssa1.co1),Lt=Ke==null?null:Wn(Ke,0,We.ssa1.co2),Sr=pt==null?null:Wn(pt,0,We.ssa2.co3),hr=pt==null?null:Wn(pt,0,We.ssa2.co4),mt=(A.f1||{})[String(I.id)]||{},_t=(A.f2||{})[String(I.id)]||{},cr=xo(mt==null?void 0:mt.skill1)!=null&&xo(mt==null?void 0:mt.att1)!=null?Wn(Number(mt.skill1)+Number(mt.att1),0,We.f1.co1):null,sr=xo(mt==null?void 0:mt.skill2)!=null&&xo(mt==null?void 0:mt.att2)!=null?Wn(Number(mt.skill2)+Number(mt.att2),0,We.f1.co2):null,pr=xo(_t==null?void 0:_t.skill1)!=null&&xo(_t==null?void 0:_t.att1)!=null?Wn(Number(_t.skill1)+Number(_t.att1),0,We.f2.co3):null,Dr=xo(_t==null?void 0:_t.skill2)!=null&&xo(_t==null?void 0:_t.att2)!=null?Wn(Number(_t.skill2)+Number(_t.att2),0,We.f2.co4):null,qr=xo(P.r1[String(I.id)]),Ur=xo(P.r2[String(I.id)]),Qr=qr==null?null:Number(qr)/2,on=Ur==null?null:Number(Ur)/2,gn=Qr==null?null:Wn(Qr,0,We.review1.co1),ea=Qr==null?null:Wn(Qr,0,We.review1.co2),ma=on==null?null:Wn(on,0,We.review2.co3),ga=on==null?null:Wn(on,0,We.review2.co4),ta=(Yn,Ra,ja)=>{const dn=Yn!=null&&Yn.sheet&&typeof Yn.sheet=="object"?Yn.sheet:{},fi=dn!=null&&dn.rowsByStudentId&&typeof dn.rowsByStudentId=="object"?dn.rowsByStudentId:{},$i=30/2,ts=dn!=null&&dn.coConfigs&&typeof dn.coConfigs=="object"?dn.coConfigs:null,Ui=ts?ts[String(Ra)]:null,xa=ja!=null&&ts?ts[String(ja)]:null,Yo=Wn(Number((dn==null?void 0:dn.expCountA)??0),0,12),rf=Wn(Number((dn==null?void 0:dn.expCountB)??0),0,12),tp=(dn==null?void 0:dn.coAEnabled)!==!1,Qo=ja!=null?(dn==null?void 0:dn.coBEnabled)!==!1:!1,Zu=Ui?!!Ui.enabled:tp,vh=ja!=null?xa?!!xa.enabled:Qo:!1,wh=Ui?Wn(Number(Ui.expCount??0),0,12):Yo,cu=ja!=null?xa?Wn(Number(xa.expCount??0),0,12):rf:0,ed=Ui&&Number.isFinite(Number(Ui.expMax))?Number(Ui.expMax):Number.isFinite(Number(dn==null?void 0:dn.expMaxA))?Number(dn.expMaxA):25,Oo=ja!=null?xa&&Number.isFinite(Number(xa.expMax))?Number(xa.expMax):Number.isFinite(Number(dn==null?void 0:dn.expMaxB))?Number(dn.expMaxB):25:0,Cs=(dn==null?void 0:dn.ciaExamEnabled)!==!1,Ec=ed+(Cs?$i:0),Gl=ja!=null?Oo+(Cs?$i:0):0,Tc=Ba=>Array.isArray(Ba)?Ba.map(za=>typeof za=="number"&&Number.isFinite(za)?za:null):[],nf=Ba=>{const za=(Ba||[]).filter(ki=>typeof ki=="number"&&Number.isFinite(ki));return za.length?za.reduce((ki,Jo)=>ki+Jo,0)/za.length:null};return{get:Ba=>{const za=fi[String(Ba)]||{},ki=za!=null&&za.marksByCo&&typeof za.marksByCo=="object"?za.marksByCo:{},Jo=(ki==null?void 0:ki[String(Ra)])??(za==null?void 0:za.marksA),_h=ja!=null?(ki==null?void 0:ki[String(ja)])??(za==null?void 0:za.marksB):[],kh=Tc(Jo).slice(0,Zu?wh:0),jh=Tc(_h).slice(0,vh?cu:0),af=nf(kh),Pc=nf(jh),Kl=za==null?void 0:za.ciaExam,Xl=typeof Kl=="number"&&Number.isFinite(Kl)?Kl:null,uu=af!=null||Pc!=null||Xl!=null,Oc=uu?(af??0)+(Cs?(Xl??0)/2:0):null,du=uu?(Pc??0)+(Cs?(Xl??0)/2:0):null;return{a:Oc==null?null:Wn(Oc,0,Ec),b:du==null?null:Wn(du,0,Gl)}},CO_MAX_A:Ec,CO_MAX_B:Gl}},Tn=L==="TCPL"?ta(B.lab1,1,2):null,Me=L==="TCPL"?ta(B.lab2,3,4):null,yt=Tn?Tn.get(I.id):null,fe=Me?Me.get(I.id):null,be=(yt==null?void 0:yt.a)??null,He=(yt==null?void 0:yt.b)??null,Fe=(fe==null?void 0:fe.a)??null,st=(fe==null?void 0:fe.b)??null,It=Ir[String(I.id)]||{},Nt=Rr[String(I.id)]||{},or=!!(It!=null&&It.absent),nr=!!(Nt!=null&&Nt.absent);let Er=null,Br=null;if(!or){const Yn=It!=null&&It.q&&typeof It.q=="object"?It.q:{};let Ra=!1,ja=0,dn=0;for(let fi=0;fi<jt.length;fi++){const $i=jt[fi],ts=xo(Yn==null?void 0:Yn[$i.key]);if(ts==null)continue;Ra=!0;const Ui=Wn(ts,0,$i.max||ts),xa=uj(jt,fi);ja+=Ui*xa.co1,dn+=Ui*xa.co2}Ra&&(Er=Wn(ja,0,We.cia1.co1),Br=Wn(dn,0,We.cia1.co2))}let Hr=null,O=null;if(!nr){const Yn=Nt!=null&&Nt.q&&typeof Nt.q=="object"?Nt.q:{};let Ra=!1,ja=0,dn=0;for(let fi=0;fi<ur.length;fi++){const $i=ur[fi],ts=xo(Yn==null?void 0:Yn[$i.key]);if(ts==null)continue;Ra=!0;const Ui=Wn(ts,0,$i.max||ts),xa=dj(ur,fi);ja+=Ui*xa.co3,dn+=Ui*xa.co4}Ra&&(Hr=Wn(ja,0,We.cia2.co3),O=Wn(dn,0,We.cia2.co4))}const le=At(ut,We.ssa1.co1,ce),Le=At(Er,We.cia1.co1,W),Ee=L==="TCPR"?At(gn,We.review1.co1,ae):L==="TCPL"?At(be,(Tn==null?void 0:Tn.CO_MAX_A)??We.f1.co1,ae):At(cr,We.f1.co1,ae),Ze=At(Lt,We.ssa1.co2,he),lt=At(Br,We.cia1.co2,ze),St=L==="TCPR"?At(ea,We.review1.co2,ke):L==="TCPL"?At(He,(Tn==null?void 0:Tn.CO_MAX_B)??We.f1.co2,ke):At(sr,We.f1.co2,ke),Zt=At(Sr,We.ssa2.co3,qe),tr=At(Hr,We.cia2.co3,Ie),jr=L==="TCPR"?At(ma,We.review2.co3,Ve):L==="TCPL"?At(Fe,(Me==null?void 0:Me.CO_MAX_A)??We.f2.co3,Ve):At(pr,We.f2.co3,Ve),zt=At(hr,We.ssa2.co4,Qe),dr=At(O,We.cia2.co4,Tt),en=L==="TCPR"?At(ga,We.review2.co4,vt):L==="TCPL"?At(st,(Me==null?void 0:Me.CO_MAX_B)??We.f2.co4,vt):At(Dr,We.f2.co4,vt),mn=kr(I),vn=At(mn.co1,mn.max.co1,Xe),Gn=At(mn.co2,mn.max.co2,Be),Fn=At(mn.co3,mn.max.co3,ct),On=At(mn.co4,mn.max.co4,nt),Jn=At(mn.co5,mn.max.co5,Se),Kn=[le,Le,Ee,Ze,lt,St,Zt,tr,jr,zt,dr,en,vn,Gn,Fn,On,Jn],wa=ee.visible.map(Yn=>Kn[Yn]),Ya=wa.some(Yn=>typeof Yn=="number"&&Number.isFinite(Yn))?Tf(wa.reduce((Yn,Ra)=>Yn+(typeof Ra=="number"&&Number.isFinite(Ra)?Ra:0),0)):null,ra=Ya==null||!z?null:Tf(Ya/z*100);return{sno:se+1,...I,cells:wa,total:Ya,pct:ra}})},[ee,A,P,N,B,re,h,w,z,e,s,f,u,_e,K]),J=ee.header,q=ee.cycles,Y=ee.weights;return i.jsxs("div",{style:{padding:12},children:[i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[i.jsxs("div",{children:[i.jsx("h3",{style:{margin:0},children:"INTERNAL MARK"}),i.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Summative + Formative (based on IQAC mapping)"})]}),i.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:i.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[i.jsx("span",{style:{color:"#374151",fontWeight:700},children:"Section"}),i.jsxs("select",{value:s??"",onChange:L=>o(L.target.value?Number(L.target.value):null),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db"},children:[i.jsx("option",{value:"",disabled:!0,children:""}),n.map(L=>{const U=L.department,ce=(U==null?void 0:U.short_name)||(U==null?void 0:U.code)||(U==null?void 0:U.name)||L.department_name||"",W=L.semester,ae=`${L.section_name||`TA ${L.id}`} ${W?` Sem ${W}`:""} ${ce?` ${ce}`:""}`;return i.jsx("option",{value:L.id,children:ae},L.id)})]})]})})]}),l?i.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:l}):null,g?i.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:g}):null,Z?i.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:Z}):null,y||ne?i.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading"}):null,i.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:i.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",fontSize:12},children:[i.jsxs("thead",{children:[i.jsxs("tr",{children:[i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"S.No"}),i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Register No."}),i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Name"}),J.map((L,U)=>i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:String(L)},U)),i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:Tf(z)}),i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"100"})]}),i.jsxs("tr",{children:[i.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"internal weightage"}),Y.map((L,U)=>i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:Number(L).toFixed(1)},`w-${U}`)),i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]}),i.jsxs("tr",{children:[i.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"cycle"}),q.map((L,U)=>i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"},children:String(L)},`c-${U}`)),i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),i.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]})]}),i.jsx("tbody",{children:X.map(L=>i.jsxs("tr",{children:[i.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:L.sno}),i.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:L.reg_no}),i.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:L.name}),(Array.isArray(L.cells)?L.cells:[]).map((U,ce)=>i.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:U==null?"":Number(U).toFixed(2)},ce)),i.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center",fontWeight:800},children:L.total==null?"":Number(L.total).toFixed(2)}),i.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:L.pct==null?"":Number(L.pct).toFixed(2)})]},L.id))})]})})]})}function JPe(){const{code:e}=M0(),t=so(),r=Xo(),[n,a]=Zr.useState(()=>"marks");Zr.useEffect(()=>{if(!r||!r.pathname)return;const y=r.pathname.toLowerCase();y.includes("/lca/instructions")||y.includes("/lca_instructions")||y.includes("/lca")||y.includes("/cdap")||y.includes("/articulation")?a("lca_instructions"):y.includes("/marks")?a("marks"):y.includes("/co_attainment")?a("co_attainment"):y.includes("/internal_mark")||y.includes("/internal-mark")?a("internal_mark"):y.includes("/cqi")?a("cqi"):a("marks")},[r]);const s=Zr.useMemo(()=>{const y=String((r==null?void 0:r.pathname)||"").toLowerCase();return y.includes("/cdap")?"cdap":y.includes("/articulation")?"articulation":y.includes("/lca")&&!(y.includes("/lca/instructions")||y.includes("/lca_instructions"))?"lca":"instructions"},[r==null?void 0:r.pathname]);if(!e)return i.jsxs("div",{style:{padding:24},children:[i.jsx("p",{style:{color:"#666"},children:"No course selected."}),i.jsx("button",{onClick:()=>t("/obe"),className:"obe-btn obe-btn-primary",children:"Back"})]});const o=decodeURIComponent(e),[l,c]=Zr.useState(null),[u,d]=Zr.useState(null),[f,p]=Zr.useState(!1),[h,m]=Zr.useState(()=>{try{const y=localStorage.getItem(`obe_course_qp_${o}`);return String(y||"").trim().toUpperCase()==="QP2"?"QP2":"QP1"}catch{return"QP1"}}),[g,b]=Zr.useState(null);return Zr.useEffect(()=>{let y=!0;return(async()=>{try{y&&p(!1);const v=await jc();if(!y)return;const w=(v||[]).filter(M=>String(M.subject_code)===String(o)),_=w[0]||null;_&&c(_.subject_name||null);let C=null;try{const M=localStorage.getItem(`markEntry_selectedTa_${o}`),P=M==null?NaN:Number(M);C=Number.isFinite(P)?P:null}catch{C=null}const j=C!=null&&w.find(M=>Number(M.id)===Number(C))||w.find(M=>String((M==null?void 0:M.class_type)||"").trim())||_,A=String((j==null?void 0:j.class_type)||"").trim();A&&(d(A),p(!0))}catch{}})(),()=>{y=!1}},[o]),Zr.useEffect(()=>{let y=!0;return(async()=>{try{const v=await sl();if(!y)return;const w=String(o),_=w.toUpperCase(),C=(v||[]).filter(R=>String((R==null?void 0:R.course_code)||"").trim()===w||String((R==null?void 0:R.course_code)||"").trim().toUpperCase()===_),j=R=>String(R||"").trim().toUpperCase(),A=C.find(R=>{const N=j(R==null?void 0:R.question_paper_type);return N&&N!=="QP1"})||C.find(R=>j(R==null?void 0:R.question_paper_type))||C.find(R=>String((R==null?void 0:R.class_type)||"").trim())||C[0];if(!f&&A&&A.class_type){const R=String(A.class_type||"").trim();d(R||null)}else if(!f)try{const R=await sm();if(!y)return;const N=(Array.isArray(R)?R:R.results||[]).find(T=>String(T.course_code||"").trim().toUpperCase()===_);N&&N.class_type&&(d(String(N.class_type||"").trim()||null),Array.isArray(N.enabled_assessments)&&N.enabled_assessments.length&&b(N.enabled_assessments.map(T=>String(T).trim().toLowerCase()).filter(Boolean)))}catch{}let M=null;try{M=localStorage.getItem(`obe_course_qp_${o}`)}catch{M=null}const P=String(M||"").trim().toUpperCase();if(P==="QP1"||P==="QP2")m(P);else{const R=String((A==null?void 0:A.question_paper_type)||"").trim().toUpperCase();m(R==="QP2"?"QP2":"QP1")}if(In(A==null?void 0:A.class_type)==="SPECIAL"){b([]);try{const R=await lS(w);b(Array.isArray(R)?R:[])}catch{const R=A==null?void 0:A.enabled_assessments;b(Array.isArray(R)?R.map(N=>String(N).trim().toLowerCase()).filter(Boolean):[])}}else b(null)}catch{}})(),()=>{y=!1}},[o]),i.jsx("main",{className:"obe-course-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:i.jsxs("div",{style:{width:"100%",minWidth:0,boxSizing:"border-box"},children:[i.jsx("div",{style:{marginBottom:24,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:24,flexWrap:"wrap"},children:[i.jsxs("div",{style:{flex:1},children:[i.jsxs("h2",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:["OBE - ",o]}),i.jsx("div",{style:{color:"#64748b",marginTop:8,fontSize:16},children:"Course OBE workspace"}),l&&i.jsx("div",{style:{color:"#1e293b",marginTop:12,fontWeight:700,fontSize:20},children:l}),i.jsxs("div",{style:{marginTop:16,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[u&&i.jsxs("div",{style:{background:"#eff6ff",color:"#3b82f6",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #bfdbfe"},children:[" Class type: ",i.jsx("strong",{children:String(u).toLowerCase()[0].toUpperCase()+String(u).toLowerCase().slice(1)})]}),i.jsxs("div",{style:{background:"#f8fafc",color:"#475569",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:8},children:[i.jsx("span",{children:" QP Type:"}),i.jsxs("select",{value:String(h||"QP1").trim().toUpperCase()==="QP2"?"QP2":"QP1",onChange:y=>{const w=String(y.target.value||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";m(w);try{localStorage.setItem(`obe_course_qp_${o}`,w)}catch{}},style:{padding:"4px 10px",borderRadius:6,border:"1px solid #cbd5e1",fontSize:14,fontWeight:600,color:"#0f172a",background:"#fff",cursor:"pointer"},children:[i.jsx("option",{value:"QP1",children:"QP1"}),i.jsx("option",{value:"QP2",children:"QP2"})]})]})]})]}),i.jsx("div",{children:i.jsx("button",{onClick:()=>t("/obe"),onMouseEnter:y=>{y.currentTarget.style.background="#f8fafc",y.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:y=>{y.currentTarget.style.background="#fff",y.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"10px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",cursor:"pointer",fontWeight:600,fontSize:15,transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:" Back to courses"})})]})}),i.jsx("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)",flexWrap:"wrap"},"aria-label":"OBE Tabs",children:[{key:"lca_instructions",label:" Learner Centric Approach",icon:""},{key:"marks",label:" Mark Entry",icon:""},{key:"co_attainment",label:" CO Attainment",icon:""},{key:"cqi",label:" CQI",icon:""},{key:"internal_mark",label:" Internal Mark",icon:""}].map(y=>{const v=n===y.key;return i.jsx("button",{onClick:()=>{if(a(y.key),e){const w=encodeURIComponent(e),_=y.key==="lca_instructions"?"lca/instructions":String(y.key);t(`/obe/course/${w}/${_}`)}},onMouseEnter:w=>{v||(w.currentTarget.style.background="rgba(59,130,246,0.08)",w.currentTarget.style.color="#3b82f6")},onMouseLeave:w=>{v||(w.currentTarget.style.background="transparent",w.currentTarget.style.color="#64748b")},style:{padding:"10px 24px",borderRadius:8,border:"none",background:v?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:v?"#fff":"#64748b",cursor:"pointer",fontWeight:v?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:v?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:y.label},y.key)})}),i.jsxs("div",{children:[n==="marks"&&i.jsx(qPe,{courseId:o,classType:u,questionPaperType:h,enabledAssessments:g}),n==="lca_instructions"&&i.jsx(sK,{courseCode:o,courseName:l,initialTab:s}),n==="co_attainment"&&i.jsx(lK,{courseId:o,enabledAssessments:g,classType:u}),n==="internal_mark"&&i.jsx(QPe,{courseId:o,enabledAssessments:g}),n==="cqi"&&i.jsx(cK,{courseId:o})]})]})})}function ZPe(){const e=so(),[t]=kJ(),r=x.useMemo(()=>{const b=String(t.get("subject_code")||"").trim(),y=String(t.get("assessment")||"").trim().toLowerCase(),v=String(t.get("reason")||"Edit Marks").trim(),w=t.get("teaching_assignment_id"),_=w?Number(w):void 0;return{subject_code:b,assessment:y,reason:v,teaching_assignment_id:Number.isFinite(_)?_:void 0}},[t]),[n,a]=x.useState(r.subject_code),[s,o]=x.useState(r.assessment),[l,c]=x.useState(r.reason),[u,d]=x.useState(String(r.teaching_assignment_id??"")),[f,p]=x.useState(!1),[h,m]=x.useState(null);async function g(){p(!0),m(null);try{const b=(u||"").trim(),y=b?Number(b):void 0;await R0({assessment:s,subject_code:n,reason:l,teaching_assignment_id:Number.isFinite(y)?y:void 0,force:!0}),alert("Edit request sent to IQAC."),e(-1)}catch(b){m((b==null?void 0:b.message)||"Request failed")}finally{p(!1)}}return i.jsxs("div",{style:{maxWidth:720},children:[i.jsx("div",{style:{fontWeight:900,fontSize:16,marginBottom:12},children:"OBE Request"}),i.jsx("div",{className:"obe-card",children:i.jsxs("div",{style:{display:"grid",gap:10},children:[i.jsxs("label",{style:{display:"grid",gap:6},children:[i.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Subject Code"}),i.jsx("input",{className:"obe-input",value:n,onChange:b=>a(b.target.value),placeholder:"e.g., GEA1268"})]}),i.jsxs("label",{style:{display:"grid",gap:6},children:[i.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Assessment"}),i.jsx("input",{className:"obe-input",value:s,onChange:b=>o(b.target.value),placeholder:"cia1 | cia2 | model | formative1 | formative2"})]}),i.jsxs("label",{style:{display:"grid",gap:6},children:[i.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Teaching Assignment ID (optional)"}),i.jsx("input",{className:"obe-input",value:u,onChange:b=>d(b.target.value),placeholder:"e.g., 123"})]}),i.jsxs("label",{style:{display:"grid",gap:6},children:[i.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Reason"}),i.jsx("textarea",{className:"obe-input",value:l,onChange:b=>c(b.target.value),rows:3,placeholder:"Edit Marks",style:{resize:"vertical"}})]}),h?i.jsx("div",{className:"obe-danger-pill",children:h}):null,i.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[i.jsx("button",{className:"obe-btn",type:"button",onClick:()=>e(-1),disabled:f,children:"Cancel"}),i.jsx("button",{className:"obe-btn obe-btn-primary",type:"button",onClick:g,disabled:f||!n||!s,children:f?"Requesting":"Request Edit"})]})]})})]})}function eOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[a,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState(new Set);x.useEffect(()=>{m()},[]);async function m(){l(!0);try{const v=await mr("/api/academics/section-advisors/?page_size=0"),w=await mr("/api/academics/sections/?page_size=0"),_=await mr("/api/academics/hod-staff/?page_size=0"),C=await mr("/api/accounts/me/");async function j(A){if(!(A.headers.get("content-type")||"").includes("application/json")){const P=await A.text();throw console.error("Expected JSON but got:",P),new Error("Server returned non-JSON response (see console)")}return A.json()}if(v.ok){const A=await j(v);s(A.results||A)}if(w.ok){const A=await j(w);t(A.results||A)}if(_.ok){const A=await j(_);n(A.results||A)}if(C.ok){const A=await j(C);u(!!(A.permissions&&(A.permissions.includes("academics.assign_advisor")||A.permissions.includes("academics.add_sectionadvisor"))))}}catch(v){console.error(v),alert("Failed to load HOD assignments. Check console for server response.")}finally{l(!1)}}async function g(v,w){l(!0);try{if(!c)return alert("You do not have permission to assign advisors");const C=await mr("/api/academics/section-advisors/",{method:"POST",body:JSON.stringify({section_id:v,advisor_id:w,is_active:!0})});if(C.ok)h(j=>{const A=new Set(j);return A.delete(v),A}),await m();else{const j=await C.text();alert("Error: "+j)}}finally{l(!1)}}function b(v){h(w=>{const _=new Set(w);return _.has(v)?_.delete(v):_.add(v),_})}function y(v){return a.find(w=>w.section_id===v&&w.is_active)}return i.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:i.jsx(F0,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Advisor Assign"}),i.jsx("p",{className:"text-gray-600",children:"Assign advisors to sections and edit existing assignments"})]})]})}),o&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:i.jsxs("div",{className:"flex items-center justify-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Loading assignments..."})]})}),!o&&e.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>v>0).map(v=>{var j,A;const w=e.filter(M=>(M.department_id||0)===v);if(w.length===0)return null;const _=((j=w[0])==null?void 0:j.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Dept ${v}`,C=d===v;return i.jsx("button",{onClick:()=>f(C?null:v),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${C?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:_},v)})]})]}),i.jsx("div",{className:"space-y-6",children:Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>d===null||d===v).map(v=>{var j,A;const w=e.filter(M=>(M.department_id||0)===v);if(w.length===0)return null;const _=((j=w[0])==null?void 0:j.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Department ${v}`,C=r.filter(M=>(M.department||0)===v);return i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:[_," Department"]}),i.jsx("div",{className:"overflow-x-auto mb-6",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Section"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Select Advisor"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Action"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:w.map(M=>{const P=y(M.id),R=p.has(M.id),N=!P||R;return i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-4 py-3 text-gray-700",children:M.name}),i.jsx("td",{className:"px-4 py-3",children:N?i.jsxs("select",{id:`advisor-${M.id}`,className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:(P==null?void 0:P.advisor_id)||"",children:[i.jsx("option",{value:"",children:"-- Select Advisor --"}),C.map(T=>i.jsxs("option",{value:T.id,children:[T.staff_id," - ",T.user]},T.id))]}):i.jsx("div",{className:"text-gray-900 font-medium",children:(P==null?void 0:P.advisor)||"No advisor assigned"})}),i.jsx("td",{className:"px-4 py-3",children:P&&!R?i.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>c&&b(M.id),title:"Edit Assignment",children:i.jsx(Jf,{className:"h-4 w-4"})}):i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>{if(!c)return;const B=document.getElementById(`advisor-${M.id}`).value;if(!B)return alert("Select an advisor first");g(M.id,Number(B))},title:"Save Assignment",children:i.jsx(Od,{className:"h-4 w-4"})}),R&&i.jsx("button",{className:"p-2 text-sm font-medium rounded-lg transition-colors text-red-600 hover:bg-red-50 border border-red-300",onClick:()=>b(M.id),title:"Cancel",children:i.jsx(zu,{className:"h-4 w-4"})}),P&&i.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors flex items-center justify-center ${c?"bg-red-50 text-red-700 border border-red-300 hover:bg-red-100":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:async()=>{if(c&&confirm("Delete advisor assignment for this section?"))try{const T=await mr(`/api/academics/section-advisors/${P.id}/`,{method:"DELETE"});if(!T.ok){const B=await T.text();return alert("Delete failed: "+B)}await m()}catch(T){console.error(T),alert("Delete failed")}},title:"Delete Assignment",children:i.jsx(Yx,{className:"h-4 w-4"})})]})})]},M.id)})})]})})]},v)})})]}),!o&&e.length===0&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ls,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sections available"}),i.jsx("p",{className:"text-gray-600",children:"There are no sections available for advisor assignment at this time."})]})})]})})}const FR=e=>{if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id},RR=e=>{if(!e)return"";if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id||""};function tOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[a,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,g]=x.useState([]),[b,y]=x.useState([]),[v,w]=x.useState([]),[_,C]=x.useState(!0),[j,A]=x.useState(new Set),[M,P]=x.useState(new Set),R=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),N=R.includes("academics.view_elective_teaching"),T=R.includes("academics.assign_elective_teaching");x.useEffect(()=>{B()},[]);async function B(){try{C(!0);const F=await mr("/api/academics/my-students/?page_size=0"),ee=N||T?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0";let z=await mr(c&&ee.includes("hod-staff")?`${ee}&department=${c}`:ee);if(z.status===403&&ee.includes("hod-staff")){console.warn("hod-staff returned 403  falling back to advisor-staff endpoint");const L=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const U=await mr(L);U.ok&&(z=U)}catch(U){console.error("fallback to advisor-staff failed",U)}}const X=await mr("/api/curriculum/department/?page_size=0"),J=await mr("/api/curriculum/elective/?page_size=0"),q=await mr("/api/academics/teaching-assignments/?page_size=0"),Y=async L=>{if(!(L.headers.get("content-type")||"").includes("application/json"))throw new Error("non-json");return L.json()};if(F.ok){const L=await Y(F),U=(L.results||L).map(ce=>({id:ce.section_id,name:ce.section_name,batch:ce.batch,batch_regulation:ce.batch_regulation,department_id:ce.department_id,semester:ce.semester,department:ce.department}));t(U)}if(z.ok){const L=await Y(z);let U=L.results||L;c&&(U=U.filter(ce=>ce.department&&ce.department.id===c||ce.department===c)),n(U)}if(X.ok){const L=await Y(X),U=L.results||L;h(U),w(U.filter(W=>W.is_elective));const ce=new Map;U.forEach(W=>{W.department&&W.department.id&&ce.set(W.department.id,W.department)}),ce.size>0&&l(Array.from(ce.values()));try{const W=await mr("/api/academics/departments/?page_size=0");if(W.ok){const ae=await Y(W),he=ae.results||ae;Array.isArray(he)&&he.length>0&&s(he)}else ce.size>0&&s(Array.from(ce.values()))}catch{ce.size>0&&s(Array.from(ce.values()))}}if(J.ok){const L=await Y(J);y(L.results||L)}if(q.ok){const L=await Y(q);g(L.results||L)}}catch(F){console.error(F),alert("Failed to load teaching assignment data")}finally{C(!1)}}x.useEffect(()=>{async function F(){try{const ee=N||T?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0",z=c&&ee.includes("hod-staff")?`${ee}&department=${c}`:ee,X=await mr(z);let J=X;if(X.status===403&&ee.includes("hod-staff")){console.warn("hod-staff returned 403 in loadStaff  trying advisor-staff");const L=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const U=await mr(L);if(U.ok)J=U;else if(U.status!==200)return}catch(U){console.error("fallback failed",U);return}}if(!J.ok)return;const q=await J.json();let Y=q.results||q;!ee.includes("hod-staff")&&c&&(Y=Y.filter(L=>L.department&&L.department.id===c||L.department===c)),n(Y)}catch(ee){console.error("loadStaff failed",ee)}}F()},[c]);const G=(F,ee)=>m.find(z=>{const X=z.section_details&&z.section_details.id===F||z.section_details&&z.section_details.id===F||z.section===F||z.section_id===F,J=z.curriculum_row_details&&z.curriculum_row_details.id===ee||z.curriculum_row_details&&z.curriculum_row_details.id===ee||z.curriculum_row&&z.curriculum_row.id===ee||z.curriculum_row_id===ee;return X&&J}),re=(F,ee)=>`${F}-${ee}`,xe=(F,ee)=>{const z=re(F,ee);A(X=>new Set(X).add(z))},_e=(F,ee)=>{const z=re(F,ee);A(X=>{const J=new Set(X);return J.delete(z),J})},V=(F,ee)=>{const z=re(F,ee);return j.has(z)},K=F=>m.find(ee=>{const z=ee.elective_subject_id||ee.elective_subject&&ee.elective_subject.id||ee.elective_subject_details&&ee.elective_subject_details.id||ee.elective_subject;return Number(z)===Number(F)}),de=F=>`elective-${F}`,ne=F=>{const ee=de(F);P(z=>new Set(z).add(ee))},E=F=>{const ee=de(F);P(z=>{const X=new Set(z);return X.delete(ee),X})},Z=F=>{const ee=de(F);return M.has(ee)};async function H(F,ee,z){if(!ee)return alert("Select staff"),Promise.reject("No staff selected");try{if(z){const X={staff_id:Number(ee),is_active:!0},J=await mr(`/api/academics/teaching-assignments/${z}/`,{method:"PATCH",body:JSON.stringify(X)});if(J.ok)return alert("Updated successfully"),B(),Promise.resolve();{const q=await J.text();return alert("Error: "+q),Promise.reject(q)}}else{const X={elective_subject_id:F,staff_id:Number(ee),is_active:!0},J=await mr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(X)});if(J.ok)return alert("Assigned successfully"),B(),Promise.resolve();{const q=await J.text();return alert("Error: "+q),Promise.reject(q)}}}catch(X){return alert("Error: "+X),Promise.reject(X)}}return _?i.jsx("div",{style:{padding:"28px",minHeight:"100vh",background:"linear-gradient(180deg, #f7fbff 0%, #ffffff 60%)"},children:i.jsx("div",{style:{padding:"16px",borderRadius:"8px",background:"#fff",border:"1px solid rgba(15,23,42,0.04)",color:"#6b7280"},children:"Loading teaching assignments"})}):i.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:i.jsx(F0,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teaching Assign"}),i.jsx("p",{className:"text-gray-600",children:"Assign faculty to courses and sections"})]})]})}),a.length>0&&i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filters"}),i.jsx("div",{className:"flex flex-wrap gap-4",children:a.length>0&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Department:"}),i.jsxs("select",{value:c??"",onChange:F=>u(F.target.value?Number(F.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"All Departments"}),a.map(F=>i.jsx("option",{value:F.id,children:F.short_name||F.code||F.name||`Dept ${F.id}`},F.id))]})]})})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(ls,{className:"h-5 w-5 text-blue-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Assignments"})]}),e.length===0?i.jsx("div",{className:"text-center py-8",children:i.jsx("div",{className:"text-gray-500 text-sm",children:"No sections available for the selected filters."})}):i.jsx("div",{className:"space-y-6",children:e.map(F=>{const ee=p.filter(z=>(F.semester?z.semester===F.semester:!0)&&(F.batch_regulation?z.regulation===F.batch_regulation.code:!0)&&!z.is_elective);return i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[i.jsx("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"text-lg font-semibold text-blue-900",children:[F.batch," / ",F.name]}),i.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[i.jsxs("p",{className:"text-blue-700 text-sm",children:["Semester: ",F.semester||"Not specified"]}),F.batch_regulation&&i.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 border border-indigo-200",children:["Regulation: ",F.batch_regulation.code]})]})]}),i.jsxs("div",{className:"text-blue-600 text-sm font-medium",children:["Section ID: ",F.id]})]})}),ee.length===0?i.jsx("div",{className:"text-gray-500 text-sm py-4",children:"No subjects available for this section."}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Code"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Name"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Assigned Staff"}),i.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Action"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:ee.map(z=>{var q,Y;const X=G(F.id,z.id),J=V(F.id,z.id);return i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:z.course_code||"-"}),i.jsx("td",{className:"px-4 py-3 text-gray-700",children:z.course_name||"Unnamed"}),i.jsx("td",{className:"px-4 py-3",children:J?i.jsxs("select",{id:`staff-${F.id}-${z.id}`,defaultValue:((q=X==null?void 0:X.staff_details)==null?void 0:q.id)||(X==null?void 0:X.staff)||"",className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"-- select staff --"}),r.map(L=>i.jsxs("option",{value:L.id,children:[L.staff_id," - ",FR(L)]},L.id))]}):X?i.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(Y=X.staff_details)==null?void 0:Y.staff_id," - ",RR(X.staff_details)]}):i.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),i.jsx("td",{className:"px-4 py-3 text-center",children:i.jsx("div",{className:"flex items-center justify-center gap-2",children:J?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:()=>{const L=document.getElementById(`staff-${F.id}-${z.id}`);if(!(L!=null&&L.value))return alert("Select staff member");if(X){const U={staff_id:Number(L.value),is_active:!0};mr(`/api/academics/teaching-assignments/${X.id}/`,{method:"PATCH",body:JSON.stringify(U)}).then(ce=>{ce.ok?(alert("Updated successfully"),_e(F.id,z.id),B()):ce.text().then(W=>alert("Error: "+W))})}else{const U={section_id:F.id,staff_id:Number(L.value),curriculum_row_id:z.id,is_active:!0};mr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(U)}).then(ce=>{ce.ok?(alert("Assigned successfully"),_e(F.id,z.id),B()):ce.text().then(W=>alert("Error: "+W))})}},className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors border border-green-300",title:"Save Assignment",children:i.jsx(Od,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>_e(F.id,z.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:i.jsx(zu,{className:"h-4 w-4"})}),X&&i.jsx("button",{onClick:async()=>{if(confirm("Delete teaching assignment for this subject/section?"))try{const L=await mr(`/api/academics/teaching-assignments/${X.id}/`,{method:"DELETE"});if(L.ok)alert("Deleted"),_e(F.id,z.id),B();else{const U=await L.text().catch(()=>null);alert("Failed: "+(U||L.status))}}catch(L){console.error(L),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:i.jsx(Yx,{className:"h-4 w-4"})})]}):i.jsx(i.Fragment,{children:i.jsx("button",{onClick:()=>xe(F.id,z.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:i.jsx(Jf,{className:"h-4 w-4"})})})})})]},`${F.id}-${z.id}`)})})]})})]},F.id)})})]}),N&&i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Elective Subject Assignments"}),o.length>1&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Filter by Department"}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),o.map(F=>i.jsx("button",{onClick:()=>f(F.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===F.id?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:F.short_name||F.code||F.name||`Dept ${F.id}`},F.id))]})]}),i.jsx("div",{className:"space-y-4",children:v.filter(F=>!d||F.department&&F.department.id===d).length===0?i.jsx("div",{className:"text-gray-500 text-sm",children:"No elective parents found for the selected department."}):v.filter(F=>!d||F.department&&F.department.id===d).map(F=>i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[i.jsx("div",{className:"flex justify-between items-center mb-4",children:i.jsx("div",{className:"font-semibold text-gray-900",children:F.course_name||F.course_code||"Elective"})}),i.jsx("div",{className:"space-y-3",children:(b&&b.filter(ee=>ee.parent===F.id)).map(ee=>{var J,q;const z=K(ee.id),X=Z(ee.id);return console.log(`Elective ${ee.course_code} (ID: ${ee.id}):`,{opt:ee,existingElectiveAssignment:z,allAssignments:m.filter(Y=>Y.subject&&(Y.subject.includes(ee.course_code)||Y.subject.includes(ee.course_name)))}),i.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex-1 text-sm font-medium text-gray-900",children:[ee.course_code||"-","  ",ee.course_name||"-"]}),i.jsx("div",{className:"min-w-[200px]",children:X?i.jsxs("select",{id:`elective-staff-${ee.id}`,defaultValue:((J=z==null?void 0:z.staff_details)==null?void 0:J.id)||(z==null?void 0:z.staff)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[i.jsx("option",{value:"",children:"-- select staff --"}),r.map(Y=>i.jsxs("option",{value:Y.id,children:[Y.staff_id," - ",FR(Y)]},Y.id))]}):z?i.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(q=z.staff_details)==null?void 0:q.staff_id," - ",RR(z.staff_details)]}):i.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),i.jsx("div",{className:"flex items-center gap-2",children:X?i.jsxs(i.Fragment,{children:[i.jsx("button",{disabled:!T,onClick:()=>{if(!T)return alert("No permission to assign electives");const Y=document.getElementById(`elective-staff-${ee.id}`);if(!(Y!=null&&Y.value))return alert("Select staff member");H(ee.id,Number(Y.value),z==null?void 0:z.id).then(()=>{E(ee.id)}).catch(()=>{})},className:`p-2 rounded-lg transition-colors ${T?"text-green-600 hover:bg-green-50 border border-green-300":"text-gray-400 bg-gray-100 cursor-not-allowed border border-gray-300"}`,title:T?"Save Assignment":"No permission",children:i.jsx(Od,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>E(ee.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:i.jsx(zu,{className:"h-4 w-4"})}),z&&i.jsx("button",{onClick:async()=>{if(confirm("Delete elective teaching assignment for this option?"))try{const Y=await mr(`/api/academics/teaching-assignments/${z.id}/`,{method:"DELETE"});if(Y.ok)alert("Deleted"),E(ee.id),B();else{const L=await Y.text().catch(()=>null);alert("Failed: "+(L||Y.status))}}catch(Y){console.error(Y),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:i.jsx(Yx,{className:"h-4 w-4"})})]}):i.jsx(i.Fragment,{children:i.jsx("button",{onClick:()=>ne(ee.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:i.jsx(Jf,{className:"h-4 w-4"})})})})]},ee.id)})})]},F.id))})]})]})})}function rOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1),[a,s]=x.useState(null);x.useEffect(()=>{o()},[]),x.useEffect(()=>{e.length>0&&a===null&&s(e[0].section_id)},[e]);async function o(){n(!0);try{const u=await mr("/api/academics/my-students/");if(!u.ok)throw new Error(await u.text());const d=await u.json();t(d.results||[])}catch(u){console.error(u),alert("Failed to load your students. See console for details.")}finally{n(!1)}}const l=e.find(u=>u.section_id===a),c=[...(l==null?void 0:l.students)||[]].sort((u,d)=>u.reg_no.localeCompare(d.reg_no));return r?i.jsx("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Lu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),i.jsx("span",{className:"text-slate-600 text-lg",children:"Loading student information..."})]})}):i.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:i.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:i.jsx(q1,{className:"w-8 h-8 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Students"}),i.jsx("p",{className:"text-slate-600 text-sm",children:"View and manage your assigned student profiles"})]})]}),i.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-slate-100 to-indigo-100 rounded-lg",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(us,{className:"w-5 h-5 text-indigo-700"}),i.jsxs("span",{className:"text-sm font-semibold text-indigo-900",children:["Total: ",e.reduce((u,d)=>u+d.students.length,0)]})]})})]})}),e.length===0&&!r&&i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:i.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[i.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:i.jsx(us,{className:"w-16 h-16 text-slate-400"})}),i.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No Students Assigned"}),i.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned to your sections yet."})]})}),e.length>0&&i.jsx("div",{className:"mb-6 flex flex-wrap gap-3",children:e.map(u=>{const d=a===u.section_id;return i.jsxs("button",{onClick:()=>s(u.section_id),className:`px-5 py-2 rounded-full font-medium text-sm transition-all duration-200 flex items-center gap-2 ${d?"bg-gradient-to-r from-indigo-600 to-cyan-500 text-white shadow-lg shadow-indigo-200":"bg-white text-slate-700 border border-slate-200 hover:border-indigo-300 hover:bg-slate-50"}`,children:[u.section_name,i.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${d?"bg-white/25 text-white":"bg-slate-100 text-slate-700"}`,children:u.students.length})]},u.section_id)})}),c.length>0&&i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-indigo-50 border-b-2 border-slate-200",children:[i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"S.No"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Registration No"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Student Name"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Email"})]})}),i.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map((u,d)=>i.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[i.jsx("td",{className:"py-3 px-4",children:i.jsx("span",{className:"text-sm font-medium text-slate-600",children:d+1})}),i.jsx("td",{className:"py-3 px-4",children:i.jsx("span",{className:"text-sm font-semibold text-slate-900",children:u.reg_no})}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Cee,{className:"w-5 h-5 text-slate-400"}),i.jsx("span",{className:"text-sm font-medium text-slate-900",children:u.first_name&&u.last_name?`${u.first_name} ${u.last_name}`.trim():u.username})]})}),i.jsx("td",{className:"py-3 px-4",children:i.jsx("div",{className:"flex items-center gap-2 text-slate-600",children:u.email?i.jsxs(i.Fragment,{children:[i.jsx(nN,{className:"w-4 h-4 text-slate-400"}),i.jsx("span",{className:"text-sm",children:u.email})]}):i.jsx("span",{className:"text-sm text-slate-400",children:"-"})})})]},u.id))})]})})})]})}const nOe=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function BR(e){if(!e)return"";if(typeof e=="string"){const a=e.trim();return a.split(/[\s\-\_]+/)[0]||a.slice(0,15)+(a.length>15?"":"")}if(e.course_code)return e.course_code;const t=e.course_name||e.course||e.subject_text||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(a=>a.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function aOe(){const[e,t]=x.useState(null),[r,n]=x.useState([]),[a,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(null);x.useEffect(()=>{d()},[]);async function d(){try{const f=await mr("/api/accounts/me/");if(!f.ok)throw new Error(await f.text());const p=await f.json(),h=p.profile||{};u(p.id),h.section_id&&t(h.section_id)}catch(f){console.error(f)}}return x.useEffect(()=>{e&&(l(!0),(async()=>{try{const f=await mr(`/api/timetable/section/${e}/timetable/`);if(!f.ok)throw new Error(await f.text());let h=(await f.json()).results||[];n(h);const m=[];for(const g of h||[])for(const b of g.assignments||[])m.find(y=>y.id===b.period_id)||m.push({id:b.period_id,index:b.period_index,is_break:b.is_break,label:b.label});m.sort((g,b)=>(g.index||0)-(b.index||0)),s(m)}catch(f){console.error(f)}finally{l(!1)}})())},[e]),i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:i.jsx(cs,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),i.jsx("p",{className:"text-gray-600",children:"View your class schedule for the week"})]})]})}),o&&i.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:i.jsx("div",{className:"text-center",children:i.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[i.jsx(Lu,{className:"animate-spin h-5 w-5 text-indigo-600"}),i.jsx("span",{children:"Loading timetable..."})]})})}),!o&&!e&&i.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:i.jsxs("div",{className:"text-center",children:[i.jsx($u,{className:"h-12 w-12 text-amber-500 mx-auto mb-3"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Section Not Assigned"}),i.jsx("p",{className:"text-gray-600",children:"You are not assigned to a section or your profile is incomplete."})]})}),!o&&e&&i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-100",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(tu,{className:"h-5 w-5 text-indigo-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[i.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[100px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),a.map(f=>i.jsx("th",{className:"px-4 py-3 text-left min-w-[140px]",children:i.jsx("div",{className:"text-sm font-bold text-indigo-700",children:f.is_break||f.is_lunch?f.label||(f.is_break?"Break":"Lunch"):f.label||`${f.start_time||""}${f.start_time&&f.end_time?" - ":""}${f.end_time||""}`})},`period-${f.id}`))]})}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:nOe.map((f,p)=>i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:f}),a.map(h=>{const g=((r.find(y=>y.day===p+1)||{assignments:[]}).assignments||[]).filter(y=>y.period_id===h.id),b=g.some(y=>y.is_special);return i.jsx("td",{className:`px-4 py-3 align-top ${b&&g.some(y=>!y.is_special)?"bg-red-50":""}`,children:h.is_break?i.jsx("div",{className:"flex items-center justify-center py-2",children:i.jsx("span",{className:"text-sm text-gray-500 italic",children:h.label||"Break"})}):g&&g.length?i.jsx("div",{className:"space-y-2",children:g.map((y,v)=>{var _,C;const w=b&&!y.is_special;return i.jsxs("div",{className:`rounded-lg p-2.5 ${y.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:[i.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[i.jsx(ls,{className:"h-3 w-3"}),y.is_special?y.timetable_name||"Special":BR(y.curriculum_row||y.subject_text),y.is_special&&i.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",BR(y.curriculum_row||y.subject_text)]})]}),i.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[i.jsx(us,{className:"h-3 w-3"}),"Staff: ",((_=y.staff)==null?void 0:_.username)||""]}),w&&i.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden by special"}),y.is_special&&i.jsxs("div",{className:"text-xs text-amber-700 mt-1 flex items-center gap-1",children:[i.jsx(cs,{className:"h-3 w-3"}),y.date||"","  ",h.label||""]}),y.subject_batch&&i.jsxs("div",{className:"text-xs text-blue-700 mt-1 font-medium",children:["Batch: ",y.subject_batch.name]}),w&&y.elective_subject&&i.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Elective: ",y.elective_subject.course_code||y.elective_subject.course_name]})]},`${y.id||((C=y.curriculum_row)==null?void 0:C.id)||v}`)})}):i.jsx("div",{className:"flex items-center justify-center py-4",children:i.jsx("span",{className:"text-gray-300 text-sm",children:""})})},`cell-${p}-${h.id}`)})]},`day-${p}`))})]})})]})]})})}const iOe=["Mon","Tue","Wed","Thu","Fri","Sat"];function IR(e){if(!e)return"";if(typeof e=="string"){const a=e.trim();return a.split(/[\s\-\_]+/)[0]||a.slice(0,15)+(a.length>15?"":"")}const t=(e==null?void 0:e.course_name)||(e==null?void 0:e.course)||(e==null?void 0:e.subject_text)||(e==null?void 0:e.course_code)||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(a=>a.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function sOe(e){var a,s;if(Array.isArray(e)){const o=[],l=new Set;for(const c of e){const u=c.section,d=c.subject_batch||(u==null?void 0:u.batch);let f="";d!=null&&d.name&&(f+=d.name),u!=null&&u.name&&(f+=(f?" / ":"")+u.name),f||(u!=null&&u.id?f="Sec "+u.id:(a=c.subject_batch)!=null&&a.name&&(f=c.subject_batch.name)),f&&!l.has(f)&&(o.push(f),l.add(f))}return o.length?o.join(" + "):""}const t=e.section,r=e.subject_batch||(t==null?void 0:t.batch);let n="";return r!=null&&r.name&&(n+=r.name),t!=null&&t.name&&(n+=(n?" / ":"")+t.name),n||(t!=null&&t.id?n="Sec "+t.id:(s=e.subject_batch)!=null&&s.name&&(n=e.subject_batch.name)),n||""}function oOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[a,s]=x.useState(!1);x.useEffect(()=>{o()},[]);async function o(){s(!0);try{const l=new Date().toISOString().slice(0,10),c=await mr(`/api/timetable/staff/?date=${l}`);if(!c.ok)throw new Error(await c.text());const u=await c.json();t(u.results||[]);const d=await mr("/api/timetable/templates/");if(d.ok){const f=await d.json(),p=f.find(h=>h.is_active)||f[0];if(p&&p.periods)n(p.periods);else{const h=[];for(const m of u.results||[])for(const g of m.assignments||[])h.find(b=>b.id===g.period_id)||h.push({id:g.period_id,index:g.period_index,is_break:g.is_break,is_lunch:g.is_lunch,label:g.label,start_time:g.start_time,end_time:g.end_time});h.sort((m,g)=>(m.index||0)-(g.index||0)),n(h)}}}catch(l){console.error(l)}finally{s(!1)}}return i.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:i.jsx(cs,{className:"h-6 w-6 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),i.jsx("p",{className:"text-gray-600",children:"View your assigned teaching schedule"})]})]})}),a?i.jsx("div",{className:"bg-white rounded-lg shadow-sm p-8",children:i.jsx("div",{className:"text-center",children:i.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[i.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),i.jsx("span",{children:"Loading timetable..."})]})})}):i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(tu,{className:"h-5 w-5 text-blue-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Day / Period"}),r.map(l=>i.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700 min-w-[120px]",children:l.label||`${l.start_time||""}${l.start_time&&l.end_time?" - ":""}${l.end_time||""}`},l.id))]})}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:iOe.map((l,c)=>i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-4 py-3 font-semibold text-gray-900 bg-gray-50",children:l}),r.map(u=>{const f=((e.find(h=>h.day===c+1)||{assignments:[]}).assignments||[]).filter(h=>h.period_id===u.id),p=f.some(h=>h.is_special);return i.jsx("td",{className:`px-4 py-3 ${p&&f.some(h=>!h.is_special)?"bg-red-50":""}`,children:u.is_break||u.is_lunch?i.jsx("div",{className:"flex items-center justify-center",children:i.jsx("span",{className:"text-sm text-gray-500 italic",children:u.label||(u.is_break?"Break":"Lunch")})}):f&&f.length?i.jsx("div",{className:"space-y-2",children:(()=>{var m;const h={};for(const g of f){let b="";g.is_special?b=`special_${g.timetable_name||g.id}`:g.curriculum_row&&g.curriculum_row.id?b=`curr_${g.curriculum_row.id}`:g.subject_batch&&g.subject_batch.id?b=`batch_${g.subject_batch.id}`:g.elective_subject&&g.elective_subject.id?b=`elective_${g.elective_subject.id}`:g.subject_text?b=`subj_${(g.subject_text||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:b=`section_${((m=g.section)==null?void 0:m.id)||Math.random()}`,h[b]=h[b]||[],h[b].push(g)}return Object.keys(h).map((g,b)=>{const y=h[g],v=y[0],w=p&&!v.is_special,_=v.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200";return i.jsxs("div",{className:`rounded-lg p-2.5 ${_}`,children:[i.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight",children:[v.is_special?v.timetable_name||"Special":IR(v.elective_subject||v.curriculum_row||v.subject_text),v.is_special&&i.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",IR(v.elective_subject||v.curriculum_row||v.subject_text)]})]}),i.jsx("div",{className:"text-xs text-blue-700 font-medium mt-1",children:sOe(y)}),w&&i.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden"}),v.is_special&&i.jsx("div",{className:"text-xs text-amber-700 mt-1",children:v.date||""})]},b)})})()}):i.jsx("div",{className:"flex items-center justify-center py-4",children:i.jsx("span",{className:"text-gray-300 text-sm",children:""})})},u.id)})]},l))})]})})]})]})})}async function lOe(e){const t=e?`/api/academics/staff/${e}/assigned-subjects/`:"/api/academics/staff/assigned-subjects/",r=await mr(t);if(!r.ok)throw new Error("Failed to fetch assigned subjects");const n=await r.json();return n.results||n}async function hv(){const e=await mr("/api/academics/subject-batches/?page_size=0");if(!e.ok)throw new Error("Failed to fetch subject batches");const t=await e.json();return t.results||t}async function cOe(e){var a;const t=await mr("/api/academics/subject-batches/",{method:"POST",body:JSON.stringify(e)}),r=t.headers.get("content-type")||"",n=await t.text();if(!t.ok){const s=r.includes("application/json")&&((a=JSON.parse(n))==null?void 0:a.detail)||n;throw new Error(s)}return r.includes("application/json")?JSON.parse(n):n}function uOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[a,s]=x.useState({}),[o,l]=x.useState(!0),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(""),[m,g]=x.useState([]),[b,y]=x.useState([]),[v,w]=x.useState(null),[_,C]=x.useState([]),[j,A]=x.useState(!1),[M,P]=x.useState([]),[R,N]=x.useState(null),[T,B]=x.useState([]);x.useEffect(()=>{G()},[]);async function G(){l(!0),u(null);try{const F=await lOe(),ee=await hv();t(F),n(ee)}catch(F){console.error(F),u((F==null?void 0:F.message)||"Failed to load assigned subjects")}finally{l(!1)}}async function re(F){var z;console.log("openPickerForAssignment clicked",F),u(null);const ee=a[F.id]||`Batch for ${F.subject_code||F.subject_name||F.id}`;N(F),s(X=>({...X,[F.id]:ee}));try{const X=await mr(`/api/academics/sections/${F.section_id}/students/`);if(!X.ok){const L=await X.text();throw new Error(L||"Failed to load students")}const J=await X.json();let q=J.results||J;const Y=F.curriculum_row_id||((z=F.curriculum_row)==null?void 0:z.id);if(Y){const L=new Set;for(const U of r)if(U.curriculum_row&&U.curriculum_row.id===Y)for(const ce of U.students||[])L.add(ce.id);q=q.filter(U=>!L.has(U.id))}P(q),B(q.map(L=>L.id)),A(!0)}catch(X){console.error("openPickerForAssignment error",X),u((X==null?void 0:X.message)||String(X)),alert("Failed to load students: "+((X==null?void 0:X.message)||X))}}async function xe(F){u(null),N(F),P([]),B([]);try{let ee;if(F.section_id){const J=await mr(`/api/academics/sections/${F.section_id}/students/`);if(!J.ok)throw new Error(await J.text());ee=await J.json()}else if(F.elective_subject_id){const J=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${F.elective_subject_id}`);if(!J.ok)throw new Error(await J.text());ee=await J.json()}else throw new Error("No student mapping available for this assignment");const X=(ee.results||ee||[]).map(J=>({id:Number(J.id),reg_no:String(J.reg_no??J.regno??""),name:String(J.username??J.name??J.full_name??""),section:J.section_name??J.section??null,section_id:J.section_id??null}));P(X),B(X.map(J=>J.id)),A(!0)}catch(ee){console.error("openListStudents error",ee),u((ee==null?void 0:ee.message)||String(ee)),alert("Failed to load students: "+((ee==null?void 0:ee.message)||ee))}}function _e(F){B(ee=>ee.includes(F)?ee.filter(z=>z!==F):[...ee,F])}async function V(){if(!R)return;const F=r.map(J=>{const q=String(J.name||"").match(/Batch\s*(\d+)/i);return q?parseInt(q[1],10):null}).filter(Boolean),X={name:`Batch ${(F.length?Math.max(...F):0)+1}`,student_ids:T};R.curriculum_row_id&&(X.curriculum_row_id=R.curriculum_row_id);try{await cOe(X);const J=await hv();n(J),A(!1),P([]),N(null),alert("Batch created for subject")}catch(J){console.error(J),alert("Failed to create batch: "+((J==null?void 0:J.message)||J))}}async function K(F){if(f(F.id),h(F.name||""),w(F),y((F.students||[]).map(ee=>ee.id)),F.curriculum_row&&F.curriculum_row.id)try{const ee=e.find(z=>z.curriculum_row_id===F.curriculum_row.id);if(ee&&ee.section_id){const z=await mr(`/api/academics/sections/${ee.section_id}/students/`);if(z.ok){const X=await z.json(),J=X.results||X;g(J)}}}catch(ee){console.error("Failed to load students for batch editing:",ee),g(F.students||[])}else g(F.students||[])}async function de(){if(d)try{const F={name:p,student_ids:b},ee=await mr(`/api/academics/subject-batches/${d}/`,{method:"PATCH",body:JSON.stringify(F)});if(!ee.ok)throw new Error(await ee.text());const z=await hv();n(z),ne(),alert("Batch updated successfully")}catch(F){console.error("saveBatchEdit failed",F),alert("Failed to update batch: "+((F==null?void 0:F.message)||F))}}function ne(){f(null),h(""),w(null),g([]),y([])}function E(F){y(ee=>ee.includes(F)?ee.filter(z=>z!==F):[...ee,F])}async function Z(F){if(confirm("Delete this batch?"))try{const ee=await mr(`/api/academics/subject-batches/${F}/`,{method:"DELETE"});if(!ee.ok)throw new Error(await ee.text());const z=await hv();n(z),alert("Batch deleted")}catch(ee){console.error("deleteBatch failed",ee),alert("Failed to delete: "+((ee==null?void 0:ee.message)||ee))}}const H={};return r.forEach(F=>{const ee=F.curriculum_row&&F.curriculum_row.id?String(F.curriculum_row.id):"___no_cr";H[ee]||(H[ee]=[]),H[ee].push(F)}),i.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 via-white to-gray-50 p-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-white to-blue-50 rounded-xl shadow-lg p-6 mb-6",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-xl flex items-center justify-center",children:i.jsx(ls,{className:"w-6 h-6 text-blue-700"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Assigned Subjects"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View all subjects assigned to you for the current academic session"})]})]}),!o&&!c&&e.length>0&&i.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-full",children:[i.jsx("span",{className:"text-sm font-medium",children:"Total Subjects"}),i.jsx("span",{className:"bg-white/20 text-white px-3 py-1 rounded-full text-sm font-semibold",children:e.length})]})]})}),o&&i.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[i.jsx("div",{className:"w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4"}),i.jsx("p",{className:"text-gray-600 font-medium",children:"Loading your assigned subjects..."})]}),c&&!o&&i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx($u,{className:"w-8 h-8 text-red-600"})}),i.jsx("p",{className:"text-red-600 font-medium mb-4",children:c}),i.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",onClick:G,children:"Try Again"})]}),!o&&!c&&e.length===0&&i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Dee,{className:"w-8 h-8 text-gray-400"})}),i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Subjects Assigned"}),i.jsx("p",{className:"text-gray-600",children:"You don't have any subjects assigned for the current session."})]}),!o&&!c&&e.length>0&&i.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[i.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"S.No"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Subject"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Section"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Batch"}),i.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Semester"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:e.map((F,ee)=>i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("span",{className:"text-sm font-medium text-gray-900",children:ee+1})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900",children:F.subject_name||"Unnamed Subject"}),F.subject_code&&i.jsx("div",{className:"text-sm text-blue-600 font-medium",children:F.subject_code})]}),i.jsx("div",{className:"flex flex-wrap gap-2",children:F.section_id?i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>re(F),children:"Create Batch"}),i.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>xe(F),children:"List Students"})]}):i.jsxs(i.Fragment,{children:[i.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>xe(F),children:"List Students"}),i.jsx("span",{className:"text-xs text-gray-500 px-2 py-1",children:"Department-wide elective"})]})})]})}),i.jsx("td",{className:"px-6 py-4",children:F.section_name?i.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 text-blue-700 px-3 py-1 rounded-full w-fit",children:[i.jsx(us,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:F.section_name})]}):i.jsx("span",{className:"text-gray-400",children:""})}),i.jsx("td",{className:"px-6 py-4",children:F.batch?i.jsxs("div",{className:"flex items-center gap-2 bg-green-50 text-green-700 px-3 py-1 rounded-full w-fit",children:[i.jsx(cs,{className:"w-4 h-4"}),i.jsx("span",{className:"text-sm font-medium",children:F.batch})]}):i.jsx("span",{className:"text-gray-400",children:""})}),i.jsx("td",{className:"px-6 py-4",children:F.semester!=null?i.jsxs("span",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold",children:["Sem ",F.semester]}):i.jsx("span",{className:"text-gray-400",children:""})})]},F.id))})]})})}),i.jsx("div",{className:"mt-6",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(us,{className:"w-5 h-5 text-blue-600"}),"Student Subject Batches"]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Existing Batches"}),r.length===0&&i.jsxs("div",{className:"text-center py-8 text-gray-500",children:[i.jsx(us,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),i.jsx("p",{children:"No batches created yet"})]}),e.map(F=>{const ee=F.curriculum_row_id?String(F.curriculum_row_id):null,z=ee?H[ee]||[]:[];return!z||z.length===0?null:i.jsxs("div",{className:"mb-6 border-b border-gray-100 pb-4 last:border-b-0",children:[i.jsx("div",{className:"font-bold text-gray-900 mb-3",children:F.subject_name||F.subject_code||"Unnamed Subject"}),i.jsx("div",{className:"space-y-3",children:z.map(X=>i.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:X.name}),i.jsx("div",{className:"text-sm text-gray-600",children:i.jsxs("span",{className:"font-medium",children:[(X.students||[]).length," students"]})})]}),i.jsxs("div",{className:"ml-4 flex gap-2",children:[i.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>K(X),children:"Edit"}),i.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>Z(X.id),children:"Delete"})]})]})},X.id))})]},`subject-${F.id}`)}),(()=>{const F=r.filter(ee=>{const z=ee.curriculum_row&&ee.curriculum_row.id?ee.curriculum_row.id:null;return!z||!e.some(X=>X.curriculum_row_id===z)});return F.length===0?null:i.jsxs("div",{className:"mt-6",children:[i.jsx("div",{className:"font-bold text-gray-900 mb-3",children:"Other Batches"}),i.jsx("div",{className:"space-y-3",children:F.map(ee=>i.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:ee.name}),i.jsx("div",{className:"text-sm text-gray-600",children:i.jsxs("span",{className:"font-medium",children:[(ee.students||[]).length," students"]})})]}),i.jsxs("div",{className:"ml-4 flex gap-2",children:[i.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>K(ee),children:"Edit"}),i.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>Z(ee.id),children:"Delete"})]})]})},`other-${ee.id}`))})]})})()]})]})}),j&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:a[(R==null?void 0:R.id)||""]||"Create Batch"}),i.jsx("div",{className:"text-sm text-gray-600",children:(R==null?void 0:R.subject_name)||(R==null?void 0:R.subject_code)})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:()=>{A(!1),P([]),N(null)},children:"Cancel"}),i.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:V,children:"Create Batch"})]})]})}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-4",children:[i.jsxs("h4",{className:"font-semibold text-gray-900 mb-2",children:["Students (",M.length,")"]}),i.jsx("p",{className:"text-sm text-gray-600",children:"Select students to include in this batch"})]}),i.jsx("div",{className:"max-h-96 overflow-y-auto",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:M.map(F=>i.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[i.jsx("input",{type:"checkbox",checked:T.includes(F.id),onChange:()=>_e(F.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:F.username||F.full_name||F.reg_no}),F.reg_no&&i.jsx("div",{className:"text-xs text-gray-500",children:F.reg_no})]})]},F.id))})})]})]})}),d&&v&&i.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"Edit Batch"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Modify batch name and student assignments"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:ne,children:"Cancel"}),i.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:de,children:"Save Changes"})]})]})}),i.jsxs("div",{className:"p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Batch Name"}),i.jsx("input",{type:"text",value:p,onChange:F=>h(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter batch name"})]}),i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center justify-between",children:[i.jsxs("span",{children:["Students (",b.length," selected)"]}),i.jsx("div",{className:"text-sm text-gray-600",children:"Click to add/remove students"})]}),i.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:m.length===0?i.jsxs("div",{className:"text-center text-gray-500 py-4",children:[i.jsx(us,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),i.jsx("p",{children:"No students available for this batch"})]}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:m.map(F=>i.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${b.includes(F.id)?"border-blue-300 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[i.jsx("input",{type:"checkbox",checked:b.includes(F.id),onChange:()=>E(F.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:F.username||F.full_name||F.reg_no}),F.reg_no&&i.jsx("div",{className:"text-xs text-gray-500",children:F.reg_no})]})]},F.id))})})]})]})]})})]})}function dOe(){const[e,t]=x.useState(new Date().toISOString().slice(0,10)),[r,n]=x.useState([]),[a,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState([]),[d,f]=x.useState({}),[p,h]=x.useState(!1),[m,g]=x.useState(!1),[b,y]=x.useState(!1),[v,w]=x.useState(new Date().toISOString().slice(0,7)),[_,C]=x.useState([]),[j,A]=x.useState({}),[M,P]=x.useState([]),[R,N]=x.useState(!1),[T,B]=x.useState({}),[G,re]=x.useState({}),[xe,_e]=x.useState({}),[V,K]=x.useState(!1),[de,ne]=x.useState(null),[E,Z]=x.useState(null);x.useEffect(()=>{F()},[e]);function H(ae){const he={};for(const ze of ae){let ke="";if(ze.period&&ze.period.index!==void 0){const qe=ze.period.index;ze.subject_batch_id?ke=`batch_${qe}_${ze.subject_batch_id}`:ze.elective_subject_id?ke=`elective_${qe}_${ze.teaching_assignment_id||ze.elective_subject_id}`:ze.subject?ke=`subj_${qe}_${String(ze.subject||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:ke=`section_${qe}_${ze.section_id}`}else ze.subject_batch_id?ke=`batch_${ze.subject_batch_id}`:ze.elective_subject_id?ke=`elective_${ze.teaching_assignment_id||ze.elective_subject_id}`:ze.subject?ke=`subj_${String(ze.subject).replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:ke=`section_${ze.section_id}`;if(!he[ke])he[ke]={...ze,section_ids:[ze.section_id],section_names:[ze.section_name],attendance_session_ids:[ze.attendance_session_id]};else{const qe=he[ke];qe.section_ids.includes(ze.section_id)||qe.section_ids.push(ze.section_id),ze.section_name&&!qe.section_names.includes(ze.section_name)&&qe.section_names.push(ze.section_name),qe.attendance_session_ids=Array.from(new Set([...qe.attendance_session_ids||[],ze.attendance_session_id]))}}return Object.keys(he).map(ze=>({...he[ze],id:ze}))}async function F(){s(!0);try{const ae=await mr(`/api/academics/staff/periods/?date=${e}`);if(!ae.ok)throw new Error("Failed to load periods");const he=await ae.json();n(he.results||[])}catch(ae){console.error("fetchPeriods",ae),n([])}finally{s(!1)}}function ee(ae){var Tt;const he=ae.section_ids&&Array.isArray(ae.section_ids)&&ae.section_ids.length?ae.section_ids:[ae.section_id],ze=r.filter(vt=>!vt||vt.attendance_session_locked||!he.includes(vt.section_id)||ae.id&&vt.id===ae.id?!1:!!(ae.subject_batch_id&&vt.subject_batch_id===ae.subject_batch_id||ae.teaching_assignment_id&&vt.teaching_assignment_id===ae.teaching_assignment_id||ae.elective_subject_id&&vt.elective_subject_id===ae.elective_subject_id||ae.subject&&vt.subject===ae.subject));if(ze.length===0)return null;const ke=[...ze].sort((vt,Xe)=>vt.period.index-Xe.period.index),qe=((Tt=ae.period)==null?void 0:Tt.index)||ae.period&&ae.period.index||0,Ie=ke.find(vt=>vt.period.index>qe),Ve=[...ke].reverse().find(vt=>vt.period.index<qe),Qe=4;return Ie&&Ie.period.index-qe<=Qe?Ie:Ve&&qe-Ve.period.index<=Qe?Ve:null}function z(ae){const he=ee(ae);he?(ne(ae),Z(he),K(!0)):X(ae)}async function X(ae){l(ae),u([]),f({}),s(!0);try{let he=[];if(ae.section_ids&&Array.isArray(ae.section_ids)&&ae.section_ids.length>1)if(ae.elective_subject_id){const Ie=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${ae.elective_subject_id}`);Ie.ok&&(he=(await Ie.json()).results||[])}else{const Ie=[];for(const Qe of ae.section_ids)Ie.push(mr(`/api/academics/sections/${Qe}/students/`).then(Tt=>Tt.ok?Tt.json():{results:[]}).catch(()=>({results:[]})));const Ve=await Promise.allSettled(Ie);for(const Qe of Ve)if(Qe.status==="fulfilled"){const Tt=Qe.value||{},vt=Tt.results||Tt.students||[];he=he.concat(vt)}}else if(ae.elective_subject_id){const Ie=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${ae.elective_subject_id}`);Ie.ok&&(he=(await Ie.json()).results||[])}else if(ae.subject_batch_id){const Ie=await mr(`/api/academics/subject-batches/${ae.subject_batch_id}/`);if(Ie.ok){const Ve=await Ie.json();he=Ve.students||Ve.results||[]}}else{const Ie=await mr(`/api/academics/sections/${ae.section_id}/students/`);Ie.ok&&(he=(await Ie.json()).results||[])}const ze={};for(const Ie of he||[])Ie&&Ie.id&&(ze[Ie.id]=Ie);const ke=Object.values(ze);u((ke||[]).map(Ie=>({id:Number(Ie.id),reg_no:String(Ie.reg_no||Ie.regno||String(Ie.id)),name:String(Ie.name??Ie.full_name??Ie.username??""),username:String(Ie.username??Ie.name??""),section:Ie.section_name??Ie.section??null,section_id:Ie.section_id??null})));const qe={};if((ke||[]).forEach(Ie=>qe[Ie.id]="P"),f(qe),ae.attendance_session_id||ae.attendance_session_ids&&ae.attendance_session_ids.length)try{const Ve=(ae.attendance_session_ids&&ae.attendance_session_ids.length?ae.attendance_session_ids:[ae.attendance_session_id]).map(vt=>mr(`/api/academics/period-attendance/${vt}/`).then(Xe=>Xe.ok?Xe.json():null).catch(()=>null)),Qe=await Promise.allSettled(Ve),Tt={...qe};for(const vt of Qe){if(vt.status!=="fulfilled"||!vt.value)continue;(vt.value.records||[]).forEach(ct=>{const nt=ct.student_pk||ct.student&&ct.student.id||null;nt&&(Tt[nt]=ct.status||Tt[nt]||"A")})}f(Tt)}catch(Ie){console.error("load session records",Ie)}}catch(he){console.error("openPeriod",he)}finally{s(!1)}}function J(ae,he){f(ze=>({...ze,[ae]:he}))}async function q(){if(o){h(!0);try{const ae=c.map(Ve=>({student_id:Ve.id,status:d[Ve.id]||"P"})),he=o.consecutive_periods&&Array.isArray(o.consecutive_periods)&&o.consecutive_periods.length>0?o.consecutive_periods.map(Ve=>Ve.period_id):[o.period.id],ze=o.section_ids&&Array.isArray(o.section_ids)&&o.section_ids.length>0?o.section_ids:[o.section_id],ke={};for(const Ve of ze){const Qe=c.filter(Tt=>(Tt.section_id||null)===Ve).map(Tt=>({student_id:Tt.id,status:d[Tt.id]||"P"}));if(Qe.length===0&&o.section_name){const Tt=new Set(String(o.section_name).split(" + ").map(Xe=>Xe.trim())),vt=c.filter(Xe=>Tt.has(String(Xe.section_name||Xe.section||"").trim())).map(Xe=>({student_id:Xe.id,status:d[Xe.id]||"P"}));ke[Ve]=vt.length?vt:c.map(Xe=>({student_id:Xe.id,status:d[Xe.id]||"P"}))}else ke[Ve]=Qe.length?Qe:c.map(Tt=>({student_id:Tt.id,status:d[Tt.id]||"P"}))}const qe=[];for(const Ve of he)for(const Qe of ze){const Tt={section_id:Qe,period_id:Ve,teaching_assignment_id:o.teaching_assignment_id??null,date:e,records:ke[Qe]||[]};console.log("Saving attendance for section",Qe,"period",Ve,Tt);const vt=await mr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify(Tt)}),Xe=await(vt.ok?vt.json().catch(()=>null):vt.json().catch(()=>null));qe.push({section:Qe,period:Ve,ok:vt.ok,data:Xe})}const Ie=qe.filter(Ve=>!Ve.ok);if(Ie.length)console.error("Some saves failed:",Ie),alert("Attendance saved for some sections/periods, but failed for others. Check console for details.");else{await F();const Ve=o.combined_period_label||o.period&&(o.period.label||`Period ${o.period.index}`);alert(`Attendance saved successfully!

Date: ${e}
Period(s): ${Ve}
Sections: ${ze.length}
Students: ${c.length}`),l(null)}}catch(ae){console.error("saveMarks error:",ae),alert("Failed to save attendance: "+(ae instanceof Error?ae.message:String(ae)))}finally{h(!1)}}}async function Y(){var ae,he,ze,ke,qe,Ie;if(!(!de||!E)){K(!1);try{const Ve=de;let Qe=[];if(Ve.section_ids&&Array.isArray(Ve.section_ids)&&Ve.section_ids.length>1){const nt=Ve.section_ids.map(Se=>mr(`/api/academics/sections/${Se}/students/`).then(Te=>Te.ok?Te.json():{results:[]}).catch(()=>({results:[]})));if(Ve.elective_subject_id){const Se=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${Ve.elective_subject_id}`);Se.ok&&(Qe=(await Se.json()).results||[])}else{const Se=await Promise.allSettled(nt);for(const Te of Se)if(Te.status==="fulfilled"){const Dt=Te.value||{};Qe=Qe.concat(Dt.results||Dt.students||[])}}}else if(Ve.elective_subject_id){const nt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${Ve.elective_subject_id}`);nt.ok&&(Qe=(await nt.json()).results||[])}else if(Ve.subject_batch_id){const nt=await mr(`/api/academics/subject-batches/${Ve.subject_batch_id}/`);if(nt.ok){const Se=await nt.json();Qe=Se.students||Se.results||[]}}else{const nt=await mr(`/api/academics/sections/${Ve.section_id}/students/`);nt.ok&&(Qe=(await nt.json()).results||[])}const Tt={};for(const nt of Qe||[])nt&&nt.id&&(Tt[nt.id]=nt);let vt=Object.values(Tt).map(nt=>({id:Number(nt.id),reg_no:String(nt.reg_no||nt.regno||String(nt.id)),username:nt.username||nt.name||"",section_id:nt.section_id||nt.sectionId||null,section_name:nt.section_name||nt.section||""}));if((!vt||vt.length===0)&&Ve.section_ids&&Array.isArray(Ve.section_ids)&&Ve.section_ids.length>0){const nt=Ve.section_ids.map(wt=>mr(`/api/academics/sections/${wt}/students/`).then(Pt=>Pt.ok?Pt.json():{results:[]}).catch(()=>({results:[]}))),Se=await Promise.allSettled(nt),Te=[];for(const wt of Se)if(wt.status==="fulfilled"){const Pt=wt.value||{},Wt=Pt.results||Pt.students||[];Te.push(...Wt)}const Dt={};for(const wt of Te)wt&&wt.id&&(Dt[wt.id]=wt);vt=Object.values(Dt).map(wt=>({id:Number(wt.id),reg_no:String(wt.reg_no||wt.regno||String(wt.id)),username:wt.username||wt.name||"",section_id:wt.section_id||wt.sectionId||null,section_name:wt.section_name||wt.section||""}))}const Xe={};vt.forEach(nt=>Xe[nt.id]="P"),u(vt),f(Xe);const Be=`${((ae=de.period)==null?void 0:ae.label)||`Period ${(he=de.period)==null?void 0:he.index}`} & ${((ze=E.period)==null?void 0:ze.label)||`Period ${(ke=E.period)==null?void 0:ke.index}`}`,ct=Ve.section_names&&Ve.section_names.length?Ve.section_names.join(" + "):Ve.section_name||"";l({...de,consecutive_periods:[{period_id:de.period.id,label:((qe=de.period)==null?void 0:qe.label)||""},{period_id:E.period.id,label:((Ie=E.period)==null?void 0:Ie.label)||""}],combined_period_label:Be,section_name:ct,section_ids:Ve.section_ids||[Ve.section_id]})}catch(Ve){console.error("markBothPeriods error:",Ve),alert("Failed to prepare marking for both periods: "+(Ve instanceof Error?Ve.message:String(Ve)))}finally{K(!1),ne(null),Z(null)}}}function L(){de&&(K(!1),X(de),ne(null),Z(null))}async function U(){var ke;if(!o||!o.attendance_session_id){alert("No active attendance session to lock/unlock");return}const ae=o.attendance_session_locked,he=o.attendance_session_id;if(window.confirm(ae?"Are you sure you want to request an unlock for this attendance session? Unlocking requires approval.":"Are you sure you want to lock this attendance session? This will prevent any further changes to attendance records.")){g(!0);try{if(ae){const qe=await mr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:o.attendance_session_id,note:""})});if(qe.ok){const Ie=await qe.json();console.log("Unlock request created:",Ie),alert('Unlock request submitted successfully! Check the "My Requests" button in the Analytics page to view the status.');try{l(Ve=>Ve&&{...Ve,unlock_request_status:Ie.status,unlock_request_id:Ie.id}),n(Ve=>Ve.map(Qe=>Qe.attendance_session_id&&he&&Qe.attendance_session_id===he?{...Qe,unlock_request_status:Ie.status,unlock_request_id:Ie.id}:Qe))}catch(Ve){console.warn("Failed to update local unlock status",Ve)}}else{const Ie=await qe.json().catch(()=>({}));if(qe.status===400&&((ke=Ie.detail)!=null&&ke.includes("already pending")))alert("An unlock request for this session already exists and is pending approval. Please check the Requests section for status.");else throw new Error(Ie.detail||"Failed to create unlock request")}}else{const qe=await mr(`/api/academics/period-attendance/${o.attendance_session_id}/lock/`,{method:"POST"});if(!qe.ok){const Ve=await qe.json().catch(()=>({}));throw new Error(Ve.detail||"Failed to lock session")}const Ie=await qe.json();console.log("Session locked successfully:",Ie),l({...o,attendance_session_locked:Ie.is_locked}),await F(),alert("Attendance session locked successfully!")}}catch(qe){console.error("toggleLock error:",qe),alert("Failed to perform lock/unlock: "+(qe instanceof Error?qe.message:String(qe)))}finally{g(!1)}}}async function ce(){try{const ae=await mr("/api/timetable/staff/");if(!ae.ok)throw new Error("Failed to load assignments");const he=await ae.json(),ze=[];for(const ke of he.results||[]){const qe=ke.day;for(const Ie of ke.assignments||[])ze.push({...Ie,_day:qe})}await W(v,ze),C(ze),y(!0),A({}),B({}),re({})}catch(ae){console.error("openBulkModal",ae),alert("Failed to open bulk modal")}}async function W(ae,he){var ze,ke;try{const[qe,Ie]=ae.split("-").map(ct=>parseInt(ct)),Ve=new Date(qe,Ie-1,1).toISOString().slice(0,10),Qe=new Date(qe,Ie,0).toISOString().slice(0,10),Tt=await mr(`/api/academics/period-attendance/?date_after=${Ve}&date_before=${Qe}`);if(!Tt.ok){console.warn("Failed to load existing sessions"),_e({});return}const Xe=(await Tt.json()).results||[],Be={};for(const ct of Xe){const nt=ct.date,Se=((ze=ct.section)==null?void 0:ze.id)||ct.section_id,Te=((ke=ct.period)==null?void 0:ke.id)||ct.period_id;if(!nt||!Se||!Te)continue;const Dt=new Date(nt),wt=Dt.getDay()===0?7:Dt.getDay(),Pt=he.find(Wt=>{var Ot,Ht;return Wt._day===wt&&(Wt.period_id===Te||((Ot=Wt.period)==null?void 0:Ot.id)===Te)&&(Wt.section_id===Se||((Ht=Wt.section)==null?void 0:Ht.id)===Se)});if(Pt){const Wt=Pt.id?String(Pt.id):`${Pt._day}_${Te}_${Se}`;Be[Wt]||(Be[Wt]=new Set),Be[Wt].add(nt)}}_e(Be),console.log("Loaded marked sessions:",Be)}catch(qe){console.error("Error loading marked sessions:",qe),_e({})}}return x.useEffect(()=>{b&&_.length>0&&W(v,_)},[v]),x.useEffect(()=>{async function ae(){var ze,ke,qe,Ie;if(!Object.keys(j).filter(Ve=>j[Ve]).length){P([]);return}N(!0);try{const Ve=[];for(const vt of _){const Xe=vt.id?String(vt.id):`${vt._day}_${vt.period_id}_${vt.section_id}`;if(j[Xe]){if(vt.elective_subject_id)Ve.push(mr(`/api/curriculum/elective-choices/?elective_subject_id=${vt.elective_subject_id}`).then(Be=>Be.ok?Be.json():{results:[]}));else if(vt.subject_batch_id||(ze=vt.subject_batch)!=null&&ze.id){const Be=vt.subject_batch_id||((ke=vt.subject_batch)==null?void 0:ke.id);Ve.push(mr(`/api/academics/subject-batches/${Be}/`).then(ct=>ct.ok?ct.json():{students:[]}))}else if(vt.section_id||(qe=vt.section)!=null&&qe.id){const Be=vt.section_id||((Ie=vt.section)==null?void 0:Ie.id);Ve.push(mr(`/api/academics/sections/${Be}/students/`).then(ct=>ct.ok?ct.json():{results:[]}))}}}const Qe=await Promise.allSettled(Ve),Tt=[];for(const vt of Qe){if(vt.status!=="fulfilled")continue;const Xe=vt.value||{},Be=Xe.results||Xe.students||[];for(const ct of Be)!ct||!ct.id||Tt.find(nt=>nt.id===ct.id)||Tt.push({id:ct.id,reg_no:ct.reg_no||ct.regno||String(ct.id),username:ct.username||ct.name||""})}P(Tt),re(vt=>{const Xe={...vt};for(const Be of Tt)Xe[Be.id]===void 0&&(Xe[Be.id]=!1);return Xe})}catch(Ve){console.error("loadAgg",Ve),P([])}finally{N(!1)}}ae()},[j,_]),i.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:i.jsx(cs,{className:"w-8 h-8 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mark Attendance"}),i.jsx("p",{className:"text-slate-600 text-sm",children:"Record student attendance for periods"})]})]})}),i.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-4 border border-slate-200",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("label",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[i.jsx(tu,{className:"w-4 h-4 text-indigo-600"}),"Select Date:"]}),i.jsx("input",{type:"date",value:e,onChange:ae=>t(ae.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[i.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:i.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[i.jsx(us,{className:"w-5 h-5 text-indigo-600"}),"Assigned Periods"]})}),i.jsx("div",{className:"p-6",children:a?i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Lu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),i.jsx("span",{className:"ml-3 text-slate-600",children:"Loading periods..."})]}):i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[H(r).map(ae=>i.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 bg-white hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"flex items-start justify-between mb-2",children:i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:ae.period.label||`Period ${ae.period.index}`}),i.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-600 mb-1",children:[i.jsx(tu,{className:"w-4 h-4"}),ae.period.start_time||"",ae.period.start_time&&ae.period.end_time?`  ${ae.period.end_time}`:""]}),i.jsx("div",{className:"text-sm text-slate-700 mb-1",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-md bg-blue-100 text-blue-800 font-medium",children:ae.section_names&&ae.section_names.length?ae.section_names.join(" + "):ae.section_name})}),i.jsx("div",{className:"text-sm italic text-slate-600",children:ae.subject_display||ae.subject||"No subject"}),ae.unlock_request_status&&i.jsxs("div",{className:"mt-2",children:[ae.unlock_request_status==="PENDING"&&i.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-amber-100 text-amber-800 border border-amber-300 rounded-md text-xs font-medium",children:"Pending"}),ae.unlock_request_status==="APPROVED"&&i.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-100 text-green-800 border border-green-300 rounded-md text-xs font-medium",children:"Approved"}),ae.unlock_request_status==="REJECTED"&&i.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-red-100 text-red-800 border border-red-300 rounded-md text-xs font-medium",children:"Rejected"})]})]})}),i.jsx("div",{className:"mt-3",children:ae.attendance_session_locked?i.jsxs("button",{onClick:()=>X(ae),className:"w-full px-3 py-2 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium hover:bg-amber-200 flex items-center justify-center gap-2",children:[i.jsx(Qh,{className:"w-4 h-4"}),ae.attendance_session_id?"View Locked Session":"View Locked Period"]}):i.jsx("button",{onClick:()=>z(ae),className:"w-full px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:ae.attendance_session_id?i.jsxs(i.Fragment,{children:[i.jsx(zh,{className:"w-4 h-4"}),"Open Session"]}):i.jsxs(i.Fragment,{children:[i.jsx(cs,{className:"w-4 h-4"}),"Take Attendance"]})})})]},ae.id)),!r.length&&i.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[i.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:i.jsx(cs,{className:"w-12 h-12 text-slate-400"})}),i.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Periods Found"}),i.jsx("p",{className:"text-slate-600 text-sm",children:"No periods assigned for this date"})]}),i.jsx("div",{className:"col-span-full mt-2",children:i.jsx("button",{onClick:ce,className:"w-full px-4 py-3 border-2 border-dashed border-indigo-300 text-indigo-600 rounded-lg font-medium hover:bg-indigo-50 transition-colors",children:"Bulk Mark (All Assignments)"})})]})})]}),o&&i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[i.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:[o.combined_period_label||o.period.label||`Period ${o.period.index}`,"  ",o.section_name,i.jsxs("span",{className:"ml-3 inline-flex items-center px-2 py-0.5 rounded-md bg-slate-100 text-slate-700 text-sm font-medium",children:[c.length," student",c.length!==1?"s":""]})]}),o.attendance_session_locked&&i.jsxs(i.Fragment,{children:[i.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium",children:[i.jsx(Qh,{className:"w-3.5 h-3.5"}),"Locked"]}),o.unlock_request_status==="PENDING"&&i.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-50 text-amber-800 border border-amber-200 rounded-lg text-sm font-medium ml-3",children:"Pending"}),o.unlock_request_status==="APPROVED"&&i.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-green-50 text-green-800 border border-green-200 rounded-lg text-sm font-medium ml-3",children:"Approved"}),o.unlock_request_status==="REJECTED"&&i.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-50 text-red-800 border border-red-200 rounded-lg text-sm font-medium ml-3",children:"Rejected"})]})]}),i.jsxs("button",{onClick:()=>l(null),className:"px-3 py-1.5 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[i.jsx(zu,{className:"w-4 h-4"}),"Close"]})]}),i.jsxs("div",{className:"p-6",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-slate-200",children:[i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Student"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map(ae=>{const he=d[ae.id]||"P",ze={P:"bg-green-50 text-green-800 border-green-300",A:"bg-red-50 text-red-800 border-red-300",LEAVE:"bg-amber-50 text-amber-800 border-amber-300",OD:"bg-blue-50 text-blue-800 border-blue-300",LATE:"bg-indigo-50 text-indigo-800 border-indigo-300"},ke={P:"bg-green-600",A:"bg-red-600",LEAVE:"bg-amber-600",OD:"bg-blue-600",LATE:"bg-indigo-600"},qe=ze[he]||ze.P,Ie=ke[he]||ke.P;return i.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[i.jsx("td",{className:"py-3 px-4 text-sm font-medium text-slate-900",children:ae.reg_no}),i.jsx("td",{className:"py-3 px-4 text-sm text-slate-700",children:ae.username}),i.jsx("td",{className:"py-3 px-4",children:i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:`inline-block w-3 h-3 rounded-full mr-2 ${Ie}`}),i.jsxs("div",{className:"relative inline-block",children:[i.jsxs("select",{value:d[ae.id]||"P",onChange:Ve=>J(ae.id,Ve.target.value),disabled:o.attendance_session_locked,className:`appearance-none px-3 py-1.5 pr-8 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent ${qe} ${o.attendance_session_locked?"disabled:bg-slate-100 disabled:text-slate-500 disabled:cursor-not-allowed":""}`,children:[i.jsx("option",{value:"P",children:"Present"}),i.jsx("option",{value:"A",children:"Absent"}),i.jsx("option",{value:"LEAVE",children:"Leave"}),i.jsx("option",{value:"OD",children:"On Duty"}),i.jsx("option",{value:"LATE",children:"Late"})]}),i.jsx(_ee,{className:"w-4 h-4 text-slate-400 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"})]})]})})]},ae.id)})})]})}),i.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[i.jsx("button",{onClick:q,disabled:p||o.attendance_session_locked,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:p?i.jsxs(i.Fragment,{children:[i.jsx(Lu,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Od,{className:"w-4 h-4"}),"Save Attendance"]})}),o.attendance_session_id&&i.jsx("button",{onClick:U,disabled:m,className:`px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 ${o.attendance_session_locked?"bg-amber-600 hover:bg-amber-700 disabled:bg-amber-300 text-white":"bg-slate-600 hover:bg-slate-700 disabled:bg-slate-300 text-white"}`,children:m?i.jsxs(i.Fragment,{children:[i.jsx(Lu,{className:"w-4 h-4 animate-spin"}),o.attendance_session_locked?"Unlocking...":"Locking..."]}):i.jsx(i.Fragment,{children:o.attendance_session_locked?i.jsxs(i.Fragment,{children:[i.jsx(Gee,{className:"w-4 h-4"}),"Unlock Session"]}):i.jsxs(i.Fragment,{children:[i.jsx(Qh,{className:"w-4 h-4"}),"Lock Session"]})})})]})]})]}),b&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[85vh] overflow-y-auto shadow-2xl",children:[i.jsx("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 rounded-t-xl",children:i.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Bulk Mark Attendance"})}),i.jsxs("div",{className:"p-6 space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[i.jsx(cs,{className:"w-4 h-4 text-indigo-600"}),"Select Month:"]}),i.jsx("input",{type:"month",value:v,onChange:ae=>w(ae.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Assignments"}),i.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-60 overflow-y-auto bg-slate-50",children:[i.jsxs("label",{className:"flex items-center gap-2 mb-3 text-sm font-medium text-slate-700",children:[i.jsx("input",{type:"checkbox",checked:Object.keys(j).length>0&&Object.values(j).every(Boolean),onChange:ae=>{const he=ae.target.checked,ze={};for(const ke of _){const qe=ke.id?String(ke.id):`${ke._day}_${ke.period_id}_${ke.section_id}`;ze[qe]=he}A(ze)},className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),"Select / Deselect all"]}),i.jsx("div",{className:"space-y-2",children:(()=>{const ae=_.filter(he=>{const ze=he.id?String(he.id):`${he._day}_${he.period_id}_${he.section_id}`,ke=xe[ze];if(!ke)return!0;try{const[qe,Ie]=v.split("-").map(Tt=>parseInt(Tt)),Ve=new Date(qe,Ie,0).getDate();let Qe=0;for(let Tt=1;Tt<=Ve;Tt++){const vt=new Date(qe,Ie-1,Tt);(vt.getDay()===0?7:vt.getDay())===he._day&&Qe++}return ke.size<Qe}catch{return!0}});return ae.length===0?i.jsxs("div",{className:"text-center py-8 text-slate-600",children:[i.jsx(zh,{className:"w-12 h-12 text-green-500 mx-auto mb-2"}),i.jsx("p",{className:"font-medium",children:"All assignments are fully marked for this month!"})]}):ae.map(he=>{var Ie;const ze=he.id?String(he.id):`${he._day}_${he.period_id}_${he.section_id}`,ke=xe[ze],qe=ke?ke.size:0;return i.jsxs("label",{className:"flex items-start gap-3 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:!!j[ze],onChange:()=>A(Ve=>({...Ve,[ze]:!Ve[ze]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500 mt-0.5"}),i.jsxs("div",{className:"flex-1 text-sm",children:[i.jsxs("div",{className:"font-medium text-slate-900",children:[he.label||`Period ${he.period_index}`,"  ",["Mon","Tue","Wed","Thu","Fri","Sat"][he._day-1]||`Day ${he._day}`,he.start_time?` ${he.start_time}${he.end_time?" - "+he.end_time:""}`:""]}),i.jsxs("div",{className:"text-xs text-slate-600 mt-0.5",children:[he.section_name||((Ie=he.section)==null?void 0:Ie.name)||(he.section_id?`Section ${he.section_id}`:""),"  ",he.subject_display||he.subject_text||"",qe>0&&i.jsxs("span",{className:"ml-2 text-green-600 font-medium",children:["(",qe," day",qe!==1?"s":""," marked)"]})]})]})]},ze)})})()})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Dates (month view for selected assignments)"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{try{const[ae,he]=v.split("-").map(Qe=>parseInt(Qe)),ze=new Date(ae,he,0),ke=new Set;for(const Qe of _){const Tt=Qe.id?String(Qe.id):`${Qe._day}_${Qe.period_id}_${Qe.section_id}`;j[Tt]&&ke.add(Qe._day)}const qe=[];for(let Qe=1;Qe<=ze.getDate();Qe++){const Tt=new Date(ae,he-1,Qe),vt=Tt.getDay()===0?7:Tt.getDay();ke.size>0&&ke.has(vt)&&qe.push(Tt.toISOString().slice(0,10))}const Ie=Object.keys(j).filter(Qe=>j[Qe]),Ve=qe.filter(Qe=>Ie.length===0?!0:Ie.some(Tt=>{const vt=xe[Tt];return!vt||!vt.has(Qe)}));return Ve.length===0&&Ie.length>0?i.jsxs("div",{className:"text-center py-4 text-slate-600",children:[i.jsx(zh,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),i.jsx("p",{className:"text-sm",children:"All dates are already marked for selected assignments"})]}):Ve.map(Qe=>{const Tt=Ie.filter(vt=>{const Xe=xe[vt];return Xe&&Xe.has(Qe)}).length;return i.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-1.5 border border-slate-300 rounded-lg text-sm hover:bg-slate-100 cursor-pointer transition-colors",children:[i.jsx("input",{type:"checkbox",checked:!!T[Qe],onChange:()=>B(vt=>({...vt,[Qe]:!vt[Qe]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),i.jsxs("span",{children:[Qe,Tt>0&&Ie.length>1&&i.jsxs("span",{className:"ml-1 text-xs text-amber-600",children:["(",Tt,"/",Ie.length," marked)"]})]})]},Qe)})}catch{return i.jsx("div",{})}})()})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:["Students (derived from selected assignments)",i.jsxs("span",{className:"ml-2 text-sm text-slate-600",children:["(",M.length," student",M.length!==1?"s":"",")"]})]}),i.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-64 overflow-y-auto bg-slate-50",children:[R&&i.jsxs("div",{className:"flex items-center justify-center py-8 text-slate-600",children:[i.jsx(Lu,{className:"w-6 h-6 animate-spin mr-2"}),"Loading students..."]}),!R&&M.length===0&&i.jsx("div",{className:"text-center py-8 text-slate-600",children:"No students for selected assignments"}),!R&&M.length>0&&i.jsx("div",{className:"space-y-1",children:M.map(ae=>i.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:!!G[ae.id],onChange:he=>re(ze=>({...ze,[ae.id]:!ze[ae.id]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),i.jsxs("span",{className:"text-sm text-slate-900",children:[ae.reg_no,"  ",ae.username]})]},ae.id))})]})]})]}),i.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 px-6 py-4 flex gap-3 rounded-b-xl",children:[i.jsxs("button",{onClick:async()=>{var ke,qe,Ie,Ve;const ae=Object.keys(T).filter(Qe=>T[Qe]);if(!ae.length){alert("Select at least one date");return}const he=[];for(const Qe of _){const Tt=Qe.id?String(Qe.id):`${Qe._day}_${Qe.period_id}_${((ke=Qe.section)==null?void 0:ke.id)||Qe.section_id}`;if(!j[Tt])continue;const vt=Qe.section_id||Qe.section&&(Qe.section.id||Qe.section.pk)||((qe=Qe.section)==null?void 0:qe.pk)||((Ie=Qe.section)==null?void 0:Ie.id),Xe=Qe.period_id||Qe.period&&(Qe.period.id||Qe.period_id)||((Ve=Qe.period)==null?void 0:Ve.id)||Qe.period_id,Be=Number(vt),ct=Number(Xe);!Number.isFinite(Be)||!Number.isFinite(ct)||he.push({section_id:Be,period_id:ct})}const ze=Object.keys(G).filter(Qe=>G[Number(Qe)]).map(Qe=>Number(Qe));if(!he.length){alert("No assignments selected");return}if(!ze.length){alert("No students selected");return}try{const Qe=await mr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify({assignments:he,dates:ae,student_ids:ze})});if(!Qe.ok){let Tt="Failed";try{const vt=await Qe.json();Tt=JSON.stringify(vt)}catch{try{Tt=await Qe.text()}catch{}}alert("Failed: "+Tt);return}alert("Bulk attendance saved"),y(!1)}catch(Qe){console.error("bulk save",Qe),alert("Failed to save bulk attendance")}},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[i.jsx(Od,{className:"w-4 h-4"}),"Save Bulk"]}),i.jsx("button",{onClick:()=>y(!1),className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Close"})]})]})}),V&&de&&E&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md shadow-2xl",children:[i.jsx("div",{className:"bg-gradient-to-br from-amber-500 to-orange-600 px-6 py-4 rounded-t-xl",children:i.jsxs("div",{className:"flex items-center gap-3 text-white",children:[i.jsx($u,{className:"w-6 h-6"}),i.jsx("h3",{className:"text-xl font-bold",children:"Consecutive Periods Detected"})]})}),i.jsxs("div",{className:"p-6 space-y-4",children:[i.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[i.jsxs("p",{className:"text-sm text-slate-700 mb-3",children:["The same subject has consecutive periods",Math.abs(E.period.index-de.period.index)>1?" (with break/lunch in between)":"",":"]}),i.jsxs("div",{className:"space-y-2 mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),i.jsx("span",{className:"font-semibold text-slate-900",children:de.period.label||`Period ${de.period.index}`}),i.jsxs("span",{className:"text-slate-600",children:["(",de.period.start_time," - ",de.period.end_time,")"]})]}),Math.abs(E.period.index-de.period.index)>1&&i.jsx("div",{className:"flex items-center gap-2 text-sm pl-4",children:i.jsxs("span",{className:"text-slate-500 italic",children:[" ",Math.abs(E.period.index-de.period.index)-1," period(s) in between (break/lunch)"]})}),i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),i.jsx("span",{className:"font-semibold text-slate-900",children:E.period.label||`Period ${E.period.index}`}),i.jsxs("span",{className:"text-slate-600",children:["(",E.period.start_time," - ",E.period.end_time,")"]})]})]}),i.jsxs("p",{className:"text-sm font-medium text-slate-900",children:["Subject: ",i.jsx("span",{className:"text-indigo-600",children:de.subject||de.subject_display||"Same Subject"})]})]}),i.jsx("p",{className:"text-sm text-slate-600",children:"Would you like to mark attendance for both periods at once (all students Present), or just the selected period?"})]}),i.jsxs("div",{className:"px-6 pb-6 flex flex-col gap-3",children:[i.jsxs("button",{onClick:Y,className:"w-full px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[i.jsx(zh,{className:"w-5 h-5"}),"Mark Both Periods (All Present)"]}),i.jsx("button",{onClick:L,className:"w-full px-4 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Single Period Only"}),i.jsx("button",{onClick:()=>{K(!1),ne(null),Z(null)},className:"w-full px-4 py-2 text-slate-600 hover:text-slate-800 text-sm font-medium transition-colors",children:"Cancel"})]})]})})]})}const fOe=()=>{const[e,t]=x.useState(!1),[r,n]=x.useState(null),[a,s]=x.useState(!1),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState([]),[p,h]=x.useState(null),[m,g]=x.useState("overall"),[b,y]=x.useState(!1),[v,w]=x.useState(null),[_,C]=x.useState([]),[j,A]=x.useState([]),[M,P]=x.useState(null),[R,N]=x.useState({}),[T,B]=x.useState(!1);x.useEffect(()=>{re()},[]),x.useEffect(()=>{xe()},[]),x.useEffect(()=>{_e()},[]),x.useEffect(()=>{G()},[]),x.useEffect(()=>{p&&(p==="all"||p==="department"?g("overall"):p==="class"&&g("assigned"))},[p]);async function G(){try{const ne=await mr("/api/academics/analytics/filters/");if(!ne.ok)return h(null);const E=await ne.json().catch(()=>null);h((E==null?void 0:E.permission_level)||null),C((E==null?void 0:E.departments)||[]),A((E==null?void 0:E.sections)||[]),((E==null?void 0:E.departments)||[]).length>0&&P((E.departments[0]||{}).id||null)}catch(ne){console.error("Failed to load analytics filters",ne),h(null)}}async function re(){t(!0);try{const ne=await mr("/api/academics/analytics/today-periods/"),E=await ne.json().catch(()=>null);ne.ok?n(E):n(null)}catch(ne){console.error("Failed to load today periods",ne),n(null)}finally{t(!1)}}async function xe(){s(!0);try{const ne=new Date().toISOString().split("T")[0],E=await mr(`/api/academics/staff/periods/?date=${ne}`),Z=await E.json().catch(()=>({results:[]}));E.ok?l(Z.results||[]):l([])}catch(ne){console.error("Failed to load assigned periods",ne),l([])}finally{s(!1)}}async function _e(){u(!0);try{const ne=new Date().toISOString().split("T")[0],E=await mr(`/api/academics/analytics/overall-section/?date=${ne}`);if(!E.ok){f([]),u(!1);return}const Z=await E.json().catch(()=>({sections:[]}));f(Z.sections||[])}catch(ne){console.error("Failed to load overall sections",ne),f([])}finally{u(!1)}}async function V(ne){if(!ne)return;B(!0);const E=new Date().toISOString().split("T")[0],Z=j.filter(F=>String(F.batch__course__department__id)===String(ne)),H={};try{await Promise.all(Z.map(async F=>{try{const ee=await mr(`/api/academics/analytics/class-report/?section_id=${F.id}&date=${E}&period_index=1`);if(!ee.ok)return;const z=await ee.json().catch(()=>null);z&&(H[F.id]=z)}catch{}})),N(F=>({...F,...H}))}finally{B(!1)}}const K=async ne=>{if(!ne)return alert("No session available");if(confirm("Request unlock for this session?"))try{const E=await mr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:ne,note:""})});if(!E.ok){const Z=await E.json().catch(()=>({}));E.status===400&&Z.detail&&String(Z.detail).includes("already pending")?alert("An unlock request for this session is already pending."):alert("Failed to create unlock request: "+(Z.detail||E.status));return}alert("Unlock request submitted successfully")}catch(E){console.error(E),alert("Failed to submit request")}};async function de(ne){if(ne){y(!0),w(null);try{const E=new Date().toISOString().split("T")[0],Z=await mr(`/api/academics/analytics/class-report/?section_id=${ne}&date=${E}`);if(!Z.ok){const F=await Z.json().catch(()=>({}));alert("Failed to load section report: "+(F.detail||Z.status)),y(!1);return}const H=await Z.json().catch(()=>null);w(H),g("section")}catch(E){console.error("Failed to load section report",E),alert("Failed to load section report")}finally{y(!1)}}}return i.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Unlock Requests"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Request unlock for a locked attendance session from the list below."})]}),e&&i.jsx("div",{className:"py-6 text-gray-600",children:"Loading today's periods"}),i.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[(p==="all"||p==="department")&&i.jsx("button",{onClick:()=>g("overall"),className:`px-3 py-1 rounded ${m==="overall"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Overall"}),i.jsx("button",{onClick:()=>g("assigned"),className:`px-3 py-1 rounded ${m==="assigned"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"My Assigned"})]}),m==="overall"&&!c&&i.jsx("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"text-sm text-gray-700",children:"Overall sections (permissioned)"}),_&&_.length>0&&i.jsxs("select",{value:M??"",onChange:ne=>{const E=ne.target.value,Z=E?Number(E):null;P(Z),Z&&V(Z)},className:"px-2 py-1 border rounded",children:[i.jsx("option",{value:"",children:"-- Select department --"}),_.map(ne=>i.jsx("option",{value:ne.id,children:ne.short_name||ne.name},ne.id))]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:_e,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[i.jsx(yA,{className:"w-4 h-4"})," Refresh"]}),M&&i.jsx("button",{onClick:()=>M&&V(M),className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:"Load Dept Sections"})]})]}),i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),i.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M?j.filter(ne=>String(ne.batch__course__department__id)===String(M)).map(ne=>{const E=R[ne.id];return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ne.name}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:(E==null?void 0:E.present)??"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:(E==null?void 0:E.absent)??"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:(E==null?void 0:E.on_duty)??"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:(E==null?void 0:E.total_strength)??"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:E!=null&&E.is_locked?i.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[i.jsx(Qh,{className:"w-3 h-3 mr-1"}),"Locked"]}):E!=null&&E.total_marked?i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),i.jsx("td",{className:"px-4 py-3 text-right",children:i.jsx("button",{onClick:()=>de(ne.id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},ne.id)}):d.map(ne=>i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(ne.department_short||ne.department_name?`${ne.department_short||ne.department_name} - `:"")+(ne.section_name||"")}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:ne.present??"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:ne.absent??"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:ne.on_duty??"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:ne.total_strength??"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:ne.is_locked?i.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[i.jsx(Qh,{className:"w-3 h-3 mr-1"}),"Locked"]}):ne.marked_at?i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),i.jsx("td",{className:"px-4 py-3 text-right",children:i.jsx("button",{onClick:()=>de(ne.section_id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},ne.section_id))})]})]})}),m==="section"&&v&&i.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-lg font-medium",children:v.section_name}),i.jsxs("div",{className:"text-sm text-gray-600",children:["Date: ",v.date]})]}),i.jsx("div",{children:i.jsx("button",{onClick:()=>g("overall"),className:"px-3 py-1 rounded bg-gray-100",children:"Back"})})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Present",i.jsx("br",{}),i.jsx("strong",{className:"text-2xl",children:v.present})]}),i.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Absent",i.jsx("br",{}),i.jsx("strong",{className:"text-2xl",children:v.absent})]}),i.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["OD",i.jsx("br",{}),i.jsx("strong",{className:"text-2xl",children:v.on_duty})]})]})]}),!a&&o&&o.length>0&&i.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("div",{className:"text-sm text-gray-700"}),i.jsxs("button",{onClick:xe,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[i.jsx(yA,{className:"w-4 h-4"})," Refresh"]})]}),i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Period"}),i.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Subject"}),i.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),i.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),i.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(ne=>{var E,Z;return i.jsxs("tr",{className:"hover:bg-gray-50",children:[i.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:((E=ne.period)==null?void 0:E.label)||((Z=ne.period)==null?void 0:Z.index)||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ne.subject_display||"-"}),i.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:ne.section_name||"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:ne.present??"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:ne.absent??"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:ne.on_duty??"-"}),i.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:ne.total_strength??"-"}),i.jsx("td",{className:"px-4 py-3 text-sm",children:ne.attendance_session_locked?i.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[i.jsx(Qh,{className:"w-3 h-3 mr-1"}),"Locked"]}):ne.present!==null?i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),i.jsx("td",{className:"px-4 py-3 text-right",children:i.jsx("button",{onClick:()=>{var H;return K(ne.attendance_session_id||((H=ne.attendance_session)==null?void 0:H.id)||ne.session_id)},className:`px-3 py-1 rounded text-sm ${ne.attendance_session_locked?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-100 text-gray-600 cursor-not-allowed"}`,disabled:!ne.attendance_session_locked,children:"Request Unlock"})})]},ne.id||ne.session_id)})})]})]})}),!e&&(!r||r.periods.length===0)&&i.jsx("div",{className:"text-gray-600 py-6",children:"No periods available for today."})]})};function hOe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[a,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(!1);x.useEffect(()=>{const h=new Date,m=h.toISOString().slice(0,10),g=new Date(h.getTime()-1e3*60*60*24*30).toISOString().slice(0,10);t(g),n(m)},[]),x.useEffect(()=>{e&&r&&d()},[e,r]);async function d(){u(!0);try{const h=`?start_date=${e}&end_date=${r}`;console.log("Fetching student attendance:",{startDate:e,endDate:r,url:`/api/academics/student/attendance/${h}`});const m=await mr(`/api/academics/student/attendance/${h}`);if(!m.ok){const b=await m.text();throw console.error("Failed to fetch attendance:",m.status,b),new Error(`Failed to fetch (${m.status})`)}const g=await m.json();console.log("Student attendance response:",{recordCount:(g.results||[]).length,summary:g.summary,records:g.results}),s(g.results||[]),l(g.summary||null)}catch(h){console.error("fetchRecords error:",h),s([]),alert("Failed to load attendance records: "+(h instanceof Error?h.message:String(h)))}finally{u(!1)}}function f(h){switch(h){case"P":return"bg-green-100 text-green-800 border-green-200";case"A":return"bg-red-100 text-red-800 border-red-200";case"LEAVE":return"bg-blue-100 text-blue-800 border-blue-200";case"OD":return"bg-purple-100 text-purple-800 border-purple-200";case"LATE":return"bg-amber-100 text-amber-800 border-amber-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}function p(h){switch(h){case"P":return i.jsx(zh,{className:"h-3.5 w-3.5"});case"A":return i.jsx(BD,{className:"h-3.5 w-3.5"});default:return i.jsx($u,{className:"h-3.5 w-3.5"})}}return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:i.jsxs("div",{className:"max-w-7xl mx-auto",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:i.jsx(zh,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Attendance"}),i.jsx("p",{className:"text-gray-600",children:"View your attendance records and statistics"})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(cs,{className:"h-5 w-5 text-indigo-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Date Range"})]}),i.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[i.jsxs("div",{className:"flex-1 min-w-[200px]",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"From Date"}),i.jsx("input",{type:"date",value:e,onChange:h=>t(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),i.jsxs("div",{className:"flex-1 min-w-[200px]",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"To Date"}),i.jsx("input",{type:"date",value:r,onChange:h=>n(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),i.jsx("button",{onClick:d,disabled:c,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors font-medium flex items-center gap-2",children:c?i.jsxs(i.Fragment,{children:[i.jsx(Lu,{className:"h-4 w-4 animate-spin"}),"Loading..."]}):i.jsxs(i.Fragment,{children:[i.jsx(cs,{className:"h-4 w-4"}),"Refresh"]})})]}),!c&&a.length>0&&i.jsxs("div",{className:"mt-3 text-sm text-gray-600 flex items-center gap-2",children:[i.jsx(zh,{className:"h-4 w-4 text-green-600"}),"Showing ",a.length," attendance record",a.length!==1?"s":""," from ",e," to ",r]})]}),c?i.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:i.jsx("div",{className:"text-center",children:i.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[i.jsx(Lu,{className:"animate-spin h-5 w-5 text-indigo-600"}),i.jsx("span",{children:"Loading attendance records..."})]})})}):i.jsx("div",{children:a.length===0?i.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:i.jsxs("div",{className:"text-center",children:[i.jsx($u,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Records Found"}),i.jsx("p",{className:"text-gray-600",children:"No attendance records found for the selected date range."})]})}):i.jsxs("div",{className:"space-y-6",children:[o&&i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(hte,{className:"h-5 w-5 text-indigo-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Overall Attendance"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200",children:[i.jsx("div",{className:"text-sm text-green-700 font-medium mb-1",children:"Attendance Rate"}),i.jsx("div",{className:"text-3xl font-bold text-green-900",children:o.overall.percentage!=null?`${o.overall.percentage.toFixed(1)}%`:"N/A"})]}),i.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[i.jsx("div",{className:"text-sm text-blue-700 font-medium mb-1",children:"Present"}),i.jsx("div",{className:"text-3xl font-bold text-blue-900",children:o.overall.present})]}),i.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200",children:[i.jsx("div",{className:"text-sm text-purple-700 font-medium mb-1",children:"Total Periods"}),i.jsx("div",{className:"text-3xl font-bold text-purple-900",children:o.overall.total_marked_periods})]})]})]}),o&&o.by_subject&&o.by_subject.length>0&&i.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[i.jsx(ls,{className:"h-5 w-5 text-indigo-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Subject-wise Breakdown"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.by_subject.map(h=>{const m=h.percentage!=null?h.percentage:0,g=h.counts||{};return i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsx("div",{className:"font-semibold text-gray-900",children:h.subject_display||h.subject_key}),i.jsx("div",{className:"text-lg font-bold text-indigo-600",children:m!=null?`${m.toFixed(1)}%`:"N/A"})]}),i.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full overflow-hidden mb-3",children:i.jsx("div",{className:`h-full transition-all ${m>=75?"bg-green-500":m>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(0,Math.min(100,m))}%`}})}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded border border-green-200",children:["P: ",g.P||0]}),i.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded border border-red-200",children:["A: ",g.A||0]}),i.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded border border-blue-200",children:["LEAVE: ",g.LEAVE||0]}),i.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded border border-purple-200",children:["OD: ",g.OD||0]}),i.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded border border-amber-200",children:["LATE: ",g.LATE||0]})]})]},h.subject_key)})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-100",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(tu,{className:"h-5 w-5 text-indigo-600"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Attendance Records"})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),i.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Period"}),i.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Section"}),i.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),i.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),i.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Marked By"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-100",children:a.map(h=>{var m,g,b;return i.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(cs,{className:"h-4 w-4 text-gray-400"}),h.date]})}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((m=h.period)==null?void 0:m.label)||((g=h.period)!=null&&g.index?`Period ${h.period.index}`:"")}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((b=h.section)==null?void 0:b.name)||""}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 font-medium",children:h.subject_display||""}),i.jsx("td",{className:"px-6 py-4 text-sm",children:i.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-md text-xs font-medium border ${f(h.status)}`,children:[p(h.status),h.status]})}),i.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(F0,{className:"h-3.5 w-3.5 text-gray-400"}),h.marked_by||""]})})]},h.id)})})]})})]})]})})]})})}const hg="";async function pOe(){const e=await mr(`${hg}/api/academics/mentor/staff/`);return e.ok?e.json():{results:[]}}async function mOe(e){const t=await mr(`${hg}/api/academics/mentor/staff/${e}/students/`);return t.ok?t.json():{results:[]}}async function gOe(e,t){return await mr(`${hg}/api/academics/mentor/map/`,{method:"POST",body:JSON.stringify({mentor_id:e,student_ids:t})})}async function DR(){const e=await mr(`${hg}/api/academics/my-students/`);return e.ok?e.json():{results:[]}}async function xOe(e,t){const r={student_ids:[e]};return t&&(r.mentor_id=t),await mr(`${hg}/api/academics/mentor/unmap/`,{method:"POST",body:JSON.stringify(r)})}async function yOe(){const e=await mr(`${hg}/api/academics/mentor/my-mentees/`);return e.ok?e.json():{results:[]}}function bOe(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[a,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(!1);x.useEffect(()=>{d()},[]);async function d(){const b=await pOe();t(b.results||[])}async function f(){const y=(await DR()).results||[],v=[];y.forEach(w=>{(w.students||[]).forEach(C=>v.push(C))}),s(v)}async function p(b){n(b),l([]),s([]);const v=(await mOe(b)).results||[],_=(await DR()).results||[],C=[];_.forEach(M=>{(M.students||[]).forEach(R=>C.push(R))});const j=new Set(v.map(M=>M.id)),A=C.filter(M=>!j.has(M.id)&&!M.has_mentor);l(v),s(A)}async function h(b){if(!r)return alert("Select a mentor first");u(!0);const y=await gOe(r,[b]);if(y.ok)await f(),r&&await p(r);else{const v=await y.json().catch(()=>null);alert("Failed: "+(v&&v.detail?v.detail:y.statusText))}u(!1)}async function m(b){if(!r)return;u(!0);const y=await xOe(b,r);if(y.ok)await f(),r&&await p(r);else{const v=await y.json().catch(()=>null);alert("Failed to remove: "+(v&&v.detail?v.detail:y.statusText))}u(!1)}const g=e.find(b=>b.id===r);return i.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:i.jsx(Ev,{className:"w-8 h-8 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mentor Assignment"}),i.jsx("p",{className:"text-slate-600 text-sm",children:"Assign and manage mentor mappings for your students"})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[i.jsx("div",{className:"lg:col-span-2",children:i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[i.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:i.jsxs("h3",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[i.jsx(us,{className:"w-5 h-5 text-indigo-600"}),"Staff Members",i.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})}),i.jsx("div",{className:"p-4 max-h-[600px] overflow-y-auto",children:e.length===0?i.jsx("div",{className:"text-center py-8 text-slate-500",children:"No staff members available"}):i.jsx("div",{className:"space-y-2",children:e.map(b=>i.jsx("div",{className:`p-4 rounded-lg border transition-all cursor-pointer ${r===b.id?"bg-gradient-to-r from-indigo-50 to-blue-50 border-indigo-300 shadow-md":"bg-white border-slate-200 hover:border-indigo-200 hover:shadow-sm"}`,onClick:()=>p(b.id),children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("div",{className:`font-medium ${r===b.id?"text-indigo-900":"text-slate-900"}`,children:b.username}),i.jsx("div",{className:"text-sm text-slate-600 mt-1",children:i.jsx("span",{className:"font-mono",children:b.staff_id||"N/A"})})]}),i.jsxs("button",{onClick:y=>{y.stopPropagation(),p(b.id)},className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${r===b.id?"bg-indigo-600 text-white":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"}`,children:[i.jsx(ID,{className:"w-4 h-4"}),"View"]})]})},b.id))})})]})}),i.jsx("div",{className:"lg:col-span-3",children:r?i.jsxs("div",{className:"space-y-6",children:[g&&i.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-4 shadow-lg",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Ev,{className:"w-6 h-6"}),i.jsxs("div",{children:[i.jsxs("div",{className:"font-semibold",children:["Selected Mentor: ",g.username]}),i.jsxs("div",{className:"text-sm opacity-90",children:["Staff ID: ",g.staff_id||"N/A"]})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[i.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-green-50",children:i.jsxs("h4",{className:"text-base font-semibold text-green-900 flex items-center gap-2",children:[i.jsx(q1,{className:"w-5 h-5 text-green-700"}),"Assigned Students",i.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-green-200 text-green-800 text-xs font-medium rounded-full",children:o.length})]})}),i.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:o.length>0?i.jsx("div",{className:"space-y-2",children:o.map(b=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[b.reg_no,"  ",b.username]}),i.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:b.section_name})]}),i.jsxs("button",{className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-red-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>m(b.id),disabled:c,children:[i.jsx(bte,{className:"w-4 h-4"}),"Remove"]})]},b.id))}):i.jsx("div",{className:"text-center py-8 text-slate-500",children:"No students currently assigned to this mentor"})})]}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[i.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-blue-50",children:i.jsxs("h4",{className:"text-base font-semibold text-blue-900 flex items-center gap-2",children:[i.jsx(us,{className:"w-5 h-5 text-blue-700"}),"Available to Assign",i.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-blue-200 text-blue-800 text-xs font-medium rounded-full",children:a.length})]})}),i.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:a.length>0?i.jsx("div",{className:"space-y-2",children:a.map(b=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[b.reg_no,"  ",b.username]}),i.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:b.section_name})]}),i.jsxs("button",{className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-green-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>h(b.id),disabled:c||!r,children:[c?i.jsx(Lu,{className:"w-4 h-4 animate-spin"}):i.jsx(xte,{className:"w-4 h-4"}),"Assign"]})]},b.id))}):i.jsx("div",{className:"text-center py-8 text-slate-500",children:"No available students to assign"})})]})]}):i.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:i.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[i.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:i.jsx(Ev,{className:"w-16 h-16 text-slate-400"})}),i.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"Select a Staff Member"}),i.jsx("p",{className:"text-slate-600 text-sm",children:"Click on a staff member to view and manage their mentee assignments"})]})})})]})]})}function vOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1);x.useEffect(()=>{a()},[]);async function a(){n(!0);try{const s=await yOe();t(s.results||[])}catch(s){console.error(s),alert("Failed to load mentees")}finally{n(!1)}}return i.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[i.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:i.jsx(us,{className:"w-8 h-8 text-white"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Mentees"}),i.jsx("p",{className:"text-slate-600 text-sm",children:"Students assigned to you as mentor"})]})]})}),i.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[i.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[i.jsx(Ev,{className:"w-5 h-5 text-indigo-600"}),"Mentees List",!r&&e.length>0&&i.jsx("span",{className:"ml-2 px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})})}),i.jsxs("div",{className:"p-6",children:[r&&i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(Lu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),i.jsx("span",{className:"ml-3 text-slate-600",children:"Loading mentees..."})]}),!r&&e.length===0&&i.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[i.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:i.jsx(us,{className:"w-12 h-12 text-slate-400"})}),i.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Mentees Assigned"}),i.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned as mentees yet."})]}),!r&&e.length>0&&i.jsx("div",{children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b border-slate-200",children:[i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Name"}),i.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Section"})]})}),i.jsx("tbody",{className:"divide-y divide-slate-200",children:e.map(s=>i.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[i.jsx("td",{className:"py-3 px-4",children:i.jsx("span",{className:"text-sm font-medium text-slate-900",children:s.reg_no})}),i.jsx("td",{className:"py-3 px-4",children:i.jsx("span",{className:"text-sm text-slate-700",children:s.username})}),i.jsx("td",{className:"py-3 px-4",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:s.section_name||"N/A"})})]},s.id))})]})})]})]})]})}function wOe(){const[e,t]=x.useState(null),[r,n]=x.useState(!0),{collapsed:a}=aN();return x.useEffect(()=>{W1().then(o=>{const l={...o,roles:Array.isArray(o.roles)?o.roles.map(c=>typeof c=="string"?c:c.name):[],permissions:Array.isArray(o.permissions)?o.permissions:[],profile_type:o.profile_type||null,profile:o.profile||null};t(l)}).catch(()=>t(null)).finally(()=>n(!1))},[]),r?i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx("p",{className:"text-gray-600",children:"Loading..."})}):((Array.isArray(e==null?void 0:e.permissions)?e==null?void 0:e.permissions:[]).map(o=>String(o||"").toLowerCase()),i.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-x-hidden",children:[i.jsx($D,{user:e}),e?i.jsxs("div",{className:"flex",children:[i.jsx(Yte,{}),i.jsx("main",{className:`flex-1 min-w-0 transition-all duration-300 pt-20 overflow-x-hidden ${a?"lg:pl-20":"lg:pl-64"}`,children:i.jsxs(iA,{children:[i.jsx(qn,{path:"/",element:i.jsx(qp,{to:"/dashboard",replace:!0})}),i.jsx(qn,{path:"/dashboard",element:i.jsx(OPe,{})}),i.jsx(qn,{path:"/profile",element:i.jsx(LPe,{user:e})}),i.jsx(qn,{path:"/import/questions",element:i.jsx(WPe,{})}),i.jsx(qn,{path:"/curriculum/master",element:i.jsx(MPe,{})}),i.jsx(qn,{path:"/curriculum/master/:id",element:i.jsx(TR,{})}),i.jsx(qn,{path:"/curriculum/master/new",element:i.jsx(TR,{})}),i.jsx(qn,{path:"/curriculum/department",element:i.jsx(FPe,{})}),i.jsx(qn,{path:"/curriculum/elective-import",element:i.jsx(pi,{user:e,requiredPermissions:["curriculum.import_elective_choices"],element:i.jsx(RPe,{})})}),i.jsx(qn,{path:"/obe",element:i.jsx(uK,{})}),i.jsx(qn,{path:"/obe/course/:code/lca/cotarget",element:i.jsx(SOe,{})}),i.jsx(qn,{path:"/obe/course/:code/*",element:i.jsx(JPe,{})}),i.jsx(qn,{path:"/obe/request",element:i.jsx(pi,{user:e,requiredProfile:"STAFF",element:i.jsx(ZPe,{})})}),i.jsx(qn,{path:"/obe/master/requests",element:i.jsx(pi,{user:e,requiredPermissions:["obe.master.manage"],element:i.jsx(TPe,{})})}),i.jsx(qn,{path:"/obe/master/due-dates",element:i.jsx(pi,{user:e,requiredPermissions:["obe.master.manage"],element:i.jsx(lN,{})})}),i.jsx(qn,{path:"/academic",element:i.jsx(UPe,{})}),i.jsx(qn,{path:"/hod/advisors",element:i.jsx(pi,{user:e,requiredRoles:["HOD"],requiredPermissions:["academics.assign_advisor"],element:i.jsx(eOe,{})})}),i.jsx(qn,{path:"/advisor/teaching",element:i.jsx(pi,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_teaching"],element:i.jsx(tOe,{})})}),i.jsx(qn,{path:"/iqac/timetable",element:i.jsx(pi,{user:e,requiredPermissions:["timetable.manage_templates"],element:i.jsx(ere,{})})}),i.jsx(qn,{path:"/iqac/academic-controller",element:i.jsx(pi,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:i.jsx(Are,{})})}),i.jsx(qn,{path:"/iqac/academic-controller/course/:courseCode",element:i.jsx(pi,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:i.jsx(Ere,{})})}),i.jsx(qn,{path:"/iqac/academic-controller/course/:courseCode/marks/:taId",element:i.jsx(pi,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:i.jsx(J8e,{})})}),i.jsx(qn,{path:"/iqac/academic-controller/course/:courseCode/internal-mark/:taId",element:i.jsx(pi,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:i.jsx(EPe,{})})}),i.jsx(qn,{path:"/iqac/academic-controller/course/:courseCode/obe/:taId/*",element:i.jsx(pi,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:i.jsx(CPe,{})})}),i.jsx(qn,{path:"/iqac/obe-requests",element:i.jsx(pi,{user:e,requiredPermissions:["obe.master.manage"],element:i.jsx(p9,{})})}),i.jsx(qn,{path:"/advisor/timetable",element:i.jsx(pi,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["timetable.assign"],element:i.jsx(Zte,{})})}),i.jsx(qn,{path:"/advisor/students",element:i.jsx(pi,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.view_my_students"],element:i.jsx(rOe,{})})}),i.jsx(qn,{path:"/advisor/mentor",element:i.jsx(pi,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_mentor"],element:i.jsx(bOe,{})})}),i.jsx(qn,{path:"/student/timetable",element:i.jsx(pi,{user:e,requiredProfile:"STUDENT",requiredPermissions:["timetable.view"],element:i.jsx(aOe,{})})}),i.jsx(qn,{path:"/student/attendance",element:i.jsx(pi,{user:e,requiredProfile:"STUDENT",element:i.jsx(hOe,{})})}),i.jsx(qn,{path:"/staff/timetable",element:i.jsx(pi,{user:e,requiredProfile:"STAFF",requiredPermissions:["timetable.view"],element:i.jsx(oOe,{})})}),i.jsx(qn,{path:"/staff/assigned-subjects",element:i.jsx(pi,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_assigned_subjects"],element:i.jsx(uOe,{})})}),i.jsx(qn,{path:"/staff/period-attendance",element:i.jsx(pi,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.mark_attendance"],element:i.jsx(dOe,{})})}),i.jsx(qn,{path:"/staff/analytics",element:i.jsx(pi,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_all_attendance","academics.view_attendance_overall","academics.view_all_departments","academics.view_department_attendance","academics.view_class_attendance","academics.view_section_attendance"],element:i.jsx(fOe,{})})}),i.jsx(qn,{path:"/staff/mentees",element:i.jsx(pi,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_mentees"],element:i.jsx(vOe,{})})}),i.jsx(qn,{path:"*",element:e?i.jsx(qp,{to:"/dashboard",replace:!0}):i.jsx(sj,{user:e})})]})})]}):i.jsx("div",{className:"pt-16",children:i.jsxs(iA,{children:[i.jsx(qn,{path:"/",element:e?i.jsx(qp,{to:"/dashboard",replace:!0}):i.jsx(sj,{user:e})}),i.jsx(qn,{path:"*",element:e?i.jsx(qp,{to:"/dashboard",replace:!0}):i.jsx(sj,{user:e})})]})})]}))}function SOe(){const{code:e}=M0(),t=e?decodeURIComponent(e):void 0;return i.jsx(iK,{courseCode:t})}function _Oe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[a,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(!1),d=so();function f(h){if(typeof h!="object"||h===null)return null;const g=h.response;if(!g)return null;const b=g.data;if(!b)return null;const y=b.non_field_errors;return Array.isArray(y)&&y.length>0?String(y[0]):typeof b.detail=="string"?b.detail:null}const p=async h=>{h.preventDefault(),l(null),u(!0);try{await MD(e,r),d("/dashboard")}catch(m){const g=f(m)||"Login failed";l(g)}finally{u(!1)}};return i.jsxs(i.Fragment,{children:[i.jsx($D,{user:null}),i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:i.jsx("div",{className:"max-w-md w-full",children:i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 sm:p-10",children:[i.jsxs("div",{className:"mb-8 text-center",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),i.jsx("p",{className:"text-gray-600",children:"Sign in to access your account"})]}),i.jsxs("form",{className:"space-y-6",onSubmit:p,children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"identifier",children:"Email or Register No"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(nN,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{id:"identifier",type:"text",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"College Email or Reg. No.",value:e,onChange:h=>t(h.target.value),required:!0,disabled:c})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"password",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Qh,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{id:"password",type:a?"text":"password",className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter your password",value:r,onChange:h=>n(h.target.value),required:!0,disabled:c}),i.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",onClick:()=>s(!a),"aria-label":a?"Hide password":"Show password",children:a?i.jsx(Mee,{className:"h-5 w-5"}):i.jsx(ID,{className:"h-5 w-5"})})]})]}),i.jsx("div",{className:"flex items-center justify-end",children:i.jsx(Vi,{to:"/forgot-password",className:"text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:"Forgot Password?"})}),o&&i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[i.jsx($u,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-sm text-red-800",children:o})]}),i.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed transform hover:scale-[1.02] active:scale-[0.98]",disabled:c,children:c?i.jsxs("span",{className:"flex items-center justify-center gap-2",children:[i.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing In..."]}):"Sign In"}),i.jsx("div",{className:"text-center pt-4",children:i.jsx(Vi,{to:"/",className:"text-sm text-gray-600 hover:text-gray-900 font-medium transition-colors",children:" Back to Home"})})]})]})})})]})}ZI(document.getElementById("root")).render(i.jsx(Zr.StrictMode,{children:i.jsx(vJ,{children:i.jsx(Nte,{children:i.jsxs(iA,{children:[i.jsx(qn,{path:"/login",element:i.jsx(_Oe,{})}),i.jsx(qn,{path:"/*",element:i.jsx(wOe,{})})]})})})}));export{Oa as _,jOe as c,Wd as g};
