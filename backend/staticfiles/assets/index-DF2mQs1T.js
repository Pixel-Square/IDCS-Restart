var yY=Object.defineProperty;var bY=(e,t,r)=>t in e?yY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Mi=(e,t,r)=>bY(e,typeof t!="symbol"?t+"":t,r);function vY(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var aMe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function sf(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var rB={exports:{}},Yw={},nB={exports:{}},xi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q1=Symbol.for("react.element"),wY=Symbol.for("react.portal"),SY=Symbol.for("react.fragment"),_Y=Symbol.for("react.strict_mode"),jY=Symbol.for("react.profiler"),kY=Symbol.for("react.provider"),AY=Symbol.for("react.context"),NY=Symbol.for("react.forward_ref"),CY=Symbol.for("react.suspense"),EY=Symbol.for("react.memo"),TY=Symbol.for("react.lazy"),dT=Symbol.iterator;function PY(e){return e===null||typeof e!="object"?null:(e=dT&&e[dT]||e["@@iterator"],typeof e=="function"?e:null)}var iB={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},aB=Object.assign,sB={};function Qm(e,t,r){this.props=e,this.context=t,this.refs=sB,this.updater=r||iB}Qm.prototype.isReactComponent={};Qm.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Qm.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function oB(){}oB.prototype=Qm.prototype;function h3(e,t,r){this.props=e,this.context=t,this.refs=sB,this.updater=r||iB}var p3=h3.prototype=new oB;p3.constructor=h3;aB(p3,Qm.prototype);p3.isPureReactComponent=!0;var fT=Array.isArray,lB=Object.prototype.hasOwnProperty,m3={current:null},cB={key:!0,ref:!0,__self:!0,__source:!0};function uB(e,t,r){var n,i={},s=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)lB.call(t,n)&&!cB.hasOwnProperty(n)&&(i[n]=t[n]);var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];i.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)i[n]===void 0&&(i[n]=l[n]);return{$$typeof:q1,type:e,key:s,ref:o,props:i,_owner:m3.current}}function OY(e,t){return{$$typeof:q1,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function g3(e){return typeof e=="object"&&e!==null&&e.$$typeof===q1}function MY(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var hT=/\/+/g;function p5(e,t){return typeof e=="object"&&e!==null&&e.key!=null?MY(""+e.key):t.toString(36)}function _v(e,t,r,n,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case q1:case wY:o=!0}}if(o)return o=e,i=i(o),e=n===""?"."+p5(o,0):n,fT(i)?(r="",e!=null&&(r=e.replace(hT,"$&/")+"/"),_v(i,t,r,"",function(u){return u})):i!=null&&(g3(i)&&(i=OY(i,r+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(hT,"$&/")+"/")+e)),t.push(i)),1;if(o=0,n=n===""?".":n+":",fT(e))for(var l=0;l<e.length;l++){s=e[l];var c=n+p5(s,l);o+=_v(s,t,r,c,i)}else if(c=PY(e),typeof c=="function")for(e=c.call(e),l=0;!(s=e.next()).done;)s=s.value,c=n+p5(s,l++),o+=_v(s,t,r,c,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function rb(e,t,r){if(e==null)return e;var n=[],i=0;return _v(e,n,"","",function(s){return t.call(r,s,i++)}),n}function LY(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var dl={current:null},jv={transition:null},RY={ReactCurrentDispatcher:dl,ReactCurrentBatchConfig:jv,ReactCurrentOwner:m3};function dB(){throw Error("act(...) is not supported in production builds of React.")}xi.Children={map:rb,forEach:function(e,t,r){rb(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return rb(e,function(){t++}),t},toArray:function(e){return rb(e,function(t){return t})||[]},only:function(e){if(!g3(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};xi.Component=Qm;xi.Fragment=SY;xi.Profiler=jY;xi.PureComponent=h3;xi.StrictMode=_Y;xi.Suspense=CY;xi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RY;xi.act=dB;xi.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=aB({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=m3.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)lB.call(t,c)&&!cB.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:q1,type:e.type,key:i,ref:s,props:n,_owner:o}};xi.createContext=function(e){return e={$$typeof:AY,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:kY,_context:e},e.Consumer=e};xi.createElement=uB;xi.createFactory=function(e){var t=uB.bind(null,e);return t.type=e,t};xi.createRef=function(){return{current:null}};xi.forwardRef=function(e){return{$$typeof:NY,render:e}};xi.isValidElement=g3;xi.lazy=function(e){return{$$typeof:TY,_payload:{_status:-1,_result:e},_init:LY}};xi.memo=function(e,t){return{$$typeof:EY,type:e,compare:t===void 0?null:t}};xi.startTransition=function(e){var t=jv.transition;jv.transition={};try{e()}finally{jv.transition=t}};xi.unstable_act=dB;xi.useCallback=function(e,t){return dl.current.useCallback(e,t)};xi.useContext=function(e){return dl.current.useContext(e)};xi.useDebugValue=function(){};xi.useDeferredValue=function(e){return dl.current.useDeferredValue(e)};xi.useEffect=function(e,t){return dl.current.useEffect(e,t)};xi.useId=function(){return dl.current.useId()};xi.useImperativeHandle=function(e,t,r){return dl.current.useImperativeHandle(e,t,r)};xi.useInsertionEffect=function(e,t){return dl.current.useInsertionEffect(e,t)};xi.useLayoutEffect=function(e,t){return dl.current.useLayoutEffect(e,t)};xi.useMemo=function(e,t){return dl.current.useMemo(e,t)};xi.useReducer=function(e,t,r){return dl.current.useReducer(e,t,r)};xi.useRef=function(e){return dl.current.useRef(e)};xi.useState=function(e){return dl.current.useState(e)};xi.useSyncExternalStore=function(e,t,r){return dl.current.useSyncExternalStore(e,t,r)};xi.useTransition=function(){return dl.current.useTransition()};xi.version="18.3.1";nB.exports=xi;var x=nB.exports;const Jr=sf(x),fB=vY({__proto__:null,default:Jr},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FY=x,BY=Symbol.for("react.element"),IY=Symbol.for("react.fragment"),DY=Object.prototype.hasOwnProperty,$Y=FY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UY={key:!0,ref:!0,__self:!0,__source:!0};function hB(e,t,r){var n,i={},s=null,o=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)DY.call(t,n)&&!UY.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:BY,type:e,key:s,ref:o,props:i,_owner:$Y.current}}Yw.Fragment=IY;Yw.jsx=hB;Yw.jsxs=hB;rB.exports=Yw;var a=rB.exports,pB={exports:{}},dc={},mB={exports:{}},gB={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(W,V){var ae=W.length;W.push(V);e:for(;0<ae;){var ee=ae-1>>>1,C=W[ee];if(0<i(C,V))W[ee]=V,W[ae]=C,ae=ee;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var V=W[0],ae=W.pop();if(ae!==V){W[0]=ae;e:for(var ee=0,C=W.length,Y=C>>>1;ee<Y;){var q=2*(ee+1)-1,O=W[q],X=q+1,F=W[X];if(0>i(O,ae))X<C&&0>i(F,O)?(W[ee]=F,W[X]=ae,ee=X):(W[ee]=O,W[q]=ae,ee=q);else if(X<C&&0>i(F,ae))W[ee]=F,W[X]=ae,ee=X;else break e}}return V}function i(W,V){var ae=W.sortIndex-V.sortIndex;return ae!==0?ae:W.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,f=null,p=3,h=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(W){for(var V=r(u);V!==null;){if(V.callback===null)n(u);else if(V.startTime<=W)n(u),V.sortIndex=V.expirationTime,t(c,V);else break;V=r(u)}}function S(W){if(g=!1,w(W),!m)if(r(c)!==null)m=!0,oe(j);else{var V=r(u);V!==null&&de(S,V.startTime-W)}}function j(W,V){m=!1,g&&(g=!1,b(R),R=-1),h=!0;var ae=p;try{for(w(V),f=r(c);f!==null&&(!(f.expirationTime>V)||W&&!E());){var ee=f.callback;if(typeof ee=="function"){f.callback=null,p=f.priorityLevel;var C=ee(f.expirationTime<=V);V=e.unstable_now(),typeof C=="function"?f.callback=C:f===r(c)&&n(c),w(V)}else n(c);f=r(c)}if(f!==null)var Y=!0;else{var q=r(u);q!==null&&de(S,q.startTime-V),Y=!1}return Y}finally{f=null,p=ae,h=!1}}var k=!1,A=null,R=-1,M=5,B=-1;function E(){return!(e.unstable_now()-B<M)}function P(){if(A!==null){var W=e.unstable_now();B=W;var V=!0;try{V=A(!0,W)}finally{V?D():(k=!1,A=null)}}else k=!1}var D;if(typeof v=="function")D=function(){v(P)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,H=G.port2;G.port1.onmessage=P,D=function(){H.postMessage(null)}}else D=function(){y(P,0)};function oe(W){A=W,k||(k=!0,D())}function de(W,V){R=y(function(){W(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,oe(j))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(W){switch(p){case 1:case 2:case 3:var V=3;break;default:V=p}var ae=p;p=V;try{return W()}finally{p=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,V){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var ae=p;p=W;try{return V()}finally{p=ae}},e.unstable_scheduleCallback=function(W,V,ae){var ee=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?ee+ae:ee):ae=ee,W){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=ae+C,W={id:d++,callback:V,priorityLevel:W,startTime:ae,expirationTime:C,sortIndex:-1},ae>ee?(W.sortIndex=ae,t(u,W),r(c)===null&&W===r(u)&&(g?(b(R),R=-1):g=!0,de(S,ae-ee))):(W.sortIndex=C,t(c,W),m||h||(m=!0,oe(j))),W},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(W){var V=p;return function(){var ae=p;p=V;try{return W.apply(this,arguments)}finally{p=ae}}}})(gB);mB.exports=gB;var zY=mB.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WY=x,ac=zY;function Xr(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xB=new Set,Wx={};function D0(e,t){jm(e,t),jm(e+"Capture",t)}function jm(e,t){for(Wx[e]=t,e=0;e<t.length;e++)xB.add(t[e])}var Hd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ak=Object.prototype.hasOwnProperty,qY=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pT={},mT={};function HY(e){return Ak.call(mT,e)?!0:Ak.call(pT,e)?!1:qY.test(e)?mT[e]=!0:(pT[e]=!0,!1)}function VY(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function GY(e,t,r,n){if(t===null||typeof t>"u"||VY(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function fl(e,t,r,n,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var yo={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){yo[e]=new fl(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];yo[t]=new fl(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){yo[e]=new fl(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){yo[e]=new fl(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){yo[e]=new fl(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){yo[e]=new fl(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){yo[e]=new fl(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){yo[e]=new fl(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){yo[e]=new fl(e,5,!1,e.toLowerCase(),null,!1,!1)});var x3=/[\-:]([a-z])/g;function y3(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x3,y3);yo[t]=new fl(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x3,y3);yo[t]=new fl(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x3,y3);yo[t]=new fl(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){yo[e]=new fl(e,1,!1,e.toLowerCase(),null,!1,!1)});yo.xlinkHref=new fl("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){yo[e]=new fl(e,1,!1,e.toLowerCase(),null,!0,!0)});function b3(e,t,r,n){var i=yo.hasOwnProperty(t)?yo[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(GY(t,r,i,n)&&(r=null),n||i===null?HY(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var of=WY.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nb=Symbol.for("react.element"),Dp=Symbol.for("react.portal"),$p=Symbol.for("react.fragment"),v3=Symbol.for("react.strict_mode"),Nk=Symbol.for("react.profiler"),yB=Symbol.for("react.provider"),bB=Symbol.for("react.context"),w3=Symbol.for("react.forward_ref"),Ck=Symbol.for("react.suspense"),Ek=Symbol.for("react.suspense_list"),S3=Symbol.for("react.memo"),Rf=Symbol.for("react.lazy"),vB=Symbol.for("react.offscreen"),gT=Symbol.iterator;function Lg(e){return e===null||typeof e!="object"?null:(e=gT&&e[gT]||e["@@iterator"],typeof e=="function"?e:null)}var La=Object.assign,m5;function lx(e){if(m5===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);m5=t&&t[1]||""}return`
`+m5+e}var g5=!1;function x5(e,t){if(!e||g5)return"";g5=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=n.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var c=`
`+i[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{g5=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?lx(e):""}function KY(e){switch(e.tag){case 5:return lx(e.type);case 16:return lx("Lazy");case 13:return lx("Suspense");case 19:return lx("SuspenseList");case 0:case 2:case 15:return e=x5(e.type,!1),e;case 11:return e=x5(e.type.render,!1),e;case 1:return e=x5(e.type,!0),e;default:return""}}function Tk(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case $p:return"Fragment";case Dp:return"Portal";case Nk:return"Profiler";case v3:return"StrictMode";case Ck:return"Suspense";case Ek:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case bB:return(e.displayName||"Context")+".Consumer";case yB:return(e._context.displayName||"Context")+".Provider";case w3:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case S3:return t=e.displayName||null,t!==null?t:Tk(e.type)||"Memo";case Rf:t=e._payload,e=e._init;try{return Tk(e(t))}catch{}}return null}function YY(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tk(t);case 8:return t===v3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ch(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function wB(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function XY(e){var t=wB(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){n=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ib(e){e._valueTracker||(e._valueTracker=XY(e))}function SB(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=wB(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function e2(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Pk(e,t){var r=t.checked;return La({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function xT(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ch(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _B(e,t){t=t.checked,t!=null&&b3(e,"checked",t,!1)}function Ok(e,t){_B(e,t);var r=ch(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Mk(e,t.type,r):t.hasOwnProperty("defaultValue")&&Mk(e,t.type,ch(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function yT(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Mk(e,t,r){(t!=="number"||e2(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var cx=Array.isArray;function im(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ch(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Lk(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Xr(91));return La({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function bT(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Xr(92));if(cx(r)){if(1<r.length)throw Error(Xr(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ch(r)}}function jB(e,t){var r=ch(t.value),n=ch(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function vT(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function kB(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Rk(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?kB(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ab,AB=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ab=ab||document.createElement("div"),ab.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ab.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function qx(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var bx={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},QY=["Webkit","ms","Moz","O"];Object.keys(bx).forEach(function(e){QY.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),bx[t]=bx[e]})});function NB(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||bx.hasOwnProperty(e)&&bx[e]?(""+t).trim():t+"px"}function CB(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=NB(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var JY=La({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fk(e,t){if(t){if(JY[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Xr(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Xr(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Xr(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Xr(62))}}function Bk(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ik=null;function _3(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Dk=null,am=null,sm=null;function wT(e){if(e=G1(e)){if(typeof Dk!="function")throw Error(Xr(280));var t=e.stateNode;t&&(t=eS(t),Dk(e.stateNode,e.type,t))}}function EB(e){am?sm?sm.push(e):sm=[e]:am=e}function TB(){if(am){var e=am,t=sm;if(sm=am=null,wT(e),t)for(e=0;e<t.length;e++)wT(t[e])}}function PB(e,t){return e(t)}function OB(){}var y5=!1;function MB(e,t,r){if(y5)return e(t,r);y5=!0;try{return PB(e,t,r)}finally{y5=!1,(am!==null||sm!==null)&&(OB(),TB())}}function Hx(e,t){var r=e.stateNode;if(r===null)return null;var n=eS(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Xr(231,t,typeof r));return r}var $k=!1;if(Hd)try{var Rg={};Object.defineProperty(Rg,"passive",{get:function(){$k=!0}}),window.addEventListener("test",Rg,Rg),window.removeEventListener("test",Rg,Rg)}catch{$k=!1}function ZY(e,t,r,n,i,s,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var vx=!1,t2=null,r2=!1,Uk=null,eX={onError:function(e){vx=!0,t2=e}};function tX(e,t,r,n,i,s,o,l,c){vx=!1,t2=null,ZY.apply(eX,arguments)}function rX(e,t,r,n,i,s,o,l,c){if(tX.apply(this,arguments),vx){if(vx){var u=t2;vx=!1,t2=null}else throw Error(Xr(198));r2||(r2=!0,Uk=u)}}function $0(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function LB(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ST(e){if($0(e)!==e)throw Error(Xr(188))}function nX(e){var t=e.alternate;if(!t){if(t=$0(e),t===null)throw Error(Xr(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var s=i.alternate;if(s===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===r)return ST(i),e;if(s===n)return ST(i),t;s=s.sibling}throw Error(Xr(188))}if(r.return!==n.return)r=i,n=s;else{for(var o=!1,l=i.child;l;){if(l===r){o=!0,r=i,n=s;break}if(l===n){o=!0,n=i,r=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===r){o=!0,r=s,n=i;break}if(l===n){o=!0,n=s,r=i;break}l=l.sibling}if(!o)throw Error(Xr(189))}}if(r.alternate!==n)throw Error(Xr(190))}if(r.tag!==3)throw Error(Xr(188));return r.stateNode.current===r?e:t}function RB(e){return e=nX(e),e!==null?FB(e):null}function FB(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=FB(e);if(t!==null)return t;e=e.sibling}return null}var BB=ac.unstable_scheduleCallback,_T=ac.unstable_cancelCallback,iX=ac.unstable_shouldYield,aX=ac.unstable_requestPaint,ts=ac.unstable_now,sX=ac.unstable_getCurrentPriorityLevel,j3=ac.unstable_ImmediatePriority,IB=ac.unstable_UserBlockingPriority,n2=ac.unstable_NormalPriority,oX=ac.unstable_LowPriority,DB=ac.unstable_IdlePriority,Xw=null,Ju=null;function lX(e){if(Ju&&typeof Ju.onCommitFiberRoot=="function")try{Ju.onCommitFiberRoot(Xw,e,void 0,(e.current.flags&128)===128)}catch{}}var hu=Math.clz32?Math.clz32:dX,cX=Math.log,uX=Math.LN2;function dX(e){return e>>>=0,e===0?32:31-(cX(e)/uX|0)|0}var sb=64,ob=4194304;function ux(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function i2(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,s=e.pingedLanes,o=r&268435455;if(o!==0){var l=o&~i;l!==0?n=ux(l):(s&=o,s!==0&&(n=ux(s)))}else o=r&~i,o!==0?n=ux(o):s!==0&&(n=ux(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-hu(t),i=1<<r,n|=e[r],t&=~i;return n}function fX(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hX(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-hu(s),l=1<<o,c=i[o];c===-1?(!(l&r)||l&n)&&(i[o]=fX(l,t)):c<=t&&(e.expiredLanes|=l),s&=~l}}function zk(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function $B(){var e=sb;return sb<<=1,!(sb&4194240)&&(sb=64),e}function b5(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function H1(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-hu(t),e[t]=r}function pX(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-hu(r),s=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~s}}function k3(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-hu(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Gi=0;function UB(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var zB,A3,WB,qB,HB,Wk=!1,lb=[],Qf=null,Jf=null,Zf=null,Vx=new Map,Gx=new Map,Df=[],mX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jT(e,t){switch(e){case"focusin":case"focusout":Qf=null;break;case"dragenter":case"dragleave":Jf=null;break;case"mouseover":case"mouseout":Zf=null;break;case"pointerover":case"pointerout":Vx.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Gx.delete(t.pointerId)}}function Fg(e,t,r,n,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[i]},t!==null&&(t=G1(t),t!==null&&A3(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function gX(e,t,r,n,i){switch(t){case"focusin":return Qf=Fg(Qf,e,t,r,n,i),!0;case"dragenter":return Jf=Fg(Jf,e,t,r,n,i),!0;case"mouseover":return Zf=Fg(Zf,e,t,r,n,i),!0;case"pointerover":var s=i.pointerId;return Vx.set(s,Fg(Vx.get(s)||null,e,t,r,n,i)),!0;case"gotpointercapture":return s=i.pointerId,Gx.set(s,Fg(Gx.get(s)||null,e,t,r,n,i)),!0}return!1}function VB(e){var t=Vh(e.target);if(t!==null){var r=$0(t);if(r!==null){if(t=r.tag,t===13){if(t=LB(r),t!==null){e.blockedOn=t,HB(e.priority,function(){WB(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function kv(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=qk(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Ik=n,r.target.dispatchEvent(n),Ik=null}else return t=G1(r),t!==null&&A3(t),e.blockedOn=r,!1;t.shift()}return!0}function kT(e,t,r){kv(e)&&r.delete(t)}function xX(){Wk=!1,Qf!==null&&kv(Qf)&&(Qf=null),Jf!==null&&kv(Jf)&&(Jf=null),Zf!==null&&kv(Zf)&&(Zf=null),Vx.forEach(kT),Gx.forEach(kT)}function Bg(e,t){e.blockedOn===t&&(e.blockedOn=null,Wk||(Wk=!0,ac.unstable_scheduleCallback(ac.unstable_NormalPriority,xX)))}function Kx(e){function t(i){return Bg(i,e)}if(0<lb.length){Bg(lb[0],e);for(var r=1;r<lb.length;r++){var n=lb[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Qf!==null&&Bg(Qf,e),Jf!==null&&Bg(Jf,e),Zf!==null&&Bg(Zf,e),Vx.forEach(t),Gx.forEach(t),r=0;r<Df.length;r++)n=Df[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Df.length&&(r=Df[0],r.blockedOn===null);)VB(r),r.blockedOn===null&&Df.shift()}var om=of.ReactCurrentBatchConfig,a2=!0;function yX(e,t,r,n){var i=Gi,s=om.transition;om.transition=null;try{Gi=1,N3(e,t,r,n)}finally{Gi=i,om.transition=s}}function bX(e,t,r,n){var i=Gi,s=om.transition;om.transition=null;try{Gi=4,N3(e,t,r,n)}finally{Gi=i,om.transition=s}}function N3(e,t,r,n){if(a2){var i=qk(e,t,r,n);if(i===null)E5(e,t,n,s2,r),jT(e,n);else if(gX(i,e,t,r,n))n.stopPropagation();else if(jT(e,n),t&4&&-1<mX.indexOf(e)){for(;i!==null;){var s=G1(i);if(s!==null&&zB(s),s=qk(e,t,r,n),s===null&&E5(e,t,n,s2,r),s===i)break;i=s}i!==null&&n.stopPropagation()}else E5(e,t,n,null,r)}}var s2=null;function qk(e,t,r,n){if(s2=null,e=_3(n),e=Vh(e),e!==null)if(t=$0(e),t===null)e=null;else if(r=t.tag,r===13){if(e=LB(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return s2=e,null}function GB(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sX()){case j3:return 1;case IB:return 4;case n2:case oX:return 16;case DB:return 536870912;default:return 16}default:return 16}}var qf=null,C3=null,Av=null;function KB(){if(Av)return Av;var e,t=C3,r=t.length,n,i="value"in qf?qf.value:qf.textContent,s=i.length;for(e=0;e<r&&t[e]===i[e];e++);var o=r-e;for(n=1;n<=o&&t[r-n]===i[s-n];n++);return Av=i.slice(e,1<n?1-n:void 0)}function Nv(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function cb(){return!0}function AT(){return!1}function fc(e){function t(r,n,i,s,o){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(r=e[l],this[l]=r?r(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?cb:AT,this.isPropagationStopped=AT,this}return La(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=cb)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=cb)},persist:function(){},isPersistent:cb}),t}var Jm={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},E3=fc(Jm),V1=La({},Jm,{view:0,detail:0}),vX=fc(V1),v5,w5,Ig,Qw=La({},V1,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:T3,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ig&&(Ig&&e.type==="mousemove"?(v5=e.screenX-Ig.screenX,w5=e.screenY-Ig.screenY):w5=v5=0,Ig=e),v5)},movementY:function(e){return"movementY"in e?e.movementY:w5}}),NT=fc(Qw),wX=La({},Qw,{dataTransfer:0}),SX=fc(wX),_X=La({},V1,{relatedTarget:0}),S5=fc(_X),jX=La({},Jm,{animationName:0,elapsedTime:0,pseudoElement:0}),kX=fc(jX),AX=La({},Jm,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),NX=fc(AX),CX=La({},Jm,{data:0}),CT=fc(CX),EX={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TX={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},PX={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OX(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=PX[e])?!!t[e]:!1}function T3(){return OX}var MX=La({},V1,{key:function(e){if(e.key){var t=EX[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Nv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?TX[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:T3,charCode:function(e){return e.type==="keypress"?Nv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Nv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),LX=fc(MX),RX=La({},Qw,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ET=fc(RX),FX=La({},V1,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:T3}),BX=fc(FX),IX=La({},Jm,{propertyName:0,elapsedTime:0,pseudoElement:0}),DX=fc(IX),$X=La({},Qw,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),UX=fc($X),zX=[9,13,27,32],P3=Hd&&"CompositionEvent"in window,wx=null;Hd&&"documentMode"in document&&(wx=document.documentMode);var WX=Hd&&"TextEvent"in window&&!wx,YB=Hd&&(!P3||wx&&8<wx&&11>=wx),TT=" ",PT=!1;function XB(e,t){switch(e){case"keyup":return zX.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function QB(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Up=!1;function qX(e,t){switch(e){case"compositionend":return QB(t);case"keypress":return t.which!==32?null:(PT=!0,TT);case"textInput":return e=t.data,e===TT&&PT?null:e;default:return null}}function HX(e,t){if(Up)return e==="compositionend"||!P3&&XB(e,t)?(e=KB(),Av=C3=qf=null,Up=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return YB&&t.locale!=="ko"?null:t.data;default:return null}}var VX={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function OT(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!VX[e.type]:t==="textarea"}function JB(e,t,r,n){EB(n),t=o2(t,"onChange"),0<t.length&&(r=new E3("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Sx=null,Yx=null;function GX(e){cI(e,0)}function Jw(e){var t=qp(e);if(SB(t))return e}function KX(e,t){if(e==="change")return t}var ZB=!1;if(Hd){var _5;if(Hd){var j5="oninput"in document;if(!j5){var MT=document.createElement("div");MT.setAttribute("oninput","return;"),j5=typeof MT.oninput=="function"}_5=j5}else _5=!1;ZB=_5&&(!document.documentMode||9<document.documentMode)}function LT(){Sx&&(Sx.detachEvent("onpropertychange",eI),Yx=Sx=null)}function eI(e){if(e.propertyName==="value"&&Jw(Yx)){var t=[];JB(t,Yx,e,_3(e)),MB(GX,t)}}function YX(e,t,r){e==="focusin"?(LT(),Sx=t,Yx=r,Sx.attachEvent("onpropertychange",eI)):e==="focusout"&&LT()}function XX(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Jw(Yx)}function QX(e,t){if(e==="click")return Jw(t)}function JX(e,t){if(e==="input"||e==="change")return Jw(t)}function ZX(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yu=typeof Object.is=="function"?Object.is:ZX;function Xx(e,t){if(yu(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!Ak.call(t,i)||!yu(e[i],t[i]))return!1}return!0}function RT(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function FT(e,t){var r=RT(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=RT(r)}}function tI(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?tI(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function rI(){for(var e=window,t=e2();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=e2(e.document)}return t}function O3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function eQ(e){var t=rI(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&tI(r.ownerDocument.documentElement,r)){if(n!==null&&O3(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,s=Math.min(n.start,i);n=n.end===void 0?s:Math.min(n.end,i),!e.extend&&s>n&&(i=n,n=s,s=i),i=FT(r,s);var o=FT(r,n);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var tQ=Hd&&"documentMode"in document&&11>=document.documentMode,zp=null,Hk=null,_x=null,Vk=!1;function BT(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Vk||zp==null||zp!==e2(n)||(n=zp,"selectionStart"in n&&O3(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),_x&&Xx(_x,n)||(_x=n,n=o2(Hk,"onSelect"),0<n.length&&(t=new E3("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=zp)))}function ub(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Wp={animationend:ub("Animation","AnimationEnd"),animationiteration:ub("Animation","AnimationIteration"),animationstart:ub("Animation","AnimationStart"),transitionend:ub("Transition","TransitionEnd")},k5={},nI={};Hd&&(nI=document.createElement("div").style,"AnimationEvent"in window||(delete Wp.animationend.animation,delete Wp.animationiteration.animation,delete Wp.animationstart.animation),"TransitionEvent"in window||delete Wp.transitionend.transition);function Zw(e){if(k5[e])return k5[e];if(!Wp[e])return e;var t=Wp[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in nI)return k5[e]=t[r];return e}var iI=Zw("animationend"),aI=Zw("animationiteration"),sI=Zw("animationstart"),oI=Zw("transitionend"),lI=new Map,IT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function vh(e,t){lI.set(e,t),D0(t,[e])}for(var A5=0;A5<IT.length;A5++){var N5=IT[A5],rQ=N5.toLowerCase(),nQ=N5[0].toUpperCase()+N5.slice(1);vh(rQ,"on"+nQ)}vh(iI,"onAnimationEnd");vh(aI,"onAnimationIteration");vh(sI,"onAnimationStart");vh("dblclick","onDoubleClick");vh("focusin","onFocus");vh("focusout","onBlur");vh(oI,"onTransitionEnd");jm("onMouseEnter",["mouseout","mouseover"]);jm("onMouseLeave",["mouseout","mouseover"]);jm("onPointerEnter",["pointerout","pointerover"]);jm("onPointerLeave",["pointerout","pointerover"]);D0("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));D0("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));D0("onBeforeInput",["compositionend","keypress","textInput","paste"]);D0("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));D0("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));D0("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dx="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),iQ=new Set("cancel close invalid load scroll toggle".split(" ").concat(dx));function DT(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,rX(n,t,void 0,e),e.currentTarget=null}function cI(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==s&&i.isPropagationStopped())break e;DT(i,l,u),s=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==s&&i.isPropagationStopped())break e;DT(i,l,u),s=c}}}if(r2)throw e=Uk,r2=!1,Uk=null,e}function fa(e,t){var r=t[Qk];r===void 0&&(r=t[Qk]=new Set);var n=e+"__bubble";r.has(n)||(uI(t,e,2,!1),r.add(n))}function C5(e,t,r){var n=0;t&&(n|=4),uI(r,e,n,t)}var db="_reactListening"+Math.random().toString(36).slice(2);function Qx(e){if(!e[db]){e[db]=!0,xB.forEach(function(r){r!=="selectionchange"&&(iQ.has(r)||C5(r,!1,e),C5(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[db]||(t[db]=!0,C5("selectionchange",!1,t))}}function uI(e,t,r,n){switch(GB(t)){case 1:var i=yX;break;case 4:i=bX;break;default:i=N3}r=i.bind(null,t,r,e),i=void 0,!$k||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function E5(e,t,r,n,i){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Vh(l),o===null)return;if(c=o.tag,c===5||c===6){n=s=o;continue e}l=l.parentNode}}n=n.return}MB(function(){var u=s,d=_3(r),f=[];e:{var p=lI.get(e);if(p!==void 0){var h=E3,m=e;switch(e){case"keypress":if(Nv(r)===0)break e;case"keydown":case"keyup":h=LX;break;case"focusin":m="focus",h=S5;break;case"focusout":m="blur",h=S5;break;case"beforeblur":case"afterblur":h=S5;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=NT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=SX;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=BX;break;case iI:case aI:case sI:h=kX;break;case oI:h=DX;break;case"scroll":h=vX;break;case"wheel":h=UX;break;case"copy":case"cut":case"paste":h=NX;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=ET}var g=(t&4)!==0,y=!g&&e==="scroll",b=g?p!==null?p+"Capture":null:p;g=[];for(var v=u,w;v!==null;){w=v;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,b!==null&&(S=Hx(v,b),S!=null&&g.push(Jx(v,S,w)))),y)break;v=v.return}0<g.length&&(p=new h(p,m,null,r,d),f.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Ik&&(m=r.relatedTarget||r.fromElement)&&(Vh(m)||m[Vd]))break e;if((h||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=u,m=m?Vh(m):null,m!==null&&(y=$0(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(g=NT,S="onMouseLeave",b="onMouseEnter",v="mouse",(e==="pointerout"||e==="pointerover")&&(g=ET,S="onPointerLeave",b="onPointerEnter",v="pointer"),y=h==null?p:qp(h),w=m==null?p:qp(m),p=new g(S,v+"leave",h,r,d),p.target=y,p.relatedTarget=w,S=null,Vh(d)===u&&(g=new g(b,v+"enter",m,r,d),g.target=w,g.relatedTarget=y,S=g),y=S,h&&m)t:{for(g=h,b=m,v=0,w=g;w;w=fp(w))v++;for(w=0,S=b;S;S=fp(S))w++;for(;0<v-w;)g=fp(g),v--;for(;0<w-v;)b=fp(b),w--;for(;v--;){if(g===b||b!==null&&g===b.alternate)break t;g=fp(g),b=fp(b)}g=null}else g=null;h!==null&&$T(f,p,h,g,!1),m!==null&&y!==null&&$T(f,y,m,g,!0)}}e:{if(p=u?qp(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var j=KX;else if(OT(p))if(ZB)j=JX;else{j=XX;var k=YX}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(j=QX);if(j&&(j=j(e,u))){JB(f,j,r,d);break e}k&&k(e,p,u),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&Mk(p,"number",p.value)}switch(k=u?qp(u):window,e){case"focusin":(OT(k)||k.contentEditable==="true")&&(zp=k,Hk=u,_x=null);break;case"focusout":_x=Hk=zp=null;break;case"mousedown":Vk=!0;break;case"contextmenu":case"mouseup":case"dragend":Vk=!1,BT(f,r,d);break;case"selectionchange":if(tQ)break;case"keydown":case"keyup":BT(f,r,d)}var A;if(P3)e:{switch(e){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else Up?XB(e,r)&&(R="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(R="onCompositionStart");R&&(YB&&r.locale!=="ko"&&(Up||R!=="onCompositionStart"?R==="onCompositionEnd"&&Up&&(A=KB()):(qf=d,C3="value"in qf?qf.value:qf.textContent,Up=!0)),k=o2(u,R),0<k.length&&(R=new CT(R,e,null,r,d),f.push({event:R,listeners:k}),A?R.data=A:(A=QB(r),A!==null&&(R.data=A)))),(A=WX?qX(e,r):HX(e,r))&&(u=o2(u,"onBeforeInput"),0<u.length&&(d=new CT("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=A))}cI(f,t)})}function Jx(e,t,r){return{instance:e,listener:t,currentTarget:r}}function o2(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Hx(e,r),s!=null&&n.unshift(Jx(e,s,i)),s=Hx(e,t),s!=null&&n.push(Jx(e,s,i))),e=e.return}return n}function fp(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function $T(e,t,r,n,i){for(var s=t._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,i?(c=Hx(r,s),c!=null&&o.unshift(Jx(r,c,l))):i||(c=Hx(r,s),c!=null&&o.push(Jx(r,c,l)))),r=r.return}o.length!==0&&e.push({event:t,listeners:o})}var aQ=/\r\n?/g,sQ=/\u0000|\uFFFD/g;function UT(e){return(typeof e=="string"?e:""+e).replace(aQ,`
`).replace(sQ,"")}function fb(e,t,r){if(t=UT(t),UT(e)!==t&&r)throw Error(Xr(425))}function l2(){}var Gk=null,Kk=null;function Yk(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Xk=typeof setTimeout=="function"?setTimeout:void 0,oQ=typeof clearTimeout=="function"?clearTimeout:void 0,zT=typeof Promise=="function"?Promise:void 0,lQ=typeof queueMicrotask=="function"?queueMicrotask:typeof zT<"u"?function(e){return zT.resolve(null).then(e).catch(cQ)}:Xk;function cQ(e){setTimeout(function(){throw e})}function T5(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),Kx(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);Kx(t)}function eh(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function WT(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Zm=Math.random().toString(36).slice(2),Vu="__reactFiber$"+Zm,Zx="__reactProps$"+Zm,Vd="__reactContainer$"+Zm,Qk="__reactEvents$"+Zm,uQ="__reactListeners$"+Zm,dQ="__reactHandles$"+Zm;function Vh(e){var t=e[Vu];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Vd]||r[Vu]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=WT(e);e!==null;){if(r=e[Vu])return r;e=WT(e)}return t}e=r,r=e.parentNode}return null}function G1(e){return e=e[Vu]||e[Vd],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function qp(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Xr(33))}function eS(e){return e[Zx]||null}var Jk=[],Hp=-1;function wh(e){return{current:e}}function ga(e){0>Hp||(e.current=Jk[Hp],Jk[Hp]=null,Hp--)}function oa(e,t){Hp++,Jk[Hp]=e.current,e.current=t}var uh={},qo=wh(uh),Al=wh(!1),p0=uh;function km(e,t){var r=e.type.contextTypes;if(!r)return uh;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in r)i[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Nl(e){return e=e.childContextTypes,e!=null}function c2(){ga(Al),ga(qo)}function qT(e,t,r){if(qo.current!==uh)throw Error(Xr(168));oa(qo,t),oa(Al,r)}function dI(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(Xr(108,YY(e)||"Unknown",i));return La({},r,n)}function u2(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||uh,p0=qo.current,oa(qo,e),oa(Al,Al.current),!0}function HT(e,t,r){var n=e.stateNode;if(!n)throw Error(Xr(169));r?(e=dI(e,t,p0),n.__reactInternalMemoizedMergedChildContext=e,ga(Al),ga(qo),oa(qo,e)):ga(Al),oa(Al,r)}var Ad=null,tS=!1,P5=!1;function fI(e){Ad===null?Ad=[e]:Ad.push(e)}function fQ(e){tS=!0,fI(e)}function Sh(){if(!P5&&Ad!==null){P5=!0;var e=0,t=Gi;try{var r=Ad;for(Gi=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ad=null,tS=!1}catch(i){throw Ad!==null&&(Ad=Ad.slice(e+1)),BB(j3,Sh),i}finally{Gi=t,P5=!1}}return null}var Vp=[],Gp=0,d2=null,f2=0,Lc=[],Rc=0,m0=null,Pd=1,Od="";function Ih(e,t){Vp[Gp++]=f2,Vp[Gp++]=d2,d2=e,f2=t}function hI(e,t,r){Lc[Rc++]=Pd,Lc[Rc++]=Od,Lc[Rc++]=m0,m0=e;var n=Pd;e=Od;var i=32-hu(n)-1;n&=~(1<<i),r+=1;var s=32-hu(t)+i;if(30<s){var o=i-i%5;s=(n&(1<<o)-1).toString(32),n>>=o,i-=o,Pd=1<<32-hu(t)+i|r<<i|n,Od=s+e}else Pd=1<<s|r<<i|n,Od=e}function M3(e){e.return!==null&&(Ih(e,1),hI(e,1,0))}function L3(e){for(;e===d2;)d2=Vp[--Gp],Vp[Gp]=null,f2=Vp[--Gp],Vp[Gp]=null;for(;e===m0;)m0=Lc[--Rc],Lc[Rc]=null,Od=Lc[--Rc],Lc[Rc]=null,Pd=Lc[--Rc],Lc[Rc]=null}var nc=null,ec=null,Sa=!1,ou=null;function pI(e,t){var r=Bc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function VT(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,nc=e,ec=eh(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,nc=e,ec=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=m0!==null?{id:Pd,overflow:Od}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Bc(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,nc=e,ec=null,!0):!1;default:return!1}}function Zk(e){return(e.mode&1)!==0&&(e.flags&128)===0}function e4(e){if(Sa){var t=ec;if(t){var r=t;if(!VT(e,t)){if(Zk(e))throw Error(Xr(418));t=eh(r.nextSibling);var n=nc;t&&VT(e,t)?pI(n,r):(e.flags=e.flags&-4097|2,Sa=!1,nc=e)}}else{if(Zk(e))throw Error(Xr(418));e.flags=e.flags&-4097|2,Sa=!1,nc=e}}}function GT(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;nc=e}function hb(e){if(e!==nc)return!1;if(!Sa)return GT(e),Sa=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Yk(e.type,e.memoizedProps)),t&&(t=ec)){if(Zk(e))throw mI(),Error(Xr(418));for(;t;)pI(e,t),t=eh(t.nextSibling)}if(GT(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Xr(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ec=eh(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ec=null}}else ec=nc?eh(e.stateNode.nextSibling):null;return!0}function mI(){for(var e=ec;e;)e=eh(e.nextSibling)}function Am(){ec=nc=null,Sa=!1}function R3(e){ou===null?ou=[e]:ou.push(e)}var hQ=of.ReactCurrentBatchConfig;function Dg(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Xr(309));var n=r.stateNode}if(!n)throw Error(Xr(147,e));var i=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(Xr(284));if(!r._owner)throw Error(Xr(290,e))}return e}function pb(e,t){throw e=Object.prototype.toString.call(t),Error(Xr(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function KT(e){var t=e._init;return t(e._payload)}function gI(e){function t(b,v){if(e){var w=b.deletions;w===null?(b.deletions=[v],b.flags|=16):w.push(v)}}function r(b,v){if(!e)return null;for(;v!==null;)t(b,v),v=v.sibling;return null}function n(b,v){for(b=new Map;v!==null;)v.key!==null?b.set(v.key,v):b.set(v.index,v),v=v.sibling;return b}function i(b,v){return b=ih(b,v),b.index=0,b.sibling=null,b}function s(b,v,w){return b.index=w,e?(w=b.alternate,w!==null?(w=w.index,w<v?(b.flags|=2,v):w):(b.flags|=2,v)):(b.flags|=1048576,v)}function o(b){return e&&b.alternate===null&&(b.flags|=2),b}function l(b,v,w,S){return v===null||v.tag!==6?(v=I5(w,b.mode,S),v.return=b,v):(v=i(v,w),v.return=b,v)}function c(b,v,w,S){var j=w.type;return j===$p?d(b,v,w.props.children,S,w.key):v!==null&&(v.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Rf&&KT(j)===v.type)?(S=i(v,w.props),S.ref=Dg(b,v,w),S.return=b,S):(S=Lv(w.type,w.key,w.props,null,b.mode,S),S.ref=Dg(b,v,w),S.return=b,S)}function u(b,v,w,S){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=D5(w,b.mode,S),v.return=b,v):(v=i(v,w.children||[]),v.return=b,v)}function d(b,v,w,S,j){return v===null||v.tag!==7?(v=n0(w,b.mode,S,j),v.return=b,v):(v=i(v,w),v.return=b,v)}function f(b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=I5(""+v,b.mode,w),v.return=b,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case nb:return w=Lv(v.type,v.key,v.props,null,b.mode,w),w.ref=Dg(b,null,v),w.return=b,w;case Dp:return v=D5(v,b.mode,w),v.return=b,v;case Rf:var S=v._init;return f(b,S(v._payload),w)}if(cx(v)||Lg(v))return v=n0(v,b.mode,w,null),v.return=b,v;pb(b,v)}return null}function p(b,v,w,S){var j=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return j!==null?null:l(b,v,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case nb:return w.key===j?c(b,v,w,S):null;case Dp:return w.key===j?u(b,v,w,S):null;case Rf:return j=w._init,p(b,v,j(w._payload),S)}if(cx(w)||Lg(w))return j!==null?null:d(b,v,w,S,null);pb(b,w)}return null}function h(b,v,w,S,j){if(typeof S=="string"&&S!==""||typeof S=="number")return b=b.get(w)||null,l(v,b,""+S,j);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case nb:return b=b.get(S.key===null?w:S.key)||null,c(v,b,S,j);case Dp:return b=b.get(S.key===null?w:S.key)||null,u(v,b,S,j);case Rf:var k=S._init;return h(b,v,w,k(S._payload),j)}if(cx(S)||Lg(S))return b=b.get(w)||null,d(v,b,S,j,null);pb(v,S)}return null}function m(b,v,w,S){for(var j=null,k=null,A=v,R=v=0,M=null;A!==null&&R<w.length;R++){A.index>R?(M=A,A=null):M=A.sibling;var B=p(b,A,w[R],S);if(B===null){A===null&&(A=M);break}e&&A&&B.alternate===null&&t(b,A),v=s(B,v,R),k===null?j=B:k.sibling=B,k=B,A=M}if(R===w.length)return r(b,A),Sa&&Ih(b,R),j;if(A===null){for(;R<w.length;R++)A=f(b,w[R],S),A!==null&&(v=s(A,v,R),k===null?j=A:k.sibling=A,k=A);return Sa&&Ih(b,R),j}for(A=n(b,A);R<w.length;R++)M=h(A,b,R,w[R],S),M!==null&&(e&&M.alternate!==null&&A.delete(M.key===null?R:M.key),v=s(M,v,R),k===null?j=M:k.sibling=M,k=M);return e&&A.forEach(function(E){return t(b,E)}),Sa&&Ih(b,R),j}function g(b,v,w,S){var j=Lg(w);if(typeof j!="function")throw Error(Xr(150));if(w=j.call(w),w==null)throw Error(Xr(151));for(var k=j=null,A=v,R=v=0,M=null,B=w.next();A!==null&&!B.done;R++,B=w.next()){A.index>R?(M=A,A=null):M=A.sibling;var E=p(b,A,B.value,S);if(E===null){A===null&&(A=M);break}e&&A&&E.alternate===null&&t(b,A),v=s(E,v,R),k===null?j=E:k.sibling=E,k=E,A=M}if(B.done)return r(b,A),Sa&&Ih(b,R),j;if(A===null){for(;!B.done;R++,B=w.next())B=f(b,B.value,S),B!==null&&(v=s(B,v,R),k===null?j=B:k.sibling=B,k=B);return Sa&&Ih(b,R),j}for(A=n(b,A);!B.done;R++,B=w.next())B=h(A,b,R,B.value,S),B!==null&&(e&&B.alternate!==null&&A.delete(B.key===null?R:B.key),v=s(B,v,R),k===null?j=B:k.sibling=B,k=B);return e&&A.forEach(function(P){return t(b,P)}),Sa&&Ih(b,R),j}function y(b,v,w,S){if(typeof w=="object"&&w!==null&&w.type===$p&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case nb:e:{for(var j=w.key,k=v;k!==null;){if(k.key===j){if(j=w.type,j===$p){if(k.tag===7){r(b,k.sibling),v=i(k,w.props.children),v.return=b,b=v;break e}}else if(k.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Rf&&KT(j)===k.type){r(b,k.sibling),v=i(k,w.props),v.ref=Dg(b,k,w),v.return=b,b=v;break e}r(b,k);break}else t(b,k);k=k.sibling}w.type===$p?(v=n0(w.props.children,b.mode,S,w.key),v.return=b,b=v):(S=Lv(w.type,w.key,w.props,null,b.mode,S),S.ref=Dg(b,v,w),S.return=b,b=S)}return o(b);case Dp:e:{for(k=w.key;v!==null;){if(v.key===k)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){r(b,v.sibling),v=i(v,w.children||[]),v.return=b,b=v;break e}else{r(b,v);break}else t(b,v);v=v.sibling}v=D5(w,b.mode,S),v.return=b,b=v}return o(b);case Rf:return k=w._init,y(b,v,k(w._payload),S)}if(cx(w))return m(b,v,w,S);if(Lg(w))return g(b,v,w,S);pb(b,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(r(b,v.sibling),v=i(v,w),v.return=b,b=v):(r(b,v),v=I5(w,b.mode,S),v.return=b,b=v),o(b)):r(b,v)}return y}var Nm=gI(!0),xI=gI(!1),h2=wh(null),p2=null,Kp=null,F3=null;function B3(){F3=Kp=p2=null}function I3(e){var t=h2.current;ga(h2),e._currentValue=t}function t4(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function lm(e,t){p2=e,F3=Kp=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(wl=!0),e.firstContext=null)}function Uc(e){var t=e._currentValue;if(F3!==e)if(e={context:e,memoizedValue:t,next:null},Kp===null){if(p2===null)throw Error(Xr(308));Kp=e,p2.dependencies={lanes:0,firstContext:e}}else Kp=Kp.next=e;return t}var Gh=null;function D3(e){Gh===null?Gh=[e]:Gh.push(e)}function yI(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,D3(t)):(r.next=i.next,i.next=r),t.interleaved=r,Gd(e,n)}function Gd(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ff=!1;function $3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bI(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Id(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function th(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,ji&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Gd(e,r)}return i=n.interleaved,i===null?(t.next=t,D3(n)):(t.next=i.next,i.next=t),n.interleaved=t,Gd(e,r)}function Cv(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,k3(e,r)}}function YT(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?i=s=o:s=s.next=o,r=r.next}while(r!==null);s===null?i=s=t:s=s.next=t}else i=s=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function m2(e,t,r,n){var i=e.updateQueue;Ff=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?s=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(s!==null){var f=i.baseState;o=0,d=u=c=null,l=s;do{var p=l.lane,h=l.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:h,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var m=e,g=l;switch(p=t,h=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(h,f,p);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,p=typeof m=="function"?m.call(h,f,p):m,p==null)break e;f=La({},f,p);break e;case 2:Ff=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[l]:p.push(l))}else h={eventTime:h,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=h,c=f):d=d.next=h,o|=p;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;p=l,l=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(c=f),i.baseState=c,i.firstBaseUpdate=u,i.lastBaseUpdate=d,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);x0|=o,e.lanes=o,e.memoizedState=f}}function XT(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(Xr(191,i));i.call(n)}}}var K1={},Zu=wh(K1),e1=wh(K1),t1=wh(K1);function Kh(e){if(e===K1)throw Error(Xr(174));return e}function U3(e,t){switch(oa(t1,t),oa(e1,e),oa(Zu,K1),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Rk(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Rk(t,e)}ga(Zu),oa(Zu,t)}function Cm(){ga(Zu),ga(e1),ga(t1)}function vI(e){Kh(t1.current);var t=Kh(Zu.current),r=Rk(t,e.type);t!==r&&(oa(e1,e),oa(Zu,r))}function z3(e){e1.current===e&&(ga(Zu),ga(e1))}var Ea=wh(0);function g2(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var O5=[];function W3(){for(var e=0;e<O5.length;e++)O5[e]._workInProgressVersionPrimary=null;O5.length=0}var Ev=of.ReactCurrentDispatcher,M5=of.ReactCurrentBatchConfig,g0=0,Ma=null,Es=null,Hs=null,x2=!1,jx=!1,r1=0,pQ=0;function jo(){throw Error(Xr(321))}function q3(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!yu(e[r],t[r]))return!1;return!0}function H3(e,t,r,n,i,s){if(g0=s,Ma=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ev.current=e===null||e.memoizedState===null?yQ:bQ,e=r(n,i),jx){s=0;do{if(jx=!1,r1=0,25<=s)throw Error(Xr(301));s+=1,Hs=Es=null,t.updateQueue=null,Ev.current=vQ,e=r(n,i)}while(jx)}if(Ev.current=y2,t=Es!==null&&Es.next!==null,g0=0,Hs=Es=Ma=null,x2=!1,t)throw Error(Xr(300));return e}function V3(){var e=r1!==0;return r1=0,e}function zu(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hs===null?Ma.memoizedState=Hs=e:Hs=Hs.next=e,Hs}function zc(){if(Es===null){var e=Ma.alternate;e=e!==null?e.memoizedState:null}else e=Es.next;var t=Hs===null?Ma.memoizedState:Hs.next;if(t!==null)Hs=t,Es=e;else{if(e===null)throw Error(Xr(310));Es=e,e={memoizedState:Es.memoizedState,baseState:Es.baseState,baseQueue:Es.baseQueue,queue:Es.queue,next:null},Hs===null?Ma.memoizedState=Hs=e:Hs=Hs.next=e}return Hs}function n1(e,t){return typeof t=="function"?t(e):t}function L5(e){var t=zc(),r=t.queue;if(r===null)throw Error(Xr(311));r.lastRenderedReducer=e;var n=Es,i=n.baseQueue,s=r.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}n.baseQueue=i=s,r.pending=null}if(i!==null){s=i.next,n=n.baseState;var l=o=null,c=null,u=s;do{var d=u.lane;if((g0&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=n):c=c.next=f,Ma.lanes|=d,x0|=d}u=u.next}while(u!==null&&u!==s);c===null?o=n:c.next=l,yu(n,t.memoizedState)||(wl=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do s=i.lane,Ma.lanes|=s,x0|=s,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function R5(e){var t=zc(),r=t.queue;if(r===null)throw Error(Xr(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,s=t.memoizedState;if(i!==null){r.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);yu(s,t.memoizedState)||(wl=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function wI(){}function SI(e,t){var r=Ma,n=zc(),i=t(),s=!yu(n.memoizedState,i);if(s&&(n.memoizedState=i,wl=!0),n=n.queue,G3(kI.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Hs!==null&&Hs.memoizedState.tag&1){if(r.flags|=2048,i1(9,jI.bind(null,r,n,i,t),void 0,null),Qs===null)throw Error(Xr(349));g0&30||_I(r,t,i)}return i}function _I(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Ma.updateQueue,t===null?(t={lastEffect:null,stores:null},Ma.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function jI(e,t,r,n){t.value=r,t.getSnapshot=n,AI(t)&&NI(e)}function kI(e,t,r){return r(function(){AI(t)&&NI(e)})}function AI(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!yu(e,r)}catch{return!0}}function NI(e){var t=Gd(e,1);t!==null&&pu(t,e,1,-1)}function QT(e){var t=zu();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n1,lastRenderedState:e},t.queue=e,e=e.dispatch=xQ.bind(null,Ma,e),[t.memoizedState,e]}function i1(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Ma.updateQueue,t===null?(t={lastEffect:null,stores:null},Ma.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function CI(){return zc().memoizedState}function Tv(e,t,r,n){var i=zu();Ma.flags|=e,i.memoizedState=i1(1|t,r,void 0,n===void 0?null:n)}function rS(e,t,r,n){var i=zc();n=n===void 0?null:n;var s=void 0;if(Es!==null){var o=Es.memoizedState;if(s=o.destroy,n!==null&&q3(n,o.deps)){i.memoizedState=i1(t,r,s,n);return}}Ma.flags|=e,i.memoizedState=i1(1|t,r,s,n)}function JT(e,t){return Tv(8390656,8,e,t)}function G3(e,t){return rS(2048,8,e,t)}function EI(e,t){return rS(4,2,e,t)}function TI(e,t){return rS(4,4,e,t)}function PI(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function OI(e,t,r){return r=r!=null?r.concat([e]):null,rS(4,4,PI.bind(null,t,e),r)}function K3(){}function MI(e,t){var r=zc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&q3(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function LI(e,t){var r=zc();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&q3(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function RI(e,t,r){return g0&21?(yu(r,t)||(r=$B(),Ma.lanes|=r,x0|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,wl=!0),e.memoizedState=r)}function mQ(e,t){var r=Gi;Gi=r!==0&&4>r?r:4,e(!0);var n=M5.transition;M5.transition={};try{e(!1),t()}finally{Gi=r,M5.transition=n}}function FI(){return zc().memoizedState}function gQ(e,t,r){var n=nh(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},BI(e))II(t,r);else if(r=yI(e,t,r,n),r!==null){var i=il();pu(r,e,n,i),DI(r,t,n)}}function xQ(e,t,r){var n=nh(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(BI(e))II(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,l=s(o,r);if(i.hasEagerState=!0,i.eagerState=l,yu(l,o)){var c=t.interleaved;c===null?(i.next=i,D3(t)):(i.next=c.next,c.next=i),t.interleaved=i;return}}catch{}finally{}r=yI(e,t,i,n),r!==null&&(i=il(),pu(r,e,n,i),DI(r,t,n))}}function BI(e){var t=e.alternate;return e===Ma||t!==null&&t===Ma}function II(e,t){jx=x2=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function DI(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,k3(e,r)}}var y2={readContext:Uc,useCallback:jo,useContext:jo,useEffect:jo,useImperativeHandle:jo,useInsertionEffect:jo,useLayoutEffect:jo,useMemo:jo,useReducer:jo,useRef:jo,useState:jo,useDebugValue:jo,useDeferredValue:jo,useTransition:jo,useMutableSource:jo,useSyncExternalStore:jo,useId:jo,unstable_isNewReconciler:!1},yQ={readContext:Uc,useCallback:function(e,t){return zu().memoizedState=[e,t===void 0?null:t],e},useContext:Uc,useEffect:JT,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Tv(4194308,4,PI.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Tv(4194308,4,e,t)},useInsertionEffect:function(e,t){return Tv(4,2,e,t)},useMemo:function(e,t){var r=zu();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=zu();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=gQ.bind(null,Ma,e),[n.memoizedState,e]},useRef:function(e){var t=zu();return e={current:e},t.memoizedState=e},useState:QT,useDebugValue:K3,useDeferredValue:function(e){return zu().memoizedState=e},useTransition:function(){var e=QT(!1),t=e[0];return e=mQ.bind(null,e[1]),zu().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Ma,i=zu();if(Sa){if(r===void 0)throw Error(Xr(407));r=r()}else{if(r=t(),Qs===null)throw Error(Xr(349));g0&30||_I(n,t,r)}i.memoizedState=r;var s={value:r,getSnapshot:t};return i.queue=s,JT(kI.bind(null,n,s,e),[e]),n.flags|=2048,i1(9,jI.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=zu(),t=Qs.identifierPrefix;if(Sa){var r=Od,n=Pd;r=(n&~(1<<32-hu(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=r1++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=pQ++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},bQ={readContext:Uc,useCallback:MI,useContext:Uc,useEffect:G3,useImperativeHandle:OI,useInsertionEffect:EI,useLayoutEffect:TI,useMemo:LI,useReducer:L5,useRef:CI,useState:function(){return L5(n1)},useDebugValue:K3,useDeferredValue:function(e){var t=zc();return RI(t,Es.memoizedState,e)},useTransition:function(){var e=L5(n1)[0],t=zc().memoizedState;return[e,t]},useMutableSource:wI,useSyncExternalStore:SI,useId:FI,unstable_isNewReconciler:!1},vQ={readContext:Uc,useCallback:MI,useContext:Uc,useEffect:G3,useImperativeHandle:OI,useInsertionEffect:EI,useLayoutEffect:TI,useMemo:LI,useReducer:R5,useRef:CI,useState:function(){return R5(n1)},useDebugValue:K3,useDeferredValue:function(e){var t=zc();return Es===null?t.memoizedState=e:RI(t,Es.memoizedState,e)},useTransition:function(){var e=R5(n1)[0],t=zc().memoizedState;return[e,t]},useMutableSource:wI,useSyncExternalStore:SI,useId:FI,unstable_isNewReconciler:!1};function iu(e,t){if(e&&e.defaultProps){t=La({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function r4(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:La({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var nS={isMounted:function(e){return(e=e._reactInternals)?$0(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=il(),i=nh(e),s=Id(n,i);s.payload=t,r!=null&&(s.callback=r),t=th(e,s,i),t!==null&&(pu(t,e,i,n),Cv(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=il(),i=nh(e),s=Id(n,i);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=th(e,s,i),t!==null&&(pu(t,e,i,n),Cv(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=il(),n=nh(e),i=Id(r,n);i.tag=2,t!=null&&(i.callback=t),t=th(e,i,n),t!==null&&(pu(t,e,n,r),Cv(t,e,n))}};function ZT(e,t,r,n,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,o):t.prototype&&t.prototype.isPureReactComponent?!Xx(r,n)||!Xx(i,s):!0}function $I(e,t,r){var n=!1,i=uh,s=t.contextType;return typeof s=="object"&&s!==null?s=Uc(s):(i=Nl(t)?p0:qo.current,n=t.contextTypes,s=(n=n!=null)?km(e,i):uh),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=nS,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function e8(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&nS.enqueueReplaceState(t,t.state,null)}function n4(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},$3(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Uc(s):(s=Nl(t)?p0:qo.current,i.context=km(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(r4(e,t,s,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&nS.enqueueReplaceState(i,i.state,null),m2(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Em(e,t){try{var r="",n=t;do r+=KY(n),n=n.return;while(n);var i=r}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function F5(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function i4(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var wQ=typeof WeakMap=="function"?WeakMap:Map;function UI(e,t,r){r=Id(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){v2||(v2=!0,p4=n),i4(e,t)},r}function zI(e,t,r){r=Id(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){i4(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){i4(e,t),typeof n!="function"&&(rh===null?rh=new Set([this]):rh.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),r}function t8(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new wQ;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=RQ.bind(null,e,t,r),t.then(e,e))}function r8(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function n8(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Id(-1,1),t.tag=2,th(r,t,1))),r.lanes|=1),e)}var SQ=of.ReactCurrentOwner,wl=!1;function Zo(e,t,r,n){t.child=e===null?xI(t,null,r,n):Nm(t,e.child,r,n)}function i8(e,t,r,n,i){r=r.render;var s=t.ref;return lm(t,i),n=H3(e,t,r,n,s,i),r=V3(),e!==null&&!wl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Kd(e,t,i)):(Sa&&r&&M3(t),t.flags|=1,Zo(e,t,n,i),t.child)}function a8(e,t,r,n,i){if(e===null){var s=r.type;return typeof s=="function"&&!rN(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,WI(e,t,s,n,i)):(e=Lv(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(r=r.compare,r=r!==null?r:Xx,r(o,n)&&e.ref===t.ref)return Kd(e,t,i)}return t.flags|=1,e=ih(s,n),e.ref=t.ref,e.return=t,t.child=e}function WI(e,t,r,n,i){if(e!==null){var s=e.memoizedProps;if(Xx(s,n)&&e.ref===t.ref)if(wl=!1,t.pendingProps=n=s,(e.lanes&i)!==0)e.flags&131072&&(wl=!0);else return t.lanes=e.lanes,Kd(e,t,i)}return a4(e,t,r,n,i)}function qI(e,t,r){var n=t.pendingProps,i=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},oa(Xp,Kl),Kl|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,oa(Xp,Kl),Kl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,oa(Xp,Kl),Kl|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,oa(Xp,Kl),Kl|=n;return Zo(e,t,i,r),t.child}function HI(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function a4(e,t,r,n,i){var s=Nl(r)?p0:qo.current;return s=km(t,s),lm(t,i),r=H3(e,t,r,n,s,i),n=V3(),e!==null&&!wl?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Kd(e,t,i)):(Sa&&n&&M3(t),t.flags|=1,Zo(e,t,r,i),t.child)}function s8(e,t,r,n,i){if(Nl(r)){var s=!0;u2(t)}else s=!1;if(lm(t,i),t.stateNode===null)Pv(e,t),$I(t,r,n),n4(t,r,n,i),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Uc(u):(u=Nl(r)?p0:qo.current,u=km(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&e8(t,o,n,u),Ff=!1;var p=t.memoizedState;o.state=p,m2(t,n,o,i),c=t.memoizedState,l!==n||p!==c||Al.current||Ff?(typeof d=="function"&&(r4(t,r,d,n),c=t.memoizedState),(l=Ff||ZT(t,r,l,n,p,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,bI(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:iu(t.type,l),o.props=u,f=t.pendingProps,p=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Uc(c):(c=Nl(r)?p0:qo.current,c=km(t,c));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&e8(t,o,n,c),Ff=!1,p=t.memoizedState,o.state=p,m2(t,n,o,i);var m=t.memoizedState;l!==f||p!==m||Al.current||Ff?(typeof h=="function"&&(r4(t,r,h,n),m=t.memoizedState),(u=Ff||ZT(t,r,u,n,p,m,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,m,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,m,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),o.props=n,o.state=m,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return s4(e,t,r,n,s,i)}function s4(e,t,r,n,i,s){HI(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return i&&HT(t,r,!1),Kd(e,t,s);n=t.stateNode,SQ.current=t;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Nm(t,e.child,null,s),t.child=Nm(t,null,l,s)):Zo(e,t,l,s),t.memoizedState=n.state,i&&HT(t,r,!0),t.child}function VI(e){var t=e.stateNode;t.pendingContext?qT(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qT(e,t.context,!1),U3(e,t.containerInfo)}function o8(e,t,r,n,i){return Am(),R3(i),t.flags|=256,Zo(e,t,r,n),t.child}var o4={dehydrated:null,treeContext:null,retryLane:0};function l4(e){return{baseLanes:e,cachePool:null,transitions:null}}function GI(e,t,r){var n=t.pendingProps,i=Ea.current,s=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(i&2)!==0),l?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),oa(Ea,i&1),e===null)return e4(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,s?(n=t.mode,s=t.child,o={mode:"hidden",children:o},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=sS(o,n,0,null),e=n0(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=l4(r),t.memoizedState=o4,e):Y3(t,o));if(i=e.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return _Q(e,t,o,n,l,i,r);if(s){s=n.fallback,o=t.mode,i=e.child,l=i.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=ih(i,c),n.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=ih(l,s):(s=n0(s,o,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,o=e.child.memoizedState,o=o===null?l4(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~r,t.memoizedState=o4,n}return s=e.child,e=s.sibling,n=ih(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Y3(e,t){return t=sS({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function mb(e,t,r,n){return n!==null&&R3(n),Nm(t,e.child,null,r),e=Y3(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function _Q(e,t,r,n,i,s,o){if(r)return t.flags&256?(t.flags&=-257,n=F5(Error(Xr(422))),mb(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,i=t.mode,n=sS({mode:"visible",children:n.children},i,0,null),s=n0(s,i,o,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&Nm(t,e.child,null,o),t.child.memoizedState=l4(o),t.memoizedState=o4,s);if(!(t.mode&1))return mb(e,t,o,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var l=n.dgst;return n=l,s=Error(Xr(419)),n=F5(s,n,void 0),mb(e,t,o,n)}if(l=(o&e.childLanes)!==0,wl||l){if(n=Qs,n!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Gd(e,i),pu(n,e,i,-1))}return tN(),n=F5(Error(Xr(421))),mb(e,t,o,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=FQ.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,ec=eh(i.nextSibling),nc=t,Sa=!0,ou=null,e!==null&&(Lc[Rc++]=Pd,Lc[Rc++]=Od,Lc[Rc++]=m0,Pd=e.id,Od=e.overflow,m0=t),t=Y3(t,n.children),t.flags|=4096,t)}function l8(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),t4(e.return,t,r)}function B5(e,t,r,n,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=i)}function KI(e,t,r){var n=t.pendingProps,i=n.revealOrder,s=n.tail;if(Zo(e,t,n.children,r),n=Ea.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&l8(e,r,t);else if(e.tag===19)l8(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(oa(Ea,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&g2(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),B5(t,!1,i,r,s);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&g2(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}B5(t,!0,r,null,s);break;case"together":B5(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Pv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Kd(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),x0|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Xr(153));if(t.child!==null){for(e=t.child,r=ih(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ih(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function jQ(e,t,r){switch(t.tag){case 3:VI(t),Am();break;case 5:vI(t);break;case 1:Nl(t.type)&&u2(t);break;case 4:U3(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;oa(h2,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(oa(Ea,Ea.current&1),t.flags|=128,null):r&t.child.childLanes?GI(e,t,r):(oa(Ea,Ea.current&1),e=Kd(e,t,r),e!==null?e.sibling:null);oa(Ea,Ea.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return KI(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),oa(Ea,Ea.current),n)break;return null;case 22:case 23:return t.lanes=0,qI(e,t,r)}return Kd(e,t,r)}var YI,c4,XI,QI;YI=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};c4=function(){};XI=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Kh(Zu.current);var s=null;switch(r){case"input":i=Pk(e,i),n=Pk(e,n),s=[];break;case"select":i=La({},i,{value:void 0}),n=La({},n,{value:void 0}),s=[];break;case"textarea":i=Lk(e,i),n=Lk(e,n),s=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=l2)}Fk(r,n);var o;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Wx.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in n){var c=n[u];if(l=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(s||(s=[]),s.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(s=s||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Wx.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&fa("scroll",e),s||l===c||(s=[])):(s=s||[]).push(u,c))}r&&(s=s||[]).push("style",r);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};QI=function(e,t,r,n){r!==n&&(t.flags|=4)};function $g(e,t){if(!Sa)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ko(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function kQ(e,t,r){var n=t.pendingProps;switch(L3(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ko(t),null;case 1:return Nl(t.type)&&c2(),ko(t),null;case 3:return n=t.stateNode,Cm(),ga(Al),ga(qo),W3(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(hb(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ou!==null&&(x4(ou),ou=null))),c4(e,t),ko(t),null;case 5:z3(t);var i=Kh(t1.current);if(r=t.type,e!==null&&t.stateNode!=null)XI(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Xr(166));return ko(t),null}if(e=Kh(Zu.current),hb(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[Vu]=t,n[Zx]=s,e=(t.mode&1)!==0,r){case"dialog":fa("cancel",n),fa("close",n);break;case"iframe":case"object":case"embed":fa("load",n);break;case"video":case"audio":for(i=0;i<dx.length;i++)fa(dx[i],n);break;case"source":fa("error",n);break;case"img":case"image":case"link":fa("error",n),fa("load",n);break;case"details":fa("toggle",n);break;case"input":xT(n,s),fa("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},fa("invalid",n);break;case"textarea":bT(n,s),fa("invalid",n)}Fk(r,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?n.textContent!==l&&(s.suppressHydrationWarning!==!0&&fb(n.textContent,l,e),i=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&fb(n.textContent,l,e),i=["children",""+l]):Wx.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&fa("scroll",n)}switch(r){case"input":ib(n),yT(n,s,!0);break;case"textarea":ib(n),vT(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=l2)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kB(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(r,{is:n.is}):(e=o.createElement(r),r==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,r),e[Vu]=t,e[Zx]=n,YI(e,t,!1,!1),t.stateNode=e;e:{switch(o=Bk(r,n),r){case"dialog":fa("cancel",e),fa("close",e),i=n;break;case"iframe":case"object":case"embed":fa("load",e),i=n;break;case"video":case"audio":for(i=0;i<dx.length;i++)fa(dx[i],e);i=n;break;case"source":fa("error",e),i=n;break;case"img":case"image":case"link":fa("error",e),fa("load",e),i=n;break;case"details":fa("toggle",e),i=n;break;case"input":xT(e,n),i=Pk(e,n),fa("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=La({},n,{value:void 0}),fa("invalid",e);break;case"textarea":bT(e,n),i=Lk(e,n),fa("invalid",e);break;default:i=n}Fk(r,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var c=l[s];s==="style"?CB(e,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&AB(e,c)):s==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&qx(e,c):typeof c=="number"&&qx(e,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Wx.hasOwnProperty(s)?c!=null&&s==="onScroll"&&fa("scroll",e):c!=null&&b3(e,s,c,o))}switch(r){case"input":ib(e),yT(e,n,!1);break;case"textarea":ib(e),vT(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ch(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?im(e,!!n.multiple,s,!1):n.defaultValue!=null&&im(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=l2)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ko(t),null;case 6:if(e&&t.stateNode!=null)QI(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Xr(166));if(r=Kh(t1.current),Kh(Zu.current),hb(t)){if(n=t.stateNode,r=t.memoizedProps,n[Vu]=t,(s=n.nodeValue!==r)&&(e=nc,e!==null))switch(e.tag){case 3:fb(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&fb(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Vu]=t,t.stateNode=n}return ko(t),null;case 13:if(ga(Ea),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Sa&&ec!==null&&t.mode&1&&!(t.flags&128))mI(),Am(),t.flags|=98560,s=!1;else if(s=hb(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Xr(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Xr(317));s[Vu]=t}else Am(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ko(t),s=!1}else ou!==null&&(x4(ou),ou=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Ea.current&1?Os===0&&(Os=3):tN())),t.updateQueue!==null&&(t.flags|=4),ko(t),null);case 4:return Cm(),c4(e,t),e===null&&Qx(t.stateNode.containerInfo),ko(t),null;case 10:return I3(t.type._context),ko(t),null;case 17:return Nl(t.type)&&c2(),ko(t),null;case 19:if(ga(Ea),s=t.memoizedState,s===null)return ko(t),null;if(n=(t.flags&128)!==0,o=s.rendering,o===null)if(n)$g(s,!1);else{if(Os!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=g2(e),o!==null){for(t.flags|=128,$g(s,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return oa(Ea,Ea.current&1|2),t.child}e=e.sibling}s.tail!==null&&ts()>Tm&&(t.flags|=128,n=!0,$g(s,!1),t.lanes=4194304)}else{if(!n)if(e=g2(o),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),$g(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Sa)return ko(t),null}else 2*ts()-s.renderingStartTime>Tm&&r!==1073741824&&(t.flags|=128,n=!0,$g(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(r=s.last,r!==null?r.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=ts(),t.sibling=null,r=Ea.current,oa(Ea,n?r&1|2:r&1),t):(ko(t),null);case 22:case 23:return eN(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Kl&1073741824&&(ko(t),t.subtreeFlags&6&&(t.flags|=8192)):ko(t),null;case 24:return null;case 25:return null}throw Error(Xr(156,t.tag))}function AQ(e,t){switch(L3(t),t.tag){case 1:return Nl(t.type)&&c2(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Cm(),ga(Al),ga(qo),W3(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return z3(t),null;case 13:if(ga(Ea),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Xr(340));Am()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ga(Ea),null;case 4:return Cm(),null;case 10:return I3(t.type._context),null;case 22:case 23:return eN(),null;case 24:return null;default:return null}}var gb=!1,Ro=!1,NQ=typeof WeakSet=="function"?WeakSet:Set,kn=null;function Yp(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Wa(e,t,n)}else r.current=null}function u4(e,t,r){try{r()}catch(n){Wa(e,t,n)}}var c8=!1;function CQ(e,t){if(Gk=a2,e=rI(),O3(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,d=0,f=e,p=null;t:for(;;){for(var h;f!==r||i!==0&&f.nodeType!==3||(l=o+i),f!==s||n!==0&&f.nodeType!==3||(c=o+n),f.nodeType===3&&(o+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++u===i&&(l=o),p===s&&++d===n&&(c=o),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Kk={focusedElem:e,selectionRange:r},a2=!1,kn=t;kn!==null;)if(t=kn,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,kn=e;else for(;kn!==null;){t=kn;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,b=t.stateNode,v=b.getSnapshotBeforeUpdate(t.elementType===t.type?g:iu(t.type,g),y);b.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Xr(163))}}catch(S){Wa(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,kn=e;break}kn=t.return}return m=c8,c8=!1,m}function kx(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&u4(t,r,s)}i=i.next}while(i!==n)}}function iS(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function d4(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function JI(e){var t=e.alternate;t!==null&&(e.alternate=null,JI(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Vu],delete t[Zx],delete t[Qk],delete t[uQ],delete t[dQ])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ZI(e){return e.tag===5||e.tag===3||e.tag===4}function u8(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ZI(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function f4(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=l2));else if(n!==4&&(e=e.child,e!==null))for(f4(e,t,r),e=e.sibling;e!==null;)f4(e,t,r),e=e.sibling}function h4(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(h4(e,t,r),e=e.sibling;e!==null;)h4(e,t,r),e=e.sibling}var ho=null,au=!1;function kf(e,t,r){for(r=r.child;r!==null;)eD(e,t,r),r=r.sibling}function eD(e,t,r){if(Ju&&typeof Ju.onCommitFiberUnmount=="function")try{Ju.onCommitFiberUnmount(Xw,r)}catch{}switch(r.tag){case 5:Ro||Yp(r,t);case 6:var n=ho,i=au;ho=null,kf(e,t,r),ho=n,au=i,ho!==null&&(au?(e=ho,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ho.removeChild(r.stateNode));break;case 18:ho!==null&&(au?(e=ho,r=r.stateNode,e.nodeType===8?T5(e.parentNode,r):e.nodeType===1&&T5(e,r),Kx(e)):T5(ho,r.stateNode));break;case 4:n=ho,i=au,ho=r.stateNode.containerInfo,au=!0,kf(e,t,r),ho=n,au=i;break;case 0:case 11:case 14:case 15:if(!Ro&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&u4(r,t,o),i=i.next}while(i!==n)}kf(e,t,r);break;case 1:if(!Ro&&(Yp(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){Wa(r,t,l)}kf(e,t,r);break;case 21:kf(e,t,r);break;case 22:r.mode&1?(Ro=(n=Ro)||r.memoizedState!==null,kf(e,t,r),Ro=n):kf(e,t,r);break;default:kf(e,t,r)}}function d8(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new NQ),t.forEach(function(n){var i=BQ.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function eu(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var s=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ho=l.stateNode,au=!1;break e;case 3:ho=l.stateNode.containerInfo,au=!0;break e;case 4:ho=l.stateNode.containerInfo,au=!0;break e}l=l.return}if(ho===null)throw Error(Xr(160));eD(s,o,i),ho=null,au=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(u){Wa(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)tD(t,e),t=t.sibling}function tD(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(eu(t,e),Cu(e),n&4){try{kx(3,e,e.return),iS(3,e)}catch(g){Wa(e,e.return,g)}try{kx(5,e,e.return)}catch(g){Wa(e,e.return,g)}}break;case 1:eu(t,e),Cu(e),n&512&&r!==null&&Yp(r,r.return);break;case 5:if(eu(t,e),Cu(e),n&512&&r!==null&&Yp(r,r.return),e.flags&32){var i=e.stateNode;try{qx(i,"")}catch(g){Wa(e,e.return,g)}}if(n&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=r!==null?r.memoizedProps:s,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&_B(i,s),Bk(l,o);var u=Bk(l,s);for(o=0;o<c.length;o+=2){var d=c[o],f=c[o+1];d==="style"?CB(i,f):d==="dangerouslySetInnerHTML"?AB(i,f):d==="children"?qx(i,f):b3(i,d,f,u)}switch(l){case"input":Ok(i,s);break;case"textarea":jB(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var h=s.value;h!=null?im(i,!!s.multiple,h,!1):p!==!!s.multiple&&(s.defaultValue!=null?im(i,!!s.multiple,s.defaultValue,!0):im(i,!!s.multiple,s.multiple?[]:"",!1))}i[Zx]=s}catch(g){Wa(e,e.return,g)}}break;case 6:if(eu(t,e),Cu(e),n&4){if(e.stateNode===null)throw Error(Xr(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){Wa(e,e.return,g)}}break;case 3:if(eu(t,e),Cu(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Kx(t.containerInfo)}catch(g){Wa(e,e.return,g)}break;case 4:eu(t,e),Cu(e);break;case 13:eu(t,e),Cu(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(J3=ts())),n&4&&d8(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ro=(u=Ro)||d,eu(t,e),Ro=u):eu(t,e),Cu(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(kn=e,d=e.child;d!==null;){for(f=kn=d;kn!==null;){switch(p=kn,h=p.child,p.tag){case 0:case 11:case 14:case 15:kx(4,p,p.return);break;case 1:Yp(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Wa(n,r,g)}}break;case 5:Yp(p,p.return);break;case 22:if(p.memoizedState!==null){h8(f);continue}}h!==null?(h.return=p,kn=h):h8(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{i=f.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=NB("display",o))}catch(g){Wa(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){Wa(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:eu(t,e),Cu(e),n&4&&d8(e);break;case 21:break;default:eu(t,e),Cu(e)}}function Cu(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(ZI(r)){var n=r;break e}r=r.return}throw Error(Xr(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(qx(i,""),n.flags&=-33);var s=u8(e);h4(e,s,i);break;case 3:case 4:var o=n.stateNode.containerInfo,l=u8(e);f4(e,l,o);break;default:throw Error(Xr(161))}}catch(c){Wa(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function EQ(e,t,r){kn=e,rD(e)}function rD(e,t,r){for(var n=(e.mode&1)!==0;kn!==null;){var i=kn,s=i.child;if(i.tag===22&&n){var o=i.memoizedState!==null||gb;if(!o){var l=i.alternate,c=l!==null&&l.memoizedState!==null||Ro;l=gb;var u=Ro;if(gb=o,(Ro=c)&&!u)for(kn=i;kn!==null;)o=kn,c=o.child,o.tag===22&&o.memoizedState!==null?p8(i):c!==null?(c.return=o,kn=c):p8(i);for(;s!==null;)kn=s,rD(s),s=s.sibling;kn=i,gb=l,Ro=u}f8(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,kn=s):f8(e)}}function f8(e){for(;kn!==null;){var t=kn;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ro||iS(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ro)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:iu(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&XT(t,s,n);break;case 3:var o=t.updateQueue;if(o!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}XT(t,o,r)}break;case 5:var l=t.stateNode;if(r===null&&t.flags&4){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&Kx(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Xr(163))}Ro||t.flags&512&&d4(t)}catch(p){Wa(t,t.return,p)}}if(t===e){kn=null;break}if(r=t.sibling,r!==null){r.return=t.return,kn=r;break}kn=t.return}}function h8(e){for(;kn!==null;){var t=kn;if(t===e){kn=null;break}var r=t.sibling;if(r!==null){r.return=t.return,kn=r;break}kn=t.return}}function p8(e){for(;kn!==null;){var t=kn;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{iS(4,t)}catch(c){Wa(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(c){Wa(t,i,c)}}var s=t.return;try{d4(t)}catch(c){Wa(t,s,c)}break;case 5:var o=t.return;try{d4(t)}catch(c){Wa(t,o,c)}}}catch(c){Wa(t,t.return,c)}if(t===e){kn=null;break}var l=t.sibling;if(l!==null){l.return=t.return,kn=l;break}kn=t.return}}var TQ=Math.ceil,b2=of.ReactCurrentDispatcher,X3=of.ReactCurrentOwner,Dc=of.ReactCurrentBatchConfig,ji=0,Qs=null,ms=null,xo=0,Kl=0,Xp=wh(0),Os=0,a1=null,x0=0,aS=0,Q3=0,Ax=null,vl=null,J3=0,Tm=1/0,kd=null,v2=!1,p4=null,rh=null,xb=!1,Hf=null,w2=0,Nx=0,m4=null,Ov=-1,Mv=0;function il(){return ji&6?ts():Ov!==-1?Ov:Ov=ts()}function nh(e){return e.mode&1?ji&2&&xo!==0?xo&-xo:hQ.transition!==null?(Mv===0&&(Mv=$B()),Mv):(e=Gi,e!==0||(e=window.event,e=e===void 0?16:GB(e.type)),e):1}function pu(e,t,r,n){if(50<Nx)throw Nx=0,m4=null,Error(Xr(185));H1(e,r,n),(!(ji&2)||e!==Qs)&&(e===Qs&&(!(ji&2)&&(aS|=r),Os===4&&$f(e,xo)),Cl(e,n),r===1&&ji===0&&!(t.mode&1)&&(Tm=ts()+500,tS&&Sh()))}function Cl(e,t){var r=e.callbackNode;hX(e,t);var n=i2(e,e===Qs?xo:0);if(n===0)r!==null&&_T(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&_T(r),t===1)e.tag===0?fQ(m8.bind(null,e)):fI(m8.bind(null,e)),lQ(function(){!(ji&6)&&Sh()}),r=null;else{switch(UB(n)){case 1:r=j3;break;case 4:r=IB;break;case 16:r=n2;break;case 536870912:r=DB;break;default:r=n2}r=uD(r,nD.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function nD(e,t){if(Ov=-1,Mv=0,ji&6)throw Error(Xr(327));var r=e.callbackNode;if(cm()&&e.callbackNode!==r)return null;var n=i2(e,e===Qs?xo:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=S2(e,n);else{t=n;var i=ji;ji|=2;var s=aD();(Qs!==e||xo!==t)&&(kd=null,Tm=ts()+500,r0(e,t));do try{MQ();break}catch(l){iD(e,l)}while(!0);B3(),b2.current=s,ji=i,ms!==null?t=0:(Qs=null,xo=0,t=Os)}if(t!==0){if(t===2&&(i=zk(e),i!==0&&(n=i,t=g4(e,i))),t===1)throw r=a1,r0(e,0),$f(e,n),Cl(e,ts()),r;if(t===6)$f(e,n);else{if(i=e.current.alternate,!(n&30)&&!PQ(i)&&(t=S2(e,n),t===2&&(s=zk(e),s!==0&&(n=s,t=g4(e,s))),t===1))throw r=a1,r0(e,0),$f(e,n),Cl(e,ts()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(Xr(345));case 2:Dh(e,vl,kd);break;case 3:if($f(e,n),(n&130023424)===n&&(t=J3+500-ts(),10<t)){if(i2(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){il(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Xk(Dh.bind(null,e,vl,kd),t);break}Dh(e,vl,kd);break;case 4:if($f(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var o=31-hu(n);s=1<<o,o=t[o],o>i&&(i=o),n&=~s}if(n=i,n=ts()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*TQ(n/1960))-n,10<n){e.timeoutHandle=Xk(Dh.bind(null,e,vl,kd),n);break}Dh(e,vl,kd);break;case 5:Dh(e,vl,kd);break;default:throw Error(Xr(329))}}}return Cl(e,ts()),e.callbackNode===r?nD.bind(null,e):null}function g4(e,t){var r=Ax;return e.current.memoizedState.isDehydrated&&(r0(e,t).flags|=256),e=S2(e,t),e!==2&&(t=vl,vl=r,t!==null&&x4(t)),e}function x4(e){vl===null?vl=e:vl.push.apply(vl,e)}function PQ(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],s=i.getSnapshot;i=i.value;try{if(!yu(s(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $f(e,t){for(t&=~Q3,t&=~aS,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-hu(t),n=1<<r;e[r]=-1,t&=~n}}function m8(e){if(ji&6)throw Error(Xr(327));cm();var t=i2(e,0);if(!(t&1))return Cl(e,ts()),null;var r=S2(e,t);if(e.tag!==0&&r===2){var n=zk(e);n!==0&&(t=n,r=g4(e,n))}if(r===1)throw r=a1,r0(e,0),$f(e,t),Cl(e,ts()),r;if(r===6)throw Error(Xr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Dh(e,vl,kd),Cl(e,ts()),null}function Z3(e,t){var r=ji;ji|=1;try{return e(t)}finally{ji=r,ji===0&&(Tm=ts()+500,tS&&Sh())}}function y0(e){Hf!==null&&Hf.tag===0&&!(ji&6)&&cm();var t=ji;ji|=1;var r=Dc.transition,n=Gi;try{if(Dc.transition=null,Gi=1,e)return e()}finally{Gi=n,Dc.transition=r,ji=t,!(ji&6)&&Sh()}}function eN(){Kl=Xp.current,ga(Xp)}function r0(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,oQ(r)),ms!==null)for(r=ms.return;r!==null;){var n=r;switch(L3(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&c2();break;case 3:Cm(),ga(Al),ga(qo),W3();break;case 5:z3(n);break;case 4:Cm();break;case 13:ga(Ea);break;case 19:ga(Ea);break;case 10:I3(n.type._context);break;case 22:case 23:eN()}r=r.return}if(Qs=e,ms=e=ih(e.current,null),xo=Kl=t,Os=0,a1=null,Q3=aS=x0=0,vl=Ax=null,Gh!==null){for(t=0;t<Gh.length;t++)if(r=Gh[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,s=r.pending;if(s!==null){var o=s.next;s.next=i,n.next=o}r.pending=n}Gh=null}return e}function iD(e,t){do{var r=ms;try{if(B3(),Ev.current=y2,x2){for(var n=Ma.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}x2=!1}if(g0=0,Hs=Es=Ma=null,jx=!1,r1=0,X3.current=null,r===null||r.return===null){Os=1,a1=t,ms=null;break}e:{var s=e,o=r.return,l=r,c=t;if(t=xo,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=r8(o);if(h!==null){h.flags&=-257,n8(h,o,l,s,t),h.mode&1&&t8(s,u,t),t=h,c=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}else{if(!(t&1)){t8(s,u,t),tN();break e}c=Error(Xr(426))}}else if(Sa&&l.mode&1){var y=r8(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),n8(y,o,l,s,t),R3(Em(c,l));break e}}s=c=Em(c,l),Os!==4&&(Os=2),Ax===null?Ax=[s]:Ax.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var b=UI(s,c,t);YT(s,b);break e;case 1:l=c;var v=s.type,w=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(rh===null||!rh.has(w)))){s.flags|=65536,t&=-t,s.lanes|=t;var S=zI(s,l,t);YT(s,S);break e}}s=s.return}while(s!==null)}oD(r)}catch(j){t=j,ms===r&&r!==null&&(ms=r=r.return);continue}break}while(!0)}function aD(){var e=b2.current;return b2.current=y2,e===null?y2:e}function tN(){(Os===0||Os===3||Os===2)&&(Os=4),Qs===null||!(x0&268435455)&&!(aS&268435455)||$f(Qs,xo)}function S2(e,t){var r=ji;ji|=2;var n=aD();(Qs!==e||xo!==t)&&(kd=null,r0(e,t));do try{OQ();break}catch(i){iD(e,i)}while(!0);if(B3(),ji=r,b2.current=n,ms!==null)throw Error(Xr(261));return Qs=null,xo=0,Os}function OQ(){for(;ms!==null;)sD(ms)}function MQ(){for(;ms!==null&&!iX();)sD(ms)}function sD(e){var t=cD(e.alternate,e,Kl);e.memoizedProps=e.pendingProps,t===null?oD(e):ms=t,X3.current=null}function oD(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=AQ(r,t),r!==null){r.flags&=32767,ms=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Os=6,ms=null;return}}else if(r=kQ(r,t,Kl),r!==null){ms=r;return}if(t=t.sibling,t!==null){ms=t;return}ms=t=e}while(t!==null);Os===0&&(Os=5)}function Dh(e,t,r){var n=Gi,i=Dc.transition;try{Dc.transition=null,Gi=1,LQ(e,t,r,n)}finally{Dc.transition=i,Gi=n}return null}function LQ(e,t,r,n){do cm();while(Hf!==null);if(ji&6)throw Error(Xr(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Xr(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(pX(e,s),e===Qs&&(ms=Qs=null,xo=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||xb||(xb=!0,uD(n2,function(){return cm(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Dc.transition,Dc.transition=null;var o=Gi;Gi=1;var l=ji;ji|=4,X3.current=null,CQ(e,r),tD(r,e),eQ(Kk),a2=!!Gk,Kk=Gk=null,e.current=r,EQ(r),aX(),ji=l,Gi=o,Dc.transition=s}else e.current=r;if(xb&&(xb=!1,Hf=e,w2=i),s=e.pendingLanes,s===0&&(rh=null),lX(r.stateNode),Cl(e,ts()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(v2)throw v2=!1,e=p4,p4=null,e;return w2&1&&e.tag!==0&&cm(),s=e.pendingLanes,s&1?e===m4?Nx++:(Nx=0,m4=e):Nx=0,Sh(),null}function cm(){if(Hf!==null){var e=UB(w2),t=Dc.transition,r=Gi;try{if(Dc.transition=null,Gi=16>e?16:e,Hf===null)var n=!1;else{if(e=Hf,Hf=null,w2=0,ji&6)throw Error(Xr(331));var i=ji;for(ji|=4,kn=e.current;kn!==null;){var s=kn,o=s.child;if(kn.flags&16){var l=s.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(kn=u;kn!==null;){var d=kn;switch(d.tag){case 0:case 11:case 15:kx(8,d,s)}var f=d.child;if(f!==null)f.return=d,kn=f;else for(;kn!==null;){d=kn;var p=d.sibling,h=d.return;if(JI(d),d===u){kn=null;break}if(p!==null){p.return=h,kn=p;break}kn=h}}}var m=s.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}kn=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,kn=o;else e:for(;kn!==null;){if(s=kn,s.flags&2048)switch(s.tag){case 0:case 11:case 15:kx(9,s,s.return)}var b=s.sibling;if(b!==null){b.return=s.return,kn=b;break e}kn=s.return}}var v=e.current;for(kn=v;kn!==null;){o=kn;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,kn=w;else e:for(o=v;kn!==null;){if(l=kn,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:iS(9,l)}}catch(j){Wa(l,l.return,j)}if(l===o){kn=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,kn=S;break e}kn=l.return}}if(ji=i,Sh(),Ju&&typeof Ju.onPostCommitFiberRoot=="function")try{Ju.onPostCommitFiberRoot(Xw,e)}catch{}n=!0}return n}finally{Gi=r,Dc.transition=t}}return!1}function g8(e,t,r){t=Em(r,t),t=UI(e,t,1),e=th(e,t,1),t=il(),e!==null&&(H1(e,1,t),Cl(e,t))}function Wa(e,t,r){if(e.tag===3)g8(e,e,r);else for(;t!==null;){if(t.tag===3){g8(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(rh===null||!rh.has(n))){e=Em(r,e),e=zI(t,e,1),t=th(t,e,1),e=il(),t!==null&&(H1(t,1,e),Cl(t,e));break}}t=t.return}}function RQ(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=il(),e.pingedLanes|=e.suspendedLanes&r,Qs===e&&(xo&r)===r&&(Os===4||Os===3&&(xo&130023424)===xo&&500>ts()-J3?r0(e,0):Q3|=r),Cl(e,t)}function lD(e,t){t===0&&(e.mode&1?(t=ob,ob<<=1,!(ob&130023424)&&(ob=4194304)):t=1);var r=il();e=Gd(e,t),e!==null&&(H1(e,t,r),Cl(e,r))}function FQ(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),lD(e,r)}function BQ(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Xr(314))}n!==null&&n.delete(t),lD(e,r)}var cD;cD=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Al.current)wl=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return wl=!1,jQ(e,t,r);wl=!!(e.flags&131072)}else wl=!1,Sa&&t.flags&1048576&&hI(t,f2,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Pv(e,t),e=t.pendingProps;var i=km(t,qo.current);lm(t,r),i=H3(null,t,n,e,i,r);var s=V3();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Nl(n)?(s=!0,u2(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,$3(t),i.updater=nS,t.stateNode=i,i._reactInternals=t,n4(t,n,e,r),t=s4(null,t,n,!0,s,r)):(t.tag=0,Sa&&s&&M3(t),Zo(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Pv(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=DQ(n),e=iu(n,e),i){case 0:t=a4(null,t,n,e,r);break e;case 1:t=s8(null,t,n,e,r);break e;case 11:t=i8(null,t,n,e,r);break e;case 14:t=a8(null,t,n,iu(n.type,e),r);break e}throw Error(Xr(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:iu(n,i),a4(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:iu(n,i),s8(e,t,n,i,r);case 3:e:{if(VI(t),e===null)throw Error(Xr(387));n=t.pendingProps,s=t.memoizedState,i=s.element,bI(e,t),m2(t,n,null,r);var o=t.memoizedState;if(n=o.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Em(Error(Xr(423)),t),t=o8(e,t,n,r,i);break e}else if(n!==i){i=Em(Error(Xr(424)),t),t=o8(e,t,n,r,i);break e}else for(ec=eh(t.stateNode.containerInfo.firstChild),nc=t,Sa=!0,ou=null,r=xI(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Am(),n===i){t=Kd(e,t,r);break e}Zo(e,t,n,r)}t=t.child}return t;case 5:return vI(t),e===null&&e4(t),n=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,Yk(n,i)?o=null:s!==null&&Yk(n,s)&&(t.flags|=32),HI(e,t),Zo(e,t,o,r),t.child;case 6:return e===null&&e4(t),null;case 13:return GI(e,t,r);case 4:return U3(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Nm(t,null,n,r):Zo(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:iu(n,i),i8(e,t,n,i,r);case 7:return Zo(e,t,t.pendingProps,r),t.child;case 8:return Zo(e,t,t.pendingProps.children,r),t.child;case 12:return Zo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,oa(h2,n._currentValue),n._currentValue=o,s!==null)if(yu(s.value,o)){if(s.children===i.children&&!Al.current){t=Kd(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(s.tag===1){c=Id(-1,r&-r),c.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}s.lanes|=r,c=s.alternate,c!==null&&(c.lanes|=r),t4(s.return,r,t),l.lanes|=r;break}c=c.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Xr(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),t4(o,r,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Zo(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,lm(t,r),i=Uc(i),n=n(i),t.flags|=1,Zo(e,t,n,r),t.child;case 14:return n=t.type,i=iu(n,t.pendingProps),i=iu(n.type,i),a8(e,t,n,i,r);case 15:return WI(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:iu(n,i),Pv(e,t),t.tag=1,Nl(n)?(e=!0,u2(t)):e=!1,lm(t,r),$I(t,n,i),n4(t,n,i,r),s4(null,t,n,!0,e,r);case 19:return KI(e,t,r);case 22:return qI(e,t,r)}throw Error(Xr(156,t.tag))};function uD(e,t){return BB(e,t)}function IQ(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bc(e,t,r,n){return new IQ(e,t,r,n)}function rN(e){return e=e.prototype,!(!e||!e.isReactComponent)}function DQ(e){if(typeof e=="function")return rN(e)?1:0;if(e!=null){if(e=e.$$typeof,e===w3)return 11;if(e===S3)return 14}return 2}function ih(e,t){var r=e.alternate;return r===null?(r=Bc(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Lv(e,t,r,n,i,s){var o=2;if(n=e,typeof e=="function")rN(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case $p:return n0(r.children,i,s,t);case v3:o=8,i|=8;break;case Nk:return e=Bc(12,r,t,i|2),e.elementType=Nk,e.lanes=s,e;case Ck:return e=Bc(13,r,t,i),e.elementType=Ck,e.lanes=s,e;case Ek:return e=Bc(19,r,t,i),e.elementType=Ek,e.lanes=s,e;case vB:return sS(r,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case yB:o=10;break e;case bB:o=9;break e;case w3:o=11;break e;case S3:o=14;break e;case Rf:o=16,n=null;break e}throw Error(Xr(130,e==null?e:typeof e,""))}return t=Bc(o,r,t,i),t.elementType=e,t.type=n,t.lanes=s,t}function n0(e,t,r,n){return e=Bc(7,e,n,t),e.lanes=r,e}function sS(e,t,r,n){return e=Bc(22,e,n,t),e.elementType=vB,e.lanes=r,e.stateNode={isHidden:!1},e}function I5(e,t,r){return e=Bc(6,e,null,t),e.lanes=r,e}function D5(e,t,r){return t=Bc(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $Q(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=b5(0),this.expirationTimes=b5(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=b5(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function nN(e,t,r,n,i,s,o,l,c){return e=new $Q(e,t,r,l,c),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Bc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},$3(s),e}function UQ(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Dp,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function dD(e){if(!e)return uh;e=e._reactInternals;e:{if($0(e)!==e||e.tag!==1)throw Error(Xr(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Nl(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Xr(171))}if(e.tag===1){var r=e.type;if(Nl(r))return dI(e,r,t)}return t}function fD(e,t,r,n,i,s,o,l,c){return e=nN(r,n,!0,e,i,s,o,l,c),e.context=dD(null),r=e.current,n=il(),i=nh(r),s=Id(n,i),s.callback=t??null,th(r,s,i),e.current.lanes=i,H1(e,i,n),Cl(e,n),e}function oS(e,t,r,n){var i=t.current,s=il(),o=nh(i);return r=dD(r),t.context===null?t.context=r:t.pendingContext=r,t=Id(s,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=th(i,t,o),e!==null&&(pu(e,i,o,s),Cv(e,i,o)),o}function _2(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function x8(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function iN(e,t){x8(e,t),(e=e.alternate)&&x8(e,t)}function zQ(){return null}var hD=typeof reportError=="function"?reportError:function(e){console.error(e)};function aN(e){this._internalRoot=e}lS.prototype.render=aN.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Xr(409));oS(e,t,null,null)};lS.prototype.unmount=aN.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;y0(function(){oS(null,e,null,null)}),t[Vd]=null}};function lS(e){this._internalRoot=e}lS.prototype.unstable_scheduleHydration=function(e){if(e){var t=qB();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Df.length&&t!==0&&t<Df[r].priority;r++);Df.splice(r,0,e),r===0&&VB(e)}};function sN(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function cS(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function y8(){}function WQ(e,t,r,n,i){if(i){if(typeof n=="function"){var s=n;n=function(){var u=_2(o);s.call(u)}}var o=fD(t,n,e,0,null,!1,!1,"",y8);return e._reactRootContainer=o,e[Vd]=o.current,Qx(e.nodeType===8?e.parentNode:e),y0(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var l=n;n=function(){var u=_2(c);l.call(u)}}var c=nN(e,0,!1,null,null,!1,!1,"",y8);return e._reactRootContainer=c,e[Vd]=c.current,Qx(e.nodeType===8?e.parentNode:e),y0(function(){oS(t,c,r,n)}),c}function uS(e,t,r,n,i){var s=r._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var c=_2(o);l.call(c)}}oS(t,o,e,i)}else o=WQ(r,t,e,i,n);return _2(o)}zB=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ux(t.pendingLanes);r!==0&&(k3(t,r|1),Cl(t,ts()),!(ji&6)&&(Tm=ts()+500,Sh()))}break;case 13:y0(function(){var n=Gd(e,1);if(n!==null){var i=il();pu(n,e,1,i)}}),iN(e,1)}};A3=function(e){if(e.tag===13){var t=Gd(e,134217728);if(t!==null){var r=il();pu(t,e,134217728,r)}iN(e,134217728)}};WB=function(e){if(e.tag===13){var t=nh(e),r=Gd(e,t);if(r!==null){var n=il();pu(r,e,t,n)}iN(e,t)}};qB=function(){return Gi};HB=function(e,t){var r=Gi;try{return Gi=e,t()}finally{Gi=r}};Dk=function(e,t,r){switch(t){case"input":if(Ok(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=eS(n);if(!i)throw Error(Xr(90));SB(n),Ok(n,i)}}}break;case"textarea":jB(e,r);break;case"select":t=r.value,t!=null&&im(e,!!r.multiple,t,!1)}};PB=Z3;OB=y0;var qQ={usingClientEntryPoint:!1,Events:[G1,qp,eS,EB,TB,Z3]},Ug={findFiberByHostInstance:Vh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HQ={bundleType:Ug.bundleType,version:Ug.version,rendererPackageName:Ug.rendererPackageName,rendererConfig:Ug.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:of.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=RB(e),e===null?null:e.stateNode},findFiberByHostInstance:Ug.findFiberByHostInstance||zQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yb=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yb.isDisabled&&yb.supportsFiber)try{Xw=yb.inject(HQ),Ju=yb}catch{}}dc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qQ;dc.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!sN(t))throw Error(Xr(200));return UQ(e,t,null,r)};dc.createRoot=function(e,t){if(!sN(e))throw Error(Xr(299));var r=!1,n="",i=hD;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=nN(e,1,!1,null,null,r,!1,n,i),e[Vd]=t.current,Qx(e.nodeType===8?e.parentNode:e),new aN(t)};dc.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Xr(188)):(e=Object.keys(e).join(","),Error(Xr(268,e)));return e=RB(t),e=e===null?null:e.stateNode,e};dc.flushSync=function(e){return y0(e)};dc.hydrate=function(e,t,r){if(!cS(t))throw Error(Xr(200));return uS(null,e,t,!0,r)};dc.hydrateRoot=function(e,t,r){if(!sN(e))throw Error(Xr(405));var n=r!=null&&r.hydratedSources||null,i=!1,s="",o=hD;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),t=fD(t,null,e,1,r??null,i,!1,s,o),e[Vd]=t.current,Qx(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new lS(t)};dc.render=function(e,t,r){if(!cS(t))throw Error(Xr(200));return uS(null,e,t,!1,r)};dc.unmountComponentAtNode=function(e){if(!cS(e))throw Error(Xr(40));return e._reactRootContainer?(y0(function(){uS(null,null,e,!1,function(){e._reactRootContainer=null,e[Vd]=null})}),!0):!1};dc.unstable_batchedUpdates=Z3;dc.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!cS(r))throw Error(Xr(200));if(e==null||e._reactInternals===void 0)throw Error(Xr(38));return uS(e,t,r,!1,n)};dc.version="18.3.1-next-f1338f8080-20240426";function pD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(pD)}catch(e){console.error(e)}}pD(),pB.exports=dc;var Y1=pB.exports,mD,b8=Y1;mD=b8.createRoot,b8.hydrateRoot;/**
 * @remix-run/router v1.23.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function s1(){return s1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s1.apply(this,arguments)}var Vf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Vf||(Vf={}));const v8="popstate";function VQ(e){e===void 0&&(e={});function t(n,i){let{pathname:s,search:o,hash:l}=n.location;return y4("",{pathname:s,search:o,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function r(n,i){return typeof i=="string"?i:j2(i)}return KQ(t,r,null,e)}function ss(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function oN(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function GQ(){return Math.random().toString(36).substr(2,8)}function w8(e,t){return{usr:e.state,key:e.key,idx:t}}function y4(e,t,r,n){return r===void 0&&(r=null),s1({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?eg(t):t,{state:r,key:t&&t.key||n||GQ()})}function j2(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function eg(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function KQ(e,t,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:s=!1}=n,o=i.history,l=Vf.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(s1({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){l=Vf.Pop;let y=d(),b=y==null?null:y-u;u=y,c&&c({action:l,location:g.location,delta:b})}function p(y,b){l=Vf.Push;let v=y4(g.location,y,b);u=d()+1;let w=w8(v,u),S=g.createHref(v);try{o.pushState(w,"",S)}catch(j){if(j instanceof DOMException&&j.name==="DataCloneError")throw j;i.location.assign(S)}s&&c&&c({action:l,location:g.location,delta:1})}function h(y,b){l=Vf.Replace;let v=y4(g.location,y,b);u=d();let w=w8(v,u),S=g.createHref(v);o.replaceState(w,"",S),s&&c&&c({action:l,location:g.location,delta:0})}function m(y){let b=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof y=="string"?y:j2(y);return v=v.replace(/ $/,"%20"),ss(b,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,b)}let g={get action(){return l},get location(){return e(i,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return i.addEventListener(v8,f),c=y,()=>{i.removeEventListener(v8,f),c=null}},createHref(y){return t(i,y)},createURL:m,encodeLocation(y){let b=m(y);return{pathname:b.pathname,search:b.search,hash:b.hash}},push:p,replace:h,go(y){return o.go(y)}};return g}var S8;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(S8||(S8={}));function YQ(e,t,r){return r===void 0&&(r="/"),XQ(e,t,r)}function XQ(e,t,r,n){let i=typeof t=="string"?eg(t):t,s=lN(i.pathname||"/",r);if(s==null)return null;let o=gD(e);QQ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=cJ(s);l=sJ(o[c],u)}return l}function gD(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(s,o,l)=>{let c={relativePath:l===void 0?s.path||"":l,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};c.relativePath.startsWith("/")&&(ss(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=ah([n,c.relativePath]),d=r.concat(c);s.children&&s.children.length>0&&(ss(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),gD(s.children,t,d,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:iJ(u,s.index),routesMeta:d})};return e.forEach((s,o)=>{var l;if(s.path===""||!((l=s.path)!=null&&l.includes("?")))i(s,o);else for(let c of xD(s.path))i(s,o,c)}),t}function xD(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,i=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return i?[s,""]:[s];let o=xD(n.join("/")),l=[];return l.push(...o.map(c=>c===""?s:[s,c].join("/"))),i&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function QQ(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:aJ(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const JQ=/^:[\w-]+$/,ZQ=3,eJ=2,tJ=1,rJ=10,nJ=-2,_8=e=>e==="*";function iJ(e,t){let r=e.split("/"),n=r.length;return r.some(_8)&&(n+=nJ),t&&(n+=eJ),r.filter(i=>!_8(i)).reduce((i,s)=>i+(JQ.test(s)?ZQ:s===""?tJ:rJ),n)}function aJ(e,t){return e.length===t.length&&e.slice(0,-1).every((n,i)=>n===t[i])?e[e.length-1]-t[t.length-1]:0}function sJ(e,t,r){let{routesMeta:n}=e,i={},s="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,d=s==="/"?t:t.slice(s.length)||"/",f=oJ({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!f)return null;Object.assign(i,f.params),o.push({params:i,pathname:ah([s,f.pathname]),pathnameBase:pJ(ah([s,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(s=ah([s,f.pathnameBase]))}return o}function oJ(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=lJ(e.path,e.caseSensitive,e.end),i=t.match(r);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),l=i.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:p,isOptional:h}=d;if(p==="*"){let g=l[f]||"";o=s.slice(0,s.length-g.length).replace(/(.)\/+$/,"$1")}const m=l[f];return h&&!m?u[p]=void 0:u[p]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:e}}function lJ(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),oN(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),n]}function cJ(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return oN(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function lN(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const uJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dJ=e=>uJ.test(e);function fJ(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:i=""}=typeof e=="string"?eg(e):e,s;if(r)if(dJ(r))s=r;else{if(r.includes("//")){let o=r;r=r.replace(/\/\/+/g,"/"),oN(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+r))}r.startsWith("/")?s=j8(r.substring(1),"/"):s=j8(r,t)}else s=t;return{pathname:s,search:mJ(n),hash:gJ(i)}}function j8(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function $5(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function hJ(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function cN(e,t){let r=hJ(e);return t?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function uN(e,t,r,n){n===void 0&&(n=!1);let i;typeof e=="string"?i=eg(e):(i=s1({},e),ss(!i.pathname||!i.pathname.includes("?"),$5("?","pathname","search",i)),ss(!i.pathname||!i.pathname.includes("#"),$5("#","pathname","hash",i)),ss(!i.search||!i.search.includes("#"),$5("#","search","hash",i)));let s=e===""||i.pathname==="",o=s?"/":i.pathname,l;if(o==null)l=r;else{let f=t.length-1;if(!n&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;i.pathname=p.join("/")}l=f>=0?t[f]:"/"}let c=fJ(i,l),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ah=e=>e.join("/").replace(/\/\/+/g,"/"),pJ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),mJ=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,gJ=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function xJ(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const yD=["post","put","patch","delete"];new Set(yD);const yJ=["get",...yD];new Set(yJ);/**
 * React Router v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function o1(){return o1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},o1.apply(this,arguments)}const dN=x.createContext(null),bJ=x.createContext(null),_h=x.createContext(null),dS=x.createContext(null),lf=x.createContext({outlet:null,matches:[],isDataRoute:!1}),bD=x.createContext(null);function vJ(e,t){let{relative:r}=t===void 0?{}:t;tg()||ss(!1);let{basename:n,navigator:i}=x.useContext(_h),{hash:s,pathname:o,search:l}=wD(e,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:ah([n,o])),i.createHref({pathname:c,search:l,hash:s})}function tg(){return x.useContext(dS)!=null}function hl(){return tg()||ss(!1),x.useContext(dS).location}function vD(e){x.useContext(_h).static||x.useLayoutEffect(e)}function bo(){let{isDataRoute:e}=x.useContext(lf);return e?MJ():wJ()}function wJ(){tg()||ss(!1);let e=x.useContext(dN),{basename:t,future:r,navigator:n}=x.useContext(_h),{matches:i}=x.useContext(lf),{pathname:s}=hl(),o=JSON.stringify(cN(i,r.v7_relativeSplatPath)),l=x.useRef(!1);return vD(()=>{l.current=!0}),x.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let f=uN(u,JSON.parse(o),s,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:ah([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,o,s,e])}function U0(){let{matches:e}=x.useContext(lf),t=e[e.length-1];return t?t.params:{}}function wD(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=x.useContext(_h),{matches:i}=x.useContext(lf),{pathname:s}=hl(),o=JSON.stringify(cN(i,n.v7_relativeSplatPath));return x.useMemo(()=>uN(e,JSON.parse(o),s,r==="path"),[e,o,s,r])}function SJ(e,t){return _J(e,t)}function _J(e,t,r,n){tg()||ss(!1);let{navigator:i}=x.useContext(_h),{matches:s}=x.useContext(lf),o=s[s.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=hl(),d;if(t){var f;let y=typeof t=="string"?eg(t):t;c==="/"||(f=y.pathname)!=null&&f.startsWith(c)||ss(!1),d=y}else d=u;let p=d.pathname||"/",h=p;if(c!=="/"){let y=c.replace(/^\//,"").split("/");h="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=YQ(e,{pathname:h}),g=CJ(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:ah([c,i.encodeLocation?i.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:ah([c,i.encodeLocation?i.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),s,r,n);return t&&g?x.createElement(dS.Provider,{value:{location:o1({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Vf.Pop}},g):g}function jJ(){let e=OJ(),t=xJ(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),r?x.createElement("pre",{style:i},r):null,null)}const kJ=x.createElement(jJ,null);class AJ extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?x.createElement(lf.Provider,{value:this.props.routeContext},x.createElement(bD.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function NJ(e){let{routeContext:t,match:r,children:n}=e,i=x.useContext(dN);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),x.createElement(lf.Provider,{value:t},n)}function CJ(e,t,r,n){var i;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let o=e,l=(i=r)==null?void 0:i.errors;if(l!=null){let d=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);d>=0||ss(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:p,errors:h}=r,m=f.route.loader&&p[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||m){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,p)=>{let h,m=!1,g=null,y=null;r&&(h=l&&f.route.id?l[f.route.id]:void 0,g=f.route.errorElement||kJ,c&&(u<0&&p===0?(LJ("route-fallback"),m=!0,y=null):u===p&&(m=!0,y=f.route.hydrateFallbackElement||null)));let b=t.concat(o.slice(0,p+1)),v=()=>{let w;return h?w=g:m?w=y:f.route.Component?w=x.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=d,x.createElement(NJ,{match:f,routeContext:{outlet:d,matches:b,isDataRoute:r!=null},children:w})};return r&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?x.createElement(AJ,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:v(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):v()},null)}var SD=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(SD||{}),_D=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(_D||{});function EJ(e){let t=x.useContext(dN);return t||ss(!1),t}function TJ(e){let t=x.useContext(bJ);return t||ss(!1),t}function PJ(e){let t=x.useContext(lf);return t||ss(!1),t}function jD(e){let t=PJ(),r=t.matches[t.matches.length-1];return r.route.id||ss(!1),r.route.id}function OJ(){var e;let t=x.useContext(bD),r=TJ(),n=jD();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function MJ(){let{router:e}=EJ(SD.UseNavigateStable),t=jD(_D.UseNavigateStable),r=x.useRef(!1);return vD(()=>{r.current=!0}),x.useCallback(function(i,s){s===void 0&&(s={}),r.current&&(typeof i=="number"?e.navigate(i):e.navigate(i,o1({fromRouteId:t},s)))},[e,t])}const k8={};function LJ(e,t,r){k8[e]||(k8[e]=!0)}function RJ(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Qp(e){let{to:t,replace:r,state:n,relative:i}=e;tg()||ss(!1);let{future:s,static:o}=x.useContext(_h),{matches:l}=x.useContext(lf),{pathname:c}=hl(),u=bo(),d=uN(t,cN(l,s.v7_relativeSplatPath),c,i==="path"),f=JSON.stringify(d);return x.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:i}),[u,f,i,r,n]),null}function Jn(e){ss(!1)}function FJ(e){let{basename:t="/",children:r=null,location:n,navigationType:i=Vf.Pop,navigator:s,static:o=!1,future:l}=e;tg()&&ss(!1);let c=t.replace(/^\/*/,"/"),u=x.useMemo(()=>({basename:c,navigator:s,static:o,future:o1({v7_relativeSplatPath:!1},l)}),[c,l,s,o]);typeof n=="string"&&(n=eg(n));let{pathname:d="/",search:f="",hash:p="",state:h=null,key:m="default"}=n,g=x.useMemo(()=>{let y=lN(d,c);return y==null?null:{location:{pathname:y,search:f,hash:p,state:h,key:m},navigationType:i}},[c,d,f,p,h,m,i]);return g==null?null:x.createElement(_h.Provider,{value:u},x.createElement(dS.Provider,{children:r,value:g}))}function b4(e){let{children:t,location:r}=e;return SJ(v4(t),r)}new Promise(()=>{});function v4(e,t){t===void 0&&(t=[]);let r=[];return x.Children.forEach(e,(n,i)=>{if(!x.isValidElement(n))return;let s=[...t,i];if(n.type===x.Fragment){r.push.apply(r,v4(n.props.children,s));return}n.type!==Jn&&ss(!1),!n.props.index||!n.props.children||ss(!1);let o={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=v4(n.props.children,s)),r.push(o)}),r}/**
 * React Router DOM v6.30.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function w4(){return w4=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},w4.apply(this,arguments)}function BJ(e,t){if(e==null)return{};var r={},n=Object.keys(e),i,s;for(s=0;s<n.length;s++)i=n[s],!(t.indexOf(i)>=0)&&(r[i]=e[i]);return r}function IJ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function DJ(e,t){return e.button===0&&(!t||t==="_self")&&!IJ(e)}function S4(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(i=>[r,i]):[[r,n]])},[]))}function $J(e,t){let r=S4(e);return t&&t.forEach((n,i)=>{r.has(i)||t.getAll(i).forEach(s=>{r.append(i,s)})}),r}const UJ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],zJ="6";try{window.__reactRouterVersion=zJ}catch{}const WJ="startTransition",A8=fB[WJ];function qJ(e){let{basename:t,children:r,future:n,window:i}=e,s=x.useRef();s.current==null&&(s.current=VQ({window:i,v5Compat:!0}));let o=s.current,[l,c]=x.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=x.useCallback(f=>{u&&A8?A8(()=>c(f)):c(f)},[c,u]);return x.useLayoutEffect(()=>o.listen(d),[o,d]),x.useEffect(()=>RJ(n),[n]),x.createElement(FJ,{basename:t,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const HJ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",VJ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,es=x.forwardRef(function(t,r){let{onClick:n,relative:i,reloadDocument:s,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,p=BJ(t,UJ),{basename:h}=x.useContext(_h),m,g=!1;if(typeof u=="string"&&VJ.test(u)&&(m=u,HJ))try{let w=new URL(window.location.href),S=u.startsWith("//")?new URL(w.protocol+u):new URL(u),j=lN(S.pathname,h);S.origin===w.origin&&j!=null?u=j+S.search+S.hash:g=!0}catch{}let y=vJ(u,{relative:i}),b=GJ(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:i,viewTransition:f});function v(w){n&&n(w),w.defaultPrevented||b(w)}return x.createElement("a",w4({},p,{href:m||y,onClick:g||s?n:v,ref:r,target:c}))});var N8;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(N8||(N8={}));var C8;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(C8||(C8={}));function GJ(e,t){let{target:r,replace:n,state:i,preventScrollReset:s,relative:o,viewTransition:l}=t===void 0?{}:t,c=bo(),u=hl(),d=wD(e,{relative:o});return x.useCallback(f=>{if(DJ(f,r)){f.preventDefault();let p=n!==void 0?n:j2(u)===j2(d);c(e,{replace:p,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[u,c,d,n,i,r,e,s,o,l])}function KJ(e){let t=x.useRef(S4(e)),r=x.useRef(!1),n=hl(),i=x.useMemo(()=>$J(n.search,r.current?null:t.current),[n.search]),s=bo(),o=x.useCallback((l,c)=>{const u=S4(typeof l=="function"?l(i):l);r.current=!0,s("?"+u,c)},[s,i]);return[i,o]}function kD(e,t){return function(){return e.apply(t,arguments)}}const{toString:YJ}=Object.prototype,{getPrototypeOf:fN}=Object,{iterator:fS,toStringTag:AD}=Symbol,hS=(e=>t=>{const r=YJ.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Su=e=>(e=e.toLowerCase(),t=>hS(t)===e),pS=e=>t=>typeof t===e,{isArray:rg}=Array,Pm=pS("undefined");function X1(e){return e!==null&&!Pm(e)&&e.constructor!==null&&!Pm(e.constructor)&&El(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const ND=Su("ArrayBuffer");function XJ(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&ND(e.buffer),t}const QJ=pS("string"),El=pS("function"),CD=pS("number"),Q1=e=>e!==null&&typeof e=="object",JJ=e=>e===!0||e===!1,Rv=e=>{if(hS(e)!=="object")return!1;const t=fN(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(AD in e)&&!(fS in e)},ZJ=e=>{if(!Q1(e)||X1(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},eZ=Su("Date"),tZ=Su("File"),rZ=Su("Blob"),nZ=Su("FileList"),iZ=e=>Q1(e)&&El(e.pipe),aZ=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||El(e.append)&&((t=hS(e))==="formdata"||t==="object"&&El(e.toString)&&e.toString()==="[object FormData]"))},sZ=Su("URLSearchParams"),[oZ,lZ,cZ,uZ]=["ReadableStream","Request","Response","Headers"].map(Su),dZ=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function J1(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,i;if(typeof e!="object"&&(e=[e]),rg(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{if(X1(e))return;const s=r?Object.getOwnPropertyNames(e):Object.keys(e),o=s.length;let l;for(n=0;n<o;n++)l=s[n],t.call(null,e[l],l,e)}}function ED(e,t){if(X1(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,i;for(;n-- >0;)if(i=r[n],t===i.toLowerCase())return i;return null}const Yh=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,TD=e=>!Pm(e)&&e!==Yh;function _4(){const{caseless:e,skipUndefined:t}=TD(this)&&this||{},r={},n=(i,s)=>{const o=e&&ED(r,s)||s;Rv(r[o])&&Rv(i)?r[o]=_4(r[o],i):Rv(i)?r[o]=_4({},i):rg(i)?r[o]=i.slice():(!t||!Pm(i))&&(r[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&J1(arguments[i],n);return r}const fZ=(e,t,r,{allOwnKeys:n}={})=>(J1(t,(i,s)=>{r&&El(i)?e[s]=kD(i,r):e[s]=i},{allOwnKeys:n}),e),hZ=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),pZ=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},mZ=(e,t,r,n)=>{let i,s,o;const l={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],(!n||n(o,e,t))&&!l[o]&&(t[o]=e[o],l[o]=!0);e=r!==!1&&fN(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},gZ=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},xZ=e=>{if(!e)return null;if(rg(e))return e;let t=e.length;if(!CD(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},yZ=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&fN(Uint8Array)),bZ=(e,t)=>{const n=(e&&e[fS]).call(e);let i;for(;(i=n.next())&&!i.done;){const s=i.value;t.call(e,s[0],s[1])}},vZ=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},wZ=Su("HTMLFormElement"),SZ=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,i){return n.toUpperCase()+i}),E8=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),_Z=Su("RegExp"),PD=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};J1(r,(i,s)=>{let o;(o=t(i,s,e))!==!1&&(n[s]=o||i)}),Object.defineProperties(e,n)},jZ=e=>{PD(e,(t,r)=>{if(El(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(El(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},kZ=(e,t)=>{const r={},n=i=>{i.forEach(s=>{r[s]=!0})};return rg(e)?n(e):n(String(e).split(t)),r},AZ=()=>{},NZ=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function CZ(e){return!!(e&&El(e.append)&&e[AD]==="FormData"&&e[fS])}const EZ=e=>{const t=new Array(10),r=(n,i)=>{if(Q1(n)){if(t.indexOf(n)>=0)return;if(X1(n))return n;if(!("toJSON"in n)){t[i]=n;const s=rg(n)?[]:{};return J1(n,(o,l)=>{const c=r(o,i+1);!Pm(c)&&(s[l]=c)}),t[i]=void 0,s}}return n};return r(e,0)},TZ=Su("AsyncFunction"),PZ=e=>e&&(Q1(e)||El(e))&&El(e.then)&&El(e.catch),OD=((e,t)=>e?setImmediate:t?((r,n)=>(Yh.addEventListener("message",({source:i,data:s})=>{i===Yh&&s===r&&n.length&&n.shift()()},!1),i=>{n.push(i),Yh.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",El(Yh.postMessage)),OZ=typeof queueMicrotask<"u"?queueMicrotask.bind(Yh):typeof process<"u"&&process.nextTick||OD,MZ=e=>e!=null&&El(e[fS]),dr={isArray:rg,isArrayBuffer:ND,isBuffer:X1,isFormData:aZ,isArrayBufferView:XJ,isString:QJ,isNumber:CD,isBoolean:JJ,isObject:Q1,isPlainObject:Rv,isEmptyObject:ZJ,isReadableStream:oZ,isRequest:lZ,isResponse:cZ,isHeaders:uZ,isUndefined:Pm,isDate:eZ,isFile:tZ,isBlob:rZ,isRegExp:_Z,isFunction:El,isStream:iZ,isURLSearchParams:sZ,isTypedArray:yZ,isFileList:nZ,forEach:J1,merge:_4,extend:fZ,trim:dZ,stripBOM:hZ,inherits:pZ,toFlatObject:mZ,kindOf:hS,kindOfTest:Su,endsWith:gZ,toArray:xZ,forEachEntry:bZ,matchAll:vZ,isHTMLForm:wZ,hasOwnProperty:E8,hasOwnProp:E8,reduceDescriptors:PD,freezeMethods:jZ,toObjectSet:kZ,toCamelCase:SZ,noop:AZ,toFiniteNumber:NZ,findKey:ED,global:Yh,isContextDefined:TD,isSpecCompliantForm:CZ,toJSONObject:EZ,isAsyncFn:TZ,isThenable:PZ,setImmediate:OD,asap:OZ,isIterable:MZ};function ai(e,t,r,n,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),i&&(this.response=i,this.status=i.status?i.status:null)}dr.inherits(ai,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:dr.toJSONObject(this.config),code:this.code,status:this.status}}});const MD=ai.prototype,LD={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{LD[e]={value:e}});Object.defineProperties(ai,LD);Object.defineProperty(MD,"isAxiosError",{value:!0});ai.from=(e,t,r,n,i,s)=>{const o=Object.create(MD);dr.toFlatObject(e,o,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const l=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return ai.call(o,l,c,r,n,i),e&&o.cause==null&&Object.defineProperty(o,"cause",{value:e,configurable:!0}),o.name=e&&e.name||"Error",s&&Object.assign(o,s),o};const LZ=null;function j4(e){return dr.isPlainObject(e)||dr.isArray(e)}function RD(e){return dr.endsWith(e,"[]")?e.slice(0,-2):e}function T8(e,t,r){return e?e.concat(t).map(function(i,s){return i=RD(i),!r&&s?"["+i+"]":i}).join(r?".":""):t}function RZ(e){return dr.isArray(e)&&!e.some(j4)}const FZ=dr.toFlatObject(dr,{},null,function(t){return/^is[A-Z]/.test(t)});function mS(e,t,r){if(!dr.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=dr.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!dr.isUndefined(y[g])});const n=r.metaTokens,i=r.visitor||d,s=r.dots,o=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&dr.isSpecCompliantForm(t);if(!dr.isFunction(i))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(dr.isDate(m))return m.toISOString();if(dr.isBoolean(m))return m.toString();if(!c&&dr.isBlob(m))throw new ai("Blob is not supported. Use a Buffer instead.");return dr.isArrayBuffer(m)||dr.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,g,y){let b=m;if(m&&!y&&typeof m=="object"){if(dr.endsWith(g,"{}"))g=n?g:g.slice(0,-2),m=JSON.stringify(m);else if(dr.isArray(m)&&RZ(m)||(dr.isFileList(m)||dr.endsWith(g,"[]"))&&(b=dr.toArray(m)))return g=RD(g),b.forEach(function(w,S){!(dr.isUndefined(w)||w===null)&&t.append(o===!0?T8([g],S,s):o===null?g:g+"[]",u(w))}),!1}return j4(m)?!0:(t.append(T8(y,g,s),u(m)),!1)}const f=[],p=Object.assign(FZ,{defaultVisitor:d,convertValue:u,isVisitable:j4});function h(m,g){if(!dr.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(m),dr.forEach(m,function(b,v){(!(dr.isUndefined(b)||b===null)&&i.call(t,b,dr.isString(v)?v.trim():v,g,p))===!0&&h(b,g?g.concat(v):[v])}),f.pop()}}if(!dr.isObject(e))throw new TypeError("data must be an object");return h(e),t}function P8(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function hN(e,t){this._pairs=[],e&&mS(e,this,t)}const FD=hN.prototype;FD.append=function(t,r){this._pairs.push([t,r])};FD.toString=function(t){const r=t?function(n){return t.call(this,n,P8)}:P8;return this._pairs.map(function(i){return r(i[0])+"="+r(i[1])},"").join("&")};function BZ(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function BD(e,t,r){if(!t)return e;const n=r&&r.encode||BZ;dr.isFunction(r)&&(r={serialize:r});const i=r&&r.serialize;let s;if(i?s=i(t,r):s=dr.isURLSearchParams(t)?t.toString():new hN(t,r).toString(n),s){const o=e.indexOf("#");o!==-1&&(e=e.slice(0,o)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}class O8{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){dr.forEach(this.handlers,function(n){n!==null&&t(n)})}}const ID={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},IZ=typeof URLSearchParams<"u"?URLSearchParams:hN,DZ=typeof FormData<"u"?FormData:null,$Z=typeof Blob<"u"?Blob:null,UZ={isBrowser:!0,classes:{URLSearchParams:IZ,FormData:DZ,Blob:$Z},protocols:["http","https","file","blob","url","data"]},pN=typeof window<"u"&&typeof document<"u",k4=typeof navigator=="object"&&navigator||void 0,zZ=pN&&(!k4||["ReactNative","NativeScript","NS"].indexOf(k4.product)<0),WZ=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",qZ=pN&&window.location.href||"http://localhost",HZ=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:pN,hasStandardBrowserEnv:zZ,hasStandardBrowserWebWorkerEnv:WZ,navigator:k4,origin:qZ},Symbol.toStringTag,{value:"Module"})),Io={...HZ,...UZ};function VZ(e,t){return mS(e,new Io.classes.URLSearchParams,{visitor:function(r,n,i,s){return Io.isNode&&dr.isBuffer(r)?(this.append(n,r.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...t})}function GZ(e){return dr.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function KZ(e){const t={},r=Object.keys(e);let n;const i=r.length;let s;for(n=0;n<i;n++)s=r[n],t[s]=e[s];return t}function DD(e){function t(r,n,i,s){let o=r[s++];if(o==="__proto__")return!0;const l=Number.isFinite(+o),c=s>=r.length;return o=!o&&dr.isArray(i)?i.length:o,c?(dr.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!l):((!i[o]||!dr.isObject(i[o]))&&(i[o]=[]),t(r,n,i[o],s)&&dr.isArray(i[o])&&(i[o]=KZ(i[o])),!l)}if(dr.isFormData(e)&&dr.isFunction(e.entries)){const r={};return dr.forEachEntry(e,(n,i)=>{t(GZ(n),i,r,0)}),r}return null}function YZ(e,t,r){if(dr.isString(e))try{return(t||JSON.parse)(e),dr.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Z1={transitional:ID,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",i=n.indexOf("application/json")>-1,s=dr.isObject(t);if(s&&dr.isHTMLForm(t)&&(t=new FormData(t)),dr.isFormData(t))return i?JSON.stringify(DD(t)):t;if(dr.isArrayBuffer(t)||dr.isBuffer(t)||dr.isStream(t)||dr.isFile(t)||dr.isBlob(t)||dr.isReadableStream(t))return t;if(dr.isArrayBufferView(t))return t.buffer;if(dr.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let l;if(s){if(n.indexOf("application/x-www-form-urlencoded")>-1)return VZ(t,this.formSerializer).toString();if((l=dr.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return mS(l?{"files[]":t}:t,c&&new c,this.formSerializer)}}return s||i?(r.setContentType("application/json",!1),YZ(t)):t}],transformResponse:[function(t){const r=this.transitional||Z1.transitional,n=r&&r.forcedJSONParsing,i=this.responseType==="json";if(dr.isResponse(t)||dr.isReadableStream(t))return t;if(t&&dr.isString(t)&&(n&&!this.responseType||i)){const o=!(r&&r.silentJSONParsing)&&i;try{return JSON.parse(t,this.parseReviver)}catch(l){if(o)throw l.name==="SyntaxError"?ai.from(l,ai.ERR_BAD_RESPONSE,this,null,this.response):l}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Io.classes.FormData,Blob:Io.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};dr.forEach(["delete","get","head","post","put","patch"],e=>{Z1.headers[e]={}});const XZ=dr.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),QZ=e=>{const t={};let r,n,i;return e&&e.split(`
`).forEach(function(o){i=o.indexOf(":"),r=o.substring(0,i).trim().toLowerCase(),n=o.substring(i+1).trim(),!(!r||t[r]&&XZ[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},M8=Symbol("internals");function zg(e){return e&&String(e).trim().toLowerCase()}function Fv(e){return e===!1||e==null?e:dr.isArray(e)?e.map(Fv):String(e)}function JZ(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const ZZ=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function U5(e,t,r,n,i){if(dr.isFunction(n))return n.call(this,t,r);if(i&&(t=r),!!dr.isString(t)){if(dr.isString(n))return t.indexOf(n)!==-1;if(dr.isRegExp(n))return n.test(t)}}function eee(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function tee(e,t){const r=dr.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(i,s,o){return this[n].call(this,t,i,s,o)},configurable:!0})})}let Tl=class{constructor(t){t&&this.set(t)}set(t,r,n){const i=this;function s(l,c,u){const d=zg(c);if(!d)throw new Error("header name must be a non-empty string");const f=dr.findKey(i,d);(!f||i[f]===void 0||u===!0||u===void 0&&i[f]!==!1)&&(i[f||c]=Fv(l))}const o=(l,c)=>dr.forEach(l,(u,d)=>s(u,d,c));if(dr.isPlainObject(t)||t instanceof this.constructor)o(t,r);else if(dr.isString(t)&&(t=t.trim())&&!ZZ(t))o(QZ(t),r);else if(dr.isObject(t)&&dr.isIterable(t)){let l={},c,u;for(const d of t){if(!dr.isArray(d))throw TypeError("Object iterator must return a key-value pair");l[u=d[0]]=(c=l[u])?dr.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}o(l,r)}else t!=null&&s(r,t,n);return this}get(t,r){if(t=zg(t),t){const n=dr.findKey(this,t);if(n){const i=this[n];if(!r)return i;if(r===!0)return JZ(i);if(dr.isFunction(r))return r.call(this,i,n);if(dr.isRegExp(r))return r.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=zg(t),t){const n=dr.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||U5(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let i=!1;function s(o){if(o=zg(o),o){const l=dr.findKey(n,o);l&&(!r||U5(n,n[l],l,r))&&(delete n[l],i=!0)}}return dr.isArray(t)?t.forEach(s):s(t),i}clear(t){const r=Object.keys(this);let n=r.length,i=!1;for(;n--;){const s=r[n];(!t||U5(this,this[s],s,t,!0))&&(delete this[s],i=!0)}return i}normalize(t){const r=this,n={};return dr.forEach(this,(i,s)=>{const o=dr.findKey(n,s);if(o){r[o]=Fv(i),delete r[s];return}const l=t?eee(s):String(s).trim();l!==s&&delete r[s],r[l]=Fv(i),n[l]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return dr.forEach(this,(n,i)=>{n!=null&&n!==!1&&(r[i]=t&&dr.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(i=>n.set(i)),n}static accessor(t){const n=(this[M8]=this[M8]={accessors:{}}).accessors,i=this.prototype;function s(o){const l=zg(o);n[l]||(tee(i,o),n[l]=!0)}return dr.isArray(t)?t.forEach(s):s(t),this}};Tl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);dr.reduceDescriptors(Tl.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});dr.freezeMethods(Tl);function z5(e,t){const r=this||Z1,n=t||r,i=Tl.from(n.headers);let s=n.data;return dr.forEach(e,function(l){s=l.call(r,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function $D(e){return!!(e&&e.__CANCEL__)}function ng(e,t,r){ai.call(this,e??"canceled",ai.ERR_CANCELED,t,r),this.name="CanceledError"}dr.inherits(ng,ai,{__CANCEL__:!0});function UD(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new ai("Request failed with status code "+r.status,[ai.ERR_BAD_REQUEST,ai.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function ree(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function nee(e,t){e=e||10;const r=new Array(e),n=new Array(e);let i=0,s=0,o;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[s];o||(o=u),r[i]=c,n[i]=u;let f=s,p=0;for(;f!==i;)p+=r[f++],f=f%e;if(i=(i+1)%e,i===s&&(s=(s+1)%e),u-o<t)return;const h=d&&u-d;return h?Math.round(p*1e3/h):void 0}}function iee(e,t){let r=0,n=1e3/t,i,s;const o=(u,d=Date.now())=>{r=d,i=null,s&&(clearTimeout(s),s=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?o(u,d):(i=u,s||(s=setTimeout(()=>{s=null,o(i)},n-f)))},()=>i&&o(i)]}const k2=(e,t,r=3)=>{let n=0;const i=nee(50,250);return iee(s=>{const o=s.loaded,l=s.lengthComputable?s.total:void 0,c=o-n,u=i(c),d=o<=l;n=o;const f={loaded:o,total:l,progress:l?o/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&d?(l-o)/u:void 0,event:s,lengthComputable:l!=null,[t?"download":"upload"]:!0};e(f)},r)},L8=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},R8=e=>(...t)=>dr.asap(()=>e(...t)),aee=Io.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Io.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Io.origin),Io.navigator&&/(msie|trident)/i.test(Io.navigator.userAgent)):()=>!0,see=Io.hasStandardBrowserEnv?{write(e,t,r,n,i,s,o){if(typeof document>"u")return;const l=[`${e}=${encodeURIComponent(t)}`];dr.isNumber(r)&&l.push(`expires=${new Date(r).toUTCString()}`),dr.isString(n)&&l.push(`path=${n}`),dr.isString(i)&&l.push(`domain=${i}`),s===!0&&l.push("secure"),dr.isString(o)&&l.push(`SameSite=${o}`),document.cookie=l.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function oee(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function lee(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function zD(e,t,r){let n=!oee(t);return e&&(n||r==!1)?lee(e,t):t}const F8=e=>e instanceof Tl?{...e}:e;function b0(e,t){t=t||{};const r={};function n(u,d,f,p){return dr.isPlainObject(u)&&dr.isPlainObject(d)?dr.merge.call({caseless:p},u,d):dr.isPlainObject(d)?dr.merge({},d):dr.isArray(d)?d.slice():d}function i(u,d,f,p){if(dr.isUndefined(d)){if(!dr.isUndefined(u))return n(void 0,u,f,p)}else return n(u,d,f,p)}function s(u,d){if(!dr.isUndefined(d))return n(void 0,d)}function o(u,d){if(dr.isUndefined(d)){if(!dr.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function l(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:l,headers:(u,d,f)=>i(F8(u),F8(d),f,!0)};return dr.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||i,p=f(e[d],t[d],d);dr.isUndefined(p)&&f!==l||(r[d]=p)}),r}const WD=e=>{const t=b0({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:l}=t;if(t.headers=o=Tl.from(o),t.url=BD(zD(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&o.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),dr.isFormData(r)){if(Io.hasStandardBrowserEnv||Io.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(dr.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&o.set(d,f)})}}if(Io.hasStandardBrowserEnv&&(n&&dr.isFunction(n)&&(n=n(t)),n||n!==!1&&aee(t.url))){const c=i&&s&&see.read(s);c&&o.set(i,c)}return t},cee=typeof XMLHttpRequest<"u",uee=cee&&function(e){return new Promise(function(r,n){const i=WD(e);let s=i.data;const o=Tl.from(i.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=i,d,f,p,h,m;function g(){h&&h(),m&&m(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function b(){if(!y)return;const w=Tl.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),j={data:!l||l==="text"||l==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:w,config:e,request:y};UD(function(A){r(A),g()},function(A){n(A),g()},j),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(n(new ai("Request aborted",ai.ECONNABORTED,e,y)),y=null)},y.onerror=function(S){const j=S&&S.message?S.message:"Network Error",k=new ai(j,ai.ERR_NETWORK,e,y);k.event=S||null,n(k),y=null},y.ontimeout=function(){let S=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const j=i.transitional||ID;i.timeoutErrorMessage&&(S=i.timeoutErrorMessage),n(new ai(S,j.clarifyTimeoutError?ai.ETIMEDOUT:ai.ECONNABORTED,e,y)),y=null},s===void 0&&o.setContentType(null),"setRequestHeader"in y&&dr.forEach(o.toJSON(),function(S,j){y.setRequestHeader(j,S)}),dr.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),l&&l!=="json"&&(y.responseType=i.responseType),u&&([p,m]=k2(u,!0),y.addEventListener("progress",p)),c&&y.upload&&([f,h]=k2(c),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",h)),(i.cancelToken||i.signal)&&(d=w=>{y&&(n(!w||w.type?new ng(null,e,y):w),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const v=ree(i.url);if(v&&Io.protocols.indexOf(v)===-1){n(new ai("Unsupported protocol "+v+":",ai.ERR_BAD_REQUEST,e));return}y.send(s||null)})},dee=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,i;const s=function(u){if(!i){i=!0,l();const d=u instanceof Error?u:this.reason;n.abort(d instanceof ai?d:new ng(d instanceof Error?d.message:d))}};let o=t&&setTimeout(()=>{o=null,s(new ai(`timeout ${t} of ms exceeded`,ai.ETIMEDOUT))},t);const l=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(s):u.removeEventListener("abort",s)}),e=null)};e.forEach(u=>u.addEventListener("abort",s));const{signal:c}=n;return c.unsubscribe=()=>dr.asap(l),c}},fee=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,i;for(;n<r;)i=n+t,yield e.slice(n,i),n=i},hee=async function*(e,t){for await(const r of pee(e))yield*fee(r,t)},pee=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},B8=(e,t,r,n)=>{const i=hee(e,t);let s=0,o,l=c=>{o||(o=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await i.next();if(u){l(),c.close();return}let f=d.byteLength;if(r){let p=s+=f;r(p)}c.enqueue(new Uint8Array(d))}catch(u){throw l(u),u}},cancel(c){return l(c),i.return()}},{highWaterMark:2})},I8=64*1024,{isFunction:bb}=dr,mee=(({Request:e,Response:t})=>({Request:e,Response:t}))(dr.global),{ReadableStream:D8,TextEncoder:$8}=dr.global,U8=(e,...t)=>{try{return!!e(...t)}catch{return!1}},gee=e=>{e=dr.merge.call({skipUndefined:!0},mee,e);const{fetch:t,Request:r,Response:n}=e,i=t?bb(t):typeof fetch=="function",s=bb(r),o=bb(n);if(!i)return!1;const l=i&&bb(D8),c=i&&(typeof $8=="function"?(m=>g=>m.encode(g))(new $8):async m=>new Uint8Array(await new r(m).arrayBuffer())),u=s&&l&&U8(()=>{let m=!1;const g=new r(Io.origin,{body:new D8,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!g}),d=o&&l&&U8(()=>dr.isReadableStream(new n("").body)),f={stream:d&&(m=>m.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!f[m]&&(f[m]=(g,y)=>{let b=g&&g[m];if(b)return b.call(g);throw new ai(`Response type '${m}' is not supported`,ai.ERR_NOT_SUPPORT,y)})});const p=async m=>{if(m==null)return 0;if(dr.isBlob(m))return m.size;if(dr.isSpecCompliantForm(m))return(await new r(Io.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(dr.isArrayBufferView(m)||dr.isArrayBuffer(m))return m.byteLength;if(dr.isURLSearchParams(m)&&(m=m+""),dr.isString(m))return(await c(m)).byteLength},h=async(m,g)=>{const y=dr.toFiniteNumber(m.getContentLength());return y??p(g)};return async m=>{let{url:g,method:y,data:b,signal:v,cancelToken:w,timeout:S,onDownloadProgress:j,onUploadProgress:k,responseType:A,headers:R,withCredentials:M="same-origin",fetchOptions:B}=WD(m),E=t||fetch;A=A?(A+"").toLowerCase():"text";let P=dee([v,w&&w.toAbortSignal()],S),D=null;const G=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let H;try{if(k&&u&&y!=="get"&&y!=="head"&&(H=await h(R,b))!==0){let ee=new r(g,{method:"POST",body:b,duplex:"half"}),C;if(dr.isFormData(b)&&(C=ee.headers.get("content-type"))&&R.setContentType(C),ee.body){const[Y,q]=L8(H,k2(R8(k)));b=B8(ee.body,I8,Y,q)}}dr.isString(M)||(M=M?"include":"omit");const oe=s&&"credentials"in r.prototype,de={...B,signal:P,method:y.toUpperCase(),headers:R.normalize().toJSON(),body:b,duplex:"half",credentials:oe?M:void 0};D=s&&new r(g,de);let W=await(s?E(D,B):E(g,de));const V=d&&(A==="stream"||A==="response");if(d&&(j||V&&G)){const ee={};["status","statusText","headers"].forEach(O=>{ee[O]=W[O]});const C=dr.toFiniteNumber(W.headers.get("content-length")),[Y,q]=j&&L8(C,k2(R8(j),!0))||[];W=new n(B8(W.body,I8,Y,()=>{q&&q(),G&&G()}),ee)}A=A||"text";let ae=await f[dr.findKey(f,A)||"text"](W,m);return!V&&G&&G(),await new Promise((ee,C)=>{UD(ee,C,{data:ae,headers:Tl.from(W.headers),status:W.status,statusText:W.statusText,config:m,request:D})})}catch(oe){throw G&&G(),oe&&oe.name==="TypeError"&&/Load failed|fetch/i.test(oe.message)?Object.assign(new ai("Network Error",ai.ERR_NETWORK,m,D),{cause:oe.cause||oe}):ai.from(oe,oe&&oe.code,m,D)}}},xee=new Map,qD=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:i}=t,s=[n,i,r];let o=s.length,l=o,c,u,d=xee;for(;l--;)c=s[l],u=d.get(c),u===void 0&&d.set(c,u=l?new Map:gee(t)),d=u;return u};qD();const mN={http:LZ,xhr:uee,fetch:{get:qD}};dr.forEach(mN,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const z8=e=>`- ${e}`,yee=e=>dr.isFunction(e)||e===null||e===!1;function bee(e,t){e=dr.isArray(e)?e:[e];const{length:r}=e;let n,i;const s={};for(let o=0;o<r;o++){n=e[o];let l;if(i=n,!yee(n)&&(i=mN[(l=String(n)).toLowerCase()],i===void 0))throw new ai(`Unknown adapter '${l}'`);if(i&&(dr.isFunction(i)||(i=i.get(t))))break;s[l||"#"+o]=i}if(!i){const o=Object.entries(s).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=r?o.length>1?`since :
`+o.map(z8).join(`
`):" "+z8(o[0]):"as no adapter specified";throw new ai("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return i}const HD={getAdapter:bee,adapters:mN};function W5(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new ng(null,e)}function W8(e){return W5(e),e.headers=Tl.from(e.headers),e.data=z5.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),HD.getAdapter(e.adapter||Z1.adapter,e)(e).then(function(n){return W5(e),n.data=z5.call(e,e.transformResponse,n),n.headers=Tl.from(n.headers),n},function(n){return $D(n)||(W5(e),n&&n.response&&(n.response.data=z5.call(e,e.transformResponse,n.response),n.response.headers=Tl.from(n.response.headers))),Promise.reject(n)})}const VD="1.13.2",gS={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{gS[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const q8={};gS.transitional=function(t,r,n){function i(s,o){return"[Axios v"+VD+"] Transitional option '"+s+"'"+o+(n?". "+n:"")}return(s,o,l)=>{if(t===!1)throw new ai(i(o," has been removed"+(r?" in "+r:"")),ai.ERR_DEPRECATED);return r&&!q8[o]&&(q8[o]=!0,console.warn(i(o," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(s,o,l):!0}};gS.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function vee(e,t,r){if(typeof e!="object")throw new ai("options must be an object",ai.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let i=n.length;for(;i-- >0;){const s=n[i],o=t[s];if(o){const l=e[s],c=l===void 0||o(l,s,e);if(c!==!0)throw new ai("option "+s+" must be "+c,ai.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new ai("Unknown option "+s,ai.ERR_BAD_OPTION)}}const Bv={assertOptions:vee,validators:gS},Eu=Bv.validators;let i0=class{constructor(t){this.defaults=t||{},this.interceptors={request:new O8,response:new O8}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{n.stack?s&&!String(n.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+s):n.stack=s}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=b0(this.defaults,r);const{transitional:n,paramsSerializer:i,headers:s}=r;n!==void 0&&Bv.assertOptions(n,{silentJSONParsing:Eu.transitional(Eu.boolean),forcedJSONParsing:Eu.transitional(Eu.boolean),clarifyTimeoutError:Eu.transitional(Eu.boolean)},!1),i!=null&&(dr.isFunction(i)?r.paramsSerializer={serialize:i}:Bv.assertOptions(i,{encode:Eu.function,serialize:Eu.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Bv.assertOptions(r,{baseUrl:Eu.spelling("baseURL"),withXsrfToken:Eu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=s&&dr.merge(s.common,s[r.method]);s&&dr.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),r.headers=Tl.concat(o,s);const l=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,l.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,f=0,p;if(!c){const m=[W8.bind(this),void 0];for(m.unshift(...l),m.push(...u),p=m.length,d=Promise.resolve(r);f<p;)d=d.then(m[f++],m[f++]);return d}p=l.length;let h=r;for(;f<p;){const m=l[f++],g=l[f++];try{h=m(h)}catch(y){g.call(this,y);break}}try{d=W8.call(this,h)}catch(m){return Promise.reject(m)}for(f=0,p=u.length;f<p;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=b0(this.defaults,t);const r=zD(t.baseURL,t.url,t.allowAbsoluteUrls);return BD(r,t.params,t.paramsSerializer)}};dr.forEach(["delete","get","head","options"],function(t){i0.prototype[t]=function(r,n){return this.request(b0(n||{},{method:t,url:r,data:(n||{}).data}))}});dr.forEach(["post","put","patch"],function(t){function r(n){return function(s,o,l){return this.request(b0(l||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}i0.prototype[t]=r(),i0.prototype[t+"Form"]=r(!0)});let wee=class GD{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(s){r=s});const n=this;this.promise.then(i=>{if(!n._listeners)return;let s=n._listeners.length;for(;s-- >0;)n._listeners[s](i);n._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(l=>{n.subscribe(l),s=l}).then(i);return o.cancel=function(){n.unsubscribe(s)},o},t(function(s,o,l){n.reason||(n.reason=new ng(s,o,l),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new GD(function(i){t=i}),cancel:t}}};function See(e){return function(r){return e.apply(null,r)}}function _ee(e){return dr.isObject(e)&&e.isAxiosError===!0}const A4={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(A4).forEach(([e,t])=>{A4[t]=e});function KD(e){const t=new i0(e),r=kD(i0.prototype.request,t);return dr.extend(r,i0.prototype,t,{allOwnKeys:!0}),dr.extend(r,t,null,{allOwnKeys:!0}),r.create=function(i){return KD(b0(e,i))},r}const Ra=KD(Z1);Ra.Axios=i0;Ra.CanceledError=ng;Ra.CancelToken=wee;Ra.isCancel=$D;Ra.VERSION=VD;Ra.toFormData=mS;Ra.AxiosError=ai;Ra.Cancel=Ra.CanceledError;Ra.all=function(t){return Promise.all(t)};Ra.spread=See;Ra.isAxiosError=_ee;Ra.mergeConfig=b0;Ra.AxiosHeaders=Tl;Ra.formToJSON=e=>DD(dr.isHTMLForm(e)?new FormData(e):e);Ra.getAdapter=HD.getAdapter;Ra.HttpStatusCode=A4;Ra.default=Ra;const{Axios:lMe,AxiosError:cMe,CanceledError:uMe,isCancel:dMe,CancelToken:fMe,VERSION:hMe,all:pMe,Cancel:mMe,isAxiosError:gMe,spread:xMe,toFormData:yMe,AxiosHeaders:N4,HttpStatusCode:bMe,formToJSON:vMe,getAdapter:wMe,mergeConfig:SMe}=Ra;function jee(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const YD=`${jee()}/api/accounts/`,Uo=Ra.create({baseURL:YD});let q5=!1,C4=[];function kee(e){C4.push(e)}function Aee(e){C4.forEach(t=>t(e)),C4=[]}async function Nee(){const e=localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await Ra.post(`${YD}token/refresh/`,{refresh:e}),{access:r,refresh:n}=t.data;return r&&localStorage.setItem("access",r),n&&localStorage.setItem("refresh",n),r}Uo.interceptors.response.use(e=>e,async e=>{const t=e.config;if(e.response&&e.response.status===401&&!t._retry){if(t._retry=!0,q5)return new Promise(r=>{kee(n=>{const i=t.headers??{};i.Authorization=`Bearer ${n}`,t.headers=new N4(i),r(Uo(t))})});q5=!0;try{const r=await Nee();Aee(r);const n=t.headers??{};return n.Authorization=`Bearer ${r}`,t.headers=new N4(n),Uo(t)}catch(r){return gN(),Promise.reject(r)}finally{q5=!1}}return Promise.reject(e)});async function XD(e,t){const r=await Uo.post("token/",{identifier:e,password:t}),{access:n,refresh:i}=r.data;localStorage.setItem("access",n),localStorage.setItem("refresh",i);try{await Dd()}catch{}return r.data}function gN(){localStorage.removeItem("access"),localStorage.removeItem("refresh"),localStorage.removeItem("roles"),localStorage.removeItem("permissions"),localStorage.removeItem("me")}Uo.interceptors.request.use(e=>{const t=localStorage.getItem("access");if(t){const r=e.headers??{};r.Authorization=`Bearer ${t}`,e.headers=new N4(r)}return e});async function Dd(){if(!localStorage.getItem("access"))throw new Error("no access token");const r=(await Uo.get("me/")).data;try{localStorage.setItem("roles",JSON.stringify(r.roles||[])),localStorage.setItem("permissions",JSON.stringify(r.permissions||[])),localStorage.setItem("me",JSON.stringify(r||null))}catch{}return r}function QD(){try{const e=localStorage.getItem("me");return e?JSON.parse(e):null}catch{return null}}function JD(){var t;const e=QD();return!!((t=e==null?void 0:e.profile)!=null&&t.mobile_verified)}async function as(){var e;if(JD())return!0;try{const t=await Dd();return!!((e=t==null?void 0:t.profile)!=null&&e.mobile_verified)}catch{return!1}}async function ZD(e){return(await Uo.post("mobile/request-otp/",{mobile_number:e})).data}async function e9(e,t){return(await Uo.post("mobile/verify-otp/",{mobile_number:e,otp:t})).data}async function t9(e){return(await Uo.post("mobile/remove/",{password:e})).data}const Cee=Object.freeze(Object.defineProperty({__proto__:null,apiClient:Uo,ensureMobileVerified:as,getCachedMe:QD,getMe:Dd,isMobileVerifiedCached:JD,login:XD,logout:gN,removeMobileNumber:t9,requestMobileOtp:ZD,verifyMobileOtp:e9},Symbol.toStringTag,{value:"Module"})),r9="/assets/idcs-logo-Ci6ccowJ.png";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n9=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eee=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tee=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=e=>{const t=Tee(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Pee={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oee=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mee=x.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...l},c)=>x.createElement("svg",{ref:c,...Pee,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:n9("lucide",i),...!s&&!Oee(l)&&{"aria-hidden":"true"},...l},[...o.map(([u,d])=>x.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=(e,t)=>{const r=x.forwardRef(({className:n,...i},s)=>x.createElement(Mee,{ref:s,iconNode:t,className:n9(`lucide-${Eee(H8(e))}`,`lucide-${e}`,n),...i}));return r.displayName=H8(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lee=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Cx=Wn("bell",Lee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ree=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],gs=Wn("book-open",Ree);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fee=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],Bee=Wn("briefcase",Fee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iee=[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]],Dee=Wn("building",Iee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ee=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],E4=Wn("calendar-clock",$ee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uee=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],xs=Wn("calendar",Uee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zee=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Wee=Wn("check",zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qee=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Hee=Wn("chevron-down",qee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ed=Wn("circle-alert",Vee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gee=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],xN=Wn("circle-check-big",Gee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Md=Wn("circle-check",Kee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yee=[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Xee=Wn("circle-user-round",Yee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qee=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],yN=Wn("circle-x",Qee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jee=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],A2=Wn("clipboard-list",Jee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zee=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],sc=Wn("clock",Zee);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ete=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],T4=Wn("download",ete);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tte=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],rte=Wn("eye-off",tte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nte=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],i9=Wn("eye",nte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ite=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],ate=Wn("file-spreadsheet",ite);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ste=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ote=Wn("file-text",ste);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lte=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],cte=Wn("funnel",lte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ute=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],Om=Wn("graduation-cap",ute);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dte=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],P4=Wn("grid-3x3",dte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fte=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-6a2 2 0 0 1 2.582 0l7 6A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"r6nss1"}]],N2=Wn("house",fte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hte=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Gu=Wn("loader-circle",hte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pte=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],mte=Wn("lock-open",pte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gte=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],a0=Wn("lock",gte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xte=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],yte=Wn("log-in",xte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bte=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],vte=Wn("log-out",bte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wte=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],bN=Wn("mail",wte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ste=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],_te=Wn("menu",Ste);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jte=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],V8=Wn("panels-top-left",jte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kte=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Ate=Wn("phone",kte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nte=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Mm=Wn("plus",Nte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cte=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],C2=Wn("refresh-cw",Cte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ete=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],rd=Wn("save",Ete);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tte=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],Pte=Wn("school",Tte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ote=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Mte=Wn("send",Ote);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lte=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Rte=Wn("shield",Lte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fte=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],dh=Wn("square-pen",Fte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bte=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Lm=Wn("trash-2",Bte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ite=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Dte=Wn("trending-up",Ite);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $te=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],E2=Wn("upload",$te);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ute=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Iv=Wn("user-check",Ute);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Wte=Wn("user-plus",zte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Hte=Wn("user-x",qte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vte=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],z0=Wn("user",Vte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gte=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],ys=Wn("users",Gte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kte=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],bu=Wn("x",Kte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yte=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Xte=Wn("zoom-in",Yte);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qte=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Jte=Wn("zoom-out",Qte),a9=x.createContext(void 0);function Zte({children:e}){const[t,r]=x.useState(()=>typeof window<"u"?window.innerWidth<1024:!0),n=()=>r(i=>!i);return a.jsx(a9.Provider,{value:{collapsed:t,toggle:n,setCollapsed:r},children:e})}function vN(){const e=x.useContext(a9);if(!e)throw new Error("useSidebar must be used within SidebarProvider");return e}function s9({user:e}){const t=bo(),n=hl().pathname==="/login",{collapsed:i,toggle:s}=vN(),o=()=>{gN(),t("/login")};return a.jsx("nav",{className:"bg-white shadow-md border-b border-gray-200 fixed top-0 left-0 right-0 z-40 overflow-x-hidden",children:a.jsx("div",{className:"px-4 max-w-full",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-gray-900 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500",onClick:s,"aria-label":"Toggle sidebar",children:i?a.jsx(_te,{className:"h-6 w-6"}):a.jsx(bu,{className:"h-6 w-6"})}),a.jsx(es,{to:"/dashboard",className:"flex items-center gap-3 group",children:a.jsx("img",{src:r9,alt:"IDCS Logo",className:"h-12 w-12 object-contain transition-transform duration-200 group-hover:scale-110",onError:l=>{l.currentTarget.style.display="none"}})})]}),a.jsx("div",{className:"flex items-center gap-3",children:e?a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"hidden sm:block",children:a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:a.jsx("span",{className:"text-white font-semibold text-sm",children:e.username.charAt(0).toUpperCase()})}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.username})]})}),a.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg font-medium transition-colors",children:[a.jsx(vte,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]}):n?a.jsxs(es,{to:"/",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[a.jsx(N2,{className:"h-4 w-4"}),a.jsx("span",{children:"Home"})]}):a.jsxs(es,{to:"/login",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md transform hover:scale-105",children:[a.jsx(yte,{className:"h-4 w-4"}),a.jsx("span",{children:"Login"})]})})]})})})}function o9(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const ere=o9();let H5=!1,Wg=null;async function tre(){return H5&&Wg||(H5=!0,Wg=(async()=>{try{const e=window.localStorage.getItem("refresh");if(!e)throw new Error("no refresh token");const t=await fetch(`${ere}/api/accounts/token/refresh/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})});if(!t.ok)throw window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh"),new Error("refresh failed");const r=await t.json();return r.access&&window.localStorage.setItem("access",r.access),r.refresh&&window.localStorage.setItem("refresh",r.refresh),r.access}finally{H5=!1,Wg=null}})()),Wg}async function mr(e,t={},r=!0){const n=window.localStorage.getItem("access"),i=t.body instanceof FormData,s=Object.assign({},t.headers||{});i||(s["Content-Type"]="application/json"),n?s.Authorization=`Bearer ${n}`:console.warn("No access token found in localStorage");let o=e;try{typeof e=="string"&&e.startsWith("/api")&&(o=`${o9()}${e}`)}catch{}const l=await fetch(o,{...t,headers:s});if(l.status===400){const c=await l.text();console.error("400 Bad Request:",{url:o,token:n,response:c})}if(l.status===401||l.status===403){let c="";try{c=await l.text()}catch{}const u={};try{l.headers.forEach((d,f)=>{u[f]=d})}catch{}console.error("Auth error from fetchWithAuth",{url:String(o),status:l.status,requestHeaders:s,responseHeaders:u,token:n,responseText:c})}if(l.status!==401||!r)return l;try{const c=await tre(),u=Object.assign({},t.headers||{});return i||(u["Content-Type"]="application/json"),u.Authorization=`Bearer ${c}`,fetch(o,{...t,headers:u})}catch(c){try{window.localStorage.removeItem("access"),window.localStorage.removeItem("refresh")}catch{}console.error("Token refresh failed:",c);try{typeof window<"u"&&setTimeout(()=>{try{window.location.href="/login"}catch{}},50)}catch{}return l}}async function rre(e=""){const t=e?`${e}/api/accounts/dashboard/`:"/api/accounts/dashboard/",r=await mr(t,{method:"GET"});if(!r.ok){const n=await r.text();throw new Error(`Dashboard fetch failed: ${r.status} ${n}`)}return r.json()}function nre(e=""){const[t,r]=x.useState(null),[n,i]=x.useState(!0),[s,o]=x.useState(null),l=x.useCallback(async()=>{i(!0),o(null);try{const c=await rre(e);r(c)}catch(c){o(c)}finally{i(!1)}},[e]);return x.useEffect(()=>{l()},[l]),{data:t,loading:n,error:s,refresh:l}}const ire="modulepreload",are=function(e){return"/"+e},G8={},um=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(r.map(c=>{if(c=are(c),c in G8)return;G8[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":ire,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((p,h)=>{f.addEventListener("load",p),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return t().catch(s)})};async function hc(){var t;const e=`${gn()}/api/academics/my-teaching-assignments/`;try{return(await Uo.get(e)).data}catch(r){if(((t=r==null?void 0:r.response)==null?void 0:t.status)===401)return[];throw r}}function gn(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}function ii(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}async function wN(e,t,r){const n=`${gn()}/api/obe/iqac/reset/${encodeURIComponent(String(e))}/${encodeURIComponent(String(t))}`;return(await Uo.post(n,{teaching_assignment_id:r})).data}async function l9(e){var i;const t=`${gn()}/api/obe/iqac/reset-notifications`,r=e?{teaching_assignment_id:e}:{};return((i=(await Uo.get(t,{params:r})).data)==null?void 0:i.notifications)||[]}async function c9(e){const t=`${gn()}/api/obe/iqac/reset-notifications/dismiss`;return(await Uo.post(t,{notification_ids:e})).data}async function sre(){try{const e=gn(),t=localStorage.getItem("refresh");if(!t)return null;const r=await Ra.post(`${e}/api/accounts/token/refresh/`,{refresh:t}),{access:n,refresh:i}=r.data||{};return n&&localStorage.setItem("access",n),i&&localStorage.setItem("refresh",i),n||null}catch{try{(await um(()=>Promise.resolve().then(()=>Cee),void 0)).logout()}catch{}return null}}async function la(e,t){const r={"Content-Type":"application/json",...(t==null?void 0:t.headers)||{},...ii()},n={...t||{},headers:r};let i=await fetch(e,n);if(i.status!==401)return i;const s=await sre();if(!s)return i;const o={...n.headers,Authorization:`Bearer ${s}`},l={...n,headers:o};return i=await fetch(e,l),i}async function xS(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await la(i,{method:"GET"});return s.status===401?{assessment:e,subject_code:String(t),teaching_assignment_id:typeof r=="number"?r:null,academic_year:null,section_name:null,exists:!1,is_published:!1,published_blocked:!1,mark_entry_blocked:!1,mark_manager_locked:!1,mark_entry_unblocked_until:null,mark_manager_unlocked_until:null,entry_open:!1,mark_manager_editable:!0,updated_at:null}:(s.ok||await jn(s,"Mark table lock fetch failed"),s.json())}async function ore(e){const t=await dm(e);return Array.isArray(t==null?void 0:t.enabled_assessments)?t.enabled_assessments.map(r=>String(r).trim().toLowerCase()).filter(Boolean):[]}async function dm(e){const t=`${gn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,r=await la(t,{method:"GET"});if(r.status===401||r.status===404)return{enabled_assessments:[],meta:{locked:!1,can_edit:!1}};r.ok||await jn(r,"Failed to fetch enabled assessments");const n=await r.json();return{enabled_assessments:Array.isArray(n==null?void 0:n.enabled_assessments)?n.enabled_assessments.map(i=>String(i).trim().toLowerCase()).filter(Boolean):[],meta:(n==null?void 0:n.meta)||void 0}}async function lre(e,t){const r=`${gn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await la(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await jn(n,"Failed to save enabled assessments");const i=await n.json();return Array.isArray(i==null?void 0:i.enabled_assessments)?i.enabled_assessments:[]}async function u9(e,t){const r=`${gn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/`,n=await la(r,{method:"POST",body:JSON.stringify({enabled_assessments:t})});if(n.status===401)throw new Error("Authentication required");n.ok||await jn(n,"Failed to save enabled assessments");const i=await n.json();return{enabled_assessments:Array.isArray(i==null?void 0:i.enabled_assessments)?i.enabled_assessments:[],meta:(i==null?void 0:i.meta)||void 0}}async function d9(e){const t=`${gn()}/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/enabled_assessments/request-edit/`,r=await la(t,{method:"POST",body:JSON.stringify({})});if(r.status===401)throw new Error("Authentication required");return r.ok||await jn(r,"Failed to request edit approval"),r.json()}async function yS(e,t){const r=t?`?academic_year_id=${encodeURIComponent(String(t))}`:"",n=`${gn()}/api/academics/special-courses/${encodeURIComponent(String(e))}/enabled_assessments/${r}`,i=await la(n,{method:"GET"});if(i.status===401)throw new Error("Authentication required");i.ok||await jn(i,"Failed to fetch enabled assessments");const s=await i.json();return(Array.isArray(s==null?void 0:s.enabled_assessments)?s.enabled_assessments:[]).map(l=>String(l).trim().toLowerCase()).filter(Boolean)}async function fh(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/mark-table-lock/${encodeURIComponent(e)}/${encodeURIComponent(t)}/confirm-mark-manager${n}`,s=await la(i,{method:"POST",body:JSON.stringify({})});if(s.status===401)throw new Error("Authentication required");return s.ok||await jn(s,"Mark Manager confirm failed"),s.json()}async function SN(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/publish-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.status===401?{assessment:e,subject_code:String(t),publish_allowed:!1,allowed_by_due:!1,allowed_by_approval:!1,global_override_active:!1,global_is_open:null,allowed_by_global:null,due_at:null,now:null,remaining_seconds:null,approval_until:null,academic_year:null,teaching_assignment_id:typeof r=="number"?r:null}:(s.ok||await jn(s,"Publish window fetch failed"),s.json())}async function l1(e,t,r,n){const i=[`scope=${encodeURIComponent(String(r))}`];n&&i.push(`teaching_assignment_id=${encodeURIComponent(String(n))}`);const s=i.length?`?${i.join("&")}`:"",o=`${gn()}/api/obe/edit-window/${encodeURIComponent(e)}/${encodeURIComponent(t)}${s}`,l=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return l.status===401?{assessment:e,subject_code:String(t),scope:r,allowed_by_approval:!1,approval_until:null,now:null,academic_year:null,teaching_assignment_id:typeof n=="number"?n:null}:(l.ok||await jn(l,"Edit window fetch failed"),l.json())}async function fx(e,t){const r=[];e!=null&&e.length&&r.push(`semester_ids=${encodeURIComponent(e.join(","))}`),t!=null&&t.length&&r.push(`assessments=${encodeURIComponent(t.join(","))}`);const n=r.length?`?${r.join("&")}`:"",i=`${gn()}/api/obe/global-publish-controls${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.ok||await jn(s,"Global publish controls fetch failed"),s.json()}async function O4(e){const t=`${gn()}/api/obe/global-publish-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await jn(r,"Bulk set global publish controls failed"),r.json()}async function f9(e){const t=`${gn()}/api/obe/global-publish-controls/bulk-reset`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await jn(r,"Bulk reset global publish controls failed"),r.json()}async function h9(){const e=`${gn()}/api/obe/semesters`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return t.ok||await jn(t,"Semesters fetch failed"),t.json()}async function Dv(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${gn()}/api/obe/assessment-controls${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});if(!n.ok){if(n.status===404)throw new Error(`Assessment controls endpoint not found (404).

URL requested:
${r}

This usually means your frontend is calling an older backend that does not include /api/obe/assessment-controls.
- Deploy/restart the updated backend OR
- Set VITE_API_BASE to the backend instance that has the new endpoints.`);await jn(n,"Assessment controls fetch failed")}return n.json()}async function M4(e){const t=`${gn()}/api/obe/assessment-controls/bulk-set`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});if(!r.ok){if(r.status===404)throw new Error(`Assessment controls bulk-set endpoint not found (404).

URL requested:
${t}

Your backend is missing /api/obe/assessment-controls/bulk-set. Deploy/restart the updated backend or point VITE_API_BASE to the correct server.`);await jn(r,"Bulk set assessment controls failed")}return r.json()}async function L4(e){const t=e!=null&&e.length?`?semester_ids=${encodeURIComponent(e.join(","))}`:"",r=`${gn()}/api/obe/due-schedules${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return n.ok||await jn(n,"Due schedules fetch failed"),n.json()}async function p9(e){const t=`?semester_ids=${encodeURIComponent(e.join(","))}`,r=`${gn()}/api/obe/due-schedule-subjects${t}`,n=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return n.ok||await jn(n,"Due schedule subjects fetch failed"),n.json()}async function cre(e){const t=`${gn()}/api/obe/due-schedule-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await jn(r,"Due schedule save failed"),r.json()}async function m9(e){const t=`${gn()}/api/obe/due-schedule-bulk-upsert`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await jn(r,"Due schedule bulk save failed"),r.json()}async function g9(e){const t=`${gn()}/api/obe/due-schedule-bulk-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await jn(r,"Due schedule bulk delete failed"),r.json()}function x9(e){if(Array.isArray(e))return{marks:e.map(r=>Number(r)).filter(r=>Number.isFinite(r))};if(e&&typeof e=="object"){const r=(Array.isArray(e.marks)?e.marks:[]).map(o=>Number(o)).filter(o=>Number.isFinite(o)),n=Array.isArray(e.cos)?e.cos:void 0,i=n?n.map(o=>{if(typeof o=="string")return o;const l=Number(o);return Number.isFinite(l)?l:""}):void 0,s={marks:r};return i&&(s.cos=i.filter(o=>o!=="")),s}return{marks:[]}}async function sh(e){const t=[];t.push(`class_type=${encodeURIComponent(String(e.class_type||"").trim())}`),e.question_paper_type&&t.push(`question_paper_type=${encodeURIComponent(String(e.question_paper_type||"").trim())}`),t.push(`exam=${encodeURIComponent(String(e.exam||"").trim())}`);const r=t.length?`?${t.join("&")}`:"",n=`${gn()}/api/obe/iqac/qp-pattern${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});i.ok||await jn(i,"QP pattern fetch failed");const s=await i.json(),o=x9(s==null?void 0:s.pattern);return{class_type:String((s==null?void 0:s.class_type)||""),question_paper_type:(s==null?void 0:s.question_paper_type)==null?null:String(s.question_paper_type),exam:(()=>{const l=String((s==null?void 0:s.exam)||"CIA").trim().toUpperCase();return l==="MODEL"?"MODEL":l==="CIA1"?"CIA1":l==="CIA2"?"CIA2":"CIA"})(),pattern:o,updated_at:(s==null?void 0:s.updated_at)??null,updated_by:typeof(s==null?void 0:s.updated_by)=="number"?s.updated_by:null}}async function y9(e){var o,l;const t=`${gn()}/api/obe/iqac/qp-pattern/save`,r={class_type:String(e.class_type||"").trim(),question_paper_type:e.question_paper_type?String(e.question_paper_type||"").trim():null,exam:e.exam,pattern:{marks:Array.isArray((o=e.pattern)==null?void 0:o.marks)?e.pattern.marks:[],cos:Array.isArray((l=e.pattern)==null?void 0:l.cos)?e.pattern.cos:void 0}},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(r)});n.ok||await jn(n,"QP pattern save failed");const i=await n.json(),s=x9(i==null?void 0:i.pattern);return{class_type:String((i==null?void 0:i.class_type)||""),question_paper_type:(i==null?void 0:i.question_paper_type)==null?null:String(i.question_paper_type),exam:(()=>{const c=String((i==null?void 0:i.exam)||"CIA").trim().toUpperCase();return c==="MODEL"?"MODEL":c==="CIA1"?"CIA1":c==="CIA2"?"CIA2":"CIA"})(),pattern:s,updated_at:(i==null?void 0:i.updated_at)??null,updated_by:typeof(i==null?void 0:i.updated_by)=="number"?i.updated_by:null}}async function bS(){const e=`${gn()}/api/obe/iqac/cqi-config`,t=await fetch(e,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});t.ok||await jn(t,"CQI config fetch failed");const r=await t.json();return{options:Array.isArray(r==null?void 0:r.options)?r.options:[],divider:Number.isFinite(Number(r==null?void 0:r.divider))?Number(r==null?void 0:r.divider):2,multiplier:Number.isFinite(Number(r==null?void 0:r.multiplier))?Number(r==null?void 0:r.multiplier):.15,updated_at:(r==null?void 0:r.updated_at)??null,updated_by:typeof(r==null?void 0:r.updated_by)=="number"?r.updated_by:null}}async function b9(e){const t=`${gn()}/api/obe/iqac/cqi-config/save`,r={options:Array.isArray(e.options)?e.options:[],divider:Number.isFinite(Number(e.divider))?Number(e.divider):2,multiplier:Number.isFinite(Number(e.multiplier))?Number(e.multiplier):.15},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(r)});return n.ok||await jn(n,"CQI config save failed"),n.json()}async function ure(e){const t=`${gn()}/api/obe/due-schedule-delete`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify(e)});return r.ok||await jn(r,"Due schedule delete failed"),r.json()}async function jh(e){const t=`${gn()}/api/obe/publish-request`,r=await la(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await jn(r,"Publish request failed"),r.json()}async function sl(e){const t=`${gn()}/api/obe/edit-request`,r=await la(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");return r.ok||await jn(r,"Edit request failed"),r.json()}function ol(e){var o,l,c,u,d;const t=e||{},r=`Edit request ID: ${typeof t.id=="number"?t.id:""}`;if((String(t.routed_to||"IQAC").trim().toUpperCase()==="HOD"?"HOD":"IQAC")==="HOD"){const f=String(((o=t.department)==null?void 0:o.short_name)||((l=t.department)==null?void 0:l.name)||((c=t.department)==null?void 0:c.code)||"").trim(),p=String(((u=t.hod)==null?void 0:u.name)||((d=t.hod)==null?void 0:d.username)||"").trim(),h=f&&p?`Sent to: ${f} HOD, ${p}`:"Sent to: HOD";return`${r}
${h}`}const s=String(t.routing_warning||"").trim();return s?`${r}
Sent to: IQAC
Note: ${s}`:`${r}
Sent to: IQAC`}function ll(e,t="Request failed"){var i,s;const r=String((e==null?void 0:e.message)||"").trim();if(r)return r;const n=String(((s=(i=e==null?void 0:e.response)==null?void 0:i.data)==null?void 0:s.detail)||"").trim();return n||t}async function Rm(e){const t=[];t.push(`assessment=${encodeURIComponent(String(e.assessment))}`),t.push(`subject_code=${encodeURIComponent(String(e.subject_code))}`),t.push(`scope=${encodeURIComponent(String(e.scope))}`),typeof e.teaching_assignment_id=="number"&&t.push(`teaching_assignment_id=${encodeURIComponent(String(e.teaching_assignment_id))}`);const r=t.length?`?${t.join("&")}`:"",n=`${gn()}/api/obe/edit-requests/my-latest${r}`,i=await la(n,{method:"GET"});return i.status===401?{result:null}:(i.ok||await jn(i,"My edit request status fetch failed"),i.json())}async function v9(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${gn()}/api/obe/edit-requests/pending${t}`,n=await la(r,{method:"GET"});return n.status===401?{results:[]}:(n.ok||await jn(n,"Pending edit requests fetch failed"),n.json())}async function w9(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${gn()}/api/obe/edit-requests/hod/pending${t}`,n=await la(r,{method:"GET"});return n.status===401?{results:[]}:(n.ok||await jn(n,"HOD pending edit requests fetch failed"),n.json())}async function S9(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`),e!=null&&e.scope&&n.push(`scope=${encodeURIComponent(e.scope)}`);const i=n.length?`?${n.join("&")}`:"",s=`${gn()}/api/obe/edit-requests/history${i}`,o=await la(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await jn(o,"Edit requests history fetch failed"),o.json())}async function vS(){const e=`${gn()}/api/obe/iqac/class-type-weights`,t=await la(e,{method:"GET"});if(t.status===401)throw new Error("Authentication required to fetch class-type weights");t.ok||await jn(t,"Fetch class-type weights failed");const r=await t.json();return(r==null?void 0:r.results)||{}}async function _9(e){const t=`${gn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}`,r=await la(t,{method:"GET"});if(r.status===401)throw new Error("Authentication required");return r.ok||await jn(r,"Failed to fetch internal mark mapping"),r.json()}async function j9(e,t){const r=`${gn()}/api/obe/iqac/internal-mark-mapping/${encodeURIComponent(e)}/save`,n=await la(r,{method:"POST",body:JSON.stringify({mapping:t})});if(n.status===401)throw new Error("Authentication required");return n.ok||await jn(n,"Failed to save internal mark mapping"),n.json()}async function dre(e){const t=`${gn()}/api/obe/iqac/class-type-weights/save`,r=await la(t,{method:"POST",body:JSON.stringify(e)});if(r.status===401)throw new Error("Authentication required");r.ok||await jn(r,"Save class-type weights failed");const n=await r.json();return(n==null?void 0:n.results)||{}}async function fre(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${gn()}/api/obe/edit-requests/pending-count${t}`,n=await la(r,{method:"GET"});return n.status===401?{pending:0}:(n.ok||await jn(n,"Pending edit requests count fetch failed"),n.json())}async function hre(e){const t=e?`?scope=${encodeURIComponent(e)}`:"",r=`${gn()}/api/obe/edit-requests/hod/pending-count${t}`,n=await la(r,{method:"GET"});return n.status===401?{pending:0}:(n.ok||await jn(n,"HOD pending edit requests count fetch failed"),n.json())}async function k9(e,t=120){const r=`${gn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({window_minutes:t})});return n.ok||await jn(n,"Approve edit request failed"),n.json()}async function A9(e){const t=`${gn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()}});return r.ok||await jn(r,"Reject edit request failed"),r.json()}async function N9(e){const t=`${gn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/hod-approve`,r=await la(t,{method:"POST"});return r.ok||await jn(r,"HOD approve/forward failed"),r.json()}async function C9(e){const t=`${gn()}/api/obe/edit-requests/${encodeURIComponent(String(e))}/hod-reject`,r=await la(t,{method:"POST"});return r.ok||await jn(r,"HOD reject failed"),r.json()}async function pre(){const e=`${gn()}/api/obe/publish-requests/pending`,t=await la(e,{method:"GET"});return t.status===401?{results:[]}:(t.ok||await jn(t,"Pending requests fetch failed"),t.json())}async function mre(e){var l;const t=(l=e==null?void 0:e.statuses)!=null&&l.length?e.statuses.join(","):"",r=typeof(e==null?void 0:e.limit)=="number"?e.limit:200,n=[];t&&n.push(`statuses=${encodeURIComponent(t)}`),Number.isFinite(r)&&n.push(`limit=${encodeURIComponent(String(r))}`);const i=n.length?`?${n.join("&")}`:"",s=`${gn()}/api/obe/publish-requests/history${i}`,o=await la(s,{method:"GET"});return o.status===401?{results:[]}:(o.ok||await jn(o,"History requests fetch failed"),o.json())}async function R4(){const e=`${gn()}/api/obe/publish-requests/pending-count`,t=await la(e,{method:"GET"});return t.status===401?{pending:0}:(t.ok||await jn(t,"Pending requests count fetch failed"),t.json())}async function gre(e,t=120){const r=`${gn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/approve`,n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({window_minutes:t})});return n.ok||await jn(n,"Approve request failed"),n.json()}async function xre(e){const t=`${gn()}/api/obe/publish-requests/${encodeURIComponent(String(e))}/reject`,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json",...ii()}});return r.ok||await jn(r,"Reject request failed"),r.json()}async function jn(e,t){const r=await e.text();try{const n=String(r??"").replace(/^\uFEFF/,"").trim(),i=JSON.parse(n),s=(i==null?void 0:i.detail)||t,o=Array.isArray(i==null?void 0:i.how_to_fix)?`
How to fix:
- ${i.how_to_fix.join(`
- `)}`:"",l=Array.isArray(i==null?void 0:i.errors)?`
Errors:
- ${i.errors.join(`
- `)}`:"",c=new Error(`${s}${o}${l}`);throw c.status=e.status,c.body=i,c}catch{const n=new Error(`${t}: ${e.status} ${r}`);throw n.status=e.status,n.bodyText=r,n}}async function ei(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await la(i,{method:"GET"});return s.status===401?{subject:{code:String(t),name:""},draft:null,updated_at:null,updated_by:null}:(s.ok||await jn(s,"Draft fetch failed"),s.json())}async function Fi(e,t,r){const n=`${gn()}/api/obe/draft/${encodeURIComponent(e)}/${encodeURIComponent(t)}`,i=await la(n,{method:"PUT",body:JSON.stringify({data:r})});if(i.status===401)throw new Error("Authentication required");return i.ok||await jn(i,"Draft save failed"),i.json()}async function ig(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${gn()}/api/obe/ssa1-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return i.ok||await jn(i,"SSA1 published fetch failed"),i.json()}async function E9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/ssa1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await jn(s,"SSA1 publish failed"),s.json()}async function wS(e){const t=`${gn()}/api/obe/review1-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return r.ok||await jn(r,"Review 1 published fetch failed"),r.json()}async function T9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/review1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await jn(s,"Review 1 publish failed"),s.json()}async function ey(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${gn()}/api/obe/ssa2-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return i.ok||await jn(i,"SSA2 published fetch failed"),i.json()}async function P9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/ssa2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await jn(s,"SSA2 publish failed"),s.json()}async function SS(e){const t=`${gn()}/api/obe/review2-published/${encodeURIComponent(e)}`,r=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return r.ok||await jn(r,"Review 2 published fetch failed"),r.json()}async function O9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/review2-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await jn(s,"Review 2 publish failed"),s.json()}async function _S(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${gn()}/api/obe/formative1-published/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return i.ok||await jn(i,"Formative1 published fetch failed"),i.json()}async function yre(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/formative1-publish/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await jn(s,"Formative1 publish failed"),s.json()}async function v0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/${encodeURIComponent(e)}-published/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.ok||await jn(s,`${e} published fetch failed`),s.json()}async function M9(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${gn()}/api/obe/${encodeURIComponent(e)}-publish/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:r})});return o.ok||await jn(o,`${e} publish failed`),o.json()}async function Ks(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/lab-published-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.ok||await jn(s,"Lab published sheet fetch failed"),s.json()}async function _N(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${gn()}/api/obe/lab-publish-sheet/${encodeURIComponent(e)}/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:r})});return o.ok||await jn(o,"Lab publish failed"),o.json()}async function ty(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${gn()}/api/obe/cia1-published-sheet/${encodeURIComponent(e)}${r}`,i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return i.ok||await jn(i,"CIA1 published sheet fetch failed"),i.json()}async function bre(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/cia1-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await jn(s,"CIA1 publish failed"),s.json()}async function Fm(e,t){const r=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${gn()}/api/obe/model-published-sheet/${encodeURIComponent(e)}${r}`;try{const i=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});if(i.ok)return i.json();if(i.status===404){const s=await Ks("model",e,t);return{subject:s.subject,data:s.data}}await jn(i,"MODEL published sheet fetch failed")}catch(i){throw i}}async function L9(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/model-publish-sheet/${encodeURIComponent(e)}${n}`,s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:t})});return s.ok||await jn(s,"MODEL publish failed"),s.json()}async function w0(e,t,r){const n=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${gn()}/api/obe/${encodeURIComponent(e)}-published-sheet/${encodeURIComponent(t)}${n}`,s=await fetch(i,{method:"GET",headers:{"Content-Type":"application/json",...ii()}});return s.ok||await jn(s,`${e} published sheet fetch failed`),s.json()}async function R9(e,t,r,n){const i=n?`?teaching_assignment_id=${encodeURIComponent(String(n))}`:"",s=`${gn()}/api/obe/${encodeURIComponent(e)}-publish-sheet/${encodeURIComponent(t)}${i}`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",...ii()},body:JSON.stringify({data:r})});return o.ok||await jn(o,`${e} publish failed`),o.json()}async function F9(e,t,r){const n=(c,u=1200)=>{const d=String(c||""),h=d.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||d.replace(/\s+/g," ").trim();return h.length<=u?h:h.slice(0,u)+" (truncated)"},i=r?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",s=`${gn()}/api/obe/${encodeURIComponent(e)}-marks/${encodeURIComponent(t)}${i}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}}});if(!l.ok){const c=await l.text();try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`${e.toUpperCase()} roster fetch failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"";throw new Error(`${d}${f}`)}catch{const u=n(c);throw new Error(`${e.toUpperCase()} roster fetch failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}}return l.json()}async function vre(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},i=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in",s=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",o=`${i}/api/obe/cia1-marks/${encodeURIComponent(e)}${s}`,l=window.localStorage.getItem("access"),c=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}}});if(!c.ok){const u=await c.text();try{const d=JSON.parse(u),f=(d==null?void 0:d.detail)||`CIA1 roster fetch failed: ${c.status}`,p=Array.isArray(d==null?void 0:d.how_to_fix)?`
How to fix:
- ${d.how_to_fix.join(`
- `)}`:"";throw new Error(`${f}${p}`)}catch{const d=r(u);throw new Error(`CIA1 roster fetch failed: ${c.status}
${d||"Server returned a non-JSON error response."}`)}}return c.json()}async function wre(e,t){const r=(u,d=1200)=>{const f=String(u||""),m=f.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||f.replace(/\s+/g," ").trim();return m.length<=d?m:m.slice(0,d)+" (truncated)"},s=`${typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in"}/api/obe/cia1-marks/${encodeURIComponent(e)}`,o=window.localStorage.getItem("access"),l=await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json",...o?{Authorization:`Bearer ${o}`}:{}},body:JSON.stringify({marks:t})}),c=await l.text();if(!l.ok)try{const u=JSON.parse(c),d=(u==null?void 0:u.detail)||`CIA1 save failed: ${l.status}`,f=Array.isArray(u==null?void 0:u.how_to_fix)?`
How to fix:
- ${u.how_to_fix.join(`
- `)}`:"",p=Array.isArray(u==null?void 0:u.errors)?`
Errors:
- ${u.errors.join(`
- `)}`:"";throw new Error(`${d}${f}${p}`)}catch{const u=r(c);throw new Error(`CIA1 save failed: ${l.status}
${u||"Server returned a non-JSON error response."}`)}return JSON.parse(c)}const K8=Object.freeze(Object.defineProperty({__proto__:null,approveEditRequest:k9,approvePublishRequest:gre,bulkDeleteDueSchedule:g9,bulkResetGlobalPublishControls:f9,bulkSetAssessmentControls:M4,bulkSetGlobalPublishControls:O4,bulkUpsertDueSchedule:m9,confirmMarkManagerLock:fh,createEditRequest:sl,createPublishRequest:jh,deleteDueSchedule:ure,dismissResetNotifications:c9,fetchAssessmentControls:Dv,fetchCia1Marks:vre,fetchCiaMarks:F9,fetchClassTypeWeights:vS,fetchDraft:ei,fetchDueScheduleSubjects:p9,fetchDueSchedules:L4,fetchEditRequestsHistory:S9,fetchEditWindow:l1,fetchGlobalPublishControls:fx,fetchHodPendingEditRequestCount:hre,fetchHodPendingEditRequests:w9,fetchInternalMarkMapping:_9,fetchIqacCqiConfig:bS,fetchIqacQpPattern:sh,fetchMarkTableLockStatus:xS,fetchMyLatestEditRequest:Rm,fetchMyTeachingAssignments:hc,fetchObeSemesters:h9,fetchPendingEditRequestCount:fre,fetchPendingEditRequests:v9,fetchPendingPublishRequestCount:R4,fetchPendingPublishRequests:pre,fetchPublishRequestsHistory:mre,fetchPublishWindow:SN,fetchPublishedCia1Sheet:ty,fetchPublishedCiaSheet:w0,fetchPublishedFormative:v0,fetchPublishedFormative1:_S,fetchPublishedLabSheet:Ks,fetchPublishedModelSheet:Fm,fetchPublishedReview1:wS,fetchPublishedReview2:SS,fetchPublishedSsa1:ig,fetchPublishedSsa2:ey,fetchResetNotifications:l9,fetchSpecialCourseEnabledAssessments:yS,fetchTeachingAssignmentEnabledAssessments:ore,fetchTeachingAssignmentEnabledAssessmentsInfo:dm,formatApiErrorMessage:ll,formatEditRequestSentMessage:ol,hodApproveEditRequest:N9,hodRejectEditRequest:C9,iqacResetAssessment:wN,publishCia1Sheet:bre,publishCiaSheet:R9,publishFormative:M9,publishFormative1:yre,publishLabSheet:_N,publishModelSheet:L9,publishReview1:T9,publishReview2:O9,publishSsa1:E9,publishSsa2:P9,rejectEditRequest:A9,rejectPublishRequest:xre,requestTeachingAssignmentEnabledAssessmentsEdit:d9,saveCia1Marks:wre,saveDraft:Fi,setTeachingAssignmentEnabledAssessments:lre,setTeachingAssignmentEnabledAssessmentsInfo:u9,upsertClassTypeWeights:dre,upsertDueSchedule:cre,upsertInternalMarkMapping:j9,upsertIqacCqiConfig:b9,upsertIqacQpPattern:y9},Symbol.toStringTag,{value:"Module"})),Sre={profile:z0,curriculum_master:gs,assigned_subjects:gs,department_curriculum:V8,elective_import:E2,student_curriculum_view:P4,home:N2,hod_advisors:ys,hod_teaching:gs,advisor_students:Om,mentor_assign:ys,timetable_templates:xs,timetable_assignments:xs,student_timetable:xs,staff_timetable:xs,student_attendance:A2,student_academics:Om,my_mentees:ys,period_attendance:A2,obe:gs,obe_master:gs,obe_due_dates:E4,obe_requests:Cx,hod_obe_requests:Cx,academic_controller:V8,notifications:Cx};function _re({baseUrl:e=""}){const{data:t,loading:r,error:n}=nre(e),i=hl(),{collapsed:s,toggle:o}=vN(),[l,c]=x.useState(0),[u,d]=x.useState({}),p=((t==null?void 0:t.permissions)||[]).map(j=>String(j||"").toLowerCase()).includes("obe.master.manage");if(x.useEffect(()=>{let j=!0;const k=window.localStorage.getItem("access");if(!p||!k)return c(0),()=>{j=!1};(async()=>{try{const R=await R4();if(!j)return;c(Number(R.pending||0))}catch{}})();const A=window.setInterval(()=>{(async()=>{try{const R=await R4();if(!j)return;c(Number(R.pending||0))}catch{}})()},3e4);return()=>{j=!1,window.clearInterval(A)}},[p]),x.useEffect(()=>{i.pathname.startsWith("/academic")&&d(j=>({...j,academic:!0}))},[i.pathname]),x.useEffect(()=>{i.pathname.startsWith("/iqac/academic-controller")&&d(j=>({...j,academic_controller:!0}))},[i.pathname]),r)return a.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:a.jsx("div",{className:"p-6 flex items-center justify-center h-full",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})});if(n)return a.jsx("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:a.jsx("div",{className:"p-6 text-red-600 text-sm",children:"Error loading sidebar"})});if(!t)return null;const h=t.entry_points||{},m=[],g=(t.permissions||[]).map(j=>(j||"").toString().toLowerCase()),y=(t.roles||[]).map(j=>(j||"").toString().toUpperCase()),b=t.flags||{},v=y.includes("IQAC");return h.curriculum_master&&(g.some(j=>j.includes("curriculum"))||h.curriculum_master)&&m.push({key:"curriculum_master",label:"Curriculum Master",to:"/curriculum/master"}),h.department_curriculum&&(g.some(j=>j.includes("curriculum"))||h.department_curriculum)&&m.push({key:"department_curriculum",label:"Department Curriculum",to:"/curriculum/department"}),g.includes("curriculum.import_elective_choices")&&m.push({key:"elective_import",label:"Elective Import",to:"/curriculum/elective-import"}),h.hod_advisors&&(y.includes("HOD")||g.includes("academics.assign_advisor"))&&m.push({key:"hod_advisors",label:"Advisor Assign",to:"/hod/advisors"}),h.hod_teaching&&(y.includes("ADVISOR")||g.includes("academics.assign_teaching"))&&m.push({key:"hod_teaching",label:"Teaching Assign",to:"/advisor/teaching"}),(!!(h!=null&&h.hod_obe_requests)||y.includes("HOD"))&&m.push({key:"hod_obe_requests",label:"HOD: OBE Requests",to:"/hod/obe-requests"}),h.advisor_students&&(y.includes("ADVISOR")||g.includes("academics.view_my_students"))&&m.push({key:"advisor_students",label:"My Students",to:"/advisor/students"}),(y.includes("ADVISOR")||g.includes("academics.assign_mentor"))&&m.push({key:"mentor_assign",label:"Mentor Assign",to:"/advisor/mentor"}),h.student_curriculum_view&&g.some(j=>j.includes("curriculum"))&&m.push({key:"student_curriculum_view",label:"My Curriculum",to:"/curriculum/student"}),(b.can_manage_timetable_templates||g.includes("timetable.manage_templates"))&&h.timetable_templates&&m.push({key:"timetable_templates",label:"IQAC: Timetable Templates",to:"/iqac/timetable"}),(!!b.can_assign_timetable||g.includes("timetable.assign")||y.includes("ADVISOR"))&&h.timetable_assignments&&m.push({key:"timetable_assignments",label:"Timetable Assignments",to:"/advisor/timetable"}),b.can_view_timetable&&b.is_student&&g.includes("timetable.view")&&m.push({key:"student_timetable",label:"My Timetable",to:"/student/timetable"}),b.can_view_timetable&&b.is_staff&&g.includes("timetable.view")&&m.push({key:"staff_timetable",label:"My Timetable (Staff)",to:"/staff/timetable"}),b.is_student&&(m.push({key:"student_academics",label:"Academics",to:"/student/academics"}),m.push({key:"student_attendance",label:"My Attendance",to:"/student/attendance"})),b.is_staff&&(g.includes("academics.view_assigned_subjects")||y.includes("HOD"))&&m.push({key:"assigned_subjects",label:"Assigned Subjects",to:"/staff/assigned-subjects"}),b.is_staff&&g.includes("academics.view_mentees")&&m.push({key:"my_mentees",label:"My Mentees",to:"/staff/mentees"}),b.is_staff&&(g.includes("academics.mark_attendance")||y.includes("HOD")||y.includes("ADVISOR"))&&m.push({key:"period_attendance",label:"Mark Attendance",to:"/staff/period-attendance"}),b.is_staff&&(g.includes("academics.view_all_attendance")||g.includes("academics.view_attendance_overall")||g.includes("academics.view_all_departments")||g.includes("academics.view_department_attendance")||g.includes("academics.view_class_attendance")||g.includes("academics.view_section_attendance"))&&m.push({key:"attendance_analytics",label:"Attendance Analytics",to:"/staff/analytics"}),m.unshift({key:"profile",label:"Profile",to:"/profile"}),v&&m.push({key:"notifications",label:"Notifications",to:"/notifications"}),b.is_staff&&!m.some(j=>j.key==="academic")&&m.push({key:"academic",label:"Academic",to:"/academic"}),v&&!m.some(j=>j.key==="academic_controller")&&m.push({key:"academic_controller",label:"Academic Controller",to:"/iqac/academic-controller"}),p&&!v&&!m.some(j=>j.key==="obe_due_dates")&&m.push({key:"obe_due_dates",label:"OBE: Due Dates",to:"/obe/master/due-dates"}),p&&!m.some(j=>j.key==="obe_requests")&&m.push({key:"obe_requests",label:"OBE: Requests",to:"/obe/master/requests"}),a.jsxs(a.Fragment,{children:[!s&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:o}),a.jsxs("aside",{className:`fixed top-16 left-0 h-[calc(100vh-4rem)] bg-white shadow-lg transition-all duration-300 z-30 overflow-y-auto ${s?"-translate-x-full lg:translate-x-0 lg:w-20":"w-full lg:w-64"}`,children:[a.jsx("div",{className:"hidden"}),a.jsx("nav",{className:"py-6",children:a.jsxs("ul",{className:"space-y-2 px-3",children:[a.jsx("li",{children:a.jsxs(es,{to:"/dashboard",className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${i.pathname==="/dashboard"?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(N2,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),a.jsx("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:"Dashboard"})]})}),m.map(j=>{const k=Sre[j.key]||z0,A=i.pathname.startsWith(j.to);return a.jsxs("li",{className:"relative",children:[a.jsxs(es,{to:j.to,className:`flex items-center gap-3 px-3 py-3 rounded-lg transition-all duration-200 ${A?"bg-blue-600 text-white shadow-md":"text-gray-700 hover:bg-blue-50 hover:text-blue-600"} ${s?"lg:justify-center lg:px-2":""}`,onClick:()=>{window.innerWidth<1024&&o(),j.key==="academic"&&d(R=>({...R,academic:!R.academic})),j.key==="academic_controller"&&d(R=>({...R,academic_controller:!R.academic_controller}))},children:[a.jsx(k,{className:`flex-shrink-0 ${s?"lg:w-5 lg:h-5":"w-6 h-6"}`}),a.jsxs("span",{className:`font-medium text-base ${s?"lg:hidden":""}`,children:[j.label,j.key==="obe_requests"&&l>0?a.jsx("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 text-xs font-medium rounded-full bg-red-600 text-white",children:l}):null]})]}),j.key==="academic"&&p&&u.academic?a.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[a.jsx("li",{children:a.jsxs(es,{to:"/academic?tab=obe_master",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/academic")&&new URLSearchParams(i.search).get("tab")==="obe_master"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(gs,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE Master"})]})}),v?null:a.jsx("li",{children:a.jsxs(es,{to:"/academic?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/academic")&&new URLSearchParams(i.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(E4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE: Due Dates"})]})})]}):null,j.key==="academic_controller"&&u.academic_controller?a.jsxs("ul",{className:"pl-8 mt-1 space-y-1",children:[a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=dashboard",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="dashboard"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(N2,{className:"w-4 h-4"})," ",a.jsx("span",{children:"Dashboard"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=qp",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="qp"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(P4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"QP"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=due_dates",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="due_dates"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(E4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"OBE Due Dates"})]})}),a.jsx("li",{children:a.jsxs(es,{to:"/iqac/academic-controller?tab=courses",className:`flex items-center gap-2 px-3 py-2 rounded-md text-sm ${i.pathname.startsWith("/iqac/academic-controller")&&new URLSearchParams(i.search).get("tab")==="courses"?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-50"}`,onClick:()=>{window.innerWidth<1024&&o()},children:[a.jsx(P4,{className:"w-4 h-4"})," ",a.jsx("span",{children:"Courses"})]})})]}):null]},j.key)})]})})]})]})}const jre=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function kre({editingCell:e,periods:t,assignmentMap:r,specialName:n,setSpecialName:i,selectedSpecialId:s,setSelectedSpecialId:o,specialTimetables:l,specialDate:c,setSpecialDate:u,curriculum:d,currentSectionRegulation:f,editingCurriculumId:p,setEditingCurriculumId:h,customSubjectText:m,setCustomSubjectText:g,editingAvailableBatches:y,setEditingAvailableBatches:b,editingBatchId:v,setEditingBatchId:w,isCustomAssignment:S,setIsCustomAssignment:j,customAssignmentText:k,setCustomAssignmentText:A,selectedStaffId:R,setSelectedStaffId:M,staffList:B,sectionId:E,shortLabel:P,loadBatchesForCurriculum:D,handleDeleteSpecialEntry:G,handleDeleteAssignment:H,handleUpdateAssignment:oe,handleAssign:de,loadTimetable:W,setShowCellPopup:V,customSubjectOptions:ae,setEditingCell:ee,fetchWithAuth:C}){if(!e)return null;const Y=e.day,q=e.periodId,O=r[Y]&&r[Y][q]||[],X=t.find(F=>F.id===q)||{};return a.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 px-6 py-4 flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-3 text-white",children:[a.jsx(xs,{className:"h-5 w-5"}),a.jsxs("h3",{className:"text-lg font-semibold",children:["Day ",Y,"  ",X.label||`${X.start_time||""} - ${X.end_time||""}`]})]}),a.jsx("button",{onClick:()=>{V(!1),ee(null)},className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-1.5 transition-colors",children:a.jsx(bu,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(gs,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Existing Assignments"})]}),O.length===0?a.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[a.jsx(ed,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:"No assignment yet"})]}):a.jsx("div",{className:"space-y-3",children:O.map(F=>{var Q;return a.jsxs("div",{className:`rounded-lg p-4 border-2 ${F.is_special?"bg-amber-50 border-amber-200":"bg-blue-50 border-blue-200"}`,children:[a.jsxs("div",{className:"font-bold text-gray-900 flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4"}),F.is_special?F.timetable_name||"Special":P(F.curriculum_row||F.subject_text),F.is_special&&a.jsxs("span",{className:"text-amber-600 text-sm",children:[" ",P(F.curriculum_row||F.subject_text)]})]}),a.jsxs("div",{className:"text-sm text-gray-700 mt-2 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3.5 w-3.5"}),((Q=F.staff)==null?void 0:Q.username)||"",F.subject_batch?`  Batch: ${F.subject_batch.name}`:""]}),F.is_special&&a.jsxs("div",{className:"text-xs text-amber-700 mt-2 flex items-center gap-1",children:[a.jsx(xs,{className:"h-3.5 w-3.5"}),"Date: ",F.date||"","  ",X.label||`${X.start_time||""}${X.start_time&&X.end_time?" - ":""}${X.end_time||""}`]}),a.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[a.jsxs("button",{onClick:async()=>{var re,T;const K=((re=F.curriculum_row)==null?void 0:re.id)||null,ne=((T=F.subject_batch)==null?void 0:T.id)||null;if(h(K),w(ne),K){const I=await D(K);if(ne&&!I.find(ie=>ie.id===ne))try{const ie=await C(`/api/academics/subject-batches/${ne}/`);if(ie.ok){const U=await ie.json();b(Z=>Z.find(me=>me.id===U.id)?Z:[...Z,U])}}catch(ie){console.error("failed to load existing batch",ie)}}else if(ne)try{const I=await C(`/api/academics/subject-batches/${ne}/`);if(I.ok){const ie=await I.json();b(U=>U.find(Z=>Z.id===ie.id)?U:[...U,ie])}}catch(I){console.error("failed to load existing batch",I)}},className:"px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg hover:bg-indigo-700 transition-colors flex items-center gap-1",children:[a.jsx(dh,{className:"h-3.5 w-3.5"}),"Edit"]}),a.jsxs("button",{onClick:()=>{F.is_special?G(F.id):H(F.id)},className:"px-3 py-1.5 bg-red-600 text-white text-sm rounded-lg hover:bg-red-700 transition-colors flex items-center gap-1",children:[a.jsx(Lm,{className:"h-3.5 w-3.5"}),"Delete"]}),a.jsxs("button",{onClick:async()=>{if(!p)return alert("Select new subject from right panel then click Update");const K={};p&&(K.curriculum_row=p),v!==null&&(K.subject_batch_id=v),await oe(F.id,K)},className:"px-3 py-1.5 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 transition-colors flex items-center gap-1",children:[a.jsx(rd,{className:"h-3.5 w-3.5"}),"Update"]})]})]},F.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Mm,{className:"h-5 w-5 text-green-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Assign / Edit"})]}),a.jsxs("div",{className:"space-y-4 bg-gray-50 rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Type"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>{j(!1),A(""),M(null)},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${S?"bg-white text-gray-700 border-gray-300 hover:border-indigo-300":"bg-indigo-600 text-white border-indigo-600"}`,children:"From Curriculum"}),a.jsx("button",{onClick:()=>{j(!0),h(null),w(null),b([])},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${S?"bg-indigo-600 text-white border-indigo-600":"bg-white text-gray-700 border-gray-300 hover:border-indigo-300"}`,children:"Custom Subject"})]})]}),S?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject Name"}),a.jsxs("select",{value:k||"",onChange:F=>A(F.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select custom subject"}),ae.map(F=>a.jsx("option",{value:F.label,children:F.label},F.value))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Staff (optional)"}),a.jsxs("select",{value:R||"",onChange:F=>M(Number(F.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select staff (optional)"}),B.map(F=>a.jsx("option",{value:F.id,children:(()=>{var re,T,I;const Q=((re=F.user)==null?void 0:re.first_name)||"",K=((T=F.user)==null?void 0:T.last_name)||"";return`${Q} ${K}`.trim()||((I=F.user)==null?void 0:I.username)||F.staff_id})()},F.id))]})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),a.jsxs("select",{value:p||"",onChange:async F=>{const Q=Number(F.target.value)||null;h(Q),w(null),Q?await D(Q):b([])},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select subject"}),d.filter(F=>!(f!=null&&f.code)||F.regulation===f.code).map(F=>a.jsxs("option",{value:F.id,children:[F.course_code,"  ",F.course_name]},F.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),a.jsxs("select",{value:v||"",onChange:F=>w(Number(F.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[a.jsx("option",{value:"",children:"Select batch (optional)"}),y.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]})]})]}),a.jsxs("button",{onClick:async()=>{if(S){if(!k.trim())return alert("Subject name is required");await de(Y,q)}else{if(!p)return alert("Select a subject");await de(Y,q,p)}V(!1),ee(null)},className:"w-full px-4 py-2.5 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx(Mm,{className:"h-4 w-4"}),"Assign to Period"]})]}),a.jsxs("div",{className:"mt-6 border-t border-gray-200 pt-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[a.jsx(ed,{className:"h-5 w-5 text-amber-600"}),a.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:"Mark Special Period"})]}),a.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Create a date-specific override for this period."}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Special timetable"}),a.jsxs("select",{value:s??"",onChange:F=>o(F.target.value?Number(F.target.value):null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"Create new"}),l.map(F=>a.jsxs("option",{value:F.id,children:[F.name," ",F.is_active?"":"(inactive)"]},F.id))]}),!s&&a.jsx("input",{placeholder:"Name for new special timetable",value:n,onChange:F=>{F.preventDefault(),i(F.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"},"special-name-input")]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Date"}),a.jsx("input",{type:"date",value:c||"",onChange:F=>u(F.target.value||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Subject"}),a.jsxs("select",{value:p??"",onChange:F=>{const Q=Number(F.target.value)||null;h(Q),g(""),w(null),Q&&Q!==-1&&D(Q).catch(console.error)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"-- choose from section subjects --"}),d.filter(F=>!(f!=null&&f.code)||F.regulation===f.code).map(F=>a.jsxs("option",{value:F.id,children:[F.course_code,"  ",F.course_name]},F.id)),a.jsx("option",{value:"-1",children:"Custom text"})]}),p===-1&&a.jsxs("select",{value:m||"",onChange:F=>{F.preventDefault(),g(F.target.value)},className:"w-full mt-2 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"-- choose custom subject --"}),ae.map(F=>a.jsx("option",{value:F.label,children:F.label},F.value))]},"custom-subject-input")]}),y&&y.length>0&&p&&p!==-1&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"Batch (optional)"}),a.jsxs("select",{value:v||"",onChange:F=>w(Number(F.target.value)||null),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-amber-500",children:[a.jsx("option",{value:"",children:"None"}),y.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]})]}),a.jsxs("button",{onClick:async()=>{if(!c)return alert("Select a date");try{let F=s;if(!F){const ne=n||`Special - ${c}`,re=await C("/api/timetable/special-timetables/",{method:"POST",body:JSON.stringify({name:ne,section:E,is_active:!0})});if(!re.ok){const I=await re.text();return alert("Failed to create special timetable: "+I)}F=(await re.json()).id}const Q={timetable_id:F,timetable:F,date:c,period_id:q,period:q};p&&p!==-1&&(Q.curriculum_row=p),p===-1&&m&&(Q.subject_text=m),v&&(Q.subject_batch_id=v);const K=await C("/api/timetable/special-entries/",{method:"POST",body:JSON.stringify(Q)});if(!K.ok){const ne=await K.text();return alert("Failed to create special entry: "+ne)}alert("Special period created"),await W(),V(!1),ee(null)}catch(F){console.error(F),alert("Failed to create special entry")}},className:"w-full px-4 py-2.5 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors flex items-center justify-center gap-2 font-medium",children:[a.jsx(ed,{className:"h-4 w-4"}),"Mark Special Period"]})]})]})]})]})})]})})}function Are(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState([]),[S,j]=x.useState(null),[k,A]=x.useState(null),[R,M]=x.useState([]),[B,E]=x.useState(null),[P,D]=x.useState(!1),[G,H]=x.useState(new Date().toISOString().slice(0,10)),[oe,de]=x.useState([]),[W,V]=x.useState(null),[ae,ee]=x.useState(""),[C,Y]=x.useState(""),[q,O]=x.useState([]),[X,F]=x.useState(!1),[Q,K]=x.useState(""),[ne,re]=x.useState(null),[T,I]=x.useState([]);x.useEffect(()=>{mr("/api/academics/my-students/").then(Ke=>Ke.ok?Ke.json():[]).then(Ke=>{const lt=(Ke.results||[]).map(ve=>({id:ve.section_id,name:ve.section_name,batch:ve.batch,batch_regulation:ve.batch_regulation,department_id:ve.department_id}));t(lt),!o&&lt.length>0&&(l(lt[0].id),u(lt[0].department_id),f(lt[0].batch_regulation))}),mr("/api/timetable/templates/").then(Ke=>Ke.json()).then(Ke=>{const lt=Ke||[];n(lt);const ve=lt.find(Ae=>Ae.is_active)||lt[0];ve&&(h(ve.id),s(ve.periods||[]))}),mr("/api/academics/custom-subjects/").then(Ke=>Ke.ok?Ke.json():{results:[]}).then(Ke=>O(Ke.results||[])).catch(Ke=>console.error("Failed to load custom subjects",Ke))},[]),x.useEffect(()=>{if(o){const Ke=e.find(lt=>lt.id===o);Ke&&f(Ke.batch_regulation),mr(`/api/timetable/curriculum-for-section/?section_id=${o}`).then(lt=>lt.json()).then(lt=>g(lt.results||[])),ie(),mr(`/api/timetable/section/${o}/subjects-staff/`).then(lt=>lt.ok?lt.json():[]).then(lt=>w(lt.results||[])),mr(`/api/timetable/special-timetables/?section_id=${o}`).then(lt=>lt.ok?lt.json():[]).then(lt=>de(lt.results||[])),c&&mr(`/api/academics/advisor-staff/?department=${c}`).then(lt=>lt.ok?lt.json():[]).then(lt=>I(lt.results||lt||[]))}},[o,c]);async function ie(){if(o)try{const Ke=await mr(`/api/timetable/section/${o}/timetable/`);if(!Ke.ok)return;const lt=await Ke.json();b(lt.results||[])}catch(Ke){console.error("loadTimetable failed",Ke)}}const U={};for(const Ke of y){const lt=Ke.day;U[lt]=U[lt]||{};for(const ve of Ke.assignments||[])U[lt][ve.period_id]=U[lt][ve.period_id]||[],U[lt][ve.period_id].push(ve)}function Z(Ke){if(!Ke)return"";if(typeof Ke=="string"){const Ae=Ke.trim();return Ae.length<=12?Ae:Ae.slice(0,12)+""}if(Ke.course_code)return Ke.course_code;const lt=Ke.course_name||Ke.course||Ke.subject_text||"",ve=String(lt).trim();return ve.length<=12?ve:ve.split(" ").map(Ae=>Ae[0]).slice(0,3).join("")||ve.slice(0,12)}function me(Ke){const lt=new Date,ve=lt.getDay(),Ae=new Date(lt),ce=ve===0?-6:1-ve;Ae.setDate(lt.getDate()+ce);const be=new Date(Ae);return be.setDate(Ae.getDate()+(Ke-1)),be.toISOString().slice(0,10)}async function Pe(Ke,lt,ve){if(!o)return alert("Section is required");const Ae={period_id:lt,day:Ke,section_id:o};if(X){if(!Q.trim())return alert("Subject name is required");Ae.subject_text=Q.trim(),ne&&(Ae.staff_id=ne)}else{if(!ve)return alert("Select a curriculum row first");Ae.curriculum_row=ve,B&&(Ae.subject_batch_id=B)}const ce=await mr("/api/timetable/assignments/",{method:"POST",body:JSON.stringify(Ae)});if(!ce.ok){const be=await ce.text();return alert("Failed: "+be)}A(null),M([]),E(null),K(""),re(null),await ie()}async function je(Ke){if(M([]),!Ke)return[];try{const lt=await mr(`/api/academics/subject-batches/?curriculum_row_id=${Ke}&page_size=0&include_all=1`);if(lt.ok){const ve=await lt.json(),Ae=ve.results||ve||[];return M(Ae),Ae}}catch(lt){console.error("loadBatches failed",lt)}return[]}function Fe(Ke,lt){if(lt.is_break||lt.is_lunch)return a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:lt.label||(lt.is_break?"Break":"Lunch")})});const ve=U[Ke]&&U[Ke][lt.id];return a.jsx("div",{children:ve&&ve.length?a.jsx("div",{className:"space-y-2",children:ve.map((Ae,ce)=>a.jsxs("div",{className:`rounded-lg p-2.5 cursor-pointer transition-all hover:shadow-md ${Ae.is_special?"bg-amber-50 border border-amber-200 hover:border-amber-300":"bg-blue-50 border border-blue-200 hover:border-blue-300"}`,onClick:()=>{j({day:Ke,periodId:lt.id}),H(me(Ke)),D(!0)},children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[a.jsx(gs,{className:"h-3 w-3"}),Ae.is_special?Ae.timetable_name||"Special":Z(Ae.curriculum_row||Ae.subject_text),Ae.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",Z(Ae.curriculum_row||Ae.subject_text)]})]}),a.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3 w-3"}),"Staff: ",(()=>{if(!Ae.staff)return"";const be=Ae.staff.first_name||"",mt=Ae.staff.last_name||"";return`${be} ${mt}`.trim()||Ae.staff.username||""})(),Ae.subject_batch?`  Batch: ${Ae.subject_batch.name}`:""]})]},ce))}):a.jsxs("div",{className:"py-4 text-gray-400 text-sm cursor-pointer hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition-all flex items-center justify-center gap-1",onClick:()=>{j({day:Ke,periodId:lt.id}),H(me(Ke)),D(!0)},children:[a.jsx(Mm,{className:"h-4 w-4"}),"Click to assign"]})})}async function _e(Ke){if(Ke&&confirm("Delete this assignment?"))try{const lt=await mr(`/api/timetable/assignments/${Ke}/`,{method:"DELETE"});if(!lt.ok){const ve=await lt.text();return alert("Failed: "+ve)}await ie()}catch(lt){console.error(lt),alert("Delete failed")}}async function He(Ke){if(!Ke||!confirm("Delete this special period?"))return;let lt=String(Ke);lt.startsWith("special-")&&(lt=lt.replace("special-",""));const ve=Number(lt);if(!ve)return alert("Invalid special entry id");try{const Ae=await mr(`/api/timetable/special-entries/${ve}/`,{method:"DELETE"});if(!Ae.ok){const ce=await Ae.text();return alert("Failed: "+ce)}await ie()}catch(Ae){console.error(Ae),alert("Delete failed")}}async function qe(Ke,lt){if(Ke)try{const ve=await mr(`/api/timetable/assignments/${Ke}/`,{method:"PATCH",body:JSON.stringify(lt)});if(!ve.ok){const Ae=await ve.text();return alert("Failed: "+Ae)}await ie(),D(!1),j(null)}catch(ve){console.error(ve),alert("Update failed")}}const ut=(()=>{if(!(d!=null&&d.code))return[];const Ke=m.filter(Ae=>Ae.regulation===d.code),lt=new Map;return v.forEach(Ae=>{Ae.id&&Ae.staff&&lt.set(Ae.id,Ae.staff)}),Ke.map(Ae=>({...Ae,staff:lt.get(Ae.id)||""}))})();return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:[a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(xs,{className:"h-7 w-7 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Timetable Editor"}),a.jsx("p",{className:"text-gray-600",children:"Manage class schedules and assignments"})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg border border-indigo-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Om,{className:"h-4 w-4 text-indigo-600"}),a.jsx("span",{className:"font-semibold text-indigo-900",children:(e.find(Ke=>Ke.id===o)||{name:"Section"}).name})]})}),d&&a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-lg border border-emerald-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4 text-emerald-600"}),a.jsxs("span",{className:"font-semibold text-emerald-900",children:["Regulation: ",d.code]})]})}),p&&a.jsx("div",{className:"px-4 py-2 bg-gray-50 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-4 w-4 text-gray-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:(r.find(Ke=>Ke.id===p)||{name:"Template"}).name})]})})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 mb-6 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[120px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),i.map(Ke=>a.jsxs("th",{className:"px-4 py-3 min-w-[160px]",children:[a.jsx("div",{className:"text-sm font-bold text-indigo-700",children:Ke.label||`Period ${Ke.index||""}`}),a.jsx("div",{className:"text-xs text-gray-600 mt-0.5",children:Ke.start_time?`${Ke.start_time}${Ke.end_time?" - "+Ke.end_time:""}`:Ke.is_break?"Break":""})]},Ke.id))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:jre.map((Ke,lt)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:Ke}),i.map(ve=>{const Ae=S&&S.day===lt+1&&S.periodId===ve.id;return a.jsx("td",{className:`px-4 py-3 align-top ${Ae?"bg-indigo-50 border-2 border-indigo-300 shadow-md":""}`,children:Fe(lt+1,ve)},ve.id)})]},Ke))})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"h-5 w-5 text-indigo-600"}),a.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Subjects & Staff Reference",d&&a.jsxs("span",{className:"ml-2 text-sm font-normal text-gray-600",children:["(Regulation: ",d.code,")"]})]})]})}),a.jsx("div",{className:"overflow-x-auto max-h-96",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 sticky top-0",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Staff"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:ut.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:2,className:"px-6 py-8 text-center",children:[a.jsx(gs,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),a.jsx("p",{className:"text-gray-500",children:d?`No subjects found for regulation ${d.code}`:"No subjects found"})]})}):ut.map(Ke=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-3 text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(gs,{className:"h-4 w-4 text-indigo-600"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:Ke.course_code?`${Ke.course_code}  ${Ke.course_name}`:Ke.course_name}),Ke.class_type&&a.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[Ke.class_type," ",Ke.is_elective?" Elective":""]})]})]})}),a.jsx("td",{className:"px-6 py-3 text-sm text-gray-700",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"h-4 w-4 text-gray-500"}),a.jsx("span",{className:Ke.staff===""?"text-gray-400 italic":"",children:Ke.staff}),Ke.staff===""&&a.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:"Not Assigned"})]})})]},String(Ke.id)))})]})})]})]}),P?a.jsx(kre,{editingCell:S,periods:i,assignmentMap:U,specialName:ae,setSpecialName:ee,selectedSpecialId:W,setSelectedSpecialId:V,specialTimetables:oe,specialDate:G,setSpecialDate:H,curriculum:m,currentSectionRegulation:d,editingCurriculumId:k,setEditingCurriculumId:A,customSubjectText:C,setCustomSubjectText:Y,editingAvailableBatches:R,setEditingAvailableBatches:M,editingBatchId:B,setEditingBatchId:E,isCustomAssignment:X,setIsCustomAssignment:F,customAssignmentText:Q,setCustomAssignmentText:K,selectedStaffId:ne,setSelectedStaffId:re,staffList:T,sectionId:o,shortLabel:Z,loadBatchesForCurriculum:je,handleDeleteSpecialEntry:He,handleDeleteAssignment:_e,handleUpdateAssignment:qe,handleAssign:Pe,loadTimetable:ie,setShowCellPopup:D,setEditingCell:j,fetchWithAuth:mr,customSubjectOptions:q}):null]})}function Nre(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[i,s]=x.useState(!1),[o,l]=x.useState({name:"",description:"",parity:"BOTH",is_public:!1,is_active:!1}),[c,u]=x.useState([]),[d,f]=x.useState({name:"",parity:"ODD",is_active:!1}),[p,h]=x.useState({index:1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""}),[m,g]=x.useState(null),[y,b]=x.useState({});x.useEffect(()=>{v()},[]),x.useEffect(()=>{w()},[]);async function v(){s(!0);try{const E=await mr("/api/timetable/templates/");if(!E.ok)throw new Error(await E.text());const P=await E.json(),D=Array.isArray(P)?P:P.results||P;if(t(D||[]),D&&D.length){const G=D.find(H=>H.is_active)||D[0];n(G);try{const H=G&&G.periods||[],oe=H.length?Math.max(...H.map(de=>Number(de.index||de.position||0))):0;h(de=>({...de,index:Number(oe)+1}))}catch{}}}catch(E){console.error(E),alert("Failed to load templates")}finally{s(!1)}}async function w(){try{const E=await mr("/api/academics/academic-years/");if(!E.ok)throw new Error(await E.text());const P=await E.json(),D=Array.isArray(P)?P:P.results||P;u(D||[])}catch(E){console.error(E)}}async function S(){try{const E=await mr("/api/academics/academic-years/",{method:"POST",body:JSON.stringify(d)});if(!E.ok)throw new Error(await E.text());await w(),f({name:"",parity:"ODD",is_active:!1})}catch(E){console.error(E),alert("Failed to create academic year: "+String(E))}}async function j(E,P){try{const D=await mr(`/api/academics/academic-years/${E}/`,{method:"PATCH",body:JSON.stringify({is_active:P})});if(!D.ok)throw new Error(await D.text());await w(),await v()}catch(D){console.error(D),alert("Failed to update academic year: "+String(D))}}async function k(){if(!r)return alert("Select a template first");try{const E={...p,template:r.id},P=await mr("/api/timetable/slots/",{method:"POST",body:JSON.stringify(E)});if(!P.ok)throw new Error(await P.text());await v(),h({index:p.index+1,start_time:"",end_time:"",is_break:!1,is_lunch:!1,label:""})}catch(E){console.error(E),alert("Failed to add slot: "+String(E))}}async function A(E){if(confirm("Delete this period?"))try{const P=await mr(`/api/timetable/slots/${E}/`,{method:"DELETE"});if(!P.ok)throw new Error(await P.text());await v()}catch(P){console.error(P),alert("Failed to delete slot: "+String(P))}}function R(E){g(E.id),b({...E})}function M(){g(null),b({})}async function B(){if(!(!m||!y))try{const E=await mr(`/api/timetable/slots/${m}/`,{method:"PATCH",body:JSON.stringify(y)});if(!E.ok)throw new Error(await E.text());await v(),g(null),b({})}catch(E){console.error(E),alert("Failed to update slot: "+String(E))}}return a.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[a.jsx("span",{className:"p-3 bg-indigo-100 rounded-xl",children:a.jsxs("svg",{width:"28",height:"28",fill:"none",viewBox:"0 0 48 48",children:[a.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),a.jsx("path",{d:"M16 24h16M16 32h16M16 16h16",stroke:"#6366f1",strokeWidth:"2",strokeLinecap:"round"})]})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"IQAC  Timetable Templates"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Create and manage timetable templates and periods."})]})]}),i&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),"Loading templates..."]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(xs,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Academic Years"})]}),a.jsxs("div",{className:"space-y-3 mb-6 p-4 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),a.jsx("input",{type:"text",placeholder:"e.g. 2025-26",value:d.name,onChange:E=>f({...d,name:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Parity"}),a.jsxs("select",{value:d.parity,onChange:E=>f({...d,parity:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"ODD",children:"Odd"}),a.jsx("option",{value:"EVEN",children:"Even"})]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",id:"activate",checked:d.is_active,onChange:E=>f({...d,is_active:E.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"activate",className:"ml-2 text-sm text-gray-700",children:"Activate on create"})]}),a.jsx("button",{onClick:S,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Create Academic Year"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Existing Years"}),a.jsx("div",{className:"space-y-2",children:c.map(E=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[a.jsx("div",{children:a.jsxs("div",{className:"font-medium text-gray-900",children:[E.name," ",E.parity&&`(${E.parity})`,E.is_active&&a.jsx("span",{className:"ml-2 text-xs bg-green-100 text-green-800 px-2 py-0.5 rounded-full",children:"Active"})]})}),a.jsx("button",{onClick:()=>j(E.id,!E.is_active),className:`px-3 py-1 text-xs font-medium rounded-lg transition-colors ${E.is_active?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:E.is_active?"Deactivate":"Activate"})]},E.id))})]})]})}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[a.jsx(sc,{className:"w-5 h-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Template Management"})]}),!r&&a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx(sc,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),a.jsx("p",{children:"Select a template to manage its periods."})]}),r&&a.jsxs("div",{children:[a.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:r.name}),a.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded-full",children:r.parity}),r.is_active&&a.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full",children:"Active"})]}),r.description&&a.jsx("p",{className:"text-gray-600",children:r.description})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h5",{className:"text-lg font-medium text-gray-900 mb-3",children:"Periods"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse border border-gray-200 rounded-lg",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:[a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Label"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Start Time"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"End Time"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Type"}),a.jsx("th",{className:"border border-gray-200 px-4 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white",children:(r.periods||[]).map(E=>a.jsx("tr",{className:"hover:bg-gray-50",children:m===E.id?a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"text",value:y.label||"",onChange:P=>b({...y,label:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Label"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"time",value:y.start_time||"",onChange:P=>b({...y,start_time:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsx("input",{type:"time",value:y.end_time||"",onChange:P=>b({...y,end_time:P.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex flex-col gap-1",children:[a.jsxs("label",{className:"flex items-center text-xs",children:[a.jsx("input",{type:"checkbox",checked:y.is_break||!1,onChange:P=>b({...y,is_break:P.target.checked,is_lunch:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Break"]}),a.jsxs("label",{className:"flex items-center text-xs",children:[a.jsx("input",{type:"checkbox",checked:y.is_lunch||!1,onChange:P=>b({...y,is_lunch:P.target.checked,is_break:!1}),className:"mr-1 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),"Lunch"]})]})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:B,className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Save Changes",children:a.jsx(rd,{className:"w-4 h-4"})}),a.jsx("button",{onClick:M,className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",title:"Cancel Edit",children:a.jsx(bu,{className:"w-4 h-4"})})]})})]}):a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.label||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.start_time||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm text-gray-900",children:E.end_time||""}),a.jsx("td",{className:"border border-gray-200 px-4 py-3 text-sm",children:E.is_break?a.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"Break"}):E.is_lunch?a.jsx("span",{className:"px-2 py-1 text-xs bg-orange-100 text-orange-800 rounded-full",children:"Lunch"}):a.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:"Period"})}),a.jsx("td",{className:"border border-gray-200 px-4 py-3",children:a.jsxs("div",{className:"flex gap-1",children:[a.jsx("button",{onClick:()=>R(E),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit Period",children:a.jsx(dh,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>A(E.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Period",children:a.jsx(Lm,{className:"w-4 h-4"})})]})})]})},E.id))})]})})]}),a.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Mm,{className:"w-5 h-5 text-green-600"}),a.jsx("h5",{className:"text-lg font-medium text-gray-900",children:"Add New Period"})]}),a.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Index"}),a.jsx("input",{type:"number",value:p.index,onChange:E=>h({...p,index:Number(E.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Time"}),a.jsx("input",{type:"time",value:p.start_time,onChange:E=>h({...p,start_time:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Time"}),a.jsx("input",{type:"time",value:p.end_time,onChange:E=>h({...p,end_time:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Label"}),a.jsx("input",{type:"text",placeholder:"Period 1, Break, etc.",value:p.label,onChange:E=>h({...p,label:E.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-4 mb-4",children:[a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:p.is_break,onChange:E=>h({...p,is_break:E.target.checked,is_lunch:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Break Period"})]}),a.jsxs("label",{className:"flex items-center",children:[a.jsx("input",{type:"checkbox",checked:p.is_lunch,onChange:E=>h({...p,is_lunch:E.target.checked,is_break:!1}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Lunch Period"})]})]}),a.jsxs("button",{onClick:k,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center gap-2",children:[a.jsx(Mm,{className:"w-4 h-4"}),"Add Period"]})]})]})]})})]})]})}function B9(){var j,k,A,R,M;const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState({}),[d,f]=x.useState({}),[p,h]=x.useState(null);async function m(){t(!0),n(null);try{const[B,E]=await Promise.all([v9(),S9({statuses:["APPROVED","REJECTED"],limit:200})]),P=Array.isArray(B==null?void 0:B.results)?B.results:[],D=Array.isArray(E==null?void 0:E.results)?E.results:[];s(P),l(D),u(G=>{const H={...G};for(const oe of P)H[oe.id]==null&&(H[oe.id]=120);return H})}catch(B){n((B==null?void 0:B.message)||"Failed to load requests")}finally{t(!1)}}x.useEffect(()=>{m()},[]);const g=x.useMemo(()=>[...i].sort((B,E)=>String(E.requested_at||"").localeCompare(String(B.requested_at||""))),[i]),y=x.useMemo(()=>[...o].sort((B,E)=>String(E.reviewed_at||E.requested_at||"").localeCompare(String(B.reviewed_at||B.requested_at||""))),[o]);function b(B){const E=String(B||"").trim();if(!E)return"?";const P=E.split(/\s+/g).filter(Boolean);return P.length===1?P[0].slice(0,2).toUpperCase():(P[0][0]+P[P.length-1][0]).toUpperCase()}function v(B){if(!B)return"";const E=new Date(B);return Number.isNaN(E.getTime())?String(B):E.toLocaleString()}async function w(B){const E=Number(c[B]??120);f(P=>({...P,[B]:!0})),n(null);try{await k9(B,Number.isFinite(E)?E:120),await m()}catch(P){n((P==null?void 0:P.message)||"Approve failed")}finally{f(P=>({...P,[B]:!1}))}}async function S(B){f(E=>({...E,[B]:!0})),n(null);try{await A9(B),await m()}catch(E){n((E==null?void 0:E.message)||"Reject failed")}finally{f(E=>({...E,[B]:!1}))}}return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:20},children:[a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:20},children:[a.jsx(sc,{size:24,color:"#9a3412"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:24,fontWeight:950,color:"#111827"},children:"OBE Edit Requests"}),a.jsx("div",{style:{color:"#6b7280",fontSize:14},children:"Manage pending requests for Mark Entry and Mark Manager edits from faculty"})]}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:a.jsxs("button",{className:"obe-btn obe-btn-secondary",onClick:m,disabled:e,children:[a.jsx(C2,{size:16,style:{marginRight:6}}),e?"Refreshing":"Refresh"]})})]}),r?a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:12,borderRadius:12,marginBottom:20},children:[a.jsx(yN,{size:16,style:{marginRight:8,verticalAlign:"middle"}}),r]}):null,a.jsxs("div",{style:{display:"grid",gap:18},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"Answered Now"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",g.length,")"]})]}),g.length===0?a.jsxs("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:[a.jsx(xN,{size:34,color:"#10b981",style:{marginBottom:8}}),a.jsx("div",{children:"No pending requests"})]}):a.jsx("div",{style:{display:"grid",gap:10},children:g.map(B=>{var G,H,oe;const E=!!d[B.id],P=String(((G=B.staff)==null?void 0:G.name)||((H=B.staff)==null?void 0:H.username)||"Unknown"),D=(oe=B.staff)==null?void 0:oe.department;return a.jsxs("div",{onClick:()=>h({kind:"pending",item:B}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#fff7ed",border:"1px solid #fed7aa",display:"grid",placeItems:"center",fontWeight:950,color:"#9a3412"},children:b(P)}),a.jsxs("div",{style:{flex:1,minWidth:220},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:P}),D?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",D]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[B.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:B.subject_name||B.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",B.assessment.toUpperCase(),"  ",v(B.requested_at)]})]}),a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsxs("div",{style:{background:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:800,whiteSpace:"nowrap"},children:[a.jsx(sc,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"Pending"]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},onClick:de=>de.stopPropagation(),children:[a.jsx("input",{type:"number",value:c[B.id]??120,onChange:de=>u(W=>({...W,[B.id]:Number(de.target.value)})),min:1,max:1440,style:{width:82,padding:"6px 8px",border:"1px solid #d1d5db",borderRadius:10},disabled:E,title:"Window minutes"}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>w(B.id),disabled:E,children:E?"Approving":"Approve"}),a.jsx("button",{className:"obe-btn obe-btn-danger",onClick:()=>S(B.id),disabled:E,children:E?"Rejecting":"Reject"})]})]})]},B.id)})})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"History"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",y.length,")"]})]}),y.length===0?a.jsx("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:a.jsx("div",{children:"No reviewed requests yet"})}):a.jsx("div",{style:{display:"grid",gap:10},children:y.map(B=>{var de,W,V;const E=String(((de=B.staff)==null?void 0:de.name)||((W=B.staff)==null?void 0:W.username)||"Unknown"),P=(V=B.staff)==null?void 0:V.department,D=B.status==="APPROVED",G=D?"#ecfdf5":"#fef2f2",H=D?"#065f46":"#991b1b",oe=D?"#10b98133":"#ef444433";return a.jsxs("div",{onClick:()=>h({kind:"history",item:B}),style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center",cursor:"pointer"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#f9fafb",border:"1px solid #e5e7eb",display:"grid",placeItems:"center",fontWeight:950,color:"#111827"},children:b(E)}),a.jsxs("div",{style:{flex:1,minWidth:220},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:E}),P?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[" ",P]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[B.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:B.subject_name||B.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Mark Manager  ",B.assessment.toUpperCase(),"  Reviewed ",v(B.reviewed_at)]})]}),a.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:a.jsx("div",{style:{background:G,color:H,border:`1px solid ${oe}`,padding:"4px 10px",borderRadius:999,fontSize:12,fontWeight:900,whiteSpace:"nowrap"},children:D?"Approved":"Rejected"})})]},B.id)})})]})]}),p?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:60},onClick:()=>h(null),children:a.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:16},onClick:B=>B.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Request Details"}),a.jsx("div",{style:{marginLeft:"auto"},children:a.jsx("button",{className:"obe-btn",onClick:()=>h(null),children:"Close"})})]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#f9fafb"},children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"160px 1fr",rowGap:8,columnGap:10,fontSize:13},children:[a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Status"}),a.jsx("div",{style:{color:"#111827",fontWeight:900},children:p.item.status}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Staff"}),a.jsxs("div",{style:{color:"#111827",fontWeight:900},children:[String(((j=p.item.staff)==null?void 0:j.name)||((k=p.item.staff)==null?void 0:k.username)||"Unknown"),(A=p.item.staff)!=null&&A.department?a.jsxs("span",{style:{color:"#6b7280",fontWeight:700},children:["  ",p.item.staff.department]}):null]}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Subject"}),a.jsxs("div",{style:{color:"#111827"},children:[a.jsx("span",{style:{fontWeight:900},children:p.item.subject_code}),"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:p.item.subject_name||p.item.subject_code})]}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Assessment"}),a.jsx("div",{style:{color:"#111827",fontWeight:900},children:p.item.assessment.toUpperCase()}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Requested At"}),a.jsx("div",{style:{color:"#111827"},children:v(p.item.requested_at)}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reason"}),a.jsx("div",{style:{color:"#111827",whiteSpace:"pre-wrap"},children:p.item.reason||""}),"reviewed_at"in p.item?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed At"}),a.jsx("div",{style:{color:"#111827"},children:v(p.item.reviewed_at)}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Reviewed By"}),a.jsx("div",{style:{color:"#111827"},children:String(((R=p.item.reviewed_by)==null?void 0:R.name)||((M=p.item.reviewed_by)==null?void 0:M.username)||"")}),a.jsx("div",{style:{color:"#6b7280",fontWeight:800},children:"Approved Until"}),a.jsx("div",{style:{color:"#111827"},children:v(p.item.approved_until)})]}):null]})})]})}):null]})}const Y8=[1,2,3,4,5,6,7,8],Cre=["THEORY","LAB","TCPL","TCPR","PRACTICAL","PROJECT","AUDIT","SPECIAL"],Af={THEORY:"Theory",LAB:"Lab",TCPL:"TCPL",TCPR:"TCPR",PRACTICAL:"Practical",PROJECT:"Project",AUDIT:"Audit",SPECIAL:"Special"},Ere=["ssa1","formative1","cia1","ssa2","formative2","cia2","model"],Tre=["ssa1","review1","cia1","ssa2","review2","cia2","model"],Pre=["cia1","cia2","model"],Ore=["cia1","cia2","model"],Mre=["review1","review2","model"],X8=["ssa1","formative1","cia1","ssa2","formative2","cia2"],Tu=["ssa1","review1","formative1","cia1","ssa2","review2","formative2","cia2","model"];function Q8(e){var l;const{controls:t,semesterIds:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const i=new Set(r.map(c=>Number(c))),s=new Map;for(const c of t||[]){const u=Number((l=c==null?void 0:c.semester)==null?void 0:l.id);if(!Number.isFinite(u)||!i.has(u))continue;const d=String((c==null?void 0:c.assessment)||"").trim().toLowerCase();d&&s.set(`${u}::${d}`,!!(c!=null&&c.is_open))}const o=new Set;for(const c of r)for(const u of n){const d=`${Number(c)}::${String(u).toLowerCase()}`;if(!s.has(d))o.add("ON");else{const f=!!s.get(d);o.add(f?"UNLIMITED":"OFF")}}return o.size===1?Array.from(o)[0]:"MIXED"}function Lre(e,t){if(e==="LAB")return Pre;if(e==="TCPR")return Tre;if(e==="PRACTICAL")return Ore;if(e==="PROJECT")return Mre;if(e==="SPECIAL"){const r=[];for(const o of t){const l=Array.isArray(o==null?void 0:o.enabled_assessments)?o.enabled_assessments:[];for(const c of l)r.push(String(c||"").trim().toLowerCase())}const n=F4(r).filter(Boolean);if(!n.length)return[];const i=new Set(X8),s=[];for(const o of X8)n.includes(String(o))&&s.push(o);for(const o of n)i.has(o)&&!s.includes(o)&&s.push(o);return s}return Ere}function J8(e,t){if(e==="TCPL"){if(t==="formative1")return"LAB 1";if(t==="formative2")return"LAB 2"}if(e==="LAB"){if(t==="cia1")return"CIA 1 LAB";if(t==="cia2")return"CIA 2 LAB";if(t==="model")return"MODEL LAB"}if(e==="PRACTICAL"){if(t==="cia1")return"CIA 1 Review";if(t==="cia2")return"CIA 2 Review";if(t==="model")return"MODEL Review"}return e==="PROJECT"&&t==="model"?"MODEL Review":t==="ssa1"?"SSA1":t==="ssa2"?"SSA2":t==="review1"?"Review 1":t==="review2"?"Review 2":t==="formative1"?"Formative 1":t==="formative2"?"Formative 2":t==="cia1"?"CIA 1":t==="cia2"?"CIA 2":t==="model"?"MODEL":String(t).toUpperCase()}function Rre(e){const t=String(e||"").trim().toUpperCase();return t==="THEORY"?"THEORY":t==="LAB"?"LAB":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t==="PRACTICAL"?"PRACTICAL":t==="PROJECT"?"PROJECT":t==="AUDIT"?"AUDIT":t==="SPECIAL"?"SPECIAL":"THEORY"}function Fre(e,t){const r=String(e||"").trim(),n=String(t||"").trim();return!r||!n?null:`${r}T${n}:00`}function F4(e){const t=new Set,r=[];for(const n of e)t.has(n)||(t.add(n),r.push(n));return r}function Bre(e){const{controls:t,subjectCodes:r,assessments:n}=e;if(!r.length||!n.length)return"MIXED";const i=new Map;for(const l of t||[]){const c=String(l.subject_code||"").trim(),u=String(l.assessment||"").trim().toLowerCase();!c||!u||i.set(`${c}::${u}`,{is_open:!!l.is_open,is_enabled:!!l.is_enabled})}let s=0,o=0;for(const l of r)for(const c of n){const u=`${l}::${String(c).toLowerCase()}`,d=i.get(u);(d?!!d.is_open:!0)?s+=1:o+=1}return s>0&&o>0?"MIXED":o>0?"READONLY":"EDITABLE"}function jN(){const[e,t]=x.useState([]),[r,n]=x.useState(1),[i,s]=x.useState({}),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[p,h]=x.useState([]),[m,g]=x.useState("THEORY"),[y,b]=x.useState([]),[v,w]=x.useState(""),[S,j]=x.useState(""),[k,A]=x.useState(!1),[R,M]=x.useState(null),[B,E]=x.useState(null),P=x.useCallback(re=>({padding:"8px 12px",borderRadius:8,border:re?"1px solid #10b981":"1px solid #e5e7eb",background:re?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer",whiteSpace:"nowrap"}),[]);x.useEffect(()=>{let re=!0;return(async()=>{try{const T=await h9(),I=Array.isArray(T==null?void 0:T.results)?T.results:[];if(!re)return;const ie=I.map(U=>({id:Number(U.id),number:(U==null?void 0:U.number)===null||typeof(U==null?void 0:U.number)>"u"?null:Number(U.number)})).filter(U=>Number.isFinite(U.id));ie.sort((U,Z)=>Number(U.number??9999)-Number(Z.number??9999)||U.id-Z.id),t(ie)}catch(T){if(!re)return;E((T==null?void 0:T.message)||"Failed to load semesters")}})(),()=>{re=!1}},[]);const D=x.useMemo(()=>{const re=new Map;for(const T of e){const I=T.number;typeof I=="number"&&Number.isFinite(I)&&re.set(I,T.id)}return re},[e]),G=D.get(r)??null,H=x.useMemo(()=>{const re=[];for(const T of Y8){const I=D.get(T);I&&re.push(I)}return re},[D]);x.useEffect(()=>{let re=!0;return(async()=>{try{if(!H.length)return;const T=await fx(H,Tu);if(!re)return;h(Array.isArray(T==null?void 0:T.results)?T.results:[])}catch{}})(),()=>{re=!1}},[H.join(",")]);const oe=x.useCallback(async()=>{A(!0),M(null),E(null);try{if(!G){s({}),l([]),u([]),f([]),M(`Semester ${r} is not available in the database.`);return}const[re,T,I,ie]=await Promise.all([p9([G]),L4([G]),Dv([G]),fx([G],Tu)]),U=(re==null?void 0:re.subjects_by_semester)||{},Z=Array.isArray(T==null?void 0:T.results)?T.results:[];s(U),l(Z),u(Array.isArray(I==null?void 0:I.results)?I.results:[]),f(Array.isArray(ie==null?void 0:ie.results)?ie.results:[])}catch(re){E((re==null?void 0:re.message)||"Failed to load semester data")}finally{A(!1)}},[G,r,m]);x.useEffect(()=>{oe()},[oe]);const de=x.useMemo(()=>{if(!G)return[];const re=(i==null?void 0:i[String(G)])||[];return(Array.isArray(re)?re:[]).filter(T=>T&&T.subject_code)},[i,G]),W=x.useMemo(()=>Cre.slice(),[]);x.useEffect(()=>{W.includes(m)||g(W[0]||"THEORY")},[W.join("|")]);const V=x.useMemo(()=>de.filter(re=>Rre(re==null?void 0:re.class_type)===m),[de,m]),ae=x.useMemo(()=>F4(V.map(re=>String(re.subject_code||"").trim()).filter(Boolean)),[V]),ee=x.useMemo(()=>F4(de.map(re=>String(re.subject_code||"").trim()).filter(Boolean)),[de]),C=x.useMemo(()=>Lre(m,V),[m,V]);x.useEffect(()=>{var Z;const re=C;if(!re.length){b([]);return}if(!G){b(re);return}const T=new Set(ae),I=new Map;for(const me of c||[]){const Pe=String(me.subject_code||"").trim();if(!T.has(Pe))continue;const je=String(me.assessment||"").trim().toLowerCase();je&&I.set(je,!!me.is_enabled)}const ie=new Set;for(const me of o||[])me!=null&&me.is_active&&(!((Z=me==null?void 0:me.semester)!=null&&Z.id)||Number(me.semester.id)!==Number(G)||T.has(String(me.subject_code||"").trim())&&ie.add(String(me.assessment||"").trim().toLowerCase()));const U=re.filter(me=>{const Pe=String(me).toLowerCase();return I.has(Pe)?!!I.get(Pe):ie.has(Pe)});b(U)},[G,m,c,o,C,ae]);const Y=x.useMemo(()=>Bre({controls:c,subjectCodes:ae,assessments:y}),[c,ae,y]),q=x.useMemo(()=>G?Q8({controls:d,semesterIds:[G],assessments:Tu}):"MIXED",[d,G]),O=x.useMemo(()=>H.length?Q8({controls:p,semesterIds:H,assessments:Tu}):"MIXED",[p,H.join(",")]),X=x.useCallback(async(re,T)=>{A(!0),M(null),E(null);try{const I=T==="ALL"?H:G?[G]:[];if(!I.length)throw new Error("No semester ids available for this action.");if(re==="ON"?await f9({semester_ids:I,assessments:Tu}):re==="OFF"?await O4({semester_ids:I,assessments:Tu,is_open:!1}):await O4({semester_ids:I,assessments:Tu,is_open:!0}),G){const ie=await fx([G],Tu);f(Array.isArray(ie==null?void 0:ie.results)?ie.results:[])}if(H.length){const ie=await fx(H,Tu);h(Array.isArray(ie==null?void 0:ie.results)?ie.results:[])}M(`${T==="ALL"?"All Semesters":`SEM ${r}`}: Publish set to ${re==="ON"?"On (Timed)":re==="OFF"?"Off (Locked)":"Unlimited (No Time Limit)"}.`)}catch(I){E((I==null?void 0:I.message)||"Publish toggle failed")}finally{A(!1)}},[H,G,r]),F=x.useCallback(async re=>{const T=!y.includes(re),I=y;b(ie=>T?[...ie,re]:ie.filter(U=>U!==re)),A(!0),M(null),E(null);try{if(!G)throw new Error(`Semester ${r} is not available in the database.`);if(!ae.length)throw new Error(`No courses found for SEM ${r} (${Af[m]}).`);await M4({semester_id:G,subject_codes:ae,assessments:[re],is_enabled:T}),T||await g9({semester_id:G,subject_codes:ae,assessments:[re]});const[ie,U]=await Promise.all([Dv([G]),L4([G])]);u(Array.isArray(ie==null?void 0:ie.results)?ie.results:[]),l(Array.isArray(U==null?void 0:U.results)?U.results:[]),M(`SEM ${r}  ${Af[m]}: ${J8(m,re)} ${T?"enabled":"disabled"}.`)}catch(ie){b(I),E((ie==null?void 0:ie.message)||"Update failed")}finally{A(!1)}},[y,G,r,m,ae]),Q=x.useCallback(async()=>{A(!0),M(null),E(null);try{if(!G)throw new Error(`Semester ${r} is not available in the database.`);if(!ee.length)throw new Error(`No courses found for SEM ${r}.`);if(q!=="ON")throw new Error(q==="OFF"?"Publish is OFF (Locked). Set Publish to ON to use a timer.":q==="UNLIMITED"?"Publish is UNLIMITED (No Time Limit). Set Publish to ON to use a due-date timer.":"Publish mode is MIXED. Set a single Publish mode first.");const re=Fre(v,S);if(!re)throw new Error("Select Due Date and Due Time");await m9({semester_id:G,subject_codes:ee,assessments:Tu,due_at:re}),M(`SEM ${r}: Timer applied to all class types.`),await oe()}catch(re){E((re==null?void 0:re.message)||"Save failed")}finally{A(!1)}},[G,r,ee,v,S,oe,q]),K=x.useCallback(async re=>{A(!0),M(null),E(null);try{if(!G)throw new Error(`Semester ${r} is not available in the database.`);if(!y.length)throw new Error("Select at least one exam/assessment");if(!ae.length)throw new Error(`No courses found for SEM ${r} (${Af[m]}).`);await M4({semester_id:G,subject_codes:ae,assessments:y,is_open:re});const T=await Dv([G]);u(Array.isArray(T==null?void 0:T.results)?T.results:[]),M(`SEM ${r}  ${Af[m]}: ${re?"Editable":"Read-only"}`)}catch(T){E((T==null?void 0:T.message)||"Lock toggle failed")}finally{A(!1)}},[G,r,y,m,ae]),ne=re=>{const T=re==="THIS"?q:O,I=re==="THIS"&&O==="OFF",ie=k||re==="ALL"&&!H.length||I;return a.jsxs("div",{className:`pub3${ie?" pub3--disabled":""}`,title:I?"Locked by Common Publish (Off)":void 0,children:[a.jsx("button",{className:`pub3__btn pub3__btn--off${T==="OFF"?" pub3__btn--active":""}`,onClick:()=>void X("OFF",re),disabled:ie,children:"Off"}),a.jsx("button",{className:`pub3__btn pub3__btn--on${T==="ON"?" pub3__btn--active":""}`,onClick:()=>void X("ON",re),disabled:ie,children:"On"}),a.jsx("button",{className:`pub3__btn pub3__btn--unlimited${T==="UNLIMITED"?" pub3__btn--active":""}`,onClick:()=>void X("UNLIMITED",re),disabled:ie,children:"Unlimited"})]})};return a.jsxs("main",{style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#f3f4f6"},children:[a.jsx("style",{children:`
        /*  Neon 3-state publish switch  */
        .pub3 {
          display: inline-flex;
          border-radius: 999px;
          background: #0f172a;
          padding: 4px;
          gap: 3px;
          box-shadow: 0 0 0 1px #1e293b, 0 4px 12px rgba(0,0,0,0.55);
        }
        .pub3--disabled { opacity: 0.4; pointer-events: none; }
        .pub3__btn {
          padding: 8px 18px;
          border-radius: 999px;
          border: none;
          font-weight: 900;
          font-size: 13px;
          cursor: pointer;
          background: transparent;
          color: #64748b;
          transition: background 0.35s cubic-bezier(0.65,0,0.35,1),
                      color 0.35s cubic-bezier(0.65,0,0.35,1),
                      box-shadow 0.35s cubic-bezier(0.65,0,0.35,1);
          letter-spacing: 0.02em;
          min-width: 64px;
        }
        .pub3__btn:disabled { cursor: not-allowed; }
        .pub3__btn--off.pub3__btn--active {
          background: #450a0a;
          color: #fca5a5;
          box-shadow: 0 0 6px #ef4444, 0 0 18px #ef444455, inset 0 0 8px #ef444418;
        }
        .pub3__btn--on.pub3__btn--active {
          background: #052e16;
          color: #86efac;
          box-shadow: 0 0 6px #22c55e, 0 0 18px #22c55e55, inset 0 0 8px #22c55e18;
        }
        .pub3__btn--unlimited.pub3__btn--active {
          background: #1e3a8a;
          color: #93c5fd;
          box-shadow: 0 0 6px #3b82f6, 0 0 18px #3b82f655, inset 0 0 8px #3b82f618;
        }
      `}),a.jsxs("div",{style:{padding:20,maxWidth:1100,margin:"0 auto"},children:[a.jsx("div",{className:"welcome",style:{marginBottom:18},children:a.jsxs("div",{className:"welcome-left",children:[a.jsx("h2",{className:"welcome-title",style:{fontSize:22,marginBottom:2},children:"OBE Master  Lock & Timer Controls"}),a.jsx("div",{className:"welcome-sub",children:"Common Publish  Semester  Publish & Timer  Class Type  Exams"})]})}),B&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:B}),R&&a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:12,whiteSpace:"pre-wrap"},children:R}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"16px 20px",marginBottom:16,display:"flex",alignItems:"center",gap:20,flexWrap:"wrap"},children:[a.jsxs("div",{style:{flex:"0 0 auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:14,marginBottom:4,color:"#111827"},children:"Common Publish  All Semesters"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Applies the same publish mode to every semester at once."})]}),a.jsxs("div",{style:{flex:"1 1 auto",display:"flex",alignItems:"center",gap:14,flexWrap:"wrap"},children:[ne("ALL"),a.jsx("span",{style:{fontSize:13,fontWeight:700,color:O==="OFF"?"#991b1b":O==="ON"?"#065f46":O==="UNLIMITED"?"#1e40af":"#6b7280"},children:O==="OFF"?"All Locked":O==="ON"?"All Timer-based":O==="UNLIMITED"?"All Unlimited":"Mixed"})]})]}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:14,padding:"14px 18px",marginBottom:0,borderBottomLeftRadius:0,borderBottomRightRadius:0,borderBottom:"2px solid #10b981"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:10,textTransform:"uppercase",letterSpacing:1},children:"Select Semester"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:Y8.map(re=>a.jsxs("button",{disabled:k,onClick:()=>n(re),style:P(re===r),children:["SEM ",re]},re))})]}),a.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderTop:0,borderRadius:14,borderTopLeftRadius:0,borderTopRightRadius:0,padding:"18px 20px",marginBottom:16},children:[a.jsxs("div",{style:{display:"flex",gap:18,alignItems:"center",flexWrap:"wrap",marginBottom:18,paddingBottom:16,borderBottom:"1px solid #f3f4f6"},children:[a.jsxs("div",{style:{flex:"0 0 auto"},children:[a.jsxs("div",{style:{fontWeight:900,fontSize:13,marginBottom:6,color:"#111827"},children:["Publish  SEM ",r]}),ne("THIS")]}),O==="OFF"?a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px 16px",borderRadius:10,background:"#fef2f2",border:"1px solid #fecaca",color:"#991b1b",fontWeight:800,fontSize:13},children:[a.jsx("span",{style:{fontSize:16},children:""})," Locked  Common Publish is Off"]}):q==="ON"?a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap",flex:"1 1 auto"},children:[a.jsx("input",{type:"date",value:v,onChange:re=>w(re.target.value),disabled:k,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),a.jsx("input",{type:"time",value:S,onChange:re=>j(re.target.value),disabled:k,style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",fontSize:13}}),a.jsx("button",{onClick:()=>void Q(),disabled:k,className:"obe-btn obe-btn-primary",style:{padding:"9px 16px",borderRadius:8,fontWeight:900,fontSize:13},children:k?"Saving":`Apply Timer  SEM ${r}`}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["All ",ee.length," subjects  all class types"]})]}):q==="UNLIMITED"?a.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#eff6ff",color:"#1e40af",fontWeight:800,border:"1px solid #bfdbfe",fontSize:13},children:" No Time Limit  always open"}):q==="OFF"?a.jsx("div",{style:{padding:"10px 16px",borderRadius:10,background:"#fef2f2",color:"#991b1b",fontWeight:800,border:"1px solid #fecaca",fontSize:13},children:" This semester locked"}):null]}),a.jsxs("div",{style:{marginBottom:14},children:[a.jsx("div",{style:{fontWeight:900,fontSize:12,color:"#6b7280",marginBottom:8,textTransform:"uppercase",letterSpacing:1},children:"Class Type"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:W.map(re=>a.jsx("button",{disabled:k,onClick:()=>g(re),style:P(re===m),children:Af[re]},re))}),a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:[V.length," course",V.length!==1?"s":""," in SEM ",r,"  ",Af[m]]})]}),a.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:"14px 16px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,flexWrap:"wrap",gap:8},children:[a.jsxs("div",{style:{fontWeight:900,fontSize:14,color:"#111827"},children:["SEM ",r,"  ",Af[m]," Exams"]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Mark Entry Mode:"}),a.jsxs("div",{style:{display:"inline-flex",border:"1px solid #e5e7eb",borderRadius:999,overflow:"hidden",background:"#fff"},children:[a.jsx("button",{onClick:()=>void K(!1),disabled:k||!y.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:Y==="READONLY"?"#fee2e2":"#fff",color:Y==="READONLY"?"#991b1b":"#374151",minWidth:100},children:"Read-only"}),a.jsx("button",{onClick:()=>void K(!0),disabled:k||!y.length,style:{padding:"7px 14px",fontWeight:900,border:0,cursor:"pointer",fontSize:13,background:Y==="EDITABLE"?"#dcfce7":"#fff",color:Y==="EDITABLE"?"#065f46":"#374151",minWidth:90},children:"Editable"})]})]})]}),C.length?a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10},children:C.map(re=>a.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center",fontSize:13,padding:"8px 14px",borderRadius:10,border:`2px solid ${y.includes(re)?"#10b981":"#e5e7eb"}`,background:y.includes(re)?"#ecfdf5":"#fff",color:y.includes(re)?"#065f46":"#374151",cursor:"pointer",userSelect:"none",fontWeight:700},children:[a.jsx("input",{type:"checkbox",checked:y.includes(re),onChange:()=>void F(re),disabled:k,style:{accentColor:"#10b981",width:15,height:15}}),J8(m,re)]},re))}):a.jsxs("div",{style:{color:"#6b7280",fontSize:13,padding:"8px 0"},children:["No exams configured for ",Af[m],"."]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Uncheck an exam to hide it from staff (message-only). Selected exams also control the Mark Entry Mode lever above."})]})]})]})]})}const cf="https://db.krgi.co.in";async function Yd(){const e=await mr(`${cf}/api/curriculum/master/`);if(!e.ok)throw new Error("Failed to fetch masters");return e.json()}async function Ire(e){const t=await mr(`${cf}/api/curriculum/master/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function Dre(e,t){const r=await mr(`${cf}/api/curriculum/master/${e}/`,{method:"PATCH",body:JSON.stringify(t)});try{if(!r.ok){const n=r.headers.get("content-type");if(n&&n.includes("application/json")){const i=await r.json();throw new Error(i.detail||"An error occurred")}else throw new Error(await r.text())}return r.json()}catch(n){throw console.error("Error in updateMaster:",n),n}}async function Sl(){const e=await mr(`${cf}/api/curriculum/department/`);if(!e.ok)throw new Error("Failed to fetch dept rows");return e.json()}async function kN(e){const t=await mr(`${cf}/api/curriculum/department/${encodeURIComponent(String(e))}/`);if(!t.ok)throw new Error("Failed to fetch dept row");return t.json()}async function fm(e){const t=new URLSearchParams;e!=null&&e.department_id&&t.set("department_id",String(e.department_id)),e!=null&&e.regulation&&t.set("regulation",e.regulation),e!=null&&e.semester&&t.set("semester",String(e.semester));const r=`${cf}/api/curriculum/elective/?${t.toString()}`,n=await mr(r);if(!n.ok)throw new Error("Failed to fetch electives");return n.json()}async function $re(e){const t=await mr(`${cf}/api/curriculum/elective/`,{method:"POST",body:JSON.stringify(e)});if(!t.ok)throw new Error(await t.text());return t.json()}async function Ure(e,t){const r=await mr(`${cf}/api/curriculum/department/${e}/`,{method:"PATCH",body:JSON.stringify(t)});if(!r.ok)throw new Error(await r.text());return r.json()}async function zre(e,t){const r=await mr(`${cf}/api/curriculum/department/${e}/approve/`,{method:"POST",body:JSON.stringify({action:t})});if(!r.ok)throw new Error(await r.text());return r.json()}function qg(e){return String(e||"").trim()}function Wre(){const e=bo(),[t,r]=x.useState([]),[n,i]=x.useState(!0),[s,o]=x.useState(null),[l,c]=x.useState("");x.useEffect(()=>{let f=!0;return(async()=>{try{const p=await Sl();if(!f)return;r(Array.isArray(p)?p:[]),o(null)}catch(p){if(!f)return;r([]),o((p==null?void 0:p.message)||"Failed to load courses")}finally{f&&i(!1)}})(),()=>{f=!1}},[]);const u=x.useMemo(()=>{const f=new Map;for(const p of t||[]){const h=qg(p.course_code);if(!h)continue;const m={course_code:h,course_name:qg(p.course_name),class_type:qg(p.class_type)||null,question_paper_type:qg(p.question_paper_type)||null},g=f.get(h);if(!g){f.set(h,m);continue}const y=b=>(b.course_name?1:0)+(b.class_type?1:0)+(b.question_paper_type?1:0)+(String(b.question_paper_type||"").trim().toUpperCase()&&String(b.question_paper_type||"").trim().toUpperCase()!=="QP1"?1:0);y(m)>y(g)&&f.set(h,m)}return Array.from(f.values()).sort((p,h)=>p.course_code.localeCompare(h.course_code))},[t]),d=x.useMemo(()=>{const f=qg(l).toLowerCase();return f?u.filter(p=>`${p.course_code} ${p.course_name}`.toLowerCase().includes(f)):u},[u,l]);return n?a.jsx("div",{style:{color:"#6b7280"},children:"Loading courses"}):s?a.jsx("div",{style:{color:"#b91c1c"},children:s}):a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"Courses"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Search and open a course to view sections and staff mappings."})]}),a.jsxs("div",{style:{minWidth:280},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Search"}),a.jsx("input",{value:l,onChange:f=>c(f.target.value),placeholder:"Course code or name",className:"obe-input"})]})]}),d.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No courses found."}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:12},children:d.map(f=>a.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:8},children:[a.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:f.course_code}),a.jsx("div",{style:{color:"#374151",fontWeight:700},children:f.course_name||""}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[f.class_type?`Class type: ${f.class_type}`:"",f.question_paper_type?`    QP: ${f.question_paper_type}`:""]}),a.jsx("div",{style:{marginTop:6},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>e(`/iqac/academic-controller/course/${encodeURIComponent(f.course_code)}`),children:"Open"})})]},f.course_code))})]})}function qre(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const W0=qre(),T2="obe_assessment_master_config_cache";async function q0(e,t){const r=e.headers.get("content-type")||"";try{if(r.includes("application/json")){const s=await e.json(),o=(s==null?void 0:s.detail)||(s==null?void 0:s.message);if(o)return`${t}: ${o}`}}catch{}if(e.status===401)return`${t}: Authentication required. Please login.`;if(e.status===403)return`${t}: Permission required.`;if(e.status===404)return`${t}: No CDAP found for this course yet. Upload the Excel to create one.`;let n="";try{n=await e.text()}catch{}const i=(n||"").trim();return i&&!i.startsWith("<")?`${t}: ${i}`:`${t}: Server returned ${e.status}.`}async function I9(e,t){const r=typeof t=="number"?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${W0}/api/obe/cdap-revision/${encodeURIComponent(e)}${r}`,i=await mr(n,{method:"GET"});if(!i.ok){const s=await q0(i,"CDAP revision fetch failed");throw new Error(s)}return i.json()}async function B4(e,t){const r=typeof t=="number"?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",n=`${W0}/api/obe/articulation-matrix/${encodeURIComponent(e)}${r}`,i=await mr(n,{method:"GET"});if(!i.ok){const s=await q0(i,"Articulation Matrix fetch failed");throw new Error(s)}return i.json()}async function D9(e){const t=(e==null?void 0:e.subjectId)||(e==null?void 0:e.subject_id);if(!t)throw new Error("subjectId is required to save CDAP revision");const r=e==null?void 0:e.teaching_assignment_id,n=typeof r=="number"?`?teaching_assignment_id=${encodeURIComponent(String(r))}`:"",i=`${W0}/api/obe/cdap-revision/${encodeURIComponent(t)}${n}`,s=await mr(i,{method:"PUT",body:JSON.stringify(e)});if(!s.ok){const o=await q0(s,"CDAP revision save failed");throw new Error(o)}return s.json()}async function AN(){const e=`${W0}/api/obe/active-learning-mapping`,t=await mr(e,{method:"GET"});if(!t.ok){try{const i=window.localStorage.getItem(T2);if(i){const s=JSON.parse(i);if(s&&typeof s=="object")return s}}catch{}const n=await q0(t,"Active learning mapping fetch failed");throw new Error(n)}const r=await t.json();return(r==null?void 0:r.mapping)||{}}async function $9(e){const t=`${W0}/api/obe/active-learning-mapping`,r=await mr(t,{method:"PUT",body:JSON.stringify({mapping:e})});if(!r.ok){const i=await q0(r,"Active learning mapping save failed");throw new Error(i)}const n=await r.json();return(n==null?void 0:n.mapping)||{}}async function oc(){const e=`${W0}/api/obe/assessment-master-config`,t=await mr(e,{method:"GET"});if(!t.ok){try{const s=window.localStorage.getItem(T2);if(s){const o=JSON.parse(s);if(o&&typeof o=="object")return o}}catch{}const i=await q0(t,"Assessment master config fetch failed");throw new Error(i)}const r=await t.json(),n=(r==null?void 0:r.config)||{};try{window.localStorage.setItem(T2,JSON.stringify(n))}catch{}return n}async function U9(e){const t=`${W0}/api/obe/assessment-master-config`,r=await mr(t,{method:"PUT",body:JSON.stringify({config:e})});if(!r.ok){const s=await q0(r,"Assessment master config save failed");throw new Error(s)}const n=await r.json(),i=(n==null?void 0:n.config)||{};try{window.localStorage.setItem(T2,JSON.stringify(i))}catch{}return i}function Hre(e,t=3e4){const r=window.setInterval(()=>e(),t);return()=>window.clearInterval(r)}function Vre(){var q;const e=x.useMemo(()=>[{key:"THEORY_QP1",label:"Theory QP 1",class_type:"THEORY",question_paper_type:"QP1"},{key:"THEORY_QP2",label:"Theory QP 2",class_type:"THEORY",question_paper_type:"QP2"},{key:"TCPR",label:"TCPR",class_type:"TCPR"},{key:"TCPL",label:"TCPL",class_type:"TCPL"},{key:"LAB",label:"LAB",class_type:"LAB"}],[]),[t,r]=x.useState(((q=e[0])==null?void 0:q.key)||""),n=x.useMemo(()=>e.find(O=>O.key===t)||null,[e,t]),[i,s]=x.useState("CIA1"),o=(n==null?void 0:n.class_type)==="TCPR"||(n==null?void 0:n.class_type)==="TCPL",[l,c]=x.useState("review1"),[u,d]=x.useState({}),[f,p]=x.useState(!1),[h,m]=x.useState(!1),[g,y]=x.useState(null),[b,v]=x.useState(null),[w,S]=x.useState([]),[j,k]=x.useState(null),[A,R]=x.useState(null),[M,B]=x.useState(!1),[E,P]=x.useState(!1),[D,G]=x.useState(null),H=x.useMemo(()=>{const O=(n==null?void 0:n.class_type)||"THEORY",X=(n==null?void 0:n.question_paper_type)||null;return{class_type:O,question_paper_type:X,exam:i}},[n,i]);x.useEffect(()=>{let O=!1;async function X(){var F,Q;k(null),R(null),B(!0),G(null);try{const K=await sh(H);if(O)return;const ne=Array.isArray((F=K==null?void 0:K.pattern)==null?void 0:F.marks)?K.pattern.marks:[],re=Array.isArray((Q=K==null?void 0:K.pattern)==null?void 0:Q.cos)?K.pattern.cos:[],T=ne.map((I,ie)=>({marks:String(I),co:re[ie]==null?"":String(re[ie])}));S(T),G((K==null?void 0:K.updated_at)??null)}catch(K){if(O)return;R(String((K==null?void 0:K.message)||K||"Failed to load pattern.")),S([])}finally{O||B(!1)}}return X(),()=>{O=!0}},[H]),x.useEffect(()=>{let O=!1;if(o)return(async()=>{p(!0),y(null),v(null);try{const X=await oc();if(O)return;const F=X==null?void 0:X.review_config;d(F&&typeof F=="object"?F:{})}catch(X){if(O)return;v(String((X==null?void 0:X.message)||X||"Failed to load review config."))}finally{O||p(!1)}})(),()=>{O=!0}},[o,n==null?void 0:n.class_type]);const oe=x.useMemo(()=>{const O=n==null?void 0:n.class_type,F=O&&(u||{})[O]||{};return F&&F[l]||{}},[u,n==null?void 0:n.class_type,l]),de=O=>{const X=n==null?void 0:n.class_type;if(!X)return;const F=O===""?void 0:Number(O);d(Q=>{const K={...Q||{}},ne={...K[X]||{}},re={...ne[l]||{}};return re.cia_max=Number.isFinite(F)?Math.max(0,Math.trunc(F)):void 0,ne[l]=re,K[X]=ne,K})},W=async()=>{y(null),v(null);try{m(!0);const X={...await oc()||{},review_config:u||{}};await U9(X),y("Review config saved.")}catch(O){v(String((O==null?void 0:O.message)||O||"Save failed."))}finally{m(!1)}},V=()=>{S(O=>[...O,{marks:"",co:i==="CIA2"?"3":"1"}])},ae=O=>{S(X=>X.filter((F,Q)=>Q!==O))},ee=(O,X)=>{S(F=>{const Q=[...F],K=Q[O]||{marks:"",co:""};return Q[O]={...K,marks:X},Q})},C=(O,X)=>{S(F=>{const Q=[...F],K=Q[O]||{marks:"",co:""};return Q[O]={...K,co:X},Q})},Y=async()=>{k(null),R(null);try{const O=w.map(ne=>({marks:String(ne.marks??"").trim(),co:String((ne==null?void 0:ne.co)??"").trim()}));if(O.length&&O.some(ne=>!ne.marks||!ne.co)){R("Enter marks and CO for all rows (or delete empty rows).");return}for(const ne of O){const re=Number(ne.marks);if(!Number.isFinite(re)||re<0){R("Marks must be a non-negative number.");return}}const X=ne=>{const re=String(ne||"").trim();if(!re)return"";if(re==="both")return"both";if(re==="1&2")return 12;if(re==="3&4")return 34;const T=Number(re);return Number.isFinite(T)?Math.trunc(T):""};P(!0);const F=O.map(ne=>Number(ne.marks)),Q=O.map(ne=>X(ne.co)).filter(ne=>ne!=="");if(Q.length!==F.length){R("CO values must be valid for all rows.");return}const K=await y9({class_type:H.class_type,question_paper_type:H.question_paper_type,exam:H.exam,pattern:{marks:F,cos:Q}});G((K==null?void 0:K.updated_at)??null),k("Saved.")}catch(O){R((O==null?void 0:O.message)||"Save failed.")}finally{P(!1)}};return a.jsxs("div",{children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#0f172a"},children:"QP"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Select the QP/class type option."})]}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:e.map(O=>{const X=O.key===t;return a.jsx("button",{onClick:()=>r(O.key),className:X?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:O.label},O.key)})}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:["CIA1","CIA2","MODEL"].map(O=>{const X=i===O;return a.jsx("button",{onClick:()=>s(O),className:X?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",type:"button",children:O==="CIA1"?"CIA 1":O==="CIA2"?"CIA 2":"MODEL"},O)})}),n?a.jsxs("div",{className:"obe-card",style:{padding:12},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:800,marginBottom:6},children:"Selected"}),a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:n.label}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#374151"},children:["Class type: ",a.jsx("strong",{children:n.class_type}),n.question_paper_type?a.jsxs(a.Fragment,{children:[" "," QP: ",a.jsx("strong",{children:n.question_paper_type})]}):null," "," Exam: ",a.jsx("strong",{children:i==="CIA1"?"CIA 1":i==="CIA2"?"CIA 2":"MODEL"})]}),M?a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Loading saved pattern"}):D?a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:["Last saved: ",new Date(D).toLocaleString()]}):null]}):null,a.jsxs("div",{className:"obe-card",style:{padding:12,marginTop:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"baseline",flexWrap:"wrap",marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:"QP Pattern"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[i==="CIA1"?"CIA 1":i==="CIA2"?"CIA 2":"MODEL","  ",(n==null?void 0:n.label)||t]})]}),A?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:A}):null,j?a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:10},children:j}):null,a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"S.No"}),a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"Marks"}),a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#6b7280",padding:"8px 6px",borderBottom:"1px solid #e5e7eb"},children:"CO"}),a.jsx("th",{style:{width:120,borderBottom:"1px solid #e5e7eb"}})]})}),a.jsx("tbody",{children:w.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,style:{padding:10,color:"#6b7280"},children:"No questions yet. Click + to add."})}):w.map((O,X)=>a.jsxs("tr",{children:[a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6",fontWeight:800},children:X+1}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsx("input",{className:"obe-input",type:"number",min:0,step:"0.5",value:O.marks,onChange:F=>ee(X,F.target.value),placeholder:"Marks",style:{maxWidth:160}})}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsxs("select",{className:"obe-input",value:String((O==null?void 0:O.co)??""),onChange:F=>C(X,F.target.value),style:{maxWidth:160},children:[a.jsx("option",{value:"",children:"Select"}),i==="MODEL"?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"})]}):i==="CIA2"?a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"3&4",children:"3&4"})]}):a.jsxs(a.Fragment,{children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"1&2",children:"1&2"})]})]})}),a.jsx("td",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:a.jsx("button",{type:"button",className:"obe-btn obe-btn-danger",onClick:()=>ae(X),children:"Delete"})})]},X))})]})}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginTop:12},children:[a.jsx("button",{type:"button",className:"obe-btn obe-btn-secondary",onClick:V,children:"+"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",onClick:Y,disabled:E,children:E?"Saving":"Save"})]})]}),o?a.jsxs("div",{className:"obe-card",style:{padding:12,marginTop:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,alignItems:"baseline",flexWrap:"wrap",marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:"Review Config"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[(n==null?void 0:n.label)||t,"  ",l==="review1"?"Review 1":"Review 2"]})]}),b?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:b}):null,g?a.jsx("div",{style:{background:"#ecfdf5",border:"1px solid #10b98133",color:"#065f46",padding:10,borderRadius:10,marginBottom:10},children:g}):null,a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:800,marginBottom:6},children:"Exam type"}),a.jsxs("select",{className:"obe-input",value:l,onChange:O=>c(O.target.value),style:{minWidth:160},children:[a.jsx("option",{value:"review1",children:"Review 1"}),a.jsx("option",{value:"review2",children:"Review 2"})]})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:800,marginBottom:6},children:"CIA exam max marks"}),a.jsx("input",{className:"obe-input",type:"number",min:0,step:1,value:String((oe==null?void 0:oe.cia_max)??""),onChange:O=>de(O.target.value),placeholder:"e.g. 40",style:{maxWidth:160},disabled:f})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{type:"button",className:"obe-btn obe-btn-secondary",onClick:()=>{y(null),v(null)},disabled:h,children:"Clear message"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",onClick:W,disabled:h||f,children:h?"Saving":"Save Review Config"})]})]})]}):null]})}const Jp=["Theory","Lab","Tcpl","Tcpr","Practical","Project","Audit","Special"];function ti(e){return String(e??"").trim().toUpperCase()}function NN(e){const t=ti(e);return t?!!(t==="LAB"||t==="L"||t.startsWith("LAB")||t.includes("LAB")||t.includes("PRACTICAL")||t.includes("PRACT")):!1}function Gre(e){return ti(e)==="SPECIAL"}function Qn(e){try{const t=window.localStorage.getItem(e);return t?JSON.parse(t):null}catch{return null}}function Gn(e,t){try{window.localStorage.setItem(e,JSON.stringify(t))}catch{}}function Pu(e){try{window.localStorage.removeItem(e)}catch{}}const Wu=[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],Kre=["THEORY","TCPR","TCPL","LAB","AUDIT","PRACTICAL","SPECIAL"],V5=6,Yre=64;function Xre(e){const t=ti(e);return t==="THEORY"?"Theory":t==="TCPL"?"TCPL":t==="TCPR"?"TCPR":t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""}function z9(e){const t=Array.isArray(e)?[...e]:[...Wu];for(;t.length<17;)t.push("");return t.slice(0,17)}function Z8(e,t,r,n){const i=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(i)||i<=0||!c)return[0,0,0];const u=Math.round(i*(s||0)/c*100)/100,d=Math.round(i*(o||0)/c*100)/100,f=Math.round(i*(l||0)/c*100)/100;return[u,d,f]}function G5(e,t){let r=Array.isArray(e)?[...e]:[...Wu];if(r.length===13){const[n,i,s]=Z8(r[0]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5),[o,l,c]=Z8(r[1]??0,(t==null?void 0:t.ssa1)??1.5,(t==null?void 0:t.cia1)??3,(t==null?void 0:t.formative1)??2.5);r=[n,i,s,o,l,c,...r.slice(2)]}return r=z9(r),r}function Qre(e){const t=ti(e);if(t==="LAB"||t==="PRACTICAL")return[{header:"CO1",cols:[{label:"CIA 1",index:1}]},{header:"CO2",cols:[{label:"CIA 1",index:4}]},{header:"CO3",cols:[{label:"CIA 2",index:7}]},{header:"CO4",cols:[{label:"CIA 2",index:10}]},{header:"ME",cols:[{label:"MODEL",index:16}]}];const r=o=>t==="TCPR"?o===1||o===2?"Review 1":"Review 2":t==="TCPL"?o===1||o===2?"LAB 1":"LAB 2":o===1||o===2?"Formative 1":"Formative 2",n=o=>o===1||o===2?"CIA 1":"CIA 2",i=o=>o===1||o===2?"SSA 1":"SSA 2",s=(o,l)=>({header:`CO${o}`,cols:[{label:i(o),index:l},{label:n(o),index:l+1},{label:r(o),index:l+2}]});return[s(1,0),s(2,3),s(3,6),s(4,9),{header:"ME",cols:[{label:"CO1",index:12},{label:"CO2",index:13},{label:"CO3",index:14},{label:"CO4",index:15},{label:"CO5",index:16}]}]}function Jre(){const[e,t]=x.useState({}),[r,n]=x.useState(!1),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(null);x.useEffect(()=>{n(!0),l(null),(async()=>{const h=()=>{const g={};for(const y of Jp){const b=ti(String(y));let v=1.5,w=3,S=2.5;b==="TCPL"?(v=1,w=3.25,S=3.5):b==="TCPR"?(v=1,w=3.25,S=4):b==="LAB"&&(v=1,w=1,S=1);let j=[...Wu];if(b==="THEORY")j=[...Wu];else if(b==="TCPL"){j=[];for(let k=0;k<4;k++)j.push(v,w,S);j.push(3,3,3,3,7)}else if(b==="TCPR"){j=[];for(let k=0;k<4;k++)j.push(v,w,S);j.push(3,3,3,3,10)}g[b]={ssa1:v,cia1:w,formative1:S,internal_mark_weights:j}}return g.THEORY||(g.THEORY={ssa1:1.5,cia1:3,formative1:2.5,internal_mark_weights:[...Wu]}),g},m=g=>{const y=h();if(!g||typeof g!="object")return y;const b={...y},v=Array.from(new Set([...Jp.map(S=>ti(String(S))),"THEORY"])),w=g.THEORY??g.Theory??g.theory??null;w&&typeof w=="object"&&(g.THEORY=w);for(const S of v){const j=g[S]??g[String(S)]??g[String(S).toUpperCase()]??null;if(!j||typeof j!="object")continue;const k=Array.isArray(j.internal_mark_weights)?j.internal_mark_weights:null,A={ssa1:j.ssa1??b[S].ssa1,cia1:j.cia1??b[S].cia1,formative1:j.formative1??b[S].formative1};b[S]={ssa1:A.ssa1,cia1:A.cia1,formative1:A.formative1,internal_mark_weights:G5(k&&k.length?k:b[S].internal_mark_weights,A)}}return b};try{const y=await(await um(()=>Promise.resolve().then(()=>K8),void 0)).fetchClassTypeWeights(),b=m(y);t(b);return}catch{}try{const g=Qn("iqac_class_type_weights"),y=m(g);t(y)}catch{const g=h();t(g)}finally{n(!1)}})().finally(()=>n(!1))},[]);const d=(h,m,g)=>{t(y=>({...y,[h]:{...y[h],[m]:g}}))},f=(h,m,g)=>{t(y=>{const b=y[h]||{ssa1:"",cia1:"",formative1:"",internal_mark_weights:[...Wu]},v=Array.isArray(b.internal_mark_weights)?[...b.internal_mark_weights]:[...Wu];for(;v.length<17;)v.push("");return v[m]=g,{...y,[h]:{...b,internal_mark_weights:v}}})},p=async()=>{s(!0),l(null),u(null);try{const h={},m=Array.from(new Set([...Jp.map(y=>ti(String(y))),"THEORY"]));for(const y of m){const b=e[y]??e[y.toLowerCase()]??e[y.toUpperCase()]??{},v=G5(Array.isArray(b==null?void 0:b.internal_mark_weights)?b.internal_mark_weights:Wu,{ssa1:b==null?void 0:b.ssa1,cia1:b==null?void 0:b.cia1,formative1:b==null?void 0:b.formative1});h[y]={ssa1:Number(b==null?void 0:b.ssa1)||0,cia1:Number(b==null?void 0:b.cia1)||0,formative1:Number(b==null?void 0:b.formative1)||0,internal_mark_weights:z9(v).map((w,S)=>{const j=Number(w);return Number.isFinite(j)?j:Wu[S]??0})}}h.THEORY||(h.THEORY=h.THEORY||null);let g=!1;try{await(await um(()=>Promise.resolve().then(()=>K8),void 0)).upsertClassTypeWeights(h),g=!0}catch{Gn("iqac_class_type_weights",h)}t(h),u(g?"Weights saved to server successfully.":"Saved locally (backend not reachable).")}catch(h){l((h==null?void 0:h.message)||"Failed to save weights")}finally{s(!1)}};return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:24},children:[a.jsx("h2",{children:"Class Type Weights"}),a.jsx("p",{children:"Set the weights for each class type. These weights are IQAC-controlled and are not editable by staff."}),r?a.jsx("div",{children:"Loading..."}):a.jsxs("form",{onSubmit:h=>{h.preventDefault(),p()},children:[a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"CO Attainment Weights"}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Used in CO Attainment (SSA/CIA/Formative blend)."})]}),a.jsx("div",{style:{overflowX:"auto",marginBottom:24},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Class Type"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"SSA1"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"CIA1"}),a.jsx("th",{style:{border:"1px solid #ccc",padding:8},children:"Formative1"})]})}),a.jsx("tbody",{children:Jp.map(h=>{var y,b,v;const m=ti(String(h)),g=String(h).charAt(0).toUpperCase()+String(h).slice(1);return a.jsxs("tr",{children:[a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:g}),a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:a.jsx("input",{type:"number",step:"0.1",value:((y=e[m])==null?void 0:y.ssa1)??"",onChange:w=>d(m,"ssa1",w.target.value),required:!0})}),a.jsx("td",{style:{border:"1px solid #ccc",padding:8},children:a.jsx("input",{type:"number",step:"0.1",value:((b=e[m])==null?void 0:b.cia1)??"",onChange:w=>d(m,"cia1",w.target.value),required:!0})}),a.jsxs("td",{style:{border:"1px solid #ccc",padding:8},children:[a.jsx("input",{type:"number",step:"0.1",value:((v=e[m])==null?void 0:v.formative1)??"",onChange:w=>d(m,"formative1",w.target.value),required:!0}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:m==="TCPL"?"Lab":m==="TCPR"?"Review":"Formative"})]})]},m)})})]})}),a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Internal Mark Weightage"}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Inputs are mapped exactly to class-type exam assignments used in Internal Mark calculation."})]}),a.jsx("div",{style:{marginBottom:24},children:Kre.map(h=>{const m=ti(String(h)),g=e[m],y=G5(Array.isArray(g==null?void 0:g.internal_mark_weights)?g.internal_mark_weights:Wu,g),b=Qre(m),v=b.flatMap(w=>w.cols);return a.jsxs("div",{style:{marginBottom:18,overflowX:"auto"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:8},children:Xre(m)}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:b.map(w=>a.jsx("th",{colSpan:w.cols.length,style:{border:"1px solid #ccc",padding:V5,textAlign:"center",whiteSpace:"nowrap",fontSize:13},children:w.header},w.header))}),a.jsx("tr",{children:v.map(w=>a.jsx("th",{style:{border:"1px solid #ccc",padding:V5,textAlign:"center",whiteSpace:"nowrap",fontSize:12},children:w.label},`${w.label}_${w.index}`))})]}),a.jsx("tbody",{children:a.jsx("tr",{children:v.map(w=>a.jsx("td",{style:{border:"1px solid #ccc",padding:V5,textAlign:"center"},children:a.jsx("input",{type:"number",step:"0.1",value:y[w.index]??"",onChange:S=>f(m,w.index,S.target.value),required:!0,style:{width:Yre}})},w.index))})})]})]},m)})}),a.jsx("button",{type:"submit",disabled:i,style:{padding:"8px 18px",fontWeight:700},children:i?"Saving...":"Save"}),o&&a.jsx("div",{style:{color:"red",marginTop:12},children:o}),c&&a.jsx("div",{style:{color:"green",marginTop:12},children:c})]})]})}const K5=[{id:"cia1_co1_co2",label:"CIA 1",cos:["CO1","CO2"],assessment:"cia1"},{id:"cia2_co3_co4",label:"CIA 2",cos:["CO3","CO4"],assessment:"cia2"},{id:"model_co1_co2_co3_co4_co5",label:"MODEL",cos:["CO1","CO2","CO3","CO4","CO5"],assessment:"model"},{id:"model_co3_co4_co5",label:"MODEL",cos:["CO3","CO4","CO5"],assessment:"model"},{id:"model_co5",label:"MODEL",cos:["CO5"],assessment:"model"}];function eP(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?"cia1_co1_co2":t==="cia2_co3_co4"?"cia2_co3_co4":t==="model_co1_co2_co3_co4_co5"?"model_co1_co2_co3_co4_co5":t==="model_co3_co4_co5"?"model_co3_co4_co5":t==="model_co5"?"model_co5":null}function Y5(e){const t=new Set,r={cia1_co1_co2:"CIA 1",cia2_co3_co4:"CIA 2",model_co1_co2_co3_co4_co5:"MODEL",model_co3_co4_co5:"MODEL",model_co5:"MODEL"},n=Array.isArray(e)?e:[];for(const i of n){if(typeof i=="string"){const s=eP(i);s&&t.add(s);continue}if(i&&typeof i=="object"){const s=eP(i.id);if(!s)continue;t.add(s);const o=String(i.name||"").trim();o&&(r[s]=o)}}return{selected:t,names:r}}function Zre({isOpen:e,onClose:t,onSave:r,currentSelection:n}){const i=Y5(n.options),[s,o]=x.useState(i.selected),[l,c]=x.useState(i.names),[u,d]=x.useState(Number(n.divider)||2),[f,p]=x.useState(Number(n.multiplier)||.15),[h,m]=x.useState("");x.useEffect(()=>{const v=Y5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),p(Number(n.multiplier)||.15),m("")},[n,e]);const g=v=>{const w=new Set(s);if(w.has(v))w.delete(v),o(w),m("");else{const S=K5.find(j=>j.id===v);if(S){const j=new Set;w.forEach(R=>{const M=K5.find(B=>B.id===R);M&&M.cos.forEach(B=>j.add(B))});const A=S.cos.filter(R=>j.has(R));if(A.length>0){m(`Cannot select this option: ${A.join(", ")} already selected in another option. Only one option per CO is allowed.`);return}w.add(v),o(w),m("")}}},y=()=>{const v=Number(u),w=Number(f);if(!Number.isFinite(v)||v<=0){m("Divider must be a number greater than 0.");return}if(!Number.isFinite(w)||w<0){m("Multiplier must be a number greater than or equal to 0.");return}m("");const S=Array.from(s).map(j=>({id:j,name:String((l==null?void 0:l[j])||"").trim()||void 0}));r({options:S,divider:v,multiplier:w}),t()},b=()=>{m("");const v=Y5(n.options);o(v.selected),c(v.names),d(Number(n.divider)||2),p(Number(n.multiplier)||.15),t()};return e?a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:b,children:a.jsxs("div",{style:{backgroundColor:"white",borderRadius:12,padding:24,maxWidth:500,width:"90%",maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)"},onClick:v=>v.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[a.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:"CQI Editor"}),a.jsx("button",{onClick:b,style:{background:"transparent",border:"none",fontSize:24,cursor:"pointer",color:"#64748b",padding:0,width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center"},title:"Close",children:""})]}),a.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:20},children:"Select when to show the CQI buttons. Multiple options can be selected as long as COs don't overlap."}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginBottom:16},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL<58 Divider"}),a.jsx("input",{type:"number",value:String(u),onChange:v=>d(Number(v.target.value)),className:"obe-input",min:.1,step:.1})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"TOTAL58 Multiplier"}),a.jsx("input",{type:"number",value:String(f),onChange:v=>p(Number(v.target.value)),className:"obe-input",min:0,step:.01})]})]}),h&&a.jsx("div",{style:{padding:12,marginBottom:16,backgroundColor:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,color:"#b91c1c",fontSize:13},children:h}),a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12,marginBottom:24},children:K5.map(v=>a.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:12,padding:16,border:"2px solid",borderColor:s.has(v.id)?"#3b82f6":"#e2e8f0",borderRadius:8,cursor:"pointer",backgroundColor:s.has(v.id)?"#eff6ff":"white",transition:"all 0.2s"},children:[a.jsx("input",{type:"checkbox",checked:s.has(v.id),onChange:()=>g(v.id),style:{marginTop:3,width:18,height:18,cursor:"pointer"}}),a.jsxs("div",{style:{flex:1},children:[a.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",gap:12,marginBottom:6},children:[a.jsxs("div",{style:{fontWeight:600,color:"#0f172a"},children:[v.label," - ",v.cos.join(" and ")]}),a.jsxs("div",{style:{minWidth:190},children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Display name"}),a.jsx("input",{type:"text",value:String((l==null?void 0:l[v.id])||v.label),onChange:w=>{const S=String(w.target.value||"");c(j=>({...j,[v.id]:S}))},className:"obe-input",style:{padding:8},placeholder:v.label})]})]}),a.jsxs("div",{style:{fontSize:13,color:"#64748b"},children:["Show CQI button after ",v.label," exam"]})]})]},v.id))}),a.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end"},children:[a.jsx("button",{onClick:b,className:"obe-btn",style:{minWidth:80},children:"Cancel"}),a.jsx("button",{onClick:y,className:"obe-btn obe-btn-primary",style:{minWidth:80},children:"Save"})]})]})}):null}function ene(){const e={options:[],divider:2,multiplier:.15},[t,r]=x.useState(!1),[n,i]=x.useState(e),[s,o]=x.useState(!1);x.useEffect(()=>{let c=!0;return o(!0),bS().then(u=>{c&&i({options:Array.isArray(u.options)?u.options:[],divider:Number.isFinite(Number(u.divider))?Number(u.divider):2,multiplier:Number.isFinite(Number(u.multiplier))?Number(u.multiplier):.15})}).catch(()=>{}).finally(()=>{c&&o(!1)}),()=>{c=!1}},[]);const l=async c=>{i(c);try{await b9({options:Array.isArray(c.options)?c.options:[],divider:c.divider,multiplier:c.multiplier}),window.alert("CQI configuration saved.")}catch{window.alert("Failed to save CQI configuration.")}};return a.jsxs("div",{style:{padding:18},children:[a.jsx("h3",{style:{marginTop:0},children:"CQI Editor"}),a.jsx("div",{style:{color:"#6b7280",marginBottom:12},children:"Edit global CQI defaults for courses."}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>r(!0),disabled:s,children:s?"Loading":"Open CQI Editor"})}),a.jsx(Zre,{isOpen:t,onClose:()=>r(!1),onSave:l,currentSelection:n})]})}function Fc(e){return String(e??"").toLowerCase().replace(/[^a-z0-9]+/g,"").trim()}function tne(){return{}}const Bm=["Technical magazine","Journal paper reading","Real time problems","Case study","Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition","Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment","Active Projects","Journal Preparation"],Mp=Array.from({length:11},(e,t)=>`PO${t+1}`);function rne(){const e={};for(const t of Bm)e[Fc(t)]=Array(Mp.length).fill(!1);return e}function nne(){const[e,t]=x.useState(rne),[r,n]=x.useState(!0),[i,s]=x.useState(!1),[o,l]=x.useState(null);x.useEffect(()=>{let d=!0;return n(!0),AN().then(f=>{d&&t(p=>{const h={...p};for(const m of Bm){const g=Fc(m),y=f==null?void 0:f[g];Array.isArray(y)&&y.length===Mp.length&&(h[g]=y)}return h})}).catch(()=>{}).finally(()=>{d&&n(!1)}),()=>{d=!1}},[]);function c(d,f){const p=Fc(d);t(h=>{const m=h[p]?[...h[p]]:Array(Mp.length).fill(!1);return m[f]=!m[f],{...h,[p]:m}}),l(null)}async function u(){s(!0),l(null);try{await $9(e),l(" Saved  changes are now active for all courses.")}catch(d){l(`Save failed: ${(d==null?void 0:d.message)||"Unknown error"}`)}finally{s(!1)}}return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0},children:"Active Learning  PO Mapping (Global)"}),a.jsxs("p",{style:{color:"#6b7280",marginTop:4,marginBottom:0,fontSize:13},children:["For each active-learning activity, tick which POs it contributes to. These settings apply to"," ",a.jsx("strong",{children:"all courses"})," immediately after saving."]})]}),a.jsx("button",{onClick:u,disabled:i||r,style:{padding:"8px 18px",borderRadius:8,background:i||r?"#d1fae5":"#10b981",color:"#fff",border:"none",fontWeight:700,cursor:i||r?"default":"pointer",whiteSpace:"nowrap"},children:i?"Saving":"Save Global Mapping"})]}),o&&a.jsx("div",{style:{marginBottom:10,padding:"8px 12px",borderRadius:6,background:o.startsWith("")?"#ecfdf5":"#fef2f2",color:o.startsWith("")?"#065f46":"#991b1b",fontSize:13},children:o}),r?a.jsx("div",{style:{color:"#6b7280",padding:16},children:"Loading global mapping"}):a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",fontSize:13,minWidth:700,width:"100%"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:"8px 10px",border:"1px solid #e5e7eb",minWidth:220},children:"Active Learning Activity"}),Mp.map(d=>a.jsx("th",{style:{padding:"6px 8px",border:"1px solid #e5e7eb",textAlign:"center",minWidth:46},children:d},d))]})}),a.jsx("tbody",{children:Bm.map((d,f)=>{const p=Fc(d),h=e[p]??Array(Mp.length).fill(!1);return a.jsxs("tr",{style:{background:f%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{padding:"7px 10px",border:"1px solid #e5e7eb",fontWeight:500},children:d}),Mp.map((m,g)=>a.jsx("td",{style:{padding:"4px",border:"1px solid #e5e7eb",textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!h[g],onChange:()=>c(d,g),style:{cursor:"pointer",width:16,height:16}})},g))]},d)})})]})})]})}function ine(){const e=hl(),t=bo(),n=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"dashboard",[i,s]=x.useState(n);x.useEffect(()=>{const l=new URLSearchParams(e.search).get("tab");l&&l!==i&&s(l)},[e.search]);const o=[{key:"dashboard",label:"Dashboard"},{key:"weights",label:"Weights"},{key:"active_learning",label:"Active Learning Mapping"},{key:"due_dates",label:"OBE Due Dates"},{key:"courses",label:"Courses"},{key:"qp",label:"QP"},{key:"cqi",label:"CQI Editor"}];return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic Controller"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"IQAC tools for OBE oversight."})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18,flexWrap:"wrap"},children:o.map(l=>a.jsx("button",{onClick:()=>{s(l.key),t(`/iqac/academic-controller?tab=${encodeURIComponent(l.key)}`)},style:{padding:"8px 12px",borderRadius:8,border:i===l.key?"1px solid #10b981":"1px solid #e5e7eb",background:i===l.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:l.label},l.key))}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[i==="dashboard"&&a.jsx("div",{style:{color:"#6b7280"},children:"Dashboard coming soon."}),i==="weights"&&a.jsx(Jre,{}),i==="active_learning"&&a.jsx(nne,{}),i==="due_dates"&&a.jsx(jN,{}),i==="courses"&&a.jsx(Wre,{}),i==="qp"&&a.jsx(Vre,{}),i==="cqi"&&a.jsx(ene,{})]})]})}const ane="https://db.krgi.co.in",sne=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":ane;async function P2(e){const t=encodeURIComponent(String(e||"").trim()),r=await mr(`${sne}/api/academics/iqac/course-teaching/${t}/`);if(!r.ok)throw new Error("Failed to fetch course teaching map");const n=await r.json();if(Array.isArray(n))return n;const i=n==null?void 0:n.results;return Array.isArray(i)?i:[]}function O2(e,t){const r=String(t||"").trim().toLowerCase(),n=String(e||"").trim();!n||!r||(Pu(`marks_${n}_${r}`),r==="ssa1"&&Pu(`ssa1_sheet_${n}`),r==="review1"&&Pu(`review1_sheet_${n}`),r==="ssa2"&&Pu(`ssa2_sheet_${n}`),r==="review2"&&Pu(`review2_sheet_${n}`),r==="formative1"&&Pu(`formative1_sheet_${n}`),r==="formative2"&&Pu(`formative2_sheet_${n}`),r==="cia1"&&Pu(`cia1_sheet_${n}`),r==="cia2"&&Pu(`cia2_sheet_${n}`),r==="model"&&Pu(`model_sheet_${n}`))}function one(){var m;const{courseCode:e}=U0(),t=bo(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),[n,i]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(!0),[u,d]=x.useState(null);x.useEffect(()=>{let g=!0;return(async()=>{if(r)try{const[y,b]=await Promise.all([P2(r),Sl()]);if(!g)return;i(Array.isArray(y)?y:[]),o(Array.isArray(b)?b:[]),d(null)}catch(y){if(!g)return;i([]),d((y==null?void 0:y.message)||"Failed to load course mapping")}finally{g&&c(!1)}})(),()=>{g=!1}},[r]);const f=((m=n[0])==null?void 0:m.course_name)||r,p=x.useMemo(()=>{const g=new Map;for(const b of n||[]){const v=String((b==null?void 0:b.section_name)||"").trim()||"Section",w=b!=null&&b.academic_year?String(b.academic_year):null,S=`${v}__${w||""}`,j=g.get(S);j?j.items.push(b):g.set(S,{section_name:v,academic_year:w,items:[b]})}const y=Array.from(g.values());y.sort((b,v)=>{const w=b.section_name.localeCompare(v.section_name);return w!==0?w:String(b.academic_year||"").localeCompare(String(v.academic_year||""))});for(const b of y)b.items.sort((v,w)=>{var k,A,R,M;const S=String(((k=v.staff)==null?void 0:k.name)||((A=v.staff)==null?void 0:A.username)||"").trim(),j=String(((R=w.staff)==null?void 0:R.name)||((M=w.staff)==null?void 0:M.username)||"").trim();return S.localeCompare(j)});return y},[n]);async function h(g){if(!g||!window.confirm("Resetting this course will delete all entered exam data for this teaching assignment. This cannot be undone. Proceed?"))return;const b=["ssa1","review1","ssa2","review2","cia1","cia2","formative1","formative2","model"];try{for(const w of b)try{await wN(w,r,g),O2(r,w)}catch(S){console.warn("reset assessment failed",w,S)}c(!0);const v=await P2(r);i(Array.isArray(v)?v:[]),d(null),window.alert("Reset completed.")}catch(v){window.alert("Reset failed: "+((v==null?void 0:v.message)||String(v)))}finally{c(!1)}}return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:r}),a.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:f}),a.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Sections and staff mapping."})]}),a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"}),a.jsx("button",{className:"obe-btn",onClick:()=>t(`/obe/course/${encodeURIComponent(r)}`),children:"Open OBE (faculty view)"})]})]}),l?a.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):null,u?a.jsx("div",{style:{color:"#b91c1c"},children:u}):null,!l&&!u&&n.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No active teaching assignments found for this course."}):null,!l&&!u&&n.length>0?a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:p.map(g=>a.jsxs("div",{className:"obe-card",style:{display:"flex",flexDirection:"column",gap:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"baseline"},children:[a.jsx("div",{style:{fontWeight:900,color:"#0f172a"},children:g.section_name}),a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:g.academic_year||""})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:10},children:g.items.map(y=>{var b,v;return a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:10,background:"#fff",display:"flex",flexDirection:"column",gap:8},children:[a.jsx("div",{style:{color:"#111827",fontWeight:800},children:((b=y.staff)==null?void 0:b.name)||((v=y.staff)==null?void 0:v.username)||""}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[y.section_name?`Section: ${y.section_name}`:"",y.academic_year?`    AY: ${y.academic_year}`:"",(()=>{var S,j;const w=(s||[]).find(k=>String((k==null?void 0:k.course_code)||"").trim().toUpperCase()===r.toUpperCase());return w?`    Dept: ${((S=w.department)==null?void 0:S.name)||((j=w.department)==null?void 0:j.code)||""}    Sem: ${w.semester||""}`:""})()]}),a.jsxs("div",{style:{marginTop:2,display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/marks/${encodeURIComponent(String(y.teaching_assignment_id))}`),children:"Open Mark Entry"}),a.jsx("button",{className:"obe-btn",onClick:()=>t(`/iqac/academic-controller/course/${encodeURIComponent(r)}/obe/${encodeURIComponent(String(y.teaching_assignment_id))}/marks`),children:"Open OBE (view-only)"}),a.jsx("button",{className:"obe-btn",onClick:()=>h(Number(y.teaching_assignment_id)),children:"Reset Course"})]})]},String(y.teaching_assignment_id))})})]},`${g.section_name}__${g.academic_year||""}`))}):null]})}async function pc(e){const t=`/api/academics/teaching-assignments/${encodeURIComponent(String(e))}/students/`,r=(i,s=800)=>{const o=String(i||""),u=o.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/&nbsp;/gi," ").replace(/&amp;/gi,"&").replace(/&quot;/gi,'"').replace(/&#39;/gi,"'").replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/\s+/g," ").trim()||o.replace(/\s+/g," ").trim();return u.length<=s?u:u.slice(0,s)+" (truncated)"},n=await mr(t,{method:"GET"});if(!n.ok){const i=await n.text();throw new Error(`Roster fetch failed: ${n.status}
${r(i)}`)}return n.json()}function lne(e,t){if(!e)return null;const r=new Date(e).getTime();if(!Number.isFinite(r))return null;const n=t?new Date(t).getTime():Date.now();return Number.isFinite(n)?Math.floor((r-n)/1e3):null}function ag(e){if(e==null)return"";const t=Math.max(0,Math.floor(e)),r=Math.floor(t/3600),n=Math.floor(t%3600/60),i=t%60;return r>0?`${r}h ${String(n).padStart(2,"0")}m`:`${n}m ${String(i).padStart(2,"0")}s`}function H0(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:i}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),[f,p]=x.useState(null),h=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),m=async y=>{if(!t||!r)return;const b=!!(y!=null&&y.silent);b||c(!0),b||d(null);try{const v=await SN(t,r,n);o(v);const w=v.remaining_seconds??lne(v.due_at,v.now);p(w)}catch(v){d((v==null?void 0:v.message)||"Failed to check publish window")}finally{b||c(!1)}};x.useEffect(()=>{o(null),p(null),m()},[h]),x.useEffect(()=>{if((i==null?void 0:i.poll)===!1)return;const y=window.setInterval(()=>{m({silent:!0})},3e4);return()=>window.clearInterval(y)},[h,i==null?void 0:i.poll]),x.useEffect(()=>{if(f==null||f<=0)return;const y=window.setInterval(()=>{p(b=>b==null?b:b<=0?0:b-1)},1e3);return()=>window.clearInterval(y)},[f]);const g=(s==null?void 0:s.publish_allowed)??!0;return{data:s,loading:l,error:u,remainingSeconds:f,publishAllowed:g,refresh:m}}function lc(e){const{assessment:t,subjectCode:r,scope:n,teachingAssignmentId:i,options:s}=e,[o,l]=x.useState(null),[c,u]=x.useState(!1),[d,f]=x.useState(null),p=x.useMemo(()=>`${t}|${r}|${n}|${i||""}`,[t,r,n,i]),h=async m=>{if(!t||!r||!n)return;const g=!!(m!=null&&m.silent);g||u(!0),g||f(null);try{const y=await l1(t,r,n,i);l(y)}catch(y){f((y==null?void 0:y.message)||"Failed to check edit window")}finally{g||u(!1)}};return x.useEffect(()=>{l(null),h()},[p]),x.useEffect(()=>{if((s==null?void 0:s.poll)===!1)return;const m=window.setInterval(()=>{h({silent:!0})},3e4);return()=>window.clearInterval(m)},[p,s==null?void 0:s.poll]),{data:o,loading:c,error:d,refresh:h}}function V0(e){const{assessment:t,subjectCode:r,teachingAssignmentId:n,options:i}=e,[s,o]=x.useState(null),[l,c]=x.useState(!1),[u,d]=x.useState(null),f=x.useMemo(()=>`${t}|${r}|${n||""}`,[t,r,n]),p=async h=>{if(!t||!r)return;const m=!!(h!=null&&h.silent);m||c(!0),m||d(null);try{const g=await xS(t,r,n);o(g)}catch(g){d((g==null?void 0:g.message)||"Failed to load lock status")}finally{m||c(!1)}};return x.useEffect(()=>{o(null),p()},[f]),x.useEffect(()=>{if((i==null?void 0:i.poll)===!1)return;const h=window.setInterval(()=>{p({silent:!0})},3e4);return()=>window.clearInterval(h)},[f,i==null?void 0:i.poll]),{data:s,loading:l,error:u,refresh:p}}const cne=24*60*60*1e3;function une(e){if(!e||String(e.status||"").toUpperCase()!=="PENDING"||!e.is_active)return null;const r=e.requested_at?new Date(String(e.requested_at)).getTime():0;if(!r||!Number.isFinite(r))return null;const n=r+cne;return Number.isFinite(n)?n:null}function G0(e){const{enabled:t,assessment:r,subjectCode:n,scope:i,teachingAssignmentId:s}=e,[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(!1),p=x.useMemo(()=>c?c>Date.now():!1,[c]),h=async m=>{if(!t||!r||!n||!i)return;const g=!!(m!=null&&m.silent);g||f(!0);try{const y=await Rm({assessment:r,subject_code:String(n),scope:i,teaching_assignment_id:s}),b=(y==null?void 0:y.result)??null;l(b),u(une(b))}catch{l(null),u(null)}finally{g||f(!1)}};return x.useEffect(()=>{if(!t){l(null),u(null);return}h({silent:!0});const m=window.setInterval(()=>{h({silent:!0})},6e4);return()=>window.clearInterval(m)},[t,r,n,i,s]),{latest:o,pending:p,pendingUntilMs:c,loading:d,refresh:h,setPendingUntilMs:u}}function K0(e){x.useEffect(()=>{if(!e||typeof document>"u")return;const t=document.body.style.overflow;return document.body.style.overflow="hidden",()=>{document.body.style.overflow=t}},[e])}function dne({size:e=22}){return a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,focusable:"false",children:[a.jsx("path",{d:"M7 10V8a5 5 0 0 1 10 0v2",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"}),a.jsx("path",{d:"M6.5 10h11A2.5 2.5 0 0 1 20 12.5v6A2.5 2.5 0 0 1 17.5 21h-11A2.5 2.5 0 0 1 4 18.5v-6A2.5 2.5 0 0 1 6.5 10Z",fill:"#F3F4F6",stroke:"#111827",strokeWidth:"1.2"}),a.jsx("path",{d:"M12 14.2v2.6",stroke:"#111827",strokeWidth:"1.8",strokeLinecap:"round"})]})}function sg({locked:e,title:t,subtitle:r,children:n}){return e?a.jsxs("div",{style:{position:"relative"},children:[a.jsx("div",{style:{position:"sticky",top:0,left:0,right:0,zIndex:10,marginBottom:12},children:a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",background:"#ffffff",border:"2px solid #fde68a",borderRadius:12,padding:"12px 16px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[a.jsx("div",{style:{width:36,height:36,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #fde68a",flex:"0 0 auto"},children:a.jsx(dne,{size:20})}),a.jsxs("div",{style:{minWidth:0,flex:1},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827",fontSize:14},children:t||"Locked by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:2},children:r||"Publishing is turned OFF globally for this assessment."})]})]})}),a.jsx("div",{style:{filter:"brightness(0.97)",pointerEvents:"none",userSelect:"none"},children:n})]}):a.jsx(a.Fragment,{children:n})}function og({children:e}){const t={minHeight:"100vh",background:"linear-gradient(180deg, #f0f9ff 0%, #ffffff 65%)",padding:"18px 14px"},r={maxWidth:1400,margin:"0 auto"},n={border:"1px solid rgba(15,23,42,0.08)",borderRadius:16,background:"rgba(255,255,255,0.88)",boxShadow:"0 12px 30px rgba(15,23,42,0.08)",padding:16,backdropFilter:"blur(10px)",overflowX:"auto",minWidth:0};return a.jsx("div",{style:t,children:a.jsx("div",{style:{...r,...n},children:e})})}function Va(e){return typeof document>"u"?a.jsx(a.Fragment,{children:e.children}):Y1.createPortal(a.jsx(a.Fragment,{children:e.children}),document.body)}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var M2={};M2.version="0.18.5";var W9=1252,fne=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CN={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},EN=function(e){fne.indexOf(e)!=-1&&(W9=CN[0]=e)};function hne(){EN(1252)}var du=function(e){EN(e)};function TN(){du(1200),hne()}function tP(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function pne(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function q9(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var hx=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?pne(e.slice(2)):t==254&&r==255?q9(e.slice(2)):t==65279?e.slice(1):e},vb=function(t){return String.fromCharCode(t)},rP=function(t){return String.fromCharCode(t)},c1,Gf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function u1(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),s=r>>2,n=e.charCodeAt(u++),o=(r&3)<<4|n>>4,i=e.charCodeAt(u++),l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),t+=Gf.charAt(s)+Gf.charAt(o)+Gf.charAt(l)+Gf.charAt(c);return t}function cc(e){var t="",r=0,n=0,i=0,s=0,o=0,l=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=Gf.indexOf(e.charAt(u++)),o=Gf.indexOf(e.charAt(u++)),r=s<<2|o>>4,t+=String.fromCharCode(r),l=Gf.indexOf(e.charAt(u++)),n=(o&15)<<4|l>>2,l!==64&&(t+=String.fromCharCode(n)),c=Gf.indexOf(e.charAt(u++)),i=(l&3)<<6|c,c!==64&&(t+=String.fromCharCode(i));return t}var mi=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),uf=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function hh(e){return mi?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function nP(e){return mi?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ql=function(t){return mi?uf(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function jS(e){if(typeof ArrayBuffer>"u")return Ql(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function kh(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function mne(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function PN(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return PN(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Gs=mi?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:uf(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function gne(e){for(var t=[],r=0,n=e.length+250,i=hh(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|l>>6&15|(o&3)<<4,i[r++]=128|l&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=hh(65535),n=65530)}return t.push(i.slice(0,r)),Gs(t)}var al=/\u0000/g,px=/[\u0001-\u0006]/g;function hm(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function fu(e,t){var r=""+e;return r.length>=t?r:qa("0",t-r.length)+r}function ON(e,t){var r=""+e;return r.length>=t?r:qa(" ",t-r.length)+r}function L2(e,t){var r=""+e;return r.length>=t?r:r+qa(" ",t-r.length)}function xne(e,t){var r=""+Math.round(e);return r.length>=t?r:qa("0",t-r.length)+r}function yne(e,t){var r=""+e;return r.length>=t?r:qa("0",t-r.length)+r}var iP=Math.pow(2,32);function hp(e,t){if(e>iP||e<-iP)return xne(e,t);var r=Math.round(e);return yne(r,t)}function R2(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var aP=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],X5=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function bne(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var qn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},sP={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},vne={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function F2(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,l=0,c=1,u=0,d=0,f=Math.floor(i);u<t&&(f=Math.floor(i),l=f*o+s,d=f*u+c,!(i-f<5e-8));)i=1/(i-f),s=o,o=l,c=u,u=d;if(d>t&&(u>t?(d=c,l=s):(d=u,l=o)),!r)return[0,n*l,d];var p=Math.floor(n*l/d);return[p,n*l-p*d,d]}function Xh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=Ane(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}var H9=new Date(1899,11,31,0,0,0),wne=H9.getTime(),Sne=new Date(1900,2,1,0,0,0);function V9(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Sne&&(r+=24*60*60*1e3),(r-(wne+(e.getTimezoneOffset()-H9.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function MN(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _ne(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function jne(e){var t=e<0?12:11,r=MN(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function kne(e){var t=MN(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function d1(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=jne(e):t===10?r=e.toFixed(10).substr(0,12):r=kne(e),MN(_ne(r.toUpperCase()))}function S0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):d1(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Wc(14,V9(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Ane(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Nne(e,t,r,n){var i="",s=0,o=0,l=r.y,c,u=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:c=l%100,u=2;break;default:c=l%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return X5[r.m-1][1];case 5:return X5[r.m-1][0];default:return X5[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return aP[r.q][0];default:return aP[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?fu(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=fu(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=l,u=1;break}var d=u>0?fu(c,u):"";return d}function Kf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var G9=/%/g;function Cne(e,t,r){var n=t.replace(G9,""),i=t.length-n.length;return $d(e,n,r*Math.pow(10,2*i))+qa("%",i)}function Ene(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return $d(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function K9(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+K9(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Y9=/# (\?+)( ?)\/( ?)(\d+)/;function Tne(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,l=n;return r+(s===0?"":""+s)+" "+(o===0?qa(" ",e[1].length+1+e[4].length):ON(o,e[1].length)+e[2]+"/"+e[3]+fu(l,e[4].length))}function Pne(e,t,r){return r+(t===0?"":""+t)+qa(" ",e[1].length+2+e[4].length)}var X9=/^#*0*\.([0#]+)/,Q9=/\).*[0#]/,J9=/\(###\) ###\\?-####/;function el(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function oP(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function lP(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function One(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Mne(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ac(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Q9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ac("n",n,r):"("+Ac("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ene(e,t,r);if(t.indexOf("%")!==-1)return Cne(e,t,r);if(t.indexOf("E")!==-1)return K9(t,r);if(t.charCodeAt(0)===36)return"$"+Ac(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+hp(c,t.length);if(t.match(/^[#?]+$/))return i=hp(r,0),i==="0"&&(i=""),i.length>t.length?i:el(t.substr(0,t.length-i.length))+i;if(s=t.match(Y9))return Tne(s,c,u);if(t.match(/^#+0+$/))return u+hp(c,t.length-t.indexOf("0"));if(s=t.match(X9))return i=oP(r,s[1].length).replace(/^([^\.]+)$/,"$1."+el(s[1])).replace(/\.$/,"."+el(s[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+qa("0",el(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+oP(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Kf(hp(c,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ac(e,t,-r):Kf(""+(Math.floor(r)+One(r,s[1].length)))+"."+fu(lP(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Ac(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=hm(Ac(e,t.replace(/[\\-]/g,""),r)),o=0,hm(hm(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(J9))return i=Ac(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=F2(c,Math.pow(10,o)-1,!1),i=""+u,d=$d("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=L2(l[2],o),d.length<s[4].length&&(d=el(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=F2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?ON(l[1],o)+s[2]+"/"+s[3]+L2(l[2],o):qa(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=hp(r,0),t.length<=i.length?i:el(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,p=t.length-i.length-f;return el(t.substr(0,f)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=lP(r,s[1].length),r<0?"-"+Ac(e,t,-r):Kf(Mne(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?fu(0,3-m.length):"")+m})+"."+fu(o,s[1].length);switch(t){case"###,##0.00":return Ac(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Kf(hp(c,0));return h!=="0"?u+h:"";case"###,###.00":return Ac(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ac(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Lne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return $d(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Rne(e,t,r){var n=t.replace(G9,""),i=t.length-n.length;return $d(e,n,r*Math.pow(10,2*i))+qa("%",i)}function Z9(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Z9(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,u,d){return c+u+d.substr(0,(i+s)%i)+"."+d.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Iu(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Q9)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Iu("n",n,r):"("+Iu("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Lne(e,t,r);if(t.indexOf("%")!==-1)return Rne(e,t,r);if(t.indexOf("E")!==-1)return Z9(t,r);if(t.charCodeAt(0)===36)return"$"+Iu(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,l,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+fu(c,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:el(t.substr(0,t.length-i.length))+i;if(s=t.match(Y9))return Pne(s,c,u);if(t.match(/^#+0+$/))return u+fu(c,t.length-t.indexOf("0"));if(s=t.match(X9))return i=(""+r).replace(/^([^\.]+)$/,"$1."+el(s[1])).replace(/\.$/,"."+el(s[1])),i=i.replace(/\.(\d*)$/,function(m,g){return"."+g+qa("0",el(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+Kf(""+c);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Iu(e,t,-r):Kf(""+r)+"."+qa("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Iu(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=hm(Iu(e,t.replace(/[\\-]/g,""),r)),o=0,hm(hm(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(J9))return i=Iu(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=F2(c,Math.pow(10,o)-1,!1),i=""+u,d=$d("n",s[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+s[2]+"/"+s[3],d=L2(l[2],o),d.length<s[4].length&&(d=el(s[4].substr(s[4].length-d.length))+d),i+=d,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),l=F2(c,Math.pow(10,o)-1,!0),u+(l[0]||(l[1]?"":"0"))+" "+(l[1]?ON(l[1],o)+s[2]+"/"+s[3]+L2(l[2],o):qa(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:el(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var f=t.indexOf(".")-o,p=t.length-i.length-f;return el(t.substr(0,f)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Iu(e,t,-r):Kf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?fu(0,3-m.length):"")+m})+"."+fu(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Kf(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Iu(e,t.slice(0,t.lastIndexOf(".")),r)+el(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function $d(e,t,r){return(r|0)===r?Iu(e,t,r):Ac(e,t,r)}function Fne(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var e$=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function lg(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":R2(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(e$))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Bne(e,t,r,n){for(var i=[],s="",o=0,l="",c="t",u,d,f,p="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!R2(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(f=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++o;break;case"\\":var h=e.charAt(++o),m=h==="("||h===")"?h:"t";i[i.length]={t:m,v:h},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(u==null&&(u=Xh(t,r,e.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Xh(t,r),u==null))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=p),i[i.length]={t:l,v:s},c=l;break;case"A":case"a":case"":var g={t:l,v:l};if(u==null&&(u=Xh(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,p="h"):e.substr(o,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",o+=5,p="h"):(g.t="t",++o),u==null&&g.t==="T")return"";i[i.length]=g,c=l;break;case"[":for(s=l;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(e$)){if(u==null&&(u=Xh(t,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",lg(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=l;++o<e.length&&(l=e.charAt(o))==="0";)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},c=l;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o;break}var y=0,b=0,v;for(o=i.length-1,c="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=p,c="h",y<1&&(y=1);break;case"s":(v=i[o].v.match(/\.0+$/))&&(b=Math.max(b,v[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=i[o].t;break;case"m":c==="s"&&(i[o].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[o].v.match(/[Hh]/)&&(y=1),y<2&&i[o].v.match(/[Mm]/)&&(y=2),y<3&&i[o].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var w="",S;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Nne(i[o].t.charCodeAt(0),i[o].v,u,b),i[o].t="t";break;case"n":case"?":for(S=o+1;i[S]!=null&&((l=i[S].t)==="?"||l==="D"||(l===" "||l==="t")&&i[S+1]!=null&&(i[S+1].t==="?"||i[S+1].t==="t"&&i[S+1].v==="/")||i[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[S].v==="/"||i[S].v===" "&&i[S+1]!=null&&i[S+1].t=="?"));)i[o].v+=i[S].v,i[S]={v:"",t:";"},++S;w+=i[o].v,o=S-1;break;case"G":i[o].t="t",i[o].v=S0(t,r);break}var j="",k,A;if(w.length>0){w.charCodeAt(0)==40?(k=t<0&&w.charCodeAt(0)===45?-t:t,A=$d("n",w,k)):(k=t<0&&n>1?-t:t,A=$d("n",w,k),k<0&&i[0]&&i[0].t=="t"&&(A=A.substr(1),i[0].v="-"+i[0].v)),S=A.length-1;var R=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){R=o;break}var M=i.length;if(R===i.length&&A.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(S>=i[o].v.length-1?(S-=i[o].v.length,i[o].v=A.substr(S+1,i[o].v.length)):S<0?i[o].v="":(i[o].v=A.substr(0,S+1),S=-1),i[o].t="t",M=o);S>=0&&M<i.length&&(i[M].v=A.substr(0,S+1)+i[M].v)}else if(R!==i.length&&A.indexOf("E")===-1){for(S=A.indexOf(".")-1,o=R;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")-1:i[o].v.length-1,j=i[o].v.substr(d+1);d>=0;--d)S>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(j=A.charAt(S--)+j);i[o].v=j,i[o].t="t",M=o}for(S>=0&&M<i.length&&(i[M].v=A.substr(0,S+1)+i[M].v),S=A.indexOf(".")+1,o=R;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==R)){for(d=i[o].v.indexOf(".")>-1&&o===R?i[o].v.indexOf(".")+1:0,j=i[o].v.substr(0,d);d<i[o].v.length;++d)S<A.length&&(j+=A.charAt(S++));i[o].v=j,i[o].t="t",M=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(k=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=$d(i[o].t,i[o].v,k),i[o].t="t");var B="";for(o=0;o!==i.length;++o)i[o]!=null&&(B+=i[o].v);return B}var cP=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function uP(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Ine(e,t){var r=Fne(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(cP),l=r[1].match(cP);return uP(t,o)?[n,r[0]]:uP(t,l)?[n,r[1]]:[n,r[o!=null&&l!=null?2:1]]}return[n,s]}function Wc(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:qn)[e],n==null&&(n=r.table&&r.table[sP[e]]||qn[sP[e]]),n==null&&(n=vne[e]||"General");break}if(R2(n,0))return S0(t,r);t instanceof Date&&(t=V9(t,r.date1904));var i=Ine(n,t);if(R2(i[1]))return S0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Bne(i[1],t,r,i[0])}function Ud(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(qn[r]==null){t<0&&(t=r);continue}if(qn[r]==e){t=r;break}}t<0&&(t=391)}return qn[t]=e,t}function kS(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ud(e[t],t)}function cg(){qn=bne()}var Dne={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},t$=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function $ne(e){var t=typeof e=="number"?qn[e]:e;return t=t.replace(t$,"(\\d+)"),new RegExp("^"+t+"$")}function Une(e,t,r){var n=-1,i=-1,s=-1,o=-1,l=-1,c=-1;(t.match(t$)||[]).forEach(function(f,p){var h=parseInt(r[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":s=h;break;case"h":o=h;break;case"s":c=h;break;case"m":o>=0?l=h:i=h;break}}),c>=0&&l==-1&&i>=0&&(l=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?u:n==-1&&i==-1&&s==-1?d:u+"T"+d}var zne=function(){var e={};e.version="1.2.0";function t(){for(var A=0,R=new Array(256),M=0;M!=256;++M)A=M,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,R[M]=A;return typeof Int32Array<"u"?new Int32Array(R):R}var r=t();function n(A){var R=0,M=0,B=0,E=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)E[B]=A[B];for(B=0;B!=256;++B)for(M=A[B],R=256+B;R<4096;R+=256)M=E[R]=M>>>8^A[M&255];var P=[];for(B=1;B!=16;++B)P[B-1]=typeof Int32Array<"u"?E.subarray(B*256,B*256+256):E.slice(B*256,B*256+256);return P}var i=n(r),s=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],f=i[6],p=i[7],h=i[8],m=i[9],g=i[10],y=i[11],b=i[12],v=i[13],w=i[14];function S(A,R){for(var M=R^-1,B=0,E=A.length;B<E;)M=M>>>8^r[(M^A.charCodeAt(B++))&255];return~M}function j(A,R){for(var M=R^-1,B=A.length-15,E=0;E<B;)M=w[A[E++]^M&255]^v[A[E++]^M>>8&255]^b[A[E++]^M>>16&255]^y[A[E++]^M>>>24]^g[A[E++]]^m[A[E++]]^h[A[E++]]^p[A[E++]]^f[A[E++]]^d[A[E++]]^u[A[E++]]^c[A[E++]]^l[A[E++]]^o[A[E++]]^s[A[E++]]^r[A[E++]];for(B+=15;E<B;)M=M>>>8^r[(M^A[E++])&255];return~M}function k(A,R){for(var M=R^-1,B=0,E=A.length,P=0,D=0;B<E;)P=A.charCodeAt(B++),P<128?M=M>>>8^r[(M^P)&255]:P<2048?(M=M>>>8^r[(M^(192|P>>6&31))&255],M=M>>>8^r[(M^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,D=A.charCodeAt(B++)&1023,M=M>>>8^r[(M^(240|P>>8&7))&255],M=M>>>8^r[(M^(128|P>>2&63))&255],M=M>>>8^r[(M^(128|D>>6&15|(P&3)<<4))&255],M=M>>>8^r[(M^(128|D&63))&255]):(M=M>>>8^r[(M^(224|P>>12&15))&255],M=M>>>8^r[(M^(128|P>>6&63))&255],M=M>>>8^r[(M^(128|P&63))&255]);return~M}return e.table=r,e.bstr=S,e.buf=j,e.str=k,e}(),In=function(){var t={};t.version="1.2.1";function r(se,ue){for(var J=se.split("/"),fe=ue.split("/"),ye=0,Ce=0,wt=Math.min(J.length,fe.length);ye<wt;++ye){if(Ce=J[ye].length-fe[ye].length)return Ce;if(J[ye]!=fe[ye])return J[ye]<fe[ye]?-1:1}return J.length-fe.length}function n(se){if(se.charAt(se.length-1)=="/")return se.slice(0,-1).indexOf("/")===-1?se:n(se.slice(0,-1));var ue=se.lastIndexOf("/");return ue===-1?se:se.slice(0,ue+1)}function i(se){if(se.charAt(se.length-1)=="/")return i(se.slice(0,-1));var ue=se.lastIndexOf("/");return ue===-1?se:se.slice(ue+1)}function s(se,ue){typeof ue=="string"&&(ue=new Date(ue));var J=ue.getHours();J=J<<6|ue.getMinutes(),J=J<<5|ue.getSeconds()>>>1,se.write_shift(2,J);var fe=ue.getFullYear()-1980;fe=fe<<4|ue.getMonth()+1,fe=fe<<5|ue.getDate(),se.write_shift(2,fe)}function o(se){var ue=se.read_shift(2)&65535,J=se.read_shift(2)&65535,fe=new Date,ye=J&31;J>>>=5;var Ce=J&15;J>>>=4,fe.setMilliseconds(0),fe.setFullYear(J+1980),fe.setMonth(Ce-1),fe.setDate(ye);var wt=ue&31;ue>>>=5;var Qe=ue&63;return ue>>>=6,fe.setHours(ue),fe.setMinutes(Qe),fe.setSeconds(wt<<1),fe}function l(se){mo(se,0);for(var ue={},J=0;se.l<=se.length-4;){var fe=se.read_shift(2),ye=se.read_shift(2),Ce=se.l+ye,wt={};switch(fe){case 21589:J=se.read_shift(1),J&1&&(wt.mtime=se.read_shift(4)),ye>5&&(J&2&&(wt.atime=se.read_shift(4)),J&4&&(wt.ctime=se.read_shift(4))),wt.mtime&&(wt.mt=new Date(wt.mtime*1e3));break}se.l=Ce,ue[fe]=wt}return ue}var c;function u(){return c||(c={})}function d(se,ue){if(se[0]==80&&se[1]==75)return Tt(se,ue);if((se[0]|32)==109&&(se[1]|32)==105)return tt(se,ue);if(se.length<512)throw new Error("CFB file size "+se.length+" < 512");var J=3,fe=512,ye=0,Ce=0,wt=0,Qe=0,Ie=0,Re=[],xt=se.slice(0,512);mo(xt,0);var Gt=f(xt);switch(J=Gt[0],J){case 3:fe=512;break;case 4:fe=4096;break;case 0:if(Gt[1]==0)return Tt(se,ue);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}fe!==512&&(xt=se.slice(0,fe),mo(xt,28));var qt=se.slice(0,fe);p(xt,J);var Wt=xt.read_shift(4,"i");if(J===3&&Wt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Wt);xt.l+=4,wt=xt.read_shift(4,"i"),xt.l+=4,xt.chk("00100000","Mini Stream Cutoff Size: "),Qe=xt.read_shift(4,"i"),ye=xt.read_shift(4,"i"),Ie=xt.read_shift(4,"i"),Ce=xt.read_shift(4,"i");for(var vt=-1,Rt=0;Rt<109&&(vt=xt.read_shift(4,"i"),!(vt<0));++Rt)Re[Rt]=vt;var Zt=h(se,fe);y(Ie,Ce,Zt,fe,Re);var wr=v(Zt,wt,Re,fe);wr[wt].name="!Directory",ye>0&&Qe!==D&&(wr[Qe].name="!MiniFAT"),wr[Re[0]].name="!FAT",wr.fat_addrs=Re,wr.ssz=fe;var br={},cr=[],Tr=[],Kr=[];w(wt,wr,Zt,cr,ye,br,Tr,Qe),m(Tr,Kr,cr),cr.shift();var Yr={FileIndex:Tr,FullPaths:Kr};return ue&&ue.raw&&(Yr.raw={header:qt,sectors:Zt}),Yr}function f(se){if(se[se.l]==80&&se[se.l+1]==75)return[0,0];se.chk(G,"Header Signature: "),se.l+=16;var ue=se.read_shift(2,"u");return[se.read_shift(2,"u"),ue]}function p(se,ue){var J=9;switch(se.l+=2,J=se.read_shift(2)){case 9:if(ue!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(ue!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}se.chk("0600","Mini Sector Shift: "),se.chk("000000000000","Reserved: ")}function h(se,ue){for(var J=Math.ceil(se.length/ue)-1,fe=[],ye=1;ye<J;++ye)fe[ye-1]=se.slice(ye*ue,(ye+1)*ue);return fe[J-1]=se.slice(J*ue),fe}function m(se,ue,J){for(var fe=0,ye=0,Ce=0,wt=0,Qe=0,Ie=J.length,Re=[],xt=[];fe<Ie;++fe)Re[fe]=xt[fe]=fe,ue[fe]=J[fe];for(;Qe<xt.length;++Qe)fe=xt[Qe],ye=se[fe].L,Ce=se[fe].R,wt=se[fe].C,Re[fe]===fe&&(ye!==-1&&Re[ye]!==ye&&(Re[fe]=Re[ye]),Ce!==-1&&Re[Ce]!==Ce&&(Re[fe]=Re[Ce])),wt!==-1&&(Re[wt]=fe),ye!==-1&&fe!=Re[fe]&&(Re[ye]=Re[fe],xt.lastIndexOf(ye)<Qe&&xt.push(ye)),Ce!==-1&&fe!=Re[fe]&&(Re[Ce]=Re[fe],xt.lastIndexOf(Ce)<Qe&&xt.push(Ce));for(fe=1;fe<Ie;++fe)Re[fe]===fe&&(Ce!==-1&&Re[Ce]!==Ce?Re[fe]=Re[Ce]:ye!==-1&&Re[ye]!==ye&&(Re[fe]=Re[ye]));for(fe=1;fe<Ie;++fe)if(se[fe].type!==0){if(Qe=fe,Qe!=Re[Qe])do Qe=Re[Qe],ue[fe]=ue[Qe]+"/"+ue[fe];while(Qe!==0&&Re[Qe]!==-1&&Qe!=Re[Qe]);Re[fe]=-1}for(ue[0]+="/",fe=1;fe<Ie;++fe)se[fe].type!==2&&(ue[fe]+="/")}function g(se,ue,J){for(var fe=se.start,ye=se.size,Ce=[],wt=fe;J&&ye>0&&wt>=0;)Ce.push(ue.slice(wt*P,wt*P+P)),ye-=P,wt=qh(J,wt*4);return Ce.length===0?_r(0):Gs(Ce).slice(0,se.size)}function y(se,ue,J,fe,ye){var Ce=D;if(se===D){if(ue!==0)throw new Error("DIFAT chain shorter than expected")}else if(se!==-1){var wt=J[se],Qe=(fe>>>2)-1;if(!wt)return;for(var Ie=0;Ie<Qe&&(Ce=qh(wt,Ie*4))!==D;++Ie)ye.push(Ce);y(qh(wt,fe-4),ue-1,J,fe,ye)}}function b(se,ue,J,fe,ye){var Ce=[],wt=[];ye||(ye=[]);var Qe=fe-1,Ie=0,Re=0;for(Ie=ue;Ie>=0;){ye[Ie]=!0,Ce[Ce.length]=Ie,wt.push(se[Ie]);var xt=J[Math.floor(Ie*4/fe)];if(Re=Ie*4&Qe,fe<4+Re)throw new Error("FAT boundary crossed: "+Ie+" 4 "+fe);if(!se[xt])break;Ie=qh(se[xt],Re)}return{nodes:Ce,data:SP([wt])}}function v(se,ue,J,fe){var ye=se.length,Ce=[],wt=[],Qe=[],Ie=[],Re=fe-1,xt=0,Gt=0,qt=0,Wt=0;for(xt=0;xt<ye;++xt)if(Qe=[],qt=xt+ue,qt>=ye&&(qt-=ye),!wt[qt]){Ie=[];var vt=[];for(Gt=qt;Gt>=0;){vt[Gt]=!0,wt[Gt]=!0,Qe[Qe.length]=Gt,Ie.push(se[Gt]);var Rt=J[Math.floor(Gt*4/fe)];if(Wt=Gt*4&Re,fe<4+Wt)throw new Error("FAT boundary crossed: "+Gt+" 4 "+fe);if(!se[Rt]||(Gt=qh(se[Rt],Wt),vt[Gt]))break}Ce[qt]={nodes:Qe,data:SP([Ie])}}return Ce}function w(se,ue,J,fe,ye,Ce,wt,Qe){for(var Ie=0,Re=fe.length?2:0,xt=ue[se].data,Gt=0,qt=0,Wt;Gt<xt.length;Gt+=128){var vt=xt.slice(Gt,Gt+128);mo(vt,64),qt=vt.read_shift(2),Wt=$N(vt,0,qt-Re),fe.push(Wt);var Rt={name:Wt,type:vt.read_shift(1),color:vt.read_shift(1),L:vt.read_shift(4,"i"),R:vt.read_shift(4,"i"),C:vt.read_shift(4,"i"),clsid:vt.read_shift(16),state:vt.read_shift(4,"i"),start:0,size:0},Zt=vt.read_shift(2)+vt.read_shift(2)+vt.read_shift(2)+vt.read_shift(2);Zt!==0&&(Rt.ct=S(vt,vt.l-8));var wr=vt.read_shift(2)+vt.read_shift(2)+vt.read_shift(2)+vt.read_shift(2);wr!==0&&(Rt.mt=S(vt,vt.l-8)),Rt.start=vt.read_shift(4,"i"),Rt.size=vt.read_shift(4,"i"),Rt.size<0&&Rt.start<0&&(Rt.size=Rt.type=0,Rt.start=D,Rt.name=""),Rt.type===5?(Ie=Rt.start,ye>0&&Ie!==D&&(ue[Ie].name="!StreamData")):Rt.size>=4096?(Rt.storage="fat",ue[Rt.start]===void 0&&(ue[Rt.start]=b(J,Rt.start,ue.fat_addrs,ue.ssz)),ue[Rt.start].name=Rt.name,Rt.content=ue[Rt.start].data.slice(0,Rt.size)):(Rt.storage="minifat",Rt.size<0?Rt.size=0:Ie!==D&&Rt.start!==D&&ue[Ie]&&(Rt.content=g(Rt,ue[Ie].data,(ue[Qe]||{}).data))),Rt.content&&mo(Rt.content,0),Ce[Wt]=Rt,wt.push(Rt)}}function S(se,ue){return new Date((Xl(se,ue+4)/1e7*Math.pow(2,32)+Xl(se,ue)/1e7-11644473600)*1e3)}function j(se,ue){return u(),d(c.readFileSync(se),ue)}function k(se,ue){var J=ue&&ue.type;switch(J||mi&&Buffer.isBuffer(se)&&(J="buffer"),J||"base64"){case"file":return j(se,ue);case"base64":return d(Ql(cc(se)),ue);case"binary":return d(Ql(se),ue)}return d(se,ue)}function A(se,ue){var J=ue||{},fe=J.root||"Root Entry";if(se.FullPaths||(se.FullPaths=[]),se.FileIndex||(se.FileIndex=[]),se.FullPaths.length!==se.FileIndex.length)throw new Error("inconsistent CFB structure");se.FullPaths.length===0&&(se.FullPaths[0]=fe+"/",se.FileIndex[0]={name:fe,type:5}),J.CLSID&&(se.FileIndex[0].clsid=J.CLSID),R(se)}function R(se){var ue="Sh33tJ5";if(!In.find(se,"/"+ue)){var J=_r(4);J[0]=55,J[1]=J[3]=50,J[2]=54,se.FileIndex.push({name:ue,type:2,content:J,size:4,L:69,R:69,C:69}),se.FullPaths.push(se.FullPaths[0]+ue),M(se)}}function M(se,ue){A(se);for(var J=!1,fe=!1,ye=se.FullPaths.length-1;ye>=0;--ye){var Ce=se.FileIndex[ye];switch(Ce.type){case 0:fe?J=!0:(se.FileIndex.pop(),se.FullPaths.pop());break;case 1:case 2:case 5:fe=!0,isNaN(Ce.R*Ce.L*Ce.C)&&(J=!0),Ce.R>-1&&Ce.L>-1&&Ce.R==Ce.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!ue)){var wt=new Date(1987,1,19),Qe=0,Ie=Object.create?Object.create(null):{},Re=[];for(ye=0;ye<se.FullPaths.length;++ye)Ie[se.FullPaths[ye]]=!0,se.FileIndex[ye].type!==0&&Re.push([se.FullPaths[ye],se.FileIndex[ye]]);for(ye=0;ye<Re.length;++ye){var xt=n(Re[ye][0]);fe=Ie[xt],fe||(Re.push([xt,{name:i(xt).replace("/",""),type:1,clsid:oe,ct:wt,mt:wt,content:null}]),Ie[xt]=!0)}for(Re.sort(function(Wt,vt){return r(Wt[0],vt[0])}),se.FullPaths=[],se.FileIndex=[],ye=0;ye<Re.length;++ye)se.FullPaths[ye]=Re[ye][0],se.FileIndex[ye]=Re[ye][1];for(ye=0;ye<Re.length;++ye){var Gt=se.FileIndex[ye],qt=se.FullPaths[ye];if(Gt.name=i(qt).replace("/",""),Gt.L=Gt.R=Gt.C=-(Gt.color=1),Gt.size=Gt.content?Gt.content.length:0,Gt.start=0,Gt.clsid=Gt.clsid||oe,ye===0)Gt.C=Re.length>1?1:-1,Gt.size=0,Gt.type=5;else if(qt.slice(-1)=="/"){for(Qe=ye+1;Qe<Re.length&&n(se.FullPaths[Qe])!=qt;++Qe);for(Gt.C=Qe>=Re.length?-1:Qe,Qe=ye+1;Qe<Re.length&&n(se.FullPaths[Qe])!=n(qt);++Qe);Gt.R=Qe>=Re.length?-1:Qe,Gt.type=1}else n(se.FullPaths[ye+1]||"")==n(qt)&&(Gt.R=ye+1),Gt.type=2}}}function B(se,ue){var J=ue||{};if(J.fileType=="mad")return st(se,J);switch(M(se),J.fileType){case"zip":return Br(se,J)}var fe=function(Wt){for(var vt=0,Rt=0,Zt=0;Zt<Wt.FileIndex.length;++Zt){var wr=Wt.FileIndex[Zt];if(wr.content){var br=wr.content.length;br>0&&(br<4096?vt+=br+63>>6:Rt+=br+511>>9)}}for(var cr=Wt.FullPaths.length+3>>2,Tr=vt+7>>3,Kr=vt+127>>7,Yr=Tr+Rt+cr+Kr,xn=Yr+127>>7,hr=xn<=109?0:Math.ceil((xn-109)/127);Yr+xn+hr+127>>7>xn;)hr=++xn<=109?0:Math.ceil((xn-109)/127);var nr=[1,hr,xn,Kr,cr,Rt,vt,0];return Wt.FileIndex[0].size=vt<<6,nr[7]=(Wt.FileIndex[0].start=nr[0]+nr[1]+nr[2]+nr[3]+nr[4]+nr[5])+(nr[6]+7>>3),nr}(se),ye=_r(fe[7]<<9),Ce=0,wt=0;{for(Ce=0;Ce<8;++Ce)ye.write_shift(1,H[Ce]);for(Ce=0;Ce<8;++Ce)ye.write_shift(2,0);for(ye.write_shift(2,62),ye.write_shift(2,3),ye.write_shift(2,65534),ye.write_shift(2,9),ye.write_shift(2,6),Ce=0;Ce<3;++Ce)ye.write_shift(2,0);for(ye.write_shift(4,0),ye.write_shift(4,fe[2]),ye.write_shift(4,fe[0]+fe[1]+fe[2]+fe[3]-1),ye.write_shift(4,0),ye.write_shift(4,4096),ye.write_shift(4,fe[3]?fe[0]+fe[1]+fe[2]-1:D),ye.write_shift(4,fe[3]),ye.write_shift(-4,fe[1]?fe[0]-1:D),ye.write_shift(4,fe[1]),Ce=0;Ce<109;++Ce)ye.write_shift(-4,Ce<fe[2]?fe[1]+Ce:-1)}if(fe[1])for(wt=0;wt<fe[1];++wt){for(;Ce<236+wt*127;++Ce)ye.write_shift(-4,Ce<fe[2]?fe[1]+Ce:-1);ye.write_shift(-4,wt===fe[1]-1?D:wt+1)}var Qe=function(Wt){for(wt+=Wt;Ce<wt-1;++Ce)ye.write_shift(-4,Ce+1);Wt&&(++Ce,ye.write_shift(-4,D))};for(wt=Ce=0,wt+=fe[1];Ce<wt;++Ce)ye.write_shift(-4,de.DIFSECT);for(wt+=fe[2];Ce<wt;++Ce)ye.write_shift(-4,de.FATSECT);Qe(fe[3]),Qe(fe[4]);for(var Ie=0,Re=0,xt=se.FileIndex[0];Ie<se.FileIndex.length;++Ie)xt=se.FileIndex[Ie],xt.content&&(Re=xt.content.length,!(Re<4096)&&(xt.start=wt,Qe(Re+511>>9)));for(Qe(fe[6]+7>>3);ye.l&511;)ye.write_shift(-4,de.ENDOFCHAIN);for(wt=Ce=0,Ie=0;Ie<se.FileIndex.length;++Ie)xt=se.FileIndex[Ie],xt.content&&(Re=xt.content.length,!(!Re||Re>=4096)&&(xt.start=wt,Qe(Re+63>>6)));for(;ye.l&511;)ye.write_shift(-4,de.ENDOFCHAIN);for(Ce=0;Ce<fe[4]<<2;++Ce){var Gt=se.FullPaths[Ce];if(!Gt||Gt.length===0){for(Ie=0;Ie<17;++Ie)ye.write_shift(4,0);for(Ie=0;Ie<3;++Ie)ye.write_shift(4,-1);for(Ie=0;Ie<12;++Ie)ye.write_shift(4,0);continue}xt=se.FileIndex[Ce],Ce===0&&(xt.start=xt.size?xt.start-1:D);var qt=Ce===0&&J.root||xt.name;if(Re=2*(qt.length+1),ye.write_shift(64,qt,"utf16le"),ye.write_shift(2,Re),ye.write_shift(1,xt.type),ye.write_shift(1,xt.color),ye.write_shift(-4,xt.L),ye.write_shift(-4,xt.R),ye.write_shift(-4,xt.C),xt.clsid)ye.write_shift(16,xt.clsid,"hex");else for(Ie=0;Ie<4;++Ie)ye.write_shift(4,0);ye.write_shift(4,xt.state||0),ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(4,0),ye.write_shift(4,xt.start),ye.write_shift(4,xt.size),ye.write_shift(4,0)}for(Ce=1;Ce<se.FileIndex.length;++Ce)if(xt=se.FileIndex[Ce],xt.size>=4096)if(ye.l=xt.start+1<<9,mi&&Buffer.isBuffer(xt.content))xt.content.copy(ye,ye.l,0,xt.size),ye.l+=xt.size+511&-512;else{for(Ie=0;Ie<xt.size;++Ie)ye.write_shift(1,xt.content[Ie]);for(;Ie&511;++Ie)ye.write_shift(1,0)}for(Ce=1;Ce<se.FileIndex.length;++Ce)if(xt=se.FileIndex[Ce],xt.size>0&&xt.size<4096)if(mi&&Buffer.isBuffer(xt.content))xt.content.copy(ye,ye.l,0,xt.size),ye.l+=xt.size+63&-64;else{for(Ie=0;Ie<xt.size;++Ie)ye.write_shift(1,xt.content[Ie]);for(;Ie&63;++Ie)ye.write_shift(1,0)}if(mi)ye.l=ye.length;else for(;ye.l<ye.length;)ye.write_shift(1,0);return ye}function E(se,ue){var J=se.FullPaths.map(function(Ie){return Ie.toUpperCase()}),fe=J.map(function(Ie){var Re=Ie.split("/");return Re[Re.length-(Ie.slice(-1)=="/"?2:1)]}),ye=!1;ue.charCodeAt(0)===47?(ye=!0,ue=J[0].slice(0,-1)+ue):ye=ue.indexOf("/")!==-1;var Ce=ue.toUpperCase(),wt=ye===!0?J.indexOf(Ce):fe.indexOf(Ce);if(wt!==-1)return se.FileIndex[wt];var Qe=!Ce.match(px);for(Ce=Ce.replace(al,""),Qe&&(Ce=Ce.replace(px,"!")),wt=0;wt<J.length;++wt)if((Qe?J[wt].replace(px,"!"):J[wt]).replace(al,"")==Ce||(Qe?fe[wt].replace(px,"!"):fe[wt]).replace(al,"")==Ce)return se.FileIndex[wt];return null}var P=64,D=-2,G="d0cf11e0a1b11ae1",H=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(se,ue,J){u();var fe=B(se,J);c.writeFileSync(ue,fe)}function V(se){for(var ue=new Array(se.length),J=0;J<se.length;++J)ue[J]=String.fromCharCode(se[J]);return ue.join("")}function ae(se,ue){var J=B(se,ue);switch(ue&&ue.type||"buffer"){case"file":return u(),c.writeFileSync(ue.filename,J),J;case"binary":return typeof J=="string"?J:V(J);case"base64":return u1(typeof J=="string"?J:V(J));case"buffer":if(mi)return Buffer.isBuffer(J)?J:uf(J);case"array":return typeof J=="string"?Ql(J):J}return J}var ee;function C(se){try{var ue=se.InflateRaw,J=new ue;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)ee=se;else throw new Error("zlib does not expose bytesRead")}catch(fe){console.error("cannot use native zlib: "+(fe.message||fe))}}function Y(se,ue){if(!ee)return yr(se,ue);var J=ee.InflateRaw,fe=new J,ye=fe._processChunk(se.slice(se.l),fe._finishFlushFlag);return se.l+=fe.bytesRead,ye}function q(se){return ee?ee.deflateRawSync(se):ce(se)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],F=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(se){var ue=(se<<1|se<<11)&139536|(se<<5|se<<15)&558144;return(ue>>16|ue>>8|ue)&255}for(var K=typeof Uint8Array<"u",ne=K?new Uint8Array(256):[],re=0;re<256;++re)ne[re]=Q(re);function T(se,ue){var J=ne[se&255];return ue<=8?J>>>8-ue:(J=J<<8|ne[se>>8&255],ue<=16?J>>>16-ue:(J=J<<8|ne[se>>16&255],J>>>24-ue))}function I(se,ue){var J=ue&7,fe=ue>>>3;return(se[fe]|(J<=6?0:se[fe+1]<<8))>>>J&3}function ie(se,ue){var J=ue&7,fe=ue>>>3;return(se[fe]|(J<=5?0:se[fe+1]<<8))>>>J&7}function U(se,ue){var J=ue&7,fe=ue>>>3;return(se[fe]|(J<=4?0:se[fe+1]<<8))>>>J&15}function Z(se,ue){var J=ue&7,fe=ue>>>3;return(se[fe]|(J<=3?0:se[fe+1]<<8))>>>J&31}function me(se,ue){var J=ue&7,fe=ue>>>3;return(se[fe]|(J<=1?0:se[fe+1]<<8))>>>J&127}function Pe(se,ue,J){var fe=ue&7,ye=ue>>>3,Ce=(1<<J)-1,wt=se[ye]>>>fe;return J<8-fe||(wt|=se[ye+1]<<8-fe,J<16-fe)||(wt|=se[ye+2]<<16-fe,J<24-fe)||(wt|=se[ye+3]<<24-fe),wt&Ce}function je(se,ue,J){var fe=ue&7,ye=ue>>>3;return fe<=5?se[ye]|=(J&7)<<fe:(se[ye]|=J<<fe&255,se[ye+1]=(J&7)>>8-fe),ue+3}function Fe(se,ue,J){var fe=ue&7,ye=ue>>>3;return J=(J&1)<<fe,se[ye]|=J,ue+1}function _e(se,ue,J){var fe=ue&7,ye=ue>>>3;return J<<=fe,se[ye]|=J&255,J>>>=8,se[ye+1]=J,ue+8}function He(se,ue,J){var fe=ue&7,ye=ue>>>3;return J<<=fe,se[ye]|=J&255,J>>>=8,se[ye+1]=J&255,se[ye+2]=J>>>8,ue+16}function qe(se,ue){var J=se.length,fe=2*J>ue?2*J:ue+5,ye=0;if(J>=ue)return se;if(mi){var Ce=nP(fe);if(se.copy)se.copy(Ce);else for(;ye<se.length;++ye)Ce[ye]=se[ye];return Ce}else if(K){var wt=new Uint8Array(fe);if(wt.set)wt.set(se);else for(;ye<J;++ye)wt[ye]=se[ye];return wt}return se.length=fe,se}function Pt(se){for(var ue=new Array(se),J=0;J<se;++J)ue[J]=0;return ue}function ut(se,ue,J){var fe=1,ye=0,Ce=0,wt=0,Qe=0,Ie=se.length,Re=K?new Uint16Array(32):Pt(32);for(Ce=0;Ce<32;++Ce)Re[Ce]=0;for(Ce=Ie;Ce<J;++Ce)se[Ce]=0;Ie=se.length;var xt=K?new Uint16Array(Ie):Pt(Ie);for(Ce=0;Ce<Ie;++Ce)Re[ye=se[Ce]]++,fe<ye&&(fe=ye),xt[Ce]=0;for(Re[0]=0,Ce=1;Ce<=fe;++Ce)Re[Ce+16]=Qe=Qe+Re[Ce-1]<<1;for(Ce=0;Ce<Ie;++Ce)Qe=se[Ce],Qe!=0&&(xt[Ce]=Re[Qe+16]++);var Gt=0;for(Ce=0;Ce<Ie;++Ce)if(Gt=se[Ce],Gt!=0)for(Qe=T(xt[Ce],fe)>>fe-Gt,wt=(1<<fe+4-Gt)-1;wt>=0;--wt)ue[Qe|wt<<Gt]=Gt&15|Ce<<4;return fe}var Ke=K?new Uint16Array(512):Pt(512),lt=K?new Uint16Array(32):Pt(32);if(!K){for(var ve=0;ve<512;++ve)Ke[ve]=0;for(ve=0;ve<32;++ve)lt[ve]=0}(function(){for(var se=[],ue=0;ue<32;ue++)se.push(5);ut(se,lt,32);var J=[];for(ue=0;ue<=143;ue++)J.push(8);for(;ue<=255;ue++)J.push(9);for(;ue<=279;ue++)J.push(7);for(;ue<=287;ue++)J.push(8);ut(J,Ke,288)})();var Ae=function(){for(var ue=K?new Uint8Array(32768):[],J=0,fe=0;J<F.length-1;++J)for(;fe<F[J+1];++fe)ue[fe]=J;for(;fe<32768;++fe)ue[fe]=29;var ye=K?new Uint8Array(259):[];for(J=0,fe=0;J<X.length-1;++J)for(;fe<X[J+1];++fe)ye[fe]=J;function Ce(Qe,Ie){for(var Re=0;Re<Qe.length;){var xt=Math.min(65535,Qe.length-Re),Gt=Re+xt==Qe.length;for(Ie.write_shift(1,+Gt),Ie.write_shift(2,xt),Ie.write_shift(2,~xt&65535);xt-- >0;)Ie[Ie.l++]=Qe[Re++]}return Ie.l}function wt(Qe,Ie){for(var Re=0,xt=0,Gt=K?new Uint16Array(32768):[];xt<Qe.length;){var qt=Math.min(65535,Qe.length-xt);if(qt<10){for(Re=je(Ie,Re,+(xt+qt==Qe.length)),Re&7&&(Re+=8-(Re&7)),Ie.l=Re/8|0,Ie.write_shift(2,qt),Ie.write_shift(2,~qt&65535);qt-- >0;)Ie[Ie.l++]=Qe[xt++];Re=Ie.l*8;continue}Re=je(Ie,Re,+(xt+qt==Qe.length)+2);for(var Wt=0;qt-- >0;){var vt=Qe[xt];Wt=(Wt<<5^vt)&32767;var Rt=-1,Zt=0;if((Rt=Gt[Wt])&&(Rt|=xt&-32768,Rt>xt&&(Rt-=32768),Rt<xt))for(;Qe[Rt+Zt]==Qe[xt+Zt]&&Zt<250;)++Zt;if(Zt>2){vt=ye[Zt],vt<=22?Re=_e(Ie,Re,ne[vt+1]>>1)-1:(_e(Ie,Re,3),Re+=5,_e(Ie,Re,ne[vt-23]>>5),Re+=3);var wr=vt<8?0:vt-4>>2;wr>0&&(He(Ie,Re,Zt-X[vt]),Re+=wr),vt=ue[xt-Rt],Re=_e(Ie,Re,ne[vt]>>3),Re-=3;var br=vt<4?0:vt-2>>1;br>0&&(He(Ie,Re,xt-Rt-F[vt]),Re+=br);for(var cr=0;cr<Zt;++cr)Gt[Wt]=xt&32767,Wt=(Wt<<5^Qe[xt])&32767,++xt;qt-=Zt-1}else vt<=143?vt=vt+48:Re=Fe(Ie,Re,1),Re=_e(Ie,Re,ne[vt]),Gt[Wt]=xt&32767,++xt}Re=_e(Ie,Re,0)-1}return Ie.l=(Re+7)/8|0,Ie.l}return function(Ie,Re){return Ie.length<8?Ce(Ie,Re):wt(Ie,Re)}}();function ce(se){var ue=_r(50+Math.floor(se.length*1.1)),J=Ae(se,ue);return ue.slice(0,J)}var be=K?new Uint16Array(32768):Pt(32768),mt=K?new Uint16Array(32768):Pt(32768),et=K?new Uint16Array(128):Pt(128),Ue=1,It=1;function ht(se,ue){var J=Z(se,ue)+257;ue+=5;var fe=Z(se,ue)+1;ue+=5;var ye=U(se,ue)+4;ue+=4;for(var Ce=0,wt=K?new Uint8Array(19):Pt(19),Qe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ie=1,Re=K?new Uint8Array(8):Pt(8),xt=K?new Uint8Array(8):Pt(8),Gt=wt.length,qt=0;qt<ye;++qt)wt[O[qt]]=Ce=ie(se,ue),Ie<Ce&&(Ie=Ce),Re[Ce]++,ue+=3;var Wt=0;for(Re[0]=0,qt=1;qt<=Ie;++qt)xt[qt]=Wt=Wt+Re[qt-1]<<1;for(qt=0;qt<Gt;++qt)(Wt=wt[qt])!=0&&(Qe[qt]=xt[Wt]++);var vt=0;for(qt=0;qt<Gt;++qt)if(vt=wt[qt],vt!=0){Wt=ne[Qe[qt]]>>8-vt;for(var Rt=(1<<7-vt)-1;Rt>=0;--Rt)et[Wt|Rt<<vt]=vt&7|qt<<3}var Zt=[];for(Ie=1;Zt.length<J+fe;)switch(Wt=et[me(se,ue)],ue+=Wt&7,Wt>>>=3){case 16:for(Ce=3+I(se,ue),ue+=2,Wt=Zt[Zt.length-1];Ce-- >0;)Zt.push(Wt);break;case 17:for(Ce=3+ie(se,ue),ue+=3;Ce-- >0;)Zt.push(0);break;case 18:for(Ce=11+me(se,ue),ue+=7;Ce-- >0;)Zt.push(0);break;default:Zt.push(Wt),Ie<Wt&&(Ie=Wt);break}var wr=Zt.slice(0,J),br=Zt.slice(J);for(qt=J;qt<286;++qt)wr[qt]=0;for(qt=fe;qt<30;++qt)br[qt]=0;return Ue=ut(wr,be,286),It=ut(br,mt,30),ue}function Lt(se,ue){if(se[0]==3&&!(se[1]&3))return[hh(ue),2];for(var J=0,fe=0,ye=nP(ue||1<<18),Ce=0,wt=ye.length>>>0,Qe=0,Ie=0;!(fe&1);){if(fe=ie(se,J),J+=3,fe>>>1)fe>>1==1?(Qe=9,Ie=5):(J=ht(se,J),Qe=Ue,Ie=It);else{J&7&&(J+=8-(J&7));var Re=se[J>>>3]|se[(J>>>3)+1]<<8;if(J+=32,Re>0)for(!ue&&wt<Ce+Re&&(ye=qe(ye,Ce+Re),wt=ye.length);Re-- >0;)ye[Ce++]=se[J>>>3],J+=8;continue}for(;;){!ue&&wt<Ce+32767&&(ye=qe(ye,Ce+32767),wt=ye.length);var xt=Pe(se,J,Qe),Gt=fe>>>1==1?Ke[xt]:be[xt];if(J+=Gt&15,Gt>>>=4,!(Gt>>>8&255))ye[Ce++]=Gt;else{if(Gt==256)break;Gt-=257;var qt=Gt<8?0:Gt-4>>2;qt>5&&(qt=0);var Wt=Ce+X[Gt];qt>0&&(Wt+=Pe(se,J,qt),J+=qt),xt=Pe(se,J,Ie),Gt=fe>>>1==1?lt[xt]:mt[xt],J+=Gt&15,Gt>>>=4;var vt=Gt<4?0:Gt-2>>1,Rt=F[Gt];for(vt>0&&(Rt+=Pe(se,J,vt),J+=vt),!ue&&wt<Wt&&(ye=qe(ye,Wt+100),wt=ye.length);Ce<Wt;)ye[Ce]=ye[Ce-Rt],++Ce}}}return ue?[ye,J+7>>>3]:[ye.slice(0,Ce),J+7>>>3]}function yr(se,ue){var J=se.slice(se.l||0),fe=Lt(J,ue);return se.l+=fe[1],fe[0]}function Ar(se,ue){if(se)typeof console<"u"&&console.error(ue);else throw new Error(ue)}function Tt(se,ue){var J=se;mo(J,0);var fe=[],ye=[],Ce={FileIndex:fe,FullPaths:ye};A(Ce,{root:ue.root});for(var wt=J.length-4;(J[wt]!=80||J[wt+1]!=75||J[wt+2]!=5||J[wt+3]!=6)&&wt>=0;)--wt;J.l=wt+4,J.l+=4;var Qe=J.read_shift(2);J.l+=6;var Ie=J.read_shift(4);for(J.l=Ie,wt=0;wt<Qe;++wt){J.l+=20;var Re=J.read_shift(4),xt=J.read_shift(4),Gt=J.read_shift(2),qt=J.read_shift(2),Wt=J.read_shift(2);J.l+=8;var vt=J.read_shift(4),Rt=l(J.slice(J.l+Gt,J.l+Gt+qt));J.l+=Gt+qt+Wt;var Zt=J.l;J.l=vt+4,Vr(J,Re,xt,Ce,Rt),J.l=Zt}return Ce}function Vr(se,ue,J,fe,ye){se.l+=2;var Ce=se.read_shift(2),wt=se.read_shift(2),Qe=o(se);if(Ce&8257)throw new Error("Unsupported ZIP encryption");for(var Ie=se.read_shift(4),Re=se.read_shift(4),xt=se.read_shift(4),Gt=se.read_shift(2),qt=se.read_shift(2),Wt="",vt=0;vt<Gt;++vt)Wt+=String.fromCharCode(se[se.l++]);if(qt){var Rt=l(se.slice(se.l,se.l+qt));(Rt[21589]||{}).mt&&(Qe=Rt[21589].mt),((ye||{})[21589]||{}).mt&&(Qe=ye[21589].mt)}se.l+=qt;var Zt=se.slice(se.l,se.l+Re);switch(wt){case 8:Zt=Y(se,xt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+wt)}var wr=!1;Ce&8&&(Ie=se.read_shift(4),Ie==134695760&&(Ie=se.read_shift(4),wr=!0),Re=se.read_shift(4),xt=se.read_shift(4)),Re!=ue&&Ar(wr,"Bad compressed size: "+ue+" != "+Re),xt!=J&&Ar(wr,"Bad uncompressed size: "+J+" != "+xt),jt(fe,Wt,Zt,{unsafe:!0,mt:Qe})}function Br(se,ue){var J=ue||{},fe=[],ye=[],Ce=_r(1),wt=J.compression?8:0,Qe=0,Ie=0,Re=0,xt=0,Gt=0,qt=se.FullPaths[0],Wt=qt,vt=se.FileIndex[0],Rt=[],Zt=0;for(Ie=1;Ie<se.FullPaths.length;++Ie)if(Wt=se.FullPaths[Ie].slice(qt.length),vt=se.FileIndex[Ie],!(!vt.size||!vt.content||Wt=="Sh33tJ5")){var wr=xt,br=_r(Wt.length);for(Re=0;Re<Wt.length;++Re)br.write_shift(1,Wt.charCodeAt(Re)&127);br=br.slice(0,br.l),Rt[Gt]=zne.buf(vt.content,0);var cr=vt.content;wt==8&&(cr=q(cr)),Ce=_r(30),Ce.write_shift(4,67324752),Ce.write_shift(2,20),Ce.write_shift(2,Qe),Ce.write_shift(2,wt),vt.mt?s(Ce,vt.mt):Ce.write_shift(4,0),Ce.write_shift(-4,Rt[Gt]),Ce.write_shift(4,cr.length),Ce.write_shift(4,vt.content.length),Ce.write_shift(2,br.length),Ce.write_shift(2,0),xt+=Ce.length,fe.push(Ce),xt+=br.length,fe.push(br),xt+=cr.length,fe.push(cr),Ce=_r(46),Ce.write_shift(4,33639248),Ce.write_shift(2,0),Ce.write_shift(2,20),Ce.write_shift(2,Qe),Ce.write_shift(2,wt),Ce.write_shift(4,0),Ce.write_shift(-4,Rt[Gt]),Ce.write_shift(4,cr.length),Ce.write_shift(4,vt.content.length),Ce.write_shift(2,br.length),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(4,0),Ce.write_shift(4,wr),Zt+=Ce.l,ye.push(Ce),Zt+=br.length,ye.push(br),++Gt}return Ce=_r(22),Ce.write_shift(4,101010256),Ce.write_shift(2,0),Ce.write_shift(2,0),Ce.write_shift(2,Gt),Ce.write_shift(2,Gt),Ce.write_shift(4,Zt),Ce.write_shift(4,xt),Ce.write_shift(2,0),Gs([Gs(fe),Gs(ye),Ce])}var Wr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function nn(se,ue){if(se.ctype)return se.ctype;var J=se.name||"",fe=J.match(/\.([^\.]+)$/);return fe&&Wr[fe[1]]||ue&&(fe=(J=ue).match(/[\.\\]([^\.\\])+$/),fe&&Wr[fe[1]])?Wr[fe[1]]:"application/octet-stream"}function fn(se){for(var ue=u1(se),J=[],fe=0;fe<ue.length;fe+=76)J.push(ue.slice(fe,fe+76));return J.join(`\r
`)+`\r
`}function Ir(se){var ue=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Re){var xt=Re.charCodeAt(0).toString(16).toUpperCase();return"="+(xt.length==1?"0"+xt:xt)});ue=ue.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ue.charAt(0)==`
`&&(ue="=0D"+ue.slice(1)),ue=ue.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],fe=ue.split(`\r
`),ye=0;ye<fe.length;++ye){var Ce=fe[ye];if(Ce.length==0){J.push("");continue}for(var wt=0;wt<Ce.length;){var Qe=76,Ie=Ce.slice(wt,wt+Qe);Ie.charAt(Qe-1)=="="?Qe--:Ie.charAt(Qe-2)=="="?Qe-=2:Ie.charAt(Qe-3)=="="&&(Qe-=3),Ie=Ce.slice(wt,wt+Qe),wt+=Qe,wt<Ce.length&&(Ie+="="),J.push(Ie)}}return J.join(`\r
`)}function dn(se){for(var ue=[],J=0;J<se.length;++J){for(var fe=se[J];J<=se.length&&fe.charAt(fe.length-1)=="=";)fe=fe.slice(0,fe.length-1)+se[++J];ue.push(fe)}for(var ye=0;ye<ue.length;++ye)ue[ye]=ue[ye].replace(/[=][0-9A-Fa-f]{2}/g,function(Ce){return String.fromCharCode(parseInt(Ce.slice(1),16))});return Ql(ue.join(`\r
`))}function Te(se,ue,J){for(var fe="",ye="",Ce="",wt,Qe=0;Qe<10;++Qe){var Ie=ue[Qe];if(!Ie||Ie.match(/^\s*$/))break;var Re=Ie.match(/^(.*?):\s*([^\s].*)$/);if(Re)switch(Re[1].toLowerCase()){case"content-location":fe=Re[2].trim();break;case"content-type":Ce=Re[2].trim();break;case"content-transfer-encoding":ye=Re[2].trim();break}}switch(++Qe,ye.toLowerCase()){case"base64":wt=Ql(cc(ue.slice(Qe).join("")));break;case"quoted-printable":wt=dn(ue.slice(Qe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ye)}var xt=jt(se,fe.slice(J.length),wt,{unsafe:!0});Ce&&(xt.ctype=Ce)}function tt(se,ue){if(V(se.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=ue&&ue.root||"",fe=(mi&&Buffer.isBuffer(se)?se.toString("binary"):V(se)).split(`\r
`),ye=0,Ce="";for(ye=0;ye<fe.length;++ye)if(Ce=fe[ye],!!/^Content-Location:/i.test(Ce)&&(Ce=Ce.slice(Ce.indexOf("file")),J||(J=Ce.slice(0,Ce.lastIndexOf("/")+1)),Ce.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),Ce.slice(0,J.length)!=J););var wt=(fe[1]||"").match(/boundary="(.*?)"/);if(!wt)throw new Error("MAD cannot find boundary");var Qe="--"+(wt[1]||""),Ie=[],Re=[],xt={FileIndex:Ie,FullPaths:Re};A(xt);var Gt,qt=0;for(ye=0;ye<fe.length;++ye){var Wt=fe[ye];Wt!==Qe&&Wt!==Qe+"--"||(qt++&&Te(xt,fe.slice(Gt,ye),J),Gt=ye)}return xt}function st(se,ue){var J=ue||{},fe=J.boundary||"SheetJS";fe="------="+fe;for(var ye=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+fe.slice(2)+'"',"","",""],Ce=se.FullPaths[0],wt=Ce,Qe=se.FileIndex[0],Ie=1;Ie<se.FullPaths.length;++Ie)if(wt=se.FullPaths[Ie].slice(Ce.length),Qe=se.FileIndex[Ie],!(!Qe.size||!Qe.content||wt=="Sh33tJ5")){wt=wt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Zt){return"_x"+Zt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Zt){return"_u"+Zt.charCodeAt(0).toString(16)+"_"});for(var Re=Qe.content,xt=mi&&Buffer.isBuffer(Re)?Re.toString("binary"):V(Re),Gt=0,qt=Math.min(1024,xt.length),Wt=0,vt=0;vt<=qt;++vt)(Wt=xt.charCodeAt(vt))>=32&&Wt<128&&++Gt;var Rt=Gt>=qt*4/5;ye.push(fe),ye.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+wt),ye.push("Content-Transfer-Encoding: "+(Rt?"quoted-printable":"base64")),ye.push("Content-Type: "+nn(Qe,wt)),ye.push(""),ye.push(Rt?Ir(xt):fn(xt))}return ye.push(fe+`--\r
`),ye.join(`\r
`)}function kt(se){var ue={};return A(ue,se),ue}function jt(se,ue,J,fe){var ye=fe&&fe.unsafe;ye||A(se);var Ce=!ye&&In.find(se,ue);if(!Ce){var wt=se.FullPaths[0];ue.slice(0,wt.length)==wt?wt=ue:(wt.slice(-1)!="/"&&(wt+="/"),wt=(wt+ue).replace("//","/")),Ce={name:i(ue),type:2},se.FileIndex.push(Ce),se.FullPaths.push(wt),ye||In.utils.cfb_gc(se)}return Ce.content=J,Ce.size=J?J.length:0,fe&&(fe.CLSID&&(Ce.clsid=fe.CLSID),fe.mt&&(Ce.mt=fe.mt),fe.ct&&(Ce.ct=fe.ct)),Ce}function ar(se,ue){A(se);var J=In.find(se,ue);if(J){for(var fe=0;fe<se.FileIndex.length;++fe)if(se.FileIndex[fe]==J)return se.FileIndex.splice(fe,1),se.FullPaths.splice(fe,1),!0}return!1}function tr(se,ue,J){A(se);var fe=In.find(se,ue);if(fe){for(var ye=0;ye<se.FileIndex.length;++ye)if(se.FileIndex[ye]==fe)return se.FileIndex[ye].name=i(J),se.FullPaths[ye]=J,!0}return!1}function Er(se){M(se,!0)}return t.find=E,t.read=k,t.parse=d,t.write=ae,t.writeFile=W,t.utils={cfb_new:kt,cfb_add:jt,cfb_del:ar,cfb_mov:tr,cfb_gc:Er,ReadShift:Ex,CheckField:_$,prep_blob:mo,bconcat:Gs,use_zlib:C,_deflateRaw:ce,_inflateRaw:yr,consts:de},t}();function Wne(e){return typeof e=="string"?jS(e):Array.isArray(e)?mne(e):e}function ry(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=jS(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ku(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([Wne(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(e);return l.open("w"),l.encoding="binary",Array.isArray(t)&&(t=kh(t)),l.write(t),l.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function qne(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ka(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function dP(e,t){for(var r=[],n=Ka(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function AS(e){for(var t=[],r=Ka(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function NS(e){for(var t=[],r=Ka(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Hne(e){for(var t=[],r=Ka(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var B2=new Date(1899,11,30,0,0,0);function Ms(e,t){var r=e.getTime(),n=B2.getTime()+(e.getTimezoneOffset()-B2.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var r$=new Date,Vne=B2.getTime()+(r$.getTimezoneOffset()-B2.getTimezoneOffset())*6e4,fP=r$.getTimezoneOffset();function CS(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Vne),t.getTimezoneOffset()!==fP&&t.setTime(t.getTime()+(t.getTimezoneOffset()-fP)*6e4),t}function Gne(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var hP=new Date("2017-02-19T19:06:09.000Z"),n$=isNaN(hP.getFullYear())?new Date("2/19/17"):hP,Kne=n$.getFullYear()==2017;function xa(e,t){var r=new Date(e);if(Kne)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(n$.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function _0(e,t){if(mi&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ku(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ku(q9(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ku(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ku(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function ya(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ya(e[r]));return t}function qa(e,t){for(var r="";r.length<t;)r+=e;return r}function mu(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Yne=["january","february","march","april","may","june","july","august","september","october","november","december"];function Im(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&Yne.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Xne=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(i),o.push(s[l]);return o}}();function i$(e){return e?e.content&&e.type?_0(e.content,!0):e.data?hx(e.data):e.asNodeBuffer&&mi?hx(e.asNodeBuffer().toString("binary")):e.asBinary?hx(e.asBinary()):e._data&&e._data.getContent?hx(_0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function a$(e){if(!e)return null;if(e.data)return tP(e.data);if(e.asNodeBuffer&&mi)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?tP(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Qne(e){return e&&e.name.slice(-4)===".bin"?a$(e):i$(e)}function Oc(e,t){for(var r=e.FullPaths||Ka(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function LN(e,t){var r=Oc(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function hs(e,t,r){if(!r)return Qne(LN(e,t));if(!t)return null;try{return hs(e,t)}catch{return null}}function Jl(e,t,r){if(!r)return i$(LN(e,t));if(!t)return null;try{return Jl(e,t)}catch{return null}}function Jne(e,t,r){return a$(LN(e,t))}function pP(e){for(var t=e.FullPaths||Ka(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function di(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return mi?n=uf(r):n=gne(r),In.utils.cfb_add(e,t,n)}In.utils.cfb_add(e,t,r)}else e.file(t,r)}function RN(){return In.utils.cfb_new()}function s$(e,t){switch(t.type){case"base64":return In.read(e,{type:"base64"});case"binary":return In.read(e,{type:"binary"});case"buffer":case"array":return In.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function mx(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var ls=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Zne=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,mP=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,eie=/<[^>]*>/g,Go=ls.match(mP)?mP:eie,tie=/<\w*:/,rie=/<(\/?)\w+:/;function Vn(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(Zne),l=0,c="",u=0,d="",f="",p=1;if(o)for(u=0;u!=o.length;++u){for(f=o[u],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(d=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(p=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+p,f.length-p),l=0;l!=d.length&&d.charCodeAt(l)!==58;++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var h=(l===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(l+1);if(n[h]&&d.slice(l-3,l)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function ld(e){return e.replace(rie,"<$1")}var o$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},FN=AS(o$),ki=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(l,c){return o$[l]||String.fromCharCode(parseInt(c,l.indexOf("x")>-1?16:10))||l}).replace(t,function(l,c){return String.fromCharCode(parseInt(c,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}}(),BN=/[&<>'"]/g,nie=/[\u0000-\u0008\u000b-\u001f]/g;function Vi(e){var t=e+"";return t.replace(BN,function(r){return FN[r]}).replace(nie,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function gP(e){return Vi(e).replace(/ /g,"_x0020_")}var l$=/[\u0000-\u001f]/g;function IN(e){var t=e+"";return t.replace(BN,function(r){return FN[r]}).replace(/\n/g,"<br/>").replace(l$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function iie(e){var t=e+"";return t.replace(BN,function(r){return FN[r]}).replace(l$,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var xP=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function aie(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function pa(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Q5(e){for(var t="",r=0,n=0,i=0,s=0,o=0,l=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),l=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(l>>>10&1023)),t+=String.fromCharCode(56320+(l&1023))}return t}function yP(e){var t=hh(2*e.length),r,n,i=1,s=0,o=0,l;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?r=l:l<224?(r=(l&31)*64+(e.charCodeAt(n+1)&63),i=2):l<240?(r=(l&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(l&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function bP(e){return uf(e,"binary").toString("utf8")}var wb="foo bar baz",Ji=mi&&(bP(wb)==Q5(wb)&&bP||yP(wb)==Q5(wb)&&yP)||Q5,Ku=mi?function(e){return uf(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},f1=function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),c$=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),sie=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),oie=/<\/?(?:vt:)?variant>/g,lie=/<(?:vt:)([^>]*)>([\s\S]*)</;function vP(e,t){var r=Vn(e),n=e.match(sie(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(oie,"").match(lie);o&&i.push({v:Ji(o[2]),t:o[1]})}),i}var u$=/(^\s|\s$|\n)/;function go(e,t){return"<"+e+(t.match(u$)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function h1(e){return Ka(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function tn(e,t,r){return"<"+e+(r!=null?h1(r):"")+(t!=null?(t.match(u$)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function I4(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function cie(e,t){switch(typeof e){case"string":var r=tn("vt:lpwstr",Vi(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return tn((e|0)==e?"vt:i4":"vt:r8",Vi(String(e)));case"boolean":return tn("vt:bool",e?"true":"false")}if(e instanceof Date)return tn("vt:filetime",I4(e));throw new Error("Unable to serialize "+e)}function DN(e){if(mi&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ji(kh(PN(e)));throw new Error("Bad input format: expected Buffer or string")}var p1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Ps={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Y0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Yl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function uie(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function die(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var l=0;l<=5;++l,s/=256)e[r+l]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var wP=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},SP=mi?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:uf(t)})):wP(e)}:wP,_P=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Ld(e,i)));return n.join("").replace(al,"")},$N=mi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(al,""):_P(e,t,r)}:_P,jP=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},d$=mi?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):jP(e,t,r)}:jP,kP=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Lp(e,i)));return n.join("")},ny=mi?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):kP(t,r,n)}:kP,f$=function(e,t){var r=Xl(e,t);return r>0?ny(e,t+4,t+4+r-1):""},h$=f$,p$=function(e,t){var r=Xl(e,t);return r>0?ny(e,t+4,t+4+r-1):""},m$=p$,g$=function(e,t){var r=2*Xl(e,t);return r>0?ny(e,t+4,t+4+r-1):""},x$=g$,y$=function(t,r){var n=Xl(t,r);return n>0?$N(t,r+4,r+4+n):""},b$=y$,v$=function(e,t){var r=Xl(e,t);return r>0?ny(e,t+4,t+4+r):""},w$=v$,S$=function(e,t){return uie(e,t)},I2=S$,UN=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};mi&&(h$=function(t,r){if(!Buffer.isBuffer(t))return f$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},m$=function(t,r){if(!Buffer.isBuffer(t))return p$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},x$=function(t,r){if(!Buffer.isBuffer(t))return g$(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},b$=function(t,r){if(!Buffer.isBuffer(t))return y$(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},w$=function(t,r){if(!Buffer.isBuffer(t))return v$(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},I2=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):S$(t,r)},UN=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Lp=function(e,t){return e[t]},Ld=function(e,t){return e[t+1]*256+e[t]},fie=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Xl=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},qh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},hie=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ex(e,t){var r="",n,i,s=[],o,l,c,u;switch(t){case"dbcs":if(u=this.l,mi&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ld(this,u)),u+=2;e*=2;break;case"utf8":r=ny(this,this.l,this.l+e);break;case"utf16le":e*=2,r=$N(this,this.l,this.l+e);break;case"wstr":return Ex.call(this,e,"dbcs");case"lpstr-ansi":r=h$(this,this.l),e=4+Xl(this,this.l);break;case"lpstr-cp":r=m$(this,this.l),e=4+Xl(this,this.l);break;case"lpwstr":r=x$(this,this.l),e=4+2*Xl(this,this.l);break;case"lpp4":e=4+Xl(this,this.l),r=b$(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Xl(this,this.l),r=w$(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Lp(this,this.l+e++))!==0;)s.push(vb(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Ld(this,this.l+e))!==0;)s.push(vb(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Lp(this,u),this.l=u+1,l=Ex.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(vb(Ld(this,u))),u+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Lp(this,u),this.l=u+1,l=Ex.call(this,e-c,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(vb(Lp(this,u))),u+=1}r=s.join("");break;default:switch(e){case 1:return n=Lp(this,this.l),this.l++,n;case 2:return n=(t==="i"?fie:Ld)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?qh:hie)(this,this.l),this.l+=4,n):(i=Xl(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=I2(this,this.l):i=I2([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=d$(this,this.l,e);break}}return this.l+=e,r}var pie=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},mie=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},gie=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function xie(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)gie(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,pie(this,t,this.l);break;case 8:if(n=8,r==="f"){die(this,t,this.l);break}case 16:break;case-4:n=4,mie(this,t,this.l);break}return this.l+=n,this}function _$(e,t){var r=d$(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function mo(e,t){e.l=t,e.read_shift=Ex,e.chk=_$,e.write_shift=xie}function Ho(e,t){e.l+=t}function _r(e){var t=hh(e);return mo(t,0),t}function df(e,t,r){if(e){var n,i,s;mo(e,e.l||0);for(var o=e.length,l=0,c=0;e.l<o;){l=e.read_shift(1),l&128&&(l=(l&127)+((e.read_shift(1)&127)<<7));var u=v1[l]||v1[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;c=e.l+s;var d=u.f&&u.f(e,s,r);if(e.l=c,t(d,u,l))return}}}function Pl(){var e=[],t=mi?256:2048,r=function(u){var d=_r(u);return mo(d,0),d},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},o=function(){return i(),Gs(e)},l=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:l,end:o,_bufs:e}}function Rr(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=v1[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&UN(r)&&e.push(r)}}function Tx(e,t,r){var n=ya(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function AP(e,t,r){var n=ya(e);return n.s=Tx(n.s,t.s,r),n.e=Tx(n.e,t.s,r),n}function Px(e,t){if(e.cRel&&e.c<0)for(e=ya(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ya(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Hn(e);return!e.cRel&&e.cRel!=null&&(r=vie(r)),!e.rRel&&e.rRel!=null&&(r=yie(r)),r}function J5(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ta(e.s.c)+":"+(e.e.cRel?"":"$")+Ta(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+os(e.s.r)+":"+(e.e.rRel?"":"$")+os(e.e.r):Px(e.s,t.biff)+":"+Px(e.e,t.biff)}function zN(e){return parseInt(bie(e),10)-1}function os(e){return""+(e+1)}function yie(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function bie(e){return e.replace(/\$(\d+)$/,"$1")}function WN(e){for(var t=wie(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ta(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function vie(e){return e.replace(/^([A-Z])/,"$$$1")}function wie(e){return e.replace(/^\$([A-Z])/,"$1")}function Sie(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pa(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function Hn(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ol(e){var t=e.indexOf(":");return t==-1?{s:Pa(e),e:Pa(e)}:{s:Pa(e.slice(0,t)),e:Pa(e.slice(t+1))}}function si(e,t){return typeof t>"u"||typeof t=="number"?si(e.s,e.e):(typeof e!="string"&&(e=Hn(e)),typeof t!="string"&&(t=Hn(t)),e==t?e:e+":"+t)}function Ai(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function NP(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Wc(e.z,r?Ms(t):t)}catch{}try{return e.w=Wc((e.XF||{}).numFmtId||(r?14:0),r?Ms(t):t)}catch{return""+t}}function Xd(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ff[e.v]||e.v:t==null?NP(e,e.v):NP(e,t))}function Ah(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function j$(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,l=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Pa(n.origin):n.origin;o=c.r,l=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Ai(s["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),o==-1&&(u.e.r=o=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[f].length;++p)if(!(typeof t[f][p]>"u")){var h={v:t[f][p]},m=o+f,g=l+p;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),t[f][p]&&typeof t[f][p]=="object"&&!Array.isArray(t[f][p])&&!(t[f][p]instanceof Date))h=t[f][p];else if(Array.isArray(h.v)&&(h.f=t[f][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||qn[14],n.cellDates?(h.t="d",h.w=Wc(h.z,Ms(h.v))):(h.t="n",h.v=Ms(h.v),h.w=Wc(h.z,h.v))):h.t="s";if(i)s[m]||(s[m]=[]),s[m][g]&&s[m][g].z&&(h.z=s[m][g].z),s[m][g]=h;else{var y=Hn({c:g,r:m});s[y]&&s[y].z&&(h.z=s[y].z),s[y]=h}}}return u.s.c<1e7&&(s["!ref"]=si(u)),s}function ug(e,t){return j$(null,e,t)}function _ie(e){return e.read_shift(4,"i")}function gu(e,t){return t||(t=_r(4)),t.write_shift(4,e),t}function zo(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ys(e,t){var r=!1;return t==null&&(r=!0,t=_r(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function jie(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function kie(e,t){return t||(t=_r(4)),t.write_shift(2,0),t.write_shift(2,0),t}function qN(e,t){var r=e.l,n=e.read_shift(1),i=zo(e),s=[],o={t:i,h:i};if(n&1){for(var l=e.read_shift(4),c=0;c!=l;++c)s.push(jie(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function Aie(e,t){var r=!1;return t==null&&(r=!0,t=_r(15+4*e.t.length)),t.write_shift(1,0),Ys(e.t,t),r?t.slice(0,t.l):t}var Nie=qN;function Cie(e,t){var r=!1;return t==null&&(r=!0,t=_r(23+4*e.t.length)),t.write_shift(1,1),Ys(e.t,t),t.write_shift(4,1),kie({},t),r?t.slice(0,t.l):t}function Kc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function X0(e,t){return t==null&&(t=_r(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Q0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function J0(e,t){return t==null&&(t=_r(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Eie=zo,k$=Ys;function HN(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function D2(e,t){var r=!1;return t==null&&(r=!0,t=_r(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Tie=zo,D4=HN,VN=D2;function GN(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?I2([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):qh(t,0)>>2;return r?i/100:i}function A$(e,t){t==null&&(t=_r(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function N$(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Pie(e,t){return t||(t=_r(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Z0=N$,dg=Pie;function Do(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function j0(e,t){return(t||_r(8)).write_shift(8,e,"f")}function Oie(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=s0[i];u&&(t.rgb=g1(u));break;case 2:t.rgb=g1([o,l,c]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function $2(e,t){if(t||(t=_r(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Mie(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Lie(e,t){t||(t=_r(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function C$(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Rie(e){return C$(e,1)}function Fie(e){return C$(e,2)}var KN=2,bl=3,Sb=11,CP=12,U2=19,_b=64,Bie=65,Iie=71,Die=4108,$ie=4126,Ws=80,E$=81,Uie=[Ws,E$],$4={1:{n:"CodePage",t:KN},2:{n:"Category",t:Ws},3:{n:"PresentationFormat",t:Ws},4:{n:"ByteCount",t:bl},5:{n:"LineCount",t:bl},6:{n:"ParagraphCount",t:bl},7:{n:"SlideCount",t:bl},8:{n:"NoteCount",t:bl},9:{n:"HiddenCount",t:bl},10:{n:"MultimediaClipCount",t:bl},11:{n:"ScaleCrop",t:Sb},12:{n:"HeadingPairs",t:Die},13:{n:"TitlesOfParts",t:$ie},14:{n:"Manager",t:Ws},15:{n:"Company",t:Ws},16:{n:"LinksUpToDate",t:Sb},17:{n:"CharacterCount",t:bl},19:{n:"SharedDoc",t:Sb},22:{n:"HyperlinksChanged",t:Sb},23:{n:"AppVersion",t:bl,p:"version"},24:{n:"DigSig",t:Bie},26:{n:"ContentType",t:Ws},27:{n:"ContentStatus",t:Ws},28:{n:"Language",t:Ws},29:{n:"Version",t:Ws},255:{},2147483648:{n:"Locale",t:U2},2147483651:{n:"Behavior",t:U2},1919054434:{}},U4={1:{n:"CodePage",t:KN},2:{n:"Title",t:Ws},3:{n:"Subject",t:Ws},4:{n:"Author",t:Ws},5:{n:"Keywords",t:Ws},6:{n:"Comments",t:Ws},7:{n:"Template",t:Ws},8:{n:"LastAuthor",t:Ws},9:{n:"RevNumber",t:Ws},10:{n:"EditTime",t:_b},11:{n:"LastPrinted",t:_b},12:{n:"CreatedDate",t:_b},13:{n:"ModifiedDate",t:_b},14:{n:"PageCount",t:bl},15:{n:"WordCount",t:bl},16:{n:"CharCount",t:bl},17:{n:"Thumbnail",t:Iie},18:{n:"Application",t:Ws},19:{n:"DocSecurity",t:bl},255:{},2147483648:{n:"Locale",t:U2},2147483651:{n:"Behavior",t:U2},1919054434:{}},EP={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zie=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Wie(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var qie=Wie([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),s0=ya(qie),ff={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},T$={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},z4={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},jb={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function YN(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Hie(e){var t=YN();if(!e||!e.match)return t;var r={};if((e.match(Go)||[]).forEach(function(n){var i=Vn(n);switch(i[0].replace(tie,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[z4[i.ContentType]]!==void 0&&t[z4[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Ps.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function P$(e,t){var r=Hne(z4),n=[],i;n[n.length]=ls,n[n.length]=tn("Types",null,{xmlns:Ps.CT,"xmlns:xsd":Ps.xsd,"xmlns:xsi":Ps.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return tn("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){e[c]&&e[c].length>0&&(i=e[c][0],n[n.length]=tn("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:jb[c][t.bookType]||jb[c].xlsx}))},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=tn("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:jb[c][t.bookType]||jb[c].xlsx})})},l=function(c){(e[c]||[]).forEach(function(u){n[n.length]=tn("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return s("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var gi={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function m1(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ox(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Go)||[]).forEach(function(i){var s=Vn(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l=s.TargetMode==="External"?s.Target:mx(s.Target,t);r[l]=o,n[s.Id]=o}}),r["!id"]=n,r}function pm(e){var t=[ls,tn("Relationships",null,{xmlns:Ps.RELS})];return Ka(e["!id"]).forEach(function(r){t[t.length]=tn("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Wi(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[gi.HLINK,gi.XPATH,gi.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var Vie="application/vnd.oasis.opendocument.spreadsheet";function Gie(e,t){for(var r=DN(e),n,i;n=p1.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Vn(n[0],!1),i.path=="/"&&i.type!==Vie)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Kie(e){var t=[ls];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function TP(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Yie(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Xie(e){var t=[ls];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(TP(e[r][0],e[r][1])),t.push(Yie("",e[r][0]));return t.push(TP("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function O$(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+M2.version+"</meta:generator></office:meta></office:document-meta>"}var $c=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Qie=function(){for(var e=new Array($c.length),t=0;t<$c.length;++t){var r=$c[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function M$(e){var t={};e=Ji(e);for(var r=0;r<$c.length;++r){var n=$c[r],i=e.match(Qie[r]);i!=null&&i.length>0&&(t[n[1]]=ki(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=xa(t[n[1]]))}return t}function Z5(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Vi(t),n[n.length]=r?tn(e,t,r):go(e,t))}function L$(e,t){var r=t||{},n=[ls,tn("cp:coreProperties",null,{"xmlns:cp":Ps.CORE_PROPS,"xmlns:dc":Ps.dc,"xmlns:dcterms":Ps.dcterms,"xmlns:dcmitype":Ps.dcmitype,"xmlns:xsi":Ps.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Z5("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:I4(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Z5("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:I4(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=$c.length;++s){var o=$c[s],l=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Z5(o[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var o0=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],R$=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function F$(e,t,r,n){var i=[];if(typeof e=="string")i=vP(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(d){return{v:d}}));var o=typeof t=="string"?vP(t,n).map(function(d){return d.v}):t,l=0,c=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(c=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=o.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=o.slice(l,l+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=o.slice(l,l+c);break}l+=c}}function Jie(e,t,r){var n={};return t||(t={}),e=Ji(e),o0.forEach(function(i){var s=(e.match(f1(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=ki(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&F$(n.HeadingPairs,n.TitlesOfParts,t,r),t}function B$(e){var t=[],r=tn;return e||(e={}),e.Application="SheetJS",t[t.length]=ls,t[t.length]=tn("Properties",null,{xmlns:Ps.EXT_PROPS,"xmlns:vt":Ps.vt}),o0.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Vi(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Vi(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Zie=/<[^>]+>[^<]*/g;function eae(e,t){var r={},n="",i=e.match(Zie);if(i)for(var s=0;s!=i.length;++s){var o=i[s],l=Vn(o);switch(l[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ki(l.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var c=o.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=ki(d);break;case"bool":r[n]=pa(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=xa(d);break;case"cy":case"error":r[n]=ki(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,c)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function I$(e){var t=[ls,tn("Properties",null,{xmlns:Ps.CUST_PROPS,"xmlns:vt":Ps.vt})];if(!e)return t.join("");var r=1;return Ka(e).forEach(function(i){++r,t[t.length]=tn("property",cie(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Vi(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var W4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},ej;function tae(e,t,r){ej||(ej=AS(W4)),t=ej[t]||t,e[t]=r}function rae(e,t){var r=[];return Ka(W4).map(function(n){for(var i=0;i<$c.length;++i)if($c[i][1]==n)return $c[i];for(i=0;i<o0.length;++i)if(o0[i][1]==n)return o0[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(go(W4[n[1]]||n[1],i))}}),tn("DocumentProperties",r.join(""),{xmlns:Yl.o})}function nae(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Ka(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<$c.length;++o)if(s==$c[o][1])return;for(o=0;o<o0.length;++o)if(s==o0[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var l=e[s],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),i.push(tn(gP(s),l,{"dt:dt":c}))}}),t&&Ka(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(tn(gP(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+Yl.o+'">'+i.join("")+"</"+n+">"}function XN(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function iae(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=_r(8);return o.write_shift(4,n),o.write_shift(4,i),o}function D$(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function $$(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function U$(e,t,r){return t===31?$$(e):D$(e,t,r)}function q4(e,t,r){return U$(e,t,r===!1?0:4)}function aae(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return U$(e,t,0)}function sae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(al,""),e.l-i&2&&(e.l+=2)}return r}function oae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(al,"");return r}function lae(e){var t=e.l,r=z2(e,E$);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=z2(e,bl);return[r,n]}function cae(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(lae(e));return r}function PP(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(al,"").replace(px,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function z$(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function uae(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function z2(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==CP&&n!==t&&Uie.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===CP?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return D$(e,n,4).replace(al,"");case 31:return $$(e);case 64:return XN(e);case 65:return z$(e);case 71:return uae(e);case 80:return q4(e,n,!s.raw).replace(al,"");case 81:return aae(e,n).replace(al,"");case 4108:return cae(e);case 4126:case 4127:return n==4127?sae(e):oae(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function OP(e,t){var r=_r(4),n=_r(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=_r(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=iae(t);break;case 31:case 80:for(n=_r(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Gs([r,n])}function MP(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,l=0,c=-1,u={};for(o=0;o!=i;++o){var d=e.read_shift(4),f=e.read_shift(4);s[o]=[d,f+r]}s.sort(function(v,w){return v[1]-w[1]});var p={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var h=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,h=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],h=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],h=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(h=!1,e.l=s[o][1]),h)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var m=t[s[o][0]];if(p[m.n]=z2(e,m.t,{raw:!0}),m.p==="version"&&(p[m.n]=String(p[m.n]>>16)+"."+("0000"+String(p[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(p[m.n]){case 0:p[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:du(l=p[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[m.n])}}else if(s[o][0]===1){if(l=p.CodePage=z2(e,KN),du(l),c!==-1){var g=e.l;e.l=s[c][1],u=PP(e,l),e.l=g}}else if(s[o][0]===0){if(l===0){c=o,e.l=s[o+1][1];continue}u=PP(e,l)}else{var y=u[s[o][0]],b;switch(e[e.l]){case 65:e.l+=4,b=z$(e);break;case 30:e.l+=4,b=q4(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,b=q4(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,b=e.read_shift(4,"i");break;case 19:e.l+=4,b=e.read_shift(4);break;case 5:e.l+=4,b=e.read_shift(8,"f");break;case 11:e.l+=4,b=Za(e,4);break;case 64:e.l+=4,b=xa(XN(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[y]=b}}return e.l=r+n,p}var W$=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function dae(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function LP(e,t,r){var n=_r(8),i=[],s=[],o=8,l=0,c=_r(8),u=_r(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),s.push(c),i.push(u),o+=8+c.length,!t){u=_r(8),u.write_shift(4,0),i.unshift(u);var d=[_r(4)];for(d[0].write_shift(4,e.length),l=0;l<e.length;++l){var f=e[l][0];for(c=_r(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Gs(d),s.unshift(c),o+=8+c.length}for(l=0;l<e.length;++l)if(!(t&&!t[e[l][0]])&&!(W$.indexOf(e[l][0])>-1||R$.indexOf(e[l][0])>-1)&&e[l][1]!=null){var p=e[l][1],h=0;if(t){h=+t[e[l][0]];var m=r[h];if(m.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}c=OP(m.t,p)}else{var y=dae(p);y==-1&&(y=31,p=String(p)),c=OP(y,p)}s.push(c),u=_r(8),u.write_shift(4,t?h:2+l),i.push(u),o+=8+c.length}var b=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,b),b+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),Gs([n].concat(i).concat(s))}function RP(e,t,r){var n=e.content;if(!n)return{};mo(n,0);var i,s,o,l,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==In.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),l=n.read_shift(4),i===1&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);i===2&&(o=n.read_shift(16),c=n.read_shift(4));var f=MP(n,t),p={SystemIdentifier:u};for(var h in f)p[h]=f[h];if(p.FMTID=s,i===1)return p;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=MP(n,null)}catch{}for(h in m)p[h]=m[h];return p.FMTID=[s,o],p}function FP(e,t,r,n,i,s){var o=_r(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,In.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var c=LP(e,r,n);if(l.push(c),i){var u=LP(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+c.length),l.push(u)}return Gs(l)}function Nf(e,t){return e.read_shift(t),null}function fae(e,t){t||(t=_r(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function hae(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function Za(e,t){return e.read_shift(t)===1}function tl(e,t){return t||(t=_r(2)),t.write_shift(2,+!!e),t}function ps(e){return e.read_shift(2,"u")}function Mc(e,t){return t||(t=_r(2)),t.write_shift(2,e),t}function q$(e,t){return hae(e,t,ps)}function pae(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function H$(e,t,r){return r||(r=_r(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function iy(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function mae(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,l,c={};i&&(o=e.read_shift(2)),n&&(l=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*o),n&&(e.l+=l),c.t=d,i||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function gae(e){var t=e.t||"",r=_r(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=_r(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Gs(i)}function k0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function ay(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):k0(e,n,r)}function ep(e,t,r){if(r.biff>5)return ay(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function V$(e,t,r){return r||(r=_r(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function xae(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function yae(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(al,"");return n&&(e.l+=24),i}function bae(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(al,"");return r+o}function vae(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return yae(e);case"0303000000000000c000000000000046":return bae(e);default:throw new Error("Unsupported Moniker "+r)}}function kb(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(al,""):"";return r}function BP(e,t){t||(t=_r(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function wae(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,l,c,u="",d,f;i&16&&(s=kb(e,r-e.l)),i&128&&(o=kb(e,r-e.l)),(i&257)===257&&(l=kb(e,r-e.l)),(i&257)===1&&(c=vae(e,r-e.l)),i&8&&(u=kb(e,r-e.l)),i&32&&(d=e.read_shift(16)),i&64&&(f=XN(e)),e.l=r;var p=o||l||c||"";p&&u&&(p+="#"+u),p||(p="#"+u),i&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var h={Target:p};return d&&(h.guid=d),f&&(h.time=f),s&&(h.Tooltip=s),h}function Sae(e){var t=_r(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),BP(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var l=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(l.length+1)),r=0;r<l.length;++r)t.write_shift(2,l.charCodeAt(r));t.write_shift(2,0),s&8&&BP(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function G$(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function K$(e,t){var r=G$(e);return r[3]=0,r}function cd(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function A0(e,t,r,n){return n||(n=_r(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function _ae(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function jae(e,t,r){return t===0?"":ep(e,t,r)}function kae(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function Y$(e){var t=e.read_shift(2),r=GN(e);return[t,r]}function Aae(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=iy(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function ES(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function X$(e,t){return t||(t=_r(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Q$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var Nae=Q$;function J$(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Cae(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Eae(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Ao(e){e.l+=2,e.l+=e.read_shift(2)}var Tae={0:Ao,4:Ao,5:Ao,6:Ao,7:Eae,8:Ao,9:Ao,10:Ao,11:Ao,12:Ao,13:Cae,14:Ao,15:Ao,16:Ao,17:Ao,18:Ao,19:Ao,20:Ao,21:J$};function Pae(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(Tae[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Ab(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function QN(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=_r(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Oae(e,t){return t===0||e.read_shift(2),1200}function Mae(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=ep(e,0,r);return e.read_shift(t+n-e.l),i}function Lae(e,t){var r=!t||t.biff==8,n=_r(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Rae(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Fae(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=iy(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function Bae(e,t){var r=!t||t.biff>=8?2:1,n=_r(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Iae(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(mae(e));return s.Count=n,s.Unique=i,s}function Dae(e,t){var r=_r(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=gae(e[i]);var s=Gs([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function $ae(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Uae(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function zae(e){var t=_ae(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Wae(e){return e.read_shift(2),e.read_shift(4)}function IP(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function qae(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:l,Selected:c,TabRatio:u}}function Hae(){var e=_r(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Vae(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Gae(e){var t=_r(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Kae(){}function Yae(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=iy(e,0,r),n}function Xae(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=_r(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function Qae(e){var t=cd(e);return t.isst=e.read_shift(4),t}function Jae(e,t,r,n){var i=_r(10);return A0(e,t,n,i),i.write_shift(4,r),i}function Zae(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=cd(e);r.biff==2&&e.l++;var s=ay(e,n-e.l,r);return i.val=s,i}function ese(e,t,r,n,i){var s=!i||i.biff==8,o=_r(8+ +s+(1+s)*r.length);return A0(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function tse(e,t,r){var n=e.read_shift(2),i=ep(e,0,r);return[n,i]}function rse(e,t,r,n){var i=r&&r.biff==5;n||(n=_r(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var nse=ep;function DP(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c}}}function ise(e,t){var r=t.biff==8||!t.biff?4:2,n=_r(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function ase(e){var t=e.read_shift(2),r=e.read_shift(2),n=Y$(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function sse(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(Y$(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function ose(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function lse(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return i.patternType=zie[l>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=l&127,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function cse(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=lse(e,t,n.fStyle,r),n}function $P(e,t,r,n){var i=r&&r.biff==5;n||(n=_r(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function use(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function dse(e){var t=_r(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function UP(e,t,r){var n=cd(e);(r.biff==2||t==9)&&++e.l;var i=pae(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function fse(e,t,r,n,i,s){var o=_r(8);return A0(e,t,n,o),H$(r,s,o),o}function hse(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=cd(e),i=Do(e);return n.val=i,n}function pse(e,t,r,n){var i=_r(14);return A0(e,t,n,i),j0(r,i),i}var zP=jae;function mse(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=k0(e,s),l=[];n>e.l;)l.push(ay(e));return[s,i,o,l]}function WP(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=Aae(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var gse=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qP(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=k0(e,o,r);i&32&&(u=gse[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||l===0||!(d>0)?[]:Pue(e,d,r,l);return{chKey:s,Name:u,itab:c,rgce:f}}function Z$(e,t,r){if(r.biff<8)return xse(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(kae(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function xse(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=iy(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function yse(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=k0(e,n,r),o=k0(e,i,r);return[s,o]}function bse(e,t,r){var n=Q$(e);e.l++;var i=e.read_shift(1);return t-=8,[Oue(e,t,r),i,n]}function HP(e,t,r){var n=Nae(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Eue(e,t,r)]}function vse(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function wse(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),l=ep(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},l,o,s]}}function Sse(e,t,r){return wse(e,t,r)}function _se(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(ES(e));return r}function jse(e){var t=_r(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)X$(e[r],t);return t}function kse(e,t,r){if(r&&r.biff<8)return Nse(e,t,r);var n=J$(e),i=Pae(e,t-22,n[1]);return{cmo:n,ft:i}}var Ase={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Nse(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((Ase[n]||Ho)(e,t,r)),{cmo:[i,n,s],ft:o}}function Cse(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=xae(e,6,r);var l=e.read_shift(2);e.read_shift(2),ps(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=k0(e,e.lens[u+1]-e.lens[u]-1);if(i+=f,i.length>=(d?l:2*l))break}if(i.length!==l&&i.length!==l*2)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function Ese(e,t){var r=ES(e);e.l+=16;var n=wae(e,t-24);return[r,n]}function Tse(e){var t=_r(24),r=Pa(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Gs([t,Sae(e[1])])}function Pse(e,t){e.read_shift(2);var r=ES(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(al,""),[r,n]}function Ose(e){var t=e[1].Tooltip,r=_r(10+2*(t.length+1));r.write_shift(2,2048);var n=Pa(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function Mse(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=EP[r]||r,r=e.read_shift(2),t[1]=EP[r]||r,t}function Lse(e){return e||(e=_r(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Rse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(K$(e));return r}function Fse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(K$(e));return r}function Bse(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function eU(e,t,r){if(!r.cellStyles)return Ho(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:l,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Ise(e,t){var r=_r(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Dse(e,t){var r={};return t<32||(e.l+=16,r.header=Do(e),r.footer=Do(e),e.l+=2),r}function $se(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function Use(e){for(var t=_r(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var zse=cd,Wse=q$,qse=ay;function Hse(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function Vse(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=cd(e);++e.l;var i=ep(e,t-7,r);return n.t="str",n.val=i,n}function Gse(e){var t=cd(e);++e.l;var r=Do(e);return t.t="n",t.val=r,t}function Kse(e,t,r){var n=_r(15);return cy(n,e,t),n.write_shift(8,r,"f"),n}function Yse(e){var t=cd(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Xse(e,t,r){var n=_r(9);return cy(n,e,t),n.write_shift(2,r),n}function Qse(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Jse(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Zse(e,t,r){var n=e.l+t,i=cd(e),s=e.read_shift(2),o=k0(e,s,r);return e.l=n,i.t="str",i.val=o,i}var eoe=[2,3,48,49,131,139,140,245],H4=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=AS({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(l,c){var u=[],d=hh(1);switch(c.type){case"base64":d=Ql(cc(l));break;case"binary":d=Ql(l);break;case"buffer":case"array":d=l;break}mo(d,0);var f=d.read_shift(1),p=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=d.read_shift(2));var b=d.read_shift(2),v=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(v=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var w=[],S={},j=Math.min(d.length,f==2?521:y-10-(h?264:0)),k=m?32:11;d.l<j&&d[d.l]!=13;)switch(S={},S.name=c1.utils.decode(v,d.slice(d.l,d.l+k)).replace(/[\u0000\r\n].*$/g,""),d.l+=k,S.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(S.offset=d.read_shift(4)),S.len=d.read_shift(1),f==2&&(S.offset=d.read_shift(2)),S.dec=d.read_shift(1),S.name.length&&w.push(S),f!=2&&(d.l+=m?13:14),S.type){case"B":(!h||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var A=0,R=0;for(u[0]=[],R=0;R!=w.length;++R)u[0][R]=w[R].name;for(;g-- >0;){if(d[d.l]===42){d.l+=b;continue}for(++d.l,u[++A]=[],R=0,R=0;R!=w.length;++R){var M=d.slice(d.l,d.l+w[R].len);d.l+=w[R].len,mo(M,0);var B=c1.utils.decode(v,M);switch(w[R].type){case"C":B.trim().length&&(u[A][R]=B.replace(/\s+$/,""));break;case"D":B.length===8?u[A][R]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):u[A][R]=B;break;case"F":u[A][R]=parseFloat(B.trim());break;case"+":case"I":u[A][R]=m?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":u[A][R]=!0;break;case"N":case"F":u[A][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[A][R]="##MEMO##"+(m?parseInt(B.trim(),10):M.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(u[A][R]=+B||0);break;case"@":u[A][R]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":u[A][R]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":u[A][R]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][R]=-M.read_shift(-8,"f");break;case"B":if(h&&w[R].len==8){u[A][R]=M.read_shift(8,"f");break}case"G":case"P":M.l+=w[R].len;break;case"0":if(w[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[R].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=w,u}function n(l,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ug(r(l,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function i(l,c){try{return Ah(n(l,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var u=c||{};if(+u.codepage>=0&&du(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Pl(),f=H2(l,{header:1,raw:!0,cellDates:!0}),p=f[0],h=f.slice(1),m=l["!cols"]||[],g=0,y=0,b=0,v=1;for(g=0;g<p.length;++g){if(((m[g]||{}).DBF||{}).name){p[g]=m[g].DBF.name,++b;continue}if(p[g]!=null){if(++b,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(y=0;y<1024;++y)if(p.indexOf(p[g]+"_"+y)==-1){p[g]+="_"+y;break}}}}var w=Ai(l["!ref"]),S=[],j=[],k=[];for(g=0;g<=w.e.c-w.s.c;++g){var A="",R="",M=0,B=[];for(y=0;y<h.length;++y)h[y][g]!=null&&B.push(h[y][g]);if(B.length==0||p[g]==null){S[g]="?";continue}for(y=0;y<B.length;++y){switch(typeof B[y]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=B[y]instanceof Date?"D":"C";break;default:R="C"}M=Math.max(M,String(B[y]).length),A=A&&A!=R?"C":R}M>250&&(M=250),R=((m[g]||{}).DBF||{}).type,R=="C"&&m[g].DBF.len>M&&(M=m[g].DBF.len),A=="B"&&R=="N"&&(A="N",k[g]=m[g].DBF.dec,M=m[g].DBF.len),j[g]=A=="C"||R=="N"?M:s[A]||0,v+=j[g],S[g]=A}var E=d.next(32);for(E.write_shift(4,318902576),E.write_shift(4,h.length),E.write_shift(2,296+32*b),E.write_shift(2,v),g=0;g<4;++g)E.write_shift(4,0);for(E.write_shift(4,0|(+t[W9]||3)<<8),g=0,y=0;g<p.length;++g)if(p[g]!=null){var P=d.next(32),D=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,D,"sbcs"),P.write_shift(1,S[g]=="?"?"C":S[g],"sbcs"),P.write_shift(4,y),P.write_shift(1,j[g]||s[S[g]]||0),P.write_shift(1,k[g]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),y+=j[g]||s[S[g]]||0}var G=d.next(264);for(G.write_shift(4,13),g=0;g<65;++g)G.write_shift(4,0);for(g=0;g<h.length;++g){var H=d.next(v);for(H.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(S[y]){case"L":H.write_shift(1,h[g][y]==null?63:h[g][y]?84:70);break;case"B":H.write_shift(8,h[g][y]||0,"f");break;case"N":var oe="0";for(typeof h[g][y]=="number"&&(oe=h[g][y].toFixed(k[y]||0)),b=0;b<j[y]-oe.length;++b)H.write_shift(1,32);H.write_shift(1,oe,"sbcs");break;case"D":h[g][y]?(H.write_shift(4,("0000"+h[g][y].getFullYear()).slice(-4),"sbcs"),H.write_shift(2,("00"+(h[g][y].getMonth()+1)).slice(-2),"sbcs"),H.write_shift(2,("00"+h[g][y].getDate()).slice(-2),"sbcs")):H.write_shift(8,"00000000","sbcs");break;case"C":var de=String(h[g][y]!=null?h[g][y]:"").slice(0,j[y]);for(H.write_shift(1,de,"sbcs"),b=0;b<j[y]-de.length;++b)H.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),tU=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ka(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var m=e[h];return typeof m=="number"?rP(m):m},n=function(p,h,m){var g=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?p:rP(g)};e["|"]=254;function i(p,h){switch(h.type){case"base64":return s(cc(p),h);case"binary":return s(p,h);case"buffer":return s(mi&&Buffer.isBuffer(p)?p.toString("binary"):kh(p),h);case"array":return s(_0(p),h)}throw new Error("Unrecognized type "+h.type)}function s(p,h){var m=p.split(/[\n\r]+/),g=-1,y=-1,b=0,v=0,w=[],S=[],j=null,k={},A=[],R=[],M=[],B=0,E;for(+h.codepage>=0&&du(+h.codepage);b!==m.length;++b){B=0;var P=m[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),D=P.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),G=D[0],H;if(P.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&S.push(P.slice(3).replace(/;;/g,";"));break;case"C":var oe=!1,de=!1,W=!1,V=!1,ae=-1,ee=-1;for(v=1;v<D.length;++v)switch(D[v].charAt(0)){case"A":break;case"X":y=parseInt(D[v].slice(1))-1,de=!0;break;case"Y":for(g=parseInt(D[v].slice(1))-1,de||(y=0),E=w.length;E<=g;++E)w[E]=[];break;case"K":H=D[v].slice(1),H.charAt(0)==='"'?H=H.slice(1,H.length-1):H==="TRUE"?H=!0:H==="FALSE"?H=!1:isNaN(mu(H))?isNaN(Im(H).getDate())||(H=xa(H)):(H=mu(H),j!==null&&lg(j)&&(H=CS(H))),oe=!0;break;case"E":V=!0;var C=mm(D[v].slice(1),{r:g,c:y});w[g][y]=[w[g][y],C];break;case"S":W=!0,w[g][y]=[w[g][y],"S5S"];break;case"G":break;case"R":ae=parseInt(D[v].slice(1))-1;break;case"C":ee=parseInt(D[v].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}if(oe&&(w[g][y]&&w[g][y].length==2?w[g][y][0]=H:w[g][y]=H,j=null),W){if(V)throw new Error("SYLK shared formula cannot have own formula");var Y=ae>-1&&w[ae][ee];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");w[g][y][1]=bU(Y[1],{r:g-ae,c:y-ee})}break;case"F":var q=0;for(v=1;v<D.length;++v)switch(D[v].charAt(0)){case"X":y=parseInt(D[v].slice(1))-1,++q;break;case"Y":for(g=parseInt(D[v].slice(1))-1,E=w.length;E<=g;++E)w[E]=[];break;case"M":B=parseInt(D[v].slice(1))/20;break;case"F":break;case"G":break;case"P":j=S[parseInt(D[v].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=D[v].slice(1).split(" "),E=parseInt(M[0],10);E<=parseInt(M[1],10);++E)B=parseInt(M[2],10),R[E-1]=B===0?{hidden:!0}:{wch:B},ph(R[E-1]);break;case"C":y=parseInt(D[v].slice(1))-1,R[y]||(R[y]={});break;case"R":g=parseInt(D[v].slice(1))-1,A[g]||(A[g]={}),B>0?(A[g].hpt=B,A[g].hpx=$m(B)):B===0&&(A[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}q<1&&(j=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}}return A.length>0&&(k["!rows"]=A),R.length>0&&(k["!cols"]=R),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,k]}function o(p,h){var m=i(p,h),g=m[0],y=m[1],b=ug(g,h);return Ka(y).forEach(function(v){b[v]=y[v]}),b}function l(p,h){return Ah(o(p,h),h)}function c(p,h,m,g){var y="C;Y"+(m+1)+";X"+(g+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+nC(p.f,{r:m,c:g}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(p,h){h.forEach(function(m,g){var y="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?y+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=x1(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=y1(m.wpx)),typeof m.wch=="number"&&(y+=Math.round(m.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function d(p,h){h.forEach(function(m,g){var y="F;";m.hidden?y+="M0;":m.hpt?y+="M"+20*m.hpt+";":m.hpx&&(y+="M"+20*b1(m.hpx)+";"),y.length>2&&p.push(y+"R"+(g+1))})}function f(p,h){var m=["ID;PWXL;N;E"],g=[],y=Ai(p["!ref"]),b,v=Array.isArray(p),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),p["!cols"]&&u(m,p["!cols"]),p["!rows"]&&d(m,p["!rows"]),m.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var j=y.s.c;j<=y.e.c;++j){var k=Hn({r:S,c:j});b=v?(p[S]||[])[j]:p[k],!(!b||b.v==null&&(!b.f||b.F))&&g.push(c(b,p,S,j))}return m.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),rU=function(){function e(s,o){switch(o.type){case"base64":return t(cc(s),o);case"binary":return t(s,o);case"buffer":return t(mi&&Buffer.isBuffer(s)?s.toString("binary"):kh(s),o);case"array":return t(_0(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var l=s.split(`
`),c=-1,u=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var p=l[d].trim().split(","),h=p[0],m=p[1];++d;for(var g=l[d]||"";(g.match(/["]/g)||[]).length&1&&d<l.length-1;)g+=`
`+l[++d];switch(g=g.trim(),+h){case-1:if(g==="BOT"){f[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[c][u]=!0:g==="FALSE"?f[c][u]=!1:isNaN(mu(m))?isNaN(Im(m).getDate())?f[c][u]=m:f[c][u]=xa(m):f[c][u]=mu(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function r(s,o){return ug(e(s,o),o)}function n(s,o){return Ah(r(s,o),o)}var i=function(){var s=function(c,u,d,f,p){c.push(u),c.push(d+","+f),c.push('"'+p.replace(/"/g,'""')+'"')},o=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Ai(c["!ref"]),f,p=Array.isArray(c);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,d.e.r-d.s.r+1,""),s(u,"TUPLES",0,d.e.c-d.s.c+1,""),s(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){o(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var g=Hn({r:h,c:m});if(f=p?(c[h]||[])[m]:c[g],!f){o(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?o(u,1,0,"="+f.f):o(u,1,0,""):o(u,0,y,"V");break;case"b":o(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Wc(f.z||qn[14],Ms(xa(f.v)))),o(u,0,f.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var b=`\r
`,v=u.join(b);return v}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),nU=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,p){for(var h=f.split(`
`),m=-1,g=-1,y=0,b=[];y!==h.length;++y){var v=h[y].trim().split(":");if(v[0]==="cell"){var w=Pa(v[1]);if(b.length<=w.r)for(m=b.length;m<=w.r;++m)b[m]||(b[m]=[]);switch(m=w.r,g=w.c,v[2]){case"t":b[m][g]=e(v[3]);break;case"v":b[m][g]=+v[3];break;case"vtf":var S=v[v.length-1];case"vtc":switch(v[3]){case"nl":b[m][g]=!!+v[4];break;default:b[m][g]=+v[4];break}v[2]=="vtf"&&(b[m][g]=[b[m][g],S])}}}return p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),b}function n(f,p){return ug(r(f,p),p)}function i(f,p){return Ah(n(f,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var p=[],h=[],m,g="",y=Ol(f["!ref"]),b=Array.isArray(f),v=y.s.r;v<=y.e.r;++v)for(var w=y.s.c;w<=y.e.c;++w)if(g=Hn({r:v,c:w}),m=b?(f[v]||[])[w]:f[g],!(!m||m.v==null||m.t==="z")){switch(h=["cell",g,"t"],m.t){case"s":case"str":h.push(t(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=t(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var S=Ms(xa(m.v));h[2]="vtc",h[3]="nd",h[4]=""+S,h[5]=m.w||Wc(m.z||qn[14],S);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(f){return[s,o,l,o,u(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),Dm=function(){function e(d,f,p,h,m){m.raw?f[p][h]=d:d===""||(d==="TRUE"?f[p][h]=!0:d==="FALSE"?f[p][h]=!1:isNaN(mu(d))?isNaN(Im(d).getDate())?f[p][h]=d:f[p][h]=xa(d):f[p][h]=mu(d))}function t(d,f){var p=f||{},h=[];if(!d||d.length===0)return h;for(var m=d.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var y=10,b=0,v=0;v<=g;++v)b=m[v].indexOf(" "),b==-1?b=m[v].length:b++,y=Math.max(y,b);for(v=0;v<=g;++v){h[v]=[];var w=0;for(e(m[v].slice(0,y).trim(),h,v,w,p),w=1;w<=(m[v].length-y)/10+1;++w)e(m[v].slice(y+(w-1)*10,y+w*10).trim(),h,v,w,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var f={},p=!1,h=0,m=0;h<d.length;++h)(m=d.charCodeAt(h))==34?p=!p:!p&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[m.pop()[1]]||44}function s(d,f){var p=f||{},h="",m=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=i(d.slice(0,1024)):p&&p.FS?h=p.FS:h=i(d.slice(0,1024));var y=0,b=0,v=0,w=0,S=0,j=h.charCodeAt(0),k=!1,A=0,R=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var M=p.dateNF!=null?$ne(p.dateNF):null;function B(){var E=d.slice(w,S),P={};if(E.charAt(0)=='"'&&E.charAt(E.length-1)=='"'&&(E=E.slice(1,-1).replace(/""/g,'"')),E.length===0)P.t="z";else if(p.raw)P.t="s",P.v=E;else if(E.trim().length===0)P.t="s",P.v=E;else if(E.charCodeAt(0)==61)E.charCodeAt(1)==34&&E.charCodeAt(E.length-1)==34?(P.t="s",P.v=E.slice(2,-1).replace(/""/g,'"')):mce(E)?(P.t="n",P.f=E.slice(1)):(P.t="s",P.v=E);else if(E=="TRUE")P.t="b",P.v=!0;else if(E=="FALSE")P.t="b",P.v=!1;else if(!isNaN(v=mu(E)))P.t="n",p.cellText!==!1&&(P.w=E),P.v=v;else if(!isNaN(Im(E).getDate())||M&&E.match(M)){P.z=p.dateNF||qn[14];var D=0;M&&E.match(M)&&(E=Une(E,p.dateNF,E.match(M)||[]),D=1),p.cellDates?(P.t="d",P.v=xa(E,D)):(P.t="n",P.v=Ms(xa(E,D))),p.cellText!==!1&&(P.w=Wc(P.z,P.v instanceof Date?Ms(P.v):P.v)),p.cellNF||delete P.z}else P.t="s",P.v=E;if(P.t=="z"||(p.dense?(m[y]||(m[y]=[]),m[y][b]=P):m[Hn({c:b,r:y})]=P),w=S+1,R=d.charCodeAt(w),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),A==j)++b;else if(b=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;S<d.length;++S)switch(A=d.charCodeAt(S)){case 34:R===34&&(k=!k);break;case j:case 10:case 13:if(!k&&B())break e;break}return S-w>0&&B(),m["!ref"]=si(g),m}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?s(d,f):ug(t(d,f),f)}function l(d,f){var p="",h=f.type=="string"?[0,0,0,0]:dC(d,f);switch(f.type){case"base64":p=cc(d);break;case"binary":p=d;break;case"buffer":f.codepage==65001?p=d.toString("utf8"):f.codepage&&typeof c1<"u"||(p=mi&&Buffer.isBuffer(d)?d.toString("binary"):kh(d));break;case"array":p=_0(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=Ji(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=Ji(p):f.type=="binary"&&typeof c1<"u",p.slice(0,19)=="socialcalc:version:"?nU.to_sheet(f.type=="string"?p:Ji(p),f):o(p,f)}function c(d,f){return Ah(l(d,f),f)}function u(d){for(var f=[],p=Ai(d["!ref"]),h,m=Array.isArray(d),g=p.s.r;g<=p.e.r;++g){for(var y=[],b=p.s.c;b<=p.e.c;++b){var v=Hn({r:g,c:b});if(h=m?(d[g]||[])[b]:d[v],!h||h.v==null){y.push("          ");continue}for(var w=(h.w||(Xd(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(b===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:u}}();function toe(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=tU.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Dm.to_workbook(e,t)}}var l0=function(){function e(C,Y,q){if(C){mo(C,C.l||0);for(var O=q.Enum||ae;C.l<C.length;){var X=C.read_shift(2),F=O[X]||O[65535],Q=C.read_shift(2),K=C.l+Q,ne=F.f&&F.f(C,Q,q);if(C.l=K,Y(ne,F,X))return}}}function t(C,Y){switch(Y.type){case"base64":return r(Ql(cc(C)),Y);case"binary":return r(Ql(C),Y);case"buffer":case"array":return r(C,Y)}throw"Unsupported type "+Y.type}function r(C,Y){if(!C)return C;var q=Y||{},O=q.dense?[]:{},X="Sheet1",F="",Q=0,K={},ne=[],re=[],T={s:{r:0,c:0},e:{r:0,c:0}},I=q.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)q.Enum=ae,e(C,function(me,Pe,je){switch(je){case 0:q.vers=me,me>=4096&&(q.qpro=!0);break;case 6:T=me;break;case 204:me&&(F=me);break;case 222:F=me;break;case 15:case 51:q.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:je==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=q.dateNF||qn[14],q.cellDates&&(me[1].t="d",me[1].v=CS(me[1].v))),q.qpro&&me[3]>Q&&(O["!ref"]=si(T),K[X]=O,ne.push(X),O=q.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},Q=me[3],X=F||"Sheet"+(Q+1),F="");var Fe=q.dense?(O[me[0].r]||[])[me[0].c]:O[Hn(me[0])];if(Fe){Fe.t=me[1].t,Fe.v=me[1].v,me[1].z!=null&&(Fe.z=me[1].z),me[1].f!=null&&(Fe.f=me[1].f);break}q.dense?(O[me[0].r]||(O[me[0].r]=[]),O[me[0].r][me[0].c]=me[1]):O[Hn(me[0])]=me[1];break}},q);else if(C[2]==26||C[2]==14)q.Enum=ee,C[2]==14&&(q.qpro=!0,C.l=0),e(C,function(me,Pe,je){switch(je){case 204:X=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>Q&&(O["!ref"]=si(T),K[X]=O,ne.push(X),O=q.dense?[]:{},T={s:{r:0,c:0},e:{r:0,c:0}},Q=me[3],X="Sheet"+(Q+1)),I>0&&me[0].r>=I)break;q.dense?(O[me[0].r]||(O[me[0].r]=[]),O[me[0].r][me[0].c]=me[1]):O[Hn(me[0])]=me[1],T.e.c<me[0].c&&(T.e.c=me[0].c),T.e.r<me[0].r&&(T.e.r=me[0].r);break;case 27:me[14e3]&&(re[me[14e3][0]]=me[14e3][1]);break;case 1537:re[me[0]]=me[1],me[0]==Q&&(X=me[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(O["!ref"]=si(T),K[F||X]=O,ne.push(F||X),!re.length)return{SheetNames:ne,Sheets:K};for(var ie={},U=[],Z=0;Z<re.length;++Z)K[ne[Z]]?(U.push(re[Z]||ne[Z]),ie[re[Z]]=K[re[Z]]||K[ne[Z]]):(U.push(re[Z]),ie[re[Z]]={"!ref":"A1"});return{SheetNames:U,Sheets:ie}}function n(C,Y){var q=Y||{};if(+q.codepage>=0&&du(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var O=Pl(),X=Ai(C["!ref"]),F=Array.isArray(C),Q=[];rn(O,0,s(1030)),rn(O,6,c(X));for(var K=Math.min(X.e.r,8191),ne=X.s.r;ne<=K;++ne)for(var re=os(ne),T=X.s.c;T<=X.e.c;++T){ne===X.s.r&&(Q[T]=Ta(T));var I=Q[T]+re,ie=F?(C[ne]||[])[T]:C[I];if(!(!ie||ie.t=="z"))if(ie.t=="n")(ie.v|0)==ie.v&&ie.v>=-32768&&ie.v<=32767?rn(O,13,h(ne,T,ie.v)):rn(O,14,g(ne,T,ie.v));else{var U=Xd(ie);rn(O,15,f(ne,T,U.slice(0,239)))}}return rn(O,1),O.end()}function i(C,Y){var q=Y||{};if(+q.codepage>=0&&du(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var O=Pl();rn(O,0,o(C));for(var X=0,F=0;X<C.SheetNames.length;++X)(C.Sheets[C.SheetNames[X]]||{})["!ref"]&&rn(O,27,V(C.SheetNames[X],F++));var Q=0;for(X=0;X<C.SheetNames.length;++X){var K=C.Sheets[C.SheetNames[X]];if(!(!K||!K["!ref"])){for(var ne=Ai(K["!ref"]),re=Array.isArray(K),T=[],I=Math.min(ne.e.r,8191),ie=ne.s.r;ie<=I;++ie)for(var U=os(ie),Z=ne.s.c;Z<=ne.e.c;++Z){ie===ne.s.r&&(T[Z]=Ta(Z));var me=T[Z]+U,Pe=re?(K[ie]||[])[Z]:K[me];if(!(!Pe||Pe.t=="z"))if(Pe.t=="n")rn(O,23,B(ie,Z,Q,Pe.v));else{var je=Xd(Pe);rn(O,22,A(ie,Z,Q,je.slice(0,239)))}}++Q}}return rn(O,1),O.end()}function s(C){var Y=_r(2);return Y.write_shift(2,C),Y}function o(C){var Y=_r(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var q=0,O=0,X=0,F=0;F<C.SheetNames.length;++F){var Q=C.SheetNames[F],K=C.Sheets[Q];if(!(!K||!K["!ref"])){++X;var ne=Ol(K["!ref"]);q<ne.e.r&&(q=ne.e.r),O<ne.e.c&&(O=ne.e.c)}}return q>8191&&(q=8191),Y.write_shift(2,q),Y.write_shift(1,X),Y.write_shift(1,O),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function l(C,Y,q){var O={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&q.qpro?(O.s.c=C.read_shift(1),C.l++,O.s.r=C.read_shift(2),O.e.c=C.read_shift(1),C.l++,O.e.r=C.read_shift(2),O):(O.s.c=C.read_shift(2),O.s.r=C.read_shift(2),Y==12&&q.qpro&&(C.l+=2),O.e.c=C.read_shift(2),O.e.r=C.read_shift(2),Y==12&&q.qpro&&(C.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function c(C){var Y=_r(8);return Y.write_shift(2,C.s.c),Y.write_shift(2,C.s.r),Y.write_shift(2,C.e.c),Y.write_shift(2,C.e.r),Y}function u(C,Y,q){var O=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(O[0].c=C.read_shift(1),O[3]=C.read_shift(1),O[0].r=C.read_shift(2),C.l+=2):(O[2]=C.read_shift(1),O[0].c=C.read_shift(2),O[0].r=C.read_shift(2)),O}function d(C,Y,q){var O=C.l+Y,X=u(C,Y,q);if(X[1].t="s",q.vers==20768){C.l++;var F=C.read_shift(1);return X[1].v=C.read_shift(F,"utf8"),X}return q.qpro&&C.l++,X[1].v=C.read_shift(O-C.l,"cstr"),X}function f(C,Y,q){var O=_r(7+q.length);O.write_shift(1,255),O.write_shift(2,Y),O.write_shift(2,C),O.write_shift(1,39);for(var X=0;X<O.length;++X){var F=q.charCodeAt(X);O.write_shift(1,F>=128?95:F)}return O.write_shift(1,0),O}function p(C,Y,q){var O=u(C,Y,q);return O[1].v=C.read_shift(2,"i"),O}function h(C,Y,q){var O=_r(7);return O.write_shift(1,255),O.write_shift(2,Y),O.write_shift(2,C),O.write_shift(2,q,"i"),O}function m(C,Y,q){var O=u(C,Y,q);return O[1].v=C.read_shift(8,"f"),O}function g(C,Y,q){var O=_r(13);return O.write_shift(1,255),O.write_shift(2,Y),O.write_shift(2,C),O.write_shift(8,q,"f"),O}function y(C,Y,q){var O=C.l+Y,X=u(C,Y,q);if(X[1].v=C.read_shift(8,"f"),q.qpro)C.l=O;else{var F=C.read_shift(2);S(C.slice(C.l,C.l+F),X),C.l+=F}return X}function b(C,Y,q){var O=Y&32768;return Y&=-32769,Y=(O?C:0)+(Y>=8192?Y-16384:Y),(O?"":"$")+(q?Ta(Y):os(Y))}var v={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(C,Y){mo(C,0);for(var q=[],O=0,X="",F="",Q="",K="";C.l<C.length;){var ne=C[C.l++];switch(ne){case 0:q.push(C.read_shift(8,"f"));break;case 1:F=b(Y[0].c,C.read_shift(2),!0),X=b(Y[0].r,C.read_shift(2),!1),q.push(F+X);break;case 2:{var re=b(Y[0].c,C.read_shift(2),!0),T=b(Y[0].r,C.read_shift(2),!1);F=b(Y[0].c,C.read_shift(2),!0),X=b(Y[0].r,C.read_shift(2),!1),q.push(re+T+":"+F+X)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(C.read_shift(2));break;case 6:{for(var I="";ne=C[C.l++];)I+=String.fromCharCode(ne);q.push('"'+I.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:K=q.pop(),Q=q.pop(),q.push(["AND","OR"][ne-20]+"("+Q+","+K+")");break;default:if(ne<32&&w[ne])K=q.pop(),Q=q.pop(),q.push(Q+w[ne]+K);else if(v[ne]){if(O=v[ne][1],O==69&&(O=C[C.l++]),O>q.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+q.join("|")+"|");return}var ie=q.slice(-O);q.length-=O,q.push(v[ne][0]+"("+ie.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}q.length==1?Y[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function j(C){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=C.read_shift(2),Y[3]=C[C.l++],Y[0].c=C[C.l++],Y}function k(C,Y){var q=j(C);return q[1].t="s",q[1].v=C.read_shift(Y-4,"cstr"),q}function A(C,Y,q,O){var X=_r(6+O.length);X.write_shift(2,C),X.write_shift(1,q),X.write_shift(1,Y),X.write_shift(1,39);for(var F=0;F<O.length;++F){var Q=O.charCodeAt(F);X.write_shift(1,Q>=128?95:Q)}return X.write_shift(1,0),X}function R(C,Y){var q=j(C);q[1].v=C.read_shift(2);var O=q[1].v>>1;if(q[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return q[1].v=O,q}function M(C,Y){var q=j(C),O=C.read_shift(4),X=C.read_shift(4),F=C.read_shift(2);if(F==65535)return O===0&&X===3221225472?(q[1].t="e",q[1].v=15):O===0&&X===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var Q=F&32768;return F=(F&32767)-16446,q[1].v=(1-Q*2)*(X*Math.pow(2,F+32)+O*Math.pow(2,F)),q}function B(C,Y,q,O){var X=_r(14);if(X.write_shift(2,C),X.write_shift(1,q),X.write_shift(1,Y),O==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var F=0,Q=0,K=0,ne=0;return O<0&&(F=1,O=-O),Q=Math.log2(O)|0,O/=Math.pow(2,Q-31),ne=O>>>0,ne&2147483648||(O/=2,++Q,ne=O>>>0),O-=ne,ne|=2147483648,ne>>>=0,O*=Math.pow(2,32),K=O>>>0,X.write_shift(4,K),X.write_shift(4,ne),Q+=16383+(F?32768:0),X.write_shift(2,Q),X}function E(C,Y){var q=M(C);return C.l+=Y-14,q}function P(C,Y){var q=j(C),O=C.read_shift(4);return q[1].v=O>>6,q}function D(C,Y){var q=j(C),O=C.read_shift(8,"f");return q[1].v=O,q}function G(C,Y){var q=D(C);return C.l+=Y-10,q}function H(C,Y){return C[C.l+Y-1]==0?C.read_shift(Y,"cstr"):""}function oe(C,Y){var q=C[C.l++];q>Y-1&&(q=Y-1);for(var O="";O.length<q;)O+=String.fromCharCode(C[C.l++]);return O}function de(C,Y,q){if(!(!q.qpro||Y<21)){var O=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var X=C.read_shift(Y-21,"cstr");return[O,X]}}function W(C,Y){for(var q={},O=C.l+Y;C.l<O;){var X=C.read_shift(2);if(X==14e3){for(q[X]=[0,""],q[X][0]=C.read_shift(2);C[C.l];)q[X][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return q}function V(C,Y){var q=_r(5+C.length);q.write_shift(2,14e3),q.write_shift(2,Y);for(var O=0;O<C.length;++O){var X=C.charCodeAt(O);q[q.l++]=X>127?95:X}return q[q.l++]=0,q}var ae={0:{n:"BOF",f:ps},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:H},222:{n:"SHEETNAMELP",f:oe},65535:{n:""}},ee={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:E},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:W},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:H},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}();function roe(e){var t={},r=e.match(Go),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Vn(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=CN[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var noe=function(){var e=f1("t"),t=f1("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var l={t:"s",v:ki(o[1])},c=s.match(t);return c&&(l.s=roe(c[1])),l}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(l){return l.v})}}(),ioe=function(){var t=/(\r\n|\n)/g;function r(i,s,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),o.push("</"+c+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),aoe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,soe=/<(?:\w+:)?r>/,ooe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function JN(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ki(Ji(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ji(e),r&&(n.h=IN(n.t))):e.match(soe)&&(n.r=Ji(e),n.t=ki(Ji((e.replace(ooe,"").match(aoe)||[]).join("").replace(Go,""))),r&&(n.h=ioe(noe(n.r)))),n):{t:""}}var loe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,coe=/<(?:\w+:)?(?:si|sstItem)>/g,uoe=/<\/(?:\w+:)?(?:si|sstItem)>/;function doe(e,t){var r=[],n="";if(!e)return r;var i=e.match(loe);if(i){n=i[2].replace(coe,"").split(uoe);for(var s=0;s!=n.length;++s){var o=JN(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=Vn(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var foe=/^\s|\s$|[\t\n\r]/;function iU(e,t){if(!t.bookSST)return"";var r=[ls];r[r.length]=tn("sst",null,{xmlns:Y0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(foe)&&(s+=' xml:space="preserve"'),s+=">"+Vi(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function hoe(e){return[e.read_shift(4),e.read_shift(4)]}function poe(e,t){var r=[],n=!1;return df(e,function(s,o,l){switch(l){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),r}function moe(e,t){return t||(t=_r(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var goe=Aie;function xoe(e){var t=Pl();Rr(t,159,moe(e));for(var r=0;r<e.length;++r)Rr(t,19,goe(e[r]));return Rr(t,160),t.end()}function aU(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function zd(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function yoe(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=zd(e,4),t.U=zd(e,4),t.W=zd(e,4),t}function boe(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function voe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(boe(e));return t}function woe(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Soe(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=zd(e,4),t.U=zd(e,4),t.W=zd(e,4),t}function _oe(e){var t=Soe(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function sU(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function oU(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function joe(e){var t=zd(e);switch(t.Minor){case 2:return[t.Minor,koe(e)];case 3:return[t.Minor,Aoe()];case 4:return[t.Minor,Noe(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function koe(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=sU(e,r),i=oU(e,e.length-e.l);return{t:"Std",h:n,v:i}}function Aoe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Noe(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Go,function(s){var o=Vn(s);switch(ld(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function Coe(e,t){var r={},n=r.EncryptionVersionInfo=zd(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=sU(e,i),t-=i,r.EncryptionVerifier=oU(e,t),r}function Eoe(e){var t={},r=t.EncryptionVersionInfo=zd(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ZN(e){var t=0,r,n=aU(e),i=n.length+1,s,o,l,c,u;for(r=hh(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],l=t&16384?1:0,c=t<<1&32767,u=l|c,t=u^o;return t^52811}var lU=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,l){return n(o^l)},s=function(o){for(var l=t[o.length-1],c=104,u=o.length-1;u>=0;--u)for(var d=o[u],f=0;f!=7;++f)d&64&&(l^=r[c]),d*=2,--c;return l};return function(o){for(var l=aU(o),c=s(l),u=l.length,d=hh(16),f=0;f!=16;++f)d[f]=0;var p,h,m;for((u&1)===1&&(p=c>>8,d[u]=i(e[0],p),--u,p=c&255,h=l[l.length-1],d[u]=i(h,p));u>0;)--u,p=c>>8,d[u]=i(l[u],p),--u,p=c&255,d[u]=i(l[u],p);for(u=15,m=15-l.length;m>0;)p=c>>8,d[u]=i(e[m],p),--u,--m,p=c&255,d[u]=i(l[u],p),--u,--m;return d}}(),Toe=function(e,t,r,n,i){i||(i=t),n||(n=lU(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},Poe=function(e){var t=0,r=lU(e);return function(n){var i=Toe("",n,t,r);return t=i[1],i[0]}};function Ooe(e,t,r,n){var i={key:ps(e),verificationBytes:ps(e)};return r.password&&(i.verifier=ZN(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=Poe(r.password)),i}function Moe(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Eoe(e):n.Data=Coe(e,t),n}function Loe(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Moe(e,t-2,n):Ooe(e,r.biff>=8?t:t-2,r,n),n}var cU=function(){function e(i,s){switch(s.type){case"base64":return t(cc(i),s);case"binary":return t(i,s);case"buffer":return t(mi&&Buffer.isBuffer(i)?i.toString("binary"):kh(i),s);case"array":return t(_0(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},l=o.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var p=/\\\w+\b/g,h=0,m,g=-1;m=p.exec(d);){switch(m[0]){case"\\cell":var y=d.slice(h,p.lastIndex-m[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(l)?l[f][g]=b:l[Hn({r:f,c:g})]=b}break}h=p.lastIndex}g>u.e.c&&(u.e.c=g)}),l["!ref"]=si(u),l}function r(i,s){return Ah(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Ai(i["!ref"]),l,c=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)s.push("\\cellx"+(d+1));for(s.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Hn({r:u,c:d});l=c?(i[u]||[])[d]:i[f],!(!l||l.v==null&&(!l.f||l.F))&&(s.push(" "+(l.w||(Xd(l),l.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Roe(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function g1(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function Foe(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var l=0,c=0,u=i+s;switch(c=o/(u>1?2-u:u),i){case t:l=((r-n)/o+6)%6;break;case r:l=(n-t)/o+2;break;case n:l=(t-r)/o+4;break}return[l/6,c,u/2]}function Boe(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],l=6*t,c;if(r!==0)switch(l|0){case 0:case 6:c=i*l,o[0]+=i,o[1]+=c;break;case 1:c=i*(2-l),o[0]+=c,o[1]+=i;break;case 2:c=i*(l-2),o[1]+=i,o[2]+=c;break;case 3:c=i*(4-l),o[1]+=c,o[2]+=i;break;case 4:c=i*(l-4),o[2]+=i,o[0]+=c;break;case 5:c=i*(6-l),o[2]+=c,o[0]+=i;break}for(var u=0;u!=3;++u)o[u]=Math.round(o[u]*255);return o}function W2(e,t){if(t===0)return e;var r=Foe(Roe(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),g1(Boe(r))}var uU=6,Ioe=15,Doe=1,Fo=uU;function x1(e){return Math.floor((e+Math.round(128/Fo)/256)*Fo)}function y1(e){return Math.floor((e-5)/Fo*100+.5)/100}function q2(e){return Math.round((e*Fo+5)/Fo*256)/256}function tj(e){return q2(y1(x1(e)))}function eC(e){var t=Math.abs(e-tj(e)),r=Fo;if(t>.005)for(Fo=Doe;Fo<Ioe;++Fo)Math.abs(e-tj(e))<=t&&(t=Math.abs(e-tj(e)),r=Fo);Fo=r}function ph(e){e.width?(e.wpx=x1(e.width),e.wch=y1(e.wpx),e.MDW=Fo):e.wpx?(e.wch=y1(e.wpx),e.width=q2(e.wch),e.MDW=Fo):typeof e.wch=="number"&&(e.width=q2(e.wch),e.wpx=x1(e.width),e.MDW=Fo),e.customWidth&&delete e.customWidth}var $oe=96,dU=$oe;function b1(e){return e*96/dU}function $m(e){return e*dU/96}var Uoe={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function zoe(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(Go)||[]).forEach(function(o){var l=Vn(o);switch(ld(l[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=pa(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=pa(l.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}function Woe(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(Go)||[]).forEach(function(o){var l=Vn(o);switch(ld(l[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),l.rgb!=null&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}function qoe(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(Go)||[]).forEach(function(o){var l=Vn(o);switch(ld(l[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=Ji(l.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=l.val?pa(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?pa(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?pa(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?pa(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?pa(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?pa(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?pa(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<family/>":case"</family>":break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(l.val=="1")break;l.codepage=CN[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=pa(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var c=s0[i.color.index];i.color.index==81&&(c=s0[1]),c||(c=s0[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=W2(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}function Hoe(e,t,r){t.NumberFmt=[];for(var n=Ka(qn),i=0;i<n.length;++i)t.NumberFmt[n[i]]=qn[n[i]];var s=e[0].match(Go);if(s)for(i=0;i<s.length;++i){var o=Vn(s[i]);switch(ld(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var l=ki(Ji(o.formatCode)),c=parseInt(o.numFmtId,10);if(t.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=l}Ud(l,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function Voe(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=tn("numFmt",null,{numFmtId:n,formatCode:Vi(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=tn("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Nb=["numFmtId","fillId","fontId","borderId","xfId"],Cb=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Goe(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(Go)||[]).forEach(function(s){var o=Vn(s),l=0;switch(ld(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],l=0;l<Nb.length;++l)n[Nb[l]]&&(n[Nb[l]]=parseInt(n[Nb[l]],10));for(l=0;l<Cb.length;++l)n[Cb[l]]&&(n[Cb[l]]=pa(n[Cb[l]]));if(t.NumberFmt&&n.numFmtId>392){for(l=392;l>60;--l)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[l]){n.numFmtId=l;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};o.vertical&&(c.vertical=o.vertical),o.horizontal&&(c.horizontal=o.horizontal),o.textRotation!=null&&(c.textRotation=o.textRotation),o.indent&&(c.indent=o.indent),o.wrapText&&(c.wrapText=pa(o.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function Koe(e){var t=[];return t[t.length]=tn("cellXfs",null),e.forEach(function(r){t[t.length]=tn("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=tn("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Yoe=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(l,c,u){var d={};if(!l)return d;l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=l.match(t))&&Hoe(f,d,u),(f=l.match(i))&&qoe(f,d,c,u),(f=l.match(n))&&Woe(f,d,c,u),(f=l.match(s))&&zoe(f,d,c,u),(f=l.match(r))&&Goe(f,d,u),d}}();function fU(e,t){var r=[ls,tn("styleSheet",null,{xmlns:Y0[0],"xmlns:vt":Ps.vt})],n;return e.SSF&&(n=Voe(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Koe(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Xoe(e,t){var r=e.read_shift(2),n=zo(e);return[r,n]}function Qoe(e,t,r){r||(r=_r(6+4*t.length)),r.write_shift(2,e),Ys(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Joe(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=Mie(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Oie(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=zo(e),n}function Zoe(e,t){t||(t=_r(25+4*32)),t.write_shift(2,e.sz*20),Lie(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),$2(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ys(e.name,t),t.length>t.l?t.slice(0,t.l):t}var ele=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rj,tle=Ho;function VP(e,t){t||(t=_r(4*3+8*7+16*1)),rj||(rj=AS(ele));var r=rj[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for($2({auto:1},t),$2({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function rle(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function hU(e,t,r){r||(r=_r(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Hg(e,t){return t||(t=_r(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var nle=Ho;function ile(e,t){return t||(t=_r(51)),t.write_shift(1,0),Hg(null,t),Hg(null,t),Hg(null,t),Hg(null,t),Hg(null,t),t.length>t.l?t.slice(0,t.l):t}function ale(e,t){return t||(t=_r(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),D2(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function sle(e,t,r){var n=_r(2052);return n.write_shift(4,e),D2(t,n),D2(r,n),n.length>n.l?n.slice(0,n.l):n}function ole(e,t,r){var n={};n.NumberFmt=[];for(var i in qn)n.NumberFmt[i]=qn[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return df(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Ud(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=W2(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(d),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(d);else if(u.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function lle(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Rr(e,615,gu(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Rr(e,44,Qoe(i,t[i]))}),Rr(e,616))}}function cle(e){var t=1;Rr(e,611,gu(t)),Rr(e,43,Zoe({sz:12,color:{theme:1},name:"Calibri",family:2})),Rr(e,612)}function ule(e){var t=2;Rr(e,603,gu(t)),Rr(e,45,VP({patternType:"none"})),Rr(e,45,VP({patternType:"gray125"})),Rr(e,604)}function dle(e){var t=1;Rr(e,613,gu(t)),Rr(e,46,ile()),Rr(e,614)}function fle(e){var t=1;Rr(e,626,gu(t)),Rr(e,47,hU({numFmtId:0},65535)),Rr(e,627)}function hle(e,t){Rr(e,617,gu(t.length)),t.forEach(function(r){Rr(e,47,hU(r,0))}),Rr(e,618)}function ple(e){var t=1;Rr(e,619,gu(t)),Rr(e,48,ale({xfId:0,name:"Normal"})),Rr(e,620)}function mle(e){var t=0;Rr(e,505,gu(t)),Rr(e,506)}function gle(e){var t=0;Rr(e,508,sle(t,"TableStyleMedium9","PivotStyleMedium4")),Rr(e,509)}function xle(e,t){var r=Pl();return Rr(r,278),lle(r,e.SSF),cle(r),ule(r),dle(r),fle(r),hle(r,t.cellXfs),ple(r),mle(r),gle(r),Rr(r,279),r.end()}var yle=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ble(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Go)||[]).forEach(function(i){var s=Vn(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[yle.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function vle(){}function wle(){}var Sle=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,_le=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,jle=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function kle(e,t,r){t.themeElements={};var n;[["clrScheme",Sle,ble],["fontScheme",_le,vle],["fmtScheme",jle,wle]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var Ale=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function pU(e,t){(!e||e.length===0)&&(e=tC());var r,n={};if(!(r=e.match(Ale)))throw new Error("themeElements not found in theme");return kle(r[0],n,t),n.raw=e,n}function tC(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ls];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Nle(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=s$(s,{type:"array"})}catch{return}var l=Jl(o,"theme/theme/theme1.xml",!0);if(l)return pU(l,r)}}function Cle(e){return e.read_shift(4)}function Ele(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Tle(e,4);break;case 2:t.xclrValue=G$(e);break;case 3:t.xclrValue=Cle(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Tle(e,t){return Ho(e,t)}function Ple(e,t){return Ho(e,t)}function Ole(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Ele(e);break;case 6:n[1]=Ple(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Mle(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(Ole(e,r-e.l));return{ixfe:n,ext:s}}function Lle(e,t){t.forEach(function(r){switch(r[0]){}})}function Rle(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:zo(e)}}function Fle(e){var t=_r(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ys(e.name,t),t.slice(0,t.l)}function Ble(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Ile(e){var t=_r(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Dle(e,t){var r=_r(8+2*t.length);return r.write_shift(4,e),Ys(t,r),r.slice(0,r.l)}function $le(e){return e.l+=4,e.read_shift(4)!=0}function Ule(e,t){var r=_r(8);return r.write_shift(4,e),r.write_shift(4,1),r}function zle(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,l=2;return df(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){l==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):l==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:l=c?1:0;break;case 338:l=2;break;case 35:s.push(d),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function Wle(){var e=Pl();return Rr(e,332),Rr(e,334,gu(1)),Rr(e,335,Fle({name:"XLDAPR",version:12e4,flags:3496657072})),Rr(e,336),Rr(e,339,Dle(1,"XLDAPR")),Rr(e,52),Rr(e,35,gu(514)),Rr(e,4096,gu(0)),Rr(e,4097,Mc(1)),Rr(e,36),Rr(e,53),Rr(e,340),Rr(e,337,Ule(1)),Rr(e,51,Ile([[1,0]])),Rr(e,338),Rr(e,333),e.end()}function qle(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(Go,function(l){var c=Vn(l);switch(ld(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(o=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return l}),n}function mU(){var e=[ls];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Hle(e){var t=[];if(!e)return t;var r=1;return(e.match(Go)||[]).forEach(function(n){var i=Vn(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function Vle(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Hn(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Gle(e,t,r){var n=[];return df(e,function(s,o,l){switch(l){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+l.toString(16))}}),n}function Kle(e,t,r,n){if(!e)return e;var i=n||{},s=!1;df(e,function(l,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!c.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function Yle(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Zp=1024;function gU(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[tn("xml",null,{"xmlns:v":Yl.v,"xmlns:o":Yl.o,"xmlns:x":Yl.x,"xmlns:mv":Yl.mv}).replace(/\/>/,">"),tn("o:shapelayout",tn("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),tn("v:shapetype",[tn("v:stroke",null,{joinstyle:"miter"}),tn("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Zp<e*1e3;)Zp+=1e3;return t.forEach(function(s){var o=Pa(s[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?tn("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=tn("v:fill",c,l),d={on:"t",obscured:"t"};++Zp,i=i.concat(["<v:shape"+h1({id:"_x0000_s"+Zp,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,tn("v:shadow",null,d),tn("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",go("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),go("x:AutoFill","False"),go("x:Row",String(o.r)),go("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function GP(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var l=Pa(o.ref);if(i?(e[l.r]||(e[l.r]=[]),s=e[l.r][l.c]):s=e[o.ref],!s){s={t:"z"},i?e[l.r][l.c]=s:e[o.ref]=s;var c=Ai(e["!ref"]||"BDWGO1000001:A1");c.s.r>l.r&&(c.s.r=l.r),c.e.r<l.r&&(c.e.r=l.r),c.s.c>l.c&&(c.s.c=l.c),c.e.c<l.c&&(c.e.c=l.c);var u=si(c);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}s.c.push(d)})}function Xle(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?author[^>]*>(.*)/);l&&r.push(l[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var l=o.match(/<(?:\w+:)?comment[^>]*>/);if(l){var c=Vn(l[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Pa(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&JN(f[1])||{r:"",t:"",h:""};u.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=p.h),n.push(u)}}}}),n}function xU(e){var t=[ls,tn("comments",null,{xmlns:Y0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Vi(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(Vi(c.a))),s.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(go("t",Vi(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,l=1;l<s.length;++l)o+=`Reply:
    `+s[l]+`
`;t.push(go("t",Vi(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Qle(e,t){var r=[],n=!1,i={},s=0;return e.replace(Go,function(l,c){var u=Vn(l);switch(ld(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+l.length;break;case"</text>":i.t=e.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),r}function Jle(e,t,r){var n=[ls,tn("ThreadedComments",null,{xmlns:Ps.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};l==0?s=c.id:c.parentId=s,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(tn("threadedComment",go("text",o.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Zle(e,t){var r=[],n=!1;return e.replace(Go,function(s){var o=Vn(s);switch(ld(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function ece(e){var t=[ls,tn("personList",null,{xmlns:Ps.TCMNT,"xmlns:x":Y0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(tn("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function tce(e){var t={};t.iauthor=e.read_shift(4);var r=Z0(e);return t.rfx=r.s,t.ref=Hn(r.s),e.l+=16,t}function rce(e,t){return t==null&&(t=_r(36)),t.write_shift(4,e[1].iauthor),dg(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var nce=zo;function ice(e){return Ys(e.slice(0,54))}function ace(e,t){var r=[],n=[],i={},s=!1;return df(e,function(l,c,u){switch(u){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function sce(e){var t=Pl(),r=[];return Rr(t,628),Rr(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Rr(t,632,ice(i.a)))})}),Rr(t,631),Rr(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Pa(n[0]),e:Pa(n[0])};Rr(t,635,rce([s,i])),i.t&&i.t.length>0&&Rr(t,637,Cie(i)),Rr(t,636),delete i.iauthor})}),Rr(t,634),Rr(t,629),t.end()}var oce="application/vnd.ms-office.vbaProject";function lce(e){var t=In.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");In.utils.cfb_add(t,i,e.FileIndex[n].content)}}),In.write(t)}function cce(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&In.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var yU=["xlsb","xlsm","xlam","biff8","xla"];function uce(){return{"!type":"dialog"}}function dce(){return{"!type":"dialog"}}function fce(){return{"!type":"macro"}}function hce(){return{"!type":"macro"}}var mm=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var l=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=t.c:--d,c?u+=t.r:--u,i+(l?"":"$")+Ta(d)+(c?"":"$")+os(u)}return function(i,s){return t=s,i.replace(e,r)}}(),rC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,nC=function(){return function(t,r){return t.replace(rC,function(n,i,s,o,l,c){var u=WN(o)-(s?0:r.c),d=zN(c)-(l?0:r.r),f=d==0?"":l?d+1:"["+d+"]",p=u==0?"":s?u+1:"["+u+"]";return i+"R"+f+"C"+p})}}();function bU(e,t){return e.replace(rC,function(r,n,i,s,o,l){return n+(i=="$"?i+s:Ta(WN(s)+t.c))+(o=="$"?o+l:os(zN(l)+t.r))})}function pce(e,t,r){var n=Ol(t),i=n.s,s=Pa(r),o={r:s.r-i.r,c:s.c-i.c};return bU(e,o)}function mce(e){return e.length!=1}function KP(e){return e.replace(/_xlfn\./g,"")}function us(e){e.l+=1}function mh(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function vU(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return wU(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=mh(e),l=mh(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function wU(e){var t=mh(e),r=mh(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function gce(e,t,r){if(r.biff<8)return wU(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=mh(e),o=mh(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function SU(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return xce(e);var n=e.read_shift(r&&r.biff==12?4:2),i=mh(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function xce(e){var t=mh(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function yce(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function bce(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return vce(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,l=(s&32768)>>15;if(s&=16383,l==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:l}}function vce(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function wce(e,t,r){var n=(e[e.l++]&96)>>5,i=vU(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Sce(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=vU(e,s,r);return[n,i,o]}function _ce(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function jce(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function kce(e,t,r){var n=(e[e.l++]&96)>>5,i=gce(e,t-1,r);return[n,i]}function Ace(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function YP(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Nce(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function Cce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ece(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Tce(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Pce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function _U(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Oce(e){return e.read_shift(2),_U(e)}function Mce(e){return e.read_shift(2),_U(e)}function Lce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=SU(e,0,r);return[n,i]}function Rce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=bce(e,0,r);return[n,i]}function Fce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=SU(e,0,r);return[n,i,s]}function Bce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[$ue[i],AU[i],n]}function Ice(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Dce(e);return[i,(s[0]===0?AU:Due)[s[1]]]}function Dce(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function $ce(e,t,r){e.l+=r&&r.biff==2?3:4}function Uce(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function zce(e){return e.l++,ff[e.read_shift(1)]}function Wce(e){return e.l++,e.read_shift(2)}function qce(e){return e.l++,e.read_shift(1)!==0}function Hce(e){return e.l++,Do(e)}function Vce(e,t,r){return e.l++,iy(e,t-1,r)}function Gce(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Za(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ff[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Do(e);break;case 2:r[1]=ep(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Kce(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Z0:ES)(e));return i}function Yce(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=Gce(e,r.biff);return o}function Xce(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function Qce(e,t,r){if(r.biff==5)return Jce(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function Jce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Zce(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function eue(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function tue(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function rue(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var nue=Ho,iue=Ho,aue=Ho;function sy(e,t,r){return e.l+=2,[yce(e)]}function iC(e){return e.l+=6,[]}var sue=sy,oue=iC,lue=iC,cue=sy;function jU(e){return e.l+=2,[ps(e),e.read_shift(2)&1]}var uue=sy,due=jU,fue=iC,hue=sy,pue=sy,mue=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function gue(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=mue[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function xue(e){return e.l+=2,[e.read_shift(4)]}function yue(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function bue(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function vue(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function wue(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Sue(e){return e.l+=4,[0,0]}var XP={1:{n:"PtgExp",f:Uce},2:{n:"PtgTbl",f:aue},3:{n:"PtgAdd",f:us},4:{n:"PtgSub",f:us},5:{n:"PtgMul",f:us},6:{n:"PtgDiv",f:us},7:{n:"PtgPower",f:us},8:{n:"PtgConcat",f:us},9:{n:"PtgLt",f:us},10:{n:"PtgLe",f:us},11:{n:"PtgEq",f:us},12:{n:"PtgGe",f:us},13:{n:"PtgGt",f:us},14:{n:"PtgNe",f:us},15:{n:"PtgIsect",f:us},16:{n:"PtgUnion",f:us},17:{n:"PtgRange",f:us},18:{n:"PtgUplus",f:us},19:{n:"PtgUminus",f:us},20:{n:"PtgPercent",f:us},21:{n:"PtgParen",f:us},22:{n:"PtgMissArg",f:us},23:{n:"PtgStr",f:Vce},26:{n:"PtgSheet",f:yue},27:{n:"PtgEndSheet",f:bue},28:{n:"PtgErr",f:zce},29:{n:"PtgBool",f:qce},30:{n:"PtgInt",f:Wce},31:{n:"PtgNum",f:Hce},32:{n:"PtgArray",f:Ace},33:{n:"PtgFunc",f:Bce},34:{n:"PtgFuncVar",f:Ice},35:{n:"PtgName",f:Xce},36:{n:"PtgRef",f:Lce},37:{n:"PtgArea",f:wce},38:{n:"PtgMemArea",f:Zce},39:{n:"PtgMemErr",f:nue},40:{n:"PtgMemNoMem",f:iue},41:{n:"PtgMemFunc",f:eue},42:{n:"PtgRefErr",f:tue},43:{n:"PtgAreaErr",f:_ce},44:{n:"PtgRefN",f:Rce},45:{n:"PtgAreaN",f:kce},46:{n:"PtgMemAreaN",f:vue},47:{n:"PtgMemNoMemN",f:wue},57:{n:"PtgNameX",f:Qce},58:{n:"PtgRef3d",f:Fce},59:{n:"PtgArea3d",f:Sce},60:{n:"PtgRefErr3d",f:rue},61:{n:"PtgAreaErr3d",f:jce},255:{}},_ue={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},jue={1:{n:"PtgElfLel",f:jU},2:{n:"PtgElfRw",f:hue},3:{n:"PtgElfCol",f:sue},6:{n:"PtgElfRwV",f:pue},7:{n:"PtgElfColV",f:cue},10:{n:"PtgElfRadical",f:uue},11:{n:"PtgElfRadicalS",f:fue},13:{n:"PtgElfColS",f:oue},15:{n:"PtgElfColSV",f:lue},16:{n:"PtgElfRadicalLel",f:due},25:{n:"PtgList",f:gue},29:{n:"PtgSxName",f:xue},255:{}},kue={0:{n:"PtgAttrNoop",f:Sue},1:{n:"PtgAttrSemi",f:Pce},2:{n:"PtgAttrIf",f:Ece},4:{n:"PtgAttrChoose",f:Nce},8:{n:"PtgAttrGoto",f:Cce},16:{n:"PtgAttrSum",f:$ce},32:{n:"PtgAttrBaxcel",f:YP},33:{n:"PtgAttrBaxcel",f:YP},64:{n:"PtgAttrSpace",f:Oce},65:{n:"PtgAttrSpaceSemi",f:Mce},128:{n:"PtgAttrIfError",f:Tce},255:{}};function oy(e,t,r,n){if(n.biff<8)return Ho(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Yce(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Kce(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(Ho(e,t)),s}function ly(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=XP[s]||XP[_ue[s]],(s===24||s===25)&&(i=(s===24?jue:kue)[e[e.l+1]]),!i||!i.f?Ho(e,t):o.push([i.n,i.f(e,t,r)]);return o}function Aue(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Nue={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Cue(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function kU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function QP(e,t,r){var n=kU(e,t,r);return n=="#REF"?n:Cue(n,r)}function Lo(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},l=[],c,u,d,f=0,p=0,h,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",b=0,v=e[0].length;b<v;++b){var w=e[0][b];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),u=l.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=qa(" ",e[0][g][1][1]);break;case 1:y=qa("\r",e[0][g][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}l.push(u+Nue[w[0]]+c);break;case"PtgIsect":c=l.pop(),u=l.pop(),l.push(u+" "+c);break;case"PtgUnion":c=l.pop(),u=l.pop(),l.push(u+","+c);break;case"PtgRange":c=l.pop(),u=l.pop(),l.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Tx(w[1][1],o,i),l.push(Px(d,s));break;case"PtgRefN":d=r?Tx(w[1][1],r,i):w[1][1],l.push(Px(d,s));break;case"PtgRef3d":f=w[1][1],d=Tx(w[1][2],o,i),m=QP(n,f,i),l.push(m+"!"+Px(d,s));break;case"PtgFunc":case"PtgFuncVar":var S=w[1][0],j=w[1][1];S||(S=0),S&=127;var k=S==0?[]:l.slice(-S);l.length-=S,j==="User"&&(j=k.shift()),l.push(j+"("+k.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":h=AP(w[1][1],r?{s:r}:o,i),l.push(J5(h,i));break;case"PtgArea":h=AP(w[1][1],o,i),l.push(J5(h,i));break;case"PtgArea3d":f=w[1][1],h=w[1][2],m=QP(n,f,i),l.push(m+"!"+J5(h,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=w[1][2];var A=(n.names||[])[p-1]||(n[0]||[])[p],R=A?A.Name:"SH33TJSNAME"+String(p);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),l.push(R);break;case"PtgNameX":var M=w[1][1];p=w[1][2];var B;if(i.biff<=5)M<0&&(M=-M),n[M]&&(B=n[M][p]);else{var E="";if(((n[M]||[])[0]||[])[0]==14849||(((n[M]||[])[0]||[])[0]==1025?n[M][p]&&n[M][p].itab>0&&(E=n.SheetNames[n[M][p].itab-1]+"!"):E=n.SheetNames[p-1]+"!"),n[M]&&n[M][p])E+=n[M][p].Name;else if(n[0]&&n[0][p])E+=n[0][p].Name;else{var P=(kU(n,M,i)||"").split(";;");P[p-1]?E=P[p-1]:E+="SH33TJSERRX"}l.push(E);break}B||(B={Name:"SH33TJSERRY"}),l.push(B.Name);break;case"PtgParen":var D="(",G=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:D=qa(" ",e[0][g][1][1])+D;break;case 3:D=qa("\r",e[0][g][1][1])+D;break;case 4:G=qa(" ",e[0][g][1][1])+G;break;case 5:G=qa("\r",e[0][g][1][1])+G;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}l.push(D+l.pop()+G);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var H={c:r.c,r:r.r};if(n.sharedf[Hn(d)]){var oe=n.sharedf[Hn(d)];l.push(Lo(oe,o,H,n,i))}else{var de=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){l.push(Lo(u[1],o,H,n,i)),de=!0;break}de||l.push(w[1])}break;case"PtgArray":l.push("{"+Aue(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var W=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&W.indexOf(e[0][b][0])==-1){w=e[0][g];var V=!0;switch(w[1][0]){case 4:V=!1;case 0:y=qa(" ",w[1][1]);break;case 5:V=!1;case 1:y=qa("\r",w[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((V?y:"")+l.pop()+(V?"":y)),g=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]}function Eue(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Ho(e,t-2)];var l=ly(e,o,r);return t!==o+i&&(s=oy(e,t-o-i,l,r)),e.l=n,[l,s]}function Tue(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],Ho(e,t-2)];var l=ly(e,o,r);return t!==o+i&&(s=oy(e,t-o-i,l,r)),e.l=n,[l,s]}function Pue(e,t,r,n){var i=e.l+t,s=ly(e,n,r),o;return i!==e.l&&(o=oy(e,i-e.l,s,r)),[s,o]}function Oue(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=ly(e,s,r);return s==65535?[[],Ho(e,t-2)]:(t!==s+2&&(i=oy(e,n-s-2,o,r)),[o,i])}function Mue(e){var t;if(Ld(e,e.l+6)!==65535)return[Do(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Lue(e){if(e==null){var t=_r(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return j0(e);return j0(0)}function nj(e,t,r){var n=e.l+t,i=cd(e);r.biff==2&&++e.l;var s=Mue(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var l=Tue(e,n-e.l,r);return{cell:i,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function Rue(e,t,r,n,i){var s=A0(t,r,i),o=Lue(e.v),l=_r(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var u=_r(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Gs([s,o,l,u]);return f}function TS(e,t,r){var n=e.read_shift(4),i=ly(e,n,r),s=e.read_shift(4),o=s>0?oy(e,s,i,r):null;return[i,o]}var Fue=TS,PS=TS,Bue=TS,Iue=TS,Due={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},AU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},$ue={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function JP(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Uue(e){var t="of:="+e.replace(rC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ij(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function zue(e){return e.replace(/\./,"!")}var Mx={},gm={},Lx=typeof Map<"u";function aC(e,t,r){var n=0,i=e.length;if(r){if(Lx?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Lx?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Lx?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function OS(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Fo=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=y1(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=q2(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function c0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Nh(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ud(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function NU(e,t,r,n,i,s){try{n.cellNF&&(e.z=qn[t])}catch(l){if(n.WTF)throw l}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=xa(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(qn[t]==null&&Ud(Dne[t]||"General",t),e.t==="e")e.w=e.w||ff[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d1(e.v);else if(e.t==="d"){var o=Ms(e.v);(o|0)===o?e.w=o.toString(10):e.w=d1(o)}else{if(e.v===void 0)return"";e.w=S0(e.v,gm)}else e.t==="d"?e.w=Wc(t,Ms(e.v),gm):e.w=Wc(t,e.v,gm)}catch(l){if(n.WTF)throw l}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=W2(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=W2(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(n.WTF&&s.Fills)throw l}}}function Wue(e,t,r){if(e&&e["!ref"]){var n=Ai(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function que(e,t){var r=Ai(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=si(r))}var Hue=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Vue=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Gue=/<(?:\w:)?hyperlink [^>]*>/mg,Kue=/"(\w*:\w*)"/,Yue=/<(?:\w:)?col\b[^>]*[\/]?>/g,Xue=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Que=/<(?:\w:)?pageMargins[^>]*\/>/g,CU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Jue=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Zue=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function ede(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var l=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(Vue);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var p=u.match(CU);p?sC(p[0],l,i,r):(p=u.match(Jue))&&rde(p[0],p[1]||"",l,i,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(Kue);m&&que(l,m[1])}var g=u.match(Zue);g&&g[1]&&mde(g[1],i);var y=[];if(t.cellStyles){var b=u.match(Yue);b&&ude(y,b)}f&&yde(f[1],l,t,c,s,o);var v=d.match(Xue);v&&(l["!autofilter"]=fde(v[0]));var w=[],S=d.match(Hue);if(S)for(h=0;h!=S.length;++h)w[h]=Ai(S[h].slice(S[h].indexOf('"')+1));var j=d.match(Gue);j&&ode(l,j,n);var k=d.match(Que);if(k&&(l["!margins"]=lde(Vn(k[0]))),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=si(c)),t.sheetRows>0&&l["!ref"]){var A=Ai(l["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>c.e.r&&(A.e.r=c.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>c.e.c&&(A.e.c=c.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),l["!fullref"]=l["!ref"],l["!ref"]=si(A))}return y.length>0&&(l["!cols"]=y),w.length>0&&(l["!merges"]=w),l}function tde(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+si(e[r])+'"/>';return t+"</mergeCells>"}function sC(e,t,r,n){var i=Vn(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=ki(Ji(i.codeName)))}function rde(e,t,r,n,i){sC(e.slice(0,e.indexOf(">")),r,n,i)}function nde(e,t,r,n,i){var s=!1,o={},l=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,o.codeName=Ku(Vi(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+tn("outlinePr",null,u)}!s&&!l||(i[i.length]=tn("sheetPr",l,o))}var ide=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ade=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function sde(e){var t={sheet:1};return ide.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),ade.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=ZN(e.password).toString(16).toUpperCase()),tn("sheetProtection",null,t)}function ode(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Vn(Ji(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+ki(s.location))):(s.Target="#"+ki(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Ai(s.ref),c=l.s.r;c<=l.e.r;++c)for(var u=l.s.c;u<=l.e.c;++u){var d=Hn({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}function lde(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function cde(e){return c0(e),tn("pageMargins",null,e)}function ude(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Vn(t[n],!0);i.hidden&&(i.hidden=pa(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,eC(i.width)),ph(i);s<=o;)e[s++]=ya(i)}}function dde(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=tn("col",null,OS(i,n)));return r[r.length]="</cols>",r.join("")}function fde(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function hde(e,t,r,n){var i=typeof e.ref=="string"?e.ref:si(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Ol(i);o.s.r==o.e.r&&(o.e.r=Ol(t["!ref"]).e.r,i=si(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),tn("autoFilter",null,{ref:i})}var pde=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function mde(e,t){t.Views||(t.Views=[{}]),(e.match(pde)||[]).forEach(function(r,n){var i=Vn(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),pa(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function gde(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),tn("sheetViews",tn("sheetView",null,i),{})}function xde(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=ff[e.v];break;case"d":n&&n.cellDates?i=xa(e.v,-1).toISOString():(e=ya(e),e.t="n",i=""+(e.v=Ms(xa(e.v)))),typeof e.z>"u"&&(e.z=qn[14]);break;default:i=e.v;break}var l=go("v",Vi(i)),c={r:t},u=Nh(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){l=go("v",""+aC(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;l=tn("f",Vi(e.f),d)+(e.v!=null?l:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),tn("c",l,c)}var yde=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=f1("v"),o=f1("f");return function(c,u,d,f,p,h){for(var m=0,g="",y=[],b=[],v=0,w=0,S=0,j="",k,A,R=0,M=0,B,E,P=0,D=0,G=Array.isArray(h.CellXf),H,oe=[],de=[],W=Array.isArray(u),V=[],ae={},ee=!1,C=!!d.sheetStubs,Y=c.split(t),q=0,O=Y.length;q!=O;++q){g=Y[q].trim();var X=g.length;if(X!==0){var F=0;e:for(m=0;m<X;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(A=Vn(g.slice(F,m),!0),R=A.r!=null?parseInt(A.r,10):R+1,M=-1,d.sheetRows&&d.sheetRows<R)continue;ae={},ee=!1,A.ht&&(ee=!0,ae.hpt=parseFloat(A.ht),ae.hpx=$m(ae.hpt)),A.hidden=="1"&&(ee=!0,ae.hidden=!0),A.outlineLevel!=null&&(ee=!0,ae.level=+A.outlineLevel),ee&&(V[R-1]=ae)}break;case"<":F=m;break}if(F>=m)break;if(A=Vn(g.slice(F,m),!0),R=A.r!=null?parseInt(A.r,10):R+1,M=-1,!(d.sheetRows&&d.sheetRows<R)){f.s.r>R-1&&(f.s.r=R-1),f.e.r<R-1&&(f.e.r=R-1),d&&d.cellStyles&&(ae={},ee=!1,A.ht&&(ee=!0,ae.hpt=parseFloat(A.ht),ae.hpx=$m(ae.hpt)),A.hidden=="1"&&(ee=!0,ae.hidden=!0),A.outlineLevel!=null&&(ee=!0,ae.level=+A.outlineLevel),ee&&(V[R-1]=ae)),y=g.slice(m).split(e);for(var Q=0;Q!=y.length&&y[Q].trim().charAt(0)=="<";++Q);for(y=y.slice(Q),m=0;m!=y.length;++m)if(g=y[m].trim(),g.length!==0){if(b=g.match(r),v=m,w=0,S=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(v=0,j=b[1],w=0;w!=j.length&&!((S=j.charCodeAt(w)-64)<1||S>26);++w)v=26*v+S;--v,M=v}else++M;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,A=Vn(g.slice(0,w),!0),A.r||(A.r=Hn({r:R-1,c:M})),j=g.slice(w),k={t:""},(b=j.match(s))!=null&&b[1]!==""&&(k.v=ki(b[1])),d.cellFormula){if((b=j.match(o))!=null&&b[1]!==""){if(k.f=ki(Ji(b[1])).replace(/\r\n/g,`
`),d.xlfn||(k.f=KP(k.f)),b[0].indexOf('t="array"')>-1)k.F=(j.match(i)||[])[1],k.F.indexOf(":")>-1&&oe.push([Ai(k.F),k.F]);else if(b[0].indexOf('t="shared"')>-1){E=Vn(b[0]);var K=ki(Ji(b[1]));d.xlfn||(K=KP(K)),de[parseInt(E.si,10)]=[E,K,A.r]}}else(b=j.match(/<f[^>]*\/>/))&&(E=Vn(b[0]),de[E.si]&&(k.f=pce(de[E.si][1],de[E.si][2],A.r)));var ne=Pa(A.r);for(w=0;w<oe.length;++w)ne.r>=oe[w][0].s.r&&ne.r<=oe[w][0].e.r&&ne.c>=oe[w][0].s.c&&ne.c<=oe[w][0].e.c&&(k.F=oe[w][1])}if(A.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(C)k.t="z";else continue;else k.t=A.t||"n";switch(f.s.c>M&&(f.s.c=M),f.e.c<M&&(f.e.c=M),k.t){case"n":if(k.v==""||k.v==null){if(!C)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!C)continue;k.t="z"}else B=Mx[parseInt(k.v,10)],k.v=B.t,k.r=B.r,d.cellHTML&&(k.h=B.h);break;case"str":k.t="s",k.v=k.v!=null?Ji(k.v):"",d.cellHTML&&(k.h=IN(k.v));break;case"inlineStr":b=j.match(n),k.t="s",b!=null&&(B=JN(b[1]))?(k.v=B.t,d.cellHTML&&(k.h=B.h)):k.v="";break;case"b":k.v=pa(k.v);break;case"d":d.cellDates?k.v=xa(k.v,1):(k.v=Ms(xa(k.v,1)),k.t="n");break;case"e":(!d||d.cellText!==!1)&&(k.w=k.v),k.v=T$[k.v];break}if(P=D=0,H=null,G&&A.s!==void 0&&(H=h.CellXf[A.s],H!=null&&(H.numFmtId!=null&&(P=H.numFmtId),d.cellStyles&&H.fillId!=null&&(D=H.fillId))),NU(k,P,D,d,p,h),d.cellDates&&G&&k.t=="n"&&lg(qn[P])&&(k.t="d",k.v=CS(k.v)),A.cm&&d.xlmeta){var re=(d.xlmeta.Cell||[])[+A.cm-1];re&&re.type=="XLDAPR"&&(k.D=!0)}if(W){var T=Pa(A.r);u[T.r]||(u[T.r]=[]),u[T.r][T.c]=k}else u[A.r]=k}}}}V.length>0&&(u["!rows"]=V)}}();function bde(e,t,r,n){var i=[],s=[],o=Ai(e["!ref"]),l="",c,u="",d=[],f=0,p=0,h=e["!rows"],m=Array.isArray(e),g={r:u},y,b=-1;for(p=o.s.c;p<=o.e.c;++p)d[p]=Ta(p);for(f=o.s.r;f<=o.e.r;++f){for(s=[],u=os(f),p=o.s.c;p<=o.e.c;++p){c=d[p]+u;var v=m?(e[f]||[])[p]:e[c];v!==void 0&&(l=xde(v,c,e,t))!=null&&s.push(l)}(s.length>0||h&&h[f])&&(g={r:u},h&&h[f]&&(y=h[f],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=b1(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),i[i.length]=tn("row",s.join(""),g))}if(h)for(;f<h.length;++f)h&&h[f]&&(g={r:f+1},y=h[f],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=b1(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level),i[i.length]=tn("row","",g));return i.join("")}function EU(e,t,r,n){var i=[ls,tn("worksheet",null,{xmlns:Y0[0],"xmlns:r":Ps.r})],s=r.SheetNames[e],o=0,l="",c=r.Sheets[s];c==null&&(c={});var u=c["!ref"]||"A1",d=Ai(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=si(d)}n||(n={}),c["!comments"]=[];var f=[];nde(c,r,e,t,i),i[i.length]=tn("dimension",null,{ref:u}),i[i.length]=gde(c,t,e,r),t.sheetFormat&&(i[i.length]=tn("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=dde(c,c["!cols"])),i[o=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=bde(c,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),c["!protect"]&&(i[i.length]=sde(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=hde(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=tde(c["!merges"]));var p=-1,h,m=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(h={ref:g[0]},g[1].Target.charAt(0)!="#"&&(m=Wi(n,-1,Vi(g[1].Target).replace(/#.*$/,""),gi.HLINK),h["r:id"]="rId"+m),(p=g[1].Target.indexOf("#"))>-1&&(h.location=Vi(g[1].Target.slice(p+1))),g[1].Tooltip&&(h.tooltip=Vi(g[1].Tooltip)),i[i.length]=tn("hyperlink",null,h))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=cde(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=go("ignoredErrors",tn("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(m=Wi(n,-1,"../drawings/drawing"+(e+1)+".xml",gi.DRAW),i[i.length]=tn("drawing",null,{"r:id":"rId"+m}),c["!drawing"]=f),c["!comments"].length>0&&(m=Wi(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",gi.VML),i[i.length]=tn("legacyDrawing",null,{"r:id":"rId"+m}),c["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function vde(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function wde(e,t,r){var n=_r(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=b1(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,p=-1,h=d<<10;h<d+1<<10;++h){u.c=h;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Hn(u)];m&&(f<0&&(f=h),p=h)}f<0||(++l,n.write_shift(4,f),n.write_shift(4,p))}var g=n.l;return n.l=c,n.write_shift(4,l),n.l=g,n.length>n.l?n.slice(0,n.l):n}function Sde(e,t,r,n){var i=wde(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Rr(e,0,i)}var _de=Z0,jde=dg;function kde(){}function Ade(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Eie(e),r}function Nde(e,t,r){r==null&&(r=_r(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return $2({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),k$(e,r),r.slice(0,r.l)}function Cde(e){var t=Kc(e);return[t]}function Ede(e,t,r){return r==null&&(r=_r(8)),X0(t,r)}function Tde(e){var t=Q0(e);return[t]}function Pde(e,t,r){return r==null&&(r=_r(4)),J0(t,r)}function Ode(e){var t=Kc(e),r=e.read_shift(1);return[t,r,"b"]}function Mde(e,t,r){return r==null&&(r=_r(9)),X0(t,r),r.write_shift(1,e.v?1:0),r}function Lde(e){var t=Q0(e),r=e.read_shift(1);return[t,r,"b"]}function Rde(e,t,r){return r==null&&(r=_r(5)),J0(t,r),r.write_shift(1,e.v?1:0),r}function Fde(e){var t=Kc(e),r=e.read_shift(1);return[t,r,"e"]}function Bde(e,t,r){return r==null&&(r=_r(9)),X0(t,r),r.write_shift(1,e.v),r}function Ide(e){var t=Q0(e),r=e.read_shift(1);return[t,r,"e"]}function Dde(e,t,r){return r==null&&(r=_r(8)),J0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function $de(e){var t=Kc(e),r=e.read_shift(4);return[t,r,"s"]}function Ude(e,t,r){return r==null&&(r=_r(12)),X0(t,r),r.write_shift(4,t.v),r}function zde(e){var t=Q0(e),r=e.read_shift(4);return[t,r,"s"]}function Wde(e,t,r){return r==null&&(r=_r(8)),J0(t,r),r.write_shift(4,t.v),r}function qde(e){var t=Kc(e),r=Do(e);return[t,r,"n"]}function Hde(e,t,r){return r==null&&(r=_r(16)),X0(t,r),j0(e.v,r),r}function TU(e){var t=Q0(e),r=Do(e);return[t,r,"n"]}function Vde(e,t,r){return r==null&&(r=_r(12)),J0(t,r),j0(e.v,r),r}function Gde(e){var t=Kc(e),r=GN(e);return[t,r,"n"]}function Kde(e,t,r){return r==null&&(r=_r(12)),X0(t,r),A$(e.v,r),r}function Yde(e){var t=Q0(e),r=GN(e);return[t,r,"n"]}function Xde(e,t,r){return r==null&&(r=_r(8)),J0(t,r),A$(e.v,r),r}function Qde(e){var t=Kc(e),r=qN(e);return[t,r,"is"]}function Jde(e){var t=Kc(e),r=zo(e);return[t,r,"str"]}function Zde(e,t,r){return r==null&&(r=_r(12+4*e.v.length)),X0(t,r),Ys(e.v,r),r.length>r.l?r.slice(0,r.l):r}function efe(e){var t=Q0(e),r=zo(e);return[t,r,"str"]}function tfe(e,t,r){return r==null&&(r=_r(8+4*e.v.length)),J0(t,r),Ys(e.v,r),r.length>r.l?r.slice(0,r.l):r}function rfe(e,t,r){var n=e.l+t,i=Kc(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var l=PS(e,n-e.l,r);o[3]=Lo(l,null,i,r.supbooks,r)}else e.l=n;return o}function nfe(e,t,r){var n=e.l+t,i=Kc(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var l=PS(e,n-e.l,r);o[3]=Lo(l,null,i,r.supbooks,r)}else e.l=n;return o}function ife(e,t,r){var n=e.l+t,i=Kc(e);i.r=r["!row"];var s=Do(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var l=PS(e,n-e.l,r);o[3]=Lo(l,null,i,r.supbooks,r)}else e.l=n;return o}function afe(e,t,r){var n=e.l+t,i=Kc(e);i.r=r["!row"];var s=zo(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var l=PS(e,n-e.l,r);o[3]=Lo(l,null,i,r.supbooks,r)}else e.l=n;return o}var sfe=Z0,ofe=dg;function lfe(e,t){return t==null&&(t=_r(4)),t.write_shift(4,e),t}function cfe(e,t){var r=e.l+t,n=Z0(e),i=HN(e),s=zo(e),o=zo(e),l=zo(e);e.l=r;var c={rfx:n,relId:i,loc:s,display:l};return o&&(c.Tooltip=o),c}function ufe(e,t){var r=_r(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));dg({s:Pa(e[0]),e:Pa(e[0])},r),VN("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Ys(i||"",r),Ys(e[1].Tooltip||"",r),Ys("",r),r.slice(0,r.l)}function dfe(){}function ffe(e,t,r){var n=e.l+t,i=N$(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var l=Fue(e,n-e.l,r);o[1]=l}else e.l=n;return o}function hfe(e,t,r){var n=e.l+t,i=Z0(e),s=[i];if(r.cellFormula){var o=Iue(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function pfe(e,t,r){r==null&&(r=_r(18));var n=OS(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var PU=["left","right","top","bottom","header","footer"];function mfe(e){var t={};return PU.forEach(function(r){t[r]=Do(e)}),t}function gfe(e,t){return t==null&&(t=_r(6*8)),c0(e),PU.forEach(function(r){j0(e[r],t)}),t}function xfe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function yfe(e,t,r){r==null&&(r=_r(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function bfe(e){var t=_r(24);return t.write_shift(4,4),t.write_shift(4,1),dg(e,t),t}function vfe(e,t){return t==null&&(t=_r(16*4+2)),t.write_shift(2,e.password?ZN(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function wfe(){}function Sfe(){}function _fe(e,t,r,n,i,s,o){if(!e)return e;var l=t||{};n||(n={"!id":{}});var c=l.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,h,m,g,y,b,v,w,S,j,k=[];l.biff=12,l["!row"]=0;var A=0,R=!1,M=[],B={},E=l.supbooks||i.supbooks||[[]];if(E.sharedf=B,E.arrayf=M,E.SheetNames=i.SheetNames||i.Sheets.map(function(W){return W.name}),!l.supbooks&&(l.supbooks=E,i.Names))for(var P=0;P<i.Names.length;++P)E[0][P+1]=i.Names[P];var D=[],G=[],H=!1;v1[16]={n:"BrtShortReal",f:TU};var oe;if(df(e,function(V,ae,ee){if(!p)switch(ee){case 148:u=V;break;case 0:h=V,l.sheetRows&&l.sheetRows<=h.r&&(p=!0),S=os(y=h.r),l["!row"]=h.r,(V.hidden||V.hpt||V.level!=null)&&(V.hpt&&(V.hpx=$m(V.hpt)),G[V.r]=V);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:V[2]},V[2]){case"n":m.v=V[1];break;case"s":w=Mx[V[1]],m.v=w.t,m.r=w.r;break;case"b":m.v=!!V[1];break;case"e":m.v=V[1],l.cellText!==!1&&(m.w=ff[m.v]);break;case"str":m.t="s",m.v=V[1];break;case"is":m.t="s",m.v=V[1].t;break}if((g=o.CellXf[V[0].iStyleRef])&&NU(m,g.numFmtId,null,l,s,o),b=V[0].c==-1?b+1:V[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=m):c[Ta(b)+S]=m,l.cellFormula){for(R=!1,A=0;A<M.length;++A){var C=M[A];h.r>=C[0].s.r&&h.r<=C[0].e.r&&b>=C[0].s.c&&b<=C[0].e.c&&(m.F=si(C[0]),R=!0)}!R&&V.length>3&&(m.f=V[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>b&&(d.s.c=b),d.e.r<h.r&&(d.e.r=h.r),d.e.c<b&&(d.e.c=b),l.cellDates&&g&&m.t=="n"&&lg(qn[g.numFmtId])){var Y=Xh(m.v);Y&&(m.t="d",m.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}oe&&(oe.type=="XLDAPR"&&(m.D=!0),oe=void 0);break;case 1:case 12:if(!l.sheetStubs||f)break;m={t:"z",v:void 0},b=V[0].c==-1?b+1:V[0].c,l.dense?(c[y]||(c[y]=[]),c[y][b]=m):c[Ta(b)+S]=m,d.s.r>h.r&&(d.s.r=h.r),d.s.c>b&&(d.s.c=b),d.e.r<h.r&&(d.e.r=h.r),d.e.c<b&&(d.e.c=b),oe&&(oe.type=="XLDAPR"&&(m.D=!0),oe=void 0);break;case 176:k.push(V);break;case 49:oe=((l.xlmeta||{}).Cell||[])[V-1];break;case 494:var q=n["!id"][V.relId];for(q?(V.Target=q.Target,V.loc&&(V.Target+="#"+V.loc),V.Rel=q):V.relId==""&&(V.Target="#"+V.loc),y=V.rfx.s.r;y<=V.rfx.e.r;++y)for(b=V.rfx.s.c;b<=V.rfx.e.c;++b)l.dense?(c[y]||(c[y]=[]),c[y][b]||(c[y][b]={t:"z",v:void 0}),c[y][b].l=V):(v=Hn({c:b,r:y}),c[v]||(c[v]={t:"z",v:void 0}),c[v].l=V);break;case 426:if(!l.cellFormula)break;M.push(V),j=l.dense?c[y][b]:c[Ta(b)+S],j.f=Lo(V[1],d,{r:h.r,c:b},E,l),j.F=si(V[0]);break;case 427:if(!l.cellFormula)break;B[Hn(V[0].s)]=V[1],j=l.dense?c[y][b]:c[Ta(b)+S],j.f=Lo(V[1],d,{r:h.r,c:b},E,l);break;case 60:if(!l.cellStyles)break;for(;V.e>=V.s;)D[V.e--]={width:V.w/256,hidden:!!(V.flags&1),level:V.level},H||(H=!0,eC(V.w/256)),ph(D[V.e+1]);break;case 161:c["!autofilter"]={ref:si(V)};break;case 476:c["!margins"]=V;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),V.name&&(i.Sheets[r].CodeName=V.name),(V.above||V.left)&&(c["!outline"]={above:V.above,left:V.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),V.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ae.T){if(!f||l.WTF)throw new Error("Unexpected record 0x"+ee.toString(16))}}},l),delete l.supbooks,delete l["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=si(u||d)),l.sheetRows&&c["!ref"]){var de=Ai(c["!ref"]);l.sheetRows<=+de.e.r&&(de.e.r=l.sheetRows-1,de.e.r>d.e.r&&(de.e.r=d.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>d.e.c&&(de.e.c=d.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),c["!fullref"]=c["!ref"],c["!ref"]=si(de))}return k.length>0&&(c["!merges"]=k),D.length>0&&(c["!cols"]=D),G.length>0&&(c["!rows"]=G),c}function jfe(e,t,r,n,i,s,o){if(t.v===void 0)return!1;var l="";switch(t.t){case"b":l=t.v?"1":"0";break;case"d":t=ya(t),t.z=t.z||qn[14],t.v=Ms(xa(t.v)),t.t="n";break;case"n":case"e":l=""+t.v;break;default:l=t.v;break}var c={r,c:n};switch(c.s=Nh(i.cellXfs,t,i),t.l&&s["!links"].push([Hn(c),t.l]),t.c&&s["!comments"].push([Hn(c),t.c]),t.t){case"s":case"str":return i.bookSST?(l=aC(i.Strings,t.v,i.revStrings),c.t="s",c.v=l,o?Rr(e,18,Wde(t,c)):Rr(e,7,Ude(t,c))):(c.t="str",o?Rr(e,17,tfe(t,c)):Rr(e,6,Zde(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Rr(e,13,Xde(t,c)):Rr(e,2,Kde(t,c)):o?Rr(e,16,Vde(t,c)):Rr(e,5,Hde(t,c)),!0;case"b":return c.t="b",o?Rr(e,15,Rde(t,c)):Rr(e,4,Mde(t,c)),!0;case"e":return c.t="e",o?Rr(e,14,Dde(t,c)):Rr(e,3,Bde(t,c)),!0}return o?Rr(e,12,Pde(t,c)):Rr(e,1,Ede(t,c)),!0}function kfe(e,t,r,n){var i=Ai(t["!ref"]||"A1"),s,o="",l=[];Rr(e,145);var c=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var d=i.s.r;d<=u;++d){o=os(d),Sde(e,t,i,d);var f=!1;if(d<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){d===i.s.r&&(l[p]=Ta(p)),s=l[p]+o;var h=c?(t[d]||[])[p]:t[s];if(!h){f=!1;continue}f=jfe(e,h,d,p,n,t,f)}}Rr(e,146)}function Afe(e,t){!t||!t["!merges"]||(Rr(e,177,lfe(t["!merges"].length)),t["!merges"].forEach(function(r){Rr(e,176,ofe(r))}),Rr(e,178))}function Nfe(e,t){!t||!t["!cols"]||(Rr(e,390),t["!cols"].forEach(function(r,n){r&&Rr(e,60,pfe(n,r))}),Rr(e,391))}function Cfe(e,t){!t||!t["!ref"]||(Rr(e,648),Rr(e,649,bfe(Ai(t["!ref"]))),Rr(e,650))}function Efe(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Wi(r,-1,n[1].Target.replace(/#.*$/,""),gi.HLINK);Rr(e,494,ufe(n,i))}}),delete t["!links"]}function Tfe(e,t,r,n){if(t["!comments"].length>0){var i=Wi(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",gi.VML);Rr(e,551,VN("rId"+i)),t["!legacy"]=i}}function Pfe(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:si(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Ol(s);l.s.r==l.e.r&&(l.e.r=Ol(t["!ref"]).e.r,s=si(l));for(var c=0;c<o.length;++c){var u=o[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Rr(e,161,dg(Ai(s))),Rr(e,162)}}function Ofe(e,t,r){Rr(e,133),Rr(e,137,yfe(t,r)),Rr(e,138),Rr(e,134)}function Mfe(e,t){t["!protect"]&&Rr(e,535,vfe(t["!protect"]))}function Lfe(e,t,r,n){var i=Pl(),s=r.SheetNames[e],o=r.Sheets[s]||{},l=s;try{r&&r.Workbook&&(l=r.Workbook.Sheets[e].CodeName||l)}catch{}var c=Ai(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Rr(i,129),(r.vbaraw||o["!outline"])&&Rr(i,147,Nde(l,o["!outline"])),Rr(i,148,jde(c)),Ofe(i,o,r.Workbook),Nfe(i,o),kfe(i,o,e,t),Mfe(i,o),Pfe(i,o,r,e),Afe(i,o),Efe(i,o,n),o["!margins"]&&Rr(i,476,gfe(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Cfe(i,o),Tfe(i,o,e,n),Rr(i,130),i.end()}function Rfe(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=ki((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function Ffe(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=Rfe(f);d.s.r=d.s.c=0,d.e.c=l,u=Ta(l),p[0].forEach(function(h,m){o[u+os(m)]={t:"n",v:h,z:p[1]},c=m}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(o["!ref"]=si(d)),o}function Bfe(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,l=e.match(CU);return l&&sC(l[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Ife(e,t){e.l+=10;var r=zo(e);return{name:r}}function Dfe(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return df(e,function(c,u,d){switch(d){case 550:s["!rel"]=c;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),c.name&&(i.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var oC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],$fe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ufe=[],zfe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ZP(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=pa(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function eO(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=pa(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function OU(e){eO(e.WBProps,oC),eO(e.CalcPr,zfe),ZP(e.WBView,$fe),ZP(e.Sheets,Ufe),gm.date1904=pa(e.WBProps.date1904)}function Wfe(e){return!e.Workbook||!e.Workbook.WBProps?"false":pa(e.Workbook.WBProps.date1904)?"true":"false"}var qfe="][*?/\\".split("");function MU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return qfe.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Hfe(e,t,r){e.forEach(function(n,i){MU(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Vfe(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Hfe(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Wue(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Gfe=/<\w+:workbook/;function Kfe(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(Go,function(c,u){var d=Vn(c);switch(ld(d[0])){case"<?xml":break;case"<workbook":c.match(Gfe)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":oC.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=pa(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=Ji(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=ki(Ji(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ji(d.name),d.comment&&(s.Comment=d.comment),d.localSheetId&&(s.Sheet=+d.localSheetId),pa(d.hidden||"0")&&(s.Hidden=!0),o=u+c.length;break;case"</definedName>":s.Ref=ki(Ji(e.slice(o,u))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Y0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return OU(r),r}function LU(e){var t=[ls];t[t.length]=tn("workbook",null,{xmlns:Y0[0],"xmlns:r":Ps.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(oC.forEach(function(l){e.Workbook.WBProps[l[0]]!=null&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=tn("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Vi(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=tn("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(t[t.length]=tn("definedName",Vi(l.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Yfe(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=D4(e),r.name=zo(e),r}function Xfe(e,t){return t||(t=_r(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),VN(e.strRelID,t),Ys(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Qfe(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?zo(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Jfe(e,t){t||(t=_r(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),k$(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Zfe(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function ehe(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=Tie(e),o=Bue(e,0,r),l=HN(e);e.l=n;var c={Name:s,Ptg:o};return i<268435455&&(c.Sheet=i),l&&(c.Comment=l),c}function the(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],v1[16]={n:"BrtFRTArchID$",f:Zfe},df(e,function(c,u,d){switch(d){case 156:o.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Lo(c.Ptg,null,null,o,t),delete t.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,c]):o[0]=[d,c],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(c),o.XTI=o.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),OU(r),r.Names=s,r.supbooks=o,r}function rhe(e,t){Rr(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Rr(e,156,Xfe(i))}Rr(e,144)}function nhe(e,t){t||(t=_r(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ys("SheetJS",t),Ys(M2.version,t),Ys(M2.version,t),Ys("7262",t),t.length>t.l?t.slice(0,t.l):t}function ihe(e,t){t||(t=_r(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function ahe(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(Rr(e,135),Rr(e,158,ihe(i)),Rr(e,136))}}function she(e,t){var r=Pl();return Rr(r,131),Rr(r,128,nhe()),Rr(r,153,Jfe(e.Workbook&&e.Workbook.WBProps||null)),ahe(r,e),rhe(r,e),Rr(r,132),r.end()}function ohe(e,t,r){return t.slice(-4)===".bin"?the(e,r):Kfe(e,r)}function lhe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?_fe(e,n,r,i,s,o,l):ede(e,n,r,i,s,o,l)}function che(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?Dfe(e,n,r,i,s):Bfe(e,n,r,i,s)}function uhe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?fce():hce()}function dhe(e,t,r,n,i,s,o,l){return t.slice(-4)===".bin"?uce():dce()}function fhe(e,t,r,n){return t.slice(-4)===".bin"?ole(e,r,n):Yoe(e,r,n)}function hhe(e,t,r){return pU(e,r)}function phe(e,t,r){return t.slice(-4)===".bin"?poe(e,r):doe(e,r)}function mhe(e,t,r){return t.slice(-4)===".bin"?ace(e,r):Xle(e,r)}function ghe(e,t,r){return t.slice(-4)===".bin"?Gle(e):Hle(e)}function xhe(e,t,r,n){return r.slice(-4)===".bin"?Kle(e,t,r,n):void 0}function yhe(e,t,r){return t.slice(-4)===".bin"?zle(e,t,r):qle(e,t,r)}function bhe(e,t,r){return(t.slice(-4)===".bin"?she:LU)(e)}function vhe(e,t,r,n,i){return(t.slice(-4)===".bin"?Lfe:EU)(e,r,n,i)}function whe(e,t,r){return(t.slice(-4)===".bin"?xle:fU)(e,r)}function She(e,t,r){return(t.slice(-4)===".bin"?xoe:iU)(e,r)}function _he(e,t,r){return(t.slice(-4)===".bin"?sce:xU)(e)}function jhe(e){return(e.slice(-4)===".bin"?Wle:mU)()}var RU=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,FU=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function tu(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(RU),s,o,l,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(FU),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?l="xmlns"+s[1].slice(6):l=s[1].slice(o+1),n[l]=s[2].slice(1,s[2].length-1));return n}function khe(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(RU),i,s,o,l;if(n)for(l=0;l!=n.length;++l)i=n[l].match(FU),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var Rx;function Ahe(e,t){var r=Rx[e]||ki(e);return r==="General"?S0(t):Wc(r,t)}function Nhe(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=pa(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=xa(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ki(t)]=i}function Che(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ff[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d1(e.v):e.w=S0(e.v):e.w=Ahe(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=Rx[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&lg(n)){var i=Xh(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function Ehe(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Uoe[n.Pattern]||n.Pattern)}e[t.ID]=t}function The(e,t,r,n,i,s,o,l,c,u){var d="General",f=n.StyleID,p={};u=u||{};var h=[],m=0;for(f===void 0&&l&&(f=l.StyleID),f===void 0&&o&&(f=o.StyleID);s[f]!==void 0&&(s[f].nf&&(d=s[f].nf),s[f].Interior&&h.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=pa(e);break;case"String":n.t="s",n.r=xP(ki(e)),n.v=e.indexOf("<")>-1?ki(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(xa(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ki(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=T$[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=xP(t||e));break}if(Che(n,d,u),u.cellFormula!==!1)if(n.Formula){var g=ki(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=mm(g,i),delete n.Formula,n.ArrayRange=="RC"?n.F=mm("RC:RC",i):n.ArrayRange&&(n.F=mm(n.ArrayRange,i),c.push([Ai(n.F),n.F]))}else for(m=0;m<c.length;++m)i.r>=c[m][0].s.r&&i.r<=c[m][0].e.r&&i.c>=c[m][0].s.c&&i.c<=c[m][0].e.c&&(n.F=c[m][1]);u.cellStyles&&(h.forEach(function(y){!p.patternType&&y.patternType&&(p.patternType=y.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Phe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function aj(e,t){var r=t||{};cg();var n=hx(DN(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ji(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=ya(r);return o.type="string",Dm.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Pe){i.indexOf("<"+Pe)>=0&&(s=!0)}),s)return g0e(n,r);Rx={"General Number":"General","General Date":qn[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":qn[15],"Short Date":qn[14],"Long Time":qn[19],"Medium Time":qn[18],"Short Time":qn[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:qn[2],Standard:qn[4],Percent:qn[10],Scientific:qn[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[],u,d={},f=[],p=r.dense?[]:{},h="",m={},g={},y=tu('<Data ss:Type="String">'),b=0,v=0,w=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},j={},k={},A="",R=0,M=[],B={},E={},P=0,D=[],G=[],H={},oe=[],de,W=!1,V=[],ae=[],ee={},C=0,Y=0,q={Sheets:[],WBProps:{date1904:!1}},O={};p1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var X="";l=p1.exec(n);)switch(l[3]=(X=l[3]).toLowerCase()){case"data":if(X=="data"){if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break}if(c[c.length-1][1])break;l[1]==="/"?The(n.slice(b,l.index),A,y,c[c.length-1][0]=="comment"?H:m,{c:v,r:w},j,oe[v],g,V,r):(A="",y=tu(l[0]),b=l.index+l[0].length);break;case"cell":if(l[1]==="/")if(G.length>0&&(m.c=G),(!r.sheetRows||r.sheetRows>w)&&m.v!==void 0&&(r.dense?(p[w]||(p[w]=[]),p[w][v]=m):p[Ta(v)+os(w)]=m),m.HRef&&(m.l={Target:ki(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(C=v+(parseInt(m.MergeAcross,10)|0),Y=w+(parseInt(m.MergeDown,10)|0),M.push({s:{c:v,r:w},e:{c:C,r:Y}})),!r.sheetStubs)m.MergeAcross?v=C+1:++v;else if(m.MergeAcross||m.MergeDown){for(var F=v;F<=C;++F)for(var Q=w;Q<=Y;++Q)(F>v||Q>w)&&(r.dense?(p[Q]||(p[Q]=[]),p[Q][F]={t:"z"}):p[Ta(F)+os(Q)]={t:"z"});v=C+1}else++v;else m=khe(l[0]),m.Index&&(v=+m.Index-1),v<S.s.c&&(S.s.c=v),v>S.e.c&&(S.e.c=v),l[0].slice(-2)==="/>"&&++v,G=[];break;case"row":l[1]==="/"||l[0].slice(-2)==="/>"?(w<S.s.r&&(S.s.r=w),w>S.e.r&&(S.e.r=w),l[0].slice(-2)==="/>"&&(g=tu(l[0]),g.Index&&(w=+g.Index-1)),v=0,++w):(g=tu(l[0]),g.Index&&(w=+g.Index-1),ee={},(g.AutoFitHeight=="0"||g.Height)&&(ee.hpx=parseInt(g.Height,10),ee.hpt=b1(ee.hpx),ae[w]=ee),g.Hidden=="1"&&(ee.hidden=!0,ae[w]=ee));break;case"worksheet":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));f.push(h),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(p["!ref"]=si(S),r.sheetRows&&r.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=r.sheetRows-1,p["!ref"]=si(S))),M.length&&(p["!merges"]=M),oe.length>0&&(p["!cols"]=oe),ae.length>0&&(p["!rows"]=ae),d[h]=p}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=v=0,c.push([l[3],!1]),u=tu(l[0]),h=ki(u.Name),p=r.dense?[]:{},M=[],V=[],ae=[],O={name:h,Hidden:0},q.Sheets.push(O);break;case"table":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if(l[0].slice(-2)=="/>")break;c.push([l[3],!1]),oe=[],W=!1}break;case"style":l[1]==="/"?Ehe(j,k,r):k=tu(l[0]);break;case"numberformat":k.nf=ki(tu(l[0]).Format||"General"),Rx[k.nf]&&(k.nf=Rx[k.nf]);for(var K=0;K!=392&&qn[K]!=k.nf;++K);if(K==392){for(K=57;K!=392;++K)if(qn[K]==null){Ud(k.nf,K);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(de=tu(l[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!W&&de.wpx>10){W=!0,Fo=uU;for(var ne=0;ne<oe.length;++ne)oe[ne]&&ph(oe[ne])}W&&ph(de),oe[de.Index-1||oe.length]=de;for(var re=0;re<+de.Span;++re)oe[oe.length]=ya(de);break;case"namedrange":if(l[1]==="/")break;q.Names||(q.Names=[]);var T=Vn(l[0]),I={Name:T.Name,Ref:mm(T.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(I.Sheet=q.Sheets.length-1),q.Names.push(I);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(l[0].slice(-2)==="/>")break;l[1]==="/"?A+=n.slice(R,l.index):R=l.index+l[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=tu(l[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(l[0].slice(-2)==="/>")break;l[1]==="/"?tae(B,X,n.slice(P,l.index)):P=l.index+l[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else c.push([l[3],!1]);break;case"comment":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));Phe(H),G.push(H)}else c.push([l[3],!1]),u=tu(l[0]),H={a:u.Author};break;case"autofilter":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if(l[0].charAt(l[0].length-2)!=="/"){var ie=tu(l[0]);p["!autofilter"]={ref:mm(ie.Range).replace(/\$/g,"")},c.push([l[3],!0])}break;case"name":break;case"datavalidation":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(l[1]==="/"){if((u=c.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else l[0].charAt(l[0].length-2)!=="/"&&c.push([l[3],!0]);break;case"null":break;default:if(c.length==0&&l[3]=="document"||c.length==0&&l[3]=="uof")return aO(n,r);var U=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:U=!1}break;case"componentoptions":switch(l[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:U=!1}break;case"excelworkbook":switch(l[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:U=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":break;case"height":break;case"width":break;default:U=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if(l[0].slice(-2)!=="/>")if(l[1]==="/")switch(n.slice(P,l.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else P=l.index+l[0].length;break;case"header":p["!margins"]||c0(p["!margins"]={},"xlml"),isNaN(+Vn(l[0]).Margin)||(p["!margins"].header=+Vn(l[0]).Margin);break;case"footer":p["!margins"]||c0(p["!margins"]={},"xlml"),isNaN(+Vn(l[0]).Margin)||(p["!margins"].footer=+Vn(l[0]).Margin);break;case"pagemargins":var Z=Vn(l[0]);p["!margins"]||c0(p["!margins"]={},"xlml"),isNaN(+Z.Top)||(p["!margins"].top=+Z.Top),isNaN(+Z.Left)||(p["!margins"].left=+Z.Left),isNaN(+Z.Right)||(p["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(p["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:U=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:U=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:U=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:U=!1}break;case"querytable":switch(l[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:U=!1}break;case"datavalidation":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:U=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:U=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:U=!1}break;case"smarttags":break;default:U=!1;break}if(U||l[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(l[0].slice(-2)==="/>")break;l[1]==="/"?Nhe(E,X,D,n.slice(P,l.index)):(D=l,P=l.index+l[0].length);break}if(r.WTF)throw"Unrecognized tag: "+l[3]+"|"+c.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=d),me.SheetNames=f,me.Workbook=q,me.SSF=ya(qn),me.Props=B,me.Custprops=E,me}function V4(e,t){switch(cC(t=t||{}),t.type||"base64"){case"base64":return aj(cc(e),t);case"binary":case"buffer":case"file":return aj(e,t);case"array":return aj(kh(e),t)}}function Ohe(e,t){var r=[];return e.Props&&r.push(rae(e.Props,t)),e.Custprops&&r.push(nae(e.Props,e.Custprops)),r.join("")}function Mhe(){return""}function Lhe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(tn("NumberFormat",null,{"ss:Format":Vi(qn[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(tn("Style",s.join(""),o))}),tn("Styles",r.join(""))}function BU(e){return tn("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+nC(e.Ref,{r:0,c:0})})}function Rhe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(BU(i)))}return tn("Names",r.join(""))}function Fhe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==r&&(l.Name.match(/^_xlfn\./)||s.push(BU(l)))}return s.join("")}function Bhe(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(tn("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(tn("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(tn("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(tn("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(go("ProtectContents","True")),e["!protect"].objects&&i.push(go("ProtectObjects","True")),e["!protect"].scenarios&&i.push(go("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(go("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(go("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":tn("WorksheetOptions",i.join(""),{xmlns:Yl.x})}function Ihe(e){return e.map(function(t){var r=aie(t.t||""),n=tn("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return tn("Comment",n,{"ss:Author":t.a})}).join("")}function Dhe(e,t,r,n,i,s,o){if(!e||e.v==null&&e.f==null)return"";var l={};if(e.f&&(l["ss:Formula"]="="+Vi(nC(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var c=Pa(e.F.slice(t.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=Vi(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=Vi(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=o.c||u[d].s.r!=o.r||(u[d].e.c>u[d].s.c&&(l["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(l["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",p=String(e.v);break;case"b":f="Boolean",p=e.v?"1":"0";break;case"e":f="Error",p=ff[e.v];break;case"d":f="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||qn[14]);break;case"s":f="String",p=iie(e.v||"");break}var h=Nh(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+h),l["ss:Index"]=o.c+1;var m=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+f+'">'+m+"</Data>";return(e.c||[]).length>0&&(g+=Ihe(e.c)),tn("Cell",g,l)}function $he(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=$m(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Uhe(e,t,r,n){if(!e["!ref"])return"";var i=Ai(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(y,b){ph(y);var v=!!y.width,w=OS(b,y),S={"ss:Index":b+1};v&&(S["ss:Width"]=x1(w.width)),y.hidden&&(S["ss:Hidden"]="1"),l.push(tn("Column",null,S))});for(var c=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var d=[$he(u,(e["!rows"]||[])[u])],f=i.s.c;f<=i.e.c;++f){var p=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>f)&&!(s[o].s.r>u)&&!(s[o].e.c<f)&&!(s[o].e.r<u)){(s[o].s.c!=f||s[o].s.r!=u)&&(p=!0);break}if(!p){var h={r:u,c:f},m=Hn(h),g=c?(e[u]||[])[f]:e[m];d.push(Dhe(g,m,e,t,r,n,h))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function zhe(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],o=s?Fhe(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?Uhe(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(Bhe(s,t,e,r)),n.join("")}function Whe(e,t){t||(t={}),e.SSF||(e.SSF=ya(qn)),e.SSF&&(cg(),kS(e.SSF),t.revssf=NS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Nh(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Ohe(e,t)),r.push(Mhe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(tn("Worksheet",zhe(n,t,e),{"ss:Name":Vi(e.SheetNames[n])}));return r[2]=Lhe(e,t),r[3]=Rhe(e),ls+tn("Workbook",r.join(""),{xmlns:Yl.ss,"xmlns:o":Yl.o,"xmlns:x":Yl.x,"xmlns:ss":Yl.ss,"xmlns:dt":Yl.dt,"xmlns:html":Yl.html})}function qhe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Rie(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Fie(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Hhe=[60,1084,2066,2165,2175];function Vhe(e,t,r,n,i){var s=n,o=[],l=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(l)}o.push(l),r.l+=s;for(var c=Ld(r,r.l),u=G4[c],d=0;u!=null&&Hhe.indexOf(c)>-1;)s=Ld(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),l=r.slice(d,r.l+4+s),o.push(l),r.l+=4+s,u=G4[c=Ld(r,r.l)];var f=Gs(o);mo(f,0);var p=0;f.lens=[];for(var h=0;h<o.length;++h)f.lens.push(p),p+=o[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,i)}function Ou(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=qn[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ff[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=d1(e.v):e.w=S0(e.v):e.w=Wc(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&lg(qn[n]||String(n))){var i=Xh(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Eb(e,t,r){return{v:e,ixfe:t,t:r}}function Ghe(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},l=null,c=[],u="",d={},f,p="",h,m,g,y,b={},v=[],w,S,j=[],k=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},R={},M=function(ce){return ce<8?s0[ce]:ce<64&&k[ce-8]||s0[ce]},B=function(ce,be,mt){var et=be.XF.data;if(!(!et||!et.patternType||!mt||!mt.cellStyles)){be.s={},be.s.patternType=et.patternType;var Ue;(Ue=g1(M(et.icvFore)))&&(be.s.fgColor={rgb:Ue}),(Ue=g1(M(et.icvBack)))&&(be.s.bgColor={rgb:Ue})}},E=function(ce,be,mt){if(!(ee>1)&&!(mt.sheetRows&&ce.r>=mt.sheetRows)){if(mt.cellStyles&&be.XF&&be.XF.data&&B(ce,be,mt),delete be.ixfe,delete be.XF,f=ce,p=Hn(ce),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),ce.r<o.s.r&&(o.s.r=ce.r),ce.c<o.s.c&&(o.s.c=ce.c),ce.r+1>o.e.r&&(o.e.r=ce.r+1),ce.c+1>o.e.c&&(o.e.c=ce.c+1),mt.cellFormula&&be.f){for(var et=0;et<v.length;++et)if(!(v[et][0].s.c>ce.c||v[et][0].s.r>ce.r)&&!(v[et][0].e.c<ce.c||v[et][0].e.r<ce.r)){be.F=si(v[et][0]),(v[et][0].s.c!=ce.c||v[et][0].s.r!=ce.r)&&delete be.f,be.f&&(be.f=""+Lo(v[et][1],o,ce,V,P));break}}mt.dense?(i[ce.r]||(i[ce.r]=[]),i[ce.r][ce.c]=be):i[p]=be}},P={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:v,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var D,G=[],H=[],oe=[],de=[],W=!1,V=[];V.SheetNames=P.snames,V.sharedf=P.sharedf,V.arrayf=P.arrayf,V.names=[],V.XTI=[];var ae=0,ee=0,C=0,Y=[],q=[],O;P.codepage=1200,du(1200);for(var X=!1;e.l<e.length-1;){var F=e.l,Q=e.read_shift(2);if(Q===0&&ae===10)break;var K=e.l===e.length?0:e.read_shift(2),ne=G4[Q];if(ne&&ne.f){if(t.bookSheets&&ae===133&&Q!==133)break;if(ae=Q,ne.r===2||ne.r==12){var re=e.read_shift(2);if(K-=2,!P.enc&&re!==Q&&((re&255)<<8|re>>8)!==Q)throw new Error("rt mismatch: "+re+"!="+Q);ne.r==12&&(e.l+=10,K-=10)}var T={};if(Q===10?T=ne.f(e,K,P):T=Vhe(Q,ne,e,K,P),ee==0&&[9,521,1033,2057].indexOf(ae)===-1)continue;switch(Q){case 34:r.opts.Date1904=A.WBProps.date1904=T;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=T,!t.password)throw new Error("File is password-protected");if(T.valid==null)throw new Error("Encryption scheme unsupported");if(!T.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=T;break;case 66:var I=Number(T);switch(I){case 21010:I=1200;break;case 32768:I=1e4;break;case 32769:I=1252;break}du(P.codepage=I),X=!0;break;case 317:P.rrtabid=T;break;case 25:P.winlocked=T;break;case 439:r.opts.RefreshAll=T;break;case 12:r.opts.CalcCount=T;break;case 16:r.opts.CalcDelta=T;break;case 17:r.opts.CalcIter=T;break;case 13:r.opts.CalcMode=T;break;case 14:r.opts.CalcPrecision=T;break;case 95:r.opts.CalcSaveRecalc=T;break;case 15:P.CalcRefMode=T;break;case 2211:r.opts.FullCalc=T;break;case 129:T.fDialog&&(i["!type"]="dialog"),T.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),T.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:j.push(T);break;case 430:V.push([T]),V[V.length-1].XTI=[];break;case 35:case 547:V[V.length-1].push(T);break;case 24:case 536:O={Name:T.Name,Ref:Lo(T.rgce,o,null,V,P)},T.itab>0&&(O.Sheet=T.itab-1),V.names.push(O),V[0]||(V[0]=[],V[0].XTI=[]),V[V.length-1].push(T),T.Name=="_xlnm._FilterDatabase"&&T.itab>0&&T.rgce&&T.rgce[0]&&T.rgce[0][0]&&T.rgce[0][0][0]=="PtgArea3d"&&(q[T.itab-1]={ref:si(T.rgce[0][0][1][2])});break;case 22:P.ExternCount=T;break;case 23:V.length==0&&(V[0]=[],V[0].XTI=[]),V[V.length-1].XTI=V[V.length-1].XTI.concat(T),V.XTI=V.XTI.concat(T);break;case 2196:if(P.biff<8)break;O!=null&&(O.Comment=T[1]);break;case 18:i["!protect"]=T;break;case 19:T!==0&&P.WTF&&console.error("Password verifier: "+T);break;case 133:s[T.pos]=T,P.snames.push(T.name);break;case 10:{if(--ee)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=si(o),t.sheetRows&&t.sheetRows<=o.e.r){var ie=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=si(o),o.e.r=ie}o.e.r++,o.e.c++}G.length>0&&(i["!merges"]=G),H.length>0&&(i["!objects"]=H),oe.length>0&&(i["!cols"]=oe),de.length>0&&(i["!rows"]=de),A.Sheets.push(R)}u===""?d=i:n[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[Q]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[T.BIFFVer]||8),P.biffguess=T.BIFFVer==0,T.BIFFVer==0&&T.dt==4096&&(P.biff=5,X=!0,du(P.codepage=28591)),P.biff==8&&T.BIFFVer==0&&T.dt==16&&(P.biff=2),ee++)break;if(i=t.dense?[]:{},P.biff<8&&!X&&(X=!0,du(P.codepage=t.codepage||1252)),P.biff<5||T.BIFFVer==0&&T.dt==4096){u===""&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var U={pos:e.l-K,name:u};s[U.pos]=U,P.snames.push(u)}else u=(s[F]||{name:""}).name;T.dt==32&&(i["!type"]="chart"),T.dt==64&&(i["!type"]="macro"),G=[],H=[],P.arrayf=v=[],oe=[],de=[],W=!1,R={Hidden:(s[F]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[T.r]||[])[T.c]:i[Hn({c:T.c,r:T.r})])&&++T.c,w={ixfe:T.ixfe,XF:j[T.ixfe]||{},v:T.val,t:"n"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 5:case 517:w={ixfe:T.ixfe,XF:j[T.ixfe],v:T.val,t:T.t},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 638:w={ixfe:T.ixfe,XF:j[T.ixfe],v:T.rknum,t:"n"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 189:for(var Z=T.c;Z<=T.C;++Z){var me=T.rkrec[Z-T.c][0];w={ixfe:me,XF:j[me],v:T.rkrec[Z-T.c][1],t:"n"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:Z,r:T.r},w,t)}break;case 6:case 518:case 1030:{if(T.val=="String"){l=T;break}if(w=Eb(T.val,T.cell.ixfe,T.tt),w.XF=j[w.ixfe],t.cellFormula){var Pe=T.formula;if(Pe&&Pe[0]&&Pe[0][0]&&Pe[0][0][0]=="PtgExp"){var je=Pe[0][0][1][0],Fe=Pe[0][0][1][1],_e=Hn({r:je,c:Fe});b[_e]?w.f=""+Lo(T.formula,o,T.cell,V,P):w.F=((t.dense?(i[je]||[])[Fe]:i[_e])||{}).F}else w.f=""+Lo(T.formula,o,T.cell,V,P)}C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E(T.cell,w,t),l=T}break;case 7:case 519:if(l)l.val=T,w=Eb(T,l.cell.ixfe,"s"),w.XF=j[w.ixfe],t.cellFormula&&(w.f=""+Lo(l.formula,o,l.cell,V,P)),C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E(l.cell,w,t),l=null;else throw new Error("String record expects Formula");break;case 33:case 545:{v.push(T);var He=Hn(T[0].s);if(h=t.dense?(i[T[0].s.r]||[])[T[0].s.c]:i[He],t.cellFormula&&h){if(!l||!He||!h)break;h.f=""+Lo(T[1],o,T[0],V,P),h.F=si(T[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!l)break;b[Hn(l.cell)]=T[0],h=t.dense?(i[l.cell.r]||[])[l.cell.c]:i[Hn(l.cell)],(h||{}).f=""+Lo(T[0],o,f,V,P)}}break;case 253:w=Eb(c[T.isst].t,T.ixfe,"s"),c[T.isst].h&&(w.h=c[T.isst].h),w.XF=j[w.ixfe],C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:T.ixfe,XF:j[T.ixfe],t:"z"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t));break;case 190:if(t.sheetStubs)for(var qe=T.c;qe<=T.C;++qe){var Pt=T.ixfe[qe-T.c];w={ixfe:Pt,XF:j[Pt],t:"z"},C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:qe,r:T.r},w,t)}break;case 214:case 516:case 4:w=Eb(T.val,T.ixfe,"s"),w.XF=j[w.ixfe],C>0&&(w.z=Y[w.ixfe>>8&63]),Ou(w,t,r.opts.Date1904),E({c:T.c,r:T.r},w,t);break;case 0:case 512:ee===1&&(o=T);break;case 252:c=T;break;case 1054:if(P.biff==4){Y[C++]=T[1];for(var ut=0;ut<C+163&&qn[ut]!=T[1];++ut);ut>=163&&Ud(T[1],C+163)}else Ud(T[1],T[0]);break;case 30:{Y[C++]=T;for(var Ke=0;Ke<C+163&&qn[Ke]!=T;++Ke);Ke>=163&&Ud(T,C+163)}break;case 229:G=G.concat(T);break;case 93:H[T.cmo[0]]=P.lastobj=T;break;case 438:P.lastobj.TxO=T;break;case 127:P.lastobj.ImData=T;break;case 440:for(y=T[0].s.r;y<=T[0].e.r;++y)for(g=T[0].s.c;g<=T[0].e.c;++g)h=t.dense?(i[y]||[])[g]:i[Hn({c:g,r:y})],h&&(h.l=T[1]);break;case 2048:for(y=T[0].s.r;y<=T[0].e.r;++y)for(g=T[0].s.c;g<=T[0].e.c;++g)h=t.dense?(i[y]||[])[g]:i[Hn({c:g,r:y})],h&&h.l&&(h.l.Tooltip=T[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;h=t.dense?(i[T[0].r]||[])[T[0].c]:i[Hn(T[0])];var lt=H[T[2]];h||(t.dense?(i[T[0].r]||(i[T[0].r]=[]),h=i[T[0].r][T[0].c]={t:"z"}):h=i[Hn(T[0])]={t:"z"},o.e.r=Math.max(o.e.r,T[0].r),o.s.r=Math.min(o.s.r,T[0].r),o.e.c=Math.max(o.e.c,T[0].c),o.s.c=Math.min(o.s.c,T[0].c)),h.c||(h.c=[]),m={a:T[1],t:lt.TxO.t},h.c.push(m)}break;case 2173:Lle(j[T.ixfe],T.ext);break;case 125:{if(!P.cellStyles)break;for(;T.e>=T.s;)oe[T.e--]={width:T.w/256,level:T.level||0,hidden:!!(T.flags&1)},W||(W=!0,eC(T.w/256)),ph(oe[T.e+1])}break;case 520:{var ve={};T.level!=null&&(de[T.r]=ve,ve.level=T.level),T.hidden&&(de[T.r]=ve,ve.hidden=!0),T.hpt&&(de[T.r]=ve,ve.hpt=T.hpt,ve.hpx=$m(T.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||c0(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Q]]=T;break;case 161:i["!margins"]||c0(i["!margins"]={}),i["!margins"].header=T.header,i["!margins"].footer=T.footer;break;case 574:T.RTL&&(A.Views[0].RTL=!0);break;case 146:k=T;break;case 2198:D=T;break;case 140:S=T;break;case 442:u?R.CodeName=T||R.name:A.WBProps.CodeName=T||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+Q.toString(16)),e.l+=K}return r.SheetNames=Ka(s).sort(function(Ae,ce){return Number(Ae)-Number(ce)}).map(function(Ae){return s[Ae].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(Ae,ce){r.Sheets[r.SheetNames[ce]]["!autofilter"]=Ae}),r.Strings=c,r.SSF=ya(qn),P.enc&&(r.Encryption=P.enc),D&&(r.Themes=D),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),V.names.length>0&&(A.Names=V.names),r.Workbook=A,r}var Fx={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Khe(e,t,r){var n=In.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=RP(n,$4,Fx.DSI);for(var s in i)t[s]=i[s]}catch(u){if(r.WTF)throw u}var o=In.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=RP(o,U4,Fx.SI);for(var c in l)t[c]==null&&(t[c]=l[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(F$(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Yhe(e,t){var r=[],n=[],i=[],s=0,o,l=dP($4,"n"),c=dP(U4,"n");if(e.Props)for(o=Ka(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Ka(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?r:Object.prototype.hasOwnProperty.call(c,o[s])?n:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)W$.indexOf(i[s][0])>-1||R$.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&In.utils.cfb_add(t,"/SummaryInformation",FP(n,Fx.SI,c,U4)),(r.length||u.length)&&In.utils.cfb_add(t,"/DocumentSummaryInformation",FP(r,Fx.DSI,l,$4,u.length?u:null,Fx.UDI))}function IU(e,t){t||(t={}),cC(t),TN(),t.codepage&&EN(t.codepage);var r,n;if(e.FullPaths){if(In.find(e,"/encryption"))throw new Error("File is password-protected");r=In.find(e,"!CompObj"),n=In.find(e,"/Workbook")||In.find(e,"/Book")}else{switch(t.type){case"base64":e=Ql(cc(e));break;case"binary":e=Ql(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}mo(e,0),n={content:e}}var i,s;if(r&&qhe(r),t.bookProps&&!t.bookSheets)i={};else{var o=mi?"buffer":"array";if(n&&n.content)i=Ghe(n.content,t);else if((s=In.find(e,"PerfectOffice_MAIN"))&&s.content)i=l0.to_workbook(s.content,(t.type=o,t));else if((s=In.find(e,"NativeContent_MAIN"))&&s.content)i=l0.to_workbook(s.content,(t.type=o,t));else throw(s=In.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&In.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=lce(e))}var l={};return e.FullPaths&&Khe(e,l,t),i.Props=i.Custprops=l,t.bookFiles&&(i.cfb=e),i}function Xhe(e,t){var r=t||{},n=In.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return In.utils.cfb_add(n,i,DU(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Yhe(e,n),r.biff==8&&e.vbaraw&&cce(n,In.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var v1={0:{f:vde},1:{f:Cde},2:{f:Gde},3:{f:Fde},4:{f:Ode},5:{f:qde},6:{f:Jde},7:{f:$de},8:{f:afe},9:{f:ife},10:{f:rfe},11:{f:nfe},12:{f:Tde},13:{f:Yde},14:{f:Ide},15:{f:Lde},16:{f:TU},17:{f:efe},18:{f:zde},19:{f:qN},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ehe},40:{},42:{},43:{f:Joe},44:{f:Xoe},45:{f:tle},46:{f:nle},47:{f:rle},48:{},49:{f:_ie},50:{},51:{f:Ble},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:eU},62:{f:Qde},63:{f:Vle},64:{f:wfe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ho,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:xfe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ade},148:{f:_de,p:16},151:{f:dfe},152:{},153:{f:Qfe},154:{},155:{},156:{f:Yfe},157:{},158:{},159:{T:1,f:hoe},160:{T:-1},161:{T:1,f:Z0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:sfe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Rle},336:{T:-1},337:{f:$le,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:D4},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Z$},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ffe},427:{f:hfe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:mfe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:kde},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:cfe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:D4},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:nce},633:{T:1},634:{T:-1},635:{T:1,f:tce},636:{T:-1},637:{f:Nie},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Ife},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Sfe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},G4={6:{f:nj},10:{f:Nf},12:{f:ps},13:{f:ps},14:{f:Za},15:{f:Za},16:{f:Do},17:{f:Za},18:{f:Za},19:{f:ps},20:{f:zP},21:{f:zP},23:{f:Z$},24:{f:qP},25:{f:Za},26:{},27:{},28:{f:Sse},29:{},34:{f:Za},35:{f:WP},38:{f:Do},39:{f:Do},40:{f:Do},41:{f:Do},42:{f:Za},43:{f:Za},47:{f:Loe},49:{f:Yae},51:{f:ps},60:{},61:{f:qae},64:{f:Za},65:{f:Kae},66:{f:ps},77:{},80:{},81:{},82:{},85:{f:ps},89:{},90:{},91:{},92:{f:Mae},93:{f:kse},94:{},95:{f:Za},96:{},97:{},99:{f:Za},125:{f:eU},128:{f:use},129:{f:Rae},130:{f:ps},131:{f:Za},132:{f:Za},133:{f:Fae},134:{},140:{f:Mse},141:{f:ps},144:{},146:{f:Fse},151:{},152:{},153:{},154:{},155:{},156:{f:ps},157:{},158:{},160:{f:Wse},161:{f:Dse},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:sse},190:{f:ose},193:{f:Nf},197:{},198:{},199:{},200:{},201:{},202:{f:Za},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:ps},220:{},221:{f:Za},222:{},224:{f:cse},225:{f:Oae},226:{f:Nf},227:{},229:{f:_se},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Iae},253:{f:Qae},255:{f:$ae},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:q$},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Za},353:{f:Nf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:mse},431:{f:Za},432:{},433:{},434:{},437:{},438:{f:Cse},439:{f:Za},440:{f:Ese},441:{},442:{f:ay},443:{},444:{f:ps},445:{},446:{},448:{f:Nf},449:{f:Wae,r:2},450:{f:Nf},512:{f:DP},513:{f:zse},515:{f:hse},516:{f:Zae},517:{f:UP},519:{f:qse},520:{f:Uae},523:{},545:{f:HP},549:{f:IP},566:{},574:{f:Vae},638:{f:ase},659:{},1048:{},1054:{f:tse},1084:{},1212:{f:bse},2048:{f:Pse},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ab},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Nf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Bse,r:12},2173:{f:Mle,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Za,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:yse,r:12},2197:{},2198:{f:Nle,r:12},2199:{},2200:{},2201:{},2202:{f:vse,r:12},2203:{f:Nf},2204:{},2205:{},2206:{},2207:{},2211:{f:zae},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:ps},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:$se},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Rse},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:DP},1:{},2:{f:Yse},3:{f:Gse},4:{f:Vse},5:{f:UP},7:{f:Qse},8:{},9:{f:Ab},11:{},22:{f:ps},30:{f:nse},31:{},32:{},33:{f:HP},36:{},37:{f:IP},50:{f:Jse},62:{},52:{},67:{},68:{f:ps},69:{},86:{},126:{},127:{f:Hse},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Zse},223:{},234:{},354:{},421:{},518:{f:nj},521:{f:Ab},536:{f:qP},547:{f:WP},561:{},579:{},1030:{f:nj},1033:{f:Ab},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function rn(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&UN(r)&&e.push(r)}}function Qhe(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return rn(e,t,r,i);var s=t;if(!isNaN(s)){for(var o=r.parts||[],l=0,c=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var d=e.next(4);for(d.write_shift(2,s),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<i;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function cy(e,t,r){return e||(e=_r(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Jhe(e,t,r,n){var i=_r(9);return cy(i,e,t),H$(r,n||"b",i),i}function Zhe(e,t,r){var n=_r(8+2*r.length);return cy(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function e0e(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Ms(xa(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?rn(e,2,Xse(r,n,i)):rn(e,3,Kse(r,n,i));return;case"b":case"e":rn(e,5,Jhe(r,n,t.v,t.t));return;case"s":case"str":rn(e,4,Zhe(r,n,(t.v||"").slice(0,255)));return}rn(e,1,cy(null,r,n))}function t0e(e,t,r,n){var i=Array.isArray(t),s=Ai(t["!ref"]||"A1"),o,l="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=si(s)}for(var u=s.s.r;u<=s.e.r;++u){l=os(u);for(var d=s.s.c;d<=s.e.c;++d){u===s.s.r&&(c[d]=Ta(d)),o=c[d]+l;var f=i?(t[u]||[])[d]:t[o];f&&e0e(e,f,u,d)}}}function r0e(e,t){for(var r=t||{},n=Pl(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return rn(n,r.biff==4?1033:r.biff==3?521:9,QN(e,16,r)),t0e(n,e.Sheets[e.SheetNames[i]],i,r),rn(n,10),n.end()}function n0e(e,t,r){rn(e,49,Xae({sz:12,name:"Arial"},r))}function i0e(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&rn(e,1054,rse(i,t[i],r))})}function a0e(e,t){var r=_r(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),rn(e,2151,r),r=_r(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),X$(Ai(t["!ref"]||"A1"),r),r.write_shift(4,4),rn(e,2152,r)}function s0e(e,t){for(var r=0;r<16;++r)rn(e,224,$P({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){rn(e,224,$P(n,0,t))})}function o0e(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];rn(e,440,Tse(n)),n[1].Tooltip&&rn(e,2048,Ose(n))}delete t["!links"]}function l0e(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&rn(e,125,Ise(OS(i,n),i))})}}function c0e(e,t,r,n,i){var s=16+Nh(i.cellXfs,t,i);if(t.v==null&&!t.bf){rn(e,513,A0(r,n,s));return}if(t.bf)rn(e,6,Rue(t,r,n,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Ms(xa(t.v)):t.v;rn(e,515,pse(r,n,o,s));break;case"b":case"e":rn(e,517,fse(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var l=aC(i.Strings,t.v,i.revStrings);rn(e,253,Jae(r,n,l,s))}else rn(e,516,ese(r,n,(t.v||"").slice(0,255),s,i));break;default:rn(e,513,A0(r,n,s))}}function u0e(e,t,r){var n=Pl(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},l=(o.Sheets||[])[e]||{},c=Array.isArray(s),u=t.biff==8,d,f="",p=[],h=Ai(s["!ref"]||"A1"),m=u?65536:16384;if(h.e.c>255||h.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,m-1)}rn(n,2057,QN(r,16,t)),rn(n,13,Mc(1)),rn(n,12,Mc(100)),rn(n,15,tl(!0)),rn(n,17,tl(!1)),rn(n,16,j0(.001)),rn(n,95,tl(!0)),rn(n,42,tl(!1)),rn(n,43,tl(!1)),rn(n,130,Mc(1)),rn(n,128,dse()),rn(n,131,tl(!1)),rn(n,132,tl(!1)),u&&l0e(n,s["!cols"]),rn(n,512,ise(h,t)),u&&(s["!links"]=[]);for(var g=h.s.r;g<=h.e.r;++g){f=os(g);for(var y=h.s.c;y<=h.e.c;++y){g===h.s.r&&(p[y]=Ta(y)),d=p[y]+f;var b=c?(s[g]||[])[y]:s[d];b&&(c0e(n,b,g,y,t),u&&b.l&&s["!links"].push([d,b.l]))}}var v=l.CodeName||l.name||i;return u&&rn(n,574,Gae((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&rn(n,229,jse(s["!merges"])),u&&o0e(n,s),rn(n,442,V$(v)),u&&a0e(n,s),rn(n,10),n.end()}function d0e(e,t,r){var n=Pl(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},l=r.biff==8,c=r.biff==5;if(rn(n,2057,QN(e,5,r)),r.bookType=="xla"&&rn(n,135),rn(n,225,l?Mc(1200):null),rn(n,193,fae(2)),c&&rn(n,191),c&&rn(n,192),rn(n,226),rn(n,92,Lae("SheetJS",r)),rn(n,66,Mc(l?1200:1252)),l&&rn(n,353,Mc(0)),l&&rn(n,448),rn(n,317,Use(e.SheetNames.length)),l&&e.vbaraw&&rn(n,211),l&&e.vbaraw){var u=o.CodeName||"ThisWorkbook";rn(n,442,V$(u))}rn(n,156,Mc(17)),rn(n,25,tl(!1)),rn(n,18,tl(!1)),rn(n,19,Mc(0)),l&&rn(n,431,tl(!1)),l&&rn(n,444,Mc(0)),rn(n,61,Hae()),rn(n,64,tl(!1)),rn(n,141,Mc(0)),rn(n,34,tl(Wfe(e)=="true")),rn(n,14,tl(!0)),l&&rn(n,439,tl(!1)),rn(n,218,Mc(0)),n0e(n,e,r),i0e(n,e.SSF,r),s0e(n,r),l&&rn(n,352,tl(!1));var d=n.end(),f=Pl();l&&rn(f,140,Lse()),l&&r.Strings&&Qhe(f,252,Dae(r.Strings)),rn(f,10);var p=f.end(),h=Pl(),m=0,g=0;for(g=0;g<e.SheetNames.length;++g)m+=(l?12:11)+(l?2:1)*e.SheetNames[g].length;var y=d.length+m+p.length;for(g=0;g<e.SheetNames.length;++g){var b=s[g]||{};rn(h,133,Bae({pos:y,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var v=h.end();if(m!=v.length)throw new Error("BS8 "+m+" != "+v.length);var w=[];return d.length&&w.push(d),v.length&&w.push(v),p.length&&w.push(p),Gs(w)}function f0e(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ya(qn)),e&&e.SSF&&(cg(),kS(e.SSF),r.revssf=NS(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,uC(r),r.cellXfs=[],Nh(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=u0e(i,r,e);return n.unshift(d0e(e,n,r)),Gs(n)}function DU(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ol(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return f0e(e,t);case 4:case 3:case 2:return r0e(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function tO(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,l=s&&s.index||e.length,c=Xne(e.slice(o,l),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<c.length;++o){var g=c[o].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var b=g.split(/<\/t[dh]>/i);for(l=0;l<b.length;++l){var v=b[l].trim();if(v.match(/<t[dh]/i)){for(var w=v,S=0;w.charAt(0)=="<"&&(S=w.indexOf(">"))>-1;)w=w.slice(S+1);for(var j=0;j<m.length;++j){var k=m[j];k.s.c==d&&k.s.r<u&&u<=k.e.r&&(d=k.e.c+1,j=-1)}var A=Vn(v.slice(0,v.indexOf(">")));p=A.colspan?+A.colspan:1,((f=+A.rowspan)>1||p>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+p-1}});var R=A.t||A["data-t"]||"";if(!w.length){d+=p;continue}if(w=c$(w),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!w.length){d+=p;continue}var M={t:"s",v:w};r.raw||!w.trim().length||R=="s"||(w==="TRUE"?M={t:"b",v:!0}:w==="FALSE"?M={t:"b",v:!1}:isNaN(mu(w))?isNaN(Im(w).getDate())||(M={t:"d",v:xa(w)},r.cellDates||(M={t:"n",v:Ms(M.v)}),M.z=r.dateNF||qn[14]):M={t:"n",v:mu(w)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=M):n[Hn({r:u,c:d})]=M,d+=p}}}}return n["!ref"]=si(h),m.length&&(n["!merges"]=m),n}function h0e(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var l=0,c=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){l=-1;break}l=i[u].e.r-i[u].s.r+1,c=i[u].e.c-i[u].s.c+1;break}if(!(l<0)){var d=Hn({r,c:o}),f=n.dense?(e[r]||[])[o]:e[d],p=f&&f.v!=null&&(f.h||IN(f.w||(Xd(f),f.w)||""))||"",h={};l>1&&(h.rowspan=l),c>1&&(h.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+d,s.push(tn("td",p,h))}}var m="<tr>";return m+s.join("")+"</tr>"}var p0e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',m0e="</body></html>";function g0e(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ah(tO(r[0],t),t);var n=hC();return r.forEach(function(i,s){pC(n,tO(i,t),"Sheet"+(s+1))}),n}function x0e(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function $U(e,t){var r=t||{},n=r.header!=null?r.header:p0e,i=r.footer!=null?r.footer:m0e,s=[n],o=Ol(e["!ref"]);r.dense=Array.isArray(e),s.push(x0e(e,o,r));for(var l=o.s.r;l<=o.e.r;++l)s.push(h0e(e,o,l,r));return s.push("</table>"+i),s.join("")}function UU(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?Pa(n.origin):n.origin;i=o.r,s=o.c}var l=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,l.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var d=Ol(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),i==-1&&(u.e.r=i=d.e.r+1)}var f=[],p=0,h=e["!rows"]||(e["!rows"]=[]),m=0,g=0,y=0,b=0,v=0,w=0;for(e["!cols"]||(e["!cols"]=[]);m<l.length&&g<c;++m){var S=l[m];if(rO(S)){if(n.display)continue;h[g]={hidden:!0}}var j=S.children;for(y=b=0;y<j.length;++y){var k=j[y];if(!(n.display&&rO(k))){var A=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):c$(k.innerHTML),R=k.getAttribute("data-z")||k.getAttribute("z");for(p=0;p<f.length;++p){var M=f[p];M.s.c==b+s&&M.s.r<g+i&&g+i<=M.e.r&&(b=M.e.c+1-s,p=-1)}w=+k.getAttribute("colspan")||1,((v=+k.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:g+i,c:b+s},e:{r:g+i+(v||1)-1,c:b+s+(w||1)-1}});var B={t:"s",v:A},E=k.getAttribute("data-t")||k.getAttribute("t")||"";A!=null&&(A.length==0?B.t=E||"z":n.raw||A.trim().length==0||E=="s"||(A==="TRUE"?B={t:"b",v:!0}:A==="FALSE"?B={t:"b",v:!1}:isNaN(mu(A))?isNaN(Im(A).getDate())||(B={t:"d",v:xa(A)},n.cellDates||(B={t:"n",v:Ms(B.v)}),B.z=n.dateNF||qn[14]):B={t:"n",v:mu(A)})),B.z===void 0&&R!=null&&(B.z=R);var P="",D=k.getElementsByTagName("A");if(D&&D.length)for(var G=0;G<D.length&&!(D[G].hasAttribute("href")&&(P=D[G].getAttribute("href"),P.charAt(0)!="#"));++G);P&&P.charAt(0)!="#"&&(B.l={Target:P}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][b+s]=B):e[Hn({c:b+s,r:g+i})]=B,u.e.c<b+s&&(u.e.c=b+s),b+=w}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=si(u),g>=c&&(e["!fullref"]=si((u.e.r=l.length-m+g-1+i,u))),e}function zU(e,t){var r=t||{},n=r.dense?[]:{};return UU(n,e,t)}function y0e(e,t){return Ah(zU(e,t),t)}function rO(e){var t="",r=b0e(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function b0e(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function v0e(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ki(t.replace(/<[^>]*>/g,""));return[r]}var nO={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function WU(e,t){var r=t||{},n=DN(e),i=[],s,o,l={name:""},c="",u=0,d,f,p={},h=[],m=r.dense?[]:{},g,y,b={value:""},v="",w=0,S=[],j=-1,k=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},R=0,M={},B=[],E={},P=0,D=0,G=[],H=1,oe=1,de=[],W={Names:[]},V={},ae=["",""],ee=[],C={},Y="",q=0,O=!1,X=!1,F=0;for(p1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=p1.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?m["!ref"]=si(A):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(m["!fullref"]=m["!ref"],A.e.r=r.sheetRows-1,m["!ref"]=si(A)),B.length&&(m["!merges"]=B),G.length&&(m["!rows"]=G),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),p[d.name]=m,X=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=Vn(g[0],!1),j=k=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,m=r.dense?[]:{},B=[],G=[],X=!0);break;case"table-row-group":g[1]==="/"?--R:++R;break;case"table-row":case"":if(g[1]==="/"){j+=H,H=1;break}if(f=Vn(g[0],!1),f.?j=f.-1:j==-1&&(j=0),H=+f["number-rows-repeated"]||1,H<10)for(F=0;F<H;++F)R>0&&(G[j+F]={level:R});k=-1;break;case"covered-table-cell":g[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(m[j]||(m[j]=[]),m[j][k]={t:"z"}):m[Hn({r:j,c:k})]={t:"z"}),v="",S=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++k,b=Vn(g[0],!1),oe=parseInt(b["number-columns-repeated"]||"1",10),y={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(y.f=JP(ki(b.formula))),(b.||b["value-type"])=="string"&&(y.t="s",y.v=ki(b["string-value"]||""),r.dense?(m[j]||(m[j]=[]),m[j][k]=y):m[Hn({r:j,c:k})]=y),k+=oe-1;else if(g[1]!=="/"){++k,v="",w=0,S=[],oe=1;var Q=H?j+H-1:j;if(k>A.e.c&&(A.e.c=k),k<A.s.c&&(A.s.c=k),j<A.s.r&&(A.s.r=j),Q>A.e.r&&(A.e.r=Q),b=Vn(g[0],!1),ee=[],C={},y={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=ki(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(P=parseInt(b["number-matrix-rows-spanned"],10)||0,D=parseInt(b["number-matrix-columns-spanned"],10)||0,E={s:{r:j,c:k},e:{r:j+P-1,c:k+D-1}},y.F=si(E),de.push([E,y.F])),b.formula)y.f=JP(b.formula);else for(F=0;F<de.length;++F)j>=de[F][0].s.r&&j<=de[F][0].e.r&&k>=de[F][0].s.c&&k<=de[F][0].e.c&&(y.F=de[F][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(P=parseInt(b["number-rows-spanned"],10)||0,D=parseInt(b["number-columns-spanned"],10)||0,E={s:{r:j,c:k},e:{r:j+P-1,c:k+D-1}},B.push(E)),b["number-columns-repeated"]&&(oe=parseInt(b["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=pa(b["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(b.value);break;case"percentage":y.t="n",y.v=parseFloat(b.value);break;case"currency":y.t="n",y.v=parseFloat(b.value);break;case"date":y.t="d",y.v=xa(b["date-value"]),r.cellDates||(y.t="n",y.v=Ms(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=Gne(b["time-value"])/86400,r.cellDates&&(y.t="d",y.v=CS(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(b.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",b["string-value"]!=null&&(v=ki(b["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(O=!1,y.t==="s"&&(y.v=v||"",S.length&&(y.R=S),O=w==0),V.Target&&(y.l=V),ee.length>0&&(y.c=ee,ee=[]),v&&r.cellText!==!1&&(y.w=v),O&&(y.t="z",delete y.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=j))for(var K=0;K<H;++K){if(oe=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(m[j+K]||(m[j+K]=[]),m[j+K][k]=K==0?y:ya(y);--oe>0;)m[j+K][k+oe]=ya(y);else for(m[Hn({r:j+K,c:k})]=y;--oe>0;)m[Hn({r:j+K,c:k+oe})]=ya(y);A.e.c<=k&&(A.e.c=k)}oe=parseInt(b["number-columns-repeated"]||"1",10),k+=oe-1,oe=0,y={},v="",S=[]}V={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s;C.t=v,S.length&&(C.R=S),C.a=Y,ee.push(C)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);Y="",q=0,v="",w=0,S=[];break;case"creator":g[1]==="/"?Y=n.slice(q,g.index):q=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);v="",w=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(M[l.name]=c,(s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(c="",l=Vn(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Vn(g[0],!1),c+=nO[g[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Vn(g[0],!1),c+=nO[g[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":o=Vn(g[0],!1),ae=ij(o["cell-range-address"]);var ne={Name:o.name,Ref:ae[0]+"!"+ae[1]};X&&(ne.Sheet=h.length),W.Names.push(ne);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var re=v0e(n.slice(w,g.index));v=(v.length>0?v+`
`:"")+re[0]}else Vn(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ae=ij(Vn(g[0])["target-range-address"]),p[ae[0]]["!autofilter"]={ref:ae[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(V=Vn(g[0],!1),!V.href)break;V.Target=ki(V.href),delete V.href,V.Target.charAt(0)=="#"&&V.Target.indexOf(".")>-1?(ae=ij(V.Target.slice(1)),V.Target="#"+ae[0]+"!"+ae[1]):V.Target.match(/^\.\.[\\\/]/)&&(V.Target=V.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var T={Sheets:p,SheetNames:h,Workbook:W};return r.bookSheets&&delete T.Sheets,T}function iO(e,t){t=t||{},Oc(e,"META-INF/manifest.xml")&&Gie(hs(e,"META-INF/manifest.xml"),t);var r=Jl(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=WU(Ji(r),t);return Oc(e,"meta.xml")&&(n.Props=M$(hs(e,"meta.xml"))),n}function aO(e,t){return WU(e,t)}var w0e=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+h1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ls+t}}(),sO=function(){var e=function(s){return Vi(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,l){var c=[];c.push('      <table:table table:name="'+Vi(o.SheetNames[l])+`" table:style-name="ta1">
`);var u=0,d=0,f=Ol(s["!ref"]||"A1"),p=s["!merges"]||[],h=0,m=Array.isArray(s);if(s["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(s["!cols"][d]?' table:style-name="co'+s["!cols"][d].ods+'"':"")+`></table:table-column>
`);var g="",y=s["!rows"]||[];for(u=0;u<f.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=f.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var b=!1,v={},w="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>d)&&!(p[h].s.r>u)&&!(p[h].e.c<d)&&!(p[h].e.r<u)){(p[h].s.c!=d||p[h].s.r!=u)&&(b=!0),v["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,v["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(b){c.push(r);continue}var S=Hn({r:u,c:d}),j=m?(s[u]||[])[d]:s[S];if(j&&j.f&&(v["table:formula"]=Vi(Uue(j.f)),j.F&&j.F.slice(0,S.length)==S)){var k=Ol(j.F);v["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,v["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!j){c.push(t);continue}switch(j.t){case"b":w=j.v?"TRUE":"FALSE",v["office:value-type"]="boolean",v["office:boolean-value"]=j.v?"true":"false";break;case"n":w=j.w||String(j.v||0),v["office:value-type"]="float",v["office:value"]=j.v||0;break;case"s":case"str":w=j.v==null?"":j.v,v["office:value-type"]="string";break;case"d":w=j.w||xa(j.v).toISOString(),v["office:value-type"]="date",v["office:date-value"]=xa(j.v).toISOString(),v["table:style-name"]="ce1";break;default:c.push(t);continue}var A=e(w);if(j.l&&j.l.Target){var R=j.l.Target;R=R.charAt(0)=="#"?"#"+zue(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),A=tn("text:a",A,{"xlink:href":R.replace(/&/g,"&amp;")})}c.push("          "+tn("table:table-cell",tn("text:p",A,{}),v)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;ph(f),f.ods=l;var p=u["!cols"][d].wpx+"px";s.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,l){var c=[ls],u=h1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=h1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(O$().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),i(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(n(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function qU(e,t){if(t.bookType=="fods")return sO(e,t);var r=RN(),n="",i=[],s=[];return n="mimetype",di(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",di(r,n,sO(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",di(r,n,w0e(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",di(r,n,ls+O$()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",di(r,n,Xie(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",di(r,n,Kie(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function N0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function K4(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ji(kh(e))}function S0e(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ql(Ku(e))}function _0e(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function gh(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function oO(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function j0e(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function k0e(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function w1(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function zi(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ga(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ei(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=w1(e,r),s=i&7;i=Math.floor(i/8);var o=0,l;if(i==0)break;switch(s){case 0:{for(var c=r[0];e[r[0]++]>=128;);l=e.slice(c,r[0])}break;case 5:o=4,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=w1(e,r),l=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:l,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function co(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(zi(n*8+i.type)),i.type==2&&t.push(zi(i.data.length)),t.push(i.data))})}),gh(t)}function lC(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Nc(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=w1(e,n),s=Ei(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:Ga(s[1][0].data),messages:[]};s[2].forEach(function(l){var c=Ei(l.data),u=Ga(c[3][0].data);o.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=s[3])!=null&&t[0]&&(o.merge=Ga(s[3][0].data)>>>0>0),r.push(o)}return r}function pp(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:zi(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:zi(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:zi(o.data.length)}],n[2].push({data:co(o.meta),type:2})});var s=co(n);t.push(zi(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),gh(t)}function A0e(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=w1(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var l=o-59;o=t[r[0]],l>1&&(o|=t[r[0]+1]<<8),l>2&&(o|=t[r[0]+2]<<16),l>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=l}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var c=0,u=0;if(s==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,s==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[gh(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(i.push(i[0].slice(-c)),u-=c;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-c,-c+u))}}var d=gh(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Cc(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(A0e(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return gh(t)}function mp(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=zi(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return gh(t)}function N0e(e,t,r,n){var i=N0(e),s=i.getUint32(4,!0),o=(n>1?12:8)+oO(s&(n>1?3470:398))*4,l=-1,c=-1,u=NaN,d=new Date(2001,0,1);s&512&&(l=i.getUint32(o,!0),o+=4),o+=oO(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(o,!0),o+=4),s&32&&(u=i.getFloat64(o,!0),o+=8),s&64&&(d.setTime(d.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(l>-1)f={t:"s",v:r[l]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function C0e(e,t,r){var n=N0(e),i=n.getUint32(8,!0),s=12,o=-1,l=-1,c=NaN,u=NaN,d=new Date(2001,0,1);i&1&&(c=j0e(e,s),s+=16),i&2&&(u=n.getFloat64(s,!0),s+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(l=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return f}function sj(e,t){var r=new Uint8Array(32),n=N0(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,k0e(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function oj(e,t){var r=new Uint8Array(32),n=N0(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function E0e(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return N0e(e,t,r,e[0]);case 5:return C0e(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Mo(e){var t=Ei(e);return w1(t[1][0].data)}function lO(e,t){var r=Ei(t.data),n=Ga(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var l=Ei(o.data),c=Ga(l[1][0].data)>>>0;switch(n){case 1:s[c]=K4(l[3][0].data);break;case 8:{var u=e[Mo(l[9][0].data)][0],d=Ei(u.data),f=e[Mo(d[1][0].data)][0],p=Ga(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var h=Ei(f.data);s[c]=h[3].map(function(m){return K4(m.data)}).join("")}break}}),s}function T0e(e,t){var r,n,i,s,o,l,c,u,d,f,p,h,m,g,y=Ei(e),b=Ga(y[1][0].data)>>>0,v=Ga(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Ga(y[8][0].data)>0||!1,S,j;if((s=(i=y[7])==null?void 0:i[0])!=null&&s.data&&t!=0)S=(l=(o=y[7])==null?void 0:o[0])==null?void 0:l.data,j=(u=(c=y[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=y[4])==null?void 0:d[0])!=null&&f.data&&t!=1)S=(h=(p=y[4])==null?void 0:p[0])==null?void 0:h.data,j=(g=(m=y[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=w?4:1,A=N0(S),R=[],M=0;M<S.length/2;++M){var B=A.getUint16(M*2,!0);B<65535&&R.push([M,B])}if(R.length!=v)throw"Expected ".concat(v," cells, found ").concat(R.length);var E=[];for(M=0;M<R.length-1;++M)E[R[M][0]]=j.subarray(R[M][1]*k,R[M+1][1]*k);return R.length>=1&&(E[R[R.length-1][0]]=j.subarray(R[R.length-1][1]*k)),{R:b,cells:E}}function P0e(e,t){var r,n=Ei(t.data),i=(r=n==null?void 0:n[7])!=null&&r[0]?Ga(n[7][0].data)>>>0>0?1:0:-1,s=lC(n[5],function(o){return T0e(o,i)});return{nrows:Ga(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(c,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=c}),o},[])}}function O0e(e,t,r){var n,i=Ei(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ga(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Ga(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=si(s);var o=Ei(i[4][0].data),l=lO(e,e[Mo(o[4][0].data)][0]),c=(n=o[17])!=null&&n[0]?lO(e,e[Mo(o[17][0].data)][0]):[],u=Ei(o[3][0].data),d=0;u[1].forEach(function(f){var p=Ei(f.data),h=e[Mo(p[2][0].data)][0],m=Ga(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=P0e(e,h);g.data.forEach(function(y,b){y.forEach(function(v,w){var S=Hn({r:d+b,c:w}),j=E0e(v,l,c);j&&(r[S]=j)})}),d+=g.nrows})}function M0e(e,t){var r=Ei(t.data),n={"!ref":"A1"},i=e[Mo(r[2][0].data)],s=Ga(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return O0e(e,i[0],n),n}function L0e(e,t){var r,n=Ei(t.data),i={name:(r=n[1])!=null&&r[0]?K4(n[1][0].data):"",sheets:[]},s=lC(n[2],Mo);return s.forEach(function(o){e[o].forEach(function(l){var c=Ga(l.meta[1][0].data);c==6e3&&i.sheets.push(M0e(e,l))})}),i}function R0e(e,t){var r=hC(),n=Ei(t.data),i=lC(n[1],Mo);if(i.forEach(function(s){e[s].forEach(function(o){var l=Ga(o.meta[1][0].data);if(l==2){var c=L0e(e,o);c.sheets.forEach(function(u,d){pC(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function lj(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Cc(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=Nc(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){s[f.id]=f.messages,o.push(f.id)})}}),!o.length)throw new Error("File has no messages");var l=((i=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Ga(s[1][0].meta[1][0].data)==1&&s[1][0];if(l||o.forEach(function(c){s[c].forEach(function(u){var d=Ga(u.meta[1][0].data)>>>0;if(d==1)if(!l)l=u;else throw new Error("Document has multiple roots")})}),!l)throw new Error("Cannot find Document root");return R0e(s,l)}function F0e(e,t,r){var n,i,s,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Ga(e[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,u=N0(e[7][0].data),d=0,f=[],p=N0(e[4][0].data),h=0,m=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}u.setUint16(g*2,d,!0),p.setUint16(g*2,h,!0);var y,b;switch(typeof t[g]){case"string":y=sj({t:"s",v:t[g]},r),b=oj({t:"s",v:t[g]},r);break;case"number":y=sj({t:"n",v:t[g]},r),b=oj({t:"n",v:t[g]},r);break;case"boolean":y=sj({t:"b",v:t[g]},r),b=oj({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}f.push(y),d+=y.length,m.push(b),h+=b.length,++c}for(e[2][0].data=zi(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=gh(f),e[3][0].data=gh(m),c}function B0e(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ol(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(si(n)));var s=H2(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(Y){return Y.forEach(function(q){typeof q=="string"&&o.push(q)})});var l={},c=[],u=In.read(t.numbers,{type:"base64"});u.FileIndex.map(function(Y,q){return[Y,u.FullPaths[q]]}).forEach(function(Y){var q=Y[0],O=Y[1];if(q.type==2&&q.name.match(/\.iwa/)){var X=q.content,F=Cc(X),Q=Nc(F);Q.forEach(function(K){c.push(K.id),l[K.id]={deps:[],location:O,type:Ga(K.messages[0].meta[1][0].data)}})}}),c.sort(function(Y,q){return Y-q});var d=c.filter(function(Y){return Y>1}).map(function(Y){return[Y,zi(Y)]});u.FileIndex.map(function(Y,q){return[Y,u.FullPaths[q]]}).forEach(function(Y){var q=Y[0];if(Y[1],!!q.name.match(/\.iwa/)){var O=Nc(Cc(q.content));O.forEach(function(X){X.messages.forEach(function(F){d.forEach(function(Q){X.messages.some(function(K){return Ga(K.meta[1][0].data)!=11006&&_0e(K.data,Q[1])})&&l[Q[0]].deps.push(X.id)})})})}});for(var f=In.find(u,l[1].location),p=Nc(Cc(f.content)),h,m=0;m<p.length;++m){var g=p[m];g.id==1&&(h=g)}var y=Mo(Ei(h.messages[0].data)[1][0].data);for(f=In.find(u,l[y].location),p=Nc(Cc(f.content)),m=0;m<p.length;++m)g=p[m],g.id==y&&(h=g);for(y=Mo(Ei(h.messages[0].data)[2][0].data),f=In.find(u,l[y].location),p=Nc(Cc(f.content)),m=0;m<p.length;++m)g=p[m],g.id==y&&(h=g);for(y=Mo(Ei(h.messages[0].data)[2][0].data),f=In.find(u,l[y].location),p=Nc(Cc(f.content)),m=0;m<p.length;++m)g=p[m],g.id==y&&(h=g);var b=Ei(h.messages[0].data);{b[6][0].data=zi(n.e.r+1),b[7][0].data=zi(n.e.c+1);var v=Mo(b[46][0].data),w=In.find(u,l[v].location),S=Nc(Cc(w.content));{for(var j=0;j<S.length&&S[j].id!=v;++j);if(S[j].id!=v)throw"Bad ColumnRowUIDMapArchive";var k=Ei(S[j].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var A=0;A<=n.e.c;++A){var R=[];R[1]=R[2]=[{type:0,data:zi(A+420690)}],k[1].push({type:2,data:co(R)}),k[2].push({type:0,data:zi(A)}),k[3].push({type:0,data:zi(A)})}k[4]=[],k[5]=[],k[6]=[];for(var M=0;M<=n.e.r;++M)R=[],R[1]=R[2]=[{type:0,data:zi(M+726270)}],k[4].push({type:2,data:co(R)}),k[5].push({type:0,data:zi(M)}),k[6].push({type:0,data:zi(M)});S[j].messages[0].data=co(k)}w.content=mp(pp(S)),w.size=w.content.length,delete b[46];var B=Ei(b[4][0].data);{B[7][0].data=zi(n.e.r+1);var E=Ei(B[1][0].data),P=Mo(E[2][0].data);w=In.find(u,l[P].location),S=Nc(Cc(w.content));{if(S[0].id!=P)throw"Bad HeaderStorageBucket";var D=Ei(S[0].messages[0].data);for(M=0;M<s.length;++M){var G=Ei(D[2][0].data);G[1][0].data=zi(M),G[4][0].data=zi(s[M].length),D[2][M]={type:D[2][0].type,data:co(G)}}S[0].messages[0].data=co(D)}w.content=mp(pp(S)),w.size=w.content.length;var H=Mo(B[2][0].data);w=In.find(u,l[H].location),S=Nc(Cc(w.content));{if(S[0].id!=H)throw"Bad HeaderStorageBucket";for(D=Ei(S[0].messages[0].data),A=0;A<=n.e.c;++A)G=Ei(D[2][0].data),G[1][0].data=zi(A),G[4][0].data=zi(n.e.r+1),D[2][A]={type:D[2][0].type,data:co(G)};S[0].messages[0].data=co(D)}w.content=mp(pp(S)),w.size=w.content.length;var oe=Mo(B[4][0].data);(function(){for(var Y=In.find(u,l[oe].location),q=Nc(Cc(Y.content)),O,X=0;X<q.length;++X){var F=q[X];F.id==oe&&(O=F)}var Q=Ei(O.messages[0].data);{Q[3]=[];var K=[];o.forEach(function(T,I){K[1]=[{type:0,data:zi(I)}],K[2]=[{type:0,data:zi(1)}],K[3]=[{type:2,data:S0e(T)}],Q[3].push({type:2,data:co(K)})})}O.messages[0].data=co(Q);var ne=pp(q),re=mp(ne);Y.content=re,Y.size=Y.content.length})();var de=Ei(B[3][0].data);{var W=de[1][0];delete de[2];var V=Ei(W.data);{var ae=Mo(V[2][0].data);(function(){for(var Y=In.find(u,l[ae].location),q=Nc(Cc(Y.content)),O,X=0;X<q.length;++X){var F=q[X];F.id==ae&&(O=F)}var Q=Ei(O.messages[0].data);{delete Q[6],delete de[7];var K=new Uint8Array(Q[5][0].data);Q[5]=[];for(var ne=0,re=0;re<=n.e.r;++re){var T=Ei(K);ne+=F0e(T,s[re],o),T[1][0].data=zi(re),Q[5].push({data:co(T),type:2})}Q[1]=[{type:0,data:zi(n.e.c+1)}],Q[2]=[{type:0,data:zi(n.e.r+1)}],Q[3]=[{type:0,data:zi(ne)}],Q[4]=[{type:0,data:zi(n.e.r+1)}]}O.messages[0].data=co(Q);var I=pp(q),ie=mp(I);Y.content=ie,Y.size=Y.content.length})()}W.data=co(V)}B[3][0].data=co(de)}b[4][0].data=co(B)}h.messages[0].data=co(b);var ee=pp(p),C=mp(ee);return f.content=C,f.size=f.content.length,u}function HU(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function cC(e){HU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function uC(e){HU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function I0e(e){return gi.WS.indexOf(e)>-1?"sheet":e==gi.CS?"chart":e==gi.DS?"dialog":e==gi.MS?"macro":e&&e.length?e:"sheet"}function D0e(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,I0e(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function $0e(e,t,r,n,i,s,o,l,c,u,d,f){try{s[n]=Ox(Jl(e,r,!0),t);var p=hs(e,t),h;switch(l){case"sheet":h=lhe(p,t,i,c,s[n],u,d,f);break;case"chart":if(h=che(p,t,i,c,s[n],u,d,f),!h||!h["!drawel"])break;var m=mx(h["!drawel"].Target,t),g=m1(m),y=Yle(Jl(e,m,!0),Ox(Jl(e,g,!0),m)),b=mx(y,m),v=m1(b);h=Ffe(Jl(e,b,!0),b,c,Ox(Jl(e,v,!0),b),u,h);break;case"macro":h=uhe(p,t,i,c,s[n],u,d,f);break;case"dialog":h=dhe(p,t,i,c,s[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=h;var w=[];s&&s[n]&&Ka(s[n]).forEach(function(S){var j="";if(s[n][S].Type==gi.CMNT){j=mx(s[n][S].Target,t);var k=mhe(hs(e,j,!0),j,c);if(!k||!k.length)return;GP(h,k,!1)}s[n][S].Type==gi.TCMNT&&(j=mx(s[n][S].Target,t),w=w.concat(Qle(hs(e,j,!0),c)))}),w&&w.length&&GP(h,w,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function Sc(e){return e.charAt(0)=="/"?e.slice(1):e}function U0e(e,t){if(cg(),t=t||{},cC(t),Oc(e,"META-INF/manifest.xml")||Oc(e,"objectdata.xml"))return iO(e,t);if(Oc(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof lj<"u"){if(e.FileIndex)return lj(e);var r=In.utils.cfb_new();return pP(e).forEach(function(G){di(r,G,Jne(e,G))}),lj(r)}throw new Error("Unsupported NUMBERS file")}if(!Oc(e,"[Content_Types].xml"))throw Oc(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Oc(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=pP(e),i=Hie(Jl(e,"[Content_Types].xml")),s=!1,o,l;if(i.workbooks.length===0&&(l="xl/workbook.xml",hs(e,l,!0)&&i.workbooks.push(l)),i.workbooks.length===0){if(l="xl/workbook.bin",!hs(e,l,!0))throw new Error("Could not find workbook");i.workbooks.push(l),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Mx=[],i.sst)try{Mx=phe(hs(e,Sc(i.sst)),i.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&i.themes.length&&(c=hhe(Jl(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=fhe(hs(e,Sc(i.style)),i.style,c,t))}i.links.map(function(G){try{var H=Ox(Jl(e,m1(Sc(G))),G);return xhe(hs(e,Sc(G)),H,G,t)}catch{}});var d=ohe(hs(e,Sc(i.workbooks[0])),i.workbooks[0],t),f={},p="";i.coreprops.length&&(p=hs(e,Sc(i.coreprops[0]),!0),p&&(f=M$(p)),i.extprops.length!==0&&(p=hs(e,Sc(i.extprops[0]),!0),p&&Jie(p,f,t)));var h={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(p=Jl(e,Sc(i.custprops[0]),!0),p&&(h=eae(p,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?o=d.Sheets.map(function(H){return H.name}):f.Worksheets&&f.SheetNames.length>0&&(o=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=h),t.bookSheets&&typeof o<"u"&&(m.SheetNames=o),t.bookSheets?m.SheetNames:t.bookProps))return m;o={};var g={};t.bookDeps&&i.calcchain&&(g=ghe(hs(e,Sc(i.calcchain)),i.calcchain));var y=0,b={},v,w;{var S=d.Sheets;f.Worksheets=S.length,f.SheetNames=[];for(var j=0;j!=S.length;++j)f.SheetNames[j]=S[j].name}var k=s?"bin":"xml",A=i.workbooks[0].lastIndexOf("/"),R=(i.workbooks[0].slice(0,A+1)+"_rels/"+i.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Oc(e,R)||(R="xl/_rels/workbook."+k+".rels");var M=Ox(Jl(e,R,!0),R.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=yhe(hs(e,Sc(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=Zle(hs(e,Sc(i.people[0])),t)),M&&(M=D0e(M,d.Sheets));var B=hs(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var E="sheet";if(M&&M[y]?(v="xl/"+M[y][1].replace(/[\/]?xl\//,""),Oc(e,v)||(v=M[y][1]),Oc(e,v)||(v=R.replace(/_rels\/.*$/,"")+M[y][1]),E=M[y][2]):(v="xl/worksheets/sheet"+(y+1-B)+"."+k,v=v.replace(/sheet0\./,"sheet.")),w=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,D=0;D!=t.sheets.length;++D)typeof t.sheets[D]=="number"&&t.sheets[D]==y&&(P=1),typeof t.sheets[D]=="string"&&t.sheets[D].toLowerCase()==f.SheetNames[y].toLowerCase()&&(P=1);if(!P)continue e}}$0e(e,v,w,f.SheetNames[y],y,b,o,E,t,d,c,u)}return m={Directory:i,Workbook:d,Props:f,Custprops:h,Deps:g,Sheets:o,SheetNames:f.SheetNames,Strings:Mx,Styles:u,Themes:c,SSF:ya(qn)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(G,H){G=G.replace(/^Root Entry[\/]/,""),m.keys.push(G),m.files[G]=e.FileIndex[H]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=hs(e,Sc(i.vba[0]),!0):i.defaults&&i.defaults.bin===oce&&(m.vbaraw=hs(e,"xl/vbaProject.bin",!0))),m}function z0e(e,t){var r=t||{},n="Workbook",i=In.find(e,n);try{if(n="/!DataSpaces/Version",i=In.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(yoe(i.content),n="/!DataSpaces/DataSpaceMap",i=In.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=voe(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=In.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=woe(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=In.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);_oe(i.content)}catch{}if(n="/EncryptionInfo",i=In.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=joe(i.content);if(n="/EncryptedPackage",i=In.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(l[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,r.password||"",r);if(l[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function W0e(e,t){return t.bookType=="ods"?qU(e,t):t.bookType=="numbers"?B0e(e,t):t.bookType=="xlsb"?q0e(e,t):H0e(e,t)}function q0e(e,t){Zp=1024,e&&!e.SSF&&(e.SSF=ya(qn)),e&&e.SSF&&(cg(),kS(e.SSF),t.revssf=NS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lx?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=yU.indexOf(t.bookType)>-1,i=YN();uC(t=t||{});var s=RN(),o="",l=0;if(t.cellXfs=[],Nh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",di(s,o,L$(e.Props,t)),i.coreprops.push(o),Wi(t.rels,2,o,gi.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,di(s,o,B$(e.Props)),i.extprops.push(o),Wi(t.rels,3,o,gi.EXT_PROPS),e.Custprops!==e.Props&&Ka(e.Custprops||{}).length>0&&(o="docProps/custom.xml",di(s,o,I$(e.Custprops)),i.custprops.push(o),Wi(t.rels,4,o,gi.CUST_PROPS)),l=1;l<=e.SheetNames.length;++l){var d={"!id":{}},f=e.Sheets[e.SheetNames[l-1]],p=(f||{})["!type"]||"sheet";switch(p){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,di(s,o,vhe(l-1,o,t,e,d)),i.sheets.push(o),Wi(t.wbrels,-1,"worksheets/sheet"+l+"."+r,gi.WS[0])}if(f){var h=f["!comments"],m=!1,g="";h&&h.length>0&&(g="xl/comments"+l+"."+r,di(s,g,_he(h,g)),i.comments.push(g),Wi(d,-1,"../comments"+l+"."+r,gi.CMNT),m=!0),f["!legacy"]&&m&&di(s,"xl/drawings/vmlDrawing"+l+".vml",gU(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&di(s,m1(o),pm(d))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,di(s,o,She(t.Strings,o,t)),i.strs.push(o),Wi(t.wbrels,-1,"sharedStrings."+r,gi.SST)),o="xl/workbook."+r,di(s,o,bhe(e,o)),i.workbooks.push(o),Wi(t.rels,1,o,gi.WB),o="xl/theme/theme1.xml",di(s,o,tC(e.Themes,t)),i.themes.push(o),Wi(t.wbrels,-1,"theme/theme1.xml",gi.THEME),o="xl/styles."+r,di(s,o,whe(e,o,t)),i.styles.push(o),Wi(t.wbrels,-1,"styles."+r,gi.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",di(s,o,e.vbaraw),i.vba.push(o),Wi(t.wbrels,-1,"vbaProject.bin",gi.VBA)),o="xl/metadata."+r,di(s,o,jhe(o)),i.metadata.push(o),Wi(t.wbrels,-1,"metadata."+r,gi.XLMETA),di(s,"[Content_Types].xml",P$(i,t)),di(s,"_rels/.rels",pm(t.rels)),di(s,"xl/_rels/workbook."+r+".rels",pm(t.wbrels)),delete t.revssf,delete t.ssf,s}function H0e(e,t){Zp=1024,e&&!e.SSF&&(e.SSF=ya(qn)),e&&e.SSF&&(cg(),kS(e.SSF),t.revssf=NS(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Lx?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=yU.indexOf(t.bookType)>-1,i=YN();uC(t=t||{});var s=RN(),o="",l=0;if(t.cellXfs=[],Nh(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",di(s,o,L$(e.Props,t)),i.coreprops.push(o),Wi(t.rels,2,o,gi.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,di(s,o,B$(e.Props)),i.extprops.push(o),Wi(t.rels,3,o,gi.EXT_PROPS),e.Custprops!==e.Props&&Ka(e.Custprops||{}).length>0&&(o="docProps/custom.xml",di(s,o,I$(e.Custprops)),i.custprops.push(o),Wi(t.rels,4,o,gi.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,l=1;l<=e.SheetNames.length;++l){var f={"!id":{}},p=e.Sheets[e.SheetNames[l-1]],h=(p||{})["!type"]||"sheet";switch(h){case"chart":default:o="xl/worksheets/sheet"+l+"."+r,di(s,o,EU(l-1,t,e,f)),i.sheets.push(o),Wi(t.wbrels,-1,"worksheets/sheet"+l+"."+r,gi.WS[0])}if(p){var m=p["!comments"],g=!1,y="";if(m&&m.length>0){var b=!1;m.forEach(function(v){v[1].forEach(function(w){w.T==!0&&(b=!0)})}),b&&(y="xl/threadedComments/threadedComment"+l+"."+r,di(s,y,Jle(m,d,t)),i.threadedcomments.push(y),Wi(f,-1,"../threadedComments/threadedComment"+l+"."+r,gi.TCMNT)),y="xl/comments"+l+"."+r,di(s,y,xU(m)),i.comments.push(y),Wi(f,-1,"../comments"+l+"."+r,gi.CMNT),g=!0}p["!legacy"]&&g&&di(s,"xl/drawings/vmlDrawing"+l+".vml",gU(l,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&di(s,m1(o),pm(f))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,di(s,o,iU(t.Strings,t)),i.strs.push(o),Wi(t.wbrels,-1,"sharedStrings."+r,gi.SST)),o="xl/workbook."+r,di(s,o,LU(e)),i.workbooks.push(o),Wi(t.rels,1,o,gi.WB),o="xl/theme/theme1.xml",di(s,o,tC(e.Themes,t)),i.themes.push(o),Wi(t.wbrels,-1,"theme/theme1.xml",gi.THEME),o="xl/styles."+r,di(s,o,fU(e,t)),i.styles.push(o),Wi(t.wbrels,-1,"styles."+r,gi.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",di(s,o,e.vbaraw),i.vba.push(o),Wi(t.wbrels,-1,"vbaProject.bin",gi.VBA)),o="xl/metadata."+r,di(s,o,mU()),i.metadata.push(o),Wi(t.wbrels,-1,"metadata."+r,gi.XLMETA),d.length>1&&(o="xl/persons/person.xml",di(s,o,ece(d)),i.people.push(o),Wi(t.wbrels,-1,"persons/person.xml",gi.PEOPLE)),di(s,"[Content_Types].xml",P$(i,t)),di(s,"_rels/.rels",pm(t.rels)),di(s,"xl/_rels/workbook."+r+".rels",pm(t.wbrels)),delete t.revssf,delete t.ssf,s}function dC(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=cc(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function V0e(e,t){return In.find(e,"EncryptedPackage")?z0e(e,t):IU(e,t)}function G0e(e,t){var r,n=e,i=t||{};return i.type||(i.type=mi&&Buffer.isBuffer(e)?"buffer":"base64"),r=s$(n,i),U0e(r,i)}function VU(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return V4(e.slice(r),t);default:break e}return Dm.to_workbook(e,t)}function K0e(e,t){var r="",n=dC(e,t);switch(t.type){case"base64":r=cc(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=_0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ji(r)),t.type="binary",VU(r,t)}function Y0e(e,t){var r=e;return t.type=="base64"&&(r=cc(r)),r=c1.utils.decode(1200,r.slice(2),"str"),t.type="binary",VU(r,t)}function X0e(e){return e.match(/[^\x00-\x7F]/)?Ku(e):e}function cj(e,t,r,n){return n?(r.type="string",Dm.to_workbook(e,r)):Dm.to_workbook(t,r)}function Um(e,t){TN();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Um(new Uint8Array(e),(r=ya(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),gm={},r.dateNF&&(gm.dateNF=r.dateNF),r.type||(r.type=mi&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=mi?"buffer":"binary",n=qne(e),typeof Uint8Array<"u"&&!mi&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=X0e(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return r=ya(r),r.type="array",Um(PN(n),r)}switch((i=dC(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return V0e(In.read(n,r),r);break;case 9:if(i[1]<=8)return IU(n,r);break;case 60:return V4(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return toe(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return rU.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?G0e(n,r):cj(e,n,r,s);case 239:return i[3]===60?V4(n,r):cj(e,n,r,s);case 255:if(i[1]===254)return Y0e(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return l0.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return l0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return H4.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return cU.to_workbook(n,r);break;case 10:case 13:case 32:return K0e(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return eoe.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?H4.to_workbook(n,r):cj(e,n,r,s)}function GU(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ry(t.file,In.write(e,{type:mi?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return In.write(e,t)}function Q0e(e,t){var r=ya(t||{}),n=W0e(e,r);return J0e(n,r)}function J0e(e,t){var r={},n=mi?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?In.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(jS(i))}return t.password&&typeof encrypt_agile<"u"?GU(encrypt_agile(i,t.password),t):t.type==="file"?ry(t.file,i):t.type=="string"?Ji(i):i}function Z0e(e,t){var r=t||{},n=Xhe(e,r);return GU(n,r)}function Du(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return u1(Ku(n));case"binary":return Ku(n);case"string":return e;case"file":return ry(t.file,n,"utf8");case"buffer":return mi?uf(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Du(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function epe(e,t){switch(t.type){case"base64":return u1(e);case"binary":return e;case"string":return e;case"file":return ry(t.file,e,"binary");case"buffer":return mi?uf(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Tb(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?u1(r):t.type=="string"?Ji(r):r;case"file":return ry(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function KU(e,t){TN(),Vfe(e);var r=ya(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=KU(e,r);return r.type="array",jS(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Du(Whe(e,r),r);case"slk":case"sylk":return Du(tU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Du($U(e.Sheets[e.SheetNames[i]],r),r);case"txt":return epe(YU(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Du(fC(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Du(rU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Tb(H4.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Du(Dm.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Du(cU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Du(nU.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Du(qU(e,r),r);case"wk1":return Tb(l0.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Tb(l0.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Tb(DU(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Z0e(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Q0e(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function tpe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function MS(e,t,r){var n={};return n.type="file",n.file=t,tpe(n),KU(e,n)}function rpe(e,t,r,n,i,s,o,l){var c=os(r),u=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!o||e[r])for(var h=t.s.c;h<=t.e.c;++h){var m=o?e[r][h]:e[n[h]+c];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[h]!=null&&(p[s[h]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[h]!=null){if(g==null)if(m.t=="e"&&g===null)p[s[h]]=null;else if(u!==void 0)p[s[h]]=u;else if(d&&g===null)p[s[h]]=null;else continue;else p[s[h]]=d&&(m.t!=="n"||m.t==="n"&&l.rawNumbers!==!1)?g:Xd(m,g,l);g!=null&&(f=!1)}}return{row:p,isempty:f}}function H2(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Ai(d);break;case"number":c=Ai(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(i=0);var f=os(c.s.r),p=[],h=[],m=0,g=0,y=Array.isArray(e),b=c.s.r,v=0,w={};y&&!e[b]&&(e[b]=[]);var S=u.skipHidden&&e["!cols"]||[],j=u.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(S[v]||{}).hidden)switch(p[v]=Ta(v),r=y?e[b][v]:e[p[v]+f],n){case 1:s[v]=v-c.s.c;break;case 2:s[v]=p[v];break;case 3:s[v]=u.header[v-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),l=o=Xd(r,null,u),g=w[o]||0,!g)w[o]=1;else{do l=o+"_"+g++;while(w[l]);w[o]=g,w[l]=1}s[v]=l}for(b=c.s.r+i;b<=c.e.r;++b)if(!(j[b]||{}).hidden){var k=rpe(e,c,b,p,n,s,y,u);(k.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=k.row)}return h.length=m,h}var cO=/"/g;function npe(e,t,r,n,i,s,o,l){for(var c=!0,u=[],d="",f=os(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=l.dense?(e[r]||[])[p]:e[n[p]+f];if(h==null)d="";else if(h.v!=null){c=!1,d=""+(l.rawNumbers&&h.t=="n"?h.v:Xd(h,null,l));for(var m=0,g=0;m!==d.length;++m)if((g=d.charCodeAt(m))===i||g===s||g===34||l.forceQuotes){d='"'+d.replace(cO,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(c=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(cO,'""')+'"')):d="";u.push(d)}return l.blankrows===!1&&c?null:u.join(o)}function fC(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Ai(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(p[m]||{}).hidden||(f[m]=Ta(m));for(var g=0,y=i.s.r;y<=i.e.r;++y)(h[y]||{}).hidden||(d=npe(e,i,y,f,o,c,s,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?l:"")+d)));return delete n.dense,r.join("")}function YU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=fC(e,t);return r}function ipe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Ai(e["!ref"]),s="",o=[],l,c=[],u=Array.isArray(e);for(l=i.s.c;l<=i.e.c;++l)o[l]=Ta(l);for(var d=i.s.r;d<=i.e.r;++d)for(s=os(d),l=i.s.c;l<=i.e.c;++l)if(t=o[l]+s,r=u?(e[d]||[])[l]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function XU(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,l=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var c=typeof n.origin=="string"?Pa(n.origin):n.origin;o=c.r,l=c.c}var u,d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+i}};if(s["!ref"]){var f=Ai(s["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+t.length-1+i)}else o==-1&&(o=0,d.e.r=t.length-1+i);var p=n.header||[],h=0;t.forEach(function(g,y){Ka(g).forEach(function(b){(h=p.indexOf(b))==-1&&(p[h=p.length]=b);var v=g[b],w="z",S="",j=Hn({c:l+h,r:o+y+i});u=S1(s,j),v&&typeof v=="object"&&!(v instanceof Date)?s[j]=v:(typeof v=="number"?w="n":typeof v=="boolean"?w="b":typeof v=="string"?w="s":v instanceof Date?(w="d",n.cellDates||(w="n",v=Ms(v)),S=n.dateNF||qn[14]):v===null&&n.nullError&&(w="e",v=0),u?(u.t=w,u.v=v,delete u.w,delete u.R,S&&(u.z=S)):s[j]=u={t:w,v},S&&(u.z=S))})}),d.e.c=Math.max(d.e.c,l+p.length-1);var m=os(o);if(i)for(h=0;h<p.length;++h)s[Ta(h+l)+m]={t:"s",v:p[h]};return s["!ref"]=si(d),s}function ape(e,t){return XU(null,e,t)}function S1(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Pa(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?S1(e,Hn(t)):S1(e,Hn({r:t,c:r||0}))}function spe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function hC(){return{SheetNames:[],Sheets:{}}}function pC(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(MU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function ope(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=spe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function lpe(e,t){return e.z=t,e}function QU(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function cpe(e,t,r){return QU(e,"#"+t,r)}function upe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function dpe(e,t,r,n){for(var i=typeof t!="string"?t:Ai(t),s=typeof t=="string"?t:si(t),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var c=S1(e,o,l);c.t="n",c.F=s,delete c.v,o==i.s.r&&l==i.s.c&&(c.f=r,n&&(c.D=!0))}return e}var $o={encode_col:Ta,encode_row:os,encode_cell:Hn,encode_range:si,decode_col:WN,decode_row:zN,split_cell:Sie,decode_cell:Pa,decode_range:Ol,format_cell:Xd,sheet_add_aoa:j$,sheet_add_json:XU,sheet_add_dom:UU,aoa_to_sheet:ug,json_to_sheet:ape,table_to_sheet:zU,table_to_book:y0e,sheet_to_csv:fC,sheet_to_txt:YU,sheet_to_json:H2,sheet_to_html:$U,sheet_to_formulae:ipe,sheet_to_row_object_array:H2,sheet_get_cell:S1,book_new:hC,book_append_sheet:pC,book_set_sheet_visibility:ope,cell_set_number_format:lpe,cell_set_hyperlink:QU,cell_set_internal_link:cpe,cell_add_comment:upe,sheet_set_array_formula:dpe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Hi(e){"@babel/helpers - typeof";return Hi=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hi(e)}var vu=Uint8Array,tc=Uint16Array,mC=Int32Array,gC=new vu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),xC=new vu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),uO=new vu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),JU=function(e,t){for(var r=new tc(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new mC(r[30]),n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},ZU=JU(gC,2),fpe=ZU.b,Y4=ZU.r;fpe[28]=258,Y4[258]=28;var hpe=JU(xC,0),dO=hpe.r,X4=new tc(32768);for(var ma=0;ma<32768;++ma){var Cf=(ma&43690)>>1|(ma&21845)<<1;Cf=(Cf&52428)>>2|(Cf&13107)<<2,Cf=(Cf&61680)>>4|(Cf&3855)<<4,X4[ma]=((Cf&65280)>>8|(Cf&255)<<8)>>1}var Bx=function(e,t,r){for(var n=e.length,i=0,s=new tc(t);i<n;++i)e[i]&&++s[e[i]-1];var o=new tc(t);for(i=1;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;var l;if(r){l=new tc(1<<t);var c=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],d=t-e[i],f=o[e[i]-1]++<<d,p=f|(1<<d)-1;f<=p;++f)l[X4[f]>>c]=u}else for(l=new tc(n),i=0;i<n;++i)e[i]&&(l[i]=X4[o[e[i]-1]++]>>15-e[i]);return l},C0=new vu(288);for(var ma=0;ma<144;++ma)C0[ma]=8;for(var ma=144;ma<256;++ma)C0[ma]=9;for(var ma=256;ma<280;++ma)C0[ma]=7;for(var ma=280;ma<288;++ma)C0[ma]=8;var V2=new vu(32);for(var ma=0;ma<32;++ma)V2[ma]=5;var ppe=Bx(C0,9,0),mpe=Bx(V2,5,0),ez=function(e){return(e+7)/8|0},gpe=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new vu(e.subarray(t,r))},yd=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Vg=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},uj=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return{t:rz,l:0};if(i==1){var o=new vu(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(j,k){return j.f-k.f}),r.push({s:-1,f:25001});var l=r[0],c=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:l.f+c.f,l,r:c};d!=i-1;)l=r[r[u].f<r[f].f?u++:f++],c=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:l.f+c.f,l,r:c};for(var p=s[0].s,n=1;n<i;++n)s[n].s>p&&(p=s[n].s);var h=new tc(p+1),m=Q4(r[d-1],h,0);if(m>t){var n=0,g=0,y=m-t,b=1<<y;for(s.sort(function(k,A){return h[A.s]-h[k.s]||k.f-A.f});n<i;++n){var v=s[n].s;if(h[v]>t)g+=b-(1<<m-h[v]),h[v]=t;else break}for(g>>=y;g>0;){var w=s[n].s;h[w]<t?g-=1<<t-h[w]++-1:++n}for(;n>=0&&g;--n){var S=s[n].s;h[S]==t&&(--h[S],++g)}m=t}return{t:new vu(h),l:m}},Q4=function(e,t,r){return e.s==-1?Math.max(Q4(e.l,t,r+1),Q4(e.r,t,r+1)):t[e.s]=r},fO=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new tc(++t),n=0,i=e[0],s=1,o=function(c){r[n++]=c},l=1;l<=t;++l)if(e[l]==i&&l!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(i),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(i);s=1,i=e[l]}return{c:r.subarray(0,n),n:t}},Gg=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},tz=function(e,t,r){var n=r.length,i=ez(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var s=0;s<n;++s)e[i+s+4]=r[s];return(i+4+n)*8},hO=function(e,t,r,n,i,s,o,l,c,u,d){yd(t,d++,r),++i[256];for(var f=uj(i,15),p=f.t,h=f.l,m=uj(s,15),g=m.t,y=m.l,b=fO(p),v=b.c,w=b.n,S=fO(g),j=S.c,k=S.n,A=new tc(19),R=0;R<v.length;++R)++A[v[R]&31];for(var R=0;R<j.length;++R)++A[j[R]&31];for(var M=uj(A,7),B=M.t,E=M.l,P=19;P>4&&!B[uO[P-1]];--P);var D=u+5<<3,G=Gg(i,C0)+Gg(s,V2)+o,H=Gg(i,p)+Gg(s,g)+o+14+3*P+Gg(A,B)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&D<=G&&D<=H)return tz(t,d,e.subarray(c,c+u));var oe,de,W,V;if(yd(t,d,1+(H<G)),d+=2,H<G){oe=Bx(p,h,0),de=p,W=Bx(g,y,0),V=g;var ae=Bx(B,E,0);yd(t,d,w-257),yd(t,d+5,k-1),yd(t,d+10,P-4),d+=14;for(var R=0;R<P;++R)yd(t,d+3*R,B[uO[R]]);d+=3*P;for(var ee=[v,j],C=0;C<2;++C)for(var Y=ee[C],R=0;R<Y.length;++R){var q=Y[R]&31;yd(t,d,ae[q]),d+=B[q],q>15&&(yd(t,d,Y[R]>>5&127),d+=Y[R]>>12)}}else oe=ppe,de=C0,W=mpe,V=V2;for(var R=0;R<l;++R){var O=n[R];if(O>255){var q=O>>18&31;Vg(t,d,oe[q+257]),d+=de[q+257],q>7&&(yd(t,d,O>>23&31),d+=gC[q]);var X=O&31;Vg(t,d,W[X]),d+=V[X],X>3&&(Vg(t,d,O>>5&8191),d+=xC[X])}else Vg(t,d,oe[O]),d+=de[O]}return Vg(t,d,oe[256]),d+de[256]},xpe=new mC([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),rz=new vu(0),ype=function(e,t,r,n,i,s){var o=s.z||e.length,l=new vu(n+o+5*(1+Math.ceil(o/7e3))+i),c=l.subarray(n,l.length-i),u=s.l,d=(s.r||0)&7;if(t){d&&(c[0]=s.r>>3);for(var f=xpe[t-1],p=f>>13,h=f&8191,m=(1<<r)-1,g=s.p||new tc(32768),y=s.h||new tc(m+1),b=Math.ceil(r/3),v=2*b,w=function(ie){return(e[ie]^e[ie+1]<<b^e[ie+2]<<v)&m},S=new mC(25e3),j=new tc(288),k=new tc(32),A=0,R=0,M=s.i||0,B=0,E=s.w||0,P=0;M+2<o;++M){var D=w(M),G=M&32767,H=y[D];if(g[G]=H,y[D]=G,E<=M){var oe=o-M;if((A>7e3||B>24576)&&(oe>423||!u)){d=hO(e,c,0,S,j,k,R,B,P,M-P,d),B=A=R=0,P=M;for(var de=0;de<286;++de)j[de]=0;for(var de=0;de<30;++de)k[de]=0}var W=2,V=0,ae=h,ee=G-H&32767;if(oe>2&&D==w(M-ee))for(var C=Math.min(p,oe)-1,Y=Math.min(32767,M),q=Math.min(258,oe);ee<=Y&&--ae&&G!=H;){if(e[M+W]==e[M+W-ee]){for(var O=0;O<q&&e[M+O]==e[M+O-ee];++O);if(O>W){if(W=O,V=ee,O>C)break;for(var X=Math.min(ee,O-2),F=0,de=0;de<X;++de){var Q=M-ee+de&32767,K=g[Q],ne=Q-K&32767;ne>F&&(F=ne,H=Q)}}}G=H,H=g[G],ee+=G-H&32767}if(V){S[B++]=268435456|Y4[W]<<18|dO[V];var re=Y4[W]&31,T=dO[V]&31;R+=gC[re]+xC[T],++j[257+re],++k[T],E=M+W,++A}else S[B++]=e[M],++j[e[M]]}}for(M=Math.max(M,E);M<o;++M)S[B++]=e[M],++j[e[M]];d=hO(e,c,u,S,j,k,R,B,P,M-P,d),u||(s.r=d&7|c[d/8|0]<<3,d-=7,s.h=y,s.p=g,s.i=M,s.w=E)}else{for(var M=s.w||0;M<o+u;M+=65535){var I=M+65535;I>=o&&(c[d/8|0]=u,I=o),d=tz(c,d+1,e.subarray(M,I))}s.i=o}return gpe(l,0,n+ez(d)+i)},nz=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=r.length|0,o=0;o!=s;){for(var l=Math.min(o+2655,s);o<l;++o)i+=n+=r[o];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},bpe=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new vu(s.length+e.length);o.set(s),o.set(e,s.length),e=o,i.w=s.length}return ype(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},iz=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},vpe=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=nz();i.p(t.dictionary),iz(e,2,i.d())}};function J4(e,t){t||(t={});var r=nz();r.p(e);var n=bpe(e,t,t.dictionary?6:2,4);return vpe(n,t),iz(n,n.length-4,r.d()),n}var wpe=typeof TextDecoder<"u"&&new TextDecoder,Spe=0;try{wpe.decode(rz,{stream:!0}),Spe=1}catch{}function _pe(e){if(Array.isArray(e))return e}function jpe(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,s,o,l=[],c=!0,u=!1;try{if(s=(r=r.call(e)).next,t!==0)for(;!(c=(n=s.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(d){u=!0,i=d}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return l}}function pO(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function kpe(e,t){if(e){if(typeof e=="string")return pO(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?pO(e,t):void 0}}function Ape(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mO(e,t){return _pe(e)||jpe(e,t)||kpe(e,t)||Ape()}function gO(e,t="utf8"){return new TextDecoder(t).decode(e)}const Npe=new TextEncoder;function Cpe(e){return Npe.encode(e)}const Epe=1024*8,Tpe=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),dj={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class yC{constructor(t=Epe,r={}){Mi(this,"buffer");Mi(this,"byteLength");Mi(this,"byteOffset");Mi(this,"length");Mi(this,"offset");Mi(this,"lastWrittenByte");Mi(this,"littleEndian");Mi(this,"_data");Mi(this,"_mark");Mi(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=r.offset?r.offset>>>0:0,s=t.byteLength-i;let o=i;(ArrayBuffer.isView(t)||t instanceof yC)&&(t.byteLength!==t.buffer.byteLength&&(o=t.byteOffset+i),t=t.buffer),n?this.lastWrittenByte=s:this.lastWrittenByte=0,this.buffer=t,this.length=s,this.byteLength=s,this.byteOffset=o,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,o,s),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=dj[r].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,s=this.buffer.slice(i,i+n);if(this.littleEndian===Tpe&&r!=="uint8"&&r!=="int8"){const l=new Uint8Array(this.buffer.slice(i,i+n));l.reverse();const c=new dj[r](l.buffer);return this.offset+=n,c.reverse(),c}const o=new dj[r](s);return this.offset+=n,o}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return gO(this.readBytes(t))}decodeText(t=1,r="utf8"){return gO(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(Cpe(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function fg(e){let t=e.length;for(;--t>=0;)e[t]=0}const Ppe=3,Ope=258,az=29,Mpe=256,Lpe=Mpe+1+az,sz=30,Rpe=512,Fpe=new Array((Lpe+2)*2);fg(Fpe);const Bpe=new Array(sz*2);fg(Bpe);const Ipe=new Array(Rpe);fg(Ipe);const Dpe=new Array(Ope-Ppe+1);fg(Dpe);const $pe=new Array(az);fg($pe);const Upe=new Array(sz);fg(Upe);const zpe=(e,t,r,n)=>{let i=e&65535|0,s=e>>>16&65535|0,o=0;for(;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+t[n++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};var Z4=zpe;const Wpe=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},qpe=new Uint32Array(Wpe()),Hpe=(e,t,r,n)=>{const i=qpe,s=n+r;e^=-1;for(let o=n;o<s;o++)e=e>>>8^i[(e^t[o])&255];return e^-1};var Mu=Hpe,eA={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},oz={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Vpe=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Gpe=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)Vpe(r,n)&&(e[n]=r[n])}}return e},Kpe=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,s=e.length;n<s;n++){let o=e[n];r.set(o,i),i+=o.length}return r},lz={assign:Gpe,flattenChunks:Kpe};let cz=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{cz=!1}const _1=new Uint8Array(256);for(let e=0;e<256;e++)_1[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_1[254]=_1[254]=1;var Ype=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,s,o=e.length,l=0;for(i=0;i<o;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(l),s=0,i=0;s<l;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<o&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|r&63):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|r&63):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|r&63);return t};const Xpe=(e,t)=>{if(t<65534&&e.subarray&&cz)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var Qpe=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i;const s=new Array(r*2);for(i=0,n=0;n<r;){let o=e[n++];if(o<128){s[i++]=o;continue}let l=_1[o];if(l>4){s[i++]=65533,n+=l-1;continue}for(o&=l===2?31:l===3?15:7;l>1&&n<r;)o=o<<6|e[n++]&63,l--;if(l>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return Xpe(s,i)},Jpe=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+_1[e[r]]>t?r:t},tA={string2buf:Ype,buf2string:Qpe,utf8border:Jpe};function Zpe(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var eme=Zpe;const Pb=16209,tme=16191;var rme=function(t,r){let n,i,s,o,l,c,u,d,f,p,h,m,g,y,b,v,w,S,j,k,A,R,M,B;const E=t.state;n=t.next_in,M=t.input,i=n+(t.avail_in-5),s=t.next_out,B=t.output,o=s-(r-t.avail_out),l=s+(t.avail_out-257),c=E.dmax,u=E.wsize,d=E.whave,f=E.wnext,p=E.window,h=E.hold,m=E.bits,g=E.lencode,y=E.distcode,b=(1<<E.lenbits)-1,v=(1<<E.distbits)-1;e:do{m<15&&(h+=M[n++]<<m,m+=8,h+=M[n++]<<m,m+=8),w=g[h&b];t:for(;;){if(S=w>>>24,h>>>=S,m-=S,S=w>>>16&255,S===0)B[s++]=w&65535;else if(S&16){j=w&65535,S&=15,S&&(m<S&&(h+=M[n++]<<m,m+=8),j+=h&(1<<S)-1,h>>>=S,m-=S),m<15&&(h+=M[n++]<<m,m+=8,h+=M[n++]<<m,m+=8),w=y[h&v];r:for(;;){if(S=w>>>24,h>>>=S,m-=S,S=w>>>16&255,S&16){if(k=w&65535,S&=15,m<S&&(h+=M[n++]<<m,m+=8,m<S&&(h+=M[n++]<<m,m+=8)),k+=h&(1<<S)-1,k>c){t.msg="invalid distance too far back",E.mode=Pb;break e}if(h>>>=S,m-=S,S=s-o,k>S){if(S=k-S,S>d&&E.sane){t.msg="invalid distance too far back",E.mode=Pb;break e}if(A=0,R=p,f===0){if(A+=u-S,S<j){j-=S;do B[s++]=p[A++];while(--S);A=s-k,R=B}}else if(f<S){if(A+=u+f-S,S-=f,S<j){j-=S;do B[s++]=p[A++];while(--S);if(A=0,f<j){S=f,j-=S;do B[s++]=p[A++];while(--S);A=s-k,R=B}}}else if(A+=f-S,S<j){j-=S;do B[s++]=p[A++];while(--S);A=s-k,R=B}for(;j>2;)B[s++]=R[A++],B[s++]=R[A++],B[s++]=R[A++],j-=3;j&&(B[s++]=R[A++],j>1&&(B[s++]=R[A++]))}else{A=s-k;do B[s++]=B[A++],B[s++]=B[A++],B[s++]=B[A++],j-=3;while(j>2);j&&(B[s++]=B[A++],j>1&&(B[s++]=B[A++]))}}else if(S&64){t.msg="invalid distance code",E.mode=Pb;break e}else{w=y[(w&65535)+(h&(1<<S)-1)];continue r}break}}else if(S&64)if(S&32){E.mode=tme;break e}else{t.msg="invalid literal/length code",E.mode=Pb;break e}else{w=g[(w&65535)+(h&(1<<S)-1)];continue t}break}}while(n<i&&s<l);j=m>>3,n-=j,m-=j<<3,h&=(1<<m)-1,t.next_in=n,t.next_out=s,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=s<l?257+(l-s):257-(s-l),E.hold=h,E.bits=m};const gp=15,xO=852,yO=592,bO=0,fj=1,vO=2,nme=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),ime=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),ame=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),sme=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),ome=(e,t,r,n,i,s,o,l)=>{const c=l.bits;let u=0,d=0,f=0,p=0,h=0,m=0,g=0,y=0,b=0,v=0,w,S,j,k,A,R=null,M;const B=new Uint16Array(gp+1),E=new Uint16Array(gp+1);let P=null,D,G,H;for(u=0;u<=gp;u++)B[u]=0;for(d=0;d<n;d++)B[t[r+d]]++;for(h=c,p=gp;p>=1&&B[p]===0;p--);if(h>p&&(h=p),p===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,l.bits=1,0;for(f=1;f<p&&B[f]===0;f++);for(h<f&&(h=f),y=1,u=1;u<=gp;u++)if(y<<=1,y-=B[u],y<0)return-1;if(y>0&&(e===bO||p!==1))return-1;for(E[1]=0,u=1;u<gp;u++)E[u+1]=E[u]+B[u];for(d=0;d<n;d++)t[r+d]!==0&&(o[E[t[r+d]]++]=d);if(e===bO?(R=P=o,M=20):e===fj?(R=nme,P=ime,M=257):(R=ame,P=sme,M=0),v=0,d=0,u=f,A=s,m=h,g=0,j=-1,b=1<<h,k=b-1,e===fj&&b>xO||e===vO&&b>yO)return 1;for(;;){D=u-g,o[d]+1<M?(G=0,H=o[d]):o[d]>=M?(G=P[o[d]-M],H=R[o[d]-M]):(G=96,H=0),w=1<<u-g,S=1<<m,f=S;do S-=w,i[A+(v>>g)+S]=D<<24|G<<16|H|0;while(S!==0);for(w=1<<u-1;v&w;)w>>=1;if(w!==0?(v&=w-1,v+=w):v=0,d++,--B[u]===0){if(u===p)break;u=t[r+o[d]]}if(u>h&&(v&k)!==j){for(g===0&&(g=h),A+=f,m=u-g,y=1<<m;m+g<p&&(y-=B[m+g],!(y<=0));)m++,y<<=1;if(b+=1<<m,e===fj&&b>xO||e===vO&&b>yO)return 1;j=v&k,i[j]=h<<24|m<<16|A-s|0}}return v!==0&&(i[A+v]=u-g<<24|64<<16|0),l.bits=h,0};var Ix=ome;const lme=0,uz=1,dz=2,{Z_FINISH:wO,Z_BLOCK:cme,Z_TREES:Ob,Z_OK:E0,Z_STREAM_END:ume,Z_NEED_DICT:dme,Z_STREAM_ERROR:qc,Z_DATA_ERROR:fz,Z_MEM_ERROR:hz,Z_BUF_ERROR:fme,Z_DEFLATED:SO}=oz,LS=16180,_O=16181,jO=16182,kO=16183,AO=16184,NO=16185,CO=16186,EO=16187,TO=16188,PO=16189,G2=16190,bd=16191,hj=16192,OO=16193,pj=16194,MO=16195,LO=16196,RO=16197,FO=16198,Mb=16199,Lb=16200,BO=16201,IO=16202,DO=16203,$O=16204,UO=16205,mj=16206,zO=16207,WO=16208,va=16209,pz=16210,mz=16211,hme=852,pme=592,mme=15,gme=mme,qO=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function xme(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const tp=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<LS||t.mode>mz?1:0},gz=e=>{if(tp(e))return qc;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=LS,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(hme),t.distcode=t.distdyn=new Int32Array(pme),t.sane=1,t.back=-1,E0},xz=e=>{if(tp(e))return qc;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,gz(e)},yz=(e,t)=>{let r;if(tp(e))return qc;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?qc:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,xz(e))},bz=(e,t)=>{if(!e)return qc;const r=new xme;e.state=r,r.strm=e,r.window=null,r.mode=LS;const n=yz(e,t);return n!==E0&&(e.state=null),n},yme=e=>bz(e,gme);let HO=!0,gj,xj;const bme=e=>{if(HO){gj=new Int32Array(512),xj=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ix(uz,e.lens,0,288,gj,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ix(dz,e.lens,0,32,xj,0,e.work,{bits:5}),HO=!1}e.lencode=gj,e.lenbits=9,e.distcode=xj,e.distbits=5},vz=(e,t,r,n)=>{let i;const s=e.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>n&&(i=n),s.window.set(t.subarray(r-n,r-n+i),s.wnext),n-=i,n?(s.window.set(t.subarray(r-n,r),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},vme=(e,t)=>{let r,n,i,s,o,l,c,u,d,f,p,h,m,g,y=0,b,v,w,S,j,k,A,R;const M=new Uint8Array(4);let B,E;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(tp(e)||!e.output||!e.input&&e.avail_in!==0)return qc;r=e.state,r.mode===bd&&(r.mode=hj),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,f=l,p=c,R=E0;e:for(;;)switch(r.mode){case LS:if(r.wrap===0){r.mode=hj;break}for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,M[0]=u&255,M[1]=u>>>8&255,r.check=Mu(r.check,M,2,0),u=0,d=0,r.mode=_O;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=va;break}if((u&15)!==SO){e.msg="unknown compression method",r.mode=va;break}if(u>>>=4,d-=4,A=(u&15)+8,r.wbits===0&&(r.wbits=A),A>15||A>r.wbits){e.msg="invalid window size",r.mode=va;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?PO:bd,u=0,d=0;break;case _O:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==SO){e.msg="unknown compression method",r.mode=va;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=va;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=Mu(r.check,M,2,0)),u=0,d=0,r.mode=jO;case jO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,M[2]=u>>>16&255,M[3]=u>>>24&255,r.check=Mu(r.check,M,4,0)),u=0,d=0,r.mode=kO;case kO:for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=Mu(r.check,M,2,0)),u=0,d=0,r.mode=AO;case AO:if(r.flags&1024){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(M[0]=u&255,M[1]=u>>>8&255,r.check=Mu(r.check,M,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=NO;case NO:if(r.flags&1024&&(h=r.length,h>l&&(h=l),h&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(s,s+h),A)),r.flags&512&&r.wrap&4&&(r.check=Mu(r.check,n,h,s)),l-=h,s+=h,r.length-=h),r.length))break e;r.length=0,r.mode=CO;case CO:if(r.flags&2048){if(l===0)break e;h=0;do A=n[s+h++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A));while(A&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Mu(r.check,n,h,s)),l-=h,s+=h,A)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=EO;case EO:if(r.flags&4096){if(l===0)break e;h=0;do A=n[s+h++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A));while(A&&h<l);if(r.flags&512&&r.wrap&4&&(r.check=Mu(r.check,n,h,s)),l-=h,s+=h,A)break e}else r.head&&(r.head.comment=null);r.mode=TO;case TO:if(r.flags&512){for(;d<16;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=va;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=bd;break;case PO:for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}e.adler=r.check=qO(u),u=0,d=0,r.mode=G2;case G2:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,dme;e.adler=r.check=1,r.mode=bd;case bd:if(t===cme||t===Ob)break e;case hj:if(r.last){u>>>=d&7,d-=d&7,r.mode=mj;break}for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=OO;break;case 1:if(bme(r),r.mode=Mb,t===Ob){u>>>=2,d-=2;break e}break;case 2:r.mode=LO;break;case 3:e.msg="invalid block type",r.mode=va}u>>>=2,d-=2;break;case OO:for(u>>>=d&7,d-=d&7;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=va;break}if(r.length=u&65535,u=0,d=0,r.mode=pj,t===Ob)break e;case pj:r.mode=MO;case MO:if(h=r.length,h){if(h>l&&(h=l),h>c&&(h=c),h===0)break e;i.set(n.subarray(s,s+h),o),l-=h,s+=h,c-=h,o+=h,r.length-=h;break}r.mode=bd;break;case LO:for(;d<14;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=va;break}r.have=0,r.mode=RO;case RO:for(;r.have<r.ncode;){for(;d<3;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.lens[P[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,B={bits:r.lenbits},R=Ix(lme,r.lens,0,19,r.lencode,0,r.work,B),r.lenbits=B.bits,R){e.msg="invalid code lengths set",r.mode=va;break}r.have=0,r.mode=FO;case FO:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(w<16)u>>>=b,d-=b,r.lens[r.have++]=w;else{if(w===16){for(E=b+2;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(u>>>=b,d-=b,r.have===0){e.msg="invalid bit length repeat",r.mode=va;break}A=r.lens[r.have-1],h=3+(u&3),u>>>=2,d-=2}else if(w===17){for(E=b+3;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=b,d-=b,A=0,h=3+(u&7),u>>>=3,d-=3}else{for(E=b+7;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=b,d-=b,A=0,h=11+(u&127),u>>>=7,d-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=va;break}for(;h--;)r.lens[r.have++]=A}}if(r.mode===va)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=va;break}if(r.lenbits=9,B={bits:r.lenbits},R=Ix(uz,r.lens,0,r.nlen,r.lencode,0,r.work,B),r.lenbits=B.bits,R){e.msg="invalid literal/lengths set",r.mode=va;break}if(r.distbits=6,r.distcode=r.distdyn,B={bits:r.distbits},R=Ix(dz,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,B),r.distbits=B.bits,R){e.msg="invalid distances set",r.mode=va;break}if(r.mode=Mb,t===Ob)break e;case Mb:r.mode=Lb;case Lb:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,rme(e,p),o=e.next_out,i=e.output,c=e.avail_out,s=e.next_in,n=e.input,l=e.avail_in,u=r.hold,d=r.bits,r.mode===bd&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(v&&!(v&240)){for(S=b,j=v,k=w;y=r.lencode[k+((u&(1<<S+j)-1)>>S)],b=y>>>24,v=y>>>16&255,w=y&65535,!(S+b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=b,d-=b,r.back+=b,r.length=w,v===0){r.mode=UO;break}if(v&32){r.back=-1,r.mode=bd;break}if(v&64){e.msg="invalid literal/length code",r.mode=va;break}r.extra=v&15,r.mode=BO;case BO:if(r.extra){for(E=r.extra;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=IO;case IO:for(;y=r.distcode[u&(1<<r.distbits)-1],b=y>>>24,v=y>>>16&255,w=y&65535,!(b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(!(v&240)){for(S=b,j=v,k=w;y=r.distcode[k+((u&(1<<S+j)-1)>>S)],b=y>>>24,v=y>>>16&255,w=y&65535,!(S+b<=d);){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}u>>>=S,d-=S,r.back+=S}if(u>>>=b,d-=b,r.back+=b,v&64){e.msg="invalid distance code",r.mode=va;break}r.offset=w,r.extra=v&15,r.mode=DO;case DO:if(r.extra){for(E=r.extra;d<E;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=va;break}r.mode=$O;case $O:if(c===0)break e;if(h=p-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=va;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),g=r.window}else g=i,m=o-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do i[o++]=g[m++];while(--h);r.length===0&&(r.mode=Lb);break;case UO:if(c===0)break e;i[o++]=r.length,c--,r.mode=Lb;break;case mj:if(r.wrap){for(;d<32;){if(l===0)break e;l--,u|=n[s++]<<d,d+=8}if(p-=c,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?Mu(r.check,i,p,o-p):Z4(r.check,i,p,o-p)),p=c,r.wrap&4&&(r.flags?u:qO(u))!==r.check){e.msg="incorrect data check",r.mode=va;break}u=0,d=0}r.mode=zO;case zO:if(r.wrap&&r.flags){for(;d<32;){if(l===0)break e;l--,u+=n[s++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=va;break}u=0,d=0}r.mode=WO;case WO:R=ume;break e;case va:R=fz;break e;case pz:return hz;case mz:default:return qc}return e.next_out=o,e.avail_out=c,e.next_in=s,e.avail_in=l,r.hold=u,r.bits=d,(r.wsize||p!==e.avail_out&&r.mode<va&&(r.mode<mj||t!==wO))&&vz(e,e.output,e.next_out,p-e.avail_out),f-=e.avail_in,p-=e.avail_out,e.total_in+=f,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?Mu(r.check,i,p,e.next_out-p):Z4(r.check,i,p,e.next_out-p)),e.data_type=r.bits+(r.last?64:0)+(r.mode===bd?128:0)+(r.mode===Mb||r.mode===pj?256:0),(f===0&&p===0||t===wO)&&R===E0&&(R=fme),R},wme=e=>{if(tp(e))return qc;let t=e.state;return t.window&&(t.window=null),e.state=null,E0},Sme=(e,t)=>{if(tp(e))return qc;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,E0):qc},_me=(e,t)=>{const r=t.length;let n,i,s;return tp(e)||(n=e.state,n.wrap!==0&&n.mode!==G2)?qc:n.mode===G2&&(i=1,i=Z4(i,t,r,0),i!==n.check)?fz:(s=vz(e,t,r,r),s?(n.mode=pz,hz):(n.havedict=1,E0))};var jme=xz,kme=yz,Ame=gz,Nme=yme,Cme=bz,Eme=vme,Tme=wme,Pme=Sme,Ome=_me,Mme="pako inflate (from Nodeca project)",Nd={inflateReset:jme,inflateReset2:kme,inflateResetKeep:Ame,inflateInit:Nme,inflateInit2:Cme,inflate:Eme,inflateEnd:Tme,inflateGetHeader:Pme,inflateSetDictionary:Ome,inflateInfo:Mme};function Lme(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Rme=Lme;const wz=Object.prototype.toString,{Z_NO_FLUSH:Fme,Z_FINISH:Bme,Z_OK:j1,Z_STREAM_END:yj,Z_NEED_DICT:bj,Z_STREAM_ERROR:Ime,Z_DATA_ERROR:VO,Z_MEM_ERROR:Dme}=oz;function uy(e){this.options=lz.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new eme,this.strm.avail_out=0;let r=Nd.inflateInit2(this.strm,t.windowBits);if(r!==j1)throw new Error(eA[r]);if(this.header=new Rme,Nd.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=tA.string2buf(t.dictionary):wz.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Nd.inflateSetDictionary(this.strm,t.dictionary),r!==j1)))throw new Error(eA[r])}uy.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let s,o,l;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?Bme:Fme,wz.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),s=Nd.inflate(r,o),s===bj&&i&&(s=Nd.inflateSetDictionary(r,i),s===j1?s=Nd.inflate(r,o):s===VO&&(s=bj));r.avail_in>0&&s===yj&&r.state.wrap>0&&e[r.next_in]!==0;)Nd.inflateReset(r),s=Nd.inflate(r,o);switch(s){case Ime:case VO:case bj:case Dme:return this.onEnd(s),this.ended=!0,!1}if(l=r.avail_out,r.next_out&&(r.avail_out===0||s===yj))if(this.options.to==="string"){let c=tA.utf8border(r.output,r.next_out),u=r.next_out-c,d=tA.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(s===j1&&l===0)){if(s===yj)return s=Nd.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};uy.prototype.onData=function(e){this.chunks.push(e)};uy.prototype.onEnd=function(e){e===j1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=lz.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function $me(e,t){const r=new uy(t);if(r.push(e),r.err)throw r.msg||eA[r.err];return r.result}var Ume=uy,zme=$me,Wme={Inflate:Ume,inflate:zme};const{Inflate:qme,inflate:Hme}=Wme;var GO=qme,Vme=Hme;const Sz=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;Sz[e]=t}const KO=4294967295;function Gme(e,t,r){let n=e;for(let i=0;i<r;i++)n=Sz[(n^t[i])&255]^n>>>8;return n}function Kme(e,t){return(Gme(KO,e,t)^KO)>>>0}function YO(e,t,r){const n=e.readUint32(),i=Kme(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function _z(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function jz(e,t,r,n){let i=0;for(;i<n;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-n]&255}function kz(e,t,r,n){let i=0;if(r.length===0)for(;i<n;i++)t[i]=e[i];else for(;i<n;i++)t[i]=e[i]+r[i]&255}function Az(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+(t[s-i]>>1)&255}else{for(;s<i;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<n;s++)t[s]=e[s]+(t[s-i]+r[s]>>1)&255}}function Nz(e,t,r,n,i){let s=0;if(r.length===0){for(;s<i;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-i]&255}else{for(;s<i;s++)t[s]=e[s]+r[s]&255;for(;s<n;s++)t[s]=e[s]+Yme(t[s-i],r[s],r[s-i])&255}}function Yme(e,t,r){const n=e+t-r,i=Math.abs(n-e),s=Math.abs(n-t),o=Math.abs(n-r);return i<=s&&i<=o?e:s<=o?t:r}function Xme(e,t,r,n,i,s){switch(e){case 0:_z(t,r,i);break;case 1:jz(t,r,i,s);break;case 2:kz(t,r,n,i);break;case 3:Az(t,r,n,i,s);break;case 4:Nz(t,r,n,i,s);break;default:throw new Error(`Unsupported filter: ${e}`)}}const Qme=new Uint16Array([255]),Jme=new Uint8Array(Qme.buffer),Zme=Jme[0]===255;function ege(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,o=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],l=Math.ceil(s/8)*i,c=new Uint8Array(n*r*l);let u=0;for(let d=0;d<7;d++){const f=o[d],p=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(p<=0||h<=0)continue;const m=p*l,g=new Uint8Array(m);for(let y=0;y<h;y++){const b=t[u++],v=t.subarray(u,u+m);u+=m;const w=new Uint8Array(m);Xme(b,v,w,g,m,l),g.set(w);for(let S=0;S<p;S++){const j=f.x+S*f.xStep,k=f.y+y*f.yStep;if(!(j>=r||k>=n))for(let A=0;A<l;A++)c[(k*r+j)*l+A]=w[S*l+A]}}}if(s===16){const d=new Uint16Array(c.buffer);if(Zme)for(let f=0;f<d.length;f++)d[f]=tge(d[f]);return d}else return c}function tge(e){return(e&255)<<8|e>>8&255}const rge=new Uint16Array([255]),nge=new Uint8Array(rge.buffer),ige=nge[0]===255,age=new Uint8Array(0);function XO(e){const{data:t,width:r,height:n,channels:i,depth:s}=e,o=Math.ceil(s/8)*i,l=Math.ceil(s/8*i*r),c=new Uint8Array(n*l);let u=age,d=0,f,p;for(let h=0;h<n;h++){switch(f=t.subarray(d+1,d+1+l),p=c.subarray(h*l,(h+1)*l),t[d]){case 0:_z(f,p,l);break;case 1:jz(f,p,l,o);break;case 2:kz(f,p,u,l);break;case 3:Az(f,p,u,l,o);break;case 4:Nz(f,p,u,l,o);break;default:throw new Error(`Unsupported filter: ${t[d]}`)}u=p,d+=l+1}if(s===16){const h=new Uint16Array(c.buffer);if(ige)for(let m=0;m<h.length;m++)h[m]=sge(h[m]);return h}else return c}function sge(e){return(e&255)<<8|e>>8&255}const $v=Uint8Array.of(137,80,78,71,13,10,26,10);function QO(e){if(!oge(e.readBytes($v.length)))throw new Error("wrong PNG signature")}function oge(e){if(e.length<$v.length)return!1;for(let t=0;t<$v.length;t++)if(e[t]!==$v[t])return!1;return!0}const lge="tEXt",cge=0,Cz=new TextDecoder("latin1");function uge(e){if(fge(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const dge=/^[\u0000-\u00FF]*$/;function fge(e){if(!dge.test(e))throw new Error("invalid latin1 text")}function hge(e,t,r){const n=Ez(t);e[n]=pge(t,r-n.length-1)}function Ez(e){for(e.mark();e.readByte()!==cge;);const t=e.offset;e.reset();const r=Cz.decode(e.readBytes(t-e.offset-1));return e.skip(1),uge(r),r}function pge(e,t){return Cz.decode(e.readBytes(t))}const ql={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},vj={UNKNOWN:-1,DEFLATE:0},JO={UNKNOWN:-1,ADAPTIVE:0},wj={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Rb={NONE:0,BACKGROUND:1,PREVIOUS:2},Sj={SOURCE:0,OVER:1};class mge extends yC{constructor(r,n={}){super(r);Mi(this,"_checkCrc");Mi(this,"_inflator");Mi(this,"_png");Mi(this,"_apng");Mi(this,"_end");Mi(this,"_hasPalette");Mi(this,"_palette");Mi(this,"_hasTransparency");Mi(this,"_transparency");Mi(this,"_compressionMethod");Mi(this,"_filterMethod");Mi(this,"_interlaceMethod");Mi(this,"_colorType");Mi(this,"_isAnimated");Mi(this,"_numberOfFrames");Mi(this,"_numberOfPlays");Mi(this,"_frames");Mi(this,"_writingDataChunks");const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new GO,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=vj.UNKNOWN,this._filterMethod=JO.UNKNOWN,this._interlaceMethod=wj.UNKNOWN,this._colorType=ql.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(QO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(QO(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case lge:hge(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?YO(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?YO(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=gge(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case ql.GREYSCALE:i=1;break;case ql.TRUECOLOUR:i=3;break;case ql.INDEXED_COLOUR:i=1;break;case ql.GREYSCALE_ALPHA:i=2;break;case ql.TRUECOLOUR_ALPHA:i=4;break;case ql.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==vj.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let s=0;s<n;s++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case ql.GREYSCALE:case ql.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case ql.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case ql.UNKNOWN:case ql.GREYSCALE_ALPHA:case ql.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=Ez(this),i=this.readUint8();if(i!==vj.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const s=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:Vme(s)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=XO({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const s=this._apng.frames.at(r-1);this.disposeFrame(i,s,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case Rb.NONE:break;case Rb.BACKGROUND:for(let s=0;s<this._png.height;s++)for(let o=0;o<this._png.width;o++){const l=(s*r.width+o)*this._png.channels;for(let c=0;c<this._png.channels;c++)i.data[l+c]=0}break;case Rb.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,s=(o,l)=>{const c=((o+n.yOffset)*this._png.width+n.xOffset+l)*this._png.channels,u=(o*n.width+l)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case Sj.SOURCE:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++)r.data[c+d]=n.data[u+d]}break;case Sj.OVER:for(let o=0;o<n.height;o++)for(let l=0;l<n.width;l++){const{index:c,frameIndex:u}=s(o,l);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/i,p=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(f*p+(1-f)*r.data[c+d]);r.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==JO.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===wj.NO_INTERLACE)this._png.data=XO({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===wj.ADAM7)this._png.data=ege({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Rb.NONE,blendOp:Sj.SOURCE,data:r}),this._inflator=new GO,this._writingDataChunks=!1}}function gge(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var ZO;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(ZO||(ZO={}));function xge(e,t){return new mge(e,t).decode()}var Yn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function _j(){Yn.console&&typeof Yn.console.log=="function"&&Yn.console.log.apply(Yn.console,arguments)}var na={log:_j,warn:function(e){Yn.console&&(typeof Yn.console.warn=="function"?Yn.console.warn.apply(Yn.console,arguments):_j.call(null,arguments))},error:function(e){Yn.console&&(typeof Yn.console.error=="function"?Yn.console.error.apply(Yn.console,arguments):_j(e))}};function jj(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){$h(n.response,t,r)},n.onerror=function(){na.error("could not download file")},n.send()}function eM(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Fb(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var $h=Yn.saveAs||((typeof window>"u"?"undefined":Hi(window))!=="object"||window!==Yn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Yn.URL||Yn.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?eM(i.href)?jj(e,t,r):Fb(i,i.target="_blank"):Fb(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Fb(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(eM(e))jj(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Fb(n)})}else navigator.msSaveOrOpenBlob(function(i,s){return s===void 0?s={autoBom:!1}:Hi(s)!=="object"&&(na.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return jj(e,t,r);var i=e.type==="application/octet-stream",s=/constructor/i.test(Yn.HTMLElement)||Yn.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&s)&&(typeof FileReader>"u"?"undefined":Hi(FileReader))==="object"){var l=new FileReader;l.onloadend=function(){var d=l.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},l.readAsDataURL(e)}else{var c=Yn.URL||Yn.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Tz(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(l){return[parseInt(l[1]),parseInt(l[2]),parseInt(l[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(l){return[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(l){return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,s=r[n].process,o=i.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var l=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+l+c+u}}var Uv=Yn.atob.bind(Yn),tM=Yn.btoa.bind(Yn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function kj(e,t){var r=e[0],n=e[1],i=e[2],s=e[3];r=No(r,n,i,s,t[0],7,-680876936),s=No(s,r,n,i,t[1],12,-389564586),i=No(i,s,r,n,t[2],17,606105819),n=No(n,i,s,r,t[3],22,-1044525330),r=No(r,n,i,s,t[4],7,-176418897),s=No(s,r,n,i,t[5],12,1200080426),i=No(i,s,r,n,t[6],17,-1473231341),n=No(n,i,s,r,t[7],22,-45705983),r=No(r,n,i,s,t[8],7,1770035416),s=No(s,r,n,i,t[9],12,-1958414417),i=No(i,s,r,n,t[10],17,-42063),n=No(n,i,s,r,t[11],22,-1990404162),r=No(r,n,i,s,t[12],7,1804603682),s=No(s,r,n,i,t[13],12,-40341101),i=No(i,s,r,n,t[14],17,-1502002290),r=Co(r,n=No(n,i,s,r,t[15],22,1236535329),i,s,t[1],5,-165796510),s=Co(s,r,n,i,t[6],9,-1069501632),i=Co(i,s,r,n,t[11],14,643717713),n=Co(n,i,s,r,t[0],20,-373897302),r=Co(r,n,i,s,t[5],5,-701558691),s=Co(s,r,n,i,t[10],9,38016083),i=Co(i,s,r,n,t[15],14,-660478335),n=Co(n,i,s,r,t[4],20,-405537848),r=Co(r,n,i,s,t[9],5,568446438),s=Co(s,r,n,i,t[14],9,-1019803690),i=Co(i,s,r,n,t[3],14,-187363961),n=Co(n,i,s,r,t[8],20,1163531501),r=Co(r,n,i,s,t[13],5,-1444681467),s=Co(s,r,n,i,t[2],9,-51403784),i=Co(i,s,r,n,t[7],14,1735328473),r=Eo(r,n=Co(n,i,s,r,t[12],20,-1926607734),i,s,t[5],4,-378558),s=Eo(s,r,n,i,t[8],11,-2022574463),i=Eo(i,s,r,n,t[11],16,1839030562),n=Eo(n,i,s,r,t[14],23,-35309556),r=Eo(r,n,i,s,t[1],4,-1530992060),s=Eo(s,r,n,i,t[4],11,1272893353),i=Eo(i,s,r,n,t[7],16,-155497632),n=Eo(n,i,s,r,t[10],23,-1094730640),r=Eo(r,n,i,s,t[13],4,681279174),s=Eo(s,r,n,i,t[0],11,-358537222),i=Eo(i,s,r,n,t[3],16,-722521979),n=Eo(n,i,s,r,t[6],23,76029189),r=Eo(r,n,i,s,t[9],4,-640364487),s=Eo(s,r,n,i,t[12],11,-421815835),i=Eo(i,s,r,n,t[15],16,530742520),r=To(r,n=Eo(n,i,s,r,t[2],23,-995338651),i,s,t[0],6,-198630844),s=To(s,r,n,i,t[7],10,1126891415),i=To(i,s,r,n,t[14],15,-1416354905),n=To(n,i,s,r,t[5],21,-57434055),r=To(r,n,i,s,t[12],6,1700485571),s=To(s,r,n,i,t[3],10,-1894986606),i=To(i,s,r,n,t[10],15,-1051523),n=To(n,i,s,r,t[1],21,-2054922799),r=To(r,n,i,s,t[8],6,1873313359),s=To(s,r,n,i,t[15],10,-30611744),i=To(i,s,r,n,t[6],15,-1560198380),n=To(n,i,s,r,t[13],21,1309151649),r=To(r,n,i,s,t[4],6,-145523070),s=To(s,r,n,i,t[11],10,-1120210379),i=To(i,s,r,n,t[2],15,718787259),n=To(n,i,s,r,t[9],21,-343485551),e[0]=Yf(r,e[0]),e[1]=Yf(n,e[1]),e[2]=Yf(i,e[2]),e[3]=Yf(s,e[3])}function RS(e,t,r,n,i,s){return t=Yf(Yf(t,e),Yf(n,s)),Yf(t<<i|t>>>32-i,r)}function No(e,t,r,n,i,s,o){return RS(t&r|~t&n,e,t,i,s,o)}function Co(e,t,r,n,i,s,o){return RS(t&n|r&~n,e,t,i,s,o)}function Eo(e,t,r,n,i,s,o){return RS(t^r^n,e,t,i,s,o)}function To(e,t,r,n,i,s,o){return RS(r^(t|~n),e,t,i,s,o)}function Pz(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)kj(n,yge(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(kj(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,kj(n,i),n}function yge(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var rM="0123456789abcdef".split("");function bge(e){for(var t="",r=0;r<4;r++)t+=rM[e>>8*r+4&15]+rM[e>>8*r&15];return t}function vge(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function rA(e){return Pz(e).map(vge).join("")}var wge=function(e){for(var t=0;t<e.length;t++)e[t]=bge(e[t]);return e.join("")}(Pz("hello"))!="5d41402abc4b2a76b9719d911017c592";function Yf(e,t){if(wge){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function nA(e,t){var r,n,i,s;if(e!==r){for(var o=(i=e,s=1+(256/e.length|0),new Array(s+1).join(i)),l=[],c=0;c<256;c++)l[c]=c;var u=0;for(c=0;c<256;c++){var d=l[c];u=(u+d+o.charCodeAt(c))%256,l[c]=l[u],l[u]=d}r=e,n=l}else l=n;var f=t.length,p=0,h=0,m="";for(c=0;c<f;c++)h=(h+(d=l[p=(p+1)%256]))%256,l[p]=l[h],l[h]=d,o=l[(l[p]+l[h])%256],m+=String.fromCharCode(t.charCodeAt(c)^o);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var nM={print:4,modify:8,copy:16,"annot-forms":32};function Rp(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(l){if(nM.perm!==void 0)throw new Error("Invalid permission: "+l);i+=nM[l]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^i)),this.encryptionKey=rA(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=nA(this.encryptionKey,this.padding)}function Fp(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);t+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):e[n]}return t}function iM(e){if(Hi(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[n,!!i],s},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,n)}catch(l){Yn.console&&na.error("jsPDF PubSub Error",l.message,l)}o[1]&&i.push(s)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function K2(e){if(!(this instanceof K2))return new K2(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Oz(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Hh(e,t,r,n,i){if(!(this instanceof Hh))return new Hh(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Oz.call(this,n,i)}function em(e,t,r,n,i){if(!(this instanceof em))return new em(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Oz.call(this,n,i)}function Rn(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],s=arguments[3],o=[],l=1,c=16,u="S",d=null;Hi(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,s=e.compress||e.compressPdf||s,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),l=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=iM;var m="1.3",g=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(L){m=L};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return y};var b=h.__private__.getPageFormat=function(L){return y[L]};i=i||"a4";var v="compat",w="advanced",S=v;function j(){this.saveGraphicsState(),U(new tt(ce,0,0,-ce,0,on()*ce).toString()+" cm"),this.setFontSize(this.getFontSize()/ce),u="n",S=w}function k(){this.restoreGraphicsState(),u="S",S=v}var A=h.__private__.combineFontStyleAndFontWeight=function(L,le){if(L=="bold"&&le=="normal"||L=="bold"&&le==400||L=="normal"&&le=="italic"||L=="bold"&&le=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return le&&(L=le==400||le==="normal"?L==="italic"?"italic":"normal":le!=700&&le!=="bold"||L!=="normal"?(le==700?"bold":le)+""+L:"bold"),L};h.advancedAPI=function(L){var le=S===v;return le&&j.call(this),typeof L!="function"||(L(this),le&&k.call(this)),this},h.compatAPI=function(L){var le=S===w;return le&&k.call(this),typeof L!="function"||(L(this),le&&j.call(this)),this},h.isAdvancedAPI=function(){return S===w};var R,M=function(L){if(S!==w)throw new Error(L+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},B=h.roundToPrecision=h.__private__.roundToPrecision=function(L,le){var Oe=t||le;if(isNaN(L)||isNaN(Oe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return L.toFixed(Oe).replace(/0+$/,"")};R=h.hpf=h.__private__.hpf=typeof c=="number"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return B(L,c)}:c==="smart"?function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return B(L,L>-1&&L<1?16:5)}:function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.hpf");return B(L,16)};var E=h.f2=h.__private__.f2=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f2");return B(L,2)},P=h.__private__.f3=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.f3");return B(L,3)},D=h.scale=h.__private__.scale=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.scale");return S===v?L*ce:S===w?L:void 0},G=function(L){return D(function(le){return S===v?on()-le:S===w?le:void 0}(L))};h.__private__.setPrecision=h.setPrecision=function(L){typeof parseInt(L,10)=="number"&&(t=parseInt(L,10))};var H,oe="00000000000000000000000000000000",de=h.__private__.getFileId=function(){return oe},W=h.__private__.setFileId=function(L){return oe=L!==void 0&&/^[a-fA-F0-9]{32}$/.test(L)?L.toUpperCase():oe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(gr=new Rp(d.userPermissions,d.userPassword,d.ownerPassword,oe)),oe};h.setFileId=function(L){return W(L),this},h.getFileId=function(){return de()};var V=h.__private__.convertDateToPDFDate=function(L){var le=L.getTimezoneOffset(),Oe=le<0?"+":"-",dt=Math.floor(Math.abs(le/60)),rt=Math.abs(le%60),Mt=[Oe,q(dt),"'",q(rt),"'"].join("");return["D:",L.getFullYear(),q(L.getMonth()+1),q(L.getDate()),q(L.getHours()),q(L.getMinutes()),q(L.getSeconds()),Mt].join("")},ae=h.__private__.convertPDFDateToDate=function(L){var le=parseInt(L.substr(2,4),10),Oe=parseInt(L.substr(6,2),10)-1,dt=parseInt(L.substr(8,2),10),rt=parseInt(L.substr(10,2),10),Mt=parseInt(L.substr(12,2),10),lr=parseInt(L.substr(14,2),10);return new Date(le,Oe,dt,rt,Mt,lr,0)},ee=h.__private__.setCreationDate=function(L){var le;if(L===void 0&&(L=new Date),L instanceof Date)le=V(L);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(L))throw new Error("Invalid argument passed to jsPDF.setCreationDate");le=L}return H=le},C=h.__private__.getCreationDate=function(L){var le=H;return L==="jsDate"&&(le=ae(H)),le};h.setCreationDate=function(L){return ee(L),this},h.getCreationDate=function(L){return C(L)};var Y,q=h.__private__.padd2=function(L){return("0"+parseInt(L)).slice(-2)},O=h.__private__.padd2Hex=function(L){return("00"+(L=L.toString())).substr(L.length)},X=0,F=[],Q=[],K=0,ne=[],re=[],T=!1,I=Q;h.__private__.setCustomOutputDestination=function(L){T=!0,I=L};var ie=function(L){T||(I=L)};h.__private__.resetCustomOutputDestination=function(){T=!1,I=Q};var U=h.__private__.out=function(L){return L=L.toString(),K+=L.length+1,I.push(L),I},Z=h.__private__.write=function(L){return U(arguments.length===1?L.toString():Array.prototype.join.call(arguments," "))},me=h.__private__.getArrayBuffer=function(L){for(var le=L.length,Oe=new ArrayBuffer(le),dt=new Uint8Array(Oe);le--;)dt[le]=L.charCodeAt(le);return Oe},Pe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Pe};var je=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(L){return je=S===w?L/ce:L,this};var Fe,_e=h.__private__.getFontSize=h.getFontSize=function(){return S===v?je:je*ce},He=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(L){return He=L,this},h.__private__.getR2L=h.getR2L=function(){return He};var qe,Pt=h.__private__.setZoomMode=function(L){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(L))Fe=L;else if(isNaN(L)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(L)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+L+'" is not recognized.');Fe=L}else Fe=parseInt(L,10)};h.__private__.getZoomMode=function(){return Fe};var ut,Ke=h.__private__.setPageMode=function(L){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(L)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+L+'" is not recognized.');qe=L};h.__private__.getPageMode=function(){return qe};var lt=h.__private__.setLayoutMode=function(L){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(L)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+L+'" is not recognized.');ut=L};h.__private__.getLayoutMode=function(){return ut},h.__private__.setDisplayMode=h.setDisplayMode=function(L,le,Oe){return Pt(L),lt(le),Ke(Oe),this};var ve={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(L){if(Object.keys(ve).indexOf(L)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ve[L]},h.__private__.getDocumentProperties=function(){return ve},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(L){for(var le in ve)ve.hasOwnProperty(le)&&L[le]&&(ve[le]=L[le]);return this},h.__private__.setDocumentProperty=function(L,le){if(Object.keys(ve).indexOf(L)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ve[L]=le};var Ae,ce,be,mt,et,Ue={},It={},ht=[],Lt={},yr={},Ar={},Tt={},Vr=null,Br=0,Wr=[],nn=new iM(h),fn=e.hotfixes||[],Ir={},dn={},Te=[],tt=function L(le,Oe,dt,rt,Mt,lr){if(!(this instanceof L))return new L(le,Oe,dt,rt,Mt,lr);isNaN(le)&&(le=1),isNaN(Oe)&&(Oe=0),isNaN(dt)&&(dt=0),isNaN(rt)&&(rt=1),isNaN(Mt)&&(Mt=0),isNaN(lr)&&(lr=0),this._matrix=[le,Oe,dt,rt,Mt,lr]};Object.defineProperty(tt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(tt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(tt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(tt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(tt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(tt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(tt.prototype,"a",{get:function(){return this._matrix[0]},set:function(L){this._matrix[0]=L}}),Object.defineProperty(tt.prototype,"b",{get:function(){return this._matrix[1]},set:function(L){this._matrix[1]=L}}),Object.defineProperty(tt.prototype,"c",{get:function(){return this._matrix[2]},set:function(L){this._matrix[2]=L}}),Object.defineProperty(tt.prototype,"d",{get:function(){return this._matrix[3]},set:function(L){this._matrix[3]=L}}),Object.defineProperty(tt.prototype,"e",{get:function(){return this._matrix[4]},set:function(L){this._matrix[4]=L}}),Object.defineProperty(tt.prototype,"f",{get:function(){return this._matrix[5]},set:function(L){this._matrix[5]=L}}),Object.defineProperty(tt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(tt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(tt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(tt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),tt.prototype.join=function(L){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(R).join(L)},tt.prototype.multiply=function(L){var le=L.sx*this.sx+L.shy*this.shx,Oe=L.sx*this.shy+L.shy*this.sy,dt=L.shx*this.sx+L.sy*this.shx,rt=L.shx*this.shy+L.sy*this.sy,Mt=L.tx*this.sx+L.ty*this.shx+this.tx,lr=L.tx*this.shy+L.ty*this.sy+this.ty;return new tt(le,Oe,dt,rt,Mt,lr)},tt.prototype.decompose=function(){var L=this.sx,le=this.shy,Oe=this.shx,dt=this.sy,rt=this.tx,Mt=this.ty,lr=Math.sqrt(L*L+le*le),en=(L/=lr)*Oe+(le/=lr)*dt;Oe-=L*en,dt-=le*en;var bn=Math.sqrt(Oe*Oe+dt*dt);return en/=bn,L*(dt/=bn)<le*(Oe/=bn)&&(L=-L,le=-le,en=-en,lr=-lr),{scale:new tt(lr,0,0,bn,0,0),translate:new tt(1,0,0,1,rt,Mt),rotate:new tt(L,le,-le,L,0,0),skew:new tt(1,0,en,1,0,0)}},tt.prototype.toString=function(L){return this.join(" ")},tt.prototype.inversed=function(){var L=this.sx,le=this.shy,Oe=this.shx,dt=this.sy,rt=this.tx,Mt=this.ty,lr=1/(L*dt-le*Oe),en=dt*lr,bn=-le*lr,Dn=-Oe*lr,zn=L*lr;return new tt(en,bn,Dn,zn,-en*rt-Dn*Mt,-bn*rt-zn*Mt)},tt.prototype.applyToPoint=function(L){var le=L.x*this.sx+L.y*this.shx+this.tx,Oe=L.x*this.shy+L.y*this.sy+this.ty;return new Dr(le,Oe)},tt.prototype.applyToRectangle=function(L){var le=this.applyToPoint(L),Oe=this.applyToPoint(new Dr(L.x+L.w,L.y+L.h));return new cn(le.x,le.y,Oe.x-le.x,Oe.y-le.y)},tt.prototype.clone=function(){var L=this.sx,le=this.shy,Oe=this.shx,dt=this.sy,rt=this.tx,Mt=this.ty;return new tt(L,le,Oe,dt,rt,Mt)},h.Matrix=tt;var st=h.matrixMult=function(L,le){return le.multiply(L)},kt=new tt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=kt;var jt=function(L,le){if(!yr[L]){var Oe=(le instanceof Hh?"Sh":"P")+(Object.keys(Lt).length+1).toString(10);le.id=Oe,yr[L]=Oe,Lt[Oe]=le,nn.publish("addPattern",le)}};h.ShadingPattern=Hh,h.TilingPattern=em,h.addShadingPattern=function(L,le){return M("addShadingPattern()"),jt(L,le),this},h.beginTilingPattern=function(L){M("beginTilingPattern()"),yn(L.boundingBox[0],L.boundingBox[1],L.boundingBox[2]-L.boundingBox[0],L.boundingBox[3]-L.boundingBox[1],L.matrix)},h.endTilingPattern=function(L,le){M("endTilingPattern()"),le.stream=re[Y].join(`
`),jt(L,le),nn.publish("endTilingPattern",le),Te.pop().restore()};var ar,tr=h.__private__.newObject=function(){var L=Er();return se(L,!0),L},Er=h.__private__.newObjectDeferred=function(){return X++,F[X]=function(){return K},X},se=function(L,le){return le=typeof le=="boolean"&&le,F[L]=K,le&&U(L+" 0 obj"),L},ue=h.__private__.newAdditionalObject=function(){var L={objId:Er(),content:""};return ne.push(L),L},J=Er(),fe=Er(),ye=h.__private__.decodeColorString=function(L){var le=L.split(" ");if(le.length!==2||le[1]!=="g"&&le[1]!=="G")le.length!==5||le[4]!=="k"&&le[4]!=="K"||(le=[(1-le[0])*(1-le[3]),(1-le[1])*(1-le[3]),(1-le[2])*(1-le[3]),"r"]);else{var Oe=parseFloat(le[0]);le=[Oe,Oe,Oe,"r"]}for(var dt="#",rt=0;rt<3;rt++)dt+=("0"+Math.floor(255*parseFloat(le[rt])).toString(16)).slice(-2);return dt},Ce=h.__private__.encodeColorString=function(L){var le;typeof L=="string"&&(L={ch1:L});var Oe=L.ch1,dt=L.ch2,rt=L.ch3,Mt=L.ch4,lr=L.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Oe=="string"&&Oe.charAt(0)!=="#"){var en=new Tz(Oe);if(en.ok)Oe=en.toHex();else if(!/^\d*\.?\d*$/.test(Oe))throw new Error('Invalid color "'+Oe+'" passed to jsPDF.encodeColorString.')}if(typeof Oe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Oe)&&(Oe="#"+Oe[1]+Oe[1]+Oe[2]+Oe[2]+Oe[3]+Oe[3]),typeof Oe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Oe)){var bn=parseInt(Oe.substr(1),16);Oe=bn>>16&255,dt=bn>>8&255,rt=255&bn}if(dt===void 0||Mt===void 0&&Oe===dt&&dt===rt)le=typeof Oe=="string"?Oe+" "+lr[0]:L.precision===2?E(Oe/255)+" "+lr[0]:P(Oe/255)+" "+lr[0];else if(Mt===void 0||Hi(Mt)==="object"){if(Mt&&!isNaN(Mt.a)&&Mt.a===0)return["1.","1.","1.",lr[1]].join(" ");le=typeof Oe=="string"?[Oe,dt,rt,lr[1]].join(" "):L.precision===2?[E(Oe/255),E(dt/255),E(rt/255),lr[1]].join(" "):[P(Oe/255),P(dt/255),P(rt/255),lr[1]].join(" ")}else le=typeof Oe=="string"?[Oe,dt,rt,Mt,lr[2]].join(" "):L.precision===2?[E(Oe),E(dt),E(rt),E(Mt),lr[2]].join(" "):[P(Oe),P(dt),P(rt),P(Mt),lr[2]].join(" ");return le},wt=h.__private__.getFilters=function(){return o},Qe=h.__private__.putStream=function(L){var le=(L=L||{}).data||"",Oe=L.filters||wt(),dt=L.alreadyAppliedFilters||[],rt=L.addLength1||!1,Mt=le.length,lr=L.objectId,en=function($e){return $e};if(d!==null&&lr===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(en=gr.encryptor(lr,0));var bn={};Oe===!0&&(Oe=["FlateEncode"]);var Dn=L.additionalKeyValues||[],zn=(bn=Rn.API.processDataByFilters!==void 0?Rn.API.processDataByFilters(le,Oe):{data:le,reverseChain:[]}).reverseChain+(Array.isArray(dt)?dt.join(" "):dt.toString());if(bn.data.length!==0&&(Dn.push({key:"Length",value:bn.data.length}),rt===!0&&Dn.push({key:"Length1",value:Mt})),zn.length!=0)if(zn.split("/").length-1==1)Dn.push({key:"Filter",value:zn});else{Dn.push({key:"Filter",value:"["+zn+"]"});for(var hi=0;hi<Dn.length;hi+=1)if(Dn[hi].key==="DecodeParms"){for(var Ni=[],bi=0;bi<bn.reverseChain.split("/").length-1;bi+=1)Ni.push("null");Ni.push(Dn[hi].value),Dn[hi].value="["+Ni.join(" ")+"]"}}U("<<");for(var Se=0;Se<Dn.length;Se++)U("/"+Dn[Se].key+" "+Dn[Se].value);U(">>"),bn.data.length!==0&&(U("stream"),U(en(bn.data)),U("endstream"))},Ie=h.__private__.putPage=function(L){var le=L.number,Oe=L.data,dt=L.objId,rt=L.contentsObjId;se(dt,!0),U("<</Type /Page"),U("/Parent "+L.rootDictionaryObjId+" 0 R"),U("/Resources "+L.resourceDictionaryObjId+" 0 R"),U("/MediaBox ["+parseFloat(R(L.mediaBox.bottomLeftX))+" "+parseFloat(R(L.mediaBox.bottomLeftY))+" "+R(L.mediaBox.topRightX)+" "+R(L.mediaBox.topRightY)+"]"),L.cropBox!==null&&U("/CropBox ["+R(L.cropBox.bottomLeftX)+" "+R(L.cropBox.bottomLeftY)+" "+R(L.cropBox.topRightX)+" "+R(L.cropBox.topRightY)+"]"),L.bleedBox!==null&&U("/BleedBox ["+R(L.bleedBox.bottomLeftX)+" "+R(L.bleedBox.bottomLeftY)+" "+R(L.bleedBox.topRightX)+" "+R(L.bleedBox.topRightY)+"]"),L.trimBox!==null&&U("/TrimBox ["+R(L.trimBox.bottomLeftX)+" "+R(L.trimBox.bottomLeftY)+" "+R(L.trimBox.topRightX)+" "+R(L.trimBox.topRightY)+"]"),L.artBox!==null&&U("/ArtBox ["+R(L.artBox.bottomLeftX)+" "+R(L.artBox.bottomLeftY)+" "+R(L.artBox.topRightX)+" "+R(L.artBox.topRightY)+"]"),typeof L.userUnit=="number"&&L.userUnit!==1&&U("/UserUnit "+L.userUnit),nn.publish("putPage",{objId:dt,pageContext:Wr[le],pageNumber:le,page:Oe}),U("/Contents "+rt+" 0 R"),U(">>"),U("endobj");var Mt=Oe.join(`
`);return S===w&&(Mt+=`
Q`),se(rt,!0),Qe({data:Mt,filters:wt(),objectId:rt}),U("endobj"),dt},Re=h.__private__.putPages=function(){var L,le,Oe=[];for(L=1;L<=Br;L++)Wr[L].objId=Er(),Wr[L].contentsObjId=Er();for(L=1;L<=Br;L++)Oe.push(Ie({number:L,data:re[L],objId:Wr[L].objId,contentsObjId:Wr[L].contentsObjId,mediaBox:Wr[L].mediaBox,cropBox:Wr[L].cropBox,bleedBox:Wr[L].bleedBox,trimBox:Wr[L].trimBox,artBox:Wr[L].artBox,userUnit:Wr[L].userUnit,rootDictionaryObjId:J,resourceDictionaryObjId:fe}));se(J,!0),U("<</Type /Pages");var dt="/Kids [";for(le=0;le<Br;le++)dt+=Oe[le]+" 0 R ";U(dt+"]"),U("/Count "+Br),U(">>"),U("endobj"),nn.publish("postPutPages")},xt=function(L){nn.publish("putFont",{font:L,out:U,newObject:tr,putStream:Qe}),L.isAlreadyPutted!==!0&&(L.objectNumber=tr(),U("<<"),U("/Type /Font"),U("/BaseFont /"+Fp(L.postScriptName)),U("/Subtype /Type1"),typeof L.encoding=="string"&&U("/Encoding /"+L.encoding),U("/FirstChar 32"),U("/LastChar 255"),U(">>"),U("endobj"))},Gt=function(L){L.objectNumber=tr();var le=[];le.push({key:"Type",value:"/XObject"}),le.push({key:"Subtype",value:"/Form"}),le.push({key:"BBox",value:"["+[R(L.x),R(L.y),R(L.x+L.width),R(L.y+L.height)].join(" ")+"]"}),le.push({key:"Matrix",value:"["+L.matrix.toString()+"]"});var Oe=L.pages[1].join(`
`);Qe({data:Oe,additionalKeyValues:le,objectId:L.objectNumber}),U("endobj")},qt=function(L,le){le||(le=21);var Oe=tr(),dt=function(lr,en){var bn,Dn=[],zn=1/(en-1);for(bn=0;bn<1;bn+=zn)Dn.push(bn);if(Dn.push(1),lr[0].offset!=0){var hi={offset:0,color:lr[0].color};lr.unshift(hi)}if(lr[lr.length-1].offset!=1){var Ni={offset:1,color:lr[lr.length-1].color};lr.push(Ni)}for(var bi="",Se=0,$e=0;$e<Dn.length;$e++){for(bn=Dn[$e];bn>lr[Se+1].offset;)Se++;var ot=lr[Se].offset,We=(bn-ot)/(lr[Se+1].offset-ot),Nt=lr[Se].color,ur=lr[Se+1].color;bi+=O(Math.round((1-We)*Nt[0]+We*ur[0]).toString(16))+O(Math.round((1-We)*Nt[1]+We*ur[1]).toString(16))+O(Math.round((1-We)*Nt[2]+We*ur[2]).toString(16))}return bi.trim()}(L.colors,le),rt=[];rt.push({key:"FunctionType",value:"0"}),rt.push({key:"Domain",value:"[0.0 1.0]"}),rt.push({key:"Size",value:"["+le+"]"}),rt.push({key:"BitsPerSample",value:"8"}),rt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),rt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Qe({data:dt,additionalKeyValues:rt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Oe}),U("endobj"),L.objectNumber=tr(),U("<< /ShadingType "+L.type),U("/ColorSpace /DeviceRGB");var Mt="/Coords ["+R(parseFloat(L.coords[0]))+" "+R(parseFloat(L.coords[1]))+" ";L.type===2?Mt+=R(parseFloat(L.coords[2]))+" "+R(parseFloat(L.coords[3])):Mt+=R(parseFloat(L.coords[2]))+" "+R(parseFloat(L.coords[3]))+" "+R(parseFloat(L.coords[4]))+" "+R(parseFloat(L.coords[5])),U(Mt+="]"),L.matrix&&U("/Matrix ["+L.matrix.toString()+"]"),U("/Function "+Oe+" 0 R"),U("/Extend [true true]"),U(">>"),U("endobj")},Wt=function(L,le){var Oe=Er(),dt=tr();le.push({resourcesOid:Oe,objectOid:dt}),L.objectNumber=dt;var rt=[];rt.push({key:"Type",value:"/Pattern"}),rt.push({key:"PatternType",value:"1"}),rt.push({key:"PaintType",value:"1"}),rt.push({key:"TilingType",value:"1"}),rt.push({key:"BBox",value:"["+L.boundingBox.map(R).join(" ")+"]"}),rt.push({key:"XStep",value:R(L.xStep)}),rt.push({key:"YStep",value:R(L.yStep)}),rt.push({key:"Resources",value:Oe+" 0 R"}),L.matrix&&rt.push({key:"Matrix",value:"["+L.matrix.toString()+"]"}),Qe({data:L.stream,additionalKeyValues:rt,objectId:L.objectNumber}),U("endobj")},vt=function(L){for(var le in L.objectNumber=tr(),U("<<"),L)switch(le){case"opacity":U("/ca "+E(L[le]));break;case"stroke-opacity":U("/CA "+E(L[le]))}U(">>"),U("endobj")},Rt=function(L){se(L.resourcesOid,!0),U("<<"),U("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var le in U("/Font <<"),Ue)Ue.hasOwnProperty(le)&&(f===!1||f===!0&&p.hasOwnProperty(le))&&U("/"+le+" "+Ue[le].objectNumber+" 0 R");U(">>")}(),function(){if(Object.keys(Lt).length>0){for(var le in U("/Shading <<"),Lt)Lt.hasOwnProperty(le)&&Lt[le]instanceof Hh&&Lt[le].objectNumber>=0&&U("/"+le+" "+Lt[le].objectNumber+" 0 R");nn.publish("putShadingPatternDict"),U(">>")}}(),function(le){if(Object.keys(Lt).length>0){for(var Oe in U("/Pattern <<"),Lt)Lt.hasOwnProperty(Oe)&&Lt[Oe]instanceof h.TilingPattern&&Lt[Oe].objectNumber>=0&&Lt[Oe].objectNumber<le&&U("/"+Oe+" "+Lt[Oe].objectNumber+" 0 R");nn.publish("putTilingPatternDict"),U(">>")}}(L.objectOid),function(){if(Object.keys(Ar).length>0){var le;for(le in U("/ExtGState <<"),Ar)Ar.hasOwnProperty(le)&&Ar[le].objectNumber>=0&&U("/"+le+" "+Ar[le].objectNumber+" 0 R");nn.publish("putGStateDict"),U(">>")}}(),function(){for(var le in U("/XObject <<"),Ir)Ir.hasOwnProperty(le)&&Ir[le].objectNumber>=0&&U("/"+le+" "+Ir[le].objectNumber+" 0 R");nn.publish("putXobjectDict"),U(">>")}(),U(">>"),U("endobj")},Zt=function(L){It[L.fontName]=It[L.fontName]||{},It[L.fontName][L.fontStyle]=L.id},wr=function(L,le,Oe,dt,rt){var Mt={id:"F"+(Object.keys(Ue).length+1).toString(10),postScriptName:L,fontName:le,fontStyle:Oe,encoding:dt,isStandardFont:rt||!1,metadata:{}};return nn.publish("addFont",{font:Mt,instance:this}),Ue[Mt.id]=Mt,Zt(Mt),Mt.id},br=h.__private__.pdfEscape=h.pdfEscape=function(L,le){return function(Oe,dt){var rt,Mt,lr,en,bn,Dn,zn,hi,Ni;if(lr=(dt=dt||{}).sourceEncoding||"Unicode",bn=dt.outputEncoding,(dt.autoencode||bn)&&Ue[Ae].metadata&&Ue[Ae].metadata[lr]&&Ue[Ae].metadata[lr].encoding&&(en=Ue[Ae].metadata[lr].encoding,!bn&&Ue[Ae].encoding&&(bn=Ue[Ae].encoding),!bn&&en.codePages&&(bn=en.codePages[0]),typeof bn=="string"&&(bn=en[bn]),bn)){for(zn=!1,Dn=[],rt=0,Mt=Oe.length;rt<Mt;rt++)(hi=bn[Oe.charCodeAt(rt)])?Dn.push(String.fromCharCode(hi)):Dn.push(Oe[rt]),Dn[rt].charCodeAt(0)>>8&&(zn=!0);Oe=Dn.join("")}for(rt=Oe.length;zn===void 0&&rt!==0;)Oe.charCodeAt(rt-1)>>8&&(zn=!0),rt--;if(!zn)return Oe;for(Dn=dt.noBOM?[]:[254,255],rt=0,Mt=Oe.length;rt<Mt;rt++){if((Ni=(hi=Oe.charCodeAt(rt))>>8)>>8)throw new Error("Character at position "+rt+" of string '"+Oe+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Dn.push(Ni),Dn.push(hi-(Ni<<8))}return String.fromCharCode.apply(void 0,Dn)}(L,le).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},cr=h.__private__.beginPage=function(L){re[++Br]=[],Wr[Br]={objId:0,contentsObjId:0,userUnit:Number(l),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(L[0]),topRightY:Number(L[1])}},Yr(Br),ie(re[Y])},Tr=function(L,le){var Oe,dt,rt;switch(r=le||r,typeof L=="string"&&(Oe=b(L.toLowerCase()),Array.isArray(Oe)&&(dt=Oe[0],rt=Oe[1])),Array.isArray(L)&&(dt=L[0]*ce,rt=L[1]*ce),isNaN(dt)&&(dt=i[0],rt=i[1]),(dt>14400||rt>14400)&&(na.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),dt=Math.min(14400,dt),rt=Math.min(14400,rt)),i=[dt,rt],r.substr(0,1)){case"l":rt>dt&&(i=[rt,dt]);break;case"p":dt>rt&&(i=[rt,dt])}cr(i),gt(Ee),U(yt),Lr!==0&&U(Lr+" J"),xr!==0&&U(xr+" j"),nn.publish("addPage",{pageNumber:Br})},Kr=function(L){L>0&&L<=Br&&(re.splice(L,1),Wr.splice(L,1),Br--,Y>Br&&(Y=Br),this.setPage(Y))},Yr=function(L){L>0&&L<=Br&&(Y=L)},xn=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return re.length-1},hr=function(L,le,Oe){var dt,rt=void 0;return Oe=Oe||{},L=L!==void 0?L:Ue[Ae].fontName,le=le!==void 0?le:Ue[Ae].fontStyle,dt=L.toLowerCase(),It[dt]!==void 0&&It[dt][le]!==void 0?rt=It[dt][le]:It[L]!==void 0&&It[L][le]!==void 0?rt=It[L][le]:Oe.disableWarning===!1&&na.warn("Unable to look up font label for font '"+L+"', '"+le+"'. Refer to getFontList() for available fonts."),rt||Oe.noFallback||(rt=It.times[le])==null&&(rt=It.times.normal),rt},nr=h.__private__.putInfo=function(){var L=tr(),le=function(dt){return dt};for(var Oe in d!==null&&(le=gr.encryptor(L,0)),U("<<"),U("/Producer ("+br(le("jsPDF "+Rn.version))+")"),ve)ve.hasOwnProperty(Oe)&&ve[Oe]&&U("/"+Oe.substr(0,1).toUpperCase()+Oe.substr(1)+" ("+br(le(ve[Oe]))+")");U("/CreationDate ("+br(le(H))+")"),U(">>"),U("endobj")},Mr=h.__private__.putCatalog=function(L){var le=(L=L||{}).rootDictionaryObjId||J;switch(tr(),U("<<"),U("/Type /Catalog"),U("/Pages "+le+" 0 R"),Fe||(Fe="fullwidth"),Fe){case"fullwidth":U("/OpenAction [3 0 R /FitH null]");break;case"fullheight":U("/OpenAction [3 0 R /FitV null]");break;case"fullpage":U("/OpenAction [3 0 R /Fit]");break;case"original":U("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Oe=""+Fe;Oe.substr(Oe.length-1)==="%"&&(Fe=parseInt(Fe)/100),typeof Fe=="number"&&U("/OpenAction [3 0 R /XYZ null null "+E(Fe)+"]")}switch(ut||(ut="continuous"),ut){case"continuous":U("/PageLayout /OneColumn");break;case"single":U("/PageLayout /SinglePage");break;case"two":case"twoleft":U("/PageLayout /TwoColumnLeft");break;case"tworight":U("/PageLayout /TwoColumnRight")}qe&&U("/PageMode /"+qe),nn.publish("putCatalog"),U(">>"),U("endobj")},an=h.__private__.putTrailer=function(){U("trailer"),U("<<"),U("/Size "+(X+1)),U("/Root "+X+" 0 R"),U("/Info "+(X-1)+" 0 R"),d!==null&&U("/Encrypt "+gr.oid+" 0 R"),U("/ID [ <"+oe+"> <"+oe+"> ]"),U(">>")},it=h.__private__.putHeader=function(){U("%PDF-"+m),U("%")},Ye=h.__private__.putXRef=function(){var L="0000000000";U("xref"),U("0 "+(X+1)),U("0000000000 65535 f ");for(var le=1;le<=X;le++)typeof F[le]=="function"?U((L+F[le]()).slice(-10)+" 00000 n "):F[le]!==void 0?U((L+F[le]).slice(-10)+" 00000 n "):U("0000000000 00000 n ")},ct=h.__private__.buildDocument=function(){var L;X=0,K=0,Q=[],F=[],ne=[],J=Er(),fe=Er(),ie(Q),nn.publish("buildDocument"),it(),Re(),function(){nn.publish("putAdditionalObjects");for(var Oe=0;Oe<ne.length;Oe++){var dt=ne[Oe];se(dt.objId,!0),U(dt.content),U("endobj")}nn.publish("postPutAdditionalObjects")}(),L=[],function(){for(var Oe in Ue)Ue.hasOwnProperty(Oe)&&(f===!1||f===!0&&p.hasOwnProperty(Oe))&&xt(Ue[Oe])}(),function(){var Oe;for(Oe in Ar)Ar.hasOwnProperty(Oe)&&vt(Ar[Oe])}(),function(){for(var Oe in Ir)Ir.hasOwnProperty(Oe)&&Gt(Ir[Oe])}(),function(Oe){var dt;for(dt in Lt)Lt.hasOwnProperty(dt)&&(Lt[dt]instanceof Hh?qt(Lt[dt]):Lt[dt]instanceof em&&Wt(Lt[dt],Oe))}(L),nn.publish("putResources"),L.forEach(Rt),Rt({resourcesOid:fe,objectOid:Number.MAX_SAFE_INTEGER}),nn.publish("postPutResources"),d!==null&&(gr.oid=tr(),U("<<"),U("/Filter /Standard"),U("/V "+gr.v),U("/R "+gr.r),U("/U <"+gr.toHexString(gr.U)+">"),U("/O <"+gr.toHexString(gr.O)+">"),U("/P "+gr.P),U(">>"),U("endobj")),nr(),Mr();var le=K;return Ye(),an(),U("startxref"),U(""+le),U("%%EOF"),ie(re[Y]),Q.join(`
`)},Ht=h.__private__.getBlob=function(L){return new Blob([me(L)],{type:"application/pdf"})},fr=h.output=h.__private__.output=(ar=function(L,le){switch(typeof(le=le||{})=="string"?le={filename:le}:le.filename=le.filename||"generated.pdf",L){case void 0:return ct();case"save":h.save(le.filename);break;case"arraybuffer":return me(ct());case"blob":return Ht(ct());case"bloburi":case"bloburl":if(Yn.URL!==void 0&&typeof Yn.URL.createObjectURL=="function")return Yn.URL&&Yn.URL.createObjectURL(Ht(ct()))||void 0;na.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Oe="",dt=ct();try{Oe=tM(dt)}catch{Oe=tM(unescape(encodeURIComponent(dt)))}return"data:application/pdf;filename="+le.filename+";base64,"+Oe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Yn)==="[object Window]"){var rt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Mt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';le.pdfObjectUrl&&(rt=le.pdfObjectUrl,Mt="");var lr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+rt+'"'+Mt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(le)+");<\/script></body></html>",en=Yn.open();return en!==null&&en.document.write(lr),en}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Yn)==="[object Window]"){var bn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(le.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+le.filename+'" width="500px" height="400px" /></body></html>',Dn=Yn.open();if(Dn!==null){Dn.document.write(bn);var zn=this;Dn.document.documentElement.querySelector("#pdfViewer").onload=function(){Dn.document.title=le.filename,Dn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(zn.output("bloburl"))}}return Dn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Yn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var hi='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",le)+'"></iframe></body></html>',Ni=Yn.open();if(Ni!==null&&(Ni.document.write(hi),Ni.document.title=le.filename),Ni||typeof safari>"u")return Ni;break;case"datauri":case"dataurl":return Yn.document.location.href=this.output("datauristring",le);default:return null}},ar.foo=function(){try{return ar.apply(this,arguments)}catch(Oe){var L=Oe.stack||"";~L.indexOf(" at ")&&(L=L.split(" at ")[1]);var le="Error in function "+L.split(`
`)[0].split("<")[0]+": "+Oe.message;if(!Yn.console)throw new Error(le);Yn.console.error(le,Oe),Yn.alert&&alert(le)}},ar.foo.bar=ar,ar.foo),Sr=function(L){return Array.isArray(fn)===!0&&fn.indexOf(L)>-1};switch(n){case"pt":ce=1;break;case"mm":ce=72/25.4;break;case"cm":ce=72/2.54;break;case"in":ce=72;break;case"px":ce=Sr("px_scaling")==1?.75:96/72;break;case"pc":case"em":ce=12;break;case"ex":ce=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ce=n}var gr=null;ee(),W();var Ze=h.__private__.getPageInfo=h.getPageInfo=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Wr[L].objId,pageNumber:L,pageContext:Wr[L]}},Kt=h.__private__.getPageInfoByObjId=function(L){if(isNaN(L)||L%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var le in Wr)if(Wr[le].objId===L)break;return Ze(le)},nt=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Wr[Y].objId,pageNumber:Y,pageContext:Wr[Y]}};h.addPage=function(){return Tr.apply(this,arguments),this},h.setPage=function(){return Yr.apply(this,arguments),ie.call(this,re[Y]),this},h.insertPage=function(L){return this.addPage(),this.movePage(Y,L),this},h.movePage=function(L,le){var Oe,dt;if(L>le){Oe=re[L],dt=Wr[L];for(var rt=L;rt>le;rt--)re[rt]=re[rt-1],Wr[rt]=Wr[rt-1];re[le]=Oe,Wr[le]=dt,this.setPage(le)}else if(L<le){Oe=re[L],dt=Wr[L];for(var Mt=L;Mt<le;Mt++)re[Mt]=re[Mt+1],Wr[Mt]=Wr[Mt+1];re[le]=Oe,Wr[le]=dt,this.setPage(le)}return this},h.deletePage=function(){return Kr.apply(this,arguments),this},h.__private__.text=h.text=function(L,le,Oe,dt,rt){var Mt,lr,en,bn,Dn,zn,hi,Ni,bi,Se=(dt=dt||{}).scope||this;if(typeof L=="number"&&typeof le=="number"&&(typeof Oe=="string"||Array.isArray(Oe))){var $e=Oe;Oe=le,le=L,L=$e}if(arguments[3]instanceof tt==0?(en=arguments[4],bn=arguments[5],Hi(hi=arguments[3])==="object"&&hi!==null||(typeof en=="string"&&(bn=en,en=null),typeof hi=="string"&&(bn=hi,hi=null),typeof hi=="number"&&(en=hi,hi=null),dt={flags:hi,angle:en,align:bn})):(M("The transform parameter of text() with a Matrix value"),bi=rt),isNaN(le)||isNaN(Oe)||L==null)throw new Error("Invalid arguments passed to jsPDF.text");if(L.length===0)return Se;var ot,We="",Nt=typeof dt.lineHeightFactor=="number"?dt.lineHeightFactor:xe,ur=Se.internal.scaleFactor;function zt(Ii){return Ii=Ii.split("	").join(Array(dt.TabLen||9).join(" ")),br(Ii,hi)}function Nr(Ii){for(var ea,Xa=Ii.concat(),_s=[],pd=Xa.length;pd--;)typeof(ea=Xa.shift())=="string"?_s.push(ea):Array.isArray(Ii)&&(ea.length===1||ea[1]===void 0&&ea[2]===void 0)?_s.push(ea[0]):_s.push([ea[0],ea[1],ea[2]]);return _s}function jr(Ii,ea){var Xa;if(typeof Ii=="string")Xa=ea(Ii)[0];else if(Array.isArray(Ii)){for(var _s,pd,Ng=Ii.concat(),up=[],Dy=Ng.length;Dy--;)typeof(_s=Ng.shift())=="string"?up.push(ea(_s)[0]):Array.isArray(_s)&&typeof _s[0]=="string"&&(pd=ea(_s[0],_s[1],_s[2]),up.push([pd[0],pd[1],pd[2]]));Xa=up}return Xa}var Ur=!1,Or=!0;if(typeof L=="string")Ur=!0;else if(Array.isArray(L)){var Gr=L.concat();lr=[];for(var zr,Qt=Gr.length;Qt--;)(typeof(zr=Gr.shift())!="string"||Array.isArray(zr)&&typeof zr[0]!="string")&&(Or=!1);Ur=Or}if(Ur===!1)throw new Error('Type of text must be string or Array. "'+L+'" is not recognized.');typeof L=="string"&&(L=L.match(/[\r?\n]/)?L.split(/\r\n|\r|\n/g):[L]);var mn=je/Se.internal.scaleFactor,ln=mn*(Nt-1);switch(dt.baseline){case"bottom":Oe-=ln;break;case"top":Oe+=mn-ln;break;case"hanging":Oe+=mn-2*ln;break;case"middle":Oe+=mn/2-ln}if((zn=dt.maxWidth||0)>0&&(typeof L=="string"?L=Se.splitTextToSize(L,zn):Object.prototype.toString.call(L)==="[object Array]"&&(L=L.reduce(function(Ii,ea){return Ii.concat(Se.splitTextToSize(ea,zn))},[]))),Mt={text:L,x:le,y:Oe,options:dt,mutex:{pdfEscape:br,activeFontKey:Ae,fonts:Ue,activeFontSize:je}},nn.publish("preProcessText",Mt),L=Mt.text,en=(dt=Mt.options).angle,bi instanceof tt==0&&en&&typeof en=="number"){en*=Math.PI/180,dt.rotationDirection===0&&(en=-en),S===w&&(en=-en);var _n=Math.cos(en),wn=Math.sin(en);bi=new tt(_n,wn,-wn,_n,0,0)}else en&&en instanceof tt&&(bi=en);S!==w||bi||(bi=kt),(Dn=dt.charSpace||Xe)!==void 0&&(We+=R(D(Dn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ni=dt.horizontalScale)!==void 0&&(We+=R(100*Ni)+` Tz
`),dt.lang;var pn=-1,oi=dt.renderingMode!==void 0?dt.renderingMode:dt.stroke,Fn=Se.internal.getCurrentPageInfo().pageContext;switch(oi){case 0:case!1:case"fill":pn=0;break;case 1:case!0:case"stroke":pn=1;break;case 2:case"fillThenStroke":pn=2;break;case 3:case"invisible":pn=3;break;case 4:case"fillAndAddForClipping":pn=4;break;case 5:case"strokeAndAddPathForClipping":pn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":pn=6;break;case 7:case"addToPathForClipping":pn=7}var pi=Fn.usedRenderingMode!==void 0?Fn.usedRenderingMode:-1;pn!==-1?We+=pn+` Tr
`:pi!==-1&&(We+=`0 Tr
`),pn!==-1&&(Fn.usedRenderingMode=pn),bn=dt.align||"left";var Xn,ca=je*Nt,Rl=Se.internal.pageSize.getWidth(),Ko=Ue[Ae];Dn=dt.charSpace||Xe,zn=dt.maxWidth||0,hi=Object.assign({autoencode:!0,noBOM:!0},dt.flags);var wo=[],So=function(Ii){return Se.getStringUnitWidth(Ii,{font:Ko,charSpace:Dn,fontSize:je,doKerning:!1})*je/ur};if(Object.prototype.toString.call(L)==="[object Array]"){var ws;lr=Nr(L),bn!=="left"&&(Xn=lr.map(So));var ba,cs=0;if(bn==="right"){le-=Xn[0],L=[],Qt=lr.length;for(var Bi=0;Bi<Qt;Bi++)Bi===0?(ba=Le(le),ws=Be(Oe)):(ba=D(cs-Xn[Bi]),ws=-ca),L.push([lr[Bi],ba,ws]),cs=Xn[Bi]}else if(bn==="center"){le-=Xn[0]/2,L=[],Qt=lr.length;for(var Aa=0;Aa<Qt;Aa++)Aa===0?(ba=Le(le),ws=Be(Oe)):(ba=D((cs-Xn[Aa])/2),ws=-ca),L.push([lr[Aa],ba,ws]),cs=Xn[Aa]}else if(bn==="left"){L=[],Qt=lr.length;for(var to=0;to<Qt;to++)L.push(lr[to])}else if(bn==="justify"&&Ko.encoding==="Identity-H"){L=[],Qt=lr.length,zn=zn!==0?zn:Rl;for(var Au=0,Ci=0;Ci<Qt;Ci++)if(ws=Ci===0?Be(Oe):-ca,ba=Ci===0?Le(le):Au,Ci<Qt-1){var $n=D((zn-Xn[Ci])/(lr[Ci].split(" ").length-1)),Yi=lr[Ci].split(" ");L.push([Yi[0]+" ",ba,ws]),Au=0;for(var Ss=1;Ss<Yi.length;Ss++){var hd=(So(Yi[Ss-1]+" "+Yi[Ss])-So(Yi[Ss]))*ur+$n;Ss==Yi.length-1?L.push([Yi[Ss],hd,0]):L.push([Yi[Ss]+" ",hd,0]),Au-=hd}}else L.push([lr[Ci],ba,ws]);L.push(["",Au,0])}else{if(bn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(L=[],Qt=lr.length,zn=zn!==0?zn:Rl,Ci=0;Ci<Qt;Ci++){ws=Ci===0?Be(Oe):-ca,ba=Ci===0?Le(le):0;var Xc=lr[Ci].split(" ").length-1,gc=Xc>0?(zn-Xn[Ci])/Xc:0;Ci<Qt-1?wo.push(R(D(gc))):wo.push(0),L.push([lr[Ci],ba,ws])}}}(typeof dt.R2L=="boolean"?dt.R2L:He)===!0&&(L=jr(L,function(Ii,ea,Xa){return[Ii.split("").reverse().join(""),ea,Xa]})),Mt={text:L,x:le,y:Oe,options:dt,mutex:{pdfEscape:br,activeFontKey:Ae,fonts:Ue,activeFontSize:je}},nn.publish("postProcessText",Mt),L=Mt.text,ot=Mt.mutex.isHex||!1;var xc=Ue[Ae].encoding;xc!=="WinAnsiEncoding"&&xc!=="StandardEncoding"||(L=jr(L,function(Ii,ea,Xa){return[zt(Ii),ea,Xa]})),lr=Nr(L),L=[];for(var Yo,ro,pl,yc=Array.isArray(lr[0])?1:0,Fl="",Bl=function(Ii,ea,Xa){var _s="";return Xa instanceof tt?(Xa=typeof dt.angle=="number"?st(Xa,new tt(1,0,0,1,Ii,ea)):st(new tt(1,0,0,1,Ii,ea),Xa),S===w&&(Xa=st(new tt(1,0,0,-1,0,0),Xa)),_s=Xa.join(" ")+` Tm
`):_s=R(Ii)+" "+R(ea)+` Td
`,_s},bc=0;bc<lr.length;bc++){switch(Fl="",yc){case 1:pl=(ot?"<":"(")+lr[bc][0]+(ot?">":")"),Yo=parseFloat(lr[bc][1]),ro=parseFloat(lr[bc][2]);break;case 0:pl=(ot?"<":"(")+lr[bc]+(ot?">":")"),Yo=Le(le),ro=Be(Oe)}wo!==void 0&&wo[bc]!==void 0&&(Fl=wo[bc]+` Tw
`),bc===0?L.push(Fl+Bl(Yo,ro,bi)+pl):yc===0?L.push(Fl+pl):yc===1&&L.push(Fl+Bl(Yo,ro,bi)+pl)}L=yc===0?L.join(` Tj
T* `):L.join(` Tj
`),L+=` Tj
`;var Nu=`BT
/`;return Nu+=Ae+" "+je+` Tf
`,Nu+=R(je*Nt)+` TL
`,Nu+=he+`
`,Nu+=We,Nu+=L,U(Nu+="ET"),p[Ae]=!0,Se};var bt=h.__private__.clip=h.clip=function(L){return U(L==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return bt("evenodd")},h.__private__.discardPath=h.discardPath=function(){return U("n"),this};var St=h.__private__.isValidStyle=function(L){var le=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(L)!==-1&&(le=!0),le};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(L){return St(L)&&(u=L),this};var Ct=h.__private__.getStyle=h.getStyle=function(L){var le=u;switch(L){case"D":case"S":le="S";break;case"F":le="f";break;case"FD":case"DF":le="B";break;case"f":case"f*":case"B":case"B*":le=L}return le},$t=h.close=function(){return U("h"),this};h.stroke=function(){return U("S"),this},h.fill=function(L){return Vt("f",L),this},h.fillEvenOdd=function(L){return Vt("f*",L),this},h.fillStroke=function(L){return Vt("B",L),this},h.fillStrokeEvenOdd=function(L){return Vt("B*",L),this};var Vt=function(L,le){Hi(le)==="object"?at(le,L):U(L)},Dt=function(L){L===null||S===w&&L===void 0||(L=Ct(L),U(L))};function ze(L,le,Oe,dt,rt){var Mt=new em(le||this.boundingBox,Oe||this.xStep,dt||this.yStep,this.gState,rt||this.matrix);Mt.stream=this.stream;var lr=L+"$$"+this.cloneIndex+++"$$";return jt(lr,Mt),Mt}var at=function(L,le){var Oe=yr[L.key],dt=Lt[Oe];if(dt instanceof Hh)U("q"),U(_t(le)),dt.gState&&h.setGState(dt.gState),U(L.matrix.toString()+" cm"),U("/"+Oe+" sh"),U("Q");else if(dt instanceof em){var rt=new tt(1,0,0,-1,0,on());L.matrix&&(rt=rt.multiply(L.matrix||kt),Oe=ze.call(dt,L.key,L.boundingBox,L.xStep,L.yStep,rt).id),U("q"),U("/Pattern cs"),U("/"+Oe+" scn"),dt.gState&&h.setGState(dt.gState),U(le),U("Q")}},_t=function(L){switch(L){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ft=h.moveTo=function(L,le){return U(R(D(L))+" "+R(G(le))+" m"),this},pr=h.lineTo=function(L,le){return U(R(D(L))+" "+R(G(le))+" l"),this},or=h.curveTo=function(L,le,Oe,dt,rt,Mt){return U([R(D(L)),R(G(le)),R(D(Oe)),R(G(dt)),R(D(rt)),R(G(Mt)),"c"].join(" ")),this};h.__private__.line=h.line=function(L,le,Oe,dt,rt){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(dt)||!St(rt))throw new Error("Invalid arguments passed to jsPDF.line");return S===v?this.lines([[Oe-L,dt-le]],L,le,[1,1],rt||"S"):this.lines([[Oe-L,dt-le]],L,le,[1,1]).stroke()},h.__private__.lines=h.lines=function(L,le,Oe,dt,rt,Mt){var lr,en,bn,Dn,zn,hi,Ni,bi,Se,$e,ot,We;if(typeof L=="number"&&(We=Oe,Oe=le,le=L,L=We),dt=dt||[1,1],Mt=Mt||!1,isNaN(le)||isNaN(Oe)||!Array.isArray(L)||!Array.isArray(dt)||!St(rt)||typeof Mt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ft(le,Oe),lr=dt[0],en=dt[1],Dn=L.length,$e=le,ot=Oe,bn=0;bn<Dn;bn++)(zn=L[bn]).length===2?($e=zn[0]*lr+$e,ot=zn[1]*en+ot,pr($e,ot)):(hi=zn[0]*lr+$e,Ni=zn[1]*en+ot,bi=zn[2]*lr+$e,Se=zn[3]*en+ot,$e=zn[4]*lr+$e,ot=zn[5]*en+ot,or(hi,Ni,bi,Se,$e,ot));return Mt&&$t(),Dt(rt),this},h.path=function(L){for(var le=0;le<L.length;le++){var Oe=L[le],dt=Oe.c;switch(Oe.op){case"m":Ft(dt[0],dt[1]);break;case"l":pr(dt[0],dt[1]);break;case"c":or.apply(this,dt);break;case"h":$t()}}return this},h.__private__.rect=h.rect=function(L,le,Oe,dt,rt){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(dt)||!St(rt))throw new Error("Invalid arguments passed to jsPDF.rect");return S===v&&(dt=-dt),U([R(D(L)),R(G(le)),R(D(Oe)),R(D(dt)),"re"].join(" ")),Dt(rt),this},h.__private__.triangle=h.triangle=function(L,le,Oe,dt,rt,Mt,lr){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(dt)||isNaN(rt)||isNaN(Mt)||!St(lr))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Oe-L,dt-le],[rt-Oe,Mt-dt],[L-rt,le-Mt]],L,le,[1,1],lr,!0),this},h.__private__.roundedRect=h.roundedRect=function(L,le,Oe,dt,rt,Mt,lr){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(dt)||isNaN(rt)||isNaN(Mt)||!St(lr))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var en=4/3*(Math.SQRT2-1);return rt=Math.min(rt,.5*Oe),Mt=Math.min(Mt,.5*dt),this.lines([[Oe-2*rt,0],[rt*en,0,rt,Mt-Mt*en,rt,Mt],[0,dt-2*Mt],[0,Mt*en,-rt*en,Mt,-rt,Mt],[2*rt-Oe,0],[-rt*en,0,-rt,-Mt*en,-rt,-Mt],[0,2*Mt-dt],[0,-Mt*en,rt*en,-Mt,rt,-Mt]],L+rt,le,[1,1],lr,!0),this},h.__private__.ellipse=h.ellipse=function(L,le,Oe,dt,rt){if(isNaN(L)||isNaN(le)||isNaN(Oe)||isNaN(dt)||!St(rt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Mt=4/3*(Math.SQRT2-1)*Oe,lr=4/3*(Math.SQRT2-1)*dt;return Ft(L+Oe,le),or(L+Oe,le-lr,L+Mt,le-dt,L,le-dt),or(L-Mt,le-dt,L-Oe,le-lr,L-Oe,le),or(L-Oe,le+lr,L-Mt,le+dt,L,le+dt),or(L+Mt,le+dt,L+Oe,le+lr,L+Oe,le),Dt(rt),this},h.__private__.circle=h.circle=function(L,le,Oe,dt){if(isNaN(L)||isNaN(le)||isNaN(Oe)||!St(dt))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(L,le,Oe,Oe,dt)},h.setFont=function(L,le,Oe){return Oe&&(le=A(le,Oe)),Ae=hr(L,le,{disableWarning:!1}),this};var Xt=h.__private__.getFont=h.getFont=function(){return Ue[hr.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var L,le,Oe={};for(L in It)if(It.hasOwnProperty(L))for(le in Oe[L]=[],It[L])It[L].hasOwnProperty(le)&&Oe[L].push(le);return Oe},h.addFont=function(L,le,Oe,dt,rt){var Mt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Mt.indexOf(arguments[3])!==-1?rt=arguments[3]:arguments[3]&&Mt.indexOf(arguments[3])==-1&&(Oe=A(Oe,dt)),wr.call(this,L,le,Oe,rt=rt||"Identity-H")};var xe,Ee=e.lineWidth||.200025,De=h.__private__.getLineWidth=h.getLineWidth=function(){return Ee},gt=h.__private__.setLineWidth=h.setLineWidth=function(L){return Ee=L,U(R(D(L))+" w"),this};h.__private__.setLineDash=Rn.API.setLineDash=Rn.API.setLineDashPattern=function(L,le){if(L=L||[],le=le||0,isNaN(le)||!Array.isArray(L))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return L=L.map(function(Oe){return R(D(Oe))}).join(" "),le=R(D(le)),U("["+L+"] "+le+" d"),this};var vr=h.__private__.getLineHeight=h.getLineHeight=function(){return je*xe};h.__private__.getLineHeight=h.getLineHeight=function(){return je*xe};var Je=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(L){return typeof(L=L||1.15)=="number"&&(xe=L),this},Ut=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return xe};Je(e.lineHeight);var Le=h.__private__.getHorizontalCoordinate=function(L){return D(L)},Be=h.__private__.getVerticalCoordinate=function(L){return S===w?L:Wr[Y].mediaBox.topRightY-Wr[Y].mediaBox.bottomLeftY-D(L)},Et=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(L){return R(Le(L))},pt=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(L){return R(Be(L))},yt=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ye(yt)},h.__private__.setStrokeColor=h.setDrawColor=function(L,le,Oe,dt){return yt=Ce({ch1:L,ch2:le,ch3:Oe,ch4:dt,pdfColorType:"draw",precision:2}),U(yt),this};var ft=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ye(ft)},h.__private__.setFillColor=h.setFillColor=function(L,le,Oe,dt){return ft=Ce({ch1:L,ch2:le,ch3:Oe,ch4:dt,pdfColorType:"fill",precision:2}),U(ft),this};var he=e.textColor||"0 g",Ne=h.__private__.getTextColor=h.getTextColor=function(){return ye(he)};h.__private__.setTextColor=h.setTextColor=function(L,le,Oe,dt){return he=Ce({ch1:L,ch2:le,ch3:Oe,ch4:dt,pdfColorType:"text",precision:3}),this};var Xe=e.charSpace,At=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Xe||0)};h.__private__.setCharSpace=h.setCharSpace=function(L){if(isNaN(L))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Xe=L,this};var Lr=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(L){var le=h.CapJoinStyles[L];if(le===void 0)throw new Error("Line cap style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Lr=le,U(le+" J"),this};var xr=0;h.__private__.setLineJoin=h.setLineJoin=function(L){var le=h.CapJoinStyles[L];if(le===void 0)throw new Error("Line join style of '"+L+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return xr=le,U(le+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(L){if(L=L||0,isNaN(L))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return U(R(D(L))+" M"),this},h.GState=K2,h.setGState=function(L){(L=typeof L=="string"?Ar[Tt[L]]:$r(null,L)).equals(Vr)||(U("/"+L.id+" gs"),Vr=L)};var $r=function(L,le){if(!L||!Tt[L]){var Oe=!1;for(var dt in Ar)if(Ar.hasOwnProperty(dt)&&Ar[dt].equals(le)){Oe=!0;break}if(Oe)le=Ar[dt];else{var rt="GS"+(Object.keys(Ar).length+1).toString(10);Ar[rt]=le,le.id=rt}return L&&(Tt[L]=le.id),nn.publish("addGState",le),le}};h.addGState=function(L,le){return $r(L,le),this},h.saveGraphicsState=function(){return U("q"),ht.push({key:Ae,size:je,color:he}),this},h.restoreGraphicsState=function(){U("Q");var L=ht.pop();return Ae=L.key,je=L.size,he=L.color,Vr=null,this},h.setCurrentTransformationMatrix=function(L){return U(L.toString()+" cm"),this},h.comment=function(L){return U("#"+L),this};var Dr=function(L,le){var Oe=L||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Oe},set:function(Mt){isNaN(Mt)||(Oe=parseFloat(Mt))}});var dt=le||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return dt},set:function(Mt){isNaN(Mt)||(dt=parseFloat(Mt))}});var rt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return rt},set:function(Mt){rt=Mt.toString()}}),this},cn=function(L,le,Oe,dt){Dr.call(this,L,le),this.type="rect";var rt=Oe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return rt},set:function(lr){isNaN(lr)||(rt=parseFloat(lr))}});var Mt=dt||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Mt},set:function(lr){isNaN(lr)||(Mt=parseFloat(lr))}}),this},hn=function(){this.page=Br,this.currentPage=Y,this.pages=re.slice(0),this.pagesContext=Wr.slice(0),this.x=be,this.y=mt,this.matrix=et,this.width=ir(Y),this.height=vn(Y),this.outputDestination=I,this.id="",this.objectNumber=-1};hn.prototype.restore=function(){Br=this.page,Y=this.currentPage,Wr=this.pagesContext,re=this.pages,be=this.x,mt=this.y,et=this.matrix,Qr(Y,this.width),Kn(Y,this.height),I=this.outputDestination};var yn=function(L,le,Oe,dt,rt){Te.push(new hn),Br=Y=0,re=[],be=L,mt=le,et=rt,cr([Oe,dt])};for(var sn in h.beginFormObject=function(L,le,Oe,dt,rt){return yn(L,le,Oe,dt,rt),this},h.endFormObject=function(L){return function(le){if(dn[le])Te.pop().restore();else{var Oe=new hn,dt="Xo"+(Object.keys(Ir).length+1).toString(10);Oe.id=dt,dn[le]=dt,Ir[dt]=Oe,nn.publish("addFormObject",Oe),Te.pop().restore()}}(L),this},h.doFormObject=function(L,le){var Oe=Ir[dn[L]];return U("q"),U(le.toString()+" cm"),U("/"+Oe.id+" Do"),U("Q"),this},h.getFormObject=function(L){var le=Ir[dn[L]];return{x:le.x,y:le.y,width:le.width,height:le.height,matrix:le.matrix}},h.save=function(L,le){return L=L||"generated.pdf",(le=le||{}).returnPromise=le.returnPromise||!1,le.returnPromise===!1?($h(Ht(ct()),L),typeof $h.unload=="function"&&Yn.setTimeout&&setTimeout($h.unload,911),this):new Promise(function(Oe,dt){try{var rt=$h(Ht(ct()),L);typeof $h.unload=="function"&&Yn.setTimeout&&setTimeout($h.unload,911),Oe(rt)}catch(Mt){dt(Mt.message)}})},Rn.API)Rn.API.hasOwnProperty(sn)&&(sn==="events"&&Rn.API.events.length?function(L,le){var Oe,dt,rt;for(rt=le.length-1;rt!==-1;rt--)Oe=le[rt][0],dt=le[rt][1],L.subscribe.apply(L,[Oe].concat(typeof dt=="function"?[dt]:dt))}(nn,Rn.API.events):h[sn]=Rn.API[sn]);function ir(L){return Wr[L].mediaBox.topRightX-Wr[L].mediaBox.bottomLeftX}function Qr(L,le){Wr[L].mediaBox.topRightX=le+Wr[L].mediaBox.bottomLeftX}function vn(L){return Wr[L].mediaBox.topRightY-Wr[L].mediaBox.bottomLeftY}function Kn(L,le){Wr[L].mediaBox.topRightY=le+Wr[L].mediaBox.bottomLeftY}var Bn=h.getPageWidth=function(L){return ir(L=L||Y)/ce},ri=h.setPageWidth=function(L,le){Qr(L,le*ce)},on=h.getPageHeight=function(L){return vn(L=L||Y)/ce},Un=h.setPageHeight=function(L,le){Kn(L,le*ce)};return h.internal={pdfEscape:br,getStyle:Ct,getFont:Xt,getFontSize:_e,getCharSpace:At,getTextColor:Ne,getLineHeight:vr,getLineHeightFactor:Ut,getLineWidth:De,write:Z,getHorizontalCoordinate:Le,getVerticalCoordinate:Be,getCoordinateString:Et,getVerticalCoordinateString:pt,collections:{},newObject:tr,newAdditionalObject:ue,newObjectDeferred:Er,newObjectDeferredBegin:se,getFilters:wt,putStream:Qe,events:nn,scaleFactor:ce,pageSize:{getWidth:function(){return Bn(Y)},setWidth:function(L){ri(Y,L)},getHeight:function(){return on(Y)},setHeight:function(L){Un(Y,L)}},encryptionOptions:d,encryption:gr,getEncryptor:function(L){return d!==null?gr.encryptor(L,0):function(le){return le}},output:fr,getNumberOfPages:xn,get pages(){return re},out:U,f2:E,f3:P,getPageInfo:Ze,getPageInfoByObjId:Kt,getCurrentPageInfo:nt,getPDFVersion:g,Point:Dr,Rectangle:cn,Matrix:tt,hasHotfix:Sr},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Bn(Y)},set:function(L){ri(Y,L)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return on(Y)},set:function(L){Un(Y,L)},enumerable:!0,configurable:!0}),(function(L){for(var le=0,Oe=Pe.length;le<Oe;le++){var dt=wr.call(this,L[le][0],L[le][1],L[le][2],Pe[le][3],!0);f===!1&&(p[dt]=!0);var rt=L[le][0].split("-");Zt({id:dt,fontName:rt[0],fontStyle:rt[1]||""})}nn.publish("addFonts",{fonts:Ue,dictionary:It})}).call(h,Pe),Ae="F1",Tr(i,r),nn.publish("initialized"),h}Rp.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Rp.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Rp.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Rp.prototype.processOwnerPassword=function(e,t){return nA(rA(t).substr(0,5),e)},Rp.prototype.encryptor=function(e,t){var r=rA(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return nA(r,n)}},K2.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Hi(e)!==Hi(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},Rn.API={events:[]},Rn.version="4.1.0";var $a=Rn.API,bC=1,rp=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xp=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Y2=function(e){return e.toString().replace(/#/g,"#23").replace(/[\s\n\r()<>[\]{}\/%]/g,function(t){var r=t.charCodeAt(0).toString(16).toUpperCase();return"#"+(r.length===1?"0"+r:r)})},Zn=function(e){return e.toFixed(2)},Ef=function(e){return e.toFixed(5)};$a.__acroform__={};var Ml=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},aM=function(e){return e*bC},$u=function(e){var t=new Lz,r=En.internal.getHeight(e)||0,n=En.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Zn(n)),Number(Zn(r))],t},Sge=$a.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},_ge=$a.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},jge=$a.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},rs=$a.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return jge(e,t-1)},ns=$a.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Sge(e,t-1)},is=$a.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return _ge(e,t-1)},kge=$a.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],s=e[1],o=e[2],l=e[3],c={};return c.lowerLeft_X=r(i)||0,c.lowerLeft_Y=n(s+l)||0,c.upperRight_X=r(i+o)||0,c.upperRight_Y=n(s)||0,[Number(Zn(c.lowerLeft_X)),Number(Zn(c.lowerLeft_Y)),Number(Zn(c.upperRight_X)),Number(Zn(c.upperRight_Y))]},Age=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=iA(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Zn(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=$u(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},iA=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(E){return E.split(`
`)}):i.map(function(E){return[E]});var s=r,o=En.internal.getHeight(e)||0;o=o<0?-o:o;var l=En.internal.getWidth(e)||0;l=l<0?-l:l;var c=function(E,P,D){if(E+1<i.length){var G=P+" "+i[E+1][0];return Bb(G,e,D).width<=l-4}return!1};s++;e:for(;s>0;){t="",s--;var u,d,f=Bb("3",e,s).height,p=e.multiline?o-s:(o-f)/2,h=p+=2,m=0,g=0,y=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Bb(t,e,s=12).width+", FieldWidth:"+l+`
`;break}for(var b="",v=0,w=0;w<i.length;w++)if(i.hasOwnProperty(w)){var S=!1;if(i[w].length!==1&&y!==i[w].length-1){if((f+2)*(v+2)+2>o)continue e;b+=i[w][y],S=!0,g=w,w--}else{b=(b+=i[w][y]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var j=parseInt(w),k=c(j,b,s),A=w>=i.length-1;if(k&&!A){b+=" ",y=0;continue}if(k||A){if(A)g=j;else if(e.multiline&&(f+2)*(v+2)+2>o)continue e}else{if(!e.multiline||(f+2)*(v+2)+2>o)continue e;g=j}}for(var R="",M=m;M<=g;M++){var B=i[M];if(e.multiline){if(M===g){R+=B[y]+" ",y=(y+1)%B.length;continue}if(M===m){R+=B[B.length-1]+" ";continue}}R+=B[0]+" "}switch(R=R.substr(R.length-1)==" "?R.substr(0,R.length-1):R,d=Bb(R,e,s).width,e.textAlign){case"right":u=l-d-2;break;case"center":u=(l-d)/2;break;default:u=2}t+=Zn(u)+" "+Zn(h)+` Td
`,t+="("+rp(R)+`) Tj
`,t+=-Zn(u)+` 0 Td
`,h=-(s+2),d=0,m=S?g:g+1,v++,b=""}break}return n.text=t,n.fontSize=s,n},Bb=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},Nge={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Cge=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Ege=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(_u.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Nge)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");bC=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Rz,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var s=n[i];s.objId=void 0,s.hasAnnotation&&Cge(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var s=!n;for(var o in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var l=n[o],c=[],u=l.Rect;if(l.Rect&&(l.Rect=kge(l.Rect,i)),i.internal.newObjectDeferredBegin(l.objId,!0),l.DA=En.createDefaultAppearanceStream(l),Hi(l)==="object"&&typeof l.getKeyValueListForStream=="function"&&(c=l.getKeyValueListForStream()),l.Rect=u,l.hasAppearanceStream&&!l.appearanceStreamContent){var d=Age(l);c.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(l.appearanceStreamContent){var f="";for(var p in l.appearanceStreamContent)if(l.appearanceStreamContent.hasOwnProperty(p)){var h=l.appearanceStreamContent[p];if(f+="/"+p+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var o in h)if(h.hasOwnProperty(o)){var m=h[o];typeof m=="function"&&(m=m.call(i,l)),f+="/"+o+" "+m+" ",i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(i,l)),f+="/"+o+" "+m,i.internal.acroformPlugin.xForms.indexOf(m)>=0||i.internal.acroformPlugin.xForms.push(m);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}i.internal.putStream({additionalKeyValues:c,objectId:l.objId}),i.internal.out("endobj")}s&&function(g,y){for(var b in g)if(g.hasOwnProperty(b)){var v=b,w=g[b];y.internal.newObjectDeferredBegin(w.objId,!0),Hi(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[v]}}(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},Mz=$a.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(o){return o};if(Array.isArray(e)){for(var i="[",s=0;s<e.length;s++)switch(s!==0&&(i+=" "),Hi(e[s])){case"boolean":case"number":case"object":i+=e[s].toString();break;case"string":e[s].substr(0,1)==="/"?i+="/"+Y2(e[s].substr(1)):(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+rp(n(e[s].toString()))+")")}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Aj=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+rp(n(e))+")"},Yu=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Yu.prototype.toString=function(){return this.objId+" 0 R"},Yu.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Yu.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:Mz(i,this.objId,this.scope)}):i instanceof Yu?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var Lz=function(){Yu.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ml(Lz,Yu);var Rz=function(){Yu.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+rp(r(e))+")"}},set:function(r){e=r}})};Ml(Rz,Yu);var _u=function e(){Yu.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');t=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!rs(t,3)},set:function(b){b?this.F=ns(t,3):this.F=is(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof X2)return;s="FieldObject"+e.FieldNum++}var b=function(v){return v};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+rp(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/bC:u},set:function(b){u=b}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(b){d=b}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof X2||this instanceof u0))return Aj(f,this.objId,this.scope)},set:function(b){b=b.toString(),f=b}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Vs==0?Aj(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof Vs==0?b.substr(0,1)==="("?xp(b.substr(1,b.length-2)):xp(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Vs==1?xp(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof Vs==1?"/"+Y2(b):b}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Vs==0?Aj(h,this.objId,this.scope):h},set:function(b){b=b.toString(),h=this instanceof Vs==0?b.substr(0,1)==="("?xp(b.substr(1,b.length-2)):xp(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Vs==1?xp(h.substr(1,h.length-1)):h},set:function(b){b=b.toString(),h=this instanceof Vs==1?"/"+Y2(b):b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(b){b=!!b,g=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(b){m=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,1)},set:function(b){b?this.Ff=ns(this.Ff,1):this.Ff=is(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,2)},set:function(b){b?this.Ff=ns(this.Ff,2):this.Ff=is(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,3)},set:function(b){b?this.Ff=ns(this.Ff,3):this.Ff=is(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');y=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(y){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Ml(_u,Yu);var xm=function(){_u.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Mz(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(s,o,l){l||(l=1);for(var c,u=[];c=o.exec(s);)u.push(c[l]);return u}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,18)},set:function(r){r?this.Ff=ns(this.Ff,18):this.Ff=is(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=ns(this.Ff,19):this.Ff=is(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,20)},set:function(r){r?(this.Ff=ns(this.Ff,20),t.sort()):this.Ff=is(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,22)},set:function(r){r?this.Ff=ns(this.Ff,22):this.Ff=is(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(r){r?this.Ff=ns(this.Ff,23):this.Ff=is(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,27)},set:function(r){r?this.Ff=ns(this.Ff,27):this.Ff=is(this.Ff,27)}}),this.hasAppearanceStream=!1};Ml(xm,_u);var ym=function(){xm.call(this),this.fontName="helvetica",this.combo=!1};Ml(ym,xm);var bm=function(){ym.call(this),this.combo=!0};Ml(bm,ym);var zv=function(){bm.call(this),this.edit=!0};Ml(zv,bm);var Vs=function(){_u.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,15)},set:function(r){r?this.Ff=ns(this.Ff,15):this.Ff=is(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,16)},set:function(r){r?this.Ff=ns(this.Ff,16):this.Ff=is(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,17)},set:function(r){r?this.Ff=ns(this.Ff,17):this.Ff=is(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(r){r?this.Ff=ns(this.Ff,26):this.Ff=is(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+rp(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){Hi(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+Y2(r)}})};Ml(Vs,_u);var Wv=function(){Vs.call(this),this.pushButton=!0};Ml(Wv,Vs);var vm=function(){Vs.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ml(vm,Vs);var X2=function(){var e,t;_u.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(l){return l};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),n)o.push("/"+s+" ("+rp(i(n[s]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Hi(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=En.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ml(X2,_u),vm.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},vm.prototype.createOption=function(e){var t=new X2;return t.Parent=this,t.optionName=e,this.Kids.push(t),Tge.call(this.scope,t),t};var qv=function(){Vs.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=En.CheckBox.createAppearanceStream()};Ml(qv,Vs);var u0=function(){_u.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,13)},set:function(t){t?this.Ff=ns(this.Ff,13):this.Ff=is(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,21)},set:function(t){t?this.Ff=ns(this.Ff,21):this.Ff=is(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,23)},set:function(t){t?this.Ff=ns(this.Ff,23):this.Ff=is(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,24)},set:function(t){t?this.Ff=ns(this.Ff,24):this.Ff=is(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,25)},set:function(t){t?this.Ff=ns(this.Ff,25):this.Ff=is(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,26)},set:function(t){t?this.Ff=ns(this.Ff,26):this.Ff=is(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ml(u0,_u);var Hv=function(){u0.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!rs(this.Ff,14)},set:function(e){e?this.Ff=ns(this.Ff,14):this.Ff=is(this.Ff,14)}}),this.password=!0};Ml(Hv,u0);var En={CheckBox:{createAppearanceStream:function(){return{N:{On:En.CheckBox.YesNormal},D:{On:En.CheckBox.YesPushDown,Off:En.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),s=iA(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Zn(En.internal.getWidth(e))+" "+Zn(En.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Zn(s.fontSize)+" Tf "+i),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=$u(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],s=En.internal.getHeight(e),o=En.internal.getWidth(e),l=iA(e,e.caption);return i.push("1 g"),i.push("0 0 "+Zn(o)+" "+Zn(s)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Zn(o-1)+" "+Zn(s-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Zn(l.fontSize)+" Tf "+n),i.push(l.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zn(En.internal.getWidth(e))+" "+Zn(En.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:En.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=En.RadioButton.Circle.YesNormal,t.D[e]=En.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=En.internal.getWidth(e)<=En.internal.getHeight(e)?En.internal.getWidth(e)/4:En.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=En.internal.Bezier_C,s=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ef(En.internal.getWidth(e)/2)+" "+Ef(En.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=En.internal.getWidth(e)<=En.internal.getHeight(e)?En.internal.getWidth(e)/4:En.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*En.internal.Bezier_C).toFixed(5)),o=Number((n*En.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ef(En.internal.getWidth(e)/2)+" "+Ef(En.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ef(En.internal.getWidth(e)/2)+" "+Ef(En.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=En.internal.getWidth(e)<=En.internal.getHeight(e)?En.internal.getWidth(e)/4:En.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),s=Number((i*En.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ef(En.internal.getWidth(e)/2)+" "+Ef(En.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+s+" "+s+" "+i+" 0 "+i+" c"),r.push("-"+s+" "+i+" -"+i+" "+s+" -"+i+" 0 c"),r.push("-"+i+" -"+s+" -"+s+" -"+i+" 0 -"+i+" c"),r.push(s+" -"+i+" "+i+" -"+s+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:En.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=En.RadioButton.Cross.YesNormal,t.D[e]=En.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=$u(e);t.scope=e.scope;var r=[],n=En.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Zn(En.internal.getWidth(e)-2)+" "+Zn(En.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Zn(n.x1.x)+" "+Zn(n.x1.y)+" m"),r.push(Zn(n.x2.x)+" "+Zn(n.x2.y)+" l"),r.push(Zn(n.x4.x)+" "+Zn(n.x4.y)+" m"),r.push(Zn(n.x3.x)+" "+Zn(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=En.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Zn(En.internal.getWidth(e))+" "+Zn(En.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Zn(En.internal.getWidth(e)-2)+" "+Zn(En.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Zn(r.x1.x)+" "+Zn(r.x1.y)+" m"),n.push(Zn(r.x2.x)+" "+Zn(r.x2.y)+" l"),n.push(Zn(r.x4.x)+" "+Zn(r.x4.y)+" m"),n.push(Zn(r.x3.x)+" "+Zn(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=$u(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Zn(En.internal.getWidth(e))+" "+Zn(En.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};En.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=En.internal.getWidth(e),r=En.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},En.internal.getWidth=function(e){var t=0;return Hi(e)==="object"&&(t=aM(e.Rect[2])),t},En.internal.getHeight=function(e){var t=0;return Hi(e)==="object"&&(t=aM(e.Rect[3])),t};var Tge=$a.addField=function(e){if(Ege(this,e),!(e instanceof _u))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};$a.AcroFormChoiceField=xm,$a.AcroFormListBox=ym,$a.AcroFormComboBox=bm,$a.AcroFormEditBox=zv,$a.AcroFormButton=Vs,$a.AcroFormPushButton=Wv,$a.AcroFormRadioButton=vm,$a.AcroFormCheckBox=qv,$a.AcroFormTextField=u0,$a.AcroFormPasswordField=Hv,$a.AcroFormAppearance=En,$a.AcroForm={ChoiceField:xm,ListBox:ym,ComboBox:bm,EditBox:zv,Button:Vs,PushButton:Wv,RadioButton:vm,CheckBox:qv,TextField:u0,PasswordField:Hv,Appearance:En},Rn.AcroForm={ChoiceField:xm,ListBox:ym,ComboBox:bm,EditBox:zv,Button:Vs,PushButton:Wv,RadioButton:vm,CheckBox:qv,TextField:u0,PasswordField:Hv,Appearance:En};Rn.AcroForm;function Fz(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(E,P){var D,G,H,oe,de,W=r;if((P=P||r)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(k(E))for(de in n)for(H=n[de],D=0;D<H.length;D+=1){for(oe=!0,G=0;G<H[D].length;G+=1)if(H[D][G]!==void 0&&H[D][G]!==E[G]){oe=!1;break}if(oe===!0){W=de;break}}else for(de in n)for(H=n[de],D=0;D<H.length;D+=1){for(oe=!0,G=0;G<H[D].length;G+=1)if(H[D][G]!==void 0&&H[D][G]!==E.charCodeAt(G)){oe=!1;break}if(oe===!0){W=de;break}}return W===r&&P!==r&&(W=P),W},s=function E(P){for(var D=this.internal.write,G=this.internal.putStream,H=(0,this.internal.getFilters)();H.indexOf("FlateEncode")!==-1;)H.splice(H.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var oe=[];if(oe.push({key:"Type",value:"/XObject"}),oe.push({key:"Subtype",value:"/Image"}),oe.push({key:"Width",value:P.width}),oe.push({key:"Height",value:P.height}),P.colorSpace===b.INDEXED?oe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(oe.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===b.DEVICE_CMYK&&oe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),oe.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&oe.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var de="",W=0,V=P.transparency.length;W<V;W++)de+=P.transparency[W]+" "+P.transparency[W]+" ";oe.push({key:"Mask",value:"["+de+"]"})}P.sMask!==void 0&&oe.push({key:"SMask",value:P.objectId+1+" 0 R"});var ae=P.filter!==void 0?["/"+P.filter]:void 0;if(G({data:P.data,additionalKeyValues:oe,alreadyAppliedFilters:ae,objectId:P.objectId}),D("endobj"),"sMask"in P&&P.sMask!==void 0){var ee,C=(ee=P.sMaskBitsPerComponent)!==null&&ee!==void 0?ee:P.bitsPerComponent,Y={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:C,data:P.sMask};"filter"in P&&(Y.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(C," /Columns ").concat(P.width),Y.filter=P.filter),E.call(this,Y)}if(P.colorSpace===b.INDEXED){var q=this.internal.newObject();G({data:R(new Uint8Array(P.palette)),objectId:q}),D("endobj")}},o=function(){var E=this.internal.collections[t+"images"];for(var P in E)s.call(this,E[P])},l=function(){var E,P=this.internal.collections[t+"images"],D=this.internal.write;for(var G in P)D("/I"+(E=P[G]).index,E.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",o),this.internal.events.subscribe("putXobjectDict",l))},u=function(){var E=this.internal.collections[t+"images"];return c.call(this),E},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(E){return typeof e["process"+E.toUpperCase()]=="function"},p=function(E){return Hi(E)==="object"&&E.nodeType===1},h=function(E,P){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var D=""+E.getAttribute("src");if(D.indexOf("data:image/")===0)return Uv(unescape(D).split("base64,").pop());var G=e.loadFile(D,!0);if(G!==void 0)return G}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var H;switch(P){case"PNG":H="image/png";break;case"WEBP":H="image/webp";break;default:H="image/jpeg"}return Uv(E.toDataURL(H,1).split("base64,").pop())}},m=function(E){var P=this.internal.collections[t+"images"];if(P){for(var D in P)if(E===P[D].alias)return P[D]}},g=function(E,P,D){return E||P||(E=-96,P=-96),E<0&&(E=-1*D.width*72/E/this.internal.scaleFactor),P<0&&(P=-1*D.height*72/P/this.internal.scaleFactor),E===0&&(E=P*D.width/D.height),P===0&&(P=E*D.height/D.width),[E,P]},y=function(E,P,D,G,H,oe){var de=g.call(this,D,G,H),W=this.internal.getCoordinateString,V=this.internal.getVerticalCoordinateString,ae=u.call(this);if(D=de[0],G=de[1],ae[H.index]=H,oe){oe*=Math.PI/180;var ee=Math.cos(oe),C=Math.sin(oe),Y=function(O){return O.toFixed(4)},q=[Y(ee),Y(C),Y(-1*C),Y(ee),0,0,"cm"]}this.internal.write("q"),oe?(this.internal.write([1,"0","0",1,W(E),V(P+G),"cm"].join(" ")),this.internal.write(q.join(" ")),this.internal.write([W(D),"0","0",W(G),"0","0","cm"].join(" "))):this.internal.write([W(D),"0","0",W(G),W(E),V(P+G),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+H.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var v=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(E){var P,D,G=0;if(typeof E=="string")for(D=E.length,P=0;P<D;P++)G=(G<<5)-G+E.charCodeAt(P),G|=0;else if(k(E))for(D=E.byteLength/2,P=0;P<D;P++)G=(G<<5)-G+E[P],G|=0;return G},S=e.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var P=!0;return E.length===0&&(P=!1),E.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(P=!1),P},j=e.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var P=E.indexOf(",");return P<0?null:E.substring(0,P).trim().endsWith("base64")?E.substring(P+1):null};e.__addimage__.isArrayBuffer=function(E){return E instanceof ArrayBuffer};var k=e.__addimage__.isArrayBufferView=function(E){return E instanceof Int8Array||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array},A=e.__addimage__.binaryStringToUint8Array=function(E){for(var P=E.length,D=new Uint8Array(P),G=0;G<P;G++)D[G]=E.charCodeAt(G);return D},R=e.__addimage__.arrayBufferToBinaryString=function(E){for(var P="",D=k(E)?E:new Uint8Array(E),G=0;G<D.length;G+=8192)P+=String.fromCharCode.apply(null,D.subarray(G,G+8192));return P};e.addImage=function(){var E,P,D,G,H,oe,de,W,V;if(typeof arguments[1]=="number"?(P=r,D=arguments[1],G=arguments[2],H=arguments[3],oe=arguments[4],de=arguments[5],W=arguments[6],V=arguments[7]):(P=arguments[1],D=arguments[2],G=arguments[3],H=arguments[4],oe=arguments[5],de=arguments[6],W=arguments[7],V=arguments[8]),Hi(E=arguments[0])==="object"&&!p(E)&&"imageData"in E){var ae=E;E=ae.imageData,P=ae.format||P||r,D=ae.x||D||0,G=ae.y||G||0,H=ae.w||ae.width||H,oe=ae.h||ae.height||oe,de=ae.alias||de,W=ae.compression||W,V=ae.rotation||ae.angle||V}var ee=this.internal.getFilters();if(W===void 0&&ee.indexOf("FlateEncode")!==-1&&(W="SLOW"),isNaN(D)||isNaN(G))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var C=M.call(this,E,P,de,W);return y.call(this,D,G,H,oe,C,V),this};var M=function(E,P,D,G){var H,oe,de;if(typeof E=="string"&&i(E)===r){E=unescape(E);var W=B(E,!1);(W!==""||(W=e.loadFile(E,!0))!==void 0)&&(E=W)}if(p(E)&&(E=h(E,P)),P=i(E,P),!f(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((de=D)==null||de.length===0)&&(D=function(V){return typeof V=="string"||k(V)?w(V):k(V.data)?w(V.data):null}(E)),(H=m.call(this,D))||(E instanceof Uint8Array||P==="RGBA"||(oe=E,E=A(E)),H=this["process"+P.toUpperCase()](E,d.call(this),D,function(V){return V&&typeof V=="string"&&(V=V.toUpperCase()),V in e.image_compression?V:v.NONE}(G),oe)),!H)throw new Error("An unknown error occurred whilst processing the image.");return H},B=e.__addimage__.convertBase64ToBinaryString=function(E,P){P=typeof P!="boolean"||P;var D,G="";if(typeof E=="string"){var H;D=(H=j(E))!==null&&H!==void 0?H:E;try{G=Uv(D)}catch(oe){if(P)throw S(D)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+oe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return G};e.getImageProperties=function(E){var P,D,G="";if(p(E)&&(E=h(E)),typeof E=="string"&&i(E)===r&&((G=B(E,!1))===""&&(G=e.loadFile(E)||""),E=G),D=i(E),!f(D))throw new Error("addImage does not support files of type '"+D+"', please ensure that a plugin for '"+D+"' support is added.");if(E instanceof Uint8Array||(E=A(E)),!(P=this["process"+D.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=D,P}})(Rn.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};Rn.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,s,o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){n=u[p];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(g.objId),v=n.title||"Note";s="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y)+"] ")+"/Contents ("+h(b(n.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+c.objId+" 0 R",s+=" /T ("+h(b(v))+") >>",g.content=s;var w=g.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(n.bounds.x+30)+" "+l(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+l(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":i="/Rect ["+o(n.bounds.x)+" "+l(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+l(n.bounds.y+n.bounds.h)+"] ";var S=n.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+h(m(n.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(n.options.name){var j=this.annotations._nameMap[n.options.name];n.options.pageNumber=j.page,n.options.top=j.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",s="",n.options.url)s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,s+=" /FitV "+n.options.left+"]";break;default:var k=l(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),s+=" /XYZ "+n.options.left+" "+k+" "+n.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,s,o){var l=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;l.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+i),h:u(n+s)},options:o,type:"link"})},e.textWithLink=function(r,n,i,s){var o,l,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){l=s.maxWidth;var d=this.splitTextToSize(r,l).length;o=Math.ceil(u*d)}else l=c,o=u;return this.text(r,n,i,s),i+=.2*u,s.align==="center"&&(n-=c/2),s.align==="right"&&(n-=c),this.link(n,i-u,l,o,s),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(Rn.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},l=e.__arabicParser__.isArabicEndLetter=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return o(g)&&i.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return o(g)&&s(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,b=r,v="",w=0;for(y=0;y<g.length;y+=1)b[g.charCodeAt(y)]!==void 0?(w++,typeof(b=b[g.charCodeAt(y)])=="number"&&(v+=String.fromCharCode(b),b=r,w=0),y===g.length-1&&(b=r,v+=g.charAt(y-(w-1)),y-=w-1,w=0)):(b=r,v+=g.charAt(y-w),y-=w,w=0);return v};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,y,b){return o(g)?s(g)===!1?-1:!u(g)||!o(y)&&!o(b)||!o(b)&&l(y)||l(g)&&!o(y)||l(g)&&c(y)||l(g)&&l(y)?0:d(g)&&o(y)&&!l(y)&&o(b)&&u(b)?3:l(g)||!o(b)?1:2:-1},h=function(g){var y=0,b=0,v=0,w="",S="",j="",k=(g=g||"").split("\\s+"),A=[];for(y=0;y<k.length;y+=1){for(A.push(""),b=0;b<k[y].length;b+=1)w=k[y][b],S=k[y][b-1],j=k[y][b+1],o(w)?(v=p(w,S,j),A[y]+=v!==-1?String.fromCharCode(t[w.charCodeAt(0)][v]):w):A[y]+=w;A[y]=f(A[y])}return A.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(y)){var v=0;for(b=[],v=0;v<y.length;v+=1)Array.isArray(y[v])?b.push([h(y[v][0]),y[v][1],y[v][2]]):b.push([h(y[v])]);g=b}else g=h(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])}(Rn.API),Rn.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(l){r=l}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(l){n=isNaN(l)||Number.isInteger(l)===!1||l<0?150:l,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(l){i=isNaN(l)||Number.isInteger(l)===!1||l<0?300:l,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(l){s=l}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(l){o=l}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Rn.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,h=0,m=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,S){return w.concat(y.splitTextToSize(S,b))},[])):c=Array.isArray(c)?c:[c];for(var v=0;v<c.length;v++)h<(g=this.getStringUnitWidth(c[v],{font:f})*d)&&(h=g);return h!==0&&(m=c.length),{w:h/=p,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var c;c=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&p&&(this.printHeaderRow(c.lineNumber,!0),c.y+=p[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,f,p){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,m,g,y,b=[],v=[],w=[],S={},j={},k=[],A=[],R=(p=p||{}).autoSize||!1,M=p.printHeaders!==!1,B=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,E=p.margins||Object.assign({width:this.getPageWidth()},t),P=typeof p.padding=="number"?p.padding:3,D=p.headerBackgroundColor||"#c8c8c8",G=p.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=M,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=B,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=D,this.internal.__cell__.headerTextColor=G,this.setFontSize(B),f==null)v=b=Object.keys(d[0]),w=b.map(function(){return"left"});else if(Array.isArray(f)&&Hi(f[0])==="object")for(b=f.map(function(ae){return ae.name}),v=f.map(function(ae){return ae.prompt||ae.name||""}),w=f.map(function(ae){return ae.align||"left"}),h=0;h<f.length;h+=1)j[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(v=b=f,w=b.map(function(){return"left"}));if(R||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<b.length;h+=1){for(S[y=b[h]]=d.map(function(ae){return ae[y]}),this.setFont(void 0,"bold"),k.push(this.getTextDimensions(v[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=S[y],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)k.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);j[y]=Math.max.apply(null,k)+P+P,k=[]}if(M){var H={};for(h=0;h<b.length;h+=1)H[b[h]]={},H[b[h]].text=v[h],H[b[h]].align=w[h];var oe=l.call(this,H,j);A=b.map(function(ae){return new s(c,u,j[ae],oe,H[ae].text,void 0,H[ae].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var de=f.reduce(function(ae,ee){return ae[ee.name]=ee.align,ae},{});for(h=0;h<d.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:d[h]},this);var W=l.call(this,d[h],j);for(g=0;g<b.length;g+=1){var V=d[h][b[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:g,data:V},this),o.call(this,new s(c,u,j[b[g]],W,V,h+2,de[b[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var l=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/p+d+d},this).reduce(function(h,m){return Math.max(h,m)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(m)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(Rn.API);var Bz={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Iz=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],aA=Fz(Iz),Dz=[100,200,300,400,500,600,700,800,900],Pge=Fz(Dz);function Nj(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return Bz[s=s||"normal"]?s:"normal"}(e.style),n=function(s){return s?typeof s=="number"?s>=100&&s<=900&&s%100==0?s:400:/^\d00$/.test(s)?parseInt(s):s==="bold"?700:400:400}(e.weight),i=function(s){return typeof aA[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function sM(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var Oge={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},oM={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function lM(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function cM(e){return e.trimLeft()}function Mge(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function Lge(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var yp,Ib,uM,dM,fM,Cj=["times"];function hM(e,t,r,n,i){var s=4,o=mM;switch(i){case Rn.API.image_compression.FAST:s=1,o=pM;break;case Rn.API.image_compression.MEDIUM:s=6,o=gM;break;case Rn.API.image_compression.SLOW:s=9,o=xM}e=function(c,u,d,f){for(var p,h=c.length/u,m=new Uint8Array(c.length+h),g=[Rge,pM,mM,gM,xM],y=0;y<h;y+=1){var b=y*u,v=c.subarray(b,b+u);if(f)m.set(f(v,d,p),b+y);else{for(var w=g.length,S=[],j=0;j<w;j+=1)S[j]=g[j](v,d,p);var k=Bge(S.concat());m.set(S[k],b+y)}p=v}return m}(e,t,Math.ceil(r*n/8),o);var l=J4(e,{level:s});return Rn.API.__addimage__.arrayBufferToBinaryString(l)}function Rge(e){var t=Array.apply([],e);return t.unshift(0),t}function pM(e,t){var r=e.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var s=e[i-t]||0;n[i+1]=e[i]-s+256&255}return n}function mM(e,t,r){var n=e.length,i=[];i[0]=2;for(var s=0;s<n;s+=1){var o=r&&r[s]||0;i[s+1]=e[s]-o+256&255}return i}function gM(e,t,r){var n=e.length,i=[];i[0]=3;for(var s=0;s<n;s+=1){var o=e[s-t]||0,l=r&&r[s]||0;i[s+1]=e[s]+256-(o+l>>>1)&255}return i}function xM(e,t,r){var n=e.length,i=[];i[0]=4;for(var s=0;s<n;s+=1){var o=Fge(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);i[s+1]=e[s]-o+256&255}return i}function Fge(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),i=Math.abs(e-r),s=Math.abs(e+t-r-r);return n<=i&&n<=s?e:i<=s?t:r}function Bge(e){var t=e.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return t.indexOf(Math.min.apply(null,t))}function Ej(e,t,r){var n=t*r,i=Math.floor(n/8),s=16-(n-8*i+r),o=(1<<r)-1;return $z(e,i)>>s&o}function yM(e,t,r,n){var i=r*n,s=Math.floor(i/8),o=16-(i-8*s+n),l=(1<<n)-1,c=(t&l)<<o;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var p=f>>8&255;u.setUint8(d,p)}})(e,s,$z(e,s)&~(l<<o)&65535|c)}function $z(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function Ige(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],s=i>>7,o=1<<1+(7&i);e[t++],e[t++];var l=null,c=null;s&&(l=t,c=o,t+=3*o);var u=!0,d=[],f=0,p=null,h=0,m=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,p=e[t++],1&g||(p=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,S=e[t++],j=S>>6&1,k=1<<1+(7&S),A=l,R=c,M=!1;S>>7&&(M=!0,A=t,R=k,t+=3*k);var B=t;for(t++;;){var E;if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}d.push({x:y,y:b,width:v,height:w,has_local_palette:M,palette_offset:A,palette_size:R,data_offset:B,data_length:t-B,transparent_index:p,interlaced:!!j,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(P){if(P<0||P>=d.length)throw new Error("Frame index out of range.");return d[P]},this.decodeAndBlitFrameBGRA=function(P,D){var G=this.frameInfo(P),H=G.width*G.height,oe=new Uint8Array(H);bM(e,G.data_offset,oe,H);var de=G.palette_offset,W=G.transparent_index;W===null&&(W=256);var V=G.width,ae=r-V,ee=V,C=4*(G.y*r+G.x),Y=4*((G.y+G.height)*r+G.x),q=C,O=4*ae;G.interlaced===!0&&(O+=4*r*7);for(var X=8,F=0,Q=oe.length;F<Q;++F){var K=oe[F];if(ee===0&&(ee=V,(q+=O)>=Y&&(O=4*ae+4*r*(X-1),q=C+(V+ae)*(X<<1),X>>=1)),K===W)q+=4;else{var ne=e[de+3*K],re=e[de+3*K+1],T=e[de+3*K+2];D[q++]=T,D[q++]=re,D[q++]=ne,D[q++]=255}--ee}},this.decodeAndBlitFrameRGBA=function(P,D){var G=this.frameInfo(P),H=G.width*G.height,oe=new Uint8Array(H);bM(e,G.data_offset,oe,H);var de=G.palette_offset,W=G.transparent_index;W===null&&(W=256);var V=G.width,ae=r-V,ee=V,C=4*(G.y*r+G.x),Y=4*((G.y+G.height)*r+G.x),q=C,O=4*ae;G.interlaced===!0&&(O+=4*r*7);for(var X=8,F=0,Q=oe.length;F<Q;++F){var K=oe[F];if(ee===0&&(ee=V,(q+=O)>=Y&&(O=4*ae+4*r*(X-1),q=C+(V+ae)*(X<<1),X>>=1)),K===W)q+=4;else{var ne=e[de+3*K],re=e[de+3*K+1],T=e[de+3*K+2];D[q++]=ne,D[q++]=re,D[q++]=T,D[q++]=255}--ee}}}function bM(e,t,r,n){for(var i=e[t++],s=1<<i,o=s+1,l=o+1,c=i+1,u=(1<<c)-1,d=0,f=0,p=0,h=e[t++],m=new Int32Array(4096),g=null;;){for(;d<16&&h!==0;)f|=e[t++]<<d,d+=8,h===1?h=e[t++]:--h;if(d<c)break;var y=f&u;if(f>>=c,d-=c,y!==s){if(y===o)break;for(var b=y<l?y:g,v=0,w=b;w>s;)w=m[w]>>8,++v;var S=w;if(p+v+(b!==y?1:0)>n)return void na.log("Warning, gif stream longer than expected.");r[p++]=S;var j=p+=v;for(b!==y&&(r[p++]=S),w=b;v--;)w=m[w],r[--j]=255&w,w>>=8;g!==null&&l<4096&&(m[l++]=g<<8|S,l>=u+1&&c<12&&(++c,u=u<<1|1)),g=y}else l=o+1,u=(1<<(c=i+1))-1,g=null}return p!==n&&na.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Tj(e){var t,r,n,i,s,o=Math.floor,l=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),p=new Array(65535),h=new Array(64),m=new Array(64),g=[],y=0,b=7,v=new Array(64),w=new Array(64),S=new Array(64),j=new Array(256),k=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],R=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],B=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],D=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],H=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function oe(C,Y){for(var q=0,O=0,X=new Array,F=1;F<=16;F++){for(var Q=1;Q<=C[F];Q++)X[Y[O]]=[],X[Y[O]][0]=q,X[Y[O]][1]=F,O++,q++;q*=2}return X}function de(C){for(var Y=C[0],q=C[1]-1;q>=0;)Y&1<<q&&(y|=1<<b),q--,--b<0&&(y==255?(W(255),W(0)):W(y),b=7,y=0)}function W(C){g.push(C)}function V(C){W(C>>8&255),W(255&C)}function ae(C,Y,q,O,X){for(var F,Q=X[0],K=X[240],ne=function(je,Fe){var _e,He,qe,Pt,ut,Ke,lt,ve,Ae,ce,be=0;for(Ae=0;Ae<8;++Ae){_e=je[be],He=je[be+1],qe=je[be+2],Pt=je[be+3],ut=je[be+4],Ke=je[be+5],lt=je[be+6];var mt=_e+(ve=je[be+7]),et=_e-ve,Ue=He+lt,It=He-lt,ht=qe+Ke,Lt=qe-Ke,yr=Pt+ut,Ar=Pt-ut,Tt=mt+yr,Vr=mt-yr,Br=Ue+ht,Wr=Ue-ht;je[be]=Tt+Br,je[be+4]=Tt-Br;var nn=.707106781*(Wr+Vr);je[be+2]=Vr+nn,je[be+6]=Vr-nn;var fn=.382683433*((Tt=Ar+Lt)-(Wr=It+et)),Ir=.5411961*Tt+fn,dn=1.306562965*Wr+fn,Te=.707106781*(Br=Lt+It),tt=et+Te,st=et-Te;je[be+5]=st+Ir,je[be+3]=st-Ir,je[be+1]=tt+dn,je[be+7]=tt-dn,be+=8}for(be=0,Ae=0;Ae<8;++Ae){_e=je[be],He=je[be+8],qe=je[be+16],Pt=je[be+24],ut=je[be+32],Ke=je[be+40],lt=je[be+48];var kt=_e+(ve=je[be+56]),jt=_e-ve,ar=He+lt,tr=He-lt,Er=qe+Ke,se=qe-Ke,ue=Pt+ut,J=Pt-ut,fe=kt+ue,ye=kt-ue,Ce=ar+Er,wt=ar-Er;je[be]=fe+Ce,je[be+32]=fe-Ce;var Qe=.707106781*(wt+ye);je[be+16]=ye+Qe,je[be+48]=ye-Qe;var Ie=.382683433*((fe=J+se)-(wt=tr+jt)),Re=.5411961*fe+Ie,xt=1.306562965*wt+Ie,Gt=.707106781*(Ce=se+tr),qt=jt+Gt,Wt=jt-Gt;je[be+40]=Wt+Re,je[be+24]=Wt-Re,je[be+8]=qt+xt,je[be+56]=qt-xt,be++}for(Ae=0;Ae<64;++Ae)ce=je[Ae]*Fe[Ae],h[Ae]=ce>0?ce+.5|0:ce-.5|0;return h}(C,Y),re=0;re<64;++re)m[A[re]]=ne[re];var T=m[0]-q;q=m[0],T==0?de(O[0]):(de(O[p[F=32767+T]]),de(f[F]));for(var I=63;I>0&&m[I]==0;)I--;if(I==0)return de(Q),q;for(var ie,U=1;U<=I;){for(var Z=U;m[U]==0&&U<=I;)++U;var me=U-Z;if(me>=16){ie=me>>4;for(var Pe=1;Pe<=ie;++Pe)de(K);me&=15}F=32767+m[U],de(X[(me<<4)+p[F]]),de(f[F]),U++}return I!=63&&de(Q),q}function ee(C){C=Math.min(Math.max(C,1),100),s!=C&&(function(Y){for(var q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],O=0;O<64;O++){var X=o((q[O]*Y+50)/100);X=Math.min(Math.max(X,1),255),l[A[O]]=X}for(var F=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Q=0;Q<64;Q++){var K=o((F[Q]*Y+50)/100);K=Math.min(Math.max(K,1),255),c[A[Q]]=K}for(var ne=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],re=0,T=0;T<8;T++)for(var I=0;I<8;I++)u[re]=1/(l[A[re]]*ne[T]*ne[I]*8),d[re]=1/(c[A[re]]*ne[T]*ne[I]*8),re++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),s=C)}this.encode=function(C,Y){Y&&ee(Y),g=new Array,y=0,b=7,V(65496),V(65504),V(16),W(74),W(70),W(73),W(70),W(0),W(1),W(1),W(0),V(1),V(1),W(0),W(0),function(){V(65499),V(132),W(0);for(var He=0;He<64;He++)W(l[He]);W(1);for(var qe=0;qe<64;qe++)W(c[qe])}(),function(He,qe){V(65472),V(17),W(8),V(qe),V(He),W(3),W(1),W(17),W(0),W(2),W(17),W(1),W(3),W(17),W(1)}(C.width,C.height),function(){V(65476),V(418),W(0);for(var He=0;He<16;He++)W(R[He+1]);for(var qe=0;qe<=11;qe++)W(M[qe]);W(16);for(var Pt=0;Pt<16;Pt++)W(B[Pt+1]);for(var ut=0;ut<=161;ut++)W(E[ut]);W(1);for(var Ke=0;Ke<16;Ke++)W(P[Ke+1]);for(var lt=0;lt<=11;lt++)W(D[lt]);W(17);for(var ve=0;ve<16;ve++)W(G[ve+1]);for(var Ae=0;Ae<=161;Ae++)W(H[Ae])}(),V(65498),V(12),W(3),W(1),W(0),W(2),W(17),W(3),W(17),W(0),W(63),W(0);var q=0,O=0,X=0;y=0,b=7,this.encode.displayName="_encode_";for(var F,Q,K,ne,re,T,I,ie,U,Z=C.data,me=C.width,Pe=C.height,je=4*me,Fe=0;Fe<Pe;){for(F=0;F<je;){for(re=je*Fe+F,I=-1,ie=0,U=0;U<64;U++)T=re+(ie=U>>3)*je+(I=4*(7&U)),Fe+ie>=Pe&&(T-=je*(Fe+1+ie-Pe)),F+I>=je&&(T-=F+I-je+4),Q=Z[T++],K=Z[T++],ne=Z[T++],v[U]=(k[Q]+k[K+256|0]+k[ne+512|0]>>16)-128,w[U]=(k[Q+768|0]+k[K+1024|0]+k[ne+1280|0]>>16)-128,S[U]=(k[Q+1280|0]+k[K+1536|0]+k[ne+1792|0]>>16)-128;q=ae(v,u,q,t,n),O=ae(w,d,O,r,i),X=ae(S,d,X,r,i),F+=32}Fe+=8}if(b>=0){var _e=[];_e[1]=b+1,_e[0]=(1<<b+1)-1,de(_e)}return V(65497),new Uint8Array(g)},e=e||50,function(){for(var C=String.fromCharCode,Y=0;Y<256;Y++)j[Y]=C(Y)}(),t=oe(R,M),r=oe(P,D),n=oe(B,E),i=oe(G,H),function(){for(var C=1,Y=2,q=1;q<=15;q++){for(var O=C;O<Y;O++)p[32767+O]=q,f[32767+O]=[],f[32767+O][1]=q,f[32767+O][0]=O;for(var X=-(Y-1);X<=-C;X++)p[32767+X]=q,f[32767+X]=[],f[32767+X][1]=q,f[32767+X][0]=Y-1+X;C<<=1,Y<<=1}}(),function(){for(var C=0;C<256;C++)k[C]=19595*C,k[C+256|0]=38470*C,k[C+512|0]=7471*C+32768,k[C+768|0]=-11059*C,k[C+1024|0]=-21709*C,k[C+1280|0]=32768*C+8421375,k[C+1536|0]=-27439*C,k[C+1792|0]=-5329*C}(),ee(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ru(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function vM(e){function t(M){if(!M)throw Error("assert :P")}function r(M,B,E){for(var P=0;4>P;P++)if(M[B+P]!=E.charCodeAt(P))return!0;return!1}function n(M,B,E,P,D){for(var G=0;G<D;G++)M[B+G]=E[P+G]}function i(M,B,E,P){for(var D=0;D<P;D++)M[B+D]=E}function s(M){return new Int32Array(M)}function o(M,B){for(var E=[],P=0;P<M;P++)E.push(new B);return E}function l(M,B){var E=[];return function P(D,G,H){for(var oe=H[G],de=0;de<oe&&(D.push(H.length>G+1?[]:new B),!(H.length<G+1));de++)P(D[de],G+1,H)}(E,0,M),E}var c=function(){var M=this;function B(_,N){for(var z=1<<N-1>>>0;_&z;)z>>>=1;return z?(_&z-1)+z:_}function E(_,N,z,te,pe){t(!(te%z));do _[N+(te-=z)]=pe;while(0<te)}function P(_,N,z,te,pe){if(t(2328>=pe),512>=pe)var ge=s(512);else if((ge=s(pe))==null)return 0;return function(we,ke,Me,Ve,Ot,rr){var Ge,Bt,Yt=ke,kr=1<<Me,er=s(16),Cr=s(16);for(t(Ot!=0),t(Ve!=null),t(we!=null),t(0<Me),Bt=0;Bt<Ot;++Bt){if(15<Ve[Bt])return 0;++er[Ve[Bt]]}if(er[0]==Ot)return 0;for(Cr[1]=0,Ge=1;15>Ge;++Ge){if(er[Ge]>1<<Ge)return 0;Cr[Ge+1]=Cr[Ge]+er[Ge]}for(Bt=0;Bt<Ot;++Bt)Ge=Ve[Bt],0<Ve[Bt]&&(rr[Cr[Ge]++]=Bt);if(Cr[15]==1)return(Ve=new D).g=0,Ve.value=rr[0],E(we,Yt,1,kr,Ve),kr;var Pr,Hr=-1,Fr=kr-1,Ln=0,Cn=1,li=1,Tn=1<<Me;for(Bt=0,Ge=1,Ot=2;Ge<=Me;++Ge,Ot<<=1){if(Cn+=li<<=1,0>(li-=er[Ge]))return 0;for(;0<er[Ge];--er[Ge])(Ve=new D).g=Ge,Ve.value=rr[Bt++],E(we,Yt+Ln,Ot,Tn,Ve),Ln=B(Ln,Ge)}for(Ge=Me+1,Ot=2;15>=Ge;++Ge,Ot<<=1){if(Cn+=li<<=1,0>(li-=er[Ge]))return 0;for(;0<er[Ge];--er[Ge]){if(Ve=new D,(Ln&Fr)!=Hr){for(Yt+=Tn,Pr=1<<(Hr=Ge)-Me;15>Hr&&!(0>=(Pr-=er[Hr]));)++Hr,Pr<<=1;kr+=Tn=1<<(Pr=Hr-Me),we[ke+(Hr=Ln&Fr)].g=Pr+Me,we[ke+Hr].value=Yt-ke-Hr}Ve.g=Ge-Me,Ve.value=rr[Bt++],E(we,Yt+(Ln>>Me),Ot,Tn,Ve),Ln=B(Ln,Ge)}}return Cn!=2*Cr[15]-1?0:kr}(_,N,z,te,pe,ge)}function D(){this.value=this.g=0}function G(){this.value=this.g=0}function H(){this.G=o(5,D),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(So,G)}function oe(_,N,z,te){t(_!=null),t(N!=null),t(2147483648>te),_.Ca=254,_.I=0,_.b=-8,_.Ka=0,_.oa=N,_.pa=z,_.Jd=N,_.Yc=z+te,_.Zc=4<=te?z+te-4+1:z,Q(_)}function de(_,N){for(var z=0;0<N--;)z|=ne(_,128)<<N;return z}function W(_,N){var z=de(_,N);return K(_)?-z:z}function V(_,N,z,te){var pe,ge=0;for(t(_!=null),t(N!=null),t(4294967288>te),_.Sb=te,_.Ra=0,_.u=0,_.h=0,4<te&&(te=4),pe=0;pe<te;++pe)ge+=N[z+pe]<<8*pe;_.Ra=ge,_.bb=te,_.oa=N,_.pa=z}function ae(_){for(;8<=_.u&&_.bb<_.Sb;)_.Ra>>>=8,_.Ra+=_.oa[_.pa+_.bb]<<cs-8>>>0,++_.bb,_.u-=8;O(_)&&(_.h=1,_.u=0)}function ee(_,N){if(t(0<=N),!_.h&&N<=ba){var z=q(_)&ws[N];return _.u+=N,ae(_),z}return _.h=1,_.u=0}function C(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function Y(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function q(_){return _.Ra>>>(_.u&cs-1)>>>0}function O(_){return t(_.bb<=_.Sb),_.h||_.bb==_.Sb&&_.u>cs}function X(_,N){_.u=N,_.h=O(_)}function F(_){_.u>=Bi&&(t(_.u>=Bi),ae(_))}function Q(_){t(_!=null&&_.oa!=null),_.pa<_.Zc?(_.I=(_.oa[_.pa++]|_.I<<8)>>>0,_.b+=8):(t(_!=null&&_.oa!=null),_.pa<_.Yc?(_.b+=8,_.I=_.oa[_.pa++]|_.I<<8):_.Ka?_.b=0:(_.I<<=8,_.b+=8,_.Ka=1))}function K(_){return de(_,1)}function ne(_,N){var z=_.Ca;0>_.b&&Q(_);var te=_.b,pe=z*N>>>8,ge=(_.I>>>te>pe)+0;for(ge?(z-=pe,_.I-=pe+1<<te>>>0):z=pe+1,te=z,pe=0;256<=te;)pe+=8,te>>=8;return te=7^pe+Aa[te],_.b-=te,_.Ca=(z<<te)-1,ge}function re(_,N,z){_[N+0]=z>>24&255,_[N+1]=z>>16&255,_[N+2]=z>>8&255,_[N+3]=255&z}function T(_,N){return _[N+0]|_[N+1]<<8}function I(_,N){return T(_,N)|_[N+2]<<16}function ie(_,N){return T(_,N)|T(_,N+2)<<16}function U(_,N){var z=1<<N;return t(_!=null),t(0<N),_.X=s(z),_.X==null?0:(_.Mb=32-N,_.Xa=N,1)}function Z(_,N){t(_!=null),t(N!=null),t(_.Xa==N.Xa),n(N.X,0,_.X,0,1<<N.Xa)}function me(){this.X=[],this.Xa=this.Mb=0}function Pe(_,N,z,te){t(z!=null),t(te!=null);var pe=z[0],ge=te[0];return pe==0&&(pe=(_*ge+N/2)/N),ge==0&&(ge=(N*pe+_/2)/_),0>=pe||0>=ge?0:(z[0]=pe,te[0]=ge,1)}function je(_,N){return _+(1<<N)-1>>>N}function Fe(_,N){return((4278255360&_)+(4278255360&N)>>>0&4278255360)+((16711935&_)+(16711935&N)>>>0&16711935)>>>0}function _e(_,N){M[N]=function(z,te,pe,ge,we,ke,Me){var Ve;for(Ve=0;Ve<we;++Ve){var Ot=M[_](ke[Me+Ve-1],pe,ge+Ve);ke[Me+Ve]=Fe(z[te+Ve],Ot)}}}function He(){this.ud=this.hd=this.jd=0}function qe(_,N){return((4278124286&(_^N))>>>1)+(_&N)>>>0}function Pt(_){return 0<=_&&256>_?_:0>_?0:255<_?255:void 0}function ut(_,N){return Pt(_+(_-N+.5>>1))}function Ke(_,N,z){return Math.abs(N-z)-Math.abs(_-z)}function lt(_,N,z,te,pe,ge,we){for(te=ge[we-1],z=0;z<pe;++z)ge[we+z]=te=Fe(_[N+z],te)}function ve(_,N,z,te,pe){var ge;for(ge=0;ge<z;++ge){var we=_[N+ge],ke=we>>8&255,Me=16711935&(Me=(Me=16711935&we)+((ke<<16)+ke));te[pe+ge]=(4278255360&we)+Me>>>0}}function Ae(_,N){N.jd=255&_,N.hd=_>>8&255,N.ud=_>>16&255}function ce(_,N,z,te,pe,ge){var we;for(we=0;we<te;++we){var ke=N[z+we],Me=ke>>>8,Ve=ke,Ot=255&(Ot=(Ot=ke>>>16)+((_.jd<<24>>24)*(Me<<24>>24)>>>5));Ve=255&(Ve=(Ve+=(_.hd<<24>>24)*(Me<<24>>24)>>>5)+((_.ud<<24>>24)*(Ot<<24>>24)>>>5)),pe[ge+we]=(4278255360&ke)+(Ot<<16)+Ve}}function be(_,N,z,te,pe){M[N]=function(ge,we,ke,Me,Ve,Ot,rr,Ge,Bt){for(Me=rr;Me<Ge;++Me)for(rr=0;rr<Bt;++rr)Ve[Ot++]=pe(ke[te(ge[we++])])},M[_]=function(ge,we,ke,Me,Ve,Ot,rr){var Ge=8>>ge.b,Bt=ge.Ea,Yt=ge.K[0],kr=ge.w;if(8>Ge)for(ge=(1<<ge.b)-1,kr=(1<<Ge)-1;we<ke;++we){var er,Cr=0;for(er=0;er<Bt;++er)er&ge||(Cr=te(Me[Ve++])),Ot[rr++]=pe(Yt[Cr&kr]),Cr>>=Ge}else M["VP8LMapColor"+z](Me,Ve,Yt,kr,Ot,rr,we,ke,Bt)}}function mt(_,N,z,te,pe){for(z=N+z;N<z;){var ge=_[N++];te[pe++]=ge>>16&255,te[pe++]=ge>>8&255,te[pe++]=255&ge}}function et(_,N,z,te,pe){for(z=N+z;N<z;){var ge=_[N++];te[pe++]=ge>>16&255,te[pe++]=ge>>8&255,te[pe++]=255&ge,te[pe++]=ge>>24&255}}function Ue(_,N,z,te,pe){for(z=N+z;N<z;){var ge=(we=_[N++])>>16&240|we>>12&15,we=240&we|we>>28&15;te[pe++]=ge,te[pe++]=we}}function It(_,N,z,te,pe){for(z=N+z;N<z;){var ge=(we=_[N++])>>16&248|we>>13&7,we=we>>5&224|we>>3&31;te[pe++]=ge,te[pe++]=we}}function ht(_,N,z,te,pe){for(z=N+z;N<z;){var ge=_[N++];te[pe++]=255&ge,te[pe++]=ge>>8&255,te[pe++]=ge>>16&255}}function Lt(_,N,z,te,pe,ge){if(ge==0)for(z=N+z;N<z;)re(te,((ge=_[N++])[0]>>24|ge[1]>>8&65280|ge[2]<<8&16711680|ge[3]<<24)>>>0),pe+=32;else n(te,pe,_,N,z)}function yr(_,N){M[N][0]=M[_+"0"],M[N][1]=M[_+"1"],M[N][2]=M[_+"2"],M[N][3]=M[_+"3"],M[N][4]=M[_+"4"],M[N][5]=M[_+"5"],M[N][6]=M[_+"6"],M[N][7]=M[_+"7"],M[N][8]=M[_+"8"],M[N][9]=M[_+"9"],M[N][10]=M[_+"10"],M[N][11]=M[_+"11"],M[N][12]=M[_+"12"],M[N][13]=M[_+"13"],M[N][14]=M[_+"0"],M[N][15]=M[_+"0"]}function Ar(_){return _==e5||_==t5||_==Hy||_==r5}function Tt(){this.eb=[],this.size=this.A=this.fb=0}function Vr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Br(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Tt,this.f.kb=new Vr,this.sd=null}function Wr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function nn(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function fn(_){return alert("todo:WebPSamplerProcessPlane"),_.T}function Ir(_,N){var z=_.T,te=N.ba.f.RGBA,pe=te.eb,ge=te.fb+_.ka*te.A,we=wc[N.ba.S],ke=_.y,Me=_.O,Ve=_.f,Ot=_.N,rr=_.ea,Ge=_.W,Bt=N.cc,Yt=N.dc,kr=N.Mc,er=N.Nc,Cr=_.ka,Pr=_.ka+_.T,Hr=_.U,Fr=Hr+1>>1;for(Cr==0?we(ke,Me,null,null,Ve,Ot,rr,Ge,Ve,Ot,rr,Ge,pe,ge,null,null,Hr):(we(N.ec,N.fc,ke,Me,Bt,Yt,kr,er,Ve,Ot,rr,Ge,pe,ge-te.A,pe,ge,Hr),++z);Cr+2<Pr;Cr+=2)Bt=Ve,Yt=Ot,kr=rr,er=Ge,Ot+=_.Rc,Ge+=_.Rc,ge+=2*te.A,we(ke,(Me+=2*_.fa)-_.fa,ke,Me,Bt,Yt,kr,er,Ve,Ot,rr,Ge,pe,ge-te.A,pe,ge,Hr);return Me+=_.fa,_.j+Pr<_.o?(n(N.ec,N.fc,ke,Me,Hr),n(N.cc,N.dc,Ve,Ot,Fr),n(N.Mc,N.Nc,rr,Ge,Fr),z--):1&Pr||we(ke,Me,null,null,Ve,Ot,rr,Ge,Ve,Ot,rr,Ge,pe,ge+te.A,null,null,Hr),z}function dn(_,N,z){var te=_.F,pe=[_.J];if(te!=null){var ge=_.U,we=N.ba.S,ke=we==qy||we==Hy;N=N.ba.f.RGBA;var Me=[0],Ve=_.ka;Me[0]=_.T,_.Kb&&(Ve==0?--Me[0]:(--Ve,pe[0]-=_.width),_.j+_.ka+_.T==_.o&&(Me[0]=_.o-_.j-Ve));var Ot=N.eb;Ve=N.fb+Ve*N.A,_=R6(te,pe[0],_.width,ge,Me,Ot,Ve+(ke?0:3),N.A),t(z==Me),_&&Ar(we)&&Cg(Ot,Ve,ke,ge,Me,N.A)}return 0}function Te(_){var N=_.ma,z=N.ba.S,te=11>z,pe=z==zy||z==Wy||z==qy||z==Z_||z==12||Ar(z);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Rl(N.Oa,_,pe?11:12))return 0;if(pe&&Ar(z)&&Nr(),_.da)alert("todo:use_scaling");else{if(te){if(N.Ib=fn,_.Kb){if(z=_.U+1>>1,N.memory=s(_.U+2*z),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+_.U,N.Mc=N.cc,N.Nc=N.dc+z,N.Ib=Ir,Nr()}}else alert("todo:EmitYUV");pe&&(N.Jb=dn,te&&ur())}if(te&&!Q6){for(_=0;256>_;++_)ZK[_]=89858*(_-128)+Gy>>Vy,rY[_]=-22014*(_-128)+Gy,tY[_]=-45773*(_-128),eY[_]=113618*(_-128)+Gy>>Vy;for(_=Tg;_<a5;++_)N=76283*(_-16)+Gy>>Vy,nY[_-Tg]=nr(N,255),iY[_-Tg]=nr(N+8>>4,15);Q6=1}return 1}function tt(_){var N=_.ma,z=_.U,te=_.T;return t(!(1&_.ka)),0>=z||0>=te?0:(z=N.Ib(_,N),N.Jb!=null&&N.Jb(_,N,z),N.Dc+=z,1)}function st(_){_.ma.memory=null}function kt(_,N,z,te){return ee(_,8)!=47?0:(N[0]=ee(_,14)+1,z[0]=ee(_,14)+1,te[0]=ee(_,1),ee(_,3)!=0?0:!_.h)}function jt(_,N){if(4>_)return _+1;var z=_-2>>1;return(2+(1&_)<<z)+ee(N,z)+1}function ar(_,N){return 120<N?N-120:1<=(z=((z=DK[N-1])>>4)*_+(8-(15&z)))?z:1;var z}function tr(_,N,z){var te=q(z),pe=_[N+=255&te].g-8;return 0<pe&&(X(z,z.u+8),te=q(z),N+=_[N].value,N+=te&(1<<pe)-1),X(z,z.u+_[N].g),_[N].value}function Er(_,N,z){return z.g+=_.g,z.value+=_.value<<N>>>0,t(8>=z.g),_.g}function se(_,N,z){var te=_.xc;return t((N=te==0?0:_.vc[_.md*(z>>te)+(N>>te)])<_.Wb),_.Ya[N]}function ue(_,N,z,te){var pe=_.ab,ge=_.c*N,we=_.C;N=we+N;var ke=z,Me=te;for(te=_.Ta,z=_.Ua;0<pe--;){var Ve=_.gc[pe],Ot=we,rr=N,Ge=ke,Bt=Me,Yt=(Me=te,ke=z,Ve.Ea);switch(t(Ot<rr),t(rr<=Ve.nc),Ve.hc){case 2:Ci(Ge,Bt,(rr-Ot)*Yt,Me,ke);break;case 0:var kr=Ot,er=rr,Cr=Me,Pr=ke,Hr=(Tn=Ve).Ea;kr==0&&(to(Ge,Bt,null,null,1,Cr,Pr),lt(Ge,Bt+1,0,0,Hr-1,Cr,Pr+1),Bt+=Hr,Pr+=Hr,++kr);for(var Fr=1<<Tn.b,Ln=Fr-1,Cn=je(Hr,Tn.b),li=Tn.K,Tn=Tn.w+(kr>>Tn.b)*Cn;kr<er;){var vi=li,js=Tn,ci=1;for(Au(Ge,Bt,Cr,Pr-Hr,1,Cr,Pr);ci<Hr;){var Pn=(ci&~Ln)+Fr;Pn>Hr&&(Pn=Hr),(0,Xc[vi[js++]>>8&15])(Ge,Bt+ +ci,Cr,Pr+ci-Hr,Pn-ci,Cr,Pr+ci),ci=Pn}Bt+=Hr,Pr+=Hr,++kr&Ln||(Tn+=Cn)}rr!=Ve.nc&&n(Me,ke-Yt,Me,ke+(rr-Ot-1)*Yt,Yt);break;case 1:for(Yt=Ge,er=Bt,Hr=(Ge=Ve.Ea)-(Pr=Ge&~(Cr=(Bt=1<<Ve.b)-1)),kr=je(Ge,Ve.b),Fr=Ve.K,Ve=Ve.w+(Ot>>Ve.b)*kr;Ot<rr;){for(Ln=Fr,Cn=Ve,li=new He,Tn=er+Pr,vi=er+Ge;er<Tn;)Ae(Ln[Cn++],li),gc(li,Yt,er,Bt,Me,ke),er+=Bt,ke+=Bt;er<vi&&(Ae(Ln[Cn++],li),gc(li,Yt,er,Hr,Me,ke),er+=Hr,ke+=Hr),++Ot&Cr||(Ve+=kr)}break;case 3:if(Ge==Me&&Bt==ke&&0<Ve.b){for(er=Me,Ge=Yt=ke+(rr-Ot)*Yt-(Pr=(rr-Ot)*je(Ve.Ea,Ve.b)),Bt=Me,Cr=ke,kr=[],Pr=(Hr=Pr)-1;0<=Pr;--Pr)kr[Pr]=Bt[Cr+Pr];for(Pr=Hr-1;0<=Pr;--Pr)er[Ge+Pr]=kr[Pr];$n(Ve,Ot,rr,Me,Yt,Me,ke)}else $n(Ve,Ot,rr,Ge,Bt,Me,ke)}ke=te,Me=z}Me!=z&&n(te,z,ke,Me,ge)}function J(_,N){var z=_.V,te=_.Ba+_.c*_.C,pe=N-_.C;if(t(N<=_.l.o),t(16>=pe),0<pe){var ge=_.l,we=_.Ta,ke=_.Ua,Me=ge.width;if(ue(_,pe,z,te),pe=ke=[ke],t((z=_.C)<(te=N)),t(ge.v<ge.va),te>ge.o&&(te=ge.o),z<ge.j){var Ve=ge.j-z;z=ge.j,pe[0]+=Ve*Me}if(z>=te?z=0:(pe[0]+=4*ge.v,ge.ka=z-ge.j,ge.U=ge.va-ge.v,ge.T=te-z,z=1),z){if(ke=ke[0],11>(z=_.ca).S){var Ot=z.f.RGBA,rr=(te=z.S,pe=ge.U,ge=ge.T,Ve=Ot.eb,Ot.A),Ge=ge;for(Ot=Ot.fb+_.Ma*Ot.A;0<Ge--;){var Bt=we,Yt=ke,kr=pe,er=Ve,Cr=Ot;switch(te){case Uy:xc(Bt,Yt,kr,er,Cr);break;case zy:Yo(Bt,Yt,kr,er,Cr);break;case e5:Yo(Bt,Yt,kr,er,Cr),Cg(er,Cr,0,kr,1,0);break;case z6:yc(Bt,Yt,kr,er,Cr);break;case Wy:Lt(Bt,Yt,kr,er,Cr,1);break;case t5:Lt(Bt,Yt,kr,er,Cr,1),Cg(er,Cr,0,kr,1,0);break;case qy:Lt(Bt,Yt,kr,er,Cr,0);break;case Hy:Lt(Bt,Yt,kr,er,Cr,0),Cg(er,Cr,1,kr,1,0);break;case Z_:ro(Bt,Yt,kr,er,Cr);break;case r5:ro(Bt,Yt,kr,er,Cr),L6(er,Cr,kr,1,0);break;case W6:pl(Bt,Yt,kr,er,Cr);break;default:t(0)}ke+=Me,Ot+=rr}_.Ma+=ge}else alert("todo:EmitRescaledRowsYUVA");t(_.Ma<=z.height)}}_.C=N,t(_.C<=_.i)}function fe(_){var N;if(0<_.ua)return 0;for(N=0;N<_.Wb;++N){var z=_.Ya[N].G,te=_.Ya[N].H;if(0<z[1][te[1]+0].g||0<z[2][te[2]+0].g||0<z[3][te[3]+0].g)return 0}return 1}function ye(_,N,z,te,pe,ge){if(_.Z!=0){var we=_.qd,ke=_.rd;for(t(vf[_.Z]!=null);N<z;++N)vf[_.Z](we,ke,te,pe,te,pe,ge),we=te,ke=pe,pe+=ge;_.qd=we,_.rd=ke}}function Ce(_,N){var z=_.l.ma,te=z.Z==0||z.Z==1?_.l.j:_.C;if(te=_.C<te?te:_.C,t(N<=_.l.o),N>te){var pe=_.l.width,ge=z.ca,we=z.tb+pe*te,ke=_.V,Me=_.Ba+_.c*te,Ve=_.gc;t(_.ab==1),t(Ve[0].hc==3),Ss(Ve[0],te,N,ke,Me,ge,we),ye(z,te,N,ge,we,pe)}_.C=_.Ma=N}function wt(_,N,z,te,pe,ge,we){var ke=_.$/te,Me=_.$%te,Ve=_.m,Ot=_.s,rr=z+_.$,Ge=rr;pe=z+te*pe;var Bt=z+te*ge,Yt=280+Ot.ua,kr=_.Pb?ke:16777216,er=0<Ot.ua?Ot.Wa:null,Cr=Ot.wc,Pr=rr<Bt?se(Ot,Me,ke):null;t(_.C<ge),t(Bt<=pe);var Hr=!1;e:for(;;){for(;Hr||rr<Bt;){var Fr=0;if(ke>=kr){var Ln=rr-z;t((kr=_).Pb),kr.wd=kr.m,kr.xd=Ln,0<kr.s.ua&&Z(kr.s.Wa,kr.s.vb),kr=ke+UK}if(Me&Cr||(Pr=se(Ot,Me,ke)),t(Pr!=null),Pr.Qb&&(N[rr]=Pr.qb,Hr=!0),!Hr)if(F(Ve),Pr.jc){Fr=Ve,Ln=N;var Cn=rr,li=Pr.pd[q(Fr)&So-1];t(Pr.jc),256>li.g?(X(Fr,Fr.u+li.g),Ln[Cn]=li.value,Fr=0):(X(Fr,Fr.u+li.g-256),t(256<=li.value),Fr=li.value),Fr==0&&(Hr=!0)}else Fr=tr(Pr.G[0],Pr.H[0],Ve);if(Ve.h)break;if(Hr||256>Fr){if(!Hr)if(Pr.nd)N[rr]=(Pr.qb|Fr<<8)>>>0;else{if(F(Ve),Hr=tr(Pr.G[1],Pr.H[1],Ve),F(Ve),Ln=tr(Pr.G[2],Pr.H[2],Ve),Cn=tr(Pr.G[3],Pr.H[3],Ve),Ve.h)break;N[rr]=(Cn<<24|Hr<<16|Fr<<8|Ln)>>>0}if(Hr=!1,++rr,++Me>=te&&(Me=0,++ke,we!=null&&ke<=ge&&!(ke%16)&&we(_,ke),er!=null))for(;Ge<rr;)Fr=N[Ge++],er.X[(506832829*Fr&4294967295)>>>er.Mb]=Fr}else if(280>Fr){if(Fr=jt(Fr-256,Ve),Ln=tr(Pr.G[4],Pr.H[4],Ve),F(Ve),Ln=ar(te,Ln=jt(Ln,Ve)),Ve.h)break;if(rr-z<Ln||pe-rr<Fr)break e;for(Cn=0;Cn<Fr;++Cn)N[rr+Cn]=N[rr+Cn-Ln];for(rr+=Fr,Me+=Fr;Me>=te;)Me-=te,++ke,we!=null&&ke<=ge&&!(ke%16)&&we(_,ke);if(t(rr<=pe),Me&Cr&&(Pr=se(Ot,Me,ke)),er!=null)for(;Ge<rr;)Fr=N[Ge++],er.X[(506832829*Fr&4294967295)>>>er.Mb]=Fr}else{if(!(Fr<Yt))break e;for(Hr=Fr-280,t(er!=null);Ge<rr;)Fr=N[Ge++],er.X[(506832829*Fr&4294967295)>>>er.Mb]=Fr;Fr=rr,t(!(Hr>>>(Ln=er).Xa)),N[Fr]=Ln.X[Hr],Hr=!0}Hr||t(Ve.h==O(Ve))}if(_.Pb&&Ve.h&&rr<pe)t(_.m.h),_.a=5,_.m=_.wd,_.$=_.xd,0<_.s.ua&&Z(_.s.vb,_.s.Wa);else{if(Ve.h)break e;we!=null&&we(_,ke>ge?ge:ke),_.a=0,_.$=rr-z}return 1}return _.a=3,0}function Qe(_){t(_!=null),_.vc=null,_.yc=null,_.Ya=null;var N=_.Wa;N!=null&&(N.X=null),_.vb=null,t(_!=null)}function Ie(){var _=new Dn;return _==null?null:(_.a=0,_.xb=V6,yr("Predictor","VP8LPredictors"),yr("Predictor","VP8LPredictors_C"),yr("PredictorAdd","VP8LPredictorsAdd"),yr("PredictorAdd","VP8LPredictorsAdd_C"),Ci=ve,gc=ce,xc=mt,Yo=et,ro=Ue,pl=It,yc=ht,M.VP8LMapColor32b=Yi,M.VP8LMapColor8b=hd,_)}function Re(_,N,z,te,pe){var ge=1,we=[_],ke=[N],Me=te.m,Ve=te.s,Ot=null,rr=0;e:for(;;){if(z)for(;ge&&ee(Me,1);){var Ge=we,Bt=ke,Yt=te,kr=1,er=Yt.m,Cr=Yt.gc[Yt.ab],Pr=ee(er,2);if(Yt.Oc&1<<Pr)ge=0;else{switch(Yt.Oc|=1<<Pr,Cr.hc=Pr,Cr.Ea=Ge[0],Cr.nc=Bt[0],Cr.K=[null],++Yt.ab,t(4>=Yt.ab),Pr){case 0:case 1:Cr.b=ee(er,3)+2,kr=Re(je(Cr.Ea,Cr.b),je(Cr.nc,Cr.b),0,Yt,Cr.K),Cr.K=Cr.K[0];break;case 3:var Hr,Fr=ee(er,8)+1,Ln=16<Fr?0:4<Fr?1:2<Fr?2:3;if(Ge[0]=je(Cr.Ea,Ln),Cr.b=Ln,Hr=kr=Re(Fr,1,0,Yt,Cr.K)){var Cn,li=Fr,Tn=Cr,vi=1<<(8>>Tn.b),js=s(vi);if(js==null)Hr=0;else{var ci=Tn.K[0],Pn=Tn.w;for(js[0]=Tn.K[0][0],Cn=1;Cn<1*li;++Cn)js[Cn]=Fe(ci[Pn+Cn],js[Cn-1]);for(;Cn<4*vi;++Cn)js[Cn]=0;Tn.K[0]=null,Tn.K[0]=js,Hr=1}}kr=Hr;break;case 2:break;default:t(0)}ge=kr}}if(we=we[0],ke=ke[0],ge&&ee(Me,1)&&!(ge=1<=(rr=ee(Me,4))&&11>=rr)){te.a=3;break e}var un;if(un=ge)t:{var Qa,ni,wi,ua=te,no=we,Xo=ke,Ba=rr,_o=z,Qo=ua.m,ks=ua.s,_i=[null],$i=1,Ia=0,Ui=$K[Ba];r:for(;;){if(_o&&ee(Qo,1)){var io=ee(Qo,3)+2,Jc=je(no,io),Ja=je(Xo,io),ml=Jc*Ja;if(!Re(Jc,Ja,0,ua,_i))break r;for(_i=_i[0],ks.xc=io,Qa=0;Qa<ml;++Qa){var ta=_i[Qa]>>8&65535;_i[Qa]=ta,ta>=$i&&($i=ta+1)}}if(Qo.h)break r;for(ni=0;5>ni;++ni){var As=q6[ni];!ni&&0<Ba&&(As+=1<<Ba),Ia<As&&(Ia=As)}var Dl=o($i*Ui,D),Jo=$i,$l=o(Jo,H);if($l==null)var Ul=null;else t(65536>=Jo),Ul=$l;var gl=s(Ia);if(Ul==null||gl==null||Dl==null){ua.a=1;break r}var zl=Dl;for(Qa=wi=0;Qa<$i;++Qa){var aa=Ul[Qa],Wl=aa.G,Zc=aa.H,Oh=0,gd=1,ao=0;for(ni=0;5>ni;++ni){As=q6[ni],Wl[ni]=zl,Zc[ni]=wi,!ni&&0<Ba&&(As+=1<<Ba);i:{var Yy,s5=As,Xy=ua,Pg=gl,oY=zl,lY=wi,o5=0,wf=Xy.m,cY=ee(wf,1);if(i(Pg,0,0,s5),cY){var uY=ee(wf,1)+1,dY=ee(wf,1),eT=ee(wf,dY==0?1:8);Pg[eT]=1,uY==2&&(Pg[eT=ee(wf,8)]=1);var Qy=1}else{var tT=s(19),rT=ee(wf,4)+4;if(19<rT){Xy.a=3;var Jy=0;break i}for(Yy=0;Yy<rT;++Yy)tT[IK[Yy]]=ee(wf,3);var l5=void 0,Og=void 0,nT=Xy,fY=tT,Zy=s5,iT=Pg,c5=0,Sf=nT.m,aT=8,sT=o(128,D);n:for(;P(sT,0,7,fY,19);){if(ee(Sf,1)){var hY=2+2*ee(Sf,3);if((l5=2+ee(Sf,hY))>Zy)break n}else l5=Zy;for(Og=0;Og<Zy&&l5--;){F(Sf);var oT=sT[0+(127&q(Sf))];X(Sf,Sf.u+oT.g);var dp=oT.value;if(16>dp)iT[Og++]=dp,dp!=0&&(aT=dp);else{var pY=dp==16,lT=dp-16,mY=FK[lT],cT=ee(Sf,RK[lT])+mY;if(Og+cT>Zy)break n;for(var gY=pY?aT:0;0<cT--;)iT[Og++]=gY}}c5=1;break n}c5||(nT.a=3),Qy=c5}(Qy=Qy&&!wf.h)&&(o5=P(oY,lY,8,Pg,s5)),Qy&&o5!=0?Jy=o5:(Xy.a=3,Jy=0)}if(Jy==0)break r;if(gd&&BK[ni]==1&&(gd=zl[wi].g==0),Oh+=zl[wi].g,wi+=Jy,3>=ni){var Mg,u5=gl[0];for(Mg=1;Mg<As;++Mg)gl[Mg]>u5&&(u5=gl[Mg]);ao+=u5}}if(aa.nd=gd,aa.Qb=0,gd&&(aa.qb=(Wl[3][Zc[3]+0].value<<24|Wl[1][Zc[1]+0].value<<16|Wl[2][Zc[2]+0].value)>>>0,Oh==0&&256>Wl[0][Zc[0]+0].value&&(aa.Qb=1,aa.qb+=Wl[0][Zc[0]+0].value<<8)),aa.jc=!aa.Qb&&6>ao,aa.jc){var eb,xd=aa;for(eb=0;eb<So;++eb){var _f=eb,jf=xd.pd[_f],tb=xd.G[0][xd.H[0]+_f];256<=tb.value?(jf.g=tb.g+256,jf.value=tb.value):(jf.g=0,jf.value=0,_f>>=Er(tb,8,jf),_f>>=Er(xd.G[1][xd.H[1]+_f],16,jf),_f>>=Er(xd.G[2][xd.H[2]+_f],0,jf),Er(xd.G[3][xd.H[3]+_f],24,jf))}}}ks.vc=_i,ks.Wb=$i,ks.Ya=Ul,ks.yc=Dl,un=1;break t}un=0}if(!(ge=un)){te.a=3;break e}if(0<rr){if(Ve.ua=1<<rr,!U(Ve.Wa,rr)){te.a=1,ge=0;break e}}else Ve.ua=0;var d5=te,uT=we,xY=ke,f5=d5.s,h5=f5.xc;if(d5.c=uT,d5.i=xY,f5.md=je(uT,h5),f5.wc=h5==0?-1:(1<<h5)-1,z){te.xb=KK;break e}if((Ot=s(we*ke))==null){te.a=1,ge=0;break e}ge=(ge=wt(te,Ot,0,we,ke,ke,null))&&!Me.h;break e}return ge?(pe!=null?pe[0]=Ot:(t(Ot==null),t(z)),te.$=0,z||Qe(Ve)):Qe(Ve),ge}function xt(_,N){var z=_.c*_.i,te=z+N+16*N;return t(_.c<=N),_.V=s(te),_.V==null?(_.Ta=null,_.Ua=0,_.a=1,0):(_.Ta=_.V,_.Ua=_.Ba+z+N,1)}function Gt(_,N){var z=_.C,te=N-z,pe=_.V,ge=_.Ba+_.c*z;for(t(N<=_.l.o);0<te;){var we=16<te?16:te,ke=_.l.ma,Me=_.l.width,Ve=Me*we,Ot=ke.ca,rr=ke.tb+Me*z,Ge=_.Ta,Bt=_.Ua;ue(_,we,pe,ge),F6(Ge,Bt,Ot,rr,Ve),ye(ke,z,z+we,Ot,rr,Me),te-=we,pe+=we*_.c,z+=we}t(z==N),_.C=_.Ma=N}function qt(){this.ub=this.yd=this.td=this.Rb=0}function Wt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function vt(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Rt(){this.Yb=function(){var _=[];return function N(z,te,pe){for(var ge=pe[te],we=0;we<ge&&(z.push(pe.length>te+1?[]:0),!(pe.length<te+1));we++)N(z[we],te+1,pe)}(_,0,[3,11]),_}()}function Zt(){this.jb=s(3),this.Wc=l([4,8],Rt),this.Xc=l([4,17],Rt)}function wr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function br(){this.ld=this.La=this.dd=this.tc=0}function cr(){this.Na=this.la=0}function Tr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Kr(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Yr(){this.uc=this.M=this.Nb=0,this.wa=Array(new br),this.Y=0,this.ya=Array(new Kr),this.aa=0,this.l=new Mr}function xn(){this.y=s(16),this.f=s(8),this.ea=s(8)}function hr(){this.cb=this.a=0,this.sc="",this.m=new C,this.Od=new qt,this.Kc=new Wt,this.ed=new wr,this.Qa=new vt,this.Ic=this.$c=this.Aa=0,this.D=new Yr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,C),this.ia=0,this.pb=o(4,Tr),this.Pa=new Zt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new xn),this.Hd=0,this.rb=Array(new cr),this.sb=0,this.wa=Array(new br),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Kr),this.L=this.aa=0,this.gd=l([4,2],br),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function nr(_,N){return 0>_?0:_>N?N:_}function Mr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function an(){var _=new hr;return _!=null&&(_.a=0,_.sc="OK",_.cb=0,_.Xb=0,Eg||(Eg=Ht)),_}function it(_,N,z){return _.a==0&&(_.a=N,_.sc=z,_.cb=0),0}function Ye(_,N,z){return 3<=z&&_[N+0]==157&&_[N+1]==1&&_[N+2]==42}function ct(_,N){if(_==null)return 0;if(_.a=0,_.sc="OK",N==null)return it(_,2,"null VP8Io passed to VP8GetHeaders()");var z=N.data,te=N.w,pe=N.ha;if(4>pe)return it(_,7,"Truncated header.");var ge=z[te+0]|z[te+1]<<8|z[te+2]<<16,we=_.Od;if(we.Rb=!(1&ge),we.td=ge>>1&7,we.yd=ge>>4&1,we.ub=ge>>5,3<we.td)return it(_,3,"Incorrect keyframe parameters.");if(!we.yd)return it(_,4,"Frame not displayable.");te+=3,pe-=3;var ke=_.Kc;if(we.Rb){if(7>pe)return it(_,7,"cannot parse picture header");if(!Ye(z,te,pe))return it(_,3,"Bad code word");ke.c=16383&(z[te+4]<<8|z[te+3]),ke.Td=z[te+4]>>6,ke.i=16383&(z[te+6]<<8|z[te+5]),ke.Ud=z[te+6]>>6,te+=7,pe-=7,_.za=ke.c+15>>4,_.Ub=ke.i+15>>4,N.width=ke.c,N.height=ke.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,i((ge=_.Pa).jb,0,255,ge.jb.length),t((ge=_.Qa)!=null),ge.Cb=0,ge.Bb=0,ge.Fb=1,i(ge.Zb,0,0,ge.Zb.length),i(ge.Lb,0,0,ge.Lb)}if(we.ub>pe)return it(_,7,"bad partition length");oe(ge=_.m,z,te,we.ub),te+=we.ub,pe-=we.ub,we.Rb&&(ke.Ld=K(ge),ke.Kd=K(ge)),ke=_.Qa;var Me,Ve=_.Pa;if(t(ge!=null),t(ke!=null),ke.Cb=K(ge),ke.Cb){if(ke.Bb=K(ge),K(ge)){for(ke.Fb=K(ge),Me=0;4>Me;++Me)ke.Zb[Me]=K(ge)?W(ge,7):0;for(Me=0;4>Me;++Me)ke.Lb[Me]=K(ge)?W(ge,6):0}if(ke.Bb)for(Me=0;3>Me;++Me)Ve.jb[Me]=K(ge)?de(ge,8):255}else ke.Bb=0;if(ge.Ka)return it(_,3,"cannot parse segment header");if((ke=_.ed).zd=K(ge),ke.Tb=de(ge,6),ke.wb=de(ge,3),ke.Pc=K(ge),ke.Pc&&K(ge)){for(Ve=0;4>Ve;++Ve)K(ge)&&(ke.vd[Ve]=W(ge,6));for(Ve=0;4>Ve;++Ve)K(ge)&&(ke.od[Ve]=W(ge,6))}if(_.L=ke.Tb==0?0:ke.zd?1:2,ge.Ka)return it(_,3,"cannot parse filter header");var Ot=pe;if(pe=Me=te,te=Me+Ot,ke=Ot,_.Xb=(1<<de(_.m,2))-1,Ot<3*(Ve=_.Xb))z=7;else{for(Me+=3*Ve,ke-=3*Ve,Ot=0;Ot<Ve;++Ot){var rr=z[pe+0]|z[pe+1]<<8|z[pe+2]<<16;rr>ke&&(rr=ke),oe(_.Jc[+Ot],z,Me,rr),Me+=rr,ke-=rr,pe+=3}oe(_.Jc[+Ve],z,Me,ke),z=Me<te?0:5}if(z!=0)return it(_,z,"cannot parse partitions");for(z=de(Me=_.m,7),pe=K(Me)?W(Me,4):0,te=K(Me)?W(Me,4):0,ke=K(Me)?W(Me,4):0,Ve=K(Me)?W(Me,4):0,Me=K(Me)?W(Me,4):0,Ot=_.Qa,rr=0;4>rr;++rr){if(Ot.Cb){var Ge=Ot.Zb[rr];Ot.Fb||(Ge+=z)}else{if(0<rr){_.pb[rr]=_.pb[0];continue}Ge=z}var Bt=_.pb[rr];Bt.Sc[0]=n5[nr(Ge+pe,127)],Bt.Sc[1]=i5[nr(Ge+0,127)],Bt.Eb[0]=2*n5[nr(Ge+te,127)],Bt.Eb[1]=101581*i5[nr(Ge+ke,127)]>>16,8>Bt.Eb[1]&&(Bt.Eb[1]=8),Bt.Qc[0]=n5[nr(Ge+Ve,117)],Bt.Qc[1]=i5[nr(Ge+Me,127)],Bt.lc=Ge+Me}if(!we.Rb)return it(_,4,"Not a key frame.");for(K(ge),we=_.Pa,z=0;4>z;++z){for(pe=0;8>pe;++pe)for(te=0;3>te;++te)for(ke=0;11>ke;++ke)Ve=ne(ge,VK[z][pe][te][ke])?de(ge,8):qK[z][pe][te][ke],we.Wc[z][pe].Yb[te][ke]=Ve;for(pe=0;17>pe;++pe)we.Xc[z][pe]=we.Wc[z][GK[pe]]}return _.kc=K(ge),_.kc&&(_.Bd=de(ge,8)),_.cb=1}function Ht(_,N,z,te,pe,ge,we){var ke=N[pe].Yb[z];for(z=0;16>pe;++pe){if(!ne(_,ke[z+0]))return pe;for(;!ne(_,ke[z+1]);)if(ke=N[++pe].Yb[0],z=0,pe==16)return 16;var Me=N[pe+1].Yb;if(ne(_,ke[z+2])){var Ve=_,Ot=0;if(ne(Ve,(Ge=ke)[(rr=z)+3]))if(ne(Ve,Ge[rr+6])){for(ke=0,rr=2*(Ot=ne(Ve,Ge[rr+8]))+(Ge=ne(Ve,Ge[rr+9+Ot])),Ot=0,Ge=zK[rr];Ge[ke];++ke)Ot+=Ot+ne(Ve,Ge[ke]);Ot+=3+(8<<rr)}else ne(Ve,Ge[rr+7])?(Ot=7+2*ne(Ve,165),Ot+=ne(Ve,145)):Ot=5+ne(Ve,159);else Ot=ne(Ve,Ge[rr+4])?3+ne(Ve,Ge[rr+5]):2;ke=Me[2]}else Ot=1,ke=Me[1];Me=we+WK[pe],0>(Ve=_).b&&Q(Ve);var rr,Ge=Ve.b,Bt=(rr=Ve.Ca>>1)-(Ve.I>>Ge)>>31;--Ve.b,Ve.Ca+=Bt,Ve.Ca|=1,Ve.I-=(rr+1&Bt)<<Ge,ge[Me]=((Ot^Bt)-Bt)*te[(0<pe)+0]}return 16}function fr(_){var N=_.rb[_.sb-1];N.la=0,N.Na=0,i(_.zc,0,0,_.zc.length),_.ja=0}function Sr(_,N,z,te,pe){pe=_[N+z+32*te]+(pe>>3),_[N+z+32*te]=-256&pe?0>pe?0:255:pe}function gr(_,N,z,te,pe,ge){Sr(_,N,0,z,te+pe),Sr(_,N,1,z,te+ge),Sr(_,N,2,z,te-ge),Sr(_,N,3,z,te-pe)}function Ze(_){return(20091*_>>16)+_}function Kt(_,N,z,te){var pe,ge=0,we=s(16);for(pe=0;4>pe;++pe){var ke=_[N+0]+_[N+8],Me=_[N+0]-_[N+8],Ve=(35468*_[N+4]>>16)-Ze(_[N+12]),Ot=Ze(_[N+4])+(35468*_[N+12]>>16);we[ge+0]=ke+Ot,we[ge+1]=Me+Ve,we[ge+2]=Me-Ve,we[ge+3]=ke-Ot,ge+=4,N++}for(pe=ge=0;4>pe;++pe)ke=(_=we[ge+0]+4)+we[ge+8],Me=_-we[ge+8],Ve=(35468*we[ge+4]>>16)-Ze(we[ge+12]),Sr(z,te,0,0,ke+(Ot=Ze(we[ge+4])+(35468*we[ge+12]>>16))),Sr(z,te,1,0,Me+Ve),Sr(z,te,2,0,Me-Ve),Sr(z,te,3,0,ke-Ot),ge++,te+=32}function nt(_,N,z,te){var pe=_[N+0]+4,ge=35468*_[N+4]>>16,we=Ze(_[N+4]),ke=35468*_[N+1]>>16;gr(z,te,0,pe+we,_=Ze(_[N+1]),ke),gr(z,te,1,pe+ge,_,ke),gr(z,te,2,pe-ge,_,ke),gr(z,te,3,pe-we,_,ke)}function bt(_,N,z,te,pe){Kt(_,N,z,te),pe&&Kt(_,N+16,z,te+4)}function St(_,N,z,te){Bl(_,N+0,z,te,1),Bl(_,N+32,z,te+128,1)}function Ct(_,N,z,te){var pe;for(_=_[N+0]+4,pe=0;4>pe;++pe)for(N=0;4>N;++N)Sr(z,te,N,pe,_)}function $t(_,N,z,te){_[N+0]&&Ii(_,N+0,z,te),_[N+16]&&Ii(_,N+16,z,te+4),_[N+32]&&Ii(_,N+32,z,te+128),_[N+48]&&Ii(_,N+48,z,te+128+4)}function Vt(_,N,z,te){var pe,ge=s(16);for(pe=0;4>pe;++pe){var we=_[N+0+pe]+_[N+12+pe],ke=_[N+4+pe]+_[N+8+pe],Me=_[N+4+pe]-_[N+8+pe],Ve=_[N+0+pe]-_[N+12+pe];ge[0+pe]=we+ke,ge[8+pe]=we-ke,ge[4+pe]=Ve+Me,ge[12+pe]=Ve-Me}for(pe=0;4>pe;++pe)we=(_=ge[0+4*pe]+3)+ge[3+4*pe],ke=ge[1+4*pe]+ge[2+4*pe],Me=ge[1+4*pe]-ge[2+4*pe],Ve=_-ge[3+4*pe],z[te+0]=we+ke>>3,z[te+16]=Ve+Me>>3,z[te+32]=we-ke>>3,z[te+48]=Ve-Me>>3,te+=64}function Dt(_,N,z){var te,pe=N-32,ge=Il,we=255-_[pe-1];for(te=0;te<z;++te){var ke,Me=ge,Ve=we+_[N-1];for(ke=0;ke<z;++ke)_[N+ke]=Me[Ve+_[pe+ke]];N+=32}}function ze(_,N){Dt(_,N,4)}function at(_,N){Dt(_,N,8)}function _t(_,N){Dt(_,N,16)}function Ft(_,N){var z;for(z=0;16>z;++z)n(_,N+32*z,_,N-32,16)}function pr(_,N){var z;for(z=16;0<z;--z)i(_,N,_[N-1],16),N+=32}function or(_,N,z){var te;for(te=0;16>te;++te)i(N,z+32*te,_,16)}function Xt(_,N){var z,te=16;for(z=0;16>z;++z)te+=_[N-1+32*z]+_[N+z-32];or(te>>5,_,N)}function xe(_,N){var z,te=8;for(z=0;16>z;++z)te+=_[N-1+32*z];or(te>>4,_,N)}function Ee(_,N){var z,te=8;for(z=0;16>z;++z)te+=_[N+z-32];or(te>>4,_,N)}function De(_,N){or(128,_,N)}function gt(_,N,z){return _+2*N+z+2>>2}function vr(_,N){var z,te=N-32;for(te=new Uint8Array([gt(_[te-1],_[te+0],_[te+1]),gt(_[te+0],_[te+1],_[te+2]),gt(_[te+1],_[te+2],_[te+3]),gt(_[te+2],_[te+3],_[te+4])]),z=0;4>z;++z)n(_,N+32*z,te,0,te.length)}function Je(_,N){var z=_[N-1],te=_[N-1+32],pe=_[N-1+64],ge=_[N-1+96];re(_,N+0,16843009*gt(_[N-1-32],z,te)),re(_,N+32,16843009*gt(z,te,pe)),re(_,N+64,16843009*gt(te,pe,ge)),re(_,N+96,16843009*gt(pe,ge,ge))}function Ut(_,N){var z,te=4;for(z=0;4>z;++z)te+=_[N+z-32]+_[N-1+32*z];for(te>>=3,z=0;4>z;++z)i(_,N+32*z,te,4)}function Le(_,N){var z=_[N-1+0],te=_[N-1+32],pe=_[N-1+64],ge=_[N-1-32],we=_[N+0-32],ke=_[N+1-32],Me=_[N+2-32],Ve=_[N+3-32];_[N+0+96]=gt(te,pe,_[N-1+96]),_[N+1+96]=_[N+0+64]=gt(z,te,pe),_[N+2+96]=_[N+1+64]=_[N+0+32]=gt(ge,z,te),_[N+3+96]=_[N+2+64]=_[N+1+32]=_[N+0+0]=gt(we,ge,z),_[N+3+64]=_[N+2+32]=_[N+1+0]=gt(ke,we,ge),_[N+3+32]=_[N+2+0]=gt(Me,ke,we),_[N+3+0]=gt(Ve,Me,ke)}function Be(_,N){var z=_[N+1-32],te=_[N+2-32],pe=_[N+3-32],ge=_[N+4-32],we=_[N+5-32],ke=_[N+6-32],Me=_[N+7-32];_[N+0+0]=gt(_[N+0-32],z,te),_[N+1+0]=_[N+0+32]=gt(z,te,pe),_[N+2+0]=_[N+1+32]=_[N+0+64]=gt(te,pe,ge),_[N+3+0]=_[N+2+32]=_[N+1+64]=_[N+0+96]=gt(pe,ge,we),_[N+3+32]=_[N+2+64]=_[N+1+96]=gt(ge,we,ke),_[N+3+64]=_[N+2+96]=gt(we,ke,Me),_[N+3+96]=gt(ke,Me,Me)}function Et(_,N){var z=_[N-1+0],te=_[N-1+32],pe=_[N-1+64],ge=_[N-1-32],we=_[N+0-32],ke=_[N+1-32],Me=_[N+2-32],Ve=_[N+3-32];_[N+0+0]=_[N+1+64]=ge+we+1>>1,_[N+1+0]=_[N+2+64]=we+ke+1>>1,_[N+2+0]=_[N+3+64]=ke+Me+1>>1,_[N+3+0]=Me+Ve+1>>1,_[N+0+96]=gt(pe,te,z),_[N+0+64]=gt(te,z,ge),_[N+0+32]=_[N+1+96]=gt(z,ge,we),_[N+1+32]=_[N+2+96]=gt(ge,we,ke),_[N+2+32]=_[N+3+96]=gt(we,ke,Me),_[N+3+32]=gt(ke,Me,Ve)}function pt(_,N){var z=_[N+0-32],te=_[N+1-32],pe=_[N+2-32],ge=_[N+3-32],we=_[N+4-32],ke=_[N+5-32],Me=_[N+6-32],Ve=_[N+7-32];_[N+0+0]=z+te+1>>1,_[N+1+0]=_[N+0+64]=te+pe+1>>1,_[N+2+0]=_[N+1+64]=pe+ge+1>>1,_[N+3+0]=_[N+2+64]=ge+we+1>>1,_[N+0+32]=gt(z,te,pe),_[N+1+32]=_[N+0+96]=gt(te,pe,ge),_[N+2+32]=_[N+1+96]=gt(pe,ge,we),_[N+3+32]=_[N+2+96]=gt(ge,we,ke),_[N+3+64]=gt(we,ke,Me),_[N+3+96]=gt(ke,Me,Ve)}function yt(_,N){var z=_[N-1+0],te=_[N-1+32],pe=_[N-1+64],ge=_[N-1+96];_[N+0+0]=z+te+1>>1,_[N+2+0]=_[N+0+32]=te+pe+1>>1,_[N+2+32]=_[N+0+64]=pe+ge+1>>1,_[N+1+0]=gt(z,te,pe),_[N+3+0]=_[N+1+32]=gt(te,pe,ge),_[N+3+32]=_[N+1+64]=gt(pe,ge,ge),_[N+3+64]=_[N+2+64]=_[N+0+96]=_[N+1+96]=_[N+2+96]=_[N+3+96]=ge}function ft(_,N){var z=_[N-1+0],te=_[N-1+32],pe=_[N-1+64],ge=_[N-1+96],we=_[N-1-32],ke=_[N+0-32],Me=_[N+1-32],Ve=_[N+2-32];_[N+0+0]=_[N+2+32]=z+we+1>>1,_[N+0+32]=_[N+2+64]=te+z+1>>1,_[N+0+64]=_[N+2+96]=pe+te+1>>1,_[N+0+96]=ge+pe+1>>1,_[N+3+0]=gt(ke,Me,Ve),_[N+2+0]=gt(we,ke,Me),_[N+1+0]=_[N+3+32]=gt(z,we,ke),_[N+1+32]=_[N+3+64]=gt(te,z,we),_[N+1+64]=_[N+3+96]=gt(pe,te,z),_[N+1+96]=gt(ge,pe,te)}function he(_,N){var z;for(z=0;8>z;++z)n(_,N+32*z,_,N-32,8)}function Ne(_,N){var z;for(z=0;8>z;++z)i(_,N,_[N-1],8),N+=32}function Xe(_,N,z){var te;for(te=0;8>te;++te)i(N,z+32*te,_,8)}function At(_,N){var z,te=8;for(z=0;8>z;++z)te+=_[N+z-32]+_[N-1+32*z];Xe(te>>4,_,N)}function Lr(_,N){var z,te=4;for(z=0;8>z;++z)te+=_[N+z-32];Xe(te>>3,_,N)}function xr(_,N){var z,te=4;for(z=0;8>z;++z)te+=_[N-1+32*z];Xe(te>>3,_,N)}function $r(_,N){Xe(128,_,N)}function Dr(_,N,z){var te=_[N-z],pe=_[N+0],ge=3*(pe-te)+J_[1020+_[N-2*z]-_[N+z]],we=$y[112+(ge+4>>3)];_[N-z]=Il[255+te+$y[112+(ge+3>>3)]],_[N+0]=Il[255+pe-we]}function cn(_,N,z,te){var pe=_[N+0],ge=_[N+z];return vc[255+_[N-2*z]-_[N-z]]>te||vc[255+ge-pe]>te}function hn(_,N,z,te){return 4*vc[255+_[N-z]-_[N+0]]+vc[255+_[N-2*z]-_[N+z]]<=te}function yn(_,N,z,te,pe){var ge=_[N-3*z],we=_[N-2*z],ke=_[N-z],Me=_[N+0],Ve=_[N+z],Ot=_[N+2*z],rr=_[N+3*z];return 4*vc[255+ke-Me]+vc[255+we-Ve]>te?0:vc[255+_[N-4*z]-ge]<=pe&&vc[255+ge-we]<=pe&&vc[255+we-ke]<=pe&&vc[255+rr-Ot]<=pe&&vc[255+Ot-Ve]<=pe&&vc[255+Ve-Me]<=pe}function sn(_,N,z,te){var pe=2*te+1;for(te=0;16>te;++te)hn(_,N+te,z,pe)&&Dr(_,N+te,z)}function ir(_,N,z,te){var pe=2*te+1;for(te=0;16>te;++te)hn(_,N+te*z,1,pe)&&Dr(_,N+te*z,1)}function Qr(_,N,z,te){var pe;for(pe=3;0<pe;--pe)sn(_,N+=4*z,z,te)}function vn(_,N,z,te){var pe;for(pe=3;0<pe;--pe)ir(_,N+=4,z,te)}function Kn(_,N,z,te,pe,ge,we,ke){for(ge=2*ge+1;0<pe--;){if(yn(_,N,z,ge,we))if(cn(_,N,z,ke))Dr(_,N,z);else{var Me=_,Ve=N,Ot=z,rr=Me[Ve-2*Ot],Ge=Me[Ve-Ot],Bt=Me[Ve+0],Yt=Me[Ve+Ot],kr=Me[Ve+2*Ot],er=27*(Pr=J_[1020+3*(Bt-Ge)+J_[1020+rr-Yt]])+63>>7,Cr=18*Pr+63>>7,Pr=9*Pr+63>>7;Me[Ve-3*Ot]=Il[255+Me[Ve-3*Ot]+Pr],Me[Ve-2*Ot]=Il[255+rr+Cr],Me[Ve-Ot]=Il[255+Ge+er],Me[Ve+0]=Il[255+Bt-er],Me[Ve+Ot]=Il[255+Yt-Cr],Me[Ve+2*Ot]=Il[255+kr-Pr]}N+=te}}function Bn(_,N,z,te,pe,ge,we,ke){for(ge=2*ge+1;0<pe--;){if(yn(_,N,z,ge,we))if(cn(_,N,z,ke))Dr(_,N,z);else{var Me=_,Ve=N,Ot=z,rr=Me[Ve-Ot],Ge=Me[Ve+0],Bt=Me[Ve+Ot],Yt=$y[112+(4+(kr=3*(Ge-rr))>>3)],kr=$y[112+(kr+3>>3)],er=Yt+1>>1;Me[Ve-2*Ot]=Il[255+Me[Ve-2*Ot]+er],Me[Ve-Ot]=Il[255+rr+kr],Me[Ve+0]=Il[255+Ge-Yt],Me[Ve+Ot]=Il[255+Bt-er]}N+=te}}function ri(_,N,z,te,pe,ge){Kn(_,N,z,1,16,te,pe,ge)}function on(_,N,z,te,pe,ge){Kn(_,N,1,z,16,te,pe,ge)}function Un(_,N,z,te,pe,ge){var we;for(we=3;0<we;--we)Bn(_,N+=4*z,z,1,16,te,pe,ge)}function L(_,N,z,te,pe,ge){var we;for(we=3;0<we;--we)Bn(_,N+=4,1,z,16,te,pe,ge)}function le(_,N,z,te,pe,ge,we,ke){Kn(_,N,pe,1,8,ge,we,ke),Kn(z,te,pe,1,8,ge,we,ke)}function Oe(_,N,z,te,pe,ge,we,ke){Kn(_,N,1,pe,8,ge,we,ke),Kn(z,te,1,pe,8,ge,we,ke)}function dt(_,N,z,te,pe,ge,we,ke){Bn(_,N+4*pe,pe,1,8,ge,we,ke),Bn(z,te+4*pe,pe,1,8,ge,we,ke)}function rt(_,N,z,te,pe,ge,we,ke){Bn(_,N+4,1,pe,8,ge,we,ke),Bn(z,te+4,1,pe,8,ge,we,ke)}function Mt(){this.ba=new Br,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new nn,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function lr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function en(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function bn(){this.ua=0,this.Wa=new me,this.vb=new me,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new H,this.yc=new D}function Dn(){this.xb=this.a=0,this.l=new Mr,this.ca=new Br,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new Y,this.Pb=0,this.wd=new Y,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new bn,this.ab=0,this.gc=o(4,en),this.Oc=0}function zn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Mr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function hi(_,N,z,te,pe,ge,we){for(_=_==null?0:_[N+0],N=0;N<we;++N)pe[ge+N]=_+z[te+N]&255,_=pe[ge+N]}function Ni(_,N,z,te,pe,ge,we){var ke;if(_==null)hi(null,null,z,te,pe,ge,we);else for(ke=0;ke<we;++ke)pe[ge+ke]=_[N+ke]+z[te+ke]&255}function bi(_,N,z,te,pe,ge,we){if(_==null)hi(null,null,z,te,pe,ge,we);else{var ke,Me=_[N+0],Ve=Me,Ot=Me;for(ke=0;ke<we;++ke)Ve=Ot+(Me=_[N+ke])-Ve,Ot=z[te+ke]+(-256&Ve?0>Ve?0:255:Ve)&255,Ve=Me,pe[ge+ke]=Ot}}function Se(_,N,z,te){var pe=N.width,ge=N.o;if(t(_!=null&&N!=null),0>z||0>=te||z+te>ge)return null;if(!_.Cc){if(_.ga==null){var we;if(_.ga=new zn,(we=_.ga==null)||(we=N.width*N.o,t(_.Gb.length==0),_.Gb=s(we),_.Uc=0,_.Gb==null?we=0:(_.mb=_.Gb,_.nb=_.Uc,_.rc=null,we=1),we=!we),!we){we=_.ga;var ke=_.Fa,Me=_.P,Ve=_.qc,Ot=_.mb,rr=_.nb,Ge=Me+1,Bt=Ve-1,Yt=we.l;if(t(ke!=null&&Ot!=null&&N!=null),vf[0]=null,vf[1]=hi,vf[2]=Ni,vf[3]=bi,we.ca=Ot,we.tb=rr,we.c=N.width,we.i=N.height,t(0<we.c&&0<we.i),1>=Ve)N=0;else if(we.$a=3&ke[Me+0],we.Z=ke[Me+0]>>2&3,we.Lc=ke[Me+0]>>4&3,Me=ke[Me+0]>>6&3,0>we.$a||1<we.$a||4<=we.Z||1<we.Lc||Me)N=0;else if(Yt.put=tt,Yt.ac=Te,Yt.bc=st,Yt.ma=we,Yt.width=N.width,Yt.height=N.height,Yt.Da=N.Da,Yt.v=N.v,Yt.va=N.va,Yt.j=N.j,Yt.o=N.o,we.$a)e:{t(we.$a==1),N=Ie();t:for(;;){if(N==null){N=0;break e}if(t(we!=null),we.mc=N,N.c=we.c,N.i=we.i,N.l=we.l,N.l.ma=we,N.l.width=we.c,N.l.height=we.i,N.a=0,V(N.m,ke,Ge,Bt),!Re(we.c,we.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&fe(N.s)?(we.ic=1,ke=N.c*N.i,N.Ta=null,N.Ua=0,N.V=s(ke),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(we.ic=0,N=xt(N,we.c)),!N))break t;N=1;break e}we.mc=null,N=0}else N=Bt>=we.c*we.i;we=!N}if(we)return null;_.ga.Lc!=1?_.Ga=0:te=ge-z}t(_.ga!=null),t(z+te<=ge);e:{if(N=(ke=_.ga).c,ge=ke.l.o,ke.$a==0){if(Ge=_.rc,Bt=_.Vc,Yt=_.Fa,Me=_.P+1+z*N,Ve=_.mb,Ot=_.nb+z*N,t(Me<=_.P+_.qc),ke.Z!=0)for(t(vf[ke.Z]!=null),we=0;we<te;++we)vf[ke.Z](Ge,Bt,Yt,Me,Ve,Ot,N),Ge=Ve,Bt=Ot,Ot+=N,Me+=N;else for(we=0;we<te;++we)n(Ve,Ot,Yt,Me,N),Ge=Ve,Bt=Ot,Ot+=N,Me+=N;_.rc=Ge,_.Vc=Bt}else{if(t(ke.mc!=null),N=z+te,t((we=ke.mc)!=null),t(N<=we.i),we.C>=N)N=1;else if(ke.ic||ur(),ke.ic){ke=we.V,Ge=we.Ba,Bt=we.c;var kr=we.i,er=(Yt=1,Me=we.$/Bt,Ve=we.$%Bt,Ot=we.m,rr=we.s,we.$),Cr=Bt*kr,Pr=Bt*N,Hr=rr.wc,Fr=er<Pr?se(rr,Ve,Me):null;t(er<=Cr),t(N<=kr),t(fe(rr));t:for(;;){for(;!Ot.h&&er<Pr;){if(Ve&Hr||(Fr=se(rr,Ve,Me)),t(Fr!=null),F(Ot),256>(kr=tr(Fr.G[0],Fr.H[0],Ot)))ke[Ge+er]=kr,++er,++Ve>=Bt&&(Ve=0,++Me<=N&&!(Me%16)&&Ce(we,Me));else{if(!(280>kr)){Yt=0;break t}kr=jt(kr-256,Ot);var Ln,Cn=tr(Fr.G[4],Fr.H[4],Ot);if(F(Ot),!(er>=(Cn=ar(Bt,Cn=jt(Cn,Ot)))&&Cr-er>=kr)){Yt=0;break t}for(Ln=0;Ln<kr;++Ln)ke[Ge+er+Ln]=ke[Ge+er+Ln-Cn];for(er+=kr,Ve+=kr;Ve>=Bt;)Ve-=Bt,++Me<=N&&!(Me%16)&&Ce(we,Me);er<Pr&&Ve&Hr&&(Fr=se(rr,Ve,Me))}t(Ot.h==O(Ot))}Ce(we,Me>N?N:Me);break t}!Yt||Ot.h&&er<Cr?(Yt=0,we.a=Ot.h?5:3):we.$=er,N=Yt}else N=wt(we,we.V,we.Ba,we.c,we.i,N,Gt);if(!N){te=0;break e}}z+te>=ge&&(_.Cc=1),te=1}if(!te)return null;if(_.Cc&&((te=_.ga)!=null&&(te.mc=null),_.ga=null,0<_.Ga))return alert("todo:WebPDequantizeLevels"),null}return _.nb+z*pe}function $e(_,N,z,te,pe,ge){for(;0<pe--;){var we,ke=_,Me=N+(z?1:0),Ve=_,Ot=N+(z?0:3);for(we=0;we<te;++we){var rr=Ve[Ot+4*we];rr!=255&&(rr*=32897,ke[Me+4*we+0]=ke[Me+4*we+0]*rr>>23,ke[Me+4*we+1]=ke[Me+4*we+1]*rr>>23,ke[Me+4*we+2]=ke[Me+4*we+2]*rr>>23)}N+=ge}}function ot(_,N,z,te,pe){for(;0<te--;){var ge;for(ge=0;ge<z;++ge){var we=_[N+2*ge+0],ke=15&(Ve=_[N+2*ge+1]),Me=4369*ke,Ve=(240&Ve|Ve>>4)*Me>>16;_[N+2*ge+0]=(240&we|we>>4)*Me>>16&240|(15&we|we<<4)*Me>>16>>4&15,_[N+2*ge+1]=240&Ve|ke}N+=pe}}function We(_,N,z,te,pe,ge,we,ke){var Me,Ve,Ot=255;for(Ve=0;Ve<pe;++Ve){for(Me=0;Me<te;++Me){var rr=_[N+Me];ge[we+4*Me]=rr,Ot&=rr}N+=z,we+=ke}return Ot!=255}function Nt(_,N,z,te,pe){var ge;for(ge=0;ge<pe;++ge)z[te+ge]=_[N+ge]>>8}function ur(){Cg=$e,L6=ot,R6=We,F6=Nt}function zt(_,N,z){M[_]=function(te,pe,ge,we,ke,Me,Ve,Ot,rr,Ge,Bt,Yt,kr,er,Cr,Pr,Hr){var Fr,Ln=Hr-1>>1,Cn=ke[Me+0]|Ve[Ot+0]<<16,li=rr[Ge+0]|Bt[Yt+0]<<16;t(te!=null);var Tn=3*Cn+li+131074>>2;for(N(te[pe+0],255&Tn,Tn>>16,kr,er),ge!=null&&(Tn=3*li+Cn+131074>>2,N(ge[we+0],255&Tn,Tn>>16,Cr,Pr)),Fr=1;Fr<=Ln;++Fr){var vi=ke[Me+Fr]|Ve[Ot+Fr]<<16,js=rr[Ge+Fr]|Bt[Yt+Fr]<<16,ci=Cn+vi+li+js+524296,Pn=ci+2*(vi+li)>>3;Tn=Pn+Cn>>1,Cn=(ci=ci+2*(Cn+js)>>3)+vi>>1,N(te[pe+2*Fr-1],255&Tn,Tn>>16,kr,er+(2*Fr-1)*z),N(te[pe+2*Fr-0],255&Cn,Cn>>16,kr,er+(2*Fr-0)*z),ge!=null&&(Tn=ci+li>>1,Cn=Pn+js>>1,N(ge[we+2*Fr-1],255&Tn,Tn>>16,Cr,Pr+(2*Fr-1)*z),N(ge[we+2*Fr+0],255&Cn,Cn>>16,Cr,Pr+(2*Fr+0)*z)),Cn=vi,li=js}1&Hr||(Tn=3*Cn+li+131074>>2,N(te[pe+Hr-1],255&Tn,Tn>>16,kr,er+(Hr-1)*z),ge!=null&&(Tn=3*li+Cn+131074>>2,N(ge[we+Hr-1],255&Tn,Tn>>16,Cr,Pr+(Hr-1)*z)))}}function Nr(){wc[Uy]=YK,wc[zy]=G6,wc[z6]=XK,wc[Wy]=K6,wc[qy]=Y6,wc[Z_]=X6,wc[W6]=QK,wc[e5]=G6,wc[t5]=K6,wc[Hy]=Y6,wc[r5]=X6}function jr(_){return _&-16384?0>_?0:255:_>>JK}function Ur(_,N){return jr((19077*_>>8)+(26149*N>>8)-14234)}function Or(_,N,z){return jr((19077*_>>8)-(6419*N>>8)-(13320*z>>8)+8708)}function Gr(_,N){return jr((19077*_>>8)+(33050*N>>8)-17685)}function zr(_,N,z,te,pe){te[pe+0]=Ur(_,z),te[pe+1]=Or(_,N,z),te[pe+2]=Gr(_,N)}function Qt(_,N,z,te,pe){te[pe+0]=Gr(_,N),te[pe+1]=Or(_,N,z),te[pe+2]=Ur(_,z)}function mn(_,N,z,te,pe){var ge=Or(_,N,z);N=ge<<3&224|Gr(_,N)>>3,te[pe+0]=248&Ur(_,z)|ge>>5,te[pe+1]=N}function ln(_,N,z,te,pe){var ge=240&Gr(_,N)|15;te[pe+0]=240&Ur(_,z)|Or(_,N,z)>>4,te[pe+1]=ge}function _n(_,N,z,te,pe){te[pe+0]=255,zr(_,N,z,te,pe+1)}function wn(_,N,z,te,pe){Qt(_,N,z,te,pe),te[pe+3]=255}function pn(_,N,z,te,pe){zr(_,N,z,te,pe),te[pe+3]=255}function oi(_,N,z){M[_]=function(te,pe,ge,we,ke,Me,Ve,Ot,rr){for(var Ge=Ot+(-2&rr)*z;Ot!=Ge;)N(te[pe+0],ge[we+0],ke[Me+0],Ve,Ot),N(te[pe+1],ge[we+0],ke[Me+0],Ve,Ot+z),pe+=2,++we,++Me,Ot+=2*z;1&rr&&N(te[pe+0],ge[we+0],ke[Me+0],Ve,Ot)}}function Fn(_,N,z){return z==0?_==0?N==0?6:5:N==0?4:0:z}function pi(_,N,z,te,pe){switch(_>>>30){case 3:Bl(N,z,te,pe,0);break;case 2:bc(N,z,te,pe);break;case 1:Ii(N,z,te,pe)}}function Xn(_,N){var z,te,pe=N.M,ge=N.Nb,we=_.oc,ke=_.pc+40,Me=_.oc,Ve=_.pc+584,Ot=_.oc,rr=_.pc+600;for(z=0;16>z;++z)we[ke+32*z-1]=129;for(z=0;8>z;++z)Me[Ve+32*z-1]=129,Ot[rr+32*z-1]=129;for(0<pe?we[ke-1-32]=Me[Ve-1-32]=Ot[rr-1-32]=129:(i(we,ke-32-1,127,21),i(Me,Ve-32-1,127,9),i(Ot,rr-32-1,127,9)),te=0;te<_.za;++te){var Ge=N.ya[N.aa+te];if(0<te){for(z=-1;16>z;++z)n(we,ke+32*z-4,we,ke+32*z+12,4);for(z=-1;8>z;++z)n(Me,Ve+32*z-4,Me,Ve+32*z+4,4),n(Ot,rr+32*z-4,Ot,rr+32*z+4,4)}var Bt=_.Gd,Yt=_.Hd+te,kr=Ge.ad,er=Ge.Hc;if(0<pe&&(n(we,ke-32,Bt[Yt].y,0,16),n(Me,Ve-32,Bt[Yt].f,0,8),n(Ot,rr-32,Bt[Yt].ea,0,8)),Ge.Za){var Cr=we,Pr=ke-32+16;for(0<pe&&(te>=_.za-1?i(Cr,Pr,Bt[Yt].y[15],4):n(Cr,Pr,Bt[Yt+1].y,0,4)),z=0;4>z;z++)Cr[Pr+128+z]=Cr[Pr+256+z]=Cr[Pr+384+z]=Cr[Pr+0+z];for(z=0;16>z;++z,er<<=2)Cr=we,Pr=ke+J6[z],Qc[Ge.Ob[z]](Cr,Pr),pi(er,kr,16*+z,Cr,Pr)}else if(Cr=Fn(te,pe,Ge.Ob[0]),bf[Cr](we,ke),er!=0)for(z=0;16>z;++z,er<<=2)pi(er,kr,16*+z,we,ke+J6[z]);for(z=Ge.Gc,Cr=Fn(te,pe,Ge.Dd),md[Cr](Me,Ve),md[Cr](Ot,rr),er=kr,Cr=Me,Pr=Ve,255&(Ge=0|z)&&(170&Ge?Nu(er,256,Cr,Pr):ea(er,256,Cr,Pr)),Ge=Ot,er=rr,255&(z>>=8)&&(170&z?Nu(kr,320,Ge,er):ea(kr,320,Ge,er)),pe<_.Ub-1&&(n(Bt[Yt].y,0,we,ke+480,16),n(Bt[Yt].f,0,Me,Ve+224,8),n(Bt[Yt].ea,0,Ot,rr+224,8)),z=8*ge*_.B,Bt=_.sa,Yt=_.ta+16*te+16*ge*_.R,kr=_.qa,Ge=_.ra+8*te+z,er=_.Ha,Cr=_.Ia+8*te+z,z=0;16>z;++z)n(Bt,Yt+z*_.R,we,ke+32*z,16);for(z=0;8>z;++z)n(kr,Ge+z*_.B,Me,Ve+32*z,8),n(er,Cr+z*_.B,Ot,rr+32*z,8)}}function ca(_,N,z,te,pe,ge,we,ke,Me){var Ve=[0],Ot=[0],rr=0,Ge=Me!=null?Me.kd:0,Bt=Me??new lr;if(_==null||12>z)return 7;Bt.data=_,Bt.w=N,Bt.ha=z,N=[N],z=[z],Bt.gb=[Bt.gb];e:{var Yt=N,kr=z,er=Bt.gb;if(t(_!=null),t(kr!=null),t(er!=null),er[0]=0,12<=kr[0]&&!r(_,Yt[0],"RIFF")){if(r(_,Yt[0]+8,"WEBP")){er=3;break e}var Cr=ie(_,Yt[0]+4);if(12>Cr||4294967286<Cr){er=3;break e}if(Ge&&Cr>kr[0]-8){er=7;break e}er[0]=Cr,Yt[0]+=12,kr[0]-=12}er=0}if(er!=0)return er;for(Cr=0<Bt.gb[0],z=z[0];;){e:{var Pr=_;kr=N,er=z;var Hr=Ve,Fr=Ot,Ln=Yt=[0];if((Tn=rr=[rr])[0]=0,8>er[0])er=7;else{if(!r(Pr,kr[0],"VP8X")){if(ie(Pr,kr[0]+4)!=10){er=3;break e}if(18>er[0]){er=7;break e}var Cn=ie(Pr,kr[0]+8),li=1+I(Pr,kr[0]+12);if(2147483648<=li*(Pr=1+I(Pr,kr[0]+15))){er=3;break e}Ln!=null&&(Ln[0]=Cn),Hr!=null&&(Hr[0]=li),Fr!=null&&(Fr[0]=Pr),kr[0]+=18,er[0]-=18,Tn[0]=1}er=0}}if(rr=rr[0],Yt=Yt[0],er!=0)return er;if(kr=!!(2&Yt),!Cr&&rr)return 3;if(ge!=null&&(ge[0]=!!(16&Yt)),we!=null&&(we[0]=kr),ke!=null&&(ke[0]=0),we=Ve[0],Yt=Ot[0],rr&&kr&&Me==null){er=0;break}if(4>z){er=7;break}if(Cr&&rr||!Cr&&!rr&&!r(_,N[0],"ALPH")){z=[z],Bt.na=[Bt.na],Bt.P=[Bt.P],Bt.Sa=[Bt.Sa];e:{Cn=_,er=N,Cr=z;var Tn=Bt.gb;Hr=Bt.na,Fr=Bt.P,Ln=Bt.Sa,li=22,t(Cn!=null),t(Cr!=null),Pr=er[0];var vi=Cr[0];for(t(Hr!=null),t(Ln!=null),Hr[0]=null,Fr[0]=null,Ln[0]=0;;){if(er[0]=Pr,Cr[0]=vi,8>vi){er=7;break e}var js=ie(Cn,Pr+4);if(4294967286<js){er=3;break e}var ci=8+js+1&-2;if(li+=ci,0<Tn&&li>Tn){er=3;break e}if(!r(Cn,Pr,"VP8 ")||!r(Cn,Pr,"VP8L")){er=0;break e}if(vi[0]<ci){er=7;break e}r(Cn,Pr,"ALPH")||(Hr[0]=Cn,Fr[0]=Pr+8,Ln[0]=js),Pr+=ci,vi-=ci}}if(z=z[0],Bt.na=Bt.na[0],Bt.P=Bt.P[0],Bt.Sa=Bt.Sa[0],er!=0)break}z=[z],Bt.Ja=[Bt.Ja],Bt.xa=[Bt.xa];e:if(Tn=_,er=N,Cr=z,Hr=Bt.gb[0],Fr=Bt.Ja,Ln=Bt.xa,Cn=er[0],Pr=!r(Tn,Cn,"VP8 "),li=!r(Tn,Cn,"VP8L"),t(Tn!=null),t(Cr!=null),t(Fr!=null),t(Ln!=null),8>Cr[0])er=7;else{if(Pr||li){if(Tn=ie(Tn,Cn+4),12<=Hr&&Tn>Hr-12){er=3;break e}if(Ge&&Tn>Cr[0]-8){er=7;break e}Fr[0]=Tn,er[0]+=8,Cr[0]-=8,Ln[0]=li}else Ln[0]=5<=Cr[0]&&Tn[Cn+0]==47&&!(Tn[Cn+4]>>5),Fr[0]=Cr[0];er=0}if(z=z[0],Bt.Ja=Bt.Ja[0],Bt.xa=Bt.xa[0],N=N[0],er!=0)break;if(4294967286<Bt.Ja)return 3;if(ke==null||kr||(ke[0]=Bt.xa?2:1),we=[we],Yt=[Yt],Bt.xa){if(5>z){er=7;break}ke=we,Ge=Yt,kr=ge,_==null||5>z?_=0:5<=z&&_[N+0]==47&&!(_[N+4]>>5)?(Cr=[0],Tn=[0],Hr=[0],V(Fr=new Y,_,N,z),kt(Fr,Cr,Tn,Hr)?(ke!=null&&(ke[0]=Cr[0]),Ge!=null&&(Ge[0]=Tn[0]),kr!=null&&(kr[0]=Hr[0]),_=1):_=0):_=0}else{if(10>z){er=7;break}ke=Yt,_==null||10>z||!Ye(_,N+3,z-3)?_=0:(Ge=_[N+0]|_[N+1]<<8|_[N+2]<<16,kr=16383&(_[N+7]<<8|_[N+6]),_=16383&(_[N+9]<<8|_[N+8]),1&Ge||3<(Ge>>1&7)||!(Ge>>4&1)||Ge>>5>=Bt.Ja||!kr||!_?_=0:(we&&(we[0]=kr),ke&&(ke[0]=_),_=1))}if(!_||(we=we[0],Yt=Yt[0],rr&&(Ve[0]!=we||Ot[0]!=Yt)))return 3;Me!=null&&(Me[0]=Bt,Me.offset=N-Me.w,t(4294967286>N-Me.w),t(Me.offset==Me.ha-z));break}return er==0||er==7&&rr&&Me==null?(ge!=null&&(ge[0]|=Bt.na!=null&&0<Bt.na.length),te!=null&&(te[0]=we),pe!=null&&(pe[0]=Yt),0):er}function Rl(_,N,z){var te=N.width,pe=N.height,ge=0,we=0,ke=te,Me=pe;if(N.Da=_!=null&&0<_.Da,N.Da&&(ke=_.cd,Me=_.bd,ge=_.v,we=_.j,11>z||(ge&=-2,we&=-2),0>ge||0>we||0>=ke||0>=Me||ge+ke>te||we+Me>pe))return 0;if(N.v=ge,N.j=we,N.va=ge+ke,N.o=we+Me,N.U=ke,N.T=Me,N.da=_!=null&&0<_.da,N.da){if(!Pe(ke,Me,z=[_.ib],ge=[_.hb]))return 0;N.ib=z[0],N.hb=ge[0]}return N.ob=_!=null&&_.ob,N.Kb=_==null||!_.Sd,N.da&&(N.ob=N.ib<3*te/4&&N.hb<3*pe/4,N.Kb=0),1}function Ko(_){if(_==null)return 2;if(11>_.S){var N=_.f.RGBA;N.fb+=(_.height-1)*N.A,N.A=-N.A}else N=_.f.kb,_=_.height,N.O+=(_-1)*N.fa,N.fa=-N.fa,N.N+=(_-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(_-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(_-1)*N.lb,N.lb=-N.lb);return 0}function wo(_,N,z,te){if(te==null||0>=_||0>=N)return 2;if(z!=null){if(z.Da){var pe=z.cd,ge=z.bd,we=-2&z.v,ke=-2&z.j;if(0>we||0>ke||0>=pe||0>=ge||we+pe>_||ke+ge>N)return 2;_=pe,N=ge}if(z.da){if(!Pe(_,N,pe=[z.ib],ge=[z.hb]))return 2;_=pe[0],N=ge[0]}}te.width=_,te.height=N;e:{var Me=te.width,Ve=te.height;if(_=te.S,0>=Me||0>=Ve||!(_>=Uy&&13>_))_=2;else{if(0>=te.Rd&&te.sd==null){we=ge=pe=N=0;var Ot=(ke=Me*Z6[_])*Ve;if(11>_||(ge=(Ve+1)/2*(N=(Me+1)/2),_==12&&(we=(pe=Me)*Ve)),(Ve=s(Ot+2*ge+we))==null){_=1;break e}te.sd=Ve,11>_?((Me=te.f.RGBA).eb=Ve,Me.fb=0,Me.A=ke,Me.size=Ot):((Me=te.f.kb).y=Ve,Me.O=0,Me.fa=ke,Me.Fd=Ot,Me.f=Ve,Me.N=0+Ot,Me.Ab=N,Me.Cd=ge,Me.ea=Ve,Me.W=0+Ot+ge,Me.Db=N,Me.Ed=ge,_==12&&(Me.F=Ve,Me.J=0+Ot+2*ge),Me.Tc=we,Me.lb=pe)}if(N=1,pe=te.S,ge=te.width,we=te.height,pe>=Uy&&13>pe)if(11>pe)_=te.f.RGBA,N&=(ke=Math.abs(_.A))*(we-1)+ge<=_.size,N&=ke>=ge*Z6[pe],N&=_.eb!=null;else{_=te.f.kb,ke=(ge+1)/2,Ot=(we+1)/2,Me=Math.abs(_.fa),Ve=Math.abs(_.Ab);var rr=Math.abs(_.Db),Ge=Math.abs(_.lb),Bt=Ge*(we-1)+ge;N&=Me*(we-1)+ge<=_.Fd,N&=Ve*(Ot-1)+ke<=_.Cd,N=(N&=rr*(Ot-1)+ke<=_.Ed)&Me>=ge&Ve>=ke&rr>=ke,N&=_.y!=null,N&=_.f!=null,N&=_.ea!=null,pe==12&&(N&=Ge>=ge,N&=Bt<=_.Tc,N&=_.F!=null)}else N=0;_=N?0:2}}return _!=0||z!=null&&z.fd&&(_=Ko(te)),_}var So=64,ws=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ba=24,cs=32,Bi=8,Aa=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_e("Predictor0","PredictorAdd0"),M.Predictor0=function(){return 4278190080},M.Predictor1=function(_){return _},M.Predictor2=function(_,N,z){return N[z+0]},M.Predictor3=function(_,N,z){return N[z+1]},M.Predictor4=function(_,N,z){return N[z-1]},M.Predictor5=function(_,N,z){return qe(qe(_,N[z+1]),N[z+0])},M.Predictor6=function(_,N,z){return qe(_,N[z-1])},M.Predictor7=function(_,N,z){return qe(_,N[z+0])},M.Predictor8=function(_,N,z){return qe(N[z-1],N[z+0])},M.Predictor9=function(_,N,z){return qe(N[z+0],N[z+1])},M.Predictor10=function(_,N,z){return qe(qe(_,N[z-1]),qe(N[z+0],N[z+1]))},M.Predictor11=function(_,N,z){var te=N[z+0];return 0>=Ke(te>>24&255,_>>24&255,(N=N[z-1])>>24&255)+Ke(te>>16&255,_>>16&255,N>>16&255)+Ke(te>>8&255,_>>8&255,N>>8&255)+Ke(255&te,255&_,255&N)?te:_},M.Predictor12=function(_,N,z){var te=N[z+0];return(Pt((_>>24&255)+(te>>24&255)-((N=N[z-1])>>24&255))<<24|Pt((_>>16&255)+(te>>16&255)-(N>>16&255))<<16|Pt((_>>8&255)+(te>>8&255)-(N>>8&255))<<8|Pt((255&_)+(255&te)-(255&N)))>>>0},M.Predictor13=function(_,N,z){var te=N[z-1];return(ut((_=qe(_,N[z+0]))>>24&255,te>>24&255)<<24|ut(_>>16&255,te>>16&255)<<16|ut(_>>8&255,te>>8&255)<<8|ut(255&_,255&te))>>>0};var to=M.PredictorAdd0;M.PredictorAdd1=lt,_e("Predictor2","PredictorAdd2"),_e("Predictor3","PredictorAdd3"),_e("Predictor4","PredictorAdd4"),_e("Predictor5","PredictorAdd5"),_e("Predictor6","PredictorAdd6"),_e("Predictor7","PredictorAdd7"),_e("Predictor8","PredictorAdd8"),_e("Predictor9","PredictorAdd9"),_e("Predictor10","PredictorAdd10"),_e("Predictor11","PredictorAdd11"),_e("Predictor12","PredictorAdd12"),_e("Predictor13","PredictorAdd13");var Au=M.PredictorAdd2;be("ColorIndexInverseTransform","MapARGB","32b",function(_){return _>>8&255},function(_){return _}),be("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(_){return _},function(_){return _>>8&255});var Ci,$n=M.ColorIndexInverseTransform,Yi=M.MapARGB,Ss=M.VP8LColorIndexInverseTransformAlpha,hd=M.MapAlpha,Xc=M.VP8LPredictorsAdd=[];Xc.length=16,(M.VP8LPredictors=[]).length=16,(M.VP8LPredictorsAdd_C=[]).length=16,(M.VP8LPredictors_C=[]).length=16;var gc,xc,Yo,ro,pl,yc,Fl,Bl,bc,Nu,Ii,ea,Xa,_s,pd,Ng,up,Dy,C6,E6,T6,P6,O6,M6,Cg,L6,R6,F6,B6=s(511),I6=s(2041),D6=s(225),$6=s(767),U6=0,J_=I6,$y=D6,Il=$6,vc=B6,Uy=0,zy=1,z6=2,Wy=3,qy=4,Z_=5,W6=6,e5=7,t5=8,Hy=9,r5=10,RK=[2,3,7],FK=[3,3,11],q6=[280,256,256,256,40],BK=[0,1,1,1,0],IK=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],DK=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],$K=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],UK=8,n5=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],i5=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Eg=null,zK=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],WK=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],H6=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],qK=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],HK=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],VK=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],GK=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],bf=[],Qc=[],md=[],KK=1,V6=2,vf=[],wc=[];zt("UpsampleRgbLinePair",zr,3),zt("UpsampleBgrLinePair",Qt,3),zt("UpsampleRgbaLinePair",pn,4),zt("UpsampleBgraLinePair",wn,4),zt("UpsampleArgbLinePair",_n,4),zt("UpsampleRgba4444LinePair",ln,2),zt("UpsampleRgb565LinePair",mn,2);var YK=M.UpsampleRgbLinePair,XK=M.UpsampleBgrLinePair,G6=M.UpsampleRgbaLinePair,K6=M.UpsampleBgraLinePair,Y6=M.UpsampleArgbLinePair,X6=M.UpsampleRgba4444LinePair,QK=M.UpsampleRgb565LinePair,Vy=16,Gy=1<<Vy-1,Tg=-227,a5=482,JK=6,Q6=0,ZK=s(256),eY=s(256),tY=s(256),rY=s(256),nY=s(a5-Tg),iY=s(a5-Tg);oi("YuvToRgbRow",zr,3),oi("YuvToBgrRow",Qt,3),oi("YuvToRgbaRow",pn,4),oi("YuvToBgraRow",wn,4),oi("YuvToArgbRow",_n,4),oi("YuvToRgba4444Row",ln,2),oi("YuvToRgb565Row",mn,2);var J6=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Ky=[0,2,8],aY=[8,7,6,4,4,2,2,2,1,1,1,1],sY=1;this.WebPDecodeRGBA=function(_,N,z,te,pe){var ge=zy,we=new Mt,ke=new Br;we.ba=ke,ke.S=ge,ke.width=[ke.width],ke.height=[ke.height];var Me=ke.width,Ve=ke.height,Ot=new Wr;if(Ot==null||_==null)var rr=2;else t(Ot!=null),rr=ca(_,N,z,Ot.width,Ot.height,Ot.Pd,Ot.Qd,Ot.format,null);if(rr!=0?Me=0:(Me!=null&&(Me[0]=Ot.width[0]),Ve!=null&&(Ve[0]=Ot.height[0]),Me=1),Me){ke.width=ke.width[0],ke.height=ke.height[0],te!=null&&(te[0]=ke.width),pe!=null&&(pe[0]=ke.height);e:{if(te=new Mr,(pe=new lr).data=_,pe.w=N,pe.ha=z,pe.kd=1,N=[0],t(pe!=null),((_=ca(pe.data,pe.w,pe.ha,null,null,null,N,null,pe))==0||_==7)&&N[0]&&(_=4),(N=_)==0){if(t(we!=null),te.data=pe.data,te.w=pe.w+pe.offset,te.ha=pe.ha-pe.offset,te.put=tt,te.ac=Te,te.bc=st,te.ma=we,pe.xa){if((_=Ie())==null){we=1;break e}if(function(Ge,Bt){var Yt=[0],kr=[0],er=[0];t:for(;;){if(Ge==null)return 0;if(Bt==null)return Ge.a=2,0;if(Ge.l=Bt,Ge.a=0,V(Ge.m,Bt.data,Bt.w,Bt.ha),!kt(Ge.m,Yt,kr,er)){Ge.a=3;break t}if(Ge.xb=V6,Bt.width=Yt[0],Bt.height=kr[0],!Re(Yt[0],kr[0],1,Ge,null))break t;return 1}return t(Ge.a!=0),0}(_,te)){if(te=(N=wo(te.width,te.height,we.Oa,we.ba))==0){t:{te=_;r:for(;;){if(te==null){te=0;break t}if(t(te.s.yc!=null),t(te.s.Ya!=null),t(0<te.s.Wb),t((z=te.l)!=null),t((pe=z.ma)!=null),te.xb!=0){if(te.ca=pe.ba,te.tb=pe.tb,t(te.ca!=null),!Rl(pe.Oa,z,Wy)){te.a=2;break r}if(!xt(te,z.width)||z.da)break r;if((z.da||Ar(te.ca.S))&&ur(),11>te.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),te.ca.f.kb.F!=null&&ur()),te.Pb&&0<te.s.ua&&te.s.vb.X==null&&!U(te.s.vb,te.s.Wa.Xa)){te.a=1;break r}te.xb=0}if(!wt(te,te.V,te.Ba,te.c,te.i,z.o,J))break r;pe.Dc=te.Ma,te=1;break t}t(te.a!=0),te=0}te=!te}te&&(N=_.a)}else N=_.a}else{if((_=new an)==null){we=1;break e}if(_.Fa=pe.na,_.P=pe.P,_.qc=pe.Sa,ct(_,te)){if((N=wo(te.width,te.height,we.Oa,we.ba))==0){if(_.Aa=0,z=we.Oa,t((pe=_)!=null),z!=null){if(0<(Me=0>(Me=z.Md)?0:100<Me?255:255*Me/100)){for(Ve=Ot=0;4>Ve;++Ve)12>(rr=pe.pb[Ve]).lc&&(rr.ia=Me*aY[0>rr.lc?0:rr.lc]>>3),Ot|=rr.ia;Ot&&(alert("todo:VP8InitRandom"),pe.ia=1)}pe.Ga=z.Id,100<pe.Ga?pe.Ga=100:0>pe.Ga&&(pe.Ga=0)}(function(Ge,Bt){if(Ge==null)return 0;if(Bt==null)return it(Ge,2,"NULL VP8Io parameter in VP8Decode().");if(!Ge.cb&&!ct(Ge,Bt))return 0;if(t(Ge.cb),Bt.ac==null||Bt.ac(Bt)){Bt.ob&&(Ge.L=0);var Yt=Ky[Ge.L];if(Ge.L==2?(Ge.yb=0,Ge.zb=0):(Ge.yb=Bt.v-Yt>>4,Ge.zb=Bt.j-Yt>>4,0>Ge.yb&&(Ge.yb=0),0>Ge.zb&&(Ge.zb=0)),Ge.Va=Bt.o+15+Yt>>4,Ge.Hb=Bt.va+15+Yt>>4,Ge.Hb>Ge.za&&(Ge.Hb=Ge.za),Ge.Va>Ge.Ub&&(Ge.Va=Ge.Ub),0<Ge.L){var kr=Ge.ed;for(Yt=0;4>Yt;++Yt){var er;if(Ge.Qa.Cb){var Cr=Ge.Qa.Lb[Yt];Ge.Qa.Fb||(Cr+=kr.Tb)}else Cr=kr.Tb;for(er=0;1>=er;++er){var Pr=Ge.gd[Yt][er],Hr=Cr;if(kr.Pc&&(Hr+=kr.vd[0],er&&(Hr+=kr.od[0])),0<(Hr=0>Hr?0:63<Hr?63:Hr)){var Fr=Hr;0<kr.wb&&(Fr=4<kr.wb?Fr>>2:Fr>>1)>9-kr.wb&&(Fr=9-kr.wb),1>Fr&&(Fr=1),Pr.dd=Fr,Pr.tc=2*Hr+Fr,Pr.ld=40<=Hr?2:15<=Hr?1:0}else Pr.tc=0;Pr.La=er}}}Yt=0}else it(Ge,6,"Frame setup failed"),Yt=Ge.a;if(Yt=Yt==0){if(Yt){Ge.$c=0,0<Ge.Aa||(Ge.Ic=sY);t:{Yt=Ge.Ic,kr=4*(Fr=Ge.za);var Ln=32*Fr,Cn=Fr+1,li=0<Ge.L?Fr*(0<Ge.Aa?2:1):0,Tn=(Ge.Aa==2?2:1)*Fr;if((Pr=kr+832+(er=3*(16*Yt+Ky[Ge.L])/2*Ln)+(Cr=Ge.Fa!=null&&0<Ge.Fa.length?Ge.Kc.c*Ge.Kc.i:0))!=Pr)Yt=0;else{if(Pr>Ge.Vb){if(Ge.Vb=0,Ge.Ec=s(Pr),Ge.Fc=0,Ge.Ec==null){Yt=it(Ge,1,"no memory during frame initialization.");break t}Ge.Vb=Pr}Pr=Ge.Ec,Hr=Ge.Fc,Ge.Ac=Pr,Ge.Bc=Hr,Hr+=kr,Ge.Gd=o(Ln,xn),Ge.Hd=0,Ge.rb=o(Cn+1,cr),Ge.sb=1,Ge.wa=li?o(li,br):null,Ge.Y=0,Ge.D.Nb=0,Ge.D.wa=Ge.wa,Ge.D.Y=Ge.Y,0<Ge.Aa&&(Ge.D.Y+=Fr),t(!0),Ge.oc=Pr,Ge.pc=Hr,Hr+=832,Ge.ya=o(Tn,Kr),Ge.aa=0,Ge.D.ya=Ge.ya,Ge.D.aa=Ge.aa,Ge.Aa==2&&(Ge.D.aa+=Fr),Ge.R=16*Fr,Ge.B=8*Fr,Fr=(Ln=Ky[Ge.L])*Ge.R,Ln=Ln/2*Ge.B,Ge.sa=Pr,Ge.ta=Hr+Fr,Ge.qa=Ge.sa,Ge.ra=Ge.ta+16*Yt*Ge.R+Ln,Ge.Ha=Ge.qa,Ge.Ia=Ge.ra+8*Yt*Ge.B+Ln,Ge.$c=0,Hr+=er,Ge.mb=Cr?Pr:null,Ge.nb=Cr?Hr:null,t(Hr+Cr<=Ge.Fc+Ge.Vb),fr(Ge),i(Ge.Ac,Ge.Bc,0,kr),Yt=1}}if(Yt){if(Bt.ka=0,Bt.y=Ge.sa,Bt.O=Ge.ta,Bt.f=Ge.qa,Bt.N=Ge.ra,Bt.ea=Ge.Ha,Bt.Vd=Ge.Ia,Bt.fa=Ge.R,Bt.Rc=Ge.B,Bt.F=null,Bt.J=0,!U6){for(Yt=-255;255>=Yt;++Yt)B6[255+Yt]=0>Yt?-Yt:Yt;for(Yt=-1020;1020>=Yt;++Yt)I6[1020+Yt]=-128>Yt?-128:127<Yt?127:Yt;for(Yt=-112;112>=Yt;++Yt)D6[112+Yt]=-16>Yt?-16:15<Yt?15:Yt;for(Yt=-255;510>=Yt;++Yt)$6[255+Yt]=0>Yt?0:255<Yt?255:Yt;U6=1}Fl=Vt,Bl=bt,Nu=St,Ii=Ct,ea=$t,bc=nt,Xa=ri,_s=on,pd=le,Ng=Oe,up=Un,Dy=L,C6=dt,E6=rt,T6=sn,P6=ir,O6=Qr,M6=vn,Qc[0]=Ut,Qc[1]=ze,Qc[2]=vr,Qc[3]=Je,Qc[4]=Le,Qc[5]=Et,Qc[6]=Be,Qc[7]=pt,Qc[8]=ft,Qc[9]=yt,bf[0]=Xt,bf[1]=_t,bf[2]=Ft,bf[3]=pr,bf[4]=xe,bf[5]=Ee,bf[6]=De,md[0]=At,md[1]=at,md[2]=he,md[3]=Ne,md[4]=xr,md[5]=Lr,md[6]=$r,Yt=1}else Yt=0}Yt&&(Yt=function(vi,js){for(vi.M=0;vi.M<vi.Va;++vi.M){var ci,Pn=vi.Jc[vi.M&vi.Xb],un=vi.m,Qa=vi;for(ci=0;ci<Qa.za;++ci){var ni=un,wi=Qa,ua=wi.Ac,no=wi.Bc+4*ci,Xo=wi.zc,Ba=wi.ya[wi.aa+ci];if(wi.Qa.Bb?Ba.$b=ne(ni,wi.Pa.jb[0])?2+ne(ni,wi.Pa.jb[2]):ne(ni,wi.Pa.jb[1]):Ba.$b=0,wi.kc&&(Ba.Ad=ne(ni,wi.Bd)),Ba.Za=!ne(ni,145)+0,Ba.Za){var _o=Ba.Ob,Qo=0;for(wi=0;4>wi;++wi){var ks,_i=Xo[0+wi];for(ks=0;4>ks;++ks){_i=HK[ua[no+ks]][_i];for(var $i=H6[ne(ni,_i[0])];0<$i;)$i=H6[2*$i+ne(ni,_i[$i])];_i=-$i,ua[no+ks]=_i}n(_o,Qo,ua,no,4),Qo+=4,Xo[0+wi]=_i}}else _i=ne(ni,156)?ne(ni,128)?1:3:ne(ni,163)?2:0,Ba.Ob[0]=_i,i(ua,no,_i,4),i(Xo,0,_i,4);Ba.Dd=ne(ni,142)?ne(ni,114)?ne(ni,183)?1:3:2:0}if(Qa.m.Ka)return it(vi,7,"Premature end-of-partition0 encountered.");for(;vi.ja<vi.za;++vi.ja){if(Qa=Pn,ni=(un=vi).rb[un.sb-1],ua=un.rb[un.sb+un.ja],ci=un.ya[un.aa+un.ja],no=un.kc?ci.Ad:0)ni.la=ua.la=0,ci.Za||(ni.Na=ua.Na=0),ci.Hc=0,ci.Gc=0,ci.ia=0;else{var Ia,Ui;if(ni=ua,ua=Qa,no=un.Pa.Xc,Xo=un.ya[un.aa+un.ja],Ba=un.pb[Xo.$b],wi=Xo.ad,_o=0,Qo=un.rb[un.sb-1],_i=ks=0,i(wi,_o,0,384),Xo.Za)var io=0,Jc=no[3];else{$i=s(16);var Ja=ni.Na+Qo.Na;if(Ja=Eg(ua,no[1],Ja,Ba.Eb,0,$i,0),ni.Na=Qo.Na=(0<Ja)+0,1<Ja)Fl($i,0,wi,_o);else{var ml=$i[0]+3>>3;for($i=0;256>$i;$i+=16)wi[_o+$i]=ml}io=1,Jc=no[0]}var ta=15&ni.la,As=15&Qo.la;for($i=0;4>$i;++$i){var Dl=1&As;for(ml=Ui=0;4>ml;++ml)ta=ta>>1|(Dl=(Ja=Eg(ua,Jc,Ja=Dl+(1&ta),Ba.Sc,io,wi,_o))>io)<<7,Ui=Ui<<2|(3<Ja?3:1<Ja?2:wi[_o+0]!=0),_o+=16;ta>>=4,As=As>>1|Dl<<7,ks=(ks<<8|Ui)>>>0}for(Jc=ta,io=As>>4,Ia=0;4>Ia;Ia+=2){for(Ui=0,ta=ni.la>>4+Ia,As=Qo.la>>4+Ia,$i=0;2>$i;++$i){for(Dl=1&As,ml=0;2>ml;++ml)Ja=Dl+(1&ta),ta=ta>>1|(Dl=0<(Ja=Eg(ua,no[2],Ja,Ba.Qc,0,wi,_o)))<<3,Ui=Ui<<2|(3<Ja?3:1<Ja?2:wi[_o+0]!=0),_o+=16;ta>>=2,As=As>>1|Dl<<5}_i|=Ui<<4*Ia,Jc|=ta<<4<<Ia,io|=(240&As)<<Ia}ni.la=Jc,Qo.la=io,Xo.Hc=ks,Xo.Gc=_i,Xo.ia=43690&_i?0:Ba.ia,no=!(ks|_i)}if(0<un.L&&(un.wa[un.Y+un.ja]=un.gd[ci.$b][ci.Za],un.wa[un.Y+un.ja].La|=!no),Qa.Ka)return it(vi,7,"Premature end-of-file encountered.")}if(fr(vi),un=js,Qa=1,ci=(Pn=vi).D,ni=0<Pn.L&&Pn.M>=Pn.zb&&Pn.M<=Pn.Va,Pn.Aa==0)t:{if(ci.M=Pn.M,ci.uc=ni,Xn(Pn,ci),Qa=1,ci=(Ui=Pn.D).Nb,ni=(_i=Ky[Pn.L])*Pn.R,ua=_i/2*Pn.B,$i=16*ci*Pn.R,ml=8*ci*Pn.B,no=Pn.sa,Xo=Pn.ta-ni+$i,Ba=Pn.qa,wi=Pn.ra-ua+ml,_o=Pn.Ha,Qo=Pn.Ia-ua+ml,As=(ta=Ui.M)==0,ks=ta>=Pn.Va-1,Pn.Aa==2&&Xn(Pn,Ui),Ui.uc)for(Dl=(Ja=Pn).D.M,t(Ja.D.uc),Ui=Ja.yb;Ui<Ja.Hb;++Ui){io=Ui,Jc=Dl;var Jo=($l=(ao=Ja).D).Nb;Ia=ao.R;var $l=$l.wa[$l.Y+io],Ul=ao.sa,gl=ao.ta+16*Jo*Ia+16*io,zl=$l.dd,aa=$l.tc;if(aa!=0)if(t(3<=aa),ao.L==1)0<io&&P6(Ul,gl,Ia,aa+4),$l.La&&M6(Ul,gl,Ia,aa),0<Jc&&T6(Ul,gl,Ia,aa+4),$l.La&&O6(Ul,gl,Ia,aa);else{var Wl=ao.B,Zc=ao.qa,Oh=ao.ra+8*Jo*Wl+8*io,gd=ao.Ha,ao=ao.Ia+8*Jo*Wl+8*io;Jo=$l.ld,0<io&&(_s(Ul,gl,Ia,aa+4,zl,Jo),Ng(Zc,Oh,gd,ao,Wl,aa+4,zl,Jo)),$l.La&&(Dy(Ul,gl,Ia,aa,zl,Jo),E6(Zc,Oh,gd,ao,Wl,aa,zl,Jo)),0<Jc&&(Xa(Ul,gl,Ia,aa+4,zl,Jo),pd(Zc,Oh,gd,ao,Wl,aa+4,zl,Jo)),$l.La&&(up(Ul,gl,Ia,aa,zl,Jo),C6(Zc,Oh,gd,ao,Wl,aa,zl,Jo))}}if(Pn.ia&&alert("todo:DitherRow"),un.put!=null){if(Ui=16*ta,ta=16*(ta+1),As?(un.y=Pn.sa,un.O=Pn.ta+$i,un.f=Pn.qa,un.N=Pn.ra+ml,un.ea=Pn.Ha,un.W=Pn.Ia+ml):(Ui-=_i,un.y=no,un.O=Xo,un.f=Ba,un.N=wi,un.ea=_o,un.W=Qo),ks||(ta-=_i),ta>un.o&&(ta=un.o),un.F=null,un.J=null,Pn.Fa!=null&&0<Pn.Fa.length&&Ui<ta&&(un.J=Se(Pn,un,Ui,ta-Ui),un.F=Pn.mb,un.F==null&&un.F.length==0)){Qa=it(Pn,3,"Could not decode alpha data.");break t}Ui<un.j&&(_i=un.j-Ui,Ui=un.j,t(!(1&_i)),un.O+=Pn.R*_i,un.N+=Pn.B*(_i>>1),un.W+=Pn.B*(_i>>1),un.F!=null&&(un.J+=un.width*_i)),Ui<ta&&(un.O+=un.v,un.N+=un.v>>1,un.W+=un.v>>1,un.F!=null&&(un.J+=un.v),un.ka=Ui-un.j,un.U=un.va-un.v,un.T=ta-Ui,Qa=un.put(un))}ci+1!=Pn.Ic||ks||(n(Pn.sa,Pn.ta-ni,no,Xo+16*Pn.R,ni),n(Pn.qa,Pn.ra-ua,Ba,wi+8*Pn.B,ua),n(Pn.Ha,Pn.Ia-ua,_o,Qo+8*Pn.B,ua))}if(!Qa)return it(vi,6,"Output aborted.")}return 1}(Ge,Bt)),Bt.bc!=null&&Bt.bc(Bt),Yt&=1}return Yt?(Ge.cb=0,Yt):0})(_,te)||(N=_.a)}}else N=_.a}N==0&&we.Oa!=null&&we.Oa.fd&&(N=Ko(we.ba))}we=N}ge=we!=0?null:11>ge?ke.f.RGBA.eb:ke.f.kb.y}else ge=null;return ge};var Z6=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(M,B){for(var E="",P=0;P<4;P++)E+=String.fromCharCode(M[B++]);return E}function d(M,B){return M[B+0]|M[B+1]<<8}function f(M,B){return(M[B+0]|M[B+1]<<8|M[B+2]<<16)>>>0}function p(M,B){return(M[B+0]|M[B+1]<<8|M[B+2]<<16|M[B+3]<<24)>>>0}new c;var h=[0],m=[0],g=[],y=new c,b=e,v=function(M,B){var E={},P=0,D=!1,G=0,H=0;if(E.frames=[],!function(C,Y){for(var q=0;q<4;q++)if(C[Y+q]!="RIFF".charCodeAt(q))return!0;return!1}(M,B)){for(p(M,B+=4),B+=8;B<M.length;){var oe=u(M,B),de=p(M,B+=4);B+=4;var W=de+(1&de);switch(oe){case"VP8 ":case"VP8L":E.frames[P]===void 0&&(E.frames[P]={}),(ee=E.frames[P]).src_off=D?H:B-8,ee.src_size=G+de+8,P++,D&&(D=!1,G=0,H=0);break;case"VP8X":(ee=E.header={}).feature_flags=M[B];var V=B+4;ee.canvas_width=1+f(M,V),V+=3,ee.canvas_height=1+f(M,V),V+=3;break;case"ALPH":D=!0,G=W+8,H=B-8;break;case"ANIM":(ee=E.header).bgcolor=p(M,B),V=B+4,ee.loop_count=d(M,V),V+=2;break;case"ANMF":var ae,ee;(ee=E.frames[P]={}).offset_x=2*f(M,B),B+=3,ee.offset_y=2*f(M,B),B+=3,ee.width=1+f(M,B),B+=3,ee.height=1+f(M,B),B+=3,ee.duration=f(M,B),B+=3,ae=M[B++],ee.dispose=1&ae,ee.blend=ae>>1&1}oe!="ANMF"&&(B+=W)}return E}}(b,0);v.response=b,v.rgbaoutput=!0,v.dataurl=!1;var w=v.header?v.header:null,S=v.frames?v.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],m=[w.canvas_width];for(var j=0;j<S.length&&S[j].blend!=0;j++);}var k=S[0],A=y.WebPDecodeRGBA(b,k.src_off,k.src_size,m,h);k.rgba=A,k.imgwidth=m[0],k.imgheight=h[0];for(var R=0;R<m[0]*h[0]*4;R++)g[R]=A[R];return this.width=m,this.height=h,this.data=g,this}/** ====================================================================
 * @license
 * jsPDF XMP metadata plugin
 * Copyright (c) 2016 Jussi Utunen, u-jussi@suomi24.fi
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 */function Dge(){var e,t=this.internal.__metadata__.metadata,r=unescape(encodeURIComponent(t));e=this.internal.__metadata__.rawXml?r:'<x:xmpmeta xmlns:x="adobe:ns:meta/"><rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceUri+'"><jspdf:metadata>'+r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")+"</jspdf:metadata></rdf:Description></rdf:RDF></x:xmpmeta>",this.internal.__metadata__.metadataObjectNumber=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+e.length+" >>"),this.internal.write("stream"),this.internal.write(e),this.internal.write("endstream"),this.internal.write("endobj")}function $ge(){this.internal.__metadata__.metadataObjectNumber&&this.internal.write("/Metadata "+this.internal.__metadata__.metadataObjectNumber+" 0 R")}(function(e){var t,r,n,i,s,o,l,c,u,d=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new c,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new o,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new o,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,l=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var Y=C;Object.defineProperty(this,"pdf",{get:function(){return Y}});var q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return q},set:function(U){q=!!U}});var O=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return O},set:function(U){O=!!U}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(U){isNaN(U)||(X=U)}});var F=0;Object.defineProperty(this,"posY",{get:function(){return F},set:function(U){isNaN(U)||(F=U)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(U){var Z;typeof U=="number"?Z=[U,U,U,U]:((Z=new Array(4))[0]=U[0],Z[1]=U.length>=2?U[1]:Z[0],Z[2]=U.length>=3?U[2]:Z[0],Z[3]=U.length>=4?U[3]:Z[1]),u.margin=Z}});var Q=!1;Object.defineProperty(this,"autoPaging",{get:function(){return Q},set:function(U){Q=U}});var K=0;Object.defineProperty(this,"lastBreak",{get:function(){return K},set:function(U){K=U}});var ne=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ne},set:function(U){ne=U}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(U){U instanceof d&&(u=U)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(U){u.path=U}});var re=[];Object.defineProperty(this,"ctxStack",{get:function(){return re},set:function(U){re=U}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(U){var Z;Z=p(U),this.ctx.fillStyle=Z.style,this.ctx.isFillTransparent=Z.a===0,this.ctx.fillOpacity=Z.a,this.pdf.setFillColor(Z.r,Z.g,Z.b,{a:Z.a}),this.pdf.setTextColor(Z.r,Z.g,Z.b,{a:Z.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(U){var Z=p(U);this.ctx.strokeStyle=Z.style,this.ctx.isStrokeTransparent=Z.a===0,this.ctx.strokeOpacity=Z.a,Z.a===0?this.pdf.setDrawColor(255,255,255):(Z.a,this.pdf.setDrawColor(Z.r,Z.g,Z.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(U){["butt","round","square"].indexOf(U)!==-1&&(this.ctx.lineCap=U,this.pdf.setLineCap(U))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(U){isNaN(U)||(this.ctx.lineWidth=U,this.pdf.setLineWidth(U))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(U){["bevel","round","miter"].indexOf(U)!==-1&&(this.ctx.lineJoin=U,this.pdf.setLineJoin(U))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(U){isNaN(U)||(this.ctx.miterLimit=U,this.pdf.setMiterLimit(U))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(U){this.ctx.textBaseline=U}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(U){["right","end","center","left","start"].indexOf(U)!==-1&&(this.ctx.textAlign=U)}});var T=null,I=null,ie=null;Object.defineProperty(this,"fontFaces",{get:function(){return ie},set:function(U){T=null,I=null,ie=U}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(U){var Z;if(this.ctx.font=U,(Z=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(U))!==null){var me=Z[1];Z[2];var Pe=Z[3],je=Z[4];Z[5];var Fe=Z[6],_e=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(je)[2];je=Math.floor(_e==="px"?parseFloat(je)*this.pdf.internal.scaleFactor:_e==="em"?parseFloat(je)*this.pdf.getFontSize():parseFloat(je)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(je);var He=function(be){var mt,et,Ue=[],It=be.trim();if(It==="")return Cj;if(It in oM)return[oM[It]];for(;It!=="";){switch(et=null,mt=(It=cM(It)).charAt(0)){case'"':case"'":et=Mge(It.substring(1),mt);break;default:et=Lge(It)}if(et===null||(Ue.push(et[0]),(It=cM(et[1]))!==""&&It.charAt(0)!==","))return Cj;It=It.replace(/^,/,"")}return Ue}(Fe);if(this.fontFaces){var qe=function(be,mt){var et=be.getFontList(),Ue=JSON.stringify(et);if(T===null||I!==Ue){var It=function(ht){var Lt=[];return Object.keys(ht).forEach(function(yr){ht[yr].forEach(function(Ar){var Tt=null;switch(Ar){case"bold":Tt={family:yr,weight:"bold"};break;case"italic":Tt={family:yr,style:"italic"};break;case"bolditalic":Tt={family:yr,weight:"bold",style:"italic"};break;case"":case"normal":Tt={family:yr}}Tt!==null&&(Tt.ref={name:yr,style:Ar},Lt.push(Tt))})}),Lt}(et);T=function(ht){for(var Lt={},yr=0;yr<ht.length;++yr){var Ar=Nj(ht[yr]),Tt=Ar.family,Vr=Ar.stretch,Br=Ar.style,Wr=Ar.weight;Lt[Tt]=Lt[Tt]||{},Lt[Tt][Vr]=Lt[Tt][Vr]||{},Lt[Tt][Vr][Br]=Lt[Tt][Vr][Br]||{},Lt[Tt][Vr][Br][Wr]=Ar}return Lt}(It.concat(mt)),I=Ue}return T}(this.pdf,this.fontFaces),Pt=He.map(function(be){return{family:be,stretch:"normal",weight:Pe,style:me}}),ut=function(be,mt,et){for(var Ue=(et=et||{}).defaultFontFamily||"times",It=Object.assign({},Oge,et.genericFontFamilies||{}),ht=null,Lt=null,yr=0;yr<mt.length;++yr)if(It[(ht=Nj(mt[yr])).family]&&(ht.family=It[ht.family]),be.hasOwnProperty(ht.family)){Lt=be[ht.family];break}if(!(Lt=Lt||be[Ue]))throw new Error("Could not find a font-family for the rule '"+lM(ht)+"' and default family '"+Ue+"'.");if(Lt=function(Ar,Tt){if(Tt[Ar])return Tt[Ar];var Vr=aA[Ar],Br=Vr<=aA.normal?-1:1,Wr=sM(Tt,Iz,Vr,Br);if(!Wr)throw new Error("Could not find a matching font-stretch value for "+Ar);return Wr}(ht.stretch,Lt),Lt=function(Ar,Tt){if(Tt[Ar])return Tt[Ar];for(var Vr=Bz[Ar],Br=0;Br<Vr.length;++Br)if(Tt[Vr[Br]])return Tt[Vr[Br]];throw new Error("Could not find a matching font-style for "+Ar)}(ht.style,Lt),!(Lt=function(Ar,Tt){if(Tt[Ar])return Tt[Ar];if(Ar===400&&Tt[500])return Tt[500];if(Ar===500&&Tt[400])return Tt[400];var Vr=Pge[Ar],Br=sM(Tt,Dz,Vr,Ar<400?-1:1);if(!Br)throw new Error("Could not find a matching font-weight for value "+Ar);return Br}(ht.weight,Lt)))throw new Error("Failed to resolve a font for the rule '"+lM(ht)+"'.");return Lt}(qe,Pt);this.pdf.setFont(ut.ref.name,ut.ref.style)}else{var Ke="";(Pe==="bold"||parseInt(Pe,10)>=700||me==="bold")&&(Ke="bold"),me==="italic"&&(Ke+="italic"),Ke.length===0&&(Ke="normal");for(var lt="",ve={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ae=0;Ae<He.length;Ae++){if(this.pdf.internal.getFont(He[Ae],Ke,{noFallback:!0,disableWarning:!0})!==void 0){lt=He[Ae];break}if(Ke==="bolditalic"&&this.pdf.internal.getFont(He[Ae],"bold",{noFallback:!0,disableWarning:!0})!==void 0)lt=He[Ae],Ke="bold";else if(this.pdf.internal.getFont(He[Ae],"normal",{noFallback:!0,disableWarning:!0})!==void 0){lt=He[Ae],Ke="normal";break}}if(lt===""){for(var ce=0;ce<He.length;ce++)if(ve[He[ce]]){lt=ve[He[ce]];break}}lt=lt===""?"Times":lt,this.pdf.setFont(lt,Ke)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(U){this.ctx.globalCompositeOperation=U}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(U){this.ctx.globalAlpha=U}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(U){this.ctx.lineDashOffset=U,ee.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(U){this.ctx.lineDash=U,ee.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(U){this.ctx.ignoreClearRect=!!U}})};f.prototype.setLineDash=function(C){this.lineDash=C},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){S.call(this,"fill",!1)},f.prototype.stroke=function(){S.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(C,Y){if(isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var q=this.ctx.transform.applyToPoint(new o(C,Y));this.path.push({type:"mt",x:q.x,y:q.y}),this.ctx.lastPoint=new o(C,Y)},f.prototype.closePath=function(){var C=new o(0,0),Y=0;for(Y=this.path.length-1;Y!==-1;Y--)if(this.path[Y].type==="begin"&&Hi(this.path[Y+1])==="object"&&typeof this.path[Y+1].x=="number"){C=new o(this.path[Y+1].x,this.path[Y+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(C.x,C.y)},f.prototype.lineTo=function(C,Y){if(isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var q=this.ctx.transform.applyToPoint(new o(C,Y));this.path.push({type:"lt",x:q.x,y:q.y}),this.ctx.lastPoint=new o(q.x,q.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},f.prototype.quadraticCurveTo=function(C,Y,q,O){if(isNaN(q)||isNaN(O)||isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new o(q,O)),F=this.ctx.transform.applyToPoint(new o(C,Y));this.path.push({type:"qct",x1:F.x,y1:F.y,x:X.x,y:X.y}),this.ctx.lastPoint=new o(X.x,X.y)},f.prototype.bezierCurveTo=function(C,Y,q,O,X,F){if(isNaN(X)||isNaN(F)||isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var Q=this.ctx.transform.applyToPoint(new o(X,F)),K=this.ctx.transform.applyToPoint(new o(C,Y)),ne=this.ctx.transform.applyToPoint(new o(q,O));this.path.push({type:"bct",x1:K.x,y1:K.y,x2:ne.x,y2:ne.y,x:Q.x,y:Q.y}),this.ctx.lastPoint=new o(Q.x,Q.y)},f.prototype.arc=function(C,Y,q,O,X,F){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O)||isNaN(X))throw na.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(F=!!F,!this.ctx.transform.isIdentity){var Q=this.ctx.transform.applyToPoint(new o(C,Y));C=Q.x,Y=Q.y;var K=this.ctx.transform.applyToPoint(new o(0,q)),ne=this.ctx.transform.applyToPoint(new o(0,0));q=Math.sqrt(Math.pow(K.x-ne.x,2)+Math.pow(K.y-ne.y,2))}Math.abs(X-O)>=2*Math.PI&&(O=0,X=2*Math.PI),this.path.push({type:"arc",x:C,y:Y,radius:q,startAngle:O,endAngle:X,counterclockwise:F})},f.prototype.arcTo=function(C,Y,q,O,X){throw new Error("arcTo not implemented.")},f.prototype.rect=function(C,Y,q,O){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,Y),this.lineTo(C+q,Y),this.lineTo(C+q,Y+O),this.lineTo(C,Y+O),this.lineTo(C,Y),this.lineTo(C+q,Y),this.lineTo(C,Y)},f.prototype.fillRect=function(C,Y,q,O){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,Y,q,O),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},f.prototype.strokeRect=function(C,Y,q,O){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(C,Y,q,O),this.stroke())},f.prototype.clearRect=function(C,Y,q,O){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O))throw na.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,Y,q,O))},f.prototype.save=function(C){C=typeof C!="boolean"||C;for(var Y=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("q");if(this.pdf.setPage(Y),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var O=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=O}},f.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var Y=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("Q");this.pdf.setPage(Y),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(C){var Y,q,O,X;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))Y=0,q=0,O=0,X=0;else{var F=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(F!==null)Y=parseInt(F[1]),q=parseInt(F[2]),O=parseInt(F[3]),X=1;else if((F=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)Y=parseInt(F[1]),q=parseInt(F[2]),O=parseInt(F[3]),X=parseFloat(F[4]);else{if(X=1,typeof C=="string"&&C.charAt(0)!=="#"){var Q=new Tz(C);C=Q.ok?Q.toHex():"#000000"}C.length===4?(Y=C.substring(1,2),Y+=Y,q=C.substring(2,3),q+=q,O=C.substring(3,4),O+=O):(Y=C.substring(1,3),q=C.substring(3,5),O=C.substring(5,7)),Y=parseInt(Y,16),q=parseInt(q,16),O=parseInt(O,16)}}return{r:Y,g:q,b:O,a:X,style:C}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(C,Y,q,O){if(isNaN(Y)||isNaN(q)||typeof C!="string")throw na.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(O=isNaN(O)?void 0:O,!h.call(this)){var X=W(this.ctx.transform.rotation),F=this.ctx.transform.scaleX;P.call(this,{text:C,x:Y,y:q,scale:F,angle:X,align:this.textAlign,maxWidth:O})}},f.prototype.strokeText=function(C,Y,q,O){if(isNaN(Y)||isNaN(q)||typeof C!="string")throw na.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){O=isNaN(O)?void 0:O;var X=W(this.ctx.transform.rotation),F=this.ctx.transform.scaleX;P.call(this,{text:C,x:Y,y:q,scale:F,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:O})}},f.prototype.measureText=function(C){if(typeof C!="string")throw na.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var Y=this.pdf,q=this.pdf.internal.scaleFactor,O=Y.internal.getFontSize(),X=Y.getStringUnitWidth(C)*O/Y.internal.scaleFactor;return new function(F){var Q=(F=F||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Q}}),this}({width:X*=Math.round(96*q/72*1e4)/1e4})},f.prototype.scale=function(C,Y){if(isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var q=new c(C,0,0,Y,0,0);this.ctx.transform=this.ctx.transform.multiply(q)},f.prototype.rotate=function(C){if(isNaN(C))throw na.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var Y=new c(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(Y)},f.prototype.translate=function(C,Y){if(isNaN(C)||isNaN(Y))throw na.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var q=new c(1,0,0,1,C,Y);this.ctx.transform=this.ctx.transform.multiply(q)},f.prototype.transform=function(C,Y,q,O,X,F){if(isNaN(C)||isNaN(Y)||isNaN(q)||isNaN(O)||isNaN(X)||isNaN(F))throw na.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var Q=new c(C,Y,q,O,X,F);this.ctx.transform=this.ctx.transform.multiply(Q)},f.prototype.setTransform=function(C,Y,q,O,X,F){C=isNaN(C)?1:C,Y=isNaN(Y)?0:Y,q=isNaN(q)?0:q,O=isNaN(O)?1:O,X=isNaN(X)?0:X,F=isNaN(F)?0:F,this.ctx.transform=new c(C,Y,q,O,X,F)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(C,Y,q,O,X,F,Q,K,ne){var re=this.pdf.getImageProperties(C),T=1,I=1,ie=1,U=1;O!==void 0&&K!==void 0&&(ie=K/O,U=ne/X,T=re.width/O*K/O,I=re.height/X*ne/X),F===void 0&&(F=Y,Q=q,Y=0,q=0),O!==void 0&&K===void 0&&(K=O,ne=X),O===void 0&&K===void 0&&(K=re.width,ne=re.height);var Z=this.ctx.transform.decompose(),me=W(Z.rotate.shx),Pe=new c,je=(Pe=(Pe=(Pe=Pe.multiply(Z.translate)).multiply(Z.skew)).multiply(Z.scale)).applyToRectangle(new l(F-Y*ie,Q-q*U,O*T,X*I));if(this.autoPaging){for(var Fe,_e=y.call(this,je),He=[],qe=0;qe<_e.length;qe+=1)He.indexOf(_e[qe])===-1&&He.push(_e[qe]);w(He);for(var Pt=He[0],ut=He[He.length-1],Ke=Pt;Ke<ut+1;Ke++){this.pdf.setPage(Ke);var lt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ve=Ke===1?this.posY+this.margin[0]:this.margin[0],Ae=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ce=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],be=Ke===1?0:Ae+(Ke-2)*ce;if(this.ctx.clip_path.length!==0){var mt=this.path;Fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(Fe,this.posX+this.margin[3],-be+ve+this.ctx.prevPageLastElemOffset),j.call(this,"fill",!0),this.path=mt}var et=JSON.parse(JSON.stringify(je));et=v([et],this.posX+this.margin[3],-be+ve+this.ctx.prevPageLastElemOffset)[0];var Ue=(Ke>Pt||Ke<ut)&&g.call(this);Ue&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],lt,ce,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",et.x,et.y,et.w,et.h,null,null,me),Ue&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(C,"JPEG",je.x,je.y,je.w,je.h,null,null,me)};var y=function(C,Y,q){var O=[];Y=Y||this.pdf.internal.pageSize.width,q=q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":O.push(Math.floor((C.y+X)/q)+1);break;case"arc":O.push(Math.floor((C.y+X-C.radius)/q)+1),O.push(Math.floor((C.y+X+C.radius)/q)+1);break;case"qct":var F=V(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);O.push(Math.floor((F.y+X)/q)+1),O.push(Math.floor((F.y+F.h+X)/q)+1);break;case"bct":var Q=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);O.push(Math.floor((Q.y+X)/q)+1),O.push(Math.floor((Q.y+Q.h+X)/q)+1);break;case"rect":O.push(Math.floor((C.y+X)/q)+1),O.push(Math.floor((C.y+C.h+X)/q)+1)}for(var K=0;K<O.length;K+=1)for(;this.pdf.internal.getNumberOfPages()<O[K];)b.call(this);return O},b=function(){var C=this.fillStyle,Y=this.strokeStyle,q=this.font,O=this.lineCap,X=this.lineWidth,F=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=Y,this.font=q,this.lineCap=O,this.lineWidth=X,this.lineJoin=F},v=function(C,Y,q){for(var O=0;O<C.length;O++)switch(C[O].type){case"bct":C[O].x2+=Y,C[O].y2+=q;case"qct":C[O].x1+=Y,C[O].y1+=q;default:C[O].x+=Y,C[O].y+=q}return C},w=function(C){return C.sort(function(Y,q){return Y-q})},S=function(C,Y){var q=this.fillStyle,O=this.strokeStyle,X=this.lineCap,F=this.lineWidth,Q=Math.abs(F*this.ctx.transform.scaleX),K=this.lineJoin;if(this.autoPaging){for(var ne,re,T=JSON.parse(JSON.stringify(this.path)),I=JSON.parse(JSON.stringify(this.path)),ie=[],U=0;U<I.length;U++)if(I[U].x!==void 0)for(var Z=y.call(this,I[U]),me=0;me<Z.length;me+=1)ie.indexOf(Z[me])===-1&&ie.push(Z[me]);for(var Pe=0;Pe<ie.length;Pe++)for(;this.pdf.internal.getNumberOfPages()<ie[Pe];)b.call(this);w(ie);for(var je=ie[0],Fe=ie[ie.length-1],_e=je;_e<Fe+1;_e++){this.pdf.setPage(_e),this.fillStyle=q,this.strokeStyle=O,this.lineCap=X,this.lineWidth=Q,this.lineJoin=K;var He=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],qe=_e===1?this.posY+this.margin[0]:this.margin[0],Pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ut=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ke=_e===1?0:Pt+(_e-2)*ut;if(this.ctx.clip_path.length!==0){var lt=this.path;ne=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(ne,this.posX+this.margin[3],-Ke+qe+this.ctx.prevPageLastElemOffset),j.call(this,C,!0),this.path=lt}if(re=JSON.parse(JSON.stringify(T)),this.path=v(re,this.posX+this.margin[3],-Ke+qe+this.ctx.prevPageLastElemOffset),Y===!1||_e===0){var ve=(_e>je||_e<Fe)&&g.call(this);ve&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],He,ut,null).clip().discardPath()),j.call(this,C,Y),ve&&this.pdf.restoreGraphicsState()}this.lineWidth=F}this.path=T}else this.lineWidth=Q,j.call(this,C,Y),this.lineWidth=F},j=function(C,Y){if((C!=="stroke"||Y||!m.call(this))&&(C==="stroke"||Y||!h.call(this))){for(var q,O,X=[],F=this.path,Q=0;Q<F.length;Q++){var K=F[Q];switch(K.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:K,deltas:[],abs:[]});break;case"lt":var ne=X.length;if(F[Q-1]&&!isNaN(F[Q-1].x)&&(q=[K.x-F[Q-1].x,K.y-F[Q-1].y],ne>0)){for(;ne>=0;ne--)if(X[ne-1].close!==!0&&X[ne-1].begin!==!0){X[ne-1].deltas.push(q),X[ne-1].abs.push(K);break}}break;case"bct":q=[K.x1-F[Q-1].x,K.y1-F[Q-1].y,K.x2-F[Q-1].x,K.y2-F[Q-1].y,K.x-F[Q-1].x,K.y-F[Q-1].y],X[X.length-1].deltas.push(q);break;case"qct":var re=F[Q-1].x+2/3*(K.x1-F[Q-1].x),T=F[Q-1].y+2/3*(K.y1-F[Q-1].y),I=K.x+2/3*(K.x1-K.x),ie=K.y+2/3*(K.y1-K.y),U=K.x,Z=K.y;q=[re-F[Q-1].x,T-F[Q-1].y,I-F[Q-1].x,ie-F[Q-1].y,U-F[Q-1].x,Z-F[Q-1].y],X[X.length-1].deltas.push(q);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(K)}}O=Y?null:C==="stroke"?"stroke":"fill";for(var me=!1,Pe=0;Pe<X.length;Pe++)if(X[Pe].arc)for(var je=X[Pe].abs,Fe=0;Fe<je.length;Fe++){var _e=je[Fe];_e.type==="arc"?R.call(this,_e.x,_e.y,_e.radius,_e.startAngle,_e.endAngle,_e.counterclockwise,void 0,Y,!me):D.call(this,_e.x,_e.y),me=!0}else if(X[Pe].close===!0)this.pdf.internal.out("h"),me=!1;else if(X[Pe].begin!==!0){var He=X[Pe].start.x,qe=X[Pe].start.y;G.call(this,X[Pe].deltas,He,qe),me=!0}O&&M.call(this,O),Y&&B.call(this)}},k=function(C){var Y=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,q=Y*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-q;case"top":return C+Y-q;case"hanging":return C+Y-2*q;case"middle":return C+Y/2-q;default:return C}},A=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(Y,q){this.colorStops.push([Y,q])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var R=function(C,Y,q,O,X,F,Q,K,ne){for(var re=oe.call(this,q,O,X,F),T=0;T<re.length;T++){var I=re[T];T===0&&(ne?E.call(this,I.x1+C,I.y1+Y):D.call(this,I.x1+C,I.y1+Y)),H.call(this,C,Y,I.x2,I.y2,I.x3,I.y3,I.x4,I.y4)}K?B.call(this):M.call(this,Q)},M=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},B=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(C,Y){this.pdf.internal.out(r(C)+" "+n(Y)+" m")},P=function(C){var Y;switch(C.align){case"right":case"end":Y="right";break;case"center":Y="center";break;default:Y="left"}var q,O,X,F=this.pdf.getTextDimensions(C.text),Q=k.call(this,C.y),K=A.call(this,Q)-F.h,ne=this.ctx.transform.applyToPoint(new o(C.x,Q));if(this.autoPaging){var re=this.ctx.transform.decompose(),T=new c;T=(T=(T=T.multiply(re.translate)).multiply(re.skew)).multiply(re.scale);for(var I=this.ctx.transform.applyToRectangle(new l(C.x,Q,F.w,F.h)),ie=T.applyToRectangle(new l(C.x,K,F.w,F.h)),U=y.call(this,ie),Z=[],me=0;me<U.length;me+=1)Z.indexOf(U[me])===-1&&Z.push(U[me]);w(Z);for(var Pe=Z[0],je=Z[Z.length-1],Fe=Pe;Fe<je+1;Fe++){this.pdf.setPage(Fe);var _e=Fe===1?this.posY+this.margin[0]:this.margin[0],He=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qe=this.pdf.internal.pageSize.height-this.margin[2],Pt=qe-this.margin[0],ut=this.pdf.internal.pageSize.width-this.margin[1],Ke=ut-this.margin[3],lt=Fe===1?0:He+(Fe-2)*Pt;if(this.ctx.clip_path.length!==0){var ve=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=v(q,this.posX+this.margin[3],-1*lt+_e),j.call(this,"fill",!0),this.path=ve}var Ae=v([JSON.parse(JSON.stringify(ie))],this.posX+this.margin[3],-lt+_e+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(O=this.pdf.internal.getFontSize(),this.pdf.setFontSize(O*C.scale),X=this.lineWidth,this.lineWidth=X*C.scale);var ce=this.autoPaging!=="text";if(ce||Ae.y+Ae.h<=qe){if(ce||Ae.y>=_e&&Ae.x<=ut){var be=ce?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||ut-Ae.x)[0],mt=v([JSON.parse(JSON.stringify(I))],this.posX+this.margin[3],-lt+_e+this.ctx.prevPageLastElemOffset)[0],et=ce&&(Fe>Pe||Fe<je)&&g.call(this);et&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ke,Pt,null).clip().discardPath()),this.pdf.text(be,mt.x,mt.y,{angle:C.angle,align:Y,renderingMode:C.renderingMode}),et&&this.pdf.restoreGraphicsState()}}else Ae.y<qe&&(this.ctx.prevPageLastElemOffset+=qe-Ae.y);C.scale>=.01&&(this.pdf.setFontSize(O),this.lineWidth=X)}}else C.scale>=.01&&(O=this.pdf.internal.getFontSize(),this.pdf.setFontSize(O*C.scale),X=this.lineWidth,this.lineWidth=X*C.scale),this.pdf.text(C.text,ne.x+this.posX,ne.y+this.posY,{angle:C.angle,align:Y,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(O),this.lineWidth=X)},D=function(C,Y,q,O){q=q||0,O=O||0,this.pdf.internal.out(r(C+q)+" "+n(Y+O)+" l")},G=function(C,Y,q){return this.pdf.lines(C,Y,q,null,null)},H=function(C,Y,q,O,X,F,Q,K){this.pdf.internal.out([t(i(q+C)),t(s(O+Y)),t(i(X+C)),t(s(F+Y)),t(i(Q+C)),t(s(K+Y)),"c"].join(" "))},oe=function(C,Y,q,O){for(var X=2*Math.PI,F=Math.PI/2;Y>q;)Y-=X;var Q=Math.abs(q-Y);Q<X&&O&&(Q=X-Q);for(var K=[],ne=O?-1:1,re=Y;Q>1e-5;){var T=re+ne*Math.min(Q,F);K.push(de.call(this,C,re,T)),Q-=Math.abs(T-re),re=T}return K},de=function(C,Y,q){var O=(q-Y)/2,X=C*Math.cos(O),F=C*Math.sin(O),Q=X,K=-F,ne=Q*Q+K*K,re=ne+Q*X+K*F,T=4/3*(Math.sqrt(2*ne*re)-re)/(Q*F-K*X),I=Q-T*K,ie=K+T*Q,U=I,Z=-ie,me=O+Y,Pe=Math.cos(me),je=Math.sin(me);return{x1:C*Math.cos(Y),y1:C*Math.sin(Y),x2:I*Pe-ie*je,y2:I*je+ie*Pe,x3:U*Pe-Z*je,y3:U*je+Z*Pe,x4:C*Math.cos(q),y4:C*Math.sin(q)}},W=function(C){return 180*C/Math.PI},V=function(C,Y,q,O,X,F){var Q=C+.5*(q-C),K=Y+.5*(O-Y),ne=X+.5*(q-X),re=F+.5*(O-F),T=Math.min(C,X,Q,ne),I=Math.max(C,X,Q,ne),ie=Math.min(Y,F,K,re),U=Math.max(Y,F,K,re);return new l(T,ie,I-T,U-ie)},ae=function(C,Y,q,O,X,F,Q,K){var ne,re,T,I,ie,U,Z,me,Pe,je,Fe,_e,He,qe,Pt=q-C,ut=O-Y,Ke=X-q,lt=F-O,ve=Q-X,Ae=K-F;for(re=0;re<41;re++)Pe=(Z=(T=C+(ne=re/40)*Pt)+ne*((ie=q+ne*Ke)-T))+ne*(ie+ne*(X+ne*ve-ie)-Z),je=(me=(I=Y+ne*ut)+ne*((U=O+ne*lt)-I))+ne*(U+ne*(F+ne*Ae-U)-me),re==0?(Fe=Pe,_e=je,He=Pe,qe=je):(Fe=Math.min(Fe,Pe),_e=Math.min(_e,je),He=Math.max(He,Pe),qe=Math.max(qe,je));return new l(Math.round(Fe),Math.round(_e),Math.round(He-Fe),Math.round(qe-_e))},ee=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,Y,q=(C=this.ctx.lineDash,Y=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:Y}));this.prevLineDash!==q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=q)}}})(Rn.API),function(e){var t=function(o){var l,c,u,d,f,p,h,m,g,y;for(c=[],u=0,d=(o+=l="\0\0\0\0".slice(o.length%4||4)).length;d>u;u+=4)(f=(o.charCodeAt(u)<<24)+(o.charCodeAt(u+1)<<16)+(o.charCodeAt(u+2)<<8)+o.charCodeAt(u+3))!==0?(p=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)%85,c.push(p+33,h+33,m+33,g+33,y+33)):c.push(122);return function(b,v){for(var w=v;w>0;w--)b.pop()}(c,l.length),String.fromCharCode.apply(String,c)+"~>"},r=function(o){var l,c,u,d,f,p=String,h="length",m=255,g="charCodeAt",y="slice",b="replace";for(o[y](-2),o=o[y](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],d=0,f=(o+=l="uuuuu"[y](o[h]%5||5))[h];f>d;d+=5)c=52200625*(o[g](d)-33)+614125*(o[g](d+1)-33)+7225*(o[g](d+2)-33)+85*(o[g](d+3)-33)+(o[g](d+4)-33),u.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(v,w){for(var S=w;S>0;S--)v.pop()}(u,l[h]),p.fromCharCode.apply(p,u)},n=function(o){return o.split("").map(function(l){return("0"+l.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(o){var l=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((o=o.replace(/\s/g,"")).indexOf(">")!==-1&&(o=o.substr(0,o.indexOf(">"))),o.length%2&&(o+="0"),l.test(o)===!1)return"";for(var c="",u=0;u<o.length;u+=2)c+=String.fromCharCode("0x"+(o[u]+o[u+1]));return c},s=function(o){for(var l=new Uint8Array(o.length),c=o.length;c--;)l[c]=o.charCodeAt(c);return(l=J4(l)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};e.processDataByFilters=function(o,l){var c=0,u=o||"",d=[];for(typeof(l=l||[])=="string"&&(l=[l]),c=0;c<l.length;c+=1)switch(l[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=i(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=s(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+l[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(Rn.API),function(e){e.loadFile=function(t,r,n){return function(i,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var l=void 0;try{l=function(c,u,d){var f=new XMLHttpRequest,p=0,h=function(m){var g=m.length,y=[],b=String.fromCharCode;for(p=0;p<g;p+=1)y.push(b(255&m.charCodeAt(p)));return y.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(i,s,o)}catch{}return l}(t,r,n)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile}(Rn.API),function(e){function t(){return(Yn.html2canvas?Promise.resolve(Yn.html2canvas):um(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load html2canvas: "+l))}).then(function(l){return l.default?l.default:l})}function r(){return(Yn.DOMPurify?Promise.resolve(Yn.DOMPurify):um(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(l){return Promise.reject(new Error("Could not load dompurify: "+l))}).then(function(l){return l.default?l.default:l})}var n=function(l){var c=Hi(l);return c==="undefined"?"undefined":c==="string"||l instanceof String?"string":c==="number"||l instanceof Number?"number":c==="function"||l instanceof Function?"function":l&&l.constructor===Array?"array":l&&l.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(l,c){var u=document.createElement(l);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},s=function l(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(l(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},o=function l(c){var u=Object.assign(l.convert(Promise.resolve()),JSON.parse(JSON.stringify(l.template))),d=l.convert(Promise.resolve(),u);return(d=d.setProgress(1,l,1,[l])).set(c)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(l,c){return l.__proto__=c||o.prototype,l},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(l,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(l),c){case"string":return this.then(r).then(function(u){return this.set({src:i("div",{innerHTML:l,dompurify:u})})});case"element":return this.set({src:l});case"canvas":return this.set({canvas:l});case"img":return this.set({img:l});default:return this.error("Unknown source type.")}})},o.prototype.to=function(l){switch(l){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var l={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=s(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(l.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:l}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var l=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(l).then(t).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var m=d[h],g=m.src.find(function(y){return y.format==="truetype"});g&&u.addFont(g.url,m.ref.name,m.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,u.context2d.save(!0),c(this.prop.container,p)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var l=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=l})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(l,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(l,c):this.outputPdf(l,c)},o.prototype.outputPdf=function(l,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(l,c)})},o.prototype.outputImg=function(l){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(l){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+l+'" is not supported.'}})},o.prototype.save=function(l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(l?{filename:l}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(l){if(n(l)!=="object")return this;var c=Object.keys(l||{}).map(function(u){if(u in o.template.prop)return function(){this.prop[u]=l[u]};switch(u){case"margin":return this.setMargin.bind(this,l.margin);case"jsPDF":return function(){return this.opt.jsPDF=l.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,l.pageSize);default:return function(){this.opt[u]=l[u]}}},this);return this.then(function(){return this.thenList(c)})},o.prototype.get=function(l,c){return this.then(function(){var u=l in o.template.prop?this.prop[l]:this.opt[l];return c?c(u):u})},o.prototype.setMargin=function(l){return this.then(function(){switch(n(l)){case"number":l=[l,l,l,l];case"array":if(l.length===2&&(l=[l[0],l[1],l[0],l[1]]),l.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=l}).then(this.setPageSize)},o.prototype.setPageSize=function(l){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(l=l||Rn.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(l.inner={width:l.width-this.opt.margin[1]-this.opt.margin[3],height:l.height-this.opt.margin[0]-this.opt.margin[2]},l.inner.px={width:c(l.inner.width,l.k),height:c(l.inner.height,l.k)},l.inner.ratio=l.inner.height/l.inner.width),this.prop.pageSize=l})},o.prototype.setProgress=function(l,c,u,d){return l!=null&&(this.progress.val=l),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(l,c,u,d){return this.setProgress(l?this.progress.val+l:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},o.prototype.then=function(l,c){var u=this;return this.thenCore(l,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(p){return u.updateProgress(null,d),p}).then(d,f).then(function(p){return u.updateProgress(1),p})})},o.prototype.thenCore=function(l,c,u){u=u||Promise.prototype.then;var d=this;l&&(l=l.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:o.convert(Object.assign({},d),Promise.prototype),p=u.call(f,l,c);return o.convert(p,d.__proto__)},o.prototype.thenExternal=function(l,c){return Promise.prototype.then.call(this,l,c)},o.prototype.thenList=function(l){var c=this;return l.forEach(function(u){c=c.thenCore(u)}),c},o.prototype.catch=function(l){l&&(l=l.bind(this));var c=Promise.prototype.catch.call(this,l);return o.convert(c,this)},o.prototype.catchExternal=function(l){return Promise.prototype.catch.call(this,l)},o.prototype.error=function(l){return this.then(function(){throw new Error(l)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,Rn.getPageSize=function(l,c,u){if(Hi(l)==="object"){var d=l;l=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",l=(""+(l||"P")).toLowerCase();var f,p=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var m,g=0,y=0;if(h.hasOwnProperty(p))g=h[p][1]/f,y=h[p][0]/f;else try{g=u[1],y=u[0]}catch{throw new Error("Invalid format: "+u)}if(l==="p"||l==="portrait")l="p",y>g&&(m=y,y=g,g=m);else{if(l!=="l"&&l!=="landscape")throw"Invalid orientation: "+l;l="l",g>y&&(m=y,y=g,g=m)}return{width:y,height:g,unit:c,k:f,orientation:l}},e.html=function(l,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Nj):null;var u=new o(c);return c.worker?u:u.from(l).doCallback()}}(Rn.API),Rn.API.addJS=function(e){var t,r,n=e;return this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(t+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),r=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+n+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){t!==void 0&&r!==void 0&&this.internal.out("/Names <</JavaScript "+t+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),s=0;s<i.length;s++){var o=i[s],l=n.exec(o);if(l!=null){var c=l[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(s=0;s<u;s++){var f=r.internal.newObject();d.push(f);var p=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<d.length;s++)r.internal.write("(page_"+(s+1)+")"+d[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,s){var o={title:i,options:s,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<n.children.length;s++){var o=n.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),s>0&&this.line("/Prev "+this.makeRef(n.children[s-1])),s<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var l=this.count=this.count_r({count:0},o);if(l>0&&this.line("/Count "+l),o.options&&o.options.pageNumber){var c=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var s=0;s<i.children.length;s++)n.count++,this.count_r(n,i.children[s]);return n.count}}])}(Rn.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,s,o,l){var c,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(f){for(var p,h=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,g={width:0,height:0,numcomponents:1},y=4;y<m;y+=2){if(y+=h,t.indexOf(f.charCodeAt(y+1))!==-1){p=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:p,numcomponents:f.charCodeAt(y+9)};break}h=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:l=this.color_spaces.DEVICE_GRAY;break;case 4:l=this.color_spaces.DEVICE_CMYK;break;case 3:l=this.color_spaces.DEVICE_RGB}d={data:r,width:c.width,height:c.height,colorSpace:l,bitsPerComponent:8,filter:u,index:n,alias:i}}return d}}(Rn.API),Rn.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var i,s=xge(e,{checkCrc:!0}),o=s.width,l=s.height,c=s.channels,u=s.palette,d=s.depth;i=u&&c===1?function(R){for(var M=R.width,B=R.height,E=R.data,P=R.palette,D=R.depth,G=!1,H=[],oe=[],de=void 0,W=!1,V=0,ae=0;ae<P.length;ae++){var ee=mO(P[ae],4),C=ee[0],Y=ee[1],q=ee[2],O=ee[3];H.push(C,Y,q),O!=null&&(O===0?(V++,oe.length<1&&oe.push(ae)):O<255&&(W=!0))}if(W||V>1){G=!0,oe=void 0;var X=M*B;de=new Uint8Array(X);for(var F=new DataView(E.buffer),Q=0;Q<X;Q++){var K=Ej(F,Q,D),ne=mO(P[K],4)[3];de[Q]=ne}}else V===0&&(oe=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:G?8:void 0,colorBytes:E,alphaBytes:de,needSMask:G,palette:H,mask:oe}}(s):c===2||c===4?function(R){for(var M=R.data,B=R.width,E=R.height,P=R.channels,D=R.depth,G=P===2?"DeviceGray":"DeviceRGB",H=P-1,oe=B*E,de=H,W=oe*de,V=1*oe,ae=Math.ceil(W*D/8),ee=Math.ceil(V*D/8),C=new Uint8Array(ae),Y=new Uint8Array(ee),q=new DataView(M.buffer),O=new DataView(C.buffer),X=new DataView(Y.buffer),F=!1,Q=0;Q<oe;Q++){for(var K=Q*P,ne=0;ne<de;ne++)yM(O,Ej(q,K+ne,D),Q*de+ne,D);var re=Ej(q,K+de,D);re<(1<<D)-1&&(F=!0),yM(X,re,1*Q,D)}return{colorSpace:G,colorsPerPixel:H,sMaskBitsPerComponent:F?D:void 0,colorBytes:C,alphaBytes:Y,needSMask:F}}(s):function(R){var M=R.data,B=R.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:B,colorsPerPixel:B==="DeviceGray"?1:3,colorBytes:M instanceof Uint16Array?function(E){for(var P=E.length,D=new Uint8Array(2*P),G=new DataView(D.buffer,D.byteOffset,D.byteLength),H=0;H<P;H++)G.setUint16(2*H,E[H],!1);return D}(M):M,needSMask:!1}}(s);var f,p,h,m=i,g=m.colorSpace,y=m.colorsPerPixel,b=m.sMaskBitsPerComponent,v=m.colorBytes,w=m.alphaBytes,S=m.needSMask,j=m.palette,k=m.mask,A=null;return n!==Rn.API.image_compression.NONE&&typeof J4=="function"?(A=function(R){var M;switch(R){case Rn.API.image_compression.FAST:M=11;break;case Rn.API.image_compression.MEDIUM:M=13;break;case Rn.API.image_compression.SLOW:M=14;break;default:M=12}return M}(n),f=this.decode.FLATE_DECODE,p="/Predictor ".concat(A," /Colors ").concat(y," /BitsPerComponent ").concat(d," /Columns ").concat(o),e=hM(v,Math.ceil(o*y*d/8),y,d,n),S&&(h=hM(w,Math.ceil(o*b/8),1,b,n))):(f=void 0,p=void 0,e=v,S&&(h=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:e,index:t,filter:f,decodeParameters:p,transparency:k,palette:j,sMask:h,predictor:A,width:o,height:l,bitsPerComponent:d,sMaskBitsPerComponent:b,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,i){var s=new Ige(t),o=s.width,l=s.height,c=[];s.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:o,height:l},d=new Tj(100).encode(u,100);return e.processJPEG.call(this,d,r,n,i)},e.processGIF87A=e.processGIF89A}(Rn.API),ru.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ru.prototype.parseBGR=function(){this.pos=this.offset;var e="bit"+this.bitPP,t=this.width*this.height*4;if(t>536870912)throw new Error("Image dimensions exceed 512MB, which is too large.");this.data=new Uint8Array(t);try{this[e]()}catch(r){na.log("bit decode error:"+r)}},ru.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*i*4,l=0;l<8&&8*i+l<this.width;l++){var c=this.palette[s>>7-l&1];this.data[o+4*l]=c.blue,this.data[o+4*l+1]=c.green,this.data[o+4*l+2]=c.red,this.data[o+4*l+3]=255}r!==0&&(this.pos+=4-r)}},ru.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var s=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*i*4,l=s>>4,c=15&s,u=this.palette[l];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*i+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},ru.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*n;if(i<this.palette.length){var o=this.palette[i];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},ru.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&t)/t*255|0,c=(s>>10&t)/t*255|0,u=s>>15?255:0,d=n*this.width*4+4*i;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=u}this.pos+=e}},ru.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(o&t)/t*255|0,c=(o>>5&r)/r*255|0,u=(o>>11)/t*255|0,d=i*this.width*4+4*s;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=l,this.data[d+3]=255}this.pos+=e}},ru.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},ru.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*r;this.data[l]=s,this.data[l+1]=i,this.data[l+2]=n,this.data[l+3]=o}},ru.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var s=new ru(t,!1),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Tj(100).encode(c,100);return e.processJPEG.call(this,u,r,n,i)}}(Rn.API),vM.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var s=new vM(t),o=s.width,l=s.height,c={data:s.getData(),width:o,height:l},u=new Tj(100).encode(c,100);return e.processJPEG.call(this,u,r,n,i)}}(Rn.API),Rn.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,s=new Uint8Array(i/4*3),o=new Uint8Array(i/4),l=0,c=0,u=0;u<i;u+=4){var d=n[u],f=n[u+1],p=n[u+2],h=n[u+3];s[l++]=d,s[l++]=f,s[l++]=p,o[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Rn.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},yp=Rn.API,Ib=yp.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),l=t.widths?t.widths:i.metadata.Unicode.widths,c=l.fof?l.fof:1,u=t.kerning?t.kerning:i.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=t.doKerning!==!1,p=0,h=e.length,m=0,g=l[0]||c,y=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?y.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+o*(1e3/s)||0)/1e3):(p=f&&Hi(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,y.push((l[n]||g)/c+p)),m=n;return y},uM=yp.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return yp.processArabic&&(e=yp.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:Ib.apply(this,arguments).reduce(function(s,o){return s+o},0)},dM=function(e,t,r,n){for(var i=[],s=0,o=e.length,l=0;s!==o&&l+t[s]<r;)l+=t[s],s++;i.push(e.slice(0,s));var c=s;for(l=0;s!==o;)l+t[s]>n&&(i.push(e.slice(c,s)),l=0,c=s),l+=t[s],s++;return c!==s&&i.push(e.slice(c,s)),i},fM=function(e,t,r){r||(r={});var n,i,s,o,l,c,u,d=[],f=[d],p=r.textIndent||0,h=0,m=0,g=e.split(" "),y=Ib.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var b=Array(c).join(" "),v=[];g.map(function(S){(S=S.split(/\s*\n/)).length>1?v=v.concat(S.map(function(j,k){return(k&&j.length?`
`:"")+j})):v.push(S[0])}),g=v,c=uM.apply(this,[b,r])}for(s=0,o=g.length;s<o;s++){var w=0;if(n=g[s],c&&n[0]==`
`&&(n=n.substr(1),w=1),p+h+(m=(i=Ib.apply(this,[n,r])).reduce(function(S,j){return S+j},0))>t||w){if(m>t){for(l=dM.apply(this,[n,i,t-(p+h),t]),d.push(l.shift()),d=[l.pop()];l.length;)f.push([l.shift()]);m=i.slice(n.length-(d[0]?d[0].length:0)).reduce(function(S,j){return S+j},0)}else d=[n];f.push(d),p=m+c,h=y}else d.push(n),p+=h+m,h=y}return u=c?function(S,j){return(j?b:"")+S.join(" ")}:function(S){return S.join(" ")},f.map(u)},yp.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),p="Unicode";return f.metadata[p]?{widths:f.metadata[p].widths||{0:1},kerning:f.metadata[p].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/i;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,s.lineIndent=r.lineIndent;var l,c,u=[];for(l=0,c=n.length;l<c;l++)u=u.concat(fM.apply(this,[n[l],o,s]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},s=0;s<16;s++)n[r[s]]=t[s],i[t[s]]=r[s];var o=function(p){return"0x"+parseInt(p,10).toString(16)},l=e.__fontmetrics__.compress=function(p){var h,m,g,y,b=["{"];for(var v in p){if(h=p[v],isNaN(parseInt(v,10))?m="'"+v+"'":(v=parseInt(v,10),m=(m=o(v).slice(2)).slice(0,-1)+i[m.slice(-1)]),typeof h=="number")h<0?(g=o(h).slice(3),y="-"):(g=o(h).slice(2),y=""),g=y+g.slice(0,-1)+i[g.slice(-1)];else{if(Hi(h)!=="object")throw new Error("Don't know what to do with value type "+Hi(h)+".");g=l(h)}b.push(m+g)}return b.push("}"),b.join("")},c=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,g,y,b={},v=1,w=b,S=[],j="",k="",A=p.length-1,R=1;R<A;R+=1)(y=p[R])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(y):y=="{"?(S.push([w,g]),w={},g=void 0):y=="}"?((m=S.pop())[0][m[1]]=w,g=void 0,w=m[0]):y=="-"?v=-1:g===void 0?n.hasOwnProperty(y)?(j+=n[y],g=parseInt(j,16)*v,v=1,j=""):j+=y:n.hasOwnProperty(y)?(k+=n[y],w[g]=parseInt(k,16)*v,v=1,g=void 0,k=""):k+=y;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var h=p.font,m=f.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var g=d.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(Rn.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),s=0;s<n;s++)i[s]=r.charCodeAt(s);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,s=r.instance;if(!i.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=s.existsFileInVFS(i.postScriptName)===!1?s.loadFile(i.postScriptName):s.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,l){l=/^\x00\x01\x00\x00/.test(l)?t(l):t(Uv(l)),o.metadata=e.API.TTFFont.open(l),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,n)}}])}(Rn),Rn.API.addSvgAsImage=function(e,t,r,n,i,s,o,l){if(isNaN(t)||isNaN(r))throw na.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw na.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Yn.canvg?Promise.resolve(Yn.canvg):um(()=>import("./index.es-B7Z486E1.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(u,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,r,n,i,o,l)})},Rn.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},Rn.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},l=Object.keys(o),c=[],u=0,d=0,f=0;function p(m,g){var y,b=!1;for(y=0;y<m.length;y+=1)m[y]===g&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=l.length;for(f=0;f<h;f+=1)r[l[f]].value=r[l[f]].defaultValue,r[l[f]].explicitSet=!1}if(Hi(e)==="object"){for(i in e)if(s=e[i],p(l,i)&&s!==void 0){if(r[i].type==="boolean"&&typeof s=="boolean")r[i].value=s;else if(r[i].type==="name"&&p(r[i].valueSet,s))r[i].value=s;else if(r[i].type==="integer"&&Number.isInteger(s))r[i].value=s;else if(r[i].type==="array"){for(u=0;u<s.length;u+=1)if(n=!0,s[u].length===1&&typeof s[u][0]=="number")c.push(String(s[u]-1));else if(s[u].length>1){for(d=0;d<s[u].length;d+=1)typeof s[u][d]!="number"&&(n=!1);n===!0&&c.push([s[u][0]-1,s[u][1]-1].join(" "))}r[i].value="["+c.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},Rn.API.addMetadata=function(e,t){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:e,namespaceUri:t??"http://jspdf.default.namespaceuri/",rawXml:typeof t=="boolean"&&t},this.internal.events.subscribe("putCatalog",$ge),this.internal.events.subscribe("postPutResources",Dge)),this},function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var l,c=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,p=s.length;f<p;++f){if(l=o.metadata.characterToGlyph(s.charCodeAt(f)),o.metadata.glyIdsUsed.push(l),o.metadata.toUnicode[l]=s.charCodeAt(f),c.indexOf(l)==-1&&(c.push(l),c.push([parseInt(o.metadata.widthOfGlyph(l),10)])),l=="0")return d.join("");l=l.toString(16),d.push(u[4-l.length],l)}return d.join("")},n=function(s){var o,l,c,u,d,f,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,p=(l=Object.keys(s).sort(function(h,m){return h-m})).length;f<p;f++)o=l[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(u=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),c.push("<"+o+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="Identity-H"){for(var f=l.metadata.Unicode.widths,p=l.metadata.subset.encode(l.metadata.glyIdsUsed,1),h="",m=0;m<p.length;m++)h+=String.fromCharCode(p[m]);var g=u();d({data:h,addLength1:!0,objectId:g}),c("endobj");var y=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Fp(l.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/Flags "+l.metadata.flags),c("/StemV "+l.metadata.stemV),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c(">>"),c("endobj");var v=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Fp(l.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+l.encoding+")"),c(">>"),c(">>"),c("endobj"),l.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+Fp(l.fontName)),c("/Encoding /"+l.encoding),c("/DescendantFonts ["+v+" 0 R]"),c(">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var l=o.font,c=o.out,u=o.newObject,d=o.putStream;if(l.metadata instanceof e.API.TTFFont&&l.encoding==="WinAnsiEncoding"){for(var f=l.metadata.rawData,p="",h=0;h<f.length;h++)p+=String.fromCharCode(f[h]);var m=u();d({data:p,addLength1:!0,objectId:m}),c("endobj");var g=u();d({data:n(l.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=u();c("<<"),c("/Descent "+l.metadata.decender),c("/CapHeight "+l.metadata.capHeight),c("/StemV "+l.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(l.metadata.bbox)),c("/FontName /"+Fp(l.fontName)),c("/ItalicAngle "+l.metadata.italicAngle),c("/Ascent "+l.metadata.ascender),c(">>"),c("endobj"),l.objectNumber=u();for(var b=0;b<l.metadata.hmtx.widths.length;b++)l.metadata.hmtx.widths[b]=parseInt(l.metadata.hmtx.widths[b]*(1e3/l.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Fp(l.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+l.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(l.metadata.hmtx.widths)+">>"),c("endobj"),l.isAlreadyPutted=!0}})(s)}]);var i=function(s){var o,l=s.text||"",c=s.x,u=s.y,d=s.options||{},f=s.mutex||{},p=f.pdfEscape,h=f.activeFontKey,m=f.fonts,g=h,y="",b=0,v="",w=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:l,x:c,y:u,options:d,mutex:f};for(v=l,g=h,Array.isArray(l)&&(v=l[0]),b=0;b<v.length;b+=1)m[g].metadata.hasOwnProperty("cmap")&&(o=m[g].metadata.cmap.unicode.codeMap[v[b].charCodeAt(0)]),o||v[b].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?y+=v[b]:y+="";var S="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?S=p(y,g).split("").map(function(j){return j.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(S=r(y,m[g])),f.isHex=!0,{text:S,x:c,y:u,options:d,mutex:f}};t.events.push(["postProcessText",function(s){var o=s.text||"",l=[],c={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?l.push([i(Object.assign({},c,{text:o[u][0]})).text,o[u][1],o[u][2]]):l.push(i(Object.assign({},c,{text:o[u]})).text);s.text=l}else s.text=i(Object.assign({},c,{text:o})).text}])}(Rn),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(Rn.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,s,o,l,c,u,d,f=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),v=!1,w=0;this.__bidiEngine__={};var S=function(E){var P=E.charCodeAt(),D=P>>8,G=g[D];return G!==void 0?f[256*G+(255&P)]:D===252||D===253?"AL":b.test(D)?"L":D===8?"R":"N"},j=function(E){for(var P,D=0;D<E.length;D++){if((P=S(E.charAt(D)))==="L")return!1;if(P==="R")return!0}return!1},k=function(E,P,D,G){var H,oe,de,W,V=P[G];switch(V){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":v=!1;break;case"N":case"AN":break;case"EN":v&&(V="AN");break;case"AL":v=!0,V="R";break;case"WS":case"BN":V="N";break;case"CS":G<1||G+1>=P.length||(H=D[G-1])!=="EN"&&H!=="AN"||(oe=P[G+1])!=="EN"&&oe!=="AN"?V="N":v&&(oe="AN"),V=oe===H?oe:"N";break;case"ES":V=(H=G>0?D[G-1]:"B")==="EN"&&G+1<P.length&&P[G+1]==="EN"?"EN":"N";break;case"ET":if(G>0&&D[G-1]==="EN"){V="EN";break}if(v){V="N";break}for(de=G+1,W=P.length;de<W&&P[de]==="ET";)de++;V=de<W&&P[de]==="EN"?"EN":"N";break;case"NSM":if(o&&!l){for(W=P.length,de=G+1;de<W&&P[de]==="NSM";)de++;if(de<W){var ae=E[G],ee=ae>=1425&&ae<=2303||ae===64286;if(H=P[de],ee&&(H==="R"||H==="AL")){V="R";break}}}V=G<1||(H=P[G-1])==="B"?"N":D[G-1];break;case"B":v=!1,i=!0,V=w;break;case"S":s=!0,V="N"}return V},A=function(E,P,D){var G=E.split("");return D&&R(G,D,{hiLevel:w}),G.reverse(),P&&P.reverse(),G.join("")},R=function(E,P,D){var G,H,oe,de,W,V=-1,ae=E.length,ee=0,C=[],Y=w?h:p,q=[];for(v=!1,i=!1,s=!1,H=0;H<ae;H++)q[H]=S(E[H]);for(oe=0;oe<ae;oe++){if(W=ee,C[oe]=k(E,q,C,oe),G=240&(ee=Y[W][m[C[oe]]]),ee&=15,P[oe]=de=Y[ee][5],G>0)if(G===16){for(H=V;H<oe;H++)P[H]=1;V=-1}else V=-1;if(Y[ee][6])V===-1&&(V=oe);else if(V>-1){for(H=V;H<oe;H++)P[H]=de;V=-1}q[oe]==="B"&&(P[oe]=0),D.hiLevel|=de}s&&function(O,X,F){for(var Q=0;Q<F;Q++)if(O[Q]==="S"){X[Q]=w;for(var K=Q-1;K>=0&&O[K]==="WS";K--)X[K]=w}}(q,P,ae)},M=function(E,P,D,G,H){if(!(H.hiLevel<E)){if(E===1&&w===1&&!i)return P.reverse(),void(D&&D.reverse());for(var oe,de,W,V,ae=P.length,ee=0;ee<ae;){if(G[ee]>=E){for(W=ee+1;W<ae&&G[W]>=E;)W++;for(V=ee,de=W-1;V<de;V++,de--)oe=P[V],P[V]=P[de],P[de]=oe,D&&(oe=D[V],D[V]=D[de],D[de]=oe);ee=W}ee++}}},B=function(E,P,D){var G=E.split(""),H={hiLevel:w};return D||(D=[]),R(G,D,H),function(oe,de,W){if(W.hiLevel!==0&&d)for(var V,ae=0;ae<oe.length;ae++)de[ae]===1&&(V=y.indexOf(oe[ae]))>=0&&(oe[ae]=y[V+1])}(G,D,H),M(2,G,P,D,H),M(1,G,P,D,H),G.join("")};return this.__bidiEngine__.doBidiReorder=function(E,P,D){if(function(H,oe){if(oe)for(var de=0;de<H.length;de++)oe[de]=de;l===void 0&&(l=j(H)),u===void 0&&(u=j(H))}(E,P),o||!c||u)if(o&&c&&l^u)w=l?1:0,E=A(E,P,D);else if(!o&&c&&u)w=l?1:0,E=B(E,P,D),E=A(E,P);else if(!o||l||c||u){if(o&&!c&&l^u)E=A(E,P),l?(w=0,E=B(E,P,D)):(w=1,E=B(E,P,D),E=A(E,P));else if(o&&l&&!c&&u)w=1,E=B(E,P,D),E=A(E,P);else if(!o&&!c&&l^u){var G=d;l?(w=1,E=B(E,P,D),w=0,d=!1,E=B(E,P,D),d=G):(w=0,E=B(E,P,D),E=A(E,P),w=1,d=!1,E=B(E,P,D),d=G,E=A(E,P))}}else w=0,E=B(E,P,D);else w=l?1:0,E=B(E,P,D);return E},this.__bidiEngine__.setOptions=function(E){E&&(o=E.isInputVisual,c=E.isOutputVisual,l=E.isInputRtl,u=E.isOutputRtl,d=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var s=n.options||{};n.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(i)==="[object Array]"){var l=0;for(o=[],l=0;l<i.length;l+=1)Object.prototype.toString.call(i[l])==="[object Array]"?o.push([r.doBidiReorder(i[l][0]),i[l][1],i[l][2]]):o.push([r.doBidiReorder(i[l])]);n.text=o}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(Rn),Rn.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new xh(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new txe(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new Uge(this.contents),this.head=new Wge(this),this.name=new Kge(this),this.cmap=new Uz(this),this.toUnicode={},this.hhea=new qge(this),this.maxp=new Yge(this),this.hmtx=new Xge(this),this.post=new Vge(this),this.os2=new Hge(this),this.loca=new exe(this),this.glyf=new Qge(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,l,c,u;for(u=[],o=0,l=(c=this.bbox).length;o<l;o++)t=c[o],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,s,o,l;for(o=0,s=0,l=(t=""+t).length;0<=l?s<l:s>l;s=0<=l?++s:--s)i=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var ju,xh=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,s,o,l,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^s)+65536*(255^o)+256*(255^l)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*s+65536*o+256*l+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,s;for(s=[],n=0,i=t.length;n<i;n++)r=t[n],s.push(this.writeByte(r));return s},e}(),Uge=function(){var e;function t(r){var n,i,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,s=this.tableCount;0<=s?i<s:i>s;i=0<=s?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,s,o,l,c,u,d,f,p,h,m,g;for(g in h=Object.keys(r).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),o=Math.floor(f/c),d=16*h-f,(i=new xh).writeInt(this.scalarType),i.writeShort(h),i.writeShort(f),i.writeShort(o),i.writeShort(d),s=16*h,u=i.pos+s,l=null,m=[],r)for(p=r[g],i.writeString(g),i.writeInt(e(p)),i.writeInt(u),i.writeInt(p.length),m=m.concat(p),g==="head"&&(l=u),u+=p.length;u%4;)m.push(0),u++;return i.write(m),n=2981146554-e(i.data),i.pos=l+8,i.writeUInt32(n),i.data},e=function(r){var n,i,s,o;for(r=zz.call(r);r.length%4;)r.push(0);for(s=new xh(r),i=0,n=0,o=r.length;n<o;n=n+=4)i+=s.readUInt32();return 4294967295&i},t}(),zge={}.hasOwnProperty,ud=function(e,t){for(var r in t)zge.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};ju=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Wge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new xh).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),wM=function(){function e(t,r){var n,i,s,o,l,c,u,d,f,p,h,m,g,y,b,v,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),p=h/2,t.pos+=6,s=function(){var S,j;for(j=[],c=S=0;0<=p?S<p:S>p;c=0<=p?++S:--S)j.push(t.readUInt16());return j}(),t.pos+=2,g=function(){var S,j;for(j=[],c=S=0;0<=p?S<p:S>p;c=0<=p?++S:--S)j.push(t.readUInt16());return j}(),u=function(){var S,j;for(j=[],c=S=0;0<=p?S<p:S>p;c=0<=p?++S:--S)j.push(t.readUInt16());return j}(),d=function(){var S,j;for(j=[],c=S=0;0<=p?S<p:S>p;c=0<=p?++S:--S)j.push(t.readUInt16());return j}(),i=(this.length-t.pos+this.offset)/2,l=function(){var S,j;for(j=[],c=S=0;0<=i?S<i:S>i;c=0<=i?++S:--S)j.push(t.readUInt16());return j}(),c=b=0,w=s.length;b<w;c=++b)for(y=s[c],n=v=m=g[c];m<=y?v<=y:v>=y;n=m<=y?++v:--v)d[c]===0?o=n+u[c]:(o=l[d[c]/2+(n-m)-(p-c)]||0)!==0&&(o+=u[c]),this.codeMap[n]=65535&o}t.pos=f}return e.encode=function(t,r){var n,i,s,o,l,c,u,d,f,p,h,m,g,y,b,v,w,S,j,k,A,R,M,B,E,P,D,G,H,oe,de,W,V,ae,ee,C,Y,q,O,X,F,Q,K,ne,re,T;switch(G=new xh,o=Object.keys(t).sort(function(I,ie){return I-ie}),r){case"macroman":for(g=0,y=function(){var I=[];for(m=0;m<256;++m)I.push(0);return I}(),v={0:0},s={},H=0,V=o.length;H<V;H++)v[K=t[i=o[H]]]==null&&(v[K]=++g),s[i]={old:t[i],new:v[t[i]]},y[i]=v[t[i]];return G.writeUInt16(1),G.writeUInt16(0),G.writeUInt32(12),G.writeUInt16(0),G.writeUInt16(262),G.writeUInt16(0),G.write(y),{charMap:s,subtable:G.data,maxGlyphID:g+1};case"unicode":for(P=[],f=[],w=0,v={},n={},b=u=null,oe=0,ae=o.length;oe<ae;oe++)v[j=t[i=o[oe]]]==null&&(v[j]=++w),n[i]={old:j,new:v[j]},l=v[j]-i,b!=null&&l===u||(b&&f.push(b),P.push(i),u=l),b=i;for(b&&f.push(b),f.push(65535),P.push(65535),B=2*(M=P.length),R=2*Math.pow(Math.log(M)/Math.LN2,2),p=Math.log(R/2)/Math.LN2,A=2*M-R,c=[],k=[],h=[],m=de=0,ee=P.length;de<ee;m=++de){if(E=P[m],d=f[m],E===65535){c.push(0),k.push(0);break}if(E-(D=n[E].new)>=32768)for(c.push(0),k.push(2*(h.length+M-m)),i=W=E;E<=d?W<=d:W>=d;i=E<=d?++W:--W)h.push(n[i].new);else c.push(D-E),k.push(0)}for(G.writeUInt16(3),G.writeUInt16(1),G.writeUInt32(12),G.writeUInt16(4),G.writeUInt16(16+8*M+2*h.length),G.writeUInt16(0),G.writeUInt16(B),G.writeUInt16(R),G.writeUInt16(p),G.writeUInt16(A),F=0,C=f.length;F<C;F++)i=f[F],G.writeUInt16(i);for(G.writeUInt16(0),Q=0,Y=P.length;Q<Y;Q++)i=P[Q],G.writeUInt16(i);for(ne=0,q=c.length;ne<q;ne++)l=c[ne],G.writeUInt16(l);for(re=0,O=k.length;re<O;re++)S=k[re],G.writeUInt16(S);for(T=0,X=h.length;T<X;T++)g=h[T],G.writeUInt16(g);return{charMap:n,subtable:G.data,maxGlyphID:w+1}}},e}(),Uz=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new wM(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,i;return r==null&&(r="macroman"),n=wM.encode(t,r),(i=new xh).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),qge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),Hge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),Vge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var s;for(n=t.readUInt16(),this.glyphNameIndex=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var o,l,c;for(c=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)c.push(t.readUInt32());return c}).call(this)}},e}(),Gge=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Kge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,i,s,o,l,c,u,d,f,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),l=t.readShort(),n=[],s=0;0<=r?s<r:s>r;s=0<=r?++s:--s)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(c={},s=d=0,f=n.length;d<f;s=++d)i=n[s],t.pos=i.offset,u=t.readString(i.length),o=new Gge(u,i),c[p=i.nameID]==null&&(c[p]=[]),c[i.nameID].push(o);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),Yge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),Xge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,i,s,o,l,c;for(t.pos=this.offset,this.metrics=[],r=0,l=this.file.hhea.numberOfMetrics;0<=l?r<l:r>l;r=0<=l?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=i?u<i:u>i;r=0<=i?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,f,p;for(p=[],u=0,d=(f=this.metrics).length;u<d;u++)s=f[u],p.push(s.advance);return p}).call(this),n=this.widths[this.widths.length-1],c=[],r=o=0;0<=i?o<i:o>i;r=0<=i?++o:--o)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),zz=[].slice,Qge=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,i,s,o,l,c,u,d,f;return t in this.cache?this.cache[t]:(s=this.file.loca,r=this.file.contents,n=s.indexOf(t),(i=s.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,o=(l=new xh(r.read(i))).readShort(),u=l.readShort(),f=l.readShort(),c=l.readShort(),d=l.readShort(),this.cache[t]=o===-1?new Zge(l,u,f,c,d):new Jge(l,o,u,f,c,d),this.cache[t]))},e.prototype.encode=function(t,r,n){var i,s,o,l,c;for(o=[],s=[],l=0,c=r.length;l<c;l++)i=t[r[l]],s.push(o.length),i&&(o=o.concat(i.encode(n)));return s.push(o.length),{table:o,offsets:s}},e}(),Jge=function(){function e(t,r,n,i,s,o){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Zge=function(){function e(t,r,n,i,s){var o,l;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;l=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&l;)o.pos+=1&l?4:2,128&l?o.pos+=8:64&l?o.pos+=4:8&l&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new xh(zz.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),exe=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ud(e,ju),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=2)s.push(2*t.readUInt16());return s}).call(this):(function(){var i,s;for(s=[],n=0,i=this.length;n<i;n+=4)s.push(t.readUInt32());return s}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),i=0,s=0,o=0;o<n.length;++o)if(n[o]=i,s<r.length&&r[s]==o){++s,n[o]=i;var l=this.offsets[o],c=this.offsets[o+1]-l;c>0&&(i+=c)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},e}(),txe=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,s;for(r in i=this.font.cmap.tables[0].codeMap,t={},s=this.subset)n=s[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,s,o,l,c;for(i={},o=0,l=t.length;o<l;o++)i[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],i)(n=i[s])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(s in c=this.glyphsFor(r))n=c[s],i[s]=n;return i},e.prototype.encode=function(t,r){var n,i,s,o,l,c,u,d,f,p,h,m,g,y,b;for(i in n=Uz.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),h={0:0},b=n.charMap)h[(c=b[i]).old]=c.new;for(m in p=n.maxGlyphID,o)m in h||(h[m]=p++);return d=function(v){var w,S;for(w in S={},v)S[v[w]]=w;return S}(h),f=Object.keys(d).sort(function(v,w){return v-w}),g=function(){var v,w,S;for(S=[],v=0,w=f.length;v<w;v++)l=f[v],S.push(d[l]);return S}(),s=this.font.glyf.encode(o,g,h),u=this.font.loca.encode(s.offsets,g),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();Rn.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,s,o;if(Array.isArray(r))return"["+function(){var l,c,u;for(u=[],l=0,c=r.length;l<c;l++)n=r[l],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in s=["<<"],r)o=r[i],s.push("/"+i+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();const rxe="/assets/logo-BRcnjZP7.jpg",nxe="K RAMAKRISHNAN COLLEGE OF TECHNOLOGY, Autonomous";function Wz(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,64)}function Db(e,t,r){const n=String(t??"");if(!n)return"";if(e.getTextWidth(n)<=r)return n;const i="",s=e.getTextWidth(i);if(s>=r)return"";let o=0,l=n.length;for(;o<l;){const c=Math.ceil((o+l)/2),u=n.slice(0,c);e.getTextWidth(u)+s<=r?o=c:l=c-1}return n.slice(0,Math.max(0,o))+i}function SM(e,t){const r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=e,n.click(),setTimeout(()=>URL.revokeObjectURL(r),500)}async function ixe(){var e;try{const t=await mr("/api/accounts/me/",{method:"GET"});if(!t.ok)return"";const r=await t.json(),n=String((r==null?void 0:r.username)||"").trim(),i=String(((e=r==null?void 0:r.profile)==null?void 0:e.staff_id)||"").trim();return n||i||""}catch{return""}}function qz(e){const t=String(e.collegeName||nxe).trim(),r=String(e.courseName||"").trim(),n=String(e.courseCode||"").trim(),i=String(e.staffName||"").trim(),s=String(e.className||"").trim();return[t,`Course Name: ${r||"-"}`,`Course Code: ${n||"-"}`,`Staff Name: ${i||"-"}`,`Class Name: ${s||"-"}`]}function axe(e,t){const r=qz(e),n=["S.No","Reg No","Name","Total"],i=t.map(s=>[s.sno,s.regNo,s.name,s.total]);return[...r.map(s=>[s,"","",""]),[""],[n[0],n[1],n[2],n[3]],...i]}function sxe(e,t,r){const i=$o.book_new(),s=[];for(let l=0;l<r.length;l+=45)s.push(r.slice(l,l+45));s.length===0&&s.push([]),s.forEach((l,c)=>{const u=$o.aoa_to_sheet(axe(t,l));u["!freeze"]={xSplit:0,ySplit:7},u["!cols"]=[{wch:6},{wch:16},{wch:34},{wch:12}],$o.book_append_sheet(i,u,s.length>1?`Page_${c+1}`:"Sheet1")});const o=`${Wz(e)||"marks"}_totals.xlsx`;MS(i,o)}function oxe(e,t){if(e.availableH=Math.max(60,e.bottomY-e.tableTopY),t.length<=1){e.colsNeeded=1,e.rowsPerCol=Math.max(1,t.length),e.colW=e.availableW;return}e.colsNeeded=2,e.colW=(e.availableW-e.colGap)/2;const r=Math.max(1,Math.ceil(t.length/2)),n=()=>e.headerRowH+r*e.rowH<=e.availableH;let i=0;for(;i++<30&&!n()&&e.rowH>6;)e.tableFont=Math.max(5,e.tableFont-.25),e.rowH=Math.max(6,e.rowH-1),e.headerRowH=Math.max(9,e.headerRowH-1);e.rowsPerCol=r}function _M(e,t,r){const n=new Rn({orientation:e,unit:"pt",format:"a4"}),i=n.internal.pageSize.getWidth(),s=n.internal.pageSize.getHeight(),o=32,l=34,c=s-28,u=i-o*2,d=12,f=l,p=Math.max(60,c-f);let h=8,m=12,g=14;const y=10,b=()=>{const A=Math.max(1,Math.floor((p-g)/m)),R=Math.max(1,Math.ceil(r.length/A)),M=(u-y*(R-1))/R;return{rowsPerCol:A,colsNeeded:R,colW:M}};let{rowsPerCol:v,colsNeeded:w,colW:S}=b();const j=150;let k=0;for(;k++<12&&S<j&&w>1;)h=Math.max(6,h-.5),m=Math.max(9,m-1),g=Math.max(11,g-1),{rowsPerCol:v,colsNeeded:w,colW:S}=b();return{doc:n,marginX:o,topY:l,bottomY:c,tableTopY:f,availableW:u,availableH:p,tableFont:h,headerFont:d,rowH:m,headerRowH:g,colGap:y,colsNeeded:w,rowsPerCol:v,colW:S}}function lxe(e,t,r,n){const i=t.tableTopY,s={sno:.12,reg:.3,name:.43,total:.15},o=t.colW*s.sno,l=t.colW*s.reg,c=t.colW*s.name,u=t.colW*s.total,d=3;e.setFontSize(t.tableFont);const f=[17,24,39],p=[255,255,255],h=[180,180,180];for(let m=0;m<t.colsNeeded;m++){const g=t.marginX+m*(t.colW+t.colGap);let y=i;e.setFillColor(f[0],f[1],f[2]),e.rect(g,y,t.colW,t.headerRowH,"F"),e.setTextColor(p[0],p[1],p[2]);const b=y+t.headerRowH-4;e.text("S.No",g+d,b),e.text("Reg No",g+o+d,b),e.text("Name",g+o+l+d,b),e.text("Total",g+o+l+c+d,b),e.setDrawColor(h[0],h[1],h[2]),e.rect(g,y,t.colW,t.headerRowH),e.line(g+o,y,g+o,y+t.headerRowH),e.line(g+o+l,y,g+o+l,y+t.headerRowH),e.line(g+o+l+c,y,g+o+l+c,y+t.headerRowH),y+=t.headerRowH,e.setTextColor(0,0,0);const v=m*t.rowsPerCol,w=Math.min(n.length,v+t.rowsPerCol);for(let S=v;S<w;S++){const j=n[S],k=y+(S-v)*t.rowH;e.rect(g,k,t.colW,t.rowH),e.line(g+o,k,g+o,k+t.rowH),e.line(g+o+l,k,g+o+l,k+t.rowH),e.line(g+o+l+c,k,g+o+l+c,k+t.rowH);const A=k+t.rowH-3,R=Db(e,String((j==null?void 0:j.sno)??""),Math.max(0,o-d*2)),M=Db(e,String((j==null?void 0:j.regNo)??""),Math.max(0,l-d*2)),B=Db(e,String((j==null?void 0:j.name)??""),Math.max(0,c-d*2)),E=Db(e,String((j==null?void 0:j.total)??""),Math.max(0,u-d*2));e.text(R,g+d,A),e.text(M,g+o+d,A),e.text(B,g+o+l+d,A),e.text(E,g+o+l+c+d,A)}}}async function cxe(e){try{const t=await fetch(e,{cache:"no-cache"});if(!t.ok)return null;const r=await t.blob();return await new Promise(n=>{const i=new FileReader;i.onload=()=>n(String(i.result||"")),i.onerror=()=>n(null),i.readAsDataURL(r)})}catch{return null}}async function uxe(e,t,r,n){const i=String((r==null?void 0:r.bannerUrl)||rxe),s=(r==null?void 0:r.bannerUrl)||i,o=await cxe(s),l=n.length>=55;let c=0;if(o)try{const p=new Image;p.src=o,await new Promise(A=>{p.onload=()=>A(!0),p.onerror=()=>A(!0)});const h=p.naturalWidth||p.width||1,m=p.naturalHeight||p.height||1,g=t.doc.internal.pageSize.getWidth(),y=l?135:170,b=g-2*t.marginX,v=h/m;let w=b,S=w/v;S>y&&(S=y,w=S*v);const j=(g-w)/2,k=12;t.doc.addImage(o,"PNG",j,k,w,S),c=S,t.tableTopY=k+S+(l?10:14)}catch{}else t.tableTopY=t.topY;const u=t.tableTopY;e.setFontSize(l?8:9),e.setTextColor(0,0,0);const d=[];r.courseName&&d.push(`Course Name: ${r.courseName}`),r.courseCode&&d.push(`Course Code: ${r.courseCode}`),r.staffName&&d.push(`Staff Name: ${r.staffName}`),r.className&&d.push(`Class Name: ${r.className}`);const f=l?10:11;for(let p=0;p<d.length;p++)e.text(d[p],t.marginX,u+p*f);return t.tableTopY=u+d.length*f+(l?6:10),oxe(t,n),lxe(e,t,r,n)}async function Pj(e,t,r){const n=_M("portrait",t,r),s=n.colsNeeded>=4?_M("landscape",t,r):n;await uxe(s.doc,s,t,r);const o=s.doc.output("blob"),l=`${Wz(e)||"marks"}_totals.pdf`;return{blob:o,filename:l}}function dxe(e,t,r){e.innerHTML="";const n=qz(t),i=document.createElement("div");i.style.display="flex",i.style.flexDirection="column",i.style.gap="2px",i.style.marginBottom="10px",n.forEach(d=>{const f=document.createElement("div");f.textContent=d,f.style.fontWeight=d===n[0]?"900":"700",f.style.fontSize=d===n[0]?"14px":"12px",i.appendChild(f)}),e.appendChild(i);const s=document.createElement("div");s.className="obe-table-wrapper",s.style.maxHeight="420px",s.style.overflow="auto";const o=document.createElement("table");o.className="obe-table",o.style.minWidth="unset";const l=document.createElement("thead"),c=document.createElement("tr");["S.No","Reg No","Name","Total"].forEach(d=>{const f=document.createElement("th");f.textContent=d,c.appendChild(f)}),l.appendChild(c),o.appendChild(l);const u=document.createElement("tbody");r.forEach(d=>{const f=document.createElement("tr");[d.sno,d.regNo,d.name,d.total].forEach(p=>{const h=document.createElement("td");h.textContent=String(p??""),f.appendChild(h)}),u.appendChild(f)}),o.appendChild(u),s.appendChild(o),e.appendChild(s)}function fxe(e,t){e.innerHTML="";const r=URL.createObjectURL(t),n=document.createElement("iframe");return n.src=r,n.style.width="100%",n.style.height="520px",n.style.border="1px solid rgba(226,232,240,0.9)",n.style.borderRadius="10px",e.appendChild(n),()=>URL.revokeObjectURL(r)}async function hxe(e){if(typeof document>"u"||typeof window>"u"){const{blob:S,filename:j}=await Pj(e.filenameBase,e.meta,e.rows);SM(j,S);return}const t=document.createElement("div");t.setAttribute("role","dialog"),t.setAttribute("aria-modal","true"),t.style.position="fixed",t.style.inset="0",t.style.background="rgba(0,0,0,0.35)",t.style.display="grid",t.style.placeItems="center",t.style.padding="16px",t.style.zIndex="9999";const r=document.createElement("div");r.className="obe-card",r.style.width="min(980px, 100%)",r.style.maxHeight="min(92vh, 900px)",r.style.overflow="auto";const n=document.createElement("div");n.textContent="Preview totals before download",n.style.fontWeight="950",n.style.fontSize="14px",n.style.marginBottom="10px";const i=document.createElement("div");i.style.display="flex",i.style.gap="8px",i.style.flexWrap="wrap",i.style.alignItems="center",i.style.justifyContent="space-between",i.style.marginBottom="10px";const s=document.createElement("div");s.style.display="flex",s.style.gap="8px",s.style.flexWrap="wrap";const o=document.createElement("button");o.className="obe-btn obe-btn-secondary",o.textContent="Excel preview";const l=document.createElement("button");l.className="obe-btn obe-btn-primary",l.textContent="PDF preview",s.appendChild(o),s.appendChild(l);const c=document.createElement("div");c.style.display="flex",c.style.gap="8px",c.style.flexWrap="wrap";const u=document.createElement("button");u.className="obe-btn",u.textContent="Close";const d=document.createElement("button");d.className="obe-btn obe-btn-success",d.textContent="Download",c.appendChild(u),c.appendChild(d),i.appendChild(s),i.appendChild(c);const f=document.createElement("div");r.appendChild(n),r.appendChild(i),r.appendChild(f),t.appendChild(r);let p="pdf",h=null,m=null;const g=()=>{o.className=p==="excel"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary",l.className=p==="pdf"?"obe-btn obe-btn-primary":"obe-btn obe-btn-secondary"},y=async()=>{if(h&&(h(),h=null),f.innerHTML="",g(),p==="excel"){m=null,dxe(f,e.meta,e.rows);return}m=await Pj(e.filenameBase,e.meta,e.rows),h=fxe(f,m.blob)};let b=!1;const v=()=>{if(!b){b=!0,h&&h();try{window.removeEventListener("keydown",w),t.remove()}catch{}}},w=S=>{S.key==="Escape"&&v()};t.addEventListener("click",S=>{S.target===t&&v()}),u.addEventListener("click",v),o.addEventListener("click",()=>{p="excel",y()}),l.addEventListener("click",()=>{p="pdf",y()}),d.addEventListener("click",async()=>{if(p==="excel"){sxe(e.filenameBase,e.meta,e.rows);return}const S=m||await Pj(e.filenameBase,e.meta,e.rows);SM(S.filename,S.blob)}),window.addEventListener("keydown",w),document.body.appendChild(t),y()}async function dy(e){const t={...e.meta};t.staffName||(t.staffName=await ixe());const r=(e.rows||[]).filter(n=>n&&n.regNo);await hxe({filenameBase:e.filenameBase,meta:t,rows:r})}const Oj={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},jM=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function kM(e){if(e==="both")return"both";if(e==="1&2"||e==="3&4")return e;if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="5")return 5;if(r==="4")return 4;if(r==="3")return 3;if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(4))return 4;if(r.includes(3))return 3;if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===5?5:t===4?4:t===3?3:t===2?2:t===34?"3&4":t===12?"1&2":1}function pxe(e){return e==="cia2"?{a:3,b:4}:{a:1,b:2}}function sA(e){return e==="both"||e==="1&2"||e==="3&4"}function mxe(e,t){if(sA(e))return{a:.5,b:.5};const r=t.a===3,n=e===t.a||r&&e===1,i=e===t.b||r&&e===2;return n?{a:1,b:0}:i?{a:0,b:1}:{a:0,b:0}}function $b(e,t,r){const n=e[t];if(!n)return{a:0,b:0};if(sA(n.co))return{a:.5,b:.5};const i=e.some(l=>sA(l.co)),s=t===e.length-1,o=String(n.key||"").toLowerCase()==="q9"||String(n.label||"").toLowerCase().includes("q9");return!i&&s&&o?{a:.5,b:.5}:mxe(n.co,r)}function Mh(e){return Object.fromEntries((e||[]).map(t=>[t.key,t.btl]))}function vd(e,t,r){return Math.max(t,Math.min(r,e))}function wd(e,t){if(!t)return"-";const r=e/t*100;if(!Number.isFinite(r))return"-";const n=r.toFixed(1);return n.endsWith(".0")?n.slice(0,-2):n}function Ub(e,t){return`${e}_sheet_${t}`}function gxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Hz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,classType:n,questionPaperType:i}){const s=r||"cia1",o=s==="cia2"?"CIA 2":"CIA 1",l=x.useMemo(()=>pxe(s),[s]),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState(null),y=x.useMemo(()=>{const xe=String(ti(n)||"").trim().toUpperCase();return xe?xe==="THEORY"?"THEORY":xe:""},[n]),b=x.useMemo(()=>{const xe=String(i??"").trim().toUpperCase();return xe==="QP2"?"QP2":xe==="QP1"?"QP1":""},[i]);x.useEffect(()=>{let xe=!0;return(async()=>{var Ut,Le;if(!y){h(null);return}const De=y==="THEORY"&&b||null,gt=s==="cia2"?"CIA2":"CIA1";let vr=null,Je=[];try{vr=await sh({class_type:y,question_paper_type:De,exam:gt}),Je=Array.isArray((Ut=vr==null?void 0:vr.pattern)==null?void 0:Ut.marks)?vr.pattern.marks:[]}catch{}if(!Je.length)try{vr=await sh({class_type:y,question_paper_type:De,exam:"CIA"}),Je=Array.isArray((Le=vr==null?void 0:vr.pattern)==null?void 0:Le.marks)?vr.pattern.marks:[]}catch{}xe&&h(Je.length?vr.pattern:null)})(),()=>{xe=!1}},[y,b,s]);const v=x.useMemo(()=>{var vr,Je,Ut,Le;const xe=((Je=(vr=c==null?void 0:c.assessments)==null?void 0:vr[s])==null?void 0:Je.questions)??((Le=(Ut=c==null?void 0:c.assessments)==null?void 0:Ut.cia1)==null?void 0:Le.questions),Ee=Array.isArray(xe)&&xe.length?xe.map(Be=>({key:String((Be==null?void 0:Be.key)||""),label:String((Be==null?void 0:Be.label)||(Be==null?void 0:Be.key)||""),max:Number((Be==null?void 0:Be.max)||0),co:kM(Be==null?void 0:Be.co),btl:Math.min(6,Math.max(1,Number((Be==null?void 0:Be.btl)||1)))})).filter(Be=>Be.key):jM,De=Array.isArray(p==null?void 0:p.marks)?p.marks:null,gt=Array.isArray(p==null?void 0:p.cos)?p.cos:null;return Array.isArray(De)&&De.length?De.map((Be,Et)=>{const pt=Ee[Et],yt=gt?gt[Et]:void 0;return{key:`q${Et+1}`,label:`Q${Et+1}`,max:Number(Be)||0,co:yt!=null?kM(yt):(pt==null?void 0:pt.co)??l.a,btl:(pt==null?void 0:pt.btl)??1}}).filter(Be=>!!Be.key):Ee},[c,s,p,l.a]),[w,S]=x.useState(!1),[j,k]=x.useState(!1),[A,R]=x.useState(!1),[M,B]=x.useState(null),[E,P]=x.useState([]),[D,G]=x.useState({}),[H,oe]=x.useState(null),de=x.useRef(!1),[W,V]=x.useState(null),[ae,ee]=x.useState(!1),[C,Y]=x.useState(!1),[q,O]=x.useState(null),[X,F]=x.useState(null),Q=x.useRef(null),[K,ne]=x.useState(!1),[re,T]=x.useState(""),[I,ie]=x.useState(!1),[U,Z]=x.useState(null),[me,Pe]=x.useState(!1),[je,Fe]=x.useState(null),[_e,He]=x.useState(null),{data:qe,loading:Pt,error:ut,remainingSeconds:Ke,publishAllowed:lt,refresh:ve}=H0({assessment:s,subjectCode:e,teachingAssignmentId:t}),Ae=!!(qe!=null&&qe.global_override_active&&(qe==null?void 0:qe.global_is_open)===!1),{data:ce,refresh:be}=V0({assessment:s,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:mt}=lc({assessment:s,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:et}=lc({assessment:s,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),[Ue,It]=x.useState(""),[ht,Lt]=x.useState(!1),[yr,Ar]=x.useState(null),[Tt,Vr]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,questionBtl:Mh(jM),rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),Br=x.useRef(null),[Wr,nn]=x.useState(!1),[fn,Ir]=x.useState(null),[dn,Te]=x.useState(!1),[tt,st]=x.useState(null),[kt,jt]=x.useState([]),[ar,tr]=x.useState([]),[Er,se]=x.useState([]),[ue,J]=x.useState(null);x.useEffect(()=>{J(null),Z(null)},[e]);const fe=!!W||!!(ce!=null&&ce.exists&&(ce!=null&&ce.is_published)),ye=!!Tt.markManagerLocked;Tt.markManagerSnapshot!=null,x.useEffect(()=>{if(ce!=null&&ce.is_published&&(ce!=null&&ce.updated_at)&&!W)try{V(new Date(String(ce.updated_at)).toLocaleString())}catch{V(String(ce.updated_at))}},[ce==null?void 0:ce.is_published,ce==null?void 0:ce.updated_at]);const Ce=et!=null&&et.approval_until?String(et.approval_until):null,wt=mt!=null&&mt.approval_until?String(mt.approval_until):null,Qe=!!(et!=null&&et.allowed_by_approval)&&!!Ce&&Ce!==((ue==null?void 0:ue.markEntryApprovalUntil)??null),Ie=!!(mt!=null&&mt.allowed_by_approval)&&!!wt&&wt!==((ue==null?void 0:ue.markManagerApprovalUntil)??null),Re=fe?!!(ce!=null&&ce.entry_open)||Qe||Ie:!0,xt=!!(fe&&!Re),Gt=!!(Ae||(fe?!Re:!ye)),qt=!!(fe&&xt),{pending:Wt,pendingUntilMs:vt,setPendingUntilMs:Rt,refresh:Zt}=G0({enabled:!!qt&&!!e,assessment:s,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!K||!!ae||!!fn);function wr(xe,Ee){return JSON.stringify({assessmentKey:s,totalsMax:hr,questions:(v||[]).map(De=>({key:De.key,label:De.label,max:De.max})),questionBtl:xe,mark_manager:{questions:(Ee==null?void 0:Ee.questions)??[],marks:(Ee==null?void 0:Ee.marks)??[],btls:(Ee==null?void 0:Ee.btls)??[]}})}async function br(){if(e){Te(!0),st(null);try{const xe=await sl({assessment:s,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${o} ${e}`,teaching_assignment_id:t});alert(ol(xe))}catch(xe){const Ee=ll(xe,"Request failed");st(Ee),alert(`Edit request failed: ${Ee}`)}finally{Te(!1)}}}async function cr(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(Wt){Z("Edit request is pending. Please wait for approval.");return}const Ee=String(re||"").trim();if(!Ee){Z("Reason is required.");return}ie(!0);try{const De=await sl({assessment:s,subject_code:String(e),scope:"MARK_ENTRY",reason:Ee,teaching_assignment_id:t});Z(ol(De).replace(/\n/g,"  ")),ne(!1),T(""),Rt(Date.now()+24*60*60*1e3);try{Zt({silent:!0})}catch{}be({silent:!0})}catch(De){const gt=ll(De,"Request failed");alert(`Edit request failed: ${gt}`)}finally{ie(!1)}}async function Tr(){if(I)return;if(Wt){Z("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}B(null),Z(null),T(""),ne(!0)}x.useEffect(()=>{if(!e||!fe||Re)return;const xe=window.setInterval(()=>{be({silent:!0})},3e4);return()=>window.clearInterval(xe)},[Re,fe,e,be]);const Kr=x.useRef(null);x.useEffect(()=>{if(!e||!fe)return;if(!Re){Kr.current=!1;return}const xe=Kr.current;if(Kr.current=!0,xe===!0)return;let Ee=!0;return(async()=>{try{const De=await ei(s,e);if(!Ee)return;const gt=De==null?void 0:De.draft;if(gt&&typeof gt=="object"){const vr=gt.rowsByStudentId;if(vr&&typeof vr=="object"&&Object.values(vr).some(Ut=>{if(!Ut||typeof Ut!="object")return!1;const Le=Ut.marks||Ut.questionMarks;return Array.isArray(Le)?Le.some(Be=>Be!==""&&Be!=null):Object.keys(Ut).some(Be=>Be.startsWith("q")&&Ut[Be]!==""&&Ut[Be]!=null)})){Vr(Ut=>({...Ut,termLabel:String(gt.termLabel||Ut.termLabel),batchLabel:e,questionBtl:gt.questionBtl&&typeof gt.questionBtl=="object"?gt.questionBtl:Ut.questionBtl,rowsByStudentId:gt.rowsByStudentId,markManagerLocked:gt.markManagerLocked??Ut.markManagerLocked,markManagerSnapshot:gt.markManagerSnapshot??Ut.markManagerSnapshot,markManagerApprovalUntil:gt.markManagerApprovalUntil??Ut.markManagerApprovalUntil})),de.current=!0;return}}Yr(!0)}catch{try{Yr(!0)}catch{}}})(),()=>{Ee=!1}},[Re,fe,e,s]);const Yr=async xe=>{if(e){xe||(O(null),Y(!0));try{const Ee=await w0(s,e,t),De=Ee&&Ee.data!=null?Ee.data:null;F(De)}catch(Ee){xe||O((Ee==null?void 0:Ee.message)||"Failed to load published sheet")}finally{xe||Y(!1)}}};x.useEffect(()=>{ae&&(F(null),Yr(!1))},[ae,e,s]);async function xn(){if(e){Te(!0),st(null);try{const xe=wr(Tt.questionBtl,{questions:kt,marks:ar,btls:Er}),Ee=mt!=null&&mt.approval_until?String(mt.approval_until):Tt.markManagerApprovalUntil||null,De={...Tt,markManagerLocked:!0,markManagerSnapshot:xe,markManagerApprovalUntil:Ee},gt={termLabel:De.termLabel,batchLabel:e,questionBtl:De.questionBtl,rowsByStudentId:De.rowsByStudentId,markManagerLocked:De.markManagerLocked,markManagerSnapshot:De.markManagerSnapshot,markManagerApprovalUntil:De.markManagerApprovalUntil};Vr(De),Ir(null),await Fi(s,e,gt),oe(new Date().toLocaleString());try{await fh(s,String(e),t),be({silent:!0})}catch(vr){console.warn("confirmMarkManagerLock failed",vr)}}catch(xe){st((xe==null?void 0:xe.message)||"Save failed")}finally{Te(!1)}}}x.useEffect(()=>{if(!(!fn||fn.mode!=="confirm"))try{if(Tt.markManagerSnapshot){const xe=JSON.parse(String(Tt.markManagerSnapshot)),Ee=xe&&xe.mark_manager||{};jt(Array.isArray(Ee.questions)?Ee.questions.map(De=>Number(De)).filter(De=>Number.isFinite(De)):[]),tr(Array.isArray(Ee.marks)?Ee.marks.map(De=>Number(De)).filter(De=>Number.isFinite(De)):[]),se(Array.isArray(Ee.btls)?Ee.btls.map(De=>Number(De)).filter(De=>Number.isFinite(De)):[])}else jt([]),tr([]),se([])}catch{jt([]),tr([]),se([])}},[fn]),x.useEffect(()=>{let xe=!0;return(async()=>{try{const Ee=await oc();if(!xe)return;u(Ee||null),f(null),Vr(De=>({...De,termLabel:String((Ee==null?void 0:Ee.termLabel)||De.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch(Ee){if(!xe)return;u(null),f((Ee==null?void 0:Ee.message)||"Failed to load OBE Master config; using derived maxima from questions.")}})(),()=>{xe=!1}},[e]),x.useEffect(()=>{let xe=!0;return(async()=>{if(e){S(!0),B(null);try{let De=null,gt=null;try{gt=(await hc()||[]).find(ft=>{const he=String(ft.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?ft.id===t:!1)||he})}catch{}if(gt&&gt.elective_subject_id&&!gt.section_id)try{const yt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(gt.elective_subject_id))}`);if(yt.ok){const ft=await yt.json();De={students:((Array.isArray(ft.results)?ft.results:Array.isArray(ft)?ft:ft.items||[])||[]).map(Ne=>({id:Number(Ne.student_id??Ne.id),reg_no:String(Ne.reg_no??Ne.regno??""),name:String(Ne.name??Ne.full_name??Ne.username??""),section:Ne.section_name??Ne.section??null})),marks:{}}}}catch(yt){console.warn("Elective-choices fetch failed, falling back:",yt)}if(!De)try{De=await F9(s,e,t)}catch(yt){if(console.warn("CIA marks fetch failed:",yt),gt&&gt.id)try{De={students:(await pc(gt.id)).students||[],marks:{}}}catch{console.warn("TA roster fallback failed")}if(!De)throw yt}if(!xe)return;let vr=(De.students||[]).slice().sort((yt,ft)=>{const he=String((yt==null?void 0:yt.name)||"").trim().toLowerCase(),Ne=String((ft==null?void 0:ft.name)||"").trim().toLowerCase();if(he&&Ne){const Xe=he.localeCompare(Ne);if(Xe)return Xe}else if(he||Ne)return he?-1:1;return String((yt==null?void 0:yt.reg_no)||"").localeCompare(String((ft==null?void 0:ft.reg_no)||""),void 0,{numeric:!0,sensitivity:"base"})});P(vr),g((De==null?void 0:De.subject)||null);const Je=De.marks||{},Ut={};for(const[yt,ft]of Object.entries(Je)){const he=Number(yt);if(!Number.isFinite(he))continue;if(ft==null||ft===""){Ut[he]=null;continue}const Ne=Number(ft);Ut[he]=Number.isFinite(Ne)?Ne:null}G(Ut);try{let yt=null;if(s==="cia1"?yt=await ty(e):yt=await w0("cia2",e),yt&&yt.data&&typeof yt.data=="object"){const ft=yt.data,he=ft.rowsByStudentId||ft.rows||ft.sheet&&ft.sheet.rowsByStudentId||{},Ne={};for(const[Lr,xr]of Object.entries(he||{})){const $r=String(Lr),Dr=xr,cn={},hn=Dr.q||Dr.answers||Dr.questions||Dr;if(hn&&typeof hn=="object")for(const[yn,sn]of Object.entries(hn)){const ir=Number(sn);cn[yn]=Number.isFinite(ir)?ir:""}Ne[$r]={studentId:Number($r)||0,absent:!!Dr.absent,absentKind:Dr.absentKind||void 0,reg_no:String(Dr.reg_no||Dr.reg_no_text||""),q:cn}}const Xe=Array.isArray(ft.questions)?Object.fromEntries(ft.questions.map(Lr=>[String(Lr.key||Lr.label||""),Number(Lr.btl||Lr.btl_level||1)])):Mh(v),At=Object.fromEntries(Object.entries(Xe).map(([Lr,xr])=>{const $r=Number(xr);return Number.isFinite($r)&&$r>=1&&$r<=6?[Lr,$r]:[Lr,""]}));Vr({termLabel:String(ft.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:At,rowsByStudentId:Ne}),V(new Date().toLocaleString());try{Gn(Ub(s,e),{termLabel:String(ft.termLabel||(c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:At,rowsByStudentId:Ne})}catch{}}}catch{}const Le=Qn(Ub(s,e)),Be=Le&&typeof Le=="object"?{termLabel:c!=null&&c.termLabel?String(c.termLabel):String(Le.termLabel||"KRCT AY25-26"),batchLabel:e,questionBtl:Le.questionBtl&&typeof Le.questionBtl=="object"?Le.questionBtl:Mh(v),rowsByStudentId:Le.rowsByStudentId&&typeof Le.rowsByStudentId=="object"?Le.rowsByStudentId:{}}:{termLabel:String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,questionBtl:Mh(v),rowsByStudentId:{}},Et={...Mh(v),...Be.questionBtl||{}};for(const yt of v){const ft=Et[yt.key];ft===""||ft===1||ft===2||ft===3||ft===4||ft===5||ft===6||(Et[yt.key]="")}const pt={...Be.rowsByStudentId};for(const yt of De.students||[]){const ft=String(yt.id);if(pt[ft]){const he=!!pt[ft].absent,Ne=String(pt[ft].absentKind||"").toUpperCase(),Xe=he?Ne==="ML"||Ne==="SKL"||Ne==="AL"?Ne:"AL":void 0;pt[ft]={studentId:yt.id,absent:he,absentKind:Xe,reg_no:yt.reg_no||"",q:{...pt[ft].q}}}else pt[ft]={studentId:yt.id,absent:!1,absentKind:void 0,reg_no:yt.reg_no||"",q:Object.fromEntries(v.map(he=>[he.key,""]))};for(const he of v)he.key in(pt[ft].q||{})||(pt[ft].q[he.key]="")}Vr({...Be,questionBtl:Et,termLabel:Be.termLabel||String((c==null?void 0:c.termLabel)||"KRCT AY25-26"),batchLabel:e,rowsByStudentId:pt})}catch(De){if(!xe)return;B((De==null?void 0:De.message)||`Failed to load ${o} roster`)}finally{xe&&S(!1)}}})(),()=>{xe=!1}},[e,t,c,v,s,o]),x.useEffect(()=>{let xe=!0;return de.current=!1,(async()=>{if(e){try{const Ee=await ei(s,e);if(!xe)return;const De=Ee==null?void 0:Ee.draft;if(De&&typeof De=="object"){Vr(gt=>({...gt,termLabel:String(De.termLabel||gt.termLabel),batchLabel:e,questionBtl:De.questionBtl&&typeof De.questionBtl=="object"?De.questionBtl:gt.questionBtl,rowsByStudentId:De.rowsByStudentId&&typeof De.rowsByStudentId=="object"?De.rowsByStudentId:gt.rowsByStudentId}));try{const gt=Ub(s,e);Gn(gt,{termLabel:String(De.termLabel||"KRCT AY25-26"),batchLabel:String(e),questionBtl:De.questionBtl&&typeof De.questionBtl=="object"?De.questionBtl:Mh(v),rowsByStudentId:De.rowsByStudentId&&typeof De.rowsByStudentId=="object"?De.rowsByStudentId:{}})}catch{}}}catch{if(!xe)return}xe&&(de.current=!0)}})(),()=>{xe=!1}},[e,s,v]);const hr=x.useMemo(()=>v.reduce((xe,Ee)=>xe+Ee.max,0),[v]),nr=x.useMemo(()=>{let xe=0,Ee=0;for(let De=0;De<v.length;De++){const gt=v[De],vr=$b(v,De,l);xe+=gt.max*vr.a,Ee+=gt.max*vr.b}return{a:xe,b:Ee}},[v,l]),Mr=x.useMemo(()=>{var gt,vr,Je,Ut;const xe=((vr=(gt=c==null?void 0:c.assessments)==null?void 0:gt[s])==null?void 0:vr.coMax)??((Ut=(Je=c==null?void 0:c.assessments)==null?void 0:Je.cia1)==null?void 0:Ut.coMax),Ee=Number((xe==null?void 0:xe[`co${l.a}`])??(xe==null?void 0:xe.co1)),De=Number((xe==null?void 0:xe[`co${l.b}`])??(xe==null?void 0:xe.co2));return{a:Number.isFinite(Ee)?Math.max(0,Ee):nr.a,b:Number.isFinite(De)?Math.max(0,De):nr.b}},[c,nr,s,l]),an=x.useMemo(()=>{const xe=new Set;for(const Ee of v){const De=(Tt.questionBtl||{})[Ee.key];(De===1||De===2||De===3||De===4||De===5||De===6)&&xe.add(De)}return[1,2,3,4,5,6].filter(Ee=>xe.has(Ee))},[Tt.questionBtl,v]),it=x.useMemo(()=>{const xe={1:0,2:0,3:0,4:0,5:0,6:0};for(const Ee of v){const De=(Tt.questionBtl||{})[Ee.key];(De===1||De===2||De===3||De===4||De===5||De===6)&&(xe[De]+=Ee.max)}return xe},[Tt.questionBtl,v]),Ye=x.useMemo(()=>{var De,gt,vr,Je;const xe=((gt=(De=c==null?void 0:c.assessments)==null?void 0:De[s])==null?void 0:gt.btlMax)??((Je=(vr=c==null?void 0:c.assessments)==null?void 0:vr.cia1)==null?void 0:Je.btlMax),Ee=(Ut,Le)=>{const Be=Number(xe==null?void 0:xe[Ut]);return Number.isFinite(Be)?Math.max(0,Be):Le};return{1:Ee("1",it[1]),2:Ee("2",it[2]),3:Ee("3",it[3]),4:Ee("4",it[4]),5:Ee("5",it[5]),6:Ee("6",it[6])}},[c,it,s]),ct=(xe,Ee)=>{A||Gt||Vr(De=>{const gt=String(xe),vr=De.rowsByStudentId[gt]||{studentId:xe,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(Ut=>[Ut.key,""]))},Je=Ee?{...vr,absent:!0,absentKind:vr.absentKind||"AL",q:Object.fromEntries(v.map(Ut=>[Ut.key,""]))}:{...vr,absent:!1,absentKind:void 0};return{...De,rowsByStudentId:{...De.rowsByStudentId,[gt]:Je}}})},Ht=(xe,Ee)=>{A||Gt||Vr(De=>{const gt=String(xe),vr=De.rowsByStudentId[gt]||{studentId:xe,absent:!0,absentKind:"AL",reg_no:"",q:Object.fromEntries(v.map(Je=>[Je.key,""]))};return{...De,rowsByStudentId:{...De.rowsByStudentId,[gt]:{...vr,absent:!0,absentKind:Ee}}}})},fr=(xe,Ee)=>{if(A||Ae)return;const De=Tt.markManagerSnapshot!=null;ye&&De||xt||Vr(gt=>({...gt,questionBtl:{...gt.questionBtl||Mh(v),[xe]:Ee}}))};x.useEffect(()=>{if(!e||!de.current)return;let xe=!1;const Ee=setTimeout(async()=>{try{const De={termLabel:Tt.termLabel,batchLabel:e,questionBtl:Tt.questionBtl,rowsByStudentId:Tt.rowsByStudentId};await Fi(s,e,De);try{const gt=Ub(s,e);Gn(gt,{termLabel:Tt.termLabel,batchLabel:e,questionBtl:Tt.questionBtl,rowsByStudentId:Tt.rowsByStudentId})}catch{}xe||oe(new Date().toLocaleString())}catch{}},700);return()=>{xe=!0,clearTimeout(Ee)}},[Tt.questionBtl,e,Tt.rowsByStudentId,s]);const Sr=(xe,Ee,De)=>{A||Gt||Vr(gt=>{const vr=String(xe),Je=gt.rowsByStudentId[vr]||{studentId:xe,absent:!1,absentKind:void 0,reg_no:"",q:Object.fromEntries(v.map(Ne=>[Ne.key,""]))},Ut=!!Je.absent,Le=Ut?String(Je.absentKind||"AL").toUpperCase():"";if(Ut&&!!!(me&&Ut))return gt;const Et=v.find(Ne=>Ne.key===Ee),pt=(Et==null?void 0:Et.max)??hr,yt=De===""?"":vd(Number(De||0),0,pt),ft=Je.absent?Je.absentKind||"AL":null,he=ft==="ML"?60:ft==="SKL"?75:null;return he!=null&&v.reduce((Xe,At)=>{const Lr=At.key===Ee?yt:(Je.q||{})[At.key];return Xe+vd(Number(Lr||0),0,At.max)},0)>he?(He({title:"Mark limit exceeded",message:Le==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"}),gt):{...gt,rowsByStudentId:{...gt.rowsByStudentId,[vr]:{...Je,q:{...Je.q||{},[Ee]:yt}}}}})},gr=xe=>!xe||!xe.q?!1:v.some(Ee=>{const De=xe.q[Ee.key];return De!==""&&De!==null&&De!==void 0});x.useMemo(()=>{const xe={};for(const Ee of E){const De=Tt.rowsByStudentId[String(Ee.id)];if(!De){xe[Ee.id]=null;continue}if(De.absent&&String(De.absentKind||"AL").toUpperCase()==="AL"){xe[Ee.id]=0;continue}const gt=v.reduce((vr,Je)=>{var Ut;return vr+vd(Number(((Ut=De.q)==null?void 0:Ut[Je.key])||0),0,Je.max)},0);xe[Ee.id]=gt}return xe},[E,Tt.rowsByStudentId,v]);const Ze=x.useRef(Tt);Ze.current=Tt,x.useEffect(()=>{const xe=()=>{if(!e||E.length===0||Gt||Ae)return;const Ee=Ze.current,De={termLabel:Ee.termLabel,batchLabel:e,questionBtl:Ee.questionBtl,rowsByStudentId:Ee.rowsByStudentId};Fi(s,e,De).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",xe),()=>window.removeEventListener("obe:before-tab-switch",xe)},[e,s,E.length,Gt,Ae]);const Kt=async()=>{k(!0),B(null);try{const xe={termLabel:Tt.termLabel,batchLabel:e,questionBtl:Tt.questionBtl,rowsByStudentId:Tt.rowsByStudentId};await Fi(s,e,xe),oe(new Date().toLocaleString())}catch(xe){B((xe==null?void 0:xe.message)||`Failed to save ${o} draft`)}finally{k(!1)}},nt=async()=>{var xe;if(e){if(Ae){B("Publishing is locked by IQAC.");return}if(!lt){B("Publish window is closed. Please request IQAC approval.");return}if(fe&&xt){if(Wt){B("Edit request is pending. Please wait for approval.");return}await Tr();return}R(!0),B(null),Z(null);try{const Ee={};for(const[gt,vr]of Object.entries(Tt.rowsByStudentId||{})){const Je=vr||{},Ut=gr(Je);Je.absent&&Ut?Ee[gt]={...Je,absent:!1,absentKind:void 0}:Ee[gt]=Je}const De={...Tt,batchLabel:e,questions:v,rowsByStudentId:Ee};await R9(s,e,De,t),V(new Date().toLocaleString()),J({markEntryApprovalUntil:Ce,markManagerApprovalUntil:wt}),Vr(gt=>({...gt,markManagerLocked:!0})),ve(),be({silent:!0}),Yr(!0);try{console.debug("obe:published dispatch",{assessment:s,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:s}}))}catch{}setTimeout(()=>{try{if(ae&&Q.current){const gt=Q.current;gt.scrollTop=gt.scrollHeight}}catch{}},50)}catch(Ee){const De=Ee==null?void 0:Ee.status;if(String(((xe=Ee==null?void 0:Ee.body)==null?void 0:xe.detail)||(Ee==null?void 0:Ee.message)||""),De===423){V(gt=>gt||new Date().toLocaleString()),ve(),be({silent:!0}),B(null),await Tr();return}B((Ee==null?void 0:Ee.message)||`Failed to publish ${o}`)}finally{R(!1)}}},bt=async()=>{Lt(!0),Ar(null),B(null);try{await jh({assessment:s,subject_code:e,reason:Ue,teaching_assignment_id:t}),Ar("Request sent to IQAC for approval.")}catch(xe){B((xe==null?void 0:xe.message)||"Failed to request approval")}finally{Lt(!1),ve()}},St=()=>{const xe=E.map((Ee,De)=>{const gt=Tt.rowsByStudentId[String(Ee.id)]||{studentId:Ee.id,absent:!1,absentKind:void 0,q:Object.fromEntries(v.map(Ne=>[Ne.key,""]))},vr=gr(gt),Je=!!(gt.absent&&!vr),Ut=Je?String(gt.absentKind||"AL"):"";if(Je){const Ne=Object.fromEntries(v.map(Xe=>[Xe.key,""]));return{sno:De+1,registerNo:Ee.reg_no,name:Ee.name,absent:1,absentKind:Ut,...Ne,total:"ABSENT",[`co${l.a}_mark`]:"",[`co${l.a}_pct`]:"",[`co${l.b}_mark`]:"",[`co${l.b}_pct`]:"",...Object.fromEntries(an.flatMap(Xe=>[[`btl${Xe}_mark`,""],[`btl${Xe}_pct`,""]]))}}const Le=0,Be="",Et=Object.fromEntries(v.map(Ne=>{var Xe;return[Ne.key,vd(Number(((Xe=gt.q)==null?void 0:Xe[Ne.key])||0),0,Ne.max)]})),pt=v.reduce((Ne,Xe)=>Ne+Number(Et[Xe.key]||0),0);let yt=0,ft=0;for(let Ne=0;Ne<v.length;Ne++){const Xe=v[Ne],At=$b(v,Ne,l),Lr=Number(Et[Xe.key]||0);yt+=Lr*At.a,ft+=Lr*At.b}const he={1:0,2:0,3:0,4:0,5:0,6:0};for(const Ne of v){const Xe=(Tt.questionBtl||{})[Ne.key];(Xe===1||Xe===2||Xe===3||Xe===4||Xe===5||Xe===6)&&(he[Xe]+=Number(Et[Ne.key]||0))}return{sno:De+1,registerNo:Ee.reg_no,name:Ee.name,absent:Le,absentKind:Be,...Et,total:pt,[`co${l.a}_mark`]:yt,[`co${l.a}_pct`]:wd(yt,Mr.a),[`co${l.b}_mark`]:ft,[`co${l.b}_pct`]:wd(ft,Mr.b),...Object.fromEntries(an.flatMap(Ne=>[[`btl${Ne}_mark`,he[Ne]],[`btl${Ne}_pct`,wd(he[Ne],Ye[Ne])]]))}});gxe(`${e}_${s.toUpperCase()}_sheet.csv`,xe)},Ct=async()=>{try{const xe=new URLSearchParams;t&&xe.set("teaching_assignment_id",String(t)),b&&xe.set("question_paper_type",String(b));const gt=`${(Oj==null?void 0:Oj.VITE_API_BASE)||(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":"https://db.krgi.co.in")}/api/obe/cia-export-template/${encodeURIComponent(s)}/${encodeURIComponent(e)}${xe.toString()?`?${xe.toString()}`:""}`,vr=await mr(gt,{method:"GET"});if(!vr.ok){const Be=await vr.text();throw new Error(Be||`Export failed (${vr.status})`)}const Je=await vr.blob(),Ut=window.URL.createObjectURL(Je),Le=document.createElement("a");Le.href=Ut,Le.download=`${e}_${s.toUpperCase()}_template.xlsx`,document.body.appendChild(Le),Le.click(),window.URL.revokeObjectURL(Ut),document.body.removeChild(Le)}catch(xe){alert((xe==null?void 0:xe.message)||"Failed to export Excel")}},$t=async()=>{const xe=E.map((gt,vr)=>{const Je=Tt.rowsByStudentId[String(gt.id)]||{studentId:gt.id,absent:!1,q:Object.fromEntries(v.map(pt=>[pt.key,""]))},Ut=gr(Je);if(!!(Je.absent&&!Ut))return{sno:vr+1,regNo:String(gt.reg_no||""),name:String(gt.name||""),total:"ABSENT"};const Be=Object.fromEntries(v.map(pt=>{var yt;return[pt.key,vd(Number(((yt=Je.q)==null?void 0:yt[pt.key])||0),0,pt.max)]})),Et=v.reduce((pt,yt)=>pt+Number(Be[yt.key]||0),0);return{sno:vr+1,regNo:String(gt.reg_no||""),name:String(gt.name||""),total:Et}}),Ee=String((m==null?void 0:m.name)||"").trim(),De=String((m==null?void 0:m.code)||e||"").trim();await dy({filenameBase:`${e}_${o}`,meta:{courseName:Ee,courseCode:De,className:String((m==null?void 0:m.className)||"")},rows:xe})},Vt=async xe=>{if(!(A||Gt||Wr)){nn(!0);try{const Ee=await xe.arrayBuffer(),De=Um(Ee,{type:"array"}),gt=De.Sheets[De.SheetNames[0]],vr=$o.sheet_to_json(gt,{header:1});if(vr.length<2)throw new Error("Excel file is empty or has no data rows");const Je=vr[0],Ut=Je.findIndex(Xe=>String(Xe||"").toLowerCase().includes("register")),Le=Je.findIndex(Xe=>String(Xe||"").toLowerCase().includes("status"));if(Ut===-1)throw new Error('Could not find "Register No" column in Excel file');const Be=2,Et=Le!==-1?Le:Je.length,pt=[];for(let Xe=Be;Xe<Et;Xe++){const At=String(Je[Xe]||"").trim();if(!At)continue;const Lr=At.match(/^([QqOo]\d+|[A-Za-z]\d*)/);if(!Lr)continue;const xr=Lr[1].toUpperCase();if(b==="QP2"&&xr==="Q10"){pt.push({colIdx:Xe,qKey:"q9",mode:"sum"});continue}if(b==="QP2"&&xr==="Q9"){pt.push({colIdx:Xe,qKey:"q9",mode:"set"});continue}const $r=v.find(Dr=>Dr.label.toUpperCase()===xr||Dr.key.toUpperCase()===xr.toUpperCase());$r&&pt.push({colIdx:Xe,qKey:$r.key,mode:"set"})}if(pt.length===0)throw new Error("No matching question columns found in Excel file");const yt=new Map;E.forEach(Xe=>{const At=String(Xe.reg_no||"").trim().toUpperCase();At&&yt.set(At,Xe)});let ft=0,he=0;const Ne={...Tt.rowsByStudentId};for(let Xe=1;Xe<vr.length;Xe++){const At=vr[Xe];if(!At||At.length===0)continue;const Lr=String(At[Ut]||"").trim().toUpperCase();if(!Lr)continue;const xr=yt.get(Lr);if(!xr){he++;continue}const $r=String(xr.id),Dr=Ne[$r]||{studentId:xr.id,absent:!1,absentKind:void 0,reg_no:xr.reg_no,q:Object.fromEntries(v.map(ir=>[ir.key,""]))},cn={...Dr.q};let hn=!1;const yn={};for(const{colIdx:ir,qKey:Qr,mode:vn}of pt){const Kn=At[ir];if(Kn==null||Kn===""){vn==="set"&&(cn[Qr]="");continue}const Bn=Number(Kn);if(!Number.isFinite(Bn)){vn==="set"&&(cn[Qr]="");continue}if(vn==="sum"){yn[Qr]=(yn[Qr]??0)+Bn;continue}const ri=v.find(Un=>Un.key===Qr),on=(ri==null?void 0:ri.max)??hr;cn[Qr]=vd(Bn,0,on),hn=!0}for(const[ir,Qr]of Object.entries(yn)){const vn=Number(cn[ir]===""?0:cn[ir]||0),Kn=v.find(on=>on.key===ir),Bn=(Kn==null?void 0:Kn.max)??hr,ri=vd(vn+Qr,0,Bn);cn[ir]=ri,hn=!0}let sn=Dr.absent;Le!==-1&&(sn=String(At[Le]||"").trim().toLowerCase()==="absent"),Ne[$r]={...Dr,q:cn,absent:sn},(hn||sn!==Dr.absent)&&ft++}Vr(Xe=>({...Xe,rowsByStudentId:Ne})),alert(`Import successful!
Imported: ${ft} students
Skipped: ${he} rows (no matching register number)`)}catch(Ee){alert(`Failed to import Excel: ${(Ee==null?void 0:Ee.message)||"Unknown error"}`),console.error("Import error:",Ee)}finally{nn(!1),Br.current&&(Br.current.value="")}}},Dt=xe=>{var De;const Ee=(De=xe.target.files)==null?void 0:De[0];Ee&&Vt(Ee)},ze=()=>{Br.current&&Br.current.click()};if(w)return a.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",o," roster"]});const at=E.some(xe=>{var Ee;return!!((Ee=Tt.rowsByStudentId[String(xe.id)])!=null&&Ee.absent)}),_t=me?E.filter(xe=>{var Ee;return je&&je.length?je.includes(xe.id):!!((Ee=Tt.rowsByStudentId[String(xe.id)])!=null&&Ee.absent)}):E,Ft={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},pr={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},or={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11},Xt=32;return a.jsxs(og,{children:[_e?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>He(null),children:a.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:xe=>xe.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:_e.title}),a.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:_e.message}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn",onClick:()=>He(null),children:"Close"})})]})}):null,M&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:M}),d&&a.jsx("div",{style:{background:"#fffbeb",border:"1px solid #f59e0b55",color:"#92400e",padding:10,borderRadius:10,marginBottom:10},children:d}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!at,onClick:()=>{if(me)return;const xe=E.filter(Ee=>{var De;return!!((De=Tt.rowsByStudentId[String(Ee.id)])!=null&&De.absent)}).map(Ee=>Ee.id);Fe(xe),Pe(!0)},title:at?"Filter the table to show only absentees":"No absentees marked yet",style:me?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",me?a.jsx("span",{onClick:xe=>{xe.stopPropagation(),Pe(!1),Fe(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),a.jsx("button",{onClick:St,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Export CSV"}),a.jsx("button",{onClick:Ct,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Export Excel"}),a.jsx("button",{onClick:ze,className:"obe-btn obe-btn-secondary",disabled:Wr||E.length===0||Gt||Ae,children:Wr?"Importing":"Import Excel"}),a.jsx("input",{ref:Br,type:"file",accept:".xlsx,.xls",onChange:Dt,style:{display:"none"}})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:$t,className:"obe-btn obe-btn-secondary",disabled:E.length===0,children:"Download"}),a.jsx("button",{onClick:Kt,className:"obe-btn obe-btn-success",disabled:j||E.length===0||Gt||Ae,children:j?"Saving":"Save Draft"}),a.jsx("button",{onClick:nt,disabled:qt?Wt:A||E.length===0||!lt||Gt||Ae,className:"obe-btn obe-btn-primary",children:qt?Wt?"Request Pending":"Request Edit":A?"Publishing":"Publish"}),H&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",H]}),W&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",W]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:lt?"#065f46":"#b91c1c"},children:Pt?"Checking publish due time":ut||(qe!=null&&qe.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(qe.due_at).toLocaleString(),"  Remaining: ",ag(Ke),qe.allowed_by_approval&&qe.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(qe.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Ae?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>ve(),disabled:Pt,children:"Refresh"})})]}):lt?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:Ue,onChange:xe=>It(xe.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>ve(),disabled:ht||Pt,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:bt,disabled:ht,children:ht?"Requesting":"Request Approval"})]}),yr?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:yr}):null]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Term",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:Tt.termLabel})]}),a.jsxs("label",{style:{fontSize:12,color:"#374151"},children:["Sheet Label",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:Tt.batchLabel})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Total max: ",hr," | Questions: ",v.length," | COs: ",l.a,"",l.b," | BTLs: 16"]})]})}),E.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):a.jsxs("div",{style:{position:"relative"},children:[a.jsxs(sg,{locked:Ae,children:[a.jsxs("div",{style:{marginBottom:10,width:"100%",maxWidth:1200,marginLeft:"auto",marginRight:"auto"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Mark Manager"}),a.jsxs("div",{style:{border:"1px solid #fcd34d",background:ye?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,width:"100%",display:"flex",justifyContent:"space-between",gap:10,alignItems:"center",flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"baseline",flexWrap:"wrap",minWidth:0},children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"BTL configuration"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Set BTL per question in the BTL row, then confirm."})]}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e||dn,onClick:()=>Ir({mode:ye?"request":"confirm"}),children:ye?"Edit":"Save"})})]}),tt?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:tt}):null]}),a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Ft,colSpan:4+v.length+1+4+an.length*2,children:[Tt.termLabel," | ",Tt.batchLabel," | ",o]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Ft,width:Xt,minWidth:Xt},rowSpan:3,children:"S.No"}),a.jsx("th",{style:{...Ft,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),a.jsx("th",{style:{...Ft,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:{...Ft,minWidth:88},rowSpan:3,children:"AB"}),a.jsx("th",{style:Ft,colSpan:v.length,children:"QUESTIONS"}),a.jsx("th",{style:Ft,rowSpan:3,children:"Total"}),a.jsx("th",{style:Ft,colSpan:4,children:"CO ATTAINMENT"}),an.length?a.jsx("th",{style:Ft,colSpan:an.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[v.map(xe=>a.jsx("th",{style:{...Ft,width:46,minWidth:46},children:xe.label},xe.key)),a.jsxs("th",{style:Ft,colSpan:2,children:["CO-",l.a]}),a.jsxs("th",{style:Ft,colSpan:2,children:["CO-",l.b]}),an.map(xe=>a.jsxs("th",{style:Ft,colSpan:2,children:["BTL-",xe]},`btl-head-${xe}`))]}),a.jsxs("tr",{children:[v.map(xe=>a.jsx("th",{style:{...Ft,width:46,minWidth:46},children:xe.max},xe.key)),Array.from({length:2+an.length}).flatMap((xe,Ee)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:Ft,children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:Ft,children:"%"})]},Ee))]})]}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},colSpan:3}),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:"BTL"}),v.map(xe=>a.jsx("td",{style:{...pr,textAlign:"center"},children:(()=>{const Ee=(Tt.questionBtl||{})[xe.key]??"",De=Ee===""?"-":String(Ee);return a.jsxs("div",{style:{position:"relative",minWidth:44},children:[a.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${De}`,children:De}),a.jsxs("select",{"aria-label":`BTL for ${xe.label}`,value:Ee,onChange:gt=>fr(xe.key,gt.target.value===""?"":Number(gt.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(gt=>a.jsx("option",{value:gt,children:gt},gt))]})]})})()},`btl-select-${xe.key}`)),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},colSpan:4}),an.map(xe=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"}})]},`btl-pad-${xe}`))]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:"-"}),v.map(xe=>a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:xe.max},xe.key)),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:hr}),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:Mr.a}),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:"%"}),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:Mr.b}),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:"%"}),an.map(xe=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:Ye[xe]}),a.jsx("td",{style:{...pr,fontWeight:700,textAlign:"center"},children:"%"})]},`btl-max-${xe}`))]}),_t.map((xe,Ee)=>{const De=Tt.rowsByStudentId[String(xe.id)]||{studentId:xe.id,reg_no:xe.reg_no??"",absent:!1,absentKind:void 0,q:Object.fromEntries(v.map(ft=>[ft.key,""]))},gt=Object.fromEntries(v.map(ft=>{var he;return[ft.key,vd(Number(((he=De.q)==null?void 0:he[ft.key])||0),0,ft.max)]})),vr=v.reduce((ft,he)=>ft+Number(gt[he.key]||0),0);let Je=0,Ut=0;for(let ft=0;ft<v.length;ft++){const he=v[ft],Ne=$b(v,ft,l),Xe=Number(gt[he.key]||0);Je+=Xe*Ne.a,Ut+=Xe*Ne.b}const Le={1:0,2:0,3:0,4:0,5:0,6:0};for(const ft of v){const he=(Tt.questionBtl||{})[ft.key];(he===1||he===2||he===3||he===4||he===5||he===6)&&(Le[he]+=Number(gt[ft.key]||0))}const Be=De.absent?{background:"#f1f5f9"}:void 0;De.absent&&String(De.absentKind||"AL").toUpperCase();const Et=!!(me&&De.absent),pt=!!(A||Gt||Ae||xt),yt=D[xe.id];return a.jsxs("tr",{style:Be,children:[a.jsx("td",{style:{...pr,textAlign:"center",width:Xt,minWidth:Xt,paddingLeft:2,paddingRight:2},children:Ee+1}),a.jsx("td",{style:{...pr,minWidth:70,overflow:"visible",textOverflow:"clip"},children:AM(De.reg_no)}),a.jsx("td",{style:{...pr,minWidth:240,overflow:"visible",textOverflow:"clip"},children:xe.name}),a.jsx("td",{style:{...pr,textAlign:"center",minWidth:88},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:De.absent,disabled:pt,onChange:ft=>ct(xe.id,ft.target.checked)}),De.absent?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:String(De.absentKind||"AL")}),a.jsxs("select",{"aria-label":"Absent type",value:De.absentKind||"AL",disabled:pt,onChange:ft=>Ht(xe.id,ft.target.value),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),v.map(ft=>{var he,Ne,Xe;return a.jsx("td",{style:{...pr,textAlign:"center",width:46,minWidth:46},children:a.jsx("input",{style:{...or,textAlign:"center"},type:"number",min:0,max:ft.max,disabled:pt||De.absent&&!Et,value:((he=De.q)==null?void 0:he[ft.key])===""||((Ne=De.q)==null?void 0:Ne[ft.key])==null?"":Number(((Xe=De.q)==null?void 0:Xe[ft.key])||0),onChange:At=>{const Lr=At.target.value;if(Lr==="")return At.currentTarget.setCustomValidity(""),Sr(xe.id,ft.key,"");const xr=Number(Lr);if(Number.isFinite(xr)){if(xr>ft.max){At.currentTarget.setCustomValidity(`Max mark is ${ft.max}`),At.currentTarget.reportValidity(),window.setTimeout(()=>At.currentTarget.setCustomValidity(""),0);return}At.currentTarget.setCustomValidity(""),Sr(xe.id,ft.key,xr)}}})},ft.key)}),a.jsx("td",{style:{...pr,textAlign:"center",fontWeight:700},title:yt!=null?`Server total: ${yt}`:void 0,children:vr}),a.jsx("td",{style:{...pr,textAlign:"center"},children:Je}),a.jsx("td",{style:{...pr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Je,Mr.a)})}),a.jsx("td",{style:{...pr,textAlign:"center"},children:Ut}),a.jsx("td",{style:{...pr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Ut,Mr.b)})}),an.map(ft=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...pr,textAlign:"center"},children:Le[ft]}),a.jsx("td",{style:{...pr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Le[ft],Ye[ft])})})]},`btl-row-${xe.id}-${ft}`))]},xe.id)})]})]})})]}),Gt&&!Ae?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:fe?"rgba(240,253,244,0.55)":"rgba(239,246,255,0.65)",border:`1px solid ${fe?"rgba(22,163,74,0.25)":"rgba(59,130,246,0.25)"}`,borderRadius:12,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:fe?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:fe?"Marks are published. Use View to inspect or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock student entry."}),fe&&U?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:U}):null]}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:fe?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>ee(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:async()=>{await Tr()},disabled:I||Wt,children:Wt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ir({mode:"confirm"}),disabled:!e||dn,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>br(),disabled:dn,children:"Request Access"})]})})]})]}):null]}),fn?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{dn||Ir(null)},children:a.jsxs("div",{style:{width:"min(760px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:xe=>xe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:fn.mode==="confirm"?`Confirmation - ${o}`:`Request Edit - ${o}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),fn.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Question"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"BTL"})]})}),a.jsx("tbody",{children:v.map(xe=>a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:xe.label}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:xe.max}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsxs("select",{value:(Tt.questionBtl||{})[xe.key]===""?"":String((Tt.questionBtl||{})[xe.key]),onChange:Ee=>{const De=Ee.target.value===""?"":Number(Ee.target.value);fr(xe.key,De)},style:{padding:"6px 8px",borderRadius:6,border:"1px solid #e5e7eb",background:"#fff"},disabled:dn||Ae,children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Ee=>a.jsx("option",{value:String(Ee),children:Ee},Ee))]})})]},xe.key))})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:dn,onClick:()=>Ir(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:dn||!e,onClick:async()=>{if(e){if(fn.mode==="request"){Ir(null),await br();return}await xn()}},children:fn.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,ae?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>ee(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:xe=>xe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsx("button",{onClick:xe=>{xe.stopPropagation(),ee(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),a.jsxs("div",{style:{padding:14},children:[C?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published sheet"}):null,q?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:q}):null]}),X&&(X.rowsByStudentId||X.rows_by_student_id)?a.jsx("div",{ref:Q,style:{overflow:"auto",border:"1px solid #e5e7eb",borderRadius:12,maxHeight:"60vh"},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Ft,colSpan:6+an.length*2,children:[Tt.termLabel," | ",Tt.batchLabel," | ",o," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Ft,width:Xt,minWidth:Xt},children:"S.No"}),a.jsx("th",{style:{...Ft,minWidth:70,overflow:"visible",textOverflow:"clip"},children:"R.No"}),a.jsx("th",{style:{...Ft,minWidth:240,overflow:"visible",textOverflow:"clip"},children:"Name of the Students"}),a.jsx("th",{style:Ft,children:"Total"}),a.jsxs("th",{style:Ft,colSpan:2,children:["CO-",l.a]}),a.jsxs("th",{style:Ft,colSpan:2,children:["CO-",l.b]}),an.map(xe=>a.jsxs("th",{style:Ft,colSpan:2,children:["BTL-",xe]},`pv_btl_${xe}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Ft}),a.jsx("th",{style:Ft}),a.jsx("th",{style:Ft}),a.jsx("th",{style:Ft}),Array.from({length:2+an.length}).flatMap((xe,Ee)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:Ft,children:"Mark"}),a.jsx("th",{style:Ft,children:"%"})]},`pv_hdr_${Ee}`))]})]}),a.jsx("tbody",{children:E.map((xe,Ee)=>{var pt;const De=X.rowsByStudentId||X.rows_by_student_id||{},gt=De[String(xe.id)]||De[xe.id]||{},vr=gt.q||{},Je=Object.fromEntries(v.map(yt=>[yt.key,vd(Number((vr==null?void 0:vr[yt.key])||0),0,yt.max)])),Ut=v.reduce((yt,ft)=>yt+Number(Je[ft.key]||0),0);let Le=0,Be=0;for(let yt=0;yt<v.length;yt++){const ft=v[yt],he=$b(v,yt,l),Ne=Number(Je[ft.key]||0);Le+=Ne*he.a,Be+=Ne*he.b}const Et={1:0,2:0,3:0,4:0,5:0,6:0};for(const yt of v){const ft=(X.questionBtl||X.question_btl||Tt.questionBtl||{})[yt.key];if(ft===1||ft===2||ft===3||ft===4||ft===5||ft===6){const he=ft;Et[he]+=Number(Je[yt.key]||0)}}return a.jsxs("tr",{children:[a.jsx("td",{style:{...pr,textAlign:"center",width:Xt,minWidth:Xt,paddingLeft:2,paddingRight:2},children:Ee+1}),a.jsx("td",{style:{...pr,minWidth:70,overflow:"visible",textOverflow:"clip"},children:AM(gt.reg_no||((pt=Tt.rowsByStudentId[String(xe.id)])==null?void 0:pt.reg_no)||"")}),a.jsx("td",{style:{...pr,minWidth:240,overflow:"visible",textOverflow:"clip"},children:xe.name}),a.jsx("td",{style:{...pr,textAlign:"center",fontWeight:900},children:Ut}),a.jsx("td",{style:{...pr,textAlign:"center"},children:Math.round(Le)}),a.jsx("td",{style:{...pr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Le,Mr.a)})}),a.jsx("td",{style:{...pr,textAlign:"center"},children:Math.round(Be)}),a.jsx("td",{style:{...pr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Be,Mr.b)})}),an.map(yt=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...pr,textAlign:"center"},children:Math.round(Et[yt])}),a.jsx("td",{style:{...pr,textAlign:"center"},children:a.jsx("span",{className:"obe-pct-badge",children:wd(Et[yt],Ye[yt])})})]},`pv_btl_${xe.id}_${yt}`))]},`pv_${xe.id}`)})})]})}):C?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published sheet found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>ee(!1),children:"Close"})})]})})}):null,K?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{I||ne(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:xe=>xe.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[o,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",vt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:re,onChange:xe=>T(xe.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:I,onClick:()=>ne(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:I||Wt||!e||!String(re||"").trim(),onClick:cr,children:I?"Requesting":Wt?"Request Pending":"Send Request"})]})]})})}):null]})}function AM(e){return e.slice(-8)}function xxe(e){return a.jsx(Hz,{...e,assessmentKey:"cia2"})}const yxe=5,bxe=20,vxe=10;function Mn(e,t,r){return Math.max(t,Math.min(r,e))}function _c(e){return Math.round(e*10)/10}function ds(e){if(e===""||e==null)return"";const t=Number(e);return Number.isFinite(t)?t:""}function zb(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function Na(e,t){if(!t)return"-";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function wxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Sxe(e,t){return`${e}_sheet_${t}`}function _xe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function bp(e){return e.slice(-8)}function Vz({subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:n=!1}){var fr,Sr,gr;const i=r||"formative1",s=i==="formative2"?"Formative 2":"Formative 1",o=i==="formative2"?3:1,l=i==="formative2"?4:2,[c,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,g]=x.useState(null),[y,b]=x.useState({skill1:3,skill2:4,att1:3,att2:4}),[v,w]=x.useState(!1),[S,j]=x.useState(!1),[k,A]=x.useState(null),R=x.useRef(!1),[M,B]=x.useState(null),[E,P]=x.useState(!1),D=x.useRef(null),[G,H]=x.useState(!1),{data:oe,loading:de,error:W,remainingSeconds:V,publishAllowed:ae,refresh:ee}=H0({assessment:i,subjectCode:String(e||""),teachingAssignmentId:t}),C=!!(oe!=null&&oe.global_override_active&&(oe==null?void 0:oe.global_is_open)===!1),[Y,q]=x.useState(""),[O,X]=x.useState(!1),[F,Q]=x.useState(null),[K,ne]=x.useState(null),[re,T]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e||"",rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),{data:I,refresh:ie}=V0({assessment:i,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:U,refresh:Z}=lc({assessment:i,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:me,refresh:Pe}=lc({assessment:i,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[je,Fe]=x.useState(null),_e=!!M||!!(I!=null&&I.exists&&(I!=null&&I.is_published)),He=n?!0:!!re.markManagerLocked;x.useEffect(()=>{if(I!=null&&I.is_published&&(I!=null&&I.updated_at)&&!M)try{B(new Date(String(I.updated_at)).toLocaleString())}catch{B(String(I.updated_at))}},[I==null?void 0:I.is_published,I==null?void 0:I.updated_at]);const qe=me!=null&&me.approval_until?String(me.approval_until):null,Pt=U!=null&&U.approval_until?String(U.approval_until):null,ut=!!(me!=null&&me.allowed_by_approval)&&!!qe&&qe!==((je==null?void 0:je.markEntryApprovalUntil)??null),Ke=!!(U!=null&&U.allowed_by_approval)&&!!Pt&&Pt!==((je==null?void 0:je.markManagerApprovalUntil)??null),lt=_e?!!(I!=null&&I.entry_open)||ut||Ke:!0,ve=!!(_e&&!lt),Ae=!!(_e&&ve),ce=!!(_e&&ve),be=n?!!(C||_e&&!lt):!!(C||(_e?!lt:!He)),mt=n?!0:re.markManagerSnapshot!=null||!!_e,[et,Ue]=x.useState(null),[It,ht]=x.useState(!1),Lt=_e,[yr,Ar]=x.useState(!1),[Tt,Vr]=x.useState(null),[Br,Wr]=x.useState(!1),[nn,fn]=x.useState(null),[Ir,dn]=x.useState(!1),[Te,tt]=x.useState(""),[st,kt]=x.useState(!1),{pending:jt,pendingUntilMs:ar,setPendingUntilMs:tr,refresh:Er}=G0({enabled:!!ce&&!!e,assessment:i,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!Ir||!!yr||!!et);const se=String((K==null?void 0:K.termLabel)||"KRCT AY25-26"),ue=((fr=K==null?void 0:K.assessments)==null?void 0:fr[i])??((Sr=K==null?void 0:K.assessments)==null?void 0:Sr.formative1)??{},J=Number.isFinite(Number(ue==null?void 0:ue.maxPart))?Number(ue.maxPart):yxe,fe=Number.isFinite(Number(ue==null?void 0:ue.maxTotal))?Number(ue.maxTotal):bxe,ye=Number.isFinite(Number(ue==null?void 0:ue.maxCo))?Number(ue.maxCo):vxe,Ce=x.useMemo(()=>{const Ze=re.markManagerSnapshot;if(!Ze)return null;try{const Kt=JSON.parse(String(Ze)),nt=Kt==null?void 0:Kt.partBtl;if(!nt||typeof nt!="object")return null;const bt={};for(const St of["skill1","skill2","att1","att2"]){const Ct=nt[St];bt[St]=Ct===""||Ct==null?"":Number(Ct),bt[St]===""||Number.isFinite(bt[St])&&bt[St]>=1&&bt[St]<=6||(bt[St]="")}return bt}catch{return null}},[re.markManagerSnapshot]);x.useEffect(()=>{Fe(null)},[e]);const wt=Ce||y,Qe=async Ze=>{if(e){Ze||(fn(null),Wr(!0));try{const Kt=await v0(i,e),nt=Kt&&Kt.marks&&typeof Kt.marks=="object"?Kt.marks:null;nt&&Object.keys(nt).length?Vr(nt):Vr(null)}catch(Kt){Ze||fn((Kt==null?void 0:Kt.message)||"Failed to load published marks")}finally{Ze||Wr(!1)}}};x.useEffect(()=>{yr&&(Vr(null),Qe(!1))},[yr,e,i]);const Ie=x.useRef(null);x.useEffect(()=>{if(!e||!_e)return;if(!lt){Ie.current=!1;return}const Ze=Ie.current;if(Ie.current=!0,Ze===!0)return;let Kt=!0;return(async()=>{try{const nt=await ei(i,String(e));if(!Kt)return;const bt=nt==null?void 0:nt.draft,St=bt==null?void 0:bt.sheet,Ct=bt==null?void 0:bt.partBtl;if(St&&typeof St=="object"&&typeof St.rowsByStudentId=="object"){const $t=St.rowsByStudentId;if($t&&Object.values($t).some(Dt=>!Dt||typeof Dt!="object"?!1:["skill1","skill2","att1","att2"].some(ze=>Dt[ze]!==""&&Dt[ze]!=null))){if(T(Dt=>({...Dt,termLabel:String(St.termLabel||se||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:St.rowsByStudentId||{},markManagerLocked:typeof St.markManagerLocked=="boolean"?St.markManagerLocked:!!(St.markManagerSnapshot??Dt.markManagerSnapshot),markManagerSnapshot:St.markManagerSnapshot??Dt.markManagerSnapshot??null,markManagerApprovalUntil:St.markManagerApprovalUntil??Dt.markManagerApprovalUntil??null})),Ct&&typeof Ct=="object"){const Dt={};for(const ze of["skill1","skill2","att1","att2"]){const at=Ct[ze];Dt[ze]=at===""||at==null?"":Number(at),Dt[ze]===""||Number.isFinite(Dt[ze])&&Dt[ze]>=1&&Dt[ze]<=6||(Dt[ze]="")}b(Dt)}R.current=!0;return}}if(!Kt)return;Qe(!1)}catch{if(!Kt)return;Qe(!1)}})(),()=>{Kt=!1}},[lt,_e,e,i,se]),x.useEffect(()=>{if(!e||!_e||lt)return;const Ze=window.setInterval(()=>{ie({silent:!0});try{Pe==null||Pe({silent:!0}),Z==null||Z({silent:!0})}catch{}},3e4);return()=>window.clearInterval(Ze)},[lt,_e,e,ie,Pe,Z]);async function Re(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(jt){alert("Edit request is pending. Please wait for approval.");return}const Kt=String(Te||"").trim();if(!Kt){alert("Reason is required.");return}kt(!0);const nt=new Date,bt=me!=null&&me.approval_until?String(me.approval_until):null;try{const St=await sl({assessment:i,subject_code:String(e),scope:"MARK_ENTRY",reason:Kt,teaching_assignment_id:t});alert(ol(St)),dn(!1),tt(""),tr(Date.now()+24*60*60*1e3);try{Er({silent:!0})}catch{}const Ct=Number(St==null?void 0:St.id),Vt=nt.getTime()-2e3;(async()=>{if(!e)return;const Dt=36,ze=5e3;for(let at=0;at<Dt;at++){try{const _t=await Rm({assessment:i,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),Ft=_t==null?void 0:_t.result;if(!(Ft&&Number.isFinite(Ct)&&Ft.id!==Ct)){if((Ft==null?void 0:Ft.status)==="APPROVED"&&(Ft!=null&&Ft.is_active)){const pr=Ft.reviewed_at?new Date(Ft.reviewed_at).getTime():NaN;if(!(!Number.isFinite(pr)||pr<Vt)){try{Pe==null||Pe({silent:!0}),ie({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}else if((Ft==null?void 0:Ft.status)==="REJECTED"){const pr=Ft.reviewed_at?new Date(Ft.reviewed_at).getTime():NaN;if(!(!Number.isFinite(pr)||pr<Vt)){alert("IQAC rejected the edit request.");return}}}}catch{try{const Ft=await l1(i,String(e),"MARK_ENTRY",t),pr=Ft!=null&&Ft.approval_until?String(Ft.approval_until):null;if(Ft!=null&&Ft.allowed_by_approval&&pr&&pr!==bt){try{Pe==null||Pe({silent:!0}),ie({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(_t=>setTimeout(_t,ze))}alert("Edit request still pending. Please try again later.")})()}catch(St){const Ct=ll(St,"Request failed");alert(`Edit request failed: ${Ct}`)}finally{kt(!1)}}x.useEffect(()=>{let Ze=!0;return(async()=>{try{const Kt=await oc();if(!Ze)return;ne(Kt||null),T(nt=>({...nt,termLabel:String((Kt==null?void 0:Kt.termLabel)||nt.termLabel||"KRCT AY25-26"),batchLabel:e||nt.batchLabel}))}catch{}})(),()=>{Ze=!1}},[e]);const xt=x.useMemo(()=>e?Sxe(i,e):"",[i,e]),Gt=x.useMemo(()=>[{key:"skill1",label:"Skill 1",max:J},{key:"skill2",label:"Skill 2",max:J},{key:"att1",label:"Attitude 1",max:J},{key:"att2",label:"Attitude 2",max:J}],[J]);(gr=Gt[Gt.length-1])==null||gr.key;const qt=x.useMemo(()=>{const Ze=new Set;for(const Kt of Object.keys(y)){const nt=y[Kt];(nt===1||nt===2||nt===3||nt===4||nt===5||nt===6)&&Ze.add(nt)}return[1,2,3,4,5,6].filter(Kt=>Ze.has(Kt))},[y]),Wt=x.useMemo(()=>12+qt.length*2,[qt.length]);x.useEffect(()=>{if(e){const Ze=`${i}_part_btl_${e}`,Kt=Qn(Ze);if(Kt&&typeof Kt=="object")try{const nt={};for(const bt of Object.keys(y)){const St=Kt[bt];nt[bt]=St===""||St==null?"":Number(St),nt[bt]===""||Number.isFinite(nt[bt])&&nt[bt]>=1&&nt[bt]<=6||(nt[bt]="")}b(nt)}catch{}}},[e,i]),x.useEffect(()=>{if(!e)return;const Ze=`${i}_part_btl_${e}`;try{Gn(Ze,y)}catch{}},[y,e,i]);const vt=Ze=>JSON.stringify({assessmentKey:i,partBtl:Ze,maxPart:J,maxTotal:fe});async function Rt(){if(e){ht(!0);try{const Ze=vt(y),Kt=U!=null&&U.approval_until?String(U.approval_until):re.markManagerApprovalUntil||null,nt={...re,markManagerLocked:!0,markManagerSnapshot:Ze,markManagerApprovalUntil:Kt},bt={sheet:nt,partBtl:y,markManagerLocked:nt.markManagerLocked,markManagerSnapshot:nt.markManagerSnapshot,markManagerApprovalUntil:nt.markManagerApprovalUntil};T(nt),Ue(null),await Fi(i,String(e),bt),A(new Date().toLocaleString());try{await fh(i,String(e),t),ie({silent:!0})}catch{}}catch{}finally{ht(!1)}}}async function Zt(){if(!e)return;ht(!0);const Ze=new Date,Kt=U!=null&&U.approval_until?String(U.approval_until):null;try{const nt=await sl({assessment:i,subject_code:String(e),scope:"MARK_MANAGER",reason:`Request mark-manager edit for ${e}`,teaching_assignment_id:t});alert(ol(nt));const bt=Number(nt==null?void 0:nt.id),Ct=Ze.getTime()-2e3;(async()=>{if(!e)return;const $t=36,Vt=5e3;for(let Dt=0;Dt<$t;Dt++){try{const ze=await Rm({assessment:i,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),at=ze==null?void 0:ze.result;if(!(at&&Number.isFinite(bt)&&at.id!==bt)){if((at==null?void 0:at.status)==="APPROVED"&&(at!=null&&at.is_active)){const _t=at.reviewed_at?new Date(at.reviewed_at).getTime():NaN;if(!(!Number.isFinite(_t)||_t<Ct)){try{Z==null||Z({silent:!0}),ie({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}else if((at==null?void 0:at.status)==="REJECTED"){const _t=at.reviewed_at?new Date(at.reviewed_at).getTime():NaN;if(!(!Number.isFinite(_t)||_t<Ct)){alert("IQAC rejected the mark-manager edit request.");return}}}}catch{try{const at=await l1(i,String(e),"MARK_MANAGER",t),_t=at!=null&&at.approval_until?String(at.approval_until):null;if(at!=null&&at.allowed_by_approval&&_t&&_t!==Kt){try{Z==null||Z({silent:!0}),ie({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(ze=>setTimeout(ze,Vt))}alert("Edit request still pending. Please try again later.")})()}catch(nt){const bt=ll(nt,"Request failed");alert(`Edit request failed: ${bt}`)}finally{ht(!1)}}x.useEffect(()=>{if(!e||!R.current)return;let Ze=!1;const Kt=setTimeout(async()=>{try{await Fi(i,e,{sheet:re,partBtl:y});try{xt&&Gn(xt,{termLabel:re.termLabel,batchLabel:re.batchLabel,rowsByStudentId:re.rowsByStudentId})}catch{}Ze||A(new Date().toLocaleString())}catch{}},700);return()=>{Ze=!0,clearTimeout(Kt)}},[y,e,i,re,xt]),x.useEffect(()=>{let Ze=!0;return R.current=!1,(async()=>{if(e){try{const Kt=await ei(i,e);if(!Ze)return;const nt=Kt==null?void 0:Kt.draft,bt=nt==null?void 0:nt.sheet,St=nt==null?void 0:nt.partBtl,Ct=nt==null?void 0:nt.selectedBtls;if(bt&&typeof bt=="object"&&typeof bt.rowsByStudentId=="object"){T({termLabel:String(bt.termLabel||se||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:bt.rowsByStudentId||{},markManagerLocked:typeof bt.markManagerLocked=="boolean"?bt.markManagerLocked:!!bt.markManagerSnapshot,markManagerSnapshot:bt.markManagerSnapshot??null,markManagerApprovalUntil:bt.markManagerApprovalUntil??null});try{xt&&Gn(xt,{termLabel:String(bt.termLabel||se||"KRCT AY25-26"),batchLabel:String(e),rowsByStudentId:bt.rowsByStudentId||{}})}catch{}}if(St&&typeof St=="object"){const $t={};for(const Vt of Object.keys(y)){const Dt=St[Vt];$t[Vt]=Dt===""||Dt==null?"":Number(Dt),$t[Vt]===""||Number.isFinite($t[Vt])&&$t[Vt]>=1&&$t[Vt]<=6||($t[Vt]="")}b($t);try{const Vt=`${i}_part_btl_${e}`;Gn(Vt,$t)}catch{}}else if(Array.isArray(Ct)){const $t=Dt=>Number.isFinite(Dt)&&Dt>=1&&Dt<=6,Vt=Ct.map(Dt=>Number(Dt)).filter($t);if(Vt.length===1){const Dt={skill1:Vt[0],skill2:Vt[0],att1:Vt[0],att2:Vt[0]};b(Dt);try{const ze=`${i}_part_btl_${e}`;Gn(ze,Dt)}catch{}}else if(Vt.length>=2){const Dt={skill1:Vt[0],skill2:Vt[1],att1:Vt[0],att2:Vt[1]};b(Dt);try{const ze=`${i}_part_btl_${e}`;Gn(ze,Dt)}catch{}}}}catch{}Ze&&(R.current=!0)}})(),()=>{Ze=!1}},[e,se,i,xt]),x.useEffect(()=>{let Ze=!0;return(async()=>{if(e){u(!0),f(null);try{let nt=[],bt=null;try{const Dt=await hc();console.log("[Formative] My TAs:",Dt==null?void 0:Dt.length,"for subject:",e,"teachingAssignmentId:",t),bt=(Dt||[]).find(ze=>{const at=String(ze.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?ze.id===t:!1)||at}),bt?console.log("[Formative] Found TA match:",bt.id,"elective_subject_id:",bt.elective_subject_id,"section_id:",bt.section_id):console.log("[Formative] No TA match found in user TAs")}catch(Dt){console.warn("[Formative] My TAs fetch failed:",Dt)}if(bt&&bt.elective_subject_id&&!bt.section_id){console.log("[Formative] Detected elective, fetching elective-choices for elective_subject_id:",bt.elective_subject_id);try{const Dt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(bt.elective_subject_id))}`);if(Dt.ok){const ze=await Dt.json(),at=Array.isArray(ze.results)?ze.results:Array.isArray(ze)?ze:ze.items||[];console.log("[Formative] Elective choices returned:",at==null?void 0:at.length,"students"),nt=(at||[]).map(_t=>({id:Number(_t.student_id??_t.id),reg_no:String(_t.reg_no??_t.regno??""),name:String(_t.name??_t.full_name??_t.username??""),section:_t.section_name??_t.section??null})).filter(_t=>Number.isFinite(_t.id)),Ze&&g({subject_name:bt.subject_name,section:bt.section_name||"Elective"})}else console.warn("[Formative] Elective-choices API returned error:",Dt.status)}catch(Dt){console.warn("[Formative] Elective-choices fetch failed:",Dt)}}if(!nt.length&&bt&&bt.id){console.log("[Formative] Fetching regular TA roster for TA ID:",bt.id);try{nt=((await pc(bt.id)).students||[]).map(ze=>({id:Number(ze.id),reg_no:String(ze.reg_no??""),name:String(ze.name??""),section:ze.section??null})).filter(ze=>Number.isFinite(ze.id)),console.log("[Formative] Regular roster returned:",nt.length,"students"),Ze&&g({subject_name:bt.subject_name,section:bt.section_name})}catch(Dt){console.warn("[Formative] TA roster fetch failed:",Dt)}}console.log("[Formative] Final roster count:",nt.length),nt.sort(wxe),Ze&&h(nt);let St=null;try{const Dt=await v0(i,e);Dt&&Dt.marks&&typeof Dt.marks=="object"&&Object.keys(Dt.marks||{}).length&&(St=Dt.marks,B(new Date().toLocaleString()))}catch{}const Ct=xt?Qn(xt):null,$t=St?{termLabel:K!=null&&K.termLabel?String(K.termLabel):se||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:Object.fromEntries(Object.entries(St).map(([Dt,ze])=>[Dt,{studentId:Number(Dt),skill1:ds(ze==null?void 0:ze.skill1),skill2:ds(ze==null?void 0:ze.skill2),att1:ds(ze==null?void 0:ze.att1),att2:ds(ze==null?void 0:ze.att2)}]))}:Ct&&typeof Ct=="object"?{termLabel:K!=null&&K.termLabel?String(K.termLabel):String(Ct.termLabel||"KRCT AY25-26"),batchLabel:String(e||Ct.batchLabel||""),rowsByStudentId:Ct.rowsByStudentId&&typeof Ct.rowsByStudentId=="object"?Ct.rowsByStudentId:{}}:{termLabel:se||"KRCT AY25-26",batchLabel:String(e||""),rowsByStudentId:{}},Vt={...$t.rowsByStudentId};for(const Dt of nt){const ze=String(Dt.id),at=Vt[ze];Vt[ze]={studentId:Dt.id,skill1:typeof(at==null?void 0:at.skill1)=="number"?Mn(Number(at==null?void 0:at.skill1),0,J):"",skill2:typeof(at==null?void 0:at.skill2)=="number"?Mn(Number(at==null?void 0:at.skill2),0,J):"",att1:typeof(at==null?void 0:at.att1)=="number"?Mn(Number(at==null?void 0:at.att1),0,J):"",att2:typeof(at==null?void 0:at.att2)=="number"?Mn(Number(at==null?void 0:at.att2),0,J):""}}T({...$t,termLabel:$t.termLabel||se,batchLabel:String(e||$t.batchLabel||""),rowsByStudentId:Vt})}catch(nt){if(!Ze)return;f((nt==null?void 0:nt.message)||`Failed to load ${s} roster`),h([])}finally{Ze&&u(!1)}}})(),()=>{Ze=!1}},[e,xt,K,se,J,s]);const wr=(Ze,Kt)=>{be||ve||T(nt=>{const bt=String(Ze),Ct={...nt.rowsByStudentId[bt]||{studentId:Ze,skill1:"",skill2:"",att1:"",att2:""},...Kt,studentId:Ze},$t=Vt=>{if(Vt===""||Vt==null)return"";const Dt=Number(Vt),ze=Number.isFinite(Dt)?Math.round(Dt):NaN,at=Mn(ze,0,J);return Number.isFinite(at)?at:""};return{...nt,rowsByStudentId:{...nt.rowsByStudentId,[bt]:{...Ct,skill1:$t(Ct.skill1),skill2:$t(Ct.skill2),att1:$t(Ct.att1),att2:$t(Ct.att2)}}}})},br=async()=>{if(e){w(!0),f(null);try{await Fi(i,e,{sheet:re,partBtl:y}),A(new Date().toLocaleString())}catch(Ze){f((Ze==null?void 0:Ze.message)||`Failed to save ${s} draft`)}finally{w(!1)}}},cr=x.useRef(re);cr.current=re;const Tr=x.useRef(y);Tr.current=y,x.useEffect(()=>{const Ze=()=>{if(!e||p.length===0)return;const Kt={sheet:cr.current,partBtl:Tr.current};Fi(i,e,Kt).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Ze),()=>window.removeEventListener("obe:before-tab-switch",Ze)},[e,i,p.length]);const Kr=async()=>{if(!e)return;if(C){f("Publishing is locked by IQAC.");return}if(!ae){f("Publish window is closed. Please request IQAC approval.");return}if(_e&&ve){if(jt){f("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}dn(!0);return}j(!0),f(null);const Ze=M,Kt=re.markManagerLocked,nt=je,bt={markEntryApprovalUntil:qe,markManagerApprovalUntil:Pt};try{B(new Date().toLocaleString()),Fe(bt),T(St=>({...St,markManagerLocked:!0})),await M9(i,e,re,t),ee(),ie({silent:!0}),Qe(!0);try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:i}}))}catch{}}catch(St){const Ct=String((St==null?void 0:St.message)||"");Ct.includes("locked after publish")||Ct.includes("Marks entry is locked")?(B(new Date().toLocaleString()),Fe(bt),T($t=>({...$t,markManagerLocked:!0})),f(null)):(B(Ze??null),T($t=>({...$t,markManagerLocked:Kt})),Fe(nt??null),f(Ct||`Failed to publish ${s}`))}finally{try{if(e){const St=await xS(i,String(e),t);St!=null&&St.exists&&(St!=null&&St.is_published)&&(B(new Date().toLocaleString()),T(Ct=>({...Ct,markManagerLocked:!0})),Fe(Ct=>Ct??bt),Qe(!0),ie({silent:!0}),ee(),f(null))}}catch{}j(!1)}},Yr=()=>{if(!e)return;const Ze=p.map((Kt,nt)=>{const bt=re.rowsByStudentId[String(Kt.id)]||{studentId:Kt.id,skill1:"",skill2:"",att1:"",att2:""},St=typeof bt.skill1=="number"?Mn(Number(bt.skill1),0,J):null,Ct=typeof bt.skill2=="number"?Mn(Number(bt.skill2),0,J):null,$t=typeof bt.att1=="number"?Mn(Number(bt.att1),0,J):null,Vt=typeof bt.att2=="number"?Mn(Number(bt.att2),0,J):null,Dt=St!=null&&Ct!=null&&$t!=null&&Vt!=null?Mn(St+Ct+$t+Vt,0,fe):"",ze=St!=null&&$t!=null?Mn(St+$t,0,ye):"",at=Ct!=null&&Vt!=null?Mn(Ct+Vt,0,ye):"",_t=[0,0,0,0,0,0];for(const Xt of Gt){const xe=y[Xt.key];(xe===1||xe===2||xe===3||xe===4||xe===5||xe===6)&&(_t[xe-1]+=Xt.max)}const Ft=qt.map(Xt=>Xt-1),pr=typeof Dt=="number"&&Ft.length?_c(Dt/Ft.length):"",or=_t.map((Xt,xe)=>pr===""||!Ft.includes(xe)?"":Xt>0?Mn(pr,0,Xt):_c(pr));return{sno:nt+1,registerNo:Kt.reg_no,name:Kt.name,skill1:St??"",skill2:Ct??"",att1:$t??"",att2:Vt??"",total:Dt===""?"":Dt,[`co${o}_mark`]:ze===""?"":ze,[`co${o}_pct`]:ze===""?"":Na(ze,ye),[`co${l}_mark`]:at===""?"":at,[`co${l}_pct`]:at===""?"":Na(at,ye),btl1_mark:or[0]??"",btl1_pct:or[0]===""?"":Na(Number(or[0]),_t[0]),btl2_mark:or[1]??"",btl2_pct:or[1]===""?"":Na(Number(or[1]),_t[1]),btl3_mark:or[2]??"",btl3_pct:or[2]===""?"":Na(Number(or[2]),_t[2]),btl4_mark:or[3]??"",btl4_pct:or[3]===""?"":Na(Number(or[3]),_t[3]),btl5_mark:or[4]??"",btl5_pct:or[4]===""?"":Na(Number(or[4]),_t[4]),btl6_mark:or[5]??"",btl6_pct:or[5]===""?"":Na(Number(or[5]),_t[5])}});_xe(`${e}_${i.toUpperCase()}_sheet.csv`,Ze)},xn=async()=>{if(!e)return;const Ze=p.map((Kt,nt)=>{const bt=re.rowsByStudentId[String(Kt.id)]||{studentId:Kt.id,skill1:"",skill2:"",att1:"",att2:""},St=typeof bt.skill1=="number"?Mn(Number(bt.skill1),0,J):null,Ct=typeof bt.skill2=="number"?Mn(Number(bt.skill2),0,J):null,$t=typeof bt.att1=="number"?Mn(Number(bt.att1),0,J):null,Vt=typeof bt.att2=="number"?Mn(Number(bt.att2),0,J):null,Dt=St!=null&&Ct!=null&&$t!=null&&Vt!=null?Mn(St+Ct+$t+Vt,0,fe):"";return{sno:nt+1,regNo:String(Kt.reg_no||""),name:String(Kt.name||""),total:Dt===""?"":Dt}});await dy({filenameBase:`${e}_${s}`,meta:{courseName:String((m==null?void 0:m.subject_name)||""),courseCode:String(e||""),className:String((m==null?void 0:m.section)||"")},rows:Ze})};function hr(Ze){return String(Ze??"").trim().toLowerCase().replace(/\s+/g," ")}const nr=()=>{if(!e||!p.length)return;const Ze=Ct=>`${Ct} (${Number(J).toFixed(2)})`,Kt=["Register No","Student Name",Ze("Skill 1"),Ze("Skill 2"),Ze("Attitude 1"),Ze("Attitude 2"),"Status"],nt=p.map(Ct=>{const $t=re.rowsByStudentId[String(Ct.id)];return[Ct.reg_no,Ct.name,($t==null?void 0:$t.skill1)??"",($t==null?void 0:$t.skill2)??"",($t==null?void 0:$t.att1)??"",($t==null?void 0:$t.att2)??"","present"]}),bt=$o.aoa_to_sheet([Kt,...nt]);bt["!freeze"]={xSplit:0,ySplit:1};const St=$o.book_new();$o.book_append_sheet(St,bt,s),MS(St,`${e}_${i.toUpperCase()}_template.xlsx`)},Mr=()=>{var Ze;be||ve||(Ze=D.current)==null||Ze.click()},an=async Ze=>{var Kt;if(e&&!(be||ve)){H(!0);try{const nt=await Ze.arrayBuffer(),bt=Um(nt,{type:"array"}),St=(Kt=bt.SheetNames)==null?void 0:Kt[0];if(!St)throw new Error("No sheet found in the Excel file.");const Ct=bt.Sheets[St],$t=$o.sheet_to_json(Ct,{header:1});if(!$t.length)throw new Error("Excel sheet is empty.");const Vt=($t[0]||[]).map(hr),Dt=Ee=>Vt.findIndex(De=>Ee(De)),ze=Dt(Ee=>Ee==="register no"||Ee==="reg no"||Ee.includes("register")),at=Dt(Ee=>Ee.startsWith("skill 1")||Ee.startsWith("skill1")),_t=Dt(Ee=>Ee.startsWith("skill 2")||Ee.startsWith("skill2")),Ft=Dt(Ee=>Ee.startsWith("attitude 1")||Ee.startsWith("att1")||Ee.startsWith("attitude1")),pr=Dt(Ee=>Ee.startsWith("attitude 2")||Ee.startsWith("att2")||Ee.startsWith("attitude2")),or=Dt(Ee=>Ee==="status"||Ee.includes("status"));if(ze<0)throw new Error("Could not find Register No column.");const Xt=new Map;for(const Ee of p){const De=String(Ee.reg_no||"").trim();De&&Xt.set(De,Ee.id);const gt=bp(De);gt&&Xt.set(gt,Ee.id)}const xe=Ee=>Ee==null||!Number.isFinite(Ee)||Ee<=0?"":Mn(Number(Ee),1,J);T(Ee=>{const De={...Ee.rowsByStudentId};for(let gt=1;gt<$t.length;gt++){const vr=$t[gt]||[],Je=String(vr[ze]??"").trim();if(!Je)continue;const Ut=Xt.get(Je);if(!Ut)continue;const Be=(or>=0?String(vr[or]??""):"").trim().toLowerCase(),Et=Be==="absent"||Be==="ab"||Be==="a",pt=De[String(Ut)]||{studentId:Ut,skill1:"",skill2:"",att1:"",att2:""};if(Et){De[String(Ut)]={...pt,skill1:"",skill2:"",att1:"",att2:""};continue}const yt=at>=0?xe(zb(vr[at])):pt.skill1,ft=_t>=0?xe(zb(vr[_t])):pt.skill2,he=Ft>=0?xe(zb(vr[Ft])):pt.att1,Ne=pr>=0?xe(zb(vr[pr])):pt.att2;De[String(Ut)]={...pt,studentId:Ut,skill1:yt,skill2:ft,att1:he,att2:Ne}}return{...Ee,rowsByStudentId:De}})}finally{H(!1)}}},it=async Ze=>{var nt;const Kt=(nt=Ze.target.files)==null?void 0:nt[0];if(Ze.target.value="",!!Kt)try{await an(Kt)}catch(bt){f((bt==null?void 0:bt.message)||"Failed to import Excel")}};if(!e)return a.jsxs("div",{style:{color:"#6b7280"},children:["Select a course to start ",s," entry."]});if(c)return a.jsxs("div",{style:{color:"#6b7280"},children:["Loading ",s," roster"]});const Ye={border:"1px solid #111",padding:"6px 6px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:12,whiteSpace:"nowrap"},ct={border:"1px solid #111",padding:"6px 6px",fontSize:12,whiteSpace:"nowrap"},Ht={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:12,textAlign:"center"};return a.jsxs(og,{children:[d&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10},children:d}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:Yr,className:"obe-btn obe-btn-secondary",disabled:p.length===0,children:"Export CSV"}),a.jsx("button",{onClick:nr,className:"obe-btn obe-btn-secondary",disabled:p.length===0,children:"Export Excel"}),a.jsx("button",{onClick:Mr,className:"obe-btn obe-btn-secondary",disabled:p.length===0||be||ve||G,children:G?"Importing":"Import Excel"}),a.jsx("input",{ref:D,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:it})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:xn,className:"obe-btn obe-btn-secondary",disabled:p.length===0,children:"Download"}),a.jsx("button",{onClick:br,className:"obe-btn obe-btn-success",disabled:v||p.length===0,children:v?"Saving":"Save Draft"}),a.jsx("button",{onClick:Kr,disabled:ce?jt:S||p.length===0||!ae||C,className:"obe-btn obe-btn-primary",children:ce?jt?"Request Pending":"Request Edit":S?"Publishing":"Publish"}),k&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Draft: ",k]}),M&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",M]})]})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:ae?"#065f46":"#b91c1c"},children:de?"Checking publish due time":W||(oe!=null&&oe.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(oe.due_at).toLocaleString(),"  Remaining: ",ag(V),oe.allowed_by_approval&&oe.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(oe.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),C?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>ee(),disabled:de,children:"Refresh"})})]}):null,a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff",marginBottom:10},children:a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Term",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:re.termLabel})]}),a.jsxs("label",{style:{fontSize:12,color:"#374151",display:"flex",alignItems:"center"},children:["Sheet Label",a.jsx("div",{style:{marginLeft:8,padding:6,border:"1px solid #d1d5db",borderRadius:8,minWidth:160},children:re.batchLabel})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Skill/Attitude max: ",J," each | Total: ",fe," | CO-",o,": ",ye," | CO-",l,": ",ye]})]})}),p.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No students found for this subject."}):a.jsx(sg,{locked:C,children:mt?E&&_e?a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),a.jsx("button",{className:"obe-btn",onClick:()=>P(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),Br?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,nn?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:nn}):null,Tt&&Object.keys(Tt).length||p.length?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Ye,colSpan:Wt,children:[re.termLabel," | ",re.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Ye,width:42,minWidth:42},children:"S.No"}),a.jsx("th",{style:Ye,children:"Register No."}),a.jsx("th",{style:Ye,children:"Name of the Students"}),a.jsx("th",{style:Ye,children:"Skill 1"}),a.jsx("th",{style:Ye,children:"Skill 2"}),a.jsx("th",{style:Ye,children:"Att 1"}),a.jsx("th",{style:Ye,children:"Att 2"}),a.jsx("th",{style:Ye,children:"Total"}),a.jsxs("th",{style:Ye,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Ye,colSpan:2,children:["CO-",l]}),qt.map(Ze=>a.jsxs("th",{style:Ye,colSpan:2,children:["BTL-",Ze]},`pv_btl_${Ze}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye,children:"Mark"}),a.jsx("th",{style:Ye,children:"%"}),a.jsx("th",{style:Ye,children:"Mark"}),a.jsx("th",{style:Ye,children:"%"}),qt.map(Ze=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:Ye,children:"Mark"}),a.jsx("th",{style:Ye,children:"%"})]},`pv_btl_sub_${Ze}`))]})]}),a.jsx("tbody",{children:p.length?p.map((Ze,Kt)=>{const nt=Tt&&Tt[String(Ze.id)]||{},bt=typeof nt.skill1=="number"?Mn(Number(nt.skill1),1,J):ds(nt.skill1),St=typeof nt.skill2=="number"?Mn(Number(nt.skill2),1,J):ds(nt.skill2),Ct=typeof nt.att1=="number"?Mn(Number(nt.att1),1,J):ds(nt.att1),$t=typeof nt.att2=="number"?Mn(Number(nt.att2),1,J):ds(nt.att2),Vt=bt!==""&&St!==""&&Ct!==""&&$t!==""?Mn(bt+St+Ct+$t,0,fe):"",Dt=bt!==""&&Ct!==""?Mn(bt+Ct,0,ye):"",ze=St!==""&&$t!==""?Mn(St+$t,0,ye):"",at=[0,0,0,0,0,0];for(const or of Gt){const Xt=wt[or.key];(Xt===1||Xt===2||Xt===3||Xt===4||Xt===5||Xt===6)&&(at[Xt-1]+=or.max)}const _t=qt.map(or=>or-1),Ft=typeof Vt=="number"&&_t.length?_c(Vt/_t.length):"",pr=at.map((or,Xt)=>Ft===""||!_t.includes(Xt)?"":or>0?Mn(Ft,0,or):_c(Ft));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ct,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Kt+1}),a.jsx("td",{style:ct,children:bp(Ze.reg_no)}),a.jsx("td",{style:ct,children:Ze.name||""}),a.jsx("td",{style:{...ct,textAlign:"center"},children:bt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:St}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Ct}),a.jsx("td",{style:{...ct,textAlign:"center"},children:$t}),a.jsx("td",{style:{...ct,textAlign:"center",fontWeight:700},children:Vt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Dt,ye)})}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,ye)})}),qt.map(or=>{const Xt=or-1,xe=pr[Xt],Ee=at[Xt]??0;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...ct,textAlign:"center"},children:xe}),a.jsx("td",{style:{...ct,textAlign:"center"},children:xe===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(xe),Ee)})})]},`pv_btl_cells_${Ze.id}_${or}`)})]},`pv_${Ze.id}`)}):Object.keys(Tt||{}).map((Ze,Kt)=>{const nt=Tt[Ze]||{},bt=typeof nt.skill1=="number"?Mn(Number(nt.skill1),1,J):ds(nt.skill1),St=typeof nt.skill2=="number"?Mn(Number(nt.skill2),1,J):ds(nt.skill2),Ct=typeof nt.att1=="number"?Mn(Number(nt.att1),1,J):ds(nt.att1),$t=typeof nt.att2=="number"?Mn(Number(nt.att2),1,J):ds(nt.att2),Vt=bt!==""&&St!==""&&Ct!==""&&$t!==""?Mn(bt+St+Ct+$t,0,fe):"",Dt=bt!==""&&Ct!==""?Mn(bt+Ct,0,ye):"",ze=St!==""&&$t!==""?Mn(St+$t,0,ye):"",at=[0,0,0,0,0,0];for(const or of Gt){const Xt=wt[or.key];(Xt===1||Xt===2||Xt===3||Xt===4||Xt===5||Xt===6)&&(at[Xt-1]+=or.max)}const _t=qt.map(or=>or-1),Ft=typeof Vt=="number"&&_t.length?_c(Vt/_t.length):"",pr=at.map((or,Xt)=>Ft===""||!_t.includes(Xt)?"":or>0?Mn(Ft,0,or):_c(Ft));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ct,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Kt+1}),a.jsx("td",{style:ct,children:bp(String(nt.reg_no??Ze))}),a.jsx("td",{style:ct,children:nt.name||""}),a.jsx("td",{style:{...ct,textAlign:"center"},children:bt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:St}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Ct}),a.jsx("td",{style:{...ct,textAlign:"center"},children:$t}),a.jsx("td",{style:{...ct,textAlign:"center",fontWeight:700},children:Vt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Dt,ye)})}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,ye)})}),qt.map(or=>{const Xt=or-1,xe=pr[Xt],Ee=at[Xt]??0;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...ct,textAlign:"center"},children:xe}),a.jsx("td",{style:{...ct,textAlign:"center"},children:xe===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(xe),Ee)})})]},`pv_btl_cells_${Ze}_${or}`)})]},`pv_${Ze}`)})})]})}):Br?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>P(!1),children:"Close"})})]}):a.jsxs("div",{className:"obe-table-wrapper",style:{position:"relative"},children:[a.jsxs("table",{className:"obe-table",style:{minWidth:1200,pointerEvents:Ae?"none":"auto"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Ye,colSpan:Wt,children:[re.termLabel," | ",re.batchLabel," | ",s.toUpperCase()]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Ye,width:42,minWidth:42},rowSpan:3,children:"S.No"}),a.jsx("th",{style:Ye,rowSpan:3,children:"Register No."}),a.jsx("th",{style:Ye,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:Ye,colSpan:2,children:"Skill"}),a.jsx("th",{style:Ye,colSpan:2,children:"Attitude"}),a.jsx("th",{style:Ye,rowSpan:3,children:"Total"}),a.jsx("th",{style:Ye,colSpan:4,children:"CIA 1"}),qt.length?a.jsx("th",{style:Ye,colSpan:qt.length*2,children:"BTL"}):null]}),a.jsxs("tr",{children:[a.jsx("th",{style:Ye,children:"1"}),a.jsx("th",{style:Ye,children:"2"}),a.jsx("th",{style:Ye,children:"1"}),a.jsx("th",{style:Ye,children:"2"}),a.jsxs("th",{style:Ye,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Ye,colSpan:2,children:["CO-",l]}),qt.map(Ze=>a.jsxs("th",{style:Ye,colSpan:2,children:["BTL-",Ze]},`btlhead-${Ze}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye,children:"Mark"}),a.jsx("th",{style:Ye,children:"%"}),a.jsx("th",{style:Ye,children:"Mark"}),a.jsx("th",{style:Ye,children:"%"}),qt.map(Ze=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:Ye,children:"Mark"}),a.jsx("th",{style:Ye,children:"%"})]},`btl-sub-${Ze}`))]})]}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:"BTL"}),Gt.map(Ze=>a.jsx("td",{style:{...ct,textAlign:"center"},children:(()=>{const Kt=y[Ze.key]??"",nt=Kt===""?"-":String(Kt);return a.jsxs("div",{style:{position:"relative",minWidth:44},children:[a.jsx("div",{style:{width:"100%",fontSize:12,padding:"2px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none"},title:`BTL: ${nt}`,children:nt}),a.jsxs("select",{"aria-label":`BTL for ${Ze.label}`,value:Kt,onChange:bt=>{if(C)return;const St=re.markManagerSnapshot!=null;He&&St||ve||b(Ct=>({...Ct||{},[Ze.key]:bt.target.value===""?"":Number(bt.target.value)}))},style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none",WebkitAppearance:"none",MozAppearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(bt=>a.jsx("option",{value:bt,children:bt},bt))]})]})})()},`btl-select-${Ze.key}`)),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},colSpan:4}),qt.map(Ze=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"}}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"}})]},`btl-pad-${Ze}`))]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},colSpan:3,children:"Name / Max Marks"}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:J}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:J}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:J}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:J}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:fe}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:ye}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:"%"}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:ye}),a.jsx("td",{style:{...ct,fontWeight:700,textAlign:"center"},children:"%"})]}),p.map((Ze,Kt)=>{const nt=re.rowsByStudentId[String(Ze.id)]||{studentId:Ze.id,skill1:"",skill2:"",att1:"",att2:""},bt=typeof nt.skill1=="number"?Mn(Number(nt.skill1),0,J):"",St=typeof nt.skill2=="number"?Mn(Number(nt.skill2),0,J):"",Ct=typeof nt.att1=="number"?Mn(Number(nt.att1),0,J):"",$t=typeof nt.att2=="number"?Mn(Number(nt.att2),0,J):"",Vt=bt!==""&&St!==""&&Ct!==""&&$t!==""?Mn(bt+St+Ct+$t,0,fe):"",Dt=bt!==""&&Ct!==""?Mn(bt+Ct,0,ye):"",ze=St!==""&&$t!==""?Mn(St+$t,0,ye):"",at=[0,0,0,0,0,0];for(const xe of Gt){const Ee=y[xe.key];(Ee===1||Ee===2||Ee===3||Ee===4||Ee===5||Ee===6)&&(at[Ee-1]+=xe.max)}const _t=qt.map(xe=>xe-1),Ft=typeof Vt=="number"&&_t.length?_c(Vt/_t.length):"",pr=at.map((xe,Ee)=>Ft===""||!_t.includes(Ee)?"":xe>0?Mn(Ft,0,xe):_c(Ft)),Xt=qt.length===0||be||ve||C;return a.jsxs("tr",{children:[a.jsx("td",{style:{...ct,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Kt+1}),a.jsx("td",{style:ct,children:bp(Ze.reg_no)}),a.jsx("td",{style:ct,children:Ze.name||""}),a.jsx("td",{style:ct,children:a.jsx("input",{style:Ht,type:"number",min:0,max:J,value:nt.skill1===""?"":nt.skill1,disabled:Xt,onChange:xe=>{const Ee=xe.target.value;if(Ee==="")return xe.currentTarget.setCustomValidity(""),wr(Ze.id,{skill1:""});const De=Number(Ee);if(Number.isFinite(De)){if(De>J){xe.currentTarget.setCustomValidity(`Max mark is ${J}`),xe.currentTarget.reportValidity(),window.setTimeout(()=>xe.currentTarget.setCustomValidity(""),0);return}xe.currentTarget.setCustomValidity(""),wr(Ze.id,{skill1:De})}}})}),a.jsx("td",{style:ct,children:a.jsx("input",{style:Ht,type:"number",min:0,max:J,value:nt.skill2===""?"":nt.skill2,disabled:Xt,onChange:xe=>{const Ee=xe.target.value;if(Ee==="")return xe.currentTarget.setCustomValidity(""),wr(Ze.id,{skill2:""});const De=Number(Ee);if(Number.isFinite(De)){if(De>J){xe.currentTarget.setCustomValidity(`Max mark is ${J}`),xe.currentTarget.reportValidity(),window.setTimeout(()=>xe.currentTarget.setCustomValidity(""),0);return}xe.currentTarget.setCustomValidity(""),wr(Ze.id,{skill2:De})}}})}),a.jsx("td",{style:ct,children:a.jsx("input",{style:Ht,type:"number",min:0,max:J,value:nt.att1===""?"":nt.att1,disabled:Xt,onChange:xe=>{const Ee=xe.target.value;if(Ee==="")return xe.currentTarget.setCustomValidity(""),wr(Ze.id,{att1:""});const De=Number(Ee);if(Number.isFinite(De)){if(De>J){xe.currentTarget.setCustomValidity(`Max mark is ${J}`),xe.currentTarget.reportValidity(),window.setTimeout(()=>xe.currentTarget.setCustomValidity(""),0);return}xe.currentTarget.setCustomValidity(""),wr(Ze.id,{att1:De})}}})}),a.jsx("td",{style:ct,children:a.jsx("input",{style:Ht,type:"number",min:0,max:J,value:nt.att2===""?"":nt.att2,disabled:Xt,onChange:xe=>{const Ee=xe.target.value;if(Ee==="")return xe.currentTarget.setCustomValidity(""),wr(Ze.id,{att2:""});const De=Number(Ee);if(Number.isFinite(De)){if(De>J){xe.currentTarget.setCustomValidity(`Max mark is ${J}`),xe.currentTarget.reportValidity(),window.setTimeout(()=>xe.currentTarget.setCustomValidity(""),0);return}xe.currentTarget.setCustomValidity(""),wr(Ze.id,{att2:De})}}})}),a.jsx("td",{style:{...ct,textAlign:"center",fontWeight:700},children:Vt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Dt,ye)})}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,ye)})}),qt.map(xe=>{const Ee=xe-1,De=pr[Ee],gt=at[Ee]??0;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...ct,textAlign:"center"},children:De}),a.jsx("td",{style:{...ct,textAlign:"center"},children:De===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(De),gt)})})]},`btl-cells-${xe}`)})]},Ze.id)})]})]}),qt.length===0&&a.jsxs("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(255,255,255,0.85)",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:10,padding:20,borderRadius:6},children:[a.jsx("div",{style:{fontSize:16,fontWeight:700},children:"BTL values not selected"}),a.jsx("div",{style:{color:"#6b7280"},children:"Assign BTL values in the BTL row below Skill/Attitude to enable entry."}),a.jsx("div",{style:{display:"flex",gap:8},children:a.jsx("button",{onClick:()=>{if(C)return;const Ze=re.markManagerSnapshot!=null;He&&Ze||ve||b({skill1:3,skill2:4,att1:3,att2:4})},style:{padding:"6px 10px"},children:"Quick: BTL-3/4"})})]}),be&&!C&&!Ae?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(239,246,255,0.65)",border:"1px solid rgba(59,130,246,0.25)",borderRadius:6,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:16,transform:"translateX(-50%)",zIndex:40,width:280,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:"Confirm the Mark Manager to unlock the student list."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ue({mode:"confirm"}),disabled:!e||It,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Zt(),disabled:It,children:"Request Access"})]})]})]}):null,Ae&&!C?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{position:"absolute",inset:0,background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.26) 100%)",border:"1px solid rgba(22,163,74,0.25)",borderRadius:6,pointerEvents:"none"}}),a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:320,background:"#fff",border:"1px solid #e5e7eb",padding:12,borderRadius:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",display:"flex",flexDirection:"column",gap:10,alignItems:"stretch"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:12,color:"#065f46",marginTop:4},children:"Marks are published. Use View or Request Edit to ask IQAC for access."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",onClick:()=>{P(!0),Vr(null);try{Qe(!1)}catch{}},children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:jt,onClick:async()=>{if(jt){alert("Edit request is pending. Please wait.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}dn(!0)},children:jt?"Request Pending":"Request Edit"})]})]})]}):null]}):a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:16},children:Lt?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:8},children:Lt?"Marks published. Use View or Request Edit to ask IQAC for access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12,justifyContent:"flex-end"},children:Lt?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>{P(!0),Vr(null);try{Qe(!1)}catch{}},children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:jt,onClick:async()=>{if(jt){alert("Edit request is pending. Please wait.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}dn(!0)},children:jt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ue({mode:"confirm"}),disabled:!e||It,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Zt(),disabled:It,children:"Request Access"})]})})]})}),et&&!n?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{It||Ue(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ze=>Ze.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:et.mode==="confirm"?`Confirmation - ${s}`:`Request Edit - ${s}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(e||"")})]}),et.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected BTL settings. After confirming, Mark Manager will be locked and the table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Skill/Attitude max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:J})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Total max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:fe})]}),a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",o," max"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:ye})]}),a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",l," max"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:ye})]}),Gt.map(Ze=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:[Ze.label," BTL"]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsxs("select",{className:"obe-input","aria-label":`BTL for ${Ze.label}`,value:y[Ze.key]??"",disabled:It||C||ve,onChange:Kt=>{if(C||ve)return;const nt=Kt.target.value;b(bt=>({...bt||{},[Ze.key]:nt===""?"":Number(nt)}))},style:{minWidth:110},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Kt=>a.jsx("option",{value:Kt,children:Kt},Kt))]})})]},`mm_${Ze.key}`))]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:It,onClick:()=>Ue(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:It||!e,onClick:async()=>{if(e){if(et.mode==="request"){Ue(null),await Zt();return}await Rt()}},children:et.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,yr?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>Ar(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"90vh",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ze=>Ze.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[s,"  ",String(e||"")]}),a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ar(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),Br?a.jsx("div",{style:{color:"#6b7280"},children:"Loading published marks"}):null,nn?a.jsx("div",{style:{color:"#991b1b",fontSize:12,marginBottom:8},children:nn}):null,Tt&&Object.keys(Tt).length||p.length?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:Ye,colSpan:Wt,children:[re.termLabel," | ",re.batchLabel," | ",s.toUpperCase()," (PUBLISHED)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...Ye,width:42,minWidth:42},children:"S.No"}),a.jsx("th",{style:Ye,children:"Register No."}),a.jsx("th",{style:Ye,children:"Name of the Students"}),a.jsx("th",{style:Ye,children:"Skill 1"}),a.jsx("th",{style:Ye,children:"Skill 2"}),a.jsx("th",{style:Ye,children:"Att 1"}),a.jsx("th",{style:Ye,children:"Att 2"}),a.jsx("th",{style:Ye,children:"Total"}),a.jsxs("th",{style:Ye,colSpan:2,children:["CO-",o]}),a.jsxs("th",{style:Ye,colSpan:2,children:["CO-",l]}),qt.map(Ze=>a.jsxs("th",{style:Ye,colSpan:2,children:["BTL-",Ze]},`pv_btl_${Ze}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye}),a.jsx("th",{style:Ye,children:"Mark"}),a.jsx("th",{style:Ye,children:"%"}),a.jsx("th",{style:Ye,children:"Mark"}),a.jsx("th",{style:Ye,children:"%"}),qt.map(Ze=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:Ye,children:"Mark"}),a.jsx("th",{style:Ye,children:"%"})]},`pv_btl_sub_${Ze}`))]})]}),a.jsx("tbody",{children:p.length?p.map((Ze,Kt)=>{const nt=Tt&&Tt[String(Ze.id)]||{},bt=typeof nt.skill1=="number"?Mn(Number(nt.skill1),1,J):ds(nt.skill1),St=typeof nt.skill2=="number"?Mn(Number(nt.skill2),1,J):ds(nt.skill2),Ct=typeof nt.att1=="number"?Mn(Number(nt.att1),1,J):ds(nt.att1),$t=typeof nt.att2=="number"?Mn(Number(nt.att2),1,J):ds(nt.att2),Vt=bt!==""&&St!==""&&Ct!==""&&$t!==""?Mn(bt+St+Ct+$t,0,fe):"",Dt=bt!==""&&Ct!==""?Mn(bt+Ct,0,ye):"",ze=St!==""&&$t!==""?Mn(St+$t,0,ye):"",at=[0,0,0,0,0,0];for(const or of Gt){const Xt=wt[or.key];(Xt===1||Xt===2||Xt===3||Xt===4||Xt===5||Xt===6)&&(at[Xt-1]+=or.max)}const _t=qt.map(or=>or-1),Ft=typeof Vt=="number"&&_t.length?_c(Vt/_t.length):"",pr=at.map((or,Xt)=>Ft===""||!_t.includes(Xt)?"":or>0?Mn(Ft,0,or):_c(Ft));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ct,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Kt+1}),a.jsx("td",{style:ct,children:bp(Ze.reg_no)}),a.jsx("td",{style:ct,children:Ze.name||""}),a.jsx("td",{style:{...ct,textAlign:"center"},children:bt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:St}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Ct}),a.jsx("td",{style:{...ct,textAlign:"center"},children:$t}),a.jsx("td",{style:{...ct,textAlign:"center",fontWeight:700},children:Vt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Dt,ye)})}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,ye)})}),qt.map(or=>{const Xt=or-1,xe=pr[Xt],Ee=at[Xt]??0;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...ct,textAlign:"center"},children:xe}),a.jsx("td",{style:{...ct,textAlign:"center"},children:xe===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(xe),Ee)})})]},`pv_btl_cells_${Ze.id}_${or}`)})]},`pv_${Ze.id}`)}):Object.keys(Tt||{}).map((Ze,Kt)=>{const nt=Tt[Ze]||{},bt=typeof nt.skill1=="number"?Mn(Number(nt.skill1),1,J):ds(nt.skill1),St=typeof nt.skill2=="number"?Mn(Number(nt.skill2),1,J):ds(nt.skill2),Ct=typeof nt.att1=="number"?Mn(Number(nt.att1),1,J):ds(nt.att1),$t=typeof nt.att2=="number"?Mn(Number(nt.att2),1,J):ds(nt.att2),Vt=bt!==""&&St!==""&&Ct!==""&&$t!==""?Mn(bt+St+Ct+$t,0,fe):"",Dt=bt!==""&&Ct!==""?Mn(bt+Ct,0,ye):"",ze=St!==""&&$t!==""?Mn(St+$t,0,ye):"",at=[0,0,0,0,0,0];for(const or of Gt){const Xt=wt[or.key];(Xt===1||Xt===2||Xt===3||Xt===4||Xt===5||Xt===6)&&(at[Xt-1]+=or.max)}const _t=qt.map(or=>or-1),Ft=typeof Vt=="number"&&_t.length?_c(Vt/_t.length):"",pr=at.map((or,Xt)=>Ft===""||!_t.includes(Xt)?"":or>0?Mn(Ft,0,or):_c(Ft));return a.jsxs("tr",{children:[a.jsx("td",{style:{...ct,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Kt+1}),a.jsx("td",{style:ct,children:bp(String(nt.reg_no??Ze))}),a.jsx("td",{style:ct,children:nt.name||""}),a.jsx("td",{style:{...ct,textAlign:"center"},children:bt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:St}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Ct}),a.jsx("td",{style:{...ct,textAlign:"center"},children:$t}),a.jsx("td",{style:{...ct,textAlign:"center",fontWeight:700},children:Vt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt}),a.jsx("td",{style:{...ct,textAlign:"center"},children:Dt===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Dt,ye)})}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze}),a.jsx("td",{style:{...ct,textAlign:"center"},children:ze===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(ze,ye)})}),qt.map(or=>{const Xt=or-1,xe=pr[Xt],Ee=at[Xt]??0;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...ct,textAlign:"center"},children:xe}),a.jsx("td",{style:{...ct,textAlign:"center"},children:xe===""?"":a.jsx("span",{className:"obe-pct-badge",children:Na(Number(xe),Ee)})})]},`pv_btl_cells_${Ze}_${or}`)})]},`pv_${Ze}`)})})]})}):Br?null:a.jsx("div",{style:{color:"#6b7280"},children:"No published marks found."}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>Ar(!1),children:"Close"})})]})})}):null,Ir?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{st||dn(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Ze=>Ze.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[s,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",ar?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:Te,onChange:Ze=>tt(Ze.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:st,onClick:()=>dn(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:st||jt||!e||!String(Te||"").trim(),onClick:Re,title:jt?"Request pending (up to 24 hours)":void 0,children:st?"Requesting":jt?"Request Pending":"Send Request"})]})]})})}):null,xt&&a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",a.jsx("span",{style:{fontFamily:"monospace"},children:xt})]})]})}function jxe(e){return a.jsx(Vz,{...e,assessmentKey:"formative2"})}const Us=5,su=25,Tf=30;function kxe(e,t){const r=String(e??"").trim(),n=String(t??"").trim(),i=r.replace(/[^0-9]/g,""),s=n.replace(/[^0-9]/g,"");if(i&&s)try{const o=BigInt(i),l=BigInt(s);if(o<l)return-1;if(o>l)return 1}catch{if(i.length!==s.length)return i.length-s.length;if(i<s)return-1;if(i>s)return 1}else{if(i&&!s)return-1;if(!i&&s)return 1}return r<n?-1:r>n?1:0}function Axe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const i=r.localeCompare(n);if(i)return i}else if(r||n)return r?-1:1;return kxe(e==null?void 0:e.reg_no,t==null?void 0:t.reg_no)}function zs(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function Nxe(e,t){return`${e}_sheet_${t}`}function Cd(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function Uf(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i],o=typeof s=="number"?s:Number(s);o===1||o===2||o===3||o===4||o===5||o===6?n.push(o):n.push(1)}return n}function Wb(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function NM(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function qb(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Pf(e,t,r,n){const i=e.coConfigs&&typeof e.coConfigs=="object"?e.coConfigs:{},s={};for(const o of t){const l=String(o),c=i[l];if(c&&typeof c=="object"&&"enabled"in c){const u=zs(Number(c.expCount??Us),0,12);s[l]={enabled:!!c.enabled,expCount:u,expMax:zs(Number(c.expMax??su),0,100),btl:Uf(c.btl,u)}}else if(o===r){const u=zs(Number(e.expCountA??Us),0,12);s[l]={enabled:!!(e.coAEnabled??!0),expCount:u,expMax:zs(Number(e.expMaxA??su),0,100),btl:Uf(e.btlsA,u)}}else if(o===n){const u=zs(Number(e.expCountB??Us),0,12);s[l]={enabled:!!(e.coBEnabled??!0),expCount:u,expMax:zs(Number(e.expMaxB??su),0,100),btl:Uf(e.btlsB,u)}}else s[l]={enabled:!1,expCount:Us,expMax:su,btl:Array.from({length:Us},()=>1)}}return s}function Mj(e,t,r,n,i){const s=e==null?void 0:e.marksByCo;if(s&&typeof s=="object"){const o=s[String(t)];if(Array.isArray(o))return Cd(o,r)}return t===n?Cd(e==null?void 0:e.marksA,r):t===i?Cd(e==null?void 0:e.marksB,r):Array.from({length:r},()=>"")}function Q2({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:i,coB:s,allCos:o,showCia1Embed:l,cia1Embed:c}){const u=r==="review1"||r==="review2",d=x.useMemo(()=>o&&o.length>0?o:[i,s],[o,i,s]),f=x.useMemo(()=>u?[i,s]:d,[u,d,i,s]),[p,h]=x.useState(!1),[m,g]=x.useState(null),[y,b]=x.useState([]),[v,w]=x.useState(null),[S,j]=x.useState(!1),[k,A]=x.useState(null),[R,M]=x.useState(null),B=Jr.useRef(!1),[E,P]=x.useState(!1),[D,G]=x.useState(null),[H,oe]=x.useState(!1),[de,W]=x.useState(""),[V,ae]=x.useState(!1),[ee,C]=x.useState(null),[Y,q]=x.useState(!1),[O,X]=x.useState(null),[F,Q]=x.useState(!1),[K,ne]=x.useState(null),[re,T]=x.useState(null),[I,ie]=x.useState(!1),[U,Z]=x.useState(""),[me,Pe]=x.useState(!1),[je,Fe]=x.useState(null),[_e,He]=x.useState(null),[qe,Pt]=x.useState(!1),[ut,Ke]=x.useState({sheet:{termLabel:"KRCT AY25-26",batchLabel:e||"",coAEnabled:!0,coBEnabled:!0,ciaExamEnabled:!0,expCountA:Us,expCountB:Us,btlsA:Array.from({length:Us},()=>1),btlsB:Array.from({length:Us},()=>1),rowsByStudentId:{},expMaxA:su,expMaxB:su,markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}}),lt=x.useMemo(()=>e?Nxe(r,e):"",[r,e]),{data:ve,publishAllowed:Ae,remainingSeconds:ce,loading:be,error:mt,refresh:et}=H0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t}),{data:Ue,refresh:It}=V0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:ht}=lc({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),Lt=!!D||!!(Ue!=null&&Ue.exists&&(Ue!=null&&Ue.is_published)),yr=Ue!=null&&Ue.exists?!!(Ue!=null&&Ue.entry_open):!0,Ar=!!(Lt&&!yr);x.useEffect(()=>{if(Ue!=null&&Ue.is_published&&(Ue!=null&&Ue.updated_at)&&!D)try{G(new Date(String(Ue.updated_at)).toLocaleString())}catch{G(String(Ue.updated_at))}},[Ue==null?void 0:Ue.is_published,Ue==null?void 0:Ue.updated_at]);const{pending:Tt,pendingUntilMs:Vr,setPendingUntilMs:Br,refresh:Wr}=G0({enabled:!!(Lt&&Ar)&&!!e,assessment:r,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!H||!!re||!!Y);const nn=!!(ve!=null&&ve.global_override_active&&(ve==null?void 0:ve.global_is_open)===!1);x.useEffect(()=>{let it=!0;return(async()=>{try{const Ye=await oc();if(!it)return;w(Ye||null),Ke(ct=>({...ct,sheet:{...ct.sheet,termLabel:String((Ye==null?void 0:Ye.termLabel)||ct.sheet.termLabel||"KRCT AY25-26"),batchLabel:e||ct.sheet.batchLabel}}))}catch{}})(),()=>{it=!1}},[e]),x.useEffect(()=>{let it=!0;return B.current=!1,(async()=>{if(e){try{const Ye=await ei(r,e);if(!it)return;const ct=Ye==null?void 0:Ye.draft;if(ct&&typeof ct=="object"&&ct.sheet&&typeof ct.sheet=="object"){const Ht=!!(ct.sheet.coAEnabled??!0),fr=!!(ct.sheet.coBEnabled??!0),Sr=!!(ct.sheet.ciaExamEnabled??!0),gr=zs(Number(ct.sheet.expCountA??Us),0,12),Ze=zs(Number(ct.sheet.expCountB??Us),0,12),Kt=Uf(ct.sheet.btlsA,gr),nt=Uf(ct.sheet.btlsB,Ze),bt={},St=ct.sheet.rowsByStudentId&&typeof ct.sheet.rowsByStudentId=="object"?ct.sheet.rowsByStudentId:{};for(const[Ft,pr]of Object.entries(St)){const or=pr&&typeof pr=="object"?pr:{},Xt=Cd(or.marksA,gr),xe=Cd(or.marksB,Ze),Ee=or.ciaExam,De=Ee===""||Ee==null?"":Number(Ee),gt=De===""?"":Number.isFinite(De)?De:"";bt[String(Ft)]={...or,studentId:Number.isFinite(Number(or.studentId))?Number(or.studentId):Number(Ft),marksA:Xt,marksB:xe,ciaExam:gt,caaExamByCo:NM(or.caaExamByCo)}}const Ct=ct.sheet.markManagerSnapshot??null,$t=ct.sheet.markManagerApprovalUntil??null,Vt=ct.sheet.markManagerLocked,Dt=typeof Vt=="boolean"?Vt:!!Ct;Ke({sheet:{termLabel:String(ct.sheet.termLabel||(v==null?void 0:v.termLabel)||"KRCT AY25-26"),batchLabel:String(e),coAEnabled:Ht,coBEnabled:fr,ciaExamEnabled:Sr,expCountA:gr,expCountB:Ze,btlsA:Kt,btlsB:nt,rowsByStudentId:bt,markManagerLocked:Dt,markManagerSnapshot:Ct,markManagerApprovalUntil:$t}});try{lt&&Gn(lt,{rowsByStudentId:ct.sheet.rowsByStudentId||{}})}catch{}const ze=(Ye==null?void 0:Ye.updated_at)??null,at=(Ye==null?void 0:Ye.updated_by)??null;if(ze)try{A(new Date(String(ze)).toLocaleString())}catch{A(String(ze))}if(at&&M(String(at.name||at.username||at.id||"")),!Object.values(bt).some(Ft=>{var Xt,xe;const pr=(Xt=Ft.marksA)==null?void 0:Xt.some(Ee=>Ee!==""&&Ee!=null),or=(xe=Ft.marksB)==null?void 0:xe.some(Ee=>Ee!==""&&Ee!=null);return pr||or||Ft.ciaExam!==""&&Ft.ciaExam!=null})&&Object.keys(bt).length>0)try{const Ft=await Ks(r,String(e),t),pr=(Ft==null?void 0:Ft.data)??null;if(it&&pr&&typeof pr=="object"&&pr.sheet){const or=pr.sheet,Xt=or.rowsByStudentId&&typeof or.rowsByStudentId=="object"?or.rowsByStudentId:{};Object.values(Xt).some(Ee=>{var De,gt;return((De=Ee==null?void 0:Ee.marksA)==null?void 0:De.some(vr=>vr!==""&&vr!=null))||((gt=Ee==null?void 0:Ee.marksB)==null?void 0:gt.some(vr=>vr!==""&&vr!=null))||(Ee==null?void 0:Ee.ciaExam)!==""&&(Ee==null?void 0:Ee.ciaExam)!=null})&&Ke(pr)}}catch{}}else{const Ht=lt?Qn(lt):null,fr=Ht!=null&&Ht.rowsByStudentId&&typeof Ht.rowsByStudentId=="object"?Ht.rowsByStudentId:{};Ke(Sr=>({...Sr,sheet:{...Sr.sheet,batchLabel:String(e),rowsByStudentId:fr}}))}}catch{}it&&(B.current=!0)}})(),()=>{it=!1}},[r,e,lt,v]),x.useEffect(()=>{let it=!0;return(async()=>{if(!t){b([]);return}h(!0),g(null);try{const Ye=await pc(t);if(!it)return;const Ht=[...(Ye==null?void 0:Ye.students)||[]].sort((fr,Sr)=>Axe(fr,Sr));b(Ht)}catch(Ye){if(!it)return;b([]),g((Ye==null?void 0:Ye.message)||"Failed to load roster")}finally{it&&h(!1)}})(),()=>{it=!1}},[t]),x.useEffect(()=>{e&&y.length!==0&&Ke(it=>{const Ye=zs(Number(it.sheet.expCountA??Us),0,12),ct=zs(Number(it.sheet.expCountB??Us),0,12),Ht=Uf(it.sheet.btlsA,Ye),fr=Uf(it.sheet.btlsB,ct),Sr={...it.sheet.rowsByStudentId||{}};for(const gr of y){const Ze=String(gr.id),Kt=Sr[Ze];if(!Kt)Sr[Ze]={studentId:gr.id,marksA:Array.from({length:Ye},()=>""),marksB:Array.from({length:ct},()=>""),caaExamByCo:{},ciaExam:""};else{const nt=Cd(Kt.marksA,Ye),bt=Cd(Kt.marksB,ct),St=Kt.ciaExam,Ct=St===""||St==null?"":Number(St),$t=Ct===""?"":Number.isFinite(Ct)?Ct:"",Vt=NM(Kt.caaExamByCo);Sr[Ze]={...Kt,marksA:nt,marksB:bt,ciaExam:$t,caaExamByCo:Vt}}}return{...it,sheet:{...it.sheet,batchLabel:String(e),expCountA:Ye,expCountB:ct,btlsA:Ht,btlsB:fr,rowsByStudentId:Sr}}})},[y,e]),x.useEffect(()=>{if(lt)try{Gn(lt,{rowsByStudentId:ut.sheet.rowsByStudentId})}catch{}},[ut.sheet.rowsByStudentId,lt]),x.useEffect(()=>{if(!e)return;if(Ue!=null&&Ue.exists){const ct=!!(Ue!=null&&Ue.mark_manager_locked);!!ut.sheet.markManagerLocked!==ct&&Ke(Ht=>({...Ht,sheet:{...Ht.sheet,markManagerLocked:ct}}));return}const it=!!(ht!=null&&ht.allowed_by_approval),Ye=ht!=null&&ht.approval_until?String(ht.approval_until):null;if(it&&Ye){(ut.sheet.markManagerApprovalUntil?String(ut.sheet.markManagerApprovalUntil):null)!==Ye&&Ke(Ht=>({...Ht,sheet:{...Ht.sheet,markManagerLocked:!1,markManagerApprovalUntil:Ye}}));return}},[e,Ue==null?void 0:Ue.exists,Ue==null?void 0:Ue.mark_manager_locked,ht==null?void 0:ht.allowed_by_approval,ht==null?void 0:ht.approval_until,ut.sheet.markManagerLocked,ut.sheet.markManagerApprovalUntil]),x.useEffect(()=>{if(!e||!B.current)return;let it=!1;const Ye=setTimeout(async()=>{try{await Fi(r,e,ut),it||A(new Date().toLocaleString())}catch{}},900);return()=>{it=!0,clearTimeout(Ye)}},[r,e,ut]);const fn=x.useMemo(()=>Pf(ut.sheet,d,i,s),[ut.sheet,d,i,s]),Ir=x.useMemo(()=>f.filter(it=>{var Ye;return(Ye=fn[String(it)])==null?void 0:Ye.enabled}).map(it=>{const Ye=fn[String(it)];return{coNumber:it,expCount:Ye.expCount,expMax:Ye.expMax,btl:Ye.btl}}),[fn,f]),dn=x.useMemo(()=>Ir.reduce((it,Ye)=>it+Ye.expCount,0),[Ir]),Te=Ir.length>0,tt=ut.sheet.ciaExamEnabled!==!1,st=x.useMemo(()=>{if(dn===0)return[];const it=new Set;for(const Ye of Ir)for(const ct of Ye.btl.slice(0,Ye.expCount))it.add(ct);return[1,2,3,4,5,6].filter(Ye=>it.has(Ye))},[Ir,dn]),kt=Te?Ir.length*2:2,jt=x.useMemo(()=>Ir.reduce((it,Ye)=>Math.max(it,Ye.expMax),su),[Ir]),ar=fn[String(i)],tr=fn[String(s)];ar!=null&&ar.enabled,tr!=null&&tr.enabled,zs(Number((ar==null?void 0:ar.expCount)??Us),0,12),zs(Number((tr==null?void 0:tr.expCount)??Us),0,12),zs(Number((ar==null?void 0:ar.expMax)??su),0,100),zs(Number((tr==null?void 0:tr.expMax)??su),0,100);const Er=!!ut.sheet.markManagerLocked,se=Er,ue=!!(nn||Ue!=null&&Ue.exists&&!(Ue!=null&&Ue.entry_open));function J(it,Ye){Ke(ct=>{if(ct.sheet.markManagerLocked)return ct;const Ht=Pf(ct.sheet,d,i,s);return Ht[String(it)]={...Ht[String(it)],enabled:Ye},{...ct,sheet:{...ct.sheet,coConfigs:Ht}}})}function fe(it,Ye){const ct=zs(Number(Ye),0,100);Ke(Ht=>{if(Ht.sheet.markManagerLocked)return Ht;const fr=Pf(Ht.sheet,d,i,s);return fr[String(it)]={...fr[String(it)],expMax:ct},{...Ht,sheet:{...Ht.sheet,coConfigs:fr}}})}function ye(it,Ye){const ct=zs(Ye,0,12);Ke(Ht=>{if(Ht.sheet.markManagerLocked)return Ht;const fr=Pf(Ht.sheet,d,i,s),Sr=fr[String(it)];fr[String(it)]={...Sr,expCount:ct,btl:Uf(Sr.btl,ct)};const gr={...Ht.sheet.rowsByStudentId||{}};for(const Ze of Object.keys(gr)){const Kt=gr[Ze],nt=Kt.marksByCo&&typeof Kt.marksByCo=="object"?{...Kt.marksByCo}:{};nt[String(it)]=Cd(nt[String(it)],ct),gr[Ze]={...Kt,marksByCo:nt}}return{...Ht,sheet:{...Ht.sheet,coConfigs:fr,rowsByStudentId:gr}}})}function Ce(it,Ye,ct){Ke(Ht=>{if(Ar||nn)return Ht;const fr=Pf(Ht.sheet,d,i,s),Sr=fr[String(it)],gr=[...Sr.btl];return gr[Ye]=ct,fr[String(it)]={...Sr,btl:gr},{...Ht,sheet:{...Ht.sheet,coConfigs:fr}}})}function wt(it){Ke(Ye=>Ye.sheet.markManagerLocked?Ye:{...Ye,sheet:{...Ye.sheet,ciaExamEnabled:!!it}})}function Qe(it){const Ye=Pf(it,d,i,s),ct=d.filter(Ht=>{var fr;return(fr=Ye[String(Ht)])==null?void 0:fr.enabled}).map(Ht=>{const fr=Ye[String(Ht)];return{co:Ht,expCount:fr.expCount,expMax:fr.expMax}});return JSON.stringify({enabled:ct,ciaExamEnabled:!!(it.ciaExamEnabled??!0)})}async function Ie(){if(e){ie(!0),He(null);try{const it=await sl({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t});alert(ol(it))}catch(it){const Ye=ll(it,"Request failed");He(Ye),alert(`Edit request failed: ${Ye}`)}finally{ie(!1)}}}function Re(it,Ye,ct,Ht){Ke(fr=>{var $t;const Sr=String(it),Ze=Pf(fr.sheet,d,i,s)[String(Ye)],Kt=Ze?Ze.expMax:su,nt=Ze?Ze.expCount:Us,bt=($t=fr.sheet.rowsByStudentId)==null?void 0:$t[Sr],St=bt!=null&&bt.marksByCo&&typeof bt.marksByCo=="object"?{...bt.marksByCo}:{},Ct=[...Cd(St[String(Ye)]??Mj(bt,Ye,nt,i,s),nt)];if(Ht===""||Ht==null)Ct[ct]="";else{const Vt=Number(Ht);Ct[ct]=Number.isFinite(Vt)?Math.max(0,Math.min(Kt,Math.trunc(Vt))):""}return St[String(Ye)]=Ct,{...fr,sheet:{...fr.sheet,rowsByStudentId:{...fr.sheet.rowsByStudentId,[Sr]:{...bt||{studentId:it,marksA:[],marksB:[]},marksByCo:St}}}}})}function xt(it,Ye){Ke(ct=>{var gr;const Ht=String(it),fr=(gr=ct.sheet.rowsByStudentId)==null?void 0:gr[Ht];let Sr="";if(Ye===""||Ye==null)Sr="";else{const Ze=Number(Ye),Kt=Tf;Sr=Number.isFinite(Ze)?Math.max(0,Math.min(Kt,Math.trunc(Ze))):""}return{...ct,sheet:{...ct.sheet,rowsByStudentId:{...ct.sheet.rowsByStudentId,[Ht]:{...fr||{studentId:it,marksA:[],marksB:[]},ciaExam:Sr}}}}})}async function Gt(){if(e){j(!0);try{await Fi(r,e,ut),A(new Date().toLocaleString())}catch(it){alert((it==null?void 0:it.message)||"Draft save failed")}finally{j(!1)}}}const qt=Jr.useRef(ut);qt.current=ut,x.useEffect(()=>{const it=()=>{!e||ue||Fi(r,e,qt.current).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",it),()=>window.removeEventListener("obe:before-tab-switch",it)},[e,r,ue]);async function Wt(){if(!e||!window.confirm("Reset all lab marks for this sheet? This clears the draft (students + experiments + CIA Exam)."))return;const Ye=zs(Number(ut.sheet.expCountA??Us),0,12),ct=zs(Number(ut.sheet.expCountB??Us),0,12),Ht={};for(const Sr of y)Ht[String(Sr.id)]={studentId:Sr.id,marksA:Array.from({length:Ye},()=>""),marksB:Array.from({length:ct},()=>""),caaExamByCo:{},ciaExam:""};const fr={sheet:{...ut.sheet,rowsByStudentId:Ht}};Ke(fr);try{lt&&Gn(lt,{rowsByStudentId:{}})}catch{}try{await Fi(r,e,fr),A(new Date().toLocaleString())}catch{}}async function vt(){if(e){if(nn){alert("Publishing is locked by IQAC.");return}if(!Ae){alert("Publish window is closed. Please request IQAC approval.");return}if(Lt&&Ar){if(Tt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}oe(!0);return}if(!D){P(!0);try{await _N(r,e,ut,t),G(new Date().toLocaleString()),await Zt(!1),et(),It({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(it){alert((it==null?void 0:it.message)||"Publish failed")}finally{P(!1)}}}}async function Rt(){if(e){Pe(!0),Fe(null);try{await jh({assessment:r,subject_code:e,reason:U,teaching_assignment_id:t}),Fe("Request sent to IQAC successfully."),Z(""),et()}catch(it){Fe((it==null?void 0:it.message)||"Failed to send request.")}finally{Pe(!1)}}}async function Zt(it){if(e){it&&Q(!0),ne(null);try{const Ye=await Ks(r,String(e),t),ct=(Ye==null?void 0:Ye.data)??null;ct&&typeof ct=="object"&&X(ct)}catch(Ye){it&&ne((Ye==null?void 0:Ye.message)||"Failed to load published marks")}finally{it&&Q(!1)}}}x.useEffect(()=>{e&&Zt(!1)},[e,r]);const wr=Jr.useRef(null);x.useEffect(()=>{if(!e||!Lt)return;if(!yr){wr.current=!1;return}const it=wr.current;if(wr.current=!0,it===!0)return;let Ye=!0;return(async()=>{var ct;try{const Ht=await ei(r,String(e),t),fr=(Ht==null?void 0:Ht.draft)??null;if(!Ye)return;if(fr&&typeof fr=="object"&&fr.sheet){const Sr=(ct=fr.sheet)==null?void 0:ct.rowsByStudentId;if(Sr&&Object.values(Sr).some(Ze=>{var Kt,nt;return((Kt=Ze==null?void 0:Ze.marksA)==null?void 0:Kt.some(bt=>bt!==""&&bt!=null))||((nt=Ze==null?void 0:Ze.marksB)==null?void 0:nt.some(bt=>bt!==""&&bt!=null))||(Ze==null?void 0:Ze.ciaExam)!==""&&(Ze==null?void 0:Ze.ciaExam)!=null})){Ke(fr),B.current=!0;return}}}catch{}Ye&&O&&O.sheet&&(Ke(O),B.current=!0)})(),()=>{Ye=!1}},[yr,Lt,e,r,O,t]),x.useEffect(()=>{if(!e||!Lt||yr)return;const it=window.setInterval(()=>{It({silent:!0})},3e4);return()=>window.clearInterval(it)},[yr,Lt,e,It]),x.useEffect(()=>{Y&&e&&(X(null),Zt(!0))},[Y,e,r]);const br=3+Math.max(dn,1)+1+kt+st.length*2,cr={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Tr={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Kr={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},Yr={position:"relative",border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},xn="100%",hr={display:"flex",width:"100%",maxWidth:1200,margin:"0 auto",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},nr={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},Mr=qe?"markManagerGlitch 2s ease-in-out":void 0,an={position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"};return a.jsxs(og,{children:[a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),a.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),a.jsxs("div",{style:{...hr,border:"1px solid #fcd34d",background:Er?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:Mr,position:"relative",overflow:"hidden"},children:[qe?a.jsx(a.Fragment,{children:Array.from({length:20},(it,Ye)=>a.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},Ye))}):null,a.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx(A2,{size:20,color:Er?"#6b7280":"#9a3412"}),a.jsx("div",{style:{fontWeight:950,color:"#111827",fontSize:14},children:"Mark Manager"}),Er&&a.jsx("span",{style:{fontSize:11,color:"#fff",background:"#dc2626",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"LOCKED"}),!Er&&a.jsx("span",{style:{fontSize:11,color:"#fff",background:"#16a34a",padding:"2px 8px",borderRadius:6,fontWeight:700},children:"EDITABLE"})]}),a.jsx("button",{onClick:()=>T({mode:Er?"request":"confirm"}),className:"obe-btn obe-btn-success",disabled:!e||I,style:{minWidth:100},children:I?"Saving...":Er?"Request Edit":"Save & Lock"})]}),a.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[d.map(it=>{const Ye=fn[String(it)],ct=Er||u&&it!==i&&it!==s;return a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:(Ye==null?void 0:Ye.enabled)||!1,disabled:ct,onChange:Ht=>J(it,Ht.target.checked),style:nr}),"CO-",it]},it)}),a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:tt,disabled:Er,onChange:it=>wt(it.target.checked),style:nr}),"CIA Exam"]})]}),a.jsx("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,marginTop:8},children:Ir.map(it=>a.jsxs("div",{style:{minWidth:0},children:[a.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of experiments (CO-",it.coNumber,")"]}),a.jsx("input",{type:"number",className:"obe-input",value:it.expCount,onChange:Ye=>ye(it.coNumber,Number(Ye.target.value)),min:0,max:12,disabled:Er}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:6},children:"Max marks (per experiment)"}),a.jsx("input",{type:"number",className:"obe-input",value:it.expMax,onChange:Ye=>fe(it.coNumber,Number(Ye.target.value)),min:0,max:100,disabled:Er})]},it.coNumber))})]}),_e?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:_e}):null]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.jsx("button",{onClick:Wt,className:"obe-btn obe-btn-danger",disabled:!e||!se||ue,title:se?ue?"Table locked after publish":"Clear all marks":"Save & Lock Mark Manager first to enable table",children:"Reset All"})}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Gt,className:"obe-btn obe-btn-success",disabled:S||!e||!se||ue,title:se?ue?"Table locked after publish":"Save current draft":"Save & Lock Mark Manager first to enable table",children:S?"Saving":"Save Draft"}),a.jsx("button",{onClick:vt,className:"obe-btn obe-btn-primary",disabled:Ar?Tt:!e||E||!se||ue||nn||!Ae,title:se?ue?"Table locked after publish":Ae?nn?"Publishing locked by IQAC":"Publish marks":"Publish window closed":"Save & Lock Mark Manager first",children:Ar?Tt?"Request Pending":"Request Edit":E?"Publishing":"Publish"}),k&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",k]}),D&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",D]})]})]}),m&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:m}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:Ae?"#065f46":"#b91c1c"},children:be?"Checking publish due time":mt||(ve!=null&&ve.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(ve.due_at).toLocaleString(),"  Remaining: ",ag(ce),ve.allowed_by_approval&&ve.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(ve.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),nn?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>et(),disabled:be,children:"Refresh"})})]}):Ae?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:U,onChange:it=>Z(it.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>et(),disabled:me||be,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Rt,disabled:me,children:me?"Requesting":"Request Approval"})]}),je?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:je}):null]}),p?a.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):y.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"Select a Teaching Assignment to load students."}):se?a.jsx("div",{style:Yr,children:a.jsxs(sg,{locked:nn,children:[a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable"},children:a.jsxs("table",{className:"obe-table",style:{minWidth:xn,width:"100%",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:cr,colSpan:br,children:[ut.sheet.termLabel," | ",ut.sheet.batchLabel," | ",n]})}),a.jsxs("tr",{children:[a.jsx("th",{style:cr,rowSpan:5,children:"S.No"}),a.jsx("th",{style:cr,rowSpan:5,children:"Register No."}),a.jsx("th",{style:cr,rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:cr,colSpan:Math.max(1,dn),children:"Experiments"}),a.jsxs("th",{style:cr,rowSpan:5,children:[a.jsx("div",{children:"Total"}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",fontWeight:900},children:tt?"CIA exam":"Avg"})]}),a.jsx("th",{style:cr,colSpan:kt,children:"CO ATTAINMENT"}),st.length?a.jsx("th",{style:cr,colSpan:st.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[dn===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Ir.map(it=>Array.from({length:it.expCount},(Ye,ct)=>a.jsx("th",{style:cr,children:it.coNumber},`co${it.coNumber}_${ct}`)))}),Ir.map(it=>a.jsxs("th",{style:cr,colSpan:2,children:["CO-",it.coNumber]},`coatt_hdr_${it.coNumber}`)),st.map(it=>a.jsxs("th",{style:cr,colSpan:2,children:["BTL-",it]},`btl_${it}`))]}),a.jsxs("tr",{children:[dn===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Ir.map(it=>Array.from({length:it.expCount},(Ye,ct)=>a.jsx("th",{style:cr,children:it.expMax},`max_${it.coNumber}_${ct}`)))}),Ir.map(it=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:cr,children:(it.expMax+(tt&&Ir.length?Tf/Ir.length:0)).toFixed(0)}),a.jsx("th",{style:cr,children:"%"})]},`comax_${it.coNumber}`)),st.map(it=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:cr,children:jt}),a.jsx("th",{style:cr,children:"%"})]},`btlmax_${it}`))]}),a.jsxs("tr",{children:[dn===0?a.jsx("th",{style:cr,children:"No experiments"}):a.jsx(a.Fragment,{children:Ir.map(it=>Array.from({length:it.expCount},(Ye,ct)=>a.jsxs("th",{style:cr,children:["E",ct+1]},`e_${it.coNumber}_${ct}`)))}),a.jsx("th",{style:cr,colSpan:kt+st.length*2})]}),a.jsxs("tr",{children:[dn===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Ir.map(it=>Array.from({length:it.expCount},(Ye,ct)=>{const Ht=it.btl[ct]??1,fr=!(Ar||nn);return a.jsx("th",{style:cr,children:fr?a.jsx("select",{"aria-label":`BTL for CO${it.coNumber} E${ct+1}`,value:Ht,onChange:Sr=>Ce(it.coNumber,ct,Number(Sr.target.value)),style:{width:"100%",minWidth:38,padding:"2px 2px",fontWeight:800,fontSize:11,textAlign:"center",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",cursor:"pointer"},children:[1,2,3,4,5,6].map(Sr=>a.jsx("option",{value:Sr,children:Sr},Sr))}):a.jsx("span",{style:{fontWeight:800},children:Ht})},`btl_${it.coNumber}_${ct}`)}))}),a.jsx("th",{style:cr,colSpan:kt+st.length*2})]})]}),a.jsx("tbody",{children:Ar?a.jsx("tr",{children:a.jsx("td",{colSpan:br,style:{padding:14,textAlign:"center",color:"#065f46",fontWeight:900},children:"Published  students hidden"})}):a.jsxs(a.Fragment,{children:[y.map((it,Ye)=>{var St;const ct=(St=ut.sheet.rowsByStudentId)==null?void 0:St[String(it.id)],Ht=ct==null?void 0:ct.ciaExam,fr=Ht===""||Ht==null?0:Number(Ht),Sr=Ht===""||Ht==null?"":Number.isFinite(fr)?fr:"",gr=tt&&Ir.length?(Number.isFinite(fr)?fr:0)/Ir.length:0,Ze=Ir.map(Ct=>{const $t=Mj(ct,Ct.coNumber,Ct.expCount,i,s),Vt=$t.slice(0,Ct.expCount),Dt=Ct.btl.slice(0,Ct.expCount),ze=Wb(Vt),_t=ze!=null&&ze>0||tt&&fr>0?Number(ze??0)+gr:null,Ft=Ct.expMax+(tt&&Ir.length?Tf/Ir.length:0);return{coNumber:Ct.coNumber,marks:$t,visibleMarks:Vt,btls:Dt,coMark:_t,coMax:Ft}}),Kt=Ze.flatMap(Ct=>Ct.visibleMarks),nt=Wb(Kt),bt={};for(const Ct of st){const $t=[];for(const Vt of Ze)for(let Dt=0;Dt<Vt.visibleMarks.length;Dt++)if(Vt.btls[Dt]===Ct){const ze=Vt.visibleMarks[Dt];typeof ze=="number"&&Number.isFinite(ze)&&$t.push(ze)}bt[Ct]=$t.length?$t.reduce((Vt,Dt)=>Vt+Dt,0)/$t.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...Tr,width:"30px",minWidth:"30px",fontWeight:700},children:Ye+1}),a.jsx("td",{style:{...Tr,width:"70px",minWidth:"70px",fontWeight:600},children:String(it.reg_no||"").slice(-8)}),a.jsx("td",{style:{...Tr,fontWeight:600,whiteSpace:"nowrap"},children:String(it.name||"")}),Ze.map(Ct=>Array.from({length:Ct.visibleMarks.length},($t,Vt)=>{const Dt=Ir.find(ze=>ze.coNumber===Ct.coNumber);return a.jsx("td",{style:{...Tr,padding:"2px"},children:a.jsx("input",{type:"number",value:Ct.marks[Vt],onChange:ze=>{const at=ze.target.value;if(at==="")return ze.currentTarget.setCustomValidity(""),Re(it.id,Ct.coNumber,Vt,"");const _t=Number(at);if(Number.isFinite(_t)){if(_t>Dt.expMax){ze.currentTarget.setCustomValidity(`Max mark is ${Dt.expMax}`),ze.currentTarget.reportValidity(),window.setTimeout(()=>ze.currentTarget.setCustomValidity(""),0);return}ze.currentTarget.setCustomValidity(""),Re(it.id,Ct.coNumber,Vt,_t)}},style:Kr,min:0,max:Dt.expMax,disabled:!se||ue})},`m${it.id}_co${Ct.coNumber}_${Vt}`)})),a.jsx("td",{style:{...Tr,padding:tt?"2px":void 0,fontWeight:tt?600:700,fontSize:"clamp(10px, 0.9vw, 11px)"},children:tt?a.jsx("input",{type:"number",value:Sr,onChange:Ct=>{const $t=Ct.target.value;if($t==="")return Ct.currentTarget.setCustomValidity(""),xt(it.id,"");const Vt=Number($t);if(Number.isFinite(Vt)){if(Vt>Tf){Ct.currentTarget.setCustomValidity(`Max mark is ${Tf}`),Ct.currentTarget.reportValidity(),window.setTimeout(()=>Ct.currentTarget.setCustomValidity(""),0);return}Ct.currentTarget.setCustomValidity(""),xt(it.id,Vt)}},style:Kr,min:0,max:Tf,disabled:!se||ue}):nt==null?"":nt.toFixed(1)}),Ze.map(Ct=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Tr,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:Ct.coMark==null?"":Ct.coMark.toFixed(1)}),a.jsx("td",{style:{...Tr,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:qb(Ct.coMark,Ct.coMax)})]},`coatt_${it.id}_${Ct.coNumber}`)),st.map(Ct=>{const $t=bt[Ct]??null;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Tr,width:"28px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:$t==null?"":$t.toFixed(1)}),a.jsx("td",{style:{...Tr,width:"25px",fontSize:"10px",padding:"2px",fontWeight:600,color:"#5f6368"},children:qb($t,jt)})]},`btlcell_${it.id}_${Ct}`)})]},it.id)}),y.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:br,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})})]})}),Ar?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,!Er&&!Ar?a.jsxs("div",{style:an,children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]}):null,Ar?a.jsxs("div",{style:an,children:[a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>q(!0),children:"View Marks"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:Tt,onClick:async()=>{if(Tt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}oe(!0)},children:Tt?"Request Pending":"Request Edit"})]}),a.jsx("div",{style:{width:64,height:64,display:"grid",placeItems:"center"},children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#065f46",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",fill:"#d1fae5"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}):null]})}):a.jsxs("div",{style:{padding:"20px",textAlign:"center",background:"#fff7ed",borderRadius:12,border:"1px solid #fcd34d"},children:[a.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#92400e",marginBottom:8},children:" Mark Manager Configuration Required"}),a.jsx("div",{style:{fontSize:12,color:"#78350f"},children:"Please configure and lock the Mark Manager above to enable the table."})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[k?a.jsxs("div",{children:["Draft saved: ",k,R?a.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",a.jsx("strong",{children:R})]}):null]}):null,D?a.jsxs("div",{children:["Last published: ",D]}):null]}),H?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{V||oe(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:it=>it.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",Vr?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",n]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Code:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",D||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",k||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:de,onChange:it=>W(it.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),ee?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:ee}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:V,onClick:()=>oe(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",disabled:V||Tt||!e||!String(de||"").trim(),onClick:async()=>{if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(Tt){alert("Edit request is pending. Please wait.");return}const Ye=String(de||"").trim();if(!Ye){C("Reason is required.");return}ae(!0),C(null);try{const ct=await sl({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:Ye,teaching_assignment_id:t});alert(ol(ct)),oe(!1),W(""),Br(Date.now()+24*60*60*1e3);try{Wr({silent:!0})}catch{}It({silent:!0})}catch(ct){const Ht=ll(ct,"Request failed");C(Ht),alert(`Edit request failed: ${Ht}`)}finally{ae(!1)}},children:V?"Requesting":Tt?"Request Pending":"Send Request"})]})]})})}):null,re?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{I||T(null)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:it=>it.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:re.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(r).toUpperCase()})]}),re.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{background:"#fffbeb",border:"1px solid #fbbf24",borderRadius:8,padding:12,marginBottom:12},children:[a.jsx("div",{style:{fontWeight:700,color:"#92400e",marginBottom:4},children:" Important"}),a.jsxs("div",{style:{fontSize:12,color:"#78350f",lineHeight:1.5},children:["After confirming, Mark Manager will be ",a.jsx("strong",{children:"locked"}),". You'll need IQAC approval to change CO selection, experiment count, or max marks."]})]}),a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:8,fontWeight:600},children:"Review your settings:"}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Experiments"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb",fontWeight:700},children:"Max marks"})]})}),a.jsxs("tbody",{children:[Ir.length>0?Ir.map(it=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:["CO-",it.coNumber]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:it.expCount}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:it.expMax})]},it.coNumber)):a.jsx("tr",{children:a.jsx("td",{colSpan:3,style:{padding:10,color:"#dc2626",fontWeight:600},children:" No COs selected"})}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:800},children:"CIA Exam"}),a.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right",fontWeight:600},children:tt?" Enabled":" Disabled"})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:I,onClick:()=>T(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:I||!e,onClick:async()=>{if(e){if(re.mode==="request"){T(null),await Ie();return}ie(!0),He(null),Pt(!0);try{const it=Qe(ut.sheet),Ye=ht!=null&&ht.approval_until?String(ht.approval_until):ut.sheet.markManagerApprovalUntil||null,ct={...ut,sheet:{...ut.sheet,markManagerLocked:!0,markManagerSnapshot:it,markManagerApprovalUntil:Ye}};await Fi(r,String(e),ct),A(new Date().toLocaleString()),await fh(r,String(e),t),await It({silent:!1}),Ke(ct),T(null),alert(" Mark Manager saved and locked successfully! You can now proceed with mark entry."),setTimeout(()=>Pt(!1),1500)}catch(it){He((it==null?void 0:it.message)||"Save failed"),Pt(!1),Ke(Ye=>({...Ye,sheet:{...Ye.sheet,markManagerLocked:!1}}))}finally{ie(!1)}}},children:I?"Saving...":re.mode==="confirm"?" Confirm & Lock":" Send Request"})]})]})})}):null,Y?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"grid",placeItems:"center",padding:16,zIndex:70},onClick:()=>q(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflow:"auto",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:it=>it.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Marks"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),F?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,K?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:K}):null,(()=>{const it=O&&O.sheet?O.sheet:ut.sheet,Ye=it.ciaExamEnabled!==!1,ct=Pf(it,d,i,s),Ht=d.filter(St=>{var Ct;return(Ct=ct[String(St)])==null?void 0:Ct.enabled}).map(St=>{const Ct=ct[String(St)];return{coNumber:St,expCount:Ct.expCount,expMax:Ct.expMax,btl:Ct.btl}}),fr=Ht.reduce((St,Ct)=>St+Ct.expCount,0),Sr=new Set;for(const St of Ht)for(const Ct of St.btl.slice(0,St.expCount))Sr.add(Ct);const gr=[1,2,3,4,5,6].filter(St=>Sr.has(St)),Ze=Ht.reduce((St,Ct)=>Math.max(St,Ct.expMax),su),Kt=Ht.length*2,nt=3+Math.max(fr,1)+1+Kt+gr.length*2,bt=Math.max(920,360+(fr+gr.length*2)*80);return a.jsx("div",{className:"obe-table-wrapper",style:{width:"100%",maxWidth:"100%",overflowX:"scroll",overflowY:"hidden",WebkitOverflowScrolling:"touch",overscrollBehaviorX:"contain",scrollbarGutter:"stable",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{className:"obe-table",style:{width:"max-content",minWidth:bt,tableLayout:"auto",borderCollapse:"collapse"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:cr,colSpan:nt,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:cr,rowSpan:5,children:"S.No"}),a.jsx("th",{style:cr,rowSpan:5,children:"Register No."}),a.jsx("th",{style:cr,rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:cr,colSpan:Math.max(1,fr),children:"Experiments"}),a.jsxs("th",{style:cr,rowSpan:5,children:[a.jsx("div",{children:"Total"}),a.jsx("div",{style:{fontSize:11,color:"#6b7280",fontWeight:900},children:Ye?"CIA exam":"Avg"})]}),a.jsx("th",{style:cr,colSpan:Kt,children:"CO ATTAINMENT"}),gr.length?a.jsx("th",{style:cr,colSpan:gr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[fr===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Ht.map(St=>Array.from({length:St.expCount},(Ct,$t)=>a.jsx("th",{style:cr,children:St.coNumber},`v_co${St.coNumber}_${$t}`)))}),Ht.map(St=>a.jsxs("th",{style:cr,colSpan:2,children:["CO-",St.coNumber]},`v_coatt_hdr_${St.coNumber}`)),gr.map(St=>a.jsxs("th",{style:cr,colSpan:2,children:["BTL-",St]},`v_btl_${St}`))]}),a.jsxs("tr",{children:[fr===0?a.jsx("th",{style:cr,children:""}):a.jsx(a.Fragment,{children:Ht.map(St=>Array.from({length:St.expCount},(Ct,$t)=>a.jsx("th",{style:cr,children:St.expMax},`v_max_${St.coNumber}_${$t}`)))}),Ht.map(St=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:cr,children:(St.expMax+(Ye&&Ht.length?Tf/Ht.length:0)).toFixed(0)}),a.jsx("th",{style:cr,children:"%"})]},`v_comax_${St.coNumber}`)),gr.map(St=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:cr,children:Ze}),a.jsx("th",{style:cr,children:"%"})]},`v_btlmax_${St}`))]}),a.jsxs("tr",{children:[fr===0?a.jsx("th",{style:cr,children:"No experiments"}):a.jsx(a.Fragment,{children:Ht.map(St=>Array.from({length:St.expCount},(Ct,$t)=>a.jsxs("th",{style:cr,children:["E",$t+1]},`v_e_${St.coNumber}_${$t}`)))}),a.jsx("th",{style:cr,colSpan:Kt+gr.length*2})]}),a.jsxs("tr",{children:[fr===0?a.jsx("th",{style:cr,children:"BTL"}):a.jsx(a.Fragment,{children:Ht.map(St=>Array.from({length:St.expCount},(Ct,$t)=>a.jsx("th",{style:cr,children:St.btl[$t]??1},`v_btl_${St.coNumber}_${$t}`)))}),a.jsx("th",{style:cr,colSpan:Kt+gr.length*2})]})]}),a.jsxs("tbody",{children:[y.map((St,Ct)=>{var or;const $t=(or=it==null?void 0:it.rowsByStudentId)==null?void 0:or[String(St.id)],Vt=$t==null?void 0:$t.ciaExam,Dt=Vt===""||Vt==null?0:Number(Vt),ze=Ye&&Ht.length?(Number.isFinite(Dt)?Dt:0)/Ht.length:0,at=Ht.map(Xt=>{const xe=Mj($t,Xt.coNumber,Xt.expCount,i,s),Ee=xe.slice(0,Xt.expCount),De=Xt.btl.slice(0,Xt.expCount),gt=Wb(Ee),Je=gt!=null&&gt>0||Ye&&Dt>0?Number(gt??0)+ze:null,Ut=Xt.expMax+(Ye&&Ht.length?Tf/Ht.length:0);return{coNumber:Xt.coNumber,marks:xe,visibleMarks:Ee,btls:De,coMark:Je,coMax:Ut}}),_t=at.flatMap(Xt=>Xt.visibleMarks),Ft=Wb(_t),pr={};for(const Xt of gr){const xe=[];for(const Ee of at)for(let De=0;De<Ee.visibleMarks.length;De++)if(Ee.btls[De]===Xt){const gt=Ee.visibleMarks[De];typeof gt=="number"&&Number.isFinite(gt)&&xe.push(gt)}pr[Xt]=xe.length?xe.reduce((Ee,De)=>Ee+De,0)/xe.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...Tr,textAlign:"center",width:42,minWidth:42},children:Ct+1}),a.jsx("td",{style:Tr,children:String(St.reg_no||"")}),a.jsx("td",{style:Tr,children:String(St.name||"")}),fr===0?a.jsx("td",{style:{...Tr,textAlign:"center",color:"#6b7280"},children:""}):a.jsx(a.Fragment,{children:at.map(Xt=>Xt.visibleMarks.map((xe,Ee)=>a.jsx("td",{style:{...Tr,width:78,minWidth:78,background:"#fff7ed",textAlign:"center",fontWeight:800},children:xe??""},`v_m_${St.id}_co${Xt.coNumber}_${Ee}`)))}),a.jsx("td",{style:{...Tr,textAlign:Ye?"center":"right",fontWeight:800,background:Ye?"#fff7ed":void 0},children:Ye?Number.isFinite(Dt)?Dt:"":Ft==null?"":Ft.toFixed(1)}),at.map(Xt=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Tr,textAlign:"right"},children:Xt.coMark==null?"":Xt.coMark.toFixed(1)}),a.jsx("td",{style:{...Tr,textAlign:"right"},children:qb(Xt.coMark,Xt.coMax)})]},`v_coatt_${St.id}_${Xt.coNumber}`)),gr.map(Xt=>{const xe=pr[Xt]??null;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Tr,textAlign:"right"},children:xe==null?"":xe.toFixed(1)}),a.jsx("td",{style:{...Tr,textAlign:"right"},children:qb(xe,Ze)})]},`v_btl_${St.id}_${Xt}`)})]},`v_${St.id}`)}),y.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:nt,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})})(),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>q(!1),children:"Close"})})]})}):null]})}const CM={co1:42,co2:42,co3:58,co4:42,co5:42},Cxe={1:9,2:9,3:4.5},Exe={1:3,2:3,3:1.5},vp={1:20,2:20,3:10},Lj={1:12,2:12,3:6},Rj={1:9,2:9,3:4.5,4:9,5:9},Sd={1:0,2:0,3:0,4:20,5:20},Li=5,ra=25,Lh=30;function qr(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,Math.trunc(e))):t}function Hb(e,t,r){return Number.isFinite(e)?Math.max(t,Math.min(r,e)):t}function Rh(e){return Math.round(e*10)/10}function Txe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function Ns(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function Lu(e,t,r=1){const n=Array.isArray(e)?e:[],i=[];for(let s=0;s<t;s++){const o=n[s];if(o===""||o==null){i.push(r);continue}const l=typeof o=="number"?o:Number(o);i.push(Number.isFinite(l)&&l>=1&&l<=6?Math.trunc(l):r)}return i}function Vb(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Gb(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function EM(e){return e.reduce((t,r)=>t+(typeof r=="number"&&Number.isFinite(r)?r:0),0)}function Kb(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Fj(e){const t=e&&typeof e=="object"?e:{},r={};for(const n of Object.keys(t)){const i=t[n];if(i===""||i==null){r[n]="";continue}const s=typeof i=="number"?i:Number(i);r[n]=Number.isFinite(s)?s:""}return r}function Bj(e,t,r){return!Number.isFinite(e)||!Number.isFinite(t)||!Number.isFinite(r)||t<=0||r<=0?0:Math.max(0,e)/t*r}function Pxe(e,t,r){const n=Number(r[t]??0);if(n<=0)return 0;const i=e[String(t)];return typeof i!="number"||!Number.isFinite(i)?0:Math.max(0,Math.min(i,n))}function TM(e,t=7){const r=String(e??"").trim();return r?r.length<=t?r:r.slice(-t):""}function Oxe(e,t){return`${e}_sheet_${t}`}function Dx({subjectId:e,teachingAssignmentId:t,assessmentKey:r,label:n,coA:i,coB:s,skipMarkManager:o=!1,initialEnabledCos:l,itemLabel:c,itemLabelPlural:u,itemAbbrev:d,ciaExamAvailable:f,absentEnabled:p,autoSaveDraft:h,autoSaveDelayMs:m,viewerMode:g,floatPanelOnTable:y}){const[b,v]=x.useState([]),[w,S]=x.useState(!1),[j,k]=x.useState(null),[A,R]=x.useState(null),[M,B]=x.useState(!1),[E,P]=x.useState(null),[D,G]=x.useState(null),H=Jr.useRef(!1),[oe,de]=x.useState(!1),[W,V]=x.useState(null),[ae,ee]=x.useState(!1),[C,Y]=x.useState(!1),[q,O]=x.useState(""),[X,F]=x.useState(!1),[Q,K]=x.useState(""),[ne,re]=x.useState(!1),[T,I]=x.useState(null),[ie,U]=x.useState(null),[Z,me]=x.useState(!1),[Pe,je]=x.useState(null),[Fe,_e]=x.useState(!1),[He,qe]=x.useState(null),[Pt,ut]=x.useState(!1),[Ke,lt]=x.useState(null),[ve,Ae]=x.useState(!1),[ce,be]=x.useState(null),[mt,et]=x.useState(null),Ue=String(c||"Experiment"),It=String(u||"Experiments"),ht=String(d||"E"),Lt=f!==!1,yr=!!(p??r==="model"),Ar=!!h,Tt=qr(Number(m??900),250,5e3),Vr=x.useMemo(()=>{const $e=(Array.isArray(l)&&l.length?l:[i,s].filter(ot=>typeof ot=="number"&&Number.isFinite(ot))).map(ot=>qr(Number(ot),1,5));return Array.from(new Set($e)).sort((ot,We)=>ot-We)},[i,s,l]),Br=x.useMemo(()=>new Set(Vr.map(Se=>String(Se))),[Vr]),Wr=x.useRef(null),nn=x.useRef(null),fn=x.useMemo(()=>e?Oxe(r,String(e)):"",[r,e]),{data:Ir,publishAllowed:dn,remainingSeconds:Te,refresh:tt}=H0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:st,refresh:kt}=V0({assessment:r,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:jt}=lc({assessment:r,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:ar,refresh:tr}=lc({assessment:r,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),[Er,se]=x.useState(null),ue=!!W||!!(st!=null&&st.exists&&(st!=null&&st.is_published));x.useEffect(()=>{if(st!=null&&st.is_published&&(st!=null&&st.updated_at)&&!W)try{V(new Date(String(st.updated_at)).toLocaleString())}catch{V(String(st.updated_at))}},[st==null?void 0:st.is_published,st==null?void 0:st.updated_at]);const J=st!=null&&st.mark_entry_unblocked_until?String(st.mark_entry_unblocked_until):null,fe=st!=null&&st.mark_manager_unlocked_until?String(st.mark_manager_unlocked_until):null,ye=!!J&&!!(st!=null&&st.entry_open)&&(Er==null||J!==(Er.markEntryUnblockedUntil??null)),Ce=!!fe&&(Er==null||fe!==(Er.markManagerUnlockedUntil??null)),wt=ue?!!(st!=null&&st.entry_open)&&(Er==null||ye||Ce):!0,Qe=!!(ue&&!wt),Ie=!!(ue&&Qe&&!g),{pending:Re,pendingUntilMs:xt,setPendingUntilMs:Gt,refresh:qt}=G0({enabled:!!Ie&&!!e,assessment:r,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!He||ae||C||ce&&ce.visible||mt&&mt.visible);const Wt=!!(Ir!=null&&Ir.global_override_active&&(Ir==null?void 0:Ir.global_is_open)===!1),[vt,Rt]=x.useState(()=>({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:qr(Number(i??1),1,5),coBNum:s==null?null:qr(Number(s),1,5),coAEnabled:!0,coBEnabled:!!s,ciaExamEnabled:!!Lt,ciaExamMax:Lh,expCountA:Li,expCountB:s?Li:0,expMaxA:ra,expMaxB:s?ra:0,btlA:Array.from({length:Li},()=>1),btlB:s?Array.from({length:Li},()=>1):[],coConfigs:Object.fromEntries((Array.isArray(l)&&l.length?l:[i,s].filter(Se=>typeof Se=="number"&&Number.isFinite(Se))).map(Se=>qr(Number(Se),1,5)).filter((Se,$e,ot)=>ot.indexOf(Se)===$e).map(Se=>[String(Se),{enabled:!0,expCount:Li,expMax:ra,btl:Array.from({length:Li},()=>1)}])),rowsByStudentId:{},markManagerLocked:!1,markManagerSnapshot:null}}));x.useEffect(()=>{if(!Vr.length||vt.sheet.markManagerSnapshot)return;const Se=vt.sheet.coConfigs&&typeof vt.sheet.coConfigs=="object"?vt.sheet.coConfigs:{},$e=Vr.filter(ot=>!Se[String(ot)]);$e.length&&Rt(ot=>{const Nt={...ot.sheet.coConfigs&&typeof ot.sheet.coConfigs=="object"?ot.sheet.coConfigs:{}};for(const ur of $e)Nt[String(ur)]={enabled:!0,expCount:Li,expMax:ra,btl:Array.from({length:Li},()=>1)};return{...ot,sheet:{...ot.sheet,coConfigs:Nt}}})},[vt.sheet.coConfigs,vt.sheet.markManagerSnapshot,Vr]);const[Zt,wr]=x.useState(null),br=x.useMemo(()=>ti(Zt),[Zt]),cr=x.useMemo(()=>NN(Zt),[Zt]),Tr=br==="TCPR",Kr=x.useMemo(()=>br==="LAB"||br==="TCPL"||br==="TCPR"||br==="PRACTICAL"||br==="PROJECT",[br]),Yr=br==="LAB",xn=Kr&&!Yr&&!Tr;x.useEffect(()=>{let Se=!0;return(async()=>{try{const $e=await oc();if(!Se)return;Rt(ot=>({...ot,sheet:{...ot.sheet,termLabel:String(($e==null?void 0:$e.termLabel)||ot.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e||ot.sheet.batchLabel||"")}}))}catch{}})(),()=>{Se=!1}},[e]),x.useEffect(()=>{let Se=!0;return(async()=>{if(e)try{const $e=String(e).trim().toUpperCase(),ot=await Sl();if(!Se)return;const We=(ot||[]).find(zt=>String(zt.course_code||"").trim().toUpperCase()===$e);if(We&&(We!=null&&We.class_type)){wr((We==null?void 0:We.class_type)??null);return}const Nt=await Yd();if(!Se)return;const ur=(Nt||[]).find(zt=>String(zt.course_code||"").trim().toUpperCase()===$e);wr((ur==null?void 0:ur.class_type)??null)}catch{Se&&wr(null)}})(),()=>{Se=!1}},[e]),x.useEffect(()=>{let Se=!0;return H.current=!1,(async()=>{var $e,ot;if(e){try{const We=await ei(r,String(e));if(!Se)return;const Nt=We==null?void 0:We.draft;if(Nt&&typeof Nt=="object"&&Nt.sheet&&typeof Nt.sheet=="object"){const ur=qr(Number(i??1),1,5),zt=s==null?null:qr(Number(s),1,5),Nr=ur,jr=zt,Ur=!!(Nt.sheet.coAEnabled??!0),Or=!!(Nt.sheet.coBEnabled??!!jr),Gr=Lt?!!(Nt.sheet.ciaExamEnabled??!0):!1,zr=qr(Number(Nt.sheet.ciaExamMax??Lh),0,100),Qt=qr(Number(Nt.sheet.expCountA??Li),0,12),mn=qr(Number(Nt.sheet.expCountB??(Or?Li:0)),0,12),ln=Number.isFinite(Number(Nt.sheet.expMaxA))?Number(Nt.sheet.expMaxA):ra,_n=Number.isFinite(Number(Nt.sheet.expMaxB))?Number(Nt.sheet.expMaxB):Or?ra:0,wn=Lu(Nt.sheet.btlA,Qt,1),pn=Lu(Nt.sheet.btlB,mn,1),oi=Nt.sheet.coConfigs,Fn={};if(oi&&typeof oi=="object")for(const Bi of Object.keys(oi)){const Aa=oi[Bi]||{},to=qr(Number(Aa.expCount??Li),0,12);Fn[Bi]={enabled:!!Aa.enabled,expCount:to,expMax:Number.isFinite(Number(Aa.expMax))?Number(Aa.expMax):ra,btl:Lu(Aa.btl,to,1)}}const pi=String(Nr);if(Fn[pi]||(Fn[pi]={enabled:Ur,expCount:Qt,expMax:ln,btl:wn}),jr!=null){const Bi=String(jr);Fn[Bi]||(Fn[Bi]={enabled:Or,expCount:mn,expMax:_n,btl:pn})}const Xn=!!((($e=Fn[String(Nr)])==null?void 0:$e.enabled)??Ur),ca=!!(jr!=null&&(((ot=Fn[String(jr)])==null?void 0:ot.enabled)??Or)),Rl=Bi=>{const Aa=Bi&&typeof Bi=="object"?Bi:{},to={};for(const[Au,Ci]of Object.entries(Aa)){const $n=Ci&&typeof Ci=="object"?Ci:{},Yi=$n!=null&&$n.marksByCo&&typeof $n.marksByCo=="object"?{...$n.marksByCo}:{},Ss=$n==null?void 0:$n.ciaExam,hd=Ss===""||Ss==null?"":Number.isFinite(Number(Ss))?Hb(Number(Ss),0,zr):"",Xc=Ns($n==null?void 0:$n.marksA,Qt),gc=Ns($n==null?void 0:$n.marksB,mn),xc=Ns(Yi[pi],Qt),Yo=jr!=null?Ns(Yi[String(jr)],mn):[],ro=Fl=>Fl.some(Bl=>Bl!==""&&Bl!=null),pl=ro(Xc)?Xc:ro(xc)?xc:Xc,yc=mn?ro(gc)?gc:ro(Yo)?Yo:gc:gc;Yi[pi]=xc,jr!=null&&(Yi[String(jr)]=Yo),to[String(Au)]={...$n,studentId:Number.isFinite(Number($n==null?void 0:$n.studentId))?Number($n.studentId):Number(Au),marksA:pl,marksB:yc,marksByCo:Yi,ciaExam:hd,caaExamByCo:Kb($n==null?void 0:$n.caaExamByCo),ciaExamByCo:Fj($n==null?void 0:$n.ciaExamByCo)}}return to},Ko=Nt.sheet.markManagerSnapshot??null,wo=Nt.sheet.markManagerApprovalUntil??null,So=Nt.sheet.markManagerLocked,ws=typeof So=="boolean"?So:!!Ko;Rt({sheet:{termLabel:String(Nt.sheet.termLabel||"KRCT AY25-26"),batchLabel:String(e),coANum:Nr,coBNum:jr,coAEnabled:Xn,coBEnabled:ca,ciaExamEnabled:Gr,ciaExamMax:zr,expCountA:Qt,expCountB:mn,expMaxA:ln,expMaxB:_n,btlA:wn,btlB:pn,coConfigs:Fn,rowsByStudentId:Rl(Nt.sheet.rowsByStudentId),markManagerLocked:ws,markManagerSnapshot:Ko,markManagerApprovalUntil:wo}});const ba=(We==null?void 0:We.updated_at)??null,cs=(We==null?void 0:We.updated_by)??null;if(ba)try{P(new Date(String(ba)).toLocaleString())}catch{P(String(ba))}cs&&G(String(cs.name||cs.username||cs.id||""));try{fn&&Gn(fn,{rowsByStudentId:Nt.sheet.rowsByStudentId||{}})}catch{}}else{const ur=fn?Qn(fn):null,zt=ur!=null&&ur.rowsByStudentId&&typeof ur.rowsByStudentId=="object"?ur.rowsByStudentId:{},Nr=qr(Number(i??1),1,5),jr=s==null?null:qr(Number(s),1,5),Ur=Li,Or=jr!=null?Li:0,Gr=ra,zr=jr!=null?ra:0,Qt=Array.from({length:Ur},()=>1),mn=jr!=null?Array.from({length:Or},()=>1):[],ln={[String(Nr)]:{enabled:!0,expCount:Ur,expMax:Gr,btl:Qt},...jr==null?{}:{[String(jr)]:{enabled:!0,expCount:Or,expMax:zr,btl:mn}}};Rt({sheet:{termLabel:"KRCT AY25-26",batchLabel:String(e||""),coANum:Nr,coBNum:jr,coAEnabled:!0,coBEnabled:!!jr,ciaExamEnabled:!!Lt,ciaExamMax:Lh,expCountA:Ur,expCountB:Or,expMaxA:Gr,expMaxB:zr,btlA:Qt,btlB:mn,coConfigs:ln,rowsByStudentId:zt,markManagerLocked:!1,markManagerSnapshot:null}})}}catch{}Se&&(H.current=!0)}})(),()=>{Se=!1}},[r,e,fn,i,s]),x.useEffect(()=>{let Se=!0;return(async()=>{var $e,ot,We;if(!t){v([]);return}S(!0),k(null);try{let Nt=null;try{const zt=await mr(`/api/academics/teaching-assignments/${t}/`);if(zt.ok){const Nr=await zt.json();if(Nr&&Nr.elective_subject_id&&!Nr.section_id){const jr=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Nr.elective_subject_id))}`);if(jr.ok){const Ur=await jr.json();Nt=(Array.isArray(Ur.results)?Ur.results:Array.isArray(Ur)?Ur:Ur.items||[]).map(Gr=>({id:Number(Gr.student_id??Gr.id),reg_no:String(Gr.reg_no??Gr.regno??""),name:String(Gr.name??Gr.full_name??Gr.username??""),section:Gr.section_name??Gr.section??null}))}}}}catch{}if(!Nt){const zt=await pc(t);R({courseName:String((($e=zt==null?void 0:zt.teaching_assignment)==null?void 0:$e.subject_name)||""),courseCode:String(((ot=zt==null?void 0:zt.teaching_assignment)==null?void 0:ot.subject_code)||e||""),className:String(((We=zt==null?void 0:zt.teaching_assignment)==null?void 0:We.section_name)||"")}),Nt=((zt==null?void 0:zt.students)||[]).map(jr=>({id:Number(jr.id),reg_no:String(jr.reg_no??""),name:String(jr.name??""),section:jr.section??null}))}if(!Se)return;const ur=(Nt||[]).filter(zt=>Number.isFinite(zt.id)).sort(Txe);v(ur),Rt(zt=>{const Nr=qr(Number(zt.sheet.expCountA??Li),0,12),jr=qr(Number(zt.sheet.expCountB??0),0,12),Ur={...zt.sheet.rowsByStudentId||{}};for(const Or of ur){const Gr=String(Or.id);Ur[Gr]||(Ur[Gr]={studentId:Or.id,absent:!1,absentKind:void 0,marksA:Array.from({length:Nr},()=>""),marksB:Array.from({length:jr},()=>""),marksByCo:{},caaExamByCo:{},ciaExamByCo:{},ciaExam:""})}return{...zt,sheet:{...zt.sheet,rowsByStudentId:Ur}}})}catch(Nt){if(!Se)return;v([]),k((Nt==null?void 0:Nt.message)||"Failed to load roster")}finally{Se&&S(!1)}})(),()=>{Se=!1}},[t]),x.useEffect(()=>{if(fn)try{Gn(fn,{rowsByStudentId:vt.sheet.rowsByStudentId})}catch{}},[vt.sheet.rowsByStudentId,fn]),x.useEffect(()=>{if(!e||!!!vt.sheet.markManagerSnapshot)return;if(ue&&(st!=null&&st.exists)){const We=!!(st!=null&&st.mark_manager_locked);!!vt.sheet.markManagerLocked!==We&&Rt(Nt=>({...Nt,sheet:{...Nt.sheet,markManagerLocked:We}}));return}const $e=!!(jt!=null&&jt.allowed_by_approval),ot=jt!=null&&jt.approval_until?String(jt.approval_until):null;if($e&&ot){const We=vt.sheet.markManagerApprovalUntil?String(vt.sheet.markManagerApprovalUntil):null;vt.sheet.markManagerLocked&&We!==ot&&Rt(Nt=>({...Nt,sheet:{...Nt.sheet,markManagerLocked:!1,markManagerApprovalUntil:ot}}));return}vt.sheet.markManagerLocked||Rt(We=>({...We,sheet:{...We.sheet,markManagerLocked:!0}}))},[e,ue,st==null?void 0:st.exists,st==null?void 0:st.mark_manager_locked,jt==null?void 0:jt.allowed_by_approval,jt==null?void 0:jt.approval_until,vt.sheet.markManagerLocked,vt.sheet.markManagerSnapshot,vt.sheet.markManagerApprovalUntil]);const hr=qr(Number(vt.sheet.coANum??i??1),1,5),nr=vt.sheet.coBNum??s??null,Mr=nr==null?null:qr(Number(nr),1,5),an=x.useMemo(()=>[1,2,3,4,5],[]),it=x.useMemo(()=>new Set(an.map(Se=>String(Se))),[an]);qr(Number(vt.sheet.expCountA??Li),0,12),qr(Number(vt.sheet.expCountB??0),0,12),vt.sheet.coAEnabled,vt.sheet.coBEnabled&&Mr!=null;const Ye=x.useMemo(()=>_t(vt.sheet),[vt.sheet]),ct=!!vt.sheet.markManagerLocked,Ht=Lt?vt.sheet.ciaExamEnabled!==!1:!1,fr=x.useMemo(()=>Tr?qr(Number(vt.sheet.ciaExamMax??Lh),0,100):Lh,[Tr,vt.sheet.ciaExamMax]);x.useMemo(()=>Ft(Ye,Ht),[Ye,Ht]);const Sr=!wt,gr=x.useMemo(()=>Object.entries(Ye||{}).filter(([Se,$e])=>it.has(String(Se))&&!!($e&&$e.enabled)).map(([Se,$e])=>({coNumber:Number(Se),expCount:qr(Number($e.expCount??0),0,12),expMax:qr(Number($e.expMax??0),0,100),btl:$e.btl??[]})),[Ye,it]),Ze=x.useMemo(()=>gr.reduce((Se,$e)=>Se+$e.expCount,0),[gr]),Kt=Math.max(Ze,1),nt=gr.length>0,bt=x.useMemo(()=>gr.filter(Se=>Number.isFinite(Number(vp[Se.coNumber]))),[gr]),St=bt.length,Ct=x.useMemo(()=>Yr&&Ht?gr.filter(Se=>Number(Sd[Se.coNumber]||0)>0):[],[gr,Yr,Ht]),$t=Yr?Ht?Ct.length:0:Ht?xn?Math.max(St,1):1:0,Vt=nt?gr.length*2:2,Dt=x.useMemo(()=>gr.reduce((Se,$e)=>Math.max(Se,$e.expMax),0),[gr]);x.useMemo(()=>{if(!yr)return!1;const Se=vt.sheet.rowsByStudentId||{};return Object.values(Se).some($e=>!!($e!=null&&$e.absent))},[yr,vt.sheet.rowsByStudentId]);function ze(Se,$e){const ot=Se==null?void 0:Se.marksByCo;return $e.map(We=>{const Nt=ot&&typeof ot=="object"?ot[String(We.coNumber)]:void 0,ur=We.coNumber===hr?Se==null?void 0:Se.marksA:We.coNumber===Mr?Se==null?void 0:Se.marksB:void 0,zt=Ns(Nt??ur,We.expCount);return{coNumber:We.coNumber,expCount:We.expCount,expMax:We.expMax,marks:zt}})}function at(Se,$e){const ot=Kb(Se==null?void 0:Se.caaExamByCo),We=Fj(Se==null?void 0:Se.ciaExamByCo),Nt=Ht&&typeof(Se==null?void 0:Se.ciaExam)=="number"&&Number.isFinite(Se==null?void 0:Se.ciaExam)?Number(Se==null?void 0:Se.ciaExam):null;if(Yr){const Ur=$e.map(zr=>{const Qt=EM(zr.marks),mn=Math.max(0,zr.expCount)*Math.max(0,zr.expMax),ln=Number(Rj[zr.coNumber]||0),_n=Ht?Pxe(We,zr.coNumber,Sd):0,wn=Bj(Qt,mn,ln),oi=Qt>0||_n>0?Rh(wn+_n):null,Fn=Rh(ln+(Ht?Number(Sd[zr.coNumber]||0):0));return{coNumber:zr.coNumber,mark:oi,coMax:Fn}}),Or=Ur.reduce((zr,Qt)=>zr+(typeof Qt.mark=="number"&&Number.isFinite(Qt.mark)?Qt.mark:0),0),Gr=Ur.some(zr=>typeof zr.mark=="number"&&Number.isFinite(zr.mark));return{caaByCo:ot,ciaByCo:We,ciaExamNumLegacy:Nt,coAttainmentValues:Ur,hasAnyMarks:Gr,finalTotal:Gr?Rh(Or):""}}if(xn){let Ur=0,Or=!1;const Gr=$e.map(zr=>{const Qt=EM(zr.marks),mn=Math.max(0,zr.expCount)*Math.max(0,zr.expMax),ln=Number(Cxe[zr.coNumber]||0),_n=Number(Exe[zr.coNumber]||0),wn=Number(vp[zr.coNumber]||0),pn=Number(Lj[zr.coNumber]||0),oi=Bj(Qt,mn,ln),Fn=ot[String(zr.coNumber)],pi=typeof Fn=="number"&&Number.isFinite(Fn)?Fn:0,Xn=Bj(pi,wn,_n),ca=oi+Xn;return(Qt>0||pi>0)&&(Or=!0),Ur+=ca,{coNumber:zr.coNumber,mark:Or?ca:null,coMax:pn}});return{caaByCo:ot,ciaByCo:We,ciaExamNumLegacy:Nt,coAttainmentValues:Gr.map(zr=>({...zr,mark:Or?zr.mark:null})),hasAnyMarks:Or,finalTotal:Or?Rh(Ur):""}}const ur=$e.flatMap(Ur=>Ur.marks),zt=Vb(ur),Nr=zt!=null||Ht&&Nt!=null,jr=$e.map(Ur=>{const Or=Vb(Ur.marks),Gr=Nr?(Or??0)+(Ht?(Nt??0)/2:0):null,zr=CM[`co${Ur.coNumber}`],Qt=Array.from({length:qr(Number(Ur.expCount??0),0,12)}).map(()=>qr(Number(Ur.expMax??ra),0,100)),mn=Qt.length?Qt.reduce((wn,pn)=>wn+pn,0)/Qt.length:0,ln=cr&&Number.isFinite(Number(zr))?Number(zr):mn,_n=Math.round(ln+(Ht?fr/2:0)||0);return{coNumber:Ur.coNumber,mark:Gr,coMax:_n}});return{caaByCo:ot,ciaByCo:We,ciaExamNumLegacy:Nt,coAttainmentValues:jr,hasAnyMarks:Nr,finalTotal:zt==null&&Nt==null?"":Rh((zt??0)+(Nt??0))}}x.useMemo(()=>!g&&ue&&!wt?[]:!yr||!Fe?b:b.filter(Se=>{var $e,ot;return!!((ot=($e=vt.sheet.rowsByStudentId)==null?void 0:$e[String(Se.id)])!=null&&ot.absent)}),[g,ue,wt,yr,b,Fe,vt.sheet.rowsByStudentId]),x.useEffect(()=>{if(!Ar||!e||!H.current||Sr||Qe)return;nn.current!=null&&(window.clearTimeout(nn.current),nn.current=null);const Se=JSON.stringify(vt);if(Se!==Wr.current)return nn.current=window.setTimeout(async()=>{if(e)try{B(!0),await Fi(r,String(e),vt),Wr.current=Se,P(new Date().toLocaleString())}catch{}finally{B(!1)}},Tt),()=>{nn.current!=null&&(window.clearTimeout(nn.current),nn.current=null)}},[Ar,Tt,r,vt,Qe,e,Sr]);function _t(Se){const ot={...Se.coConfigs&&typeof Se.coConfigs=="object"?Se.coConfigs:{}};for(const We of[1,2,3,4,5]){const Nt=String(We),ur=ot[Nt];if(!ur)ot[Nt]={enabled:Br.has(Nt),expCount:Li,expMax:ra,btl:Array.from({length:Li},()=>1)};else{const zt=qr(Number(ur.expCount??Li),0,12);ot[Nt]={enabled:!!ur.enabled,expCount:zt,expMax:qr(Number(ur.expMax??ra),0,100),btl:Lu(ur.btl,zt,1)}}}return ot}function Ft(Se,$e){const ot=Object.entries(Se).filter(([We,Nt])=>it.has(String(We))&&!!(Nt!=null&&Nt.enabled)).map(([We,Nt])=>({co:qr(Number(We),1,5),expCount:qr(Number((Nt==null?void 0:Nt.expCount)??0),0,12),expMax:qr(Number((Nt==null?void 0:Nt.expMax)??0),0,100)})).sort((We,Nt)=>We.co-Nt.co);return JSON.stringify({enabled:ot,ciaExamEnabled:!!$e})}function pr(Se){if(!Se)return null;try{const $e=JSON.parse(String(Se)),ot=Array.isArray($e==null?void 0:$e.enabled)?$e.enabled:[],We={};for(const Nt of[1,2,3,4,5])We[String(Nt)]={enabled:!1,expCount:Li,expMax:ra,btl:Array.from({length:Li},()=>1)};for(const Nt of ot){const ur=qr(Number(Nt==null?void 0:Nt.co),1,5);We[String(ur)]={...We[String(ur)],enabled:!0,expCount:qr(Number((Nt==null?void 0:Nt.expCount)??Li),0,12),expMax:qr(Number((Nt==null?void 0:Nt.expMax)??ra),0,100)}}return We}catch{return null}}function or(Se,$e,ot,We){if(!Se)return 0;const Nt=new Set($e.map(zt=>String(zt)));let ur=0;for(const zt of Object.values(Se)){if(!zt||typeof zt!="object")continue;const Nr=zt.marksByCo&&typeof zt.marksByCo=="object"?zt.marksByCo:{};let jr=!1;for(const Ur of $e){const Or=String(Ur);if(!Nt.has(Or))continue;const Gr=Nr[Or];if(Array.isArray(Gr)&&Gr.some(zr=>zr!==""&&zr!=null)){jr=!0;break}if(!jr&&Ur===ot&&Array.isArray(zt.marksA)&&zt.marksA.some(zr=>zr!==""&&zr!=null)&&(jr=!0),!jr&&We!=null&&Ur===We&&Array.isArray(zt.marksB)&&zt.marksB.some(zr=>zr!==""&&zr!=null)&&(jr=!0),jr)break}jr&&ur++}return ur}function Xt(Se){return Object.entries(Se).filter(([$e,ot])=>it.has(String($e))&&!!(ot!=null&&ot.enabled)).map(([$e])=>qr(Number($e),1,5)).sort(($e,ot)=>$e-ot)}function xe(Se,$e){const ot=[],We=[],Nt=[];for(const ur of[1,2,3,4,5]){const zt=String(ur),Nr=Se[zt],jr=$e[zt],Ur=!!(Nr!=null&&Nr.enabled),Or=!!(jr!=null&&jr.enabled);if(!Nr&&jr){Or&&ot.push(ur);continue}if(Nr&&!jr){Ur&&We.push(ur);continue}if(Nr&&jr){const Gr=qr(Number(Nr.expCount??0),0,12),zr=qr(Number(jr.expCount??0),0,12),Qt=qr(Number(Nr.expMax??0),0,100),mn=qr(Number(jr.expMax??0),0,100);(Ur!==Or||Gr!==zr||Qt!==mn)&&Nt.push(ur)}}return{added:ot,removed:We,changed:Nt}}function Ee(Se,$e){if(!Se)return 0;let ot=0;for(const We of Object.values(Se)){if(!We||typeof We!="object")continue;if(Array.isArray(We.marksA)&&We.marksA.some(Nr=>Nr!==""&&Nr!=null)||Array.isArray(We.marksB)&&We.marksB.some(Nr=>Nr!==""&&Nr!=null)||We.ciaExam!==""&&We.ciaExam!=null){ot++;continue}const ur=We.marksByCo&&typeof We.marksByCo=="object"?We.marksByCo:{};let zt=!1;for(const Nr of $e){const jr=ur[String(Nr)];if(Array.isArray(jr)&&jr.some(Ur=>Ur!==""&&Ur!=null)){zt=!0;break}}zt&&ot++}return ot}function De(Se){Rt($e=>!Lt||$e.sheet.markManagerLocked?$e:{...$e,sheet:{...$e.sheet,ciaExamEnabled:!!Se}})}function gt(Se){Tr&&Rt($e=>{if(!Lt||$e.sheet.markManagerLocked)return $e;const ot=qr(Number(Se),0,100),We={...$e.sheet.rowsByStudentId||{}};for(const[Nt,ur]of Object.entries(We)){const zt=ur&&typeof ur=="object"?ur:{},Nr=zt==null?void 0:zt.ciaExam;typeof Nr=="number"&&Number.isFinite(Nr)&&(We[Nt]={...zt,ciaExam:Hb(Nr,0,ot)})}return{...$e,sheet:{...$e.sheet,ciaExamMax:ot,rowsByStudentId:We}}})}function vr(Se,$e){Rt(ot=>{var Nr;const We=String(Se),Nt=(Nr=ot.sheet.rowsByStudentId)==null?void 0:Nr[We];if(!Nt)return ot;const ur=qr(Number(ot.sheet.expCountA??Li),0,12),zt=qr(Number(ot.sheet.expCountB??0),0,12);return $e?{...ot,sheet:{...ot.sheet,rowsByStudentId:{...ot.sheet.rowsByStudentId,[We]:{...Nt,absent:!0,absentKind:Nt.absentKind||"AL",marksA:Array.from({length:ur},()=>""),marksB:Array.from({length:zt},()=>""),caaExamByCo:{},ciaExamByCo:{},ciaExam:""}}}}:{...ot,sheet:{...ot.sheet,rowsByStudentId:{...ot.sheet.rowsByStudentId,[We]:{...Nt,absent:!1,absentKind:void 0}}}}})}function Je(Se,$e){Rt(ot=>{var ur;const We=String(Se),Nt=(ur=ot.sheet.rowsByStudentId)==null?void 0:ur[We];return Nt?{...ot,sheet:{...ot.sheet,rowsByStudentId:{...ot.sheet.rowsByStudentId,[We]:{...Nt,absent:!0,absentKind:$e}}}}:ot})}function Ut(Se,$e){const ot=qr(Number(Se),1,5);Rt(We=>{if(We.sheet.markManagerLocked)return We;const Nt=_t(We.sheet),ur=String(ot),zt=Nt[ur],Nr=qr(Number((zt==null?void 0:zt.expCount)??Li),0,12),jr=qr(Number((zt==null?void 0:zt.expMax)??ra),0,100),Ur=Lu((zt==null?void 0:zt.btl)??[],Nr,1);Nt[ur]={enabled:!!$e,expCount:Nr,expMax:jr,btl:Ur};const Or=qr(Number(We.sheet.coANum??i??1),1,5),Gr=We.sheet.coBNum??s??null,zr=Gr==null?null:qr(Number(Gr),1,5),Qt={...We.sheet,coConfigs:Nt};return ot===Or&&(Qt.coAEnabled=!!$e),zr!=null&&ot===zr&&(Qt.coBEnabled=!!$e),{...We,sheet:Qt}})}async function Le(){if(!e)return;ut(!0),lt(null);const Se=new Date,$e=st!=null&&st.mark_manager_unlocked_until?String(st.mark_manager_unlocked_until):null;try{const ot=await sl({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${n}`,teaching_assignment_id:t});alert(ol(ot));const We=Number(ot==null?void 0:ot.id),Nt=Se.getTime()-2e3;(async()=>{for(let Nr=0;Nr<36;Nr++){try{const jr=await Rm({assessment:r,subject_code:String(e),scope:"MARK_MANAGER",teaching_assignment_id:t}),Ur=jr==null?void 0:jr.result;if(!Ur)throw new Error("No status");if(Number.isFinite(We)&&We>0&&Number(Ur.id)!==We)throw new Error("Different request");const Or=Ur.reviewed_at?new Date(String(Ur.reviewed_at)).getTime():0,Gr=String(Ur.status||"").toUpperCase();if(Gr==="APPROVED"&&Or>=Nt){try{kt({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}if(Gr==="REJECTED"&&Or>=Nt){alert("IQAC rejected the mark-manager edit request.");return}}catch{try{const jr=st!=null&&st.mark_manager_unlocked_until?String(st.mark_manager_unlocked_until):null;if(jr&&$e&&jr!==$e){try{kt({silent:!0})}catch{}alert("IQAC approved the mark-manager edit request. You can now edit mark-manager settings.");return}}catch{}}await new Promise(jr=>setTimeout(jr,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(ot){const We=ll(ot,"Request failed");lt(We),alert(`Edit request failed: ${We}`)}finally{ut(!1)}}async function Be(Se,$e=[]){if(e){ut(!0),lt(null);try{const ot=qr(Number(i??1),1,5),We=s==null?null:qr(Number(s),1,5),Nt=Ft(Ye,Ht),ur=jt!=null&&jt.approval_until?String(jt.approval_until):vt.sheet.markManagerApprovalUntil||null,zt=Ye[String(ot)],Nr=We==null?null:Ye[String(We)],jr=!!(zt!=null&&zt.enabled),Ur=!!(We!=null&&(Nr!=null&&Nr.enabled)),Or=qr(Number((zt==null?void 0:zt.expCount)??vt.sheet.expCountA??Li),0,12),Gr=qr(Number((zt==null?void 0:zt.expMax)??vt.sheet.expMaxA??ra),0,100),zr=Lu((zt==null?void 0:zt.btl)??vt.sheet.btlA,Or,1),Qt=We==null?0:qr(Number((Nr==null?void 0:Nr.expCount)??vt.sheet.expCountB??Li),0,12),mn=We==null?0:qr(Number((Nr==null?void 0:Nr.expMax)??vt.sheet.expMaxB??ra),0,100),ln=We==null?[]:Lu((Nr==null?void 0:Nr.btl)??vt.sheet.btlB,Qt,1),_n=new Set(Se==="full"?[1,2,3,4,5].map(String):Se==="partial"?$e.map(Fn=>String(qr(Number(Fn),1,5))):[]),wn=(Fn,pi,Xn)=>{const ca=Fn!=null&&Fn.marksByCo&&typeof Fn.marksByCo=="object"?Fn.marksByCo:{};return Ns(ca[pi],Xn)},pn=Fn=>Fn.some(pi=>pi!==""&&pi!=null),oi={...vt,sheet:{...vt.sheet,coANum:ot,coBNum:We,coAEnabled:jr,coBEnabled:Ur,expCountA:Or,expCountB:Qt,expMaxA:Gr,expMaxB:mn,btlA:zr,btlB:ln,coConfigs:Ye,markManagerLocked:!0,markManagerSnapshot:Nt,markManagerApprovalUntil:ur,rowsByStudentId:Object.fromEntries(Object.entries(vt.sheet.rowsByStudentId||{}).map(([Fn,pi])=>{const Xn=pi&&typeof pi=="object"?pi:{};let ca=Xn!=null&&Xn.marksByCo&&typeof Xn.marksByCo=="object"?{...Xn.marksByCo}:{};if(Se==="full")ca={},Xn.marksA=Array.from({length:Or},()=>""),Xn.marksB=Array.from({length:Qt},()=>""),Xn.caaExamByCo={},Xn.ciaExamByCo={},Xn.ciaExam="";else if(Se==="partial"&&_n.size){const cs=Kb(Xn.caaExamByCo);for(const Bi of Array.from(_n)){const Aa=Ye[String(Bi)],to=qr(Number((Aa==null?void 0:Aa.expCount)??0),0,12);to>0?ca[String(Bi)]=Array.from({length:to},()=>""):delete ca[String(Bi)],Object.prototype.hasOwnProperty.call(cs,String(Bi))&&(cs[String(Bi)]=""),Number(Bi)===ot&&(Xn.marksA=Array.from({length:Or},()=>"")),We!=null&&Number(Bi)===We&&(Xn.marksB=Array.from({length:Qt},()=>""))}Xn.caaExamByCo=cs}const Rl=Ns(Xn==null?void 0:Xn.marksA,Or),Ko=Ns(Xn==null?void 0:Xn.marksB,Qt),wo=Ns(ca[String(ot)]??wn(Xn,String(ot),Or),Or),So=We==null?[]:Ns(ca[String(We)]??wn(Xn,String(We),Qt),Qt),ws=pn(Rl)?Rl:pn(wo)?wo:Rl,ba=Qt?pn(Ko)?Ko:pn(So)?So:Ko:Ko;return ca[String(ot)]=wo,We!=null&&(ca[String(We)]=So),[Fn,{...Xn,marksA:ws,marksB:ba,marksByCo:ca}]}))}};Rt(oi),qe(null),et(null),Ae(!0),await Fi(r,String(e),oi),P(new Date().toLocaleString());try{await fh(r,String(e),t),kt({silent:!0})}catch(Fn){console.warn("confirmMarkManagerLock failed",Fn)}}catch(ot){lt((ot==null?void 0:ot.message)||"Save failed")}finally{ut(!1),setTimeout(()=>Ae(!1),2e3)}}}function Et(Se,$e){const ot=qr(Number($e),0,12);Rt(We=>{if(We.sheet.markManagerLocked)return We;const Nt=_t(We.sheet),ur=String(Se),zt=Nt[ur],Nr=qr(Number((zt==null?void 0:zt.expMax)??ra),0,100);Nt[ur]={enabled:!!((zt==null?void 0:zt.enabled)??!0),expCount:ot,expMax:Nr,btl:Lu((zt==null?void 0:zt.btl)??[],ot,1)};const jr=qr(Number(We.sheet.coANum??i??1),1,5),Ur=We.sheet.coBNum??s??null,Or=Ur==null?null:qr(Number(Ur),1,5),Gr={...We.sheet.rowsByStudentId||{}};for(const zr of Object.keys(Gr)){const Qt=Gr[zr],mn=Qt!=null&&Qt.marksByCo&&typeof Qt.marksByCo=="object"?{...Qt.marksByCo}:{};mn[ur]=Ns(mn[ur],ot);const ln={...Qt,marksByCo:mn};Se===jr&&(ln.marksA=Ns(Qt.marksA,ot)),Or!=null&&Se===Or&&(ln.marksB=Ns(Qt.marksB,ot)),Gr[zr]=ln}return{...We,sheet:{...We.sheet,coConfigs:Nt,expCountA:Se===jr?ot:We.sheet.expCountA,expCountB:Se===Or?ot:We.sheet.expCountB,btlA:Se===jr?Nt[ur].btl:We.sheet.btlA,btlB:Se===Or?Nt[ur].btl:We.sheet.btlB,rowsByStudentId:Gr}}})}function pt(Se,$e){const ot=qr(Number($e),0,100);Rt(We=>{if(We.sheet.markManagerLocked)return We;const Nt=_t(We.sheet),ur=String(Se),zt=Nt[ur],Nr=qr(Number((zt==null?void 0:zt.expCount)??Li),0,12);Nt[ur]={enabled:!!((zt==null?void 0:zt.enabled)??!0),expCount:Nr,expMax:ot,btl:Lu((zt==null?void 0:zt.btl)??[],Nr,1)};const jr=qr(Number(We.sheet.coANum??i??1),1,5),Ur=We.sheet.coBNum??s??null,Or=Ur==null?null:qr(Number(Ur),1,5),Gr=Se===jr?ot:qr(Number(We.sheet.expMaxA??ra),0,100),zr=Se===Or?ot:qr(Number(We.sheet.expMaxB??0),0,100),Qt=qr(Number(We.sheet.expCountA??Li),0,12),mn=qr(Number(We.sheet.expCountB??0),0,12),ln={};for(const[_n,wn]of Object.entries(We.sheet.rowsByStudentId||{})){const pn=Ns(wn.marksA,Qt).map(pi=>typeof pi=="number"?qr(pi,0,Gr):""),oi=Ns(wn.marksB,mn).map(pi=>typeof pi=="number"?qr(pi,0,zr):""),Fn=wn!=null&&wn.marksByCo&&typeof wn.marksByCo=="object"?{...wn.marksByCo}:{};Fn[ur]=Ns(Fn[ur],Nr).map(pi=>typeof pi=="number"?qr(pi,0,ot):""),ln[_n]={...wn,marksA:pn,marksB:oi,marksByCo:Fn}}return{...We,sheet:{...We.sheet,coConfigs:Nt,expMaxA:Gr,expMaxB:zr,rowsByStudentId:ln}}})}function yt(Se,$e,ot){Rt(We=>{if(We.sheet.markManagerLocked)return We;const Nt=_t(We.sheet),ur=String(qr(Number(Se),1,5)),zt=Nt[ur],Nr=qr(Number((zt==null?void 0:zt.expCount)??Li),0,12),jr=Lu((zt==null?void 0:zt.btl)??[],Nr,1);$e>=0&&$e<jr.length&&(jr[$e]=ot),Nt[ur]={enabled:!!((zt==null?void 0:zt.enabled)??!1),expCount:Nr,expMax:qr(Number((zt==null?void 0:zt.expMax)??ra),0,100),btl:jr};const Ur=qr(Number(We.sheet.coANum??i??1),1,5),Or=We.sheet.coBNum??s??null,Gr=Or==null?null:qr(Number(Or),1,5);return{...We,sheet:{...We.sheet,coConfigs:Nt,btlA:Se===Ur?jr:We.sheet.btlA,btlB:Se===Gr?jr:We.sheet.btlB}}})}function ft(Se,$e,ot,We){Rt(Nt=>{var oi;const ur=String(Se),zt=(oi=Nt.sheet.rowsByStudentId)==null?void 0:oi[ur];if(!zt||yr&&r!=="model"&&zt.absent)return Nt;if(r==="model"){const Fn=!!zt.absent,pi=Fn?String(zt.absentKind||"AL").toUpperCase():"";if(Fn&&!!!(Fe&&Fn&&(pi==="ML"||pi==="SKL")))return Nt}const Nr=_t(Nt.sheet),jr=String(qr(Number($e),1,5)),Ur=Nr[jr],Or=qr(Number((Ur==null?void 0:Ur.expCount)??0),0,12),Gr=qr(Number((Ur==null?void 0:Ur.expMax)??ra),0,100),zr=zt!=null&&zt.marksByCo&&typeof zt.marksByCo=="object"?{...zt.marksByCo}:{},Qt=Ns(zr[jr],Or),mn=We===""?"":qr(Number(We),0,Gr);ot>=0&&ot<Qt.length&&(Qt[ot]=mn),zr[jr]=Qt;const ln=qr(Number(Nt.sheet.coANum??i??1),1,5),_n=Nt.sheet.coBNum??s??null,wn=_n==null?null:qr(Number(_n),1,5),pn={...zt,marksByCo:zr};return $e===ln&&(pn.marksA=Ns(zt.marksA,Or).map((Fn,pi)=>pi===ot?mn:Fn)),wn!=null&&$e===wn&&(pn.marksB=Ns(zt.marksB,Or).map((Fn,pi)=>pi===ot?mn:Fn)),{...Nt,sheet:{...Nt.sheet,rowsByStudentId:{...Nt.sheet.rowsByStudentId,[ur]:pn}}}})}function he(Se,$e){Rt(ot=>{var Nr;const We=String(Se),Nt=(Nr=ot.sheet.rowsByStudentId)==null?void 0:Nr[We];if(!Nt||!Lt||yr&&r!=="model"&&Nt.absent)return ot;if(r==="model"){const jr=!!Nt.absent,Ur=jr?String(Nt.absentKind||"AL").toUpperCase():"";if(jr&&!!!(Fe&&jr&&(Ur==="ML"||Ur==="SKL")))return ot}if(Yr)return ot;const ur=Tr?qr(Number(ot.sheet.ciaExamMax??Lh),0,100):Lh,zt=$e===""?"":qr(Number($e),0,ur);return{...ot,sheet:{...ot.sheet,rowsByStudentId:{...ot.sheet.rowsByStudentId,[We]:{...Nt,ciaExam:zt}}}}})}function Ne(Se,$e,ot){Rt(We=>{var Or;if(Yr)return We;const Nt=String(Se),ur=(Or=We.sheet.rowsByStudentId)==null?void 0:Or[Nt];if(!ur||yr&&r!=="model"&&ur.absent)return We;if(r==="model"){const Gr=!!ur.absent,zr=Gr?String(ur.absentKind||"AL").toUpperCase():"";if(Gr&&!!!(Fe&&Gr&&(zr==="ML"||zr==="SKL")))return We}const zt=String(qr(Number($e),1,5)),Nr=Number(vp[Number(zt)]||0),jr=ot===""?"":Hb(Number(ot),0,Nr>0?Nr:0),Ur={...Kb(ur==null?void 0:ur.caaExamByCo),[zt]:jr};return{...We,sheet:{...We.sheet,rowsByStudentId:{...We.sheet.rowsByStudentId,[Nt]:{...ur,caaExamByCo:Ur}}}}})}function Xe(Se,$e,ot){Rt(We=>{var Or;if(!Yr)return We;const Nt=String(Se),ur=(Or=We.sheet.rowsByStudentId)==null?void 0:Or[Nt];if(!ur||!Lt||!Ht||yr&&r!=="model"&&ur.absent)return We;if(r==="model"){const Gr=!!ur.absent,zr=Gr?String(ur.absentKind||"AL").toUpperCase():"";if(Gr&&!!!(Fe&&Gr&&(zr==="ML"||zr==="SKL")))return We}const zt=String(qr(Number($e),1,5)),Nr=Number(Sd[Number(zt)]||0);if(Nr<=0)return We;const jr=ot===""?"":Hb(Number(ot),0,Nr),Ur={...Fj(ur==null?void 0:ur.ciaExamByCo),[zt]:jr};return{...We,sheet:{...We.sheet,rowsByStudentId:{...We.sheet.rowsByStudentId,[Nt]:{...ur,ciaExamByCo:Ur}}}}})}async function At(){if(e){B(!0);try{await Fi(r,String(e),vt),P(new Date().toLocaleString())}catch(Se){alert((Se==null?void 0:Se.message)||"Draft save failed")}finally{B(!1)}}}const Lr=Jr.useRef(vt);Lr.current=vt,x.useEffect(()=>{const Se=()=>{!e||Sr||Fi(r,String(e),Lr.current).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Se),()=>window.removeEventListener("obe:before-tab-switch",Se)},[e,r,Sr]);async function xr(){if(!e||!window.confirm(`Reset all marks for ${n}? This clears the draft for all students.`))return;const $e=qr(Number(vt.sheet.expCountA??Li),0,12),ot=qr(Number(vt.sheet.expCountB??0),0,12),We={};for(const ur of b)We[String(ur.id)]={studentId:ur.id,absent:!1,absentKind:void 0,marksA:Array.from({length:$e},()=>""),marksB:Array.from({length:ot},()=>""),marksByCo:{},caaExamByCo:{},ciaExamByCo:{},ciaExam:""};const Nt={sheet:{...vt.sheet,btlA:Array.from({length:$e},()=>1),btlB:Array.from({length:ot},()=>1),rowsByStudentId:We}};Rt(Nt);try{fn&&Gn(fn,{rowsByStudentId:{}})}catch{}try{await Fi(r,String(e),Nt),P(new Date().toLocaleString())}catch{}}async function $r(){if(!e)return;if(Wt){alert("Publishing is locked by IQAC.");return}if(!dn){alert("Publish window is closed. Please request IQAC approval.");return}if(ue&&Qe&&!g){if(Re){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ee(!0);return}de(!0);const Se=W,$e=Er,ot={markEntryUnblockedUntil:J,markManagerUnlockedUntil:fe};try{console.debug("publish called",{assessment:r,subjectId:e,entryOpen:wt,publishAllowed:dn,globalLocked:Wt}),V(new Date().toLocaleString()),se(ot),await _N(r,String(e),vt,t),console.debug("publish succeeded",{assessment:r,subjectId:e}),await Dr(!1),tt(),kt({silent:!0});try{console.debug("obe:published dispatch",{assessment:r,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:r}}))}catch{}}catch(We){V(Se),se($e),alert((We==null?void 0:We.message)||"Publish failed")}finally{de(!1)}}async function Dr(Se){if(e){Se&&me(!0),je(null);try{const $e=await Ks(r,String(e),t),ot=($e==null?void 0:$e.data)??null;ot&&typeof ot=="object"&&U(ot)}catch($e){Se&&je(($e==null?void 0:$e.message)||"Failed to load published marks")}finally{Se&&me(!1)}}}x.useEffect(()=>{if(e){if(!(st!=null&&st.exists)||!(st!=null&&st.is_published)){U(null);return}Dr(!1)}},[e,r,st==null?void 0:st.exists,st==null?void 0:st.is_published]);const cn=Jr.useRef(null);x.useEffect(()=>{if(!e||!ue)return;if(!wt){cn.current=!1;return}const Se=cn.current;if(cn.current=!0,Se===!0)return;let $e=!0;return(async()=>{var ot;try{const We=await ei(r,String(e),t),Nt=(We==null?void 0:We.draft)??null;if(!$e)return;if(Nt&&typeof Nt=="object"&&Nt.sheet){const ur=(ot=Nt.sheet)==null?void 0:ot.rowsByStudentId;if(ur&&Object.values(ur).some(Nr=>{var jr,Ur;return((jr=Nr==null?void 0:Nr.marksA)==null?void 0:jr.some(Or=>Or!==""&&Or!=null))||((Ur=Nr==null?void 0:Nr.marksB)==null?void 0:Ur.some(Or=>Or!==""&&Or!=null))||(Nr==null?void 0:Nr.ciaExam)!==""&&(Nr==null?void 0:Nr.ciaExam)!=null})){Rt(Nt),H.current=!0;return}}}catch{}$e&&ie&&ie.sheet&&(Rt(ie),H.current=!0)})(),()=>{$e=!1}},[wt,ue,e,r,ie,t]),x.useEffect(()=>{if(!e||!ue||wt)return;const Se=window.setInterval(()=>{kt({silent:!0});try{tr==null||tr({silent:!0})}catch{}},3e4);return()=>window.clearInterval(Se)},[wt,ue,e,kt,tr]),x.useEffect(()=>{se(null)},[e]);async function hn(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}const $e=String(q||"").trim();if(!$e){alert("Reason is required.");return}if(Re){alert("Edit request is already pending. Please wait.");return}F(!0);const ot=new Date,We=ar!=null&&ar.approval_until?String(ar.approval_until):null;try{const Nt=await sl({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",reason:$e,teaching_assignment_id:t});alert(ol(Nt)),ee(!1),O(""),Gt(Date.now()+24*60*60*1e3);try{qt({silent:!0})}catch{}const ur=Number(Nt==null?void 0:Nt.id),zt=ot.getTime()-2e3;(async()=>{for(let Ur=0;Ur<36;Ur++){try{const Or=await Rm({assessment:r,subject_code:String(e),scope:"MARK_ENTRY",teaching_assignment_id:t}),Gr=Or==null?void 0:Or.result;if(!Gr)throw new Error("No status");if(Number.isFinite(ur)&&ur>0&&Number(Gr.id)!==ur)throw new Error("Different request");const zr=Gr.reviewed_at?new Date(String(Gr.reviewed_at)).getTime():0,Qt=String(Gr.status||"").toUpperCase();if(Qt==="APPROVED"&&zr>=zt){try{kt({silent:!0}),tr==null||tr({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}if(Qt==="REJECTED"&&zr>=zt){alert("IQAC rejected the edit request.");return}}catch{try{const Or=await l1(r,String(e),"MARK_ENTRY",t),Gr=Or!=null&&Or.approval_until?String(Or.approval_until):null;if(Or!=null&&Or.allowed_by_approval&&Gr&&Gr!==We){try{kt({silent:!0}),tr==null||tr({silent:!0})}catch{}alert("IQAC approved the edit request. You can now edit marks.");return}}catch{}}await new Promise(Or=>setTimeout(Or,5e3))}alert("Edit request still pending. Please try again later.")})()}catch(Nt){const ur=ll(Nt,"Request failed");alert(`Edit request failed: ${ur}`)}finally{F(!1)}}x.useEffect(()=>{C&&e&&(U(null),Dr(!0))},[C,e,r]);const yn=x.useMemo(()=>{if(Ze===0)return[];const Se=new Set;for(const $e of gr)for(let ot=0;ot<$e.expCount;ot++){const We=$e.btl[ot];(We===1||We===2||We===3||We===4||We===5||We===6)&&Se.add(We)}return[1,2,3,4,5,6].filter($e=>Se.has($e))},[gr,Ze]),sn=3+(yr?1:0)+Kt+1+$t+Vt+yn.length*2,ir={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Qr={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},vn={width:"100%",border:"none",outline:"none",background:"transparent",fontSize:11,textAlign:"center"},Kn={border:"1px solid #e5e7eb",borderRadius:12,background:"#fff",padding:12},Bn=40,ri=90,on=180,Un=56,L=52,le=72,Oe=80,dt=x.useMemo(()=>[...Array.from({length:Kt},()=>Oe),L,...$t>0?Array.from({length:$t},()=>Oe):[],...Array.from({length:Vt+yn.length*2},()=>Oe)],[Kt,$t,Vt,yn.length]),rt=x.useMemo(()=>{const Se=Bn+ri+on+(yr?Un:0),$e=dt.reduce((ot,We)=>ot+We,0);return Math.max(900,Se+$e)},[yr,dt]),Mt=x.useMemo(()=>{const Se=Bn+ri+on,$e=dt.reduce((ot,We)=>ot+We,0);return Math.max(900,Se+$e)},[dt]),lr=(Se,$e)=>({position:"sticky",left:Se,zIndex:40,...$e!=null?{width:$e,minWidth:$e,maxWidth:$e}:null,background:ir.background}),en=(Se,$e)=>({position:"sticky",left:Se,zIndex:25,...$e!=null?{width:$e,minWidth:$e,maxWidth:$e}:null,background:"#fff"});function bn(Se,$e,ot){const We=3+($e?1:0),Nt=Math.max(0,Se-We);return a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:Bn}}),a.jsx("col",{style:{width:ri}}),a.jsx("col",{style:{width:on}}),$e?a.jsx("col",{style:{width:Un}}):null,Array.from({length:Nt}).map((ur,zt)=>{const Nr=(ot==null?void 0:ot[zt])??Oe;return a.jsx("col",{style:{width:Nr,minWidth:Nr,maxWidth:Nr}},`rest_${zt}`)})]})}const Dn={display:"flex",width:"100%",maxWidth:1200,margin:"0 auto",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:8},zn={width:20,height:20,transform:"scale(1.5)",accentColor:"#9a3412"},hi=ve?"markManagerGlitch 2s ease-in-out":void 0,Ni={position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)",filter:"none"},bi=async()=>{if(!e)return;const Se=b.map(($e,ot)=>{var jr;const We=(jr=vt.sheet.rowsByStudentId)==null?void 0:jr[String($e.id)],Nt=ze(We,gr),ur=at(We,Nt),Nr=!!(yr&&(We!=null&&We.absent)&&!ur.hasAnyMarks)?"ABSENT":ur.finalTotal;return{sno:ot+1,regNo:String($e.reg_no||""),name:String($e.name||""),total:Nr}});await dy({filenameBase:`${String(e)}_${n}`,meta:{courseName:(A==null?void 0:A.courseName)||"",courseCode:(A==null?void 0:A.courseCode)||String(e),className:(A==null?void 0:A.className)||""},rows:Se})};return a.jsxs(og,{children:[a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0% { background: #fff7ed; transform: translateX(0); }
          10% { background: #f3f4f6; transform: translateX(-2px); }
          20% { background: #fff7ed; transform: translateX(2px); }
          30% { background: #f3f4f6; transform: translateX(-1px); }
          40% { background: #fff7ed; transform: translateX(1px); }
          50% { background: #f3f4f6; transform: translateX(0); }
          60% { background: #fff7ed; transform: translateX(-1px); }
          70% { background: #f3f4f6; transform: translateX(1px); }
          80% { background: #fff7ed; transform: translateX(0); }
          90% { background: #f3f4f6; transform: translateX(-1px); }
          100% { background: #f3f4f6; transform: translateX(0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 1; transform: scale(1) rotate(0deg); }
          50% { opacity: 0.8; transform: scale(1.1) rotate(180deg); }
          100% { opacity: 0; transform: scale(0.5) rotate(360deg); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }
      `}),a.jsxs("div",{style:{margin:"0 0 10px 0",maxWidth:"100%",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"COs enabled"}),a.jsxs("div",{style:{...Dn,border:"1px solid #fcd34d",background:ct?"#f3f4f6":"#fff7ed",padding:12,borderRadius:12,alignItems:"stretch",animation:hi,position:"relative",overflow:"hidden"},children:[ve&&a.jsx(a.Fragment,{children:Array.from({length:20},(Se,$e)=>a.jsx("div",{className:"markManagerDustParticle",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*1}s`}},$e))}),a.jsxs("div",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",gap:10,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0},children:[a.jsx(A2,{size:18,color:ct?"#6b7280":"#9a3412"}),a.jsx("div",{style:{fontWeight:950,color:"#111827"},children:"Mark Manager"})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center"},children:a.jsx("button",{onClick:()=>{if(ct){qe({mode:"request"});return}const Se=pr(vt.sheet.markManagerSnapshot??null);if(Se){const $e=Xt(Se),ot=Xt(Ye),We=$e.filter(Nt=>!ot.includes(Nt));if(We.length){const Nt=qr(Number(i??1),1,5),ur=s==null?null:qr(Number(s),1,5),zt=or(vt.sheet.rowsByStudentId,We,Nt,ur);et({visible:!0,removed:We,affected:zt});return}}qe({mode:"confirm"})},className:"obe-btn obe-btn-success",disabled:!e||Pt,style:Pt?{opacity:.6,cursor:"not-allowed"}:void 0,children:ct?"Edit":"Save"})})]}),a.jsxs("div",{style:{width:"100%",display:"flex",gap:10,flexWrap:"wrap",marginTop:8},children:[an.map(Se=>{const $e=Ye[String(Se)],ot=!!($e!=null&&$e.enabled);return a.jsxs("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:[a.jsx("input",{type:"checkbox",checked:ot,disabled:ct,onChange:We=>Ut(Se,We.target.checked),style:zn}),"CO-",Se]},Se)}),a.jsx("label",{style:{display:"flex",gap:6,alignItems:"center",fontWeight:800,fontSize:12,color:"#111827"},children:Lt?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"checkbox",checked:Ht,disabled:ct,onChange:Se=>De(Se.target.checked),style:zn}),"CIA Exam"]}):null})]}),a.jsxs("div",{style:{width:"100%",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:10,marginTop:8},children:[Tr&&Lt&&Ht?a.jsxs("div",{style:{width:"100%",minWidth:0,display:"flex",flexDirection:"column",gap:6,padding:"10px 10px",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,fontWeight:950},children:"CIA Exam"}),a.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Max marks"}),a.jsx("input",{type:"number",className:"obe-input",value:fr,onChange:Se=>gt(Number(Se.target.value)),min:0,max:100,disabled:ct})]},"cfg_cia_exam"):null,an.map(Se=>{const $e=Ye[String(Se)];if(!!!($e!=null&&$e.enabled))return null;const We=qr(Number(($e==null?void 0:$e.expCount)??Li),0,12),Nt=qr(Number(($e==null?void 0:$e.expMax)??ra),0,100);return a.jsxs("div",{style:{width:"100%",minWidth:0,display:"flex",flexDirection:"column",gap:6,padding:"10px 10px",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:[a.jsxs("div",{style:{fontSize:12,fontWeight:950},children:["CO-",Se]}),a.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:["No. of ",It.toLowerCase()]}),a.jsx("input",{type:"number",className:"obe-input",value:We,onChange:ur=>Et(Se,Number(ur.target.value)),min:0,max:12,disabled:ct}),a.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"Max marks"}),a.jsx("input",{type:"number",className:"obe-input",value:Nt,onChange:ur=>pt(Se,Number(ur.target.value)),min:0,max:100,disabled:ct})]},`cfg_${Se}`)})]})]}),Ke?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#991b1b"},children:Ke}):null]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:bi,className:"obe-btn obe-btn-secondary",disabled:!e||b.length===0,children:"Download"}),a.jsx("button",{onClick:xr,className:"obe-btn obe-btn-danger",disabled:!e||Sr,title:Sr?"Table locked  confirm Mark Manager to enable actions":void 0,children:"Reset"})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:At,className:"obe-btn obe-btn-success",disabled:M||!e||Sr,title:Sr?"Table locked  confirm Mark Manager to enable actions":void 0,children:M?"Saving":"Save Draft"}),a.jsx("button",{onClick:$r,className:"obe-btn obe-btn-primary",disabled:Ie?!1:!e||oe||Sr||Wt||!dn,title:Sr?"Table locked  confirm Mark Manager to enable actions":dn?Wt?"Publishing locked":"Publish":"Publish window closed",children:Ie?"Request Edit":oe?"Publishing":"Publish"}),E&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",E]}),W&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",W]})]})]}),Ir&&!Wt&&dn&&a.jsxs("div",{style:{fontSize:13,color:"#6b7280",marginBottom:6},children:["Publish window open  due by"," ",a.jsx("strong",{children:Ir.due_at?new Date(Ir.due_at).toLocaleString():""}),Te!=null&&Te>0&&a.jsxs("span",{children:[" (",Math.ceil(Te/60)," min remaining)"]})]}),Wt&&a.jsx("div",{style:{background:"#fffbeb",border:"1px solid #fde68a",color:"#92400e",padding:"10px 14px",borderRadius:10,marginBottom:10,fontWeight:600},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:"Publishing disabled by IQAC"}),a.jsx("button",{className:"obe-btn obe-btn-secondary",style:{padding:"2px 10px",fontSize:12},onClick:()=>tt(),children:"Refresh"})]})}),!Wt&&!dn&&Ir&&a.jsxs("div",{style:{background:"#fff7ed",border:"1px solid #fecaca",color:"#9a3412",padding:"10px 14px",borderRadius:10,marginBottom:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:6},children:[a.jsx("strong",{children:"Publish time is over"}),a.jsxs("div",{style:{display:"flex",gap:6},children:[a.jsx("button",{className:"obe-btn obe-btn-secondary",style:{padding:"2px 10px",fontSize:12},onClick:()=>tt(),children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",style:{padding:"2px 10px",fontSize:12},disabled:ne,onClick:async()=>{if(Q.trim()){re(!0),I(null);try{await jh({assessment:r,subject_code:String(e),reason:Q,teaching_assignment_id:t}),I("Request sent successfully."),K("")}catch(Se){I((Se==null?void 0:Se.message)||"Request failed")}re(!1)}},children:ne?"Sending":"Request Approval"})]})]}),a.jsx("input",{type:"text",placeholder:"Reason for approval",value:Q,onChange:Se=>K(Se.target.value),style:{width:"100%",padding:"4px 8px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13}}),T&&a.jsx("div",{style:{marginTop:4,fontSize:12,color:T.includes("success")?"#065f46":"#991b1b"},children:T})]}),w?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,j?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:j}):null,a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:vt.sheet.termLabel||""})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:vt.sheet.batchLabel||""})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:E||""}),D?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:D})]}):null]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:W||""})]})]}),a.jsx("div",{style:Kn,children:a.jsx(sg,{locked:Wt,children:a.jsxs("div",{className:"obe-table-wrapper",style:{overflowX:"auto",position:"relative",filter:Sr?"grayscale(5%)":void 0,opacity:Sr?.78:1},children:[a.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:rt,tableLayout:"fixed",borderCollapse:"collapse"},children:[bn(sn,yr,dt),a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:ir,colSpan:sn,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...ir,...lr(0,Bn)},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...ir,...lr(Bn,ri)},rowSpan:5,children:"R.No"}),a.jsx("th",{style:{...ir,...lr(Bn+ri,on),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),yr?a.jsx("th",{style:{...ir,...lr(Bn+ri+on,Un)},rowSpan:5,children:"AB"}):null,a.jsx("th",{style:ir,colSpan:Kt,children:It}),a.jsx("th",{style:{...ir,width:L,minWidth:L,maxWidth:L},rowSpan:5,children:"AVG"}),Yr?a.jsx(a.Fragment,{children:Ht&&Ct.length>0?a.jsx("th",{style:ir,colSpan:Ct.length,children:"CIA EXAM"}):null}):Ht?xn?a.jsx("th",{style:ir,colSpan:Math.max(St,1),children:"CIA EXAM"}):a.jsx("th",{style:{...ir,width:le,minWidth:le,maxWidth:le,overflow:"visible",textOverflow:"clip"},rowSpan:5,title:"CIA Exam",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,lineHeight:1.05},children:[a.jsx("div",{style:{whiteSpace:"pre-line"},children:`CIA
EXAM`}),Tr?a.jsx("div",{style:{fontSize:12,fontWeight:900},children:fr}):null]})}):null,a.jsx("th",{style:ir,colSpan:Vt,children:"CO ATTAINMENT"}),yn.length?a.jsx("th",{style:ir,colSpan:yn.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Ze===0?a.jsx("th",{style:ir,children:""}):a.jsx(a.Fragment,{children:gr.map(Se=>Array.from({length:Se.expCount},($e,ot)=>a.jsx("th",{style:ir,children:Se.coNumber},`co_${Se.coNumber}_${ot}`)))}),Yr?a.jsx(a.Fragment,{children:Ht?Ct.map(Se=>a.jsxs("th",{style:ir,children:["CO-",Se.coNumber]},`lab_cia_co_${Se.coNumber}`)):null}):Ht&&xn?St>0?bt.map(Se=>a.jsxs("th",{style:ir,children:["CO-",Se.coNumber]},`caa_co_${Se.coNumber}`)):a.jsx("th",{style:ir,children:""}):null,nt?gr.map(Se=>a.jsxs("th",{style:ir,colSpan:2,children:["CO-",Se.coNumber]},`coatt_${Se.coNumber}`)):a.jsx("th",{style:ir,colSpan:2,children:""}),yn.map(Se=>a.jsxs("th",{style:ir,colSpan:2,children:["BTL-",Se]},`btl_${Se}`))]}),a.jsxs("tr",{children:[Ze===0?a.jsx("th",{style:ir,children:""}):a.jsx(a.Fragment,{children:gr.map(Se=>Array.from({length:Se.expCount},($e,ot)=>a.jsx("th",{style:ir,children:Se.expMax},`max_${Se.coNumber}_${ot}`)))}),Yr?a.jsx(a.Fragment,{children:Ht?Ct.map(Se=>a.jsx("th",{style:ir,children:Sd[Se.coNumber]??0},`lab_cia_max_${Se.coNumber}`)):null}):Ht&&xn?St>0?bt.map(Se=>a.jsx("th",{style:ir,children:vp[Se.coNumber]??0},`caa_max_${Se.coNumber}`)):a.jsx("th",{style:ir,children:""}):null,nt?gr.map(Se=>{const $e=Yr?Rh(Number(Rj[Se.coNumber]||0)+(Ht?Number(Sd[Se.coNumber]||0):0)):(()=>{const ot=Number(Lj[Se.coNumber]||0),We=CM[`co${Se.coNumber}`],Nt=Array.from({length:qr(Number(Se.expCount??0),0,12)}).map(()=>qr(Number(Se.expMax??ra),0,100)),ur=Nt.length?Nt.reduce((Nr,jr)=>Nr+jr,0)/Nt.length:0,zt=cr&&Number.isFinite(Number(We))?Number(We):ur;return xn&&ot>0?ot:Math.round(zt+(Ht?fr/2:0)||0)})();return a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:ir,children:$e}),a.jsx("th",{style:ir,children:"%"})]},`comax_${Se.coNumber}`)}):a.jsxs(a.Fragment,{children:[a.jsx("th",{style:ir,children:""}),a.jsx("th",{style:ir,children:"%"})]}),yn.map(Se=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:ir,children:Dt||ra}),a.jsx("th",{style:ir,children:"%"})]},`btlmax_${Se}`))]}),a.jsxs("tr",{children:[Ze===0?a.jsxs("th",{style:ir,children:["No ",It.toLowerCase()]}):a.jsx(a.Fragment,{children:gr.map(Se=>Array.from({length:Se.expCount},($e,ot)=>a.jsxs("th",{style:ir,children:[ht,ot+1]},`e_${Se.coNumber}_${ot}`)))}),a.jsx("th",{style:ir,colSpan:Vt+yn.length*2+$t})]}),a.jsxs("tr",{children:[Ze===0?a.jsx("th",{style:ir,children:"BTL"}):a.jsx(a.Fragment,{children:gr.map(Se=>Array.from({length:Se.expCount},($e,ot)=>a.jsx("th",{style:ir,children:(()=>{var zt;const We=((zt=Se.btl)==null?void 0:zt[ot])??1,Nt=We===""?"-":String(We);return!g&&!Sr&&!Qe&&!Wt?a.jsxs("select",{"aria-label":`BTL for ${Ue} ${ot+1} (CO-${Se.coNumber})`,value:We,onChange:Nr=>{const jr=Nr.target.value,Ur=jr===""?"":Number(jr);yt(Se.coNumber,ot,Ur)},style:{width:"100%",minWidth:44,padding:"4px 2px",fontWeight:800,fontSize:11,textAlign:"center",border:"1px solid #d1d5db",borderRadius:4,background:"#fff",cursor:"pointer"},children:[a.jsx("option",{value:"",children:"-"}),[1,2,3,4,5,6].map(Nr=>a.jsx("option",{value:Nr,children:Nr},Nr))]}):a.jsx("span",{style:{fontWeight:800},children:Nt})})()},`btl_${Se.coNumber}_${ot}`)))}),a.jsx("th",{style:ir,colSpan:Vt+yn.length*2+$t})]})]}),a.jsxs("tbody",{children:[(!Sr&&!Qe?b:[]).map((Se,$e)=>{var Gr,zr;const ot=(Gr=vt.sheet.rowsByStudentId)==null?void 0:Gr[String(Se.id)],We=ze(ot,gr),Nt=We.flatMap(Qt=>Qt.marks),ur=Vb(Nt),zt=at(ot,We),Nr=nt?zt.coAttainmentValues:[],jr=zt.caaByCo,Ur=zt.ciaByCo,Or={};for(const Qt of yn){const mn=[];for(const ln of gr){const _n=((zr=We.find(wn=>wn.coNumber===ln.coNumber))==null?void 0:zr.marks)??[];for(let wn=0;wn<Math.min(ln.expCount,_n.length);wn++)if(ln.btl[wn]===Qt){const pn=_n[wn];typeof pn=="number"&&Number.isFinite(pn)&&mn.push(pn)}}Or[Qt]=mn.length?mn.reduce((ln,_n)=>ln+_n,0)/mn.length:null}return a.jsxs("tr",{style:Sr&&$e<3?{position:"relative",zIndex:35,background:"#fff"}:void 0,children:[a.jsx("td",{style:{...Qr,...en(0,Bn),textAlign:"center"},children:$e+1}),a.jsx("td",{style:{...Qr,...en(Bn,ri),textAlign:"center"},title:String(Se.reg_no||""),children:TM(Se.reg_no,7)}),a.jsx("td",{style:{...Qr,...en(Bn+ri,on)},title:String(Se.name||""),children:a.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String(Se.name||"")})}),yr?a.jsx("td",{style:{...Qr,...en(Bn+ri+on,Un),textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:!!(ot!=null&&ot.absent),onChange:Qt=>vr(Se.id,Qt.target.checked),disabled:Sr}),ot!=null&&ot.absent?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:String(ot.absentKind||"AL")}),a.jsxs("select",{"aria-label":"Absent type",value:ot.absentKind||"AL",onChange:Qt=>Je(Se.id,Qt.target.value),disabled:Sr,children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}):null,Ze===0?a.jsx("td",{style:{...Qr,textAlign:"center",color:"#6b7280"},children:""}):gr.map(Qt=>{var ln;const mn=((ln=We.find(_n=>_n.coNumber===Qt.coNumber))==null?void 0:ln.marks)??[];return Array.from({length:Qt.expCount},(_n,wn)=>a.jsx("td",{style:{...Qr,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:mn[wn]??"",onChange:pn=>{const oi=pn.target.value;if(oi==="")return pn.currentTarget.setCustomValidity(""),ft(Se.id,Qt.coNumber,wn,"");const Fn=Number(oi);if(Number.isFinite(Fn)){if(Fn>Qt.expMax){pn.currentTarget.setCustomValidity(`Max mark is ${Qt.expMax}`),pn.currentTarget.reportValidity(),window.setTimeout(()=>pn.currentTarget.setCustomValidity(""),0);return}pn.currentTarget.setCustomValidity(""),ft(Se.id,Qt.coNumber,wn,Fn)}},style:vn,min:0,max:Qt.expMax,disabled:Sr})},`m_${Se.id}_${Qt.coNumber}_${wn}`))}),a.jsx("td",{style:{...Qr,width:L,minWidth:0,textAlign:"right",fontWeight:800},children:ur==null?"":ur.toFixed(1)}),Yr?a.jsx(a.Fragment,{children:Ht?Ct.map(Qt=>{const mn=Number(Sd[Qt.coNumber]||0),ln=Ur[String(Qt.coNumber)]??"";return a.jsx("td",{style:{...Qr,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:ln,onChange:_n=>{const wn=_n.target.value;if(wn==="")return _n.currentTarget.setCustomValidity(""),Xe(Se.id,Qt.coNumber,"");const pn=Number(wn);if(Number.isFinite(pn)){if(pn>mn){_n.currentTarget.setCustomValidity(`Max mark is ${mn}`),_n.currentTarget.reportValidity(),window.setTimeout(()=>_n.currentTarget.setCustomValidity(""),0);return}_n.currentTarget.setCustomValidity(""),Xe(Se.id,Qt.coNumber,pn)}},style:vn,min:0,max:mn,step:.1,disabled:Sr})},`lab_cia_${Se.id}_${Qt.coNumber}`)}):null}):Ht?xn?St>0?bt.map(Qt=>{const mn=Number(vp[Qt.coNumber]||0),ln=jr[String(Qt.coNumber)]??"";return a.jsx("td",{style:{...Qr,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:ln,onChange:_n=>{const wn=_n.target.value;if(wn==="")return _n.currentTarget.setCustomValidity(""),Ne(Se.id,Qt.coNumber,"");const pn=Number(wn);if(Number.isFinite(pn)){if(pn>mn){_n.currentTarget.setCustomValidity(`Max mark is ${mn}`),_n.currentTarget.reportValidity(),window.setTimeout(()=>_n.currentTarget.setCustomValidity(""),0);return}_n.currentTarget.setCustomValidity(""),Ne(Se.id,Qt.coNumber,pn)}},style:vn,min:0,max:mn,disabled:Sr})},`caa_${Se.id}_${Qt.coNumber}`)}):a.jsx("td",{style:{...Qr,textAlign:"center",color:"#6b7280"},children:""}):a.jsx("td",{style:{...Qr,width:le,minWidth:0,padding:"2px 2px",background:"#fff7ed"},children:a.jsx("input",{type:"number",value:(ot==null?void 0:ot.ciaExam)??"",onChange:Qt=>{const mn=Qt.target.value;if(mn==="")return Qt.currentTarget.setCustomValidity(""),he(Se.id,"");const ln=Number(mn);if(Number.isFinite(ln)){if(ln>fr){Qt.currentTarget.setCustomValidity(`Max mark is ${fr}`),Qt.currentTarget.reportValidity(),window.setTimeout(()=>Qt.currentTarget.setCustomValidity(""),0);return}Qt.currentTarget.setCustomValidity(""),he(Se.id,ln)}},style:vn,min:0,max:fr,disabled:Sr})}):null,nt?Nr.map(Qt=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Qr,textAlign:"right"},children:Qt.mark==null?"":Qt.mark.toFixed(1)}),a.jsx("td",{style:{...Qr,textAlign:"right"},children:Gb(Qt.mark,Qt.coMax)})]},`coattrow_${Se.id}_${Qt.coNumber}`)):a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...Qr,textAlign:"right"}}),a.jsx("td",{style:{...Qr,textAlign:"right"}})]}),yn.map(Qt=>{const mn=Or[Qt]??null;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Qr,textAlign:"right"},children:mn==null?"":mn.toFixed(1)}),a.jsx("td",{style:{...Qr,textAlign:"right"},children:Gb(mn,Dt||ra)})]},`btlcell_${Se.id}_${Qt}`)})]},Se.id)}),b.length===0&&a.jsx("tr",{children:a.jsx("td",{colSpan:sn,style:{padding:10,color:"#6b7280"},children:"No students."})})]})]}),Sr&&!Qe&&!g?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(72, 113, 195, 0.92) 0%, rgba(51, 55, 64, 0.96) 100%)"}}):null,Qe&&!g?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"auto",background:"linear-gradient(180deg, rgba(34,197,94,0.28) 0%, rgba(16,185,129,0.36) 100%)"}}):null,Sr&&!Qe&&!g&&!y?a.jsxs("div",{style:Ni,children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{id:"mark-manager-float-gif",src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"gif",style:{maxWidth:72,maxHeight:72,display:"block"},onError:Se=>{console.warn("Failed to load lock GIF:",Se.currentTarget.src),Se.currentTarget.onerror=null,Se.currentTarget.src="data:image/svg+xml;utf8,"+encodeURIComponent('<svg xmlns="https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif" width="72" height="72" viewBox="0 0 24 24" fill="none" stroke="#0f172a" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="10" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>')}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:4}})]}):null,Qe&&!g&&!y?a.jsxs("div",{style:Ni,children:[a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:950,color:"#065f46"},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Table is locked. Request IQAC approval to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>Y(!0),children:"View"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:Re,onClick:async()=>{if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}ee(!0)},children:Re?"Request Pending":"Request Edit"})]}),a.jsx("div",{style:{width:64,height:64,display:"grid",placeItems:"center"},children:a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#065f46",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2",fill:"#d1fae5"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})})]}):null]})})}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280",display:"flex",gap:18,flexWrap:"wrap"},children:[E?a.jsxs("div",{children:["Draft saved: ",E,D?a.jsxs("span",{style:{marginLeft:8,color:"#374151"},children:["by ",a.jsx("strong",{children:D})]}):null]}):null,W?a.jsxs("div",{children:["Last published: ",W]}):null]}),He?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:50},onClick:()=>{Pt||qe(null)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",maxHeight:"90vh",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Se=>Se.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:He.mode==="confirm"?`Confirmation - ${n}`:`Request Edit - ${n}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:r.toUpperCase()})]}),He.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected COs and their settings. After confirming, the Mark Manager box will be locked."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"CO"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:It}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Max marks"})]})}),a.jsxs("tbody",{children:[Object.entries(Ye).filter(([Se,$e])=>it.has(String(Se))&&!!($e!=null&&$e.enabled)).map(([Se,$e])=>({co:qr(Number(Se),1,5),expCount:qr(Number(($e==null?void 0:$e.expCount)??0),0,12),expMax:qr(Number(($e==null?void 0:$e.expMax)??0),0,100)})).sort((Se,$e)=>Se.co-$e.co).map(Se=>a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["CO-",Se.co]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:Se.expCount}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:Se.expMax})]},Se.co)),Object.entries(Ye).filter(([Se,$e])=>it.has(String(Se))&&!!($e!=null&&$e.enabled)).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:3,style:{padding:10,color:"#6b7280"},children:"No COs selected."})}):null,Lt?a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CIA Exam"}),a.jsx("td",{colSpan:2,style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:Ht?"Enabled":"Disabled"})]}):null]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. The Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:Pt,onClick:()=>qe(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Ie?Re:!e||oe||Sr||Wt||!dn,onClick:async()=>{if(!e)return;if(He.mode==="request"){ut(!0),lt(null);try{const $e=ie,ot=Ye;if($e&&$e.sheet&&$e.sheet.coConfigs){const We=xe(_t($e.sheet),ot),Nt=Ee($e.sheet.rowsByStudentId,[...We.removed,...We.changed]);if((We.removed.length||We.changed.length||We.added.length)&&Nt>0){be({visible:!0,diff:We,affected:Nt,mode:"request"}),ut(!1);return}}qe(null),await Le()}finally{ut(!1)}return}const Se=pr(vt.sheet.markManagerSnapshot??null);if(Se){const $e=Xt(Se),ot=Xt(Ye),We=$e.filter(Nt=>!ot.includes(Nt));if(We.length){const Nt=qr(Number(i??1),1,5),ur=s==null?null:qr(Number(s),1,5),zt=or(vt.sheet.rowsByStudentId,We,Nt,ur);et({visible:!0,removed:We,affected:zt});return}}await Be("none")},children:He.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,ce&&ce.visible?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:90},onClick:()=>{Pt||be(null)},children:a.jsxs("div",{style:{width:"min(640px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:Se=>Se.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:8},children:"Mark Manager conflict with published marks"}),a.jsxs("div",{style:{color:"#374151",marginBottom:12},children:["The selected CO settings differ from the published mark sheet. ",ce.affected," student rows contain marks that may be lost."]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Added COs:"})," ",ce.diff.added.join(", ")||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Removed COs:"})," ",ce.diff.removed.join(", ")||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Changed COs:"})," ",ce.diff.changed.join(", ")||""]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>be(null),disabled:Pt,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:Pt,onClick:async()=>{if(e){ut(!0);try{const Se=vt,$e=Object.fromEntries(Object.entries(Se.sheet.rowsByStudentId||{}).map(([We,Nt])=>{var Or;const ur=Nt&&typeof Nt=="object"?Nt:{},zt=qr(Number(Se.sheet.expCountA??Li),0,12),Nr=qr(Number(Se.sheet.expCountB??0),0,12),jr={...ur};jr.marksA=Array.from({length:zt},()=>""),jr.marksB=Array.from({length:Nr},()=>""),jr.caaExamByCo={},jr.ciaExamByCo={},jr.ciaExam="";const Ur=jr.marksByCo&&typeof jr.marksByCo=="object"?{...jr.marksByCo}:{};for(const Gr of[...ce.diff.removed.map(String),...ce.diff.changed.map(String)])Ur[Gr]&&(Ur[Gr]=Array.from({length:((Or=Ye[Gr])==null?void 0:Or.expCount)??0},()=>""));return jr.marksByCo=Ur,[We,jr]})),ot={sheet:{...Se.sheet,rowsByStudentId:$e}};if(Rt(ot),await Fi(r,String(e),ot),P(new Date().toLocaleString()),ce.mode==="request")be(null),qe(null),await Le();else{try{await fh(r,String(e),t),kt({silent:!0})}catch(We){console.warn("confirmMarkManagerLock failed after reset",We)}be(null)}}catch(Se){alert((Se==null?void 0:Se.message)||"Failed to reset marks")}finally{ut(!1)}}},children:"Reset & Continue"})]})]})})}):null,mt&&mt.visible?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:95},onClick:()=>{Pt||et(null)},children:a.jsxs("div",{style:{width:"min(660px, 96vw)",background:"#fff",borderRadius:12,padding:14,border:"1px solid #e5e7eb"},onClick:Se=>Se.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:8},children:mt.removed.length===1?`Shall I reset the CO${mt.removed[0]} column?`:"Shall I reset the removed CO columns?"}),a.jsxs("div",{style:{color:"#374151",marginBottom:10},children:["The new Mark Manager selection removed old COs.",mt.affected>0?` ${mt.affected} student rows contain marks in these columns.`:" No marks were found in these columns."]}),a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:12},children:a.jsxs("div",{children:[a.jsx("strong",{children:"Removed COs:"})," ",mt.removed.join(", ")||""]})}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>et(null),disabled:Pt,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-primary",disabled:Pt,onClick:async()=>{const Se=mt.removed;et(null),await Be("partial",Se)},children:mt.removed.length===1?`Reset CO${mt.removed[0]} column`:"Reset removed CO columns"}),a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:Pt,onClick:async()=>{et(null),await Be("full")},children:"Reset full data"})]})]})})}):null,ae?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{X||ee(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Se=>Se.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[String(r).toUpperCase()," LAB"]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",xt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",n]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Code:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",W||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",E||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:q,onChange:Se=>O(Se.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:X,onClick:()=>ee(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",disabled:X||Re||!e||!String(q||"").trim(),onClick:hn,title:Re?"Request pending (up to 24 hours)":void 0,children:X?"Requesting":Re?"Request Pending":"Send Request"})]})]})})}):null,C?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>Y(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Se=>Se.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10,position:"relative"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280",marginRight:36},children:[n,"  ",String(e||"")]}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:()=>Y(!1),style:{position:"absolute",right:0,top:0},children:"Close"})]}),Z?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,Pe?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:Pe}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,position:"relative"},children:(()=>{const Se=3+Kt+1+$t+Vt+yn.length*2;return a.jsxs("table",{className:"obe-table",style:{width:"100%",minWidth:Mt,tableLayout:"fixed",borderCollapse:"collapse"},children:[bn(Se,!1,dt),a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:ir,colSpan:Se,children:n})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...ir,...lr(0,Bn)},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...ir,...lr(Bn,ri)},rowSpan:5,children:"R.No"}),a.jsx("th",{style:{...ir,...lr(Bn+ri,on),textAlign:"left"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:ir,colSpan:Kt,children:"Experiments"}),a.jsx("th",{style:{...ir,width:L,minWidth:L,maxWidth:L},rowSpan:5,children:"AVG"}),Yr?a.jsx(a.Fragment,{children:Ht&&Ct.length>0?a.jsx("th",{style:ir,colSpan:Ct.length,children:"CIA EXAM"}):null}):Ht?xn?a.jsx("th",{style:ir,colSpan:Math.max(St,1),children:"CIA EXAM"}):a.jsx("th",{style:{...ir,width:le,minWidth:le,maxWidth:le,overflow:"visible",textOverflow:"clip"},rowSpan:5,title:"CIA Exam",children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:2,lineHeight:1.05},children:[a.jsx("div",{style:{whiteSpace:"pre-line"},children:`CIA
EXAM`}),Tr?a.jsx("div",{style:{fontSize:12,fontWeight:900},children:fr}):null]})}):null,a.jsx("th",{style:ir,colSpan:Vt,children:"CO ATTAINMENT"}),yn.length?a.jsx("th",{style:ir,colSpan:yn.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[Ze===0?a.jsx("th",{style:ir,children:""}):a.jsx(a.Fragment,{children:gr.map($e=>Array.from({length:$e.expCount},(ot,We)=>a.jsx("th",{style:ir,children:$e.coNumber},`co_view_${$e.coNumber}_${We}`)))}),Yr?a.jsx(a.Fragment,{children:Ht?Ct.map($e=>a.jsxs("th",{style:ir,children:["CO-",$e.coNumber]},`lab_cia_co_view_${$e.coNumber}`)):null}):Ht&&xn?St>0?bt.map($e=>a.jsxs("th",{style:ir,children:["CO-",$e.coNumber]},`caa_co_view_${$e.coNumber}`)):a.jsx("th",{style:ir,children:""}):null,nt?gr.map($e=>a.jsxs("th",{style:ir,colSpan:2,children:["CO-",$e.coNumber]},`coatt_view_${$e.coNumber}`)):a.jsx("th",{style:ir,colSpan:2,children:""}),yn.map($e=>a.jsxs("th",{style:ir,colSpan:2,children:["BTL-",$e]},`btl_view_${$e}`))]}),a.jsxs("tr",{children:[Ze===0?a.jsx("th",{style:ir,children:""}):a.jsx(a.Fragment,{children:gr.map($e=>Array.from({length:$e.expCount},(ot,We)=>a.jsx("th",{style:ir,children:$e.expMax},`max_view_${$e.coNumber}_${We}`)))}),Yr?a.jsx(a.Fragment,{children:Ht?Ct.map($e=>a.jsx("th",{style:ir,children:Sd[$e.coNumber]??0},`lab_cia_max_view_${$e.coNumber}`)):null}):Ht&&xn?St>0?bt.map($e=>a.jsx("th",{style:ir,children:vp[$e.coNumber]??0},`caa_max_view_${$e.coNumber}`)):a.jsx("th",{style:ir,children:""}):null,nt?gr.map($e=>{const ot=Yr?Rh(Number(Rj[$e.coNumber]||0)+(Ht?Number(Sd[$e.coNumber]||0):0)):(()=>{const We=Number(Lj[$e.coNumber]||0);return xn&&We>0?We:$e.expMax+(Ht?fr/2:0)})();return a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:ir,children:ot}),a.jsx("th",{style:ir,children:"%"})]},`comax_view_${$e.coNumber}`)}):a.jsxs(a.Fragment,{children:[a.jsx("th",{style:ir,children:""}),a.jsx("th",{style:ir,children:"%"})]}),yn.map($e=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:ir,children:Dt||ra}),a.jsx("th",{style:ir,children:"%"})]},`btlmax_view_${$e}`))]}),a.jsxs("tr",{children:[Ze===0?a.jsx("th",{style:ir,children:"No experiments"}):a.jsx(a.Fragment,{children:gr.map($e=>Array.from({length:$e.expCount},(ot,We)=>a.jsxs("th",{style:ir,children:["E",We+1]},`e_view_${$e.coNumber}_${We}`)))}),a.jsx("th",{style:ir,colSpan:Vt+yn.length*2+$t})]}),a.jsxs("tr",{children:[Ze===0?a.jsx("th",{style:ir,children:"BTL"}):a.jsx(a.Fragment,{children:gr.map($e=>Array.from({length:$e.expCount},(ot,We)=>a.jsx("th",{style:ir,children:$e.btl[We]||1},`btlhdr_view_${$e.coNumber}_${We}`)))}),a.jsx("th",{style:ir,colSpan:Vt+yn.length*2+$t})]})]}),a.jsxs("tbody",{children:[b.map(($e,ot)=>{var Qt,mn;const We=ie&&ie.sheet?ie.sheet:vt.sheet,Nt=(Qt=We==null?void 0:We.rowsByStudentId)==null?void 0:Qt[String($e.id)],ur=ze(Nt,gr),zt=ur.flatMap(ln=>ln.marks),Nr=Vb(zt),jr=at(Nt,ur),Ur=nt?jr.coAttainmentValues:[],Or=jr.caaByCo,Gr=jr.ciaByCo,zr={};for(const ln of yn){const _n=[];for(const wn of gr){const pn=((mn=ur.find(oi=>oi.coNumber===wn.coNumber))==null?void 0:mn.marks)??[];for(let oi=0;oi<Math.min(wn.expCount,pn.length);oi++)if(wn.btl[oi]===ln){const Fn=pn[oi];typeof Fn=="number"&&Number.isFinite(Fn)&&_n.push(Fn)}}zr[ln]=_n.length?_n.reduce((wn,pn)=>wn+pn,0)/_n.length:null}return a.jsxs("tr",{children:[a.jsx("td",{style:{...Qr,...en(0,Bn),textAlign:"center"},children:ot+1}),a.jsx("td",{style:{...Qr,...en(Bn,ri)},title:String($e.reg_no||""),children:TM($e.reg_no,7)}),a.jsx("td",{style:{...Qr,...en(Bn+ri,on)},title:String($e.name||""),children:a.jsx("span",{style:{display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:String($e.name||"")})}),Ze===0?a.jsx("td",{style:{...Qr,textAlign:"center",color:"#6b7280"},children:""}):gr.map(ln=>{var wn;const _n=((wn=ur.find(pn=>pn.coNumber===ln.coNumber))==null?void 0:wn.marks)??[];return Array.from({length:ln.expCount},(pn,oi)=>a.jsx("td",{style:{...Qr,width:38,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:_n[oi]??""},`view_m_${$e.id}_${ln.coNumber}_${oi}`))}),a.jsx("td",{style:{...Qr,width:L,minWidth:0,textAlign:"right",fontWeight:800},children:Nr==null?"":Nr.toFixed(1)}),Yr?a.jsx(a.Fragment,{children:Ht?Ct.map(ln=>a.jsx("td",{style:{...Qr,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:Gr[String(ln.coNumber)]??""},`view_lab_cia_${$e.id}_${ln.coNumber}`)):null}):Ht?xn?St>0?bt.map(ln=>a.jsx("td",{style:{...Qr,width:66,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:Or[String(ln.coNumber)]??""},`view_caa_${$e.id}_${ln.coNumber}`)):a.jsx("td",{style:{...Qr,textAlign:"center",color:"#6b7280"},children:""}):a.jsx("td",{style:{...Qr,width:le,minWidth:0,padding:"2px 2px",background:"#fff7ed",textAlign:"center",fontWeight:800},children:(Nt==null?void 0:Nt.ciaExam)??""}):null,nt?Ur.map(ln=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Qr,textAlign:"right"},children:ln.mark==null?"":ln.mark.toFixed(1)}),a.jsx("td",{style:{...Qr,textAlign:"right"},children:Gb(ln.mark,ln.coMax)})]},`view_coatt_${$e.id}_${ln.coNumber}`)):a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...Qr,textAlign:"right"}}),a.jsx("td",{style:{...Qr,textAlign:"right"}})]}),yn.map(ln=>{const _n=zr[ln]??null;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Qr,textAlign:"right"},children:_n==null?"":_n.toFixed(1)}),a.jsx("td",{style:{...Qr,textAlign:"right"},children:Gb(_n,Dt||ra)})]},`view_btl_${$e.id}_${ln}`)})]},`view_${$e.id}`)}),b.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:sn,style:{padding:10,color:"#6b7280"},children:"No students."})}):null]})]})})()}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>Y(!1),children:"Close"})})]})})}):null]})}const Mxe=[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:16},{key:"q8",label:"Q8",max:16},{key:"q9",label:"Q9",max:16}];function Lxe({subjectId:e,classType:t,teachingAssignmentId:r,questionPaperType:n}){const i=x.useMemo(()=>[1,2,3,4,5,6],[]),s=he=>{const Ne=String(he??"AL").trim().toUpperCase();return Ne==="ML"||Ne==="MALPRACTICE"?"ML":Ne==="SKL"||Ne==="SICK"||Ne==="SICKLEAVE"||Ne==="SL"?"SKL":"AL"},o={border:"1px solid #111",padding:"4px 4px",background:"#ecfdf5",color:"#065f46",textAlign:"center",fontWeight:700,fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},l={border:"1px solid #111",padding:"4px 4px",fontSize:11,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},c=32,[u,d]=x.useState([]),[f,p]=x.useState(!1),[h,m]=x.useState(null),[g,y]=x.useState(null),[b,v]=x.useState(!1),[w,S]=x.useState(!1),[j,k]=x.useState(!1),[A,R]=x.useState(null),[M,B]=x.useState(null),[E,P]=x.useState(null),[D,G]=x.useState(null),[H,oe]=x.useState(!1),[de,W]=x.useState(null),V=x.useRef(!1),[ae,ee]=x.useState(!1),C=x.useRef(!1),[Y,q]=x.useState(!1),[O,X]=x.useState(null),[F,Q]=x.useState(null),[K,ne]=x.useState({}),[re,T]=x.useState({}),[I,ie]=x.useState(null),[U,Z]=x.useState(""),[me,Pe]=x.useState(!1),[je,Fe]=x.useState(null),[_e,He]=x.useState(!1),[qe,Pt]=x.useState(""),[ut,Ke]=x.useState(!1),[lt,ve]=x.useState(!1);x.useRef(null);const[Ae,ce]=x.useState(!1),be=x.useMemo(()=>ti(t),[t]),mt=be==="THEORY",et=be==="TCPL"||be==="TCPR",Ue=be==="TCPR"?"TCPR":"TCPL",{data:It,loading:ht,error:Lt,remainingSeconds:yr,publishAllowed:Ar,refresh:Tt}=H0({assessment:"model",subjectCode:e,teachingAssignmentId:r}),{data:Vr,refresh:Br}=V0({assessment:"model",subjectCode:String(e||""),teachingAssignmentId:r,options:{poll:!1}}),{data:Wr,refresh:nn}=lc({assessment:"model",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:r,options:{poll:!1}}),fn=!!E||!!(Vr!=null&&Vr.exists&&(Vr!=null&&Vr.is_published))||!!D,Ir=!!(Wr!=null&&Wr.allowed_by_approval),dn=fn?Ir:!0,Te=!!(fn&&!Ir),tt=!!(fn&&Te),{pending:st,pendingUntilMs:kt,setPendingUntilMs:jt,refresh:ar}=G0({enabled:!!tt&&!!e,assessment:"model",subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:r});K0(!!_e);const tr=!!(It!=null&&It.global_override_active&&(It==null?void 0:It.global_is_open)===!1);x.useEffect(()=>{ve(!1)},[e,r,Te]);const Er=x.useMemo(()=>`model_qp_type_${e}_${String(r??"none")}`,[e,r]),[se,ue]=x.useState("");x.useEffect(()=>{const he=Lr=>{const xr=String(Lr??"").trim().toUpperCase();return xr==="QP2"?"QP2":xr==="QP1"?"QP1":""},Ne=he(n);if(Ne){ue(Ne);try{Gn(Er,Ne)}catch{}return}const Xe=Qn(Er),At=he(Xe);ue(At||"QP1")},[Er,n]);const J=String(se??"").trim().toUpperCase();x.useEffect(()=>{let he=!0;return(async()=>{var xr;let Xe=String(be||"").trim().toUpperCase();if(Xe.startsWith("THEORY")&&(Xe="THEORY"),!Xe){ie(null);return}const At=J==="QP2"?"QP2":J==="QP1"?"QP1":"",Lr=Xe==="THEORY"&&At||null;try{const $r=await sh({class_type:Xe,question_paper_type:Lr,exam:"MODEL"}),Dr=Array.isArray((xr=$r==null?void 0:$r.pattern)==null?void 0:xr.marks)?$r.pattern.marks:[];if(!he)return;ie(Dr.length?$r.pattern:null)}catch{if(!he)return;ie(null)}})(),()=>{he=!1}},[be,J]);const fe=x.useMemo(()=>{const he=Array.isArray(I==null?void 0:I.marks)?I.marks:null;return Array.isArray(he)&&he.length?he.map((Ne,Xe)=>({key:`q${Xe+1}`,label:`Q${Xe+1}`,max:Number(Ne)||0})):Mxe},[I]),ye=4+fe.length+1+4+i.length*2,Ce=et?K||{}:re||{},wt={width:"100%",border:"none",outline:"none",background:"transparent",padding:0,margin:0,fontSize:11,textAlign:"center"},Qe=async he=>{const Ne=!!(he!=null&&he.silent);if(!r){d([]),Ne||m(null);return}Ne||p(!0),Ne||m(null);try{try{const xr=await mr(`/api/academics/teaching-assignments/${r}/`);if(xr.ok){const $r=await xr.json();if($r&&$r.elective_subject_id&&!$r.section_id){const Dr=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String($r.elective_subject_id))}`);if(!Dr.ok)throw new Error(`Elective-choices fetch failed: ${Dr.status}`);const cn=await Dr.json(),sn=((Array.isArray(cn.results)?cn.results:Array.isArray(cn)?cn:cn.items||[])||[]).map(ir=>({id:Number(ir.student_id??ir.id),reg_no:String(ir.reg_no??ir.registration_no??ir.regno??""),name:String(ir.name??ir.full_name??ir.username??""),section:ir.section_name??ir.section??null})).filter(ir=>Number.isFinite(ir.id)).sort((ir,Qr)=>String(ir.name||"").localeCompare(String(Qr.name||"")));d(sn);return}}}catch{}const Xe=await pc(r),Lr=[...(Xe==null?void 0:Xe.students)||[]].sort((xr,$r)=>String(xr.name||"").localeCompare(String($r.name||"")));d(Lr)}catch(Xe){d([]),Ne||m((Xe==null?void 0:Xe.message)||"Failed to load roster")}finally{Ne||p(!1)}};x.useEffect(()=>{Qe()},[r]);const Ie=()=>({version:1,qpType:String(se??""),classType:String(be??""),tcplLikeKind:Ue,theoryQuestionBtl:gr||{},tcplQuestionBtl:Dt||{},theorySheet:re||{},tcplSheet:K||{}}),Re=he=>{if(!he||typeof he!="object")return;C.current=!0;const Ne=typeof he.qpType=="string"?he.qpType:null;if(Ne!=null){const At=String(Ne||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";ue(At);try{Gn(Er,At)}catch{}}if(he.theoryQuestionBtl&&typeof he.theoryQuestionBtl=="object"){Ze({...Sr,...he.theoryQuestionBtl});try{Gn(fr,{...Sr,...he.theoryQuestionBtl})}catch{}}if(he.tcplQuestionBtl&&typeof he.tcplQuestionBtl=="object"){ze({...Vt,...he.tcplQuestionBtl});try{Gn($t,{...Vt,...he.tcplQuestionBtl})}catch{}}if(he.tcplSheet&&typeof he.tcplSheet=="object"){ne(he.tcplSheet);try{Gn(_t,he.tcplSheet)}catch{}}if(he.theorySheet&&typeof he.theorySheet=="object"){T(he.theorySheet);try{Gn(Ft,he.theorySheet)}catch{}}window.setTimeout(()=>{C.current=!1},0)},xt=async he=>{if(!e)return;const Ne=!!(he!=null&&he.silent);Ne||k(!0),Ne||y(null);try{const Xe=await ei("model",e,r);Xe!=null&&Xe.draft&&Re(Xe.draft),R(Xe!=null&&Xe.updated_at?new Date(Xe.updated_at).toLocaleString():null);const At=Xe==null?void 0:Xe.updated_by;B(typeof(At==null?void 0:At.name)=="string"?At.name:typeof(At==null?void 0:At.username)=="string"?At.username:null)}catch(Xe){Ne||y((Xe==null?void 0:Xe.message)||"Failed to refresh draft")}finally{Ne||k(!1)}};x.useEffect(()=>{ee(!1);let he=!0;return(async()=>{try{await xt({silent:!0})}finally{he&&ee(!0)}})(),()=>{he=!1}},[e,r]);const Gt=async()=>{if(e){v(!0),y(null);try{await Fi("model",e,Ie()),R(new Date().toLocaleString())}catch(he){y((he==null?void 0:he.message)||"Draft save failed")}finally{v(!1)}}};x.useEffect(()=>{const he=()=>{!e||Te||Fi("model",e,Ie()).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",he),()=>window.removeEventListener("obe:before-tab-switch",he)},[e,Te]);const qt=async()=>{if(!e)return;if(fn){if(Te){if(st){y("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}He(!0);return}y("Editing is already open for this published sheet.");return}if(tr){y("Publishing is locked by IQAC.");return}if(!Ar){y("Publish window is closed. Please request IQAC approval.");return}if(!u||u.length===0){y("No students loaded - cannot publish");return}let he=null;try{he=Ie()}catch(Ne){y("Failed to build payload: "+((Ne==null?void 0:Ne.message)||String(Ne)));return}if(!he){y("Empty payload - nothing to publish");return}if(window.confirm("Are you sure you want to publish the entered marks? This action will finalize the sheet.")){S(!0),y(null);try{await L9(e,he,r),P(new Date().toLocaleString()),await Rt(!1),Tt({silent:!0}),Br({silent:!0});try{window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:"model"}}))}catch{}alert("Published successfully")}catch(Ne){const Xe=(Ne==null?void 0:Ne.message)||"Publish failed";y(Xe),alert("Publish failed: "+Xe)}finally{S(!1)}}},Wt=async()=>{if(e){Pe(!0),Fe(null),y(null);try{await jh({assessment:"model",subject_code:e,reason:U,teaching_assignment_id:r}),Fe("Request sent to IQAC for approval.")}catch(he){y((he==null?void 0:he.message)||"Failed to request approval")}finally{Pe(!1),Tt({silent:!0})}}},vt=async()=>{if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(st){y("Edit request is pending. Please wait for approval.");return}const Ne=String(qe||"").trim();if(!Ne){y("Reason is required.");return}Ke(!0),y(null);try{const Xe=await sl({assessment:"model",subject_code:String(e),scope:"MARK_ENTRY",reason:Ne,teaching_assignment_id:r});alert(ol(Xe)),He(!1),Pt(""),jt(Date.now()+24*60*60*1e3);try{ar({silent:!0})}catch{}Br({silent:!0}),nn({silent:!0})}catch(Xe){const At=ll(Xe,"Failed to request edit");y(At),alert(`Edit request failed: ${At}`)}finally{Ke(!1)}};async function Rt(he,Ne){if(e){he&&oe(!0),W(null);try{const Xe=await Fm(String(e),r),At=(Xe==null?void 0:Xe.data)??null;!!(At&&typeof At=="object"&&Number(At.version)===1&&(typeof At.classType=="string"||typeof At.qpType=="string")&&("theorySheet"in At||"tcplSheet"in At))?(G(At),(Ne!=null&&Ne.applyToMain||Te)&&Re(At)):(G(null),(he||Ne!=null&&Ne.applyToMain)&&W("No published snapshot found."))}catch(Xe){(he||Ne!=null&&Ne.applyToMain)&&W((Xe==null?void 0:Xe.message)||"Failed to load published sheet")}finally{he&&oe(!1)}}}x.useEffect(()=>{e&&Rt(!1)},[e,r]),x.useEffect(()=>{if(e){if(!Te){V.current=!1;return}if(!V.current){if(V.current=!0,D&&typeof D=="object"){Re(D);return}Rt(!0,{applyToMain:!0})}}},[Te,e,r]),x.useEffect(()=>{if(!e||!fn||dn)return;const he=window.setInterval(()=>{Br({silent:!0})},3e4);return()=>window.clearInterval(he)},[dn,fn,e,Br]);const Zt=x.useMemo(()=>u.length?u:Array.from({length:5},(he,Ne)=>({id:-(Ne+1),reg_no:"",name:"",section:null})),[u]),wr=x.useMemo(()=>Object.values(Ce||{}).some(Ne=>!!(Ne!=null&&Ne.absent)),[Ce]),br=x.useMemo(()=>{const he=Array.isArray(I==null?void 0:I.marks)?I.marks:null;if(Array.isArray(he)&&he.length&&et)return he.map((At,Lr)=>({key:`q${Lr+1}`,label:`Q${Lr+1}`,max:Number(At)||0}));const Ne=Ue==="TCPR"?12:15,Xe=Ue==="TCPR"?8:10;return Array.from({length:Ne},(At,Lr)=>{const xr=Lr+1;return{key:`q${xr}`,label:`Q${xr}`,max:xr<=Xe?2:16}})},[Ue,I,et]),cr=x.useMemo(()=>br.reduce((he,Ne)=>he+Ne.max,0),[br]),Tr=30,Kr=Ue==="TCPR",Yr=5,xn=Kr?0:Tr/Yr,hr=Ue==="TCPR"?"REVIEW":"LAB",nr=x.useMemo(()=>{const he=Array.isArray(I==null?void 0:I.marks)?I.marks:null;return Array.isArray(he)&&he.length&&mt?he.map((Ne,Xe)=>({key:`q${Xe+1}`,label:`Q${Xe+1}`,max:Number(Ne)||0})):[{key:"q1",label:"Q1",max:2},{key:"q2",label:"Q2",max:2},{key:"q3",label:"Q3",max:2},{key:"q4",label:"Q4",max:2},{key:"q5",label:"Q5",max:2},{key:"q6",label:"Q6",max:2},{key:"q7",label:"Q7",max:2},{key:"q8",label:"Q8",max:2},{key:"q9",label:"Q9",max:2},{key:"q10",label:"Q10",max:2},{key:"q11",label:"Q11",max:14},{key:"q12",label:"Q12",max:14},{key:"q13",label:"Q13",max:14},{key:"q14",label:"Q14",max:14},{key:"q15",label:"Q15",max:14},{key:"q16",label:"Q16",max:10}]},[I,mt]),Mr=5,an=x.useMemo(()=>nr.reduce((he,Ne)=>he+Ne.max,0),[nr]),it=x.useMemo(()=>{const he=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],Ne=Array.isArray(I==null?void 0:I.cos)?I.cos:null;return mt&&Array.isArray(Ne)&&Ne.length===nr.length?Ne.map(Xe=>{const At=Number(Xe);return Number.isFinite(At)?Math.max(1,Math.min(5,Math.trunc(At))):1}):nr.length===he.length?he:Array.from({length:nr.length},(Xe,At)=>he[At%he.length])},[I,mt,nr.length]),Ye=x.useMemo(()=>{const he=[2,2,3,3,3,2,2,3,3,3,4,4,3,3,3,5];return nr.length===he.length?he:Array.from({length:nr.length},(Ne,Xe)=>he[Xe%he.length])},[nr.length]),ct=x.useMemo(()=>{const he=Array.from({length:Mr},()=>0);return nr.forEach((Ne,Xe)=>{const At=it[Xe]??1;At>=1&&At<=Mr&&(he[At-1]+=Ne.max)}),he},[nr,it]),Ht=x.useMemo(()=>ct,[ct]),fr=x.useMemo(()=>`model_theory_questionBtl_${e}`,[e]),Sr=x.useMemo(()=>Object.fromEntries(nr.map((he,Ne)=>{const Xe=Ye[Ne];return[he.key,typeof Xe=="number"?Xe:""]})),[nr,Ye]),[gr,Ze]=x.useState(Sr);x.useEffect(()=>{if(!mt)return;const he=Qn(fr);Ze(he&&typeof he=="object"?{...Sr,...he}:Sr)},[mt,fr,Sr]);const Kt=(he,Ne)=>{Ze(Xe=>{const At={...Xe||{},[he]:Ne};return Gn(fr,At),At})},nt=x.useMemo(()=>nr.map((he,Ne)=>{const Xe=(gr||{})[he.key];if(Xe===""||Xe===1||Xe===2||Xe===3||Xe===4||Xe===5||Xe===6)return Xe;const At=Ye[Ne];return typeof At=="number"?At:""}),[nr,gr,Ye]),bt=x.useMemo(()=>{const he=[0,0,0,0,0,0];return nr.forEach((Ne,Xe)=>{const At=nt[Xe];typeof At=="number"&&At>=1&&At<=6&&(he[At-1]+=Ne.max)}),he},[nr,nt]),St=x.useMemo(()=>{const he=Ue==="TCPR"?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5],Ne=Array.isArray(I==null?void 0:I.cos)?I.cos:null;return et&&Array.isArray(Ne)&&Ne.length===br.length?Ne.map(Xe=>{const At=Number(Xe);return Number.isFinite(At)?Math.max(1,Math.min(5,Math.trunc(At))):1}):br.length===he.length?he:Array.from({length:br.length},(Xe,At)=>he[At%he.length])},[I,et,Ue,br.length]),Ct=Ue==="TCPR"?"tcpr":"tcpl",$t=x.useMemo(()=>`model_${Ct}_questionBtl_${e}`,[e,Ct]),Vt=x.useMemo(()=>Object.fromEntries(br.map(he=>[he.key,""])),[br]),[Dt,ze]=x.useState(Vt);x.useEffect(()=>{if(!et)return;const he=Qn($t);ze(he&&typeof he=="object"?{...Vt,...he}:Vt)},[et,$t,Vt]);const at=(he,Ne)=>{ze(Xe=>{const At={...Xe||{},[he]:Ne};return Gn($t,At),At})},_t=x.useMemo(()=>`model_${Ct}_sheet_${e}_${String(r??"none")}`,[e,r,Ct]);x.useEffect(()=>{if(!et)return;const he=Qn(_t);ne(he&&typeof he=="object"?he:{})},[et,_t]);const Ft=x.useMemo(()=>`model_theory_sheet_${e}_${String(r??"none")}`,[e,r]);x.useEffect(()=>{if(et)return;const he=Qn(Ft);T(he&&typeof he=="object"?he:{})},[et,Ft]);const pr=(he,Ne)=>{ne(Xe=>{const At={...Xe||{},[he]:Ne};return Gn(_t,At),At})},or=(he,Ne)=>{T(Xe=>{const At={...Xe||{},[he]:Ne};return Gn(Ft,At),At})};x.useEffect(()=>{if(!ae||!e||Te||C.current)return;let he=!1;const Ne=window.setTimeout(async()=>{try{await Fi("model",e,Ie()),he||R(new Date().toLocaleString())}catch{}},700);return()=>{he=!0,window.clearTimeout(Ne)}},[ae,e,r,Te,se,be,gr,Dt,re,K]);const Xt=(he,Ne)=>{const Xe=String(he??"");if(Xe.trim()==="")return"";const At=Number(Xe);return Number.isFinite(At)?Math.max(0,Math.min(Ne,At)):""},xe=he=>{const Xe=(Math.round((he+Number.EPSILON)*10)/10).toFixed(1);return Xe.endsWith(".0")?Xe.slice(0,-2):Xe},Ee=x.useMemo(()=>{const he=Array.from({length:Yr},()=>0);return br.forEach((Ne,Xe)=>{const At=St[Xe]??1;At>=1&&At<=Yr&&(he[At-1]+=Ne.max)}),he},[br,St,Yr]),De=x.useMemo(()=>Kr?Ee.map((he,Ne)=>Ne===4?Tr:he):Ee.map(he=>he+xn),[Ee,xn,Kr,Tr]),gt=x.useMemo(()=>{const he=[0,0,0,0,0,0];return br.forEach(Ne=>{const Xe=(Dt||{})[Ne.key]??"";typeof Xe=="number"&&Xe>=1&&Xe<=6&&(he[Xe-1]+=Ne.max)}),he},[br,Dt]),vr=x.useMemo(()=>{const he=new Set;return br.forEach(Ne=>{const Xe=(Dt||{})[Ne.key]??"";(Xe===1||Xe===2||Xe===3||Xe===4||Xe===5||Xe===6)&&he.add(Xe)}),he.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(Ne=>he.has(Ne))},[br,Dt]),Je=(he,Ne)=>{const Xe=he==null?void 0:he.id;if(typeof Xe=="number"&&Xe>0)return`id:${Xe}`;const At=String((he==null?void 0:he.reg_no)||"").trim();return At?`reg:${At}`:`idx:${Ne}`},Ut=x.useRef({}),Le=he=>Ne=>{Ut.current[he]=Ne},Be=he=>{const Ne=Ut.current[he];if(Ne){Ne.focus();try{Ne.select()}catch{}}},Et=4+br.length+1+1+Yr*2+vr.length*2,pt=x.useMemo(()=>{const he=new Set;return nr.forEach(Ne=>{const Xe=(gr||{})[Ne.key]??"";(Xe===1||Xe===2||Xe===3||Xe===4||Xe===5||Xe===6)&&he.add(Xe)}),he.size===0?[1,2,3,4,5,6]:[1,2,3,4,5,6].filter(Ne=>he.has(Ne))},[nr,gr]),yt=4+nr.length+1+Mr*2+pt.length*2,ft=x.useMemo(()=>Y?Zt.filter((he,Ne)=>{var At;const Xe=Je(he,Ne);return O&&O.length?O.includes(Xe):!!((At=(Ce||{})[Xe])!=null&&At.absent)}):Zt,[Zt,Y,Ce,O]);return a.jsxs("div",{children:[F?a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(15,23,42,0.45)",display:"flex",alignItems:"center",justifyContent:"center",padding:16,zIndex:50},onClick:()=>Q(null),children:a.jsxs("div",{style:{width:"min(520px, 100%)",background:"#fff",borderRadius:14,border:"1px solid rgba(15,23,42,0.10)",boxShadow:"0 20px 60px rgba(2,6,23,0.25)",padding:14},onClick:he=>he.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:F.title}),a.jsx("div",{style:{fontSize:13,color:"#334155",marginBottom:12},children:F.message}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn",onClick:()=>Q(null),children:"Close"})})]})}):null,a.jsxs("div",{style:{marginBottom:10,color:"#6b7280",fontSize:12},children:["Subject: ",a.jsx("b",{children:e})," | Assessment: ",a.jsx("b",{children:"MODEL"}),be?a.jsxs(a.Fragment,{children:[" ","| Class: ",a.jsx("b",{children:be})]}):null," ","| QP: ",a.jsx("b",{children:J||"QP1"})]}),f?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading roster"}):null,h?a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:h}):null,g?a.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fed7aa",color:"#9a3412",padding:10,borderRadius:10,marginBottom:10,maxWidth:"100%",whiteSpace:"pre-wrap",overflowWrap:"anywhere",wordBreak:"break-word"},children:g}):null,a.jsxs("div",{style:{marginTop:16,marginBottom:16,display:"flex",justifyContent:"flex-start",gap:10,flexWrap:"wrap"},children:[a.jsx("button",{onClick:Gt,className:"obe-btn obe-btn-success",disabled:b||!e||Te,title:Te?"Published sheets are locked (IQAC must open editing).":void 0,children:b?"Saving":"Save Draft"}),a.jsx("button",{onClick:qt,className:"obe-btn obe-btn-primary",disabled:w||u.length===0||!Ar,title:u.length===0?"No students in roster":Ar?void 0:"Publish window is closed.",children:w?"Publishing":"Publish"}),g&&a.jsx("div",{style:{color:"#b91c1c",fontWeight:700,marginLeft:12},children:g}),A&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:["Saved: ",A]}),E&&a.jsxs("div",{style:{fontSize:12,color:"#16a34a",alignSelf:"center"},children:["Published: ",E]}),a.jsx("button",{className:"obe-btn obe-btn-secondary",style:{marginLeft:10},onClick:()=>ve(he=>!he),children:lt?"Minimize":"Expand"})]}),a.jsx("div",{style:{marginBottom:10,fontSize:12,color:Ar?"#065f46":"#b91c1c"},children:ht?"Checking publish due time":Lt||(It!=null&&It.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(It.due_at).toLocaleString(),"  Remaining: ",ag(yr)]}):"Due time not set by IQAC.")}),tr?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>Tt(),disabled:ht,children:"Refresh"})})]}):Ar?null:a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:U,onChange:he=>Z(he.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>Tt(),disabled:me||ht,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Wt,disabled:me||!e,children:me?"Requesting":"Request Approval"})]}),je?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:je}):null]}),a.jsxs("div",{style:{marginBottom:10,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:A||""}),M?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:M})]}):null]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:E||""}),a.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",disabled:!fn||!e,onClick:()=>Rt(!0,{applyToMain:!0}),title:fn?void 0:"Publish first to view the published snapshot.",children:H?"Loading":"View Published"}),a.jsx("button",{className:"obe-btn",onClick:()=>Br(),disabled:!e,children:"Refresh Lock"})]}),de?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:de}):null]})]}),Te?a.jsxs("div",{style:{marginBottom:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Published & locked"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Editing and auto-save are disabled until IQAC opens the edit window."})]}):null,_e?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>He(!1),children:a.jsxs("div",{style:{width:"min(520px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:16,border:"1px solid #e5e7eb",padding:14,boxShadow:"0 12px 30px rgba(0,0,0,0.18)"},onClick:he=>he.stopPropagation(),children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginTop:6,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",kt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:qe,onChange:he=>Pt(he.target.value),placeholder:"Explain why you need to edit (required)",rows:3,className:"obe-input",style:{resize:"vertical"}})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{className:"obe-btn",disabled:ut,onClick:()=>He(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:ut||st||!e||!String(qe||"").trim(),onClick:vt,children:ut?"Sending":st?"Request Pending":"Send Request"})]})]})})}):null,a.jsx(a.Fragment,{children:a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:10},children:a.jsxs("button",{className:"obe-btn",disabled:!wr,onClick:()=>{if(Y)return;const he=(Zt||[]).map((Ne,Xe)=>{var At;return{key:Je(Ne,Xe),isAbsent:!!((At=(Ce||{})[Je(Ne,Xe)])!=null&&At.absent)}}).filter(Ne=>Ne.isAbsent).map(Ne=>Ne.key);X(he),q(!0)},title:wr?"Filter the table to show only absentees":"No absentees marked yet",style:Y?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",Y?a.jsx("span",{onClick:he=>{he.stopPropagation(),q(!1),X(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]})})}),a.jsxs("div",{style:{position:"relative",minHeight:Te&&!lt?220:void 0},children:[fn&&Te?a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"linear-gradient(180deg, rgba(34,197,94,0.18) 0%, rgba(16,185,129,0.24) 100%)"}}):null,fn&&Te?a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,background:"#fff",border:"1px solid #e5e7eb",padding:"10px 14px",borderRadius:999,display:"flex",alignItems:"center",gap:12,boxShadow:"0 6px 18px rgba(17,24,39,0.06)",pointerEvents:"auto",maxWidth:"min(720px, 96vw)"},children:[a.jsx("div",{style:{width:34,height:34,borderRadius:999,display:"grid",placeItems:"center",background:"#fef3c7",border:"1px solid #f59e0b33",color:"#92400e"},"aria-hidden":"true",children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("path",{d:"M7 11V8a5 5 0 0 1 10 0v3",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),a.jsx("path",{d:"M6 11h12a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2Z",stroke:"#92400e",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),a.jsxs("div",{style:{minWidth:0},children:[a.jsx("div",{style:{fontWeight:900,fontSize:18,color:"#111827",lineHeight:1.1},children:"Published  Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginTop:2},children:H?"Loading published marks":de||"Marks are published. IQAC approval is required to edit."})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{className:"obe-btn",disabled:!fn||!e,onClick:async()=>{ve(he=>!he);try{await Rt(!0,{applyToMain:!0})}catch{}},title:fn?void 0:"Publish first to view the published snapshot.",children:H?"Loading":"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:!e||st,onClick:async()=>{if(st){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}He(!0)},title:"Ask IQAC to open editing for published marks",children:st?"Request Pending":"Request Edit"})]})]}):null,a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx("table",{className:"obe-table",style:{width:"max-content",minWidth:"100%",tableLayout:"auto",pointerEvents:Te?"none":void 0,opacity:Te?.78:1,display:Te&&!lt?"none":void 0},children:et?a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:o,colSpan:Et,children:["MODEL (",be||"TCPL"," Header Template)"]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"AB"}),br.map(he=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:he.label},he.key)),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:hr}),a.jsx("th",{style:o,colSpan:Yr*2,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:vr.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:br.length,children:"COS"}),a.jsx("th",{style:o,colSpan:Yr*2,children:""}),a.jsx("th",{style:o,colSpan:vr.length*2,children:""})]}),a.jsxs("tr",{children:[St.map((he,Ne)=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:he},`co-map-${Ne}`)),Array.from({length:Yr}).map((he,Ne)=>a.jsxs("th",{style:o,colSpan:2,children:["CO-",Ne+1]},`co-head-${Ne}`)),vr.map(he=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",he]},`btl-head-${he}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:br.length,children:"BTL"}),a.jsx("th",{style:o,children:""}),a.jsx("th",{style:o,children:""}),Array.from({length:Yr+vr.length}).flatMap((he,Ne)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`mkpct-${Ne}`))]}),a.jsxs("tr",{children:[br.map(he=>{const Ne=(Dt||{})[he.key]??"",Xe=Ne===""?"-":String(Ne);return a.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:a.jsxs("div",{style:{position:"relative",minWidth:40},children:[a.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${Xe}`,children:Xe}),a.jsxs("select",{"aria-label":`BTL for ${he.label}`,value:Ne,onChange:At=>at(he.key,At.target.value===""?"":Number(At.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"}),a.jsx("option",{value:"6",children:"6"})]})]})},`btl-map-${he.key}`)}),a.jsx("th",{style:o,children:""}),a.jsx("th",{style:o,children:""}),Array.from({length:Yr*2+vr.length*2}).map((he,Ne)=>a.jsx("th",{style:o,children:""},`tailblank-${Ne}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:o,children:"S.No"}),a.jsx("th",{style:o,children:"Register No."}),a.jsx("th",{style:o,children:"Name / Max Marks"}),a.jsx("th",{style:o,children:""}),br.map(he=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:he.max},`qmax-${he.key}`)),a.jsx("th",{style:o,children:cr}),a.jsx("th",{style:o,children:"30"}),De.flatMap((he,Ne)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:o,children:xe(he)}),a.jsx("th",{style:o,children:"%"})]},`co-max-mm-${Ne}`)),vr.flatMap(he=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:o,children:xe(gt[he-1]||0)}),a.jsx("th",{style:o,children:"%"})]},`btl-max-mm-${he}`))]})]}),a.jsx("tbody",{children:ft.map((he,Ne)=>a.jsx("tr",{children:(()=>{const Xe=Je(he,Ne),At=(K||{})[Xe]||{},Lr=!!At.absent,xr=At.lab??"",$r=Lr?s(At.absentKind):null,Dr=!!(Y&&Lr&&($r==="ML"||$r==="SKL")),cn=Lr&&$r==="AL"?0:null,hn=Lr&&$r==="ML"?60:Lr&&$r==="SKL"?75:null,yn={};br.forEach(rt=>{const Mt=(At.q||{})[rt.key]??"",lr=typeof Mt=="number"&&Number.isFinite(Mt)?Mt:0;yn[rt.key]=Math.max(0,Math.min(rt.max,lr))});const sn=typeof xr=="number"&&Number.isFinite(xr)?Math.max(0,Math.min(Tr,xr)):0,ir=Object.values(yn).reduce((rt,Mt)=>rt+Mt,0),Qr=Array.from({length:Yr},()=>0);if(br.forEach((rt,Mt)=>{const lr=St[Mt]??1;lr>=1&&lr<=Yr&&(Qr[lr-1]+=yn[rt.key]||0)}),Kr)Qr[4]+=sn;else for(let rt=0;rt<Yr;rt++)Qr[rt]+=sn/Yr;const vn=Qr.map((rt,Mt)=>{const lr=De[Mt]||0;return lr?rt/lr*100:0}),Kn=[0,0,0,0,0,0];br.forEach(rt=>{const Mt=(Dt||{})[rt.key]??"";typeof Mt=="number"&&Mt>=1&&Mt<=6&&(Kn[Mt-1]+=yn[rt.key]||0)});const Bn=Kn.map((rt,Mt)=>{const lr=gt[Mt]||0;return lr?rt/lr*100:0}),ri=rt=>{if(rt){pr(Xe,{...At,absent:!0,absentKind:s(At.absentKind),q:Object.fromEntries(br.map(Mt=>[Mt.key,""])),lab:""});return}pr(Xe,{...At,absent:!1,absentKind:void 0})},on=rt=>{pr(Xe,{...At,absent:!0,absentKind:s(rt)})},Un=rt=>{Lr&&!Dr||pr(Xe,{...At,lab:Xt(rt,Tr)})},L=(rt,Mt,lr)=>{if(Lr&&!Dr)return;const en=Xt(Mt,lr),bn={...At.q||{},[rt]:en};if(hn!=null&&br.reduce((zn,hi)=>{const Ni=bn[hi.key]??"",bi=typeof Ni=="number"&&Number.isFinite(Ni)?Ni:0;return zn+Math.max(0,Math.min(hi.max,bi))},0)>hn){Q({title:"Mark limit exceeded",message:$r==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}pr(Xe,{...At,q:bn})},le=[...br.map(rt=>rt.key),"lab"],Oe=(rt,Mt)=>{const lr=le.indexOf(rt),en=Mt==="left"?Math.max(0,lr-1):Mt==="right"?Math.min(le.length-1,lr+1):lr,bn=Mt==="up"?Math.max(0,Ne-1):Mt==="down"?Math.min(ft.length-1,Ne+1):Ne,zn=`${Je(ft[bn],bn)}|${le[en]}`;Be(zn)},dt=rt=>Mt=>{Mt.key==="Tab"?(Mt.preventDefault(),Oe(rt,Mt.shiftKey?"left":"right")):Mt.key==="ArrowLeft"?(Mt.preventDefault(),Oe(rt,"left")):Mt.key==="ArrowRight"?(Mt.preventDefault(),Oe(rt,"right")):Mt.key==="ArrowUp"||Mt.key==="Enter"&&Mt.shiftKey?(Mt.preventDefault(),Oe(rt,"up")):(Mt.key==="ArrowDown"||Mt.key==="Enter")&&(Mt.preventDefault(),Oe(rt,"down"))};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:Ne+1}),a.jsx("td",{style:l,children:he.reg_no||""}),a.jsx("td",{style:l,children:he.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Lr,onChange:rt=>ri(rt.target.checked)}),Lr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:$r||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:$r||"AL",onChange:rt=>on(s(rt.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),br.map(rt=>{const Mt=(At.q||{})[rt.key]??"",lr=`${Xe}|${rt.key}`;return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:Le(lr),type:"text",inputMode:"decimal",disabled:Lr&&!Dr,value:Mt===""?"":String(Mt),onChange:en=>L(rt.key,en.target.value,rt.max),onFocus:en=>en.currentTarget.select(),onKeyDown:dt(rt.key),style:wt})},`${Ne}-${rt.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:xe(cn??ir)}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:Le(`${Xe}|lab`),type:"text",inputMode:"decimal",disabled:Lr&&!Dr,value:xr===""?"":String(xr),onChange:rt=>Un(rt.target.value),onFocus:rt=>rt.currentTarget.select(),onKeyDown:dt("lab"),style:wt})}),Qr.flatMap((rt,Mt)=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:xe(rt)}),a.jsx("td",{style:{...l,textAlign:"center"},children:xe(vn[Mt])})]},`co-${Ne}-${Mt}`)),vr.flatMap(rt=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:xe(Kn[rt-1]||0)}),a.jsx("td",{style:{...l,textAlign:"center"},children:xe(Bn[rt-1]||0)})]},`btl-${Ne}-${rt}`))]})})()},String(he.id??Ne)))})]}):a.jsx(a.Fragment,{children:mt?a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:o,colSpan:yt,children:"MODEL (THEORY Header Template)"})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:5,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:110,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Register No."}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:5,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:92},rowSpan:5,children:"ABSENT"}),nr.map(he=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:he.label},he.key)),a.jsx("th",{style:{...o,minWidth:56},rowSpan:3,children:"Total"}),a.jsx("th",{style:o,colSpan:Mr*2,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:pt.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:nr.length,children:"COs"}),a.jsx("th",{style:o,colSpan:Mr*2,children:""}),a.jsx("th",{style:o,colSpan:pt.length*2,children:""})]}),a.jsxs("tr",{children:[it.map((he,Ne)=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:he},`theory-co-map-${Ne}`)),Array.from({length:Mr}).map((he,Ne)=>a.jsxs("th",{style:o,colSpan:2,children:["CO-",Ne+1]},`theory-co-head-${Ne}`)),pt.map(he=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",he]},`theory-btl-head-${he}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,fontWeight:800},colSpan:nr.length,children:"BTL"}),a.jsx("th",{style:o,children:""}),Array.from({length:Mr+pt.length}).flatMap((he,Ne)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},`theory-mkpct-${Ne}`))]}),a.jsxs("tr",{children:[nr.map((he,Ne)=>{const Xe=(gr||{})[he.key]??"",At=Xe===""?"-":String(Xe);return a.jsx("th",{style:{...o,width:40,minWidth:40,padding:0},children:a.jsxs("div",{style:{position:"relative",minWidth:40},children:[a.jsx("div",{style:{width:"100%",fontSize:11,padding:"4px 4px",border:"1px solid #d1d5db",borderRadius:8,background:"#fff",textAlign:"center",userSelect:"none",margin:2},title:`BTL: ${At}`,children:At}),a.jsxs("select",{"aria-label":`BTL for ${he.label}`,value:Xe,onChange:Lr=>Kt(he.key,Lr.target.value===""?"":Number(Lr.target.value)),style:{position:"absolute",inset:0,width:"100%",height:"100%",opacity:0,cursor:"pointer",appearance:"none"},children:[a.jsx("option",{value:"",children:"-"}),a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"3",children:"3"}),a.jsx("option",{value:"4",children:"4"}),a.jsx("option",{value:"5",children:"5"}),a.jsx("option",{value:"6",children:"6"})]})]})},`theory-btl-map-${he.key}`)}),a.jsx("th",{style:o,children:""}),Array.from({length:Mr*2+pt.length*2}).map((he,Ne)=>a.jsx("th",{style:o,children:""},`theory-tailblank-${Ne}`))]}),a.jsxs("tr",{children:[a.jsx("th",{style:o,children:"S.No"}),a.jsx("th",{style:o,children:"Register No."}),a.jsx("th",{style:o,children:"Name / Max Marks"}),a.jsx("th",{style:o,children:""}),nr.map(he=>a.jsx("th",{style:{...o,width:40,minWidth:40},children:he.max},`theory-qmax-${he.key}`)),a.jsx("th",{style:o,children:an}),Ht.flatMap((he,Ne)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:o,children:xe(he)}),a.jsx("th",{style:o,children:"%"})]},`theory-co-max-mm-${Ne}`)),pt.flatMap(he=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:o,children:xe(bt[he-1]||0)}),a.jsx("th",{style:o,children:"%"})]},`theory-btl-max-mm-${he}`))]})]}),a.jsx("tbody",{children:ft.map((he,Ne)=>a.jsx("tr",{children:(()=>{const Xe=Je(he,Ne),At=(Ce||{})[Xe]||{},Lr=!!At.absent,xr=Lr?s(At.absentKind):null,$r=!!(Y&&Lr&&(xr==="ML"||xr==="SKL")),Dr=Lr&&xr==="AL"?0:null,cn=Lr&&xr==="ML"?60:Lr&&xr==="SKL"?75:null,hn={};nr.forEach(on=>{const Un=(At.q||{})[on.key]??"",L=typeof Un=="number"&&Number.isFinite(Un)?Un:0;hn[on.key]=Math.max(0,Math.min(on.max,L))});const yn=Object.values(hn).reduce((on,Un)=>on+Un,0),sn=Array.from({length:Mr},()=>0);nr.forEach((on,Un)=>{const L=it[Un]??1;L>=1&&L<=Mr&&(sn[L-1]+=hn[on.key]||0)});const ir=sn.map((on,Un)=>{const L=Ht[Un]||0;return L?on/L*100:0}),Qr=[0,0,0,0,0,0];nr.forEach((on,Un)=>{const L=nt[Un];typeof L=="number"&&L>=1&&L<=6&&(Qr[L-1]+=hn[on.key]||0)});const vn=Qr.map((on,Un)=>{const L=bt[Un]||0;return L?on/L*100:0}),Kn=on=>{if(on){or(Xe,{...At,absent:!0,absentKind:s(At.absentKind),q:Object.fromEntries(nr.map(Un=>[Un.key,""]))});return}or(Xe,{...At,absent:!1,absentKind:void 0})},Bn=on=>{or(Xe,{...At,absent:!0,absentKind:s(on)})},ri=(on,Un,L)=>{if(Lr&&!$r)return;const le=Xt(Un,L),Oe={...At.q||{},[on]:le};if(cn!=null&&nr.reduce((rt,Mt)=>{const lr=Oe[Mt.key]??"",en=typeof lr=="number"&&Number.isFinite(lr)?lr:0;return rt+Math.max(0,Math.min(Mt.max,en))},0)>cn){Q({title:"Mark limit exceeded",message:xr==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}or(Xe,{...At,q:Oe})};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:Ne+1}),a.jsx("td",{style:l,children:he.reg_no||""}),a.jsx("td",{style:l,children:he.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Lr,onChange:on=>Kn(on.target.checked)}),Lr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:xr||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:xr||"AL",onChange:on=>Bn(s(on.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),nr.map(on=>{const Un=(At.q||{})[on.key]??"",L=`${Xe}|${on.key}`,le=nr.map(rt=>rt.key),Oe=(rt,Mt)=>{const lr=Math.max(0,le.indexOf(rt)),en=Mt==="left"?Math.max(0,lr-1):Mt==="right"?Math.min(le.length-1,lr+1):lr,bn=Mt==="up"?Math.max(0,Ne-1):Mt==="down"?Math.min(ft.length-1,Ne+1):Ne,Dn=Je(ft[bn],bn);Be(`${Dn}|${le[en]}`)},dt=rt=>Mt=>{Mt.key==="Tab"?(Mt.preventDefault(),Oe(rt,Mt.shiftKey?"left":"right")):Mt.key==="ArrowLeft"?(Mt.preventDefault(),Oe(rt,"left")):Mt.key==="ArrowRight"?(Mt.preventDefault(),Oe(rt,"right")):Mt.key==="ArrowUp"||Mt.key==="Enter"&&Mt.shiftKey?(Mt.preventDefault(),Oe(rt,"up")):(Mt.key==="ArrowDown"||Mt.key==="Enter")&&(Mt.preventDefault(),Oe(rt,"down"))};return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:Le(L),type:"text",inputMode:"decimal",disabled:Lr&&!$r,value:Un===""?"":String(Un),onChange:rt=>ri(on.key,rt.target.value,on.max),onFocus:rt=>rt.currentTarget.select(),onKeyDown:dt(on.key),style:wt})},`${Ne}-${on.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:xe(Dr??yn)}),sn.flatMap((on,Un)=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:xe(on)}),a.jsx("td",{style:{...l,textAlign:"center"},children:xe(ir[Un])})]},`theory-co-${Ne}-${Un}`)),pt.flatMap(on=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:xe(Qr[on-1]||0)}),a.jsx("td",{style:{...l,textAlign:"center"},children:xe(vn[on-1]||0)})]},`theory-btl-${Ne}-${on}`))]})})()},String(he.id??Ne)))})]}):a.jsxs(a.Fragment,{children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsx("th",{style:o,colSpan:ye,children:"MODEL (Blank Template)"})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...o,width:c,minWidth:c},rowSpan:3,children:"S.No"}),a.jsx("th",{style:{...o,minWidth:70,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"R.No"}),a.jsx("th",{style:{...o,minWidth:240,overflow:"visible",textOverflow:"clip"},rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:{...o,minWidth:32},rowSpan:3,children:"AB"}),a.jsx("th",{style:o,colSpan:fe.length,children:"QUESTIONS"}),a.jsx("th",{style:o,rowSpan:3,children:"Total"}),a.jsx("th",{style:o,colSpan:4,children:"CO ATTAINMENT"}),a.jsx("th",{style:o,colSpan:i.length*2,children:"BTL ATTAINMENT"})]}),a.jsxs("tr",{children:[fe.map(he=>a.jsx("th",{style:{...o,width:46,minWidth:46},children:he.label},he.key)),a.jsx("th",{style:o,colSpan:2,children:"CO-1"}),a.jsx("th",{style:o,colSpan:2,children:"CO-2"}),i.map(he=>a.jsxs("th",{style:o,colSpan:2,children:["BTL-",he]},`btl-head-${he}`))]}),a.jsxs("tr",{children:[fe.map(he=>a.jsx("th",{style:{...o,width:46,minWidth:46},children:he.max},he.key)),Array.from({length:2+i.length}).flatMap((he,Ne)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:{...o,minWidth:52},children:a.jsx("div",{style:{whiteSpace:"pre-line",lineHeight:"0.9",fontSize:"0.7em"},children:`M
A
R
K`})}),a.jsx("th",{style:{...o,minWidth:34},children:"%"})]},Ne))]})]}),a.jsx("tbody",{children:ft.map((he,Ne)=>a.jsxs("tr",{children:[(()=>{const Xe=Je(he,Ne),At=(Ce||{})[Xe]||{},Lr=!!At.absent,xr=Lr?s(At.absentKind):null,$r=!!(Y&&Lr&&(xr==="ML"||xr==="SKL")),Dr=Lr&&xr==="AL"?0:null,cn=Lr&&xr==="ML"?60:Lr&&xr==="SKL"?75:null,hn={};fe.forEach(vn=>{const Kn=(At.q||{})[vn.key]??"",Bn=typeof Kn=="number"&&Number.isFinite(Kn)?Kn:0;hn[vn.key]=Math.max(0,Math.min(vn.max,Bn))});const yn=Object.values(hn).reduce((vn,Kn)=>vn+Kn,0),sn=vn=>{if(vn){or(Xe,{...At,absent:!0,absentKind:s(At.absentKind),q:Object.fromEntries(fe.map(Kn=>[Kn.key,""]))});return}or(Xe,{...At,absent:!1,absentKind:void 0})},ir=vn=>{or(Xe,{...At,absent:!0,absentKind:s(vn)})},Qr=(vn,Kn,Bn)=>{if(Lr&&!$r)return;const ri=Xt(Kn,Bn),on={...At.q||{},[vn]:ri};if(cn!=null&&fe.reduce((L,le)=>{const Oe=on[le.key]??"",dt=typeof Oe=="number"&&Number.isFinite(Oe)?Oe:0;return L+Math.max(0,Math.min(le.max,dt))},0)>cn){Q({title:"Mark limit exceeded",message:xr==="ML"?"For malpractice the total mark assigned is 60":"For Sick leave the Total mark assigned is 75"});return}or(Xe,{...At,q:on})};return a.jsxs(a.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:Ne+1}),a.jsx("td",{style:l,children:he.reg_no||""}),a.jsx("td",{style:l,children:he.name||""}),a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:6},children:[a.jsx("input",{type:"checkbox",checked:Lr,onChange:vn=>sn(vn.target.checked)}),Lr?a.jsxs("div",{className:"obe-ios-select",title:"Absent type",children:[a.jsx("span",{className:"obe-ios-select-value",children:xr||"AL"}),a.jsxs("select",{"aria-label":"Absent type",value:xr||"AL",onChange:vn=>ir(s(vn.target.value)),children:[a.jsx("option",{value:"AL",children:"AL"}),a.jsx("option",{value:"ML",children:"ML"}),a.jsx("option",{value:"SKL",children:"SKL"})]})]}):null]})}),fe.map(vn=>{const Kn=(At.q||{})[vn.key]??"",Bn=`${Xe}|${vn.key}`,ri=fe.map(L=>L.key),on=(L,le)=>{const Oe=Math.max(0,ri.indexOf(L)),dt=le==="left"?Math.max(0,Oe-1):le==="right"?Math.min(ri.length-1,Oe+1):Oe,rt=le==="up"?Math.max(0,Ne-1):le==="down"?Math.min(ft.length-1,Ne+1):Ne,Mt=Je(ft[rt],rt);Be(`${Mt}|${ri[dt]}`)},Un=L=>le=>{le.key==="Tab"?(le.preventDefault(),on(L,le.shiftKey?"left":"right")):le.key==="ArrowLeft"?(le.preventDefault(),on(L,"left")):le.key==="ArrowRight"?(le.preventDefault(),on(L,"right")):le.key==="ArrowUp"||le.key==="Enter"&&le.shiftKey?(le.preventDefault(),on(L,"up")):(le.key==="ArrowDown"||le.key==="Enter")&&(le.preventDefault(),on(L,"down"))};return a.jsx("td",{style:{...l,textAlign:"center"},children:a.jsx("input",{ref:Le(Bn),type:"text",inputMode:"decimal",disabled:Lr&&!$r,value:Kn===""?"":String(Kn),onChange:L=>Qr(vn.key,L.target.value,vn.max),onFocus:L=>L.currentTarget.select(),onKeyDown:Un(vn.key),style:wt})},`${Ne}-${vn.key}`)}),a.jsx("td",{style:{...l,textAlign:"center",fontWeight:700},children:xe(Dr??yn)})]})})(),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""}),i.flatMap(Xe=>a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...l,textAlign:"center"},children:""}),a.jsx("td",{style:{...l,textAlign:"center"},children:""})]},`${Ne}-btl-${Xe}`))]},String(he.id??Ne)))})]})})})})]})]})}function Ij({subjectId:e,teachingAssignmentId:t,assessmentKey:r,viewerMode:n}){const i=r==="cia1"?{label:"CIA 1 Review",coA:1,coB:2}:r==="cia2"?{label:"CIA 2 Review",coA:3,coB:4}:{label:"MODEL Review",coA:5,coB:null};return a.jsx(Dx,{subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:!0,floatPanelOnTable:!0,label:i.label,coA:i.coA,coB:i.coB,initialEnabledCos:[1,2,3,4,5],viewerMode:!!n,itemLabel:"Content",itemLabelPlural:"Content",itemAbbrev:"Con",ciaExamAvailable:!0,absentEnabled:!0,autoSaveDraft:!0})}function Dj({subjectId:e,teachingAssignmentId:t,assessmentKey:r,viewerMode:n,classType:i}){const s=ti(i||"");if(s&&s!=="PROJECT")return a.jsx("div",{style:{color:"#6b7280"},children:"Review mark entry is available only for PROJECT class type courses."});const o=r==="cia1"?{label:"CIA 1 Review",coA:1,coB:2}:r==="cia2"?{label:"CIA 2 Review",coA:3,coB:4}:{label:"MODEL Review",coA:5,coB:null};return a.jsx(Dx,{subjectId:e,teachingAssignmentId:t,assessmentKey:r,skipMarkManager:!0,floatPanelOnTable:!0,label:o.label,coA:o.coA,coB:o.coB,initialEnabledCos:[1,2,3,4,5],viewerMode:!!n,itemLabel:"Content",itemLabelPlural:"Content",itemAbbrev:"Con",ciaExamAvailable:!0,absentEnabled:!0,autoSaveDraft:!0})}function Rxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Q2,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review1",label:r||"Review 1",coA:1,coB:2,allCos:[1,2,3,4,5]})}function Fxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Q2,{subjectId:e,teachingAssignmentId:t,assessmentKey:"review2",label:r||"Review 2",coA:3,coB:4,allCos:[1,2,3,4,5]})}const Bxe=20,PM={co1:10,co2:10},wp={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},Bp=10;function so(e,t,r){return Math.max(t,Math.min(r,e))}function Hl(e){return Math.round(e*10)/10}function xl(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Vv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function Sp(e,t,r){const n=e==null?void 0:e.btlMax,i=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Vv(i);return s??r}function Ixe(e){const t=Number(e);return Number.isFinite(t)&&t>0?t:Bp}function Dxe(e,t){return`${t}_sheet_${e}`}function OM(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function $xe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Uxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function $j(e){return e.slice(-8)}function Gz({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa1"}){var vr,Je,Ut;const i=String(r||"SSA1"),s=n==="review1",o=!1,l=x.useMemo(()=>Dxe(e,n),[e,n]),c=n==="review1"?wS:ig,u=n==="review1"?T9:E9,[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),y=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),b=((vr=d==null?void 0:d.assessments)==null?void 0:vr.ssa1)||{},v=Number.isFinite(Number(b==null?void 0:b.maxTotal))?Number(b.maxTotal):Bxe,w=s?30:v,S={co1:Number.isFinite(Number((Je=b==null?void 0:b.coMax)==null?void 0:Je.co1))?Number(b.coMax.co1):PM.co1,co2:Number.isFinite(Number((Ut=b==null?void 0:b.coMax)==null?void 0:Ut.co2))?Number(b.coMax.co2):PM.co2},j=s?{co1:15,co2:15}:S,k={btl1:Sp(b,1,wp.btl1),btl2:Sp(b,2,wp.btl2),btl3:Sp(b,3,wp.btl3),btl4:Sp(b,4,wp.btl4),btl5:Sp(b,5,wp.btl5),btl6:Sp(b,6,wp.btl6)},A=s?30:Bp,R=x.useRef(null),[M,B]=x.useState(!1);x.useEffect(()=>{let Le=!0;return(async()=>{try{const Be=await oc();if(!Le)return;f(Be||null),g(Et=>({...Et,termLabel:String((Be==null?void 0:Be.termLabel)||Et.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{Le=!1}},[e]);const[E,P]=x.useState(!1),[D,G]=x.useState(null),[H,oe]=x.useState(()=>s?[3,4]:[]),[de,W]=x.useState(!1),[V,ae]=x.useState(!1),[ee,C]=x.useState(null),[Y,q]=x.useState(null),[O,X]=x.useState(null),F=x.useRef(!1),[Q,K]=x.useState(null),[ne,re]=x.useState(!1),[T,I]=x.useState(!1),[ie,U]=x.useState(""),[Z,me]=x.useState(!1),[Pe,je]=x.useState(null),[Fe,_e]=x.useState(null),[He,qe]=x.useState(!1),[Pt,ut]=x.useState(null),[Ke,lt]=x.useState(!1),[ve,Ae]=x.useState(null),{data:ce,loading:be,error:mt,remainingSeconds:et,publishAllowed:Ue,refresh:It}=H0({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:ht,loading:Lt,error:yr,refresh:Ar}=V0({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:Tt}=lc({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!1}}),{data:Vr}=lc({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!1}}),Br=!!(ce!=null&&ce.global_override_active&&(ce==null?void 0:ce.global_is_open)===!1),[Wr,nn]=x.useState(""),[fn,Ir]=x.useState(!1),[dn,Te]=x.useState(null),[tt,st]=x.useState(null),[kt,jt]=x.useState(!1),[ar,tr]=x.useState(null),[Er,se]=x.useState(!1),ue=!!Q||!!(ht!=null&&ht.exists&&(ht!=null&&ht.is_published))||!!Fe;x.useEffect(()=>{if(ht!=null&&ht.is_published&&(ht!=null&&ht.updated_at)&&!Q)try{K(new Date(String(ht.updated_at)).toLocaleString())}catch{K(String(ht.updated_at))}},[ht==null?void 0:ht.is_published,ht==null?void 0:ht.updated_at]);const[J,fe]=x.useState(null);x.useEffect(()=>{fe(null),K(null),_e(null),ut(null),I(!1),U(""),je(null)},[e,n,t]);const ye=!!m.markManagerLocked,Ce=Vr!=null&&Vr.approval_until?String(Vr.approval_until):null,wt=Tt!=null&&Tt.approval_until?String(Tt.approval_until):null,Qe=!!(Vr!=null&&Vr.allowed_by_approval)&&!!Ce&&Ce!==((J==null?void 0:J.markEntryApprovalUntil)??null),Ie=!!(Tt!=null&&Tt.allowed_by_approval)&&!!wt&&wt!==((J==null?void 0:J.markManagerApprovalUntil)??null),Re=ue?!!(ht!=null&&ht.entry_open)||Qe||Ie:!0,xt=!!(ue&&!Re),{pending:Gt,pendingUntilMs:qt,setPendingUntilMs:Wt,refresh:vt}=G0({enabled:!!(ue&&xt)&&!!e,assessment:n,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!T||!!tt||!!ne);const Rt=!!e&&(Lt||!!yr||ht==null),Zt=!!(Br||Rt||(ht?!ht.entry_open:ue?!Re:!ye)),wr=!!(Br||xt||Zt),br=m.markManagerSnapshot!=null,cr=x.useMemo(()=>{const Le=new Set(H);return[1,2,3,4,5,6].filter(Be=>Le.has(Be))},[H]),Tr=x.useMemo(()=>8+cr.length*2,[cr.length,o]),Kr=x.useMemo(()=>{try{return m.rows.some(Le=>!!Le.absent||Object.values(Le).some(Be=>typeof Be=="string"&&String(Be).toLowerCase().includes("absent")))}catch{return!1}},[m.rows]),Yr=x.useMemo(()=>Ke?ve&&ve.length?m.rows.filter(Le=>ve.includes(Number(Le.studentId))):m.rows.filter(Le=>!!Le.absent||Object.values(Le).some(Be=>typeof Be=="string"&&String(Be).toLowerCase().includes("absent"))):m.rows,[m.rows,Ke,ve]);x.useEffect(()=>{if(!e||!F.current)return;try{const Et=`${n}_selected_btls_${e}`;Gn(Et,H)}catch{}let Le=!1;const Be=setTimeout(async()=>{try{await Fi(n,e,{sheet:m,selectedBtls:H});try{l&&Gn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}Le||q(new Date().toLocaleString())}catch{}},700);return()=>{Le=!0,clearTimeout(Be)}},[H,e,m,n,l]),x.useEffect(()=>{if(!e)return;const Le=Qn(l);Le&&typeof Le=="object"&&Array.isArray(Le.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(Le.termLabel||"KRCT AY25-26"),batchLabel:e,rows:Le.rows}):g({termLabel:y||"KRCT AY25-26",batchLabel:e,rows:[]})},[l,e,d,y]),x.useEffect(()=>{let Le=!0;return F.current=!1,(async()=>{if(e){try{const Be=await ei(n,e);if(!Le)return;const Et=Be==null?void 0:Be.draft,pt=Et==null?void 0:Et.sheet,yt=Et==null?void 0:Et.selectedBtls;if(pt&&typeof pt=="object"&&Array.isArray(pt.rows)){g(Ne=>({...Ne,termLabel:String(pt.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:pt.rows,markManagerSnapshot:(pt==null?void 0:pt.markManagerSnapshot)??Ne.markManagerSnapshot??null,markManagerApprovalUntil:(pt==null?void 0:pt.markManagerApprovalUntil)??Ne.markManagerApprovalUntil??null,markManagerLocked:typeof(pt==null?void 0:pt.markManagerLocked)=="boolean"?pt.markManagerLocked:!!((pt==null?void 0:pt.markManagerSnapshot)??Ne.markManagerSnapshot)}));const ft=(Be==null?void 0:Be.updated_at)??null,he=(Be==null?void 0:Be.updated_by)??null;if(ft)try{q(new Date(String(ft)).toLocaleString())}catch{q(String(ft))}he&&X(String(he.name||he.username||he.id||""));try{l&&Gn(l,{termLabel:String(pt.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:pt.rows})}catch{}}if(Array.isArray(yt)){oe(yt.map(ft=>Number(ft)).filter(ft=>Number.isFinite(ft)));try{const ft=`${n}_selected_btls_${e}`;Gn(ft,yt.map(he=>Number(he)).filter(he=>Number.isFinite(he)))}catch{}}}catch{}Le&&(F.current=!0)}})(),()=>{Le=!1}},[e,y,n,l]),x.useEffect(()=>{if(!e)return;if((!!(ht!=null&&ht.exists&&(ht!=null&&ht.is_published))||!!Q)&&(ht!=null&&ht.exists)){const pt=!!(ht!=null&&ht.mark_manager_locked);!!m.markManagerLocked!==pt&&g(yt=>({...yt,markManagerLocked:pt}));return}const Be=!!(Tt!=null&&Tt.allowed_by_approval),Et=Tt!=null&&Tt.approval_until?String(Tt.approval_until):null;if(Be&&Et){if(Et===((J==null?void 0:J.markManagerApprovalUntil)??null))return;const pt=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&pt!==Et&&g(yt=>({...yt,markManagerLocked:!1,markManagerApprovalUntil:Et}));return}},[e,ht==null?void 0:ht.exists,ht==null?void 0:ht.mark_manager_locked,Tt==null?void 0:Tt.allowed_by_approval,Tt==null?void 0:Tt.approval_until,m.markManagerLocked,Q,J==null?void 0:J.markManagerApprovalUntil,m.markManagerApprovalUntil]);const xn=Le=>{g(Be=>{const Et=new Map,pt=new Map;for(const ft of Be.rows||[])typeof ft.studentId=="number"&&Et.set(ft.studentId,ft),ft.registerNo&&pt.set(String(ft.registerNo),ft);const yt=(Le||[]).slice().sort(Uxe).map(ft=>{const he=Et.get(ft.id)||pt.get(String(ft.reg_no||""));return{studentId:ft.id,section:String(ft.section||""),registerNo:String(ft.reg_no||""),name:String(ft.name||""),total:typeof(he==null?void 0:he.total)=="number"?so(Number(he.total),0,w):((he==null?void 0:he.total)==="","")}});return{...Be,rows:yt}})},hr=async()=>{var Le,Be,Et;if(!e){G("Subject ID is required.");return}P(!0),G(null);try{let pt=[],yt=null;try{const ft=await hc();console.log("[SSA1] My TAs:",ft==null?void 0:ft.length,"for subject:",e,"teachingAssignmentId:",t),yt=(ft||[]).find(he=>{const Ne=String(he.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?he.id===t:!1)||Ne}),yt?console.log("[SSA1] Found TA match:",yt.id,"elective_subject_id:",yt.elective_subject_id,"section_id:",yt.section_id):console.log("[SSA1] No TA match found in user TAs")}catch(ft){console.warn("[SSA1] My TAs fetch failed:",ft)}if(yt&&yt.elective_subject_id&&!yt.section_id){console.log("[SSA1] Detected elective, fetching elective-choices for elective_subject_id:",yt.elective_subject_id);try{const ft=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(yt.elective_subject_id))}`);if(ft.ok){const he=await ft.json(),Ne=Array.isArray(he.results)?he.results:Array.isArray(he)?he:he.items||[];console.log("[SSA1] Elective choices returned:",Ne==null?void 0:Ne.length,"students"),pt=(Ne||[]).map(Xe=>({id:Number(Xe.student_id??Xe.id),reg_no:String(Xe.reg_no??Xe.regno??""),name:String(Xe.name??Xe.full_name??Xe.username??""),section:Xe.section_name??Xe.section??null}))}else console.warn("[SSA1] Elective-choices API returned error:",ft.status)}catch(ft){console.warn("[SSA1] Elective-choices fetch failed:",ft)}}if(!pt.length&&yt&&yt.id){console.log("[SSA1] Fetching regular TA roster for TA ID:",yt.id);try{const ft=await pc(yt.id);pt=ft.students||[],h({courseName:String(((Le=ft==null?void 0:ft.teaching_assignment)==null?void 0:Le.subject_name)||(yt==null?void 0:yt.subject_name)||""),courseCode:String(((Be=ft==null?void 0:ft.teaching_assignment)==null?void 0:Be.subject_code)||(yt==null?void 0:yt.subject_code)||e||""),className:String(((Et=ft==null?void 0:ft.teaching_assignment)==null?void 0:Et.section_name)||(yt==null?void 0:yt.section_name)||"")}),console.log("[SSA1] Regular roster returned:",pt.length,"students")}catch(ft){console.warn("[SSA1] TA roster fetch failed:",ft)}}console.log("[SSA1] Final roster count:",pt.length),xn(pt)}catch(pt){G((pt==null?void 0:pt.message)||"Failed to load roster")}finally{P(!1)}};x.useEffect(()=>{e&&hr()},[t,e]);async function nr(Le){if(e){Le&&qe(!0),ut(null);try{const Be=await c(String(e));_e(Be||null)}catch(Be){Le&&ut((Be==null?void 0:Be.message)||`Failed to load published ${i} marks`)}finally{Le&&qe(!1)}}}x.useEffect(()=>{e&&nr(!1)},[e,n,t]);const Mr=x.useRef(null);x.useEffect(()=>{Mr.current=null},[e,n,t]),x.useEffect(()=>{if(!e||!ue)return;if(!Re){Mr.current=!1;return}const Le=Mr.current;if(Mr.current=!0,Le===!0)return;let Be=!0;return(async()=>{try{const Et=await ei(n,String(e));if(!Be)return;const pt=Et==null?void 0:Et.draft,yt=pt==null?void 0:pt.sheet,ft=pt==null?void 0:pt.selectedBtls;if(yt&&typeof yt=="object"&&Array.isArray(yt.rows)&&yt.rows.some(Ne=>(Ne==null?void 0:Ne.total)!==""&&(Ne==null?void 0:Ne.total)!=null)){g(Ne=>({...Ne,termLabel:String(yt.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:yt.rows,markManagerSnapshot:(yt==null?void 0:yt.markManagerSnapshot)??Ne.markManagerSnapshot??null,markManagerApprovalUntil:(yt==null?void 0:yt.markManagerApprovalUntil)??Ne.markManagerApprovalUntil??null,markManagerLocked:typeof(yt==null?void 0:yt.markManagerLocked)=="boolean"?yt.markManagerLocked:!!((yt==null?void 0:yt.markManagerSnapshot)??Ne.markManagerSnapshot)})),Array.isArray(ft)&&oe(ft.map(Ne=>Number(Ne)).filter(Ne=>Number.isFinite(Ne))),F.current=!0;return}}catch{}Be&&nr(!1)})(),()=>{Be=!1}},[Re,ue,e,n,y]),x.useEffect(()=>{if(!e||!ue||Re)return;const Le=window.setInterval(()=>{Ar({silent:!0})},3e4);return()=>window.clearInterval(Le)},[Re,ue,e,Ar]),x.useEffect(()=>{ne&&e&&(_e(null),nr(!0))},[ne,e]);const an=async()=>{W(!0),C(null);try{await Fi(n,e,{sheet:m,selectedBtls:H}),q(new Date().toLocaleString())}catch(Le){C((Le==null?void 0:Le.message)||`Failed to save ${i} draft`)}finally{W(!1)}},it=x.useRef(m);it.current=m;const Ye=x.useRef(H);Ye.current=H,x.useEffect(()=>{const Le=()=>{if(!e||Zt)return;const Be={sheet:it.current,selectedBtls:Ye.current};Fi(n,e,Be).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Le),()=>window.removeEventListener("obe:before-tab-switch",Le)},[e,n,Zt]);const ct=async()=>{if(e){if(Br){C("Publishing is locked by IQAC.");return}if(!Ue){C("Publish window is closed. Please request IQAC approval.");return}ae(!0),C(null);try{await u(e,m,t),K(new Date().toLocaleString()),fe({markEntryApprovalUntil:Ce,markManagerApprovalUntil:wt}),g(Le=>({...Le,markManagerLocked:!0})),It(),Ar({silent:!0}),nr(!1);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}}catch(Le){C((Le==null?void 0:Le.message)||`Failed to publish ${i}`)}finally{ae(!1)}}},Ht=async()=>{Ir(!0),Te(null),C(null);try{await jh({assessment:n,subject_code:e,reason:Wr,teaching_assignment_id:t}),Te("Request sent to IQAC for approval.")}catch(Le){C((Le==null?void 0:Le.message)||"Failed to request approval")}finally{Ir(!1),It()}};function fr(Le){return JSON.stringify({maxTotal:w,coMax:j,selectedBtls:H.slice(),btlMax:k})}async function Sr(){if(e){jt(!0),tr(null);try{const Le=await sl({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${i} ${e}`,teaching_assignment_id:t});alert(ol(Le))}catch(Le){const Be=ll(Le,"Request failed");tr(Be),alert(`Edit request failed: ${Be}`)}finally{jt(!1)}}}async function gr(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(Gt){alert("Edit request is pending. Please wait for approval.");return}const Be=String(ie||"").trim();if(!Be){je("Reason is required.");return}me(!0),je(null);try{const Et=await sl({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:Be,teaching_assignment_id:t});alert(ol(Et)),I(!1),U(""),Wt(Date.now()+24*60*60*1e3);try{vt({silent:!0})}catch{}Ar({silent:!0}),It()}catch(Et){const pt=ll(Et,"Request failed");je(pt),alert(`Edit request failed: ${pt}`)}finally{me(!1)}}async function Ze(){if(e){jt(!0),tr(null);try{const Le=fr(m),Be=Tt!=null&&Tt.approval_until?String(Tt.approval_until):m.markManagerApprovalUntil||null,Et={...m,markManagerLocked:!0,markManagerSnapshot:Le,markManagerApprovalUntil:Be},pt={sheet:Et,selectedBtls:H};g(Et),st(null),se(!0),await Fi(n,String(e),pt),q(new Date().toLocaleString());try{await fh(n,String(e),t),Ar({silent:!0})}catch(yt){console.warn("confirmMarkManagerLock failed",yt)}}catch(Le){tr((Le==null?void 0:Le.message)||"Save failed")}finally{jt(!1),setTimeout(()=>se(!1),2e3)}}}const Kt=()=>{confirm(`Reset ${i} marks for all students in this section?`)&&(Zt||g(Le=>({...Le,rows:(Le.rows||[]).map(Be=>({...Be,total:""}))})))},nt=(Le,Be)=>{g(Et=>{const pt=Et.rows.slice(),yt=pt[Le]||{studentId:0,section:"",registerNo:"",name:"",total:""};return pt[Le]={...yt,...Be},{...Et,rows:pt}})},bt=()=>{const Le=m.rows.map((Be,Et)=>{const pt=typeof Be.total=="number"?so(Number(Be.total),0,w):null,yt=pt==null?"":Hl(pt),he=pt==null?null:Hl(pt/2),Ne=he==null?null:so(he,0,j.co1),Xe=he==null?null:so(he,0,j.co2),At=cr.map(hn=>hn-1),xr=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((hn,yn)=>At.includes(yn)?s?A:hn>0?hn:Bp:hn),$r=pt==null?null:At.length?Hl(pt/At.length):0,Dr=xr.map((hn,yn)=>pt==null||!At.includes(yn)?null:hn>0?so($r,0,hn):Hl($r)),cn={sno:Et+1,registerNo:Be.registerNo,name:Be.name,co1_mark:Ne??"",co1_pct:xl(Ne,j.co1),co2_mark:Xe??"",co2_pct:xl(Xe,j.co2),btl1_mark:Dr[0]??"",btl1_pct:xl(Dr[0],xr[0]),btl2_mark:Dr[1]??"",btl2_pct:xl(Dr[1],xr[1]),btl3_mark:Dr[2]??"",btl3_pct:xl(Dr[2],xr[2]),btl4_mark:Dr[3]??"",btl4_pct:xl(Dr[3],xr[3]),btl5_mark:Dr[4]??"",btl5_pct:xl(Dr[4],xr[4]),btl6_mark:Dr[5]??"",btl6_pct:xl(Dr[5],xr[5])};return cn[i]=yt,cn});$xe(`${e}_${OM(i)||"SSA1"}_sheet.csv`,Le)},St=()=>{if(!m.rows.length)return;const Le=Number.isFinite(Number(j.co1))?Number(j.co1):0,Be=Number.isFinite(Number(j.co2))?Number(j.co2):0,Et=["Register No","Student Name",`Q1 (${Le.toFixed(2)})`,`Q2 (${Be.toFixed(2)})`,"Status"],pt=m.rows.map(Ne=>[Ne.registerNo,Ne.name,"","","present"]),yt=$o.aoa_to_sheet([Et,...pt]);yt["!freeze"]={xSplit:0,ySplit:1};const ft=$o.book_new();$o.book_append_sheet(ft,yt,i||"SSA1");const he=`${e}_${OM(i)||"SSA1"}_template.xlsx`;MS(ft,he)},Ct=async()=>{const Le=m.rows.map((Be,Et)=>({sno:Et+1,regNo:String(Be.registerNo||""),name:String(Be.name||""),total:Be.total===""?"":Number(Be.total)}));await dy({filenameBase:`${e}_${i}`,meta:{courseName:(p==null?void 0:p.courseName)||"",courseCode:(p==null?void 0:p.courseCode)||e,className:(p==null?void 0:p.className)||""},rows:Le})};function $t(Le){return String(Le??"").trim().toLowerCase().replace(/\s+/g," ")}const Vt=()=>{var Le;Zt||(Le=R.current)==null||Le.click()},Dt=async Le=>{var Be;if(Le){B(!0);try{const Et=await Le.arrayBuffer(),pt=Um(Et,{type:"array"}),yt=(Be=pt.SheetNames)==null?void 0:Be[0];if(!yt)throw new Error("No sheet found in the Excel file.");const ft=pt.Sheets[yt],he=$o.sheet_to_json(ft,{header:1});if(!he.length)throw new Error("Excel sheet is empty.");const Ne=(he[0]||[]).map($t),Xe=sn=>Ne.findIndex(ir=>sn(ir)),At=Xe(sn=>sn==="register no"||sn==="reg no"||sn.includes("register")),Lr=Xe(sn=>sn.startsWith("q1")),xr=Xe(sn=>sn.startsWith("q2")),$r=Xe(sn=>sn==="total"||sn.includes("total")),Dr=Xe(sn=>sn==="status"||sn.includes("status"));if(At<0)throw new Error("Could not find Register No column.");const cn=Number.isFinite(Number(j.co1))?Number(j.co1):0,hn=Number.isFinite(Number(j.co2))?Number(j.co2):0,yn=new Map;m.rows.forEach((sn,ir)=>{const Qr=String(sn.registerNo||"").trim();Qr&&yn.set(Qr,ir);const vn=$j(Qr);vn&&yn.set(vn,ir)}),g(sn=>{const ir=sn.rows.slice();for(let Qr=1;Qr<he.length;Qr++){const vn=he[Qr]||[],Kn=String(vn[At]??"").trim();if(!Kn)continue;const Bn=yn.get(Kn);if(Bn==null)continue;const on=(Dr>=0?String(vn[Dr]??""):"").trim().toLowerCase(),Un=on==="absent"||on==="ab"||on==="a",L=Lr>=0?Vv(vn[Lr]):null,le=xr>=0?Vv(vn[xr]):null,Oe=$r>=0?Vv(vn[$r]):null,dt=L==null?0:so(L,0,cn),rt=le==null?0:so(le,0,hn),Mt=Oe??dt+rt,lr=Un?0:so(Mt,0,w);ir[Bn]={...ir[Bn],total:Hl(lr)}}return{...sn,rows:ir}})}finally{B(!1)}}},ze=async Le=>{var Et;const Be=(Et=Le.target.files)==null?void 0:Et[0];if(Le.target.value="",!!Be)try{await Dt(Be)}catch(pt){alert((pt==null?void 0:pt.message)||"Failed to import Excel")}},at={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},_t={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Ft={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},pr={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},or={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},Xt=Le=>{if(Br||kt)return;const Be=m.markManagerSnapshot!=null;ye&&Be||oe(Et=>Et.includes(Le)?Et.filter(pt=>pt!==Le):Et.concat(Le).sort((pt,yt)=>pt-yt))},xe=!!(ue&&xt),Ee=async()=>{if(Gt){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}je(null),I(!0)},De=xe?Ee:ct,gt=xe?Gt:!!(V||!Ue||Zt);return a.jsx(a.Fragment,{children:a.jsxs(og,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:hr,className:"obe-btn obe-btn-secondary",disabled:E,children:E?"Loading roster":"Load/Refresh Roster"}),a.jsx("button",{onClick:Kt,className:"obe-btn obe-btn-danger",disabled:!m.rows.length,children:"Reset Marks"}),a.jsxs("button",{className:"obe-btn obe-btn-secondary",disabled:!Kr,onClick:()=>{if(Ke)return;const Le=m.rows.filter(Be=>!!Be.absent||Object.values(Be).some(Et=>typeof Et=="string"&&String(Et).toLowerCase().includes("absent"))).map(Be=>Number(Be.studentId)).filter(Be=>Number.isFinite(Be));Ae(Le.length?Le:null),lt(!0)},title:Kr?"Filter the table to show only absentees":"No absentees marked yet",style:Ke?{background:"linear-gradient(180deg, #111827, #334155)",color:"#fff",borderColor:"rgba(2,6,23,0.12)"}:void 0,children:["Show absentees list",Ke?a.jsx("span",{onClick:Le=>{Le.stopPropagation(),lt(!1),Ae(null)},role:"button","aria-label":"Close absentees list",title:"Close absentees list",style:{marginLeft:10,display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:999,background:"rgba(255,255,255,0.18)",border:"1px solid rgba(255,255,255,0.25)",fontWeight:900,lineHeight:1,cursor:"pointer",userSelect:"none"},children:""}):null]}),a.jsx("button",{onClick:bt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export CSV"}),a.jsx("button",{onClick:St,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export Excel"}),a.jsx("button",{onClick:Vt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length||Zt||M,children:M?"Importing":"Import Excel"}),a.jsx("input",{ref:R,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:ze})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:Ct,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Download"}),a.jsx("button",{onClick:an,className:"obe-btn obe-btn-success",disabled:de||Zt,title:Zt?"Table locked  confirm Mark Manager to enable actions":void 0,children:de?"Saving":"Save Draft"}),a.jsx("button",{onClick:De,className:"obe-btn obe-btn-primary",disabled:gt,title:Zt?"Table locked  confirm Mark Manager to enable actions":void 0,children:xe?Gt?"Request Pending":"Request Edit":V?"Publishing":"Publish"})]})]}),a.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:or,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),a.jsxs("div",{style:or,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),a.jsxs("div",{style:or,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:Y||""}),O?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:O})]}):null]}),a.jsxs("div",{style:or,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:Q||""})]})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:Ue?"#065f46":"#b91c1c"},children:be?"Checking publish due time":mt||(ce!=null&&ce.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(ce.due_at).toLocaleString(),"  Remaining: ",ag(et),ce.allowed_by_approval&&ce.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(ce.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Br?a.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>It(),disabled:be,children:"Refresh"})})]}):Ue?null:a.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:Wr,onChange:Le=>nn(Le.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>It(),disabled:fn||be,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:Ht,disabled:fn,children:fn?"Requesting":"Request Approval"})]}),dn?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:dn}):null]}),ne?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>re(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Le=>Le.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsxs("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:["View Published ",i]}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i}),a.jsx("button",{onClick:Le=>{Le.stopPropagation(),re(!1)},"aria-label":"Close",style:{marginLeft:8,border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),He?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,Pt?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:Pt}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:at,colSpan:Tr,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...at,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:at,rowSpan:4,children:"Register No."}),a.jsx("th",{style:at,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:at,children:i}),null,a.jsx("th",{style:at,colSpan:4,children:"CO ATTAINMENT"}),cr.length?a.jsx("th",{style:at,colSpan:cr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:at,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,a.jsx("th",{style:at,colSpan:2,children:"CO-1"}),a.jsx("th",{style:at,colSpan:2,children:"CO-2"}),cr.map(Le=>a.jsxs("th",{style:at,colSpan:2,children:["BTL-",Le]},`btl-head-${Le}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:at,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:cr.length?cr.join(","):"-"})]}),null,Array.from({length:2+cr.length}).flatMap((Le,Be)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:at,children:"Mark"}),a.jsx("th",{style:at,children:"%"})]},Be))]}),a.jsxs("tr",{children:[a.jsx("th",{style:at,children:"Name / Max Marks"}),a.jsx("th",{style:at,children:w}),null,a.jsx("th",{style:at,children:j.co1}),a.jsx("th",{style:at,children:"%"}),a.jsx("th",{style:at,children:j.co2}),a.jsx("th",{style:at,children:"%"}),cr.flatMap(Le=>[a.jsx("th",{style:at,children:String(s?A:Math.max(Number(k[`btl${Le}`]??0)||0,Bp))},`btl-max-${Le}`),a.jsx("th",{style:at,children:"%"},`btl-pct-${Le}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Tr,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):Yr.map((Le,Be)=>{var Dr;const Et=((Dr=Fe==null?void 0:Fe.marks)==null?void 0:Dr[String(Le.studentId)])??null,pt=Et==null||Et===""?null:so(Number(Et),0,w),ft=pt==null?null:Hl(pt/2),he=ft==null?null:so(ft,0,j.co1),Ne=ft==null?null:so(ft,0,j.co2),Xe=cr.map(cn=>cn-1),Lr=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((cn,hn)=>Xe.includes(hn)?s?A:cn>0?cn:Bp:cn),xr=pt==null?null:Xe.length?Hl(pt/Xe.length):0,$r=Lr.map((cn,hn)=>pt==null||!Xe.includes(hn)?null:cn>0?so(xr,0,cn):Hl(xr));return a.jsxs("tr",{style:{background:Be%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{..._t,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Be+1}),a.jsx("td",{style:_t,children:$j(Le.registerNo)}),a.jsx("td",{style:_t,children:Le.name}),a.jsx("td",{style:{..._t,width:90,background:"#fff7ed",textAlign:"center"},children:pt==null?"":Hl(pt)}),null,a.jsx("td",{style:{..._t,textAlign:"center"},children:he??""}),a.jsx("td",{style:{..._t,textAlign:"center"},children:xl(he,j.co1)}),a.jsx("td",{style:{..._t,textAlign:"center"},children:Ne??""}),a.jsx("td",{style:{..._t,textAlign:"center"},children:xl(Ne,j.co2)}),cr.map(cn=>{const hn=cn-1,yn=$r[hn],sn=Lr[hn];return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{..._t,textAlign:"center"},children:yn??""}),a.jsx("td",{style:{..._t,textAlign:"center"},children:xl(yn,sn)})]},cn)})]},String(Le.studentId||Be))})})]})}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>re(!1),children:"Close"})})]})})}):null,(D||ee)&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:D||ee}),a.jsxs("div",{style:{marginTop:12,...or},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),a.jsx("div",{children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const Le=m.markManagerSnapshot!=null;st({mode:Le?"request":"confirm"})},disabled:!e||kt,children:m.markManagerSnapshot?"Edit":"Save"})})]}),a.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[a.jsxs("div",{children:["Max ",i,": ",a.jsx("strong",{style:{color:"#111"},children:w})]}),a.jsxs("div",{children:["CO-1 max: ",a.jsx("strong",{style:{color:"#111"},children:j.co1}),"  CO-2 max: ",a.jsx("strong",{style:{color:"#111"},children:j.co2})]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(Le=>{const Be=H.includes(Le),Et=!!(ye&&m.markManagerSnapshot!=null);return a.jsxs("div",{onClick:()=>Xt(Le),style:{...pr,borderColor:Be?"#16a34a":"#cbd5e1",background:Be?"#ecfdf5":"#fff",cursor:Et||kt?"not-allowed":"pointer",opacity:Et?.6:1,padding:"6px 8px"},"aria-disabled":Et||kt,children:[a.jsx("input",{type:"checkbox",checked:Be,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",Le]})]},`card_btl_${Le}`)})})]})]}),ar?a.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:ar}):null]}),a.jsx("div",{style:{marginTop:14},children:br?a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx(sg,{locked:!!(Br||xt||ue&&Rt),title:Br?"Locked by IQAC":xt?"Published  Locked":"Table Locked",subtitle:Br?"Publishing is turned OFF globally for this assessment.":xt?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:at,colSpan:Tr,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{...at,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:at,rowSpan:4,children:"Register No."}),a.jsx("th",{style:at,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:at,children:i}),null,a.jsx("th",{style:at,colSpan:4,children:"CO ATTAINMENT"}),cr.length?a.jsx("th",{style:at,colSpan:cr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:at,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"1,2"})]}),null,a.jsx("th",{style:at,colSpan:2,children:"CO-1"}),a.jsx("th",{style:at,colSpan:2,children:"CO-2"}),cr.map(Le=>a.jsxs("th",{style:at,colSpan:2,children:["BTL-",Le]},`btl-head-${Le}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:at,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:cr.length?cr.join(","):"-"})]}),null,Array.from({length:2+cr.length}).flatMap((Le,Be)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:at,children:"Mark"}),a.jsx("th",{style:at,children:"%"})]},Be))]}),a.jsxs("tr",{children:[a.jsx("th",{style:at,children:"Name / Max Marks"}),a.jsx("th",{style:at,children:w}),null,a.jsx("th",{style:at,children:j.co1}),a.jsx("th",{style:at,children:"%"}),a.jsx("th",{style:at,children:j.co2}),a.jsx("th",{style:at,children:"%"}),cr.flatMap(Le=>[a.jsx("th",{style:at,children:String(s?A:Ixe(k[`btl${Le}`]))},`btl-max-${Le}`),a.jsx("th",{style:at,children:"%"},`btl-pct-${Le}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Tr,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):Zt&&!xt?a.jsx("tr",{children:a.jsx("td",{colSpan:Tr,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):Yr.map((Le,Be)=>{const Et=typeof Le.total=="number"?so(Number(Le.total),0,w):null,pt=Et==null?null:Hl(Et/2),yt=pt==null?null:so(pt,0,j.co1),ft=pt==null?null:so(pt,0,j.co2),he=cr.map(xr=>xr-1),Xe=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((xr,$r)=>he.includes($r)?s?A:xr>0?xr:Bp:xr),At=Et==null?null:he.length?Hl(Et/he.length):0,Lr=Xe.map((xr,$r)=>Et==null||!he.includes($r)?null:xr>0?so(At,0,xr):Hl(At));return a.jsxs("tr",{style:{background:Be%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{..._t,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Be+1}),a.jsx("td",{style:_t,children:$j(Le.registerNo)}),a.jsx("td",{style:_t,children:Le.name}),a.jsx("td",{style:{..._t,width:90,background:"#fff7ed"},children:wr?a.jsx("div",{style:Ft,children:typeof Le.total=="number"?Hl(Le.total):""}):a.jsx("input",{style:Ft,type:"number",value:Le.total,min:0,max:w,onChange:xr=>{if(wr)return;const $r=xr.target.value;if($r==="")return nt(Be,{total:""});const Dr=Number($r);if(!Number.isFinite(Dr))return nt(Be,{total:""});if(Dr>w){xr.currentTarget.setCustomValidity(`Max mark is ${w}`),xr.currentTarget.reportValidity(),window.setTimeout(()=>xr.currentTarget.setCustomValidity(""),0);return}xr.currentTarget.setCustomValidity("");const cn=so(Dr,0,w);nt(Be,{total:cn})}})}),null,a.jsx("td",{style:{..._t,textAlign:"center"},children:yt??""}),a.jsx("td",{style:{..._t,textAlign:"center"},children:xl(yt,j.co1)}),a.jsx("td",{style:{..._t,textAlign:"center"},children:ft??""}),a.jsx("td",{style:{..._t,textAlign:"center"},children:xl(ft,j.co2)}),cr.map(xr=>{const $r=xr-1,Dr=Lr[$r],cn=Xe[$r];return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{..._t,textAlign:"center"},children:Dr??""}),a.jsx("td",{style:{..._t,textAlign:"center"},children:xl(Dr,cn)})]},xr)})]},String(Le.studentId||Be))})})]})})}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:a.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[a.jsx("div",{style:{fontSize:40},children:""}),a.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:xt?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:xt?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:xt?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>re(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Gt,onClick:Ee,children:Gt?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>st({mode:"confirm"}),disabled:!e||kt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Sr(),disabled:kt,children:"Request Access"})]})})]})})}),T?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>{Z||I(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Le=>Le.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsxs("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:[i,"  ",String(e||"")]})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",qt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:ie,onChange:Le=>U(Le.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),Pe?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:Pe}):null,a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:12},children:[a.jsx("button",{className:"obe-btn",disabled:Z,onClick:()=>I(!1),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Z||Gt||!e||!String(ie||"").trim(),onClick:gr,children:Z?"Requesting":Gt?"Request Pending":"Send Request"})]})]})})}):null,a.jsx("style",{children:`
        @keyframes markManagerGlitch {
          0%, 100% { transform: translate(0,0); filter: none; }
          10% { transform: translate(-2px, 1px); }
          20% { transform: translate(2px, -1px); }
          30% { transform: translate(-1px, -2px); }
          40% { transform: translate(1px, 2px); }
          50% { transform: translate(-2px, -1px); }
          60% { transform: translate(2px, 1px); }
          70% { transform: translate(-1px, 1px); }
          80% { transform: translate(1px, -1px); }
          90% { transform: translate(-1px, 0); }
        }
        @keyframes markManagerDust {
          0% { opacity: 0.9; transform: translate(0,0) scale(1); }
          100% { opacity: 0; transform: translate(80px, -40px) scale(0.6); }
        }
        .markManagerDustParticle {
          position: absolute;
          width: 4px;
          height: 4px;
          background: #d1d5db;
          border-radius: 50%;
          animation: markManagerDust 2s ease-out forwards;
        }

        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),a.jsxs("div",{style:{position:"relative"},children:[ye?null:a.jsx("div",{style:{position:"absolute",inset:0,zIndex:30,pointerEvents:"none",background:"rgba(107, 114, 128, 0.15)"}}),!ye&&!xt?a.jsxs("div",{style:{position:"absolute",left:"50%",top:6,transform:"translateX(-50%)",zIndex:40,width:160,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[a.jsx("div",{style:{width:100,height:72,display:"grid",placeItems:"center",background:"#fff",borderRadius:8},children:a.jsx("img",{src:"https://media.lordicon.com/icons/wired/flat/94-lock-unlock.gif",alt:"locked",style:{maxWidth:72,maxHeight:72,display:"block"}})}),a.jsxs("div",{style:{textAlign:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#111827"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Confirm the Mark Manager"})]})]}):null]}),tt?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{kt||st(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Le=>Le.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:tt.mode==="confirm"?`Confirmation - ${i}`:`Request Edit - ${i}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),tt.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",i]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-1 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:j.co1})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-2 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:j.co2})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(Le=>{const Be=H.includes(Le);return a.jsxs("div",{onClick:()=>oe(Et=>Et.includes(Le)?Et.filter(pt=>pt!==Le):[...Et,Le].sort((pt,yt)=>pt-yt)),style:{...pr,borderColor:Be?"#16a34a":"#cbd5e1",background:Be?"#ecfdf5":"#fff",cursor:kt?"not-allowed":"pointer",padding:"6px 8px"},children:[a.jsx("input",{type:"checkbox",checked:Be,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",Le]})]},`modal_btl_${Le}`)})})})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:kt,onClick:()=>st(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:kt||!e,onClick:async()=>{if(e){if(tt.mode==="request"){st(null),await Sr();return}await Ze()}},children:tt.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null]})})}function zxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Gz,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa1",label:r||"SSA1"})}const Wxe=20,MM={co3:10,co4:10},_p={btl1:0,btl2:0,btl3:10,btl4:10,btl5:0,btl6:0},jp=10;function oo(e,t,r){return Math.max(t,Math.min(r,e))}function Vl(e){return Math.round(e*10)/10}function yl(e,t){if(e==null)return"";if(!Number.isFinite(t)||t<=0)return"0";const r=e/t*100;return`${Number.isFinite(r)?r.toFixed(0):0}`}function Gv(e){if(e===""||e==null||typeof e=="string"&&e.trim()==="")return null;const t=Number(e);return Number.isFinite(t)?t:null}function kp(e,t,r){const n=e==null?void 0:e.btlMax,i=(n==null?void 0:n[String(t)])??(n==null?void 0:n[`btl${t}`])??(n==null?void 0:n[t]),s=Gv(i);return s??r}function qxe(e,t){return`${t}_sheet_${e}`}function LM(e){return String(e||"").trim().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_-]/g,"").slice(0,48)}function Hxe(e,t){if(!t.length)return;const r=Object.keys(t[0]),n=[r.join(",")].concat(t.map(l=>r.map(c=>{const u=l[c],d=String(u??"").replace(/\n/g," ");return d.includes(",")||d.includes('"')?`"${d.replace(/"/g,'""')}"`:d}).join(","))).join(`
`),i=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function Vxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const l=r.localeCompare(n);if(l)return l}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim(),o=i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"});return o||0}function Yb(e){return e.slice(-8)}function Kz({subjectId:e,teachingAssignmentId:t,label:r,assessmentKey:n="ssa2"}){var xe,Ee,De,gt,vr;const i=String(r||"SSA2"),s=n==="review2",o=!1,l=x.useMemo(()=>qxe(e,n),[e,n]),c=n==="review2"?SS:ey,u=n==="review2"?O9:P9,[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState({termLabel:"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null}),y=String((d==null?void 0:d.termLabel)||"KRCT AY25-26"),b=((xe=d==null?void 0:d.assessments)==null?void 0:xe.ssa2)||{},v=Number.isFinite(Number(b==null?void 0:b.maxTotal))?Number(b.maxTotal):Wxe,w=s?30:v,S={co3:Number.isFinite(Number((Ee=b==null?void 0:b.coMax)==null?void 0:Ee.co3))?Number(b.coMax.co3):Number.isFinite(Number((De=b==null?void 0:b.coMax)==null?void 0:De.co1))?Number(b.coMax.co1):MM.co3,co4:Number.isFinite(Number((gt=b==null?void 0:b.coMax)==null?void 0:gt.co4))?Number(b.coMax.co4):Number.isFinite(Number((vr=b==null?void 0:b.coMax)==null?void 0:vr.co2))?Number(b.coMax.co2):MM.co4},j=s?{co3:15,co4:15}:S,k={btl1:kp(b,1,_p.btl1),btl2:kp(b,2,_p.btl2),btl3:kp(b,3,_p.btl3),btl4:kp(b,4,_p.btl4),btl5:kp(b,5,_p.btl5),btl6:kp(b,6,_p.btl6)},A=s?30:jp,R=x.useRef(null),[M,B]=x.useState(!1);x.useEffect(()=>{let Je=!0;return(async()=>{try{const Ut=await oc();if(!Je)return;f(Ut||null),g(Le=>({...Le,termLabel:String((Ut==null?void 0:Ut.termLabel)||Le.termLabel||"KRCT AY25-26"),batchLabel:e}))}catch{}})(),()=>{Je=!1}},[e]);const[E,P]=x.useState(!1),[D,G]=x.useState(null),[H,oe]=x.useState(()=>s?[3,4]:[]),[de,W]=x.useState(!1),[V,ae]=x.useState(!1),[ee,C]=x.useState(null),[Y,q]=x.useState(null),[O,X]=x.useState(null),F=x.useRef(!1),[Q,K]=x.useState(null),[ne,re]=x.useState(!1),[T,I]=x.useState(""),[ie,U]=x.useState(!1),[Z,me]=x.useState(null),[Pe,je]=x.useState(!1),[Fe,_e]=x.useState(null),[He,qe]=x.useState(!1),[Pt,ut]=x.useState(null),[Ke,lt]=x.useState(!1),{data:ve,loading:Ae,error:ce,remainingSeconds:be,publishAllowed:mt,refresh:et}=H0({assessment:n,subjectCode:e,teachingAssignmentId:t}),{data:Ue,loading:It,error:ht,refresh:Lt}=V0({assessment:n,subjectCode:String(e||""),teachingAssignmentId:t,options:{poll:!1}}),{data:yr,refresh:Ar}=lc({assessment:n,subjectCode:String(e||""),scope:"MARK_MANAGER",teachingAssignmentId:t,options:{poll:!0}}),{data:Tt,refresh:Vr}=lc({assessment:n,subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:t,options:{poll:!0}}),Br=!!(ve!=null&&ve.global_override_active&&(ve==null?void 0:ve.global_is_open)===!1),[Wr,nn]=x.useState(""),[fn,Ir]=x.useState(!1),[dn,Te]=x.useState(null),[tt,st]=x.useState(null),[kt,jt]=x.useState(!1),[ar,tr]=x.useState(null),[Er,se]=x.useState(null);x.useEffect(()=>{se(null),K(null),_e(null),ut(null)},[e,n,t]);const ue=!!Q||!!(Ue!=null&&Ue.exists&&(Ue!=null&&Ue.is_published))||!!Fe,J=!!m.markManagerLocked;x.useEffect(()=>{if(Ue!=null&&Ue.is_published&&(Ue!=null&&Ue.updated_at)&&!Q)try{K(new Date(String(Ue.updated_at)).toLocaleString())}catch{K(String(Ue.updated_at))}},[Ue==null?void 0:Ue.is_published,Ue==null?void 0:Ue.updated_at]);const fe=Tt!=null&&Tt.approval_until?String(Tt.approval_until):null,ye=yr!=null&&yr.approval_until?String(yr.approval_until):null,Ce=!!(Tt!=null&&Tt.allowed_by_approval)&&!!fe&&fe!==((Er==null?void 0:Er.markEntryApprovalUntil)??null),wt=!!(yr!=null&&yr.allowed_by_approval)&&!!ye&&ye!==((Er==null?void 0:Er.markManagerApprovalUntil)??null),Qe=ue?!!(Ue!=null&&Ue.entry_open)||Ce||wt:!0,Ie=!!(ue&&!Qe),{pending:Re,pendingUntilMs:xt,setPendingUntilMs:Gt,refresh:qt}=G0({enabled:!!(ue&&Ie)&&!!e,assessment:n,subjectCode:e?String(e):null,scope:"MARK_ENTRY",teachingAssignmentId:t});K0(!!ne||!!tt||!!Pe);const Wt=!!(ue&&Ie),vt=async()=>{if(Re){alert("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}me(null),re(!0)},Rt=!!e&&(It||!!ht||Ue==null),Zt=!!(Br||Rt||(Ue?!Ue.entry_open:ue?!Qe:!J)),wr=m.markManagerSnapshot!=null,br=!!(Br||Ie||Zt),cr=!!(ue&&Ie&&J),Tr=x.useMemo(()=>{const Je=new Set(H);return[1,2,3,4,5,6].filter(Ut=>Je.has(Ut))},[H]),Kr=x.useMemo(()=>8+Tr.length*2,[o,Tr.length]);x.useEffect(()=>{if(!e)return;try{const Le=`${n}_selected_btls_${e}`;Gn(Le,H)}catch{}if(!F.current)return;let Je=!1;const Ut=setTimeout(async()=>{try{await Fi(n,e,{sheet:m,selectedBtls:H});try{l&&Gn(l,{termLabel:m.termLabel,batchLabel:m.batchLabel,rows:m.rows})}catch{}Je||q(new Date().toLocaleString())}catch{}},700);return()=>{Je=!0,clearTimeout(Ut)}},[H,e,m,l,n]),x.useEffect(()=>{if(!e)return;const Je=Qn(l);Je&&typeof Je=="object"&&Array.isArray(Je.rows)?g({termLabel:d!=null&&d.termLabel?String(d.termLabel):String(Je.termLabel||"KRCT AY25-26"),batchLabel:e,rows:Je.rows,markManagerSnapshot:(Je==null?void 0:Je.markManagerSnapshot)??null,markManagerApprovalUntil:(Je==null?void 0:Je.markManagerApprovalUntil)??null,markManagerLocked:typeof(Je==null?void 0:Je.markManagerLocked)=="boolean"?Je.markManagerLocked:!!(Je!=null&&Je.markManagerSnapshot)}):g({termLabel:y||"KRCT AY25-26",batchLabel:e,rows:[],markManagerLocked:!1,markManagerSnapshot:null,markManagerApprovalUntil:null})},[l,e,d,y]),x.useEffect(()=>{let Je=!0;return F.current=!1,(async()=>{if(e){try{const Ut=await ei(n,e);if(!Je)return;const Le=Ut==null?void 0:Ut.draft,Be=Le==null?void 0:Le.sheet,Et=Le==null?void 0:Le.selectedBtls;if(Be&&typeof Be=="object"&&Array.isArray(Be.rows)){g(ft=>({...ft,termLabel:String(Be.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Be.rows,markManagerSnapshot:(Be==null?void 0:Be.markManagerSnapshot)??ft.markManagerSnapshot??null,markManagerApprovalUntil:(Be==null?void 0:Be.markManagerApprovalUntil)??ft.markManagerApprovalUntil??null,markManagerLocked:typeof(Be==null?void 0:Be.markManagerLocked)=="boolean"?Be.markManagerLocked:!!((Be==null?void 0:Be.markManagerSnapshot)??ft.markManagerSnapshot)}));const pt=(Ut==null?void 0:Ut.updated_at)??null,yt=(Ut==null?void 0:Ut.updated_by)??null;if(pt)try{q(new Date(String(pt)).toLocaleString())}catch{q(String(pt))}yt&&X(String(yt.name||yt.username||yt.id||""));try{l&&Gn(l,{termLabel:String(Be.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Be.rows})}catch{}}if(Array.isArray(Et)){const pt=Et.map(yt=>Number(yt)).filter(yt=>Number.isFinite(yt));oe(pt);try{const yt=`${n}_selected_btls_${e}`;Gn(yt,pt)}catch{}}}catch{}Je&&(F.current=!0)}})(),()=>{Je=!1}},[e,y,l,n]),x.useEffect(()=>{if(!e)return;if((!!(Ue!=null&&Ue.exists&&(Ue!=null&&Ue.is_published))||!!Q)&&(Ue!=null&&Ue.exists)){const Be=!!(Ue!=null&&Ue.mark_manager_locked);!!m.markManagerLocked!==Be&&g(Et=>({...Et,markManagerLocked:Be}));return}const Ut=!!(yr!=null&&yr.allowed_by_approval),Le=yr!=null&&yr.approval_until?String(yr.approval_until):null;if(Ut&&Le){if(Le===((Er==null?void 0:Er.markManagerApprovalUntil)??null))return;const Be=m.markManagerApprovalUntil?String(m.markManagerApprovalUntil):null;m.markManagerLocked&&Be!==Le&&g(Et=>({...Et,markManagerLocked:!1,markManagerApprovalUntil:Le}));return}},[e,Ue==null?void 0:Ue.exists,Ue==null?void 0:Ue.is_published,Ue==null?void 0:Ue.mark_manager_locked,yr==null?void 0:yr.allowed_by_approval,yr==null?void 0:yr.approval_until,m.markManagerLocked,m.markManagerApprovalUntil,Q,Er==null?void 0:Er.markManagerApprovalUntil]);const Yr=Je=>{g(Ut=>{const Le=new Map,Be=new Map;for(const pt of Ut.rows||[])typeof pt.studentId=="number"&&Le.set(pt.studentId,pt),pt.registerNo&&Be.set(String(pt.registerNo),pt);const Et=(Je||[]).slice().sort(Vxe).map(pt=>{const yt=Le.get(pt.id)||Be.get(String(pt.reg_no||""));return{studentId:pt.id,section:String(pt.section||""),registerNo:String(pt.reg_no||""),name:String(pt.name||""),total:typeof(yt==null?void 0:yt.total)=="number"?oo(Number(yt.total),0,w):((yt==null?void 0:yt.total)==="","")}});return{...Ut,rows:Et}})},xn=async()=>{var Je,Ut,Le;if(!e){G("Subject ID is required.");return}P(!0),G(null);try{let Be=[],Et=null;try{const pt=await hc();console.log("[SSA2] My TAs:",pt==null?void 0:pt.length,"for subject:",e,"teachingAssignmentId:",t),Et=(pt||[]).find(yt=>{const ft=String(yt.subject_code||"").trim().toUpperCase()===String(e||"").trim().toUpperCase();return(t?yt.id===t:!1)||ft}),Et?console.log("[SSA2] Found TA match:",Et.id,"elective_subject_id:",Et.elective_subject_id,"section_id:",Et.section_id):console.log("[SSA2] No TA match found in user TAs")}catch(pt){console.warn("[SSA2] My TAs fetch failed:",pt)}if(Et&&Et.elective_subject_id&&!Et.section_id){console.log("[SSA2] Detected elective, fetching elective-choices for elective_subject_id:",Et.elective_subject_id);try{const pt=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Et.elective_subject_id))}`);if(pt.ok){const yt=await pt.json(),ft=Array.isArray(yt.results)?yt.results:Array.isArray(yt)?yt:yt.items||[];console.log("[SSA2] Elective choices returned:",ft==null?void 0:ft.length,"students"),Be=(ft||[]).map(he=>({id:Number(he.student_id??he.id),reg_no:String(he.reg_no??he.regno??""),name:String(he.name??he.full_name??he.username??""),section:he.section_name??he.section??null}))}else console.warn("[SSA2] Elective-choices API returned error:",pt.status)}catch(pt){console.warn("[SSA2] Elective-choices fetch failed:",pt)}}if(!Be.length&&Et&&Et.id){console.log("[SSA2] Fetching regular TA roster for TA ID:",Et.id);try{const pt=await pc(Et.id);Be=pt.students||[],h({courseName:String(((Je=pt==null?void 0:pt.teaching_assignment)==null?void 0:Je.subject_name)||(Et==null?void 0:Et.subject_name)||""),courseCode:String(((Ut=pt==null?void 0:pt.teaching_assignment)==null?void 0:Ut.subject_code)||(Et==null?void 0:Et.subject_code)||e||""),className:String(((Le=pt==null?void 0:pt.teaching_assignment)==null?void 0:Le.section_name)||(Et==null?void 0:Et.section_name)||"")}),console.log("[SSA2] Regular roster returned:",Be.length,"students")}catch(pt){console.warn("[SSA2] TA roster fetch failed:",pt)}}console.log("[SSA2] Final roster count:",Be.length),Yr(Be)}catch(Be){G((Be==null?void 0:Be.message)||"Failed to load roster")}finally{P(!1)}};x.useEffect(()=>{e&&xn()},[t,e]);async function hr(Je){if(e){Je&&qe(!0),ut(null);try{const Ut=await c(String(e));_e(Ut||null)}catch(Ut){Je&&ut((Ut==null?void 0:Ut.message)||`Failed to load published ${i} marks`)}finally{Je&&qe(!1)}}}x.useEffect(()=>{e&&hr(!1)},[e,n,t]);const nr=x.useRef(null);x.useEffect(()=>{nr.current=null},[e,n,t]);const Mr=x.useRef(null);async function an(Je=!0){try{if(et(),Lt({silent:!1}),await hr(Je),t)try{await xn()}catch{}}catch{}}x.useEffect(()=>{if(!e||!ue)return;if(!Qe){nr.current=!1;return}const Je=nr.current;if(nr.current=!0,Je===!0)return;let Ut=!0;return(async()=>{try{const Le=await ei(n,String(e));if(!Ut)return;const Be=Le==null?void 0:Le.draft,Et=Be==null?void 0:Be.sheet,pt=Be==null?void 0:Be.selectedBtls;if(Et&&typeof Et=="object"&&Array.isArray(Et.rows)&&Et.rows.some(ft=>(ft==null?void 0:ft.total)!==""&&(ft==null?void 0:ft.total)!=null)){g(ft=>({...ft,termLabel:String(Et.termLabel||y||"KRCT AY25-26"),batchLabel:e,rows:Et.rows,markManagerSnapshot:(Et==null?void 0:Et.markManagerSnapshot)??ft.markManagerSnapshot??null,markManagerApprovalUntil:(Et==null?void 0:Et.markManagerApprovalUntil)??ft.markManagerApprovalUntil??null,markManagerLocked:typeof(Et==null?void 0:Et.markManagerLocked)=="boolean"?Et.markManagerLocked:!!((Et==null?void 0:Et.markManagerSnapshot)??ft.markManagerSnapshot)})),Array.isArray(pt)&&oe(pt.map(ft=>Number(ft)).filter(ft=>Number.isFinite(ft))),F.current=!0;return}}catch{}Ut&&hr(!1)})(),()=>{Ut=!1}},[Qe,ue,e,n,y]),x.useEffect(()=>{if(!e||!ue||Qe)return;const Je=window.setInterval(()=>{Lt({silent:!0})},3e4);return()=>window.clearInterval(Je)},[Qe,ue,e,Lt]),x.useEffect(()=>{Pe&&e&&(_e(null),hr(!0))},[Pe,e]);const it=async()=>{W(!0),C(null);try{await Fi(n,e,{sheet:m,selectedBtls:H}),q(new Date().toLocaleString())}catch(Je){C((Je==null?void 0:Je.message)||`Failed to save ${i} draft`)}finally{W(!1)}},Ye=x.useRef(m);Ye.current=m;const ct=x.useRef(H);ct.current=H,x.useEffect(()=>{const Je=()=>{if(!e||Zt)return;const Ut={sheet:Ye.current,selectedBtls:ct.current};Fi(n,e,Ut).catch(()=>{})};return window.addEventListener("obe:before-tab-switch",Je),()=>window.removeEventListener("obe:before-tab-switch",Je)},[e,n,Zt]);const Ht=async()=>{if(e){if(Br){C("Publishing is locked by IQAC.");return}if(!mt){C("Publish window is closed. Please request IQAC approval.");return}if(ue&&Ie){if(Re){C("Edit request is pending. Please wait for approval.");return}if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}re(!0);return}ae(!0),C(null);try{await u(e,m,t),K(new Date().toLocaleString()),se({markEntryApprovalUntil:fe,markManagerApprovalUntil:ye}),g(Je=>({...Je,markManagerLocked:!0})),et(),Lt({silent:!0}),hr(!1),setTimeout(()=>{try{if(Pe&&Mr.current){const Je=Mr.current;Je.scrollTop=Je.scrollHeight}}catch{}},50);try{console.debug("obe:published dispatch",{assessment:n,subjectId:e}),window.dispatchEvent(new CustomEvent("obe:published",{detail:{subjectId:e,assessment:n}}))}catch{}setTimeout(()=>{an(!0),lt(!0),setTimeout(()=>lt(!1),5e3)},2e3)}catch(Je){C((Je==null?void 0:Je.message)||`Failed to publish ${i}`)}finally{ae(!1)}}},fr=async()=>{Ir(!0),Te(null),C(null);try{await jh({assessment:n,subject_code:e,reason:Wr,teaching_assignment_id:t}),Te("Request sent to IQAC for approval.")}catch(Je){C((Je==null?void 0:Je.message)||"Failed to request approval")}finally{Ir(!1),et()}},Sr=()=>{confirm(`Reset ${i} marks for all students in this section?`)&&(Zt||g(Je=>({...Je,rows:(Je.rows||[]).map(Ut=>({...Ut,total:""}))})))};function gr(Je){return JSON.stringify({maxTotal:w,coMax:j,selectedBtls:H.slice(),btlMax:k})}async function Ze(){if(e){jt(!0),tr(null);try{const Je=await sl({assessment:n,subject_code:String(e),scope:"MARK_MANAGER",reason:`Edit request: Mark Manager changes for ${i} ${e}`,teaching_assignment_id:t});alert(ol(Je));try{await(Ar?Ar({silent:!0}):Promise.resolve())}catch{}}catch(Je){const Ut=ll(Je,"Request failed");tr(Ut),alert(`Edit request failed: ${Ut}`)}finally{jt(!1)}}}async function Kt(){if(!e)return;if(!await as()){alert("Please verify your mobile number in Profile before requesting edits."),window.location.href="/profile";return}if(Re){alert("Edit request is pending. Please wait for approval.");return}const Ut=String(T||"").trim();if(!Ut){me("Reason is required.");return}U(!0),me(null);try{const Le=await sl({assessment:n,subject_code:String(e),scope:"MARK_ENTRY",reason:Ut,teaching_assignment_id:t});alert(ol(Le)),re(!1),I(""),Gt(Date.now()+24*60*60*1e3);try{qt({silent:!0})}catch{}Lt({silent:!0});try{await(Vr?Vr({silent:!0}):Promise.resolve())}catch{}}catch(Le){const Be=ll(Le,"Request failed");me(Be),alert(`Edit request failed: ${Be}`)}finally{U(!1)}}async function nt(){if(e){jt(!0),tr(null);try{const Je=gr(m),Ut=yr!=null&&yr.approval_until?String(yr.approval_until):m.markManagerApprovalUntil||null,Le={...m,markManagerLocked:!0,markManagerSnapshot:Je,markManagerApprovalUntil:Ut},Be={sheet:Le,selectedBtls:H};g(Le),st(null),await Fi(n,String(e),Be),q(new Date().toLocaleString());try{await fh(n,String(e),t),Lt({silent:!0})}catch(Et){console.warn("confirmMarkManagerLock failed",Et)}}catch(Je){tr((Je==null?void 0:Je.message)||"Save failed")}finally{jt(!1)}}}const bt=(Je,Ut)=>{g(Le=>{const Be=Le.rows.slice(),Et=Be[Je]||{studentId:0,section:"",registerNo:"",name:"",total:""};return Be[Je]={...Et,...Ut},{...Le,rows:Be}})},St=()=>{const Je=m.rows.map((Ut,Le)=>{const Be=typeof Ut.total=="number"?oo(Number(Ut.total),0,w):null,Et=Be==null?"":Vl(Be),yt=Be==null?null:Vl(Be/2),ft=yt==null?null:oo(yt,0,j.co3),he=yt==null?null:oo(yt,0,j.co4),Ne=Tr.map(Dr=>Dr-1),At=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((Dr,cn)=>Ne.includes(cn)?s?A:Dr>0?Dr:jp:Dr),Lr=Be==null?null:Ne.length?Vl(Be/Ne.length):0,xr=At.map((Dr,cn)=>Be==null||!Ne.includes(cn)?null:Dr>0?oo(Lr,0,Dr):Vl(Lr)),$r={sno:Le+1,registerNo:Yb(Ut.registerNo),name:Ut.name,co3_mark:ft??"",co3_pct:yl(ft,j.co3),co4_mark:he??"",co4_pct:yl(he,j.co4),btl1_mark:xr[0]??"",btl1_pct:yl(xr[0],At[0]),btl2_mark:xr[1]??"",btl2_pct:yl(xr[1],At[1]),btl3_mark:xr[2]??"",btl3_pct:yl(xr[2],At[2]),btl4_mark:xr[3]??"",btl4_pct:yl(xr[3],At[3]),btl5_mark:xr[4]??"",btl5_pct:yl(xr[4],At[4]),btl6_mark:xr[5]??"",btl6_pct:yl(xr[5],At[5])};return $r[i]=Et,$r});Hxe(`${e}_${LM(i)||"SSA2"}_sheet.csv`,Je)},Ct=()=>{if(!m.rows.length)return;const Je=Number.isFinite(Number(j.co3))?Number(j.co3):0,Ut=Number.isFinite(Number(j.co4))?Number(j.co4):0,Le=["Register No","Student Name",`Q1 (${Je.toFixed(2)})`,`Q2 (${Ut.toFixed(2)})`,"Status"],Be=m.rows.map(ft=>[ft.registerNo,ft.name,"","","present"]),Et=$o.aoa_to_sheet([Le,...Be]);Et["!freeze"]={xSplit:0,ySplit:1};const pt=$o.book_new();$o.book_append_sheet(pt,Et,i||"SSA2");const yt=`${e}_${LM(i)||"SSA2"}_template.xlsx`;MS(pt,yt)},$t=async()=>{const Je=m.rows.map((Ut,Le)=>({sno:Le+1,regNo:String(Ut.registerNo||""),name:String(Ut.name||""),total:Ut.total===""?"":Number(Ut.total)}));await dy({filenameBase:`${e}_${i}`,meta:{courseName:(p==null?void 0:p.courseName)||"",courseCode:(p==null?void 0:p.courseCode)||e,className:(p==null?void 0:p.className)||""},rows:Je})};function Vt(Je){return String(Je??"").trim().toLowerCase().replace(/\s+/g," ")}const Dt=()=>{var Je;Zt||(Je=R.current)==null||Je.click()},ze=async Je=>{var Ut;if(Je){B(!0);try{const Le=await Je.arrayBuffer(),Be=Um(Le,{type:"array"}),Et=(Ut=Be.SheetNames)==null?void 0:Ut[0];if(!Et)throw new Error("No sheet found in the Excel file.");const pt=Be.Sheets[Et],yt=$o.sheet_to_json(pt,{header:1});if(!yt.length)throw new Error("Excel sheet is empty.");const ft=(yt[0]||[]).map(Vt),he=hn=>ft.findIndex(yn=>hn(yn)),Ne=he(hn=>hn==="register no"||hn==="reg no"||hn.includes("register")),Xe=he(hn=>hn.startsWith("q1")),At=he(hn=>hn.startsWith("q2")),Lr=he(hn=>hn==="total"||hn.includes("total")),xr=he(hn=>hn==="status"||hn.includes("status"));if(Ne<0)throw new Error("Could not find Register No column.");const $r=Number.isFinite(Number(j.co3))?Number(j.co3):0,Dr=Number.isFinite(Number(j.co4))?Number(j.co4):0,cn=new Map;m.rows.forEach((hn,yn)=>{const sn=String(hn.registerNo||"").trim();sn&&cn.set(sn,yn);const ir=Yb(sn);ir&&cn.set(ir,yn)}),g(hn=>{const yn=hn.rows.slice();for(let sn=1;sn<yt.length;sn++){const ir=yt[sn]||[],Qr=String(ir[Ne]??"").trim();if(!Qr)continue;const vn=cn.get(Qr);if(vn==null)continue;const Bn=(xr>=0?String(ir[xr]??""):"").trim().toLowerCase(),ri=Bn==="absent"||Bn==="ab"||Bn==="a",on=Xe>=0?Gv(ir[Xe]):null,Un=At>=0?Gv(ir[At]):null,L=Lr>=0?Gv(ir[Lr]):null,le=on==null?0:oo(on,0,$r),Oe=Un==null?0:oo(Un,0,Dr),dt=L??le+Oe,rt=ri?0:oo(dt,0,w);yn[vn]={...yn[vn],total:Vl(rt)}}return{...hn,rows:yn}})}finally{B(!1)}}},at=async Je=>{var Le;const Ut=(Le=Je.target.files)==null?void 0:Le[0];if(Je.target.value="",!!Ut)try{await ze(Ut)}catch(Be){alert((Be==null?void 0:Be.message)||"Failed to import Excel")}},_t={padding:"10px 12px",background:"linear-gradient(180deg, rgba(11,74,111,0.06), rgba(240,249,255,0.06))",color:"#0b4a6f",textAlign:"center",fontWeight:800,fontSize:12,borderBottom:"1px solid rgba(148,163,184,0.5)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},Ft={padding:"10px 12px",fontSize:12,borderBottom:"1px solid rgba(226,232,240,0.9)",borderRight:"1px solid rgba(226,232,240,0.8)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},pr={width:"100%",padding:"8px 10px",borderRadius:10,border:"1px solid rgba(226,232,240,0.9)",outline:"none",background:"rgba(255,255,255,0.9)",fontSize:12,textAlign:"center"},or={display:"inline-flex",alignItems:"center",gap:6,padding:"4px 8px",border:"1px solid #d1d5db",borderRadius:999,background:"#fff",cursor:"pointer",userSelect:"none",fontSize:11},Xt={border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"};return a.jsx(a.Fragment,{children:a.jsxs(og,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx("button",{onClick:xn,className:"obe-btn obe-btn-secondary",disabled:E,children:E?"Loading roster":"Load/Refresh Roster"}),a.jsx("button",{onClick:Sr,className:"obe-btn obe-btn-danger",disabled:!m.rows.length,children:"Reset Marks"}),a.jsx("button",{onClick:St,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export CSV"}),a.jsx("button",{onClick:Ct,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Export Excel"}),a.jsx("button",{onClick:Dt,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length||Zt||M,children:M?"Importing":"Import Excel"}),a.jsx("input",{ref:R,type:"file",accept:".xlsx,.xls",style:{display:"none"},onChange:at})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("button",{onClick:$t,className:"obe-btn obe-btn-secondary",disabled:!m.rows.length,children:"Download"}),a.jsx("button",{onClick:it,className:"obe-btn obe-btn-success",disabled:de||Zt,title:Zt?"Table locked  confirm Mark Manager to enable actions":void 0,children:de?"Saving":"Save Draft"}),a.jsx("button",{onClick:Ht,className:"obe-btn obe-btn-primary",disabled:Wt?Re:V||!mt||Zt,title:Zt?"Table locked  confirm Mark Manager to enable actions":void 0,children:Wt?Re?"Request Pending":"Request Edit":V?"Publishing":"Publish"})]})]}),Ke?a.jsx("div",{style:{marginTop:8,padding:8,background:"#ecfdf5",border:"1px solid #bbf7d0",borderRadius:8,color:"#065f46",fontWeight:700},children:"Name list locked"}):null,a.jsx("div",{style:{marginTop:10,fontSize:12,color:mt?"#065f46":"#b91c1c"},children:Ae?"Checking publish due time":ce||(ve!=null&&ve.due_at?a.jsxs(a.Fragment,{children:["Due: ",new Date(ve.due_at).toLocaleString(),"  Remaining: ",ag(be),ve.allowed_by_approval&&ve.approval_until?a.jsxs(a.Fragment,{children:["  Approved until ",new Date(ve.approval_until).toLocaleString()]}):null]}):"Due time not set by IQAC.")}),Br?a.jsxs("div",{style:{marginTop:10,border:"1px solid #fde68a",background:"#fffbeb",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publishing disabled by IQAC"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Global publishing is turned OFF for this assessment. You can view the sheet, but editing and publishing are locked."}),a.jsx("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:a.jsx("button",{className:"obe-btn",onClick:()=>et(),disabled:Ae,children:"Refresh"})})]}):mt?null:a.jsxs("div",{style:{marginTop:10,border:"1px solid #fecaca",background:"#fff7ed",borderRadius:12,padding:12},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"Publish time is over"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:"Send a request to IQAC to approve publishing."}),a.jsx("textarea",{value:Wr,onChange:Je=>nn(Je.target.value),placeholder:"Reason (optional)",rows:3,style:{width:"100%",padding:10,borderRadius:10,border:"1px solid #e5e7eb",resize:"vertical"}}),a.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{className:"obe-btn",onClick:()=>et(),disabled:fn||Ae,children:"Refresh"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:fr,disabled:fn,children:fn?"Requesting":"Request Approval"})]}),dn?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#065f46"},children:dn}):null]}),(D||ee)&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c",fontSize:13},children:D||ee}),a.jsxs("div",{style:{marginTop:10,display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{style:Xt,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Term"}),a.jsx("div",{style:{fontWeight:700},children:m.termLabel||""})]}),a.jsxs("div",{style:Xt,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Batch"}),a.jsx("div",{style:{fontWeight:700},children:m.batchLabel||""})]}),a.jsxs("div",{style:Xt,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Saved"}),a.jsx("div",{style:{fontWeight:700},children:Y||""}),O?a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["by ",a.jsx("span",{style:{color:"#0369a1",fontWeight:700},children:O})]}):null]}),a.jsxs("div",{style:Xt,children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Published"}),a.jsx("div",{style:{fontWeight:700},children:Q||""})]})]}),a.jsxs("div",{style:{marginTop:12,...Xt},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800},children:"Mark Manager"}),a.jsx("div",{children:a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>{const Je=m.markManagerSnapshot!=null;st({mode:Je?"request":"confirm"})},disabled:!e||kt,children:m.markManagerSnapshot?"Edit":"Save"})})]}),a.jsxs("div",{style:{marginTop:8,fontSize:13,color:"#6b7280"},children:[a.jsxs("div",{children:["Max ",i,": ",a.jsx("strong",{style:{color:"#111"},children:w})]}),a.jsxs("div",{children:["CO-3 max: ",a.jsx("strong",{style:{color:"#111"},children:j.co3}),"  CO-4 max: ",a.jsx("strong",{style:{color:"#111"},children:j.co4})]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Selected BTLs:"}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[1,2,3,4,5,6].map(Je=>{const Ut=H.includes(Je),Le=!!(J&&m.markManagerSnapshot!=null);return a.jsxs("div",{onClick:()=>{if(Br||kt)return;const Be=m.markManagerSnapshot!=null;J&&Be||oe(Et=>Et.includes(Je)?Et.filter(pt=>pt!==Je):Et.concat(Je).sort((pt,yt)=>pt-yt))},style:{...or,borderColor:Ut?"#16a34a":"#cbd5e1",background:Ut?"#ecfdf5":"#fff",cursor:Le||kt?"not-allowed":"pointer",opacity:Le?.6:1,padding:"6px 8px"},"aria-disabled":Le||kt,children:[a.jsx("input",{type:"checkbox",checked:Ut,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",Je]})]},`card_btl_${Je}`)})})]})]}),ar?a.jsx("div",{style:{marginTop:8,color:"#991b1b"},children:ar}):null]}),a.jsx("div",{style:{marginTop:14},children:wr?a.jsxs("div",{style:{position:"relative"},children:[a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"},children:a.jsx(sg,{locked:!!(Br||Ie||ue&&Rt),title:Br?"Locked by IQAC":Ie?"Published  Locked":"Table Locked",subtitle:Br?"Publishing is turned OFF globally for this assessment.":Ie?"Marks are published. Request IQAC approval to edit.":"Confirm the Mark Manager",children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:_t,colSpan:Kr,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{..._t,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:_t,rowSpan:4,children:"Register No."}),a.jsx("th",{style:_t,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:_t,children:i}),null,a.jsx("th",{style:_t,colSpan:4,children:"CO ATTAINMENT"}),Tr.length?a.jsx("th",{style:_t,colSpan:Tr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:_t,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,a.jsx("th",{style:_t,colSpan:2,children:"CO-3"}),a.jsx("th",{style:_t,colSpan:2,children:"CO-4"}),Tr.map(Je=>a.jsxs("th",{style:_t,colSpan:2,children:["BTL-",Je]},`btl-head-${Je}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:_t,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:Tr.length?Tr.join(","):"-"})]}),null,Array.from({length:2+Tr.length}).flatMap((Je,Ut)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:_t,children:"Mark"}),a.jsx("th",{style:_t,children:"%"})]},Ut))]}),a.jsxs("tr",{children:[a.jsx("th",{style:_t,children:"Name / Max Marks"}),a.jsx("th",{style:_t,children:w}),null,a.jsx("th",{style:_t,children:j.co3}),a.jsx("th",{style:_t,children:"%"}),a.jsx("th",{style:_t,children:j.co4}),a.jsx("th",{style:_t,children:"%"}),Tr.flatMap(Je=>[a.jsx("th",{style:_t,children:String(s?A:Math.max(Number(k[`btl${Je}`]??0)||0,jp))},`btl-max-${Je}`),a.jsx("th",{style:_t,children:"%"},`btl-pct-${Je}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Kr,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):Zt&&!Ie?a.jsx("tr",{children:a.jsx("td",{colSpan:Kr,style:{padding:20,textAlign:"center",color:"#065f46",fontWeight:900},children:"Table locked  confirm the Mark Manager to enable student marks"})}):m.rows.map((Je,Ut)=>{const Le=typeof Je.total=="number"?oo(Number(Je.total),0,w):null,Be=Le==null?null:Vl(Le/2),Et=Be==null?null:oo(Be,0,j.co3),pt=Be==null?null:oo(Be,0,j.co4),yt=Tr.map(At=>At-1),he=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map((At,Lr)=>yt.includes(Lr)?s?A:At>0?At:jp:At),Ne=Le==null?null:yt.length?Vl(Le/yt.length):0,Xe=he.map((At,Lr)=>Le==null||!yt.includes(Lr)?null:At>0?oo(Ne,0,At):Vl(Ne));return a.jsxs("tr",{style:{background:Ut%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...Ft,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ut+1}),a.jsx("td",{style:Ft,children:Yb(Je.registerNo)}),a.jsx("td",{style:Ft,children:Je.name}),a.jsx("td",{style:{...Ft,width:90,background:"#fff7ed"},children:br?a.jsx("div",{style:pr,children:typeof Je.total=="number"?Vl(Je.total):""}):a.jsx("input",{style:pr,type:"number",value:Je.total,min:0,max:w,onChange:At=>{if(br)return;const Lr=At.target.value;if(Lr==="")return bt(Ut,{total:""});const xr=Number(Lr);if(!Number.isFinite(xr))return bt(Ut,{total:""});if(xr>w){At.currentTarget.setCustomValidity(`Max mark is ${w}`),At.currentTarget.reportValidity(),window.setTimeout(()=>At.currentTarget.setCustomValidity(""),0);return}At.currentTarget.setCustomValidity("");const $r=oo(xr,0,w);bt(Ut,{total:$r})}})}),null,a.jsx("td",{style:{...Ft,textAlign:"center"},children:Et??""}),a.jsx("td",{style:{...Ft,textAlign:"center"},children:yl(Et,j.co3)}),a.jsx("td",{style:{...Ft,textAlign:"center"},children:pt??""}),a.jsx("td",{style:{...Ft,textAlign:"center"},children:yl(pt,j.co4)}),Tr.map(At=>{const Lr=At-1,xr=Xe[Lr],$r=he[Lr];return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Ft,textAlign:"center"},children:xr??""}),a.jsx("td",{style:{...Ft,textAlign:"center"},children:yl(xr,$r)})]},At)})]},String(Je.studentId||Ut))})})]})})}),cr&&wr?a.jsxs("div",{style:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:40,width:360,background:"#fff",border:"1px solid #e5e7eb",padding:10,borderRadius:12,display:"flex",flexDirection:"column",gap:8,alignItems:"center",boxShadow:"0 6px 18px rgba(17,24,39,0.06)"},children:[a.jsx("div",{style:{textAlign:"center"},children:Ie?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Published"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Marks are locked. Request IQAC approval to edit."})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontWeight:900,color:"#065f46"},children:"Table Locked"}),a.jsx("div",{style:{fontSize:13,color:"#065f46"},children:"Confirm the Mark Manager"})]})}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[a.jsx("button",{className:"obe-btn",onClick:()=>je(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Re,onClick:vt,children:Re?"Request Pending":"Request Edit"})]})]}):null]}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:20,background:"#fff"},children:a.jsxs("div",{style:{display:"grid",placeItems:"center",padding:40},children:[a.jsx("div",{style:{fontWeight:800,fontSize:16,marginTop:8},children:Ie?"Published  Locked":"Table Locked"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:Ie?"Marks published. Use View to inspect or Request Edit to ask IQAC for edit access.":"Confirm the Mark Manager to unlock the student list."}),a.jsx("div",{style:{display:"flex",gap:8,marginTop:12},children:Ie?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:()=>je(!0),children:"View"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:Re,onClick:vt,children:Re?"Request Pending":"Request Edit"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn obe-btn-success",onClick:()=>st({mode:"confirm"}),disabled:!e||kt,children:"Save Mark Manager"}),a.jsx("button",{className:"obe-btn",onClick:()=>Ze(),disabled:kt,children:"Request Access"})]})})]})})}),Pe?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:70},onClick:()=>je(!1),children:a.jsxs("div",{style:{width:"min(1100px, 96vw)",maxHeight:"min(80vh, 900px)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:0,display:"flex",flexDirection:"column"},onClick:Je=>Je.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"12px 14px",borderBottom:"1px solid #eef2f7"},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Only"}),a.jsx("button",{onClick:Je=>{Je.stopPropagation(),je(!1)},"aria-label":"Close",style:{marginLeft:"auto",border:"none",background:"transparent",fontSize:20,lineHeight:1,cursor:"pointer"},children:""})]}),a.jsxs("div",{style:{padding:14},children:[He?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading published marks"}):null,Pt?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:Pt}):null]}),a.jsx("div",{ref:Mr,style:{overflow:"auto",borderTop:"1px solid #e5e7eb",borderBottom:"1px solid #e5e7eb",borderLeft:"1px solid #e5e7eb",borderRight:"1px solid #e5e7eb",borderRadius:0,maxHeight:"60vh",background:"#fff"},children:a.jsxs("table",{className:"ssa-modern-table",style:{borderCollapse:"separate",borderSpacing:0,width:"100%",minWidth:920},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:a.jsxs("th",{style:_t,colSpan:Kr,children:[m.termLabel," | ",m.batchLabel," | ",i]})}),a.jsxs("tr",{children:[a.jsx("th",{style:{..._t,width:42,minWidth:42},rowSpan:4,children:"S.No"}),a.jsx("th",{style:_t,rowSpan:4,children:"Register No."}),a.jsx("th",{style:_t,rowSpan:3,children:"Name of the Students"}),a.jsx("th",{style:_t,children:i}),null,a.jsx("th",{style:_t,colSpan:4,children:"CO ATTAINMENT"}),Tr.length?a.jsx("th",{style:_t,colSpan:Tr.length*2,children:"BTL ATTAINMENT"}):null]}),a.jsxs("tr",{children:[a.jsxs("th",{style:_t,children:[a.jsx("div",{style:{fontWeight:800},children:"COs"}),a.jsx("div",{style:{fontSize:12},children:"3,4"})]}),null,a.jsx("th",{style:_t,colSpan:2,children:"CO-3"}),a.jsx("th",{style:_t,colSpan:2,children:"CO-4"}),Tr.map(Je=>a.jsxs("th",{style:_t,colSpan:2,children:["BTL-",Je]},`btl-head-${Je}`))]}),a.jsxs("tr",{children:[a.jsxs("th",{style:_t,children:[a.jsx("div",{style:{fontWeight:800},children:"BTL"}),a.jsx("div",{style:{fontSize:12},children:Tr.length?Tr.join(","):"-"})]}),null,Array.from({length:2+Tr.length}).flatMap((Je,Ut)=>a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:_t,children:"Mark"}),a.jsx("th",{style:_t,children:"%"})]},Ut))]}),a.jsxs("tr",{children:[a.jsx("th",{style:_t,children:"Name / Max Marks"}),a.jsx("th",{style:_t,children:w}),null,a.jsx("th",{style:_t,children:j.co3}),a.jsx("th",{style:_t,children:"%"}),a.jsx("th",{style:_t,children:j.co4}),a.jsx("th",{style:_t,children:"%"}),Tr.flatMap(Je=>[a.jsx("th",{style:_t,children:String(s?A:Math.max(Number(k[`btl${Je}`]??0)||0,jp))},`btl-max-${Je}`),a.jsx("th",{style:_t,children:"%"},`btl-pct-${Je}`)])]})]}),a.jsx("tbody",{children:m.rows.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:Kr,style:{padding:14,color:"#6b7280",fontSize:13},children:"No students loaded yet. Choose a Teaching Assignment above, then click Load/Refresh Roster."})}):m.rows.map((Je,Ut)=>{var xr;const Le=((xr=Fe==null?void 0:Fe.marks)==null?void 0:xr[String(Je.studentId)])??null,Be=Le==null||Le===""?null:oo(Number(Le),0,w),pt=Be==null?null:Vl(Be/2),yt=pt==null?null:oo(pt,0,j.co3),ft=pt==null?null:oo(pt,0,j.co4),he=Tr.map($r=>$r-1),Xe=[k.btl1,k.btl2,k.btl3,k.btl4,k.btl5,k.btl6].map(($r,Dr)=>he.includes(Dr)?s?A:$r>0?$r:jp:$r),At=Be==null?null:he.length?Vl(Be/he.length):0,Lr=Xe.map(($r,Dr)=>Be==null||!he.includes(Dr)?null:$r>0?oo(At,0,$r):Vl(At));return a.jsxs("tr",{style:{background:Ut%2===1?"#f8fafc":"#fff"},children:[a.jsx("td",{style:{...Ft,textAlign:"center",width:42,minWidth:42,paddingLeft:2,paddingRight:2},children:Ut+1}),a.jsx("td",{style:Ft,children:Yb(Je.registerNo)}),a.jsx("td",{style:Ft,children:Je.name}),a.jsx("td",{style:{...Ft,width:90,background:"#fff7ed",textAlign:"center"},children:Be==null?"":Vl(Be)}),null,a.jsx("td",{style:{...Ft,textAlign:"center"},children:yt??""}),a.jsx("td",{style:{...Ft,textAlign:"center"},children:yl(yt,j.co3)}),a.jsx("td",{style:{...Ft,textAlign:"center"},children:ft??""}),a.jsx("td",{style:{...Ft,textAlign:"center"},children:yl(ft,j.co4)}),Tr.map($r=>{const Dr=$r-1,cn=Lr[Dr],hn=Xe[Dr];return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Ft,textAlign:"center"},children:cn??""}),a.jsx("td",{style:{...Ft,textAlign:"center"},children:yl(cn,hn)})]},$r)})]},String(Je.studentId||Ut))})})]})}),a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:12},children:a.jsx("button",{className:"obe-btn",onClick:()=>je(!1),children:"Close"})})]})})}):null,tt?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:9999},onClick:()=>{kt||st(null)},children:a.jsxs("div",{style:{width:"min(640px,96vw)",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Je=>Je.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:tt.mode==="confirm"?`Confirmation - ${i}`:`Request Edit - ${i}`}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),tt.mode==="confirm"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"Confirm the selected settings. After confirming, Mark Manager will be applied and table will be editable."}),a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{background:"#f9fafb"},children:[a.jsx("th",{style:{textAlign:"left",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Item"}),a.jsx("th",{style:{textAlign:"right",padding:10,fontSize:12,borderBottom:"1px solid #e5e7eb"},children:"Value"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsxs("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:["Max ",i]}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:w})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-3 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:j.co3})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"CO-4 max"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:j.co4})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",fontWeight:900},children:"Selected BTLs"}),a.jsx("td",{style:{padding:10,borderBottom:"1px solid #f3f4f6",textAlign:"right"},children:a.jsx("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",flexWrap:"wrap"},children:[1,2,3,4,5,6].map(Je=>{const Ut=H.includes(Je);return a.jsxs("div",{onClick:()=>{kt||oe(Le=>Le.includes(Je)?Le.filter(Be=>Be!==Je):[...Le,Je].sort((Be,Et)=>Be-Et))},style:{...or,borderColor:Ut?"#16a34a":"#cbd5e1",background:Ut?"#ecfdf5":"#fff",cursor:kt?"not-allowed":"pointer",padding:"6px 8px"},children:[a.jsx("input",{type:"checkbox",checked:Ut,readOnly:!0,style:{marginRight:6}}),a.jsxs("span",{style:{fontWeight:800},children:["BTL",Je]})]},`modal_btl_${Je}`)})})})]})]})]})})]}):a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10},children:"This will send an edit request to IQAC. Mark Manager will remain locked until IQAC approves."}),a.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:14},children:[a.jsx("button",{className:"obe-btn",disabled:kt,onClick:()=>st(null),children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-success",disabled:kt||!e,onClick:async()=>{if(e){if(tt.mode==="request"){st(null),await Ze();return}await nt()}},children:tt.mode==="confirm"?"Confirm":"Send Request"})]})]})})}):null,ne?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:60},onClick:()=>{ie||re(!1)},children:a.jsxs("div",{style:{width:"min(560px, 96vw)",maxHeight:"min(86vh, 740px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:Je=>Je.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"Request Edit Access"}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:i})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:10,lineHeight:1.35},children:["This will send a request to IQAC. Once approved, mark entry will open for editing until the approval expires.",xt?a.jsxs("div",{style:{marginTop:6},children:[a.jsx("strong",{children:"Request window:"})," 24 hours"]}):null]}),a.jsxs("div",{style:{fontSize:13,color:"#374151",marginBottom:10,lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Subject:"})," ",String(e||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Published:"})," ",Q||""]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Saved:"})," ",Y||""]})]}),a.jsxs("div",{style:{marginTop:10},children:[a.jsx("div",{style:{fontSize:12,fontWeight:800,color:"#111827",marginBottom:6},children:"Reason"}),a.jsx("textarea",{value:T,onChange:Je=>I(Je.target.value),placeholder:"Explain why you need to edit (required)",rows:4,className:"obe-input",style:{resize:"vertical"}})]}),Z?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c"},children:Z}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:ie,onClick:()=>re(!1),children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-primary",disabled:ie||Re||!e||!String(T||"").trim(),onClick:async()=>{await Kt()},children:ie?"Requesting":Re?"Request Pending":"Send Request"})]})]})})}):null,a.jsx("style",{children:`
        /* SSA table modern look (UI-only) */
        .ssa-modern-table th:last-child,
        .ssa-modern-table td:last-child {
          border-right: none;
        }
        .ssa-modern-table tbody tr:nth-child(even) td {
          background: #fbfdff;
        }
        .ssa-modern-table tbody tr:hover td {
          background: rgba(2, 132, 199, 0.03);
        }
      `}),a.jsx("div",{style:{marginTop:14},children:wr?a.jsx("div",{className:"obe-table-wrapper",style:{overflowX:"auto"}}):null})]})})}function Gxe({subjectId:e,teachingAssignmentId:t,label:r}){return a.jsx(Kz,{subjectId:e,teachingAssignmentId:t,assessmentKey:"ssa2",label:r||"SSA2"})}const Xb=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],RM=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function _d(e,t,r){return Math.max(t,Math.min(r,e))}function Kxe(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function FM(e,t){if(Array.isArray(e)){const r=e.slice(0,t).map(n=>typeof n=="number"&&Number.isFinite(n)?n:"");for(;r.length<t;)r.push("");return r}return new Array(t).fill("")}function BM(e){const t=(e||[]).filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function Cs(e){return Math.round(e*100)/100}function Yxe(e,t){const r=String(t||"").toLowerCase();return r==="ssa"?"SSA":r==="cia"?"CIA":r==="fa"?"FA":r==="review"?"REVIEW":r==="me"?"ME":r==="lab1"?"LAB1":r==="lab2"?"LAB2":String(t||"").toUpperCase()}function nu(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function Xxe(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function IM(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),i=n.includes("1"),s=n.includes("2");if(i&&s||n==="1&2"||n==="1,2"||n==="1/2"||n==="2/1"||n==="CO1&CO2"||n==="CO1,CO2"||n==="CO1/CO2"||n==="CO2/CO1")return"1&2";if(n==="CO2"||n==="2")return 2;if(n==="CO1"||n==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const i=n.match(/\d+/);return Number(i?i[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===2?2:t===12?"1&2":1}function DM(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const n=e.trim().toUpperCase().replace(/\s+/g,""),i=n.includes("3"),s=n.includes("4");if(i&&s)return"3&4";if(s)return 4;if(i)return 3;if(n==="3&4"||n==="3,4"||n==="3/4"||n==="4/3"||n==="CO3&CO4"||n==="CO3,CO4"||n==="CO3/CO4"||n==="CO4/CO3")return"3&4";if(n==="CO4"||n==="4")return 4;if(n==="CO3"||n==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>{if(typeof n=="string"){const i=n.match(/\d+/);return Number(i?i[0]:n)}return Number(n)}).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(typeof e=="string"?(e.match(/\d+/)||[])[0]:e);return t===4?4:t===3?3:t===34?"3&4":3}function Qxe(e,t){const r=e[t];if(!r)return{co1:0,co2:0};const n=IM(r.co);if(n==="1&2")return{co1:.5,co2:.5};const i=e.some(u=>IM(u==null?void 0:u.co)==="1&2"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!i&&s&&c?{co1:.5,co2:.5}:n===2?{co1:0,co2:1}:{co1:1,co2:0}}function Jxe(e,t){const r=e[t];if(!r)return{co3:0,co4:0};const n=DM(r.co);if(n==="3&4")return{co3:.5,co4:.5};const i=e.some(u=>DM(u==null?void 0:u.co)==="3&4"),s=t===e.length-1,o=String((r==null?void 0:r.key)||"").toLowerCase(),l=String((r==null?void 0:r.label)||"").toLowerCase(),c=o==="q9"||l.includes("q9");return!i&&s&&c?{co3:.5,co4:.5}:n===4?{co3:0,co4:1}:{co3:1,co4:0}}function Zxe({subjectId:e,teachingAssignmentId:t,classType:r,enabledAssessments:n,assessmentType:i,cos:s,cqiDivider:o,cqiMultiplier:l}){var O,X;const[c,u]=x.useState([]),[d,f]=x.useState(!1),[p,h]=x.useState(null),[m,g]=x.useState({}),[y,b]=x.useState({}),[v,w]=x.useState({}),[S,j]=x.useState(null),[k,A]=x.useState(null),R=58,M=x.useMemo(()=>{const F=Number(o);if(Number.isFinite(F)&&F>0)return F;const Q=Number(k==null?void 0:k.divider);return Number.isFinite(Q)&&Q>0?Q:2},[o,k]),B=x.useMemo(()=>{const F=Number(l);if(Number.isFinite(F)&&F>=0)return F;const Q=Number(k==null?void 0:k.multiplier);return Number.isFinite(Q)&&Q>=0?Q:.15},[l,k]),[E,P]=x.useState(!0),[D,G]=x.useState(!0),[H,oe]=x.useState(null),[de,W]=x.useState(!0),[V,ae]=x.useState(!1);x.useEffect(()=>{let F=!0;return(async()=>{try{const Q=await bS();if(!F)return;const K=Number(Q==null?void 0:Q.divider),ne=Number(Q==null?void 0:Q.multiplier);A({options:Array.isArray(Q==null?void 0:Q.options)?Q.options:[],divider:Number.isFinite(K)?K:2,multiplier:Number.isFinite(ne)?ne:.15})}catch{F&&A(null)}})(),()=>{F=!1}},[]);const ee=x.useMemo(()=>!s||!Array.isArray(s)?[]:s.map(F=>{const Q=F.match(/\d+/);return Q?parseInt(Q[0]):null}).filter(F=>F!==null).sort((F,Q)=>F-Q),[s]),C=x.useMemo(()=>{const F={};return ee.forEach(Q=>{const K=`co${Q}`;let ne=null;Object.values(m).forEach(re=>{const T=re&&re[K];if(T&&typeof T.max=="number"){const I=T.max;(ne==null||I>ne)&&(ne=I)}}),F[Q]=ne}),F},[m,ee]);x.useEffect(()=>{let F=!0;return(async()=>{try{const Q=await oc();if(!F)return;j(Q||null)}catch{}})(),()=>{F=!1}},[e]),x.useEffect(()=>{if(!t)return;let F=!0;return f(!0),h(null),(async()=>{try{const Q=await pc(t);if(!F)return;const K=(Q.students||[]).map(ne=>({id:Number(ne.id),reg_no:String(ne.reg_no??""),name:String(ne.name??""),section:ne.section??null})).filter(ne=>Number.isFinite(ne.id)).sort(Xxe);u(K)}catch(Q){if(!F)return;h((Q==null?void 0:Q.message)||"Failed to load roster")}finally{F&&f(!1)}})(),()=>{F=!1}},[t]),x.useEffect(()=>{if(!e||!t)return;const F=`cqi_entries_${e}_${t}`,Q=Qn(F);Q&&typeof Q=="object"&&(b(Q),ae(!1)),(async()=>{try{const K=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",ne=await mr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${K}`,{method:"GET"}).catch(()=>null);if(ne&&ne.ok){const re=await ne.json().catch(()=>null);re!=null&&re.draft&&(b(re.draft.entries||re.draft||{}),oe({updated_at:re.updated_at||null,updated_by:re.updated_by||null}),ae(!1))}}catch{}})()},[e,t]),x.useEffect(()=>{if(!e||!t||c.length===0||ee.length===0)return;let F=!0;return(async()=>{var Q,K,ne,re,T,I,ie,U,Z,me,Pe,je,Fe,_e,He,qe,Pt,ut,Ke,lt,ve,Ae,ce,be,mt,et;try{f(!0);const Ue=ti(r),It=Kxe(n),ht=Ue==="SPECIAL"&&It.size,Lt=hr=>ht?It.has(String(hr).toLowerCase()):!0,yr=Ue==="TCPR",Ar=Ue==="TCPL",Tt=Ue==="LAB"||Ue==="PRACTICAL",Br=!Tt&&Ue!=="SPECIAL"&&ee.some(hr=>hr>=1&&hr<=5),Wr=(()=>{if(!Br)return null;const hr=String(t??"none"),nr=[];Ue==="THEORY"?(nr.push(`model_theory_sheet_${e}_${hr}`),nr.push(`model_theory_sheet_${e}_none`)):Ue==="TCPL"?(nr.push(`model_tcpl_sheet_${e}_${hr}`),nr.push(`model_tcpl_sheet_${e}_none`)):Ue==="TCPR"&&(nr.push(`model_tcpr_sheet_${e}_${hr}`),nr.push(`model_tcpr_sheet_${e}_none`)),nr.push(`model_sheet_${e}`);for(const Mr of nr){const an=Qn(Mr);if(an&&typeof an=="object")return an}return null})(),nn=(()=>{const hr={co1:0,co2:0,co3:0,co4:0,co5:0};for(let nr=0;nr<Xb.length;nr++){const Mr=Xb[nr],an=RM[nr];an===1?hr.co1+=Mr.max:an===2?hr.co2+=Mr.max:an===3?hr.co3+=Mr.max:an===4?hr.co4+=Mr.max:an===5&&(hr.co5+=Mr.max)}return hr})(),fn=hr=>{if(!Wr)return null;const nr=`id:${String(hr.id)}`,Mr=hr.reg_no?`reg:${String(hr.reg_no).trim()}`:"",an=Wr[nr]||(Mr?Wr[Mr]:null)||null;if(!an||typeof an!="object")return null;const it=!!an.absent,Ye=String(an.absentKind||"AL").toUpperCase();if(it&&Ye==="AL")return null;const ct=an.q&&typeof an.q=="object"?an.q:an;let Ht=!1;const fr={co1:0,co2:0,co3:0,co4:0,co5:0};for(let gr=0;gr<Xb.length;gr++){const Ze=Xb[gr],Kt=nu(ct[Ze.key]);if(Kt==null)continue;Ht=!0;const nt=RM[gr];nt===1?fr.co1+=Kt:nt===2?fr.co2+=Kt:nt===3?fr.co3+=Kt:nt===4?fr.co4+=Kt:nt===5&&(fr.co5+=Kt)}if(!Ht)return null;const Sr=(gr,Ze,Kt)=>!Ze||!Number.isFinite(Ze)||Ze<=0?0:_d(_d(gr,0,Ze)/Ze*Kt,0,Kt);return{co1:Sr(fr.co1,nn.co1,2),co2:Sr(fr.co2,nn.co2,2),co3:Sr(fr.co3,nn.co3,2),co4:Sr(fr.co4,nn.co4,2),co5:Sr(fr.co5,nn.co5,4)}},Ir=ee.some(hr=>hr===1||hr===2),dn=ee.some(hr=>hr===3||hr===4),Te=ee.some(hr=>hr===5),[tt,st,kt,jt,ar,tr,Er,se,ue,J,fe,ye,Ce]=await Promise.all([Ir&&Lt("ssa1")&&!Tt?ig(e,t).catch(()=>({marks:{}})):{marks:{}},dn&&Lt("ssa2")&&!Tt?ey(e,t).catch(()=>({marks:{}})):{marks:{}},Ir&&Lt("formative1")&&!Tt&&!yr&&!Ar?_S(e,t).catch(()=>({marks:{}})):{marks:{}},dn&&Lt("formative2")&&!Tt&&!yr&&!Ar?v0("formative2",e,t).catch(()=>({marks:{}})):{marks:{}},Ir&&Lt("cia1")&&!Tt?ty(e,t).catch(()=>({data:null})):{data:null},dn&&Lt("cia2")&&!Tt?w0("cia2",e,t).catch(()=>({data:null})):{data:null},Ir&&Lt("review1")&&yr?wS(e).catch(()=>({marks:{}})):{marks:{}},dn&&Lt("review2")&&yr?SS(e).catch(()=>({marks:{}})):{marks:{}},Ir&&Lt("formative1")&&Ar?(async()=>{try{const hr=await ei("formative1",e,t);if(hr!=null&&hr.draft)return{data:hr.draft.data??hr.draft}}catch{}return Ks("formative1",e,t).catch(()=>({data:null}))})():{data:null},dn&&Lt("formative2")&&Ar?(async()=>{try{const hr=await ei("formative2",e,t);if(hr!=null&&hr.draft)return{data:hr.draft.data??hr.draft}}catch{}return Ks("formative2",e,t).catch(()=>({data:null}))})():{data:null},Ir&&Lt("cia1")&&Tt?(async()=>{try{const hr=await ei("cia1",e,t);if(hr!=null&&hr.draft)return{data:hr.draft.data??hr.draft}}catch{}return Ks("cia1",e,t).catch(()=>({data:null}))})():{data:null},dn&&Lt("cia2")&&Tt?(async()=>{try{const hr=await ei("cia2",e,t);if(hr!=null&&hr.draft)return{data:hr.draft.data??hr.draft}}catch{}return Ks("cia2",e,t).catch(()=>({data:null}))})():{data:null},Te&&Lt("model")&&Tt?(async()=>{try{const hr=await ei("model",e,t);if(hr!=null&&hr.draft)return{data:hr.draft.data??hr.draft}}catch{}return Fm(e,t).catch(()=>({data:null}))})():{data:null}]);if(!F)return;const wt={ssa:1.5,cia:3,fa:2.5},Qe={ssa:wt.ssa,cia:wt.cia,fa:wt.fa},Ie=((Q=S==null?void 0:S.assessments)==null?void 0:Q.ssa1)||{},Re=((K=S==null?void 0:S.assessments)==null?void 0:K.ssa2)||{},xt=((ne=S==null?void 0:S.assessments)==null?void 0:ne.formative1)||{},Gt=((re=S==null?void 0:S.assessments)==null?void 0:re.formative2)||{},qt=((T=S==null?void 0:S.assessments)==null?void 0:T.cia1)||{},Wt=((I=S==null?void 0:S.assessments)==null?void 0:I.cia2)||{},vt=((ie=S==null?void 0:S.assessments)==null?void 0:ie.review1)||{},Rt=((U=S==null?void 0:S.assessments)==null?void 0:U.review2)||{},Zt={ssa1:{co1:Number((Z=Ie==null?void 0:Ie.coMax)==null?void 0:Z.co1)||10,co2:Number((me=Ie==null?void 0:Ie.coMax)==null?void 0:me.co2)||10},ssa2:{co3:Number(((Pe=Re==null?void 0:Re.coMax)==null?void 0:Pe.co3)??((je=Re==null?void 0:Re.coMax)==null?void 0:je.co1))||10,co4:Number(((Fe=Re==null?void 0:Re.coMax)==null?void 0:Fe.co4)??((_e=Re==null?void 0:Re.coMax)==null?void 0:_e.co2))||10},cia1:{co1:Number((He=qt==null?void 0:qt.coMax)==null?void 0:He.co1)||30,co2:Number((qe=qt==null?void 0:qt.coMax)==null?void 0:qe.co2)||30},cia2:{co3:Number(((Pt=Wt==null?void 0:Wt.coMax)==null?void 0:Pt.co3)??((ut=Wt==null?void 0:Wt.coMax)==null?void 0:ut.co1))||30,co4:Number(((Ke=Wt==null?void 0:Wt.coMax)==null?void 0:Ke.co4)??((lt=Wt==null?void 0:Wt.coMax)==null?void 0:lt.co2))||30},f1:{co1:Number(xt==null?void 0:xt.maxCo)||10,co2:Number(xt==null?void 0:xt.maxCo)||10},f2:{co3:Number(Gt==null?void 0:Gt.maxCo)||10,co4:Number(Gt==null?void 0:Gt.maxCo)||10},review1:{co1:Number((ve=vt==null?void 0:vt.coMax)==null?void 0:ve.co1)||15,co2:Number((Ae=vt==null?void 0:vt.coMax)==null?void 0:Ae.co2)||15},review2:{co3:Number(((ce=Rt==null?void 0:Rt.coMax)==null?void 0:ce.co3)??((be=Rt==null?void 0:Rt.coMax)==null?void 0:be.co1))||15,co4:Number(((mt=Rt==null?void 0:Rt.coMax)==null?void 0:mt.co4)??((et=Rt==null?void 0:Rt.coMax)==null?void 0:et.co2))||15}},wr=hr=>{const nr=hr!=null&&hr.sheet&&typeof hr.sheet=="object"?hr.sheet:{},Mr=nr!=null&&nr.rowsByStudentId&&typeof nr.rowsByStudentId=="object"?nr.rowsByStudentId:{},an=_d(Number((nr==null?void 0:nr.expCountA)??0),0,12),it=_d(Number((nr==null?void 0:nr.expCountB)??0),0,12),Ye=Number.isFinite(Number(nr==null?void 0:nr.expMaxA))?Number(nr.expMaxA):25,ct=Number.isFinite(Number(nr==null?void 0:nr.expMaxB))?Number(nr.expMaxB):25,Ht=(nr==null?void 0:nr.ciaExamEnabled)!==!1,fr=30/2,Sr=Ye+(Ht?fr:0),gr=ct+(Ht?fr:0);return{get:Kt=>{const nt=Mr[String(Kt)]||{},bt=FM(nt==null?void 0:nt.marksA,an),St=FM(nt==null?void 0:nt.marksB,it),Ct=BM(bt),$t=BM(St),Vt=nt==null?void 0:nt.ciaExam,Dt=typeof Vt=="number"&&Number.isFinite(Vt)?Vt:null,ze=Ct!=null||$t!=null||Dt!=null,at=ze?(Ct??0)+(Ht?(Dt??0)/2:0):null,_t=ze?($t??0)+(Ht?(Dt??0)/2:0):null;return{a:at==null?null:_d(at,0,Sr),b:_t==null?null:_d(_t,0,gr)}},CO_MAX_A:Sr,CO_MAX_B:gr}},br=Ar?wr((ue==null?void 0:ue.data)??null):null,cr=Ar?wr((J==null?void 0:J.data)??null):null,Tr=Tt?wr((fe==null?void 0:fe.data)??null):null,Kr=Tt?wr((ye==null?void 0:ye.data)??null):null,Yr=Tt?wr((Ce==null?void 0:Ce.data)??null):null,xn={};c.forEach(hr=>{xn[hr.id]={};const nr=Br?fn(hr):null;ee.forEach(Mr=>{let an=null,it=0,Ye=null,ct=0,Ht=null,fr=0,Sr=null,gr=0,Ze=null,Kt=0;if(nr){const bt=`co${Mr}`;bt in nr&&(Ze=Number(nr[bt]),Kt=Mr===5?4:2)}if(Mr===1||Mr===2)if(Tt){if(Tr){const bt=Tr.get(hr.id),St=Mr===1?bt.a:bt.b;St!=null&&(Ye=St,ct=Mr===1?Tr.CO_MAX_A:Tr.CO_MAX_B)}}else{const bt=nu(tt.marks[String(hr.id)]);an=bt==null?null:Number(bt)/2,it=Mr===1?Zt.ssa1.co1:Zt.ssa1.co2;const Ct=ar.data;if(Ct){const Vt=(Ct.rowsByStudentId||{})[String(hr.id)]||{},Dt=Ct.questions||[],ze=Vt!=null&&Vt.q&&typeof Vt.q=="object"?Vt.q:Vt;let at=!1,_t=0,Ft=0;Dt.forEach((pr,or)=>{const Xt=Number((pr==null?void 0:pr.max)||0),xe=Qxe(Dt,or),Ee=Mr===2?xe.co2:xe.co1;Ee>0&&Xt>0&&(Ft+=Xt*Ee);const De=nu(ze==null?void 0:ze[pr.key]);if(De==null||Ee<=0)return;at=!0;const gt=Xt>0?_d(De,0,Xt):De;_t+=gt*Ee}),at&&(Ye=_t,ct=Ft>0?Ft:Mr===1?Zt.cia1.co1:Zt.cia1.co2)}if(yr){const $t=nu(Er.marks[String(hr.id)]),Vt=$t==null?null:Number($t)/2;Vt!=null&&(Ht=Vt,fr=Mr===1?Zt.review1.co1:Zt.review1.co2)}if(Ar&&br){const $t=br.get(hr.id),Vt=Mr===1?$t.a:$t.b;Vt!=null&&(Sr=Vt,gr=Mr===1?br.CO_MAX_A:br.CO_MAX_B)}if(!yr&&!Ar){const $t=(kt.marks||{})[String(hr.id)]||{},Vt=Mr===1?"skill1":"skill2",Dt=Mr===1?"att1":"att2",ze=nu($t[Vt]),at=nu($t[Dt]);ze!==null&&at!==null&&(Sr=ze+at,gr=Mr===1?Zt.f1.co1:Zt.f1.co2)}}else if(Mr===3||Mr===4)if(Tt){if(Kr){const bt=Kr.get(hr.id),St=Mr===3?bt.a:bt.b;St!=null&&(Ye=St,ct=Mr===3?Kr.CO_MAX_A:Kr.CO_MAX_B)}}else{const bt=nu(st.marks[String(hr.id)]);an=bt==null?null:Number(bt)/2,it=Mr===3?Zt.ssa2.co3:Zt.ssa2.co4;const Ct=tr.data;if(Ct){const Vt=(Ct.rowsByStudentId||{})[String(hr.id)]||{},Dt=Ct.questions||[],ze=Vt!=null&&Vt.q&&typeof Vt.q=="object"?Vt.q:Vt;let at=!1,_t=0,Ft=0;Dt.forEach((pr,or)=>{const Xt=Number((pr==null?void 0:pr.max)||0),xe=Jxe(Dt,or),Ee=Mr===4?xe.co4:xe.co3;Ee>0&&Xt>0&&(Ft+=Xt*Ee);const De=nu(ze==null?void 0:ze[pr.key]);if(De==null||Ee<=0)return;at=!0;const gt=Xt>0?_d(De,0,Xt):De;_t+=gt*Ee}),at&&(Ye=_t,ct=Ft>0?Ft:Mr===3?Zt.cia2.co3:Zt.cia2.co4)}if(yr){const $t=nu(se.marks[String(hr.id)]),Vt=$t==null?null:Number($t)/2;Vt!=null&&(Ht=Vt,fr=Mr===3?Zt.review2.co3:Zt.review2.co4)}if(Ar&&cr){const $t=cr.get(hr.id),Vt=Mr===3?$t.a:$t.b;Vt!=null&&(Sr=Vt,gr=Mr===3?cr.CO_MAX_A:cr.CO_MAX_B)}if(!yr&&!Ar){const $t=(jt.marks||{})[String(hr.id)]||{},Vt=Mr===3?"skill1":"skill2",Dt=Mr===3?"att1":"att2",ze=nu($t[Vt]),at=nu($t[Dt]);ze!==null&&at!==null&&(Sr=ze+at,gr=Mr===3?Zt.f2.co3:Zt.f2.co4)}}if(Tt&&Mr===5&&Yr){const bt=Yr.get(hr.id);bt.a!=null&&(Ze=bt.a,Kt=Yr.CO_MAX_A)}const nt=[];if(an!==null&&it>0&&nt.push({key:"ssa",mark:an,max:it,w:Qe.ssa}),Ye!==null&&ct>0&&nt.push({key:"cia",mark:Ye,max:ct,w:Qe.cia}),Ht!==null&&fr>0&&nt.push({key:"review",mark:Ht,max:fr,w:Qe.fa}),Sr!==null&&gr>0){const bt=Ar?Mr===1||Mr===2?"lab1":Mr===3||Mr===4?"lab2":"fa":"fa";nt.push({key:bt,mark:Sr,max:gr,w:Qe.fa})}if(Ze!==null&&Kt>0&&nt.push({key:"me",mark:Ze,max:Kt,w:Kt}),nt.length>0){const St=nt.reduce((Vt,Dt)=>Vt+Dt.w,0),Ct=nt.reduce((Vt,Dt)=>{const ze=Dt.mark/Dt.max;return Vt+ze*Dt.w},0),$t=nt.map(Vt=>({...Vt,contrib:Cs(Vt.mark/Vt.max*Vt.w)}));xn[hr.id][`co${Mr}`]={value:Cs(Ct),max:Cs(St),breakdown:$t}}else xn[hr.id][`co${Mr}`]=null})}),g(xn)}catch(Ue){if(!F)return;h((Ue==null?void 0:Ue.message)||"Failed to calculate CO totals")}finally{F&&f(!1)}})(),()=>{F=!1}},[e,t,r,n,c,ee,S]);const Y=(F,Q,K)=>{if(K===""){w(I=>{const ie={...I};return delete ie[`${F}_${Q}`],ie}),b(I=>({...I,[F]:{...I[F],[Q]:null}}));return}const ne=Number(K);if(!(Number.isFinite(ne)&&Math.floor(ne)===ne)){w(I=>({...I,[`${F}_${Q}`]:"Enter an integer between 0 and 10"})),b(I=>({...I,[F]:{...I[F],[Q]:null}}));return}const T=ne;if(T<0||T>10){w(I=>({...I,[`${F}_${Q}`]:"Value must be between 0 and 10"})),b(I=>({...I,[F]:{...I[F],[Q]:T}}));return}w(I=>{const ie={...I};return delete ie[`${F}_${Q}`],ie}),b(I=>{const ie={...I,[F]:{...I[F],[Q]:T}};if(e&&t){const U=`cqi_entries_${e}_${t}`;try{Gn(U,ie)}catch{}}return ae(!0),ie})},q=()=>{if(!(!e||!t)){if(Object.keys(v).length){alert("Fix CQI input errors before saving");return}(async()=>{const F=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"";try{const K=await mr(`/api/obe/cqi-save/${encodeURIComponent(String(e))}${F}`,{method:"PUT",body:JSON.stringify({entries:y})}).catch(()=>null);if(K&&K.ok){alert("CQI entries saved to server"),ae(!1);try{const ne=await K.json().catch(()=>null);ne&&oe(ne)}catch{}return}}catch{}const Q=`cqi_entries_${e}_${t}`;try{Gn(Q,y),ae(!1),alert("CQI entries saved locally")}catch(K){alert("Failed to save CQI entries: "+String((K==null?void 0:K.message)||K))}})()}};return!e||!t?a.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"Missing subject ID or teaching assignment ID"}):d?a.jsx("div",{style:{padding:24,textAlign:"center",color:"#6b7280"},children:"Loading CQI data..."}):p?a.jsxs("div",{style:{padding:24,color:"#b91c1c"},children:["Error: ",p]}):ee.length===0?a.jsx("div",{style:{padding:24,color:"#b91c1c"},children:"No course outcomes selected for CQI entry"}):a.jsxs("div",{style:{padding:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16,padding:16,background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",borderRadius:12,border:"1px solid #bae6fd"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#0f172a"},children:["CQI Entry - ",s==null?void 0:s.join(", ")]}),a.jsxs("div",{style:{marginTop:4,fontSize:14,color:"#64748b"},children:["Students below ",R,"% threshold require CQI intervention"]})]}),a.jsx("button",{onClick:q,className:"obe-btn obe-btn-primary",style:{minWidth:100},children:"Save CQI"}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("button",{type:"button",onClick:()=>P(F=>!F),className:"obe-btn",style:{minWidth:90,background:E?"#fef3c7":void 0},children:E?"DEBUG ON":"DEBUG"}),a.jsx("button",{type:"button",onClick:()=>G(F=>!F),className:"obe-btn",style:{minWidth:120},children:D?"Hide Header Max":"Show Header Max"}),a.jsx("button",{type:"button",onClick:async()=>{if(!e||!t)return alert("Missing subject/teaching assignment");try{const F={entries:y},Q=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",K=await mr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${Q}`,{method:"PUT",body:JSON.stringify(F)}).catch(()=>null);if(K&&K.ok){const ne=await K.json().catch(()=>null);oe(ne||{updated_at:new Date().toISOString(),updated_by:null}),ae(!1),alert("Draft saved to server")}else{const ne=`cqi_entries_${e}_${t}`;try{Gn(ne,y),ae(!1),alert("Draft saved locally")}catch{alert("Failed to save draft")}}}catch(F){alert("Failed to save draft: "+String((F==null?void 0:F.message)||F))}},className:"obe-btn",style:{minWidth:110},children:"Save Draft"}),a.jsx("button",{type:"button",onClick:async()=>{if(!e)return alert("Missing subject");if(confirm("Publish CQI to DB? This action cannot be undone."))try{const F=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",Q=await mr(`/api/obe/cqi-publish/${encodeURIComponent(String(e))}${F}`,{method:"POST"}).catch(()=>null);Q&&Q.ok?alert("CQI published"):alert("Publish failed (server may not support CQI publish)")}catch(F){alert("Publish failed: "+String((F==null?void 0:F.message)||F))}},className:"obe-btn obe-btn-primary",style:{minWidth:110},children:"Publish"})]})]}),a.jsxs("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 12px",background:"#f8fafc",borderBottom:"1px solid #e6eef8"},children:[a.jsxs("div",{style:{fontSize:13,color:"#475569"},children:["Draft: ",H!=null&&H.updated_at?new Date(String(H.updated_at)).toLocaleString():"never"," ",H!=null&&H.updated_by?`by ${((O=H.updated_by)==null?void 0:O.name)||((X=H.updated_by)==null?void 0:X.username)||H.updated_by}`:"",V?"  unsaved changes":""]}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:13,color:"#475569"},children:[a.jsx("input",{type:"checkbox",checked:de,onChange:()=>W(F=>!F)})," Auto-save"]}),a.jsx("button",{className:"obe-btn",onClick:()=>{(async()=>{if(!e||!t)return alert("Missing subject/TA");try{const F=t?`?teaching_assignment_id=${encodeURIComponent(String(t))}`:"",Q=await mr(`/api/obe/cqi-draft/${encodeURIComponent(String(e))}${F}`,{method:"PUT",body:JSON.stringify({entries:y})}).catch(()=>null);if(Q&&Q.ok){const K=await Q.json().catch(()=>null);oe(K||null),ae(!1),alert("Draft synced to server")}else alert("Server save failed")}catch(F){alert("Server save failed: "+String((F==null?void 0:F.message)||F))}})()},children:"Sync Draft"})]})]}),a.jsxs("table",{className:"cqi-table",style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},children:[a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:60},children:"S.No"}),a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:120},children:"Reg No"}),a.jsx("th",{style:{padding:"12px 8px",textAlign:"left",fontWeight:700,color:"#475569",minWidth:200},children:"Name"}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["BEFORE CQI",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:100},children:["AFTER CQI",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Total / Max"})]}),a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:120},children:["TOTAL",a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:"Sum of selected COs"})]}),ee.map(F=>a.jsxs("th",{style:{padding:"12px 8px",textAlign:"center",fontWeight:700,color:"#475569",minWidth:150},children:["CO",F,a.jsx("div",{style:{fontSize:11,fontWeight:400,color:"#94a3b8",marginTop:2},children:D?a.jsxs(a.Fragment,{children:["Max: ",C[F]!=null?Cs(C[F]):""]}):a.jsx(a.Fragment,{children:""})})]},F))]})}),a.jsx("tbody",{children:c.map((F,Q)=>{const K=m[F.id]||{};let ne=0,re=0;ee.forEach(_e=>{const He=K[`co${_e}`];He&&(ne+=He.value,re+=He.max)});const T=ne,I=re,ie=I?T/I*100:0,U=re?ne/re*100:0,Z=I?ie:U,me=re;let Pe=ne,je=0;ee.forEach(_e=>{var Ae;const He=`co${_e}`,qe=K[He],Pt=(Ae=y[F.id])==null?void 0:Ae[He];if(!qe||Pt==null||!((qe.max?Number(qe.value)/Number(qe.max)*100:0)<R))return;const lt=Number(Pt)/10*Number(qe.max),ve=Z<R?lt/M:lt*B;Number.isFinite(ve)&&ve>0&&(je+=ve,Pe+=ve)}),Pe=Number.isFinite(Pe)?_d(Pe,0,me||Pe):ne;const Fe=me?Pe/me*100:0;return a.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",backgroundColor:Q%2===0?"white":"#f9fafb"},children:[a.jsx("td",{style:{padding:"10px 8px",color:"#64748b"},children:Q+1}),a.jsx("td",{style:{padding:"10px 8px",fontFamily:"monospace",color:"#0f172a"},children:F.reg_no}),a.jsx("td",{style:{padding:"10px 8px",color:"#0f172a"},children:F.name}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600},children:re>0?a.jsxs("div",{children:[a.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[Cs(ne),!E&&re>0?a.jsxs(a.Fragment,{children:[" / ",Cs(re)]}):null]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",Cs(U),"%)"]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:600,backgroundColor:Pe>ne?"#f0fdf4":"transparent"},children:me>0?a.jsxs("div",{children:[a.jsxs("div",{style:{color:"#0f172a",fontSize:14},children:[Cs(Pe),!E&&me>0?a.jsxs(a.Fragment,{children:[" / ",Cs(me)]}):null]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:["(",Cs(Fe),"%)"]}),je>0&&a.jsxs("div",{style:{fontSize:11,color:"#16a34a",marginTop:2},children:["+",Cs(je)]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",fontWeight:700},children:I>0?a.jsxs("div",{style:{backgroundColor:ie<R?"#fff1f2":"transparent",padding:6,borderRadius:6},children:[a.jsxs("div",{style:{color:ie<R?"#ef4444":"#0f172a",fontSize:14,fontWeight:800},children:[Cs(ie),"%"]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",marginTop:6},children:[Cs(T),!E&&I>0?a.jsxs(a.Fragment,{children:[" / ",Cs(I)]}):null]})]}):a.jsx("span",{style:{color:"#94a3b8"},children:""})}),ee.map(_e=>{var lt;const He=`co${_e}`,qe=K[He];if(!qe)return a.jsx("td",{style:{padding:"10px 8px",textAlign:"center",color:"#94a3b8"},children:""},_e);const Pt=qe.max?qe.value/qe.max*100:0,ut=Pt<R,Ke=(lt=y[F.id])==null?void 0:lt[He];return a.jsxs("td",{style:{padding:"10px 8px",textAlign:"center",backgroundColor:ut?"#fef2f2":"#f0fdf4"},children:[a.jsxs("div",{style:{fontSize:13,color:"#64748b",marginBottom:6},children:[a.jsxs("div",{children:[Cs(qe.value)," (",Cs(Pt),"%)"]}),E?null:Array.isArray(qe.breakdown)&&a.jsx("div",{style:{marginTop:6,fontSize:11,color:"#94a3b8"},children:qe.breakdown.map(ve=>a.jsxs("div",{style:{display:"inline-block",marginRight:8},children:[Yxe(ti(r),String(ve.key||"")),": ",Cs(ve.mark)," / ",Cs(ve.max)," =",Cs(ve.contrib)]},ve.key))})]}),ut?a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:11,color:"#dc2626",fontWeight:600,marginBottom:4},children:"CQI ATTAINED"}),a.jsx("input",{type:"number",value:Ke??"",onChange:ve=>Y(F.id,He,ve.target.value),placeholder:"Enter CQI",className:"obe-input",style:{width:90,padding:"4px 8px",fontSize:13,textAlign:"center"}}),v[`${F.id}_${He}`]&&a.jsx("div",{style:{color:"#dc2626",fontSize:11,marginTop:6},children:v[`${F.id}_${He}`]})]}):a.jsx("div",{style:{fontSize:12,color:"#16a34a",fontWeight:600},children:" NO CQI"})]},_e)})]},F.id)})})]})]}),c.length===0&&a.jsx("div",{style:{textAlign:"center",padding:32,color:"#94a3b8"},children:"No students found in this section"})]})}function Yz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=Yz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Si(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=Yz(e))&&(n&&(n+=" "),n+=t);return n}var e1e=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function vC(e){if(typeof e!="string")return!1;var t=e1e;return t.includes(e)}var t1e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],r1e=new Set(t1e);function Xz(e){return typeof e!="string"?!1:r1e.has(e)}function Qz(e){return typeof e=="string"&&e.startsWith("data-")}function cl(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Xz(r)||Qz(r))&&(t[r]=e[r]);return t}function yh(e){if(e==null)return null;if(x.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return cl(t)}return typeof e=="object"&&!Array.isArray(e)?cl(e):null}function Vo(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Xz(r)||Qz(r)||vC(r))&&(t[r]=e[r]);return t}function n1e(e){return e==null?null:x.isValidElement(e)?Vo(e.props):typeof e=="object"&&!Array.isArray(e)?Vo(e):null}var i1e=["children","width","height","viewBox","className","style","title","desc"];function oA(){return oA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oA.apply(null,arguments)}function a1e(e,t){if(e==null)return{};var r,n,i=s1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function s1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var wC=x.forwardRef((e,t)=>{var{children:r,width:n,height:i,viewBox:s,className:o,style:l,title:c,desc:u}=e,d=a1e(e,i1e),f=s||{width:n,height:i,x:0,y:0},p=Si("recharts-surface",o);return x.createElement("svg",oA({},Vo(d),{className:p,width:n,height:i,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),x.createElement("title",null,c),x.createElement("desc",null,u),r)}),o1e=["children","className"];function lA(){return lA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lA.apply(null,arguments)}function l1e(e,t){if(e==null)return{};var r,n,i=c1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function c1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ja=x.forwardRef((e,t)=>{var{children:r,className:n}=e,i=l1e(e,o1e),s=Si("recharts-layer",n);return x.createElement("g",lA({className:s},Vo(i),{ref:t}),r)}),Jz=x.createContext(null),u1e=()=>x.useContext(Jz);function sa(e){return function(){return e}}const Zz=Math.cos,J2=Math.sin,ku=Math.sqrt,Z2=Math.PI,FS=2*Z2,cA=Math.PI,uA=2*cA,Uh=1e-6,d1e=uA-Uh;function eW(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function f1e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return eW;const r=10**t;return function(n){this._+=n[0];for(let i=1,s=n.length;i<s;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class h1e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?eW:f1e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,s,o){this._append`C${+t},${+r},${+n},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(t,r,n,i,s){if(t=+t,r=+r,n=+n,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=n-t,u=i-r,d=o-t,f=l-r,p=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>Uh)if(!(Math.abs(f*c-u*d)>Uh)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-o,m=i-l,g=c*c+u*u,y=h*h+m*m,b=Math.sqrt(g),v=Math.sqrt(p),w=s*Math.tan((cA-Math.acos((g+p-y)/(2*b*v)))/2),S=w/v,j=w/b;Math.abs(S-1)>Uh&&this._append`L${t+S*d},${r+S*f}`,this._append`A${s},${s},0,0,${+(f*h>d*m)},${this._x1=t+j*c},${this._y1=r+j*u}`}}arc(t,r,n,i,s,o){if(t=+t,r=+r,n=+n,o=!!o,n<0)throw new Error(`negative radius: ${n}`);let l=n*Math.cos(i),c=n*Math.sin(i),u=t+l,d=r+c,f=1^o,p=o?i-s:s-i;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Uh||Math.abs(this._y1-d)>Uh)&&this._append`L${u},${d}`,n&&(p<0&&(p=p%uA+uA),p>d1e?this._append`A${n},${n},0,1,${f},${t-l},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:p>Uh&&this._append`A${n},${n},0,${+(p>=cA)},${f},${this._x1=t+n*Math.cos(s)},${this._y1=r+n*Math.sin(s)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function SC(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new h1e(t)}function _C(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tW(e){this._context=e}tW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function BS(e){return new tW(e)}function rW(e){return e[0]}function nW(e){return e[1]}function iW(e,t){var r=sa(!0),n=null,i=BS,s=null,o=SC(l);e=typeof e=="function"?e:e===void 0?rW:sa(e),t=typeof t=="function"?t:t===void 0?nW:sa(t);function l(c){var u,d=(c=_C(c)).length,f,p=!1,h;for(n==null&&(s=i(h=o())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===p&&((p=!p)?s.lineStart():s.lineEnd()),p&&s.point(+e(f,u,c),+t(f,u,c));if(h)return s=null,h+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:sa(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:sa(+c),l):t},l.defined=function(c){return arguments.length?(r=typeof c=="function"?c:sa(!!c),l):r},l.curve=function(c){return arguments.length?(i=c,n!=null&&(s=i(n)),l):i},l.context=function(c){return arguments.length?(c==null?n=s=null:s=i(n=c),l):n},l}function Qb(e,t,r){var n=null,i=sa(!0),s=null,o=BS,l=null,c=SC(u);e=typeof e=="function"?e:e===void 0?rW:sa(+e),t=typeof t=="function"?t:sa(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?nW:sa(+r);function u(f){var p,h,m,g=(f=_C(f)).length,y,b=!1,v,w=new Array(g),S=new Array(g);for(s==null&&(l=o(v=c())),p=0;p<=g;++p){if(!(p<g&&i(y=f[p],p,f))===b)if(b=!b)h=p,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),m=p-1;m>=h;--m)l.point(w[m],S[m]);l.lineEnd(),l.areaEnd()}b&&(w[p]=+e(y,p,f),S[p]=+t(y,p,f),l.point(n?+n(y,p,f):w[p],r?+r(y,p,f):S[p]))}if(v)return l=null,v+""||null}function d(){return iW().defined(i).curve(o).context(s)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:sa(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:sa(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:sa(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:sa(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:sa(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:sa(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(i=typeof f=="function"?f:sa(!!f),u):i},u.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),u):o},u.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),u):s},u}class aW{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function p1e(e){return new aW(e,!0)}function m1e(e){return new aW(e,!1)}const jC={draw(e,t){const r=ku(t/Z2);e.moveTo(r,0),e.arc(0,0,r,0,FS)}},g1e={draw(e,t){const r=ku(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},sW=ku(1/3),x1e=sW*2,y1e={draw(e,t){const r=ku(t/x1e),n=r*sW;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},b1e={draw(e,t){const r=ku(t),n=-r/2;e.rect(n,n,r,r)}},v1e=.8908130915292852,oW=J2(Z2/10)/J2(7*Z2/10),w1e=J2(FS/10)*oW,S1e=-Zz(FS/10)*oW,_1e={draw(e,t){const r=ku(t*v1e),n=w1e*r,i=S1e*r;e.moveTo(0,-r),e.lineTo(n,i);for(let s=1;s<5;++s){const o=FS*s/5,l=Zz(o),c=J2(o);e.lineTo(c*r,-l*r),e.lineTo(l*n-c*i,c*n+l*i)}e.closePath()}},Uj=ku(3),j1e={draw(e,t){const r=-ku(t/(Uj*3));e.moveTo(0,r*2),e.lineTo(-Uj*r,-r),e.lineTo(Uj*r,-r),e.closePath()}},jc=-.5,kc=ku(3)/2,dA=1/ku(12),k1e=(dA/2+1)*3,A1e={draw(e,t){const r=ku(t/k1e),n=r/2,i=r*dA,s=n,o=r*dA+r,l=-s,c=o;e.moveTo(n,i),e.lineTo(s,o),e.lineTo(l,c),e.lineTo(jc*n-kc*i,kc*n+jc*i),e.lineTo(jc*s-kc*o,kc*s+jc*o),e.lineTo(jc*l-kc*c,kc*l+jc*c),e.lineTo(jc*n+kc*i,jc*i-kc*n),e.lineTo(jc*s+kc*o,jc*o-kc*s),e.lineTo(jc*l+kc*c,jc*c-kc*l),e.closePath()}};function N1e(e,t){let r=null,n=SC(i);e=typeof e=="function"?e:sa(e||jC),t=typeof t=="function"?t:sa(t===void 0?64:+t);function i(){let s;if(r||(r=s=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:sa(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:sa(+s),i):t},i.context=function(s){return arguments.length?(r=s??null,i):r},i}function ew(){}function tw(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function lW(e){this._context=e}lW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:tw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:tw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function C1e(e){return new lW(e)}function cW(e){this._context=e}cW.prototype={areaStart:ew,areaEnd:ew,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:tw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function E1e(e){return new cW(e)}function uW(e){this._context=e}uW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:tw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function T1e(e){return new uW(e)}function dW(e){this._context=e}dW.prototype={areaStart:ew,areaEnd:ew,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function P1e(e){return new dW(e)}function $M(e){return e<0?-1:1}function UM(e,t,r){var n=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(n||i<0&&-0),o=(r-e._y1)/(i||n<0&&-0),l=(s*i+o*n)/(n+i);return($M(s)+$M(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function zM(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function zj(e,t,r){var n=e._x0,i=e._y0,s=e._x1,o=e._y1,l=(s-n)/3;e._context.bezierCurveTo(n+l,i+l*t,s-l,o-l*r,s,o)}function rw(e){this._context=e}rw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:zj(this,this._t0,zM(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,zj(this,zM(this,r=UM(this,e,t)),r);break;default:zj(this,this._t0,r=UM(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function fW(e){this._context=new hW(e)}(fW.prototype=Object.create(rw.prototype)).point=function(e,t){rw.prototype.point.call(this,t,e)};function hW(e){this._context=e}hW.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,s){this._context.bezierCurveTo(t,e,n,r,s,i)}};function O1e(e){return new rw(e)}function M1e(e){return new fW(e)}function pW(e){this._context=e}pW.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=WM(e),i=WM(t),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(n[0][s],i[0][s],n[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function WM(e){var t,r=e.length-1,n,i=new Array(r),s=new Array(r),o=new Array(r);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,s[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/s[t-1],s[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/s[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function L1e(e){return new pW(e)}function IS(e,t){this._context=e,this._t=t}IS.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function R1e(e){return new IS(e,.5)}function F1e(e){return new IS(e,0)}function B1e(e){return new IS(e,1)}function T0(e,t){if((o=e.length)>1)for(var r=1,n,i,s=e[t[0]],o,l=s.length;r<o;++r)for(i=s,s=e[t[r]],n=0;n<l;++n)s[n][1]+=s[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function fA(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function I1e(e,t){return e[t]}function D1e(e){const t=[];return t.key=e,t}function $1e(){var e=sa([]),t=fA,r=T0,n=I1e;function i(s){var o=Array.from(e.apply(this,arguments),D1e),l,c=o.length,u=-1,d;for(const f of s)for(l=0,++u;l<c;++l)(o[l][u]=[0,+n(f,o[l].key,u,s)]).data=f;for(l=0,d=_C(t(o));l<c;++l)o[d[l]].index=l;return r(o,d),o}return i.keys=function(s){return arguments.length?(e=typeof s=="function"?s:sa(Array.from(s)),i):e},i.value=function(s){return arguments.length?(n=typeof s=="function"?s:sa(+s),i):n},i.order=function(s){return arguments.length?(t=s==null?fA:typeof s=="function"?s:sa(Array.from(s)),i):t},i.offset=function(s){return arguments.length?(r=s??T0,i):r},i}function U1e(e,t){if((n=e.length)>0){for(var r,n,i=0,s=e[0].length,o;i<s;++i){for(o=r=0;r<n;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<n;++r)e[r][i][1]/=o}T0(e,t)}}function z1e(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,s=n.length;r<s;++r){for(var o=0,l=0;o<i;++o)l+=e[o][r][1]||0;n[r][1]+=n[r][0]=-l/2}T0(e,t)}}function W1e(e,t){if(!(!((o=e.length)>0)||!((s=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,s,o;n<s;++n){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],f=d[n][1]||0,p=d[n-1][1]||0,h=(f-p)/2,m=0;m<l;++m){var g=e[t[m]],y=g[n][1]||0,b=g[n-1][1]||0;h+=y-b}c+=f,u+=h*f}i[n-1][1]+=i[n-1][0]=r,c&&(r-=u/c)}i[n-1][1]+=i[n-1][0]=r,T0(e,t)}}var DS={},mW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(mW);var kC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(kC);var $S={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})($S);var US={},gW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(gW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gW,r=$S;function n(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=t.toString(i);const s=[],o=i.length;if(o===0)return s;let l=0,c="",u="",d=!1;for(i.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=i[l];u?f==="\\"&&l+1<o?(l++,c+=i[l]):f===u?u="":c+=f:d?f==='"'||f==="'"?u=f:f==="]"?(d=!1,s.push(c),c=""):c+=f:f==="["?(d=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}e.toPath=n})(US);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=mW,r=kC,n=$S,i=US;function s(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?r.isDeepKey(c)?s(l,i.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=l[c];return d===void 0?u:d}default:{if(Array.isArray(c))return o(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=l[c];return d===void 0?u:d}}}function o(l,c,u){if(c.length===0)return u;let d=l;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=s})(DS);var q1e=DS.get;const P0=sf(q1e);var H1e=4;function Xf(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:H1e,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function za(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((i,s,o)=>{var l=r[o-1];return typeof l=="string"?i+l+s:l!==void 0?i+Xf(l)+s:i+s},"")}var Xs=e=>e===0?0:e>0?1:-1,nd=e=>typeof e=="number"&&e!=+e,O0=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,An=e=>(typeof e=="number"||e instanceof Number)&&!nd(e),Hc=e=>An(e)||typeof e=="string",V1e=0,k1=e=>{var t=++V1e;return"".concat(e||"").concat(t)},Wo=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!An(t)&&typeof t!="string")return n;var s;if(O0(t)){if(r==null)return n;var o=t.indexOf("%");s=r*parseFloat(t.slice(0,o))/100}else s=+t;return nd(s)&&(s=n),i&&r!=null&&s>r&&(s=r),s},xW=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Xi(e,t,r){return An(e)&&An(t)?Xf(e+r*(t-e)):t}function yW(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):P0(n,t))===r)}var G1e=e=>{for(var t=e.length,r=0,n=0,i=0,s=0,o=1/0,l=-1/0,c=0,u=0,d=0;d<t;d++){var f,p;c=((f=e[d])===null||f===void 0?void 0:f.cx)||0,u=((p=e[d])===null||p===void 0?void 0:p.cy)||0,r+=c,n+=u,i+=c*u,s+=c*c,o=Math.min(o,c),l=Math.max(l,c)}var h=t*s!==r*r?(t*i-r*n)/(t*s-r*r):0;return{xmin:o,xmax:l,a:h,b:(n-h*r)/t}},Qi=e=>e===null||typeof e>"u",fy=e=>Qi(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function _l(e){return e!=null}function np(){}var K1e=["type","size","sizeType"];function hA(){return hA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hA.apply(null,arguments)}function qM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function HM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qM(Object(r),!0).forEach(function(n){Y1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Y1e(e,t,r){return(t=X1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X1e(e){var t=Q1e(e,"string");return typeof t=="symbol"?t:t+""}function Q1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J1e(e,t){if(e==null)return{};var r,n,i=Z1e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Z1e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var bW={symbolCircle:jC,symbolCross:g1e,symbolDiamond:y1e,symbolSquare:b1e,symbolStar:_1e,symbolTriangle:j1e,symbolWye:A1e},eye=Math.PI/180,tye=e=>{var t="symbol".concat(fy(e));return bW[t]||jC},rye=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*eye;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},nye=(e,t)=>{bW["symbol".concat(fy(e))]=t},zS=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,i=J1e(e,K1e),s=HM(HM({},i),{},{type:t,size:r,sizeType:n}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var p=tye(o),h=N1e().type(p).size(rye(r,n,o)),m=h();if(m!==null)return m},{className:c,cx:u,cy:d}=s,f=Vo(s);return An(u)&&An(d)&&An(r)?x.createElement("path",hA({},f,{className:Si("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(d,")"),d:l()})):null};zS.registerSymbol=nye;var vW=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,AC=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(x.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{vC(i)&&(n[i]=s=>r[i](r,s))}),n},iye=(e,t,r)=>n=>(e(t,r,n),null),hg=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(i=>{var s=e[i];vC(i)&&typeof s=="function"&&(n||(n={}),n[i]=iye(s,t,r))}),n},aye=e=>Array.isArray(e)&&e.length>0;function VM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function sye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?VM(Object(r),!0).forEach(function(n){oye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):VM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oye(e,t,r){return(t=lye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lye(e){var t=cye(e,"string");return typeof t=="symbol"?t:t+""}function cye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(e,t){var r=sye({},e),n=t,i=Object.keys(t),s=i.reduce((o,l)=>(o[l]===void 0&&n[l]!==void 0&&(o[l]=n[l]),o),r);return s}function nw(){return nw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},nw.apply(null,arguments)}function GM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uye(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GM(Object(r),!0).forEach(function(n){dye(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dye(e,t,r){return(t=fye(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fye(e){var t=hye(e,"string");return typeof t=="symbol"?t:t+""}function hye(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Tc=32,pye={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function mye(e){var{data:t,iconType:r,inactiveColor:n}=e,i=Tc/2,s=Tc/6,o=Tc/3,l=t.inactive?n:t.color,c=r??t.type;if(c==="none")return null;if(c==="plainline"){var u;return x.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:(u=t.payload)===null||u===void 0?void 0:u.strokeDasharray,x1:0,y1:i,x2:Tc,y2:i,className:"recharts-legend-icon"})}if(c==="line")return x.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(i,"h").concat(o,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(2*o,",").concat(i,`
            H`).concat(Tc,"M").concat(2*o,",").concat(i,`
            A`).concat(s,",").concat(s,",0,1,1,").concat(o,",").concat(i),className:"recharts-legend-icon"});if(c==="rect")return x.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(Tc/8,"h").concat(Tc,"v").concat(Tc*3/4,"h").concat(-Tc,"z"),className:"recharts-legend-icon"});if(x.isValidElement(t.legendIcon)){var d=uye({},t);return delete d.legendIcon,x.cloneElement(t.legendIcon,d)}return x.createElement(zS,{fill:l,cx:i,cy:i,size:Tc,sizeType:"diameter",type:c})}function gye(e){var{payload:t,iconSize:r,layout:n,formatter:i,inactiveColor:s,iconType:o}=e,l={x:0,y:0,width:Tc,height:Tc},c={display:n==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((d,f)=>{var p=d.formatter||i,h=Si({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:d.inactive});if(d.type==="none")return null;var m=d.inactive?s:d.color,g=p?p(d.value,d,f):d.value;return x.createElement("li",nw({className:h,style:c,key:"legend-item-".concat(f)},hg(e,d,f)),x.createElement(wC,{width:r,height:r,viewBox:l,style:u,"aria-label":"".concat(g," legend icon")},x.createElement(mye,{data:d,iconType:o,inactiveColor:s})),x.createElement("span",{className:"recharts-legend-item-text",style:{color:m}},g))})}var xye=e=>{var t=ka(e,pye),{payload:r,layout:n,align:i}=t;if(!r||!r.length)return null;var s={padding:0,margin:0,textAlign:n==="horizontal"?i:"left"};return x.createElement("ul",{className:"recharts-default-legend",style:s},x.createElement(gye,nw({},t,{payload:r})))},wW={},SW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const i=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=n(o,s,r);i.has(l)||i.set(l,o)}return Array.from(i.values())}e.uniqBy=t})(SW);var _W={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...i){return r.apply(this,i.slice(0,n))}}e.ary=t})(_W);var NC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(NC);var jW={},WS={},kW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(kW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kW;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(WS);var AW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(AW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WS,r=AW;function n(i){return r.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=n})(jW);var NW={},CW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=DS;function r(n){return function(i){return t.get(i,n)}}e.property=r})(CW);var EW={},CC={},TW={},EC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(EC);var TC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(TC);var PC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(PC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EC,r=TC,n=PC;function i(d,f,p){return typeof p!="function"?i(d,f,()=>{}):s(d,f,function h(m,g,y,b,v,w){const S=p(m,g,y,b,v,w);return S!==void 0?!!S:s(m,g,h,w)},new Map)}function s(d,f,p,h){if(f===d)return!0;switch(typeof f){case"object":return o(d,f,p,h);case"function":return Object.keys(f).length>0?s(d,{...f},p,h):n.isEqualsSameValueZero(d,f);default:return t.isObject(d)?typeof f=="string"?f==="":!0:n.isEqualsSameValueZero(d,f)}}function o(d,f,p,h){if(f==null)return!0;if(Array.isArray(f))return c(d,f,p,h);if(f instanceof Map)return l(d,f,p,h);if(f instanceof Set)return u(d,f,p,h);const m=Object.keys(f);if(d==null||r.isPrimitive(d))return m.length===0;if(m.length===0)return!0;if(h!=null&&h.has(f))return h.get(f)===d;h==null||h.set(f,d);try{for(let g=0;g<m.length;g++){const y=m[g];if(!r.isPrimitive(d)&&!(y in d)||f[y]===void 0&&d[y]!==void 0||f[y]===null&&d[y]!==null||!p(d[y],f[y],y,d,f,h))return!1}return!0}finally{h==null||h.delete(f)}}function l(d,f,p,h){if(f.size===0)return!0;if(!(d instanceof Map))return!1;for(const[m,g]of f.entries()){const y=d.get(m);if(p(y,g,m,d,f,h)===!1)return!1}return!0}function c(d,f,p,h){if(f.length===0)return!0;if(!Array.isArray(d))return!1;const m=new Set;for(let g=0;g<f.length;g++){const y=f[g];let b=!1;for(let v=0;v<d.length;v++){if(m.has(v))continue;const w=d[v];let S=!1;if(p(w,y,g,d,f,h)&&(S=!0),S){m.add(v),b=!0;break}}if(!b)return!1}return!0}function u(d,f,p,h){return f.size===0?!0:d instanceof Set?c([...d],[...f],p,h):!1}e.isMatchWith=i,e.isSetMatch=u})(TW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TW;function r(n,i){return t.isMatchWith(n,i,()=>{})}e.isMatch=r})(CC);var PW={},OC={},OW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(OW);var qS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(qS);var MC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",p="[object ArrayBuffer]",h="[object Object]",m="[object Error]",g="[object DataView]",y="[object Uint8Array]",b="[object Uint8ClampedArray]",v="[object Uint16Array]",w="[object Uint32Array]",S="[object BigUint64Array]",j="[object Int8Array]",k="[object Int16Array]",A="[object Int32Array]",R="[object BigInt64Array]",M="[object Float32Array]",B="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=p,e.arrayTag=d,e.bigInt64ArrayTag=R,e.bigUint64ArrayTag=S,e.booleanTag=i,e.dataViewTag=g,e.dateTag=l,e.errorTag=m,e.float32ArrayTag=M,e.float64ArrayTag=B,e.functionTag=f,e.int16ArrayTag=k,e.int32ArrayTag=A,e.int8ArrayTag=j,e.mapTag=c,e.numberTag=n,e.objectTag=h,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=v,e.uint32ArrayTag=w,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=b})(MC);var MW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(MW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OW,r=qS,n=MC,i=TC,s=MW;function o(d,f){return l(d,void 0,d,new Map,f)}function l(d,f,p,h=new Map,m=void 0){const g=m==null?void 0:m(d,f,p,h);if(g!==void 0)return g;if(i.isPrimitive(d))return d;if(h.has(d))return h.get(d);if(Array.isArray(d)){const y=new Array(d.length);h.set(d,y);for(let b=0;b<d.length;b++)y[b]=l(d[b],b,p,h,m);return Object.hasOwn(d,"index")&&(y.index=d.index),Object.hasOwn(d,"input")&&(y.input=d.input),y}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const y=new RegExp(d.source,d.flags);return y.lastIndex=d.lastIndex,y}if(d instanceof Map){const y=new Map;h.set(d,y);for(const[b,v]of d)y.set(b,l(v,b,p,h,m));return y}if(d instanceof Set){const y=new Set;h.set(d,y);for(const b of d)y.add(l(b,void 0,p,h,m));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(s.isTypedArray(d)){const y=new(Object.getPrototypeOf(d)).constructor(d.length);h.set(d,y);for(let b=0;b<d.length;b++)y[b]=l(d[b],b,p,h,m);return y}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const y=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return h.set(d,y),c(y,d,p,h,m),y}if(typeof File<"u"&&d instanceof File){const y=new File([d],d.name,{type:d.type});return h.set(d,y),c(y,d,p,h,m),y}if(typeof Blob<"u"&&d instanceof Blob){const y=new Blob([d],{type:d.type});return h.set(d,y),c(y,d,p,h,m),y}if(d instanceof Error){const y=new d.constructor;return h.set(d,y),y.message=d.message,y.name=d.name,y.stack=d.stack,y.cause=d.cause,c(y,d,p,h,m),y}if(d instanceof Boolean){const y=new Boolean(d.valueOf());return h.set(d,y),c(y,d,p,h,m),y}if(d instanceof Number){const y=new Number(d.valueOf());return h.set(d,y),c(y,d,p,h,m),y}if(d instanceof String){const y=new String(d.valueOf());return h.set(d,y),c(y,d,p,h,m),y}if(typeof d=="object"&&u(d)){const y=Object.create(Object.getPrototypeOf(d));return h.set(d,y),c(y,d,p,h,m),y}return d}function c(d,f,p=d,h,m){const g=[...Object.keys(f),...t.getSymbols(f)];for(let y=0;y<g.length;y++){const b=g[y],v=Object.getOwnPropertyDescriptor(d,b);(v==null||v.writable)&&(d[b]=l(f[b],b,p,h,m))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(OC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OC;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(PW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CC,r=PW;function n(i){return i=r.cloneDeep(i),s=>t.isMatch(s,i)}e.matches=n})(EW);var LW={},RW={},FW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OC,r=qS,n=MC;function i(s,o){return t.cloneDeepWith(s,(l,c,u,d)=>{const f=o==null?void 0:o(l,c,u,d);if(f!==void 0)return f;if(typeof s=="object"){if(r.getTag(s)===n.objectTag&&typeof s.constructor!="function"){const p={};return d.set(s,p),t.copyProperties(p,s,u,d),p}switch(Object.prototype.toString.call(s)){case n.numberTag:case n.stringTag:case n.booleanTag:{const p=new s.constructor(s==null?void 0:s.valueOf());return t.copyProperties(p,s),p}case n.argumentsTag:{const p={};return t.copyProperties(p,s),p.length=s.length,p[Symbol.iterator]=s[Symbol.iterator],p}default:return}}})}e.cloneDeepWith=i})(FW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FW;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(RW);var BW={},LC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(LC);var IW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qS;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(IW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kC,r=LC,n=IW,i=US;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=i.toPath(l):c=[l],c.length===0)return!1;let u=o;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=s})(BW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CC,r=$S,n=RW,i=DS,s=BW;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return c=n.cloneDeep(c),function(u){const d=i.get(u,l);return d===void 0?s.has(u,l):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=o})(LW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=NC,r=CW,n=EW,i=LW;function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):n.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=s})(NW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SW,r=_W,n=NC,i=jW,s=NW;function o(l,c=n.identity){return i.isArrayLikeObject(l)?t.uniqBy(Array.from(l),r.ary(s.iteratee(c),1)):[]}e.uniqBy=o})(wW);var yye=wW.uniqBy;const KM=sf(yye);function DW(e,t,r){return t===!0?KM(e,r):typeof t=="function"?KM(e,t):e}var $W={exports:{}},UW={},zW={exports:{}},WW={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zm=x;function bye(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vye=typeof Object.is=="function"?Object.is:bye,wye=zm.useState,Sye=zm.useEffect,_ye=zm.useLayoutEffect,jye=zm.useDebugValue;function kye(e,t){var r=t(),n=wye({inst:{value:r,getSnapshot:t}}),i=n[0].inst,s=n[1];return _ye(function(){i.value=r,i.getSnapshot=t,Wj(i)&&s({inst:i})},[e,r,t]),Sye(function(){return Wj(i)&&s({inst:i}),e(function(){Wj(i)&&s({inst:i})})},[e]),jye(r),r}function Wj(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!vye(e,r)}catch{return!0}}function Aye(e,t){return t()}var Nye=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Aye:kye;WW.useSyncExternalStore=zm.useSyncExternalStore!==void 0?zm.useSyncExternalStore:Nye;zW.exports=WW;var Cye=zW.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HS=x,Eye=Cye;function Tye(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Pye=typeof Object.is=="function"?Object.is:Tye,Oye=Eye.useSyncExternalStore,Mye=HS.useRef,Lye=HS.useEffect,Rye=HS.useMemo,Fye=HS.useDebugValue;UW.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=Mye(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=Rye(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),i!==void 0&&o.hasValue){var m=o.value;if(i(m,h))return f=m}return f=h}if(m=f,Pye(d,h))return m;var g=n(h);return i!==void 0&&i(m,g)?(d=h,m):(d=h,f=g)}var u=!1,d,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,i]);var l=Oye(e,s[0],s[1]);return Lye(function(){o.hasValue=!0,o.value=l},[l]),Fye(l),l};$W.exports=UW;var Bye=$W.exports,RC=x.createContext(null),Iye=e=>e,Zi=()=>{var e=x.useContext(RC);return e?e.store.dispatch:Iye},Kv=()=>{},Dye=()=>Kv,$ye=(e,t)=>e===t;function Sn(e){var t=x.useContext(RC),r=x.useMemo(()=>t?n=>{if(n!=null)return e(n)}:Kv,[t,e]);return Bye.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Dye,t?t.store.getState:Kv,t?t.store.getState:Kv,r,$ye)}function Uye(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function zye(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Wye(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var YM=e=>Array.isArray(e)?e:[e];function qye(e){const t=Array.isArray(e[0])?e[0]:e;return Wye(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Hye(e,t){const r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var Vye=class{constructor(e){this.value=e}deref(){return this.value}},Gye=typeof WeakRef<"u"?WeakRef:Vye,Kye=0,XM=1;function Jb(){return{s:Kye,v:void 0,o:null,p:null}}function qW(e,t={}){let r=Jb();const{resultEqualityCheck:n}=t;let i,s=0;function o(){var f;let l=r;const{length:c}=arguments;for(let p=0,h=c;p<h;p++){const m=arguments[p];if(typeof m=="function"||typeof m=="object"&&m!==null){let g=l.o;g===null&&(l.o=g=new WeakMap);const y=g.get(m);y===void 0?(l=Jb(),g.set(m,l)):l=y}else{let g=l.p;g===null&&(l.p=g=new Map);const y=g.get(m);y===void 0?(l=Jb(),g.set(m,l)):l=y}}const u=l;let d;if(l.s===XM)d=l.v;else if(d=e.apply(null,arguments),s++,n){const p=((f=i==null?void 0:i.deref)==null?void 0:f.call(i))??i;p!=null&&n(p,d)&&(d=p,s!==0&&s--),i=typeof d=="object"&&d!==null||typeof d=="function"?new Gye(d):d}return u.s=XM,u.v=d,d}return o.clearCache=()=>{r=Jb(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function Yye(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let s=0,o=0,l,c={},u=i.pop();typeof u=="object"&&(c=u,u=i.pop()),Uye(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:p=[],argsMemoize:h=qW,argsMemoizeOptions:m=[]}=d,g=YM(p),y=YM(m),b=qye(i),v=f(function(){return s++,u.apply(null,arguments)},...g),w=h(function(){o++;const j=Hye(b,arguments);return l=v.apply(null,j),l},...y);return Object.assign(w,{resultFunc:u,memoizedResultFunc:v,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var Jt=Yye(qW),Xye=Object.assign((e,t=Jt)=>{zye(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(s=>e[s]);return t(n,(...s)=>s.reduce((o,l,c)=>(o[r[c]]=l,o),{}))},{withTypes:()=>Xye}),HW={},VW={},GW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,s)=>{if(n!==i){const o=t(n),l=t(i);if(o===l&&o===0){if(n<i)return s==="desc"?1:-1;if(n>i)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};e.compareValues=r})(GW);var KW={},FC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(FC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FC,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(n.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=i})(KW);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GW,r=KW,n=US;function i(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(h=>String(h));const u=(h,m)=>{let g=h;for(let y=0;y<m.length&&g!=null;++y)g=g[m[y]];return g},d=(h,m)=>m==null||h==null?m:typeof h=="object"&&"key"in h?Object.hasOwn(m,h.key)?m[h.key]:u(m,h.path):typeof h=="function"?h(m):Array.isArray(h)?u(m,h):typeof m=="object"?m[h]:m,f=o.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return s.map(h=>({original:h,criteria:f.map(m=>d(m,h))})).slice().sort((h,m)=>{for(let g=0;g<f.length;g++){const y=t.compareValues(h.criteria[g],m.criteria[g],l[g]);if(y!==0)return y}return 0}).map(h=>h.original)}e.orderBy=i})(VW);var YW={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const i=[],s=Math.floor(n),o=(l,c)=>{for(let u=0;u<l.length;u++){const d=l[u];Array.isArray(d)&&c<s?o(d,c+1):i.push(d)}};return o(r,0),i}e.flatten=t})(YW);var BC={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LC,r=WS,n=EC,i=PC;function s(o,l,c){return n.isObject(c)&&(typeof l=="number"&&r.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?i.isEqualsSameValueZero(c[l],o):!1}e.isIterateeCall=s})(BC);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VW,r=YW,n=BC;function i(s,...o){const l=o.length;return l>1&&n.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&n.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,r.flatten(o),["asc"])}e.sortBy=i})(HW);var Qye=HW.sortBy;const VS=sf(Qye);var XW=e=>e.legend.settings,Jye=e=>e.legend.size,Zye=e=>e.legend.payload,ebe=Jt([Zye,XW],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?VS(n,r):n});function tbe(){return Sn(ebe)}var Zb=1;function QW(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=x.useState({height:0,left:0,top:0,width:0}),n=x.useCallback(i=>{if(i!=null){var s=i.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>Zb||Math.abs(o.left-t.left)>Zb||Math.abs(o.top-t.top)>Zb||Math.abs(o.width-t.width)>Zb)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function fo(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var rbe=typeof Symbol=="function"&&Symbol.observable||"@@observable",QM=rbe,qj=()=>Math.random().toString(36).substring(7).split("").join("."),nbe={INIT:`@@redux/INIT${qj()}`,REPLACE:`@@redux/REPLACE${qj()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${qj()}`},iw=nbe;function IC(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function JW(e,t,r){if(typeof e!="function")throw new Error(fo(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(fo(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(fo(1));return r(JW)(e,t)}let n=e,i=t,s=new Map,o=s,l=0,c=!1;function u(){o===s&&(o=new Map,s.forEach((y,b)=>{o.set(b,y)}))}function d(){if(c)throw new Error(fo(3));return i}function f(y){if(typeof y!="function")throw new Error(fo(4));if(c)throw new Error(fo(5));let b=!0;u();const v=l++;return o.set(v,y),function(){if(b){if(c)throw new Error(fo(6));b=!1,u(),o.delete(v),s=null}}}function p(y){if(!IC(y))throw new Error(fo(7));if(typeof y.type>"u")throw new Error(fo(8));if(typeof y.type!="string")throw new Error(fo(17));if(c)throw new Error(fo(9));try{c=!0,i=n(i,y)}finally{c=!1}return(s=o).forEach(v=>{v()}),y}function h(y){if(typeof y!="function")throw new Error(fo(10));n=y,p({type:iw.REPLACE})}function m(){const y=f;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(fo(11));function v(){const S=b;S.next&&S.next(d())}return v(),{unsubscribe:y(v)}},[QM](){return this}}}return p({type:iw.INIT}),{dispatch:p,subscribe:f,getState:d,replaceReducer:h,[QM]:m}}function ibe(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:iw.INIT})>"u")throw new Error(fo(12));if(typeof r(void 0,{type:iw.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(fo(13))})}function ZW(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(r[o]=e[o])}const n=Object.keys(r);let i;try{ibe(r)}catch(s){i=s}return function(o={},l){if(i)throw i;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],p=r[f],h=o[f],m=p(h,l);if(typeof m>"u")throw l&&l.type,new Error(fo(14));u[f]=m,c=c||m!==h}return c=c||n.length!==Object.keys(o).length,c?u:o}}function aw(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function abe(...e){return t=>(r,n)=>{const i=t(r,n);let s=()=>{throw new Error(fo(15))};const o={getState:i.getState,dispatch:(c,...u)=>s(c,...u)},l=e.map(c=>c(o));return s=aw(...l)(i.dispatch),{...i,dispatch:s}}}function eq(e){return IC(e)&&"type"in e&&typeof e.type=="string"}var tq=Symbol.for("immer-nothing"),JM=Symbol.for("immer-draftable"),ul=Symbol.for("immer-state");function lu(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var rc=Object,Wm=rc.getPrototypeOf,sw="constructor",GS="prototype",pA="configurable",ow="enumerable",Yv="writable",A1="value",Qd=e=>!!e&&!!e[ul];function wu(e){var t;return e?rq(e)||YS(e)||!!e[JM]||!!((t=e[sw])!=null&&t[JM])||XS(e)||QS(e):!1}var sbe=rc[GS][sw].toString(),ZM=new WeakMap;function rq(e){if(!e||!DC(e))return!1;const t=Wm(e);if(t===null||t===rc[GS])return!0;const r=rc.hasOwnProperty.call(t,sw)&&t[sw];if(r===Object)return!0;if(!Ip(r))return!1;let n=ZM.get(r);return n===void 0&&(n=Function.toString.call(r),ZM.set(r,n)),n===sbe}function KS(e,t,r=!0){hy(e)===0?(r?Reflect.ownKeys(e):rc.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function hy(e){const t=e[ul];return t?t.type_:YS(e)?1:XS(e)?2:QS(e)?3:0}var eL=(e,t,r=hy(e))=>r===2?e.has(t):rc[GS].hasOwnProperty.call(e,t),mA=(e,t,r=hy(e))=>r===2?e.get(t):e[t],lw=(e,t,r,n=hy(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function obe(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var YS=Array.isArray,XS=e=>e instanceof Map,QS=e=>e instanceof Set,DC=e=>typeof e=="object",Ip=e=>typeof e=="function",Hj=e=>typeof e=="boolean";function lbe(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var Ed=e=>e.copy_||e.base_,$C=e=>e.modified_?e.copy_:e.base_;function gA(e,t){if(XS(e))return new Map(e);if(QS(e))return new Set(e);if(YS(e))return Array[GS].slice.call(e);const r=rq(e);if(t===!0||t==="class_only"&&!r){const n=rc.getOwnPropertyDescriptors(e);delete n[ul];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],l=n[o];l[Yv]===!1&&(l[Yv]=!0,l[pA]=!0),(l.get||l.set)&&(n[o]={[pA]:!0,[Yv]:!0,[ow]:l[ow],[A1]:e[o]})}return rc.create(Wm(e),n)}else{const n=Wm(e);if(n!==null&&r)return{...e};const i=rc.create(n);return rc.assign(i,e)}}function UC(e,t=!1){return JS(e)||Qd(e)||!wu(e)||(hy(e)>1&&rc.defineProperties(e,{set:ev,add:ev,clear:ev,delete:ev}),rc.freeze(e),t&&KS(e,(r,n)=>{UC(n,!0)},!1)),e}function cbe(){lu(2)}var ev={[A1]:cbe};function JS(e){return e===null||!DC(e)?!0:rc.isFrozen(e)}var cw="MapSet",xA="Patches",tL="ArrayMethods",nq={};function M0(e){const t=nq[e];return t||lu(0,e),t}var rL=e=>!!nq[e],N1,iq=()=>N1,ube=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:rL(cw)?M0(cw):void 0,arrayMethodsPlugin_:rL(tL)?M0(tL):void 0});function nL(e,t){t&&(e.patchPlugin_=M0(xA),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function yA(e){bA(e),e.drafts_.forEach(dbe),e.drafts_=null}function bA(e){e===N1&&(N1=e.parent_)}var iL=e=>N1=ube(N1,e);function dbe(e){const t=e[ul];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function aL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[ul].modified_&&(yA(t),lu(4)),wu(e)&&(e=sL(t,e));const{patchPlugin_:i}=t;i&&i.generateReplacementPatches_(r[ul].base_,e,t)}else e=sL(t,r);return fbe(t,e,!0),yA(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==tq?e:void 0}function sL(e,t){if(JS(t))return t;const r=t[ul];if(!r)return uw(t,e.handledSet_,e);if(!ZS(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);oq(r,e)}return r.copy_}function fbe(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&UC(t,r)}function aq(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var ZS=(e,t)=>e.scope_===t,hbe=[];function sq(e,t,r,n){const i=Ed(e),s=e.type_;if(n!==void 0&&mA(i,n,s)===t){lw(i,n,r,s);return}if(!e.draftLocations_){const l=e.draftLocations_=new Map;KS(i,(c,u)=>{if(Qd(u)){const d=l.get(u)||[];d.push(c),l.set(u,d)}})}const o=e.draftLocations_.get(t)??hbe;for(const l of o)lw(i,l,r,s)}function pbe(e,t,r){e.callbacks_.push(function(i){var l;const s=t;if(!s||!ZS(s,i))return;(l=i.mapSetPlugin_)==null||l.fixSetContents(s);const o=$C(s);sq(e,s.draft_??s,o,r),oq(s,i)})}function oq(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:i}=t;if(i){const s=i.getPath(e);s&&i.generatePatches_(e,s,t)}aq(e)}}function mbe(e,t,r){const{scope_:n}=e;if(Qd(r)){const i=r[ul];ZS(i,n)&&i.callbacks_.push(function(){Xv(e);const o=$C(i);sq(e,r,o,t)})}else wu(r)&&e.callbacks_.push(function(){const s=Ed(e);e.type_===3?s.has(r)&&uw(r,n.handledSet_,n):mA(s,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&uw(mA(e.copy_,t,e.type_),n.handledSet_,n)})}function uw(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||Qd(e)||t.has(e)||!wu(e)||JS(e)||(t.add(e),KS(e,(n,i)=>{if(Qd(i)){const s=i[ul];if(ZS(s,r)){const o=$C(s);lw(e,n,o,e.type_),aq(s)}}else wu(i)&&uw(i,t,r)})),e}function gbe(e,t){const r=YS(e),n={type_:r?1:0,scope_:t?t.scope_:iq(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let i=n,s=dw;r&&(i=[n],s=C1);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return n.draft_=l,n.revoke_=o,[l,n]}var dw={get(e,t){if(t===ul)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const i=Ed(e);if(!eL(i,t,e.type_))return xbe(e,i,t);const s=i[t];if(e.finalized_||!wu(s)||n&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&lbe(t))return s;if(s===Vj(e.base_,t)){Xv(e);const o=e.type_===1?+t:t,l=wA(e.scope_,s,e,o);return e.copy_[o]=l}return s},has(e,t){return t in Ed(e)},ownKeys(e){return Reflect.ownKeys(Ed(e))},set(e,t,r){const n=lq(Ed(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Vj(Ed(e),t),s=i==null?void 0:i[ul];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(obe(r,i)&&(r!==void 0||eL(e.base_,t,e.type_)))return!0;Xv(e),vA(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),mbe(e,t,r)),!0},deleteProperty(e,t){return Xv(e),Vj(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),vA(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Ed(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Yv]:!0,[pA]:e.type_!==1||t!=="length",[ow]:n[ow],[A1]:r[t]}},defineProperty(){lu(11)},getPrototypeOf(e){return Wm(e.base_)},setPrototypeOf(){lu(12)}},C1={};for(let e in dw){let t=dw[e];C1[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}C1.deleteProperty=function(e,t){return C1.set.call(this,e,t,void 0)};C1.set=function(e,t,r){return dw.set.call(this,e[0],t,r,e[0])};function Vj(e,t){const r=e[ul];return(r?Ed(r):e)[t]}function xbe(e,t,r){var i;const n=lq(t,r);return n?A1 in n?n[A1]:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function lq(e,t){if(!(t in e))return;let r=Wm(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Wm(r)}}function vA(e){e.modified_||(e.modified_=!0,e.parent_&&vA(e.parent_))}function Xv(e){e.copy_||(e.assigned_=new Map,e.copy_=gA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var ybe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,i)=>{if(Ip(r)&&!Ip(n)){const o=n;n=r;const l=this;return function(u=o,...d){return l.produce(u,f=>n.call(this,f,...d))}}Ip(n)||lu(6),i!==void 0&&!Ip(i)&&lu(7);let s;if(wu(r)){const o=iL(this),l=wA(o,r,void 0);let c=!0;try{s=n(l),c=!1}finally{c?yA(o):bA(o)}return nL(o,i),aL(s,o)}else if(!r||!DC(r)){if(s=n(r),s===void 0&&(s=r),s===tq&&(s=void 0),this.autoFreeze_&&UC(s,!0),i){const o=[],l=[];M0(xA).generateReplacementPatches_(r,s,{patches_:o,inversePatches_:l}),i(o,l)}return s}else lu(1,r)},this.produceWithPatches=(r,n)=>{if(Ip(r))return(l,...c)=>this.produceWithPatches(l,u=>r(u,...c));let i,s;return[this.produce(r,n,(l,c)=>{i=l,s=c}),i,s]},Hj(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),Hj(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),Hj(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){wu(t)||lu(8),Qd(t)&&(t=xu(t));const r=iL(this),n=wA(r,t,void 0);return n[ul].isManual_=!0,bA(r),n}finishDraft(t,r){const n=t&&t[ul];(!n||!n.isManual_)&&lu(9);const{scope_:i}=n;return nL(i,r),aL(void 0,i)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const s=r[n];if(s.path.length===0&&s.op==="replace"){t=s.value;break}}n>-1&&(r=r.slice(n+1));const i=M0(xA).applyPatches_;return Qd(t)?i(t,r):this.produce(t,s=>i(s,r))}};function wA(e,t,r,n){const[i,s]=XS(t)?M0(cw).proxyMap_(t,r):QS(t)?M0(cw).proxySet_(t,r):gbe(t,r);return((r==null?void 0:r.scope_)??iq()).drafts_.push(i),s.callbacks_=(r==null?void 0:r.callbacks_)??[],s.key_=n,r&&n!==void 0?pbe(r,s,n):s.callbacks_.push(function(c){var d;(d=c.mapSetPlugin_)==null||d.fixSetContents(s);const{patchPlugin_:u}=c;s.modified_&&u&&u.generatePatches_(s,[],c)}),i}function xu(e){return Qd(e)||lu(10,e),cq(e)}function cq(e){if(!wu(e)||JS(e))return e;const t=e[ul];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=gA(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=gA(e,!0);return KS(r,(i,s)=>{lw(r,i,cq(s))},n),t&&(t.finalized_=!1),r}var bbe=new ybe,uq=bbe.produce;function dq(e){return({dispatch:r,getState:n})=>i=>s=>typeof s=="function"?s(r,n,e):i(s)}var vbe=dq(),wbe=dq,Sbe=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?aw:aw.apply(null,arguments)};function Vc(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(ic(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>eq(n)&&n.type===e,r}var fq=class gx extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,gx.prototype)}static get[Symbol.species](){return gx}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new gx(...t[0].concat(this)):new gx(...t.concat(this))}};function oL(e){return wu(e)?uq(e,()=>{}):e}function tv(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function _be(e){return typeof e=="boolean"}var jbe=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:s=!0}=t??{};let o=new fq;return r&&(_be(r)?o.push(vbe):o.push(wbe(r.extraArgument))),o},hq="RTK_autoBatch",wa=()=>e=>({payload:e,meta:{[hq]:!0}}),lL=e=>t=>{setTimeout(t,e)},pq=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let i=!0,s=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:lL(10):e.type==="callback"?e.queueNotification:lL(e.timeout),u=()=>{o=!1,s&&(s=!1,l.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>i&&d(),p=n.subscribe(f);return l.add(d),()=>{p(),l.delete(d)}},dispatch(d){var f;try{return i=!((f=d==null?void 0:d.meta)!=null&&f[hq]),s=!i,s&&(o||(o=!0,c(u))),n.dispatch(d)}finally{i=!0}}})},kbe=e=>function(r){const{autoBatch:n=!0}=r??{};let i=new fq(e);return n&&i.push(pq(typeof n=="object"?n:void 0)),i};function Abe(e){const t=jbe(),{reducer:r=void 0,middleware:n,devTools:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(IC(r))l=ZW(r);else throw new Error(ic(1));let c;typeof n=="function"?c=n(t):c=t();let u=aw;i&&(u=Sbe({trace:!1,...typeof i=="object"&&i}));const d=abe(...c),f=kbe(d);let p=typeof o=="function"?o(f):f();const h=u(...p);return JW(l,s,h)}function mq(e){const t={},r=[];let n;const i={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(ic(28));if(l in t)throw new Error(ic(29));return t[l]=o,i},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),i},addMatcher(s,o){return r.push({matcher:s,reducer:o}),i},addDefaultCase(s){return n=s,i}};return e(i),[t,r,n]}function Nbe(e){return typeof e=="function"}function Cbe(e,t){let[r,n,i]=mq(t),s;if(Nbe(e))s=()=>oL(e());else{const l=oL(e);s=()=>l}function o(l=s(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[i]),u.reduce((d,f)=>{if(f)if(Qd(d)){const h=f(d,c);return h===void 0?d:h}else{if(wu(d))return uq(d,p=>f(p,c));{const p=f(d,c);if(p===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return d},l)}return o.getInitialState=s,o}var Ebe="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Tbe=(e=21)=>{let t="",r=e;for(;r--;)t+=Ebe[Math.random()*64|0];return t},Pbe=Symbol.for("rtk-slice-createasyncthunk");function Obe(e,t){return`${e}/${t}`}function Mbe({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[Pbe];return function(i){const{name:s,reducerPath:o=s}=i;if(!s)throw new Error(ic(11));const l=(typeof i.reducers=="function"?i.reducers(Rbe()):i.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},d={addCase(S,j){const k=typeof S=="string"?S:S.type;if(!k)throw new Error(ic(12));if(k in u.sliceCaseReducersByType)throw new Error(ic(13));return u.sliceCaseReducersByType[k]=j,d},addMatcher(S,j){return u.sliceMatchers.push({matcher:S,reducer:j}),d},exposeAction(S,j){return u.actionCreators[S]=j,d},exposeCaseReducer(S,j){return u.sliceCaseReducersByName[S]=j,d}};c.forEach(S=>{const j=l[S],k={reducerName:S,type:Obe(s,S),createNotation:typeof i.reducers=="function"};Bbe(j)?Dbe(k,j,d,t):Fbe(k,j,d)});function f(){const[S={},j=[],k=void 0]=typeof i.extraReducers=="function"?mq(i.extraReducers):[i.extraReducers],A={...S,...u.sliceCaseReducersByType};return Cbe(i.initialState,R=>{for(let M in A)R.addCase(M,A[M]);for(let M of u.sliceMatchers)R.addMatcher(M.matcher,M.reducer);for(let M of j)R.addMatcher(M.matcher,M.reducer);k&&R.addDefaultCase(k)})}const p=S=>S,h=new Map,m=new WeakMap;let g;function y(S,j){return g||(g=f()),g(S,j)}function b(){return g||(g=f()),g.getInitialState()}function v(S,j=!1){function k(R){let M=R[S];return typeof M>"u"&&j&&(M=tv(m,k,b)),M}function A(R=p){const M=tv(h,j,()=>new WeakMap);return tv(M,R,()=>{const B={};for(const[E,P]of Object.entries(i.selectors??{}))B[E]=Lbe(P,R,()=>tv(m,R,b),j);return B})}return{reducerPath:S,getSelectors:A,get selectors(){return A(k)},selectSlice:k}}const w={name:s,reducer:y,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...v(o),injectInto(S,{reducerPath:j,...k}={}){const A=j??o;return S.inject({reducerPath:A,reducer:y},k),{...w,...v(A,!0)}}};return w}}function Lbe(e,t,r,n){function i(s,...o){let l=t(s);return typeof l>"u"&&n&&(l=r()),e(l,...o)}return i.unwrapped=e,i}var Ll=Mbe();function Rbe(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function Fbe({type:e,reducerName:t,createNotation:r},n,i){let s,o;if("reducer"in n){if(r&&!Ibe(n))throw new Error(ic(17));s=n.reducer,o=n.prepare}else s=n;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?Vc(e,o):Vc(e))}function Bbe(e){return e._reducerDefinitionType==="asyncThunk"}function Ibe(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Dbe({type:e,reducerName:t},r,n,i){if(!i)throw new Error(ic(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:u,options:d}=r,f=i(e,s,d);n.exposeAction(t,f),o&&n.addCase(f.fulfilled,o),l&&n.addCase(f.pending,l),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:o||rv,pending:l||rv,rejected:c||rv,settled:u||rv})}function rv(){}var $be="task",gq="listener",xq="completed",zC="cancelled",Ube=`task-${zC}`,zbe=`task-${xq}`,SA=`${gq}-${zC}`,Wbe=`${gq}-${xq}`,e_=class{constructor(e){Mi(this,"name","TaskAbortError");Mi(this,"message");this.code=e,this.message=`${$be} ${zC} (reason: ${e})`}},WC=(e,t)=>{if(typeof e!="function")throw new TypeError(ic(32))},fw=()=>{},yq=(e,t=fw)=>(e.catch(t),e),bq=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),d0=e=>{if(e.aborted)throw new e_(e.reason)};function vq(e,t){let r=fw;return new Promise((n,i)=>{const s=()=>i(new e_(e.reason));if(e.aborted){s();return}r=bq(e,s),t.finally(()=>r()).then(n,i)}).finally(()=>{r=fw})}var qbe=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof e_?"cancelled":"rejected",error:r}}finally{t==null||t()}},hw=e=>t=>yq(vq(e,t).then(r=>(d0(e),r))),wq=e=>{const t=hw(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:wm}=Object,cL={},t_="listenerMiddleware",Hbe=(e,t)=>{const r=n=>bq(e,()=>n.abort(e.reason));return(n,i)=>{WC(n);const s=new AbortController;r(s);const o=qbe(async()=>{d0(e),d0(s.signal);const l=await n({pause:hw(s.signal),delay:wq(s.signal),signal:s.signal});return d0(s.signal),l},()=>s.abort(zbe));return i!=null&&i.autoJoin&&t.push(o.catch(fw)),{result:hw(e)(o),cancel(){s.abort(Ube)}}}},Vbe=(e,t)=>{const r=async(n,i)=>{d0(t);let s=()=>{};const l=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,p)=>{p.unsubscribe(),c([f,p.getState(),p.getOriginalState()])}});s=()=>{d(),u()}})];i!=null&&l.push(new Promise(c=>setTimeout(c,i,null)));try{const c=await vq(t,Promise.race(l));return d0(t),c}finally{s()}};return(n,i)=>yq(r(n,i))},Sq=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:s}=e;if(t)i=Vc(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(ic(21));return WC(s),{predicate:i,type:t,effect:s}},_q=wm(e=>{const{type:t,predicate:r,effect:n}=Sq(e);return{id:Tbe(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(ic(22))}}},{withTypes:()=>_q}),uL=(e,t)=>{const{type:r,effect:n,predicate:i}=Sq(t);return Array.from(e.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===i)&&s.effect===n)},_A=e=>{e.pending.forEach(t=>{t.abort(SA)})},Gbe=(e,t)=>()=>{for(const r of t.keys())_A(r);e.clear()},dL=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},jq=wm(Vc(`${t_}/add`),{withTypes:()=>jq}),Kbe=Vc(`${t_}/removeAll`),kq=wm(Vc(`${t_}/remove`),{withTypes:()=>kq}),Ybe=(...e)=>{console.error(`${t_}/error`,...e)},py=(e={})=>{const t=new Map,r=new Map,n=h=>{const m=r.get(h)??0;r.set(h,m+1)},i=h=>{const m=r.get(h)??1;m===1?r.delete(h):r.set(h,m-1)},{extra:s,onError:o=Ybe}=e;WC(o);const l=h=>(h.unsubscribe=()=>t.delete(h.id),t.set(h.id,h),m=>{h.unsubscribe(),m!=null&&m.cancelActive&&_A(h)}),c=h=>{const m=uL(t,h)??_q(h);return l(m)};wm(c,{withTypes:()=>c});const u=h=>{const m=uL(t,h);return m&&(m.unsubscribe(),h.cancelActive&&_A(m)),!!m};wm(u,{withTypes:()=>u});const d=async(h,m,g,y)=>{const b=new AbortController,v=Vbe(c,b.signal),w=[];try{h.pending.add(b),n(h),await Promise.resolve(h.effect(m,wm({},g,{getOriginalState:y,condition:(S,j)=>v(S,j).then(Boolean),take:v,delay:wq(b.signal),pause:hw(b.signal),extra:s,signal:b.signal,fork:Hbe(b.signal,w),unsubscribe:h.unsubscribe,subscribe:()=>{t.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((S,j,k)=>{S!==b&&(S.abort(SA),k.delete(S))})},cancel:()=>{b.abort(SA),h.pending.delete(b)},throwIfCancelled:()=>{d0(b.signal)}})))}catch(S){S instanceof e_||dL(o,S,{raisedBy:"effect"})}finally{await Promise.all(w),b.abort(Wbe),i(h),h.pending.delete(b)}},f=Gbe(t,r);return{middleware:h=>m=>g=>{if(!eq(g))return m(g);if(jq.match(g))return c(g.payload);if(Kbe.match(g)){f();return}if(kq.match(g))return u(g.payload);let y=h.getState();const b=()=>{if(y===cL)throw new Error(ic(23));return y};let v;try{if(v=m(g),t.size>0){const w=h.getState(),S=Array.from(t.values());for(const j of S){let k=!1;try{k=j.predicate(g,w,y)}catch(A){k=!1,dL(o,A,{raisedBy:"predicate"})}k&&d(j,g,h,b)}}}finally{y=cL}return v},startListening:c,stopListening:u,clearListeners:f}};function ic(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Xbe={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Aq=Ll({name:"chartLayout",initialState:Xbe,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,i,s;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Qbe,setLayout:Jbe,setChartSize:Zbe,setScale:eve}=Aq.actions,tve=Aq.reducer;function Nq(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function fi(e){return Number.isFinite(e)}function id(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function fL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fL(Object(r),!0).forEach(function(n){rve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rve(e,t,r){return(t=nve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nve(e){var t=ive(e,"string");return typeof t=="symbol"?t:t+""}function ive(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ti(e,t,r){return Qi(e)||Qi(t)?r:Hc(t)?P0(e,t,r):typeof t=="function"?t(e):r}var ave=(e,t,r)=>{if(t&&r){var{width:n,height:i}=r,{align:s,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&An(e[s]))return tm(tm({},e),{},{[s]:e[s]+(n||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&An(e[o]))return tm(tm({},e),{},{[o]:e[o]+(i||0)})}return e},hf=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Cq=(e,t,r,n)=>{if(n)return e.map(l=>l.coordinate);var i,s,o=e.map(l=>(l.coordinate===t&&(i=!0),l.coordinate===r&&(s=!0),l.coordinate));return i||o.push(t),s||o.push(r),o},Eq=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:i,range:s,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:p,axisType:h}=e;if(!o)return null;var m=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,g=i==="category"&&o.bandwidth?o.bandwidth()/m:0;if(g=h==="angleAxis"&&s&&s.length>=2?Xs(s[0]-s[1])*2*g:g,f||p){var y=(f||p||[]).map((b,v)=>{var w=n?n.indexOf(b):b,S=o.map(w);return fi(S)?{coordinate:S+g,value:b,offset:g,index:v}:null}).filter(_l);return y}return c&&u?u.map((b,v)=>{var w=o.map(b);return fi(w)?{coordinate:w+g,value:b,index:v,offset:g}:null}).filter(_l):o.ticks&&d!=null?o.ticks(d).map((b,v)=>{var w=o.map(b);return fi(w)?{coordinate:w+g,value:b,index:v,offset:g}:null}).filter(_l):o.domain().map((b,v)=>{var w=o.map(b);return fi(w)?{coordinate:w+g,value:n?n[b]:b,index:v,offset:g}:null}).filter(_l)},sve=(e,t)=>{if(!t||t.length!==2||!An(t[0])||!An(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!An(e[0])||e[0]<r)&&(i[0]=r),(!An(e[1])||e[1]>n)&&(i[1]=n),i[0]>n&&(i[0]=n),i[1]<r&&(i[1]=r),i},ove=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var s=0,o=0,l=0;l<r;++l){var c=e[l],u=c==null?void 0:c[i];if(u!=null){var d=u[1],f=u[0],p=nd(d)?f:d;p>=0?(u[0]=s,s+=p,u[1]=s):(u[0]=o,o+=p,u[1]=o)}}}},lve=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var i=0;i<n;++i)for(var s=0,o=0;o<r;++o){var l=e[o],c=l==null?void 0:l[i];if(c!=null){var u=nd(c[1])?c[0]:c[1];u>=0?(c[0]=s,s+=u,c[1]=s):(c[0]=0,c[1]=0)}}}},cve={sign:ove,expand:U1e,none:T0,silhouette:z1e,wiggle:W1e,positive:lve},uve=(e,t,r)=>{var n,i=(n=cve[r])!==null&&n!==void 0?n:T0,s=$1e().keys(t).value((l,c)=>Number(Ti(l,c,0))).order(fA).offset(i),o=s(e);return o.forEach((l,c)=>{l.forEach((u,d)=>{var f=Ti(e[d],t[c],0);Array.isArray(f)&&f.length===2&&An(f[0])&&An(f[1])&&(u[0]=f[0],u[1]=f[1])})}),o};function dve(e){return e==null?void 0:String(e)}function pw(e){var{axis:t,ticks:r,bandSize:n,entry:i,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Qi(i[t.dataKey])){var l=yW(r,"value",i[t.dataKey]);if(l)return l.coordinate+n/2}return r!=null&&r[s]?r[s].coordinate+n/2:null}var c=Ti(i,Qi(o)?t.dataKey:o),u=t.scale.map(c);return An(u)?u:null}var hL=e=>{var{axis:t,ticks:r,offset:n,bandSize:i,entry:s,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+n:null;var l=Ti(s,t.dataKey,t.scale.domain()[o]);if(Qi(l))return null;var c=t.scale.map(l);return An(c)?c-i/2+n:null},fve=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return n<=0&&i>=0?0:i<0?i:n}return r[0]},hve=e=>{var t=e.flat(2).filter(An);return[Math.min(...t),Math.max(...t)]},pve=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],mve=(e,t,r)=>{if(e!=null)return pve(Object.keys(e).reduce((n,i)=>{var s=e[i];if(!s)return n;var{stackedData:o}=s,l=o.reduce((c,u)=>{var d=Nq(u,t,r),f=hve(d);return!fi(f[0])||!fi(f[1])?c:[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],n[0]),Math.max(l[1],n[1])]},[1/0,-1/0]))},pL=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,mL=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,qm=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var i=VS(t,d=>d.coordinate),s=1/0,o=1,l=i.length;o<l;o++){var c=i[o],u=i[o-1];s=Math.min(((c==null?void 0:c.coordinate)||0)-((u==null?void 0:u.coordinate)||0),s)}return s===1/0?0:s}return r?void 0:0};function gL(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:i,name:s}=e;return tm(tm({},t),{},{dataKey:r,payload:n,value:i,name:s})}function Ch(e,t){if(e)return String(e);if(typeof t=="string")return t}var gve=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},xve=(e,t)=>t==="centric"?e.angle:e.radius,pf=e=>e.layout.width,mf=e=>e.layout.height,yve=e=>e.layout.scale,Tq=e=>e.layout.margin,r_=Jt(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),n_=Jt(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),Pq="data-recharts-item-index",qC="data-recharts-item-id",my=60;function xL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function nv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xL(Object(r),!0).forEach(function(n){bve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bve(e,t,r){return(t=vve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vve(e){var t=wve(e,"string");return typeof t=="symbol"?t:t+""}function wve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sve=e=>e.brush.height;function _ve(e){var t=n_(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:my;return r+i}return r},0)}function jve(e){var t=n_(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var i=typeof n.width=="number"?n.width:my;return r+i}return r},0)}function kve(e){var t=r_(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Ave(e){var t=r_(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Ls=Jt([pf,mf,Tq,Sve,_ve,jve,kve,Ave,XW,Jye],(e,t,r,n,i,s,o,l,c,u)=>{var d={left:(r.left||0)+i,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},p=nv(nv({},f),d),h=p.bottom;p.bottom+=n,p=ave(p,c,u);var m=e-p.left-p.right,g=t-p.top-p.bottom;return nv(nv({brushBottom:h},p),{},{width:Math.max(m,0),height:Math.max(g,0)})}),Nve=Jt(Ls,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),HC=Jt(pf,mf,(e,t)=>({x:0,y:0,width:e,height:t})),Cve=x.createContext(null),Rs=()=>x.useContext(Cve)!=null,i_=e=>e.brush,a_=Jt([i_,Ls,Tq],(e,t,r)=>({height:e.height,x:An(e.x)?e.x:t.left,y:An(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:An(e.width)?e.width:t.width})),Oq={},Mq={},Lq={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:i,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),u=s==null||s.includes("trailing"),d=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{u&&d(),g()};let p=null;const h=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,f()},n)},m=()=>{p!==null&&(clearTimeout(p),p=null)},g=()=>{m(),o=void 0,l=null},y=()=>{d()},b=function(...v){if(i!=null&&i.aborted)return;o=this,l=v;const w=p==null;h(),c&&w&&d()};return b.schedule=h,b.cancel=g,b.flush=y,i==null||i.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(Lq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Lq;function r(n,i=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,u=Array(2);o&&(u[0]="leading"),l&&(u[1]="trailing");let d,f=null;const p=t.debounce(function(...g){d=n.apply(this,g),f=null},i,{edges:u}),h=function(...g){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,g),f=Date.now(),p.cancel(),p.schedule(),d):(p.apply(this,g),d)},m=()=>(p.flush(),d);return h.cancel=p.cancel,h.flush=m,h}e.debounce=r})(Mq);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Mq;function r(n,i=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return t.debounce(n,i,{leading:o,maxWait:i,trailing:l})}e.throttle=r})(Oq);var Eve=Oq.throttle;const Tve=sf(Eve);var mw=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=0;console.warn(r.replace(/%s/g,()=>i[o++]))}},Xu={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},Rq=(e,t,r)=>{var{width:n=Xu.width,height:i=Xu.height,aspect:s,maxHeight:o}=r,l=O0(n)?e:Number(n),c=O0(i)?t:Number(i);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},Pve={width:0,height:0,overflow:"visible"},Ove={width:0,overflowX:"visible"},Mve={height:0,overflowY:"visible"},Lve={},Rve=e=>{var{width:t,height:r}=e,n=O0(t),i=O0(r);return n&&i?Pve:n?Ove:i?Mve:Lve};function Fve(e){var{width:t,height:r,aspect:n}=e,i=t,s=r;return i===void 0&&s===void 0?(i=Xu.width,s=Xu.height):i===void 0?i=n&&n>0?void 0:Xu.width:s===void 0&&(s=n&&n>0?void 0:Xu.height),{width:i,height:s}}function jA(){return jA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jA.apply(null,arguments)}function yL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function bL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yL(Object(r),!0).forEach(function(n){Bve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bve(e,t,r){return(t=Ive(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ive(e){var t=Dve(e,"string");return typeof t=="symbol"?t:t+""}function Dve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Fq=x.createContext(Xu.initialDimension);function $ve(e){return id(e.width)&&id(e.height)}function Bq(e){var{children:t,width:r,height:n}=e,i=x.useMemo(()=>({width:r,height:n}),[r,n]);return $ve(i)?x.createElement(Fq.Provider,{value:i},t):null}var VC=()=>x.useContext(Fq),Uve=x.forwardRef((e,t)=>{var{aspect:r,initialDimension:n=Xu.initialDimension,width:i,height:s,minWidth:o=Xu.minWidth,minHeight:l,maxHeight:c,children:u,debounce:d=Xu.debounce,id:f,className:p,onResize:h,style:m={}}=e,g=x.useRef(null),y=x.useRef();y.current=h,x.useImperativeHandle(t,()=>g.current);var[b,v]=x.useState({containerWidth:n.width,containerHeight:n.height}),w=x.useCallback((R,M)=>{v(B=>{var E=Math.round(R),P=Math.round(M);return B.containerWidth===E&&B.containerHeight===P?B:{containerWidth:E,containerHeight:P}})},[]);x.useEffect(()=>{if(g.current==null||typeof ResizeObserver>"u")return np;var R=P=>{var D,G=P[0];if(G!=null){var{width:H,height:oe}=G.contentRect;w(H,oe),(D=y.current)===null||D===void 0||D.call(y,H,oe)}};d>0&&(R=Tve(R,d,{trailing:!0,leading:!1}));var M=new ResizeObserver(R),{width:B,height:E}=g.current.getBoundingClientRect();return w(B,E),M.observe(g.current),()=>{M.disconnect()}},[w,d]);var{containerWidth:S,containerHeight:j}=b;mw(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:k,calculatedHeight:A}=Rq(S,j,{width:i,height:s,aspect:r,maxHeight:c});return mw(k!=null&&k>0||A!=null&&A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,k,A,i,s,o,l,r),x.createElement("div",{id:f?"".concat(f):void 0,className:Si("recharts-responsive-container",p),style:bL(bL({},m),{},{width:i,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:g},x.createElement("div",{style:Rve({width:i,height:s})},x.createElement(Bq,{width:k,height:A},u)))}),gy=x.forwardRef((e,t)=>{var r=VC();if(id(r.width)&&id(r.height))return e.children;var{width:n,height:i}=Fve({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:o}=Rq(void 0,void 0,{width:n,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return An(s)&&An(o)?x.createElement(Bq,{width:s,height:o},e.children):x.createElement(Uve,jA({},e,{width:n,height:i,ref:t}))});function GC(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var pg=()=>{var e,t=Rs(),r=Sn(Nve),n=Sn(a_),i=(e=Sn(i_))===null||e===void 0?void 0:e.padding;return!t||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},zve={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Iq=()=>{var e;return(e=Sn(Ls))!==null&&e!==void 0?e:zve},KC=()=>Sn(pf),YC=()=>Sn(mf),Wve=()=>Sn(e=>e.layout.margin),Oi=e=>e.layout.layoutType,ip=()=>Sn(Oi),Dq=()=>{var e=ip();if(e==="horizontal"||e==="vertical")return e},$q=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},qve=()=>{var e=ip();return e!==void 0},xy=e=>{var t=Zi(),r=Rs(),{width:n,height:i}=e,s=VC(),o=n,l=i;return s&&(o=s.width>0?s.width:n,l=s.height>0?s.height:i),x.useEffect(()=>{!r&&id(o)&&id(l)&&t(Zbe({width:o,height:l}))},[t,r,o,l]),null},Uq=Symbol.for("immer-nothing"),vL=Symbol.for("immer-draftable"),uc=Symbol.for("immer-state");function cu(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var E1=Object.getPrototypeOf;function Hm(e){return!!e&&!!e[uc]}function L0(e){var t;return e?zq(e)||Array.isArray(e)||!!e[vL]||!!((t=e.constructor)!=null&&t[vL])||yy(e)||o_(e):!1}var Hve=Object.prototype.constructor.toString(),wL=new WeakMap;function zq(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=wL.get(r);return n===void 0&&(n=Function.toString.call(r),wL.set(r,n)),n===Hve}function gw(e,t,r=!0){s_(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((n,i)=>t(i,n,e))}function s_(e){const t=e[uc];return t?t.type_:Array.isArray(e)?1:yy(e)?2:o_(e)?3:0}function kA(e,t){return s_(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Wq(e,t,r){const n=s_(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Vve(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function yy(e){return e instanceof Map}function o_(e){return e instanceof Set}function zh(e){return e.copy_||e.base_}function AA(e,t){if(yy(e))return new Map(e);if(o_(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=zq(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[uc];let i=Reflect.ownKeys(n);for(let s=0;s<i.length;s++){const o=i[s],l=n[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(n[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(E1(e),n)}else{const n=E1(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function XC(e,t=!1){return l_(e)||Hm(e)||!L0(e)||(s_(e)>1&&Object.defineProperties(e,{set:iv,add:iv,clear:iv,delete:iv}),Object.freeze(e),t&&Object.values(e).forEach(r=>XC(r,!0))),e}function Gve(){cu(2)}var iv={value:Gve};function l_(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var Kve={};function R0(e){const t=Kve[e];return t||cu(0,e),t}var T1;function qq(){return T1}function Yve(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function SL(e,t){t&&(R0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function NA(e){CA(e),e.drafts_.forEach(Xve),e.drafts_=null}function CA(e){e===T1&&(T1=e.parent_)}function _L(e){return T1=Yve(T1,e)}function Xve(e){const t=e[uc];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function jL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[uc].modified_&&(NA(t),cu(4)),L0(e)&&(e=xw(t,e),t.parent_||yw(t,e)),t.patches_&&R0("Patches").generateReplacementPatches_(r[uc].base_,e,t.patches_,t.inversePatches_)):e=xw(t,r,[]),NA(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Uq?e:void 0}function xw(e,t,r){if(l_(t))return t;const n=e.immer_.shouldUseStrictIteration(),i=t[uc];if(!i)return gw(t,(s,o)=>kL(e,i,t,s,o,r),n),t;if(i.scope_!==e)return t;if(!i.modified_)return yw(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,l=!1;i.type_===3&&(o=new Set(s),s.clear(),l=!0),gw(o,(c,u)=>kL(e,i,s,c,u,r,l),n),yw(e,s,!1),r&&e.patches_&&R0("Patches").generatePatches_(i,r,e.patches_,e.inversePatches_)}return i.copy_}function kL(e,t,r,n,i,s,o){if(i==null||typeof i!="object"&&!o)return;const l=l_(i);if(!(l&&!o)){if(Hm(i)){const c=s&&t&&t.type_!==3&&!kA(t.assigned_,n)?s.concat(n):void 0,u=xw(e,i,c);if(Wq(r,n,u),Hm(u))e.canAutoFreeze_=!1;else return}else o&&r.add(i);if(L0(i)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===i&&l)return;xw(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(yy(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&yw(e,i)}}}function yw(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&XC(t,r)}function Qve(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:qq(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,s=QC;r&&(i=[n],s=P1);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return n.draft_=l,n.revoke_=o,l}var QC={get(e,t){if(t===uc)return e;const r=zh(e);if(!kA(r,t))return Jve(e,r,t);const n=r[t];return e.finalized_||!L0(n)?n:n===Gj(e.base_,t)?(Kj(e),e.copy_[t]=TA(n,e)):n},has(e,t){return t in zh(e)},ownKeys(e){return Reflect.ownKeys(zh(e))},set(e,t,r){const n=Hq(zh(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=Gj(zh(e),t),s=i==null?void 0:i[uc];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Vve(r,i)&&(r!==void 0||kA(e.base_,t)))return!0;Kj(e),EA(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Gj(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Kj(e),EA(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=zh(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){cu(11)},getPrototypeOf(e){return E1(e.base_)},setPrototypeOf(){cu(12)}},P1={};gw(QC,(e,t)=>{P1[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});P1.deleteProperty=function(e,t){return P1.set.call(this,e,t,void 0)};P1.set=function(e,t,r){return QC.set.call(this,e[0],t,r,e[0])};function Gj(e,t){const r=e[uc];return(r?zh(r):e)[t]}function Jve(e,t,r){var i;const n=Hq(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function Hq(e,t){if(!(t in e))return;let r=E1(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=E1(r)}}function EA(e){e.modified_||(e.modified_=!0,e.parent_&&EA(e.parent_))}function Kj(e){e.copy_||(e.copy_=AA(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Zve=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const o=this;return function(c=s,...u){return o.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&cu(6),n!==void 0&&typeof n!="function"&&cu(7);let i;if(L0(t)){const s=_L(this),o=TA(t,void 0);let l=!0;try{i=r(o),l=!1}finally{l?NA(s):CA(s)}return SL(s,n),jL(i,s)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===Uq&&(i=void 0),this.autoFreeze_&&XC(i,!0),n){const s=[],o=[];R0("Patches").generateReplacementPatches_(t,i,s,o),n(s,o)}return i}else cu(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let n,i;return[this.produce(t,r,(o,l)=>{n=o,i=l}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){L0(e)||cu(8),Hm(e)&&(e=e2e(e));const t=_L(this),r=TA(e,void 0);return r[uc].isManual_=!0,CA(t),r}finishDraft(e,t){const r=e&&e[uc];(!r||!r.isManual_)&&cu(9);const{scope_:n}=r;return SL(n,t),jL(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=R0("Patches").applyPatches_;return Hm(e)?n(e,t):this.produce(e,i=>n(i,t))}};function TA(e,t){const r=yy(e)?R0("MapSet").proxyMap_(e,t):o_(e)?R0("MapSet").proxySet_(e,t):Qve(e,t);return(t?t.scope_:qq()).drafts_.push(r),r}function e2e(e){return Hm(e)||cu(10,e),Vq(e)}function Vq(e){if(!L0(e)||l_(e))return e;const t=e[uc];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=AA(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=AA(e,!0);return gw(r,(i,s)=>{Wq(r,i,Vq(s))},n),t&&(t.finalized_=!1),r}var t2e=new Zve;t2e.produce;var r2e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Gq=Ll({name:"legend",initialState:r2e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:wa()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,i=xu(e).payload.indexOf(r);i>-1&&(e.payload[i]=n)},prepare:wa()},removeLegendPayload:{reducer(e,t){var r=xu(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:wa()}}}),{setLegendSize:AL,setLegendSettings:n2e,addLegendPayload:Kq,replaceLegendPayload:Yq,removeLegendPayload:Xq}=Gq.actions,i2e=Gq.reducer,a2e=["contextPayload"];function PA(){return PA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},PA.apply(null,arguments)}function NL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Vm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NL(Object(r),!0).forEach(function(n){s2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s2e(e,t,r){return(t=o2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o2e(e){var t=l2e(e,"string");return typeof t=="symbol"?t:t+""}function l2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function c2e(e,t){if(e==null)return{};var r,n,i=u2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function u2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function d2e(e){return e.value}function f2e(e){var{contextPayload:t}=e,r=c2e(e,a2e),n=DW(t,e.payloadUniqBy,d2e),i=Vm(Vm({},r),{},{payload:n});return x.isValidElement(e.content)?x.cloneElement(e.content,i):typeof e.content=="function"?x.createElement(e.content,i):x.createElement(xye,i)}function h2e(e,t,r,n,i,s){var{layout:o,align:l,verticalAlign:c}=t,u,d;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l==="center"&&o==="vertical"?u={left:((n||0)-s.width)/2}:u=l==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(c==="middle"?d={top:((i||0)-s.height)/2}:d=c==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),Vm(Vm({},u),d)}function p2e(e){var t=Zi();return x.useEffect(()=>{t(n2e(e))},[t,e]),null}function m2e(e){var t=Zi();return x.useEffect(()=>(t(AL(e)),()=>{t(AL({width:0,height:0}))}),[t,e]),null}function g2e(e,t,r,n){return e==="vertical"&&t!=null?{height:t}:e==="horizontal"?{width:r||n}:null}var x2e={align:"center",iconSize:14,inactiveColor:"#ccc",itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function JC(e){var t=ka(e,x2e),r=tbe(),n=u1e(),i=Wve(),{width:s,height:o,wrapperStyle:l,portal:c}=t,[u,d]=QW([r]),f=KC(),p=YC();if(f==null||p==null)return null;var h=f-((i==null?void 0:i.left)||0)-((i==null?void 0:i.right)||0),m=g2e(t.layout,o,s,h),g=c?l:Vm(Vm({position:"absolute",width:(m==null?void 0:m.width)||s||"auto",height:(m==null?void 0:m.height)||o||"auto"},h2e(l,t,i,f,p,u)),l),y=c??n;if(y==null||r==null)return null;var b=x.createElement("div",{className:"recharts-legend-wrapper",style:g,ref:d},x.createElement(p2e,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!c&&x.createElement(m2e,{width:u.width,height:u.height}),x.createElement(f2e,PA({},t,m,{margin:i,chartWidth:f,chartHeight:p,contextPayload:r})));return Y1.createPortal(b,y)}JC.displayName="Legend";function OA(){return OA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},OA.apply(null,arguments)}function CL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Kg(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CL(Object(r),!0).forEach(function(n){y2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function y2e(e,t,r){return(t=b2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function b2e(e){var t=v2e(e,"string");return typeof t=="symbol"?t:t+""}function v2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function w2e(e){return Array.isArray(e)&&Hc(e[0])&&Hc(e[1])?e.join(" ~ "):e}var Ap={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},S2e=e=>{var{separator:t=Ap.separator,contentStyle:r,itemStyle:n,labelStyle:i=Ap.labelStyle,payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:p=Ap.accessibilityLayer}=e,h=()=>{if(s&&s.length){var j={padding:0,margin:0},k=(l?VS(s,l):s).map((A,R)=>{if(A.type==="none")return null;var M=A.formatter||o||w2e,{value:B,name:E}=A,P=B,D=E;if(M){var G=M(B,E,A,R,s);if(Array.isArray(G))[P,D]=G;else if(G!=null)P=G;else return null}var H=Kg(Kg({},Ap.itemStyle),{},{color:A.color||Ap.itemStyle.color},n);return x.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(R),style:H},Hc(D)?x.createElement("span",{className:"recharts-tooltip-item-name"},D):null,Hc(D)?x.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,x.createElement("span",{className:"recharts-tooltip-item-value"},P),x.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return x.createElement("ul",{className:"recharts-tooltip-item-list",style:j},k)}return null},m=Kg(Kg({},Ap.contentStyle),r),g=Kg({margin:0},i),y=!Qi(d),b=y?d:"",v=Si("recharts-default-tooltip",c),w=Si("recharts-tooltip-label",u);y&&f&&s!==void 0&&s!==null&&(b=f(d,s));var S=p?{role:"status","aria-live":"assertive"}:{};return x.createElement("div",OA({className:v,style:m},S),x.createElement("p",{className:w,style:g},x.isValidElement(b)?b:"".concat(b)),h())},Yg="recharts-tooltip-wrapper",_2e={visibility:"hidden"};function j2e(e){var{coordinate:t,translateX:r,translateY:n}=e;return Si(Yg,{["".concat(Yg,"-right")]:An(r)&&t&&An(t.x)&&r>=t.x,["".concat(Yg,"-left")]:An(r)&&t&&An(t.x)&&r<t.x,["".concat(Yg,"-bottom")]:An(n)&&t&&An(t.y)&&n>=t.y,["".concat(Yg,"-top")]:An(n)&&t&&An(t.y)&&n<t.y})}function EL(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offset:i,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=e;if(s&&An(s[n]))return s[n];var d=r[n]-l-(i>0?i:0),f=r[n]+i;if(t[n])return o[n]?d:f;var p=c[n];if(p==null)return 0;if(o[n]){var h=d,m=p;return h<m?Math.max(f,p):Math.max(d,p)}if(u==null)return 0;var g=f+l,y=p+u;return g>y?Math.max(d,p):Math.max(f,p)}function k2e(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function A2e(e){var{allowEscapeViewBox:t,coordinate:r,offsetTop:n,offsetLeft:i,position:s,reverseDirection:o,tooltipBox:l,useTranslate3d:c,viewBox:u}=e,d,f,p;return l.height>0&&l.width>0&&r?(f=EL({allowEscapeViewBox:t,coordinate:r,key:"x",offset:i,position:s,reverseDirection:o,tooltipDimension:l.width,viewBox:u,viewBoxDimension:u.width}),p=EL({allowEscapeViewBox:t,coordinate:r,key:"y",offset:n,position:s,reverseDirection:o,tooltipDimension:l.height,viewBox:u,viewBoxDimension:u.height}),d=k2e({translateX:f,translateY:p,useTranslate3d:c})):d=_2e,{cssProperties:d,cssClasses:j2e({translateX:f,translateY:p,coordinate:r})}}function TL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function av(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TL(Object(r),!0).forEach(function(n){MA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MA(e,t,r){return(t=N2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N2e(e){var t=C2e(e,"string");return typeof t=="symbol"?t:t+""}function C2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class E2e extends x.PureComponent{constructor(){super(...arguments),MA(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),MA(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,i,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:p,viewBox:h,wrapperStyle:m,lastBoundingBox:g,innerRef:y,hasPortalFromProps:b}=this.props,v=typeof u=="number"?u:u.x,w=typeof u=="number"?u:u.y,{cssClasses:S,cssProperties:j}=A2e({allowEscapeViewBox:r,coordinate:o,offsetLeft:v,offsetTop:w,position:d,reverseDirection:f,tooltipBox:{height:g.height,width:g.width},useTranslate3d:p,viewBox:h}),k=b?{}:av(av({transition:c&&t?"transform ".concat(n,"ms ").concat(i):void 0},j),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),A=av(av({},k),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},m);return x.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:S,style:A,ref:y},s)}}var Qq=()=>{var e;return(e=Sn(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function LA(){return LA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LA.apply(null,arguments)}function PL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function OL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PL(Object(r),!0).forEach(function(n){T2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T2e(e,t,r){return(t=P2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P2e(e){var t=O2e(e,"string");return typeof t=="symbol"?t:t+""}function O2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ML={curveBasisClosed:E1e,curveBasisOpen:T1e,curveBasis:C1e,curveBumpX:p1e,curveBumpY:m1e,curveLinearClosed:P1e,curveLinear:BS,curveMonotoneX:O1e,curveMonotoneY:M1e,curveNatural:L1e,curveStep:R1e,curveStepAfter:B1e,curveStepBefore:F1e},bw=e=>fi(e.x)&&fi(e.y),LL=e=>e.base!=null&&bw(e.base)&&bw(e),Xg=e=>e.x,Qg=e=>e.y,M2e=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(fy(e));if((r==="curveMonotone"||r==="curveBump")&&t){var n=ML["".concat(r).concat(t==="vertical"?"Y":"X")];if(n)return n}return ML[r]||BS},RL={connectNulls:!1,type:"linear"},L2e=e=>{var{type:t=RL.type,points:r=[],baseLine:n,layout:i,connectNulls:s=RL.connectNulls}=e,o=M2e(t,i),l=s?r.filter(bw):r;if(Array.isArray(n)){var c,u=r.map((m,g)=>OL(OL({},m),{},{base:n[g]}));i==="vertical"?c=Qb().y(Qg).x1(Xg).x0(m=>m.base.x):c=Qb().x(Xg).y1(Qg).y0(m=>m.base.y);var d=c.defined(LL).curve(o),f=s?u.filter(LL):u;return d(f)}var p;i==="vertical"&&An(n)?p=Qb().y(Qg).x1(Xg).x0(n):An(n)?p=Qb().x(Xg).y1(Qg).y0(n):p=iW().x(Xg).y(Qg);var h=p.defined(bw).curve(o);return h(l)},c_=e=>{var{className:t,points:r,path:n,pathRef:i}=e,s=ip();if((!r||!r.length)&&!n)return null;var o={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||s,connectNulls:e.connectNulls},l=r&&r.length?L2e(o):n;return x.createElement("path",LA({},cl(e),AC(e),{className:Si("recharts-curve",t),d:l===null?void 0:l,ref:i}))},R2e=["x","y","top","left","width","height","className"];function RA(){return RA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},RA.apply(null,arguments)}function FL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function F2e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FL(Object(r),!0).forEach(function(n){B2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B2e(e,t,r){return(t=I2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I2e(e){var t=D2e(e,"string");return typeof t=="symbol"?t:t+""}function D2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $2e(e,t){if(e==null)return{};var r,n,i=U2e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function U2e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var z2e=(e,t,r,n,i,s)=>"M".concat(e,",").concat(i,"v").concat(n,"M").concat(s,",").concat(t,"h").concat(r),W2e=e=>{var{x:t=0,y:r=0,top:n=0,left:i=0,width:s=0,height:o=0,className:l}=e,c=$2e(e,R2e),u=F2e({x:t,y:r,top:n,left:i,width:s,height:o},c);return!An(t)||!An(r)||!An(s)||!An(o)||!An(n)||!An(i)?null:x.createElement("path",RA({},Vo(u),{className:Si("recharts-cross",l),d:z2e(t,r,s,o,n,i)}))};function q2e(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function BL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function IL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?BL(Object(r),!0).forEach(function(n){H2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):BL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function H2e(e,t,r){return(t=V2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function V2e(e){var t=G2e(e,"string");return typeof t=="symbol"?t:t+""}function G2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K2e=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),Jq=(e,t,r)=>e.map(n=>"".concat(K2e(n)," ").concat(t,"ms ").concat(r)).join(","),Y2e=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(i=>n.includes(i))),O1=(e,t)=>Object.keys(t).reduce((r,n)=>IL(IL({},r),{},{[n]:e(n,t[n])}),{});function DL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ts(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DL(Object(r),!0).forEach(function(n){X2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function X2e(e,t,r){return(t=Q2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q2e(e){var t=J2e(e,"string");return typeof t=="symbol"?t:t+""}function J2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vw=(e,t,r)=>e+(t-e)*r,FA=e=>{var{from:t,to:r}=e;return t!==r},Zq=(e,t,r)=>{var n=O1((i,s)=>{if(FA(s)){var[o,l]=e(s.from,s.to,s.velocity);return Ts(Ts({},s),{},{from:o,velocity:l})}return s},t);return r<1?O1((i,s)=>FA(s)&&n[i]!=null?Ts(Ts({},s),{},{velocity:vw(s.velocity,n[i].velocity,r),from:vw(s.from,n[i].from,r)}):s,t):Zq(e,n,r-1)};function Z2e(e,t,r,n,i,s){var o,l=n.reduce((p,h)=>Ts(Ts({},p),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>O1((p,h)=>h.from,l),u=()=>!Object.values(l).filter(FA).length,d=null,f=p=>{o||(o=p);var h=p-o,m=h/r.dt;l=Zq(r,l,m),i(Ts(Ts(Ts({},e),t),c())),o=p,u()||(d=s.setTimeout(f))};return()=>(d=s.setTimeout(f),()=>{var p;(p=d)===null||p===void 0||p()})}function ewe(e,t,r,n,i,s,o){var l=null,c=i.reduce((f,p)=>{var h=e[p],m=t[p];return h==null||m==null?f:Ts(Ts({},f),{},{[p]:[h,m]})},{}),u,d=f=>{u||(u=f);var p=(f-u)/n,h=O1((g,y)=>vw(...y,r(p)),c);if(s(Ts(Ts(Ts({},e),t),h)),p<1)l=o.setTimeout(d);else{var m=O1((g,y)=>vw(...y,r(1)),c);s(Ts(Ts(Ts({},e),t),m))}};return()=>(l=o.setTimeout(d),()=>{var f;(f=l)===null||f===void 0||f()})}const twe=(e,t,r,n,i,s)=>{var o=Y2e(e,t);return r==null?()=>(i(Ts(Ts({},e),t)),()=>{}):r.isStepper===!0?Z2e(e,t,r,o,i,s):ewe(e,t,r,n,o,i,s)};var ww=1e-4,eH=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],tH=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),$L=(e,t)=>r=>{var n=eH(e,t);return tH(n,r)},rwe=(e,t)=>r=>{var n=eH(e,t),i=[...n.map((s,o)=>s*o).slice(1),0];return tH(i,r)},nwe=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var i=n.map(s=>parseFloat(s));return[i[0],i[1],i[2],i[3]]},iwe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i=nwe(r[0]);if(i)return i}}return r.length===4?r:[0,0,1,1]},awe=(e,t,r,n)=>{var i=$L(e,r),s=$L(t,n),o=rwe(e,r),l=u=>u>1?1:u<0?0:u,c=u=>{for(var d=u>1?1:u,f=d,p=0;p<8;++p){var h=i(f)-d,m=o(f);if(Math.abs(h-d)<ww||m<ww)return s(f);f=l(f-h/m)}return s(f)};return c.isStepper=!1,c},UL=function(){return awe(...iwe(...arguments))},swe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=t,s=(o,l,c)=>{var u=-(o-l)*r,d=c*n,f=c+(u-d)*i/1e3,p=c*i/1e3+o;return Math.abs(p-l)<ww&&Math.abs(f)<ww?[l,0]:[p,f]};return s.isStepper=!0,s.dt=i,s},owe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return UL(e);case"spring":return swe();default:if(e.split("(")[0]==="cubic-bezier")return UL(e)}return typeof e=="function"?e:null};function lwe(e){var t,r=()=>null,n=!1,i=null,s=o=>{if(!n){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...u]=l;if(typeof c=="number"){i=e.setTimeout(s.bind(null,u),c);return}s(c),i=e.setTimeout(s.bind(null,u));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{n=!0},start:o=>{n=!1,i&&(i(),i=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class cwe{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,s=o=>{o-n>=r?t(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(s))};return i=requestAnimationFrame(s),()=>{i!=null&&cancelAnimationFrame(i)}}}function uwe(){return lwe(new cwe)}var dwe=x.createContext(uwe);function fwe(e,t){var r=x.useContext(dwe);return x.useMemo(()=>t??r(e),[e,t,r])}var hwe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),u_={isSsr:hwe()},pwe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},zL={t:0},Yj={t:1};function mg(e){var t=ka(e,pwe),{isActive:r,canBegin:n,duration:i,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:u}=t,d=r==="auto"?!u_.isSsr:r,f=fwe(t.animationId,t.animationManager),[p,h]=x.useState(d?zL:Yj),m=x.useRef(null);return x.useEffect(()=>{d||h(Yj)},[d]),x.useEffect(()=>{if(!d||!n)return np;var g=twe(zL,Yj,owe(s),i,h,f.getTimeoutController()),y=()=>{m.current=g()};return f.start([c,o,y,i,l]),()=>{f.stop(),m.current&&m.current(),l()}},[d,n,i,s,o,c,l,f]),u(p.t)}function gg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=x.useRef(k1(t)),n=x.useRef(e);return n.current!==e&&(r.current=k1(t),n.current=e),r.current}var mwe=["radius"],gwe=["radius"],WL,qL,HL,VL,GL,KL,YL,XL,QL,JL;function ZL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function e7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZL(Object(r),!0).forEach(function(n){xwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xwe(e,t,r){return(t=ywe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ywe(e){var t=bwe(e,"string");return typeof t=="symbol"?t:t+""}function bwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Sw(){return Sw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sw.apply(null,arguments)}function t7(e,t){if(e==null)return{};var r,n,i=vwe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function vwe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ru(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var r7=(e,t,r,n,i)=>{var s=Xf(r),o=Xf(n),l=Math.min(Math.abs(s)/2,Math.abs(o)/2),c=o>=0?1:-1,u=s>=0?1:-1,d=o>=0&&s>=0||o<0&&s<0?1:0,f;if(l>0&&Array.isArray(i)){for(var p=[0,0,0,0],h=0,m=4;h<m;h++){var g,y=(g=i[h])!==null&&g!==void 0?g:0;p[h]=y>l?l:y}f=za(WL||(WL=Ru(["M",",",""])),e,t+c*p[0]),p[0]>0&&(f+=za(qL||(qL=Ru(["A ",",",",0,0,",",",",",""])),p[0],p[0],d,e+u*p[0],t)),f+=za(HL||(HL=Ru(["L ",",",""])),e+r-u*p[1],t),p[1]>0&&(f+=za(VL||(VL=Ru(["A ",",",",0,0,",`,
        `,",",""])),p[1],p[1],d,e+r,t+c*p[1])),f+=za(GL||(GL=Ru(["L ",",",""])),e+r,t+n-c*p[2]),p[2]>0&&(f+=za(KL||(KL=Ru(["A ",",",",0,0,",`,
        `,",",""])),p[2],p[2],d,e+r-u*p[2],t+n)),f+=za(YL||(YL=Ru(["L ",",",""])),e+u*p[3],t+n),p[3]>0&&(f+=za(XL||(XL=Ru(["A ",",",",0,0,",`,
        `,",",""])),p[3],p[3],d,e,t+n-c*p[3])),f+="Z"}else if(l>0&&i===+i&&i>0){var b=Math.min(l,i);f=za(QL||(QL=Ru(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+c*b,b,b,d,e+u*b,t,e+r-u*b,t,b,b,d,e+r,t+c*b,e+r,t+n-c*b,b,b,d,e+r-u*b,t+n,e+u*b,t+n,b,b,d,e,t+n-c*b)}else f=za(JL||(JL=Ru(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return f},n7={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},rH=e=>{var t=ka(e,n7),r=x.useRef(null),[n,i]=x.useState(-1);x.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var de=r.current.getTotalLength();de&&i(de)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:p,animationBegin:h,isAnimationActive:m,isUpdateAnimationActive:g}=t,y=x.useRef(l),b=x.useRef(c),v=x.useRef(s),w=x.useRef(o),S=x.useMemo(()=>({x:s,y:o,width:l,height:c,radius:u}),[s,o,l,c,u]),j=gg(S,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var k=Si("recharts-rectangle",d);if(!g){var A=Vo(t),{radius:R}=A,M=t7(A,mwe);return x.createElement("path",Sw({},M,{x:Xf(s),y:Xf(o),width:Xf(l),height:Xf(c),radius:typeof u=="number"?u:void 0,className:k,d:r7(s,o,l,c,u)}))}var B=y.current,E=b.current,P=v.current,D=w.current,G="0px ".concat(n===-1?1:n,"px"),H="".concat(n,"px 0px"),oe=Jq(["strokeDasharray"],p,typeof f=="string"?f:n7.animationEasing);return x.createElement(mg,{animationId:j,key:j,canBegin:n>0,duration:p,easing:f,isActive:g,begin:h},de=>{var W=Xi(B,l,de),V=Xi(E,c,de),ae=Xi(P,s,de),ee=Xi(D,o,de);r.current&&(y.current=W,b.current=V,v.current=ae,w.current=ee);var C;m?de>0?C={transition:oe,strokeDasharray:H}:C={strokeDasharray:G}:C={strokeDasharray:H};var Y=Vo(t),{radius:q}=Y,O=t7(Y,gwe);return x.createElement("path",Sw({},O,{radius:typeof u=="number"?u:void 0,className:k,d:r7(ae,ee,W,V,u),ref:r,style:e7(e7({},C),t.style)}))})};function i7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function a7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i7(Object(r),!0).forEach(function(n){wwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wwe(e,t,r){return(t=Swe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Swe(e){var t=_we(e,"string");return typeof t=="symbol"?t:t+""}function _we(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _w=Math.PI/180,jwe=e=>e*180/Math.PI,bs=(e,t,r,n)=>({x:e+Math.cos(-_w*n)*r,y:t+Math.sin(-_w*n)*r}),nH=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},kwe=(e,t)=>{var{x:r,y:n}=e,{x:i,y:s}=t;return Math.sqrt((r-i)**2+(n-s)**2)},Awe=(e,t)=>{var{x:r,y:n}=e,{cx:i,cy:s}=t,o=kwe({x:r,y:n},{x:i,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-i)/o,c=Math.acos(l);return n>s&&(c=2*Math.PI-c),{radius:o,angle:jwe(c),angleInRadian:c}},Nwe=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),i=Math.floor(r/360),s=Math.min(n,i);return{startAngle:t-s*360,endAngle:r-s*360}},Cwe=(e,t)=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),s=Math.floor(n/360),o=Math.min(i,s);return e+o*360},Ewe=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:i,angle:s}=Awe({x:r,y:n},t),{innerRadius:o,outerRadius:l}=t;if(i<o||i>l||i===0)return null;var{startAngle:c,endAngle:u}=Nwe(t),d=s,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?a7(a7({},t),{},{radius:i,angle:Cwe(d,t)}):null};function iH(e){var{cx:t,cy:r,radius:n,startAngle:i,endAngle:s}=e,o=bs(t,r,n,i),l=bs(t,r,n,s);return{points:[o,l],cx:t,cy:r,radius:n,startAngle:i,endAngle:s}}var s7,o7,l7,c7,u7,d7,f7;function BA(){return BA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},BA.apply(null,arguments)}function Qh(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Twe=(e,t)=>{var r=Xs(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},sv=e=>{var{cx:t,cy:r,radius:n,angle:i,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,u=l*(o?1:-1)+n,d=Math.asin(l/u)/_w,f=c?i:i+s*d,p=bs(t,r,u,f),h=bs(t,r,n,f),m=c?i-s*d:i,g=bs(t,r,u*Math.cos(d*_w),m);return{center:p,circleTangency:h,lineTangency:g,theta:d}},aH=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:s,endAngle:o}=e,l=Twe(s,o),c=s+l,u=bs(t,r,i,s),d=bs(t,r,i,c),f=za(s7||(s7=Qh(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),u.x,u.y,i,i,+(Math.abs(l)>180),+(s>c),d.x,d.y);if(n>0){var p=bs(t,r,n,s),h=bs(t,r,n,c);f+=za(o7||(o7=Qh(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),h.x,h.y,n,n,+(Math.abs(l)>180),+(s<=c),p.x,p.y)}else f+=za(l7||(l7=Qh(["L ",","," Z"])),t,r);return f},Pwe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}=e,d=Xs(u-c),{circleTangency:f,lineTangency:p,theta:h}=sv({cx:t,cy:r,radius:i,angle:c,sign:d,cornerRadius:s,cornerIsExternal:l}),{circleTangency:m,lineTangency:g,theta:y}=sv({cx:t,cy:r,radius:i,angle:u,sign:-d,cornerRadius:s,cornerIsExternal:l}),b=l?Math.abs(c-u):Math.abs(c-u)-h-y;if(b<0)return o?za(c7||(c7=Qh(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),p.x,p.y,s,s,s*2,s,s,-s*2):aH({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:c,endAngle:u});var v=za(u7||(u7=Qh(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),p.x,p.y,s,s,+(d<0),f.x,f.y,i,i,+(b>180),+(d<0),m.x,m.y,s,s,+(d<0),g.x,g.y);if(n>0){var{circleTangency:w,lineTangency:S,theta:j}=sv({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:k,lineTangency:A,theta:R}=sv({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),M=l?Math.abs(c-u):Math.abs(c-u)-j-R;if(M<0&&s===0)return"".concat(v,"L").concat(t,",").concat(r,"Z");v+=za(d7||(d7=Qh(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),A.x,A.y,s,s,+(d<0),k.x,k.y,n,n,+(M>180),+(d>0),w.x,w.y,s,s,+(d<0),S.x,S.y)}else v+=za(f7||(f7=Qh(["L",",","Z"])),t,r);return v},Owe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},sH=e=>{var t=ka(e,Owe),{cx:r,cy:n,innerRadius:i,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(s<i||u===d)return null;var p=Si("recharts-sector",f),h=s-i,m=Wo(o,h,0,!0),g;return m>0&&Math.abs(u-d)<360?g=Pwe({cx:r,cy:n,innerRadius:i,outerRadius:s,cornerRadius:Math.min(m,h/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):g=aH({cx:r,cy:n,innerRadius:i,outerRadius:s,startAngle:u,endAngle:d}),x.createElement("path",BA({},Vo(t),{className:p,d:g}))};function Mwe(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(vW(t)){if(e==="centric"){var{cx:n,cy:i,innerRadius:s,outerRadius:o,angle:l}=t,c=bs(n,i,s,l),u=bs(n,i,o,l);return[{x:c.x,y:c.y},{x:u.x,y:u.y}]}return iH(t)}}var oH={},lH={},cH={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FC;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(cH);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cH;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(lH);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=BC,r=lH;function n(i,s,o){o&&typeof o!="number"&&t.isIterateeCall(i,s,o)&&(s=o=void 0),i=r.toFinite(i),s===void 0?(s=i,i=0):s=r.toFinite(s),o=o===void 0?i<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-i)/(o||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=i,i+=o;return c}e.range=n})(oH);var Lwe=oH.range;const uH=sf(Lwe);function oh(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Rwe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function ZC(e){let t,r,n;e.length!==2?(t=oh,r=(l,c)=>oh(e(l),c),n=(l,c)=>e(l)-c):(t=e===oh||e===Rwe?e:Fwe,r=e,n=e);function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<0?u=f+1:d=f}while(u<d)}return u}function s(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(l[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function o(l,c,u=0,d=l.length){const f=i(l,c,u,d-1);return f>u&&n(l[f-1],c)>-n(l[f],c)?f-1:f}return{left:i,center:o,right:s}}function Fwe(){return 0}function dH(e){return e===null?NaN:+e}function*Bwe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const Iwe=ZC(oh),by=Iwe.right;ZC(dH).center;class h7 extends Map{constructor(t,r=Uwe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(p7(this,t))}has(t){return super.has(p7(this,t))}set(t,r){return super.set(Dwe(this,t),r)}delete(t){return super.delete($we(this,t))}}function p7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function Dwe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function $we({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function Uwe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function zwe(e=oh){if(e===oh)return fH;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function fH(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const Wwe=Math.sqrt(50),qwe=Math.sqrt(10),Hwe=Math.sqrt(2);function jw(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),s=n/Math.pow(10,i),o=s>=Wwe?10:s>=qwe?5:s>=Hwe?2:1;let l,c,u;return i<0?(u=Math.pow(10,-i)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,i)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=r&&r<2?jw(e,t,r*2):[l,c,u]}function IA(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,s,o]=n?jw(t,e,r):jw(e,t,r);if(!(s>=i))return[];const l=s-i+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(s-u)/-o;else for(let u=0;u<l;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(i+u)/-o;else for(let u=0;u<l;++u)c[u]=(i+u)*o;return c}function DA(e,t,r){return t=+t,e=+e,r=+r,jw(e,t,r)[2]}function $A(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?DA(t,e,r):DA(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function m7(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function g7(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function hH(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?fH:zwe(i);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),p=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(t-u*f/c+p)),m=Math.min(n,Math.floor(t+(c-u)*f/c+p));hH(e,t,h,m,i)}const s=e[t];let o=r,l=n;for(Jg(e,r,t),i(e[n],s)>0&&Jg(e,r,n);o<l;){for(Jg(e,o,l),++o,--l;i(e[o],s)<0;)++o;for(;i(e[l],s)>0;)--l}i(e[r],s)===0?Jg(e,r,l):(++l,Jg(e,l,n)),l<=t&&(r=l+1),t<=l&&(n=l-1)}return e}function Jg(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function Vwe(e,t,r){if(e=Float64Array.from(Bwe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return g7(e);if(t>=1)return m7(e);var n,i=(n-1)*t,s=Math.floor(i),o=m7(hH(e,s).subarray(0,s+1)),l=g7(e.subarray(s+1));return o+(l-o)*(i-s)}}function Gwe(e,t,r=dH){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,s=Math.floor(i),o=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return o+(l-o)*(i-s)}}function Kwe(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(i);++n<i;)s[n]=e+n*r;return s}function Yc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function gf(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const UA=Symbol("implicit");function eE(){var e=new h7,t=[],r=[],n=UA;function i(s){let o=e.get(s);if(o===void 0){if(n!==UA)return n;e.set(s,o=t.push(s)-1)}return r[o%r.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new h7;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(r=Array.from(s),i):r.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return eE(t,r).unknown(n)},Yc.apply(i,arguments),i}function tE(){var e=eE().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,s,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var p=t().length,h=i<n,m=h?i:n,g=h?n:i;s=(g-m)/Math.max(1,p-c+u*2),l&&(s=Math.floor(s)),m+=(g-m-s*(p-c))*d,o=s*(1-c),l&&(m=Math.round(m),o=Math.round(o));var y=Kwe(p).map(function(b){return m+s*b});return r(h?y.reverse():y)}return e.domain=function(p){return arguments.length?(t(p),f()):t()},e.range=function(p){return arguments.length?([n,i]=p,n=+n,i=+i,f()):[n,i]},e.rangeRound=function(p){return[n,i]=p,n=+n,i=+i,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(p){return arguments.length?(l=!!p,f()):l},e.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),f()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),f()):c},e.paddingOuter=function(p){return arguments.length?(u=+p,f()):u},e.align=function(p){return arguments.length?(d=Math.max(0,Math.min(1,p)),f()):d},e.copy=function(){return tE(t(),[n,i]).round(l).paddingInner(c).paddingOuter(u).align(d)},Yc.apply(f(),arguments)}function pH(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return pH(t())},e}function Ywe(){return pH(tE.apply(null,arguments).paddingInner(1))}function rE(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function mH(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function vy(){}var M1=.7,kw=1/M1,Sm="\\s*([+-]?\\d+)\\s*",L1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",td="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xwe=/^#([0-9a-f]{3,8})$/,Qwe=new RegExp(`^rgb\\(${Sm},${Sm},${Sm}\\)$`),Jwe=new RegExp(`^rgb\\(${td},${td},${td}\\)$`),Zwe=new RegExp(`^rgba\\(${Sm},${Sm},${Sm},${L1}\\)$`),eSe=new RegExp(`^rgba\\(${td},${td},${td},${L1}\\)$`),tSe=new RegExp(`^hsl\\(${L1},${td},${td}\\)$`),rSe=new RegExp(`^hsla\\(${L1},${td},${td},${L1}\\)$`),x7={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};rE(vy,R1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:y7,formatHex:y7,formatHex8:nSe,formatHsl:iSe,formatRgb:b7,toString:b7});function y7(){return this.rgb().formatHex()}function nSe(){return this.rgb().formatHex8()}function iSe(){return gH(this).formatHsl()}function b7(){return this.rgb().formatRgb()}function R1(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=Xwe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?v7(t):r===3?new jl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?ov(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?ov(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Qwe.exec(e))?new jl(t[1],t[2],t[3],1):(t=Jwe.exec(e))?new jl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Zwe.exec(e))?ov(t[1],t[2],t[3],t[4]):(t=eSe.exec(e))?ov(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=tSe.exec(e))?_7(t[1],t[2]/100,t[3]/100,1):(t=rSe.exec(e))?_7(t[1],t[2]/100,t[3]/100,t[4]):x7.hasOwnProperty(e)?v7(x7[e]):e==="transparent"?new jl(NaN,NaN,NaN,0):null}function v7(e){return new jl(e>>16&255,e>>8&255,e&255,1)}function ov(e,t,r,n){return n<=0&&(e=t=r=NaN),new jl(e,t,r,n)}function aSe(e){return e instanceof vy||(e=R1(e)),e?(e=e.rgb(),new jl(e.r,e.g,e.b,e.opacity)):new jl}function zA(e,t,r,n){return arguments.length===1?aSe(e):new jl(e,t,r,n??1)}function jl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}rE(jl,zA,mH(vy,{brighter(e){return e=e==null?kw:Math.pow(kw,e),new jl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?M1:Math.pow(M1,e),new jl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new jl(f0(this.r),f0(this.g),f0(this.b),Aw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:w7,formatHex:w7,formatHex8:sSe,formatRgb:S7,toString:S7}));function w7(){return`#${Jh(this.r)}${Jh(this.g)}${Jh(this.b)}`}function sSe(){return`#${Jh(this.r)}${Jh(this.g)}${Jh(this.b)}${Jh((isNaN(this.opacity)?1:this.opacity)*255)}`}function S7(){const e=Aw(this.opacity);return`${e===1?"rgb(":"rgba("}${f0(this.r)}, ${f0(this.g)}, ${f0(this.b)}${e===1?")":`, ${e})`}`}function Aw(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function f0(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Jh(e){return e=f0(e),(e<16?"0":"")+e.toString(16)}function _7(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new uu(e,t,r,n)}function gH(e){if(e instanceof uu)return new uu(e.h,e.s,e.l,e.opacity);if(e instanceof vy||(e=R1(e)),!e)return new uu;if(e instanceof uu)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,l=s-i,c=(s+i)/2;return l?(t===s?o=(r-n)/l+(r<n)*6:r===s?o=(n-t)/l+2:o=(t-r)/l+4,l/=c<.5?s+i:2-s-i,o*=60):l=c>0&&c<1?0:o,new uu(o,l,c,e.opacity)}function oSe(e,t,r,n){return arguments.length===1?gH(e):new uu(e,t,r,n??1)}function uu(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}rE(uu,oSe,mH(vy,{brighter(e){return e=e==null?kw:Math.pow(kw,e),new uu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?M1:Math.pow(M1,e),new uu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new jl(Xj(e>=240?e-240:e+120,i,n),Xj(e,i,n),Xj(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new uu(j7(this.h),lv(this.s),lv(this.l),Aw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Aw(this.opacity);return`${e===1?"hsl(":"hsla("}${j7(this.h)}, ${lv(this.s)*100}%, ${lv(this.l)*100}%${e===1?")":`, ${e})`}`}}));function j7(e){return e=(e||0)%360,e<0?e+360:e}function lv(e){return Math.max(0,Math.min(1,e||0))}function Xj(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const nE=e=>()=>e;function lSe(e,t){return function(r){return e+r*t}}function cSe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function uSe(e){return(e=+e)==1?xH:function(t,r){return r-t?cSe(t,r,e):nE(isNaN(t)?r:t)}}function xH(e,t){var r=t-e;return r?lSe(e,r):nE(isNaN(e)?t:e)}const k7=function e(t){var r=uSe(t);function n(i,s){var o=r((i=zA(i)).r,(s=zA(s)).r),l=r(i.g,s.g),c=r(i.b,s.b),u=xH(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=l(d),i.b=c(d),i.opacity=u(d),i+""}}return n.gamma=e,n}(1);function dSe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(s){for(i=0;i<r;++i)n[i]=e[i]*(1-s)+t[i]*s;return n}}function fSe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function hSe(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),s=new Array(r),o;for(o=0;o<n;++o)i[o]=xg(e[o],t[o]);for(;o<r;++o)s[o]=t[o];return function(l){for(o=0;o<n;++o)s[o]=i[o](l);return s}}function pSe(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Nw(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function mSe(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=xg(e[i],t[i]):n[i]=t[i];return function(s){for(i in r)n[i]=r[i](s);return n}}var WA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qj=new RegExp(WA.source,"g");function gSe(e){return function(){return e}}function xSe(e){return function(t){return e(t)+""}}function ySe(e,t){var r=WA.lastIndex=Qj.lastIndex=0,n,i,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=WA.exec(e))&&(i=Qj.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(n=n[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,c.push({i:o,x:Nw(n,i)})),r=Qj.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?xSe(c[0].x):gSe(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)l[(f=c[d]).i]=f.x(u);return l.join("")})}function xg(e,t){var r=typeof t,n;return t==null||r==="boolean"?nE(t):(r==="number"?Nw:r==="string"?(n=R1(t))?(t=n,k7):ySe:t instanceof R1?k7:t instanceof Date?pSe:fSe(t)?dSe:Array.isArray(t)?hSe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?mSe:Nw)(e,t)}function iE(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function bSe(e,t){t===void 0&&(t=e,e=xg);for(var r=0,n=t.length-1,i=t[0],s=new Array(n<0?0:n);r<n;)s[r]=e(i,i=t[++r]);return function(o){var l=Math.max(0,Math.min(n-1,Math.floor(o*=n)));return s[l](o-l)}}function vSe(e){return function(){return e}}function Cw(e){return+e}var A7=[0,1];function nl(e){return e}function qA(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:vSe(isNaN(t)?NaN:.5)}function wSe(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function SSe(e,t,r){var n=e[0],i=e[1],s=t[0],o=t[1];return i<n?(n=qA(i,n),s=r(o,s)):(n=qA(n,i),s=r(s,o)),function(l){return s(n(l))}}function _Se(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),s=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)i[o]=qA(e[o],e[o+1]),s[o]=r(t[o],t[o+1]);return function(l){var c=by(e,l,1,n)-1;return s[c](i[c](l))}}function wy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function d_(){var e=A7,t=A7,r=xg,n,i,s,o=nl,l,c,u;function d(){var p=Math.min(e.length,t.length);return o!==nl&&(o=wSe(e[0],e[p-1])),l=p>2?_Se:SSe,c=u=null,f}function f(p){return p==null||isNaN(p=+p)?s:(c||(c=l(e.map(n),t,r)))(n(o(p)))}return f.invert=function(p){return o(i((u||(u=l(t,e.map(n),Nw)))(p)))},f.domain=function(p){return arguments.length?(e=Array.from(p,Cw),d()):e.slice()},f.range=function(p){return arguments.length?(t=Array.from(p),d()):t.slice()},f.rangeRound=function(p){return t=Array.from(p),r=iE,d()},f.clamp=function(p){return arguments.length?(o=p?!0:nl,d()):o!==nl},f.interpolate=function(p){return arguments.length?(r=p,d()):r},f.unknown=function(p){return arguments.length?(s=p,f):s},function(p,h){return n=p,i=h,d()}}function aE(){return d_()(nl,nl)}function jSe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ew(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Gm(e){return e=Ew(Math.abs(e)),e?e[1]:NaN}function kSe(e,t){return function(r,n){for(var i=r.length,s=[],o=0,l=e[0],c=0;i>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),s.push(r.substring(i-=l,i+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return s.reverse().join(t)}}function ASe(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var NSe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function F1(e){if(!(t=NSe.exec(e)))throw new Error("invalid format: "+e);var t;return new sE({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}F1.prototype=sE.prototype;function sE(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}sE.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function CSe(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var Tw;function ESe(e,t){var r=Ew(e,t);if(!r)return Tw=void 0,e.toPrecision(t);var n=r[0],i=r[1],s=i-(Tw=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=n.length;return s===o?n:s>o?n+new Array(s-o+1).join("0"):s>0?n.slice(0,s)+"."+n.slice(s):"0."+new Array(1-s).join("0")+Ew(e,Math.max(0,t+s-1))[0]}function N7(e,t){var r=Ew(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const C7={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:jSe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>N7(e*100,t),r:N7,s:ESe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function E7(e){return e}var T7=Array.prototype.map,P7=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function TSe(e){var t=e.grouping===void 0||e.thousands===void 0?E7:kSe(T7.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?E7:ASe(T7.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f,p){f=F1(f);var h=f.fill,m=f.align,g=f.sign,y=f.symbol,b=f.zero,v=f.width,w=f.comma,S=f.precision,j=f.trim,k=f.type;k==="n"?(w=!0,k="g"):C7[k]||(S===void 0&&(S=12),j=!0,k="g"),(b||h==="0"&&m==="=")&&(b=!0,h="0",m="=");var A=(p&&p.prefix!==void 0?p.prefix:"")+(y==="$"?r:y==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():""),R=(y==="$"?n:/[%p]/.test(k)?o:"")+(p&&p.suffix!==void 0?p.suffix:""),M=C7[k],B=/[defgprs%]/.test(k);S=S===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function E(P){var D=A,G=R,H,oe,de;if(k==="c")G=M(P)+G,P="";else{P=+P;var W=P<0||1/P<0;if(P=isNaN(P)?c:M(Math.abs(P),S),j&&(P=CSe(P)),W&&+P==0&&g!=="+"&&(W=!1),D=(W?g==="("?g:l:g==="-"||g==="("?"":g)+D,G=(k==="s"&&!isNaN(P)&&Tw!==void 0?P7[8+Tw/3]:"")+G+(W&&g==="("?")":""),B){for(H=-1,oe=P.length;++H<oe;)if(de=P.charCodeAt(H),48>de||de>57){G=(de===46?i+P.slice(H+1):P.slice(H))+G,P=P.slice(0,H);break}}}w&&!b&&(P=t(P,1/0));var V=D.length+P.length+G.length,ae=V<v?new Array(v-V+1).join(h):"";switch(w&&b&&(P=t(ae+P,ae.length?v-G.length:1/0),ae=""),m){case"<":P=D+P+G+ae;break;case"=":P=D+ae+P+G;break;case"^":P=ae.slice(0,V=ae.length>>1)+D+P+G+ae.slice(V);break;default:P=ae+D+P+G;break}return s(P)}return E.toString=function(){return f+""},E}function d(f,p){var h=Math.max(-8,Math.min(8,Math.floor(Gm(p)/3)))*3,m=Math.pow(10,-h),g=u((f=F1(f),f.type="f",f),{suffix:P7[8+h/3]});return function(y){return g(m*y)}}return{format:u,formatPrefix:d}}var cv,oE,yH;PSe({thousands:",",grouping:[3],currency:["$",""]});function PSe(e){return cv=TSe(e),oE=cv.format,yH=cv.formatPrefix,cv}function OSe(e){return Math.max(0,-Gm(Math.abs(e)))}function MSe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Gm(t)/3)))*3-Gm(Math.abs(e)))}function LSe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Gm(t)-Gm(e))+1}function bH(e,t,r,n){var i=$A(e,t,r),s;switch(n=F1(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(s=MSe(i,o))&&(n.precision=s),yH(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(s=LSe(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=s-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(s=OSe(i))&&(n.precision=s-(n.type==="%")*2);break}}return oE(n)}function Eh(e){var t=e.domain;return e.ticks=function(r){var n=t();return IA(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return bH(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,s=n.length-1,o=n[i],l=n[s],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=i,i=s,s=u);d-- >0;){if(u=DA(o,l,r),u===c)return n[i]=o,n[s]=l,t(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function vH(){var e=aE();return e.copy=function(){return wy(e,vH())},Yc.apply(e,arguments),Eh(e)}function wH(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Cw),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return wH(e).unknown(t)},e=arguments.length?Array.from(e,Cw):[0,1],Eh(r)}function SH(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],s=e[n],o;return s<i&&(o=r,r=n,n=o,o=i,i=s,s=o),e[r]=t.floor(i),e[n]=t.ceil(s),e}function O7(e){return Math.log(e)}function M7(e){return Math.exp(e)}function RSe(e){return-Math.log(-e)}function FSe(e){return-Math.exp(-e)}function BSe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function ISe(e){return e===10?BSe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function DSe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function L7(e){return(t,r)=>-e(-t,r)}function lE(e){const t=e(O7,M7),r=t.domain;let n=10,i,s;function o(){return i=DSe(n),s=ISe(n),r()[0]<0?(i=L7(i),s=L7(s),e(RSe,FSe)):e(O7,M7),t}return t.base=function(l){return arguments.length?(n=+l,o()):n},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let p=i(u),h=i(d),m,g;const y=l==null?10:+l;let b=[];if(!(n%1)&&h-p<y){if(p=Math.floor(p),h=Math.ceil(h),u>0){for(;p<=h;++p)for(m=1;m<n;++m)if(g=p<0?m/s(-p):m*s(p),!(g<u)){if(g>d)break;b.push(g)}}else for(;p<=h;++p)for(m=n-1;m>=1;--m)if(g=p>0?m/s(-p):m*s(p),!(g<u)){if(g>d)break;b.push(g)}b.length*2<y&&(b=IA(u,d,y))}else b=IA(p,h,Math.min(h-p,y)).map(s);return f?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=F1(c)).precision==null&&(c.trim=!0),c=oE(c)),l===1/0)return c;const u=Math.max(1,n*l/t.ticks().length);return d=>{let f=d/s(Math.round(i(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(SH(r(),{floor:l=>s(Math.floor(i(l))),ceil:l=>s(Math.ceil(i(l)))})),t}function _H(){const e=lE(d_()).domain([1,10]);return e.copy=()=>wy(e,_H()).base(e.base()),Yc.apply(e,arguments),e}function R7(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function F7(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function cE(e){var t=1,r=e(R7(t),F7(t));return r.constant=function(n){return arguments.length?e(R7(t=+n),F7(t)):t},Eh(r)}function jH(){var e=cE(d_());return e.copy=function(){return wy(e,jH()).constant(e.constant())},Yc.apply(e,arguments)}function B7(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $Se(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function USe(e){return e<0?-e*e:e*e}function uE(e){var t=e(nl,nl),r=1;function n(){return r===1?e(nl,nl):r===.5?e($Se,USe):e(B7(r),B7(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Eh(t)}function dE(){var e=uE(d_());return e.copy=function(){return wy(e,dE()).exponent(e.exponent())},Yc.apply(e,arguments),e}function zSe(){return dE.apply(null,arguments).exponent(.5)}function I7(e){return Math.sign(e)*e*e}function WSe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function kH(){var e=aE(),t=[0,1],r=!1,n;function i(s){var o=WSe(e(s));return isNaN(o)?n:r?Math.round(o):o}return i.invert=function(s){return e.invert(I7(s))},i.domain=function(s){return arguments.length?(e.domain(s),i):e.domain()},i.range=function(s){return arguments.length?(e.range((t=Array.from(s,Cw)).map(I7)),i):t.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(r=!!s,i):r},i.clamp=function(s){return arguments.length?(e.clamp(s),i):e.clamp()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return kH(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Yc.apply(i,arguments),Eh(i)}function AH(){var e=[],t=[],r=[],n;function i(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=Gwe(e,o/l);return s}function s(o){return o==null||isNaN(o=+o)?n:t[by(r,o)]}return s.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(oh),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(n=o,s):n},s.quantiles=function(){return r.slice()},s.copy=function(){return AH().domain(e).range(t).unknown(n)},Yc.apply(s,arguments)}function NH(){var e=0,t=1,r=1,n=[.5],i=[0,1],s;function o(c){return c!=null&&c<=c?i[by(n,c,0,r)]:s}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(r=(i=Array.from(c)).length-1,l()):i.slice()},o.invertExtent=function(c){var u=i.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return n.slice()},o.copy=function(){return NH().domain([e,t]).range(i).unknown(s)},Yc.apply(Eh(o),arguments)}function CH(){var e=[.5],t=[0,1],r,n=1;function i(s){return s!=null&&s<=s?t[by(e,s,0,n)]:r}return i.domain=function(s){return arguments.length?(e=Array.from(s),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return CH().domain(e).range(t).unknown(r)},Yc.apply(i,arguments)}const Jj=new Date,Zj=new Date;function Fs(e,t,r,n){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),l=i.ceil(s);return s-o<l-s?o:l},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,l)=>{const c=[];if(s=i.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let u;do c.push(u=new Date(+s)),t(s,l),e(s);while(u<s&&s<o);return c},i.filter=s=>Fs(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!s(o););else for(;--l>=0;)for(;t(o,1),!s(o););}),r&&(i.count=(s,o)=>(Jj.setTime(+s),Zj.setTime(+o),e(Jj),e(Zj),Math.floor(r(Jj,Zj))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(n?o=>n(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const Pw=Fs(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Pw.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Fs(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Pw);Pw.range;const Rd=1e3,Ic=Rd*60,Fd=Ic*60,Jd=Fd*24,fE=Jd*7,D7=Jd*30,ek=Jd*365,Zh=Fs(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Rd)},(e,t)=>(t-e)/Rd,e=>e.getUTCSeconds());Zh.range;const hE=Fs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rd)},(e,t)=>{e.setTime(+e+t*Ic)},(e,t)=>(t-e)/Ic,e=>e.getMinutes());hE.range;const pE=Fs(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Ic)},(e,t)=>(t-e)/Ic,e=>e.getUTCMinutes());pE.range;const mE=Fs(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rd-e.getMinutes()*Ic)},(e,t)=>{e.setTime(+e+t*Fd)},(e,t)=>(t-e)/Fd,e=>e.getHours());mE.range;const gE=Fs(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Fd)},(e,t)=>(t-e)/Fd,e=>e.getUTCHours());gE.range;const Sy=Fs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ic)/Jd,e=>e.getDate()-1);Sy.range;const f_=Fs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Jd,e=>e.getUTCDate()-1);f_.range;const EH=Fs(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Jd,e=>Math.floor(e/Jd));EH.range;function ap(e){return Fs(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Ic)/fE)}const h_=ap(0),Ow=ap(1),qSe=ap(2),HSe=ap(3),Km=ap(4),VSe=ap(5),GSe=ap(6);h_.range;Ow.range;qSe.range;HSe.range;Km.range;VSe.range;GSe.range;function sp(e){return Fs(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/fE)}const p_=sp(0),Mw=sp(1),KSe=sp(2),YSe=sp(3),Ym=sp(4),XSe=sp(5),QSe=sp(6);p_.range;Mw.range;KSe.range;YSe.range;Ym.range;XSe.range;QSe.range;const xE=Fs(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());xE.range;const yE=Fs(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());yE.range;const Zd=Fs(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Zd.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fs(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Zd.range;const ef=Fs(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());ef.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Fs(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});ef.range;function TH(e,t,r,n,i,s){const o=[[Zh,1,Rd],[Zh,5,5*Rd],[Zh,15,15*Rd],[Zh,30,30*Rd],[s,1,Ic],[s,5,5*Ic],[s,15,15*Ic],[s,30,30*Ic],[i,1,Fd],[i,3,3*Fd],[i,6,6*Fd],[i,12,12*Fd],[n,1,Jd],[n,2,2*Jd],[r,1,fE],[t,1,D7],[t,3,3*D7],[e,1,ek]];function l(u,d,f){const p=d<u;p&&([u,d]=[d,u]);const h=f&&typeof f.range=="function"?f:c(u,d,f),m=h?h.range(u,+d+1):[];return p?m.reverse():m}function c(u,d,f){const p=Math.abs(d-u)/f,h=ZC(([,,y])=>y).right(o,p);if(h===o.length)return e.every($A(u/ek,d/ek,f));if(h===0)return Pw.every(Math.max($A(u,d,f),1));const[m,g]=o[p/o[h-1][2]<o[h][2]/p?h-1:h];return m.every(g)}return[l,c]}const[JSe,ZSe]=TH(ef,yE,p_,EH,gE,pE),[e_e,t_e]=TH(Zd,xE,h_,Sy,mE,hE);function tk(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function rk(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Zg(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function r_e(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,s=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=ex(i),d=tx(i),f=ex(s),p=tx(s),h=ex(o),m=tx(o),g=ex(l),y=tx(l),b=ex(c),v=tx(c),w={a:de,A:W,b:V,B:ae,c:null,d:H7,e:H7,f:k_e,g:R_e,G:B_e,H:S_e,I:__e,j:j_e,L:PH,m:A_e,M:N_e,p:ee,q:C,Q:K7,s:Y7,S:C_e,u:E_e,U:T_e,V:P_e,w:O_e,W:M_e,x:null,X:null,y:L_e,Y:F_e,Z:I_e,"%":G7},S={a:Y,A:q,b:O,B:X,c:null,d:V7,e:V7,f:z_e,g:J_e,G:e5e,H:D_e,I:$_e,j:U_e,L:MH,m:W_e,M:q_e,p:F,q:Q,Q:K7,s:Y7,S:H_e,u:V_e,U:G_e,V:K_e,w:Y_e,W:X_e,x:null,X:null,y:Q_e,Y:Z_e,Z:t5e,"%":G7},j={a:B,A:E,b:P,B:D,c:G,d:W7,e:W7,f:y_e,g:z7,G:U7,H:q7,I:q7,j:p_e,L:x_e,m:h_e,M:m_e,p:M,q:f_e,Q:v_e,s:w_e,S:g_e,u:o_e,U:l_e,V:c_e,w:s_e,W:u_e,x:H,X:oe,y:z7,Y:U7,Z:d_e,"%":b_e};w.x=k(r,w),w.X=k(n,w),w.c=k(t,w),S.x=k(r,S),S.X=k(n,S),S.c=k(t,S);function k(K,ne){return function(re){var T=[],I=-1,ie=0,U=K.length,Z,me,Pe;for(re instanceof Date||(re=new Date(+re));++I<U;)K.charCodeAt(I)===37&&(T.push(K.slice(ie,I)),(me=$7[Z=K.charAt(++I)])!=null?Z=K.charAt(++I):me=Z==="e"?" ":"0",(Pe=ne[Z])&&(Z=Pe(re,me)),T.push(Z),ie=I+1);return T.push(K.slice(ie,I)),T.join("")}}function A(K,ne){return function(re){var T=Zg(1900,void 0,1),I=R(T,K,re+="",0),ie,U;if(I!=re.length)return null;if("Q"in T)return new Date(T.Q);if("s"in T)return new Date(T.s*1e3+("L"in T?T.L:0));if(ne&&!("Z"in T)&&(T.Z=0),"p"in T&&(T.H=T.H%12+T.p*12),T.m===void 0&&(T.m="q"in T?T.q:0),"V"in T){if(T.V<1||T.V>53)return null;"w"in T||(T.w=1),"Z"in T?(ie=rk(Zg(T.y,0,1)),U=ie.getUTCDay(),ie=U>4||U===0?Mw.ceil(ie):Mw(ie),ie=f_.offset(ie,(T.V-1)*7),T.y=ie.getUTCFullYear(),T.m=ie.getUTCMonth(),T.d=ie.getUTCDate()+(T.w+6)%7):(ie=tk(Zg(T.y,0,1)),U=ie.getDay(),ie=U>4||U===0?Ow.ceil(ie):Ow(ie),ie=Sy.offset(ie,(T.V-1)*7),T.y=ie.getFullYear(),T.m=ie.getMonth(),T.d=ie.getDate()+(T.w+6)%7)}else("W"in T||"U"in T)&&("w"in T||(T.w="u"in T?T.u%7:"W"in T?1:0),U="Z"in T?rk(Zg(T.y,0,1)).getUTCDay():tk(Zg(T.y,0,1)).getDay(),T.m=0,T.d="W"in T?(T.w+6)%7+T.W*7-(U+5)%7:T.w+T.U*7-(U+6)%7);return"Z"in T?(T.H+=T.Z/100|0,T.M+=T.Z%100,rk(T)):tk(T)}}function R(K,ne,re,T){for(var I=0,ie=ne.length,U=re.length,Z,me;I<ie;){if(T>=U)return-1;if(Z=ne.charCodeAt(I++),Z===37){if(Z=ne.charAt(I++),me=j[Z in $7?ne.charAt(I++):Z],!me||(T=me(K,re,T))<0)return-1}else if(Z!=re.charCodeAt(T++))return-1}return T}function M(K,ne,re){var T=u.exec(ne.slice(re));return T?(K.p=d.get(T[0].toLowerCase()),re+T[0].length):-1}function B(K,ne,re){var T=h.exec(ne.slice(re));return T?(K.w=m.get(T[0].toLowerCase()),re+T[0].length):-1}function E(K,ne,re){var T=f.exec(ne.slice(re));return T?(K.w=p.get(T[0].toLowerCase()),re+T[0].length):-1}function P(K,ne,re){var T=b.exec(ne.slice(re));return T?(K.m=v.get(T[0].toLowerCase()),re+T[0].length):-1}function D(K,ne,re){var T=g.exec(ne.slice(re));return T?(K.m=y.get(T[0].toLowerCase()),re+T[0].length):-1}function G(K,ne,re){return R(K,t,ne,re)}function H(K,ne,re){return R(K,r,ne,re)}function oe(K,ne,re){return R(K,n,ne,re)}function de(K){return o[K.getDay()]}function W(K){return s[K.getDay()]}function V(K){return c[K.getMonth()]}function ae(K){return l[K.getMonth()]}function ee(K){return i[+(K.getHours()>=12)]}function C(K){return 1+~~(K.getMonth()/3)}function Y(K){return o[K.getUTCDay()]}function q(K){return s[K.getUTCDay()]}function O(K){return c[K.getUTCMonth()]}function X(K){return l[K.getUTCMonth()]}function F(K){return i[+(K.getUTCHours()>=12)]}function Q(K){return 1+~~(K.getUTCMonth()/3)}return{format:function(K){var ne=k(K+="",w);return ne.toString=function(){return K},ne},parse:function(K){var ne=A(K+="",!1);return ne.toString=function(){return K},ne},utcFormat:function(K){var ne=k(K+="",S);return ne.toString=function(){return K},ne},utcParse:function(K){var ne=A(K+="",!0);return ne.toString=function(){return K},ne}}}var $7={"-":"",_:" ",0:"0"},Js=/^\s*\d+/,n_e=/^%/,i_e=/[\\^$*+?|[\]().{}]/g;function Pi(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",s=i.length;return n+(s<r?new Array(r-s+1).join(t)+i:i)}function a_e(e){return e.replace(i_e,"\\$&")}function ex(e){return new RegExp("^(?:"+e.map(a_e).join("|")+")","i")}function tx(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function s_e(e,t,r){var n=Js.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function o_e(e,t,r){var n=Js.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function l_e(e,t,r){var n=Js.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function c_e(e,t,r){var n=Js.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function u_e(e,t,r){var n=Js.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function U7(e,t,r){var n=Js.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function z7(e,t,r){var n=Js.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function d_e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function f_e(e,t,r){var n=Js.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function h_e(e,t,r){var n=Js.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function W7(e,t,r){var n=Js.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function p_e(e,t,r){var n=Js.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function q7(e,t,r){var n=Js.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function m_e(e,t,r){var n=Js.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function g_e(e,t,r){var n=Js.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function x_e(e,t,r){var n=Js.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function y_e(e,t,r){var n=Js.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function b_e(e,t,r){var n=n_e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function v_e(e,t,r){var n=Js.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function w_e(e,t,r){var n=Js.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function H7(e,t){return Pi(e.getDate(),t,2)}function S_e(e,t){return Pi(e.getHours(),t,2)}function __e(e,t){return Pi(e.getHours()%12||12,t,2)}function j_e(e,t){return Pi(1+Sy.count(Zd(e),e),t,3)}function PH(e,t){return Pi(e.getMilliseconds(),t,3)}function k_e(e,t){return PH(e,t)+"000"}function A_e(e,t){return Pi(e.getMonth()+1,t,2)}function N_e(e,t){return Pi(e.getMinutes(),t,2)}function C_e(e,t){return Pi(e.getSeconds(),t,2)}function E_e(e){var t=e.getDay();return t===0?7:t}function T_e(e,t){return Pi(h_.count(Zd(e)-1,e),t,2)}function OH(e){var t=e.getDay();return t>=4||t===0?Km(e):Km.ceil(e)}function P_e(e,t){return e=OH(e),Pi(Km.count(Zd(e),e)+(Zd(e).getDay()===4),t,2)}function O_e(e){return e.getDay()}function M_e(e,t){return Pi(Ow.count(Zd(e)-1,e),t,2)}function L_e(e,t){return Pi(e.getFullYear()%100,t,2)}function R_e(e,t){return e=OH(e),Pi(e.getFullYear()%100,t,2)}function F_e(e,t){return Pi(e.getFullYear()%1e4,t,4)}function B_e(e,t){var r=e.getDay();return e=r>=4||r===0?Km(e):Km.ceil(e),Pi(e.getFullYear()%1e4,t,4)}function I_e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Pi(t/60|0,"0",2)+Pi(t%60,"0",2)}function V7(e,t){return Pi(e.getUTCDate(),t,2)}function D_e(e,t){return Pi(e.getUTCHours(),t,2)}function $_e(e,t){return Pi(e.getUTCHours()%12||12,t,2)}function U_e(e,t){return Pi(1+f_.count(ef(e),e),t,3)}function MH(e,t){return Pi(e.getUTCMilliseconds(),t,3)}function z_e(e,t){return MH(e,t)+"000"}function W_e(e,t){return Pi(e.getUTCMonth()+1,t,2)}function q_e(e,t){return Pi(e.getUTCMinutes(),t,2)}function H_e(e,t){return Pi(e.getUTCSeconds(),t,2)}function V_e(e){var t=e.getUTCDay();return t===0?7:t}function G_e(e,t){return Pi(p_.count(ef(e)-1,e),t,2)}function LH(e){var t=e.getUTCDay();return t>=4||t===0?Ym(e):Ym.ceil(e)}function K_e(e,t){return e=LH(e),Pi(Ym.count(ef(e),e)+(ef(e).getUTCDay()===4),t,2)}function Y_e(e){return e.getUTCDay()}function X_e(e,t){return Pi(Mw.count(ef(e)-1,e),t,2)}function Q_e(e,t){return Pi(e.getUTCFullYear()%100,t,2)}function J_e(e,t){return e=LH(e),Pi(e.getUTCFullYear()%100,t,2)}function Z_e(e,t){return Pi(e.getUTCFullYear()%1e4,t,4)}function e5e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Ym(e):Ym.ceil(e),Pi(e.getUTCFullYear()%1e4,t,4)}function t5e(){return"+0000"}function G7(){return"%"}function K7(e){return+e}function Y7(e){return Math.floor(+e/1e3)}var Np,RH,FH;r5e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function r5e(e){return Np=r_e(e),RH=Np.format,Np.parse,FH=Np.utcFormat,Np.utcParse,Np}function n5e(e){return new Date(e)}function i5e(e){return e instanceof Date?+e:+new Date(+e)}function bE(e,t,r,n,i,s,o,l,c,u){var d=aE(),f=d.invert,p=d.domain,h=u(".%L"),m=u(":%S"),g=u("%I:%M"),y=u("%I %p"),b=u("%a %d"),v=u("%b %d"),w=u("%B"),S=u("%Y");function j(k){return(c(k)<k?h:l(k)<k?m:o(k)<k?g:s(k)<k?y:n(k)<k?i(k)<k?b:v:r(k)<k?w:S)(k)}return d.invert=function(k){return new Date(f(k))},d.domain=function(k){return arguments.length?p(Array.from(k,i5e)):p().map(n5e)},d.ticks=function(k){var A=p();return e(A[0],A[A.length-1],k??10)},d.tickFormat=function(k,A){return A==null?j:u(A)},d.nice=function(k){var A=p();return(!k||typeof k.range!="function")&&(k=t(A[0],A[A.length-1],k??10)),k?p(SH(A,k)):d},d.copy=function(){return wy(d,bE(e,t,r,n,i,s,o,l,c,u))},d}function a5e(){return Yc.apply(bE(e_e,t_e,Zd,xE,h_,Sy,mE,hE,Zh,RH).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function s5e(){return Yc.apply(bE(JSe,ZSe,ef,yE,p_,f_,gE,pE,Zh,FH).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function m_(){var e=0,t=1,r,n,i,s,o=nl,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:o(i===0?.5:(f=(s(f)-r)*i,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),n=s(t=+t),i=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(o=f,u):o};function d(f){return function(p){var h,m;return arguments.length?([h,m]=p,o=f(h,m),u):[o(0),o(1)]}}return u.range=d(xg),u.rangeRound=d(iE),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return s=f,r=f(e),n=f(t),i=r===n?0:1/(n-r),u}}function Th(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function BH(){var e=Eh(m_()(nl));return e.copy=function(){return Th(e,BH())},gf.apply(e,arguments)}function IH(){var e=lE(m_()).domain([1,10]);return e.copy=function(){return Th(e,IH()).base(e.base())},gf.apply(e,arguments)}function DH(){var e=cE(m_());return e.copy=function(){return Th(e,DH()).constant(e.constant())},gf.apply(e,arguments)}function vE(){var e=uE(m_());return e.copy=function(){return Th(e,vE()).exponent(e.exponent())},gf.apply(e,arguments)}function o5e(){return vE.apply(null,arguments).exponent(.5)}function $H(){var e=[],t=nl;function r(n){if(n!=null&&!isNaN(n=+n))return t((by(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(oh),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,s)=>Vwe(e,s/n))},r.copy=function(){return $H(t).domain(e)},gf.apply(r,arguments)}function g_(){var e=0,t=.5,r=1,n=1,i,s,o,l,c,u=nl,d,f=!1,p;function h(g){return isNaN(g=+g)?p:(g=.5+((g=+d(g))-s)*(n*g<n*s?l:c),u(f?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,r]=g,i=d(e=+e),s=d(t=+t),o=d(r=+r),l=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),n=s<i?-1:1,h):[e,t,r]},h.clamp=function(g){return arguments.length?(f=!!g,h):f},h.interpolator=function(g){return arguments.length?(u=g,h):u};function m(g){return function(y){var b,v,w;return arguments.length?([b,v,w]=y,u=bSe(g,[b,v,w]),h):[u(0),u(.5),u(1)]}}return h.range=m(xg),h.rangeRound=m(iE),h.unknown=function(g){return arguments.length?(p=g,h):p},function(g){return d=g,i=g(e),s=g(t),o=g(r),l=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),n=s<i?-1:1,h}}function UH(){var e=Eh(g_()(nl));return e.copy=function(){return Th(e,UH())},gf.apply(e,arguments)}function zH(){var e=lE(g_()).domain([.1,1,10]);return e.copy=function(){return Th(e,zH()).base(e.base())},gf.apply(e,arguments)}function WH(){var e=cE(g_());return e.copy=function(){return Th(e,WH()).constant(e.constant())},gf.apply(e,arguments)}function wE(){var e=uE(g_());return e.copy=function(){return Th(e,wE()).exponent(e.exponent())},gf.apply(e,arguments)}function l5e(){return wE.apply(null,arguments).exponent(.5)}const xx=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:tE,scaleDiverging:UH,scaleDivergingLog:zH,scaleDivergingPow:wE,scaleDivergingSqrt:l5e,scaleDivergingSymlog:WH,scaleIdentity:wH,scaleImplicit:UA,scaleLinear:vH,scaleLog:_H,scaleOrdinal:eE,scalePoint:Ywe,scalePow:dE,scaleQuantile:AH,scaleQuantize:NH,scaleRadial:kH,scaleSequential:BH,scaleSequentialLog:IH,scaleSequentialPow:vE,scaleSequentialQuantile:$H,scaleSequentialSqrt:o5e,scaleSequentialSymlog:DH,scaleSqrt:zSe,scaleSymlog:jH,scaleThreshold:CH,scaleTime:a5e,scaleUtc:s5e,tickFormat:bH},Symbol.toStringTag,{value:"Module"}));var xf=e=>e.chartData,x_=Jt([xf],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),y_=(e,t,r,n)=>n?x_(e):xf(e),c5e=(e,t,r)=>r?x_(e):xf(e);function tf(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(fi(t)&&fi(r))return!0}return!1}function X7(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function qH(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,i,s;if(fi(r))i=r;else if(typeof r=="function")return;if(fi(n))s=n;else if(typeof n=="function")return;var o=[i,s];if(tf(o))return o}}function u5e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(tf(n))return X7(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[i,s]=e,o,l;if(i==="auto")t!=null&&(o=Math.min(...t));else if(An(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[0]))}catch{}else if(typeof i=="string"&&pL.test(i)){var c=pL.exec(i);if(c==null||c[1]==null||t==null)o=void 0;else{var u=+c[1];o=t[0]-u}}else o=t==null?void 0:t[0];if(s==="auto")t!=null&&(l=Math.max(...t));else if(An(s))l=s;else if(typeof s=="function")try{t!=null&&(l=s(t==null?void 0:t[1]))}catch{}else if(typeof s=="string"&&mL.test(s)){var d=mL.exec(s);if(d==null||d[1]==null||t==null)l=void 0;else{var f=+d[1];l=t[1]+f}}else l=t==null?void 0:t[1];var p=[o,l];if(tf(p))return t==null?p:X7(p,t,r)}}}var yg=1e9,d5e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},_E,_a=!0,Gc="[DecimalError] ",h0=Gc+"Invalid argument: ",SE=Gc+"Exponent out of range: ",bg=Math.floor,Wh=Math.pow,f5e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Zl,qs=1e7,ha=7,HH=9007199254740991,Lw=bg(HH/ha),Nn={};Nn.absoluteValue=Nn.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Nn.comparedTo=Nn.cmp=function(e){var t,r,n,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(n=s.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return n===i?0:n>i^s.s<0?1:-1};Nn.decimalPlaces=Nn.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*ha;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Nn.dividedBy=Nn.div=function(e){return Wd(this,new this.constructor(e))};Nn.dividedToIntegerBy=Nn.idiv=function(e){var t=this,r=t.constructor;return ia(Wd(t,new r(e),0,1),r.precision)};Nn.equals=Nn.eq=function(e){return!this.cmp(e)};Nn.exponent=function(){return vs(this)};Nn.greaterThan=Nn.gt=function(e){return this.cmp(e)>0};Nn.greaterThanOrEqualTo=Nn.gte=function(e){return this.cmp(e)>=0};Nn.isInteger=Nn.isint=function(){return this.e>this.d.length-2};Nn.isNegative=Nn.isneg=function(){return this.s<0};Nn.isPositive=Nn.ispos=function(){return this.s>0};Nn.isZero=function(){return this.s===0};Nn.lessThan=Nn.lt=function(e){return this.cmp(e)<0};Nn.lessThanOrEqualTo=Nn.lte=function(e){return this.cmp(e)<1};Nn.logarithm=Nn.log=function(e){var t,r=this,n=r.constructor,i=n.precision,s=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Zl))throw Error(Gc+"NaN");if(r.s<1)throw Error(Gc+(r.s?"NaN":"-Infinity"));return r.eq(Zl)?new n(0):(_a=!1,t=Wd(B1(r,s),B1(e,s),s),_a=!0,ia(t,i))};Nn.minus=Nn.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?KH(t,e):VH(t,(e.s=-e.s,e))};Nn.modulo=Nn.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(Gc+"NaN");return r.s?(_a=!1,t=Wd(r,e,0,1).times(e),_a=!0,r.minus(t)):ia(new n(r),i)};Nn.naturalExponential=Nn.exp=function(){return GH(this)};Nn.naturalLogarithm=Nn.ln=function(){return B1(this)};Nn.negated=Nn.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Nn.plus=Nn.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?VH(t,e):KH(t,(e.s=-e.s,e))};Nn.precision=Nn.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(h0+e);if(t=vs(i)+1,n=i.d.length-1,r=n*ha+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};Nn.squareRoot=Nn.sqrt=function(){var e,t,r,n,i,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Gc+"NaN")}for(e=vs(l),_a=!1,i=Math.sqrt(+l),i==0||i==1/0?(t=Qu(l.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=bg((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(i.toString()),r=c.precision,i=o=r+3;;)if(s=n,n=s.plus(Wd(l,s,o+2)).times(.5),Qu(s.d).slice(0,o)===(t=Qu(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(ia(s,r+1,0),s.times(s).eq(l)){n=s;break}}else if(t!="9999")break;o+=4}return _a=!0,ia(n,r)};Nn.times=Nn.mul=function(e){var t,r,n,i,s,o,l,c,u,d=this,f=d.constructor,p=d.d,h=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=p.length,u=h.length,c<u&&(s=p,p=h,h=s,o=c,c=u,u=o),s=[],o=c+u,n=o;n--;)s.push(0);for(n=u;--n>=0;){for(t=0,i=c+n;i>n;)l=s[i]+h[n]*p[i-n-1]+t,s[i--]=l%qs|0,t=l/qs|0;s[i]=(s[i]+t)%qs|0}for(;!s[--o];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,_a?ia(e,f.precision):e};Nn.toDecimalPlaces=Nn.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ad(e,0,yg),t===void 0?t=n.rounding:ad(t,0,8),ia(r,e+vs(r)+1,t))};Nn.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=F0(n,!0):(ad(e,0,yg),t===void 0?t=i.rounding:ad(t,0,8),n=ia(new i(n),e+1,t),r=F0(n,!0,e+1)),r};Nn.toFixed=function(e,t){var r,n,i=this,s=i.constructor;return e===void 0?F0(i):(ad(e,0,yg),t===void 0?t=s.rounding:ad(t,0,8),n=ia(new s(i),e+vs(i)+1,t),r=F0(n.abs(),!1,e+vs(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Nn.toInteger=Nn.toint=function(){var e=this,t=e.constructor;return ia(new t(e),vs(e)+1,t.rounding)};Nn.toNumber=function(){return+this};Nn.toPower=Nn.pow=function(e){var t,r,n,i,s,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Zl);if(l=new c(l),!l.s){if(e.s<1)throw Error(Gc+"Infinity");return l}if(l.eq(Zl))return l;if(n=c.precision,e.eq(Zl))return ia(l,n);if(t=e.e,r=e.d.length-1,o=t>=r,s=l.s,o){if((r=d<0?-d:d)<=HH){for(i=new c(Zl),t=Math.ceil(n/ha+4),_a=!1;r%2&&(i=i.times(l),J7(i.d,t)),r=bg(r/2),r!==0;)l=l.times(l),J7(l.d,t);return _a=!0,e.s<0?new c(Zl).div(i):ia(i,n)}}else if(s<0)throw Error(Gc+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,_a=!1,i=e.times(B1(l,n+u)),_a=!0,i=GH(i),i.s=s,i};Nn.toPrecision=function(e,t){var r,n,i=this,s=i.constructor;return e===void 0?(r=vs(i),n=F0(i,r<=s.toExpNeg||r>=s.toExpPos)):(ad(e,1,yg),t===void 0?t=s.rounding:ad(t,0,8),i=ia(new s(i),e,t),r=vs(i),n=F0(i,e<=r||r<=s.toExpNeg,e)),n};Nn.toSignificantDigits=Nn.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ad(e,1,yg),t===void 0?t=n.rounding:ad(t,0,8)),ia(new n(r),e,t)};Nn.toString=Nn.valueOf=Nn.val=Nn.toJSON=Nn[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=vs(e),r=e.constructor;return F0(e,t<=r.toExpNeg||t>=r.toExpPos)};function VH(e,t){var r,n,i,s,o,l,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),_a?ia(t,f):t;if(c=e.d,u=t.d,o=e.e,i=t.e,c=c.slice(),s=o-i,s){for(s<0?(n=c,s=-s,l=u.length):(n=u,i=o,l=c.length),o=Math.ceil(f/ha),l=o>l?o+1:l+1,s>l&&(s=l,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for(l=c.length,s=u.length,l-s<0&&(s=l,n=u,u=c,c=n),r=0;s;)r=(c[--s]=c[s]+u[s]+r)/qs|0,c[s]%=qs;for(r&&(c.unshift(r),++i),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=i,_a?ia(t,f):t}function ad(e,t,r){if(e!==~~e||e<t||e>r)throw Error(h0+e)}function Qu(e){var t,r,n,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)n=e[t]+"",r=ha-n.length,r&&(s+=Bf(r)),s+=n;o=e[t],n=o+"",r=ha-n.length,r&&(s+=Bf(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Wd=function(){function e(n,i){var s,o=0,l=n.length;for(n=n.slice();l--;)s=n[l]*i+o,n[l]=s%qs|0,o=s/qs|0;return o&&n.unshift(o),n}function t(n,i,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(n[l]!=i[l]){c=n[l]>i[l]?1:-1;break}return c}function r(n,i,s){for(var o=0;s--;)n[s]-=o,o=n[s]<i[s]?1:0,n[s]=o*qs+n[s]-i[s];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,s,o){var l,c,u,d,f,p,h,m,g,y,b,v,w,S,j,k,A,R,M=n.constructor,B=n.s==i.s?1:-1,E=n.d,P=i.d;if(!n.s)return new M(n);if(!i.s)throw Error(Gc+"Division by zero");for(c=n.e-i.e,A=P.length,j=E.length,h=new M(B),m=h.d=[],u=0;P[u]==(E[u]||0);)++u;if(P[u]>(E[u]||0)&&--c,s==null?v=s=M.precision:o?v=s+(vs(n)-vs(i))+1:v=s,v<0)return new M(0);if(v=v/ha+2|0,u=0,A==1)for(d=0,P=P[0],v++;(u<j||d)&&v--;u++)w=d*qs+(E[u]||0),m[u]=w/P|0,d=w%P|0;else{for(d=qs/(P[0]+1)|0,d>1&&(P=e(P,d),E=e(E,d),A=P.length,j=E.length),S=A,g=E.slice(0,A),y=g.length;y<A;)g[y++]=0;R=P.slice(),R.unshift(0),k=P[0],P[1]>=qs/2&&++k;do d=0,l=t(P,g,A,y),l<0?(b=g[0],A!=y&&(b=b*qs+(g[1]||0)),d=b/k|0,d>1?(d>=qs&&(d=qs-1),f=e(P,d),p=f.length,y=g.length,l=t(f,g,p,y),l==1&&(d--,r(f,A<p?R:P,p))):(d==0&&(l=d=1),f=P.slice()),p=f.length,p<y&&f.unshift(0),r(g,f,y),l==-1&&(y=g.length,l=t(P,g,A,y),l<1&&(d++,r(g,A<y?R:P,y))),y=g.length):l===0&&(d++,g=[0]),m[u++]=d,l&&g[0]?g[y++]=E[S]||0:(g=[E[S]],y=1);while((S++<j||g[0]!==void 0)&&v--)}return m[0]||m.shift(),h.e=c,ia(h,o?s+vs(h)+1:s)}}();function GH(e,t){var r,n,i,s,o,l,c=0,u=0,d=e.constructor,f=d.precision;if(vs(e)>16)throw Error(SE+vs(e));if(!e.s)return new d(Zl);for(_a=!1,l=f,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(n=Math.log(Wh(2,u))/Math.LN10*2+5|0,l+=n,r=i=s=new d(Zl),d.precision=l;;){if(i=ia(i.times(e),l),r=r.times(++c),o=s.plus(Wd(i,r,l)),Qu(o.d).slice(0,l)===Qu(s.d).slice(0,l)){for(;u--;)s=ia(s.times(s),l);return d.precision=f,t==null?(_a=!0,ia(s,f)):s}s=o}}function vs(e){for(var t=e.e*ha,r=e.d[0];r>=10;r/=10)t++;return t}function nk(e,t,r){if(t>e.LN10.sd())throw _a=!0,r&&(e.precision=r),Error(Gc+"LN10 precision limit exceeded");return ia(new e(e.LN10),t)}function Bf(e){for(var t="";e--;)t+="0";return t}function B1(e,t){var r,n,i,s,o,l,c,u,d,f=1,p=10,h=e,m=h.d,g=h.constructor,y=g.precision;if(h.s<1)throw Error(Gc+(h.s?"NaN":"-Infinity"));if(h.eq(Zl))return new g(0);if(t==null?(_a=!1,u=y):u=t,h.eq(10))return t==null&&(_a=!0),nk(g,u);if(u+=p,g.precision=u,r=Qu(m),n=r.charAt(0),s=vs(h),Math.abs(s)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(e),r=Qu(h.d),n=r.charAt(0),f++;s=vs(h),n>1?(h=new g("0."+r),s++):h=new g(n+"."+r.slice(1))}else return c=nk(g,u+2,y).times(s+""),h=B1(new g(n+"."+r.slice(1)),u-p).plus(c),g.precision=y,t==null?(_a=!0,ia(h,y)):h;for(l=o=h=Wd(h.minus(Zl),h.plus(Zl),u),d=ia(h.times(h),u),i=3;;){if(o=ia(o.times(d),u),c=l.plus(Wd(o,new g(i),u)),Qu(c.d).slice(0,u)===Qu(l.d).slice(0,u))return l=l.times(2),s!==0&&(l=l.plus(nk(g,u+2,y).times(s+""))),l=Wd(l,new g(f),u),g.precision=y,t==null?(_a=!0,ia(l,y)):l;l=c,i+=2}}function Q7(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=bg(r/ha),e.d=[],n=(r+1)%ha,r<0&&(n+=ha),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=ha;n<i;)e.d.push(+t.slice(n,n+=ha));t=t.slice(n),n=ha-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),_a&&(e.e>Lw||e.e<-Lw))throw Error(SE+r)}else e.s=0,e.e=0,e.d=[0];return e}function ia(e,t,r){var n,i,s,o,l,c,u,d,f=e.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(n=t-o,n<0)n+=ha,i=t,u=f[d=0];else{if(d=Math.ceil((n+1)/ha),s=f.length,d>=s)return e;for(u=s=f[d],o=1;s>=10;s/=10)o++;n%=ha,i=n-ha+o}if(r!==void 0&&(s=Wh(10,o-i-1),l=u/s%10|0,c=t<0||f[d+1]!==void 0||u%s,c=r<4?(l||c)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||c||r==6&&(n>0?i>0?u/Wh(10,o-i):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(s=vs(e),f.length=1,t=t-s-1,f[0]=Wh(10,(ha-t%ha)%ha),e.e=bg(-t/ha)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,s=1,d--):(f.length=d+1,s=Wh(10,ha-n),f[d]=i>0?(u/Wh(10,o-i)%Wh(10,i)|0)*s:0),c)for(;;)if(d==0){(f[0]+=s)==qs&&(f[0]=1,++e.e);break}else{if(f[d]+=s,f[d]!=qs)break;f[d--]=0,s=1}for(n=f.length;f[--n]===0;)f.pop();if(_a&&(e.e>Lw||e.e<-Lw))throw Error(SE+vs(e));return e}function KH(e,t){var r,n,i,s,o,l,c,u,d,f,p=e.constructor,h=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),_a?ia(t,h):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),o=u-n,o){for(d=o<0,d?(r=c,o=-o,l=f.length):(r=f,n=u,l=c.length),i=Math.max(Math.ceil(h/ha),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=c.length,l=f.length,d=i<l,d&&(l=i),i=0;i<l;i++)if(c[i]!=f[i]){d=c[i]<f[i];break}o=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),l=c.length,i=f.length-l;i>0;--i)c[l++]=0;for(i=f.length;i>o;){if(c[--i]<f[i]){for(s=i;s&&c[--s]===0;)c[s]=qs-1;--c[s],c[i]+=qs}c[i]-=f[i]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,_a?ia(t,h):t):new p(0)}function F0(e,t,r){var n,i=vs(e),s=Qu(e.d),o=s.length;return t?(r&&(n=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+Bf(n):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Bf(-i-1)+s,r&&(n=r-o)>0&&(s+=Bf(n))):i>=o?(s+=Bf(i+1-o),r&&(n=r-i-1)>0&&(s=s+"."+Bf(n))):((n=i+1)<o&&(s=s.slice(0,n)+"."+s.slice(n)),r&&(n=r-o)>0&&(i+1===o&&(s+="."),s+=Bf(n))),e.s<0?"-"+s:s}function J7(e,t){if(e.length>t)return e.length=t,!0}function YH(e){var t,r,n;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(h0+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Q7(o,s.toString())}else if(typeof s!="string")throw Error(h0+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,f5e.test(s))Q7(o,s);else throw Error(h0+s)}if(i.prototype=Nn,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=YH,i.config=i.set=h5e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function h5e(e){if(!e||typeof e!="object")throw Error(Gc+"Object expected");var t,r,n,i=["precision",1,yg,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(bg(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(h0+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(h0+r+": "+n);return this}var _E=YH(d5e);Zl=new _E(1);const qi=_E;function XH(e){var t;return e===0?t=1:t=Math.floor(new qi(e).abs().log(10).toNumber())+1,t}function QH(e,t,r){for(var n=new qi(e),i=0,s=[];n.lt(t)&&i<1e5;)s.push(n.toNumber()),n=n.add(r),i++;return s}var JH=e=>{var[t,r]=e,[n,i]=[t,r];return t>r&&([n,i]=[r,t]),[n,i]},ZH=(e,t,r)=>{if(e.lte(0))return new qi(0);var n=XH(e.toNumber()),i=new qi(10).pow(n),s=e.div(i),o=n!==1?.05:.1,l=new qi(Math.ceil(s.div(o).toNumber())).add(r).mul(o),c=l.mul(i);return t?new qi(c.toNumber()):new qi(Math.ceil(c.toNumber()))},p5e=(e,t,r)=>{var n=new qi(1),i=new qi(e);if(!i.isint()&&r){var s=Math.abs(e);s<1?(n=new qi(10).pow(XH(e)-1),i=new qi(Math.floor(i.div(n).toNumber())).mul(n)):s>1&&(i=new qi(Math.floor(e)))}else e===0?i=new qi(Math.floor((t-1)/2)):r||(i=new qi(Math.floor(e)));for(var o=Math.floor((t-1)/2),l=[],c=0;c<t;c++)l.push(i.add(new qi(c-o).mul(n)).toNumber());return l},eV=function(t,r,n,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new qi(0),tickMin:new qi(0),tickMax:new qi(0)};var o=ZH(new qi(r).sub(t).div(n-1),i,s),l;t<=0&&r>=0?l=new qi(0):(l=new qi(t).add(r).div(2),l=l.sub(new qi(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),u=Math.ceil(new qi(r).sub(l).div(o).toNumber()),d=c+u+1;return d>n?eV(t,r,n,i,s+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:o,tickMin:l.sub(new qi(c).mul(o)),tickMax:l.add(new qi(u).mul(o))})},m5e=function(t){var[r,n]=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(i,2),[l,c]=JH([r,n]);if(l===-1/0||c===1/0){var u=c===1/0?[l,...Array(i-1).fill(1/0)]:[...Array(i-1).fill(-1/0),c];return r>n?u.reverse():u}if(l===c)return p5e(l,i,s);var{step:d,tickMin:f,tickMax:p}=eV(l,c,o,s,0),h=QH(f,p.add(new qi(.1).mul(d)),d);return r>n?h.reverse():h},g5e=function(t,r){var[n,i]=t,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=JH([n,i]);if(o===-1/0||l===1/0)return[n,i];if(o===l)return[o];var c=Math.max(r,2),u=ZH(new qi(l).sub(o).div(c-1),s,0),d=[...QH(new qi(o),new qi(l),u),l];return s===!1&&(d=d.map(f=>Math.round(f))),n>i?d.reverse():d},tV=e=>e.rootProps.maxBarSize,x5e=e=>e.rootProps.barGap,rV=e=>e.rootProps.barCategoryGap,y5e=e=>e.rootProps.barSize,_y=e=>e.rootProps.stackOffset,nV=e=>e.rootProps.reverseStackOrder,jE=e=>e.options.chartName,kE=e=>e.rootProps.syncId,iV=e=>e.rootProps.syncMethod,AE=e=>e.options.eventEmitter,Oa={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Fh={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},Fu={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},b_=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function v_(e,t,r){if(r!=="auto")return r;if(e!=null)return hf(e,t)?"category":"number"}function Z7(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Rw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Z7(Object(r),!0).forEach(function(n){b5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z7(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b5e(e,t,r){return(t=v5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v5e(e){var t=w5e(e,"string");return typeof t=="symbol"?t:t+""}function w5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eR={allowDataOverflow:Fh.allowDataOverflow,allowDecimals:Fh.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Fh.angleAxisId,includeHidden:!1,name:void 0,reversed:Fh.reversed,scale:Fh.scale,tick:Fh.tick,tickCount:void 0,ticks:void 0,type:Fh.type,unit:void 0},tR={allowDataOverflow:Fu.allowDataOverflow,allowDecimals:Fu.allowDecimals,allowDuplicatedCategory:Fu.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Fu.radiusAxisId,includeHidden:Fu.includeHidden,name:void 0,reversed:Fu.reversed,scale:Fu.scale,tick:Fu.tick,tickCount:Fu.tickCount,ticks:void 0,type:Fu.type,unit:void 0},S5e=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},NE=Jt([S5e,$q],(e,t)=>{var r;if(e!=null)return e;var n=(r=v_(t,"angleAxis",eR.type))!==null&&r!==void 0?r:"category";return Rw(Rw({},eR),{},{type:n})}),_5e=(e,t)=>e.polarAxis.radiusAxis[t],CE=Jt([_5e,$q],(e,t)=>{var r;if(e!=null)return e;var n=(r=v_(t,"radiusAxis",tR.type))!==null&&r!==void 0?r:"category";return Rw(Rw({},tR),{},{type:n})}),w_=e=>e.polarOptions,EE=Jt([pf,mf,Ls],nH),aV=Jt([w_,EE],(e,t)=>{if(e!=null)return Wo(e.innerRadius,t,0)}),sV=Jt([w_,EE],(e,t)=>{if(e!=null)return Wo(e.outerRadius,t,t*.8)}),j5e=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},oV=Jt([w_],j5e);Jt([NE,oV],b_);var lV=Jt([EE,aV,sV],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Jt([CE,lV],b_);var cV=Jt([Oi,w_,aV,sV,pf,mf],(e,t,r,n,i,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:o,cy:l,startAngle:c,endAngle:u}=t;return{cx:Wo(o,i,i/2),cy:Wo(l,s,s/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Fa=(e,t)=>t,jy=(e,t,r)=>r;function TE(e){return e==null?void 0:e.id}function uV(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:i,dataKey:s}=r,o=new Map;return e.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=TE(l);u.forEach((f,p)=>{var h=s==null||i?p:String(Ti(f,s,null)),m=Ti(f,l.dataKey,0),g;o.has(h)?g=o.get(h):g={},Object.assign(g,{[d]:m}),o.set(h,g)})}}),Array.from(o.values())}function S_(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var __=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function j_(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function k5e(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var Zs=e=>{var t=Oi(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},vg=e=>e.tooltip.settings.axisId;function A5e(e){if(e in xx)return xx[e]();var t="scale".concat(fy(e));if(t in xx)return xx[t]()}function rR(e){var t=e.ticks,r=e.bandwidth,n=e.range(),i=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:function(s){function o(){return s.apply(this,arguments)}return o.toString=function(){return s.toString()},o}(()=>i),rangeMin:()=>i[0],rangeMax:()=>i[1],isInRange(s){var o=i[0],l=i[1];return o<=l?s>=o&&s<=l:s>=l&&s<=o},bandwidth:r?()=>r.call(e):void 0,ticks:t?s=>t.call(e,s):void 0,map:(s,o)=>{var l=e(s);if(l!=null){if(e.bandwidth&&o!==null&&o!==void 0&&o.position){var c=e.bandwidth();switch(o.position){case"middle":l+=c/2;break;case"end":l+=c;break}}return l}}}}function nR(e,t,r){if(typeof e=="function")return rR(e.copy().domain(t).range(r));if(e!=null){var n=A5e(e);if(n!=null)return n.domain(t).range(r),rR(n)}}var dV=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!tf(t)){for(var r,n,i=0;i<t.length;i++){var s=t[i];fi(s)&&((r===void 0||s<r)&&(r=s),(n===void 0||s>n)&&(n=s))}return r!==void 0&&n!==void 0?[r,n]:void 0}return t}default:return t}};function iR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Fw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iR(Object(r),!0).forEach(function(n){N5e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function N5e(e,t,r){return(t=C5e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C5e(e){var t=E5e(e,"string");return typeof t=="symbol"?t:t+""}function E5e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HA=[0,"auto"],Ds={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},fV=(e,t)=>e.cartesianAxis.xAxis[t],dd=(e,t)=>{var r=fV(e,t);return r??Ds},$s={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:HA,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:my},hV=(e,t)=>e.cartesianAxis.yAxis[t],fd=(e,t)=>{var r=hV(e,t);return r??$s},Bd={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},PE=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??Bd},Ya=(e,t,r)=>{switch(t){case"xAxis":return dd(e,r);case"yAxis":return fd(e,r);case"zAxis":return PE(e,r);case"angleAxis":return NE(e,r);case"radiusAxis":return CE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},T5e=(e,t,r)=>{switch(t){case"xAxis":return dd(e,r);case"yAxis":return fd(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},wg=(e,t,r)=>{switch(t){case"xAxis":return dd(e,r);case"yAxis":return fd(e,r);case"angleAxis":return NE(e,r);case"radiusAxis":return CE(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},pV=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function OE(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var ky=e=>e.graphicalItems.cartesianItems,P5e=Jt([Fa,jy],OE),ME=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),Ay=Jt([ky,Ya,P5e],ME,{memoizeOptions:{resultEqualityCheck:j_}}),mV=Jt([Ay],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(S_)),gV=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),O5e=Jt([Ay],gV),LE=e=>e.map(t=>t.data).filter(Boolean).flat(1),M5e=Jt([Ay],LE,{memoizeOptions:{resultEqualityCheck:j_}}),RE=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=t;return e.length>0?e:r.slice(n,i+1)},FE=Jt([M5e,y_],RE),BE=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Ti(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(i=>({value:Ti(i,n)}))):e.map(n=>({value:n})),k_=Jt([FE,Ya,Ay],BE);function xV(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Qv(e){if(Hc(e)||e instanceof Date){var t=Number(e);if(fi(t))return t}}function aR(e){if(Array.isArray(e)){var t=[Qv(e[0]),Qv(e[1])];return tf(t)?t:void 0}var r=Qv(e);if(r!=null)return[r,r]}function rf(e){return e.map(Qv).filter(_l)}function L5e(e,t,r){return!r||typeof t!="number"||nd(t)?[]:r.length?rf(r.flatMap(n=>{var i=Ti(e,n.dataKey),s,o;if(Array.isArray(i)?[s,o]=i:s=o=i,!(!fi(s)||!fi(o)))return[t-s,t+o]})):[]}var Bs=e=>{var t=Zs(e),r=vg(e);return wg(e,t,r)},Ny=Jt([Bs],e=>e==null?void 0:e.dataKey),R5e=Jt([mV,y_,Bs],uV),yV=(e,t,r,n)=>{var i={},s=t.reduce((o,l)=>{if(l.stackId==null)return o;var c=o[l.stackId];return c==null&&(c=[]),c.push(l),o[l.stackId]=c,o},i);return Object.fromEntries(Object.entries(s).map(o=>{var[l,c]=o,u=n?[...c].reverse():c,d=u.map(TE);return[l,{stackedData:uve(e,d,r),graphicalItems:u}]}))},VA=Jt([R5e,mV,_y,nV],yV),bV=(e,t,r,n)=>{var{dataStartIndex:i,dataEndIndex:s}=t;if(n==null&&r!=="zAxis"){var o=mve(e,i,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},F5e=Jt([Ya],e=>e.allowDataOverflow),IE=e=>{var t;if(e==null||!("domain"in e))return HA;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=rf(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:HA},DE=Jt([Ya],IE),$E=Jt([DE,F5e],qH),B5e=Jt([VA,xf,Fa,$E],bV,{memoizeOptions:{resultEqualityCheck:__}}),A_=e=>e.errorBars,I5e=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>xV(r,n)),Bw=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var s=i.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},UE=(e,t,r,n,i)=>{var s,o;if(r.length>0&&e.forEach(l=>{r.forEach(c=>{var u,d,f=(u=n[c.id])===null||u===void 0?void 0:u.filter(b=>xV(i,b)),p=Ti(l,(d=t.dataKey)!==null&&d!==void 0?d:c.dataKey),h=L5e(l,p,f);if(h.length>=2){var m=Math.min(...h),g=Math.max(...h);(s==null||m<s)&&(s=m),(o==null||g>o)&&(o=g)}var y=aR(p);y!=null&&(s=s==null?y[0]:Math.min(s,y[0]),o=o==null?y[1]:Math.max(o,y[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(l=>{var c=aR(Ti(l,t.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),fi(s)&&fi(o))return[s,o]},D5e=Jt([FE,Ya,O5e,A_,Fa],UE,{memoizeOptions:{resultEqualityCheck:__}});function $5e(e){var{value:t}=e;if(Hc(t)||t instanceof Date)return t}var U5e=(e,t,r)=>{var n=e.map($5e).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&xW(n))?uH(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},vV=e=>e.referenceElements.dots,Sg=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),z5e=Jt([vV,Fa,jy],Sg),wV=e=>e.referenceElements.areas,W5e=Jt([wV,Fa,jy],Sg),SV=e=>e.referenceElements.lines,q5e=Jt([SV,Fa,jy],Sg),_V=(e,t)=>{if(e!=null){var r=rf(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},H5e=Jt(z5e,Fa,_V),jV=(e,t)=>{if(e!=null){var r=rf(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},V5e=Jt([W5e,Fa],jV);function G5e(e){var t;if(e.x!=null)return rf([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:rf(r)}function K5e(e){var t;if(e.y!=null)return rf([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:rf(r)}var kV=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?G5e(n):K5e(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},Y5e=Jt([q5e,Fa],kV),X5e=Jt(H5e,Y5e,V5e,(e,t,r)=>Bw(e,r,t)),zE=(e,t,r,n,i,s,o,l)=>{if(r!=null)return r;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",u=c?Bw(n,s,i):Bw(s,i);return u5e(t,u,e.allowDataOverflow)},Q5e=Jt([Ya,DE,$E,B5e,D5e,X5e,Oi,Fa],zE,{memoizeOptions:{resultEqualityCheck:__}}),J5e=[0,1],WE=(e,t,r,n,i,s,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,u=hf(t,s);if(u&&l==null){var d;return uH(0,(d=r==null?void 0:r.length)!==null&&d!==void 0?d:0)}return c==="category"?U5e(n,e,u):i==="expand"?J5e:o}},qE=Jt([Ya,Oi,FE,k_,_y,Fa,Q5e],WE);function Z5e(e){return e in xx}var AV=(e,t,r)=>{if(e!=null){var{scale:n,type:i}=e;if(n==="auto")return i==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!t)?"point":i==="category"?"band":"linear";if(typeof n=="string"){var s="scale".concat(fy(n));return Z5e(s)?s:"point"}}},Ph=Jt([Ya,pV,jE],AV);function HE(e,t,r,n){if(!(r==null||n==null))return typeof e.scale=="function"?nR(e.scale,r,n):nR(t,r,n)}var VE=(e,t,r)=>{var n=IE(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&tf(e))return m5e(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&tf(e))return g5e(e,t.tickCount,t.allowDecimals)}},GE=Jt([qE,wg,Ph],VE),KE=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&tf(t)&&Array.isArray(r)&&r.length>0){var i,s,o=t[0],l=(i=r[0])!==null&&i!==void 0?i:0,c=t[1],u=(s=r[r.length-1])!==null&&s!==void 0?s:0;return[Math.min(o,l),Math.max(c,u)]}return t},eje=Jt([Ya,qE,GE,Fa],KE),tje=Jt(k_,Ya,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(rf(e.map(f=>f.value))).sort((f,p)=>f-p),i=n[0],s=n[n.length-1];if(i==null||s==null)return 1/0;var o=s-i;if(o===0)return 1/0;for(var l=0;l<n.length-1;l++){var c=n[l],u=n[l+1];if(!(c==null||u==null)){var d=u-c;r=Math.min(r,d)}}return r/o}}),NV=Jt(tje,Oi,rV,Ls,(e,t,r,n,i)=>i,(e,t,r,n,i)=>{if(!fi(e))return 0;var s=t==="vertical"?n.height:n.width;if(i==="gap")return e*s/2;if(i==="no-gap"){var o=Wo(r,e*s),l=e*s/2;return l-o-(l-o)/s*o}return 0}),rje=(e,t,r)=>{var n=dd(e,t);return n==null||typeof n.padding!="string"?0:NV(e,"xAxis",t,r,n.padding)},nje=(e,t,r)=>{var n=fd(e,t);return n==null||typeof n.padding!="string"?0:NV(e,"yAxis",t,r,n.padding)},ije=Jt(dd,rje,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((n=i.right)!==null&&n!==void 0?n:0)+t}}),aje=Jt(fd,nje,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+t}}),sje=Jt([Ls,ije,a_,i_,(e,t,r)=>r],(e,t,r,n,i)=>{var{padding:s}=n;return i?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),oje=Jt([Ls,Oi,aje,a_,i_,(e,t,r)=>r],(e,t,r,n,i,s)=>{var{padding:o}=i;return s?[n.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),Cy=(e,t,r,n)=>{var i;switch(t){case"xAxis":return sje(e,r,n);case"yAxis":return oje(e,r,n);case"zAxis":return(i=PE(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return oV(e);case"radiusAxis":return lV(e,r);default:return}},CV=Jt([Ya,Cy],b_),lje=Jt([Ph,eje],dV),Xm=Jt([Ya,Ph,lje,CV],HE);Jt([Ay,A_,Fa],I5e);function EV(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var N_=(e,t)=>t,C_=(e,t,r)=>r,cje=Jt(r_,N_,C_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(EV)),uje=Jt(n_,N_,C_,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(EV)),TV=(e,t)=>({width:e.width,height:t.height}),dje=(e,t)=>{var r=typeof t.width=="number"?t.width:my;return{width:r,height:e.height}},PV=Jt(Ls,dd,TV),fje=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},hje=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},pje=Jt(mf,Ls,cje,N_,C_,(e,t,r,n,i)=>{var s={},o;return r.forEach(l=>{var c=TV(t,l);o==null&&(o=fje(t,n,e));var u=n==="top"&&!i||n==="bottom"&&i;s[l.id]=o-Number(u)*c.height,o+=(u?-1:1)*c.height}),s}),mje=Jt(pf,Ls,uje,N_,C_,(e,t,r,n,i)=>{var s={},o;return r.forEach(l=>{var c=dje(t,l);o==null&&(o=hje(t,n,e));var u=n==="left"&&!i||n==="right"&&i;s[l.id]=o-Number(u)*c.width,o+=(u?-1:1)*c.width}),s}),gje=(e,t)=>{var r=dd(e,t);if(r!=null)return pje(e,r.orientation,r.mirror)},xje=Jt([Ls,dd,gje,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),yje=(e,t)=>{var r=fd(e,t);if(r!=null)return mje(e,r.orientation,r.mirror)},bje=Jt([Ls,fd,yje,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var i=r==null?void 0:r[n];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),OV=Jt(Ls,fd,(e,t)=>{var r=typeof t.width=="number"?t.width:my;return{width:r,height:e.height}}),sR=(e,t,r)=>{switch(t){case"xAxis":return PV(e,r).width;case"yAxis":return OV(e,r).height;default:return}},MV=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:s,dataKey:o}=r,l=hf(e,n),c=t.map(u=>u.value);if(o&&l&&s==="category"&&i&&xW(c))return c}},YE=Jt([Oi,k_,Ya,Fa],MV),LV=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:s}=r,o=hf(e,n);if(o&&(i==="number"||s!=="auto"))return t.map(l=>l.value)}},XE=Jt([Oi,k_,wg,Fa],LV),oR=Jt([Oi,T5e,Ph,Xm,YE,XE,Cy,GE,Fa],(e,t,r,n,i,s,o,l,c)=>{if(t!=null){var u=hf(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:s,duplicateDomain:i,isCategorical:u,niceTicks:l,range:o,realScaleType:r,scale:n}}}),vje=(e,t,r,n,i,s,o,l,c)=>{if(!(t==null||n==null)){var u=hf(e,c),{type:d,ticks:f,tickCount:p}=t,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,m=d==="category"&&n.bandwidth?n.bandwidth()/h:0;m=c==="angleAxis"&&s!=null&&s.length>=2?Xs(s[0]-s[1])*2*m:m;var g=f||i;return g?g.map((y,b)=>{var v=o?o.indexOf(y):y,w=n.map(v);return fi(w)?{index:b,coordinate:w+m,value:y,offset:m}:null}).filter(_l):u&&l?l.map((y,b)=>{var v=n.map(y);return fi(v)?{coordinate:v+m,value:y,index:b,offset:m}:null}).filter(_l):n.ticks?n.ticks(p).map((y,b)=>{var v=n.map(y);return fi(v)?{coordinate:v+m,value:y,index:b,offset:m}:null}).filter(_l):n.domain().map((y,b)=>{var v=n.map(y);return fi(v)?{coordinate:v+m,value:o?o[y]:y,index:b,offset:m}:null}).filter(_l)}},RV=Jt([Oi,wg,Ph,Xm,GE,Cy,YE,XE,Fa],vje),wje=(e,t,r,n,i,s,o)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var l=hf(e,o),{tickCount:c}=t,u=0;return u=o==="angleAxis"&&(n==null?void 0:n.length)>=2?Xs(n[0]-n[1])*2*u:u,l&&s?s.map((d,f)=>{var p=r.map(d);return fi(p)?{coordinate:p+u,value:d,index:f,offset:u}:null}).filter(_l):r.ticks?r.ticks(c).map((d,f)=>{var p=r.map(d);return fi(p)?{coordinate:p+u,value:d,index:f,offset:u}:null}).filter(_l):r.domain().map((d,f)=>{var p=r.map(d);return fi(p)?{coordinate:p+u,value:i?i[d]:d,index:f,offset:u}:null}).filter(_l)}},sd=Jt([Oi,wg,Xm,Cy,YE,XE,Fa],wje),od=Jt(Ya,Xm,(e,t)=>{if(!(e==null||t==null))return Fw(Fw({},e),{},{scale:t})}),Sje=Jt([Ya,Ph,qE,CV],HE),_je=Jt((e,t,r)=>PE(e,r),Sje,(e,t)=>{if(!(e==null||t==null))return Fw(Fw({},e),{},{scale:t})}),jje=Jt([Oi,r_,n_],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),FV=e=>e.options.defaultTooltipEventType,BV=e=>e.options.validateTooltipEventTypes;function IV(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function QE(e,t){var r=FV(e),n=BV(e);return IV(t,r,n)}function kje(e){return Sn(t=>QE(t,e))}var DV=(e,t)=>{var r,n=Number(t);if(!(nd(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},Aje=e=>e.tooltip.settings,zf={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},Nje={itemInteraction:{click:zf,hover:zf},axisInteraction:{click:zf,hover:zf},keyboardInteraction:zf,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},$V=Ll({name:"tooltip",initialState:Nje,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:wa()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,i=xu(e).tooltipItemPayloads.indexOf(r);i>-1&&(e.tooltipItemPayloads[i]=n)},prepare:wa()},removeTooltipEntrySettings:{reducer(e,t){var r=xu(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:wa()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:Cje,replaceTooltipEntrySettings:Eje,removeTooltipEntrySettings:Tje,setTooltipSettingsState:Pje,setActiveMouseOverItemIndex:UV,mouseLeaveItem:Oje,mouseLeaveChart:zV,setActiveClickItemIndex:Mje,setMouseOverAxisIndex:WV,setMouseClickAxisIndex:Lje,setSyncInteraction:GA,setKeyboardInteraction:KA}=$V.actions,Rje=$V.reducer;function lR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lR(Object(r),!0).forEach(function(n){Fje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Fje(e,t,r){return(t=Bje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bje(e){var t=Ije(e,"string");return typeof t=="symbol"?t:t+""}function Ije(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dje(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function $je(e){return e.index!=null}var qV=(e,t,r,n)=>{if(t==null)return zf;var i=Dje(e,t,r);if(i==null)return zf;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if($je(i)){if(s)return uv(uv({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return uv(uv({},zf),{},{coordinate:i.coordinate})};function Uje(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function zje(e,t){var r=Uje(e),n=t[0],i=t[1];if(r===void 0)return!1;var s=Math.min(n,i),o=Math.max(n,i);return r>=s&&r<=o}function Wje(e,t,r){if(r==null||t==null)return!0;var n=Ti(e,t);return n==null||!tf(r)?!0:zje(n,r)}var JE=(e,t,r,n)=>{var i=e==null?void 0:e.index;if(i==null)return null;var s=Number(i);if(!fi(s))return i;var o=0,l=1/0;t.length>0&&(l=t.length-1);var c=Math.max(o,Math.min(s,l)),u=t[c];return u==null||Wje(u,r,n)?String(c):null},HV=(e,t,r,n,i,s,o)=>{if(s!=null){var l=o[0],c=l==null?void 0:l.getPosition(s);if(c!=null)return c;var u=i==null?void 0:i[Number(s)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:u.coordinate}}}},VV=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;if(r==="hover"?i=e.itemInteraction.hover.graphicalItemId:i=e.itemInteraction.click.graphicalItemId,i==null&&n!=null){var s=e.tooltipItemPayloads[0];return s!=null?[s]:[]}return e.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.graphicalItemId)===i})},GV=e=>e.options.tooltipPayloadSearcher,_g=e=>e.tooltip;function cR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function uR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cR(Object(r),!0).forEach(function(n){qje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qje(e,t,r){return(t=Hje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Hje(e){var t=Vje(e,"string");return typeof t=="symbol"?t:t+""}function Vje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gje(e,t){return e??t}var KV=(e,t,r,n,i,s,o)=>{if(!(t==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((p,h)=>{var m,{dataDefinedOnItem:g,settings:y}=h,b=Gje(g,l),v=Array.isArray(b)?Nq(b,u,d):b,w=(m=y==null?void 0:y.dataKey)!==null&&m!==void 0?m:n,S=y==null?void 0:y.nameKey,j;if(n&&Array.isArray(v)&&!Array.isArray(v[0])&&o==="axis"?j=yW(v,n,i):j=s(v,t,c,S),Array.isArray(j))j.forEach(A=>{var R=uR(uR({},y),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});p.push(gL({tooltipEntrySettings:R,dataKey:A.dataKey,payload:A.payload,value:Ti(A.payload,A.dataKey),name:A.name}))});else{var k;p.push(gL({tooltipEntrySettings:y,dataKey:w,payload:j,value:Ti(j,w),name:(k=Ti(j,S))!==null&&k!==void 0?k:y==null?void 0:y.name}))}return p},f)}},ZE=Jt([Bs,pV,jE],AV),Kje=Jt([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),Yje=Jt([Zs,vg],OE),jg=Jt([Kje,Bs,Yje],ME,{memoizeOptions:{resultEqualityCheck:j_}}),Xje=Jt([jg],e=>e.filter(S_)),Qje=Jt([jg],LE,{memoizeOptions:{resultEqualityCheck:j_}}),kg=Jt([Qje,xf],RE),Jje=Jt([Xje,xf,Bs],uV),e6=Jt([kg,Bs,jg],BE),YV=Jt([Bs],IE),Zje=Jt([Bs],e=>e.allowDataOverflow),XV=Jt([YV,Zje],qH),eke=Jt([jg],e=>e.filter(S_)),tke=Jt([Jje,eke,_y,nV],yV),rke=Jt([tke,xf,Zs,XV],bV),nke=Jt([jg],gV),ike=Jt([kg,Bs,nke,A_,Zs],UE,{memoizeOptions:{resultEqualityCheck:__}}),ake=Jt([vV,Zs,vg],Sg),ske=Jt([ake,Zs],_V),oke=Jt([wV,Zs,vg],Sg),lke=Jt([oke,Zs],jV),cke=Jt([SV,Zs,vg],Sg),uke=Jt([cke,Zs],kV),dke=Jt([ske,uke,lke],Bw),fke=Jt([Bs,YV,XV,rke,ike,dke,Oi,Zs],zE),Ey=Jt([Bs,Oi,kg,e6,_y,Zs,fke],WE),hke=Jt([Ey,Bs,ZE],VE),pke=Jt([Bs,Ey,hke,Zs],KE),QV=e=>{var t=Zs(e),r=vg(e),n=!1;return Cy(e,t,r,n)},JV=Jt([Bs,QV],b_),ZV=Jt([Bs,ZE,pke,JV],HE),mke=Jt([Oi,e6,Bs,Zs],MV),gke=Jt([Oi,e6,Bs,Zs],LV),xke=(e,t,r,n,i,s,o,l)=>{if(t){var{type:c}=t,u=hf(e,l);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=l==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Xs(i[0]-i[1])*2*f:f,u&&o?o.map((p,h)=>{var m=n.map(p);return fi(m)?{coordinate:m+f,value:p,index:h,offset:f}:null}).filter(_l):n.domain().map((p,h)=>{var m=n.map(p);return fi(m)?{coordinate:m+f,value:s?s[p]:p,index:h,offset:f}:null}).filter(_l)}}},yf=Jt([Oi,Bs,ZE,ZV,QV,mke,gke,Zs],xke),t6=Jt([FV,BV,Aje],(e,t,r)=>IV(r.shared,e,t)),eG=e=>e.tooltip.settings.trigger,r6=e=>e.tooltip.settings.defaultIndex,Ty=Jt([_g,t6,eG,r6],qV),nf=Jt([Ty,kg,Ny,Ey],JE),tG=Jt([yf,nf],DV),n6=Jt([Ty],e=>{if(e)return e.dataKey}),yke=Jt([Ty],e=>{if(e)return e.graphicalItemId}),rG=Jt([_g,t6,eG,r6],VV),bke=Jt([pf,mf,Oi,Ls,yf,r6,rG],HV),vke=Jt([Ty,bke],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),wke=Jt([Ty],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),Ske=Jt([rG,nf,xf,Ny,tG,GV,t6],KV),_ke=Jt([Ske],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function dR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dR(Object(r),!0).forEach(function(n){jke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jke(e,t,r){return(t=kke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kke(e){var t=Ake(e,"string");return typeof t=="symbol"?t:t+""}function Ake(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Nke=()=>Sn(Bs),Cke=()=>{var e=Nke(),t=Sn(yf),r=Sn(ZV);return qm(!e||!r?void 0:fR(fR({},e),{},{scale:r}),t)};function hR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Cp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hR(Object(r),!0).forEach(function(n){Eke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Eke(e,t,r){return(t=Tke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Tke(e){var t=Pke(e,"string");return typeof t=="symbol"?t:t+""}function Pke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Oke=(e,t,r,n)=>{var i=t.find(s=>s&&s.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:i.coordinate}}return{x:0,y:0}},Mke=(e,t,r,n)=>{var i=t.find(u=>u&&u.index===r);if(i){if(e==="centric"){var s=i.coordinate,{radius:o}=n;return Cp(Cp(Cp({},n),bs(n.cx,n.cy,o,s)),{},{angle:s,radius:o})}var l=i.coordinate,{angle:c}=n;return Cp(Cp(Cp({},n),bs(n.cx,n.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function Lke(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var nG=(e,t,r,n,i)=>{var s,o=(s=t==null?void 0:t.length)!==null&&s!==void 0?s:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<o;l++){var c,u,d,f,p,h=l>0?(c=r[l-1])===null||c===void 0?void 0:c.coordinate:(u=r[o-1])===null||u===void 0?void 0:u.coordinate,m=(d=r[l])===null||d===void 0?void 0:d.coordinate,g=l>=o-1?(f=r[0])===null||f===void 0?void 0:f.coordinate:(p=r[l+1])===null||p===void 0?void 0:p.coordinate,y=void 0;if(!(h==null||m==null||g==null))if(Xs(m-h)!==Xs(g-m)){var b=[];if(Xs(g-m)===Xs(i[1]-i[0])){y=g;var v=m+i[1]-i[0];b[0]=Math.min(v,(v+h)/2),b[1]=Math.max(v,(v+h)/2)}else{y=h;var w=g+i[1]-i[0];b[0]=Math.min(m,(w+m)/2),b[1]=Math.max(m,(w+m)/2)}var S=[Math.min(m,(y+m)/2),Math.max(m,(y+m)/2)];if(e>S[0]&&e<=S[1]||e>=b[0]&&e<=b[1]){var j;return(j=r[l])===null||j===void 0?void 0:j.index}}else{var k=Math.min(h,g),A=Math.max(h,g);if(e>(k+m)/2&&e<=(A+m)/2){var R;return(R=r[l])===null||R===void 0?void 0:R.index}}}else if(t)for(var M=0;M<o;M++){var B=t[M];if(B!=null){var E=t[M+1],P=t[M-1];if(M===0&&E!=null&&e<=(B.coordinate+E.coordinate)/2||M===o-1&&P!=null&&e>(B.coordinate+P.coordinate)/2||M>0&&M<o-1&&P!=null&&E!=null&&e>(B.coordinate+P.coordinate)/2&&e<=(B.coordinate+E.coordinate)/2)return B.index}}return-1},Rke=()=>Sn(jE),i6=(e,t)=>t,iG=(e,t,r)=>r,a6=(e,t,r,n)=>n,Fke=Jt(yf,e=>VS(e,t=>t.coordinate)),s6=Jt([_g,i6,iG,a6],qV),o6=Jt([s6,kg,Ny,Ey],JE),Bke=(e,t,r)=>{if(t!=null){var n=_g(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},aG=Jt([_g,i6,iG,a6],VV),Iw=Jt([pf,mf,Oi,Ls,yf,a6,aG],HV),Ike=Jt([s6,Iw],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),sG=Jt([yf,o6],DV),Dke=Jt([aG,o6,xf,Ny,sG,GV,i6],KV),$ke=Jt([s6,o6],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),Uke=(e,t,r,n,i,s,o)=>{if(!(!e||!r||!n||!i)&&Lke(e,o)){var l=gve(e,t),c=nG(l,s,i,r,n),u=Oke(t,i,c,e);return{activeIndex:String(c),activeCoordinate:u}}},zke=(e,t,r,n,i,s,o)=>{if(!(!e||!n||!i||!s||!r)){var l=Ewe(e,r);if(l){var c=xve(l,t),u=nG(c,o,s,n,i),d=Mke(t,s,u,l);return{activeIndex:String(u),activeCoordinate:d}}}},Wke=(e,t,r,n,i,s,o,l)=>{if(!(!e||!t||!n||!i||!s))return t==="horizontal"||t==="vertical"?Uke(e,t,n,i,s,o,l):zke(e,t,r,n,i,s,o)},qke=Jt(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),Hke=Jt(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(Oa)),r=Array.from(new Set(t));return r.sort((n,i)=>n-i)},{memoizeOptions:{resultEqualityCheck:k5e}});function pR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function mR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pR(Object(r),!0).forEach(function(n){Vke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vke(e,t,r){return(t=Gke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gke(e){var t=Kke(e,"string");return typeof t=="symbol"?t:t+""}function Kke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yke={},Xke={zIndexMap:Object.values(Oa).reduce((e,t)=>mR(mR({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),Yke)},Qke=new Set(Object.values(Oa));function Jke(e){return Qke.has(e)}var oG=Ll({name:"zIndex",initialState:Xke,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:wa()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!Jke(r)&&delete e.zIndexMap[r])},prepare:wa()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:i}=t.payload;e.zIndexMap[r]?i?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:i?void 0:n,panoramaElement:i?n:void 0}},prepare:wa()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:wa()}}}),{registerZIndexPortal:Zke,unregisterZIndexPortal:e4e,registerZIndexPortalElement:t4e,unregisterZIndexPortalElement:r4e}=oG.actions,n4e=oG.reducer;function vo(e){var{zIndex:t,children:r}=e,n=qve(),i=n&&t!==void 0&&t!==0,s=Rs(),o=Zi();x.useLayoutEffect(()=>i?(o(Zke({zIndex:t})),()=>{o(e4e({zIndex:t}))}):np,[o,t,i]);var l=Sn(c=>qke(c,t,s));return i?l?Y1.createPortal(r,l):null:r}function YA(){return YA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},YA.apply(null,arguments)}function gR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function dv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gR(Object(r),!0).forEach(function(n){i4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i4e(e,t,r){return(t=a4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a4e(e){var t=s4e(e,"string");return typeof t=="symbol"?t:t+""}function s4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o4e(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return x.isValidElement(t)?x.cloneElement(t,n):x.createElement(r,n)}function l4e(e){var t,{coordinate:r,payload:n,index:i,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:u,chartName:d}=e,f=r,p=n,h=i;if(!c||!f||d!=="ScatterChart"&&u!=="axis")return null;var m,g,y;if(d==="ScatterChart")m=f,g=W2e,y=Oa.cursorLine;else if(d==="BarChart")m=q2e(l,f,s,o),g=rH,y=Oa.cursorRectangle;else if(l==="radial"&&vW(f)){var{cx:b,cy:v,radius:w,startAngle:S,endAngle:j}=iH(f);m={cx:b,cy:v,startAngle:S,endAngle:j,innerRadius:w,outerRadius:w},g=sH,y=Oa.cursorLine}else m={points:Mwe(l,f,s)},g=c_,y=Oa.cursorLine;var k=typeof c=="object"&&"className"in c?c.className:void 0,A=dv(dv(dv(dv({stroke:"#ccc",pointerEvents:"none"},s),m),yh(c)),{},{payload:p,payloadIndex:h,className:Si("recharts-tooltip-cursor",k)});return x.createElement(vo,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:y},x.createElement(o4e,{cursor:c,cursorComp:g,cursorProps:A}))}function c4e(e){var t=Cke(),r=Iq(),n=ip(),i=Rke();return t==null||r==null||n==null||i==null?null:x.createElement(l4e,YA({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:i}))}var lG=x.createContext(null),u4e=()=>x.useContext(lG),cG={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function s(c,u,d,f,p){if(typeof d!="function")throw new TypeError("The listener must be a function");var h=new i(d,f||c,p),m=r?r+u:u;return c._events[m]?c._events[m].fn?c._events[m]=[c._events[m],h]:c._events[m].push(h):(c._events[m]=h,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,h=f.length,m=new Array(h);p<h;p++)m[p]=f[p].fn;return m},l.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,d,f,p,h,m){var g=r?r+u:u;if(!this._events[g])return!1;var y=this._events[g],b=arguments.length,v,w;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,f),!0;case 4:return y.fn.call(y.context,d,f,p),!0;case 5:return y.fn.call(y.context,d,f,p,h),!0;case 6:return y.fn.call(y.context,d,f,p,h,m),!0}for(w=1,v=new Array(b-1);w<b;w++)v[w-1]=arguments[w];y.fn.apply(y.context,v)}else{var S=y.length,j;for(w=0;w<S;w++)switch(y[w].once&&this.removeListener(u,y[w].fn,void 0,!0),b){case 1:y[w].fn.call(y[w].context);break;case 2:y[w].fn.call(y[w].context,d);break;case 3:y[w].fn.call(y[w].context,d,f);break;case 4:y[w].fn.call(y[w].context,d,f,p);break;default:if(!v)for(j=1,v=new Array(b-1);j<b;j++)v[j-1]=arguments[j];y[w].fn.apply(y[w].context,v)}}return!0},l.prototype.on=function(u,d,f){return s(this,u,d,f,!1)},l.prototype.once=function(u,d,f){return s(this,u,d,f,!0)},l.prototype.removeListener=function(u,d,f,p){var h=r?r+u:u;if(!this._events[h])return this;if(!d)return o(this,h),this;var m=this._events[h];if(m.fn)m.fn===d&&(!p||m.once)&&(!f||m.context===f)&&o(this,h);else{for(var g=0,y=[],b=m.length;g<b;g++)(m[g].fn!==d||p&&!m[g].once||f&&m[g].context!==f)&&y.push(m[g]);y.length?this._events[h]=y.length===1?y[0]:y:o(this,h)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&o(this,d)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(cG);var d4e=cG.exports;const f4e=sf(d4e);var I1=new f4e,XA="recharts.syncEvent.tooltip",xR="recharts.syncEvent.brush",E_=(e,t)=>{if(t&&Array.isArray(e)){var r=Number.parseInt(t,10);if(!nd(r))return e[r]}},h4e={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},uG=Ll({name:"options",initialState:h4e,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),p4e=uG.reducer,{createEventEmitter:m4e}=uG.actions;function g4e(e){return e.tooltip.syncInteraction}var x4e={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},dG=Ll({name:"chartData",initialState:x4e,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:yR,setDataStartEndIndexes:y4e,setComputedData:jMe}=dG.actions,b4e=dG.reducer,v4e=["x","y"];function bR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ep(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bR(Object(r),!0).forEach(function(n){w4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function w4e(e,t,r){return(t=S4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S4e(e){var t=_4e(e,"string");return typeof t=="symbol"?t:t+""}function _4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j4e(e,t){if(e==null)return{};var r,n,i=k4e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function k4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function A4e(){var e=Sn(kE),t=Sn(AE),r=Zi(),n=Sn(iV),i=Sn(yf),s=ip(),o=pg(),l=Sn(c=>c.rootProps.className);x.useEffect(()=>{if(e==null)return np;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var p;if(o&&d!==null&&d!==void 0&&(p=d.payload)!==null&&p!==void 0&&p.coordinate&&d.payload.sourceViewBox){var h=d.payload.coordinate,{x:m,y:g}=h,y=j4e(h,v4e),{x:b,y:v,width:w,height:S}=d.payload.sourceViewBox,j=Ep(Ep({},y),{},{x:o.x+(w?(m-b)/w:0)*o.width,y:o.y+(S?(g-v)/S:0)*o.height});r(Ep(Ep({},d),{},{payload:Ep(Ep({},d.payload),{},{coordinate:j})}))}else r(d);return}if(i!=null){var k;if(typeof n=="function"){var A={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},R=n(i,A);k=i[R]}else n==="value"&&(k=i.find(oe=>String(oe.value)===d.payload.label));var{coordinate:M}=d.payload;if(k==null||d.payload.active===!1||M==null||o==null){r(GA({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:B,y:E}=M,P=Math.min(B,o.x+o.width),D=Math.min(E,o.y+o.height),G={x:s==="horizontal"?k.coordinate:P,y:s==="horizontal"?D:k.coordinate},H=GA({active:d.payload.active,coordinate:G,dataKey:d.payload.dataKey,index:String(k.index),label:d.payload.label,sourceViewBox:d.payload.sourceViewBox,graphicalItemId:d.payload.graphicalItemId});r(H)}}};return I1.on(XA,c),()=>{I1.off(XA,c)}},[l,r,t,e,n,i,s,o])}function N4e(){var e=Sn(kE),t=Sn(AE),r=Zi();x.useEffect(()=>{if(e==null)return np;var n=(i,s,o)=>{t!==o&&e===i&&r(y4e(s))};return I1.on(xR,n),()=>{I1.off(xR,n)}},[r,t,e])}function C4e(){var e=Zi();x.useEffect(()=>{e(m4e())},[e]),A4e(),N4e()}function E4e(e,t,r,n,i,s){var o=Sn(h=>Bke(h,e,t)),l=Sn(AE),c=Sn(kE),u=Sn(iV),d=Sn(g4e),f=d==null?void 0:d.active,p=pg();x.useEffect(()=>{if(!f&&c!=null&&l!=null){var h=GA({active:s,coordinate:r,dataKey:o,index:i,label:typeof n=="number"?String(n):n,sourceViewBox:p,graphicalItemId:void 0});I1.emit(XA,c,h,l)}},[f,r,o,i,n,l,c,u,s,p])}function vR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function wR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?vR(Object(r),!0).forEach(function(n){T4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):vR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T4e(e,t,r){return(t=P4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P4e(e){var t=O4e(e,"string");return typeof t=="symbol"?t:t+""}function O4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function M4e(e){return e.dataKey}function L4e(e,t){return x.isValidElement(e)?x.cloneElement(e,t):typeof e=="function"?x.createElement(e,t):x.createElement(S2e,t)}var SR=[],R4e={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Py(e){var t,r,n=ka(e,R4e),{active:i,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:u,isAnimationActive:d,offset:f,payloadUniqBy:p,position:h,reverseDirection:m,useTranslate3d:g,wrapperStyle:y,cursor:b,shared:v,trigger:w,defaultIndex:S,portal:j,axisId:k}=n,A=Zi(),R=typeof S=="number"?String(S):S;x.useEffect(()=>{A(Pje({shared:v,trigger:w,axisId:k,active:i,defaultIndex:R}))},[A,v,w,k,i,R]);var M=pg(),B=Qq(),E=kje(v),{activeIndex:P,isActive:D}=(t=Sn(F=>$ke(F,E,w,R)))!==null&&t!==void 0?t:{},G=Sn(F=>Dke(F,E,w,R)),H=Sn(F=>sG(F,E,w,R)),oe=Sn(F=>Ike(F,E,w,R)),de=G,W=u4e(),V=(r=i??D)!==null&&r!==void 0?r:!1,[ae,ee]=QW([de,V]),C=E==="axis"?H:void 0;E4e(E,w,oe,C,P,V);var Y=j??W;if(Y==null||M==null||E==null)return null;var q=de??SR;V||(q=SR),u&&q.length&&(q=DW(q.filter(F=>F.value!=null&&(F.hide!==!0||n.includeHidden)),p,M4e));var O=q.length>0,X=x.createElement(E2e,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:d,active:V,coordinate:oe,hasPayload:O,offset:f,position:h,reverseDirection:m,useTranslate3d:g,viewBox:M,wrapperStyle:y,lastBoundingBox:ae,innerRef:ee,hasPortalFromProps:!!j},L4e(c,wR(wR({},n),{},{payload:q,label:C,active:V,activeIndex:P,coordinate:oe,accessibilityLayer:B})));return x.createElement(x.Fragment,null,Y1.createPortal(X,Y),V&&x.createElement(c4e,{cursor:b,tooltipEventType:E,coordinate:oe,payload:q,index:P}))}var op=e=>null;op.displayName="Cell";function F4e(e,t,r){return(t=B4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B4e(e){var t=I4e(e,"string");return typeof t=="symbol"?t:t+""}function I4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class D4e{constructor(t){F4e(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function _R(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function $4e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_R(Object(r),!0).forEach(function(n){U4e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_R(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U4e(e,t,r){return(t=z4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z4e(e){var t=W4e(e,"string");return typeof t=="symbol"?t:t+""}function W4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var q4e={cacheSize:2e3,enableCache:!0},fG=$4e({},q4e),jR=new D4e(fG.cacheSize),H4e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},kR="recharts_measurement_span";function V4e(e,t){var r=t.fontSize||"",n=t.fontFamily||"",i=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(s,"|").concat(o,"|").concat(l)}var AR=(e,t)=>{try{var r=document.getElementById(kR);r||(r=document.createElement("span"),r.setAttribute("id",kR),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,H4e,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},$x=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||u_.isSsr)return{width:0,height:0};if(!fG.enableCache)return AR(t,r);var n=V4e(t,r),i=jR.get(n);if(i)return i;var s=AR(t,r);return jR.set(n,s),s},hG;function G4e(e,t,r){return(t=K4e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K4e(e){var t=Y4e(e,"string");return typeof t=="symbol"?t:t+""}function Y4e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,CR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,X4e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Q4e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,J4e={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Z4e=["cm","mm","pt","pc","in","Q","px"];function eAe(e){return Z4e.includes(e)}var rm="NaN";function tAe(e,t){return e*J4e[t]}class po{static parse(t){var r,[,n,i]=(r=Q4e.exec(t))!==null&&r!==void 0?r:[];return n==null?po.NaN:new po(parseFloat(n),i??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,nd(t)&&(this.unit=""),r!==""&&!X4e.test(r)&&(this.num=NaN,this.unit=""),eAe(r)&&(this.num=tAe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new po(NaN,""):new po(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new po(NaN,""):new po(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new po(NaN,""):new po(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new po(NaN,""):new po(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return nd(this.num)}}hG=po;G4e(po,"NaN",new hG(NaN,""));function pG(e){if(e==null||e.includes(rm))return rm;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,i,s]=(r=NR.exec(t))!==null&&r!==void 0?r:[],o=po.parse(n??""),l=po.parse(s??""),c=i==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return rm;t=t.replace(NR,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,p]=(u=CR.exec(t))!==null&&u!==void 0?u:[],h=po.parse(d??""),m=po.parse(p??""),g=f==="+"?h.add(m):h.subtract(m);if(g.isNaN())return rm;t=t.replace(CR,g.toString())}return t}var ER=/\(([^()]*)\)/;function rAe(e){for(var t=e,r;(r=ER.exec(t))!=null;){var[,n]=r;t=t.replace(ER,pG(n))}return t}function nAe(e){var t=e.replace(/\s+/g,"");return t=rAe(t),t=pG(t),t}function iAe(e){try{return nAe(e)}catch{return rm}}function ik(e){var t=iAe(e.slice(5,-1));return t===rm?"":t}var aAe=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],sAe=["dx","dy","angle","className","breakAll"];function QA(){return QA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},QA.apply(null,arguments)}function TR(e,t){if(e==null)return{};var r,n,i=oAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function oAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var mG=/[ \f\n\r\t\v\u2028\u2029]+/,gG=e=>{var{children:t,breakAll:r,style:n}=e;try{var i=[];Qi(t)||(r?i=t.toString().split(""):i=t.toString().split(mG));var s=i.map(l=>({word:l,width:$x(l,n).width})),o=r?0:$x("",n).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function lAe(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var xG=(e,t,r,n)=>e.reduce((i,s)=>{var{word:o,width:l}=s,c=i[i.length-1];if(c&&l!=null&&(t==null||n||c.width+l+r<Number(t)))c.words.push(o),c.width+=l+r;else{var u={words:[o],width:l};i.push(u)}return i},[]),yG=e=>e.reduce((t,r)=>t.width>r.width?t:r),cAe="",PR=(e,t,r,n,i,s,o,l)=>{var c=e.slice(0,t),u=gG({breakAll:r,style:n,children:c+cAe});if(!u)return[!1,[]];var d=xG(u.wordsWithComputedWidth,s,o,l),f=d.length>i||yG(d).width>Number(s);return[f,d]},uAe=(e,t,r,n,i)=>{var{maxLines:s,children:o,style:l,breakAll:c}=e,u=An(s),d=String(o),f=xG(t,n,r,i);if(!u||i)return f;var p=f.length>s||yG(f).width>Number(n);if(!p)return f;for(var h=0,m=d.length-1,g=0,y;h<=m&&g<=d.length-1;){var b=Math.floor((h+m)/2),v=b-1,[w,S]=PR(d,v,c,l,s,n,r,i),[j]=PR(d,b,c,l,s,n,r,i);if(!w&&!j&&(h=b+1),w&&j&&(m=b-1),!w&&j){y=S;break}g++}return y||f},OR=e=>{var t=Qi(e)?[]:e.toString().split(mG);return[{words:t,width:void 0}]},dAe=e=>{var{width:t,scaleToFit:r,children:n,style:i,breakAll:s,maxLines:o}=e;if((t||r)&&!u_.isSsr){var l,c,u=gG({breakAll:s,children:n,style:i});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;l=d,c=f}else return OR(n);return uAe({breakAll:s,children:n,maxLines:o,style:i},l,c,t,!!r)}return OR(n)},bG="#808080",fAe={angle:0,breakAll:!1,capHeight:"0.71em",fill:bG,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},T_=x.forwardRef((e,t)=>{var r=ka(e,fAe),{x:n,y:i,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:u,verticalAnchor:d}=r,f=TR(r,aAe),p=x.useMemo(()=>dAe({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:h,dy:m,angle:g,className:y,breakAll:b}=f,v=TR(f,sAe);if(!Hc(n)||!Hc(i)||p.length===0)return null;var w=Number(n)+(An(h)?h:0),S=Number(i)+(An(m)?m:0);if(!fi(w)||!fi(S))return null;var j;switch(d){case"start":j=ik("calc(".concat(o,")"));break;case"middle":j=ik("calc(".concat((p.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:j=ik("calc(".concat(p.length-1," * -").concat(s,")"));break}var k=[],A=p[0];if(c&&A!=null){var R=A.width,{width:M}=f;k.push("scale(".concat(An(M)&&An(R)?M/R:1,")"))}return g&&k.push("rotate(".concat(g,", ").concat(w,", ").concat(S,")")),k.length&&(v.transform=k.join(" ")),x.createElement("text",QA({},Vo(v),{ref:t,x:w,y:S,className:Si("recharts-text",y),textAnchor:u,fill:l.includes("url")?bG:l}),p.map((B,E)=>{var P=B.words.join(b?"":" ");return x.createElement("tspan",{x:w,dy:E===0?j:s,key:"".concat(P,"-").concat(E)},P)}))});T_.displayName="Text";function MR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MR(Object(r),!0).forEach(function(n){hAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hAe(e,t,r){return(t=pAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pAe(e){var t=mAe(e,"string");return typeof t=="symbol"?t:t+""}function mAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gAe=e=>{var{viewBox:t,position:r,offset:n=0,parentViewBox:i}=e,{x:s,y:o,height:l,upperWidth:c,lowerWidth:u}=GC(t),d=s,f=s+(c-u)/2,p=(d+f)/2,h=(c+u)/2,m=d+c/2,g=l>=0?1:-1,y=g*n,b=g>0?"end":"start",v=g>0?"start":"end",w=c>=0?1:-1,S=w*n,j=w>0?"end":"start",k=w>0?"start":"end",A=i;if(r==="top"){var R={x:d+c/2,y:o-y,horizontalAnchor:"middle",verticalAnchor:b};return A&&(R.height=Math.max(o-A.y,0),R.width=c),R}if(r==="bottom"){var M={x:f+u/2,y:o+l+y,horizontalAnchor:"middle",verticalAnchor:v};return A&&(M.height=Math.max(A.y+A.height-(o+l),0),M.width=u),M}if(r==="left"){var B={x:p-S,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"};return A&&(B.width=Math.max(B.x-A.x,0),B.height=l),B}if(r==="right"){var E={x:p+h+S,y:o+l/2,horizontalAnchor:k,verticalAnchor:"middle"};return A&&(E.width=Math.max(A.x+A.width-E.x,0),E.height=l),E}var P=A?{width:h,height:l}:{};return r==="insideLeft"?Bu({x:p+S,y:o+l/2,horizontalAnchor:k,verticalAnchor:"middle"},P):r==="insideRight"?Bu({x:p+h-S,y:o+l/2,horizontalAnchor:j,verticalAnchor:"middle"},P):r==="insideTop"?Bu({x:d+c/2,y:o+y,horizontalAnchor:"middle",verticalAnchor:v},P):r==="insideBottom"?Bu({x:f+u/2,y:o+l-y,horizontalAnchor:"middle",verticalAnchor:b},P):r==="insideTopLeft"?Bu({x:d+S,y:o+y,horizontalAnchor:k,verticalAnchor:v},P):r==="insideTopRight"?Bu({x:d+c-S,y:o+y,horizontalAnchor:j,verticalAnchor:v},P):r==="insideBottomLeft"?Bu({x:f+S,y:o+l-y,horizontalAnchor:k,verticalAnchor:b},P):r==="insideBottomRight"?Bu({x:f+u-S,y:o+l-y,horizontalAnchor:j,verticalAnchor:b},P):r&&typeof r=="object"&&(An(r.x)||O0(r.x))&&(An(r.y)||O0(r.y))?Bu({x:s+Wo(r.x,h),y:o+Wo(r.y,l),horizontalAnchor:"end",verticalAnchor:"end"},P):Bu({x:m,y:o+l/2,horizontalAnchor:"middle",verticalAnchor:"middle"},P)},xAe=["labelRef"],yAe=["content"];function LR(e,t){if(e==null)return{};var r,n,i=bAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function bAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function RR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function yx(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RR(Object(r),!0).forEach(function(n){vAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vAe(e,t,r){return(t=wAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wAe(e){var t=SAe(e,"string");return typeof t=="symbol"?t:t+""}function SAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Td(){return Td=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Td.apply(null,arguments)}var vG=x.createContext(null),wG=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:i,width:s,height:o,children:l}=e,c=x.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:i,width:s,height:o}),[t,r,n,i,s,o]);return x.createElement(vG.Provider,{value:c},l)},SG=()=>{var e=x.useContext(vG),t=pg();return e||(t?GC(t):void 0)},_Ae=x.createContext(null),jAe=()=>{var e=x.useContext(_Ae),t=Sn(cV);return e||t},kAe=e=>{var{value:t,formatter:r}=e,n=Qi(e.children)?t:e.children;return typeof r=="function"?r(n):n},l6=e=>e!=null&&typeof e=="function",AAe=(e,t)=>{var r=Xs(t-e),n=Math.min(Math.abs(t-e),360);return r*n},NAe=(e,t,r,n,i)=>{var{offset:s,className:o}=e,{cx:l,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:p,clockWise:h}=i,m=(u+d)/2,g=AAe(f,p),y=g>=0?1:-1,b,v;switch(t){case"insideStart":b=f+y*s,v=h;break;case"insideEnd":b=p-y*s,v=!h;break;case"end":b=p+y*s,v=h;break;default:throw new Error("Unsupported position ".concat(t))}v=g<=0?v:!v;var w=bs(l,c,m,b),S=bs(l,c,m,b+(v?1:-1)*359),j="M".concat(w.x,",").concat(w.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(v?0:1,`,
    `).concat(S.x,",").concat(S.y),k=Qi(e.id)?k1("recharts-radial-line-"):e.id;return x.createElement("text",Td({},n,{dominantBaseline:"central",className:Si("recharts-radial-bar-label",o)}),x.createElement("defs",null,x.createElement("path",{id:k,d:j})),x.createElement("textPath",{xlinkHref:"#".concat(k)},r))},CAe=(e,t,r)=>{var{cx:n,cy:i,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=e,u=(l+c)/2;if(r==="outside"){var{x:d,y:f}=bs(n,i,o+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:i,textAnchor:"middle",verticalAnchor:"end"};var p=(s+o)/2,{x:h,y:m}=bs(n,i,p,u);return{x:h,y:m,textAnchor:"middle",verticalAnchor:"middle"}},Jv=e=>e!=null&&"cx"in e&&An(e.cx),EAe={angle:0,offset:5,zIndex:Oa.label,position:"middle",textBreakAll:!1};function TAe(e){if(!Jv(e))return e;var{cx:t,cy:r,outerRadius:n}=e,i=n*2;return{x:t-n,y:r-n,width:i,upperWidth:i,lowerWidth:i,height:i}}function If(e){var t=ka(e,EAe),{viewBox:r,parentViewBox:n,position:i,value:s,children:o,content:l,className:c="",textBreakAll:u,labelRef:d}=t,f=jAe(),p=SG(),h=i==="center"?p:f??p,m,g,y;r==null?m=h:Jv(r)?m=r:m=GC(r);var b=TAe(m);if(!m||Qi(s)&&Qi(o)&&!x.isValidElement(l)&&typeof l!="function")return null;var v=yx(yx({},t),{},{viewBox:m});if(x.isValidElement(l)){var{labelRef:w}=v,S=LR(v,xAe);return x.cloneElement(l,S)}if(typeof l=="function"){var{content:j}=v,k=LR(v,yAe);if(g=x.createElement(l,k),x.isValidElement(g))return g}else g=kAe(t);var A=Vo(t);if(Jv(m)){if(i==="insideStart"||i==="insideEnd"||i==="end")return NAe(t,i,g,A,m);y=CAe(m,t.offset,t.position)}else{if(!b)return null;var R=gAe({viewBox:b,position:i,offset:t.offset,parentViewBox:Jv(n)?void 0:n});y=yx(yx({x:R.x,y:R.y,textAnchor:R.horizontalAnchor,verticalAnchor:R.verticalAnchor},R.width!==void 0?{width:R.width}:{}),R.height!==void 0?{height:R.height}:{})}return x.createElement(vo,{zIndex:t.zIndex},x.createElement(T_,Td({ref:d,className:Si("recharts-label",c)},A,y,{textAnchor:lAe(A.textAnchor)?A.textAnchor:y.textAnchor,breakAll:u}),g))}If.displayName="Label";var PAe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?x.createElement(If,Td({key:"label-implicit"},n)):Hc(e)?x.createElement(If,Td({key:"label-implicit",value:e},n)):x.isValidElement(e)?e.type===If?x.cloneElement(e,yx({key:"label-implicit"},n)):x.createElement(If,Td({key:"label-implicit",content:e},n)):l6(e)?x.createElement(If,Td({key:"label-implicit",content:e},n)):e&&typeof e=="object"?x.createElement(If,Td({},e,{key:"label-implicit"},n)):null};function _G(e){var{label:t,labelRef:r}=e,n=SG();return PAe(t,n,r)||null}var jG={},kG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(kG);var AG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(AG);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kG,r=AG,n=WS;function i(s){if(n.isArrayLike(s))return t.last(r.toArray(s))}e.last=i})(jG);var OAe=jG.last;const MAe=sf(OAe);var LAe=["valueAccessor"],RAe=["dataKey","clockWise","id","textBreakAll","zIndex"];function Dw(){return Dw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dw.apply(null,arguments)}function FR(e,t){if(e==null)return{};var r,n,i=FAe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function FAe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var BAe=e=>Array.isArray(e.value)?MAe(e.value):e.value,NG=x.createContext(void 0),c6=NG.Provider,CG=x.createContext(void 0),IAe=CG.Provider;function DAe(){return x.useContext(NG)}function $Ae(){return x.useContext(CG)}function Zv(e){var{valueAccessor:t=BAe}=e,r=FR(e,LAe),{dataKey:n,clockWise:i,id:s,textBreakAll:o,zIndex:l}=r,c=FR(r,RAe),u=DAe(),d=$Ae(),f=u||d;return!f||!f.length?null:x.createElement(vo,{zIndex:l??Oa.label},x.createElement(ja,{className:"recharts-label-list"},f.map((p,h)=>{var m,g=Qi(n)?t(p,h):Ti(p.payload,n),y=Qi(s)?{}:{id:"".concat(s,"-").concat(h)};return x.createElement(If,Dw({key:"label-".concat(h)},Vo(p),c,y,{fill:(m=r.fill)!==null&&m!==void 0?m:p.fill,parentViewBox:p.parentViewBox,value:g,textBreakAll:o,viewBox:p.viewBox,index:h,zIndex:0}))})))}Zv.displayName="LabelList";function P_(e){var{label:t}=e;return t?t===!0?x.createElement(Zv,{key:"labelList-implicit"}):x.isValidElement(t)||l6(t)?x.createElement(Zv,{key:"labelList-implicit",content:t}):typeof t=="object"?x.createElement(Zv,Dw({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function JA(){return JA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},JA.apply(null,arguments)}var EG=e=>{var{cx:t,cy:r,r:n,className:i}=e,s=Si("recharts-dot",i);return An(t)&&An(r)&&An(n)?x.createElement("circle",JA({},cl(e),AC(e),{className:s,cx:t,cy:r,r:n})):null},TG=e=>e.graphicalItems.polarItems,UAe=Jt([Fa,jy],OE),O_=Jt([TG,Ya,UAe],ME),zAe=Jt([O_],LE),M_=Jt([zAe,x_],RE),WAe=Jt([M_,Ya,O_],BE);Jt([M_,Ya,O_],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(i=>{var s,o=Ti(n,(s=t.dataKey)!==null&&s!==void 0?s:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Ti(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var BR=()=>{},qAe=Jt([M_,Ya,O_,A_,Fa],UE),HAe=Jt([Ya,DE,$E,BR,qAe,BR,Oi,Fa],zE),PG=Jt([Ya,Oi,M_,WAe,_y,Fa,HAe],WE),VAe=Jt([PG,wg,Ph],VE),GAe=Jt([Ya,PG,VAe,Fa],KE);Jt([Ph,GAe],dV);var KAe={radiusAxis:{},angleAxis:{}},OG=Ll({name:"polarAxis",initialState:KAe,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:kMe,removeRadiusAxis:AMe,addAngleAxis:NMe,removeAngleAxis:CMe}=OG.actions,YAe=OG.reducer;function MG(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function IR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function DR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IR(Object(r),!0).forEach(function(n){XAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XAe(e,t,r){return(t=QAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QAe(e){var t=JAe(e,"string");return typeof t=="symbol"?t:t+""}function JAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZAe=(e,t)=>t,u6=Jt([TG,ZAe],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),e3e=[],d6=(e,t,r)=>(r==null?void 0:r.length)===0?e3e:r,LG=Jt([x_,u6,d6],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var i;if((t==null?void 0:t.data)!=null&&t.data.length>0?i=t.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(s=>DR(DR({},t.presentationProps),s.props))),i!=null)return i}}),t3e=Jt([LG,u6,d6],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,i)=>{var s,o=Ti(n,t.nameKey,t.name),l;return r!=null&&(s=r[i])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?l=n.fill:l=t.fill,{value:Ch(o,t.dataKey),color:l,payload:n,type:t.legendType}})}),r3e=Jt([LG,u6,d6,Ls],(e,t,r,n)=>{if(!(t==null||e==null))return iNe({offset:n,pieSettings:t,displayedData:e,cells:r})}),RG={exports:{}},Ki={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var eo=typeof Symbol=="function"&&Symbol.for,f6=eo?Symbol.for("react.element"):60103,h6=eo?Symbol.for("react.portal"):60106,L_=eo?Symbol.for("react.fragment"):60107,R_=eo?Symbol.for("react.strict_mode"):60108,F_=eo?Symbol.for("react.profiler"):60114,B_=eo?Symbol.for("react.provider"):60109,I_=eo?Symbol.for("react.context"):60110,p6=eo?Symbol.for("react.async_mode"):60111,D_=eo?Symbol.for("react.concurrent_mode"):60111,$_=eo?Symbol.for("react.forward_ref"):60112,U_=eo?Symbol.for("react.suspense"):60113,n3e=eo?Symbol.for("react.suspense_list"):60120,z_=eo?Symbol.for("react.memo"):60115,W_=eo?Symbol.for("react.lazy"):60116,i3e=eo?Symbol.for("react.block"):60121,a3e=eo?Symbol.for("react.fundamental"):60117,s3e=eo?Symbol.for("react.responder"):60118,o3e=eo?Symbol.for("react.scope"):60119;function mc(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case f6:switch(e=e.type,e){case p6:case D_:case L_:case F_:case R_:case U_:return e;default:switch(e=e&&e.$$typeof,e){case I_:case $_:case W_:case z_:case B_:return e;default:return t}}case h6:return t}}}function FG(e){return mc(e)===D_}Ki.AsyncMode=p6;Ki.ConcurrentMode=D_;Ki.ContextConsumer=I_;Ki.ContextProvider=B_;Ki.Element=f6;Ki.ForwardRef=$_;Ki.Fragment=L_;Ki.Lazy=W_;Ki.Memo=z_;Ki.Portal=h6;Ki.Profiler=F_;Ki.StrictMode=R_;Ki.Suspense=U_;Ki.isAsyncMode=function(e){return FG(e)||mc(e)===p6};Ki.isConcurrentMode=FG;Ki.isContextConsumer=function(e){return mc(e)===I_};Ki.isContextProvider=function(e){return mc(e)===B_};Ki.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===f6};Ki.isForwardRef=function(e){return mc(e)===$_};Ki.isFragment=function(e){return mc(e)===L_};Ki.isLazy=function(e){return mc(e)===W_};Ki.isMemo=function(e){return mc(e)===z_};Ki.isPortal=function(e){return mc(e)===h6};Ki.isProfiler=function(e){return mc(e)===F_};Ki.isStrictMode=function(e){return mc(e)===R_};Ki.isSuspense=function(e){return mc(e)===U_};Ki.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===L_||e===D_||e===F_||e===R_||e===U_||e===n3e||typeof e=="object"&&e!==null&&(e.$$typeof===W_||e.$$typeof===z_||e.$$typeof===B_||e.$$typeof===I_||e.$$typeof===$_||e.$$typeof===a3e||e.$$typeof===s3e||e.$$typeof===o3e||e.$$typeof===i3e)};Ki.typeOf=mc;RG.exports=Ki;var l3e=RG.exports,$R=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",UR=null,ak=null,BG=e=>{if(e===UR&&Array.isArray(ak))return ak;var t=[];return x.Children.forEach(e,r=>{Qi(r)||(l3e.isFragment(r)?t=t.concat(BG(r.props.children)):t.push(r))}),ak=t,UR=e,t};function q_(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(i=>$R(i)):n=[$R(t)],BG(e).forEach(i=>{var s=P0(i,"type.displayName")||P0(i,"type.name");s&&n.indexOf(s)!==-1&&r.push(i)}),r}var IG=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,DG={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var i;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((i=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&i.writable)?!1:r.toString()===`[object ${s}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(DG);var c3e=DG.isPlainObject;const u3e=sf(c3e);var zR,WR,qR,HR,VR;function GR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function KR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GR(Object(r),!0).forEach(function(n){d3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function d3e(e,t,r){return(t=f3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f3e(e){var t=h3e(e,"string");return typeof t=="symbol"?t:t+""}function h3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $w(){return $w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$w.apply(null,arguments)}function rx(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var YR=(e,t,r,n,i)=>{var s=r-n,o;return o=za(zR||(zR=rx(["M ",",",""])),e,t),o+=za(WR||(WR=rx(["L ",",",""])),e+r,t),o+=za(qR||(qR=rx(["L ",",",""])),e+r-s/2,t+i),o+=za(HR||(HR=rx(["L ",",",""])),e+r-s/2-n,t+i),o+=za(VR||(VR=rx(["L ",","," Z"])),e,t),o},p3e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},m3e=e=>{var t=ka(e,p3e),{x:r,y:n,upperWidth:i,lowerWidth:s,height:o,className:l}=t,{animationEasing:c,animationDuration:u,animationBegin:d,isUpdateAnimationActive:f}=t,p=x.useRef(null),[h,m]=x.useState(-1),g=x.useRef(i),y=x.useRef(s),b=x.useRef(o),v=x.useRef(r),w=x.useRef(n),S=gg(e,"trapezoid-");if(x.useEffect(()=>{if(p.current&&p.current.getTotalLength)try{var G=p.current.getTotalLength();G&&m(G)}catch{}},[]),r!==+r||n!==+n||i!==+i||s!==+s||o!==+o||i===0&&s===0||o===0)return null;var j=Si("recharts-trapezoid",l);if(!f)return x.createElement("g",null,x.createElement("path",$w({},Vo(t),{className:j,d:YR(r,n,i,s,o)})));var k=g.current,A=y.current,R=b.current,M=v.current,B=w.current,E="0px ".concat(h===-1?1:h,"px"),P="".concat(h,"px 0px"),D=Jq(["strokeDasharray"],u,c);return x.createElement(mg,{animationId:S,key:S,canBegin:h>0,duration:u,easing:c,isActive:f,begin:d},G=>{var H=Xi(k,i,G),oe=Xi(A,s,G),de=Xi(R,o,G),W=Xi(M,r,G),V=Xi(B,n,G);p.current&&(g.current=H,y.current=oe,b.current=de,v.current=W,w.current=V);var ae=G>0?{transition:D,strokeDasharray:P}:{strokeDasharray:E};return x.createElement("path",$w({},Vo(t),{className:j,d:YR(W,V,H,oe,de),ref:p,style:KR(KR({},ae),t.style)}))})},g3e=["option","shapeType","activeClassName"];function x3e(e,t){if(e==null)return{};var r,n,i=y3e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function y3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function XR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Uw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?XR(Object(r),!0).forEach(function(n){b3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):XR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function b3e(e,t,r){return(t=v3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function v3e(e){var t=w3e(e,"string");return typeof t=="symbol"?t:t+""}function w3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S3e(e,t){return Uw(Uw({},t),e)}function _3e(e,t){return e==="symbols"}function QR(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return x.createElement(rH,r);case"trapezoid":return x.createElement(m3e,r);case"sector":return x.createElement(sH,r);case"symbols":if(_3e(t))return x.createElement(zS,r);break;case"curve":return x.createElement(c_,r);default:return null}}function j3e(e){return x.isValidElement(e)?e.props:e}function D1(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,i=x3e(e,g3e),s;if(x.isValidElement(t))s=x.cloneElement(t,Uw(Uw({},i),j3e(t)));else if(typeof t=="function")s=t(i,i.index);else if(u3e(t)&&typeof t!="boolean"){var o=S3e(t,i);s=x.createElement(QR,{shapeType:r,elementProps:o})}else{var l=i;s=x.createElement(QR,{shapeType:r,elementProps:l})}return i.isActive?x.createElement(ja,{className:n},s):s}var H_=(e,t,r)=>{var n=Zi();return(i,s)=>o=>{e==null||e(i,s,o),n(UV({activeIndex:String(s),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}},V_=e=>{var t=Zi();return(r,n)=>i=>{e==null||e(r,n,i),t(Oje())}},G_=(e,t,r)=>{var n=Zi();return(i,s)=>o=>{e==null||e(i,s,o),n(Mje({activeIndex:String(s),activeDataKey:t,activeCoordinate:i.tooltipPosition,activeGraphicalItemId:r}))}};function K_(e){var{tooltipEntrySettings:t}=e,r=Zi(),n=Rs(),i=x.useRef(null);return x.useLayoutEffect(()=>{n||(i.current===null?r(Cje(t)):i.current!==t&&r(Eje({prev:i.current,next:t})),i.current=t)},[t,r,n]),x.useLayoutEffect(()=>()=>{i.current&&(r(Tje(i.current)),i.current=null)},[r]),null}function m6(e){var{legendPayload:t}=e,r=Zi(),n=Rs(),i=x.useRef(null);return x.useLayoutEffect(()=>{n||(i.current===null?r(Kq(t)):i.current!==t&&r(Yq({prev:i.current,next:t})),i.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{i.current&&(r(Xq(i.current)),i.current=null)},[r]),null}function k3e(e){var{legendPayload:t}=e,r=Zi(),n=Sn(Oi),i=x.useRef(null);return x.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(i.current===null?r(Kq(t)):i.current!==t&&r(Yq({prev:i.current,next:t})),i.current=t)},[r,n,t]),x.useLayoutEffect(()=>()=>{i.current&&(r(Xq(i.current)),i.current=null)},[r]),null}var sk,A3e=()=>{var[e]=x.useState(()=>k1("uid-"));return e},N3e=(sk=fB.useId)!==null&&sk!==void 0?sk:A3e;function C3e(e,t){var r=N3e();return t||(e?"".concat(e,"-").concat(r):r)}var E3e=x.createContext(void 0),Y_=e=>{var{id:t,type:r,children:n}=e,i=C3e("recharts-".concat(r),t);return x.createElement(E3e.Provider,{value:i},n(i))},T3e={cartesianItems:[],polarItems:[]},$G=Ll({name:"graphicalItems",initialState:T3e,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:wa()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,i=xu(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=n)},prepare:wa()},removeCartesianGraphicalItem:{reducer(e,t){var r=xu(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:wa()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:wa()},removePolarGraphicalItem:{reducer(e,t){var r=xu(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:wa()}}}),{addCartesianGraphicalItem:P3e,replaceCartesianGraphicalItem:O3e,removeCartesianGraphicalItem:M3e,addPolarGraphicalItem:L3e,removePolarGraphicalItem:R3e}=$G.actions,F3e=$G.reducer,B3e=e=>{var t=Zi(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(P3e(e)):r.current!==e&&t(O3e({prev:r.current,next:e})),r.current=e},[t,e]),x.useLayoutEffect(()=>()=>{r.current&&(t(M3e(r.current)),r.current=null)},[t]),null},g6=x.memo(B3e);function I3e(e){var t=Zi();return x.useLayoutEffect(()=>(t(L3e(e)),()=>{t(R3e(e))}),[t,e]),null}var D3e=["key"],$3e=["onMouseEnter","onClick","onMouseLeave"],U3e=["id"],z3e=["id"];function JR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ha(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JR(Object(r),!0).forEach(function(n){W3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W3e(e,t,r){return(t=q3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q3e(e){var t=H3e(e,"string");return typeof t=="symbol"?t:t+""}function H3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bh.apply(null,arguments)}function X_(e,t){if(e==null)return{};var r,n,i=V3e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function V3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function G3e(e){var t=x.useMemo(()=>q_(e.children,op),[e.children]),r=Sn(n=>t3e(n,e.id,t));return r==null?null:x.createElement(k3e,{legendPayload:r})}var K3e=x.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:i,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:n.map(p=>p.tooltipPayload),getPosition:p=>{var h;return(h=n[Number(p)])===null||h===void 0?void 0:h.tooltipPosition},settings:{stroke:i,strokeWidth:s,fill:o,dataKey:t,nameKey:r,name:Ch(l,t),hide:c,type:u,color:o,unit:"",graphicalItemId:d}};return x.createElement(K_,{tooltipEntrySettings:f})}),Y3e=(e,t)=>e>t?"start":e<t?"end":"middle",X3e=(e,t,r)=>Wo(typeof t=="function"?t(e):t,r,r*.8),Q3e=(e,t,r)=>{var{top:n,left:i,width:s,height:o}=t,l=nH(s,o),c=i+Wo(e.cx,s,s/2),u=n+Wo(e.cy,o,o/2),d=Wo(e.innerRadius,l,0),f=X3e(r,e.outerRadius,l),p=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:f,maxRadius:p}},J3e=(e,t)=>{var r=Xs(t-e),n=Math.min(Math.abs(t-e),360);return r*n},Z3e=(e,t)=>{if(x.isValidElement(e))return x.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Si("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,i=X_(t,D3e);return x.createElement(c_,bh({},i,{type:"linear",className:r}))},eNe=(e,t,r)=>{if(x.isValidElement(e))return x.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),x.isValidElement(n)))return n;var i=Si("recharts-pie-label-text",MG(e));return x.createElement(T_,bh({},t,{alignmentBaseline:"middle",className:i}),n)};function tNe(e){var{sectors:t,props:r,showLabels:n}=e,{label:i,labelLine:s,dataKey:o}=r;if(!n||!i||!t)return null;var l=cl(r),c=yh(i),u=yh(s),d=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,f=t.map((p,h)=>{var m=(p.startAngle+p.endAngle)/2,g=bs(p.cx,p.cy,p.outerRadius+d,m),y=Ha(Ha(Ha(Ha({},l),p),{},{stroke:"none"},c),{},{index:h,textAnchor:Y3e(g.x,p.cx)},g),b=Ha(Ha(Ha(Ha({},l),p),{},{fill:"none",stroke:p.fill},u),{},{index:h,points:[bs(p.cx,p.cy,p.outerRadius,m),g],key:"line"});return x.createElement(vo,{zIndex:Oa.label,key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(h)},x.createElement(ja,null,s&&Z3e(s,b),eNe(i,y,Ti(p,o))))});return x.createElement(ja,{className:"recharts-pie-labels"},f)}function rNe(e){var{sectors:t,props:r,showLabels:n}=e,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?x.createElement(P_,{label:i}):x.createElement(tNe,{sectors:t,props:r,showLabels:n})}function nNe(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:i,shape:s,id:o}=e,l=Sn(nf),c=Sn(n6),u=Sn(yke),{onMouseEnter:d,onClick:f,onMouseLeave:p}=i,h=X_(i,$3e),m=H_(d,i.dataKey,o),g=V_(p),y=G_(f,i.dataKey,o);return t==null||t.length===0?null:x.createElement(x.Fragment,null,t.map((b,v)=>{if((b==null?void 0:b.startAngle)===0&&(b==null?void 0:b.endAngle)===0&&t.length!==1)return null;var w=u==null||u===o,S=String(v)===l&&(c==null||i.dataKey===c)&&w,j=l?n:null,k=r&&S?r:j,A=Ha(Ha({},b),{},{stroke:b.stroke,tabIndex:-1,[Pq]:v,[qC]:o});return x.createElement(ja,bh({key:"sector-".concat(b==null?void 0:b.startAngle,"-").concat(b==null?void 0:b.endAngle,"-").concat(b.midAngle,"-").concat(v),tabIndex:-1,className:"recharts-pie-sector"},hg(h,b,v),{onMouseEnter:m(b,v),onMouseLeave:g(b,v),onClick:y(b,v)}),x.createElement(D1,bh({option:s??k,index:v,shapeType:"sector",isActive:S},A)))}))}function iNe(e){var t,{pieSettings:r,displayedData:n,cells:i,offset:s}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:u,nameKey:d,tooltipType:f}=r,p=Math.abs(r.minAngle),h=J3e(l,c),m=Math.abs(h),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=n.filter(k=>Ti(k,u,0)!==0).length,b=(m>=360?y:y-1)*g,v=m-y*p-b,w=n.reduce((k,A)=>{var R=Ti(A,u,0);return k+(An(R)?R:0)},0),S;if(w>0){var j;S=n.map((k,A)=>{var R=Ti(k,u,0),M=Ti(k,d,A),B=Q3e(r,s,k),E=(An(R)?R:0)/w,P,D=Ha(Ha({},k),i&&i[A]&&i[A].props);A?P=j.endAngle+Xs(h)*g*(R!==0?1:0):P=l;var G=P+Xs(h)*((R!==0?p:0)+E*v),H=(P+G)/2,oe=(B.innerRadius+B.outerRadius)/2,de=[{name:M,value:R,payload:D,dataKey:u,type:f,graphicalItemId:r.id}],W=bs(B.cx,B.cy,oe,H);return j=Ha(Ha(Ha(Ha({},r.presentationProps),{},{percent:E,cornerRadius:typeof o=="string"?parseFloat(o):o,name:M,tooltipPayload:de,midAngle:H,middleRadius:oe,tooltipPosition:W},D),B),{},{value:R,dataKey:u,startAngle:P,endAngle:G,payload:D,paddingAngle:Xs(h)*g}),j})}return S}function aNe(e){var{showLabels:t,sectors:r,children:n}=e,i=x.useMemo(()=>!t||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,t]);return x.createElement(IAe,{value:t?i:void 0},n)}function sNe(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:u,inactiveShape:d,onAnimationStart:f,onAnimationEnd:p}=t,h=gg(t,"recharts-pie-"),m=r.current,[g,y]=x.useState(!1),b=x.useCallback(()=>{typeof p=="function"&&p(),y(!1)},[p]),v=x.useCallback(()=>{typeof f=="function"&&f(),y(!0)},[f]);return x.createElement(aNe,{showLabels:!g,sectors:i},x.createElement(mg,{animationId:h,begin:o,duration:l,isActive:s,easing:c,onAnimationStart:v,onAnimationEnd:b,key:h},w=>{var S,j=[],k=i&&i[0],A=(S=k==null?void 0:k.startAngle)!==null&&S!==void 0?S:0;return i==null||i.forEach((R,M)=>{var B=m&&m[M],E=M>0?P0(R,"paddingAngle",0):0;if(B){var P=Xi(B.endAngle-B.startAngle,R.endAngle-R.startAngle,w),D=Ha(Ha({},R),{},{startAngle:A+E,endAngle:A+P+E});j.push(D),A=D.endAngle}else{var{endAngle:G,startAngle:H}=R,oe=Xi(0,G-H,w),de=Ha(Ha({},R),{},{startAngle:A+E,endAngle:A+oe+E});j.push(de),A=de.endAngle}}),r.current=j,x.createElement(ja,null,x.createElement(nNe,{sectors:j,activeShape:u,inactiveShape:d,allOtherPieProps:t,shape:t.shape,id:n}))}),x.createElement(rNe,{showLabels:!g,sectors:i,props:t}),t.children)}var oNe={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Oa.area};function lNe(e){var{id:t}=e,r=X_(e,U3e),{hide:n,className:i,rootTabIndex:s}=e,o=x.useMemo(()=>q_(e.children,op),[e.children]),l=Sn(d=>r3e(d,t,o)),c=x.useRef(null),u=Si("recharts-pie",i);return n||l==null?(c.current=null,x.createElement(ja,{tabIndex:s,className:u})):x.createElement(vo,{zIndex:e.zIndex},x.createElement(K3e,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:l,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),x.createElement(ja,{tabIndex:s,className:u},x.createElement(sNe,{props:Ha(Ha({},r),{},{sectors:l}),previousSectorsRef:c,id:t})))}function UG(e){var t=ka(e,oNe),{id:r}=t,n=X_(t,z3e),i=cl(n);return x.createElement(Y_,{id:r,type:"pie"},s=>x.createElement(x.Fragment,null,x.createElement(I3e,{type:"pie",id:s,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i,maxRadius:t.maxRadius}),x.createElement(G3e,bh({},n,{id:s})),x.createElement(lNe,bh({},n,{id:s}))))}UG.displayName="Pie";var cNe=["points"];function ZR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ok(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZR(Object(r),!0).forEach(function(n){uNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function uNe(e,t,r){return(t=dNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dNe(e){var t=fNe(e,"string");return typeof t=="symbol"?t:t+""}function fNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zw(){return zw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zw.apply(null,arguments)}function hNe(e,t){if(e==null)return{};var r,n,i=pNe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function pNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function mNe(e){var{option:t,dotProps:r,className:n}=e;if(x.isValidElement(t))return x.cloneElement(t,r);if(typeof t=="function")return t(r);var i=Si(n,typeof t!="boolean"?t.className:""),s=r??{},{points:o}=s,l=hNe(s,cNe);return x.createElement(EG,zw({},l,{className:i}))}function gNe(e,t){return e==null?!1:t?!0:e.length===1}function xNe(e){var{points:t,dot:r,className:n,dotClassName:i,dataKey:s,baseProps:o,needClip:l,clipPathId:c,zIndex:u=Oa.scatter}=e;if(!gNe(t,r))return null;var d=IG(r),f=n1e(r),p=t.map((m,g)=>{var y,b,v=ok(ok(ok({r:3},o),f),{},{index:g,cx:(y=m.x)!==null&&y!==void 0?y:void 0,cy:(b=m.y)!==null&&b!==void 0?b:void 0,dataKey:s,value:m.value,payload:m.payload,points:t});return x.createElement(mNe,{key:"dot-".concat(g),option:r,dotProps:v,className:i})}),h={};return l&&c!=null&&(h.clipPath="url(#clipPath-".concat(d?"":"dots-").concat(c,")")),x.createElement(vo,{zIndex:u},x.createElement(ja,zw({className:n},h),p))}function eF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function tF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eF(Object(r),!0).forEach(function(n){yNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yNe(e,t,r){return(t=bNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bNe(e){var t=vNe(e,"string");return typeof t=="symbol"?t:t+""}function vNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zG=0,wNe={xAxis:{},yAxis:{},zAxis:{}},WG=Ll({name:"cartesianAxis",initialState:wNe,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:wa()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:wa()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:wa()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:wa()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:wa()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:wa()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:wa()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:wa()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:wa()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,i=e.yAxis[r];if(i){var s,o=i.widthHistory||[];if(o.length===3&&o[0]===o[2]&&n===o[1]&&n!==i.width&&Math.abs(n-((s=o[0])!==null&&s!==void 0?s:0))<=1)return;var l=[...o,n].slice(-3);e.yAxis[r]=tF(tF({},i),{},{width:n,widthHistory:l})}}}}),{addXAxis:SNe,replaceXAxis:_Ne,removeXAxis:jNe,addYAxis:kNe,replaceYAxis:ANe,removeYAxis:NNe,addZAxis:CNe,replaceZAxis:ENe,removeZAxis:TNe,updateYAxisWidth:PNe}=WG.actions,ONe=WG.reducer,MNe=Jt([Ls],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),LNe=Jt([MNe,pf,mf],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),x6=()=>Sn(LNe),RNe=()=>Sn(_ke);function rF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function lk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rF(Object(r),!0).forEach(function(n){FNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FNe(e,t,r){return(t=BNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BNe(e){var t=INe(e,"string");return typeof t=="symbol"?t:t+""}function INe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DNe=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:i,dataKey:s,clipPath:o}=e;if(i===!1||t.x==null||t.y==null)return null;var l={index:r,dataKey:s,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},c=lk(lk(lk({},l),yh(i)),AC(i)),u;return x.isValidElement(i)?u=x.cloneElement(i,c):typeof i=="function"?u=i(c):u=x.createElement(EG,c),x.createElement(ja,{className:"recharts-active-dot",clipPath:o},u)};function $Ne(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:i,clipPath:s,zIndex:o=Oa.activeDot}=e,l=Sn(nf),c=RNe();if(t==null||c==null)return null;var u=t.find(d=>c.includes(d.payload));return Qi(u)?null:x.createElement(vo,{zIndex:o},x.createElement(DNe,{point:u,childIndex:Number(l),mainColor:r,dataKey:i,activeDot:n,clipPath:s}))}var nF=(e,t,r)=>{var n=r??e;if(!Qi(n))return Wo(n,t,0)},UNe=(e,t,r)=>{var n={},i=e.filter(S_),s=e.filter(u=>u.stackId==null),o=i.reduce((u,d)=>{var f=u[d.stackId];return f==null&&(f=[]),f.push(d),u[d.stackId]=f,u},n),l=Object.entries(o).map(u=>{var d,[f,p]=u,h=p.map(g=>g.dataKey),m=nF(t,r,(d=p[0])===null||d===void 0?void 0:d.barSize);return{stackId:f,dataKeys:h,barSize:m}}),c=s.map(u=>{var d=[u.dataKey].filter(p=>p!=null),f=nF(t,r,u.barSize);return{stackId:void 0,dataKeys:d,barSize:f}});return[...l,...c]};function iF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function fv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iF(Object(r),!0).forEach(function(n){zNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zNe(e,t,r){return(t=WNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WNe(e){var t=qNe(e,"string");return typeof t=="symbol"?t:t+""}function qNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HNe(e,t,r,n,i){var s,o=n.length;if(!(o<1)){var l=Wo(e,r,0,!0),c,u=[];if(fi((s=n[0])===null||s===void 0?void 0:s.barSize)){var d=!1,f=r/o,p=n.reduce((v,w)=>v+(w.barSize||0),0);p+=(o-1)*l,p>=r&&(p-=(o-1)*l,l=0),p>=r&&f>0&&(d=!0,f*=.9,p=o*f);var h=(r-p)/2>>0,m={offset:h-l,size:0};c=n.reduce((v,w)=>{var S,j={stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:m.offset+m.size+l,size:d?f:(S=w.barSize)!==null&&S!==void 0?S:0}},k=[...v,j];return m=j.position,k},u)}else{var g=Wo(t,r,0,!0);r-2*g-(o-1)*l<=0&&(l=0);var y=(r-2*g-(o-1)*l)/o;y>1&&(y>>=0);var b=fi(i)?Math.min(y,i):y;c=n.reduce((v,w,S)=>[...v,{stackId:w.stackId,dataKeys:w.dataKeys,position:{offset:g+(y+l)*S+(y-b)/2,size:b}}],u)}return c}}var VNe=(e,t,r,n,i,s,o)=>{var l=Qi(o)?t:o,c=HNe(r,n,i!==s?i:s,e,l);return i!==s&&c!=null&&(c=c.map(u=>fv(fv({},u),{},{position:fv(fv({},u.position),{},{offset:u.position.offset-i/2})}))),c},GNe=(e,t)=>{var r=TE(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var i=e[n];if(i){var{stackedData:s}=i;if(s)return s.find(o=>o.key===r)}}}},KNe=(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}};function YNe(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&fi(e.zIndex)?e.zIndex:t}var qG=e=>{var{chartData:t}=e,r=Zi(),n=Rs();return x.useEffect(()=>n?()=>{}:(r(yR(t)),()=>{r(yR(void 0))}),[t,r,n]),null},aF={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},HG=Ll({name:"brush",initialState:aF,reducers:{setBrushSettings(e,t){return t.payload==null?aF:t.payload}}}),{setBrushSettings:EMe}=HG.actions,XNe=HG.reducer,QNe=(e,t)=>{var{x:r,y:n}=e,{x:i,y:s}=t;return{x:Math.min(r,i),y:Math.min(n,s),width:Math.abs(i-r),height:Math.abs(s-n)}},JNe=e=>{var{x1:t,y1:r,x2:n,y2:i}=e;return QNe({x:t,y:r},{x:n,y:i})};function ZNe(e){return(e%180+180)%180}var eCe=function(t){var{width:r,height:n}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=ZNe(i),o=s*Math.PI/180,l=Math.atan(n/r),c=o>l&&o<Math.PI-l?n/Math.sin(o):r/Math.cos(o);return Math.abs(c)},tCe={dots:[],areas:[],lines:[]},VG=Ll({name:"referenceElements",initialState:tCe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=xu(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=xu(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=xu(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:TMe,removeDot:PMe,addArea:OMe,removeArea:MMe,addLine:rCe,removeLine:nCe}=VG.actions,iCe=VG.reducer,GG=x.createContext(void 0),aCe=e=>{var{children:t}=e,[r]=x.useState("".concat(k1("recharts"),"-clip")),n=x6();if(n==null)return null;var{x:i,y:s,width:o,height:l}=n;return x.createElement(GG.Provider,{value:r},x.createElement("defs",null,x.createElement("clipPath",{id:r},x.createElement("rect",{x:i,y:s,height:l,width:o}))),t)},sCe=()=>x.useContext(GG);class oCe{constructor(t){var{x:r,y:n}=t;this.xAxisScale=r,this.yAxisScale=n}map(t,r){var n,i,{position:s}=r;return{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:0,y:(i=this.yAxisScale.map(t.y,{position:s}))!==null&&i!==void 0?i:0}}mapWithFallback(t,r){var n,i,{position:s,fallback:o}=r,l,c;return o==="rangeMin"?l=this.yAxisScale.rangeMin():o==="rangeMax"?l=this.yAxisScale.rangeMax():l=0,o==="rangeMin"?c=this.xAxisScale.rangeMin():o==="rangeMax"?c=this.xAxisScale.rangeMax():c=0,{x:(n=this.xAxisScale.map(t.x,{position:s}))!==null&&n!==void 0?n:c,y:(i=this.yAxisScale.map(t.y,{position:s}))!==null&&i!==void 0?i:l}}isInRange(t){var{x:r,y:n}=t,i=r==null||this.xAxisScale.isInRange(r),s=n==null||this.yAxisScale.isInRange(n);return i&&s}}function sF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function oF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sF(Object(r),!0).forEach(function(n){lCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function lCe(e,t,r){return(t=cCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cCe(e){var t=uCe(e,"string");return typeof t=="symbol"?t:t+""}function uCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ww(){return Ww=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ww.apply(null,arguments)}var dCe=(e,t)=>{var r;if(x.isValidElement(e))r=x.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{if(!fi(t.x1)||!fi(t.y1)||!fi(t.x2)||!fi(t.y2))return null;r=x.createElement("line",Ww({},t,{className:"recharts-reference-line-line"}))}return r},fCe=(e,t,r,n,i,s)=>{var{x:o,width:l}=s,c=i.map(e,{position:r});if(!fi(c)||t==="discard"&&!i.isInRange(c))return null;var u=[{x:o+l,y:c},{x:o,y:c}];return n==="left"?u.reverse():u},hCe=(e,t,r,n,i,s)=>{var{y:o,height:l}=s,c=i.map(e,{position:r});if(!fi(c)||t==="discard"&&!i.isInRange(c))return null;var u=[{x:c,y:o+l},{x:c,y:o}];return n==="top"?u.reverse():u},pCe=(e,t,r,n)=>{var i=[n.mapWithFallback(e[0],{position:r,fallback:"rangeMin"}),n.mapWithFallback(e[1],{position:r,fallback:"rangeMax"})];return t==="discard"&&i.some(s=>!n.isInRange(s))?null:i},mCe=(e,t,r,n,i,s,o)=>{var{x:l,y:c,segment:u,ifOverflow:d}=o,f=Hc(l),p=Hc(c);return p?fCe(c,d,n,s,t,r):f?hCe(l,d,n,i,e,r):u!=null&&u.length===2?pCe(u,d,n,new oCe({x:e,y:t})):null};function gCe(e){var t=Zi();return x.useEffect(()=>(t(rCe(e)),()=>{t(nCe(e))})),null}function xCe(e){var{xAxisId:t,yAxisId:r,shape:n,className:i,ifOverflow:s}=e,o=Rs(),l=sCe(),c=Sn(A=>dd(A,t)),u=Sn(A=>fd(A,r)),d=Sn(A=>Xm(A,"xAxis",t,o)),f=Sn(A=>Xm(A,"yAxis",r,o)),p=pg();if(!l||!p||c==null||u==null||d==null||f==null)return null;var h=mCe(d,f,p,e.position,c.orientation,u.orientation,e);if(!h)return null;var m=h[0],g=h[1];if(m==null||g==null)return null;var{x:y,y:b}=m,{x:v,y:w}=g,S=s==="hidden"?"url(#".concat(l,")"):void 0,j=oF(oF({clipPath:S},Vo(e)),{},{x1:y,y1:b,x2:v,y2:w}),k=JNe({x1:y,y1:b,x2:v,y2:w});return x.createElement(vo,{zIndex:e.zIndex},x.createElement(ja,{className:Si("recharts-reference-line",i)},dCe(n,j),x.createElement(wG,Ww({},k,{lowerWidth:k.width,upperWidth:k.width}),x.createElement(_G,{label:e.label}),e.children)))}var yCe={ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",label:!1,stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle",zIndex:Oa.line};function ZA(e){var t=ka(e,yCe);return x.createElement(x.Fragment,null,x.createElement(gCe,{yAxisId:t.yAxisId,xAxisId:t.xAxisId,ifOverflow:t.ifOverflow,x:t.x,y:t.y,segment:t.segment}),x.createElement(xCe,t))}ZA.displayName="ReferenceLine";function KG(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var i=e[n];i!==void 0&&r.push(i)}return r}function bCe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return eCe(n,r)}function vCe(e,t,r){var n=r==="width",{x:i,y:s,width:o,height:l}=e;return t===1?{start:n?i:s,end:n?i+o:s+l}:{start:n?i+o:s+l,end:n?i:s}}function $1(e,t,r,n,i){if(e*t<e*n||e*t>e*i)return!1;var s=r();return e*(t-e*s/2-n)>=0&&e*(t+e*s/2-i)<=0}function wCe(e,t){return KG(e,t+1)}function SCe(e,t,r,n,i){for(var s=(n||[]).slice(),{start:o,end:l}=t,c=0,u=1,d=o,f=function(){var m=n==null?void 0:n[c];if(m===void 0)return{v:KG(n,u)};var g=c,y,b=()=>(y===void 0&&(y=r(m,g)),y),v=m.coordinate,w=c===0||$1(e,v,b,d,l);w||(c=0,d=o,u+=1),w&&(d=v+e*(b()/2+i),c+=u)},p;u<=s.length;)if(p=f(),p)return p.v;return[]}function _Ce(e,t,r,n,i){var s=(n||[]).slice(),o=s.length;if(o===0)return[];for(var{start:l,end:c}=t,u=1;u<=o;u++){for(var d=(o-1)%u,f=l,p=!0,h=function(){var S=n[g];if(S==null)return 0;var j=g,k,A=()=>(k===void 0&&(k=r(S,j)),k),R=S.coordinate,M=g===d||$1(e,R,A,f,c);if(!M)return p=!1,1;M&&(f=R+e*(A()/2+i))},m,g=d;g<o&&(m=h(),!(m!==0&&m===1));g+=u);if(p){for(var y=[],b=d;b<o;b+=u){var v=n[b];v!=null&&y.push(v)}return y}}return[]}function lF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Oo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lF(Object(r),!0).forEach(function(n){jCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jCe(e,t,r){return(t=kCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kCe(e){var t=ACe(e,"string");return typeof t=="symbol"?t:t+""}function ACe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NCe(e,t,r,n,i){for(var s=(n||[]).slice(),o=s.length,{start:l}=t,{end:c}=t,u=function(p){var h=s[p];if(h==null)return 1;var m=h,g,y=()=>(g===void 0&&(g=r(h,p)),g);if(p===o-1){var b=e*(m.coordinate+e*y()/2-c);s[p]=m=Oo(Oo({},m),{},{tickCoord:b>0?m.coordinate-b*e:m.coordinate})}else s[p]=m=Oo(Oo({},m),{},{tickCoord:m.coordinate});if(m.tickCoord!=null){var v=$1(e,m.tickCoord,y,l,c);v&&(c=m.tickCoord-e*(y()/2+i),s[p]=Oo(Oo({},m),{},{isShow:!0}))}},d=o-1;d>=0;d--)u(d);return s}function CCe(e,t,r,n,i,s){var o=(n||[]).slice(),l=o.length,{start:c,end:u}=t;if(s){var d=n[l-1];if(d!=null){var f=r(d,l-1),p=e*(d.coordinate+e*f/2-u);if(o[l-1]=d=Oo(Oo({},d),{},{tickCoord:p>0?d.coordinate-p*e:d.coordinate}),d.tickCoord!=null){var h=$1(e,d.tickCoord,()=>f,c,u);h&&(u=d.tickCoord-e*(f/2+i),o[l-1]=Oo(Oo({},d),{},{isShow:!0}))}}}for(var m=s?l-1:l,g=function(v){var w=o[v];if(w==null)return 1;var S=w,j,k=()=>(j===void 0&&(j=r(w,v)),j);if(v===0){var A=e*(S.coordinate-e*k()/2-c);o[v]=S=Oo(Oo({},S),{},{tickCoord:A<0?S.coordinate-A*e:S.coordinate})}else o[v]=S=Oo(Oo({},S),{},{tickCoord:S.coordinate});if(S.tickCoord!=null){var R=$1(e,S.tickCoord,k,c,u);R&&(c=S.tickCoord+e*(k()/2+i),o[v]=Oo(Oo({},S),{},{isShow:!0}))}},y=0;y<m;y++)g(y);return o}function y6(e,t,r){var{tick:n,ticks:i,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!i||!i.length||!n)return[];if(An(c)||u_.isSsr){var p;return(p=wCe(i,An(c)?c:0))!==null&&p!==void 0?p:[]}var h=[],m=l==="top"||l==="bottom"?"width":"height",g=d&&m==="width"?$x(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},y=(j,k)=>{var A=typeof u=="function"?u(j.value,k):j.value;return m==="width"?bCe($x(A,{fontSize:t,letterSpacing:r}),g,f):$x(A,{fontSize:t,letterSpacing:r})[m]},b=i[0],v=i[1],w=i.length>=2&&b!=null&&v!=null?Xs(v.coordinate-b.coordinate):1,S=vCe(s,w,m);return c==="equidistantPreserveStart"?SCe(w,S,y,i,o):c==="equidistantPreserveEnd"?_Ce(w,S,y,i,o):(c==="preserveStart"||c==="preserveStartEnd"?h=CCe(w,S,y,i,o,c==="preserveStartEnd"):h=NCe(w,S,y,i,o),h.filter(j=>j.isShow))}var ECe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:i=0,tickMargin:s=0}=e,o=0;if(t){Array.from(t).forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,c=i+s,u=o+c+l+(r?n:0);return Math.round(u)}return 0},TCe=["axisLine","width","height","className","hide","ticks","axisType"];function PCe(e,t){if(e==null)return{};var r,n,i=OCe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function OCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function B0(){return B0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},B0.apply(null,arguments)}function cF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ua(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cF(Object(r),!0).forEach(function(n){MCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MCe(e,t,r){return(t=LCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LCe(e){var t=RCe(e,"string");return typeof t=="symbol"?t:t+""}function RCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qd={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Oa.axis};function FCe(e){var{x:t,y:r,width:n,height:i,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var u=Ua(Ua(Ua({},c),cl(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var d=+(s==="top"&&!o||s==="bottom"&&o);u=Ua(Ua({},u),{},{x1:t,y1:r+d*i,x2:t+n,y2:r+d*i})}else{var f=+(s==="left"&&!o||s==="right"&&o);u=Ua(Ua({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+i})}return x.createElement("line",B0({},u,{className:Si("recharts-cartesian-axis-line",P0(l,"className"))}))}function BCe(e,t,r,n,i,s,o,l,c){var u,d,f,p,h,m,g=l?-1:1,y=e.tickSize||o,b=An(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":u=d=e.coordinate,p=r+ +!l*i,f=p-g*y,m=f-g*c,h=b;break;case"left":f=p=e.coordinate,d=t+ +!l*n,u=d-g*y,h=u-g*c,m=b;break;case"right":f=p=e.coordinate,d=t+ +l*n,u=d+g*y,h=u+g*c,m=b;break;default:u=d=e.coordinate,p=r+ +l*i,f=p+g*y,m=f+g*c,h=b;break}return{line:{x1:u,y1:f,x2:d,y2:p},tick:{x:h,y:m}}}function ICe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function DCe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function $Ce(e){var{option:t,tickProps:r,value:n}=e,i,s=Si(r.className,"recharts-cartesian-axis-tick-value");if(x.isValidElement(t))i=x.cloneElement(t,Ua(Ua({},r),{},{className:s}));else if(typeof t=="function")i=t(Ua(Ua({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=Si(o,MG(t))),i=x.createElement(T_,B0({},r,{className:o}),n)}return i}var UCe=x.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:i,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:u,orientation:d,mirror:f,x:p,y:h,width:m,height:g,tickSize:y,tickMargin:b,fontSize:v,letterSpacing:w,getTicksConfig:S,events:j,axisType:k}=e,A=y6(Ua(Ua({},S),{},{ticks:r}),v,w),R=ICe(d,f),M=DCe(d,f),B=cl(S),E=yh(n),P={};typeof i=="object"&&(P=i);var D=Ua(Ua({},B),{},{fill:"none"},P),G=A.map(de=>Ua({entry:de},BCe(de,p,h,m,g,d,y,f,b))),H=G.map(de=>{var{entry:W,line:V}=de;return x.createElement(ja,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(W.value,"-").concat(W.coordinate,"-").concat(W.tickCoord)},i&&x.createElement("line",B0({},D,V,{className:Si("recharts-cartesian-axis-tick-line",P0(i,"className"))})))}),oe=G.map((de,W)=>{var V,ae,{entry:ee,tick:C}=de,Y=Ua(Ua(Ua(Ua({verticalAnchor:M},B),{},{textAnchor:R,stroke:"none",fill:s},C),{},{index:W,payload:ee,visibleTicksCount:A.length,tickFormatter:o,padding:c},u),{},{angle:(V=(ae=u==null?void 0:u.angle)!==null&&ae!==void 0?ae:B.angle)!==null&&V!==void 0?V:0}),q=Ua(Ua({},Y),E);return x.createElement(ja,B0({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(ee.value,"-").concat(ee.coordinate,"-").concat(ee.tickCoord)},hg(j,ee,W)),n&&x.createElement($Ce,{option:n,tickProps:q,value:"".concat(typeof o=="function"?o(ee.value,W):ee.value).concat(l||"")}))});return x.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(k,"-ticks")},oe.length>0&&x.createElement(vo,{zIndex:Oa.label},x.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(k,"-tick-labels"),ref:t},oe)),H.length>0&&x.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(k,"-tick-lines")},H))}),zCe=x.forwardRef((e,t)=>{var{axisLine:r,width:n,height:i,className:s,hide:o,ticks:l,axisType:c}=e,u=PCe(e,TCe),[d,f]=x.useState(""),[p,h]=x.useState(""),m=x.useRef(null);x.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var y;return ECe({ticks:m.current,label:(y=e.labelRef)===null||y===void 0?void 0:y.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var g=x.useCallback(y=>{if(y){var b=y.getElementsByClassName("recharts-cartesian-axis-tick-value");m.current=b;var v=b[0];if(v){var w=window.getComputedStyle(v),S=w.fontSize,j=w.letterSpacing;(S!==d||j!==p)&&(f(S),h(j))}}},[d,p]);return o||n!=null&&n<=0||i!=null&&i<=0?null:x.createElement(vo,{zIndex:e.zIndex},x.createElement(ja,{className:Si("recharts-cartesian-axis",s)},x.createElement(FCe,{x:e.x,y:e.y,width:n,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:cl(e)}),x.createElement(UCe,{ref:g,axisType:c,events:u,fontSize:d,getTicksConfig:e,height:e.height,letterSpacing:p,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),x.createElement(wG,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},x.createElement(_G,{label:e.label,labelRef:e.labelRef}),e.children)))}),b6=x.forwardRef((e,t)=>{var r=ka(e,qd);return x.createElement(zCe,B0({},r,{ref:t}))});b6.displayName="CartesianAxis";var WCe=["x1","y1","x2","y2","key"],qCe=["offset"],HCe=["xAxisId","yAxisId"],VCe=["xAxisId","yAxisId"];function uF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Bo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uF(Object(r),!0).forEach(function(n){GCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GCe(e,t,r){return(t=KCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KCe(e){var t=YCe(e,"string");return typeof t=="symbol"?t:t+""}function YCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function e0(){return e0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e0.apply(null,arguments)}function qw(e,t){if(e==null)return{};var r,n,i=XCe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function XCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var QCe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:i,width:s,height:o,ry:l}=e;return x.createElement("rect",{x:n,y:i,ry:l,width:s,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function YG(e){var{option:t,lineItemProps:r}=e,n;if(x.isValidElement(t))n=x.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var i,{x1:s,y1:o,x2:l,y2:c,key:u}=r,d=qw(r,WCe),f=(i=cl(d))!==null&&i!==void 0?i:{},{offset:p}=f,h=qw(f,qCe);n=x.createElement("line",e0({},h,{x1:s,y1:o,x2:l,y2:c,fill:"none",key:u}))}return n}function JCe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=qw(e,HCe),c=i.map((u,d)=>{var f=Bo(Bo({},l),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return x.createElement(YG,{key:"line-".concat(d),option:n,lineItemProps:f})});return x.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function ZCe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:i}=e;if(!n||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=qw(e,VCe),c=i.map((u,d)=>{var f=Bo(Bo({},l),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return x.createElement(YG,{option:n,lineItemProps:f,key:"line-".concat(d)})});return x.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function eEe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:i,width:s,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var u=l.map(f=>Math.round(f+i-i)).sort((f,p)=>f-p);i!==u[0]&&u.unshift(0);var d=u.map((f,p)=>{var h=u[p+1],m=h==null,g=m?i+o-f:h-f;if(g<=0)return null;var y=p%t.length;return x.createElement("rect",{key:"react-".concat(p),y:f,x:n,height:g,width:s,stroke:"none",fill:t[y],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function tEe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:i,y:s,width:o,height:l,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+i-i)).sort((f,p)=>f-p);i!==u[0]&&u.unshift(0);var d=u.map((f,p)=>{var h=u[p+1],m=h==null,g=m?i+o-f:h-f;if(g<=0)return null;var y=p%r.length;return x.createElement("rect",{key:"react-".concat(p),x:f,y:s,width:g,height:l,stroke:"none",fill:r[y],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return x.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var rEe=(e,t)=>{var{xAxis:r,width:n,height:i,offset:s}=e;return Cq(y6(Bo(Bo(Bo({},qd),r),{},{ticks:Eq(r),viewBox:{x:0,y:0,width:n,height:i}})),s.left,s.left+s.width,t)},nEe=(e,t)=>{var{yAxis:r,width:n,height:i,offset:s}=e;return Cq(y6(Bo(Bo(Bo({},qd),r),{},{ticks:Eq(r),viewBox:{x:0,y:0,width:n,height:i}})),s.top,s.top+s.height,t)},iEe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Oa.grid};function Oy(e){var t=KC(),r=YC(),n=Iq(),i=Bo(Bo({},ka(e,iEe)),{},{x:An(e.x)?e.x:n.left,y:An(e.y)?e.y:n.top,width:An(e.width)?e.width:n.width,height:An(e.height)?e.height:n.height}),{xAxisId:s,yAxisId:o,x:l,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:p,verticalValues:h}=i,m=Rs(),g=Sn(M=>oR(M,"xAxis",s,m)),y=Sn(M=>oR(M,"yAxis",o,m));if(!id(u)||!id(d)||!An(l)||!An(c))return null;var b=i.verticalCoordinatesGenerator||rEe,v=i.horizontalCoordinatesGenerator||nEe,{horizontalPoints:w,verticalPoints:S}=i;if((!w||!w.length)&&typeof v=="function"){var j=p&&p.length,k=v({yAxis:y?Bo(Bo({},y),{},{ticks:j?p:y.ticks}):void 0,width:t??u,height:r??d,offset:n},j?!0:f);mw(Array.isArray(k),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof k,"]")),Array.isArray(k)&&(w=k)}if((!S||!S.length)&&typeof b=="function"){var A=h&&h.length,R=b({xAxis:g?Bo(Bo({},g),{},{ticks:A?h:g.ticks}):void 0,width:t??u,height:r??d,offset:n},A?!0:f);mw(Array.isArray(R),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof R,"]")),Array.isArray(R)&&(S=R)}return x.createElement(vo,{zIndex:i.zIndex},x.createElement("g",{className:"recharts-cartesian-grid"},x.createElement(QCe,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),x.createElement(eEe,e0({},i,{horizontalPoints:w})),x.createElement(tEe,e0({},i,{verticalPoints:S})),x.createElement(JCe,e0({},i,{offset:n,horizontalPoints:w,xAxis:g,yAxis:y})),x.createElement(ZCe,e0({},i,{offset:n,verticalPoints:S,xAxis:g,yAxis:y}))))}Oy.displayName="CartesianGrid";var aEe={},XG=Ll({name:"errorBars",initialState:aEe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:i}=t.payload;e[r]&&(e[r]=e[r].map(s=>s.dataKey===n.dataKey&&s.direction===n.direction?i:s))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),{addErrorBar:LMe,replaceErrorBar:RMe,removeErrorBar:FMe}=XG.actions,sEe=XG.reducer,oEe=["children"];function lEe(e,t){if(e==null)return{};var r,n,i=cEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function cEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uEe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},dEe=x.createContext(uEe);function v6(e){var{children:t}=e,r=lEe(e,oEe);return x.createElement(dEe.Provider,{value:r},t)}function Q_(e,t){var r,n,i=Sn(u=>dd(u,e)),s=Sn(u=>fd(u,t)),o=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:Ds.allowDataOverflow,l=(n=s==null?void 0:s.allowDataOverflow)!==null&&n!==void 0?n:$s.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function w6(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,i=x6(),{needClipX:s,needClipY:o,needClip:l}=Q_(t,r);if(!l||!i)return null;var{x:c,y:u,width:d,height:f}=i;return x.createElement("clipPath",{id:"clipPath-".concat(n)},x.createElement("rect",{x:s?c:c-d/2,y:o?u:u-f/2,width:s?d:d*2,height:o?f:f*2}))}var QG=(e,t,r,n)=>od(e,"xAxis",t,n),JG=(e,t,r,n)=>sd(e,"xAxis",t,n),ZG=(e,t,r,n)=>od(e,"yAxis",r,n),eK=(e,t,r,n)=>sd(e,"yAxis",r,n),fEe=Jt([Oi,QG,ZG,JG,eK],(e,t,r,n,i)=>hf(e,"xAxis")?qm(t,n,!1):qm(r,i,!1)),hEe=(e,t,r,n,i)=>i;function pEe(e){return e.type==="line"}var mEe=Jt([ky,hEe],(e,t)=>e.filter(pEe).find(r=>r.id===t)),gEe=Jt([Oi,QG,ZG,JG,eK,mEe,fEe,y_],(e,t,r,n,i,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=l;if(!(s==null||t==null||r==null||n==null||i==null||n.length===0||i.length===0||o==null||e!=="horizontal"&&e!=="vertical")){var{dataKey:f,data:p}=s,h;if(p!=null&&p.length>0?h=p:h=c==null?void 0:c.slice(u,d+1),h!=null)return o6e({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:i,dataKey:f,bandSize:o,displayedData:h})}});function xEe(e){var t=yh(e),r=3,n=2;if(t!=null){var{r:i,strokeWidth:s}=t,o=Number(i),l=Number(s);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(l)||l<0)&&(l=n),{r:o,strokeWidth:l}}return{r,strokeWidth:n}}var yEe={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var My=x;function bEe(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var vEe=typeof Object.is=="function"?Object.is:bEe,wEe=My.useSyncExternalStore,SEe=My.useRef,_Ee=My.useEffect,jEe=My.useMemo,kEe=My.useDebugValue;yEe.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var s=SEe(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=jEe(function(){function c(h){if(!u){if(u=!0,d=h,h=n(h),i!==void 0&&o.hasValue){var m=o.value;if(i(m,h))return f=m}return f=h}if(m=f,vEe(d,h))return m;var g=n(h);return i!==void 0&&i(m,g)?(d=h,m):(d=h,f=g)}var u=!1,d,f,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,i]);var l=wEe(e,s[0],s[1]);return _Ee(function(){o.hasValue=!0,o.value=l},[l]),kEe(l),l};function AEe(e){e()}function NEe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){AEe(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var dF={notify(){},get:()=>[]};function CEe(e,t){let r,n=dF,i=0,s=!1;function o(g){d();const y=n.subscribe(g);let b=!1;return()=>{b||(b=!0,y(),f())}}function l(){n.notify()}function c(){m.onStateChange&&m.onStateChange()}function u(){return s}function d(){i++,r||(r=e.subscribe(c),n=NEe())}function f(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=dF)}function p(){s||(s=!0,d())}function h(){s&&(s=!1,f())}const m={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:h,getListeners:()=>n};return m}var EEe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TEe=EEe(),PEe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",OEe=PEe(),MEe=()=>TEe||OEe?x.useLayoutEffect:x.useEffect,LEe=MEe();function fF(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function REe(e,t){if(fF(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(!Object.prototype.hasOwnProperty.call(t,r[i])||!fF(e[r[i]],t[r[i]]))return!1;return!0}var ck=Symbol.for("react-redux-context"),uk=typeof globalThis<"u"?globalThis:{};function FEe(){if(!x.createContext)return{};const e=uk[ck]??(uk[ck]=new Map);let t=e.get(x.createContext);return t||(t=x.createContext(null),e.set(x.createContext,t)),t}var BEe=FEe();function IEe(e){const{children:t,context:r,serverState:n,store:i}=e,s=x.useMemo(()=>{const c=CEe(i);return{store:i,subscription:c,getServerState:n?()=>n:void 0}},[i,n]),o=x.useMemo(()=>i.getState(),[i]);LEe(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==i.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=r||BEe;return x.createElement(l.Provider,{value:s},t)}var DEe=IEe,$Ee=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function UEe(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function Ly(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if($Ee.has(n)){if(e[n]==null&&t[n]==null)continue;if(!REe(e[n],t[n]))return!1}else if(!UEe(e[n],t[n]))return!1;return!0}var zEe=["id"],WEe=["type","layout","connectNulls","needClip","shape"],qEe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function U1(){return U1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U1.apply(null,arguments)}function hF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Hu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hF(Object(r),!0).forEach(function(n){HEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HEe(e,t,r){return(t=VEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VEe(e){var t=GEe(e,"string");return typeof t=="symbol"?t:t+""}function GEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function S6(e,t){if(e==null)return{};var r,n,i=KEe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function KEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var YEe=e=>{var{dataKey:t,name:r,stroke:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Ch(r,t),payload:e}]},XEe=x.memo(e=>{var{dataKey:t,data:r,stroke:n,strokeWidth:i,fill:s,name:o,hide:l,unit:c,tooltipType:u,id:d}=e,f={dataDefinedOnItem:r,getPosition:np,settings:{stroke:n,strokeWidth:i,fill:s,dataKey:t,nameKey:void 0,name:Ch(o,t),hide:l,type:u,color:n,unit:c,graphicalItemId:d}};return x.createElement(K_,{tooltipEntrySettings:f})}),tK=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function QEe(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],i=0;i<t;++i)n=[...n,...r];return n}var JEe=(e,t,r)=>{var n=r.reduce((h,m)=>h+m);if(!n)return tK(t,e);for(var i=Math.floor(e/n),s=e%n,o=t-e,l=[],c=0,u=0;c<r.length;u+=(d=r[c])!==null&&d!==void 0?d:0,++c){var d,f=r[c];if(f!=null&&u+f>s){l=[...r.slice(0,c),s-u];break}}var p=l.length%2===0?[0,o]:[o];return[...QEe(r,i),...l,...p].map(h=>"".concat(h,"px")).join(", ")};function ZEe(e){var{clipPathId:t,points:r,props:n}=e,{dot:i,dataKey:s,needClip:o}=n,{id:l}=n,c=S6(n,zEe),u=cl(c);return x.createElement(xNe,{points:r,dot:i,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:u,needClip:o,clipPathId:t})}function e6e(e){var{showLabels:t,children:r,points:n}=e,i=x.useMemo(()=>n==null?void 0:n.map(s=>{var o,l,c={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Hu(Hu({},c),{},{value:s.value,payload:s.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[n]);return x.createElement(c6,{value:t?i:void 0},r)}function pF(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:i,props:s}=e,{type:o,layout:l,connectNulls:c,needClip:u,shape:d}=s,f=S6(s,WEe),p=Hu(Hu({},Vo(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:o,layout:l,connectNulls:c,strokeDasharray:i??s.strokeDasharray});return x.createElement(x.Fragment,null,(n==null?void 0:n.length)>1&&x.createElement(D1,U1({shapeType:"curve",option:d},p,{pathRef:r})),x.createElement(ZEe,{points:n,clipPathId:t,props:s}))}function t6e(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function r6e(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:i,longestAnimatedLengthRef:s}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:p,width:h,height:m,onAnimationEnd:g,onAnimationStart:y}=r,b=i.current,v=gg(o,"recharts-line-"),w=x.useRef(v),[S,j]=x.useState(!1),k=!S,A=x.useCallback(()=>{typeof g=="function"&&g(),j(!1)},[g]),R=x.useCallback(()=>{typeof y=="function"&&y(),j(!0)},[y]),M=t6e(n.current),B=x.useRef(0);w.current!==v&&(B.current=s.current,w.current=v);var E=B.current;return x.createElement(e6e,{points:o,showLabels:k},r.children,x.createElement(mg,{animationId:v,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:A,onAnimationStart:R,key:v},P=>{var D=Xi(E,M+E,P),G=Math.min(D,M),H;if(c)if(l){var oe="".concat(l).split(/[,\s]+/gim).map(V=>parseFloat(V));H=JEe(G,M,oe)}else H=tK(M,G);else H=l==null?void 0:String(l);if(P>0&&M>0&&(i.current=o,s.current=Math.max(s.current,G)),b){var de=b.length/o.length,W=P===1?o:o.map((V,ae)=>{var ee=Math.floor(ae*de);if(b[ee]){var C=b[ee];return Hu(Hu({},V),{},{x:Xi(C.x,V.x,P),y:Xi(C.y,V.y,P)})}return p?Hu(Hu({},V),{},{x:Xi(h*2,V.x,P),y:Xi(m/2,V.y,P)}):Hu(Hu({},V),{},{x:V.x,y:V.y})});return i.current=W,x.createElement(pF,{props:r,points:W,clipPathId:t,pathRef:n,strokeDasharray:H})}return x.createElement(pF,{props:r,points:o,clipPathId:t,pathRef:n,strokeDasharray:H})}),x.createElement(P_,{label:r.label}))}function n6e(e){var{clipPathId:t,props:r}=e,n=x.useRef(null),i=x.useRef(0),s=x.useRef(null);return x.createElement(r6e,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:i,pathRef:s})}var i6e=(e,t)=>{var r,n;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(n=e.y)!==null&&n!==void 0?n:void 0,value:e.value,errorVal:Ti(e.payload,t)}};class a6e extends x.Component{render(){var{hide:t,dot:r,points:n,className:i,xAxisId:s,yAxisId:o,top:l,left:c,width:u,height:d,id:f,needClip:p,zIndex:h}=this.props;if(t)return null;var m=Si("recharts-line",i),g=f,{r:y,strokeWidth:b}=xEe(r),v=IG(r),w=y*2+b,S=p?"url(#clipPath-".concat(v?"":"dots-").concat(g,")"):void 0;return x.createElement(vo,{zIndex:h},x.createElement(ja,{className:m},p&&x.createElement("defs",null,x.createElement(w6,{clipPathId:g,xAxisId:s,yAxisId:o}),!v&&x.createElement("clipPath",{id:"clipPath-dots-".concat(g)},x.createElement("rect",{x:c-w/2,y:l-w/2,width:u+w,height:d+w}))),x.createElement(v6,{xAxisId:s,yAxisId:o,data:n,dataPointFormatter:i6e,errorBarOffset:0},x.createElement(n6e,{props:this.props,clipPathId:g}))),x.createElement($Ne,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:S}))}}var rK={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Oa.line,type:"linear"};function s6e(e){var t=ka(e,rK),{activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:s,animationEasing:o,connectNulls:l,dot:c,hide:u,isAnimationActive:d,label:f,legendType:p,xAxisId:h,yAxisId:m,id:g}=t,y=S6(t,qEe),{needClip:b}=Q_(h,m),v=x6(),w=ip(),S=Rs(),j=Sn(B=>gEe(B,h,m,S,g));if(w!=="horizontal"&&w!=="vertical"||j==null||v==null)return null;var{height:k,width:A,x:R,y:M}=v;return x.createElement(a6e,U1({},y,{id:g,connectNulls:l,dot:c,activeDot:r,animateNewValues:n,animationBegin:i,animationDuration:s,animationEasing:o,isAnimationActive:d,hide:u,label:f,legendType:p,xAxisId:h,yAxisId:m,points:j,layout:w,height:k,width:A,left:R,top:M,needClip:b}))}function o6e(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:s,dataKey:o,bandSize:l,displayedData:c}=e;return c.map((u,d)=>{var f=Ti(u,o);if(t==="horizontal"){var p=pw({axis:r,ticks:i,bandSize:l,entry:u,index:d}),h=Qi(f)?null:n.scale.map(f);return{x:p,y:h??null,value:f,payload:u}}var m=Qi(f)?null:r.scale.map(f),g=pw({axis:n,ticks:s,bandSize:l,entry:u,index:d});return m==null||g==null?null:{x:m,y:g,value:f,payload:u}}).filter(Boolean)}function l6e(e){var t=ka(e,rK),r=Rs();return x.createElement(Y_,{id:t.id,type:"line"},n=>x.createElement(x.Fragment,null,x.createElement(m6,{legendPayload:YEe(t)}),x.createElement(XEe,{dataKey:t.dataKey,data:t.data,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:n}),x.createElement(g6,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),x.createElement(s6e,U1({},t,{id:n}))))}var nK=x.memo(l6e,Ly);nK.displayName="Line";function lp(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:zG}function cp(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(i=>i.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:zG}var c6e="Invariant failed";function u6e(e,t){throw new Error(c6e)}function e3(){return e3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e3.apply(null,arguments)}function Hw(e){return x.createElement(D1,e3({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var d6e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,i)=>{if(An(t))return t;var s=An(n)||Qi(n);return s?t(n,i):(s||u6e(),r)}},f6e=(e,t,r)=>r,h6e=(e,t)=>t,Ry=Jt([ky,h6e],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),p6e=Jt([Ry],e=>e==null?void 0:e.maxBarSize),m6e=(e,t,r,n)=>n,g6e=Jt([Oi,ky,lp,cp,f6e],(e,t,r,n,i)=>t.filter(s=>e==="horizontal"?s.xAxisId===r:s.yAxisId===n).filter(s=>s.isPanorama===i).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),x6e=(e,t,r)=>{var n=Oi(e),i=lp(e,t),s=cp(e,t);if(!(i==null||s==null))return n==="horizontal"?VA(e,"yAxis",s,r):VA(e,"xAxis",i,r)},y6e=(e,t)=>{var r=Oi(e),n=lp(e,t),i=cp(e,t);if(!(n==null||i==null))return r==="horizontal"?sR(e,"xAxis",n):sR(e,"yAxis",i)},b6e=Jt([g6e,y5e,y6e],UNe),v6e=(e,t,r)=>{var n,i,s=Ry(e,t);if(s==null)return 0;var o=lp(e,t),l=cp(e,t);if(o==null||l==null)return 0;var c=Oi(e),u=tV(e),{maxBarSize:d}=s,f=Qi(d)?u:d,p,h;return c==="horizontal"?(p=od(e,"xAxis",o,r),h=sd(e,"xAxis",o,r)):(p=od(e,"yAxis",l,r),h=sd(e,"yAxis",l,r)),(n=(i=qm(p,h,!0))!==null&&i!==void 0?i:f)!==null&&n!==void 0?n:0},iK=(e,t,r)=>{var n=Oi(e),i=lp(e,t),s=cp(e,t);if(!(i==null||s==null)){var o,l;return n==="horizontal"?(o=od(e,"xAxis",i,r),l=sd(e,"xAxis",i,r)):(o=od(e,"yAxis",s,r),l=sd(e,"yAxis",s,r)),qm(o,l)}},w6e=Jt([b6e,tV,x5e,rV,v6e,iK,p6e],VNe),S6e=(e,t,r)=>{var n=lp(e,t);if(n!=null)return od(e,"xAxis",n,r)},_6e=(e,t,r)=>{var n=cp(e,t);if(n!=null)return od(e,"yAxis",n,r)},j6e=(e,t,r)=>{var n=lp(e,t);if(n!=null)return sd(e,"xAxis",n,r)},k6e=(e,t,r)=>{var n=cp(e,t);if(n!=null)return sd(e,"yAxis",n,r)},A6e=Jt([w6e,Ry],KNe),N6e=Jt([x6e,Ry],GNe),C6e=Jt([Ls,HC,S6e,_6e,j6e,k6e,A6e,Oi,c5e,iK,N6e,Ry,m6e],(e,t,r,n,i,s,o,l,c,u,d,f,p)=>{var{chartData:h,dataStartIndex:m,dataEndIndex:g}=c;if(!(f==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||n==null||i==null||s==null||u==null)){var{data:y}=f,b;if(y!=null&&y.length>0?b=y:b=h==null?void 0:h.slice(m,g+1),b!=null)return rTe({layout:l,barSettings:f,pos:o,parentViewBox:t,bandSize:u,xAxis:r,yAxis:n,xAxisTicks:i,yAxisTicks:s,stackedData:d,displayedData:b,offset:e,cells:p,dataStartIndex:m})}}),E6e=["index"];function t3(){return t3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},t3.apply(null,arguments)}function T6e(e,t){if(e==null)return{};var r,n,i=P6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function P6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var aK=x.createContext(void 0),O6e=e=>{var t=x.useContext(aK);if(t!=null)return t.stackId;if(e!=null)return dve(e)},M6e=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),L6e=e=>{var t=x.useContext(aK);if(t!=null){var{stackId:r}=t;return"url(#".concat(M6e(r,e),")")}},sK=e=>{var{index:t}=e,r=T6e(e,E6e),n=L6e(t);return x.createElement(ja,t3({className:"recharts-bar-stack-layer",clipPath:n},r))},R6e=["onMouseEnter","onMouseLeave","onClick"],F6e=["value","background","tooltipPosition"],B6e=["id"],I6e=["onMouseEnter","onClick","onMouseLeave"];function af(){return af=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},af.apply(null,arguments)}function mF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function rl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mF(Object(r),!0).forEach(function(n){D6e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function D6e(e,t,r){return(t=$6e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $6e(e){var t=U6e(e,"string");return typeof t=="symbol"?t:t+""}function U6e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vw(e,t){if(e==null)return{};var r,n,i=z6e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function z6e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var W6e=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Ch(r,t),payload:e}]},q6e=x.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:i,name:s,hide:o,unit:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:void 0,getPosition:np,settings:{stroke:r,strokeWidth:n,fill:i,dataKey:t,nameKey:void 0,name:Ch(s,t),hide:o,type:c,color:i,unit:l,graphicalItemId:u}};return x.createElement(K_,{tooltipEntrySettings:d})});function H6e(e){var t=Sn(nf),{data:r,dataKey:n,background:i,allOtherBarProps:s}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,u=Vw(s,R6e),d=H_(o,n,s.id),f=V_(l),p=G_(c,n,s.id);if(!i||r==null)return null;var h=yh(i);return x.createElement(vo,{zIndex:YNe(i,Oa.barBackground)},r.map((m,g)=>{var{value:y,background:b,tooltipPosition:v}=m,w=Vw(m,F6e);if(!b)return null;var S=d(m,g),j=f(m,g),k=p(m,g),A=rl(rl(rl(rl(rl({option:i,isActive:String(g)===t},w),{},{fill:"#eee"},b),h),hg(u,m,g)),{},{onMouseEnter:S,onMouseLeave:j,onClick:k,dataKey:n,index:g,className:"recharts-bar-background-rectangle"});return x.createElement(Hw,af({key:"background-bar-".concat(g)},A))}))}function V6e(e){var{showLabels:t,children:r,rects:n}=e,i=n==null?void 0:n.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return rl(rl({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return x.createElement(c6,{value:t?i:void 0},r)}function G6e(e){var{shape:t,activeBar:r,baseProps:n,entry:i,index:s,dataKey:o}=e,l=Sn(nf),c=Sn(n6),u=r&&String(s)===l&&(c==null||o===c),d=u?r:t;return u?x.createElement(vo,{zIndex:Oa.activeBar},x.createElement(sK,{index:s},x.createElement(Hw,af({},n,{name:String(n.name)},i,{isActive:u,option:d,index:s,dataKey:o})))):x.createElement(Hw,af({},n,{name:String(n.name)},i,{isActive:u,option:d,index:s,dataKey:o}))}function K6e(e){var{shape:t,baseProps:r,entry:n,index:i,dataKey:s}=e;return x.createElement(Hw,af({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:i,dataKey:s}))}function Y6e(e){var t,{data:r,props:n}=e,i=(t=cl(n))!==null&&t!==void 0?t:{},{id:s}=i,o=Vw(i,B6e),{shape:l,dataKey:c,activeBar:u}=n,{onMouseEnter:d,onClick:f,onMouseLeave:p}=n,h=Vw(n,I6e),m=H_(d,c,s),g=V_(p),y=G_(f,c,s);return r?x.createElement(x.Fragment,null,r.map((b,v)=>x.createElement(sK,af({index:v,key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(v),className:"recharts-bar-rectangle"},hg(h,b,v),{onMouseEnter:m(b,v),onMouseLeave:g(b,v),onClick:y(b,v)}),u?x.createElement(G6e,{shape:l,activeBar:u,baseProps:o,entry:b,index:v,dataKey:c}):x.createElement(K6e,{shape:l,baseProps:o,entry:b,index:v,dataKey:c})))):null}function X6e(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:d}=t,f=r.current,p=gg(t,"recharts-bar-"),[h,m]=x.useState(!1),g=!h,y=x.useCallback(()=>{typeof u=="function"&&u(),m(!1)},[u]),b=x.useCallback(()=>{typeof d=="function"&&d(),m(!0)},[d]);return x.createElement(V6e,{showLabels:g,rects:n},x.createElement(mg,{animationId:p,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:y,onAnimationStart:b,key:p},v=>{var w=v===1?n:n==null?void 0:n.map((S,j)=>{var k=f&&f[j];if(k)return rl(rl({},S),{},{x:Xi(k.x,S.x,v),y:Xi(k.y,S.y,v),width:Xi(k.width,S.width,v),height:Xi(k.height,S.height,v)});if(i==="horizontal"){var A=Xi(0,S.height,v),R=Xi(S.stackedBarStart,S.y,v);return rl(rl({},S),{},{y:R,height:A})}var M=Xi(0,S.width,v),B=Xi(S.stackedBarStart,S.x,v);return rl(rl({},S),{},{width:M,x:B})});return v>0&&(r.current=w??null),w==null?null:x.createElement(ja,null,x.createElement(Y6e,{props:t,data:w}))}),x.createElement(P_,{label:t.label}),t.children)}function Q6e(e){var t=x.useRef(null);return x.createElement(X6e,{previousRectanglesRef:t,props:e})}var oK=0,J6e=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Ti(e,t)}};class Z6e extends x.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:i,xAxisId:s,yAxisId:o,needClip:l,background:c,id:u}=this.props;if(t||r==null)return null;var d=Si("recharts-bar",i),f=u;return x.createElement(ja,{className:d,id:u},l&&x.createElement("defs",null,x.createElement(w6,{clipPathId:f,xAxisId:s,yAxisId:o})),x.createElement(ja,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},x.createElement(H6e,{data:r,dataKey:n,background:c,allOtherBarProps:this.props}),x.createElement(Q6e,this.props)))}}var eTe={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:oK,xAxisId:0,yAxisId:0,zIndex:Oa.bar};function tTe(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d}=e,{needClip:f}=Q_(t,r),p=ip(),h=Rs(),m=q_(e.children,op),g=Sn(v=>C6e(v,e.id,h,m));if(p!=="vertical"&&p!=="horizontal")return null;var y,b=g==null?void 0:g[0];return b==null||b.height==null||b.width==null?y=0:y=p==="vertical"?b.height/2:b.width/2,x.createElement(v6,{xAxisId:t,yAxisId:r,data:g,dataPointFormatter:J6e,errorBarOffset:y},x.createElement(Z6e,af({},e,{layout:p,needClip:f,data:g,xAxisId:t,yAxisId:r,hide:n,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:d})))}function rTe(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:i,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:d,displayedData:f,offset:p,cells:h,parentViewBox:m,dataStartIndex:g}=e,y=t==="horizontal"?l:o,b=d?y.scale.domain():null,v=fve({numericAxis:y}),w=y.scale.map(v);return f.map((S,j)=>{var k,A,R,M,B,E;if(d){var P=d[j+g];if(P==null)return null;k=sve(P,b)}else k=Ti(S,r),Array.isArray(k)||(k=[v,k]);var D=d6e(n,oK)(k[1],j);if(t==="horizontal"){var G,H=l.scale.map(k[0]),oe=l.scale.map(k[1]);if(H==null||oe==null)return null;A=hL({axis:o,ticks:c,bandSize:s,offset:i.offset,entry:S,index:j}),R=(G=oe??H)!==null&&G!==void 0?G:void 0,M=i.size;var de=H-oe;if(B=nd(de)?0:de,E={x:A,y:p.top,width:M,height:p.height},Math.abs(D)>0&&Math.abs(B)<Math.abs(D)){var W=Xs(B||D)*(Math.abs(D)-Math.abs(B));R-=W,B+=W}}else{var V=o.scale.map(k[0]),ae=o.scale.map(k[1]);if(V==null||ae==null)return null;if(A=V,R=hL({axis:l,ticks:u,bandSize:s,offset:i.offset,entry:S,index:j}),M=ae-V,B=i.size,E={x:p.left,y:R,width:p.width,height:B},Math.abs(D)>0&&Math.abs(M)<Math.abs(D)){var ee=Xs(M||D)*(Math.abs(D)-Math.abs(M));M+=ee}}if(A==null||R==null||M==null||B==null)return null;var C=rl(rl({},S),{},{stackedBarStart:w,x:A,y:R,width:M,height:B,value:d?k:k[1],payload:S,background:E,tooltipPosition:{x:A+M/2,y:R+B/2},parentViewBox:m},h&&h[j]&&h[j].props);return C}).filter(Boolean)}function nTe(e){var t=ka(e,eTe),r=O6e(t.stackId),n=Rs();return x.createElement(Y_,{id:t.id,type:"bar"},i=>x.createElement(x.Fragment,null,x.createElement(m6,{legendPayload:W6e(t)}),x.createElement(q6e,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:i}),x.createElement(g6,{type:"bar",id:i,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),x.createElement(vo,{zIndex:t.zIndex},x.createElement(tTe,af({},t,{id:i})))))}var Ux=x.memo(nTe,Ly);Ux.displayName="Bar";var iTe=["option","isActive"];function zx(){return zx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zx.apply(null,arguments)}function aTe(e,t){if(e==null)return{};var r,n,i=sTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function sTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function oTe(e){var{option:t,isActive:r}=e,n=aTe(e,iTe);return typeof t=="string"?x.createElement(D1,zx({option:x.createElement(zS,zx({type:t},n)),isActive:r,shapeType:"symbols"},n)):x.createElement(D1,zx({option:t,isActive:r,shapeType:"symbols"},n))}var lTe=(e,t,r,n,i,s,o)=>od(e,"xAxis",t,o),cTe=(e,t,r,n,i,s,o)=>sd(e,"xAxis",t,o),uTe=(e,t,r,n,i,s,o)=>od(e,"yAxis",r,o),dTe=(e,t,r,n,i,s,o)=>sd(e,"yAxis",r,o),fTe=(e,t,r,n)=>_je(e,"zAxis",n,!1),hTe=(e,t,r,n,i)=>i,pTe=(e,t,r,n,i,s)=>s,mTe=(e,t,r,n,i,s,o)=>y_(e,void 0,void 0,o),gTe=Jt([ky,hTe],(e,t)=>e.filter(r=>r.type==="scatter").find(r=>r.id===t)),xTe=Jt([mTe,lTe,cTe,uTe,dTe,fTe,gTe,pTe],(e,t,r,n,i,s,o,l)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=e;if(o!=null){var f;if((o==null?void 0:o.data)!=null&&o.data.length>0?f=o.data:f=c==null?void 0:c.slice(u,d+1),!(f==null||t==null||n==null||r==null||i==null||(r==null?void 0:r.length)===0||(i==null?void 0:i.length)===0))return PTe({displayedData:f,xAxis:t,yAxis:n,zAxis:s,scatterSettings:o,xAxisTicks:r,yAxisTicks:i,cells:l})}}),yTe=["id"],bTe=["onMouseEnter","onClick","onMouseLeave"],vTe=["animationBegin","animationDuration","animationEasing","hide","isAnimationActive","legendType","lineJointType","lineType","shape","xAxisId","yAxisId","zAxisId"];function r3(e,t){if(e==null)return{};var r,n,i=wTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function wTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I0.apply(null,arguments)}function gF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function kl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gF(Object(r),!0).forEach(function(n){STe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function STe(e,t,r){return(t=_Te(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Te(e){var t=jTe(e,"string");return typeof t=="symbol"?t:t+""}function jTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var kTe=e=>{var{dataKey:t,name:r,fill:n,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:n,value:Ch(r,t),payload:e}]},ATe=x.memo(e=>{var{dataKey:t,points:r,stroke:n,strokeWidth:i,fill:s,name:o,hide:l,tooltipType:c,id:u}=e,d={dataDefinedOnItem:r==null?void 0:r.map(f=>f.tooltipPayload),getPosition:f=>{var p;return r==null||(p=r[Number(f)])===null||p===void 0?void 0:p.tooltipPosition},settings:{stroke:n,strokeWidth:i,fill:s,nameKey:void 0,dataKey:t,name:Ch(o,t),hide:l,type:c,color:s,unit:"",graphicalItemId:u}};return x.createElement(K_,{tooltipEntrySettings:d})});function NTe(e){var{points:t,props:r}=e,{line:n,lineType:i,lineJointType:s}=r;if(!n)return null;var o=cl(r),l=yh(n),c,u;if(i==="joint")c=t.map(y=>{var b,v;return{x:(b=y.cx)!==null&&b!==void 0?b:null,y:(v=y.cy)!==null&&v!==void 0?v:null}});else if(i==="fitting"){var{xmin:d,xmax:f,a:p,b:h}=G1e(t),m=y=>p*y+h;c=[{x:d,y:m(d)},{x:f,y:m(f)}]}var g=kl(kl(kl({},o),{},{fill:"none",stroke:o&&o.fill},l),{},{points:c});return x.isValidElement(n)?u=x.cloneElement(n,g):typeof n=="function"?u=n(g):u=x.createElement(c_,I0({},g,{type:s})),x.createElement(ja,{className:"recharts-scatter-line",key:"recharts-scatter-line"},u)}function CTe(e){var{showLabels:t,points:r,children:n}=e,i=pg(),s=x.useMemo(()=>r==null?void 0:r.map(o=>{var l,c,u={x:(l=o.x)!==null&&l!==void 0?l:0,y:(c=o.y)!==null&&c!==void 0?c:0,width:o.width,height:o.height,lowerWidth:o.width,upperWidth:o.width};return kl(kl({},u),{},{value:void 0,payload:o.payload,viewBox:u,parentViewBox:i,fill:void 0})}),[i,r]);return x.createElement(c6,{value:t?s:void 0},n)}function ETe(e){var{points:t,allOtherScatterProps:r}=e,{shape:n,activeShape:i,dataKey:s}=r,{id:o}=r,l=r3(r,yTe),c=Sn(nf),{onMouseEnter:u,onClick:d,onMouseLeave:f}=r,p=r3(r,bTe),h=H_(u,s,o),m=V_(f),g=G_(d,s,o);if(!aye(t))return null;var y=cl(l);return x.createElement(x.Fragment,null,x.createElement(NTe,{points:t,props:l}),t.map((b,v)=>{var w=i!=null&&i!==!1,S=w&&c===String(v),j=w&&S?i:n,k=kl(kl(kl({},y),b),{},{index:v,[qC]:String(o)});return x.createElement(vo,{key:"symbol-".concat(b==null?void 0:b.cx,"-").concat(b==null?void 0:b.cy,"-").concat(b==null?void 0:b.size,"-").concat(v),zIndex:S?Oa.activeDot:void 0},x.createElement(ja,I0({className:"recharts-scatter-symbol"},hg(p,b,v),{onMouseEnter:h(b,v),onMouseLeave:m(b,v),onClick:g(b,v)}),x.createElement(oTe,I0({option:j,isActive:S},k))))}))}function TTe(e){var{previousPointsRef:t,props:r}=e,{points:n,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:l}=r,c=t.current,u=gg(r,"recharts-scatter-"),[d,f]=x.useState(!1),p=x.useCallback(()=>{f(!1)},[]),h=x.useCallback(()=>{f(!0)},[]),m=!d;return x.createElement(CTe,{showLabels:m,points:n},r.children,x.createElement(mg,{animationId:u,begin:s,duration:o,isActive:i,easing:l,onAnimationEnd:p,onAnimationStart:h,key:u},g=>{var y=g===1?n:n==null?void 0:n.map((b,v)=>{var w=c&&c[v];return w?kl(kl({},b),{},{cx:b.cx==null?void 0:Xi(w.cx,b.cx,g),cy:b.cy==null?void 0:Xi(w.cy,b.cy,g),size:Xi(w.size,b.size,g)}):kl(kl({},b),{},{size:Xi(0,b.size,g)})});return g>0&&(t.current=y),x.createElement(ja,null,x.createElement(ETe,{points:y,allOtherScatterProps:r,showLabels:m}))}),x.createElement(P_,{label:r.label}))}function PTe(e){var{displayedData:t,xAxis:r,yAxis:n,zAxis:i,scatterSettings:s,xAxisTicks:o,yAxisTicks:l,cells:c}=e,u=Qi(r.dataKey)?s.dataKey:r.dataKey,d=Qi(n.dataKey)?s.dataKey:n.dataKey,f=i&&i.dataKey,p=i?i.range:Bd.range,h=p&&p[0],m=r.scale.bandwidth?r.scale.bandwidth():0,g=n.scale.bandwidth?n.scale.bandwidth():0;return t.map((y,b)=>{var v=Ti(y,u),w=Ti(y,d),S=!Qi(f)&&Ti(y,f)||"-",j=[{name:Qi(r.dataKey)?s.name:r.name||String(r.dataKey),unit:r.unit||"",value:v,payload:y,dataKey:u,type:s.tooltipType},{name:Qi(n.dataKey)?s.name:n.name||String(n.dataKey),unit:n.unit||"",value:w,payload:y,dataKey:d,type:s.tooltipType}];S!=="-"&&i!=null&&j.push({name:i.name||i.dataKey,unit:i.unit||"",value:S,payload:y,dataKey:f,type:s.tooltipType});var k=pw({axis:r,ticks:o,bandSize:m,entry:y,index:b,dataKey:u}),A=pw({axis:n,ticks:l,bandSize:g,entry:y,index:b,dataKey:d}),R=S!=="-"&&i!=null?i.scale.map(S):h,M=R==null?0:Math.sqrt(Math.max(R,0)/Math.PI);return kl(kl({},y),{},{cx:k,cy:A,x:k==null?void 0:k-M,y:A==null?void 0:A-M,width:2*M,height:2*M,size:R,node:{x:v,y:w,z:S},tooltipPayload:j,tooltipPosition:{x:k,y:A},payload:y},c&&c[b]&&c[b].props)})}var OTe=(e,t,r)=>({x:e.cx,y:e.cy,value:Number(r==="x"?e.node.x:e.node.y),errorVal:Ti(e,t)});function MTe(e){var{hide:t,points:r,className:n,needClip:i,xAxisId:s,yAxisId:o,id:l}=e,c=x.useRef(null);if(t)return null;var u=Si("recharts-scatter",n),d=l;return x.createElement(vo,{zIndex:e.zIndex},x.createElement(ja,{className:u,clipPath:i?"url(#clipPath-".concat(d,")"):void 0,id:l},i&&x.createElement("defs",null,x.createElement(w6,{clipPathId:d,xAxisId:s,yAxisId:o})),x.createElement(v6,{xAxisId:s,yAxisId:o,data:r,dataPointFormatter:OTe,errorBarOffset:0},x.createElement(ja,{key:"recharts-scatter-symbols"},x.createElement(TTe,{props:e,previousPointsRef:c})))))}var lK={xAxisId:0,yAxisId:0,zAxisId:0,label:!1,line:!1,legendType:"circle",lineType:"joint",lineJointType:"linear",shape:"circle",hide:!1,isAnimationActive:"auto",animationBegin:0,animationDuration:400,animationEasing:"linear",zIndex:Oa.scatter};function LTe(e){var t=ka(e,lK),{animationBegin:r,animationDuration:n,animationEasing:i,hide:s,isAnimationActive:o,legendType:l,lineJointType:c,lineType:u,shape:d,xAxisId:f,yAxisId:p,zAxisId:h}=t,m=r3(t,vTe),{needClip:g}=Q_(f,p),y=x.useMemo(()=>q_(e.children,op),[e.children]),b=Rs(),v=Sn(w=>xTe(w,f,p,h,e.id,y,b));return g==null||v==null?null:x.createElement(x.Fragment,null,x.createElement(ATe,{dataKey:e.dataKey,points:v,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:e.id}),x.createElement(MTe,I0({},m,{xAxisId:f,yAxisId:p,zAxisId:h,lineType:u,lineJointType:c,legendType:l,shape:d,hide:s,isAnimationActive:o,animationBegin:r,animationDuration:n,animationEasing:i,points:v,needClip:g})))}function RTe(e){var t=ka(e,lK),r=Rs();return x.createElement(Y_,{id:t.id,type:"scatter"},n=>x.createElement(x.Fragment,null,x.createElement(m6,{legendPayload:kTe(t)}),x.createElement(g6,{type:"scatter",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:t.zAxisId,dataKey:t.dataKey,hide:t.hide,name:t.name,tooltipType:t.tooltipType,isPanorama:r}),x.createElement(LTe,I0({},t,{id:n}))))}var cK=x.memo(RTe,Ly);cK.displayName="Scatter";var FTe=["domain","range"],BTe=["domain","range"];function xF(e,t){if(e==null)return{};var r,n,i=ITe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ITe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yF(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function uK(e,t){if(e===t)return!0;var{domain:r,range:n}=e,i=xF(e,FTe),{domain:s,range:o}=t,l=xF(t,BTe);return!yF(r,s)||!yF(n,o)?!1:Ly(i,l)}var DTe=["type"],$Te=["dangerouslySetInnerHTML","ticks","scale"],UTe=["id","scale"];function n3(){return n3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n3.apply(null,arguments)}function bF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bF(Object(r),!0).forEach(function(n){zTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zTe(e,t,r){return(t=WTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WTe(e){var t=qTe(e,"string");return typeof t=="symbol"?t:t+""}function qTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function i3(e,t){if(e==null)return{};var r,n,i=HTe(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function HTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function VTe(e){var t=Zi(),r=x.useRef(null),n=Dq(),{type:i}=e,s=i3(e,DTe),o=v_(n,"xAxis",i),l=x.useMemo(()=>{if(o!=null)return vF(vF({},s),{},{type:o})},[s,o]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(SNe(l)):r.current!==l&&t(_Ne({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(jNe(r.current)),r.current=null)},[t]),null}var GTe=e=>{var{xAxisId:t,className:r}=e,n=Sn(HC),i=Rs(),s="xAxis",o=Sn(b=>RV(b,s,t,i)),l=Sn(b=>PV(b,t)),c=Sn(b=>xje(b,t)),u=Sn(b=>fV(b,t));if(l==null||c==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f,scale:p}=e,h=i3(e,$Te),{id:m,scale:g}=u,y=i3(u,UTe);return x.createElement(b6,n3({},h,y,{x:c.x,y:c.y,width:l.width,height:l.height,className:Si("recharts-".concat(s," ").concat(s),r),viewBox:n,ticks:o,axisType:s}))},KTe={allowDataOverflow:Ds.allowDataOverflow,allowDecimals:Ds.allowDecimals,allowDuplicatedCategory:Ds.allowDuplicatedCategory,angle:Ds.angle,axisLine:qd.axisLine,height:Ds.height,hide:!1,includeHidden:Ds.includeHidden,interval:Ds.interval,label:!1,minTickGap:Ds.minTickGap,mirror:Ds.mirror,orientation:Ds.orientation,padding:Ds.padding,reversed:Ds.reversed,scale:Ds.scale,tick:Ds.tick,tickCount:Ds.tickCount,tickLine:qd.tickLine,tickSize:qd.tickSize,type:Ds.type,xAxisId:0},YTe=e=>{var t=ka(e,KTe);return x.createElement(x.Fragment,null,x.createElement(VTe,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),x.createElement(GTe,t))},Fy=x.memo(YTe,uK);Fy.displayName="XAxis";var XTe=["type"],QTe=["dangerouslySetInnerHTML","ticks","scale"],JTe=["id","scale"];function a3(){return a3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a3.apply(null,arguments)}function wF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function SF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wF(Object(r),!0).forEach(function(n){ZTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZTe(e,t,r){return(t=e8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e8e(e){var t=t8e(e,"string");return typeof t=="symbol"?t:t+""}function t8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function s3(e,t){if(e==null)return{};var r,n,i=r8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function r8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function n8e(e){var t=Zi(),r=x.useRef(null),n=Dq(),{type:i}=e,s=s3(e,XTe),o=v_(n,"yAxis",i),l=x.useMemo(()=>{if(o!=null)return SF(SF({},s),{},{type:o})},[o,s]);return x.useLayoutEffect(()=>{l!=null&&(r.current===null?t(kNe(l)):r.current!==l&&t(ANe({prev:r.current,next:l})),r.current=l)},[l,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(NNe(r.current)),r.current=null)},[t]),null}function i8e(e){var{yAxisId:t,className:r,width:n,label:i}=e,s=x.useRef(null),o=x.useRef(null),l=Sn(HC),c=Rs(),u=Zi(),d="yAxis",f=Sn(k=>OV(k,t)),p=Sn(k=>bje(k,t)),h=Sn(k=>RV(k,d,t,c)),m=Sn(k=>hV(k,t));if(x.useLayoutEffect(()=>{if(!(n!=="auto"||!f||l6(i)||x.isValidElement(i)||m==null)){var k=s.current;if(k){var A=k.getCalculatedWidth();Math.round(f.width)!==Math.round(A)&&u(PNe({id:t,width:A}))}}},[h,f,u,i,t,n,m]),f==null||p==null||m==null)return null;var{dangerouslySetInnerHTML:g,ticks:y,scale:b}=e,v=s3(e,QTe),{id:w,scale:S}=m,j=s3(m,JTe);return x.createElement(b6,a3({},v,j,{ref:s,labelRef:o,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:f.width,height:f.height,className:Si("recharts-".concat(d," ").concat(d),r),viewBox:l,ticks:h,axisType:d}))}var a8e={allowDataOverflow:$s.allowDataOverflow,allowDecimals:$s.allowDecimals,allowDuplicatedCategory:$s.allowDuplicatedCategory,angle:$s.angle,axisLine:qd.axisLine,hide:!1,includeHidden:$s.includeHidden,interval:$s.interval,label:!1,minTickGap:$s.minTickGap,mirror:$s.mirror,orientation:$s.orientation,padding:$s.padding,reversed:$s.reversed,scale:$s.scale,tick:$s.tick,tickCount:$s.tickCount,tickLine:qd.tickLine,tickSize:qd.tickSize,type:$s.type,width:$s.width,yAxisId:0},s8e=e=>{var t=ka(e,a8e);return x.createElement(x.Fragment,null,x.createElement(n8e,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),x.createElement(i8e,t))},By=x.memo(s8e,uK);By.displayName="YAxis";function o8e(e){var t=Zi(),r=x.useRef(null);return x.useLayoutEffect(()=>{r.current===null?t(CNe(e)):r.current!==e&&t(ENe({prev:r.current,next:e})),r.current=e},[e,t]),x.useLayoutEffect(()=>()=>{r.current&&(t(TNe(r.current)),r.current=null)},[t]),null}var l8e={zAxisId:0,range:Bd.range,scale:Bd.scale,type:Bd.type};function dK(e){var t=ka(e,l8e);return x.createElement(o8e,{domain:t.domain,id:t.zAxisId,dataKey:t.dataKey,name:t.name,unit:t.unit,range:t.range,scale:t.scale,type:t.type,allowDuplicatedCategory:Bd.allowDuplicatedCategory,allowDataOverflow:Bd.allowDataOverflow,reversed:Bd.reversed,includeHidden:Bd.includeHidden})}dK.displayName="ZAxis";var c8e=(e,t)=>t,_6=Jt([c8e,Oi,cV,Zs,JV,yf,Fke,Ls],Wke),j6=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},fK=Vc("mouseClick"),hK=py();hK.startListening({actionCreator:fK,effect:(e,t)=>{var r=e.payload,n=_6(t.getState(),j6(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(Lje({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var o3=Vc("mouseMove"),pK=py(),hv=null;pK.startListening({actionCreator:o3,effect:(e,t)=>{var r=e.payload;hv!==null&&cancelAnimationFrame(hv);var n=j6(r);hv=requestAnimationFrame(()=>{var i=t.getState(),s=QE(i,i.tooltip.settings.shared);if(s==="axis"){var o=_6(i,n);(o==null?void 0:o.activeIndex)!=null?t.dispatch(WV({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):t.dispatch(zV())}hv=null})}});function u8e(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var _F={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},mK=Ll({name:"rootProps",initialState:_F,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:_F.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),d8e=mK.reducer,{updateOptions:f8e}=mK.actions,h8e=null,p8e={updatePolarOptions:(e,t)=>t.payload},gK=Ll({name:"polarOptions",initialState:h8e,reducers:p8e}),{updatePolarOptions:m8e}=gK.actions,g8e=gK.reducer,xK=Vc("keyDown"),yK=Vc("focus"),k6=py();k6.startListening({actionCreator:xK,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=JE(i,kg(r),Ny(r),Ey(r)),l=o==null?-1:Number(o);if(!(!Number.isFinite(l)||l<0)){var c=yf(r);if(s==="Enter"){var u=Iw(r,"axis","hover",String(i.index));t.dispatch(KA({active:!i.active,activeIndex:i.index,activeCoordinate:u}));return}var d=jje(r),f=d==="left-to-right"?1:-1,p=s==="ArrowRight"?1:-1,h=l+p*f;if(!(c==null||h>=c.length||h<0)){var m=Iw(r,"axis","hover",String(h));t.dispatch(KA({active:!0,activeIndex:h.toString(),activeCoordinate:m}))}}}}}});k6.startListening({actionCreator:yK,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var s="0",o=Iw(r,"axis","hover",String(s));t.dispatch(KA({active:!0,activeIndex:s,activeCoordinate:o}))}}}});var Ec=Vc("externalEvent"),bK=py(),dk=new Map;bK.startListening({actionCreator:Ec,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var i=n.type,s=dk.get(i);s!==void 0&&cancelAnimationFrame(s);var o=requestAnimationFrame(()=>{try{var l=t.getState(),c={activeCoordinate:vke(l),activeDataKey:n6(l),activeIndex:nf(l),activeLabel:tG(l),activeTooltipIndex:nf(l),isTooltipActive:wke(l)};r(c,n)}finally{dk.delete(i)}});dk.set(i,o)}}});var x8e=Jt([_g],e=>e.tooltipItemPayloads),y8e=Jt([x8e,(e,t)=>t,(e,t,r)=>r],(e,t,r)=>{if(t!=null){var n=e.find(s=>s.settings.graphicalItemId===r);if(n!=null){var{getPosition:i}=n;if(i!=null)return i(t)}}}),vK=Vc("touchMove"),wK=py();wK.startListening({actionCreator:vK,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),i=QE(n,n.tooltip.settings.shared);if(i==="axis"){var s=r.touches[0];if(s==null)return;var o=_6(n,j6({clientX:s.clientX,clientY:s.clientY,currentTarget:r.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&t.dispatch(WV({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(i==="item"){var l,c=r.touches[0];if(document.elementFromPoint==null||c==null)return;var u=document.elementFromPoint(c.clientX,c.clientY);if(!u||!u.getAttribute)return;var d=u.getAttribute(Pq),f=(l=u.getAttribute(qC))!==null&&l!==void 0?l:void 0,p=jg(n).find(g=>g.id===f);if(d==null||p==null||f==null)return;var{dataKey:h}=p,m=y8e(n,d,f);t.dispatch(UV({activeDataKey:h,activeIndex:d,activeCoordinate:m,activeGraphicalItemId:f}))}}}});var b8e=ZW({brush:XNe,cartesianAxis:ONe,chartData:b4e,errorBars:sEe,graphicalItems:F3e,layout:tve,legend:i2e,options:p4e,polarAxis:YAe,polarOptions:g8e,referenceElements:iCe,rootProps:d8e,tooltip:Rje,zIndex:n4e}),v8e=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return Abe({reducer:b8e,preloadedState:t,middleware:n=>{var i;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((i="es6")!==null&&i!==void 0?i:"")}).concat([hK.middleware,pK.middleware,k6.middleware,bK.middleware,wK.middleware])},enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(pq({type:"raf"}))},devTools:{serialize:{replacer:u8e},name:"recharts-".concat(r)}})};function SK(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,i=Rs(),s=x.useRef(null);if(i)return r;s.current==null&&(s.current=v8e(t,n));var o=RC;return x.createElement(DEe,{context:o,store:s.current},r)}function w8e(e){var{layout:t,margin:r}=e,n=Zi(),i=Rs();return x.useEffect(()=>{i||(n(Jbe(t)),n(Qbe(r)))},[n,i,t,r]),null}var _K=x.memo(w8e,Ly);function jK(e){var t=Zi();return x.useEffect(()=>{t(f8e(e))},[t,e]),null}function jF(e){var{zIndex:t,isPanorama:r}=e,n=x.useRef(null),i=Zi();return x.useLayoutEffect(()=>(n.current&&i(t4e({zIndex:t,element:n.current,isPanorama:r})),()=>{i(r4e({zIndex:t,isPanorama:r}))}),[i,t,r]),x.createElement("g",{tabIndex:-1,ref:n})}function kF(e){var{children:t,isPanorama:r}=e,n=Sn(Hke);if(!n||n.length===0)return t;var i=n.filter(o=>o<0),s=n.filter(o=>o>0);return x.createElement(x.Fragment,null,i.map(o=>x.createElement(jF,{key:o,zIndex:o,isPanorama:r})),t,s.map(o=>x.createElement(jF,{key:o,zIndex:o,isPanorama:r})))}var S8e=["children"];function _8e(e,t){if(e==null)return{};var r,n,i=j8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function j8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Gw(){return Gw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gw.apply(null,arguments)}var k8e={width:"100%",height:"100%",display:"block"},A8e=x.forwardRef((e,t)=>{var r=KC(),n=YC(),i=Qq();if(!id(r)||!id(n))return null;var{children:s,otherAttributes:o,title:l,desc:c}=e,u,d;return o!=null&&(typeof o.tabIndex=="number"?u=o.tabIndex:u=i?0:void 0,typeof o.role=="string"?d=o.role:d=i?"application":void 0),x.createElement(wC,Gw({},o,{title:l,desc:c,role:d,tabIndex:u,width:r,height:n,style:k8e,ref:t}),s)}),N8e=e=>{var{children:t}=e,r=Sn(a_);if(!r)return null;var{width:n,height:i,y:s,x:o}=r;return x.createElement(wC,{width:n,height:i,x:o,y:s},t)},AF=x.forwardRef((e,t)=>{var{children:r}=e,n=_8e(e,S8e),i=Rs();return i?x.createElement(N8e,null,x.createElement(kF,{isPanorama:!0},r)):x.createElement(A8e,Gw({ref:t},n),x.createElement(kF,{isPanorama:!1},r))});function C8e(){var e=Zi(),[t,r]=x.useState(null),n=Sn(yve);return x.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),s=i.width/t.offsetWidth;fi(s)&&s!==n&&e(eve(s))}},[t,e,n]),r}function NF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function E8e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NF(Object(r),!0).forEach(function(n){T8e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T8e(e,t,r){return(t=P8e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P8e(e){var t=O8e(e,"string");return typeof t=="symbol"?t:t+""}function O8e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lh(){return lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lh.apply(null,arguments)}var M8e=()=>(C4e(),null);function Kw(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var L8e=x.forwardRef((e,t)=>{var r,n,i=x.useRef(null),[s,o]=x.useState({containerWidth:Kw((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Kw((n=e.style)===null||n===void 0?void 0:n.height)}),l=x.useCallback((u,d)=>{o(f=>{var p=Math.round(u),h=Math.round(d);return f.containerWidth===p&&f.containerHeight===h?f:{containerWidth:p,containerHeight:h}})},[]),c=x.useCallback(u=>{if(typeof t=="function"&&t(u),u!=null&&typeof ResizeObserver<"u"){var{width:d,height:f}=u.getBoundingClientRect();l(d,f);var p=m=>{var g=m[0];if(g!=null){var{width:y,height:b}=g.contentRect;l(y,b)}},h=new ResizeObserver(p);h.observe(u),i.current=h}},[t,l]);return x.useEffect(()=>()=>{var u=i.current;u!=null&&u.disconnect()},[l]),x.createElement(x.Fragment,null,x.createElement(xy,{width:s.containerWidth,height:s.containerHeight}),x.createElement("div",lh({ref:c},e)))}),R8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e,[i,s]=x.useState({containerWidth:Kw(r),containerHeight:Kw(n)}),o=x.useCallback((c,u)=>{s(d=>{var f=Math.round(c),p=Math.round(u);return d.containerWidth===f&&d.containerHeight===p?d:{containerWidth:f,containerHeight:p}})},[]),l=x.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:u,height:d}=c.getBoundingClientRect();o(u,d)}},[t,o]);return x.createElement(x.Fragment,null,x.createElement(xy,{width:i.containerWidth,height:i.containerHeight}),x.createElement("div",lh({ref:l},e)))}),F8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return x.createElement(x.Fragment,null,x.createElement(xy,{width:r,height:n}),x.createElement("div",lh({ref:t},e)))}),B8e=x.forwardRef((e,t)=>{var{width:r,height:n}=e;return typeof r=="string"||typeof n=="string"?x.createElement(R8e,lh({},e,{ref:t})):typeof r=="number"&&typeof n=="number"?x.createElement(F8e,lh({},e,{width:r,height:n,ref:t})):x.createElement(x.Fragment,null,x.createElement(xy,{width:r,height:n}),x.createElement("div",lh({ref:t},e)))});function I8e(e){return e?L8e:B8e}var D8e=x.forwardRef((e,t)=>{var{children:r,className:n,height:i,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:p,onTouchEnd:h,onTouchMove:m,onTouchStart:g,style:y,width:b,responsive:v,dispatchTouchEvents:w=!0}=e,S=x.useRef(null),j=Zi(),[k,A]=x.useState(null),[R,M]=x.useState(null),B=C8e(),E=VC(),P=(E==null?void 0:E.width)>0?E.width:b,D=(E==null?void 0:E.height)>0?E.height:i,G=x.useCallback(K=>{B(K),typeof t=="function"&&t(K),A(K),M(K),K!=null&&(S.current=K)},[B,t,A,M]),H=x.useCallback(K=>{j(fK(K)),j(Ec({handler:s,reactEvent:K}))},[j,s]),oe=x.useCallback(K=>{j(o3(K)),j(Ec({handler:u,reactEvent:K}))},[j,u]),de=x.useCallback(K=>{j(zV()),j(Ec({handler:d,reactEvent:K}))},[j,d]),W=x.useCallback(K=>{j(o3(K)),j(Ec({handler:f,reactEvent:K}))},[j,f]),V=x.useCallback(()=>{j(yK())},[j]),ae=x.useCallback(K=>{j(xK(K.key))},[j]),ee=x.useCallback(K=>{j(Ec({handler:o,reactEvent:K}))},[j,o]),C=x.useCallback(K=>{j(Ec({handler:l,reactEvent:K}))},[j,l]),Y=x.useCallback(K=>{j(Ec({handler:c,reactEvent:K}))},[j,c]),q=x.useCallback(K=>{j(Ec({handler:p,reactEvent:K}))},[j,p]),O=x.useCallback(K=>{j(Ec({handler:g,reactEvent:K}))},[j,g]),X=x.useCallback(K=>{w&&j(vK(K)),j(Ec({handler:m,reactEvent:K}))},[j,w,m]),F=x.useCallback(K=>{j(Ec({handler:h,reactEvent:K}))},[j,h]),Q=I8e(v);return x.createElement(lG.Provider,{value:k},x.createElement(Jz.Provider,{value:R},x.createElement(Q,{width:P??(y==null?void 0:y.width),height:D??(y==null?void 0:y.height),className:Si("recharts-wrapper",n),style:E8e({position:"relative",cursor:"default",width:P,height:D},y),onClick:H,onContextMenu:ee,onDoubleClick:C,onFocus:V,onKeyDown:ae,onMouseDown:Y,onMouseEnter:oe,onMouseLeave:de,onMouseMove:W,onMouseUp:q,onTouchEnd:F,onTouchMove:X,onTouchStart:O,ref:G},x.createElement(M8e,null),r)))}),$8e=["width","height","responsive","children","className","style","compact","title","desc"];function U8e(e,t){if(e==null)return{};var r,n,i=z8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function z8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var kK=x.forwardRef((e,t)=>{var{width:r,height:n,responsive:i,children:s,className:o,style:l,compact:c,title:u,desc:d}=e,f=U8e(e,$8e),p=cl(f);return c?x.createElement(x.Fragment,null,x.createElement(xy,{width:r,height:n}),x.createElement(AF,{otherAttributes:p,title:u,desc:d},s)):x.createElement(D8e,{className:o,style:l,width:r,height:n,responsive:i??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},x.createElement(AF,{otherAttributes:p,title:u,desc:d,ref:t},x.createElement(aCe,null,s)))});function l3(){return l3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l3.apply(null,arguments)}var W8e={top:5,right:5,bottom:5,left:5},q8e={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:W8e,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},A6=x.forwardRef(function(t,r){var n,i=ka(t.categoricalChartProps,q8e),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:u}=t,d={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return x.createElement(SK,{preloadedState:{options:d},reduxStoreName:(n=u.id)!==null&&n!==void 0?n:s},x.createElement(qG,{chartData:u.data}),x.createElement(_K,{layout:i.layout,margin:i.margin}),x.createElement(jK,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),x.createElement(kK,l3({},i,{ref:r})))}),H8e=["axis"],V8e=x.forwardRef((e,t)=>x.createElement(A6,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:H8e,tooltipPayloadSearcher:E_,categoricalChartProps:e,ref:t})),G8e=["axis","item"],AK=x.forwardRef((e,t)=>x.createElement(A6,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:G8e,tooltipPayloadSearcher:E_,categoricalChartProps:e,ref:t}));function K8e(e){var t=Zi();return x.useEffect(()=>{t(m8e(e))},[t,e]),null}var Y8e=["layout"];function c3(){return c3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},c3.apply(null,arguments)}function X8e(e,t){if(e==null)return{};var r,n,i=Q8e(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Q8e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var J8e={top:5,right:5,bottom:5,left:5},NK={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:J8e,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Z8e=x.forwardRef(function(t,r){var n,i=ka(t.categoricalChartProps,NK),{layout:s}=i,o=X8e(i,Y8e),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d}=t,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:u,tooltipPayloadSearcher:d,eventEmitter:void 0};return x.createElement(SK,{preloadedState:{options:f},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:l},x.createElement(qG,{chartData:i.data}),x.createElement(_K,{layout:s,margin:i.margin}),x.createElement(jK,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className,reverseStackOrder:i.reverseStackOrder}),x.createElement(K8e,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),x.createElement(kK,c3({},o,{ref:r})))});function CF(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function EF(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?CF(Object(r),!0).forEach(function(n){ePe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):CF(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ePe(e,t,r){return(t=tPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tPe(e){var t=rPe(e,"string");return typeof t=="symbol"?t:t+""}function rPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var nPe=["item"],iPe=EF(EF({},NK),{},{layout:"centric",startAngle:0,endAngle:360}),aPe=x.forwardRef((e,t)=>{var r=ka(e,iPe);return x.createElement(Z8e,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:nPe,tooltipPayloadSearcher:E_,categoricalChartProps:r,ref:t})}),sPe=["item"],oPe=x.forwardRef((e,t)=>x.createElement(A6,{chartName:"ScatterChart",defaultTooltipEventType:"item",validateTooltipEventTypes:sPe,tooltipPayloadSearcher:E_,categoricalChartProps:e,ref:t}));function fk(e,t){try{const r=Qn(`${t}_${e}`);if(!r)return null;if(r.rowsByStudentId&&typeof r.rowsByStudentId=="object")return r.rowsByStudentId;if(Array.isArray(r.rows)){const n={};return r.rows.forEach(i=>{n[String(i.studentId||i.id||"")]=i}),n}if(Array.isArray(r)){const n={};return r.forEach(i=>{n[String(i.studentId||i.id||"")]=i}),n}return typeof r=="object"?r:null}catch{return null}}function hk(e){if(!e)return null;for(const t of["total","mark","score","marks"])if(typeof e[t]=="number")return e[t];return null}const u3=58;function nx({title:e,subtitle:t,children:r}){return a.jsxs("div",{className:"obe-card",style:{padding:"18px 18px 14px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline",marginBottom:14},children:[a.jsx("div",{style:{fontWeight:800,fontSize:15,color:"#0f172a"},children:e}),t&&a.jsx("div",{style:{fontSize:11,color:"#94a3b8",fontWeight:600},children:t})]}),r]})}function Iy(){return a.jsxs("div",{style:{textAlign:"center",padding:"32px 0",color:"#94a3b8",fontSize:13},children:[a.jsx("svg",{width:32,height:32,viewBox:"0 0 24 24",fill:"none",stroke:"#cbd5e1",strokeWidth:1.5,style:{margin:"0 auto 6px",display:"block"},children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v18h18M7 16l4-5 4 3 4-6"})}),"No marks saved yet"]})}function lPe(e){const t=fk(e,"cia1_sheet"),r=fk(e,"cia2_sheet"),n=fk(e,"model_sheet"),i=new Set;return[t,r,n].forEach(s=>s&&Object.keys(s).forEach(o=>i.add(o))),Array.from(i).map(s=>{const o=t!=null&&t[s]?hk(t[s]):null,l=r!=null&&r[s]?hk(r[s]):null,c=n!=null&&n[s]?hk(n[s]):null,u=[o,l,c].filter(f=>f!==null),d=u.length?u.reduce((f,p)=>f+p,0)/u.length:null;return{id:s,cia1:o??void 0,cia2:l??void 0,model:c??void 0,avg:d??void 0}})}function cPe({students:e}){const t=e.filter(c=>typeof c.avg=="number"),r=t.length,n=t.filter(c=>(c.avg??0)>=u3).length,i=r?t.reduce((c,u)=>c+(u.avg??0),0)/r:0,s=r?Math.max(...t.map(c=>c.avg??0)):0,o=r?Math.min(...t.map(c=>c.avg??0)):0,l=[{label:"Total Students",value:r,color:"#0b74b8"},{label:"Passed",value:n,color:"#10b981"},{label:"Class Avg",value:i.toFixed(1),color:"#f59e0b"},{label:"Highest",value:s.toFixed(1),color:"#8b5cf6"},{label:"Lowest",value:o.toFixed(1),color:"#ef4444"}];return a.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:12,marginBottom:14},children:l.map(c=>a.jsxs("div",{style:{flex:"1 1 120px",background:"#fff",borderRadius:12,padding:"14px 18px",boxShadow:"0 2px 8px rgba(0,0,0,0.07)",borderLeft:`4px solid ${c.color}`},children:[a.jsx("div",{style:{fontSize:22,fontWeight:900,color:c.color},children:c.value}),a.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:2,fontWeight:600},children:c.label})]},c.label))})}function uPe({students:e}){const t=n=>{const i=n.filter(s=>typeof s=="number");return i.length?Math.round(i.reduce((s,o)=>s+o,0)/i.length*10)/10:0},r=[{name:"CIA 1",average:t(e.map(n=>n.cia1))},{name:"CIA 2",average:t(e.map(n=>n.cia2))},{name:"Model",average:t(e.map(n=>n.model))}];return e.length===0?a.jsx(Iy,{}):a.jsx(gy,{width:"100%",height:220,children:a.jsxs(V8e,{data:r,margin:{top:10,right:20,left:0,bottom:5},children:[a.jsx(Oy,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(Fy,{dataKey:"name",tick:{fontSize:12,fill:"#475569"}}),a.jsx(By,{domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),a.jsx(Py,{contentStyle:{borderRadius:10,fontSize:13}}),a.jsx(nK,{type:"monotone",dataKey:"average",stroke:"#0b74b8",strokeWidth:3,dot:{r:6,fill:"#ff8c42",stroke:"#fff",strokeWidth:2},activeDot:{r:8}})]})})}const TF=["#ef4444","#f59e0b","#06b6d4","#10b981"];function dPe({students:e}){const t={"Fail (<58)":0,"5864":0,"6574":0,"75+":0};e.forEach(s=>{const o=s.avg??0;o<58?t["Fail (<58)"]+=1:o<65?t["5864"]+=1:o<75?t["6574"]+=1:t["75+"]+=1});const r=Object.entries(t).map(([s,o])=>({name:s,value:o})).filter(s=>s.value>0),n=e.filter(s=>typeof s.avg=="number").length,i=n?Math.round((n-t["Fail (<58)"])/n*100):0;return r.length===0?a.jsx(Iy,{}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{textAlign:"center",marginBottom:4},children:[a.jsxs("span",{style:{fontSize:28,fontWeight:900,color:i>=75?"#10b981":"#f59e0b"},children:[i,"%"]}),a.jsx("span",{style:{fontSize:12,color:"#64748b",marginLeft:6},children:"Pass Rate"})]}),a.jsx(gy,{width:"100%",height:200,children:a.jsxs(aPe,{children:[a.jsx(UG,{data:r,cx:"50%",cy:"50%",innerRadius:50,outerRadius:80,paddingAngle:3,dataKey:"value",label:({name:s,percent:o})=>`${s} ${(o*100).toFixed(0)}%`,labelLine:!1,children:r.map((s,o)=>a.jsx(op,{fill:TF[o%TF.length]},o))}),a.jsx(Py,{}),a.jsx(JC,{iconType:"circle",iconSize:10})]})})]})}function fPe({students:e}){const t=[...e].filter(n=>typeof n.avg=="number").sort((n,i)=>(i.avg??0)-(n.avg??0)),r=[...t.slice(0,5).map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Top"})),...t.slice(-5).reverse().map(n=>({id:n.id.slice(-6),avg:+(n.avg??0).toFixed(1),group:"Bottom"}))];return r.length===0?a.jsx(Iy,{}):a.jsx(gy,{width:"100%",height:260,children:a.jsxs(AK,{data:r,layout:"vertical",margin:{top:4,right:24,left:8,bottom:4},children:[a.jsx(Oy,{strokeDasharray:"3 3",horizontal:!1,stroke:"#e2e8f0"}),a.jsx(Fy,{type:"number",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"}}),a.jsx(By,{dataKey:"id",type:"category",tick:{fontSize:11,fill:"#475569"},width:56}),a.jsx(Py,{contentStyle:{borderRadius:10,fontSize:13}}),a.jsx(Ux,{dataKey:"avg",radius:[0,6,6,0],children:r.map((n,i)=>a.jsx(op,{fill:n.group==="Top"?"#0b74b8":"#ef4444"},i))})]})})}function hPe({students:e}){const t=e.filter(r=>r.cia1!=null||r.cia2!=null||r.model!=null).slice(0,25).map(r=>({id:r.id.slice(-5),CIA1:r.cia1!=null?+r.cia1.toFixed(1):null,CIA2:r.cia2!=null?+r.cia2.toFixed(1):null,Model:r.model!=null?+r.model.toFixed(1):null}));return t.length===0?a.jsx(Iy,{}):a.jsx(gy,{width:"100%",height:240,children:a.jsxs(AK,{data:t,margin:{top:10,right:10,left:0,bottom:20},children:[a.jsx(Oy,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(Fy,{dataKey:"id",tick:{fontSize:9,fill:"#475569"},angle:-45,textAnchor:"end",interval:0}),a.jsx(By,{domain:[0,100],tick:{fontSize:10,fill:"#94a3b8"}}),a.jsx(Py,{contentStyle:{borderRadius:10,fontSize:12}}),a.jsx(JC,{iconType:"circle",iconSize:9}),a.jsx(Ux,{dataKey:"CIA1",fill:"#0b74b8",radius:[3,3,0,0]}),a.jsx(Ux,{dataKey:"CIA2",fill:"#06b6d4",radius:[3,3,0,0]}),a.jsx(Ux,{dataKey:"Model",fill:"#f59e0b",radius:[3,3,0,0]})]})})}function pPe({students:e}){const t=e.filter(r=>r.cia1!=null&&r.cia2!=null).map(r=>({x:+(r.cia1??0).toFixed(1),y:+(r.cia2??0).toFixed(1),id:r.id}));return t.length===0?a.jsx(Iy,{}):a.jsx(gy,{width:"100%",height:220,children:a.jsxs(oPe,{margin:{top:10,right:20,left:0,bottom:10},children:[a.jsx(Oy,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),a.jsx(Fy,{type:"number",dataKey:"x",name:"CIA1",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 1",position:"insideBottom",offset:-6,fontSize:11,fill:"#475569"}}),a.jsx(By,{type:"number",dataKey:"y",name:"CIA2",domain:[0,100],tick:{fontSize:11,fill:"#94a3b8"},label:{value:"CIA 2",angle:-90,position:"insideLeft",fontSize:11,fill:"#475569"}}),a.jsx(dK,{range:[40,40]}),a.jsx(Py,{cursor:{strokeDasharray:"3 3"},contentStyle:{borderRadius:10,fontSize:12},content:({payload:r})=>{var n,i,s,o,l,c;return r!=null&&r.length?a.jsxs("div",{style:{background:"#fff",padding:"6px 10px",borderRadius:8,fontSize:12,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:[a.jsx("div",{children:a.jsx("b",{children:(i=(n=r[0])==null?void 0:n.payload)==null?void 0:i.id})}),a.jsxs("div",{children:["CIA1: ",(o=(s=r[0])==null?void 0:s.payload)==null?void 0:o.x,"  CIA2: ",(c=(l=r[0])==null?void 0:l.payload)==null?void 0:c.y]})]}):null}}),a.jsx(ZA,{x:u3,stroke:"#ef4444",strokeDasharray:"5 3",label:{value:"Fail",fill:"#ef4444",fontSize:10}}),a.jsx(ZA,{y:u3,stroke:"#ef4444",strokeDasharray:"5 3"}),a.jsx(cK,{data:t,fill:"#0b74b8",opacity:.75})]})})}function mPe({subjectId:e}){const t=String(e||""),r=x.useMemo(()=>lPe(t),[t]);return a.jsxs("div",{style:{padding:"4px 0"},children:[a.jsx(cPe,{students:r}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:16},children:[a.jsx(nx,{title:"Trend Over Time",subtitle:"Class avg per assessment",children:a.jsx(uPe,{students:r})}),a.jsx(nx,{title:"Grade Distribution",subtitle:"Pass rate (fail < 58)",children:a.jsx(dPe,{students:r})}),a.jsx(nx,{title:"Top vs Bottom Performers",subtitle:"Avg marks (last 5 digits of ID)",children:a.jsx(fPe,{students:r})}),a.jsx(nx,{title:"CIA1 vs CIA2 Scatter",subtitle:"Each dot = one student",children:a.jsx(pPe,{students:r})}),a.jsx(nx,{title:"Per-Student Assessment Comparison",subtitle:"First 25 students  CIA1 / CIA2 / Model",children:a.jsx(hPe,{students:r})})]})]})}const gPe=["ssa1","formative1","ssa2","formative2","cia1","cia2"];function xPe({teachingAssignmentId:e,onSaved:t,onClose:r}){var E;const[n,i]=x.useState(!1),[s,o]=x.useState(!1),[l,c]=x.useState(new Set),[u,d]=x.useState(null),[f,p]=x.useState(!1),[h,m]=x.useState(null),g=x.useRef(null);x.useEffect(()=>{let P=!0;if(e)return(async()=>{i(!0);try{const D=await dm(Number(e));if(!P)return;c(new Set((D==null?void 0:D.enabled_assessments)||[])),d((D==null?void 0:D.meta)||null),m(null)}catch(D){m((D==null?void 0:D.message)||"Failed to load")}finally{P&&i(!1)}})(),()=>{P=!1}},[e]),x.useEffect(()=>{var G;if(!e||(u==null?void 0:u.mode)!=="SPECIAL_GLOBAL"||((G=u==null?void 0:u.edit_request)==null?void 0:G.status)!=="PENDING")return;let P=!1;const D=window.setInterval(async()=>{try{const H=await dm(Number(e));if(P)return;c(new Set((H==null?void 0:H.enabled_assessments)||[])),d((H==null?void 0:H.meta)||null)}catch{}},4e3);return()=>{P=!0,window.clearInterval(D)}},[e,u==null?void 0:u.mode,(E=u==null?void 0:u.edit_request)==null?void 0:E.status]);const y=!!(u!=null&&u.locked),b=(u==null?void 0:u.can_edit)!==!1,v=y&&!b,w=(u==null?void 0:u.edit_request)||null,j=String((w==null?void 0:w.status)||"").toUpperCase()==="PENDING";x.useEffect(()=>{if((u==null?void 0:u.mode)!=="SPECIAL_GLOBAL")return;const P=g.current;g.current=b,P===!1&&b===!0&&alert("IQAC approval granted. You can now edit and re-save the enabled exams.")},[b,u==null?void 0:u.mode]);const k=P=>{v||c(D=>{const G=new Set(D);return G.has(P)?G.delete(P):G.add(P),G})},A=async()=>{if(e){o(!0);try{const P=Array.from(l.values()),D=await u9(Number(e),P),G=(D==null?void 0:D.enabled_assessments)||[];c(new Set(G)),d((D==null?void 0:D.meta)||u),m(null),t&&t(G),alert("Saved enabled assessments.")}catch(P){m((P==null?void 0:P.message)||"Save failed"),alert("Save failed: "+((P==null?void 0:P.message)||""))}finally{o(!1)}}},R=async P=>{if(e){p(!0);try{const D=await d9(Number(e));d(G=>({...G||{},locked:!0,can_edit:!1,edit_request:D||{status:"PENDING"}})),alert(P?"Request is already pending. Synced status with server.":"Edit request sent to IQAC for approval.")}catch(D){m((D==null?void 0:D.message)||"Failed to request edit"),alert("Edit request failed: "+((D==null?void 0:D.message)||""))}finally{p(!1)}}},M=async()=>{await R(j),await B()},B=async()=>{if(e)try{i(!0);const P=await dm(Number(e));c(new Set((P==null?void 0:P.enabled_assessments)||[])),d((P==null?void 0:P.meta)||null),m(null)}catch(P){m((P==null?void 0:P.message)||"Failed to refresh")}finally{i(!1)}};return a.jsxs("div",{style:{border:"1px solid #e5e7eb",padding:12,borderRadius:8,background:"#ffffff",maxWidth:520},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[a.jsx("div",{style:{fontWeight:700},children:"Select Exams for this Assignment"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"?"Special course (global lock)":"Faculty override"})]}),(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&y&&a.jsxs("div",{style:{fontSize:12,color:v?"#92400e":"#065f46",marginBottom:8},children:[v?"Locked after first save. Edit requires IQAC approval.":"Editing permitted (approved by IQAC/admin).",w!=null&&w.status?a.jsxs("span",{style:{marginLeft:8,color:"#6b7280"},children:["Request: ",String(w.status)]}):null]}),n?a.jsx("div",{style:{color:"#6b7280"},children:"Loading"}):a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0,1fr))",gap:8},children:gPe.map(P=>a.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("input",{type:"checkbox",checked:l.has(P),onChange:()=>k(P),disabled:v||s}),a.jsx("span",{style:{textTransform:"uppercase",fontSize:13},children:P.toUpperCase()})]},P))}),h&&a.jsx("div",{style:{color:"#b91c1c",marginTop:8},children:h}),a.jsxs("div",{style:{display:"flex",gap:8,marginTop:12},children:[!v&&a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:A,disabled:s||n||!e,children:s?"Saving":"Save"}),v&&(u==null?void 0:u.mode)==="SPECIAL_GLOBAL"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"obe-btn",onClick:M,disabled:f||s||n||!e,title:j?"Request already pending. Wait for IQAC approval.":void 0,children:f?"Requesting":j?"Edit Request Pending":"Edit (Request IQAC Approval)"}),a.jsx("button",{className:"obe-btn",onClick:B,disabled:s||n||!e,children:"Refresh"})]}),a.jsx("button",{className:"obe-btn",onClick:()=>r&&r(),disabled:s,children:"Close"})]})]})}function yPe({teachingAssignmentId:e,subjectId:t,onApplied:r}){var f,p,h;const[n,i]=x.useState([]),[s,o]=x.useState(!1),l=x.useMemo(()=>[...new Set(n.map(m=>String(m.assessment||"").trim().toLowerCase()).filter(Boolean))],[n]);x.useEffect(()=>{let m=!0;return(async()=>{try{const g=await l9(e);if(!m)return;const y=g.filter(b=>b.teaching_assignment_id===e);if(i(y),y.length===0){o(!0);return}try{for(const b of y)O2(String(t),String(b.assessment))}catch{}try{r&&r()}catch{}}catch(g){console.error("Failed to fetch reset notifications:",g),m&&o(!0)}})(),()=>{m=!1}},[e]);const c=async()=>{if(n.length!==0)try{const m=n.map(g=>g.id);await c9(m);try{for(const g of l)O2(String(t),String(g))}catch{}o(!0);try{r&&r()}catch{}}catch(m){console.error("Failed to dismiss notifications:",m),o(!0)}};if(s||n.length===0)return null;const u={ssa1:"SSA1",review1:"Review 1",ssa2:"SSA2",review2:"Review 2",cia1:"CIA1",cia2:"CIA2",formative1:"Formative 1",formative2:"Formative 2",model:"Model Exam"},d=l.map(m=>u[m]||m).join(", ");return a.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},onClick:c,children:a.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:24,maxWidth:500,boxShadow:"0 4px 12px rgba(0,0,0,0.15)"},onClick:m=>m.stopPropagation(),children:[a.jsx("h3",{style:{margin:0,marginBottom:12,color:"#dc2626",fontSize:18,fontWeight:800},children:" Course Reset by IQAC"}),a.jsx("p",{style:{margin:0,marginBottom:16,color:"#374151",lineHeight:1.6},children:"The following assessment(s) have been reset by the IQAC administrator:"}),a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #fecaca",borderRadius:8,padding:12,marginBottom:16},children:[a.jsxs("div",{style:{fontWeight:700,color:"#991b1b",marginBottom:6},children:[(f=n[0])==null?void 0:f.subject_code,"  ",(p=n[0])==null?void 0:p.subject_name]}),a.jsxs("div",{style:{fontSize:14,color:"#7f1d1d"},children:["Section: ",((h=n[0])==null?void 0:h.section_name)||""]}),a.jsxs("div",{style:{fontSize:14,color:"#7f1d1d",marginTop:4},children:["Assessments: ",d]})]}),a.jsx("p",{style:{margin:0,marginBottom:16,color:"#6b7280",fontSize:14},children:"All previously entered data for these assessment(s) has been cleared. You will need to re-enter the marks."}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:c,style:{minWidth:80},children:"OK"})})]})})}function bPe(e){return String(e).startsWith("cqi_")?null:e==="ssa1"?"ssa1":e==="review1"?"review1":e==="ssa2"?"ssa2":e==="review2"?"review2":e==="formative1"?"formative1":e==="formative2"?"formative2":e==="cia1"?"cia1":e==="cia2"?"cia2":e==="model"?"model":null}const ix=[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"formative1",label:"Formative 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"formative2",label:"Formative 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}];function vPe(e){const t=String(e||"").trim().toLowerCase();return t==="cia1_co1_co2"?{showAfter:"cia1",assessmentType:"cia1",cos:["CO1","CO2"]}:t==="cia2_co3_co4"?{showAfter:"cia2",assessmentType:"cia2",cos:["CO3","CO4"]}:t==="model_co1_co2_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO1","CO2","CO3","CO4","CO5"]}:t==="model_co3_co4_co5"?{showAfter:"model",assessmentType:"model",cos:["CO3","CO4","CO5"]}:t==="model_co5"?{showAfter:"model",assessmentType:"model",cos:["CO5"]}:null}function wPe(e){const t=Array.isArray(e)?e:[];return new Set(t.map(r=>String(r||"").trim().toLowerCase()).filter(Boolean))}function SPe(e,t){const r=ti(e),n=wPe(t);if(r==="SPECIAL"){const i=new Set(["dashboard"]);return["ssa1","ssa2","formative1","formative2","cia1","cia2"].forEach(s=>{n.has(s)&&i.add(s)}),ix.filter(s=>i.has(s.key))}return r==="PRACTICAL"?ix.filter(i=>["dashboard","cia1","cia2","model"].includes(i.key)).map(i=>i.key==="cia1"?{...i,label:"CIA 1 Review"}:i.key==="cia2"?{...i,label:"CIA 2 Review"}:i.key==="model"?{...i,label:"MODEL Review"}:i):r==="PROJECT"?[{key:"dashboard",label:"Dashboard"},{key:"review1",label:"Review 1"},{key:"review2",label:"Review 2"},{key:"model",label:"MODEL Review"}]:r==="TCPR"?[{key:"dashboard",label:"Dashboard"},{key:"ssa1",label:"SSA1"},{key:"review1",label:"Review 1"},{key:"cia1",label:"CIA 1"},{key:"ssa2",label:"SSA2"},{key:"review2",label:"Review 2"},{key:"cia2",label:"CIA 2"},{key:"model",label:"MODEL"}]:r==="TCPL"?ix.map(i=>i.key==="formative1"?{...i,label:"LAB 1"}:i.key==="formative2"?{...i,label:"LAB 2"}:i):r==="LAB"?ix.filter(i=>["dashboard","cia1","cia2","model"].includes(i.key)).map(i=>i.key==="cia1"?{...i,label:"CIA 1 LAB"}:i.key==="cia2"?{...i,label:"CIA 2 LAB"}:i.key==="model"?{...i,label:"MODEL LAB"}:i):ix}function CK(e,t){return`marks_${e}_${t}`}function _Pe(e,t){const r=`studentId,mark
`,n=t.map(l=>`${String(l.studentId||"").replace(/\n/g," ")},${Number(l.mark||0)}`).join(`
`),i=new Blob([r+n],{type:"text/csv"}),s=URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download=e,o.click(),URL.revokeObjectURL(s)}function jPe({active:e,label:t,onClick:r}){return a.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""}`,children:t})}function kPe({active:e,label:t,onClick:r,isCqi:n,uniqueId:i}){return a.jsx("button",{onClick:r,className:`obe-sidebar-btn ${e?"active":""} ${n?"cqi-floating-btn":""}`,...i?{"data-cqi-id":i}:{},children:t})}function APe({subjectId:e,tab:t}){const r=x.useMemo(()=>CK(e,t),[e,t]),[n,i]=x.useState([]);x.useEffect(()=>{const d=Qn(r)||[];i(Array.isArray(d)?d:[])},[r]);const s=()=>i(d=>[...d,{studentId:"",mark:0}]),o=(d,f,p)=>{i(h=>{const m=[...h],g=m[d]||{studentId:"",mark:0};return m[d]={...g,[f]:p},m})},l=d=>{i(f=>f.filter((p,h)=>h!==d))},c=()=>{Gn(r,n),alert("Marks saved locally.")},u=()=>{_Pe(`${e}_${t}_marks.csv`,n)};return a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:10,flexWrap:"wrap"},children:[a.jsx("button",{onClick:s,className:"obe-btn obe-btn-primary",children:"Add Row"}),a.jsx("button",{onClick:c,className:"obe-btn obe-btn-success",children:"Save Local"}),a.jsx("button",{onClick:u,className:"obe-btn obe-btn-secondary",disabled:!n.length,title:n.length?"Export as CSV":"Add at least one row to export",children:"Export CSV"})]}),n.length===0?a.jsx("div",{style:{color:"#6b7280",fontSize:14,padding:"12px 0"},children:"No rows yet. Click Add Row to start."}):a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:n.map((d,f)=>a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 120px 90px",gap:8,alignItems:"center"},children:[a.jsx("input",{value:d.studentId,onChange:p=>o(f,"studentId",p.target.value),placeholder:"Student ID",className:"obe-input"}),a.jsx("input",{type:"number",value:d.mark,onChange:p=>o(f,"mark",Number(p.target.value)),className:"obe-input"}),a.jsx("button",{onClick:()=>l(f),className:"obe-btn obe-btn-danger",children:"Remove"})]},f))}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Saved key: ",a.jsx("span",{style:{fontFamily:"monospace"},children:r})]})]})}function N6({subjectId:e,classType:t,questionPaperType:r,enabledAssessments:n,teachingAssignmentsOverride:i,fixedTeachingAssignmentId:s,iqacResetEnabled:o,viewerMode:l}){var ne,re;const[c,u]=x.useState("dashboard"),d=Jr.useCallback(T=>{if(T!==c){try{window.dispatchEvent(new CustomEvent("obe:before-tab-switch",{detail:{from:c,to:T}}))}catch{}u(T),e&&Gn(`markEntry_activeTab_${e}`,T)}},[c,e]),[f,p]=x.useState([]),[h,m]=x.useState(null),[g,y]=x.useState(null),[b,v]=x.useState(void 0),[w,S]=x.useState(!1),[j,k]=x.useState(!1),[A,R]=x.useState(0),[M,B]=x.useState(null),E=x.useMemo(()=>bPe(c),[c]),[P,D]=x.useState({loading:!1,enabled:!0,open:!0,error:null});x.useEffect(()=>{let T=!0;return(async()=>{if(!E){if(!T)return;D({loading:!1,enabled:!0,open:!0,error:null});return}if(T){D({loading:!0,enabled:!0,open:!0,error:null});try{const I=await SN(E,String(e||""),g??void 0);if(!T)return;const ie=(I==null?void 0:I.assessment_enabled)??!0,U=(I==null?void 0:I.assessment_open)??!0;D({loading:!1,enabled:!!ie,open:!!U,error:null})}catch(I){if(!T)return;D({loading:!1,enabled:!0,open:!0,error:(I==null?void 0:I.message)||"Failed to check exam availability"})}}})(),()=>{T=!1}},[E,e,g]);const G=E?!!P.enabled:!0,H=!!l||(E?!P.open:!1),oe=x.useMemo(()=>g==null?null:(f||[]).find(T=>T.id===g)||null,[f,g]),[de,W]=x.useState(null),[V,ae]=x.useState(null);x.useEffect(()=>{let T=!0;return(async()=>{if(W(null),ae(null),g==null)return;const I=oe||null,ie=String((I==null?void 0:I.class_type)||"").trim(),U=!!String((I==null?void 0:I.academic_year)||"").trim(),Z=typeof(I==null?void 0:I.semester)<"u"&&(I==null?void 0:I.semester)!=null,me=!!(I!=null&&I.department||I!=null&&I.department_name),Pe=!!String((I==null?void 0:I.section_name)||"").trim();if(ie&&U&&Z&&me&&Pe){W(ie);return}const je=String(t||"").trim();try{const Fe=await pc(Number(g));if(!T)return;const _e=(Fe==null?void 0:Fe.teaching_assignment)||{},He=String((_e==null?void 0:_e.class_type)||"").trim();W(He||ie||je||null),ae({academic_year:(_e==null?void 0:_e.academic_year)||(_e==null?void 0:_e.academic_year_name)||(_e==null?void 0:_e.year)||null,semester:typeof(_e==null?void 0:_e.semester)<"u"?_e==null?void 0:_e.semester:null,department:(_e==null?void 0:_e.department)||(_e==null?void 0:_e.department_name)||null,section_name:(_e==null?void 0:_e.section_name)||(_e==null?void 0:_e.section)||null})}catch{if(!T)return;W(ie||je||null),ae(null)}})(),()=>{T=!1}},[g,oe,t]);const ee=x.useMemo(()=>{const T=String((oe==null?void 0:oe.class_type)||"").trim();if(T)return T;const I=String(de||"").trim();return I||String(t||"").trim()||null},[oe,de,t]),C=x.useMemo(()=>{const T=ti(ee),I=T.replace(/[^A-Z0-9]/g,"");return I.includes("TCPR")?"TCPR":I.includes("TCPL")?"TCPL":String(r||"").trim().toUpperCase()==="QP2"&&!T?"TCPR":ee},[ee,r]),Y=x.useMemo(()=>ti(C),[C]);x.useEffect(()=>{let T=!0;return(async()=>{try{const I=await bS();if(!T)return;const U=(Array.isArray(I==null?void 0:I.options)?I.options:[]).map(Z=>typeof Z=="string"?String(Z||""):Z&&typeof Z=="object"&&Z.id?String(Z.id||""):"").map(Z=>Z.trim()).filter(Boolean);B({options:U,divider:Number.isFinite(Number(I==null?void 0:I.divider))?Number(I.divider):2,multiplier:Number.isFinite(Number(I==null?void 0:I.multiplier))?Number(I.multiplier):.15})}catch{if(!T)return;B(null)}})(),()=>{T=!1}},[]);const q=x.useMemo(()=>Y==="SPECIAL",[Y]),O=b===void 0?n:b,X=x.useMemo(()=>SPe(C,O),[C,n,b]),F=x.useMemo(()=>(Array.isArray(M==null?void 0:M.options)?M.options:[]).map(I=>vPe(I)).filter(I=>!!I),[M]),Q=x.useMemo(()=>{const T=[...X];return F.length&&F.forEach((I,ie)=>{var Pe,je,Fe;const U=`CQI (${I.assessmentType.toUpperCase()} ${I.cos.join(", ")})`,Z={key:`cqi_${ie}`,label:U,cqi:I},me=T.findIndex(_e=>_e.key===I.showAfter);if(me>=0){let _e=me+1;for(;_e<T.length&&String(((Pe=T[_e])==null?void 0:Pe.key)||"").startsWith("cqi_")&&((Fe=(je=T[_e])==null?void 0:je.cqi)==null?void 0:Fe.showAfter)===I.showAfter;)_e+=1;T.splice(_e,0,Z)}else T.push(Z)}),T},[X,F]);x.useEffect(()=>{if(!e)return;const T=Qn(`markEntry_activeTab_${e}`);T&&Q.some(I=>I.key===T)&&u(T)},[e]),x.useEffect(()=>{Q.some(T=>T.key===c)||u("dashboard")},[Q,c]),x.useEffect(()=>{var ie;if(!e||!i)return;const T=(i||[]).filter(U=>String(U.subject_code)===String(e));p(T),m(null);const I=typeof s=="number"&&T.some(U=>U.id===s)&&s||(((ie=T[0])==null?void 0:ie.id)??null);y(I)},[e,i,s]),x.useEffect(()=>{let T=!0;if(!(i&&Array.isArray(i)))return(async()=>{var I;try{const ie=await hc();if(!T)return;let U=(ie||[]).filter(Pe=>Pe.subject_code===e);if(U.length===0)try{const Pe=await mr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(Pe.ok){const je=await Pe.json();U=(Array.isArray(je.results)?je.results:Array.isArray(je)?je:je.items||[])||[]}}catch(Pe){console.warn("Server TA list fetch failed:",Pe)}p(U),m(null);const Z=Qn(`markEntry_selectedTa_${e}`),me=typeof s=="number"&&U.some(Pe=>Pe.id===s)&&s||typeof Z=="number"&&U.some(Pe=>Pe.id===Z)&&Z||(((I=U[0])==null?void 0:I.id)??null);y(me)}catch(ie){if(!T)return;p([]),y(null),m((ie==null?void 0:ie.message)||"Failed to load teaching assignments")}})(),()=>{T=!1}},[e,i,s]),x.useEffect(()=>{e&&g!=null&&typeof s!="number"&&Gn(`markEntry_selectedTa_${e}`,g)},[e,g,s]),x.useEffect(()=>{let T=!0;if(e){if(g==null){v(void 0);return}if(!q){v(void 0);return}return(async()=>{try{const I=await dm(Number(g)),ie=I==null?void 0:I.enabled_assessments;if(!T)return;v(Array.isArray(ie)&&ie.length?ie:null)}catch(I){if(!T)return;v(void 0),m((I==null?void 0:I.message)||"Failed to load faculty enabled assessments")}})(),()=>{T=!1}}},[e,g,q]),x.useEffect(()=>{e&&Gn(`markEntry_activeTab_${e}`,c)},[e,c]);const K=x.useMemo(()=>{if(!e)return{};const T={};for(const I of Q){if(I.key==="dashboard"||String(I.key).startsWith("cqi_"))continue;if(I.key==="ssa1"){const U=Qn(`ssa1_sheet_${e}`),Z=U==null?void 0:U.rows;T[I.key]=Array.isArray(Z)?Z.length:0;continue}if(I.key==="review1"){const U=Qn(`review1_sheet_${e}`),Z=U==null?void 0:U.rows;T[I.key]=Array.isArray(Z)?Z.length:0;continue}if(I.key==="ssa2"){const U=Qn(`ssa2_sheet_${e}`),Z=U==null?void 0:U.rows;T[I.key]=Array.isArray(Z)?Z.length:0;continue}if(I.key==="review2"){const U=Qn(`review2_sheet_${e}`),Z=U==null?void 0:U.rows;T[I.key]=Array.isArray(Z)?Z.length:0;continue}if(I.key==="formative1"){const U=Qn(`formative1_sheet_${e}`),Z=U==null?void 0:U.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(I.key==="formative2"){const U=Qn(`formative2_sheet_${e}`),Z=U==null?void 0:U.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(I.key==="cia1"){const U=Qn(`cia1_sheet_${e}`),Z=U==null?void 0:U.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(I.key==="cia2"){const U=Qn(`cia2_sheet_${e}`),Z=U==null?void 0:U.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}if(I.key==="model"){const U=Qn(`model_sheet_${e}`),Z=U==null?void 0:U.rowsByStudentId;T[I.key]=Z&&typeof Z=="object"?Object.keys(Z).length:0;continue}const ie=Qn(CK(e,I.key))||[];T[I.key]=Array.isArray(ie)?ie.length:0}return T},[e,c,Q,A]);return a.jsxs("div",{children:[g!=null&&a.jsx(yPe,{teachingAssignmentId:g,subjectId:String(e),onApplied:()=>R(T=>T+1)}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-end",flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{style:{minWidth:260},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Teaching Assignment (Section)"}),f.length===0?a.jsx("div",{className:"obe-input",children:"No teaching assignments"}):a.jsxs("div",{style:{padding:"8px 10px",borderRadius:6,background:"#fff",border:"1px solid #e5e7eb"},children:[a.jsx("div",{style:{fontSize:14,fontWeight:600},children:((ne=oe||f[0])==null?void 0:ne.section_name)||(V==null?void 0:V.section_name)||""}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:(()=>{var Pe,je,Fe,_e,He,qe,Pt,ut;const T=oe||f[0]||{},I=T.academic_year||(V==null?void 0:V.academic_year)||T.academic_year_name||T.year||"",ie=typeof T.semester<"u"&&T.semester!=null?T.semester:typeof(V==null?void 0:V.semester)<"u"?V==null?void 0:V.semester:(Pe=f[0])==null?void 0:Pe.semester,U=T.department||((je=T.section_details)==null?void 0:je.department)||((He=(_e=(Fe=T.section_details)==null?void 0:Fe.batch)==null?void 0:_e.course)==null?void 0:He.department)||(V==null?void 0:V.department)||(T.department_name?{name:T.department_name}:null)||((qe=f[0])==null?void 0:qe.department)||((ut=(Pt=f[0])==null?void 0:Pt.section_details)==null?void 0:ut.department),Z=(U==null?void 0:U.short_name)||(U==null?void 0:U.code)||(U==null?void 0:U.name)||T.department_name||"",me=[];return me.push(I||""),typeof ie<"u"&&ie!=null&&me.push(`Sem ${ie}`),Z&&me.push(Z),me.filter(Boolean).join("  ")})()})]}),h&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:h})]}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:"Student rows load from the selected section roster."}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:q&&g?a.jsx("button",{className:"obe-btn",onClick:()=>S(T=>!T),children:"Show exams"}):null})]}),q&&w&&g?a.jsx("div",{style:{marginBottom:12},children:a.jsx(xPe,{teachingAssignmentId:g??void 0,onSaved:T=>{v(Array.isArray(T)&&T.length?T:null),S(!1)},onClose:()=>S(!1)})}):null,o&&E&&g!=null?a.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:a.jsx("button",{className:"obe-btn obe-btn-danger",disabled:j,onClick:async()=>{const T=E;if(window.confirm(`Reset ${T.toUpperCase()} for this section? This clears draft + published data for that exam.`))try{k(!0),await wN(T,String(e),Number(g)),O2(String(e),String(T)),R(ie=>ie+1),alert("Reset completed.")}catch(ie){alert((ie==null?void 0:ie.message)||"Reset failed")}finally{k(!1)}},children:j?"Resetting":"Reset This Exam"})}):null,a.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e0f2fe 100%)",borderRadius:12,padding:"16px",marginBottom:20,border:"1px solid #cbd5e1",boxShadow:"0 2px 8px rgba(2,6,23,0.04), inset 0 1px 0 rgba(255,255,255,0.5)"},children:[a.jsx("div",{style:{fontSize:12,fontWeight:700,color:"#64748b",textTransform:"uppercase",letterSpacing:"0.05em",marginBottom:12},children:"Assessment Exams"}),a.jsx("div",{className:"obe-sidebar-nav","aria-label":"Mark Entry sub-tabs",style:{display:"flex",flexWrap:"wrap",gap:8},children:Q.map((T,I)=>a.jsx(Jr.Fragment,{children:T.cqi?a.jsx(kPe,{active:c===T.key,label:T.label,onClick:()=>d(T.key),isCqi:!0,uniqueId:String(T.key)}):a.jsx(jPe,{active:c===T.key,label:T.label,onClick:()=>d(T.key)})},T.key))})]}),c==="dashboard"&&a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 6px 0"},children:"Dashboard"}),a.jsxs("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:["Quick overview for ",a.jsx("b",{children:e}),". Use the tabs to enter marks."]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(160px, 1fr))",gap:12},children:Q.filter(T=>T.key!=="dashboard").map(T=>a.jsxs("div",{className:"obe-card",children:[a.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:T.label}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#6b7280"},children:["Rows saved: ",String(T.key).startsWith("cqi_")?"":K[T.key]??0]})]},T.key))}),a.jsx("div",{style:{marginTop:14},children:a.jsx(mPe,{subjectId:e})})]}),c!=="dashboard"&&a.jsxs("div",{children:[a.jsx("h3",{style:{margin:"0 0 6px 0"},children:(re=Q.find(T=>T.key===c))==null?void 0:re.label}),(()=>{const T=Q.find(ie=>ie.key===c)||null,I=(T==null?void 0:T.cqi)||null;return a.jsx("div",{style:{color:"#6b7280",marginBottom:12,fontSize:14},children:c==="formative1"?Y==="TCPL"?"Enter and manage LAB-1 marks (experiments + totals).":"Enter and manage Formative-1 assessment marks with BTL mapping.":c==="formative2"?Y==="TCPL"?"Enter and manage LAB-2 marks (experiments + totals).":"Enter and manage Formative-2 assessment marks with BTL mapping.":c==="ssa1"?"SSA1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review1"?"Review 1 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="ssa2"?"SSA2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="review2"?"Review 2 sheet-style entry (CO + BTL attainment) matching the Excel layout.":c==="cia1"?Y==="LAB"?"CIA 1 LAB entry (CO-1/CO-2 experiments + CIA exam)":Y==="PRACTICAL"?"CIA 1 Review (Practical) - enter review marks for practical content.":Y==="TCPR"?"CIA 1 Review (TCPR) - enter review marks for TCPR content.":"CIA 1 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="cia2"?Y==="LAB"?"CIA 2 LAB entry (CO-3/CO-4/CO-5 experiments + CIA exam).":Y==="PRACTICAL"?"CIA 2 Review (Practical) - enter review marks for practical content.":Y==="TCPR"?"CIA 2 Review (TCPR) - enter review marks for TCPR content.":"CIA 2 sheet-style entry (Q-wise + CO + BTL) matching the Excel layout.":c==="model"?Y==="LAB"?"MODEL LAB entry (CO-5 experiments + CIA exam).":Y==="PRACTICAL"?"MODEL Review (Practical) - enter review marks for practical content.":Y==="TCPR"?"MODEL Review (TCPR) - enter review marks for TCPR content.":"MODEL blank table template (same layout style as CIA sheets).":String(c).startsWith("cqi_")?`CQI view for ${((I==null?void 0:I.assessmentType)||"assessment").toUpperCase()} (${((I==null?void 0:I.cos)||[]).join(", ")})`:"Enter and save marks locally for this assessment."})})(),P.loading&&E?a.jsx("div",{style:{padding:"10px 0",color:"#6b7280",fontSize:13},children:"Checking availability"}):!G&&E?a.jsx("div",{style:{background:"#fff7ed",border:"1px solid #fdba7433",color:"#9a3412",padding:12,borderRadius:12,fontWeight:800},children:"This exam is disabled by IQAC. Please contact IQAC to enable it."}):a.jsx("fieldset",{disabled:!!H,style:{border:0,padding:0,margin:0},children:(()=>{const T=Q.find(ie=>ie.key===c)||null,I=(T==null?void 0:T.cqi)||null;return c==="formative1"?Y==="TCPL"?a.jsx(Q2,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"formative1",label:"LAB 1",coA:1,coB:2}):a.jsx(Vz,{subjectId:e,teachingAssignmentId:g??void 0}):c==="formative2"?Y==="TCPL"?a.jsx(Q2,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"formative2",label:"LAB 2",coA:2,coB:3}):a.jsx(jxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="ssa1"?a.jsx(zxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="review1"?Y==="TCPR"?a.jsx(Gz,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"review1",label:"Review 1"}):a.jsx(Rxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="ssa2"?a.jsx(Gxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="review2"?Y==="TCPR"?a.jsx(Kz,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"review2",label:"Review 2"}):a.jsx(Fxe,{subjectId:e,teachingAssignmentId:g??void 0}):c==="cia1"?Y==="LAB"?a.jsx(Dx,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",label:"CIA 1 LAB",coA:1,coB:2,initialEnabledCos:[1,2],viewerMode:!!H}):Y==="PROJECT"?a.jsx(Dj,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",viewerMode:!!H,classType:ee??null}):Y==="PRACTICAL"?a.jsx(Ij,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia1",viewerMode:!!H}):a.jsx(Hz,{subjectId:e,teachingAssignmentId:g??void 0,classType:ee??null,questionPaperType:r??null}):c==="cia2"?Y==="LAB"?a.jsx(Dx,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",label:"CIA 2 LAB",coA:3,coB:4,initialEnabledCos:[3,4,5],viewerMode:!!H}):Y==="PROJECT"?a.jsx(Dj,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",viewerMode:!!H,classType:ee??null}):Y==="PRACTICAL"?a.jsx(Ij,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"cia2",viewerMode:!!H}):a.jsx(xxe,{subjectId:e,teachingAssignmentId:g??void 0,classType:ee??null,questionPaperType:r??null}):c==="model"?Y==="LAB"?a.jsx(Dx,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",label:"MODEL LAB",coA:5,coB:null,initialEnabledCos:[5],viewerMode:!!H}):Y==="PROJECT"?a.jsx(Dj,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",viewerMode:!!H,classType:ee??null}):Y==="PRACTICAL"?a.jsx(Ij,{subjectId:e,teachingAssignmentId:g??void 0,assessmentKey:"model",viewerMode:!!H}):a.jsx(Lxe,{subjectId:e,teachingAssignmentId:g??void 0,classType:ee??null,questionPaperType:r??null}):String(c).startsWith("cqi_")?a.jsx(Zxe,{subjectId:e,teachingAssignmentId:g??void 0,classType:ee??null,enabledAssessments:O??null,assessmentType:(I==null?void 0:I.assessmentType)||"model",cos:(I==null?void 0:I.cos)||["CO1","CO2","CO3","CO4","CO5"],cqiDivider:Number(M==null?void 0:M.divider)||2,cqiMultiplier:Number(M==null?void 0:M.multiplier)||.15}):a.jsx(APe,{subjectId:e,tab:c})})()})]},`${c}_${A}`)]})}function NPe(){var m,g,y,b;const{courseCode:e,taId:t}=U0(),r=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),n=x.useMemo(()=>t?Number(t):NaN,[t]),[i,s]=x.useState(null),[o,l]=x.useState(null),[c,u]=x.useState(null),[d,f]=x.useState(null);x.useEffect(()=>{let v=!0;return(async()=>{if(r)try{const[w,S]=await Promise.all([Sl(),Yd()]);if(!v)return;const k=(w||[]).filter(A=>String((A==null?void 0:A.course_code)||"").trim().toUpperCase()===r.toUpperCase())[0];if(k)if(l(k!=null&&k.class_type?String(k.class_type):null),u(k!=null&&k.question_paper_type?String(k.question_paper_type):null),String((k==null?void 0:k.class_type)||"").trim().toUpperCase()==="SPECIAL"){f([]);try{const R=await yS(r);f(Array.isArray(R)?R:[])}catch{const R=k==null?void 0:k.enabled_assessments;f(Array.isArray(R)?R.map(M=>String(M).trim().toLowerCase()).filter(Boolean):[])}}else f(null);else{const A=(S||[]).find(R=>String((R==null?void 0:R.course_code)||"").trim().toUpperCase()===r.toUpperCase());l(A!=null&&A.class_type?String(A.class_type):null),u(null),f(null)}}catch{}})(),()=>{v=!1}},[r]),x.useEffect(()=>{let v=!0;return(async()=>{if(!(!r||!Number.isFinite(n)))try{const w=await P2(r);if(!v)return;const S=(w||[]).find(j=>Number(j.teaching_assignment_id)===Number(n))||null;s(S)}catch{if(!v)return;s(null)}})(),()=>{v=!1}},[r,n]);const p=x.useMemo(()=>Number.isFinite(n)?[{id:n,subject_id:0,subject_code:r,subject_name:(i==null?void 0:i.course_name)||r,section_id:(i==null?void 0:i.section_id)||0,section_name:(i==null?void 0:i.section_name)||"Section",academic_year:(i==null?void 0:i.academic_year)||""}]:[],[n,r,i]),h=ti(o);return!r||!Number.isFinite(n)?a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),a.jsx("div",{style:{marginTop:10},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]}):a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Mark Entry Viewer"}),a.jsx("div",{style:{color:"#374151",marginTop:6,fontWeight:800},children:r}),a.jsxs("div",{style:{color:"#6b7280",marginTop:4},children:[i?`${i.section_name}  ${i.academic_year}`:"",(m=i==null?void 0:i.staff)!=null&&m.name||(g=i==null?void 0:i.staff)!=null&&g.username?`    ${((y=i.staff)==null?void 0:y.name)||((b=i.staff)==null?void 0:b.username)}`:"",h?`    ${h}`:""]})]}),a.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(r)}`,children:"Back"})})]}),a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:a.jsx(N6,{subjectId:r,classType:o,questionPaperType:c,enabledAssessments:d,teachingAssignmentsOverride:p,fixedTeachingAssignmentId:n,iqacResetEnabled:!0,viewerMode:!1})})]})}function CPe(e){return e==="-"||e===null||e===void 0||e===""?" - ":String(e)}function Tp(e,t){const r=Math.pow(10,t);return Math.round((e+Number.EPSILON)*r)/r}function d3({headers:e,rows:t}){return a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:900},children:[a.jsx("thead",{children:a.jsx("tr",{children:e.map(r=>a.jsx("th",{style:{textAlign:"left",fontSize:12,color:"#111827",background:"#f9fafb",padding:"10px 10px",borderBottom:"1px solid #e5e7eb",whiteSpace:"nowrap"},children:r},r))})}),a.jsx("tbody",{children:t.map((r,n)=>a.jsx("tr",{children:r.map((i,s)=>a.jsx("td",{style:{padding:"8px 10px",borderBottom:"1px solid #f3f4f6",fontSize:12,color:"#111827",whiteSpace:s===3?"normal":"nowrap",maxWidth:s===3?360:void 0},children:CPe(i)},s))},n))})]})})}function PF({title:e,headers:t,rows:r,collapsedByDefault:n=!1,showToggle:i=!0}){const[s,o]=x.useState(!n);return a.jsxs("section",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("h3",{style:{margin:"6px 0 10px 0",flex:1},children:e}),i?a.jsx("button",{"aria-label":s?"Collapse table":"Expand table",onClick:()=>o(l=>!l),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:18,padding:6,color:"#374151"},children:s?"":""}):null]}),s&&a.jsx(d3,{headers:t,rows:r})]})}function EPe({subjectId:e,matrix:t}){var s,o,l;if(!e)return a.jsx("div",{style:{color:"#6b7280",fontSize:13},children:"Select a course to view the Articulation Matrix."});if(!t)return a.jsxs("div",{style:{border:"1px dashed #bbb",padding:16,borderRadius:8,color:"#666"},children:["No articulation matrix loaded yet for ",a.jsx("b",{children:e}),". Upload the Excel to parse page-2."]});const r=Array.isArray(t.units)?t.units:[],n=(s=t.summaries)==null?void 0:s.co_po_summary,i=["S. No","CO Mapped","Topic No.","Topic Name",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Hours"];return Array.from({length:i.length},()=>""),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[((o=t.meta)==null?void 0:o.sheet_used)&&a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["Sheet: ",a.jsx("b",{children:t.meta.sheet_used})]}),r.map(c=>{const u=(c.rows||[]).map(d=>[d.s_no,d.co_mapped,d.topic_no,d.topic_name,...d.po||[],...d.pso||[],d.hours]);return a.jsxs("section",{children:[a.jsx("h3",{style:{margin:"6px 0 10px 0"},children:c.unit}),a.jsx(d3,{headers:i,rows:u})]},c.unit)}),(()=>{const c=[],u=(f,p)=>{const h=r[f];if(!h||!Array.isArray(h.rows)||h.rows.length===0)return[p,...Array.from({length:11},()=>""),...Array.from({length:3},()=>""),""];const m=h.rows,g=m.reduce((v,w)=>{const S=Number(w.hours);return v+(Number.isFinite(S)?S:0)},0),y=[];for(let v=0;v<11;v++){const w=m.reduce((S,j)=>{const k=Number((j.po&&j.po[v])??0);return S+(Number.isFinite(k)?k:0)},0);if(g>0){const S=w/g,j=Tp(S,2);y.push(j.toFixed(2))}else y.push("")}const b=[];for(let v=0;v<3;v++){const w=m.reduce((S,j)=>{const k=Number((j.pso&&j.pso[v])??0);return S+(Number.isFinite(k)?k:0)},0);if(g>0){const S=w/g,j=Tp(S,2);b.push(j.toFixed(2))}else b.push("")}return[p,...y,...b,g||""]};for(let f=0;f<5;f++)c.push(u(f,`CO${f+1}`));const d=(()=>{const f=[];c.forEach(y=>{const b=y[0],w=y.slice(1,15).map(k=>{if(k===""||k===null||k===void 0)return"";const A=Number(String(k));if(!Number.isFinite(A))return"";const R=A*3,M=Tp(R,2);return M===0?"":M.toFixed(2)}),S=w.map(k=>k===""?null:Number(k)).filter(k=>k!==null),j=S.length?Tp(S.reduce((k,A)=>k+A,0)/S.length,2).toFixed(2):"";f.push([b,...w,j])});const h=[];for(let y=0;y<14;y++){const b=[];for(let v=0;v<f.length;v++){const w=f[v][1+y];if(w===""||w===null||w===void 0)continue;const S=Number(w);Number.isFinite(S)&&b.push(S)}b.length?h.push(Tp(b.reduce((v,w)=>v+w,0)/b.length,2).toFixed(2)):h.push("")}const m=f.map(y=>y[y.length-1]).filter(y=>y!=="").map(Number),g=m.length?Tp(m.reduce((y,b)=>y+b,0)/m.length,2).toFixed(2):"";return f.push(["Average",...h,g]),f})();return a.jsxs(a.Fragment,{children:[a.jsx(PF,{title:"CO  PO/PSO (Course Delivery)",headers:["COs",...Array.from({length:11},(f,p)=>`PO${p+1}`),...Array.from({length:3},(f,p)=>`PSO${p+1}`),"Course delivery"],rows:c,collapsedByDefault:!0}),a.jsx(PF,{title:"CO  PO/PSO Summary",headers:["COs",...Array.from({length:11},(f,p)=>`PO${p+1}`),...Array.from({length:3},(f,p)=>`PSO${p+1}`),"Average"],rows:d,collapsedByDefault:!1,showToggle:!1})]})})(),(l=n==null?void 0:n.rows)!=null&&l.length?a.jsxs("section",{children:[a.jsx("h3",{style:{margin:"6px 0 10px 0"},children:"CO  PO/PSO Summary"}),a.jsx(d3,{headers:["CO",...Array.from({length:11},(c,u)=>`PO${u+1}`),...Array.from({length:3},(c,u)=>`PSO${u+1}`),"Average"],rows:[...n.rows.map(c=>[c.label,...c.po,...c.pso,c.average]),...n.average?[[n.average.label,...n.average.po,...n.average.pso,n.average.average]]:[]]})]}):null]})}const Da={container:{minHeight:"100vh",background:"linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%)",padding:"2rem"},card:{maxWidth:"1400px",margin:"0 auto",background:"#ffffff",borderRadius:"12px",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.07), 0 1px 3px rgba(0, 0, 0, 0.06)",overflow:"hidden"},header:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"2rem 2.5rem",borderBottom:"1px solid #e5e7eb"},title:{fontSize:"1.875rem",fontWeight:"700",color:"#ffffff",margin:"0",letterSpacing:"-0.025em"},subtitle:{fontSize:"0.95rem",color:"rgba(255, 255, 255, 0.9)",marginTop:"0.5rem",fontWeight:"400"},content:{padding:"2rem 2.5rem"},inputSection:{marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px",border:"1px solid #e5e7eb"},label:{display:"block",fontSize:"0.875rem",fontWeight:"600",color:"#374151",marginBottom:"0.5rem",textTransform:"uppercase",letterSpacing:"0.025em"},input:{width:"100%",padding:"0.75rem 1rem",fontSize:"1rem",border:"2px solid #e5e7eb",borderRadius:"6px",outline:"none",transition:"all 0.2s ease",fontFamily:"inherit"},inputFocus:{borderColor:"#667eea",boxShadow:"0 0 0 3px rgba(102, 126, 234, 0.1)"},actionBar:{display:"flex",gap:"1rem",alignItems:"center",flexWrap:"wrap",marginBottom:"1.5rem",padding:"1.25rem",background:"#f9fafb",borderRadius:"8px"},button:{padding:"0.75rem 1.5rem",fontSize:"0.95rem",fontWeight:"600",color:"#ffffff",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"6px",cursor:"pointer",transition:"all 0.2s ease",boxShadow:"0 2px 4px rgba(102, 126, 234, 0.3)",outline:"none"},buttonHover:{transform:"translateY(-1px)",boxShadow:"0 4px 8px rgba(102, 126, 234, 0.4)"},buttonDisabled:{background:"#9ca3af",cursor:"not-allowed",boxShadow:"none",opacity:.6},infoText:{fontSize:"0.875rem",color:"#6b7280",display:"flex",alignItems:"center",gap:"0.5rem"},infoIcon:{width:"16px",height:"16px",borderRadius:"50%",background:"#667eea",color:"#ffffff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"700"},alert:{padding:"1rem 1.25rem",borderRadius:"8px",fontSize:"0.925rem",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.75rem",fontWeight:"500"},alertSuccess:{background:"#d1fae5",color:"#065f46",border:"1px solid #6ee7b7"},alertError:{background:"#fee2e2",color:"#991b1b",border:"1px solid #fca5a5"},matrixContainer:{background:"#ffffff",borderRadius:"8px",border:"1px solid #e5e7eb",padding:"1.5rem",minHeight:"200px"},loadingSpinner:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTop:"2px solid #ffffff",borderRadius:"50%",animation:"spin 0.6s linear infinite",marginRight:"0.5rem"}};function TPe({courseId:e,embedded:t=!1}){const[r,n]=x.useState(e||""),[i,s]=x.useState(null),[o,l]=x.useState("idle"),[c,u]=x.useState(null),[d,f]=x.useState(!1),[p,h]=x.useState(!1);async function m(v){if(v){try{const w=new URLSearchParams(window.location.search),S=w.get("teaching_assignment_id")||w.get("teachingAssignmentId");if(S){const j=Number(S);if(Number.isFinite(j))return j}}catch{}try{const S=(await hc()||[]).find(k=>String(k==null?void 0:k.subject_code)===String(v)),j=(S==null?void 0:S.id)!=null?Number(S.id):NaN;if(Number.isFinite(j))return j}catch{}}}x.useEffect(()=>{r&&(async()=>{l("loading"),u(null);try{const v=await m(r),w=await B4(r,v);s(w),l("success")}catch(v){s(null),l("error"),u((v==null?void 0:v.message)||"Articulation Matrix fetch failed.")}})()},[r]);async function g(){if(r){l("loading"),u(null);try{const v=await m(r),w=await B4(r,v);s(w),l("success");const S=Array.isArray(w==null?void 0:w.units)?w.units.length:0;u(`Loaded articulation matrix from saved CDAP. Units: ${S}.`)}catch(v){l("error"),u((v==null?void 0:v.message)||"Articulation Matrix fetch failed.")}}}const y=t?{padding:0}:Da.container,b=t?{...Da.card,maxWidth:"100%",margin:0,borderRadius:12,boxShadow:"none"}:Da.card;return a.jsxs("div",{style:y,children:[a.jsx("style",{children:`
        @keyframes spin {
          to { transform: rotate(360deg); }
        }
      `}),a.jsxs("div",{style:b,children:[!t&&a.jsxs("div",{style:Da.header,children:[a.jsx("h1",{style:Da.title,children:"Articulation Matrix"}),a.jsx("p",{style:Da.subtitle,children:r?`Course: ${r}`:"Select a course to view the articulation matrix"})]}),a.jsxs("div",{style:t?{padding:0}:Da.content,children:[!e&&a.jsxs("div",{style:Da.inputSection,children:[a.jsx("label",{style:Da.label,children:"Course ID"}),a.jsx("input",{value:r,onChange:v=>n(v.target.value),placeholder:"Enter course identifier (e.g., CS101)",style:{...Da.input,...d?Da.inputFocus:{}},onFocus:()=>f(!0),onBlur:()=>f(!1)})]}),a.jsxs("div",{style:Da.actionBar,children:[a.jsxs("button",{onClick:g,disabled:o==="loading"||!r,style:{...Da.button,...o==="loading"||!r?Da.buttonDisabled:{},...p&&o!=="loading"&&r?Da.buttonHover:{}},onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[o==="loading"&&a.jsx("span",{style:Da.loadingSpinner}),o==="loading"?"Loading...":"Refresh Matrix"]}),a.jsxs("span",{style:Da.infoText,children:[a.jsx("span",{style:Da.infoIcon,children:"i"}),"Uses saved CDAP ticks + hours (no upload required)"]})]}),c&&a.jsxs("div",{style:{...Da.alert,...o==="error"?Da.alertError:Da.alertSuccess},children:[a.jsx("span",{style:{fontSize:"1.25rem"},children:o==="error"?"":""}),c]}),a.jsx("div",{style:Da.matrixContainer,children:a.jsx(EPe,{subjectId:r,matrix:i})})]})]})]})}const PPe="https://db.krgi.co.in",OPe=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":PPe;function MPe(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function LPe(e,t){if(e===401)return"Authentication required. Please login and try again.";if(e===403)return"Permission required to upload CDAP Excel files.";if(e===400)return"Invalid file. Please upload a valid CDAP Excel template.";if(e===404)return"Upload endpoint not found. Please contact admin.";const r=(t||"").trim();return r&&!r.startsWith("<")?r:`Upload failed with status ${e}. Please try again.`}function RPe({subjectId:e,onUpload:t}){const[r,n]=x.useState(null),[i,s]=x.useState("idle"),[o,l]=x.useState(null),[c,u]=x.useState(null);async function d(){var y,b,v;if(!r){s("error"),l("Please choose an Excel file first.");return}s("uploading"),l(null);const h=new FormData;h.append("file",r),e&&h.append("subject_id",e);const m=new AbortController,g=setTimeout(()=>m.abort(),6e4);try{const w={...MPe()},S=await fetch(`${OPe}/api/obe/upload-cdap`,{method:"POST",headers:w,body:h,signal:m.signal});if(!S.ok){const R=await S.text();s("error"),l(LPe(S.status,R));return}const j=await S.json(),k={rows:Array.isArray(j==null?void 0:j.rows)?j.rows:[],textbook:((y=j==null?void 0:j.books)==null?void 0:y.textbook)??(j==null?void 0:j.textbook)??"",reference:((b=j==null?void 0:j.books)==null?void 0:b.reference)??(j==null?void 0:j.reference)??"",activeLearningOptionsByRow:((v=j==null?void 0:j.active_learning)==null?void 0:v.optionsByRow)??(j==null?void 0:j.activeLearningOptions)??[],articulationExtras:(j==null?void 0:j.articulation_extras)??{}};u(k);const A=Array.isArray(j==null?void 0:j.rows)?j.rows.length:0;A?(s("success"),l(`Upload complete. Parsed ${A} rows from the Excel file.`)):(s("success"),l("Upload completed, but no rows were parsed. Please check the Excel template format.")),t&&t({revision:k,uploadedAt:new Date().toISOString()})}catch(w){s("error"),(w==null?void 0:w.name)==="AbortError"?l("Upload timed out. The server took too long to respond. Please try again."):l((w==null?void 0:w.message)||"Upload failed. Please try again.")}finally{clearTimeout(g),s(w=>w==="uploading"?"error":w)}}function f(h,m){for(const g of m){if(h==null)continue;if(h[g]!=null)return h[g];const y=String(g).toLowerCase();for(const b of Object.keys(h||{}))if(String(b).toLowerCase()===y)return h[b]}return""}function p(h){if(!h||!Array.isArray(h.rows)||!h.rows.length)return;const m=h.rows,g=["#","Content type","PART NO.","TOPICS TO BE COVERED (SYLLBUS TOPICS)","SUB TOPICS (WHAT TO BE TAUGHT)","BT LEVEL"],y=m.map((w,S)=>{const j=f(w,["content_type","contentType","Content type","content"]),k=f(w,["part_no","partNo","PART NO","part"]),A=f(w,["topics","topics_to_be_covered","Topics","TOPICS TO BE COVERED"]),R=f(w,["sub_topics","subTopics","Sub Topics","SUB TOPICS","sub_topics_to_be_taught"]),M=f(w,["bt_level","bt","BT LEVEL","btLevel"]);return`<tr>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${S+1}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(j??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(k??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(A??"")}</td>
        <td style="padding:6px;border:1px solid #ccc">${String(R??"")}</td>
        <td style="padding:6px;border:1px solid #ccc;text-align:center;">${String(M??"")}</td>
      </tr>`}).join(`
`),b=`<!doctype html><html><head><meta charset="utf-8"><title>CDAP Export</title>
      <style>body{font-family:Arial,Helvetica,sans-serif;font-size:12px;padding:20px}table{border-collapse:collapse;width:100%}th{background:#f3f4f6;padding:8px;border:1px solid #ddd;text-align:left}td{vertical-align:top}</style>
      </head><body>
      <h2>CDAP Export</h2>
      <p>Exported rows: ${m.length}</p>
      <table>
        <thead><tr>${g.map(w=>`<th>${w}</th>`).join("")}</tr></thead>
        <tbody>
          ${y}
        </tbody>
      </table>
      </body></html>`,v=window.open("","_blank");if(!v){alert("Popup blocked  allow popups for this site to export PDF.");return}v.document.write(b),v.document.close(),v.focus(),setTimeout(()=>{v.print()},300)}return a.jsxs("div",{children:[a.jsx("div",{style:{marginBottom:8},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:h=>{var m;return n(((m=h.target.files)==null?void 0:m[0])||null)}})}),a.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("button",{id:"cdap-upload-button",onClick:d,disabled:i==="uploading","aria-label":"Upload CDAP Excel file",title:"Upload parsed CDAP Excel",style:{background:"#1d4ed8",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",boxShadow:"0 8px 20px rgba(29,78,216,0.24)",fontWeight:600,cursor:i==="uploading"?"default":"pointer",transition:"transform 120ms ease, box-shadow 120ms ease, opacity 120ms ease",opacity:i==="uploading"?.65:1},onMouseDown:h=>{h.currentTarget.style.transform="translateY(1px)"},onMouseUp:h=>{h.currentTarget.style.transform="translateY(0)"},children:i==="uploading"?"Uploading...":"Upload Excel"}),r&&a.jsx("span",{style:{fontSize:12,color:"#555"},children:r.name})]}),i==="success"&&c&&Array.isArray(c.rows)&&c.rows.length>0&&a.jsx("div",{style:{marginTop:10},children:a.jsx("button",{onClick:()=>p(c),style:{background:"#047857",color:"#fff",padding:"8px 14px",borderRadius:8,border:"none",fontWeight:600,cursor:"pointer"},"aria-label":"Export PDF",title:"Export CDAP to PDF (will open print dialog)",children:"Export PDF"})}),o&&a.jsx("div",{style:{marginTop:8,fontSize:12,color:i==="error"?"#b91c1c":"#166534"},children:o})]})}const OF=[{key:"unit",label:"UNIT",type:"text"},{key:"unit_name",label:"SYLLABUS (UNIT NAME)",type:"text"},{key:"co",label:"OUTCOME (WRITE THE CO)",type:"text"},{key:"content_type",label:"Content type",type:"text"},{key:"part_no",label:"PART NO.",type:"text"},{key:"topics",label:"TOPICS TO BE COVERED (SYLLBUS TOPICS)",type:"text"},{key:"sub_topics",label:"SUB TOPICS (WHAT TO BE TAUGHT)",type:"text"},{key:"bt_level",label:"BT LEVEL",type:"text"}],MF=Array.from({length:11},(e,t)=>({key:`po${t+1}`,label:`PO${t+1}`,type:"checkbox",group:"po_pso"})),LF=Array.from({length:3},(e,t)=>({key:`pso${t+1}`,label:`PSO${t+1}`,type:"checkbox",group:"po_pso"})),lo=["SSA1","SSA2","ACTIVE LEARNING 1 (SKILL)","ACTIVE LEARNING 2 (SKILL)","ACTIVE LEARNING 1 (ATTITUDE)","ACTIVE LEARNING 2 (ATTITUDE)","SPECIAL ACTIVITY"],Of=Array.from({length:11},(e,t)=>`PO${t+1}`),pv={SSA1:["Technical magazine","Journal paper reading","Real time problems","Case study"],SSA2:["Technical magazine","Journal paper reading","Real time problems","Case study"],"ACTIVE LEARNING 1 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 2 (SKILL)":["Dipstick (Writing explanation content of CO)","Dipstick (Sketch Representation)","Real time Photography or Video Explanation","Course competition"],"ACTIVE LEARNING 1 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"ACTIVE LEARNING 2 (ATTITUDE)":["Active Learing Exercies (Group Discussion)","Active Learing Exercies (Technical Question and answering Session)","Technical Role play","Interview Assessment"],"SPECIAL ACTIVITY":["Active Projects","Journal Preparation"]};function FPe({subjectId:e,imported:t,onLockChange:r}){const n=x.useMemo(()=>{if(e)try{const ve=localStorage.getItem(`markEntry_selectedTa_${e}`),Ae=ve==null?NaN:Number(ve);return Number.isFinite(Ae)?Ae:void 0}catch{return}},[e]),i=(ve,Ae)=>{const ce=[...Ae];for(let be=0;be<ve.length;be++){const mt=ve[be]??[];(!ce[be]||String(ce[be]).trim()==="")&&Array.isArray(mt)&&mt.length===1&&(ce[be]=String(mt[0]??"").trim())}return ce},s=x.useRef(null),[o,l]=x.useState(!0),[c,u]=x.useState(1),[d,f]=x.useState(()=>{if(!e)return 100;try{const ve=localStorage.getItem(`cdap_zoom_${e}`);return ve?parseInt(ve,10):100}catch{return 100}}),[p,h]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState(()=>lo.map(()=>Of.map(()=>!1))),[v,w]=x.useState(()=>lo.map(()=>"")),[S,j]=x.useState(()=>tne()),[k,A]=x.useState(()=>lo.map(ve=>pv[ve]??[])),[R,M]=x.useState({}),[B,E]=x.useState(!1),[P,D]=x.useState(null),[G,H]=x.useState(!1),{data:oe,loading:de,error:W,refresh:V}=lc({assessment:"cdap",subjectCode:String(e||""),scope:"MARK_ENTRY",teachingAssignmentId:n,options:{poll:!0}}),ae=!!G,ee=!!(oe!=null&&oe.allowed_by_approval),C=!!(ae&&!ee),[Y,q]=x.useState(!1),[O,X]=x.useState(""),[F,Q]=x.useState(!1),[K,ne]=x.useState(null);x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_active_learning_draft_${e}`,JSON.stringify({dropdowns:v,grid:y,ts:Date.now()})),window.dispatchEvent(new CustomEvent("cdap-active-learning-changed",{detail:{subjectId:e}}))}catch{}},[e,v,y]),x.useEffect(()=>{if(e)try{localStorage.setItem(`cdap_zoom_${e}`,d.toString())}catch{}},[e,d]);const re=ve=>String(ve??"").replace(/\s+/g," ").trim().toUpperCase().includes("#N/A"),T=ve=>ve.filter(Ae=>!re(Ae==null?void 0:Ae.content_type)),I=x.useMemo(()=>[...OF,...MF,...LF],[]),ie=x.useMemo(()=>{const ve={};for(const Ae of I)ve[Ae.key]=Ae.type==="checkbox"?!1:"";return ve},[I]),[U,Z]=x.useState(()=>[structuredClone(ie)]),me=ve=>{const Ae=Fc(ve);if(Ae===Fc("SPECIAL ACTIVITY")){const ce=Fc("Active Projects");if(Array.isArray(S==null?void 0:S[ce])&&S[ce].length===11)return S[ce]}if(Array.isArray(S==null?void 0:S[Ae])&&S[Ae].length===11)return S[Ae];for(const ce of Bm){const be=Fc(ce);if(be===Ae&&Array.isArray(S==null?void 0:S[be])&&S[be].length===11)return S[be]}for(const ce of Bm){const be=Fc(ce);if((be.includes(Ae)||Ae.includes(be))&&Array.isArray(S==null?void 0:S[be])&&S[be].length===11)return S[be]}return null},Pe=(ve,Ae)=>{const ce=ve.map(be=>[...be]);for(let be=0;be<lo.length;be++){const mt=(Ae==null?void 0:Ae[be])??"";if(!mt)continue;const et=me(mt);if(!(!Array.isArray(et)||et.length!==11))for(let Ue=0;Ue<Of.length;Ue++)ce[be][Ue]=!!et[Ue]}return ce};x.useEffect(()=>{if(!e)return;let ve=!0;return(async()=>{try{D(null),E(!0);const ce=await I9(e,n);if(!ve)return;const be=String((ce==null?void 0:ce.status)||"").toLowerCase()==="published";if(H(be),be&&(q(!1),ne(null)),!ce){Z([structuredClone(ie)]),h(""),g(""),b(lo.map(()=>Of.map(()=>!1))),w(lo.map(()=>"")),A(lo.map(Br=>pv[Br]??[])),H(!1);return}const mt=Array.isArray(ce.rows)?ce.rows:[];Z(mt.length?T(mt):[structuredClone(ie)]);const et=ce.books&&typeof ce.books=="object"?ce.books:{};h(typeof et.textbook=="string"?et.textbook:""),g(typeof et.reference=="string"?et.reference:"");const Ue=ce.active_learning&&typeof ce.active_learning=="object"?ce.active_learning:{},It=Array.isArray(Ue.dropdowns)?Ue.dropdowns.map(Br=>Br==null?"":String(Br)):[],ht=Array.isArray(Ue.grid)?Ue.grid:[],Lt=Array.isArray(Ue.optionsByRow)?Ue.optionsByRow:null,yr=Ue.articulation_extras&&typeof Ue.articulation_extras=="object"?Ue.articulation_extras:{};M(yr);const Ar=lo.map((Br,Wr)=>Of.map((nn,fn)=>{var dn;const Ir=(dn=ht==null?void 0:ht[Wr])==null?void 0:dn[fn];return Ir===!0||Ir==="true"||Ir===1||Ir==="1"||String(Ir).trim().toLowerCase()==="x"?!0:!!Ir})),Tt=It.length===lo.length?It.slice(0,lo.length):lo.map(()=>""),Vr=Lt&&Array.isArray(Lt)?i(Lt,Tt):Tt;if(w(Vr),b(Pe(Ar,Vr)),Lt&&Array.isArray(Lt)){const Br=lo.map((Wr,nn)=>{const fn=Lt==null?void 0:Lt[nn];return Array.isArray(fn)?fn.map(Ir=>String(Ir??"")).map(Ir=>Ir.trim()).filter(Boolean):[]});A(Br)}else A(lo.map(Br=>pv[Br]??[]))}catch(ce){if(!ve)return;D((ce==null?void 0:ce.message)||"Failed to load CDAP from cloud"),Z([structuredClone(ie)])}finally{ve&&E(!1)}})(),()=>{ve=!1}},[e,ie]),x.useEffect(()=>{r&&r(!!C)},[C,r]),x.useEffect(()=>{let ve=!0;const Ae=async()=>{try{const be=await AN();ve&&j(be)}catch{}};Ae();const ce=Hre(()=>Ae());return()=>{ve=!1,ce()}},[]),x.useEffect(()=>{if(t&&!C){if(Array.isArray(t.rows)&&t.rows.length&&Z(T(t.rows)),typeof t.textbook=="string"&&h(t.textbook),typeof t.reference=="string"&&g(t.reference),Array.isArray(t.activeLearningOptionsByRow)&&t.activeLearningOptionsByRow.length){const ve=lo.map((be,mt)=>{var Ue;const et=(Ue=t.activeLearningOptionsByRow)==null?void 0:Ue[mt];return Array.isArray(et)?et.map(It=>String(It??"")).map(It=>It.trim()).filter(Boolean):[]}),ce=i(ve,v);A(ve),w(ce),b(be=>Pe(be,ce))}t.articulationExtras&&typeof t.articulationExtras=="object"&&M(t.articulationExtras)}},[t,C]);const je=async()=>{if(!e)return;const ve=String(O||"").trim();if(!ve){ne("Reason is required.");return}Q(!0),ne(null);try{const Ae=await sl({assessment:"cdap",subject_code:e,scope:"MARK_ENTRY",reason:ve,teaching_assignment_id:n});alert(ol(Ae)),q(!1)}catch(Ae){const ce=ll(Ae,"Failed to request edit");ne(ce),alert(`Edit request failed: ${ce}`)}finally{Q(!1),V()}};x.useEffect(()=>{b(ve=>Pe(ve,v))},[S]);const Fe=x.useMemo(()=>{const ve=new Map;let Ae=null;return U.forEach((ce,be)=>{const mt=ce.unit??"",et=mt!==""?String(mt):"";et&&(Ae=et);const Ue=et||Ae||String(Math.floor(be/9)+1),It=ve.get(Ue)??{key:Ue,items:[]};It.items.push({row:ce,index:be}),ve.set(Ue,It)}),Array.from(ve.values()).sort((ce,be)=>{const mt=Number(ce.key),et=Number(be.key);return!Number.isNaN(mt)&&!Number.isNaN(et)?mt-et:ce.key.localeCompare(be.key)})},[U]),_e=(ve,Ae,ce)=>{if(Ae==="content_type"&&re(ce)){Z(be=>be.filter((mt,et)=>et!==ve));return}Z(be=>{const mt=[...be];return mt[ve]={...mt[ve],[Ae]:ce},mt})},He=()=>Z(ve=>[...ve,structuredClone(ie)]),qe=ve=>Z(Ae=>Ae.filter((ce,be)=>be!==ve)),Pt=ve=>{Z(Ae=>{const ce=structuredClone(ie);ce.unit=ve;let be=null,mt=-1,et=-1;for(let It=0;It<Ae.length;It++){const ht=Ae[It].unit??"",Lt=ht!==""?String(ht):"";Lt&&(be=Lt),(Lt||be||String(Math.floor(It/9)+1))===String(ve)&&(et===-1&&(et=It),mt=It)}return et!==-1&&(ce.unit_name=Ae[et].unit_name??"",ce.co=Ae[et].co??""),mt===-1?[...Ae,ce]:[...Ae.slice(0,mt+1),ce,...Ae.slice(mt+1)]})},ut=async()=>{if(!e){alert("No subject selected.");return}try{D(null),E(!0),await D9({subjectId:e,status:"published",teaching_assignment_id:n,rows:U,books:{textbook:p,reference:m},active_learning:{grid:y,dropdowns:v,optionsByRow:k,articulation_extras:R}}),H(!0),alert("Published to cloud.")}catch(ve){alert((ve==null?void 0:ve.message)||"Failed to save to cloud")}finally{E(!1),V()}};x.useEffect(()=>{if(!o){u(1);return}const ve=()=>{const be=s.current;if(!be)return;const mt=be.querySelector('table[data-cdap-table="1"]');if(!mt)return;const et=be.clientWidth,Ue=mt.scrollWidth;if(!et||!Ue)return;const ht=(et-24)/Ue,Lt=Math.min(1,Math.max(.35,ht));u(Lt)};ve();const Ae=s.current;if(!Ae)return;const ce=new ResizeObserver(()=>ve());return ce.observe(Ae),()=>ce.disconnect()},[o,U]);const Ke=OF.slice(3,8),lt=[...MF,...LF];return a.jsxs("div",{style:{border:"1px solid #dbe4f0",borderRadius:14,padding:"16px 18px",background:"#fff",boxShadow:"0 2px 12px rgba(15, 23, 42, 0.08)",width:"100%",boxSizing:"border-box",overflow:"hidden"},children:[a.jsx("style",{children:`
        .cdap-slider::-webkit-slider-thumb {
          appearance: none;
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        .cdap-slider::-moz-range-thumb {
          height: 14px;
          width: 14px;
          border-radius: 50%;
          background: #2563eb;
          cursor: pointer;
          border: none;
        }
        .cdap-slider::-webkit-slider-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
        }
        .cdap-slider::-moz-range-track {
          background: #e5e7eb;
          height: 6px;
          border-radius: 999px;
          border: none;
        }
        .cdap-table-wrap { overflow-x: auto; border: 1px solid #e2e8f0; border-radius: 10px; }
        .cdap-table { border-collapse: collapse; width: 100%; font-size: 11px; table-layout: fixed; }
        .cdap-table thead th {
          position: sticky;
          top: 0;
          z-index: 2;
          border: 1px solid #e2e8f0;
          padding: 5px 4px;
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.03em;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }
        .cdap-table tbody tr:hover td { background: #eff6ff !important; }
        .cdap-table tbody td { border: 1px solid #e2e8f0; padding: 3px 4px; vertical-align: top; }
        .cdap-cell-textarea {
          width: 100%;
          border: 1px solid #cbd5e1;
          border-radius: 4px;
          padding: 3px 5px;
          font-size: 11px;
          resize: none;
          font-family: inherit;
          line-height: 1.4;
        }
        .cdap-cell-textarea:focus { outline: none; border-color: #2563eb; box-shadow: 0 0 0 2px rgba(37,99,235,0.15); }
        .cdap-cell-textarea:disabled { background: #f3f4f6; cursor: not-allowed; color: #6b7280; }
        .cdap-unit-card {
          border: 1px solid #dbe4f0;
          border-radius: 12px;
          background: #fff;
          margin-bottom: 14px;
          overflow: hidden;
          box-shadow: 0 1px 4px rgba(15,23,42,0.05);
        }
        .cdap-unit-header {
          display: grid;
          grid-template-columns: 80px 1fr 1fr;
          gap: 0;
          border-bottom: 1px solid #dbe4f0;
          background: #f1f5f9;
        }
        .cdap-unit-header-cell {
          padding: 8px 10px;
          border-right: 1px solid #dbe4f0;
        }
        .cdap-unit-header-cell:last-child { border-right: none; }
        .cdap-unit-header-cell label {
          display: block;
          font-size: 10px;
          font-weight: 700;
          text-transform: uppercase;
          letter-spacing: 0.04em;
          color: #64748b;
          margin-bottom: 4px;
        }
        .cdap-unit-header-cell textarea {
          width: 100%;
          border: 1px solid #cbd5e1;
          border-radius: 6px;
          padding: 4px 6px;
          font-size: 12px;
          font-family: inherit;
          resize: none;
          background: #fff;
          line-height: 1.4;
        }
        .cdap-unit-header-cell textarea:focus { outline: none; border-color: #2563eb; }
        .cdap-unit-header-cell textarea:disabled { background: #f3f4f6; cursor: not-allowed; color: #6b7280; }
        .cdap-table-scale-wrap {
          transform-origin: left top;
        }
      `}),B?a.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#64748b"},children:"Loading from cloud"}):P?a.jsx("div",{style:{marginBottom:8,fontSize:12,color:"#b91c1c"},children:P}):null,C?a.jsx("div",{style:{marginBottom:12,padding:"12px 16px",background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",border:"1px solid #fbbf24",borderRadius:10,color:"#92400e",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:a.jsx("span",{children:" Published  Document is read-only. Use Request Edit to make changes."})}):null,de||W?a.jsx("div",{style:{marginBottom:10,fontSize:12,color:W?"#b91c1c":"#64748b"},children:W||"Checking edit approval"}):ae&&ee&&(oe!=null&&oe.approval_until)?a.jsxs("div",{style:{marginBottom:10,fontSize:12,color:"#065f46"},children:["Edit approved until ",new Date(oe.approval_until).toLocaleString(),"."]}):null,a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-between",alignItems:"center",gap:10,padding:"10px 14px",background:"linear-gradient(to right, #f8fafc, #f1f5f9)",border:"1px solid #e2e8f0",borderRadius:12,marginBottom:14},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[a.jsx("div",{style:{width:36,height:36,borderRadius:9,background:"linear-gradient(135deg, #1e40af 0%, #2563eb 100%)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"#fff",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2"}),a.jsx("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),a.jsx("line",{x1:"3",y1:"15",x2:"21",y2:"15"}),a.jsx("line",{x1:"9",y1:"3",x2:"9",y2:"21"})]})}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,color:"#0f172a",fontSize:13},children:"Revised CDP Editor"}),a.jsx("div",{style:{fontSize:11,color:"#64748b"},children:"Interactive spreadsheet interface"})]})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,background:"#fff",border:"1px solid #e2e8f0",borderRadius:8,padding:"5px 8px",boxShadow:"0 1px 2px rgba(0,0,0,0.04)"},children:[a.jsx("button",{type:"button",onClick:()=>f(ve=>Math.max(50,ve-10)),style:{background:"none",border:"none",cursor:"pointer",padding:"0 2px",display:"flex",alignItems:"center"},children:a.jsx(Jte,{size:14,color:"#64748b"})}),a.jsx("input",{type:"range",min:"50",max:"200",step:"10",value:d,onChange:ve=>f(parseInt(ve.target.value,10)),className:"cdap-slider",style:{width:80}}),a.jsx("button",{type:"button",onClick:()=>f(ve=>Math.min(200,ve+10)),style:{background:"none",border:"none",cursor:"pointer",padding:"0 2px",display:"flex",alignItems:"center"},children:a.jsx(Xte,{size:14,color:"#64748b"})}),a.jsxs("span",{style:{fontSize:11,color:"#334155",minWidth:32,textAlign:"right",fontVariantNumeric:"tabular-nums"},children:[d,"%"]})]}),a.jsxs("button",{onClick:()=>l(ve=>!ve),title:"Toggle fit-to-screen scaling",style:{padding:"6px 10px",borderRadius:8,border:o?"none":"1px solid #e2e8f0",background:o?"#111827":"#fff",color:o?"#fff":"#374151",cursor:"pointer",fontWeight:600,fontSize:11,display:"flex",alignItems:"center",gap:5,boxShadow:o?"0 2px 6px rgba(17,24,39,0.25)":"0 1px 2px rgba(0,0,0,0.04)",transition:"all 150ms ease"},children:[a.jsxs("svg",{width:"13",height:"13",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3"}),a.jsx("path",{d:"M21 8V5a2 2 0 0 0-2-2h-3"}),a.jsx("path",{d:"M3 16v3a2 2 0 0 0 2 2h3"}),a.jsx("path",{d:"M16 21h3a2 2 0 0 0 2-2v-3"})]}),"Fit Screen: ",o?"ON":"OFF"]}),a.jsxs("button",{onClick:He,disabled:C,style:{padding:"6px 12px",borderRadius:8,border:"none",background:C?"#d1d5db":"#059669",color:"#fff",cursor:C?"not-allowed":"pointer",fontWeight:600,fontSize:11,opacity:C?.5:1,display:"flex",alignItems:"center",gap:5,boxShadow:C?"none":"0 2px 6px rgba(5,150,105,0.28)"},children:[a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"Add Row"]}),a.jsx("button",{onClick:()=>{if(!C)return ut();q(ve=>!ve),ne(null)},disabled:F,style:{padding:"6px 14px",borderRadius:8,border:"none",background:C?"#16a34a":"#2563eb",color:"#fff",cursor:F?"not-allowed":"pointer",fontWeight:700,fontSize:11,opacity:F?.6:1,boxShadow:C?"0 2px 6px rgba(22,163,74,0.28)":"0 2px 6px rgba(37,99,235,0.28)"},children:C?" Request Edit":" Publish"})]})]}),C&&Y?a.jsxs("div",{style:{marginBottom:16,border:"1px solid #e2e8f0",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0f172a",marginBottom:8},children:"Reason (required)"}),a.jsx("textarea",{value:O,onChange:ve=>X(ve.target.value),rows:3,style:{width:"100%",padding:10,border:"1px solid #cbd5e1",borderRadius:10,fontSize:13,background:"#fff"},placeholder:"Why do you need to edit this published CDAP?"}),K?a.jsx("div",{style:{marginTop:8,fontSize:12,color:"#b91c1c",fontWeight:700},children:K}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",marginTop:10},children:[a.jsx("button",{type:"button",className:"obe-btn",onClick:()=>q(!1),disabled:F,children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-success",onClick:je,disabled:F||!String(O||"").trim(),children:F?"Requesting":"Confirm Request"})]})]}):null,a.jsx("div",{ref:s,children:Fe.map(ve=>{var ce;const Ae=(ce=ve.items[0])==null?void 0:ce.row;return Ae?a.jsxs("div",{className:"cdap-unit-card",children:[a.jsxs("div",{className:"cdap-unit-header",children:[a.jsxs("div",{className:"cdap-unit-header-cell",style:{background:"linear-gradient(135deg, #1e40af 0%, #2563eb 100%)"},children:[a.jsx("label",{style:{color:"rgba(255,255,255,0.75)"},children:"Unit #"}),a.jsx("textarea",{value:Ae.unit??"",onChange:be=>ve.items.forEach(mt=>_e(mt.index,"unit",be.target.value)),disabled:C,rows:2,style:{background:"rgba(255,255,255,0.15)",border:"1px solid rgba(255,255,255,0.3)",borderRadius:6,color:"#fff",padding:"4px 6px",fontSize:13,fontWeight:700,width:"100%",resize:"none",fontFamily:"inherit",cursor:C?"not-allowed":"text"}})]}),a.jsxs("div",{className:"cdap-unit-header-cell",children:[a.jsx("label",{children:"Syllabus (Unit Name)"}),a.jsx("textarea",{value:Ae.unit_name??"",onChange:be=>ve.items.forEach(mt=>_e(mt.index,"unit_name",be.target.value)),disabled:C,rows:2})]}),a.jsxs("div",{className:"cdap-unit-header-cell",children:[a.jsx("label",{children:"Course Outcome (CO)"}),a.jsx("textarea",{value:Ae.co??"",onChange:be=>ve.items.forEach(mt=>_e(mt.index,"co",be.target.value)),disabled:C,rows:2})]})]}),a.jsx("div",{className:"cdap-table-wrap",style:{margin:"0 0"},children:(()=>{const be=o?c*(d/100):d/100,mt=Math.max(1,100/be);return a.jsx("div",{className:"cdap-table-scale-wrap",style:{transform:`scale(${be})`,width:`${mt}%`},children:a.jsxs("table",{"data-cdap-table":"1",className:"cdap-table",style:{minWidth:1200},children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:34}}),a.jsx("col",{style:{width:90}}),a.jsx("col",{style:{width:70}}),a.jsx("col",{style:{width:190}}),a.jsx("col",{style:{width:190}}),a.jsx("col",{style:{width:62}}),lt.map(et=>a.jsx("col",{style:{width:34}},et.key)),a.jsx("col",{style:{width:82}}),a.jsx("col",{style:{width:66}})]}),a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{background:"#f1f5f9",textAlign:"center"},children:"#"}),Ke.map(et=>a.jsx("th",{style:{background:"#f1f5f9",textAlign:"left"},children:et.label},et.key)),lt.map(et=>a.jsx("th",{style:{background:et.key.startsWith("pso")?"#fdf4ff":"#fff7ed",textAlign:"center"},children:et.label},et.key)),a.jsx("th",{style:{background:"#f0fdf4",textAlign:"center"},children:"HRS"}),a.jsx("th",{style:{background:"#f1f5f9",textAlign:"center"},children:"Act."})]})}),a.jsx("tbody",{children:ve.items.map((et,Ue)=>a.jsx(x.Fragment,{children:a.jsxs("tr",{style:{background:Ue%2===0?"#fff":"#f8fafc"},children:[a.jsx("td",{style:{textAlign:"center",color:"#94a3b8",fontWeight:600,fontSize:10},children:Ue+1}),Ke.map(It=>a.jsx("td",{children:a.jsx("textarea",{value:et.row[It.key]??"",onChange:ht=>_e(et.index,It.key,ht.target.value),disabled:C,className:"cdap-cell-textarea",rows:2})},It.key)),lt.map(It=>a.jsx("td",{style:{textAlign:"center",background:It.key.startsWith("pso")?"#fdf4ff":void 0},children:a.jsx("input",{type:"checkbox",checked:!!et.row[It.key],onChange:ht=>_e(et.index,It.key,ht.target.checked),disabled:C,style:{cursor:C?"not-allowed":"pointer",width:14,height:14,accentColor:"#2563eb"}})},It.key)),a.jsx("td",{style:{textAlign:"center"},children:a.jsx("input",{type:"text",value:et.row.total_hours_required??"",onChange:It=>_e(et.index,"total_hours_required",It.target.value),disabled:C,style:{width:"100%",border:"1px solid #cbd5e1",borderRadius:4,padding:"3px 4px",fontSize:11,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text",textAlign:"center"}})}),a.jsx("td",{style:{textAlign:"center"},children:a.jsx("button",{type:"button",onClick:()=>qe(et.index),disabled:C,title:"Delete row",style:{padding:"3px 7px",background:C?"#d1d5db":"#fee2e2",color:C?"#9ca3af":"#dc2626",border:`1px solid ${C?"#d1d5db":"#fca5a5"}`,borderRadius:5,cursor:C?"not-allowed":"pointer",fontSize:11,fontWeight:600,opacity:C?.5:1},children:""})})]})},et.index))})]})})})()}),a.jsx("div",{style:{padding:"10px 14px",borderTop:"1px solid #f1f5f9"},children:a.jsxs("button",{type:"button",onClick:()=>Pt(ve.key),disabled:C,style:{padding:"6px 12px",background:C?"#e5e7eb":"#eff6ff",color:C?"#9ca3af":"#2563eb",border:`1px solid ${C?"#d1d5db":"#bfdbfe"}`,borderRadius:7,cursor:C?"not-allowed":"pointer",fontWeight:600,fontSize:12,opacity:C?.5:1,display:"flex",alignItems:"center",gap:5},children:[a.jsx("span",{style:{fontSize:14,lineHeight:1},children:"+"})," Add Row to Unit ",ve.key]})})]},ve.key):null})}),a.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#f8fafc"},children:[a.jsx("h4",{style:{marginBottom:10},children:"Reference Materials"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:16},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Textbook Details"}),a.jsx("textarea",{value:p,onChange:ve=>h(ve.target.value),disabled:C,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text"},placeholder:"Textbook details (Excel: Column B, Row 64)"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontSize:12,fontWeight:600},children:"Reference Book Details"}),a.jsx("textarea",{value:m,onChange:ve=>g(ve.target.value),disabled:C,rows:4,style:{width:"100%",padding:8,border:"1px solid #cbd5e1",borderRadius:8,marginTop:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"text"},placeholder:"Reference book details (Excel: Column B, Row 68)"})]})]})]}),a.jsxs("section",{style:{marginTop:16,padding:16,border:"1px solid #e2e8f0",borderRadius:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0},children:"Active Learning Mapping"}),a.jsx("div",{style:{fontSize:12,color:"#64748b"},children:"7  11 PO mapping matrix"})]}),a.jsx("button",{type:"button",onClick:()=>{b(lo.map(()=>Of.map(()=>!1))),w(lo.map(()=>""))},disabled:C,style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e2e8f0",background:C?"#e5e7eb":"#f8fafc",cursor:C?"not-allowed":"pointer",opacity:C?.5:1},children:"Clear All"})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",minWidth:900,width:"100%"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Activity Type"}),a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#f8fafc",textAlign:"left"},children:"Specific Activity"}),Of.map(ve=>a.jsx("th",{style:{border:"1px solid #e2e8f0",padding:8,background:"#fff7ed",textAlign:"center"},children:ve},ve))]})}),a.jsx("tbody",{children:lo.map((ve,Ae)=>a.jsxs("tr",{style:{background:Ae%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,fontWeight:600},children:ve}),a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8},children:a.jsxs("select",{value:v[Ae]??"",onChange:ce=>{const be=ce.target.value;w(mt=>{const et=[...mt];return et[Ae]=be,et}),b(mt=>{const et=mt.map(It=>[...It]),Ue=me(be);if(Array.isArray(Ue)&&Ue.length===11)for(let It=0;It<Of.length;It++)et[Ae][It]=!!Ue[It];return et})},disabled:C,style:{width:"100%",padding:6,border:"1px solid #cbd5e1",borderRadius:6,background:C?"#f3f4f6":"#fff",cursor:C?"not-allowed":"pointer"},children:[a.jsx("option",{value:"",children:"-- Select Activity --"}),(Array.isArray(k==null?void 0:k[Ae])&&(k!=null&&k[Ae].length)?k==null?void 0:k[Ae]:pv[ve]??[]).map(mt=>String(mt??"").trim()).filter(Boolean).filter((mt,et,Ue)=>Ue.indexOf(mt)===et).map(mt=>a.jsx("option",{value:mt,children:mt},mt))]})}),Of.map((ce,be)=>a.jsx("td",{style:{border:"1px solid #e2e8f0",padding:8,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!y[Ae][be],disabled:C||(()=>{const mt=(v==null?void 0:v[Ae])??"";if(!mt)return!1;const et=me(mt);return Array.isArray(et)&&et.length===11})(),onChange:mt=>{const et=mt.target.checked;b(Ue=>{const It=Ue.map(ht=>[...ht]);return It[Ae][be]=et,It})},style:{cursor:C?"not-allowed":"pointer"}})},ce))]},ve))})]})})]})]})}function BPe({courseId:e,showHeader:t=!0,showCourseInput:r=!0}){const[n,i]=x.useState(e||""),[s,o]=x.useState(null),[l,c]=x.useState("idle"),[u,d]=x.useState(null),[f,p]=x.useState(!1),h=Jr.useMemo(()=>{if(n)try{const m=localStorage.getItem(`markEntry_selectedTa_${n}`),g=m==null?NaN:Number(m);return Number.isFinite(g)?g:void 0}catch{return}},[n]);return x.useEffect(()=>{e&&i(e)},[e]),a.jsxs("div",{children:[t&&a.jsxs("h2",{children:["CDAP - ",n||"No course selected"]}),r&&!e&&a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("label",{style:{marginRight:8},children:"Course ID:"}),a.jsx("input",{value:n,onChange:m=>i(m.target.value),placeholder:"Enter course id",style:{padding:6,border:"1px solid #ccc",borderRadius:4}})]}),f?null:a.jsx("div",{style:{marginBottom:12},children:a.jsx(RPe,{subjectId:n,onUpload:async m=>{o(m);const g=(m==null?void 0:m.revision)||m;if(!(!n||!g)&&!(!Array.isArray(g==null?void 0:g.rows)||g.rows.length===0))try{c("saving"),d(null);const y=D9({subjectId:n,status:"draft",rows:g.rows,books:{textbook:g.textbook||"",reference:g.reference||""},teaching_assignment_id:h,active_learning:{grid:[],dropdowns:[],optionsByRow:g.activeLearningOptionsByRow||[],articulation_extras:g.articulationExtras||{}}}),b=new Promise((v,w)=>setTimeout(()=>w(new Error("Auto-save timed out. Server did not respond in time.")),6e4));await Promise.race([y,b]),c("saved"),d("Saved parsed CDAP to cloud (draft).")}catch(y){c("error"),d((y==null?void 0:y.message)||"Auto-save failed. You can still publish from the editor.")}}})}),u&&a.jsx("div",{style:{marginBottom:12,fontSize:12,color:l==="error"?"#b91c1c":"#166534"},children:u}),a.jsx("div",{style:{marginBottom:12},children:a.jsx(FPe,{subjectId:n,imported:(s==null?void 0:s.revision)||s,onLockChange:m=>p(!!m)})})]})}function Pp({value:e,onChange:t,min:r,max:n}){return a.jsx("input",{type:"number",value:e,onChange:i=>{const s=i.target.value;t(s===""?"":Number(s))},min:r,max:n,style:{width:76,padding:"6px 8px",borderRadius:8,border:"1px solid #e6eef8",outline:"none",fontSize:13}})}function RF(e){const t=typeof e.band1=="number"?e.band1:0,r=typeof e.band2=="number"?e.band2:0,n=typeof e.band3=="number"?e.band3:0;if(!(t+r+n))return"-";const s=Math.max(t,r,n);return s===t?1:s===r?2:3}function IPe(e){return e===1?{label:"LOW LEVEL",code:"LL"}:e===2?{label:"MEDIUM LEVEL",code:"ML"}:e===3?{label:"HIGH LEVEL",code:"HL"}:{label:"",code:"-"}}const sr={page:{padding:20,width:"100%",boxSizing:"border-box",minHeight:"100vh",display:"flex",justifyContent:"center",alignItems:"flex-start",margin:0,fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947",background:"transparent"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)",width:"100%",maxWidth:1200,margin:"18px",flex:"1 1 auto"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},table:{width:"100%",borderCollapse:"collapse",marginTop:8,tableLayout:"auto",display:"block",overflowX:"auto",WebkitOverflowScrolling:"touch"},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13,whiteSpace:"nowrap"},thLeft:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"left",fontSize:13,whiteSpace:"nowrap",minWidth:220},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left",minWidth:220},cellYellow:{background:"#fef9c3"},cellGreen:{background:"#ecfdf3"},link:{color:"#0b4a6f",textDecoration:"underline",fontWeight:700},btn:{border:"1px solid #e6eef8",background:"#fbfdff",padding:"8px 10px",borderRadius:10,cursor:"pointer",fontWeight:700,color:"#0b4a6f"},pill:{display:"inline-flex",alignItems:"center",gap:8,padding:"8px 10px",borderRadius:10,background:"#fbfdff",border:"1px solid #e6eef8",fontSize:13,color:"#234451"}};function pk(e){return String(e||"").trim().toLowerCase().replace(/\s+/g,"").replace(/[^a-z0-9]/g,"")}function DPe(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=parseFloat(e.replace(/[^0-9.\-]/g,""));return Number.isFinite(t)?t:null}return null}function $Pe(e){return e<=6?"HC":e<=8?"MC":"EC"}function UPe(e){return e==="EC"?"L1":e==="MC"?"L2":e==="HC"?"L3":"-"}async function zPe(e){var m;let t;try{t=await import("xlsx")}catch{throw new Error('Missing dependency "xlsx". Install it with: npm install xlsx  (or yarn add xlsx / pnpm add xlsx)')}const r=await e.arrayBuffer(),n=t.read(r,{type:"array"}),i=(m=n.SheetNames)==null?void 0:m[0];if(!i)throw new Error("No sheet found in the Excel file.");const s=n.Sheets[i],o=t.utils.sheet_to_json(s,{defval:""})||[];if(!o.length)throw new Error("Excel sheet is empty.");const l=Object.keys(o[0]||{}),c=new Map;l.forEach(g=>c.set(pk(g),g));const u=c.get("grade")||l.find(g=>pk(g).includes("grade"))||null,d=c.get("gpaconversion")||c.get("gpaconvert")||l.find(g=>{const y=pk(g);return y.includes("gpaconversion")||y.includes("gpaconvert")||y==="gpa"})||null;if(!u||!d)throw new Error('Excel must contain columns for "Grade" and "GPA conversion".');const f=[];for(const g of o){if(!String(g[u]??"").trim())continue;const b=DPe(g[d]);b!==null&&f.push(b)}if(!f.length)throw new Error('No numeric "GPA conversion" values found.');const p=f.reduce((g,y)=>g+y,0)/f.length,h=Number(p.toFixed(2));return{fileName:e.name,studentsCount:f.length,meanGpa:h,courseLevel:$Pe(h)}}function WPe({courseId:e,courseCode:t,courseName:r,embedded:n}){const i=hl(),s=bo(),o=(i.pathname||"").toLowerCase().includes("/lca/pbr"),[l,c]=x.useState({courseCode:t??e??"",courseName:r??"",credit:"",courseModule:""});x.useEffect(()=>{c(ae=>({...ae,courseCode:t??e??ae.courseCode,courseName:r??ae.courseName}))},[e,t,r]);const[u,d]=x.useState({band1:"",band2:"",band3:""}),f=x.useMemo(()=>RF(u),[u]),[p,h]=x.useState([{name:"Prerequisite 1",band1:"",band2:"",band3:""}]),m=x.useMemo(()=>p.map(ae=>RF({band1:ae.band1,band2:ae.band2,band3:ae.band3})),[p]),g=x.useMemo(()=>{const ae=m.filter(C=>C!=="-");if(!ae.length)return"";const ee=ae.reduce((C,Y)=>C+Y,0);return Number((ee/ae.length).toFixed(2))},[m]),y=x.useMemo(()=>g===""?"":Math.floor(g),[g]),b=x.useMemo(()=>y===""||y===0?"-":y===1||y===2||y===3?y:"-",[y]),v=x.useMemo(()=>IPe(b),[b]),w=x.useMemo(()=>b==="-"?"-":`L${b}`,[b]),[S,j]=x.useState(null),[k,A]=x.useState(null),[R,M]=x.useState(null),[B,E]=x.useState(null),[P,D]=x.useState("-"),G=x.useMemo(()=>k?k.courseLevel:S?S.courseLevel:P&&P!=="-"?P:"-",[S,k,P]),H=x.useMemo(()=>UPe(G),[G]),oe=x.useMemo(()=>H!=="-"?H:w,[w,H]),de=e?`/obe/course/${encodeURIComponent(e)}`:"/obe/course",W=async(ae,ee)=>{if(M(null),!ee){ae==="cay1"?j(null):A(null);return}try{E(ae);const C=await zPe(ee);ae==="cay1"?j(C):A(C)}catch(C){M(String((C==null?void 0:C.message)||C||"Failed to parse Excel")),ae==="cay1"?j(null):A(null)}finally{E(null)}},V=ae=>n?a.jsx(a.Fragment,{children:ae}):a.jsx("div",{style:sr.page,children:a.jsx("div",{style:sr.card,children:ae})});return V(o?a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12},children:[a.jsxs("div",{children:[a.jsx("h2",{style:sr.title,children:"Previous Batch Result (PBR)"}),a.jsx("div",{style:sr.subtitle,children:"Upload up to 2 Excel files (max 2)."})]}),a.jsx("button",{type:"button",onClick:()=>s(`${de}/lca`),style:sr.btn,children:"Back"})]}),a.jsx("div",{style:{height:14}}),a.jsxs("div",{style:{marginBottom:8,display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{color:"#0b4a6f",fontWeight:700},children:"Fallback course level (if no Excel):"}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"HC",checked:P==="HC",onChange:()=>D("HC")}),"HARD COURSE (HC)"]}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"MC",checked:P==="MC",onChange:()=>D("MC")}),"MEDIUM COURSE (MC)"]}),a.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[a.jsx("input",{type:"radio",name:"pbrManual",value:"EC",checked:P==="EC",onChange:()=>D("EC")}),"EASY COURSE (EC)"]}),a.jsx("button",{type:"button",onClick:()=>D("-"),style:{marginLeft:8,...sr.btn,padding:"6px 8px"},children:"Clear"})]}),a.jsx("table",{style:sr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:800,width:220},children:"CAY-1 Excel"}),a.jsx("td",{style:{...sr.tdLeft,...sr.cellGreen},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ae=>{var ee;return W("cay1",((ee=ae.target.files)==null?void 0:ee[0])||null)}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:800},children:"CAY-2 Excel"}),a.jsx("td",{style:{...sr.tdLeft,...sr.cellGreen},children:a.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:ae=>{var ee;return W("cay2",((ee=ae.target.files)==null?void 0:ee[0])||null)}})})]})]})}),B&&a.jsxs("div",{style:{marginTop:10,fontSize:13,color:"#3d5566"},children:["Parsing ",B.toUpperCase()," Excel"]}),R&&a.jsx("div",{style:{marginTop:10,fontSize:13,color:"#b42318",fontWeight:700},children:R}),a.jsx("div",{style:{height:14}}),a.jsxs("table",{style:sr.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:sr.thLeft,children:"DATASET"}),a.jsx("th",{style:sr.th,children:"FILE"}),a.jsx("th",{style:sr.th,children:"STUDENTS"}),a.jsx("th",{style:sr.th,children:"MEAN GPA"}),a.jsx("th",{style:sr.th,children:"COURSE LEVEL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:900},children:"CAY-1"}),a.jsx("td",{style:sr.tdLeft,children:(S==null?void 0:S.fileName)||""}),a.jsx("td",{style:sr.td,children:(S==null?void 0:S.studentsCount)??""}),a.jsx("td",{style:sr.td,children:S?S.meanGpa:""}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:(S==null?void 0:S.courseLevel)||""})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:900},children:"CAY-2"}),a.jsx("td",{style:sr.tdLeft,children:(k==null?void 0:k.fileName)||""}),a.jsx("td",{style:sr.td,children:(k==null?void 0:k.studentsCount)??""}),a.jsx("td",{style:sr.td,children:k?k.meanGpa:""}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:(k==null?void 0:k.courseLevel)||""})]})]})]}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:sr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:900,width:220},children:"PREVIOUS BATCH RESULT (PBR)"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:G==="-"?"":G}),a.jsx("td",{style:{...sr.tdLeft,fontWeight:900},children:"Learner Centric Level"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:H==="-"?"":H})]}),a.jsx("tr",{children:a.jsx("td",{style:{...sr.tdLeft,color:"#557085"},colSpan:4,children:"Course level rule: mean GPA 06 = HC, 68 = MC, >8 = EC. PBR uses CAY-2 when provided; otherwise CAY-1."})})]})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},children:[a.jsxs("div",{children:[a.jsx("h2",{style:sr.title,children:"Learner Centric Approach"}),a.jsx("div",{style:sr.subtitle,children:"Enter values in the highlighted cells; levels are computed automatically."})]}),a.jsx("div",{style:{...sr.pill,fontWeight:800},children:"INDEX"})]}),a.jsx("table",{style:sr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,width:220,fontWeight:700},children:"COURSE CODE"}),a.jsx("td",{style:{...sr.tdLeft,...sr.cellGreen},children:a.jsx("input",{value:l.courseCode,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course code is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:700},children:"COURSE NAME"}),a.jsx("td",{style:{...sr.tdLeft,...sr.cellGreen},children:a.jsx("input",{value:l.courseName,readOnly:!0,disabled:!0,"aria-disabled":"true",title:"Course name is locked",style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none",cursor:"not-allowed",color:"#234451"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:700},children:"CREDIT OF THE COURSE"}),a.jsx("td",{style:{...sr.tdLeft,...sr.cellGreen},children:a.jsx("input",{value:l.credit,onChange:ae=>c(ee=>({...ee,credit:ae.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:700},children:"COURSE MODULE"}),a.jsx("td",{style:{...sr.tdLeft,...sr.cellGreen},children:a.jsx("input",{value:l.courseModule,onChange:ae=>c(ee=>({...ee,courseModule:ae.target.value})),style:{width:"100%",border:"none",background:"transparent",fontSize:13,outline:"none"}})})]})]})}),a.jsx("div",{style:{height:16}}),a.jsx("div",{style:sr.sectionTitle,children:"STEP 1: Identifying Learner profile"}),a.jsxs("table",{style:sr.table,children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:220}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:100}}),a.jsx("col",{style:{width:60}})]}),a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:sr.thLeft,colSpan:4,children:"1.1 CURRENT GPA PROFILE (CGP)"}),a.jsx("th",{style:sr.th,rowSpan:3,colSpan:2,children:"LEVEL"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:sr.thLeft,children:"Current batch mean GPA"}),a.jsx("th",{style:sr.th,children:"1"}),a.jsx("th",{style:sr.th,children:"2"}),a.jsx("th",{style:sr.th,children:"3"})]}),a.jsxs("tr",{children:[a.jsx("th",{style:sr.thLeft,children:"GPA"}),a.jsx("th",{style:sr.th,children:"0 - 5"}),a.jsx("th",{style:sr.th,children:"5 - 7.5"}),a.jsx("th",{style:sr.th,children:"> 7.5"})]})]}),a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:700},children:"NUMBER OF STUDENTS (CAY-1)"}),a.jsx("td",{style:{...sr.td,...sr.cellYellow},children:a.jsx(Pp,{value:u.band1,onChange:ae=>d(ee=>({...ee,band1:ae}))})}),a.jsx("td",{style:{...sr.td,...sr.cellYellow},children:a.jsx(Pp,{value:u.band2,onChange:ae=>d(ee=>({...ee,band2:ae}))})}),a.jsx("td",{style:{...sr.td,...sr.cellYellow},children:a.jsx(Pp,{value:u.band3,onChange:ae=>d(ee=>({...ee,band3:ae}))})}),a.jsx("td",{style:{...sr.td,fontWeight:800,color:"#0b4a6f"},colSpan:2,children:f})]})})]}),a.jsx("div",{style:{height:14}}),a.jsxs("table",{style:sr.table,children:[a.jsxs("colgroup",{children:[a.jsx("col",{style:{width:220}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:200}}),a.jsx("col",{style:{width:100}}),a.jsx("col",{style:{width:60}})]}),a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:sr.thLeft,colSpan:4,children:"1.2 PRE REQUISITE PROFILE (PRP)"}),a.jsx("th",{style:sr.th,children:"LEVEL"}),a.jsx("th",{style:sr.th,children:" "})]}),a.jsxs("tr",{children:[a.jsx("th",{style:sr.thLeft,children:" "}),a.jsx("th",{style:sr.th,children:"1"}),a.jsx("th",{style:sr.th,children:"2"}),a.jsx("th",{style:sr.th,children:"3"}),a.jsx("th",{style:sr.th,children:" "}),a.jsx("th",{style:sr.th,children:" "})]}),a.jsxs("tr",{children:[a.jsx("th",{style:sr.thLeft,children:" "}),a.jsx("th",{style:sr.th,children:"0 - 5"}),a.jsx("th",{style:sr.th,children:"5 - 7.5"}),a.jsx("th",{style:sr.th,children:"> 7.5"}),a.jsx("th",{style:sr.th,children:" "}),a.jsx("th",{style:sr.th,children:" "})]})]}),a.jsxs("tbody",{children:[p.map((ae,ee)=>a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:700},children:ae.name}),a.jsx("td",{style:{...sr.td,...sr.cellYellow},children:a.jsx(Pp,{value:ae.band1,onChange:C=>h(Y=>{const q=[...Y];return q[ee]={...q[ee],band1:C},q})})}),a.jsx("td",{style:{...sr.td,...sr.cellYellow},children:a.jsx(Pp,{value:ae.band2,onChange:C=>h(Y=>{const q=[...Y];return q[ee]={...q[ee],band2:C},q})})}),a.jsx("td",{style:{...sr.td,...sr.cellYellow},children:a.jsx(Pp,{value:ae.band3,onChange:C=>h(Y=>{const q=[...Y];return q[ee]={...q[ee],band3:C},q})})}),a.jsx("td",{style:{...sr.td,fontWeight:800,color:"#0b4a6f"},children:m[ee]}),a.jsx("td",{style:{...sr.td},children:a.jsx("button",{type:"button",title:"Delete prerequisite","aria-label":`Delete ${ae.name}`,onClick:()=>h(C=>C.filter((Y,q)=>q!==ee)),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:16},children:""})})]},ae.name)),a.jsx("tr",{children:a.jsxs("td",{style:{...sr.tdLeft},colSpan:6,children:[a.jsx("button",{type:"button",style:{...sr.btn,padding:"6px 10px"},onClick:()=>h(ae=>[...ae,{name:`Prerequisite ${ae.length+1}`,band1:"",band2:"",band3:""}]),"aria-label":"Add prerequisite",children:"+"}),a.jsx("span",{style:{marginLeft:10,fontSize:13,color:"#557085"},children:"Add next prerequisite"})]})}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:700},colSpan:5,children:"AVERAGE"}),a.jsx("td",{style:{...sr.td,fontWeight:800},children:g===""?"-":g})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:700},colSpan:5,children:"Standardized level of Learner profile as per the above norms"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900,color:"#0b4a6f"},children:b==="-"?"-":b})]})]})]}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:sr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,...sr.cellGreen,fontWeight:900},children:"LOW LEVEL"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:"LL"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:"1"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,...sr.cellGreen,fontWeight:900},children:"MEDIUM LEVEL"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:"ML"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:"2"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,...sr.cellGreen,fontWeight:900},children:"HIGH LEVEL"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:"HL"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:"3"})]})]})}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:sr.table,children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:800,width:220},children:"The Learners are at"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:v.label}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:v.code})]})})}),a.jsx("div",{style:{height:14}}),a.jsx("table",{style:sr.table,children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:900,width:260},children:a.jsx(es,{style:sr.link,to:`${de}/lca/pbr`,children:"PREVIOUS BATCH RESULT (PBR)"})}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:G==="-"?"":G}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:k?"COURSE LEVEL (CAY-2)":"COURSE LEVEL (CAY-1)"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:700},children:" "}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:S?`Mean GPA: ${S.meanGpa}`:""}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:k?`Mean GPA: ${k.meanGpa}`:""})]})]})}),a.jsx("div",{style:{height:12}}),a.jsx("table",{style:sr.table,children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{...sr.tdLeft,fontWeight:900,width:260},children:"Learner Centric Level"}),a.jsx("td",{style:{...sr.td,...sr.cellGreen,fontWeight:900},children:oe})]})})})]}))}const On={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},headerRow:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap",marginBottom:12},label:{color:"#557085",fontSize:12,fontWeight:700},codeBox:{background:"#fbfdff",border:"1px solid #e6eef8",padding:"10px 14px",borderRadius:8,fontWeight:800,color:"#0b4a6f",fontSize:18},nameBox:{background:"#fff",padding:"6px 10px",color:"#234451"},sectionTitle:{marginTop:8,marginBottom:12,color:"#0b3b57",fontSize:16,fontWeight:700},table:{width:"100%",borderCollapse:"collapse",marginTop:12},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"12px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"12px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},tdLeft:{padding:"10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"left"},checkbox:{transform:"scale(1.2)",cursor:"pointer",margin:"0"},inputNumber:{width:80,padding:"6px 8px",borderRadius:6,border:"1px solid #d1e3f0",textAlign:"center"}};function EK({courseCode:e=" ",courseName:t=" ",embedded:r=!1,onClose:n}){const i=hl(),s=bo(),o=r?{padding:12,maxWidth:980,width:"100%",margin:"0 auto"}:On.page,[l,c]=x.useState(""),[u,d]=x.useState(()=>{var de;const G=t&&t.trim()?t.trim():"",H=((de=i.state)==null?void 0:de.courseName)||"",oe=new URLSearchParams(i.search).get("name")||"";return G||H||oe||""}),f=u||l||"",[p,h]=x.useState(()=>{try{const G=new URLSearchParams(i.search),H=G.get("teaching_assignment_id")||G.get("teachingAssignmentId");if(!H)return null;const oe=Number(H);return Number.isFinite(oe)?oe:null}catch{return null}}),[m,g]=x.useState(null),[y,b]=x.useState(null),[v,w]=x.useState(()=>Array(5).fill(null)),[S,j]=x.useState({ico:.4,bco:.3,aco:.1,api:.1,iic:.1}),[k,A]=x.useState(Array.from({length:5},()=>({aco:null,api:null,iic:null})));function R(G,H){const oe=Math.pow(10,H);return Math.round((G+Number.EPSILON)*oe)/oe}function M(G,H=2,oe=!0){if(G==null||G==="")return oe?null:0;const de=Number(G);if(!Number.isFinite(de))return oe?null:0;const W=R(de,H);return W<0?0:W}x.useEffect(()=>{let G=!0;return(async()=>{try{if(!e)return;const H=await B4(e,typeof p=="number"?p:void 0);if(!G||!H)return;g(H);const oe=Array.isArray(H.units)?H.units:[],de=[],W=V=>{if(!Number.isFinite(V))return null;const ae=R(V,2),ee=R(ae*3,2);return ee===0?null:ee};for(let V=0;V<5;V++){const ae=oe[V];if(!ae||!Array.isArray(ae.rows)||ae.rows.length===0){de.push([]);continue}const ee=ae.rows,C=ee.reduce((X,F)=>{const Q=Number(F.hours);return X+(Number.isFinite(Q)?Q:0)},0),Y=11,q=3,O=[];for(let X=0;X<Y;X++){const F=ee.reduce((Q,K)=>{const ne=Number((K.po&&K.po[X])??0);return Q+(Number.isFinite(ne)?ne:0)},0);if(C>0){const Q=F/C,K=W(Q);K!=null&&O.push(K)}}for(let X=0;X<q;X++){const F=ee.reduce((Q,K)=>{const ne=Number((K.pso&&K.pso[X])??0);return Q+(Number.isFinite(ne)?ne:0)},0);if(C>0){const Q=F/C,K=W(Q);K!=null&&O.push(K)}}de.push(O)}b(de)}catch{}})(),()=>{G=!1}},[e,p]);const B=Jr.useMemo(()=>y?y.map(G=>{if(!Array.isArray(G)||G.length===0)return{high:0,med:0,low:0,total:0,ico:0};let H=0,oe=0,de=0;G.forEach(ee=>{const C=Number(ee);Number.isFinite(C)&&(C>=1.98?H++:C>=.99?oe++:de++)});const W=H*3+oe*2+de*1,V=H+oe+de,ae=V?R(W/(V*3)*100,2):0;return{high:H,med:oe,low:de,total:W,ico:ae}}):null,[y]),E=Jr.useMemo(()=>v.map(G=>G?G*10:null),[v]),P=Jr.useMemo(()=>{var H,oe,de;const G=[];for(let W=0;W<5;W++){const V=B&&B[W]?B[W].ico:0,ae=E[W]??0,ee=((H=k[W])==null?void 0:H.aco)??0,C=((oe=k[W])==null?void 0:oe.api)??0,Y=((de=k[W])==null?void 0:de.iic)??0,q=V*S.ico+ae*S.bco+ee*S.aco+C*S.api+Y*S.iic,O=Math.round(q),X=R(O*.03,2);G.push({weightedRounded:O,final:X})}return G},[B,E,k,S]);x.useEffect(()=>{let G=!0;return(async()=>{try{if(!l&&e&&typeof p=="number"){const H=await I9(e,p);if(!G||!H)return;const oe=H.course_name||H.subject_name||H.courseName||H.revision&&(H.revision.course_name||H.revision.courseName||H.revision.subject_name)||"";oe&&c(String(oe))}}catch{}})(),()=>{G=!1}},[e,l,p]),x.useEffect(()=>{l&&!u&&d(l)},[l,u]),x.useEffect(()=>{let G=!0;return(async()=>{try{if(u||!e)return;try{const H=await hc();if(!G)return;const de=(H||[]).filter(W=>String(W.subject_code)===String(e))[0]||null;if(p==null&&de&&de.id!=null){const W=Number(de.id);Number.isFinite(W)&&h(W)}if(de&&de.subject_name){d(String(de.subject_name));return}}catch{}try{const H=await Sl();if(!G)return;const oe=String(e),de=oe.toUpperCase(),W=(H||[]).find(V=>String((V==null?void 0:V.course_code)||"").trim()===oe||String((V==null?void 0:V.course_code)||"").trim().toUpperCase()===de);if(W&&W.course_name){d(String(W.course_name));return}}catch{}}catch{}})(),()=>{G=!1}},[e,f,u,p]);const D=[{co:"CO1",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:68,scale:2.03},{co:"CO2",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:66,scale:1.99},{co:"CO3",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.01},{co:"CO4",ico:.4,bco:.3,aco:.1,api:.1,iic:.1,target:67,scale:2.02},{co:"CO5",ico:0,bco:.5,aco:0,api:0,iic:0,target:74,scale:2.22}];return a.jsx("div",{style:o,children:a.jsxs("div",{style:On.card,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12,marginBottom:12},children:[a.jsxs("div",{style:On.headerRow,children:[a.jsxs("div",{children:[a.jsx("div",{style:On.label,children:"COURSE CODE"}),a.jsx("div",{style:On.codeBox,children:e})]}),a.jsxs("div",{style:{marginLeft:12},children:[a.jsx("div",{style:On.label,children:"COURSE NAME"}),a.jsx("div",{style:On.nameBox,children:f})]})]}),a.jsx("div",{children:r?n?a.jsx("button",{onClick:n,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:"Close"}):null:a.jsx("button",{onClick:()=>s(-1),style:{padding:"8px 12px",borderRadius:8,border:"1px solid #e6eef8",background:"#fff",cursor:"pointer",fontWeight:700},children:" Back"})})]}),a.jsxs("div",{style:{...On.card,padding:14,marginTop:0},children:[a.jsx("div",{style:On.sectionTitle,children:"Course Outcome Attainment  Targets"}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,marginTop:12},children:[a.jsxs("div",{style:{...On.card,padding:16,minHeight:140},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"1. Rubrics for Impact (ICO)"}),a.jsxs("table",{style:On.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:On.th,children:"CO"}),a.jsx("th",{style:On.th,children:"High (3)"}),a.jsx("th",{style:On.th,children:"Medium (2)"}),a.jsx("th",{style:On.th,children:"Low (1)"}),a.jsx("th",{style:On.th,children:"Total"}),a.jsx("th",{style:On.th,children:"ICO"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((G,H)=>{const oe=B&&B[H]?B[H]:{high:0,med:0,low:0,total:0,ico:0};return a.jsxs("tr",{children:[a.jsx("td",{style:On.tdLeft,children:G}),a.jsx("td",{style:On.td,children:oe.high}),a.jsx("td",{style:On.td,children:oe.med}),a.jsx("td",{style:On.td,children:oe.low}),a.jsx("td",{style:On.td,children:oe.total}),a.jsxs("td",{style:On.td,children:[oe.ico.toFixed(2),"%"]})]},G)})})]})]}),a.jsxs("div",{style:{...On.card,padding:16,minHeight:140},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"2. BTL Level (BCO)"}),a.jsxs("table",{style:On.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:On.th,children:"CO"}),a.jsx("th",{style:On.th,children:"BTL-1"}),a.jsx("th",{style:On.th,children:"BTL-2"}),a.jsx("th",{style:On.th,children:"BTL-3"}),a.jsx("th",{style:On.th,children:"BTL-4"}),a.jsx("th",{style:On.th,children:"BTL-5"}),a.jsx("th",{style:On.th,children:"BTL-6"}),a.jsx("th",{style:On.th,children:"BCO"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((G,H)=>a.jsxs("tr",{children:[a.jsx("td",{style:On.tdLeft,children:G}),Array.from({length:6},(oe,de)=>{const W=de+1,V=v[H]===W;return a.jsx("td",{style:On.td,children:a.jsx("input",{type:"checkbox","aria-label":`BTL-${W} for ${G}`,style:On.checkbox,checked:!!V,onChange:()=>{w(ae=>{const ee=[...ae];return ee[H]===W?ee[H]=null:ee[H]=W,ee})},disabled:v[H]!=null&&v[H]!==W,title:v[H]!=null&&v[H]!==W?"Disabled while another BTL is selected":`Select BTL-${W}`})},W)}),a.jsx("td",{style:On.td,children:E[H]??""})]},G))})]})]}),a.jsxs("div",{style:{...On.card,padding:16,minHeight:120},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"3. Last year's Average CO attainment (ACO)"}),a.jsxs("table",{style:On.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:On.th,children:"COs"}),a.jsx("th",{style:On.th,children:"SUB"})]})}),a.jsx("tbody",{children:D.map((G,H)=>{var oe;return a.jsxs("tr",{children:[a.jsx("td",{style:On.tdLeft,children:G.co}),a.jsx("td",{style:On.td,children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:((oe=k[H])==null?void 0:oe.aco)??"",onChange:de=>{const W=de.target.value===""?null:de.target.value;A(V=>{const ae=[...V];return ae[H]={...ae[H],aco:W===null?null:Number(W)},ae})},onBlur:de=>{const W=M(de.target.value,2,!0);A(V=>{const ae=[...V];return ae[H]={...ae[H],aco:W},ae})}})})]},G.co)})})]})]}),a.jsxs("div",{style:{...On.card,padding:16,minHeight:120},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"4. Average Performance Index (API)"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{border:"1px solid #94a3b8",borderRadius:4,overflow:"hidden",flex:1},children:a.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,minWidth:220,background:"#fff",fontWeight:700,borderRight:"1px solid #94a3b8"},children:"BATCH (CAY)"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"NO OF SUCCESSFUL"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:8,background:"#fff",borderTop:"1px solid #94a3b8",borderRight:"1px solid #94a3b8"},children:"MEAN CGPA"}),a.jsx("td",{style:{padding:8,background:"#fde68a",fontWeight:800,textAlign:"center"}})]})]})})}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Per-CO API (manual)"}),a.jsxs("table",{style:On.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:On.th,children:"CO"}),a.jsx("th",{style:On.th,children:"API"})]})}),a.jsx("tbody",{children:["CO1","CO2","CO3","CO4","CO5"].map((G,H)=>{var oe;return a.jsxs("tr",{children:[a.jsx("td",{style:On.tdLeft,children:G}),a.jsx("td",{style:On.td,children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:((oe=k[H])==null?void 0:oe.api)??"",onChange:de=>{const W=de.target.value===""?null:de.target.value;A(V=>{const ae=[...V];return ae[H]={...ae[H],api:W===null?null:Number(W)},ae})},onBlur:de=>{const W=M(de.target.value,2,!0);A(V=>{const ae=[...V];return ae[H]={...ae[H],api:W},ae})}})})]},G)})})]})]})]}),a.jsxs("div",{style:{marginTop:12,display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[a.jsx("div",{style:{color:"#234451",fontWeight:700},children:"Average Performance Index of the student's batch (API) - GPA ="}),a.jsx("div",{style:{border:"2px solid #0b4a6f",padding:"6px 10px",fontWeight:900}}),a.jsx("div",{children:"/100"})]})]}),a.jsxs("div",{style:{...On.card,padding:18,minHeight:180},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"5. The Improvement Index on CO attainment (IIC)"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{border:"2px solid #0b3b57",borderRadius:4,overflow:"hidden",width:360,background:"#fff"},children:a.jsx("table",{style:{borderCollapse:"collapse",width:"100%"},children:a.jsxs("tbody",{children:[a.jsx("tr",{children:a.jsx("td",{colSpan:2,style:{padding:12,background:"#f8fafc",fontWeight:800,color:"#0b3b57"},children:"Learner Centric Approach (LCA)"})}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L3"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L2"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]}),a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"right",paddingRight:20,fontWeight:700},children:"L1"}),a.jsx("td",{style:{padding:10,background:"#bfdbfe",textAlign:"center",fontWeight:800}})]})]})})}),a.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:12,alignItems:"stretch"},children:[a.jsxs("div",{style:{width:"100%"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:8,textAlign:"center",color:"#0b3b57"},children:"The Course Outcome Attainment Targets"}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"2px solid #0b3b57"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f2ff",color:"#0b3b57"},children:"COs"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"ICO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#e6f8ff",color:"#0b4a6f"},children:"BCO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"ACO"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"API"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fde8f0",color:"#6b213f"},children:"IIC"}),a.jsx("th",{style:{padding:10,borderRight:"1px solid #0b3b57",background:"#fff7d6",color:"#6b4a00"},children:"COs Targets"}),a.jsx("th",{style:{padding:10,background:"#fff7d6",color:"#6b4a00"},children:"CO TARGET IN 3 POINT SCALE"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderTop:"1px solid #e6eef8",background:"#f3f8ff",fontWeight:700},children:"Weight Values"}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:S.ico,onChange:G=>j(H=>({...H,ico:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,ico:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:S.bco,onChange:G=>j(H=>({...H,bco:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,bco:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:S.aco,onChange:G=>j(H=>({...H,aco:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,aco:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:S.api,onChange:G=>j(H=>({...H,api:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,api:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:S.iic,onChange:G=>j(H=>({...H,iic:Number(G.target.value||0)})),onBlur:G=>j(H=>({...H,iic:M(G.target.value,2,!1)}))})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"}})]}),["CO-1","CO-2","CO-3","CO-4","CO-5"].map((G,H)=>{var oe,de,W,V,ae;return a.jsxs("tr",{children:[a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb",textAlign:"left",fontWeight:700},children:G}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:B&&B[H]?B[H].ico.toFixed(2)+"%":""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:E[H]??""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:((oe=k[H])==null?void 0:oe.aco)??"",onChange:ee=>{const C=ee.target.value===""?null:ee.target.value;A(Y=>{const q=[...Y];return q[H]={...q[H],aco:C===null?null:Number(C)},q})},onBlur:ee=>{const C=M(ee.target.value,2,!0);A(Y=>{const q=[...Y];return q[H]={...q[H],aco:C},q})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:((de=k[H])==null?void 0:de.api)??"",onChange:ee=>{const C=ee.target.value===""?null:ee.target.value;A(Y=>{const q=[...Y];return q[H]={...q[H],api:C===null?null:Number(C)},q})},onBlur:ee=>{const C=M(ee.target.value,2,!0);A(Y=>{const q=[...Y];return q[H]={...q[H],api:C},q})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:a.jsx("input",{min:0,step:"any",style:On.inputNumber,type:"number",value:((W=k[H])==null?void 0:W.iic)??"",onChange:ee=>{const C=ee.target.value===""?null:ee.target.value;A(Y=>{const q=[...Y];return q[H]={...q[H],iic:C===null?null:Number(C)},q})},onBlur:ee=>{const C=M(ee.target.value,2,!0);A(Y=>{const q=[...Y];return q[H]={...q[H],iic:C},q})}})}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:((V=P[H])==null?void 0:V.weightedRounded)??""}),a.jsx("td",{style:{padding:10,borderTop:"1px solid #eef6fb"},children:((ae=P[H])==null?void 0:ae.final)??""})]},G)})]})]})]}),a.jsx("div",{style:{width:"100%",background:"#86efac",padding:12,borderRadius:6,border:"2px solid #16a34a",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontWeight:700},children:"TARGET TABLE WILL BE GENERATED AUTOMATICALLY"})]})]})]})]})]})]})})}const Zr={page:{padding:28,maxWidth:1100,margin:"18px auto",fontFamily:"Inter, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial",color:"#1f3947"},card:{background:"#fff",borderRadius:12,padding:18,border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13,60,100,0.04)"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12,marginBottom:18},titleBlock:{display:"flex",flexDirection:"column"},title:{margin:0,color:"#0b4a6f",fontSize:22,fontWeight:700},subtitle:{marginTop:6,color:"#3d5566",fontSize:13},grid:{display:"grid",gap:16},sectionTitle:{margin:"0 0 10px 0",color:"#0b3b57",fontSize:16},paragraph:{color:"#334e68",lineHeight:1.45,margin:0},table:{width:"100%",borderCollapse:"collapse",marginTop:8},th:{background:"#f3f8ff",color:"#0b4a6f",fontWeight:700,padding:"8px 10px",border:"1px solid #e6eef8",textAlign:"center",fontSize:13},td:{padding:"8px 10px",border:"1px solid #eef6fb",color:"#234451",fontSize:13,textAlign:"center"},note:{color:"#6b8190",fontSize:13},kv:{background:"#fbfdff",padding:10,borderRadius:8,border:"1px solid #e9f3fb",minWidth:160},kvLabel:{fontSize:12,color:"#557085",marginBottom:6},kvValue:{fontWeight:700,color:"#0b4a6f"}};function qPe({title:e,columns:t,rows:r}){return a.jsxs("div",{children:[e&&a.jsx("div",{style:Zr.sectionTitle,children:e}),a.jsxs("table",{style:Zr.table,children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(n=>a.jsx("th",{style:Zr.th,children:n},n))})}),a.jsx("tbody",{children:r.map((n,i)=>a.jsx("tr",{children:n.map((s,o)=>a.jsx("td",{style:Zr.td,children:s},o))},i))})]})]})}function TK({courseCode:e,courseName:t,initialTab:r,viewerMode:n}){const i=x.useMemo(()=>e?String(e):"",[e]);bo();const[s,o]=x.useState(r||"instructions");x.useEffect(()=>{r&&o(r)},[r]);const l=[{key:"instructions",label:"LCA Instructions"},{key:"lca",label:"LCA"},{key:"cdap",label:"CDAP"},{key:"articulation",label:"Articulation Matrix"},{key:"cotarget",label:"CO Target"}],c={display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},u=(d,f)=>{const p=s===d,h=()=>{if(d==="cotarget"){o(d);return}o(d)};return a.jsx("button",{onClick:h,style:{padding:"8px 12px",borderRadius:8,border:p?"2px solid #0b4a6f":"1px solid #e6eef8",background:p?"#0b4a6f":"#fbfdff",color:p?"#fff":"#0b4a6f",fontWeight:700,cursor:"pointer"},children:f},f)};return a.jsx("div",{style:Zr.page,children:a.jsxs("div",{style:{...Zr.card},children:[a.jsx("div",{style:Zr.header,children:a.jsxs("div",{style:Zr.titleBlock,children:[a.jsx("h2",{style:Zr.title,children:"Learner Centric Approach  Instructions"}),a.jsx("div",{style:Zr.subtitle,children:"Default LCA planning matrix and instruction-level guidance for course design and assessment."})]})}),a.jsxs("div",{style:{padding:12},children:[a.jsx("div",{style:c,children:l.map(d=>u(d.key,d.label))}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-start",gap:12,flexWrap:"wrap",marginBottom:12},children:a.jsxs("div",{style:Zr.kv,children:[a.jsx("div",{style:Zr.kvLabel,children:"Course"}),a.jsx("div",{style:Zr.kvValue,children:(e||"")+(t?`  ${t}`:"")})]})}),s==="instructions"&&a.jsxs("div",{style:Zr.grid,children:[a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:16,alignItems:"start"},children:a.jsxs("div",{style:{...Zr.card,padding:14,gridColumn:"1 / -1"},children:[a.jsx("div",{style:Zr.sectionTitle,children:"Overview"}),a.jsx("p",{style:Zr.paragraph,children:"Use this page to map learner profiles (L1L3) to instruction levels (IL-1..IL-3) and to define assessment distribution. The tables below provide recommended mappings and a sample distribution for course planning."}),a.jsx("div",{style:{marginTop:12},children:a.jsx(qPe,{title:"Learner Profile  Quick Guide",columns:["Profile","Description"],rows:[["L1","Lower CGPA / limited prerequisites"],["L2","Average preparedness"],["L3","High CGPA / strong prerequisites"]]})})]})}),a.jsxs("div",{style:{...Zr.card,padding:14},children:[a.jsx("div",{style:Zr.sectionTitle,children:"Instruction Steps (recommended)"}),a.jsxs("ol",{style:{margin:0,paddingLeft:18,color:"#334e68"},children:[a.jsx("li",{style:{marginBottom:8},children:"Identify learner profile (L1 / L2 / L3) for the target offering."}),a.jsx("li",{style:{marginBottom:8},children:"Use IL mapping to determine instruction emphasis across IL-1..IL-3."}),a.jsx("li",{style:{marginBottom:8},children:"Apply distribution when preparing teaching plan and question banks (map PT / CO / BTL)."})]})]}),a.jsxs("div",{style:{display:"grid",gap:12},children:[a.jsxs("div",{style:{...Zr.card,padding:12},children:[a.jsx("div",{style:Zr.sectionTitle,children:"Sample Assessment Distribution by Learner Profile"}),a.jsxs("table",{style:Zr.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:Zr.th,children:"Learner Profile"}),a.jsx("th",{style:Zr.th,children:"IL-1 %"}),a.jsx("th",{style:Zr.th,children:"IL-2 %"}),a.jsx("th",{style:Zr.th,children:"IL-3 %"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:Zr.td,children:"L1"}),a.jsx("td",{style:Zr.td,children:"60"}),a.jsx("td",{style:Zr.td,children:"30"}),a.jsx("td",{style:Zr.td,children:"10"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:Zr.td,children:"L2"}),a.jsx("td",{style:Zr.td,children:"30"}),a.jsx("td",{style:Zr.td,children:"50"}),a.jsx("td",{style:Zr.td,children:"20"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:Zr.td,children:"L3"}),a.jsx("td",{style:Zr.td,children:"10"}),a.jsx("td",{style:Zr.td,children:"40"}),a.jsx("td",{style:Zr.td,children:"50"})]})]})]})]}),a.jsxs("div",{style:{...Zr.card,padding:12},children:[a.jsx("div",{style:Zr.sectionTitle,children:"Current Course  Example Breakdown"}),a.jsxs("table",{style:Zr.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:Zr.th,children:"Component"}),a.jsx("th",{style:Zr.th,children:"IL-1"}),a.jsx("th",{style:Zr.th,children:"IL-2"}),a.jsx("th",{style:Zr.th,children:"IL-3"}),a.jsx("th",{style:Zr.th,children:"Notes"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:Zr.td,children:"Teaching Hours"}),a.jsx("td",{style:Zr.td,children:"40%"}),a.jsx("td",{style:Zr.td,children:"40%"}),a.jsx("td",{style:Zr.td,children:"20%"}),a.jsx("td",{style:Zr.td,children:"Blend of lectures and labs"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:Zr.td,children:"Question Bank"}),a.jsx("td",{style:Zr.td,children:"50%"}),a.jsx("td",{style:Zr.td,children:"30%"}),a.jsx("td",{style:Zr.td,children:"20%"}),a.jsx("td",{style:Zr.td,children:"Adjust difficulty by profile"})]})]})]}),a.jsx("div",{style:{marginTop:10},children:a.jsx("div",{style:Zr.note,children:"Tip: Use these templates as starting points and adapt percentages to the specific cohort."})})]}),a.jsxs("div",{style:{...Zr.card,padding:12},children:[a.jsx("div",{style:Zr.sectionTitle,children:"IL Mapping"}),a.jsxs("table",{style:Zr.table,children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:Zr.th,children:"IL"}),a.jsx("th",{style:Zr.th,children:"Instruction Focus"}),a.jsx("th",{style:Zr.th,children:"Typical Assessment Emphasis"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{children:[a.jsx("td",{style:Zr.td,children:"IL-1"}),a.jsx("td",{style:Zr.td,children:"Foundation, concepts, scaffolding"}),a.jsx("td",{style:Zr.td,children:"More formative; MCQ / guided tasks"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:Zr.td,children:"IL-2"}),a.jsx("td",{style:Zr.td,children:"Application and practice"}),a.jsx("td",{style:Zr.td,children:"Mixture of practical and theory"})]}),a.jsxs("tr",{children:[a.jsx("td",{style:Zr.td,children:"IL-3"}),a.jsx("td",{style:Zr.td,children:"Advanced, synthesis, independent work"}),a.jsx("td",{style:Zr.td,children:"Problem-solving, projects, high-level questions"})]})]})]})]})]})]}),s==="lca"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx(WPe,{embedded:!0,courseId:i,courseCode:i,courseName:t??void 0}):a.jsxs("div",{style:{...Zr.card,padding:16},children:[a.jsx("div",{style:Zr.sectionTitle,children:"LCA"}),a.jsx("div",{style:Zr.paragraph,children:"Select a course to view the LCA worksheet."})]})}),s==="cdap"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx("div",{style:{...Zr.card,padding:12},children:a.jsx(BPe,{courseId:i,showHeader:!1,showCourseInput:!1})}):a.jsxs("div",{style:{...Zr.card,padding:16},children:[a.jsx("div",{style:Zr.sectionTitle,children:"CDAP"}),a.jsx("div",{style:Zr.paragraph,children:"Select a course to open CDAP."})]})}),s==="articulation"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx(TPe,{embedded:!0,courseId:i}):a.jsxs("div",{style:{...Zr.card,padding:16},children:[a.jsx("div",{style:Zr.sectionTitle,children:"Articulation Matrix"}),a.jsx("div",{style:Zr.paragraph,children:"Select a course to view the articulation matrix."})]})}),s==="cotarget"&&a.jsx("fieldset",{disabled:!!n,style:{border:0,padding:0,margin:0},children:i?a.jsx("div",{style:{...Zr.card,padding:12},children:a.jsx(EK,{embedded:!0,courseCode:i,courseName:t??void 0,onClose:()=>o("instructions")})}):a.jsxs("div",{style:{...Zr.card,padding:16},children:[a.jsx("div",{style:Zr.sectionTitle,children:"CO Target"}),a.jsx("div",{style:Zr.paragraph,children:"Select a course to view CO Targets."})]})})]})]})})}const HPe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],VPe=[{key:"q1",label:"Q1",max:2,co:3,btl:1},{key:"q2",label:"Q2",max:2,co:3,btl:3},{key:"q3",label:"Q3",max:2,co:3,btl:4},{key:"q4",label:"Q4",max:2,co:4,btl:1},{key:"q5",label:"Q5",max:2,co:4,btl:1},{key:"q6",label:"Q6",max:2,co:4,btl:2},{key:"q7",label:"Q7",max:16,co:3,btl:2},{key:"q8",label:"Q8",max:16,co:4,btl:3},{key:"q9",label:"Q9",max:16,co:"3&4",btl:5}],mk=30,ax={co1:42,co2:42,co3:58,co4:42,co5:42},f3=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],PK=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5],gk=f3.reduce((e,t,r)=>e+(PK[r]===5?t.max:0),0),FF=10;function GPe(e,t,r){if(t)return 5;const n=ti(e);return r.includes("model")&&(n==="THEORY"||n==="TCPL"||n==="TCPR")?5:4}function KPe(e){return Array.from({length:e},(t,r)=>r+1)}const nm={ssa1:1.5,cia1:3,formative1:2.5},YPe={THEORY:{ssa1:1.5,cia1:3,formative1:2.5},TCPR:{ssa1:2,cia1:2.5,formative1:2},TCPL:{ssa1:1,cia1:2,formative1:3},LAB:{ssa1:1,cia1:1,formative1:1},PRACTICAL:{ssa1:1,cia1:1,formative1:1},SPECIAL:{ssa1:1.5,cia1:3,formative1:2.5},AUDIT:{ssa1:1.5,cia1:3,formative1:2.5}};function mv(e){if(!e)return nm;const t=ti(e);return YPe[t]||nm}function yi(e,t,r){return Math.max(t,Math.min(r,e))}function fs(e){return Math.round(e*10)/10}function Mf(e){return Math.round(e*100)/100}function Gl(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function sx(e,t){const r=Array.isArray(e)?e:[],n=[];for(let i=0;i<t;i++){const s=r[i];if(s===""||s==null){n.push("");continue}const o=typeof s=="number"?s:Number(s);n.push(Number.isFinite(o)?o:"")}return n}function gv(e){const t=e.filter(r=>typeof r=="number"&&Number.isFinite(r));return t.length?t.reduce((r,n)=>r+n,0)/t.length:null}function xk(e){const t=typeof e=="number"?e:Number(e);if(!Number.isFinite(t))return null;const r=Math.trunc(t);return r>=1&&r<=6?r:null}function BF(e){if(e==="1&2"||e==="both")return"1&2";if(typeof e=="string"){const r=e.trim();if(r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1")return"1&2";if(r==="2")return 2;if(r==="1")return 1}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(1)&&r.includes(2))return"1&2";if(r.includes(2))return 2;if(r.includes(1))return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function IF(e){if(e==="3&4"||e==="both")return"3&4";if(typeof e=="string"){const r=e.trim();if(r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3")return"3&4";if(r==="4")return 4;if(r==="3")return 3}if(Array.isArray(e)){const r=e.map(n=>Number(n)).filter(n=>Number.isFinite(n));if(r.includes(3)&&r.includes(4))return"3&4";if(r.includes(4))return 4;if(r.includes(3))return 3}const t=Number(e);return t===4?4:t===3?3:t===34?"3&4":3}function XPe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function DF(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),i=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&i&&s?{co1:.5,co2:.5}:XPe(r.co)}function QPe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function $F(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),i=t===e.length-1,s=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return!n&&i&&s?{co3:.5,co4:.5}:QPe(r.co)}function UF(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function xv(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:i,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u,outOf:d}=e,f=[{mark:t,max:i,w:l},{mark:r,max:s,w:c},{mark:n,max:o,w:u}].filter(g=>Number(g.w||0)>0);if(!f.length||!d||!Number.isFinite(Number(d))||f.some(g=>g.mark==null)||f.some(g=>!g.max||!Number.isFinite(Number(g.max))))return null;const p=f.reduce((g,y)=>g+y.w,0);if(!p)return null;const m=f.reduce((g,y)=>g+y.mark/y.max*y.w,0)/p*d;return Number.isFinite(m)?yi(m,0,d):null}function OK({courseId:e,enabledAssessments:t,classType:r}){const[n,i]=x.useState(null),[s,o]=x.useState(r??null),l=x.useMemo(()=>Array.isArray(t),[t]),c=x.useMemo(()=>{const Te=Array.isArray(t)?t:[];return new Set(Te.map(tt=>String(tt||"").trim().toLowerCase()).filter(Boolean))},[t]),u=x.useMemo(()=>c.has("model"),[c]),[d,f]=x.useState(null),[p,h]=x.useState(null),m=x.useMemo(()=>l||Gre(s),[l,s]),g=x.useMemo(()=>({ssa1:!m||c.has("ssa1"),ssa2:!m||c.has("ssa2"),formative1:!m||c.has("formative1"),formative2:!m||c.has("formative2"),cia1:!m||c.has("cia1"),cia2:!m||c.has("cia2"),model:!m||c.has("model")}),[m,c]),y=x.useMemo(()=>NN(s)&&!l,[s,l]),b=x.useMemo(()=>ti(s)==="TCPL",[s]),v=x.useMemo(()=>{const Te=ti(s);return(Te==="THEORY"||Te==="TCPL"||Te==="TCPR")&&!!g.model},[s,g.model]),w=x.useMemo(()=>{const Te=Object.entries(g).filter(([tt,st])=>st).map(([tt])=>tt);return GPe(s,y,Te)},[s,y,g]),S=x.useMemo(()=>KPe(w),[w]),[j,k]=x.useState([]),[A,R]=x.useState(null),[M,B]=x.useState(null);x.useEffect(()=>{if(!e||M==null||!u){f(null),h(null);return}let Te=!0;return(async()=>{try{const tt=await xS("model",String(e),Number(M));if(!Te)return;f(tt),h(null)}catch(tt){if(!Te)return;f(null),h((tt==null?void 0:tt.message)||"Failed to fetch MODEL publish status")}})(),()=>{Te=!1}},[e,M,u]);const[E,P]=x.useState(!1),[D,G]=x.useState(null),[H,oe]=x.useState([]),[de,W]=x.useState(!1),[V,ae]=x.useState(null),[ee,C]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[Y,q]=x.useState({}),[O,X]=x.useState({cia1:null,cia2:null,model:null}),[F,Q]=x.useState({lab1:null,lab2:null}),K=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[ne,re]=x.useState(!1),[T,I]=x.useState(()=>({ssa1:nm.ssa1,cia1:nm.cia1,formative1:nm.formative1})),[ie,U]=x.useState(FF),Z=!!(u&&d&&d.is_published);x.useEffect(()=>{v&&U(Z?30:FF)},[v,Z]);const[me,Pe]=x.useState("default"),je=Jr.useRef(null),Fe=Jr.useRef(null),[_e,He]=x.useState(null),[qe,Pt]=x.useState(null),[ut,Ke]=x.useState(null),[lt,ve]=x.useState(!1),[Ae,ce]=x.useState(!1),[be,mt]=x.useState({});x.useEffect(()=>{try{const Te=localStorage.getItem("roles"),tt=localStorage.getItem("permissions"),st=Te?JSON.parse(Te):[],kt=tt?JSON.parse(tt):[],jt=Array.isArray(st)?st.map(se=>String(se||"").toUpperCase()):[],ar=Array.isArray(kt)?kt.map(se=>String(se||"").toLowerCase()):[],tr=jt.includes("IQAC"),Er=ar.includes("obe.master.manage");re(tr||Er)}catch{re(!1)}},[]),x.useEffect(()=>{let Te=!0;const tt=async st=>{Te&&He("Loading IQAC weights");try{const jt=await vS();if(!Te)return;if(jt&&typeof jt=="object"){const ar={...jt};try{Object.defineProperty(ar,"__source",{value:"server",enumerable:!1})}catch{}je.current=ar,Ke(Object.keys(ar||{}).length||0),Pt(null),He(`Server weights loaded (${Object.keys(ar||{}).length} class-types)`);const tr=st??s;if(tr){const Er=ti(tr),se=ar[Er];if(se&&typeof se=="object"){const ue=mv(tr);I({ssa1:Number.isFinite(Number(se.ssa1))?Number(se.ssa1):ue.ssa1,cia1:Number.isFinite(Number(se.cia1))?Number(se.cia1):ue.cia1,formative1:Number.isFinite(Number(se.formative1))?Number(se.formative1):ue.formative1}),Pe("server"),He(`Applied server weights for ${Er}`);return}else He(`Server weights loaded (${Object.keys(ar||{}).length} keys) but no entry for ${Er}`)}}}catch(jt){const ar=String((jt==null?void 0:jt.message)||jt||"Unknown error");Pt(ar),He(`Server fetch failed: ${ar}`)}try{const jt=Qn("iqac_class_type_weights");if(jt&&typeof jt=="object"){const ar={...jt};try{Object.defineProperty(ar,"__source",{value:"local",enumerable:!1})}catch{}je.current=ar,Ke(Object.keys(ar||{}).length||0);const tr=st??s;if(tr){const Er=ti(tr),se=ar[Er];if(se&&typeof se=="object"){const ue=mv(tr);I({ssa1:Number.isFinite(Number(se.ssa1))?Number(se.ssa1):ue.ssa1,cia1:Number.isFinite(Number(se.cia1))?Number(se.cia1):ue.cia1,formative1:Number.isFinite(Number(se.formative1))?Number(se.formative1):ue.formative1}),Pe("local"),He(`Applied local weights for ${Er}`);return}else He(`Local weights loaded (${Object.keys(ar||{}).length} keys) but no entry for ${Er}`)}}}catch(jt){const ar=String((jt==null?void 0:jt.message)||jt||"Unknown error");Pt(ar),He(`Local weights read failed: ${ar}`)}const kt=st??s;if(kt){const jt=mv(kt);I(jt),Pe("default"),He(`Applied class-type defaults for ${ti(kt)}`)}else I(nm),Pe("default"),He("Applied general defaults (no class type detected)")};return tt(),Fe.current=tt,()=>{Te=!1}},[s]),x.useEffect(()=>{try{const Te=Fe.current;typeof Te=="function"&&Te()}catch{}},[M]),x.useEffect(()=>{try{const Te=je.current;if(s&&Te&&typeof Te=="object"){const tt=ti(s),st=Te[tt];if(st&&typeof st=="object"){const kt=mv(s);I({ssa1:Number.isFinite(Number(st.ssa1))?Number(st.ssa1):kt.ssa1,cia1:Number.isFinite(Number(st.cia1))?Number(st.cia1):kt.cia1,formative1:Number.isFinite(Number(st.formative1))?Number(st.formative1):kt.formative1}),Pe(Te.__source==="server"?"server":"local"),He(`Applied cached mapping for ${tt}`),Pt(null)}}}catch{}},[s]),x.useEffect(()=>{let Te=!0;return(async()=>{try{const tt=await oc();if(!Te)return;i(tt||null)}catch{}})(),()=>{Te=!1}},[e]),x.useEffect(()=>{let Te=!0;return(async()=>{var tt;try{const st=await hc();if(!Te)return;let kt=(st||[]).filter(tr=>tr.subject_code===e);if(kt.length===0)try{const tr=await mr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(tr.ok){const Er=await tr.json();kt=(Array.isArray(Er.results)?Er.results:Array.isArray(Er)?Er:Er.items||[])||[]}}catch(tr){console.warn("Server TA list fetch failed:",tr)}k(kt),R(null);const jt=Qn(`coAttainment_selectedTa_${e}`),ar=typeof jt=="number"&&kt.some(tr=>tr.id===jt)&&jt||(((tt=kt[0])==null?void 0:tt.id)??null);B(ar)}catch(st){if(!Te)return;k([]),B(null),R((st==null?void 0:st.message)||"Failed to load teaching assignments")}})(),()=>{Te=!1}},[e]),x.useEffect(()=>{!e||M==null||Gn(`coAttainment_selectedTa_${e}`,M)},[e,M]),x.useEffect(()=>{if(r){o(r);return}let Te=!0;return(async()=>{try{const tt=(j||[]).find(Er=>Er.id===M)||null,st=(tt==null?void 0:tt.class_type)??null;if(st){if(!Te)return;o(st);return}const kt=tt==null?void 0:tt.elective_subject_id;if(kt&&!(tt!=null&&tt.section_id)){console.log("[COAttainment] Detected elective TA, fetching elective subject details for:",kt);try{const Er=await mr(`/api/curriculum/elective-subjects/${kt}/`);if(Er.ok){const se=await Er.json(),ue=se==null?void 0:se.class_type;if(console.log("[COAttainment] Elective subject class_type:",ue),ue){if(!Te)return;o(ue);return}}else console.warn("[COAttainment] Elective subject API returned error:",Er.status)}catch(Er){console.warn("[COAttainment] Failed to fetch elective subject:",Er)}}const jt=tt==null?void 0:tt.curriculum_row_id;if(!jt)try{const Er=String(e).trim().toUpperCase(),se=await Sl();if(!Te)return;const ue=(se||[]).find(Ce=>String(Ce.course_code||"").trim().toUpperCase()===Er),J=(ue==null?void 0:ue.class_type)??null;if(J){o(J);return}const fe=await Yd();if(!Te)return;const ye=(fe||[]).find(Ce=>String(Ce.course_code||"").trim().toUpperCase()===Er);o((ye==null?void 0:ye.class_type)??null);return}catch{Te&&o(null);return}const ar=await kN(Number(jt));if(!Te)return;const tr=(ar==null?void 0:ar.class_type)??null;if(tr){o(tr);return}try{const Er=String(e).trim().toUpperCase(),se=await Yd();if(!Te)return;const ue=(se||[]).find(J=>String(J.course_code||"").trim().toUpperCase()===Er);o((ue==null?void 0:ue.class_type)??null)}catch{o(null)}}catch{Te&&o(null)}})(),()=>{Te=!1}},[j,M,r]),x.useEffect(()=>{Gn(K,{weights:T})},[K,T]),x.useEffect(()=>{let Te=!0;return(async()=>{if(M){P(!0),G(null);try{const st=(j||[]).find(jt=>jt.id===M)||null,kt=[];if(st&&st.elective_subject_id&&!st.section_id){const jt=st.elective_subject_id,ar=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(jt))}`);if(!ar.ok)throw new Error(`Elective-choices fetch failed: ${ar.status}`);const tr=await ar.json();if(!Te)return;const se=((Array.isArray(tr.results)?tr.results:Array.isArray(tr)?tr:tr.items||[])||[]).map(ue=>({id:Number(ue.student_id??ue.id),reg_no:String(ue.reg_no??ue.registration_no??ue.regno??""),name:String(ue.name??ue.full_name??ue.username??ue.student_name??""),section:ue.section_name??ue.section??null,section_id:ue.section_id??null}));if(!Te)return;oe(se.filter(ue=>Number.isFinite(ue.id)).sort(UF))}else{const jt=await pc(M);if(!Te)return;const ar=(jt.students||[]).map(tr=>({id:Number(tr.id),reg_no:String(tr.reg_no??""),name:String(tr.name??""),section:tr.section??null})).filter(tr=>Number.isFinite(tr.id)).sort(UF);oe(ar)}}catch(st){if(!Te)return;oe([]),G((st==null?void 0:st.message)||"Failed to load roster")}finally{Te&&P(!1)}}})(),()=>{Te=!1}},[M,j]);const et=x.useMemo(()=>{var tt,st;const Te=(st=(tt=n==null?void 0:n.assessments)==null?void 0:tt.cia1)==null?void 0:st.questions;return Array.isArray(Te)&&Te.length?Te.map(kt=>({key:String((kt==null?void 0:kt.key)||""),label:String((kt==null?void 0:kt.label)||(kt==null?void 0:kt.key)||""),max:Number((kt==null?void 0:kt.max)||0),co:BF(kt==null?void 0:kt.co),btl:Math.min(6,Math.max(1,Number((kt==null?void 0:kt.btl)||1)))})).filter(kt=>kt.key):HPe},[n]),Ue=x.useMemo(()=>{var tt,st;const Te=(st=(tt=n==null?void 0:n.assessments)==null?void 0:tt.cia2)==null?void 0:st.questions;return Array.isArray(Te)&&Te.length?Te.map(kt=>({key:String((kt==null?void 0:kt.key)||""),label:String((kt==null?void 0:kt.label)||(kt==null?void 0:kt.key)||""),max:Number((kt==null?void 0:kt.max)||0),co:IF(kt==null?void 0:kt.co),btl:Math.min(6,Math.max(1,Number((kt==null?void 0:kt.btl)||1)))})).filter(kt=>kt.key):VPe},[n]),It=x.useMemo(()=>{let Te=0,tt=0;const st=et||[];return st.forEach((kt,jt)=>{const ar=DF(st,jt);Te+=(Number(kt.max)||0)*ar.co1,tt+=(Number(kt.max)||0)*ar.co2}),{co1:Te,co2:tt}},[et]),ht=x.useMemo(()=>{let Te=0,tt=0;const st=Ue||[];return st.forEach((kt,jt)=>{const ar=$F(st,jt);Te+=(Number(kt.max)||0)*ar.co3,tt+=(Number(kt.max)||0)*ar.co4}),{co3:Te,co4:tt}},[Ue]),Lt=x.useMemo(()=>{var Ie,Re,xt,Gt,qt,Wt,vt,Rt,Zt,wr,br,cr,Tr,Kr,Yr,xn,hr,nr;const Te=((Ie=n==null?void 0:n.assessments)==null?void 0:Ie.ssa1)||{},tt=((Re=n==null?void 0:n.assessments)==null?void 0:Re.ssa2)||{},st=((xt=n==null?void 0:n.assessments)==null?void 0:xt.formative1)||{},kt=((Gt=n==null?void 0:n.assessments)==null?void 0:Gt.formative2)||{},jt=((qt=n==null?void 0:n.assessments)==null?void 0:qt.cia1)||{},ar=((Wt=n==null?void 0:n.assessments)==null?void 0:Wt.cia2)||{},tr=Number((vt=Te==null?void 0:Te.coMax)==null?void 0:vt.co1),Er=Number((Rt=Te==null?void 0:Te.coMax)==null?void 0:Rt.co2),se=Number(((Zt=tt==null?void 0:tt.coMax)==null?void 0:Zt.co3)??((wr=tt==null?void 0:tt.coMax)==null?void 0:wr.co1)),ue=Number(((br=tt==null?void 0:tt.coMax)==null?void 0:br.co4)??((cr=tt==null?void 0:tt.coMax)==null?void 0:cr.co2)),J=Number((Tr=jt==null?void 0:jt.coMax)==null?void 0:Tr.co1),fe=Number((Kr=jt==null?void 0:jt.coMax)==null?void 0:Kr.co2),ye=Number(((Yr=ar==null?void 0:ar.coMax)==null?void 0:Yr.co3)??((xn=ar==null?void 0:ar.coMax)==null?void 0:xn.co1)),Ce=Number(((hr=ar==null?void 0:ar.coMax)==null?void 0:hr.co4)??((nr=ar==null?void 0:ar.coMax)==null?void 0:nr.co2)),wt=Number(st==null?void 0:st.maxCo),Qe=Number(kt==null?void 0:kt.maxCo);return{ssa1:{co1:Number.isFinite(tr)?Math.max(0,tr):10,co2:Number.isFinite(Er)?Math.max(0,Er):10},ssa2:{co3:Number.isFinite(se)?Math.max(0,se):10,co4:Number.isFinite(ue)?Math.max(0,ue):10},cia1:{co1:Number.isFinite(J)?Math.max(0,J):It.co1,co2:Number.isFinite(fe)?Math.max(0,fe):It.co2},cia2:{co3:Number.isFinite(ye)?Math.max(0,ye):ht.co3,co4:Number.isFinite(Ce)?Math.max(0,Ce):ht.co4},f1:{co1:Number.isFinite(wt)?Math.max(0,wt):10,co2:Number.isFinite(wt)?Math.max(0,wt):10},f2:{co3:Number.isFinite(Qe)?Math.max(0,Qe):10,co4:Number.isFinite(Qe)?Math.max(0,Qe):10}}},[n,It,ht]),yr=x.useMemo(()=>{if(!y)return null;const Te=ax.co1,tt=ax.co2,st=ax.co3,kt=ax.co4,jt=ax.co5;return{co1:Te,co2:tt,co3:st,co4:kt,co5:jt,total:fs(Te+tt+st+kt+jt)}},[y]),Ar=async()=>{W(!0),ae(null);const Te=typeof M=="number"?M:void 0;try{if(q({}),Q({lab1:null,lab2:null}),y){let tt=null,st=null,kt=null;try{tt=await Ks("cia1",e,Te)}catch(jt){q(ar=>({...ar,lab_cia1:String((jt==null?void 0:jt.message)||jt)}))}try{st=await Ks("cia2",e,Te)}catch(jt){q(ar=>({...ar,lab_cia2:String((jt==null?void 0:jt.message)||jt)}))}try{kt=await Fm(e,Te)}catch(jt){q(ar=>({...ar,lab_model:String((jt==null?void 0:jt.message)||jt)}))}X({cia1:(tt==null?void 0:tt.data)??null,cia2:(st==null?void 0:st.data)??null,model:(kt==null?void 0:kt.data)??null});try{if(!(tt!=null&&tt.data))try{const jt=await ei("cia1",e,Te);jt&&jt.draft&&X(ar=>({...ar,cia1:jt.draft.data??jt.draft}))}catch(jt){q(ar=>({...ar,lab_cia1_draft:String((jt==null?void 0:jt.message)||jt)}))}if(!(st!=null&&st.data))try{const jt=await ei("cia2",e,Te);jt&&jt.draft&&X(ar=>({...ar,cia2:jt.draft.data??jt.draft}))}catch(jt){q(ar=>({...ar,lab_cia2_draft:String((jt==null?void 0:jt.message)||jt)}))}if(!(kt!=null&&kt.data))try{const jt=await ei("model",e,Te);jt&&jt.draft&&X(ar=>({...ar,model:jt.draft.data??jt.draft}))}catch(jt){q(ar=>({...ar,lab_model_draft:String((jt==null?void 0:jt.message)||jt)}))}}catch{}}if(y)C({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});else{const tt=ti(s)==="TCPL";let st=null,kt=null,jt=null,ar=null,tr=null,Er=null,se=null,ue=null;if(g.ssa1)try{st=await ig(e,Te)}catch(J){q(fe=>({...fe,ssa1:String((J==null?void 0:J.message)||J)}))}if(g.ssa2)try{kt=await ey(e,Te)}catch(J){q(fe=>({...fe,ssa2:String((J==null?void 0:J.message)||J)}))}if(g.formative1)if(tt)try{tr=await Ks("formative1",e,Te)}catch(J){q(fe=>({...fe,tcpl_lab1:String((J==null?void 0:J.message)||J)}))}else try{jt=await _S(e,Te)}catch(J){q(fe=>({...fe,formative1:String((J==null?void 0:J.message)||J)}))}if(g.formative2)if(tt)try{Er=await Ks("formative2",e,Te)}catch(J){q(fe=>({...fe,tcpl_lab2:String((J==null?void 0:J.message)||J)}))}else try{ar=await v0("formative2",e,Te)}catch(J){q(fe=>({...fe,formative2:String((J==null?void 0:J.message)||J)}))}if(g.cia1)try{se=await ty(e,Te)}catch(J){q(fe=>({...fe,cia1:String((J==null?void 0:J.message)||J)}))}if(g.cia2)try{ue=await w0("cia2",e,Te)}catch(J){q(fe=>({...fe,cia2:String((J==null?void 0:J.message)||J)}))}try{if(g.ssa1&&(!st||!(st.marks&&Object.keys(st.marks||{}).length)))try{const J=await ei("ssa1",e,Te);J&&J.draft&&J.draft.marks&&(st={marks:J.draft.marks})}catch(J){q(fe=>({...fe,ssa1_draft:String((J==null?void 0:J.message)||J)}))}if(g.ssa2&&(!kt||!(kt.marks&&Object.keys(kt.marks||{}).length)))try{const J=await ei("ssa2",e,Te);J&&J.draft&&J.draft.marks&&(kt={marks:J.draft.marks})}catch(J){q(fe=>({...fe,ssa2_draft:String((J==null?void 0:J.message)||J)}))}if(g.formative1){if(tt){if(!(tr!=null&&tr.data))try{const J=await ei("formative1",e,Te);J&&J.draft&&(tr={data:J.draft.data??J.draft})}catch(J){q(fe=>({...fe,tcpl_lab1_draft:String((J==null?void 0:J.message)||J)}))}}else if(!jt||!(jt.marks&&Object.keys(jt.marks||{}).length))try{const J=await ei("formative1",e,Te);J&&J.draft&&J.draft.marks&&(jt={marks:J.draft.marks})}catch(J){q(fe=>({...fe,formative1_draft:String((J==null?void 0:J.message)||J)}))}}if(g.formative2){if(tt){if(!(Er!=null&&Er.data))try{const J=await ei("formative2",e,Te);J&&J.draft&&(Er={data:J.draft.data??J.draft})}catch(J){q(fe=>({...fe,tcpl_lab2_draft:String((J==null?void 0:J.message)||J)}))}}else if(!ar||!(ar.marks&&Object.keys(ar.marks||{}).length))try{const J=await ei("formative2",e,Te);J&&J.draft&&J.draft.marks&&(ar={marks:J.draft.marks})}catch(J){q(fe=>({...fe,formative2_draft:String((J==null?void 0:J.message)||J)}))}}if(g.cia1&&(!se||!se.data))try{const J=await ei("cia1",e,Te);J&&J.draft&&(se={data:J.draft.data??J.draft})}catch(J){q(fe=>({...fe,cia1_draft:String((J==null?void 0:J.message)||J)}))}if(g.cia2&&(!ue||!ue.data))try{const J=await ei("cia2",e,Te);J&&J.draft&&(ue={data:J.draft.data??J.draft})}catch(J){q(fe=>({...fe,cia2_draft:String((J==null?void 0:J.message)||J)}))}}catch{}tt&&Q({lab1:(tr==null?void 0:tr.data)??null,lab2:(Er==null?void 0:Er.data)??null}),C({ssa1:st!=null&&st.marks&&typeof st.marks=="object"?st.marks:{},ssa2:kt!=null&&kt.marks&&typeof kt.marks=="object"?kt.marks:{},f1:!tt&&(jt!=null&&jt.marks)&&typeof jt.marks=="object"?jt.marks:{},f2:!tt&&(ar!=null&&ar.marks)&&typeof ar.marks=="object"?ar.marks:{},cia1:(se==null?void 0:se.data)??null,cia2:(ue==null?void 0:ue.data)??null})}}catch(tt){C({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),X({cia1:null,cia2:null,model:null}),Q({lab1:null,lab2:null}),ae((tt==null?void 0:tt.message)||"Failed to load published marks")}finally{W(!1)}};x.useEffect(()=>{e&&Ar()},[e,M,y,g,s]),x.useEffect(()=>{const Te=tt=>{try{const st=(tt==null?void 0:tt.detail)||{},kt=st.subjectId,jt=st.assessment;if(!kt||String(kt)!==String(e)||jt&&!["ssa1","formative1","cia1"].includes(String(jt)))return;Ar()}catch{}};return window.addEventListener("obe:published",Te),()=>window.removeEventListener("obe:published",Te)},[e]);const Tt=x.useMemo(()=>{const Te=new Map;if(y){const Qe=mk/2,Ie=(qt,Wt,vt)=>{const Rt=qt!=null&&qt.sheet&&typeof qt.sheet=="object"?qt.sheet:{},Zt=Rt!=null&&Rt.rowsByStudentId&&typeof Rt.rowsByStudentId=="object"?Rt.rowsByStudentId:{},wr=yi(Number((Rt==null?void 0:Rt.expCountA)??0),0,12),br=yi(Number((Rt==null?void 0:Rt.expCountB)??0),0,12),cr=!!(Rt!=null&&Rt.coAEnabled),Tr=!!(Rt!=null&&Rt.coBEnabled),Kr=!!(Rt!=null&&Rt.ciaExamEnabled),Yr=Rt!=null&&Rt.coConfigs&&typeof Rt.coConfigs=="object"?Rt.coConfigs:null,xn=Yr?Yr[String(Wt)]:null,hr=vt!=null&&Yr?Yr[String(vt)]:null,nr=xn?!!xn.enabled:cr,Mr=vt!=null?hr?!!hr.enabled:Tr:!1,an=xn?yi(Number(xn.expCount??0),0,12):wr,it=vt!=null?hr?yi(Number(hr.expCount??0),0,12):br:0,Ye=xn&&Number.isFinite(Number(xn.expMax))?Number(xn.expMax):Number.isFinite(Number(Rt==null?void 0:Rt.expMaxA))?Number(Rt.expMaxA):25,ct=vt!=null?hr&&Number.isFinite(Number(hr.expMax))?Number(hr.expMax):Number.isFinite(Number(Rt==null?void 0:Rt.expMaxB))?Number(Rt.expMaxB):25:0,Ht=Ye+(Kr?Qe:0),fr=vt!=null?ct+(Kr?Qe:0):0;return{get:gr=>{const Ze=Zt[String(gr)]||{},Kt=Ze!=null&&Ze.marksByCo&&typeof Ze.marksByCo=="object"?Ze.marksByCo:{},nt=(Kt==null?void 0:Kt[String(Wt)])??Ze.marksA,bt=vt!=null?(Kt==null?void 0:Kt[String(vt)])??Ze.marksB:[],St=sx(nt,an).slice(0,nr?an:0),Ct=sx(bt,it).slice(0,Mr?it:0),$t=gv(St),Vt=gv(Ct),Dt=Ze==null?void 0:Ze.ciaExam,ze=typeof Dt=="number"&&Number.isFinite(Dt)?Dt:null,at=$t!=null||Vt!=null||ze!=null,_t=at?($t??0)+(Kr?(ze??0)/2:0):null,Ft=at?(Vt??0)+(Kr?(ze??0)/2:0):null;return{a:_t==null?null:yi(_t,0,Ht),b:Ft==null?null:yi(Ft,0,fr)}},coA:Wt,coB:vt,CO_MAX_A:Ht,CO_MAX_B:fr,expMaxA:Ye,expMaxB:ct,expCountA:an,expCountB:it}},Re=Ie(O.cia1,1,2),xt=Ie(O.cia2,3,4),Gt=Ie(O.model,5,null);for(const qt of H){const Wt=Re.get(qt.id),vt=xt.get(qt.id),Rt=Gt.get(qt.id);Te.set(qt.id,{co1:Wt.a,co2:Wt.b,co3:vt.a,co4:vt.b,co5:Rt.a,coMax1:Re.CO_MAX_A,coMax2:Re.CO_MAX_B,coMax3:xt.CO_MAX_A,coMax4:xt.CO_MAX_B,coMax5:Gt.CO_MAX_A})}return Te}const tt=ti(s)==="TCPL",st=Qe=>{const Ie=Qe!=null&&Qe.sheet&&typeof Qe.sheet=="object"?Qe.sheet:{},Re=Ie!=null&&Ie.rowsByStudentId&&typeof Ie.rowsByStudentId=="object"?Ie.rowsByStudentId:{},xt=yi(Number((Ie==null?void 0:Ie.expCountA)??0),0,12),Gt=yi(Number((Ie==null?void 0:Ie.expCountB)??0),0,12),qt=Number.isFinite(Number(Ie==null?void 0:Ie.expMaxA))?Number(Ie.expMaxA):25,Wt=Number.isFinite(Number(Ie==null?void 0:Ie.expMaxB))?Number(Ie.expMaxB):25,vt=(Ie==null?void 0:Ie.ciaExamEnabled)!==!1,Rt=mk/2,Zt=qt+(vt?Rt:0),wr=Wt+(vt?Rt:0);return{get:cr=>{const Tr=Re[String(cr)]||{},Kr=sx(Tr==null?void 0:Tr.marksA,xt),Yr=sx(Tr==null?void 0:Tr.marksB,Gt),xn=gv(Kr),hr=gv(Yr),nr=Tr==null?void 0:Tr.ciaExam,Mr=typeof nr=="number"&&Number.isFinite(nr)?nr:null,an=xn!=null||hr!=null||Mr!=null,it=an?(xn??0)+(vt?(Mr??0)/2:0):null,Ye=an?(hr??0)+(vt?(Mr??0)/2:0):null;return{a:it==null?null:yi(it,0,Zt),b:Ye==null?null:yi(Ye,0,wr)}},CO_MAX_A:Zt,CO_MAX_B:wr}},kt=tt?st(F.lab1):null,jt=tt?st(F.lab2):null,ar=(()=>{if(!v)return null;const Qe=String(M??"none"),Ie=ti(s),Re=[];Ie==="THEORY"?(Re.push(`model_theory_sheet_${e}_${Qe}`),Re.push(`model_theory_sheet_${e}_none`)):Ie==="TCPL"?(Re.push(`model_tcpl_sheet_${e}_${Qe}`),Re.push(`model_tcpl_sheet_${e}_none`)):Ie==="TCPR"&&(Re.push(`model_tcpr_sheet_${e}_${Qe}`),Re.push(`model_tcpr_sheet_${e}_none`)),Re.push(`model_sheet_${e}`);for(const xt of Re){const Gt=Qn(xt);if(Gt&&typeof Gt=="object")return Gt}return null})(),tr=Qe=>{const Ie=ti(s),Re=ar&&typeof ar=="object"?ar:null,qt=Ie==="THEORY"?gk:0;if(!v)return{mark:null,max:qt};if(!Re)return{mark:null,max:qt};let Wt=qt;const vt=`id:${String(Qe.id)}`,Rt=Qe.reg_no?`reg:${String(Qe.reg_no).trim()}`:"",Zt=Re[vt]||(Rt?Re[Rt]:null)||null;if(!Zt||typeof Zt!="object")return{mark:null,max:Wt};const wr=!!Zt.absent,br=String(Zt.absentKind||"AL").toUpperCase(),cr=Zt.q&&typeof Zt.q=="object"?Zt.q:{};let Tr=!1,Kr=0;if(Wt=0,Ie==="THEORY"){Wt=gk;for(let Yr=0;Yr<f3.length;Yr++){const xn=f3[Yr],hr=cr[xn.key],nr=Gl(hr);if(nr==null)continue;Tr=!0;const Mr=yi(nr,0,xn.max);PK[Yr]===5&&(Kr+=Mr)}}else if(Ie==="TCPL"||Ie==="TCPR"){const Yr=Ie==="TCPR",xn=Yr?12:15,hr=Yr?8:10,nr=Yr?[1,1,2,2,3,3,4,4,1,2,3,4]:[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];for(let it=0;it<xn;it++){const Ye=it+1,ct=`q${Ye}`,Ht=Ye<=hr?2:16,fr=nr[it]??1;fr===5&&(Wt+=Ht);const Sr=cr[ct],gr=Gl(Sr);if(gr==null)continue;Tr=!0;const Ze=yi(gr,0,Ht);fr===5&&(Kr+=Ze)}const Mr=Gl(Zt.lab);Mr!=null&&(Tr=!0);const an=Mr==null?null:yi(Mr,0,30);Yr?(Wt+=30,an!=null&&(Kr+=an)):(Wt+=30/5,an!=null&&(Kr+=an/5))}return Tr?wr&&br==="AL"?{mark:0,max:Wt}:{mark:yi(Kr,0,Wt),max:Wt}:wr&&br==="AL"?{mark:0,max:Wt}:{mark:null,max:Wt}},Er=ee.f1&&typeof ee.f1=="object"?ee.f1:{},se=ee.f2&&typeof ee.f2=="object"?ee.f2:{},ue=ee.cia1&&typeof ee.cia1=="object"?ee.cia1:null,J=Array.isArray(ue==null?void 0:ue.questions)?ue.questions.map(Qe=>({key:String((Qe==null?void 0:Qe.key)||""),label:String((Qe==null?void 0:Qe.label)||(Qe==null?void 0:Qe.key)||""),max:Number((Qe==null?void 0:Qe.max)||0),co:BF(Qe==null?void 0:Qe.co),btl:Math.min(6,Math.max(1,Number((Qe==null?void 0:Qe.btl)||1)))})).filter(Qe=>Qe.key):et,fe=ue!=null&&ue.rowsByStudentId&&typeof ue.rowsByStudentId=="object"?ue.rowsByStudentId:{},ye=ee.cia2&&typeof ee.cia2=="object"?ee.cia2:null,Ce=Array.isArray(ye==null?void 0:ye.questions)?ye.questions.map(Qe=>({key:String((Qe==null?void 0:Qe.key)||""),label:String((Qe==null?void 0:Qe.label)||(Qe==null?void 0:Qe.key)||""),max:Number((Qe==null?void 0:Qe.max)||0),co:IF(Qe==null?void 0:Qe.co),btl:Math.min(6,Math.max(1,Number((Qe==null?void 0:Qe.btl)||1)))})).filter(Qe=>Qe.key):Ue,wt=ye!=null&&ye.rowsByStudentId&&typeof ye.rowsByStudentId=="object"?ye.rowsByStudentId:{};for(const Qe of H){const Ie=(ee.ssa1&&typeof ee.ssa1=="object"?ee.ssa1[String(Qe.id)]:null)??null,Re=Ie==null?null:Number(Ie)/2,xt=Re==null?null:yi(Re,0,Lt.ssa1.co1),Gt=Re==null?null:yi(Re,0,Lt.ssa1.co2),qt=(ee.ssa2&&typeof ee.ssa2=="object"?ee.ssa2[String(Qe.id)]:null)??null,Wt=qt==null?null:Number(qt)/2,vt=Wt==null?null:yi(Wt,0,Lt.ssa2.co3),Rt=Wt==null?null:yi(Wt,0,Lt.ssa2.co4),Zt=tt&&kt?kt.get(Qe.id):null,wr=tt&&jt?jt.get(Qe.id):null,br=Er[String(Qe.id)]||{},cr=Gl(br==null?void 0:br.skill1),Tr=Gl(br==null?void 0:br.skill2),Kr=Gl(br==null?void 0:br.att1),Yr=Gl(br==null?void 0:br.att2),xn=tt?(Zt==null?void 0:Zt.a)??null:cr!=null&&Kr!=null?yi(cr+Kr,0,Lt.f1.co1):null,hr=tt?(Zt==null?void 0:Zt.b)??null:Tr!=null&&Yr!=null?yi(Tr+Yr,0,Lt.f1.co2):null,nr=se[String(Qe.id)]||{},Mr=Gl(nr==null?void 0:nr.skill1),an=Gl(nr==null?void 0:nr.skill2),it=Gl(nr==null?void 0:nr.att1),Ye=Gl(nr==null?void 0:nr.att2),ct=tt?(wr==null?void 0:wr.a)??null:Mr!=null&&it!=null?yi(Mr+it,0,Lt.f2.co3):null,Ht=tt?(wr==null?void 0:wr.b)??null:an!=null&&Ye!=null?yi(an+Ye,0,Lt.f2.co4):null,fr=fe[String(Qe.id)]||{},Sr=!!(fr!=null&&fr.absent),gr=fr!=null&&fr.q&&typeof fr.q=="object"?fr.q:{};let Ze=null,Kt=null;if(!Sr){let Dt=0,ze=0,at=!1;J.forEach((_t,Ft)=>{const pr=gr==null?void 0:gr[_t.key],or=Gl(pr);if(or==null)return;at=!0;const Xt=yi(or,0,Number(_t.max)||or),xe=DF(J,Ft);Dt+=Xt*xe.co1,ze+=Xt*xe.co2}),at&&(Ze=yi(Dt,0,Lt.cia1.co1),Kt=yi(ze,0,Lt.cia1.co2))}const nt=wt[String(Qe.id)]||{},bt=!!(nt!=null&&nt.absent),St=nt!=null&&nt.q&&typeof nt.q=="object"?nt.q:{};let Ct=null,$t=null;if(!bt){let Dt=0,ze=0,at=!1;Ce.forEach((_t,Ft)=>{const pr=St==null?void 0:St[_t.key],or=Gl(pr);if(or==null)return;at=!0;const Xt=yi(or,0,Number(_t.max)||or),xe=$F(Ce,Ft);Dt+=Xt*xe.co3,ze+=Xt*xe.co4}),at&&(Ct=yi(Dt,0,Lt.cia2.co3),$t=yi(ze,0,Lt.cia2.co4))}const Vt=v?tr(Qe):{mark:null,max:0};Te.set(Qe.id,{ssaCo1:xt,ssaCo2:Gt,ssaCo3:vt,ssaCo4:Rt,ciaCo1:Ze,ciaCo2:Kt,ciaCo3:Ct,ciaCo4:$t,f1Co1:xn,f1Co2:hr,f2Co3:ct,f2Co4:Ht,modelCo5:Vt.mark,modelCo5Max:Vt.max})}return Te},[ee,O,F,H,Lt,et,y,s,e,M,v]),Vr=x.useMemo(()=>{if(!b)return null;const Te=tt=>{const st=tt!=null&&tt.sheet&&typeof tt.sheet=="object"?tt.sheet:{},kt=Number.isFinite(Number(st==null?void 0:st.expMaxA))?Number(st.expMaxA):25,jt=Number.isFinite(Number(st==null?void 0:st.expMaxB))?Number(st.expMaxB):25,ar=(st==null?void 0:st.ciaExamEnabled)!==!1,tr=mk/2;return{a:kt+(ar?tr:0),b:jt+(ar?tr:0)}};return{lab1:Te(F.lab1),lab2:Te(F.lab2)}},[b,F]),Br=x.useMemo(()=>{var J,fe,ye,Ce;const Te=b?((J=Vr==null?void 0:Vr.lab1)==null?void 0:J.a)??Lt.f1.co1:Lt.f1.co1,tt=b?((fe=Vr==null?void 0:Vr.lab1)==null?void 0:fe.b)??Lt.f1.co2:Lt.f1.co2,st=b?((ye=Vr==null?void 0:Vr.lab2)==null?void 0:ye.a)??Lt.f2.co3:Lt.f2.co3,kt=b?((Ce=Vr==null?void 0:Vr.lab2)==null?void 0:Ce.b)??Lt.f2.co4:Lt.f2.co4,jt=(g.ssa1?Lt.ssa1.co1:0)+(g.cia1?Lt.cia1.co1:0)+(g.formative1?Te:0),ar=(g.ssa1?Lt.ssa1.co2:0)+(g.cia1?Lt.cia1.co2:0)+(g.formative1?tt:0),tr=(g.ssa2?Lt.ssa2.co3:0)+(g.cia2?Lt.cia2.co3:0)+(g.formative2?st:0),Er=(g.ssa2?Lt.ssa2.co4:0)+(g.cia2?Lt.cia2.co4:0)+(g.formative2?kt:0),se=v?ie:0,ue=jt+ar+tr+Er+se;return{f1MaxCo1:Te,f1MaxCo2:tt,f2MaxCo3:st,f2MaxCo4:kt,co1:jt,co2:ar,co3:tr,co4:Er,co5:se,total:ue}},[b,Vr,Lt,g,v,ie]),Wr=x.useMemo(()=>{if(y){const Qe=yr||{co1:55,co2:55,co3:55,co4:55,co5:55},Ie=(qt,Wt)=>qt==null||!Wt?null:fs(qt/Wt*100),Re=(qt,Wt)=>qt==null||!Wt?null:Mf(qt/Wt*3),xt=[O.cia1,O.cia2,O.model].filter(Boolean),Gt=qt=>{const Wt=[0,0,0,0,0,0,0],vt=[0,0,0,0,0,0,0];for(const Zt of xt){const wr=Zt!=null&&Zt.sheet&&typeof Zt.sheet=="object"?Zt.sheet:{},cr=(wr!=null&&wr.rowsByStudentId&&typeof wr.rowsByStudentId=="object"?wr.rowsByStudentId:{})[String(qt)]||{},Tr=wr!=null&&wr.coConfigs&&typeof wr.coConfigs=="object"?wr.coConfigs:null,Kr=cr!=null&&cr.marksByCo&&typeof cr.marksByCo=="object"?cr.marksByCo:{},Yr=!!(wr!=null&&wr.coAEnabled),xn=!!(wr!=null&&wr.coBEnabled),hr=yi(Number((wr==null?void 0:wr.expCountA)??0),0,12),nr=yi(Number((wr==null?void 0:wr.expCountB)??0),0,12),Mr=Number.isFinite(Number(wr==null?void 0:wr.expMaxA))?Number(wr.expMaxA):25,an=Number.isFinite(Number(wr==null?void 0:wr.expMaxB))?Number(wr.expMaxB):25,it=Array.isArray(wr==null?void 0:wr.btlA)?wr.btlA:[],Ye=Array.isArray(wr==null?void 0:wr.btlB)?wr.btlB:[],ct=(Ht,fr,Sr,gr,Ze,Kt)=>{if(!fr||Sr<=0||!gr)return;const nt=sx(Kt,Sr);for(let bt=0;bt<Sr;bt++){const St=xk(Ze[bt]),Ct=typeof nt[bt]=="number"&&Number.isFinite(nt[bt])?nt[bt]:null;if(!St||Ct==null)continue;const $t=yi(Ct,0,gr)*(10/gr);Wt[St]+=$t,vt[St]+=1}};if(Tr)for(const[Ht,fr]of Object.entries(Tr)){const Sr=Number(Ht);if(!Number.isFinite(Sr)||!fr||typeof fr!="object")continue;const gr=!!fr.enabled,Ze=yi(Number(fr.expCount??0),0,12),Kt=Number.isFinite(Number(fr.expMax))?Number(fr.expMax):25,nt=Array.isArray(fr.btl)?fr.btl:[],bt=(Kr==null?void 0:Kr[String(Sr)])??[];ct(Sr,gr,Ze,Kt,nt,bt)}else ct(0,Yr,hr,Mr,it,cr.marksA),ct(0,xn,nr,an,Ye,cr.marksB)}const Rt={};for(let Zt=1;Zt<=6;Zt++)Rt[`btl${Zt}`]=vt[Zt]?fs(Wt[Zt]/vt[Zt]):null,Rt[`btl${Zt}Pct`]=vt[Zt]?fs(Wt[Zt]/vt[Zt]/10*100):null;return Rt};return H.map((qt,Wt)=>{const vt=Tt.get(qt.id)||{},Rt=typeof vt.co1=="number"?vt.co1:null,Zt=typeof vt.co2=="number"?vt.co2:null,wr=typeof vt.co3=="number"?vt.co3:null,br=typeof vt.co4=="number"?vt.co4:null,cr=typeof vt.co5=="number"?vt.co5:null,Tr=Gt(qt.id),Kr=[Rt,Zt,wr,br,cr].every(Yr=>typeof Yr=="number")?fs(Rt+Zt+wr+br+cr):null;return{sno:Wt+1,...qt,co1:Rt,co1Pct:Ie(Rt,Qe.co1),co1_3pt:Re(Rt,Qe.co1),co2:Zt,co2Pct:Ie(Zt,Qe.co2),co2_3pt:Re(Zt,Qe.co2),co3:wr,co3Pct:Ie(wr,Qe.co3),co3_3pt:Re(wr,Qe.co3),co4:br,co4Pct:Ie(br,Qe.co4),co4_3pt:Re(br,Qe.co4),co5:cr,co5Pct:Ie(cr,Qe.co5),co5_3pt:Re(cr,Qe.co5),...Tr,total:Kr}})}const Te=g.ssa1?T.ssa1:0,tt=g.cia1?T.cia1:0,st=g.formative1?T.formative1:0,kt=g.ssa2?T.ssa1:0,jt=g.cia2?T.cia1:0,ar=g.formative2?T.formative1:0,{f1MaxCo1:tr,f1MaxCo2:Er,f2MaxCo3:se,f2MaxCo4:ue}=Br,J=Br.co1,fe=Br.co2,ye=Br.co3,Ce=Br.co4,wt=Br.co5;return H.map((Qe,Ie)=>{const Re=Tt.get(Qe.id),xt=xv({ssaMark:(Re==null?void 0:Re.ssaCo1)??null,ciaMark:(Re==null?void 0:Re.ciaCo1)??null,f1Mark:(Re==null?void 0:Re.f1Co1)??null,ssaMax:Lt.ssa1.co1,ciaMax:Lt.cia1.co1,f1Max:tr,ssaW:Te,ciaW:tt,f1W:st,outOf:J}),Gt=xv({ssaMark:(Re==null?void 0:Re.ssaCo2)??null,ciaMark:(Re==null?void 0:Re.ciaCo2)??null,f1Mark:(Re==null?void 0:Re.f1Co2)??null,ssaMax:Lt.ssa1.co2,ciaMax:Lt.cia1.co2,f1Max:Er,ssaW:Te,ciaW:tt,f1W:st,outOf:fe}),qt=xv({ssaMark:(Re==null?void 0:Re.ssaCo3)??null,ciaMark:(Re==null?void 0:Re.ciaCo3)??null,f1Mark:(Re==null?void 0:Re.f2Co3)??null,ssaMax:Lt.ssa2.co3,ciaMax:Lt.cia2.co3,f1Max:se,ssaW:kt,ciaW:jt,f1W:ar,outOf:ye}),Wt=xv({ssaMark:(Re==null?void 0:Re.ssaCo4)??null,ciaMark:(Re==null?void 0:Re.ciaCo4)??null,f1Mark:(Re==null?void 0:Re.f2Co4)??null,ssaMax:Lt.ssa2.co4,ciaMax:Lt.cia2.co4,f1Max:ue,ssaW:kt,ciaW:jt,f1W:ar,outOf:Ce}),vt=xt==null||!J?null:fs(xt/J*100),Rt=Gt==null||!fe?null:fs(Gt/fe*100),Zt=qt==null||!ye?null:fs(qt/ye*100),wr=Wt==null||!Ce?null:fs(Wt/Ce*100),br=typeof(Re==null?void 0:Re.modelCo5)=="number"&&Number.isFinite(Re.modelCo5)?Re.modelCo5:null,cr=typeof(Re==null?void 0:Re.modelCo5Max)=="number"&&Number.isFinite(Re.modelCo5Max)?Math.max(0,Re.modelCo5Max):gk,Tr=!v||br==null||!cr||!wt?null:yi(br/cr*wt,0,wt),Kr=Tr==null||!wt?null:fs(Tr/wt*100),Yr=xt==null||!J?null:Mf(xt/J*3),xn=Gt==null||!fe?null:Mf(Gt/fe*3),hr=qt==null||!ye?null:Mf(qt/ye*3),nr=Wt==null||!Ce?null:Mf(Wt/Ce*3),Mr=Tr==null||!wt?null:Mf(Tr/wt*3),an=[{enabled:J>0,v:xt},{enabled:fe>0,v:Gt},{enabled:ye>0,v:qt},{enabled:Ce>0,v:Wt},...v?[{enabled:wt>0,v:Tr}]:[]];let it=!1,Ye=!1,ct=0;for(const fr of an)if(fr.enabled){if(it=!0,typeof fr.v!="number"||!Number.isFinite(fr.v)){Ye=!0;break}ct+=fr.v}const Ht=!it||Ye?null:fs(ct);return{sno:Ie+1,...Qe,co1:xt,co1Pct:vt,co1_3pt:Yr,co2:Gt,co2Pct:Rt,co2_3pt:xn,co3:qt,co3Pct:Zt,co3_3pt:hr,co4:Wt,co4Pct:wr,co4_3pt:nr,co5:Tr,co5Pct:Kr,co5_3pt:Mr,total:Ht}})},[H,Tt,Lt,T,g,v,ie,Br,y,yr,O]),nn=x.useMemo(()=>{if(y){const tr=Er=>{const se=Wr.map(ue=>ue==null?void 0:ue[Er]).filter(ue=>typeof ue=="number");return se.length?Mf(se.reduce((ue,J)=>ue+J,0)/se.length):null};return{strength:H.length,co1Avg3pt:tr("co1_3pt"),co2Avg3pt:tr("co2_3pt"),co3Avg3pt:tr("co3_3pt"),co4Avg3pt:tr("co4_3pt"),co5Avg3pt:tr("co5_3pt")}}const Te=Wr.map(tr=>tr.co1_3pt).filter(tr=>typeof tr=="number"),tt=Wr.map(tr=>tr.co2_3pt).filter(tr=>typeof tr=="number"),st=Wr.map(tr=>tr.co3_3pt).filter(tr=>typeof tr=="number"),kt=Wr.map(tr=>tr.co4_3pt).filter(tr=>typeof tr=="number"),jt=Wr.map(tr=>tr.co5_3pt).filter(tr=>typeof tr=="number"),ar=tr=>tr.length?Mf(tr.reduce((Er,se)=>Er+se,0)/tr.length):null;return{strength:H.length,co1Avg3pt:ar(Te),co2Avg3pt:ar(tt),co3Avg3pt:ar(st),co4Avg3pt:ar(kt),...v?{co5Avg3pt:ar(jt)}:{}}},[Wr,H.length,y,v]),fn=x.useMemo(()=>{const Te=Number(yr==null?void 0:yr.co1);return Number.isFinite(Te)&&Te>0?Te:55},[yr]),Ir=x.useMemo(()=>{if(!y)return{1:0,2:0,3:0,4:0,5:0,6:0};const Te={1:!1,2:!1,3:!1,4:!1,5:!1,6:!1},tt=[O.cia1,O.cia2,O.model].filter(Boolean);for(const st of tt){const kt=st!=null&&st.sheet&&typeof st.sheet=="object"?st.sheet:{},jt=yi(Number((kt==null?void 0:kt.expCountA)??0),0,12),ar=yi(Number((kt==null?void 0:kt.expCountB)??0),0,12),tr=!!(kt!=null&&kt.coAEnabled),Er=!!(kt!=null&&kt.coBEnabled),se=Array.isArray(kt==null?void 0:kt.btlA)?kt.btlA:[],ue=Array.isArray(kt==null?void 0:kt.btlB)?kt.btlB:[];if(tr)for(let J=0;J<jt;J++){const fe=xk(se[J]);fe&&(Te[fe]=!0)}if(Er)for(let J=0;J<ar;J++){const fe=xk(ue[J]);fe&&(Te[fe]=!0)}}return{1:Te[1]?10:0,2:Te[2]?10:0,3:Te[3]?10:0,4:Te[4]?10:0,5:Te[5]?10:0,6:Te[6]?10:0}},[y,O]),dn={padding:"8px 10px",borderRadius:10,border:"1px solid #e5e7eb",width:90};return a.jsxs("div",{style:{display:"grid",gap:14},children:[(de||V)&&a.jsx("div",{style:{fontSize:12,color:V?"#b91c1c":"#6b7280"},children:de?"Loading published marks":V}),Y&&Object.keys(Y).length>0&&a.jsx("div",{style:{marginTop:6,fontSize:12},children:Object.entries(Y).map(([Te,tt])=>tt?a.jsxs("div",{style:{color:"#b91c1c"},children:[Te,": ",String(tt)]},Te):null)}),a.jsxs("div",{style:{padding:16,borderRadius:12,background:"linear-gradient(180deg,#ffffff, #f6fbff)",border:"1px solid #e6eef8",boxShadow:"0 6px 20px rgba(13, 60, 100, 0.06)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:18,fontWeight:800,color:"#0b4a6f"},children:y?"CO Attainment (LAB)":"CO Attainment (Summative + Formative)"}),a.jsx("div",{style:{marginTop:6,color:"#264653",fontSize:13},children:y?"Uses published LAB sheets: CIA1 LAB (CO1/CO2) + CIA2 LAB (CO3/CO4) + MODEL LAB (CO5).":"Uses weighted blending per CO: SSA1 + CIA1 + Formative1 (based on your Excel formula)."})]}),a.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"Teaching Assignment / Section"}),a.jsxs("select",{value:M??"",onChange:Te=>B(Te.target.value?Number(Te.target.value):null),style:{padding:"10px 12px",borderRadius:10,border:"1px solid #e5e7eb",minWidth:320},children:[a.jsx("option",{value:"",children:"Select"}),j.map(Te=>{const tt=Te.department,st=(tt==null?void 0:tt.short_name)||(tt==null?void 0:tt.code)||(tt==null?void 0:tt.name)||Te.department_name||"",kt=Te.semester;return a.jsxs("option",{value:Te.id,children:[Te.section_name," ",kt?` Sem ${kt}`:""," ",Te.academic_year?` ${Te.academic_year}`:""," ",st?` ${st}`:""]},Te.id)})]})]})})]}),A&&a.jsx("div",{style:{marginTop:10,background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:A}),y?a.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12,marginTop:12},children:a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"LAB CO max"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["CO max values are pulled from published LAB sheets only.",yr?a.jsx(a.Fragment,{children:S.map((Te,tt)=>{const st=`co${Te}`;return a.jsxs(Jr.Fragment,{children:[tt>0&&" | ","CO",Te,": ",a.jsx("b",{children:yr[st]})]},Te)})}):a.jsxs(a.Fragment,{children:[" Each CO max is ",a.jsx("b",{children:fn}),"."]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",a.jsx("b",{children:nn.strength}),S.map(Te=>{const tt=`co${Te}Avg3pt`;return a.jsxs(Jr.Fragment,{children:["| CO",Te," avg (3pt): ",a.jsx("b",{children:nn[tt]??"-"})]},Te)})]})]})}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr",gap:12,marginTop:12},children:[a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Max marks per CO (P4:P6)"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 120px 120px 120px",gap:8,alignItems:"center"},children:[a.jsx("div",{}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"SSA1"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"CIA1"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",fontWeight:700},children:"Formative1"}),a.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO1"}),a.jsx("div",{children:Lt.ssa1.co1}),a.jsx("div",{children:Lt.cia1.co1}),a.jsx("div",{children:Lt.f1.co1}),a.jsx("div",{style:{fontSize:12,fontWeight:700},children:"CO2"}),a.jsx("div",{children:Lt.ssa1.co2}),a.jsx("div",{children:Lt.cia1.co2}),a.jsx("div",{children:Lt.f1.co2})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:S.filter(Te=>Te<=4||v).map((Te,tt)=>{const st=`co${Te}`,kt=Te===5?ie:Br[st];return a.jsxs(Jr.Fragment,{children:[tt>0&&a.jsx(a.Fragment,{children:"|"}),"CO",Te," total max: ",a.jsx("b",{children:kt})]},Te)})})]}),a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Weights (R4:R6)"}),a.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Source: ",a.jsx("b",{children:me==="server"?"IQAC (server)":me==="local"?"IQAC (local)":"Defaults"})]})]}),_e&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:_e}),qe&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",qe]}),ut!=null&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#475569"},children:["Known class-types on server/local: ",ut]}),a.jsx("div",{style:{marginTop:6},children:a.jsxs("button",{onClick:()=>ve(Te=>!Te),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[lt?"Hide":"Show"," raw IQAC mapping"]})}),lt&&a.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(je.current||{},null,2).slice(0,3200)}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1",a.jsx("input",{type:"number",step:"0.1",value:T.ssa1,onChange:Te=>I(tt=>({...tt,ssa1:Number(Te.target.value)})),disabled:!ne,style:dn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1",a.jsx("input",{type:"number",step:"0.1",value:T.cia1,onChange:Te=>I(tt=>({...tt,cia1:Number(Te.target.value)})),disabled:!ne,style:dn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1",a.jsx("input",{type:"number",step:"0.1",value:T.formative1,onChange:Te=>I(tt=>({...tt,formative1:Number(Te.target.value)})),disabled:!ne,style:dn})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Batch strength: ",a.jsx("b",{children:nn.strength})," | CO1 avg (3pt): ",a.jsx("b",{children:nn.co1Avg3pt??"-"})," | CO2 avg (3pt): ",a.jsx("b",{children:nn.co2Avg3pt??"-"})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"Note: CIA1 CO marks are computed from the locally saved CIA1 question-wise sheet."})]})]}),a.jsx("div",{style:{marginTop:12},children:a.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e9f0f7",padding:12},children:[a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[a.jsx("div",{style:{fontWeight:800,color:"#0b3b57",marginBottom:8},children:"Assessment Weights"}),a.jsxs("div",{style:{fontSize:12,color:"#475569"},children:["Class Type: ",a.jsx("b",{children:s||"Unknown"})," | Source: ",a.jsx("b",{children:me==="server"?"IQAC (server)":me==="local"?"IQAC (local)":"Defaults"})]})]}),_e&&a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:_e}),qe&&a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#b91c1c"},children:["Weights load error: ",qe]}),a.jsx("div",{style:{marginTop:6},children:a.jsxs("button",{onClick:()=>ve(Te=>!Te),style:{background:"transparent",border:"none",color:"#0b66a3",cursor:"pointer",padding:0,fontSize:12},children:[lt?"Hide":"Show"," raw IQAC mapping"]})}),lt&&a.jsx("pre",{style:{marginTop:8,maxHeight:220,overflow:"auto",background:"#0f1724",color:"#e6eef8",padding:10,borderRadius:8},children:JSON.stringify(je.current||{},null,2).slice(0,3200)}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginTop:12},children:[a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["SSA1 Weight",a.jsx("input",{type:"number",step:"0.1",value:T.ssa1,onChange:Te=>I(tt=>({...tt,ssa1:Number(Te.target.value)})),disabled:!ne,style:dn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CIA1 Weight",a.jsx("input",{type:"number",step:"0.1",value:T.cia1,onChange:Te=>I(tt=>({...tt,cia1:Number(Te.target.value)})),disabled:!ne,style:dn})]}),a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["Formative1 Weight",a.jsx("input",{type:"number",step:"0.1",value:T.formative1,onChange:Te=>I(tt=>({...tt,formative1:Number(Te.target.value)})),disabled:!ne,style:dn})]}),v&&a.jsxs("label",{style:{display:"grid",gap:6,fontSize:12},children:["CO5 Weightage (MODEL)",a.jsx("input",{type:"number",step:"1",value:ie,onChange:Te=>U(Number(Te.target.value)),disabled:!ne,style:dn})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["These weights determine how SSA1, CIA1, and Formative1 assessments contribute to CO attainment calculations.",!ne&&a.jsxs("span",{style:{color:"#059669",fontWeight:600},children:[" Values shown are appropriate defaults for ",s||"this"," class type."]})]})]})})]}),D&&a.jsx("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:10,borderRadius:10},children:D}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:10},children:a.jsx("button",{onClick:()=>ce(!Ae),style:{padding:"8px 16px",backgroundColor:Ae?"#059669":"#0ea5e9",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",fontWeight:600,fontSize:13},children:Ae?"Show CO Columns":"Hide CO Columns"})}),E?a.jsx("div",{style:{color:"#6b7280"},children:"Loading roster"}):a.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,overflow:"auto",background:"#fff"},children:y?a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:2100},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{rowSpan:2,style:Ri,children:"S.No"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Section"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Register No"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Name"}),!Ae&&a.jsx(a.Fragment,{children:S.map(Te=>a.jsxs("th",{colSpan:3,style:Lf,children:["CO",Te]},`co${Te}`))}),a.jsx("th",{rowSpan:2,style:Ri,children:"CQI Entry"}),a.jsx("th",{colSpan:2,style:Lf,children:"BTL-1"}),a.jsx("th",{colSpan:2,style:Lf,children:"BTL-2"}),a.jsx("th",{colSpan:2,style:Lf,children:"BTL-3"}),a.jsx("th",{colSpan:2,style:Lf,children:"BTL-4"}),a.jsx("th",{colSpan:2,style:Lf,children:"BTL-5"}),a.jsx("th",{colSpan:2,style:Lf,children:"BTL-6"}),a.jsxs("th",{rowSpan:2,style:Ri,children:["Total / ",fs((yr==null?void 0:yr.total)??fn*5)]})]}),a.jsxs("tr",{children:[!Ae&&a.jsx(a.Fragment,{children:S.map(Te=>{const tt=`co${Te}`,st=(yr==null?void 0:yr[tt])??fn;return a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:Ri,children:st}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:"3pt"})]},`co${Te}-cells`)})}),a.jsx("th",{style:Ri,children:Ir[1]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Ir[2]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Ir[3]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Ir[4]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Ir[5]}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:Ir[6]}),a.jsx("th",{style:Ri,children:"%"})]})]}),a.jsx("tbody",{children:Wr.map(Te=>a.jsxs("tr",{children:[a.jsx("td",{style:Di,children:Te.sno}),a.jsx("td",{style:Di,children:Te.section??""}),a.jsx("td",{style:Di,children:Te.reg_no}),a.jsx("td",{style:Di,children:Te.name}),!Ae&&a.jsx(a.Fragment,{children:S.map(tt=>{const st=`co${tt}`,kt=`co${tt}Pct`,jt=`co${tt}_3pt`;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Di,textAlign:"center"},children:Te[st]==null?"":fs(Te[st])}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te[kt]==null?"":Te[kt]}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te[jt]==null?"":Te[jt]})]},`co${tt}-row`)})}),a.jsx("td",{style:{...Di,textAlign:"center"},children:a.jsx("input",{type:"text",value:be[Te.id]||"",onChange:tt=>mt({...be,[Te.id]:tt.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl1==null?"":fs(Te.btl1)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl1Pct==null?"":Te.btl1Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl2==null?"":fs(Te.btl2)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl2Pct==null?"":Te.btl2Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl3==null?"":fs(Te.btl3)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl3Pct==null?"":Te.btl3Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl4==null?"":fs(Te.btl4)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl4Pct==null?"":Te.btl4Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl5==null?"":fs(Te.btl5)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl5Pct==null?"":Te.btl5Pct}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl6==null?"":fs(Te.btl6)}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te.btl6Pct==null?"":Te.btl6Pct}),a.jsx("td",{style:{...Di,textAlign:"center",fontWeight:700},children:Te.total==null?"":Te.total})]},Te.id))})]}):a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",minWidth:980},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{rowSpan:2,style:Ri,children:"S.No"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Section"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Register No"}),a.jsx("th",{rowSpan:2,style:Ri,children:"Name"}),!Ae&&a.jsx(a.Fragment,{children:S.map(Te=>Te===5&&!v?null:a.jsxs("th",{colSpan:3,style:Lf,children:["CO",Te]},`co${Te}`))}),a.jsx("th",{rowSpan:2,style:Ri,children:"CQI Entry"}),a.jsxs("th",{rowSpan:2,style:Ri,children:["Total / ",Br.total]})]}),a.jsx("tr",{children:!Ae&&a.jsx(a.Fragment,{children:S.map(Te=>{if(Te===5&&!v)return null;const tt=`co${Te}`,st=Te===5?ie:Br[tt];return a.jsxs(Jr.Fragment,{children:[a.jsx("th",{style:Ri,children:st}),a.jsx("th",{style:Ri,children:"%"}),a.jsx("th",{style:Ri,children:"3pt"})]},`co${Te}-cells`)})})})]}),a.jsx("tbody",{children:Wr.map(Te=>a.jsxs("tr",{children:[a.jsx("td",{style:Di,children:Te.sno}),a.jsx("td",{style:Di,children:Te.section??""}),a.jsx("td",{style:Di,children:Te.reg_no}),a.jsx("td",{style:Di,children:Te.name}),!Ae&&a.jsx(a.Fragment,{children:S.map(tt=>{if(tt===5&&!v)return null;const st=`co${tt}`,kt=`co${tt}Pct`,jt=`co${tt}_3pt`;return a.jsxs(Jr.Fragment,{children:[a.jsx("td",{style:{...Di,textAlign:"center"},children:Te[st]==null?"":fs(Te[st])}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te[kt]==null?"":Te[kt]}),a.jsx("td",{style:{...Di,textAlign:"center"},children:Te[jt]==null?"":Te[jt]})]},`co${tt}-row`)})}),a.jsx("td",{style:{...Di,textAlign:"center"},children:a.jsx("input",{type:"text",value:be[Te.id]||"",onChange:tt=>mt({...be,[Te.id]:tt.target.value}),style:{width:"100%",minWidth:100,padding:"4px 6px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12},placeholder:"Enter CQI"})}),a.jsx("td",{style:{...Di,textAlign:"center",fontWeight:700},children:Te.total==null?"":Te.total})]},Te.id))})]})})]})}const Ri={border:"1px solid #111827",padding:"8px 8px",background:"#f3f4f6",textAlign:"center",fontWeight:800,fontSize:12,whiteSpace:"nowrap"},Lf={...Ri,background:"#eaf2ff",color:"#0b4a6f"},Di={border:"1px solid #111827",padding:"7px 8px",fontSize:12,whiteSpace:"nowrap"},Ca=[1,2,3,4,5];function Is(e){return`co${e}`}function uo(e){return{co1:e,co2:e,co3:e,co4:e,co5:e}}const JPe=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}],jd={ssa1:1.5,cia1:3,formative1:2.5},yk=1.74;function Uu(e,t,r){return Math.max(t,Math.min(r,e))}function zF(e){return Math.round(e*100)/100}function yv(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function WF(e){const t=s=>!Number.isFinite(s)||s<1||s>5?null:s;if(e==null||e==="")return[1];if(Array.isArray(e)){const s=[];for(const o of e){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}if(typeof e=="number")return[t(e)||1];const r=String(e).trim().toLowerCase();if(!r)return[1];if(r==="both")return[1,2];const n=r.replace(/[^0-9,\/\+&]+/g,"").split(/[,\/\+&]+/g).map(s=>s.trim()).filter(Boolean);if(n.length>1){const s=[];for(const o of n){const l=t(Number(o));l&&!s.includes(l)&&s.push(l)}return s.length?s:[1]}return r==="12"?[1,2]:[t(Number(r))||1]}function ZPe(e){const t=uo(0),n=Array.from(new Set((e||[]).filter(Boolean))).filter(s=>Ca.includes(s)),i=n.length||1;for(const s of n.length?n:[1])t[Is(s)]=1/i;return t}function qF(e,t){const r=e[t];if(!r)return uo(0);const n=WF(r.co),i=e.some(c=>WF(c.co).length>1),s=t===e.length-1,o=String(r.key||"").toLowerCase()==="q9"||String(r.label||"").toLowerCase().includes("q9");return ZPe(!i&&s&&o?[1,2]:n)}function HF(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function eOe(e){const{ssaMark:t,ciaMark:r,f1Mark:n,ssaMax:i,ciaMax:s,f1Max:o,ssaW:l,ciaW:c,f1W:u}=e;if(t==null||r==null||n==null||!i||!s||!o)return null;const d=l+c+u,f=i+s+o;if(!d||!f)return null;const h=(t/i*l+r/s*c+n/o*u)/d*f;return Number.isFinite(h)?Uu(h,0,f):null}function tOe({courseId:e}){const[t,r]=x.useState(null),n=x.useMemo(()=>`cqi_visible_cos_${e}`,[e]),[i,s]=x.useState(()=>{try{const I=Qn(`cqi_visible_cos_${e}`);if(Array.isArray(I)){const ie=I.map(Z=>Number(Z)).filter(Z=>Ca.includes(Z)),U=Array.from(new Set(ie));return U.length?U:[...Ca]}}catch{}return[...Ca]});x.useEffect(()=>{try{Gn(n,i)}catch{}},[n,i]);const[o,l]=x.useState(null);x.useMemo(()=>ti(o),[o]);const c=x.useMemo(()=>NN(o),[o]),[u,d]=x.useState([]),[f,p]=x.useState(null),[h,m]=x.useState(null),[g,y]=x.useState(!1),[b,v]=x.useState(null),[w,S]=x.useState([]),[j,k]=x.useState(!1),[A,R]=x.useState(null),[M,B]=x.useState({ssa:{},f1:{},cia:null}),[E,P]=x.useState({cia1:null}),[D,G]=x.useState(""),H=x.useMemo(()=>`co_attainment_cfg_${e}`,[e]),[oe,de]=x.useState(()=>{const I=Qn(`co_attainment_cfg_${e}`),ie=I==null?void 0:I.weights;return{ssa1:Number.isFinite(Number(ie==null?void 0:ie.ssa1))?Number(ie.ssa1):jd.ssa1,cia1:Number.isFinite(Number(ie==null?void 0:ie.cia1))?Number(ie.cia1):jd.cia1,formative1:Number.isFinite(Number(ie==null?void 0:ie.formative1))?Number(ie.formative1):jd.formative1}}),[W,V]=x.useState("default"),[ae,ee]=x.useState(null);x.useEffect(()=>{let I=!0;return(async()=>{try{const ie=await oc();if(!I)return;r(ie||null)}catch{}})(),()=>{I=!1}},[e]),x.useEffect(()=>{let I=!0;return(async()=>{var ie;try{const U=await hc();if(!I)return;const Z=(U||[]).filter(je=>je.subject_code===e);d(Z),p(null);const me=Qn(`coAttainment_selectedTa_${e}`),Pe=typeof me=="number"&&Z.some(je=>je.id===me)&&me||(((ie=Z[0])==null?void 0:ie.id)??null);m(Pe)}catch(U){if(!I)return;d([]),m(null),p((U==null?void 0:U.message)||"Failed to load teaching assignments")}})(),()=>{I=!1}},[e]),x.useEffect(()=>{!e||h==null||Gn(`coAttainment_selectedTa_${e}`,h)},[e,h]),x.useEffect(()=>{let I=!0;return(async()=>{try{const ie=(u||[]).find(je=>je.id===h)||null,U=String((ie==null?void 0:ie.class_type)||"").trim();if(U){I&&l(U);return}const Z=ie==null?void 0:ie.curriculum_row_id;if(!Z){I&&l(null);return}const me=await kN(Number(Z));if(!I)return;const Pe=String((me==null?void 0:me.class_type)||"").trim();l(Pe||null)}catch{I&&l(null)}})(),()=>{I=!1}},[h,u]),x.useEffect(()=>{let I=!0;return(async()=>{if(o){ee("Loading IQAC weights");try{const ie=await vS();if(!I)return;if(ie&&typeof ie=="object"){const U=ti(o),Z=ie[U];if(Z&&typeof Z=="object"){const me={ssa1:Number.isFinite(Number(Z.ssa1))?Number(Z.ssa1):jd.ssa1,cia1:Number.isFinite(Number(Z.cia1))?Number(Z.cia1):jd.cia1,formative1:Number.isFinite(Number(Z.formative1))?Number(Z.formative1):jd.formative1};de(me),V("server"),ee(`Applied server weights for ${U}`);try{Gn(H,{weights:me})}catch{}return}ee(`Server weights loaded but no entry for ${ti(o)}`)}}catch(ie){ee(`Server fetch failed: ${String((ie==null?void 0:ie.message)||ie)}`)}try{const ie=Qn("iqac_class_type_weights");if(ie&&typeof ie=="object"){const U=ti(o),Z=ie[U];if(Z&&typeof Z=="object"){const me={ssa1:Number.isFinite(Number(Z.ssa1))?Number(Z.ssa1):jd.ssa1,cia1:Number.isFinite(Number(Z.cia1))?Number(Z.cia1):jd.cia1,formative1:Number.isFinite(Number(Z.formative1))?Number(Z.formative1):jd.formative1};de(me),V("local"),ee(`Applied local weights for ${U}`);try{Gn(H,{weights:me})}catch{}return}}}catch(ie){ee(`Local read failed: ${String((ie==null?void 0:ie.message)||ie)}`)}}})(),()=>{I=!1}},[o,H]);const C=x.useMemo(()=>{var ie,U;const I=(U=(ie=t==null?void 0:t.assessments)==null?void 0:ie.cia1)==null?void 0:U.questions;return Array.isArray(I)&&I.length?I.map(Z=>({key:String((Z==null?void 0:Z.key)||""),label:String((Z==null?void 0:Z.label)||(Z==null?void 0:Z.key)||""),max:Number((Z==null?void 0:Z.max)||0),co:Z==null?void 0:Z.co,btl:Math.min(6,Math.max(1,Number((Z==null?void 0:Z.btl)||1)))})).filter(Z=>Z.key):JPe},[t]),Y=x.useMemo(()=>{const I=uo(0);return C.forEach((ie,U)=>{const Z=qF(C,U);for(const me of Ca)I[Is(me)]+=(Number(ie.max)||0)*(Z[Is(me)]||0)}),I},[C]),q=x.useMemo(()=>{var _e,He,qe;const I=((_e=t==null?void 0:t.assessments)==null?void 0:_e.ssa1)||{},ie=((He=t==null?void 0:t.assessments)==null?void 0:He.formative1)||{},U=((qe=t==null?void 0:t.assessments)==null?void 0:qe.cia1)||{},Z=(Pt,ut)=>{var lt;const Ke=uo(0);for(const ve of Ca){const Ae=Is(ve),ce=Number((lt=Pt==null?void 0:Pt.coMax)==null?void 0:lt[Ae]);Ke[Ae]=Number.isFinite(ce)?Math.max(0,ce):ut[Ae]}return Ke},me={...uo(0),co1:10,co2:10},Pe=Number(ie==null?void 0:ie.maxCo),je={...uo(0),co1:Number.isFinite(Pe)?Math.max(0,Pe):10,co2:Number.isFinite(Pe)?Math.max(0,Pe):10},Fe=Y;return{ssa:Z(I,me),cia:Z(U,Fe),f1:Z(ie,je)}},[t,Y]),O=async()=>{k(!0),R(null);try{if(c){const I=await Ks("cia1",e);B({ssa:{},f1:{},cia:null}),P({cia1:(I==null?void 0:I.data)??null})}else{const[I,ie,U]=await Promise.all([ig(e),_S(e),ty(e)]);B({ssa:I!=null&&I.marks&&typeof I.marks=="object"?I.marks:{},f1:ie!=null&&ie.marks&&typeof ie.marks=="object"?ie.marks:{},cia:(U==null?void 0:U.data)??null}),P({cia1:null})}}catch(I){B({ssa:{},f1:{},cia:null}),P({cia1:null}),R((I==null?void 0:I.message)||"Failed to load published marks")}finally{k(!1)}};x.useEffect(()=>{e&&O()},[e,c]),x.useEffect(()=>{const I=ie=>{try{const U=(ie==null?void 0:ie.detail)||{},Z=U.subjectId,me=U.assessment;if(!Z||String(Z)!==String(e)||me&&!["ssa1","formative1","cia1"].includes(String(me)))return;O()}catch{}};return window.addEventListener("obe:published",I),()=>window.removeEventListener("obe:published",I)},[e]),x.useEffect(()=>{let I=!0;return(async()=>{if(h){y(!0),v(null);try{const U=(u||[]).find(Z=>Z.id===h)||null;if(U&&U.elective_subject_id&&!U.section_id){const Z=U.elective_subject_id,me=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(Z))}`);if(!me.ok)throw new Error(`Elective-choices fetch failed: ${me.status}`);const Pe=await me.json();if(!I)return;const Fe=((Array.isArray(Pe.results)?Pe.results:Array.isArray(Pe)?Pe:Pe.items||[])||[]).map(_e=>({id:Number(_e.student_id??_e.id),reg_no:String(_e.reg_no??_e.registration_no??_e.regno??""),name:String(_e.name??_e.full_name??_e.username??""),section:_e.section_name??_e.section??null}));if(!I)return;S(Fe.filter(_e=>Number.isFinite(_e.id)).sort(HF))}else{const Z=await pc(h);if(!I)return;const me=(Z.students||[]).map(Pe=>({id:Number(Pe.id),reg_no:String(Pe.reg_no??""),name:String(Pe.name??""),section:Pe.section??null})).filter(Pe=>Number.isFinite(Pe.id)).sort(HF);S(me)}}catch(U){if(!I)return;S([]),v((U==null?void 0:U.message)||"Failed to load roster")}finally{I&&y(!1)}}})(),()=>{I=!1}},[h,u]);const X=x.useMemo(()=>{const I=new Map;if(c){const Fe=E.cia1,_e=Fe!=null&&Fe.sheet&&typeof Fe.sheet=="object"?Fe.sheet:{},He=_e!=null&&_e.rowsByStudentId&&typeof _e.rowsByStudentId=="object"?_e.rowsByStudentId:{},qe=Uu(Number((_e==null?void 0:_e.expCountA)??0),0,12),Pt=Uu(Number((_e==null?void 0:_e.expCountB)??0),0,12),ut=!!(_e!=null&&_e.coAEnabled),Ke=!!(_e!=null&&_e.coBEnabled),lt=(Ae,ce)=>{const be=Array.isArray(Ae)?Ae:[],mt=[];for(let et=0;et<ce;et++){const Ue=be[et];if(Ue===""||Ue==null){mt.push("");continue}const It=typeof Ue=="number"?Ue:Number(Ue);mt.push(Number.isFinite(It)?It:"")}return mt},ve=Ae=>{const ce=Ae.filter(be=>typeof be=="number"&&Number.isFinite(be));return ce.length?ce.reduce((be,mt)=>be+mt,0)/ce.length:null};for(const Ae of w){const ce=He[String(Ae.id)]||{},be=lt(ce.marksA,qe).slice(0,ut?qe:0),mt=lt(ce.marksB,Pt).slice(0,Ke?Pt:0),et=ve(be),Ue=ve(mt),It=ce==null?void 0:ce.ciaExam,ht=typeof It=="number"&&Number.isFinite(It)?It:null,Lt=et!=null||Ue!=null||ht!=null,yr=Lt?(et??0)+(ht??0)/2:null,Ar=Lt?(Ue??0)+(ht??0)/2:null;I.set(Ae.id,{ssaCo1:null,ssaCo2:null,ciaCo1:yr==null?null:Uu(yr,0,40),ciaCo2:Ar==null?null:Uu(Ar,0,40),f1Co1:null,f1Co2:null,__labCoMax:40})}return I}const ie=new Map;for(const[je,Fe]of Object.entries(M.ssa||{})){const _e=Number(je);Number.isFinite(_e)&&ie.set(_e,yv(Fe))}const U=M.f1&&typeof M.f1=="object"?M.f1:{},Z=M.cia&&typeof M.cia=="object"?M.cia:null,me=Array.isArray(Z==null?void 0:Z.questions)?Z.questions.map(je=>({key:String((je==null?void 0:je.key)||""),label:String((je==null?void 0:je.label)||(je==null?void 0:je.key)||""),max:Number((je==null?void 0:je.max)||0),co:je==null?void 0:je.co,btl:Math.min(6,Math.max(1,Number((je==null?void 0:je.btl)||1)))})).filter(je=>je.key):C,Pe=Z!=null&&Z.rowsByStudentId&&typeof Z.rowsByStudentId=="object"?Z.rowsByStudentId:{};for(const je of w){const Fe=ie.get(je.id)??null,_e=Ca.reduce((ce,be)=>ce+(q.ssa[Is(be)]||0),0),He=uo(null);for(const ce of Ca){const be=Is(ce),mt=q.ssa[be]||0;if(Fe==null||!_e||!mt){He[be]=null;continue}const et=Fe/_e*mt;He[be]=Uu(et,0,mt)}const qe=U[String(je.id)]||{},Pt=uo(null);for(const ce of Ca){const be=Is(ce),mt=q.f1[be]||0,et=yv(qe==null?void 0:qe[`skill${ce}`]),Ue=yv(qe==null?void 0:qe[`att${ce}`]);mt&&et!=null&&Ue!=null?Pt[be]=Uu(et+Ue,0,mt):Pt[be]=null}const ut=Pe[String(je.id)]||{},Ke=!!(ut!=null&&ut.absent),lt=ut!=null&&ut.q&&typeof ut.q=="object"?ut.q:{},ve=uo(null);if(!Ke){const ce=uo(0);let be=!1;if(me.forEach((mt,et)=>{const Ue=lt==null?void 0:lt[mt.key],It=yv(Ue);if(It==null)return;be=!0;const ht=Uu(It,0,Number(mt.max)||It),Lt=qF(me,et);for(const yr of Ca){const Ar=Is(yr);ce[Ar]+=ht*(Lt[Ar]||0)}}),be)for(const mt of Ca){const et=Is(mt),Ue=q.cia[et]||0;ve[et]=Ue?Uu(ce[et],0,Ue):null}}const Ae={};for(const ce of Ca){const be=Is(ce);Ae[`ssaCo${ce}`]=He[be],Ae[`f1Co${ce}`]=Pt[be],Ae[`ciaCo${ce}`]=ve[be]}I.set(je.id,Ae)}return I},[M,E,w,q,C,c]),F=x.useMemo(()=>{var me;if(c){const Pe=((me=w[0])==null?void 0:me.id)!=null?X.get(w[0].id):null,je=Number(Pe==null?void 0:Pe.__labCoMax),Fe=Number.isFinite(je)&&je>0?je:40,_e=qe=>qe==null||!Fe?null:zF(qe/Fe*3),He=(qe,Pt)=>{if(qe==null||Pt==null||!Fe)return null;const ut=(qe+Pt)/(2*Fe)*100;return Number.isFinite(ut)?Math.round(Uu(ut,0,100)):null};return w.map((qe,Pt)=>{const ut=X.get(qe.id)||{},Ke=uo(null);Ke.co1=typeof ut.ciaCo1=="number"?ut.ciaCo1:null,Ke.co2=typeof ut.ciaCo2=="number"?ut.ciaCo2:null;const lt=uo(null),ve=uo(!1);for(const mt of Ca){const et=Is(mt);lt[et]=_e(Ke[et]),ve[et]=typeof lt[et]=="number"&&lt[et]<yk}const Ae=He(Ke.co1,Ke.co2),ce=Ca.map(mt=>ve[Is(mt)]?`CO${mt}`:null).filter(Boolean).join("+"),be={sno:Pt+1,...qe,total:Ae,cos:ce};for(const mt of Ca){const et=Is(mt);be[`${et}_3pt`]=lt[et],be[`flagCO${mt}`]=ve[et]}return be})}const I=oe.ssa1,ie=oe.cia1,U=oe.formative1,Z=uo(0);for(const Pe of Ca){const je=Is(Pe);Z[je]=(q.ssa[je]||0)+(q.cia[je]||0)+(q.f1[je]||0)}return w.map((Pe,je)=>{const Fe=X.get(Pe.id),_e=uo(null),He=uo(null),qe=uo(!1);for(const lt of Ca){const ve=Is(lt),Ae=eOe({ssaMark:(Fe==null?void 0:Fe[`ssaCo${lt}`])??null,ciaMark:(Fe==null?void 0:Fe[`ciaCo${lt}`])??null,f1Mark:(Fe==null?void 0:Fe[`f1Co${lt}`])??null,ssaMax:q.ssa[ve]||0,ciaMax:q.cia[ve]||0,f1Max:q.f1[ve]||0,ssaW:I,ciaW:ie,f1W:U});_e[ve]=Ae;const ce=Z[ve]||0;He[ve]=Ae==null||!ce?null:zF(Ae/ce*3),qe[ve]=typeof He[ve]=="number"&&He[ve]<yk}const Pt=(()=>{const lt=Ca.map(ve=>_e[Is(ve)]).filter(ve=>typeof ve=="number"&&Number.isFinite(ve));return lt.length?Math.round(lt.reduce((ve,Ae)=>ve+Ae,0)):null})(),ut=Ca.map(lt=>qe[Is(lt)]?`CO${lt}`:null).filter(Boolean).join("+"),Ke={sno:je+1,...Pe,total:Pt,cos:ut};for(const lt of Ca){const ve=Is(lt);Ke[`${ve}_3pt`]=He[ve],Ke[`flagCO${lt}`]=qe[ve]}return Ke})},[w,X,q,oe,c]),Q=x.useMemo(()=>{const I=D.trim().toLowerCase();return I?F.filter(ie=>{const U=String(ie.reg_no||"").toLowerCase(),Z=String(ie.name||"").toLowerCase(),me=String(ie.section||"").toLowerCase();return U.includes(I)||Z.includes(I)||me.includes(I)}):F},[F,D]),K=x.useMemo(()=>{const I=Z=>i.some(me=>!!(Z!=null&&Z[`flagCO${me}`])),ie=F.filter(Z=>I(Z)).length,U={strength:F.length,flagged:ie};for(const Z of Ca)U[`co${Z}`]=F.filter(me=>!!me[`flagCO${Z}`]).length;return U},[F,i]),ne={position:"sticky",top:0,zIndex:2,textAlign:"left",padding:"10px 12px",fontSize:12,letterSpacing:.2,textTransform:"uppercase",color:"#0f172a",background:"linear-gradient(180deg,#eaf6ff,#ffffff)",borderBottom:"1px solid rgba(148, 163, 184, 0.5)",whiteSpace:"nowrap"},re={padding:"10px 12px",borderBottom:"1px solid rgba(226, 232, 240, 0.9)",fontSize:13,color:"#0f172a",verticalAlign:"middle",whiteSpace:"nowrap"},T=(I,ie)=>{const U=ie==="danger"?{background:"rgba(239, 68, 68, 0.12)",border:"1px solid rgba(239, 68, 68, 0.35)",color:"#991b1b"}:{background:"rgba(2, 132, 199, 0.08)",border:"1px solid rgba(2, 132, 199, 0.25)",color:"#0b4a6f"};return a.jsx("span",{style:{display:"inline-flex",alignItems:"center",height:24,padding:"0 10px",borderRadius:999,fontSize:12,fontWeight:800,...U},children:I})};return a.jsxs("div",{style:{display:"grid",gap:14},children:[a.jsxs("div",{style:{padding:16,borderRadius:14,background:"linear-gradient(135deg,#ffffff,#f0f9ff)",border:"1px solid rgba(226, 232, 240, 0.9)",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"flex-end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:18,fontWeight:950,color:"#0b4a6f"},children:"C1-CQI"}),a.jsxs("div",{style:{marginTop:6,fontSize:13,color:"#334155"},children:["Flags CO1CO5 when 3pt attainment is below ",a.jsx("b",{children:yk}),"."]})]}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Teaching Assignment / Section"}),a.jsxs("select",{value:h??"",onChange:I=>m(I.target.value?Number(I.target.value):null),style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",minWidth:320,background:"#fff"},children:[a.jsx("option",{value:"",children:"Select"}),u.map(I=>{const ie=I.department,U=(ie==null?void 0:ie.short_name)||(ie==null?void 0:ie.code)||(ie==null?void 0:ie.name)||I.department_name||"",Z=I.semester;return a.jsxs("option",{value:I.id,children:[I.section_name," ",Z?` Sem ${Z}`:""," ",I.academic_year?` ${I.academic_year}`:""," ",U?` ${U}`:""]},I.id)})]})]}),a.jsxs("div",{style:{minWidth:320},children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Show CO columns"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",background:"#fff"},children:[Ca.map(I=>{const ie=i.includes(I);return a.jsxs("label",{style:{display:"inline-flex",gap:8,alignItems:"center",cursor:"pointer",userSelect:"none"},children:[a.jsx("input",{type:"checkbox",checked:ie,onChange:U=>{const Z=U.target.checked?Array.from(new Set([...i,I])):i.filter(me=>me!==I);s(Z)}}),a.jsx("span",{style:{fontSize:12,fontWeight:800,color:"#0f172a"},children:`CO${I}`})]},I)}),a.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[a.jsx("button",{type:"button",onClick:()=>s([...Ca]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#f8fafc",fontSize:12,fontWeight:800,color:"#0f172a"},children:"All"}),a.jsx("button",{type:"button",onClick:()=>s([]),style:{padding:"6px 10px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",fontSize:12,fontWeight:800,color:"#0f172a"},children:"None"})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#64748b",marginBottom:6,fontWeight:700},children:"Search"}),a.jsx("input",{value:D,onChange:I=>G(I.target.value),placeholder:"Reg no / name / section",style:{padding:"10px 12px",borderRadius:12,border:"1px solid #e2e8f0",width:260}})]})]})]}),(j||A||g||b||f)&&a.jsxs("div",{style:{marginTop:12,display:"grid",gap:8},children:[(j||A)&&a.jsx("div",{style:{fontSize:12,color:A?"#b91c1c":"#64748b"},children:j?"Loading published marks":A}),(g||b)&&a.jsx("div",{style:{fontSize:12,color:b?"#b91c1c":"#64748b"},children:g?"Loading roster":b}),f&&a.jsx("div",{style:{marginTop:4,background:"#fef2f2",border:"1px solid rgba(239, 68, 68, 0.25)",color:"#991b1b",padding:10,borderRadius:12},children:f})]}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:12,flexWrap:"wrap"},children:[T(`Strength: ${K.strength}`,"neutral"),T(`Flagged: ${K.flagged}`,K.flagged?"danger":"neutral"),i.map(I=>a.jsx(Jr.Fragment,{children:T(`CO${I} below: ${K[`co${I}`]??0}`,K[`co${I}`]?"danger":"neutral")},I))]})]}),a.jsx("div",{style:{borderRadius:14,border:"1px solid rgba(226, 232, 240, 0.9)",overflow:"hidden",background:"#fff",boxShadow:"0 10px 28px rgba(2, 6, 23, 0.06)"},children:a.jsx("div",{style:{maxHeight:"70vh",overflow:"auto"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{...ne,width:70},children:"slno"}),a.jsx("th",{style:{...ne,width:70},children:"SEC"}),a.jsx("th",{style:{...ne,width:160},children:"Reg number"}),a.jsx("th",{style:{...ne,minWidth:260},children:"NAME"}),a.jsx("th",{style:{...ne,width:140},children:"CO's"}),a.jsx("th",{style:{...ne,width:90,textAlign:"center"},children:"100"}),i.map(I=>a.jsx("th",{style:{...ne,width:90,textAlign:"center"},children:`CO${I} (3pt)`},I))]})}),a.jsxs("tbody",{children:[Q.map((I,ie)=>{const U=i.some(Fe=>!!I[`flagCO${Fe}`]),Z=ie%2===0,me=U?"rgba(239, 68, 68, 0.10)":Z?"#ffffff":"#f8fafc",Pe=Fe=>({...re,textAlign:"center",fontWeight:900,color:Fe?"#991b1b":"#065f46",background:Fe?"rgba(239, 68, 68, 0.10)":"rgba(34, 197, 94, 0.10)",borderBottom:"1px solid rgba(226, 232, 240, 0.9)"}),je=I.total!=null&&I.total<=58;return a.jsxs("tr",{style:{background:me},children:[a.jsx("td",{style:{...re,width:70,borderLeft:U?"4px solid rgba(239, 68, 68, 0.55)":"4px solid transparent"},children:I.sno}),a.jsx("td",{style:{...re,width:70},children:I.section??""}),a.jsx("td",{style:{...re,width:160,fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'},children:I.reg_no}),a.jsx("td",{style:{...re,minWidth:260,fontWeight:800},children:I.name}),a.jsx("td",{style:{...re,width:140},children:i.some(Fe=>!!I[`flagCO${Fe}`])?a.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:i.filter(Fe=>!!I[`flagCO${Fe}`]).map(Fe=>a.jsx(Jr.Fragment,{children:T(`CO${Fe}`,"danger")},Fe))}):""}),a.jsx("td",{style:{...re,width:90,textAlign:"center",fontWeight:900,color:je?"#991b1b":"#0f172a",background:je?"rgba(239, 68, 68, 0.12)":"transparent"},children:I.total==null?"":Number.isFinite(Number(I.total))?String(Math.round(Number(I.total))):I.total}),i.map(Fe=>a.jsx("td",{style:Pe(!!I[`flagCO${Fe}`]),children:I[`co${Fe}_3pt`]==null?"":I[`co${Fe}_3pt`]},Fe))]},I.id)}),!Q.length&&a.jsx("tr",{children:a.jsx("td",{colSpan:6+i.length,style:{padding:18,textAlign:"center",color:"#64748b"},children:"No rows."})})]})]})})})]})}function MK({courseId:e}){return a.jsx(tOe,{courseId:e})}function Bh(e){return String(e||"").trim()}function rOe(){var j,k;const{courseCode:e,taId:t}=U0(),r=bo(),n=hl(),i=x.useMemo(()=>decodeURIComponent(String(e||"")).trim(),[e]),s=x.useMemo(()=>t?Number(t):NaN,[t]),[o,l]=x.useState("marks"),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(null),[m,g]=x.useState(null);x.useEffect(()=>{if(!(n!=null&&n.pathname))return;const A=n.pathname.toLowerCase();A.includes("/lca/instructions")||A.includes("/lca_instructions")||A.includes("/lca")||A.includes("/cdap")||A.includes("/articulation")?l("lca_instructions"):A.includes("/marks")?l("marks"):A.includes("/co_attainment")?l("co_attainment"):A.includes("/cqi")?l("cqi"):l("marks")},[n]);const y=x.useMemo(()=>{const A=String((n==null?void 0:n.pathname)||"").toLowerCase();return A.includes("/cdap")?"cdap":A.includes("/articulation")?"articulation":A.includes("/lca")&&!(A.includes("/lca/instructions")||A.includes("/lca_instructions"))?"lca":"instructions"},[n==null?void 0:n.pathname]);x.useEffect(()=>{let A=!0;return(async()=>{if(i)try{const R=await P2(i);if(!A)return;const M=(R||[]).find(B=>Number(B.teaching_assignment_id)===Number(s))||null;u(M)}catch{if(!A)return;u(null)}})(),()=>{A=!1}},[i,s]),x.useEffect(()=>{let A=!0;return(async()=>{if(i)try{const[R,M]=await Promise.all([Sl(),Yd()]);if(!A)return;const B=i.toUpperCase(),E=(R||[]).filter(H=>Bh(H==null?void 0:H.course_code).toUpperCase()===B),P=H=>Bh(H).toUpperCase(),D=E.find(H=>{const oe=P(H==null?void 0:H.question_paper_type);return oe&&oe!=="QP1"})||E.find(H=>P(H==null?void 0:H.question_paper_type))||E.find(H=>Bh(H==null?void 0:H.class_type))||E[0];if(D){if(f(D!=null&&D.class_type?Bh(D.class_type):null),h(D!=null&&D.question_paper_type?Bh(D.question_paper_type):null),ti(D==null?void 0:D.class_type)==="SPECIAL"){g([]);try{const H=await yS(i);g(Array.isArray(H)?H:[])}catch{const H=D==null?void 0:D.enabled_assessments;g(Array.isArray(H)?H.map(oe=>String(oe).trim().toLowerCase()).filter(Boolean):[])}}else g(null);return}const G=(M||[]).find(H=>Bh(H==null?void 0:H.course_code).toUpperCase()===B);f(G!=null&&G.class_type?Bh(G.class_type):null),h(null),g(null)}catch{}})(),()=>{A=!1}},[i]);const b=x.useMemo(()=>Number.isFinite(s)?[{id:s,subject_id:0,subject_code:i,subject_name:(c==null?void 0:c.course_name)||i,section_id:(c==null?void 0:c.section_id)||0,section_name:(c==null?void 0:c.section_name)||"Section",academic_year:(c==null?void 0:c.academic_year)||""}]:[],[s,i,c]);if(!i||!Number.isFinite(s))return a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsx("div",{style:{color:"#b91c1c"},children:"Invalid teaching assignment."}),a.jsx("div",{style:{marginTop:10},children:a.jsx(es,{className:"obe-btn obe-btn-secondary",to:"/iqac/academic-controller?tab=courses",children:"Back"})})]});const v=(c==null?void 0:c.course_name)||i,w=[c==null?void 0:c.section_name,c==null?void 0:c.academic_year].filter(Boolean).join("  "),S=((j=c==null?void 0:c.staff)==null?void 0:j.name)||((k=c==null?void 0:c.staff)==null?void 0:k.username)||"";return a.jsx("main",{className:"obe-course-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:a.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsx("div",{style:{marginBottom:12,padding:18},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsxs("h2",{style:{margin:0},children:["OBE Viewer - ",i]}),a.jsx("div",{style:{color:"#666",marginTop:6},children:"View-only (IQAC)"}),a.jsx("div",{style:{color:"#222",marginTop:6,fontWeight:800},children:v}),a.jsxs("div",{style:{color:"#374151",marginTop:4},children:[w||"",S?`    ${S}`:"",d?`    ${String(d).toUpperCase()}`:""]}),p?a.jsxs("div",{style:{color:"#374151",marginTop:2},children:["QP Type: ",a.jsx("strong",{style:{color:"#111827"},children:String(p)})]}):null]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:[a.jsx(es,{className:"obe-btn obe-btn-secondary",to:`/iqac/academic-controller/course/${encodeURIComponent(i)}`,children:"Back"}),a.jsx("button",{onClick:()=>r(`/iqac/academic-controller/course/${encodeURIComponent(i)}/marks/${encodeURIComponent(String(s))}`),className:"obe-btn",children:"Mark Entry Only"})]})]})}),a.jsx("div",{className:"obe-tab-nav","aria-label":"OBE Tabs",style:{padding:"0 18px"},children:[{key:"lca_instructions",label:"LCA Instructions"},{key:"marks",label:"Mark Entry"},{key:"co_attainment",label:"CO ATTAINMENT"},{key:"cqi",label:"CQI"}].map(A=>{const R=o===A.key;return a.jsx("button",{onClick:()=>{l(A.key);const M=encodeURIComponent(i),B=encodeURIComponent(String(s)),E=A.key==="lca_instructions"?"lca/instructions":String(A.key);r(`/iqac/academic-controller/course/${M}/obe/${B}/${E}`)},className:`obe-tab-btn ${R?"active":""}`,children:A.label},A.key)})}),a.jsxs("div",{style:{border:"1px solid #eee",borderRadius:10,padding:12,margin:18},children:[o==="lca_instructions"&&a.jsx(TK,{courseCode:i,courseName:(c==null?void 0:c.course_name)||null,initialTab:y,viewerMode:!0}),o!=="lca_instructions"?a.jsxs("fieldset",{disabled:!0,style:{border:0,padding:0,margin:0},children:[o==="co_attainment"&&a.jsx(OK,{courseId:i,enabledAssessments:m}),o==="cqi"&&a.jsx(MK,{courseId:i})]}):null,o==="marks"?a.jsx("div",{children:a.jsx(N6,{subjectId:i,classType:d,questionPaperType:p,enabledAssessments:m,teachingAssignmentsOverride:b,fixedTeachingAssignmentId:s,iqacResetEnabled:!0,viewerMode:!1})}):null]})]})})}function nOe(){const{courseCode:e,taId:t}=U0(),r=String(e||""),n=bo(),[i,s]=x.useState(!0),[o,l]=x.useState(!1),[c,u]=x.useState(null),[d,f]=x.useState(null),p={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},h=k=>{const A=Number(k);if(!Number.isFinite(A)||A<=0)return[0,0,0];const R=1.5,M=3,B=2.5,E=R+M+B,P=Math.round(A*R/E*100)/100,D=Math.round(A*M/E*100)/100,G=Math.round(A*B/E*100)/100;return[P,D,G]},m=k=>{const A=k&&typeof k=="object"?k:{};let R=Array.isArray(A.weights)?[...A.weights]:[];if(R=R.map(M=>{const B=Number(M);return Number.isFinite(B)?B:0}),R.length===13){const[M,B,E]=h(R[0]??0),[P,D,G]=h(R[1]??0);R=[M,B,E,P,D,G,...R.slice(2)]}for(;R.length<p.weights.length;)R.push(p.weights[R.length]??0);return R=R.slice(0,p.weights.length),{...A,header:p.header,cycles:p.cycles,weights:R}};x.useEffect(()=>{let k=!0;return(async()=>{s(!0);try{const A=await _9(r);if(!k)return;f(A!=null&&A.mapping?m(A.mapping):null)}catch(A){if(!k)return;u((A==null?void 0:A.message)||String(A))}finally{k&&s(!1)}})(),()=>{k=!1}},[r]);const g=()=>d?m(d):(f(p),p),y=(k,A)=>{const R=A===""?"":Number(A);f(M=>{const B={...M||g()},E=Array.isArray(B.weights)?[...B.weights]:[];return E[k]=R,B.weights=E,B})},b=async()=>{l(!0),u(null);try{const k=m(d??g());await j9(r,k);try{window.dispatchEvent(new CustomEvent("internal-mark:updated",{detail:{subjectId:r}}))}catch{}n(-1)}catch(k){u((k==null?void 0:k.message)||String(k))}finally{l(!1)}};if(i)return a.jsx("div",{style:{padding:18},children:"Loading"});const v=m(d??g()),w=v.header,S=v.weights,j=v.cycles;return a.jsxs("main",{style:{padding:18},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[a.jsxs("h2",{style:{margin:0},children:["Internal Mark Mapping - ",r]}),a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx("button",{className:"obe-btn",onClick:()=>n(-1),children:"Back"}),a.jsx("button",{className:"obe-btn obe-btn-primary",onClick:b,disabled:o,children:o?"Saving...":"Save"})]})]}),a.jsx("div",{style:{overflowX:"auto"},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%"},children:[a.jsxs("thead",{children:[a.jsx("tr",{children:w.map((k,A)=>a.jsx("th",{style:{border:"1px solid #d1d5db",padding:8,background:"#f3f4f6"},children:k},A))}),a.jsx("tr",{children:j.map((k,A)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb",fontWeight:600},children:k},`cy-${A}`))})]}),a.jsx("tbody",{children:a.jsx("tr",{children:S.map((k,A)=>a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,background:"#f3f4f6"},children:a.jsx("input",{type:"number",step:"0.1",value:k===""?"":String(k),onChange:R=>y(A,R.target.value),style:{width:70,padding:6}})},A))})})]})}),c?a.jsx("div",{style:{color:"red",marginTop:12},children:c}):null]})}function iOe(){return a.jsx(B9,{})}function da({user:e,element:t,requiredRoles:r,requiredPermissions:n,requiredProfile:i}){if(!e)return a.jsx(Qp,{to:"/login",replace:!0});const s=(e.roles||[]).map(u=>(u||"").toString().toUpperCase()),o=(e.permissions||[]).map(u=>(u||"").toString().toLowerCase()),l=(e.profile_type||"").toString().toUpperCase();let c=!1;return i&&(i==="STUDENT"&&l==="STUDENT"&&(c=!0),i==="STAFF"&&l==="STAFF"&&(c=!0)),!c&&r&&r.length&&r.map(d=>d.toString().toUpperCase()).some(d=>s.includes(d))&&(c=!0),!c&&n&&n.length&&n.map(d=>d.toString().toLowerCase()).some(d=>o.includes(d))&&(c=!0),!i&&(!r||r.length===0)&&(!n||n.length===0)&&(c=!0),c?t:a.jsx(Qp,{to:"/dashboard",replace:!0})}function bk({user:e}){return a.jsx("div",{className:"fixed inset-0 overflow-hidden bg-gradient-to-br from-blue-50 to-slate-100",children:a.jsx("section",{className:"relative h-full flex items-center justify-center bg-gradient-to-b from-indigo-50 to-white py-0 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[a.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-gray-900 mb-6",children:"Welcome to IDCS"}),a.jsx("p",{className:"text-lg sm:text-xl text-gray-600 mb-8 max-w-2xl mx-auto",children:"Streamline your academic management with our comprehensive Education Resource Planning system"}),e?a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 max-w-md mx-auto",children:[a.jsxs("p",{className:"text-lg text-gray-700 mb-2",children:["Hello, ",a.jsx("strong",{className:"text-blue-600",children:e.username}),"!"]}),e.roles&&e.roles.length>0&&a.jsxs("p",{className:"text-sm text-gray-500",children:["Role: ",a.jsx("span",{className:"font-semibold text-indigo-600",children:e.roles.join(", ")})]})]}):a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[a.jsx("a",{href:"/login",className:"px-8 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-all duration-200 shadow-md hover:shadow-lg transform hover:scale-105",children:"Get Started"}),a.jsx("a",{href:"#features",className:"px-8 py-3 bg-white text-blue-600 border-2 border-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition-all duration-200",children:"Learn More"})]})]})})})}function aOe(){return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-14 h-14 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx(z0,{className:"w-7 h-7 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Welcome back"}),a.jsx("p",{className:"text-gray-600 mt-1",children:"Welcome to the dashboard."})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center",children:a.jsx(gs,{className:"w-5 h-5 text-emerald-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Courses"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"View your enrolled courses"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:a.jsx(Om,{className:"w-5 h-5 text-purple-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Academics"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Access academic resources"})]}),a.jsxs("div",{className:"bg-white rounded-lg p-6 shadow-md hover:shadow-lg transition-shadow sm:col-span-2 lg:col-span-1",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:a.jsx(xs,{className:"w-5 h-5 text-blue-600"})}),a.jsx("h3",{className:"font-semibold text-gray-900",children:"Schedule"})]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Check your timetable"})]})]})]})}function t0({children:e}){return a.jsx(a.Fragment,{children:e})}function sOe(){return a.jsx(t0,{children:a.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:[a.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6",children:"Dashboard"}),a.jsx(aOe,{})]})})}function oOe(e){return String(e??"").trim()}function lOe({user:e}){const[t,r]=x.useState(e===void 0?null:e),[n,i]=x.useState(!e),[s,o]=x.useState(null),l=x.useMemo(()=>{var F;return oOe((F=t==null?void 0:t.profile)==null?void 0:F.mobile_number)},[t]),c=x.useMemo(()=>{var F;return!!((F=t==null?void 0:t.profile)!=null&&F.mobile_verified)},[t]),[u,d]=x.useState(""),[f,p]=x.useState(!1),[h,m]=x.useState(!1),[g,y]=x.useState(""),[b,v]=x.useState(!1),[w,S]=x.useState(null),[j,k]=x.useState(null),[A,R]=x.useState(null),[M,B]=x.useState(0),[E,P]=x.useState(!1),[D,G]=x.useState(!1),[H,oe]=x.useState(null),[de,W]=x.useState(""),[V,ae]=x.useState(!1);if(x.useEffect(()=>{const F=l||"",Q=F.trim()?F.startsWith("+91")?F:`+91${F.replace(/^\+91\s*/,"")}`:"";d(Q),p(!c||!F),m(!1),y(""),S(null),k(null),R(null),B(0),ae(!1)},[l,c]),x.useEffect(()=>{if(!h||!A)return;const F=()=>{const K=Math.max(0,Math.ceil((A-Date.now())/1e3));B(K)};F();const Q=window.setInterval(F,1e3);return()=>window.clearInterval(Q)},[h,A]),x.useEffect(()=>{if(e)return;let F=!0;return i(!0),Dd().then(Q=>{if(!F)return;const K={...Q,roles:Array.isArray(Q.roles)?Q.roles.map(ne=>typeof ne=="string"?ne:ne.name):[]};r(K)}).catch(Q=>o(String(Q))).finally(()=>i(!1)),()=>{F=!1}},[e]),n)return a.jsx(t0,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading profile"})]})})});if(s)return a.jsx(t0,{children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-800",children:["Error loading profile: ",s]})})});if(!t)return a.jsx(t0,{children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8 pb-6",children:a.jsx("div",{className:"text-center text-gray-500",children:"No profile available"})})});const ee=(t.username||"U").slice(0,2).toUpperCase(),C=!!(c&&!f&&l);async function Y(){var Q,K,ne;S(null),k(null);let F=String(u||"").trim();if(F&&!F.startsWith("+91")&&(F=`+91${F}`),!F||F==="+91"){S("Enter mobile number.");return}try{v(!0);const re=await ZD(F);m(!0);const T=Number((re==null?void 0:re.expires_in_seconds)??0);if(Number.isFinite(T)&&T>0){R(Date.now()+T*1e3),B(Math.ceil(T));const I=Math.ceil(T/60);k(`OTP sent. Valid for ${I} minute${I===1?"":"s"}.`)}else R(null),B(0),k("OTP sent.")}catch(re){const I=Number(((Q=re==null?void 0:re.response)==null?void 0:Q.status)||0)===401?"Session expired. Please login again and retry OTP request.":String(((ne=(K=re==null?void 0:re.response)==null?void 0:K.data)==null?void 0:ne.detail)||(re==null?void 0:re.message)||re||"Failed to send OTP");S(I)}finally{v(!1)}}async function q(){var K,ne,re;S(null),k(null);let F=String(u||"").trim();F&&!F.startsWith("+91")&&(F=`+91${F}`);const Q=String(g||"").trim();if(!F||F==="+91"){S("Enter mobile number.");return}if(!Q){S("Enter OTP.");return}try{v(!0);const T=await e9(F,Q),I=T&&T.me||null;if(I){const ie={...I,roles:Array.isArray(I.roles)?I.roles.map(U=>typeof U=="string"?U:U.name):[]};r(ie)}else{const ie=await Dd(),U={...ie,roles:Array.isArray(ie.roles)?ie.roles.map(Z=>typeof Z=="string"?Z:Z.name):[]};r(U)}m(!1),y(""),k(null),S(null),p(!1),R(null),B(0),ae(!0),setTimeout(()=>ae(!1),8e3)}catch(T){const ie=Number(((K=T==null?void 0:T.response)==null?void 0:K.status)||0)===401?"Session expired. Please login again and retry OTP verification.":String(((re=(ne=T==null?void 0:T.response)==null?void 0:ne.data)==null?void 0:re.detail)||(T==null?void 0:T.message)||T||"OTP verification failed");S(ie)}finally{v(!1)}}const O=h&&A!=null&&M<=0;async function X(){var Q,K,ne;oe(null);const F=String(de||"").trim();if(!F){oe("Password is required.");return}try{G(!0);const re=await t9(F),T=re&&re.me||null;if(T){const I={...T,roles:Array.isArray(T.roles)?T.roles.map(ie=>typeof ie=="string"?ie:ie.name):[]};r(I)}else{const I=await Dd(),ie={...I,roles:Array.isArray(I.roles)?I.roles.map(U=>typeof U=="string"?U:U.name):[]};r(ie)}P(!1),W(""),oe(null)}catch(re){const I=Number(((Q=re==null?void 0:re.response)==null?void 0:Q.status)||0)===401?"Session expired or incorrect password.":String(((ne=(K=re==null?void 0:re.response)==null?void 0:K.data)==null?void 0:ne.detail)||(re==null?void 0:re.message)||re||"Failed to remove mobile number");oe(I)}finally{G(!1)}}return a.jsxs(t0,{children:[a.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 pb-6 space-y-6",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-xl p-6 sm:p-8 shadow-md",children:a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-16 h-16 sm:w-20 sm:h-20 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:a.jsx("span",{className:"text-2xl sm:text-3xl font-bold text-white",children:ee})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:t.username}),a.jsx("p",{className:"text-gray-600 mt-1",children:t.email||"No email provided"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg px-4 py-2 shadow-sm",children:[a.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Profile Type"}),a.jsx("div",{className:"font-bold text-gray-900",children:t.profile_type||""})]})]})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Details"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(z0,{className:"w-5 h-5 text-blue-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Account"}),a.jsxs("div",{className:"text-gray-900 font-medium truncate",children:["ID: ",t.id]})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(bN,{className:"w-5 h-5 text-emerald-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Email"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.email||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Rte,{className:"w-5 h-5 text-purple-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Roles"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:(t.roles||[]).join(", ")||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Dee,{className:"w-5 h-5 text-orange-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Department"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.department&&(t.profile.department.short_name||t.profile.department.code)||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Bee,{className:"w-5 h-5 text-indigo-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"Designation"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.profile&&t.profile.designation||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Pte,{className:"w-5 h-5 text-pink-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-1",children:"College"}),a.jsx("div",{className:"text-gray-900 font-medium truncate",children:t.college&&(t.college.short_name||t.college.name)||""})]})]})}),a.jsx("div",{className:"bg-white rounded-lg p-5 shadow-md hover:shadow-lg transition-shadow",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center flex-shrink-0",children:a.jsx(Ate,{className:"w-5 h-5 text-teal-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("div",{className:"text-sm font-semibold text-gray-500 mb-2",children:"Mobile Number"}),V&&a.jsxs("div",{className:"mb-3 bg-emerald-50 border border-emerald-200 rounded-lg p-3 flex items-start gap-2",children:[a.jsx(Md,{className:"w-5 h-5 text-emerald-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"text-sm text-emerald-800 leading-relaxed",children:[a.jsx("strong",{children:"Mobile number verified successfully!"})," You can now access your Academic panel and submit requests through IDCS."]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative flex-1 flex",children:[a.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-2 bg-gray-100 border border-gray-200 rounded-l-md border-r-0",children:[a.jsx("span",{className:"text-base leading-none",children:""}),a.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"+91"})]}),a.jsx("input",{className:"flex-1 rounded-r-md rounded-l-none border border-gray-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-200",value:u.replace(/^\+91\s*/,""),onChange:F=>{const Q=F.target.value.replace(/^\+91\s*/,"").replace(/[^\d]/g,"");d(Q?`+91${Q}`:""),m(!1),y(""),S(null),k(null),R(null),B(0)},readOnly:C,placeholder:"Enter 10-digit mobile number",maxLength:10}),C&&a.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:a.jsx(Md,{className:"w-5 h-5 text-emerald-600"})})]}),!C&&a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md bg-teal-600 text-white text-sm font-semibold disabled:opacity-60",onClick:Y,disabled:b||h&&A!=null&&!O,children:h?O?"Resend OTP":"OTP Sent":"Verify"})]}),j&&a.jsx("div",{className:"mt-2 text-xs text-gray-500",children:j}),w&&a.jsx("div",{className:"mt-2 text-xs text-red-600 font-semibold",children:w}),h&&A!=null&&!C&&a.jsx("div",{className:"mt-2 text-xs text-gray-600",children:M>0?a.jsxs("span",{children:["OTP expires in"," ",String(Math.floor(M/60)).padStart(2,"0"),":",String(M%60).padStart(2,"0")]}):a.jsx("span",{className:"text-amber-700 font-semibold",children:"OTP expired. You can resend now."})}),h&&!C&&a.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[a.jsx("input",{className:"flex-1 rounded-md border border-gray-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-teal-200",value:g,onChange:F=>y(F.target.value),placeholder:"Enter OTP"}),a.jsx("button",{type:"button",className:"px-3 py-2 rounded-md bg-emerald-600 text-white text-sm font-semibold disabled:opacity-60",onClick:q,disabled:b,children:"Submit"})]}),C&&a.jsxs("div",{className:"mt-2 flex items-center gap-3",children:[a.jsx("button",{type:"button",className:"text-xs text-blue-700 underline font-semibold",onClick:()=>{p(!0),m(!1),y(""),S(null),k(null)},children:"Change number"}),a.jsxs("button",{type:"button",className:"text-xs text-red-700 underline font-semibold flex items-center gap-1",onClick:()=>{W(""),oe(null),P(!0)},children:[a.jsx(Lm,{className:"w-3 h-3"}),"Remove"]})]})]})]})})]})]})]}),E?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",overflowY:"auto",padding:16,zIndex:80},onClick:()=>{D||(P(!1),W(""),oe(null))},children:a.jsxs("div",{style:{width:"min(420px, 96vw)",background:"#fff",borderRadius:16,border:"2px solid #fca5a5",boxShadow:"0 8px 32px rgba(220,38,38,0.12), 0 2px 8px rgba(0,0,0,0.10)",overflow:"hidden"},onClick:F=>F.stopPropagation(),children:[a.jsxs("div",{style:{background:"linear-gradient(135deg, #fff1f2 0%, #ffe4e6 100%)",borderBottom:"1px solid #fecaca",padding:"16px 20px",display:"flex",alignItems:"center",gap:12},children:[a.jsx("img",{src:r9,alt:"IDCS Logo",style:{width:36,height:36,objectFit:"contain",flexShrink:0}}),a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:15,color:"#991b1b",lineHeight:1.2},children:"Remove Mobile Number"}),a.jsx("div",{style:{fontSize:11,color:"#b91c1c",marginTop:2},children:"This action cannot be undone"})]})]}),a.jsxs("div",{style:{padding:"20px 20px 16px"},children:[a.jsx("div",{style:{fontSize:13,color:"#374151",marginBottom:18,lineHeight:1.55,background:"#fef9c3",border:"1px solid #fde68a",borderRadius:8,padding:"10px 12px"},children:"Your verified mobile number will be removed. You will need to re-verify to access features that require it."}),a.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:"#374151",marginBottom:6,letterSpacing:"0.03em"},children:"IDCS PASSWORD"}),a.jsx("input",{autoFocus:!0,type:"password",className:"obe-input",style:{borderColor:de.trim()?"#dc2626":"#fca5a5",outline:"none",boxShadow:de.trim()?"0 0 0 3px rgba(220,38,38,0.15)":"0 0 0 3px rgba(252,165,165,0.25)",borderWidth:2,fontSize:14,padding:"10px 12px",transition:"box-shadow 0.15s, border-color 0.15s"},value:de,onChange:F=>W(F.target.value),onKeyDown:F=>{F.key==="Enter"&&de.trim()&&!D&&X()},placeholder:"Enter your IDCS password"}),H?a.jsx("div",{className:"obe-danger-pill",style:{marginTop:10,fontSize:13},children:H}):null]}),a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end",padding:"12px 20px 16px",borderTop:"1px solid #fee2e2",background:"#fff7f7"},children:[a.jsx("button",{type:"button",className:"obe-btn",disabled:D,style:{minWidth:80},onClick:()=>{P(!1),W(""),oe(null)},children:"Cancel"}),a.jsx("button",{type:"button",className:"obe-btn obe-btn-danger",disabled:D||!de.trim(),style:{minWidth:100},onClick:X,children:D?"Removing":" Remove"})]})]})})}):null]})}function z1({children:e}){return a.jsx(t0,{children:a.jsx("div",{className:"flex flex-col w-full max-w-full overflow-x-hidden",children:e})})}function cOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),[i,s]=x.useState(null),o=hl(),l=bo(),c=e&&e.length?Array.from(new Set(e.map(b=>b.regulation))):[],u=e&&e.length?Array.from(new Set(e.map(b=>b.semester))).sort((b,v)=>b-v):[],[d,f]=x.useState(c.length===1?c[0]:c[0]??null),[p,h]=x.useState(u.length===1?u[0]:u[0]??null);x.useEffect(()=>{const b=e&&e.length?Array.from(new Set(e.map(w=>w.regulation))):[];b.length===1?f(b[0]):b.includes(d||"")||f(b[0]??null);const v=e&&e.length?Array.from(new Set(e.map(w=>w.semester))).sort((w,S)=>w-S):[];v.length===1?h(v[0]):v.includes(p||-1)||h(v[0]??null)},[e]),x.useEffect(()=>{Yd().then(b=>t(b)).catch(b=>console.error(b)).finally(()=>n(!1))},[]);function m(b){if(b==null)return"";const v=String(b);return v.includes(",")||v.includes('"')||v.includes(`
`)?'"'+v.replace(/"/g,'""')+'"':v}function g(){const b=e.filter(A=>(!d||A.regulation===d)&&(!p||A.semester===p)&&A.editable===!0);if(!b.length){alert("No editable subjects in current view");return}const w=[["regulation","semester","course_code","course_name","category","class_type","l","t","p","s","c","internal_mark","external_mark","for_all_departments","editable","departments"].join(",")];for(const A of b){const R=A.for_all_departments?"":(A.departments_display||[]).map(B=>B.short_name||B.shortname||B.code||B.name).join(","),M=[A.regulation,A.semester,A.course_code||"",A.course_name||"",A.category||"",A.class_type||"",A.l??0,A.t??0,A.p??0,A.s??0,A.c??0,A.internal_mark??"",A.external_mark??"",A.for_all_departments?"True":"False",A.editable?"True":"False",R];w.push(M.map(m).join(","))}const S=new Blob([w.join(`
`)],{type:"text/csv"}),j=URL.createObjectURL(S),k=document.createElement("a");k.href=j,k.download=`department_curriculum_editable_${d||"all"}_${p||"all"}.csv`,document.body.appendChild(k),k.click(),k.remove(),URL.revokeObjectURL(j)}async function y(b){const v=b.target.files&&b.target.files[0];if(v){if(!confirm(`Upload ${v.name} to import masters?`)){b.currentTarget.value="";return}try{const w=new FormData;w.append("csv_file",v,v.name);const S=await mr("/api/curriculum/master/import/",{method:"POST",body:w});if(S.status===401){alert("Your session has expired. Please refresh the page and try again.");return}if(S.ok)alert("Import request submitted; refresh to see changes."),n(!0),Yd().then(j=>t(j)).catch(()=>{}).finally(()=>n(!1));else{let j="";try{j=await S.text()}catch{j=S.statusText}alert("Import failed: "+(j||S.statusText))}}catch(w){console.error(w),alert("Import failed: "+(w.message||w))}try{const w=document.getElementById("master-import-file");w&&(w.value="")}catch{}}}return x.useEffect(()=>{const b=o.state;b&&b.savedMessage&&(s(b.savedMessage),l(location.pathname,{replace:!0,state:{}}),setTimeout(()=>s(null),2500))},[o,l]),r?a.jsx(z1,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading masters"})]})})}):a.jsx(z1,{children:a.jsxs("div",{className:"px-4 pb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(gs,{className:"w-6 h-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Master Curriculum"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage all master curriculum entries."})]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[(()=>{try{const b=JSON.parse(localStorage.getItem("roles")||"[]");if(Array.isArray(b)&&b.some(w=>String(w).toLowerCase()==="iqac"))return a.jsx(es,{to:"/curriculum/master/new",className:"px-4 py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md",children:"New Master"})}catch{}return null})(),a.jsxs("button",{onClick:()=>g(),className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-all duration-200 shadow-sm hover:shadow-md",children:[a.jsx(T4,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Download"})]}),a.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg font-medium hover:bg-indigo-700 transition-all duration-200 shadow-sm hover:shadow-md cursor-pointer",children:[a.jsx(E2,{className:"w-4 h-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Import CSV"}),a.jsx("input",{id:"master-import-file",type:"file",accept:".csv",className:"hidden",onChange:b=>y(b)})]})]})]}),c.length>0&&a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),a.jsx("select",{value:d??"",onChange:b=>f(b.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:c.map(b=>a.jsx("option",{value:b,children:b},b))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),a.jsx("select",{value:p??"",onChange:b=>h(b.target.value?Number(b.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:u.map(b=>a.jsx("option",{value:b,children:b},b))})]})]}),i&&a.jsx("div",{className:"mb-4 inline-block bg-green-100 text-green-800 px-4 py-2 rounded-lg font-semibold",children:i}),a.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Course"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Depts"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),a.jsx("th",{className:"px-3 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(b=>(!d||b.regulation===d)&&(!p||b.semester===p)).length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:16,className:"px-4 py-8 text-center text-gray-500",children:"No curriculum entries found for the selected filters."})}):e.filter(b=>(!d||b.regulation===d)&&(!p||b.semester===p)).map(b=>a.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${b.editable?"bg-blue-50/30":""}`,children:[a.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 whitespace-nowrap",children:b.course_code||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-900 font-medium min-w-[200px]",children:b.course_name||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.category||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.class_type||"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:b.is_elective?a.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.l??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.t??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.p??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.s??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.c??0}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 whitespace-nowrap",children:b.external_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center text-gray-900 font-semibold whitespace-nowrap",children:b.total_mark??"-"}),a.jsx("td",{className:"px-3 py-3 text-sm text-gray-700 whitespace-nowrap",children:b.for_all_departments?"ALL":b.departments_display&&b.departments_display.length>0?b.departments_display.map(v=>v.short_name||v.shortname||v.code||v.name).join(", "):"No Depts"}),a.jsx("td",{className:"px-3 py-3 text-sm text-center whitespace-nowrap",children:b.editable?a.jsx("span",{className:"text-green-700 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(es,{to:`/curriculum/master/${b.id}`,className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:a.jsx(dh,{className:"w-4 h-4"})}),b.status==="PENDING"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"px-3 py-1.5 text-green-600 hover:bg-green-50 text-xs font-medium rounded-lg transition-colors",children:"Approve"}),a.jsx("button",{type:"button",className:"px-3 py-1.5 text-red-600 hover:bg-red-50 text-xs font-medium rounded-lg transition-colors",children:"Reject"})]})]})})]},b.id))})]})})]})})}function VF(){const{id:e}=U0(),t=e??(window.location.pathname.endsWith("/new")?"new":void 0),r=bo(),[n,i]=x.useState({regulation:"",semester:1,for_all_departments:!0,editable:!1,is_elective:!1}),[s,o]=x.useState(!1),[l,c]=x.useState([]),[u,d]=x.useState(null);x.useEffect(()=>{t&&t!=="new"&&(o(!0),Yd().then(p=>{const h=p.find(m=>String(m.id)===String(t));h&&i(h)}).finally(()=>o(!1)))},[t]),x.useEffect(()=>{Sl().then(p=>{const h=new Map;p.forEach(m=>h.set(m.department.id,m.department)),c(Array.from(h.values()))}).catch(()=>c([]))},[]);async function f(){o(!0);try{if(!n.regulation)throw new Error("Regulation is required");if(!n.semester||n.semester<=0)throw new Error("Semester must be a positive number");if(!n.course_name)throw new Error("Course Name is required");if(n.internal_mark!==""&&n.internal_mark!=null&&n.internal_mark<0||n.external_mark!==""&&n.external_mark!=null&&n.external_mark<0)throw new Error("Marks cannot be negative");const p={...n};if(n.for_all_departments?p.departments=[]:p.departments=Array.isArray(n.departments)?n.departments:[],p.internal_mark=n.internal_mark===""||n.internal_mark==null?0:Number(n.internal_mark),p.external_mark=n.external_mark===""||n.external_mark==null?0:Number(n.external_mark),p.course_code=n.course_code===""||n.course_code==null?null:n.course_code,t==="new"){const h=await Ire(p);r("/curriculum/master",{state:{savedMessage:"Saved",newId:h.id}})}else{const h=Number(t);if(Number.isNaN(h))throw new Error("Invalid master id");const m=await Dre(h,p);i(m),d("Saved"),setTimeout(()=>d(null),2500)}}catch(p){alert(`Error: ${p.message}`)}finally{o(!1)}}return a.jsxs(z1,{children:[a.jsxs("div",{className:"px-2 sm:px-4 pb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsx(gs,{className:"w-5 h-5 sm:w-6 sm:h-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:e==="new"?"New Master":"Edit Master"}),a.jsx("p",{className:"text-gray-600 text-xs sm:text-sm mt-1",children:e==="new"?"Create a new master curriculum entry.":"Edit the selected master curriculum entry."})]})]}),a.jsxs("form",{onSubmit:p=>{p.preventDefault(),f()},className:"bg-white rounded-lg shadow-md p-3 sm:p-4 lg:p-6 space-y-4",autoComplete:"off",children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Regulation"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.regulation||"",onChange:p=>i({...n,regulation:p.target.value}),required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Semester"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:1,value:n.semester||1,onChange:p=>i({...n,semester:Number(p.target.value)}),required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Code"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_code??"",onChange:p=>i({...n,course_code:p.target.value}),placeholder:"Optional"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Course Name"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.course_name||"",onChange:p=>i({...n,course_name:p.target.value}),required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"CAT"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.category||"",onChange:p=>i({...n,category:p.target.value}),placeholder:"e.g. CORE"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Class"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",value:n.class_type||"",onChange:p=>i({...n,class_type:p.target.value}),placeholder:"e.g. Theory"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"L"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.l||0,onChange:p=>i({...n,l:Number(p.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"T"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.t||0,onChange:p=>i({...n,t:Number(p.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"P"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.p||0,onChange:p=>i({...n,p:Number(p.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"S"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.s||0,onChange:p=>i({...n,s:Number(p.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"C"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-center text-sm",type:"number",min:0,value:n.c||0,onChange:p=>i({...n,c:Number(p.target.value)})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Internal Mark"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.internal_mark??"",onChange:p=>i({...n,internal_mark:p.target.value===""?"":Number(p.target.value)})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"External Mark"}),a.jsx("input",{className:"w-full px-2 py-1.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",type:"number",min:0,value:n.external_mark??"",onChange:p=>i({...n,external_mark:p.target.value===""?"":Number(p.target.value)})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:p=>i({...n,for_all_departments:p.target.checked}),id:"forAllDepts",className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"forAllDepts",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"For All Departments"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-indigo-900 mb-1",children:"Departments"}),n.for_all_departments?a.jsx("div",{className:"text-gray-600 text-xs sm:text-sm p-2 bg-gray-50 rounded-lg",children:"Applies to all departments"}):a.jsxs("div",{className:"max-h-32 overflow-y-auto p-2 border border-gray-300 rounded-lg bg-white",children:[l.length===0&&a.jsx("div",{className:"text-gray-400 text-xs",children:"No departments available"}),l.map(p=>a.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[a.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(p.id):!1,onChange:h=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(h.target.checked)m.includes(p.id)||m.push(p.id);else{const g=m.indexOf(p.id);g>=0&&m.splice(g,1)}i({...n,departments:m})},id:`dept-${p.id}`,className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsxs("label",{htmlFor:`dept-${p.id}`,className:"text-xs sm:text-sm text-gray-700",children:[p.code,"  ",p.name]})]},p.id))]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:p=>i({...n,editable:p.target.checked}),id:"editable",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"editable",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Editable"})]}),a.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[a.jsx("input",{type:"checkbox",checked:!!n.is_elective,onChange:p=>i({...n,is_elective:p.target.checked}),id:"is_elective",className:"w-3.5 h-3.5 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),a.jsx("label",{htmlFor:"is_elective",className:"text-xs sm:text-sm font-semibold text-indigo-900",children:"Is Elective"})]})]}),u&&a.jsx("div",{className:"bg-green-100 text-green-800 px-3 py-1.5 rounded-lg font-semibold text-sm inline-block",children:u}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[a.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-50 disabled:cursor-not-allowed text-sm",disabled:s,children:[a.jsx(rd,{className:"w-4 h-4"}),s?"Saving":"Save"]}),a.jsxs("button",{type:"button",className:"flex items-center justify-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg font-semibold hover:bg-gray-50 transition-colors text-sm",onClick:()=>r("/curriculum/master"),children:[a.jsx(bu,{className:"w-4 h-4"}),"Cancel"]})]})]})]}),a.jsxs("form",{onSubmit:p=>{p.preventDefault(),f()},style:{background:"#fff",borderRadius:10,boxShadow:"0 2px 8px #e5e7eb",padding:32,maxWidth:700,margin:"0 auto",display:"grid",gap:22},autoComplete:"off",children:[a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Regulation"}),a.jsx("input",{className:"input",value:n.regulation||"",onChange:p=>i({...n,regulation:p.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Semester"}),a.jsx("input",{className:"input",type:"number",min:1,value:n.semester||1,onChange:p=>i({...n,semester:Number(p.target.value)}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Code"}),a.jsx("input",{className:"input",value:n.course_code??"",onChange:p=>i({...n,course_code:p.target.value}),placeholder:"Optional",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Course Name"}),a.jsx("input",{className:"input",value:n.course_name||"",onChange:p=>i({...n,course_name:p.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"CAT"}),a.jsx("input",{className:"input",value:n.category||"",onChange:p=>i({...n,category:p.target.value}),placeholder:"e.g. CORE",style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Class"}),a.jsxs("select",{className:"input",value:n.class_type||"",onChange:p=>i({...n,class_type:p.target.value}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4},children:[a.jsx("option",{value:"",children:"Select class type"}),Jp.map(p=>{const h=ti(String(p)),m=String(p).charAt(0).toUpperCase()+String(p).slice(1);return a.jsx("option",{value:h,children:m},h)})]})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"L"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.l||0,onChange:p=>i({...n,l:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"T"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.t||0,onChange:p=>i({...n,t:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"P"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.p||0,onChange:p=>i({...n,p:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"S"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.s||0,onChange:p=>i({...n,s:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"C"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.c||0,onChange:p=>i({...n,c:Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Internal Mark"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.internal_mark??"",onChange:p=>i({...n,internal_mark:p.target.value===""?"":Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"External Mark"}),a.jsx("input",{className:"input",type:"number",min:0,value:n.external_mark??"",onChange:p=>i({...n,external_mark:p.target.value===""?"":Number(p.target.value)}),style:{width:"100%",padding:"8px",borderRadius:6,border:"1px solid #d1d5db",marginTop:4}})]})]}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:18},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!n.for_all_departments,onChange:p=>i({...n,for_all_departments:p.target.checked}),id:"forAllDepts"}),a.jsx("label",{htmlFor:"forAllDepts",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"For All Departments"})]}),a.jsxs("div",{children:[a.jsx("label",{style:{fontWeight:600,color:"#3730a3"},children:"Departments"}),n.for_all_departments?a.jsx("div",{style:{marginTop:6,color:"#6b7280"},children:"Applies to all departments"}):a.jsxs("div",{style:{marginTop:6,maxHeight:220,overflowY:"auto",padding:6,border:"1px solid #e5e7eb",borderRadius:6},children:[l.length===0&&a.jsx("div",{style:{color:"#9ca3af"},children:"No departments available"}),l.map(p=>a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:6},children:[a.jsx("input",{type:"checkbox",checked:Array.isArray(n.departments)?n.departments.includes(p.id):!1,onChange:h=>{const m=Array.isArray(n.departments)?[...n.departments]:[];if(h.target.checked)m.includes(p.id)||m.push(p.id);else{const g=m.indexOf(p.id);g>=0&&m.splice(g,1)}i({...n,departments:m})},id:`dept-${p.id}`}),a.jsxs("label",{htmlFor:`dept-${p.id}`,style:{marginBottom:0},children:[p.code,"  ",p.name]})]},p.id))]})]})]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginTop:8},children:[a.jsx("input",{type:"checkbox",checked:!!n.editable,onChange:p=>i({...n,editable:p.target.checked}),id:"editable"}),a.jsx("label",{htmlFor:"editable",style:{fontWeight:600,color:"#3730a3",marginBottom:0},children:"Editable"})]}),u&&a.jsx("div",{style:{background:"#ecfccb",color:"#365314",padding:"8px 12px",borderRadius:8,fontWeight:600,display:"inline-block"},children:u}),a.jsxs("div",{style:{display:"flex",gap:10,marginTop:8},children:[a.jsx("button",{type:"submit",className:"btn-primary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},disabled:s,children:s?"Saving":"Save"}),a.jsx("button",{type:"button",className:"btn-secondary",style:{padding:"6px 18px",borderRadius:8,fontWeight:600,fontSize:16,minWidth:100},onClick:()=>r("/curriculum/master"),children:"Cancel"})]})]})]})}function uOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!0),i=e&&e.length?Array.from(new Set(e.map(W=>W.regulation))):[],s=e&&e.length?Array.from(new Set(e.map(W=>W.semester))).sort((W,V)=>W-V):[],[o,l]=x.useState(i.length===1?i[0]:i[0]??null),[c,u]=x.useState(s.length===1?s[0]:s[0]??null),d=e&&e.length?Array.from(new Set(e.map(W=>W.department.id))):[];x.useEffect(()=>{const W=e&&e.length?Array.from(new Set(e.map(ae=>ae.regulation))):[];W.length===1?l(W[0]):W.includes(o||"")||l(W[0]??null);const V=e&&e.length?Array.from(new Set(e.map(ae=>ae.semester))).sort((ae,ee)=>ae-ee):[];V.length===1?u(V[0]):V.includes(c||-1)||u(V[0]??null)},[e]),x.useEffect(()=>{Sl().then(W=>t(W)).catch(console.error).finally(()=>n(!1))},[]);async function f(W){try{const V=await Ure(W.id,W);t(ae=>ae.map(ee=>ee.id===V.id?V:ee)),h(null),alert("Row updated successfully")}catch(V){alert(String(V))}}const[p,h]=x.useState(null),m=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),g=Array.isArray(m)&&(m.includes("curriculum.department.approve")||m.includes("CURRICULUM_DEPARTMENT_APPROVE"));async function y(W,V){try{await zre(W,V);const ae=await Sl();t(ae),alert("OK")}catch(ae){alert(String(ae))}}const[b,v]=x.useState(null);x.useEffect(()=>{d.length===1?v(d[0]):d.includes(b||-1)||v(d[0]??null)},[e]);const w=e.filter(W=>W.is_elective&&(!b||W.department.id===b)&&(!o||W.regulation===o)&&(!c||W.semester===c)),[S,j]=x.useState([]);x.useEffect(()=>{fm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0}).then(j).catch(()=>j([]))},[b,o,c,e]);const[k,A]=x.useState(!1),[R,M]=x.useState({parent:null,department_id:b||null,regulation:o||null,semester_id:c||null,course_code:"",course_name:"",class_type:"THEORY",category:"",is_elective:!0,l:0,t:0,p:0,s:0,c:0,internal_mark:null,external_mark:null,total_mark:null,total_hours:null,question_paper_type:"",editable:!1});function B(W){M(V=>({...V,parent:W.id,department_id:b||V.department_id,regulation:o||V.regulation,semester_id:c||V.semester_id,course_name:"",course_code:""})),A(!0)}async function E(){try{const W={...R};if(!W.parent)throw new Error("Parent curriculum id missing");W.course_code||delete W.course_code,W.course_name||delete W.course_name,await $re(W);const V=await Sl();t(V);const ae=await fm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0});j(ae),A(!1),alert("Elective subject added")}catch(W){alert(String(W))}}const[P,D]=x.useState(!1),[G,H]=x.useState(null);function oe(W){H({...W}),D(!0)}async function de(){if(!(!G||!G.id))try{const W=await mr(`/api/curriculum/elective/${G.id}/`,{method:"PATCH",body:JSON.stringify(G)});if(!W.ok)throw new Error(await W.text());const V=await Sl();t(V);const ae=await fm({department_id:b??void 0,regulation:o??void 0,semester:c??void 0});j(ae),D(!1),alert("Elective updated")}catch(W){alert(String(W))}}return r?a.jsx(z1,{children:a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"Loading department curriculum"})]})})}):a.jsx(z1,{children:a.jsxs("div",{className:"px-4 pb-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-12 h-12 bg-indigo-100 rounded-xl flex items-center justify-center flex-shrink-0",children:a.jsxs("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 48 48",children:[a.jsx("rect",{width:"48",height:"48",rx:"12",fill:"#e0e7ff"}),a.jsx("path",{d:"M16 32V16h16v16H16zm2-2h12V18H18v12zm2-2v-8h8v8h-8z",fill:"#6366f1"})]})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Department Curriculum"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage department-specific curriculum entries."})]})]}),i.length>0&&a.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-6 bg-white rounded-lg shadow-sm p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Regulation:"}),a.jsx("select",{value:o??"",onChange:W=>l(W.target.value||null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:i.map(W=>a.jsx("option",{value:W,children:W},W))})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Semester:"}),a.jsx("select",{value:c??"",onChange:W=>u(W.target.value?Number(W.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500",children:s.map(W=>a.jsx("option",{value:W,children:W},W))})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:d.map(W=>{var C;const V=b===W,ae=(C=e.find(Y=>Y.department.id===W))==null?void 0:C.department,ee=(ae==null?void 0:ae.short_name)||(ae==null?void 0:ae.shortname)||(ae==null?void 0:ae.code)||(ae==null?void 0:ae.name)||`Dept ${W}`;return a.jsx("button",{onClick:()=>v(W),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${V?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:ee},W)})})]}),a.jsx("div",{className:"w-full overflow-x-auto bg-white rounded-lg shadow-md",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gradient-to-r from-gray-50 to-indigo-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap min-w-[200px]",children:"Course"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Elective"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Hours"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"QP Type"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Editable"}),a.jsx("th",{className:"px-3 py-3 text-left text-xs font-bold text-indigo-900 uppercase tracking-wider whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.filter(W=>(!b||W.department.id===b)&&(!o||W.regulation===o)&&(!c||W.semester===c)).map(W=>a.jsx("tr",{className:`hover:bg-gray-50 transition-colors ${W.editable?"bg-slate-50":""}`,children:p===W.id?a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:W.course_code||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,course_code:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2",children:a.jsx("textarea",{value:W.course_name||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,course_name:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",style:{minHeight:"32px"},placeholder:"Course Name",rows:1,onInput:V=>{const ae=V.target;ae.style.height="32px",ae.style.height=ae.scrollHeight+"px"}})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:W.category||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,category:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("select",{value:W.class_type||"THEORY",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,class_type:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500 edit-cell-input",style:{minWidth:90},children:Jp.map(V=>{const ae=ti(String(V)),ee=String(V).charAt(0).toUpperCase()+String(V).slice(1).toLowerCase();return a.jsx("option",{value:ae,children:ee},ae)})})}),a.jsx("td",{className:"px-3 py-2 text-center whitespace-nowrap",children:a.jsx("input",{type:"checkbox",checked:!!W.is_elective,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,is_elective:V.target.checked}:ee)),className:"w-4 h-4"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.l||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,l:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.t||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,t:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.p||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,p:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.s||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,s:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.c||0,onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,c:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.internal_mark||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,internal_mark:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.external_mark||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,external_mark:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.total_mark||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,total_mark:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{type:"number",value:W.total_hours||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,total_hours:Number(V.target.value)}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsx("input",{value:W.question_paper_type||"",onChange:V=>t(ae=>ae.map(ee=>ee.id===W.id?{...ee,question_paper_type:V.target.value}:ee)),className:"w-full px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:W.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsxs("td",{className:"px-3 py-2 whitespace-nowrap",children:[a.jsx("button",{className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors mr-2",onClick:()=>f(W),title:"Save",children:a.jsx(rd,{className:"w-4 h-4"})}),a.jsx("button",{className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg transition-colors",onClick:()=>h(null),title:"Cancel",children:a.jsx(bu,{className:"w-4 h-4"})})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.course_code||"-"}),a.jsx("td",{className:"px-3 py-2.5 text-sm text-gray-900 font-medium",children:W.course_name||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.category||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.class_type||"-"}),a.jsx("td",{className:"px-3 py-2.5 text-center whitespace-nowrap text-sm",children:W.is_elective?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.l??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.t??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.p??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.s??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.c??0}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.external_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.total_mark??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.total_hours??"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.question_paper_type||"-"}),a.jsx("td",{className:"px-3 py-2.5 whitespace-nowrap text-sm",children:W.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsxs("td",{className:"px-3 py-2.5 whitespace-nowrap",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[W.editable?a.jsx("button",{className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",onClick:()=>h(W.id),title:"Edit",children:a.jsx(dh,{className:"w-4 h-4"})}):a.jsx("div",{className:"w-8 h-8"}),g&&W.approval_status==="PENDING"?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>y(W.id,"approve"),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"Approve",children:a.jsx(Wee,{className:"w-4 h-4"})}),a.jsx("button",{onClick:()=>y(W.id,"reject"),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Reject",children:a.jsx(bu,{className:"w-4 h-4"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"w-8 h-8"}),a.jsx("div",{className:"w-8 h-8"})]})]}),a.jsxs("div",{className:"text-xs mt-1 text-gray-600",children:["Status: ",a.jsx("strong",{className:"text-gray-900",children:W.approval_status||"APPROVED"})]})]})]})},W.id))})]})}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Elective Options"}),w.length===0?a.jsx("div",{className:"text-gray-400 py-4",children:"No elective options for selected department/semester."}):a.jsx("div",{className:"space-y-6",children:w.map(W=>{const V=S.filter(ae=>ae.parent===W.id);return a.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("div",{className:"text-lg font-bold text-gray-900",children:W.course_name||W.course_code||"Elective"}),a.jsx("button",{onClick:()=>B(W),className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Add Subject"})]}),a.jsx("div",{className:"w-full overflow-x-auto",children:a.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Code"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Course"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"CAT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Class"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"L"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"T"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"P"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"S"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"C"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"INT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"EXT"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"TTL"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Hours"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"QP Type"}),a.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 uppercase whitespace-nowrap",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-100",children:V.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:15,className:"px-3 py-4 text-gray-400 text-center",children:"No subjects added yet."})}):V.map(ae=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.course_code||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.course_name||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.category||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.class_type||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.l??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.t??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.p??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.s??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.c??0}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.internal_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.external_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.total_mark??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.total_hours??"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap text-sm",children:ae.question_paper_type||"-"}),a.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm",children:ae.editable?a.jsx("span",{className:"text-emerald-600 font-semibold",children:"Yes"}):a.jsx("span",{className:"text-gray-400",children:"No"})}),a.jsx("button",{onClick:()=>oe(ae),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:a.jsx(dh,{className:"w-4 h-4"})})]})})]},ae.id))})]})})]},W.id)})})]}),k&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Add Elective Subject"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),a.jsx("input",{value:R.course_name||"",onChange:W=>M(V=>({...V,course_name:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),a.jsx("input",{value:R.course_code||"",onChange:W=>M(V=>({...V,course_code:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),a.jsxs("select",{value:R.class_type,onChange:W=>M(V=>({...V,class_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"THEORY",children:"THEORY"}),a.jsx("option",{value:"LAB",children:"LAB"}),a.jsx("option",{value:"TCPL",children:"TCPL"}),a.jsx("option",{value:"TCPR",children:"TCPR"}),a.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),a.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),a.jsx("input",{value:R.category||"",onChange:W=>M(V=>({...V,category:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),a.jsx("input",{type:"number",value:R.l??0,onChange:W=>M(V=>({...V,l:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),a.jsx("input",{type:"number",value:R.t??0,onChange:W=>M(V=>({...V,t:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),a.jsx("input",{type:"number",value:R.p??0,onChange:W=>M(V=>({...V,p:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),a.jsx("input",{type:"number",value:R.s??0,onChange:W=>M(V=>({...V,s:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),a.jsx("input",{type:"number",value:R.c??0,onChange:W=>M(V=>({...V,c:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),a.jsx("input",{type:"number",value:R.internal_mark??"",onChange:W=>M(V=>({...V,internal_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),a.jsx("input",{type:"number",value:R.external_mark??"",onChange:W=>M(V=>({...V,external_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),a.jsx("input",{type:"number",value:R.total_mark??"",onChange:W=>M(V=>({...V,total_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),a.jsx("input",{type:"number",value:R.total_hours??"",onChange:W=>M(V=>({...V,total_hours:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),a.jsx("input",{value:R.question_paper_type||"",onChange:W=>M(V=>({...V,question_paper_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"add-editable",type:"checkbox",checked:!!R.editable,onChange:W=>M(V=>({...V,editable:W.target.checked})),className:"w-4 h-4"}),a.jsx("label",{htmlFor:"add-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),a.jsx("button",{onClick:E,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})}),P&&G&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:a.jsxs("div",{className:"w-full max-w-3xl mx-4 bg-white rounded-lg shadow-2xl p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Edit Elective Subject"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Name"}),a.jsx("input",{value:G.course_name||"",onChange:W=>H(V=>({...V,course_name:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Course Code"}),a.jsx("input",{value:G.course_code||"",onChange:W=>H(V=>({...V,course_code:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Class Type"}),a.jsxs("select",{value:G.class_type||"THEORY",onChange:W=>H(V=>({...V,class_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"THEORY",children:"THEORY"}),a.jsx("option",{value:"LAB",children:"LAB"}),a.jsx("option",{value:"TCPL",children:"TCPL"}),a.jsx("option",{value:"TCPR",children:"TCPR"}),a.jsx("option",{value:"PRACTICAL",children:"PRACTICAL"}),a.jsx("option",{value:"AUDIT",children:"AUDIT"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Category"}),a.jsx("input",{value:G.category||"",onChange:W=>H(V=>({...V,category:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"L"}),a.jsx("input",{type:"number",value:G.l??0,onChange:W=>H(V=>({...V,l:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"T"}),a.jsx("input",{type:"number",value:G.t??0,onChange:W=>H(V=>({...V,t:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"P"}),a.jsx("input",{type:"number",value:G.p??0,onChange:W=>H(V=>({...V,p:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"S"}),a.jsx("input",{type:"number",value:G.s??0,onChange:W=>H(V=>({...V,s:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"C"}),a.jsx("input",{type:"number",value:G.c??0,onChange:W=>H(V=>({...V,c:Number(W.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Internal Mark"}),a.jsx("input",{type:"number",value:G.internal_mark??"",onChange:W=>H(V=>({...V,internal_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"External Mark"}),a.jsx("input",{type:"number",value:G.external_mark??"",onChange:W=>H(V=>({...V,external_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Mark"}),a.jsx("input",{type:"number",value:G.total_mark??"",onChange:W=>H(V=>({...V,total_mark:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Total Hours"}),a.jsx("input",{type:"number",value:G.total_hours??"",onChange:W=>H(V=>({...V,total_hours:W.target.value?Number(W.target.value):null})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Question Paper Type"}),a.jsx("input",{value:G.question_paper_type||"",onChange:W=>H(V=>({...V,question_paper_type:W.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{id:"edit-editable",type:"checkbox",checked:!!G.editable,onChange:W=>H(V=>({...V,editable:W.target.checked})),className:"w-4 h-4"}),a.jsx("label",{htmlFor:"edit-editable",className:"text-sm font-medium text-gray-700",children:"Editable"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:()=>D(!1),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),a.jsx("button",{onClick:de,className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors",children:"Save"})]})]})})]})})}function dOe(){const[e,t]=x.useState(null),[r,n]=x.useState(!1),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState([]),[d,f]=x.useState([]),[p,h]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState(""),[v,w]=x.useState([]),[S,j]=x.useState(!1);x.useEffect(()=>{k()},[p,m,y]),x.useEffect(()=>{A()},[]);const k=async()=>{j(!0);try{const D={};p&&(D.regulation=p),m&&(D.semester=m),y&&(D.department_id=y);const G=await fm(D);w(G||[])}catch(D){console.error("Failed to load electives:",D),w([])}finally{j(!1)}},A=async()=>{try{const D=await fm();if(!D||!Array.isArray(D))return;const G=[...new Set(D.map(de=>de.regulation))].filter(Boolean).sort(),H=[...new Set(D.map(de=>de.semester))].filter(Boolean).sort((de,W)=>de-W),oe=Array.from(new Map(D.map(de=>de.department).filter(Boolean).map(de=>[de.id,de])).values()).sort((de,W)=>(de.code||"").localeCompare(W.code||""));l(G),u(H),f(oe)}catch(D){console.error("Failed to load filter options:",D)}},R=async()=>{try{const D=await mr("/api/curriculum/elective-choices/template/");if(!D.ok){alert("Failed to download template");return}const G=await D.blob(),H=window.URL.createObjectURL(G),oe=document.createElement("a");oe.href=H,oe.download="elective_choices_template.csv",document.body.appendChild(oe),oe.click(),window.URL.revokeObjectURL(H),document.body.removeChild(oe)}catch(D){console.error("Download error:",D),alert("Failed to download template")}},M=async()=>{try{const D=await mr("/api/curriculum/elective-choices/template/?format=excel");if(!D.ok){alert("Failed to download Excel template");return}const G=await D.blob(),H=window.URL.createObjectURL(G),oe=document.createElement("a");oe.href=H,oe.download="elective_choices_template.xlsx",document.body.appendChild(oe),oe.click(),window.URL.revokeObjectURL(H),document.body.removeChild(oe)}catch(D){console.error("Download error:",D),alert("Failed to download Excel template")}},B=D=>{var H;const G=(H=D.target.files)==null?void 0:H[0];if(G){if(![".csv",".xlsx",".xls"].some(W=>G.name.toLowerCase().endsWith(W))){alert("Please select a CSV or Excel file (.csv, .xlsx, .xls)");return}t(G),s(null)}},E=async()=>{if(!e){alert("Please select a file first");return}n(!0),s(null);try{const D=new FormData;D.append("csv_file",e);const G=await mr("/api/curriculum/elective-choices/import/",{method:"POST",body:D});if(G.status===401){alert("Your session has expired. Please refresh the page and try again.");return}let H;try{H=await G.json()}catch(oe){console.error("Failed to parse response:",oe),alert("Import failed: Invalid response from server");return}if(G.ok){s(H),t(null);const oe=document.getElementById("file-input");oe&&(oe.value=""),k()}else{const oe=H.error||H.detail||H.message||"Import failed";alert(typeof oe=="string"?oe:"Import failed: "+JSON.stringify(oe).substring(0,200))}}catch(D){console.error("Upload error:",D),alert("Failed to upload file. Please check your connection and try again.")}finally{n(!1)}},P=v.filter(D=>{var G;return!(p&&D.regulation!==p||m&&D.semester!==m||y&&((G=D.department)==null?void 0:G.id)!==y)});return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-indigo-50 rounded-lg",children:a.jsx(ate,{className:"h-6 w-6 text-indigo-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Elective Import"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Import student elective choices from CSV or Excel"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:R,className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white font-medium rounded-lg hover:bg-green-700 transition-colors",children:[a.jsx(T4,{className:"h-5 w-5"}),"CSV Template"]}),a.jsxs("button",{onClick:M,className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-600 text-white font-medium rounded-lg hover:bg-emerald-700 transition-colors",children:[a.jsx(T4,{className:"h-5 w-5"}),"Excel Template"]})]})]}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Upload File"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{children:a.jsxs("label",{htmlFor:"file-input",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[a.jsxs("div",{className:"flex flex-col items-center justify-center",children:[a.jsx(E2,{className:"h-8 w-8 text-gray-400 mb-2"}),a.jsx("p",{className:"text-sm text-gray-600",children:e?a.jsx("span",{className:"font-medium text-indigo-600",children:e.name}):a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]})}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"CSV or Excel files (.csv, .xlsx, .xls)"})]}),a.jsx("input",{id:"file-input",type:"file",className:"hidden",accept:".csv,.xlsx,.xls",onChange:B})]})}),a.jsxs("button",{onClick:E,disabled:!e||r,className:`w-full inline-flex items-center justify-center gap-2 px-6 py-3 font-medium rounded-lg transition-colors ${!e||r?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[a.jsx(E2,{className:"h-5 w-5"}),r?"Uploading...":"Upload and Import"]})]})]}),i&&a.jsx("div",{className:`rounded-lg shadow-sm p-6 mb-6 ${i.errors&&i.errors.length>0?"bg-yellow-50 border border-yellow-200":"bg-green-50 border border-green-200"}`,children:a.jsxs("div",{className:"flex items-start gap-3",children:[i.errors&&i.errors.length>0?a.jsx(ed,{className:"h-6 w-6 text-yellow-600 flex-shrink-0 mt-0.5"}):a.jsx(xN,{className:"h-6 w-6 text-green-600 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:`text-lg font-semibold mb-2 ${i.errors&&i.errors.length>0?"text-yellow-900":"text-green-900"}`,children:i.message}),a.jsxs("div",{className:`space-y-1 text-sm ${i.errors&&i.errors.length>0?"text-yellow-800":"text-green-800"}`,children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Created:"})," ",i.created," entries"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Updated:"})," ",i.updated," entries"]}),i.errors&&i.errors.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsxs("p",{className:"font-semibold text-red-700 mb-2",children:["Errors (",i.errors.length,"):"]}),a.jsx("ul",{className:"list-disc list-inside space-y-1 text-red-600 max-h-40 overflow-y-auto",children:i.errors.map((D,G)=>a.jsx("li",{className:"text-xs",children:D},G))})]})]})]})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(cte,{className:"h-5 w-5 text-gray-600"}),a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Elective Subjects"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Regulation"}),a.jsxs("select",{value:p,onChange:D=>h(D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Regulations"}),o.map(D=>a.jsx("option",{value:D,children:D},D))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Semester"}),a.jsxs("select",{value:m,onChange:D=>g(D.target.value?Number(D.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Semesters"}),c.map(D=>a.jsxs("option",{value:D,children:["Semester ",D]},D))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),a.jsxs("select",{value:y,onChange:D=>b(D.target.value?Number(D.target.value):""),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:[a.jsx("option",{value:"",children:"All Departments"}),d.map(D=>a.jsxs("option",{value:D.id,children:[D.code," - ",D.short_name||D.name]},D.id))]})]})]}),S?a.jsx("div",{className:"text-center py-8 text-gray-600",children:"Loading electives..."}):P.length===0?a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No electives found"}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Regulation"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Semester"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),a.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx(ys,{className:"h-4 w-4"}),"Students"]})})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(D=>{var G;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:D.course_code||""}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:D.course_name||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:D.regulation||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:D.semester||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-600",children:((G=D.department)==null?void 0:G.code)||""}),a.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:a.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${D.student_count>0?"bg-indigo-100 text-indigo-800":"bg-gray-100 text-gray-600"}`,children:D.student_count})})]},D.id)})})]})})]})]})})}function fOe(){var e;if(typeof window<"u"&&((e=window.location)!=null&&e.origin)){const t=String(window.location.hostname||"").trim().toLowerCase();return t==="localhost"||t==="127.0.0.1"?"http://localhost:8000":String(window.location.origin).replace(/\/+$/,"")}return"https://db.krgi.co.in"}const Op=fOe();function ox(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function LK(){var Ae;const[e,t]=x.useState([]),[r,n]=x.useState("courses"),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState(!1),[p,h]=x.useState(1),[m,g]=x.useState("idle"),[y,b]=x.useState(null),[v,w]=x.useState([]),[S,j]=x.useState(null),[k,A]=x.useState(""),[R,M]=x.useState(""),[B,E]=x.useState(""),[P,D]=x.useState(""),[G,H]=x.useState(""),[oe,de]=x.useState(!1),[W,V]=x.useState(null),[ae,ee]=x.useState(null),[C,Y]=x.useState([]),[q,O]=x.useState(!1),[X,F]=x.useState(0),[Q,K]=x.useState([]),[ne,re]=x.useState(null),[T,I]=x.useState(null),[ie,U]=x.useState(null);function Z(ce){try{if(typeof ce=="string"){let be=ce;return!be.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(be)&&be.length>100&&(be=`data:image/png;base64,${be.replace(/\s+/g,"")}`),be}if(ce&&typeof ce=="object"){if(typeof ce.url=="string"&&ce.url)return ce.url;if(typeof ce.base64=="string"&&ce.base64)return ce.base64.startsWith("data:")?ce.base64:`data:image/png;base64,${ce.base64}`;if(ce.binary&&ce.binary instanceof Uint8Array){const be=new Blob([ce.binary],{type:"image/png"});return URL.createObjectURL(be)}}if(ce instanceof Uint8Array){const be=new Blob([ce],{type:"image/png"});return URL.createObjectURL(be)}return null}catch{return null}}x.useEffect(()=>{Dd().then(ce=>s(ce)).catch(()=>s(null)),(async()=>{try{u(!0);const ce=await hc();Array.isArray(ce)&&l(ce)}catch(ce){console.warn("Failed to load teaching assignments",ce),l([])}finally{u(!1)}})(),(async()=>{try{const ce=await fetch(`${Op}/api/obe/list-uploads`,{headers:{...ox()}});if(!ce.ok)return;const be=await ce.json();Array.isArray(be==null?void 0:be.files)&&K(be.files||[])}catch{}})()},[]);const me=x.useMemo(()=>i?i.faculty_id??i.staff_id??i.employee_id??i.id??null:null,[i]),Pe=ce=>{const be=parseFloat(ce.replace(/[^0-9.\-]/g,""));return Number.isFinite(be)?be:0},je=ce=>{const be=`/obe/course/${encodeURIComponent(ce)}`;window.location.href=be},Fe=x.useMemo(()=>(v||[]).filter(ce=>{const be=String((ce==null?void 0:ce.marks)??"").trim().toUpperCase(),mt=String((ce==null?void 0:ce.btl)??"").trim().toUpperCase(),et=String((ce==null?void 0:ce.course_outcomes)??"").trim().toUpperCase();return!(be==="(OR)"&&mt==="(OR)"&&et==="(OR)")}),[v]),[_e,He]=x.useState("idle"),[qe,Pt]=x.useState(null);async function ut(ce){He("uploading"),Pt(null),g("idle"),b(null),V(null),ee(null);const be=new FormData;be.append("file",ce);try{const mt=await fetch(`${Op}/api/obe/upload-docx`,{method:"POST",headers:{...ox()},body:be});if(!mt.ok){const Tt=await mt.text();He("error"),Pt(Tt||`Upload failed (${mt.status})`);return}const et=await mt.json();He("success");const Ue=(et==null?void 0:et.file_url)||(et==null?void 0:et.saved_path)||"";j(Ue||null),Pt(`Uploaded: ${Ue}`),f(!0),h(1),w([]),g("scanning"),b("Scanning DOCX");const It=new FormData;It.append("file",ce);const ht=await fetch(`${Op}/api/template/scan-docx`,{method:"POST",headers:{...ox()},body:It});if(!ht.ok){const Tt=await ht.text();g("error"),b(Tt||`Scan failed (${ht.status})`),w([]);return}const Lt=await ht.json(),Ar=(Array.isArray(Lt==null?void 0:Lt.questions)?Lt.questions:[]).map(Tt=>({...Tt,source_file_path:Ue||Tt.source_file_path||null}));if(w(Ar),g("success"),b(`Scanned ${Ar.length} question(s).`),!k.trim()){const Tt=ce.name.replace(/\.docx$/i,"");A(Tt)}}catch(mt){He("error"),Pt((mt==null?void 0:mt.message)||"Upload failed"),g("error"),b((mt==null?void 0:mt.message)||"Scan failed")}}function Ke(){f(!1),h(1)}async function lt(){if(!k.trim()){ee("Exam name is required."),h(2);return}if(!B.trim()){ee("Exam type is required."),h(2);return}if(!P.trim()){ee("Exam date is required."),h(2);return}de(!0),ee(null),V(null);try{const ce=G.split(/\r?\n/).map(It=>It.trim()).filter(Boolean),be=Fe.map(It=>({...It,excel_type:It.excel_type||B,source_file_path:It.source_file_path||S||null})),mt=await fetch(`${Op}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...ox()},body:JSON.stringify({title:k.trim(),status:"pending",exam_type:B.trim(),exam_date:P.trim(),sections:ce,faculty_id:me,questions:be})});if(!mt.ok){const It=await mt.text();ee(It||`Import failed (${mt.status})`);return}const et=await mt.json();V(et);const Ue={title:k.trim(),inserted:et.inserted||0,failed:Array.isArray(et.failed)?et.failed.length:0,source_file_path:S||null,title_id:et.title_id||null,exam_date:P||null,exam_type:B||null,faculty_id:me||null,created_at:new Date().toISOString()};Y(It=>[Ue,...It]),O(!0),setTimeout(()=>O(!1),4e3),setTimeout(()=>Ke(),600)}catch(ce){ee((ce==null?void 0:ce.message)||"Import failed")}finally{de(!1)}}const ve=e.length;return ve&&(e.reduce((ce,be)=>ce+Pe(be.achieved),0)/ve).toFixed(1)+"",a.jsxs("main",{className:"obe-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[a.jsx("header",{style:{marginBottom:32,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsx("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"flex-end",width:"100%"},children:a.jsxs("div",{style:{textAlign:"left"},children:[a.jsx("h1",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:"Outcome Based Education (OBE)"}),a.jsx("div",{style:{marginTop:8,color:"#64748b",fontSize:16,fontWeight:400},children:"Select a course, then work through CDAP, Articulation Matrix and Mark Entry."})]})})}),a.jsxs("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)"},children:[a.jsx("button",{onClick:()=>n("courses"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="courses"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="courses"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="courses"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="courses"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Courses"}),a.jsx("button",{onClick:()=>n("exam"),style:{padding:"10px 24px",borderRadius:8,border:"none",background:r==="exam"?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:r==="exam"?"#fff":"#64748b",cursor:"pointer",fontWeight:r==="exam"?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:r==="exam"?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:" Exam Management"})]}),r==="courses"&&a.jsxs("section",{"aria-label":"Course selector",style:{marginBottom:32},children:[a.jsx("div",{style:{fontSize:14,color:"#475569",marginBottom:20,fontWeight:500},children:"Select a course to work on:"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(320px, 1fr))",gap:24,marginBottom:32},children:c?a.jsx("div",{style:{gridColumn:"1/-1",color:"#64748b",fontSize:16,textAlign:"center",padding:60,background:"#fff",borderRadius:12},children:" Loading courses"}):o.length===0?a.jsxs("div",{style:{gridColumn:"1/-1",color:"#94a3b8",fontSize:18,textAlign:"center",padding:60,background:"#fff",borderRadius:12,border:"2px dashed #e2e8f0"},children:[" No courses found. You have no teaching assignments.",a.jsx("br",{}),a.jsx("span",{style:{fontSize:14,marginTop:12,display:"block"},children:"(If you expect to see courses here, please check with your backend/API or contact admin.)"})]}):o.reduce((ce,be)=>(ce.some(mt=>mt.subject_code===be.subject_code)||ce.push(be),ce),[]).map(ce=>a.jsxs("div",{onClick:()=>je(ce.subject_code),role:"button",tabIndex:0,onKeyDown:be=>{be.key==="Enter"&&je(ce.subject_code)},onMouseEnter:be=>{be.currentTarget.style.transform="translateY(-4px)",be.currentTarget.style.boxShadow="0 12px 24px rgba(0,0,0,0.1), 0 4px 8px rgba(0,0,0,0.06)",be.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:be=>{be.currentTarget.style.transform="translateY(0)",be.currentTarget.style.boxShadow="0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",be.currentTarget.style.borderColor="#e2e8f0"},style:{border:"1px solid #e2e8f0",borderRadius:12,padding:24,background:"#fff",boxShadow:"0 4px 6px rgba(0,0,0,0.07), 0 2px 4px rgba(0,0,0,0.05)",display:"flex",flexDirection:"column",alignItems:"flex-start",minHeight:140,position:"relative",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",cursor:"pointer"},children:[a.jsx("div",{style:{fontWeight:700,fontSize:19,marginBottom:6,color:"#0f172a",lineHeight:1.3},children:ce.subject_name}),a.jsx("div",{style:{fontSize:14,color:"#3b82f6",marginBottom:16,fontWeight:600,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:ce.subject_code}),a.jsxs("div",{style:{marginTop:"auto",display:"flex",gap:10,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("button",{onClick:be=>{be.stopPropagation(),je(ce.subject_code)},onMouseEnter:be=>{be.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)",be.currentTarget.style.transform="scale(1.05)"},onMouseLeave:be=>{be.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",be.currentTarget.style.transform="scale(1)"},style:{padding:"8px 18px",borderRadius:8,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:600,fontSize:14,cursor:"pointer",boxShadow:"0 2px 4px rgba(37,99,235,0.2)",transition:"all 0.2s ease"},children:"Open Course"}),a.jsx("button",{onClick:be=>{be.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(ce.subject_code)}/lca`},onMouseEnter:be=>{be.currentTarget.style.background="#f8fafc",be.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:be=>{be.currentTarget.style.background="#fff",be.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"LCA"}),a.jsx("button",{onClick:be=>{be.stopPropagation(),window.location.href=`/obe/course/${encodeURIComponent(ce.subject_code)}/co_attainment`},onMouseEnter:be=>{be.currentTarget.style.background="#f8fafc",be.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:be=>{be.currentTarget.style.background="#fff",be.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",fontWeight:600,fontSize:13,cursor:"pointer",transition:"all 0.2s ease"},children:"CO"})]})]},ce.subject_code))})]}),r==="exam"&&a.jsx("section",{"aria-label":"Exam management",style:{background:"#fff",padding:28,borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[a.jsx("div",{style:{background:"#f8fafc",padding:20,borderRadius:12,border:"2px dashed #cbd5e1"},children:a.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center"},children:[a.jsx("input",{id:"exam-upload-input",type:"file",accept:".docx",style:{display:"none"},onChange:ce=>{const be=ce.target.files&&ce.target.files[0];be&&ut(be),ce.currentTarget.value=""}}),a.jsx("label",{htmlFor:"exam-upload-input",style:{display:"inline-flex",alignItems:"center",gap:10,padding:"12px 20px",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",borderRadius:10,cursor:"pointer",fontWeight:600,fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:_e==="uploading"?" Uploading...":" Upload .docx"}),a.jsx("div",{style:{color:"#64748b",fontSize:14},children:"Upload exam spreadsheets or related files here."})]})}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("input",{type:"search",placeholder:" Search exams, courses, entries...",style:{flex:1,padding:"12px 16px",borderRadius:10,border:"1px solid #e2e8f0",fontSize:15,background:"#fff",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},onChange:()=>{}}),a.jsx("button",{style:{padding:"12px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#475569",transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:"Search"})]}),a.jsxs("div",{style:{marginTop:8},children:[a.jsx("h3",{style:{margin:"12px 0 16px 0",fontSize:18,fontWeight:700,color:"#0f172a"},children:" Recent"}),C.length===0?a.jsxs("div",{style:{color:"#666"},children:[a.jsx("div",{style:{marginBottom:8,fontSize:13},children:"Uploaded DOCX files"}),Q.length===0?a.jsx("div",{style:{color:"#666"},children:"No uploaded DOCX files found."}):a.jsx("div",{style:{display:"grid",gap:8},children:Q.map((ce,be)=>a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700},children:ce.name}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:ce.path})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>re(ce),style:{background:"none",border:"none",color:"#2563eb",cursor:"pointer",padding:6},children:"Open"})})]},be))})]}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"320px 1fr",gap:12},children:[a.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:C.slice(0,12).map((ce,be)=>{const mt=be===X;return a.jsxs("div",{onClick:()=>F(be),role:"button",tabIndex:0,style:{border:mt?"2px solid #2563eb":"1px solid #e5e7eb",borderRadius:8,padding:10,background:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[a.jsxs("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0,children:[a.jsx("path",{d:"M6 2h7l5 5v13a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1z",fill:"#e6f0ff",stroke:"#2563eb",strokeWidth:"0.5"}),a.jsx("path",{d:"M13 2v6h6",fill:"#fff"}),a.jsx("rect",{x:"7",y:"11",width:"10",height:"2.2",rx:"0.6",fill:"#2563eb"}),a.jsx("rect",{x:"7",y:"14",width:"6",height:"2.2",rx:"0.6",fill:"#2563eb"}),a.jsx("text",{x:"7",y:"18.8",fontSize:"2.8",fill:"#2563eb",fontFamily:"Arial, Helvetica, sans-serif",children:"DOCX"})]}),a.jsx("div",{style:{fontWeight:700},children:ce.title})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[ce.exam_type||"","  ",ce.exam_date||""]})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontWeight:800,color:"#16a34a"},children:ce.inserted}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"questions"})]})]},be)})}),a.jsx("div",{children:C[X]&&a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Preview"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"240px 1fr",gap:12},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():"U"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#111827"},children:me??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Course details"}),a.jsx("div",{style:{fontWeight:700},children:""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""}),a.jsxs("div",{style:{marginTop:8,fontSize:12,color:"#6b7280"},children:["Assignments: ",a.jsx("strong",{style:{color:"#111827"},children:""})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Questions imported"}),a.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:C[X].inserted})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Title"}),a.jsx("div",{style:{fontWeight:700},children:C[X].title||""}),a.jsx("div",{style:{marginTop:6,fontSize:12,color:"#6b7280"},children:"Assessment"}),a.jsx("div",{style:{fontWeight:700},children:C[X].exam_type||""})]})]}),a.jsxs("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam Type"}),a.jsx("div",{style:{fontWeight:700},children:C[X].exam_type||""})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Exam date"}),a.jsx("div",{style:{fontWeight:700},children:C[X].exam_date||""})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Uploaded file"}),a.jsx("div",{style:{fontWeight:700,whiteSpace:"pre-wrap"},children:C[X].source_file_path||""})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Questions preview"}),a.jsx("div",{children:a.jsx("button",{onClick:async()=>{var ce,be;I(null);try{const mt=(ce=C[X])==null?void 0:ce.title_id;let et="";mt?et=`${Op}/api/import/questions/list?title_id=${mt}`:et=`${Op}/api/import/questions/list?title=${encodeURIComponent(((be=C[X])==null?void 0:be.title)||"")}`;const Ue=await fetch(et,{headers:{...ox()}});if(!Ue.ok){I([]);return}const It=await Ue.json();I(Array.isArray(It==null?void 0:It.questions)?It.questions:[])}catch{I([])}},style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Load questions"})})]}),a.jsx("div",{style:{maxHeight:220,overflow:"auto"},children:T===null?a.jsx("div",{style:{color:"#6b7280"},children:'Click "Load questions" to fetch saved questions for this import.'}):T.length===0?a.jsx("div",{style:{color:"#6b7280"},children:"No saved questions found for this title."}):T.slice(0,20).map((ce,be)=>a.jsxs("div",{style:{padding:"8px 6px",borderBottom:"1px solid #f3f4f6"},children:[a.jsxs("div",{style:{fontWeight:700,color:"#111827"},children:[be+1,"."]}),a.jsx("div",{style:{color:"#111827"},children:String(ce.question_text).slice(0,300)})]},be))})]})]})]})]})})]})]}),qe&&a.jsx("div",{style:{marginTop:12,fontSize:14,color:_e==="error"?"#dc2626":"#16a34a",background:_e==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${_e==="error"?"#fecaca":"#bbf7d0"}`},children:qe})]})}),d&&a.jsx("div",{role:"dialog","aria-modal":"true",onClick:Ke,style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50,padding:20},children:a.jsxs("div",{onClick:ce=>ce.stopPropagation(),style:{width:"min(1000px, 100%)",background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.3)",overflow:"hidden",border:"1px solid #e2e8f0"},children:[a.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:20,color:"#0f172a"},children:" Question Import"}),a.jsxs("div",{style:{color:"#64748b",fontSize:14,marginTop:4},children:["Step ",p," of 3  ",m==="scanning"?"Scanning":m==="error"?"Scan failed":"Ready"]})]}),a.jsx("button",{onClick:Ke,onMouseEnter:ce=>{ce.currentTarget.style.background="#fee2e2"},onMouseLeave:ce=>{ce.currentTarget.style.background="#fff"},style:{padding:"8px 14px",borderRadius:8,border:"1px solid #e2e8f0",background:"#fff",cursor:"pointer",fontWeight:600,fontSize:14,color:"#64748b",transition:"all 0.2s ease"},children:" Close"})]}),a.jsx("div",{style:{overflow:"hidden",background:"#fafbfc"},children:a.jsxs("div",{style:{display:"flex",width:"300%",transform:`translateX(-${(p-1)*33.3333333}%)`,transition:"transform 360ms cubic-bezier(0.4, 0, 0.2, 1)"},children:[a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,marginBottom:16},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700,fontSize:18,color:"#0f172a"},children:" Preview"}),a.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:S?`Source: ${S}`:"Source: (not available)"})]}),a.jsxs("div",{style:{fontSize:14,color:"#0f172a",background:"#eff6ff",padding:"6px 12px",borderRadius:8,fontWeight:600},children:["Questions: ",a.jsx("b",{style:{color:"#3b82f6"},children:Fe.length})]})]}),y&&a.jsx("div",{style:{marginBottom:12,fontSize:14,color:m==="error"?"#dc2626":"#16a34a",background:m==="error"?"#fef2f2":"#f0fdf4",padding:"12px 16px",borderRadius:10,border:`1px solid ${m==="error"?"#fecaca":"#bbf7d0"}`},children:y}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,maxHeight:420,overflow:"auto",background:"#fff",boxShadow:"0 2px 8px rgba(0,0,0,0.05)"},children:[m==="scanning"&&a.jsx("div",{style:{color:"#64748b",textAlign:"center",padding:40},children:" Scanning your DOCX"}),m!=="scanning"&&Fe.length===0&&a.jsx("div",{style:{color:"#94a3b8",textAlign:"center",padding:40},children:" No questions to preview yet."}),Fe.map((ce,be)=>a.jsxs("div",{style:{padding:"14px 12px",borderBottom:be<Fe.length-1?"1px solid #f1f5f9":"none"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:10,marginBottom:8},children:[a.jsxs("div",{style:{fontWeight:700,color:"#3b82f6",fontSize:15,background:"#eff6ff",padding:"4px 10px",borderRadius:6},children:["Q",be+1]}),a.jsxs("div",{style:{fontSize:12,color:"#64748b",background:"#f8fafc",padding:"4px 10px",borderRadius:6},children:["Marks: ",String((ce==null?void 0:ce.marks)??"-")," "," BTL: ",String((ce==null?void 0:ce.btl)??"-")," "," CO: ",String((ce==null?void 0:ce.course_outcomes)??"-")]})]}),a.jsxs("div",{style:{marginTop:8,color:"#1e293b",whiteSpace:"pre-wrap",fontSize:14,lineHeight:1.6},children:[String((ce==null?void 0:ce.question_text)??"").slice(0,500),String((ce==null?void 0:ce.question_text)??"").length>500?"":""]}),Array.isArray(ce==null?void 0:ce.images)&&ce.images.length?a.jsx("div",{style:{marginTop:12,display:"flex",gap:12,flexWrap:"wrap"},children:ce.images.slice(0,4).map((mt,et)=>{const Ue=Z(mt);return Ue?a.jsx("img",{src:Ue,alt:`q${be+1}-img${et+1}`,onClick:()=>U(Ue),style:{maxHeight:140,borderRadius:10,border:"2px solid #e2e8f0",cursor:"pointer",objectFit:"contain",background:"#fff",transition:"all 0.2s ease",boxShadow:"0 2px 6px rgba(0,0,0,0.08)"}},et):null})}):null]},be))]})]}),a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Save details"}),ae&&a.jsx("div",{style:{marginBottom:12,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:ae}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam name"}),a.jsx("input",{value:k,onChange:ce=>A(ce.target.value),placeholder:"e.g., Unit 1 - Introduction",style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",boxShadow:"inset 0 1px 2px #00000008"}})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam (CIA / Model / ESE)"}),a.jsxs("select",{value:R,onChange:ce=>M(ce.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[a.jsx("option",{value:"",children:"Select assessment"}),a.jsx("option",{value:"CIA1",children:"CIA1"}),a.jsx("option",{value:"CIA2",children:"CIA2"}),a.jsx("option",{value:"MODEL",children:"MODEL"}),a.jsx("option",{value:"ESE",children:"ESE"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam Type"}),a.jsxs("select",{value:B,onChange:ce=>E(ce.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8",background:"#fff"},children:[a.jsx("option",{value:"",children:"Select paper"}),a.jsx("option",{value:"QP1",children:"QP1"}),a.jsx("option",{value:"QP2",children:"QP2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Exam date"}),a.jsx("input",{type:"date",value:P,onChange:ce=>D(ce.target.value),style:{width:"100%",padding:"10px 12px",borderRadius:10,border:"1px solid #e6eef8"}})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"Sections"}),a.jsx("textarea",{value:G,onChange:ce=>H(ce.target.value),placeholder:"e.g., Part A\\nPart B\\nSection 1",rows:3,style:{width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid #e6eef8",resize:"vertical"}})]})]}),a.jsx("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:"This metadata is shown for confirmation. (Currently, only the exam name is used as the imported title.)"})]}),a.jsxs("div",{style:{width:"33.3333333%",padding:24},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:16,fontSize:18,color:"#0f172a"},children:" Confirmation"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:16},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:10,background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#3b82f6",fontSize:24},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():""}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#0f172a"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#64748b"},children:"Faculty"})]})]}),a.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569",background:"#f8fafc",padding:"8px 12px",borderRadius:8},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#0f172a"},children:me??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",marginBottom:10,fontWeight:600},children:" Course details"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a"},children:""}),a.jsx("div",{style:{fontSize:13,color:"#64748b",marginTop:2},children:""}),a.jsxs("div",{style:{marginTop:12,fontSize:13,color:"#475569"},children:["Assignments: ",a.jsx("strong",{style:{color:"#0f172a"},children:""})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,marginBottom:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:16,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Questions to import"}),a.jsx("div",{style:{fontSize:28,fontWeight:900,color:"#3b82f6",marginTop:4},children:Fe.length})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:600},children:"Exam name"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",fontSize:16,marginTop:2},children:k||""}),a.jsx("div",{style:{marginTop:8,fontSize:13,color:"#64748b",fontWeight:600},children:"Assessment"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:2},children:R||""})]})]}),a.jsxs("div",{style:{marginTop:16,display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,background:"#f8fafc",padding:12,borderRadius:8},children:[a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam Type"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:B||""})]}),a.jsxs("div",{children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Exam date"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",marginTop:4},children:P||""})]}),a.jsxs("div",{style:{gridColumn:"1 / -1"},children:[a.jsx("span",{style:{color:"#64748b",fontSize:13,fontWeight:600},children:"Sections"}),a.jsx("div",{style:{fontWeight:700,color:"#0f172a",whiteSpace:"pre-wrap",marginTop:4},children:G||""})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:16,background:"#fff",boxShadow:"0 2px 4px rgba(0,0,0,0.05)"},children:[a.jsx("div",{style:{fontSize:14,color:"#64748b",marginBottom:10,fontWeight:600},children:" Questions preview"}),a.jsx("div",{style:{maxHeight:240,overflow:"auto"},children:Fe.slice(0,10).map((ce,be)=>a.jsxs("div",{style:{padding:"10px 8px",borderBottom:be<Math.min(Fe.length,10)-1?"1px solid #f1f5f9":"none",display:"flex",gap:12,alignItems:"flex-start"},children:[a.jsx("div",{style:{fontWeight:700,color:"#3b82f6",minWidth:40,background:"#eff6ff",padding:"4px 8px",borderRadius:6,textAlign:"center"},children:be+1}),a.jsxs("div",{style:{flex:1},children:[a.jsx("div",{style:{color:"#1e293b",fontSize:14,lineHeight:1.5},children:String(ce.question_text).slice(0,260)}),Array.isArray(ce.images)&&ce.images.length?a.jsx("div",{style:{display:"flex",gap:10,marginTop:8},children:ce.images.slice(0,2).map((mt,et)=>{const Ue=Z(mt);return Ue?a.jsx("img",{src:Ue,style:{width:90,height:70,objectFit:"cover",borderRadius:8,border:"2px solid #e2e8f0",cursor:"pointer",transition:"all 0.2s ease"},onClick:()=>U(Ue)},et):null})}):null]})]},be))})]})]})]}),ae&&a.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#dc2626",background:"#fef2f2",padding:"12px 16px",borderRadius:10,border:"1px solid #fecaca"},children:[" ",ae]}),W&&a.jsxs("div",{style:{marginTop:16,fontSize:14,color:"#16a34a",background:"#f0fdf4",padding:"12px 16px",borderRadius:10,border:"1px solid #bbf7d0"},children:[" Imported ",W.inserted," question(s)",(Ae=W.failed)!=null&&Ae.length?`, failed ${W.failed.length}.`:"."]})]})]})}),a.jsxs("div",{style:{padding:"16px 24px",borderTop:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",gap:12,background:"#fafbfc"},children:[a.jsx("button",{onClick:()=>h(ce=>ce===1?1:ce-1),disabled:p===1,onMouseEnter:ce=>{p!==1&&(ce.currentTarget.style.background="#f8fafc")},onMouseLeave:ce=>{p!==1&&(ce.currentTarget.style.background="#fff")},style:{padding:"10px 18px",borderRadius:10,border:"1px solid #e2e8f0",background:p===1?"#f1f5f9":"#fff",cursor:p===1?"not-allowed":"pointer",fontWeight:600,fontSize:14,color:p===1?"#94a3b8":"#475569",transition:"all 0.2s ease"},children:" Back"}),a.jsx("div",{style:{display:"flex",gap:10,alignItems:"center"},children:p<3?a.jsx("button",{onClick:()=>{if(ee(null),p===2){if(!k.trim()){ee("Exam name is required.");return}if(!B.trim()){ee("Exam type is required.");return}if(!P.trim()){ee("Exam date is required.");return}}h(ce=>ce+1)},disabled:p===1&&m==="scanning",onMouseEnter:ce=>{p===1&&m==="scanning"||(ce.currentTarget.style.background="linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%)")},onMouseLeave:ce=>{p===1&&m==="scanning"||(ce.currentTarget.style.background="linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)",color:"#fff",fontWeight:700,cursor:"pointer",fontSize:15,boxShadow:"0 2px 8px rgba(37,99,235,0.25)",transition:"all 0.2s ease"},children:"Next "}):a.jsx("button",{onClick:lt,disabled:oe||m==="scanning"||Fe.length===0,onMouseEnter:ce=>{!oe&&m!=="scanning"&&Fe.length>0&&(ce.currentTarget.style.background="linear-gradient(135deg, #15803d 0%, #166534 100%)")},onMouseLeave:ce=>{!oe&&m!=="scanning"&&Fe.length>0&&(ce.currentTarget.style.background="linear-gradient(135deg, #16a34a 0%, #15803d 100%)")},style:{padding:"10px 24px",borderRadius:10,border:"none",background:oe?"#cbd5e1":"linear-gradient(135deg, #16a34a 0%, #15803d 100%)",color:"#fff",fontWeight:800,fontSize:15,cursor:oe?"not-allowed":"pointer",boxShadow:oe?"none":"0 2px 8px rgba(22,163,74,0.25)",transition:"all 0.2s ease"},children:oe?" Importing":" Confirm & Import"})})]})]})}),ie&&a.jsx("div",{role:"dialog",onClick:()=>{U(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.85)",backdropFilter:"blur(4px)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80},children:a.jsx("div",{onClick:ce=>ce.stopPropagation(),style:{maxWidth:"95%",maxHeight:"95%",padding:16,background:"#fff",borderRadius:16,boxShadow:"0 20px 50px rgba(0,0,0,0.5)"},children:a.jsx("img",{src:ie,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:12}})})}),ne&&a.jsx("div",{role:"dialog",onClick:()=>{re(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80,padding:16},children:a.jsxs("div",{onClick:ce=>ce.stopPropagation(),style:{width:"min(900px, 100%)",background:"#fff",borderRadius:12,boxShadow:"0 12px 40px rgba(0,0,0,0.25)",overflow:"hidden",border:"1px solid #e5e7eb"},children:[a.jsxs("div",{style:{padding:"14px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:800,fontSize:16},children:"Uploaded file preview"}),a.jsxs("div",{style:{color:"#6b7280",fontSize:12},children:["Preview of uploaded DOCX  ",ne.name]})]}),a.jsx("button",{onClick:()=>re(null),style:{padding:"6px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:"#fff",cursor:"pointer"},children:"Close"})]}),a.jsx("div",{style:{padding:16},children:a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"280px 1fr",gap:12},children:[a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:64,height:64,borderRadius:8,background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:"#6b7280"},children:i!=null&&i.username?String(i.username).slice(0,1).toUpperCase():"U"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:16,fontWeight:800,color:"#111827"},children:(i==null?void 0:i.username)||""}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:"Faculty"}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:""})]})]}),a.jsxs("div",{style:{marginTop:10,fontSize:12,color:"#6b7280"},children:["Faculty ID: ",a.jsx("strong",{style:{color:"#111827"},children:me??""})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"File details"}),a.jsx("div",{style:{fontWeight:700},children:ne.name}),a.jsx("div",{style:{fontSize:13,color:"#6b7280"},children:ne.path}),a.jsx("div",{style:{marginTop:8},children:a.jsx("a",{href:ne.url,target:"_blank",rel:"noreferrer",style:{color:"#2563eb"},children:"Download file"})})]})]}),a.jsxs("div",{children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,marginBottom:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded file"}),a.jsx("div",{style:{fontSize:20,fontWeight:900,color:"#111827"},children:ne.name})]}),a.jsxs("div",{style:{textAlign:"right"},children:[a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Uploaded path"}),a.jsx("div",{style:{fontWeight:700},children:ne.path})]})]}),a.jsx("div",{style:{marginTop:12,display:"grid",gridTemplateColumns:"1fr",gap:10},children:a.jsxs("div",{children:[a.jsx("span",{style:{color:"#6b7280",fontSize:12},children:"Notes"}),a.jsx("div",{style:{fontWeight:700},children:"This preview shows file metadata. Open the file to view full content or import to parse questions."})]})})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:8},children:"Importer preview"}),a.jsx("div",{style:{maxHeight:260,overflow:"auto"},children:a.jsx("div",{style:{color:"#6b7280"},children:"To see a full questions preview, upload and scan this DOCX using the importer  then the Step 3 confirmation contains the parsed question list."})})]})]})]})})]})}),q&&a.jsx("div",{style:{position:"fixed",left:24,bottom:24,zIndex:120,animation:"slideIn 0.3s ease"},children:a.jsxs("div",{style:{background:"linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%)",color:"#065f46",border:"1px solid #6ee7b7",padding:"16px 20px",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,0.15)"},children:[a.jsx("div",{style:{fontWeight:800,fontSize:16,marginBottom:4},children:" Imported"}),a.jsxs("div",{style:{fontSize:14,color:"#047857"},children:[(W==null?void 0:W.inserted)??0," question(s) imported successfully."]})]})})]})}const qu=[{key:"q1",label:"Q1",max:2,co:1,btl:1},{key:"q2",label:"Q2",max:2,co:1,btl:3},{key:"q3",label:"Q3",max:2,co:1,btl:4},{key:"q4",label:"Q4",max:2,co:2,btl:1},{key:"q5",label:"Q5",max:2,co:2,btl:1},{key:"q6",label:"Q6",max:2,co:2,btl:2},{key:"q7",label:"Q7",max:16,co:1,btl:2},{key:"q8",label:"Q8",max:16,co:2,btl:3},{key:"q9",label:"Q9",max:16,co:"1&2",btl:5}];function _m(e){let t=0,r=0;for(const n of e||[]){const i=Number(n.max||0);n.co==="1&2"?(t+=i/2,r+=i/2):n.co===2?r+=i:t+=i}return{co1:t,co2:r}}function W1(e){const t={1:0,2:0,3:0,4:0,5:0,6:0};for(const r of e||[]){const n=String(r.btl);n in t&&(t[n]+=Number(r.max||0))}return t}function bv(e){var d,f;const t=_m(e.prevQuestions),r=_m(e.nextQuestions),n=W1(e.prevQuestions),i=W1(e.nextQuestions),s=Number((d=e.existingCoMax)==null?void 0:d.co1),o=Number((f=e.existingCoMax)==null?void 0:f.co2),l=!Number.isFinite(s)||s===t.co1?r.co1:Math.max(0,s),c=!Number.isFinite(o)||o===t.co2?r.co2:Math.max(0,o),u={...i};return["1","2","3","4","5","6"].forEach(p=>{var m;const h=Number((m=e.existingBtlMax)==null?void 0:m[p]);Number.isFinite(h)&&h!==n[p]&&(u[p]=Math.max(0,h))}),{coMax:{co1:l,co2:c},btlMax:u}}const vk={termLabel:"KRCT AY25-26",assessments:{ssa1:{maxTotal:20,coMax:{co1:10,co2:10},btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},formative1:{maxPart:5,maxTotal:20,maxCo:10,btlMax:{1:0,2:0,3:10,4:10,5:0,6:0}},cia1:{questions:qu,coMax:_m(qu),btlMax:W1(qu)}}},hOe=Array.from({length:11},(e,t)=>`PO${t+1}`);function pOe(e,t){const r=Fc(t),n=e==null?void 0:e[r];return Array.isArray(n)&&n.length===11?n:Array.from({length:11},()=>!1)}function mOe(){var R,M,B,E,P,D,G,H,oe,de,W,V,ae,ee,C,Y,q,O,X,F;const[e,t]=x.useState({}),[r,n]=x.useState(vk),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState("assessments"),[d,f]=x.useState({}),[p,h]=x.useState(""),[m,g]=x.useState(""),[y,b]=x.useState("");x.useEffect(()=>{let Q=!0;return(async()=>{try{const K=await AN();Q&&t(K||{})}catch(K){Q&&l((K==null?void 0:K.message)||"Failed to load global mapping")}})(),()=>{Q=!1}},[]),x.useEffect(()=>{let Q=!0;return(async()=>{var K,ne,re,T,I,ie,U;try{const Z=await oc();if(!Q)return;const me={...vk,...Z||{},assessments:{...vk.assessments||{},...(Z==null?void 0:Z.assessments)||{}}},Pe=((ne=(K=me.assessments)==null?void 0:K.cia1)==null?void 0:ne.questions)||[],je=Array.isArray(Pe)&&Pe.length?Pe:qu,Fe=_m(je),_e=W1(je),He=(T=(re=me.assessments)==null?void 0:re.cia1)==null?void 0:T.coMax,qe=Number(He==null?void 0:He.co1),Pt=Number(He==null?void 0:He.co2),ut=(ie=(I=me.assessments)==null?void 0:I.cia1)==null?void 0:ie.btlMax,Ke=lt=>{const ve=Number(ut==null?void 0:ut[lt]);return Number.isFinite(ve)?Math.max(0,ve):_e[lt]};me.assessments={...me.assessments||{},cia1:{...((U=me.assessments)==null?void 0:U.cia1)||{},questions:je,coMax:{co1:Number.isFinite(qe)?Math.max(0,qe):Fe.co1,co2:Number.isFinite(Pt)?Math.max(0,Pt):Fe.co2},btlMax:{1:Ke("1"),2:Ke("2"),3:Ke("3"),4:Ke("4"),5:Ke("5"),6:Ke("6")}}},n(me)}catch(Z){Q&&l((Z==null?void 0:Z.message)||"Failed to load assessment master config")}})(),()=>{Q=!1}},[]);const v=x.useMemo(()=>Bm.map(Q=>({label:Q,key:Fc(Q),values:pOe(e,Q)})),[e]),w=(Q,K,ne)=>{const re=Fc(Q);t(T=>{const I=Array.isArray(T==null?void 0:T[re])?[...T[re]]:Array.from({length:11},()=>!1);return I[K]=ne,{...T,[re]:I}})},S=async()=>{s(!0),l(null);try{c==="po"?(await $9(e),l("Saved global mapping.")):(await U9(r),l("Saved assessment master config."))}catch(Q){l((Q==null?void 0:Q.message)||"Failed to save global mapping")}finally{s(!1)}},j=x.useMemo(()=>{var K,ne;const Q=(ne=(K=r==null?void 0:r.assessments)==null?void 0:K.cia1)==null?void 0:ne.questions;return Array.isArray(Q)&&Q.length?Q:qu},[r]),k=x.useMemo(()=>j.filter(Q=>d[Q.key]),[j,d]),A=()=>{k.length&&n(Q=>{var T,I,ie,U,Z,me,Pe;const K=(((I=(T=Q.assessments)==null?void 0:T.cia1)==null?void 0:I.questions)||qu).slice(),ne=K.map(je=>{if(!d[je.key])return je;const Fe={...je};return p!==""&&Number.isFinite(Number(p))&&(Fe.max=Math.max(0,Number(p))),(m==="1"||m==="2")&&(Fe.co=Number(m)),m==="1&2"&&(Fe.co="1&2"),y&&["1","2","3","4","5","6"].includes(y)&&(Fe.btl=Number(y)),Fe}),re=bv({prevQuestions:K,nextQuestions:ne,existingCoMax:(U=(ie=Q.assessments)==null?void 0:ie.cia1)==null?void 0:U.coMax,existingBtlMax:(me=(Z=Q.assessments)==null?void 0:Z.cia1)==null?void 0:me.btlMax});return{...Q,assessments:{...Q.assessments||{},cia1:{...((Pe=Q.assessments)==null?void 0:Pe.cia1)||{},questions:ne,coMax:re.coMax,btlMax:re.btlMax}}}})};return a.jsx("main",{className:"obe-master-page",style:{padding:0,fontFamily:"Arial, sans-serif",minHeight:"100vh",background:"#fff"},children:a.jsxs("div",{style:{padding:"0px",width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsxs("div",{style:{marginBottom:16},children:[a.jsx("h2",{style:{margin:0},children:"OBE Master"}),a.jsx("div",{style:{color:"#666",marginTop:4},children:"Global settings for OBE pages"})]}),a.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12,flexWrap:"wrap"},children:[a.jsx("button",{onClick:()=>u("assessments"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="assessments"?"#111827":"#fff",color:c==="assessments"?"#fff":"#111827"},children:"Assessment Headers"}),a.jsx("button",{onClick:()=>u("po"),style:{padding:"8px 10px",borderRadius:8,border:"1px solid #e5e7eb",background:c==="po"?"#111827":"#fff",color:c==="po"?"#fff":"#111827"},children:"Active Learning PO Mapping"})]}),o&&a.jsx("div",{style:{marginBottom:12,fontSize:12,color:o.startsWith("Saved")?"#166534":"#b91c1c"},children:o}),c==="po"?a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:12,background:"#fff"},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:900},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"left",background:"#f8fafc"},children:"Activity"}),hOe.map(Q=>a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,textAlign:"center",background:"#fff7ed"},children:Q},Q))]})}),a.jsx("tbody",{children:v.map((Q,K)=>a.jsxs("tr",{style:{background:K%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,fontWeight:600},children:Q.label}),Q.values.map((ne,re)=>a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!ne,onChange:T=>w(Q.label,re,T.target.checked)})},`${Q.key}-${re}`))]},Q.key))})]})}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Global Term Label"}),a.jsx("input",{value:r.termLabel??"",onChange:Q=>n(K=>({...K,termLabel:Q.target.value})),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db",width:260}})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"SSA1 Headers"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:12},children:["Total Max",a.jsx("input",{type:"number",value:String(((M=(R=r.assessments)==null?void 0:R.ssa1)==null?void 0:M.maxTotal)??20),onChange:Q=>n(K=>{var ne;return{...K,assessments:{...K.assessments||{},ssa1:{...((ne=K.assessments)==null?void 0:ne.ssa1)||{},maxTotal:Number(Q.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO1 Max",a.jsx("input",{type:"number",value:String(((P=(E=(B=r.assessments)==null?void 0:B.ssa1)==null?void 0:E.coMax)==null?void 0:P.co1)??10),onChange:Q=>n(K=>{var ne,re,T;return{...K,assessments:{...K.assessments||{},ssa1:{...((ne=K.assessments)==null?void 0:ne.ssa1)||{},coMax:{...((T=(re=K.assessments)==null?void 0:re.ssa1)==null?void 0:T.coMax)||{},co1:Number(Q.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO2 Max",a.jsx("input",{type:"number",value:String(((H=(G=(D=r.assessments)==null?void 0:D.ssa1)==null?void 0:G.coMax)==null?void 0:H.co2)??10),onChange:Q=>n(K=>{var ne,re,T;return{...K,assessments:{...K.assessments||{},ssa1:{...((ne=K.assessments)==null?void 0:ne.ssa1)||{},coMax:{...((T=(re=K.assessments)==null?void 0:re.ssa1)==null?void 0:T.coMax)||{},co2:Number(Q.target.value||0)}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"Formative 1 Headers"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("label",{style:{fontSize:12},children:["Part Max",a.jsx("input",{type:"number",value:String(((de=(oe=r.assessments)==null?void 0:oe.formative1)==null?void 0:de.maxPart)??5),onChange:Q=>n(K=>{var ne;return{...K,assessments:{...K.assessments||{},formative1:{...((ne=K.assessments)==null?void 0:ne.formative1)||{},maxPart:Number(Q.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["Total Max",a.jsx("input",{type:"number",value:String(((V=(W=r.assessments)==null?void 0:W.formative1)==null?void 0:V.maxTotal)??20),onChange:Q=>n(K=>{var ne;return{...K,assessments:{...K.assessments||{},formative1:{...((ne=K.assessments)==null?void 0:ne.formative1)||{},maxTotal:Number(Q.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO Max",a.jsx("input",{type:"number",value:String(((ee=(ae=r.assessments)==null?void 0:ae.formative1)==null?void 0:ee.maxCo)??10),onChange:Q=>n(K=>{var ne;return{...K,assessments:{...K.assessments||{},formative1:{...((ne=K.assessments)==null?void 0:ne.formative1)||{},maxCo:Number(Q.target.value||0)}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}})]})]})]}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[a.jsx("div",{style:{fontWeight:800,marginBottom:10},children:"CIA 1"}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"stretch",marginBottom:12},children:[a.jsxs("div",{style:{flex:"1 1 360px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fbfdff"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"CIA1 Limits"}),a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:10},children:[a.jsxs("label",{style:{fontSize:12},children:["CO-1 Max",a.jsx("input",{type:"number",value:String(((q=(Y=(C=r.assessments)==null?void 0:C.cia1)==null?void 0:Y.coMax)==null?void 0:q.co1)??_m(j).co1),onChange:Q=>n(K=>{var ne,re,T;return{...K,assessments:{...K.assessments||{},cia1:{...((ne=K.assessments)==null?void 0:ne.cia1)||{},coMax:{...(T=(re=K.assessments)==null?void 0:re.cia1)==null?void 0:T.coMax,co1:Math.max(0,Number(Q.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]}),a.jsxs("label",{style:{fontSize:12},children:["CO-2 Max",a.jsx("input",{type:"number",value:String(((F=(X=(O=r.assessments)==null?void 0:O.cia1)==null?void 0:X.coMax)==null?void 0:F.co2)??_m(j).co2),onChange:Q=>n(K=>{var ne,re,T;return{...K,assessments:{...K.assessments||{},cia1:{...((ne=K.assessments)==null?void 0:ne.cia1)||{},coMax:{...(T=(re=K.assessments)==null?void 0:re.cia1)==null?void 0:T.coMax,co2:Math.max(0,Number(Q.target.value||0))}}}}}),style:{marginLeft:8,padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})]})]}),a.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:6},children:"BTL Max Marks (1 to 6)"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, minmax(70px, 1fr))",gap:8},children:["1","2","3","4","5","6"].map(Q=>{var K,ne,re;return a.jsxs("label",{style:{fontSize:12,display:"flex",flexDirection:"column",gap:4},children:[a.jsxs("span",{style:{color:"#111827"},children:["BTL-",Q]}),a.jsx("input",{type:"number",value:String(((re=(ne=(K=r.assessments)==null?void 0:K.cia1)==null?void 0:ne.btlMax)==null?void 0:re[Q])??W1(j)[Q]),onChange:T=>n(I=>{var ie,U,Z;return{...I,assessments:{...I.assessments||{},cia1:{...((ie=I.assessments)==null?void 0:ie.cia1)||{},btlMax:{...((Z=(U=I.assessments)==null?void 0:U.cia1)==null?void 0:Z.btlMax)||{},[Q]:Math.max(0,Number(T.target.value||0))}}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",textAlign:"center"}})]},Q)})})]}),a.jsxs("div",{style:{flex:"2 1 520px",border:"1px solid #eef2f7",borderRadius:12,padding:12,background:"#fff"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",gap:12,flexWrap:"wrap",alignItems:"center"},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:700},children:"CIA1 Question Headers"}),a.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"Select question rows and apply Max / CO / BTL in bulk."})]}),a.jsxs("div",{style:{display:"flex",gap:8,flexWrap:"wrap",alignItems:"center"},children:[a.jsx("input",{placeholder:"Max",value:p,onChange:Q=>h(Q.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90}}),a.jsxs("select",{value:m,onChange:Q=>g(Q.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",children:"CO"}),a.jsx("option",{value:"1",children:"CO-1"}),a.jsx("option",{value:"2",children:"CO-2"}),a.jsx("option",{value:"1&2",children:"CO-1&CO-2 (split)"})]}),a.jsxs("select",{value:y,onChange:Q=>b(Q.target.value),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",children:"BTL"}),[1,2,3,4,5,6].map(Q=>a.jsxs("option",{value:String(Q),children:["BTL-",Q]},Q))]}),a.jsxs("button",{onClick:A,disabled:!k.length,style:{padding:"8px 10px"},children:["Apply to Selected (",k.length,")"]})]})]}),a.jsx("div",{style:{overflowX:"auto",marginTop:10,border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:720},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Sel"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Key"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"left"},children:"Label"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"Max"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"CO"}),a.jsx("th",{style:{borderBottom:"1px solid #e5e7eb",padding:10,background:"#f8fafc",textAlign:"center"},children:"BTL"})]})}),a.jsx("tbody",{children:j.map((Q,K)=>a.jsxs("tr",{style:{background:K%2===0?"#fff":"#f9fafb"},children:[a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"checkbox",checked:!!d[Q.key],onChange:ne=>f(re=>({...re,[Q.key]:ne.target.checked}))})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:Q.key}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10},children:a.jsx("input",{value:Q.label,onChange:ne=>n(re=>{var ie,U,Z;const I=(((U=(ie=re.assessments)==null?void 0:ie.cia1)==null?void 0:U.questions)||qu).slice().map(me=>me.key===Q.key?{...me,label:ne.target.value}:me);return{...re,assessments:{...re.assessments||{},cia1:{...((Z=re.assessments)==null?void 0:Z.cia1)||{},questions:I}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:"100%"}})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("input",{type:"number",value:String(Q.max),onChange:ne=>n(re=>{var Z,me,Pe,je,Fe,_e,He;const T=Math.max(0,Number(ne.target.value||0)),I=(((me=(Z=re.assessments)==null?void 0:Z.cia1)==null?void 0:me.questions)||qu).slice(),ie=I.map(qe=>qe.key===Q.key?{...qe,max:T}:qe),U=bv({prevQuestions:I,nextQuestions:ie,existingCoMax:(je=(Pe=re.assessments)==null?void 0:Pe.cia1)==null?void 0:je.coMax,existingBtlMax:(_e=(Fe=re.assessments)==null?void 0:Fe.cia1)==null?void 0:_e.btlMax});return{...re,assessments:{...re.assessments||{},cia1:{...((He=re.assessments)==null?void 0:He.cia1)||{},questions:ie,coMax:U.coMax,btlMax:U.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db",width:90,textAlign:"center"}})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsxs("select",{value:String(Q.co),onChange:ne=>n(re=>{var me,Pe,je,Fe,_e,He,qe;const T=String(ne.target.value),I=T==="1&2"?"1&2":Number(T)===2?2:1,ie=(((Pe=(me=re.assessments)==null?void 0:me.cia1)==null?void 0:Pe.questions)||qu).slice(),U=ie.map(Pt=>Pt.key===Q.key?{...Pt,co:I}:Pt),Z=bv({prevQuestions:ie,nextQuestions:U,existingCoMax:(Fe=(je=re.assessments)==null?void 0:je.cia1)==null?void 0:Fe.coMax,existingBtlMax:(He=(_e=re.assessments)==null?void 0:_e.cia1)==null?void 0:He.btlMax});return{...re,assessments:{...re.assessments||{},cia1:{...((qe=re.assessments)==null?void 0:qe.cia1)||{},questions:U,coMax:Z.coMax,btlMax:Z.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"1",children:"1"}),a.jsx("option",{value:"2",children:"2"}),a.jsx("option",{value:"1&2",children:"1&2"})]})}),a.jsx("td",{style:{borderTop:"1px solid #f1f5f9",padding:10,textAlign:"center"},children:a.jsx("select",{value:String(Q.btl),onChange:ne=>n(re=>{var Z,me,Pe,je,Fe,_e,He;const T=Math.min(6,Math.max(1,Number(ne.target.value||1))),I=(((me=(Z=re.assessments)==null?void 0:Z.cia1)==null?void 0:me.questions)||qu).slice(),ie=I.map(qe=>qe.key===Q.key?{...qe,btl:T}:qe),U=bv({prevQuestions:I,nextQuestions:ie,existingCoMax:(je=(Pe=re.assessments)==null?void 0:Pe.cia1)==null?void 0:je.coMax,existingBtlMax:(_e=(Fe=re.assessments)==null?void 0:Fe.cia1)==null?void 0:_e.btlMax});return{...re,assessments:{...re.assessments||{},cia1:{...((He=re.assessments)==null?void 0:He.cia1)||{},questions:ie,coMax:U.coMax,btlMax:U.btlMax}}}}),style:{padding:6,borderRadius:8,border:"1px solid #d1d5db"},children:[1,2,3,4,5,6].map(ne=>a.jsx("option",{value:String(ne),children:ne},ne))})})]},Q.key))})]})})]})]})]})]}),a.jsx("div",{style:{marginTop:16,display:"flex",gap:12},children:a.jsx("button",{onClick:S,disabled:i,style:{padding:"10px 14px",borderRadius:8,border:"1px solid #2563eb",background:"#2563eb",color:"#fff",fontWeight:600,cursor:"pointer"},children:i?"Saving...":c==="po"?"Save Global PO Mapping":"Save Assessment Headers"})})]})})}function gOe(){var u,d;const e=hl(),r=x.useMemo(()=>new URLSearchParams(e.search),[e.search]).get("tab")||"obe",[n,i]=x.useState(r),s=((u=window.__APP_ME__)==null?void 0:u.permissions)||((d=window.__ME__)==null?void 0:d.permissions)||[],l=(Array.isArray(s)?s.map(f=>String(f||"").toLowerCase()):[]).includes("obe.master.manage"),c=x.useMemo(()=>{const f=[];return f.push({key:"obe",label:"OBE"}),l&&(f.push({key:"obe_master",label:"OBE Master"}),f.push({key:"due_dates",label:"OBE: Due Dates"})),f},[l]);return Jr.useEffect(()=>{var f;c.some(p=>p.key===n)||i(((f=c[0])==null?void 0:f.key)||"obe")},[c,n]),x.useEffect(()=>{const f=new URLSearchParams(e.search).get("tab");f&&c.some(p=>p.key===f)&&f!==n&&i(f)},[e.search]),a.jsxs("main",{style:{padding:18,minHeight:"100vh",fontFamily:"Arial, sans-serif"},children:[a.jsxs("div",{style:{marginBottom:12},children:[a.jsx("h2",{style:{margin:0,fontSize:20},children:"Academic"}),a.jsx("div",{style:{color:"#6b7280",marginTop:6},children:"Quick access to OBE tools."})]}),a.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:18},children:c.map(f=>a.jsx("button",{onClick:()=>i(f.key),style:{padding:"8px 12px",borderRadius:8,border:n===f.key?"1px solid #10b981":"1px solid #e5e7eb",background:n===f.key?"#ecfdf5":"#fff",fontWeight:700,cursor:"pointer"},children:f.label},f.key))}),a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:12,padding:12,background:"#fff"},children:[n==="obe"&&a.jsx(LK,{}),n==="obe_master"&&l&&a.jsx(mOe,{}),n==="due_dates"&&l&&a.jsx(jN,{})]})]})}const xOe="https://db.krgi.co.in",GF=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?"http://localhost:8000":xOe;function KF(){const e=window.localStorage.getItem("access");return e?{Authorization:`Bearer ${e}`}:{}}function yOe(){var M,B;const[e,t]=x.useState(null),[r,n]=x.useState(!1),[i,s]=x.useState(null),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(""),[p,h]=x.useState("pending"),[m,g]=x.useState(!1),[y,b]=x.useState(null),[v,w]=x.useState(null),[S,j]=x.useState(null),k=x.useMemo(()=>o.filter(E=>{const P=String(E.marks??"").trim().toUpperCase(),D=String(E.btl??"").trim().toUpperCase(),G=String(E.course_outcomes??"").trim().toUpperCase();return!(P==="(OR)"&&D==="(OR)"&&G==="(OR)")}),[o]);async function A(){if(!e){s("Please select a .docx file first.");return}n(!0),s(null),b(null),w(null);const E=new FormData;E.append("file",e);try{const P=await fetch(`${GF}/api/template/scan-docx`,{method:"POST",headers:{...KF()},body:E});if(!P.ok){const H=await P.text();s(H||`Scan failed (${P.status})`),l([]);return}const D=await P.json(),G=Array.isArray(D==null?void 0:D.questions)?D.questions:[];u((D==null?void 0:D.debug)??null);try{console.debug("scan_docx response: questions=",G.length,"sample=",G[0]?{q0:G[0].question_text,imgs:(G[0].images||[]).slice(0,2)}:null),G.length&&G.forEach((H,oe)=>{console.log(`Q#${oe+1} images:`,Array.isArray(H.images)?H.images.map(de=>typeof de=="string"?de.slice(0,80):typeof de):H.images)})}catch(H){console.warn("scan_docx debug log failed",H)}l(G)}catch(P){s((P==null?void 0:P.message)||"Scan failed"),l([])}finally{n(!1)}}async function R(){if(!d.trim()){w("Title is required to import.");return}g(!0),w(null),b(null);try{const E={title:d.trim(),status:p,questions:k},P=await fetch(`${GF}/api/import/questions`,{method:"POST",headers:{"Content-Type":"application/json",...KF()},body:JSON.stringify(E)});if(!P.ok){const G=await P.text();w(G||`Import failed (${P.status})`);return}const D=await P.json();b(D)}catch(E){w((E==null?void 0:E.message)||"Import failed")}finally{g(!1)}}return a.jsxs("div",{style:{maxWidth:1100,margin:"0 auto",padding:24},children:[a.jsx("h1",{style:{marginTop:0},children:"Question Import"}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{type:"file",accept:".docx",onChange:E=>{var P;return t(((P=E.target.files)==null?void 0:P[0])||null)}}),a.jsx("button",{onClick:A,disabled:r||!e,children:r?"Scanning":"Scan DOCX"}),a.jsx("div",{style:{color:"#666",fontSize:13},children:o.length?`${o.length} scanned (${k.length} visible)`:""})]}),i&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:i}),c&&a.jsxs("div",{style:{marginTop:10,padding:10,background:"#f8fafc",border:"1px solid #e6eef8",borderRadius:8},children:[a.jsx("div",{style:{fontSize:13,color:"#0747a6",fontWeight:700},children:"Scan debug"}),a.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Questions parsed: ",c.parsed_questions??"-"]}),a.jsxs("div",{style:{fontSize:13,color:"#333"},children:["Total images: ",c.total_images??0]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample questions: ",Array.isArray(c.sample_questions)?c.sample_questions.join(" | "):"-"]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["Sample image prefix: ",a.jsx("code",{style:{background:"#fff",padding:"2px 6px",borderRadius:4},children:String(c.sample_image_prefix||"").slice(0,200)})]}),a.jsxs("div",{style:{fontSize:12,color:"#666",marginTop:6},children:["First questions' images (raw):",a.jsx("pre",{style:{whiteSpace:"pre-wrap",maxHeight:160,overflow:"auto",background:"#fff",padding:8,borderRadius:6},children:JSON.stringify(o.slice(0,3).map(E=>E.images),null,2)})]})]}),a.jsx("hr",{style:{margin:"20px 0"}}),a.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[a.jsx("input",{value:d,onChange:E=>f(E.target.value),placeholder:"Title (e.g., Midterm 2026)",style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6,minWidth:260}}),a.jsxs("select",{value:p,onChange:E=>h(E.target.value),style:{padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:6},children:[a.jsx("option",{value:"pending",children:"pending"}),a.jsx("option",{value:"approved",children:"approved"})]}),a.jsx("button",{onClick:R,disabled:m||k.length===0,children:m?"Importing":"Import to Bank"})]}),v&&a.jsx("div",{style:{marginTop:10,color:"#b91c1c"},children:v}),y&&a.jsxs("div",{style:{marginTop:10,color:"#166534"},children:["Imported ",y.inserted," question(s)",(M=y.failed)!=null&&M.length?`, ${y.failed.length} failed.`:"."]}),(B=y==null?void 0:y.failed)!=null&&B.length?a.jsxs("div",{style:{marginTop:10},children:[a.jsx("h3",{style:{margin:"10px 0"},children:"Failures"}),a.jsx("ul",{children:y.failed.map(E=>a.jsxs("li",{style:{color:"#b91c1c"},children:["#",E.index+1,": ",E.error]},E.index))})]}):null,a.jsx("hr",{style:{margin:"20px 0"}}),a.jsx("h2",{style:{margin:"10px 0"},children:"Preview"}),k.length===0?a.jsx("div",{style:{color:"#666"},children:"No questions to preview yet."}):a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:12},children:[k.slice(0,50).map((E,P)=>a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:10,padding:14},children:[a.jsxs("div",{style:{fontWeight:700,marginBottom:6},children:[P+1,". ",E.question_text]}),a.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",color:"#555",fontSize:13,marginBottom:8},children:[E.marks!=null&&a.jsxs("span",{children:["Marks: ",String(E.marks)]}),E.btl!=null&&a.jsxs("span",{children:["BTL: ",String(E.btl)]}),E.course_outcomes&&a.jsxs("span",{children:["CO: ",E.course_outcomes]}),E.chapter&&a.jsxs("span",{children:["Chapter: ",E.chapter]})]}),Array.isArray(E.options)&&E.options.length?a.jsx("ol",{type:"a",style:{marginTop:0},children:E.options.map((D,G)=>a.jsx("li",{children:String(D)},G))}):null,E.correct_answer?a.jsxs("div",{style:{marginTop:6,color:"#111",fontSize:13},children:[a.jsx("strong",{children:"Answer:"})," ",E.correct_answer]}):null,E.answer_text?a.jsxs("div",{style:{marginTop:4,color:"#444",fontSize:13},children:[a.jsx("strong",{children:"Explanation:"})," ",E.answer_text]}):null,Array.isArray(E.images)&&E.images.length?a.jsx("div",{style:{marginTop:10,display:"flex",gap:10,flexWrap:"wrap"},children:E.images.slice(0,6).map((D,G)=>{let H=null;try{if(typeof D=="string")H=D,!H.startsWith("data:")&&/^[A-Za-z0-9+/=\n\r]+$/.test(H)&&H.length>100&&(H=`data:image/png;base64,${H.replace(/\s+/g,"")}`);else if(D&&typeof D=="object"){if(D.url)H=D.url;else if(D.base64)H=D.base64.startsWith("data:")?D.base64:`data:image/png;base64,${D.base64}`;else if(D.binary&&D.binary instanceof Uint8Array){const oe=new Blob([D.binary],{type:"image/png"});H=URL.createObjectURL(oe)}}else if(D instanceof Uint8Array){const oe=new Blob([D],{type:"image/png"});H=URL.createObjectURL(oe)}}catch{H=null}return H?a.jsx("img",{src:H,alt:`q${P+1}-img${G+1}`,onClick:()=>j(H),style:{maxHeight:140,borderRadius:8,border:"1px solid #eee",cursor:"pointer",objectFit:"contain"}},G):null})}):null]},P)),k.length>50&&a.jsx("div",{style:{color:"#666"},children:"Showing first 50 questions."})]}),S&&a.jsx("div",{role:"dialog",onClick:()=>{j(null)},style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:60},children:a.jsx("div",{onClick:E=>E.stopPropagation(),style:{maxWidth:"90%",maxHeight:"90%",padding:12},children:a.jsx("img",{src:S,alt:"preview",style:{maxWidth:"100%",maxHeight:"100%",borderRadius:8}})})})]})}function bOe({courseId:e,classType:t,questionPaperType:r,enabledAssessments:n}){const[i,s]=x.useState(e||""),[o,l]=x.useState(!1);return x.useEffect(()=>{e&&e!==i&&s(e),!e&&i&&s("")},[e]),a.jsx("div",{style:{minHeight:"100vh",background:"linear-gradient(135deg, #ecfdf5 0%, #ffffff 60%)",padding:"0"},children:a.jsxs("div",{style:{background:"#ffffff",minHeight:"100vh",display:"flex",flexDirection:"column"},children:[a.jsxs("div",{style:{background:"linear-gradient(135deg, #10b981, #059669)",color:"#ffffff",padding:"20px 24px",flexShrink:0},children:[a.jsx("div",{style:{fontSize:24,fontWeight:800},children:"Mark Entry"}),a.jsxs("div",{style:{fontSize:14,opacity:.9},children:[" ",i?`Course: ${i}`:"No course selected"," "]})]}),a.jsxs("div",{style:{padding:"20px 24px",flex:1},children:[!e&&a.jsxs("div",{className:"obe-card",style:{marginBottom:12},children:[a.jsx("label",{style:{display:"block",fontSize:12,fontWeight:700,color:"#065f46",textTransform:"uppercase",letterSpacing:"0.03em"},children:"Course ID"}),a.jsx("input",{value:i,onChange:c=>s(c.target.value),placeholder:"Enter course id",className:"obe-input",style:{marginTop:6,...o?{boxShadow:"0 0 0 3px rgba(16,185,129,0.2)",borderColor:"#a7f3d0"}:{}},onFocus:()=>l(!0),onBlur:()=>l(!1)})]}),i?a.jsx(N6,{subjectId:i,classType:t,questionPaperType:r,enabledAssessments:n}):a.jsx("div",{style:{background:"#d1fae5",border:"1px solid #a7f3d0",color:"#065f46",fontSize:14,padding:12,borderRadius:10},children:"Select a course to start mark entry."})]})]})})}const Pc={header:["CO1","CO1","CO1","CO2","CO2","CO2","CO3","CO3","CO3","CO4","CO4","CO4","CO1","CO2","CO3","CO4","CO5"],weights:[1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,1.5,3,2.5,2,2,2,2,4],cycles:["ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ssa","cia","fa","ME","ME","ME","ME","ME"]},vOe=[{key:"q1",max:2,co:1},{key:"q2",max:2,co:1},{key:"q3",max:2,co:1},{key:"q4",max:2,co:2},{key:"q5",max:2,co:2},{key:"q6",max:2,co:2},{key:"q7",max:16,co:1},{key:"q8",max:16,co:2},{key:"q9",max:16,co:"1&2"}],wOe=[{key:"q1",max:2,co:3},{key:"q2",max:2,co:3},{key:"q3",max:2,co:3},{key:"q4",max:2,co:4},{key:"q5",max:2,co:4},{key:"q6",max:2,co:4},{key:"q7",max:16,co:3},{key:"q8",max:16,co:4},{key:"q9",max:16,co:"3&4"}],SOe=[{key:"q1",max:2},{key:"q2",max:2},{key:"q3",max:2},{key:"q4",max:2},{key:"q5",max:2},{key:"q6",max:2},{key:"q7",max:2},{key:"q8",max:2},{key:"q9",max:2},{key:"q10",max:2},{key:"q11",max:14},{key:"q12",max:14},{key:"q13",max:14},{key:"q14",max:14},{key:"q15",max:14},{key:"q16",max:10}],vv=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5,5];function ui(e,t,r){return Math.max(t,Math.min(r,e))}function Wf(e){return Math.round(e*100)/100}function Po(e){if(e===""||e==null)return null;const t=Number(e);return Number.isFinite(t)?t:null}function YF(e,t){const r=String((e==null?void 0:e.name)||"").trim().toLowerCase(),n=String((t==null?void 0:t.name)||"").trim().toLowerCase();if(r&&n){const o=r.localeCompare(n);if(o)return o}else if(r||n)return r?-1:1;const i=String((e==null?void 0:e.reg_no)||"").trim(),s=String((t==null?void 0:t.reg_no)||"").trim();return i.localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}function _Oe(e){return e==="1&2"?{co1:.5,co2:.5}:e===2?{co1:0,co2:1}:{co1:1,co2:0}}function jOe(e){return e==="3&4"?{co3:.5,co4:.5}:e===4?{co3:0,co4:1}:{co3:1,co4:0}}function wk(e){if(e==="both"||e==="1&2")return"1&2";if(Array.isArray(e)){const r=e.map(s=>String(s??"").trim().toUpperCase());if(r.some(s=>s==="BOTH"))return"1&2";const n=r.some(s=>s==="1"||s==="CO1"),i=r.some(s=>s==="2"||s==="CO2");return n&&i?"1&2":i?2:1}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2")return"1&2";if(r==="2"||r==="CO2")return 2;if(r==="1"||r==="CO1")return 1}const t=Number(e);return t===2?2:t===12?"1&2":1}function Sk(e){if(e==="both"||e==="3&4")return"3&4";if(Array.isArray(e)){const r=e.map(l=>String(l??"").trim().toUpperCase());if(r.some(l=>l==="BOTH"))return"3&4";const n=r.some(l=>l==="1"||l==="CO1"),i=r.some(l=>l==="2"||l==="CO2"),s=r.some(l=>l==="3"||l==="CO3"),o=r.some(l=>l==="4"||l==="CO4");return s&&o||n&&i?"3&4":o||i?4:3}if(typeof e=="string"){const r=e.trim().toUpperCase();if(r==="BOTH"||r==="1&2"||r==="1,2"||r==="1/2"||r==="2/1"||r==="CO1&CO2"||r==="CO1,CO2"||r==="3&4"||r==="3,4"||r==="3/4"||r==="4/3"||r==="CO3&CO4"||r==="CO3,CO4")return"3&4";if(r==="4"||r==="CO4")return 4;if(r==="3"||r==="CO3")return 3;if(r==="2"||r==="CO2")return 4;if(r==="1"||r==="CO1")return 3}const t=Number(e);return t===4?4:t===34?"3&4":t===2?4:t===1?3:t===12?"3&4":3}function _k(e,t){const r=e[t];if(!r)return{co1:0,co2:0};if(r.co==="1&2")return{co1:.5,co2:.5};const n=e.some(o=>o.co==="1&2"),i=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&i&&s?{co1:.5,co2:.5}:_Oe(r.co)}function jk(e,t){const r=e[t];if(!r)return{co3:0,co4:0};if(r.co==="3&4")return{co3:.5,co4:.5};const n=e.some(o=>o.co==="3&4"),i=t===e.length-1,s=String(r.key||"").trim().toLowerCase()==="q9";return!n&&i&&s?{co3:.5,co4:.5}:jOe(r.co)}function XF(e,t,r,n){const i=Number(e),s=Number(t),o=Number(r),l=Number(n),c=(Number.isFinite(s)?s:0)+(Number.isFinite(o)?o:0)+(Number.isFinite(l)?l:0);if(!Number.isFinite(i)||i<=0||!c)return[0,0,0];const u=Wf(i*(s||0)/c),d=Wf(i*(o||0)/c),f=Wf(i*(l||0)/c);return[u,d,f]}function kOe(e,t){const r=ti(e),n=Pc.header,i=Pc.cycles,s=["CO1-SSA","CO1-CIA","CO1-FA","CO2-SSA","CO2-CIA","CO2-FA","CO3-SSA","CO3-CIA","CO3-FA","CO4-SSA","CO4-CIA","CO4-FA","ME-CO1","ME-CO2","ME-CO3","ME-CO4","ME-CO5"];let o=Array.from({length:17},(p,h)=>h),l=[...i],c=[...s];if(r==="TCPR"&&(l=l.map((p,h)=>h===2||h===5||h===8||h===11?"review":p),c=c.map((p,h)=>h===2||h===5||h===8||h===11?p.replace("-FA","-Review"):p)),r==="TCPL"&&(l=l.map((p,h)=>h===2||h===5||h===8||h===11?"lab":p),c=c.map((p,h)=>h===2||h===5?p.replace("-FA","-LAB1"):h===8||h===11?p.replace("-FA","-LAB2"):p)),r==="LAB"||r==="PRACTICAL")return o=[1,4,7,10,16],{visible:o,header:["CO1","CO2","CO3","CO4","ME"],cycles:["CIA 1","CIA 1","CIA 2","CIA 2","MODEL"],labels:["CO1-CIA1","CO2-CIA1","CO3-CIA2","CO4-CIA2","ME-CO5"]};if(r==="SPECIAL"&&t.size){const p=[],h=(m,g)=>{if(m)for(const y of g)p.push(y)};h(t.has("ssa1"),[0,3]),h(t.has("cia1"),[1,4]),h(t.has("formative1"),[2,5]),h(t.has("ssa2"),[6,9]),h(t.has("cia2"),[7,10]),h(t.has("formative2"),[8,11]),o=p}const u=o.map(p=>n[p]),d=o.map(p=>l[p]),f=o.map(p=>c[p]);return{visible:o,header:u,cycles:d,labels:f}}function AOe({courseId:e,enabledAssessments:t}){const r=x.useMemo(()=>new Set((t||[]).map(T=>String(T||"").trim().toLowerCase()).filter(Boolean)),[t]),[n,i]=x.useState([]),[s,o]=x.useState(null),[l,c]=x.useState(null),[u,d]=x.useState(null),[f,p]=x.useState(null),[h,m]=x.useState([]),[g,y]=x.useState(null),[b,v]=x.useState(!1),[w,S]=x.useState({ssa1:1.5,cia1:3,formative1:2.5}),[j,k]=x.useState([...Pc.weights]),[A,R]=x.useState({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null}),[M,B]=x.useState({r1:{},r2:{}}),[E,P]=x.useState({cia1:null,cia2:null,model:null}),[D,G]=x.useState({lab1:null,lab2:null}),[H,oe]=x.useState(null),[de,W]=x.useState({cia1:null,cia2:null}),[V,ae]=x.useState(null),[ee,C]=x.useState(!1),[Y,q]=x.useState(null);x.useEffect(()=>{let T=!0;return(async()=>{try{const I=await oc();if(!T)return;p(I||null)}catch{}})(),()=>{T=!1}},[e]),x.useEffect(()=>{let T=!0;return(async()=>{var I;try{const ie=await hc();if(!T)return;let U=(ie||[]).filter(Pe=>String(Pe.subject_code)===String(e));if(U.length===0)try{const Pe=await mr(`/api/academics/teaching-assignments/?subject_code=${encodeURIComponent(String(e||""))}`);if(Pe.ok){const je=await Pe.json();U=(Array.isArray(je.results)?je.results:Array.isArray(je)?je:je.items||[])||[]}}catch(Pe){console.warn("Server TA list fetch failed:",Pe)}i(U);const Z=Qn(`internalMark_selectedTa_${e}`),me=(typeof Z=="number"&&U.some(Pe=>Pe.id===Z)?Z:(I=U[0])==null?void 0:I.id)??null;o(me),c(null)}catch(ie){if(!T)return;i([]),o(null),c((ie==null?void 0:ie.message)||"Failed to load teaching assignments")}})(),()=>{T=!1}},[e]),x.useEffect(()=>{!e||s==null||Gn(`internalMark_selectedTa_${e}`,s)},[e,s]),x.useEffect(()=>{let T=!0;return(async()=>{try{const I=(n||[]).find(Z=>Z.id===s)||null,ie=I==null?void 0:I.curriculum_row_id;if(!ie){const Z=String(e).trim().toUpperCase(),me=await Sl();if(!T)return;const Pe=(me||[]).find(He=>String(He.course_code||"").trim().toUpperCase()===Z),je=(Pe==null?void 0:Pe.class_type)??null;if(je){d(je);return}const Fe=await Yd();if(!T)return;const _e=(Fe||[]).find(He=>String(He.course_code||"").trim().toUpperCase()===Z);d((_e==null?void 0:_e.class_type)??null);return}const U=await kN(Number(ie));if(!T)return;d((U==null?void 0:U.class_type)??null)}catch{T&&d(null)}})(),()=>{T=!1}},[n,s,e]),x.useEffect(()=>{let T=!0;return(async()=>{try{const I=ti(u),ie=U=>{if(!U||typeof U!="object")return!1;const Z=Number.isFinite(Number(U.ssa1))?Number(U.ssa1):1.5,me=Number.isFinite(Number(U.cia1))?Number(U.cia1):3,Pe=Number.isFinite(Number(U.formative1))?Number(U.formative1):2.5;S({ssa1:Z,cia1:me,formative1:Pe});const je=U.internal_mark_weights;if(Array.isArray(je)&&je.length){let Fe=je.map(_e=>{const He=Number(_e);return Number.isFinite(He)?He:0});if(Fe.length===13&&Pc.weights.length===17){const[_e,He,qe]=XF(Fe[0]||0,Z,me,Pe),[Pt,ut,Ke]=XF(Fe[1]||0,Z,me,Pe);Fe=[_e,He,qe,Pt,ut,Ke,...Fe.slice(2)]}for(;Fe.length<Pc.weights.length;)Fe.push(Pc.weights[Fe.length]??0);k(Fe.slice(0,Pc.weights.length))}else k([...Pc.weights]);return!0};try{const U=await vS();if(!T)return;const Z=U&&U[I]||null;if(ie(Z))return}catch{}try{const U=Qn("iqac_class_type_weights"),Z=U&&U[I]||null;if(ie(Z))return}catch{}}catch{}})(),()=>{T=!1}},[u]),x.useEffect(()=>{let T=!0;return(async()=>{if(s){v(!0),y(null);try{const ie=(n||[]).find(U=>U.id===s)||null;if(ie&&ie.elective_subject_id&&!ie.section_id){const U=ie.elective_subject_id,Z=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${encodeURIComponent(String(U))}`);if(!Z.ok)throw new Error(`Elective-choices fetch failed: ${Z.status}`);const me=await Z.json();if(!T)return;const je=((Array.isArray(me.results)?me.results:Array.isArray(me)?me:me.items||[])||[]).map(Fe=>({id:Number(Fe.student_id??Fe.id),reg_no:String(Fe.reg_no??Fe.registration_no??Fe.regno??""),name:String(Fe.name??Fe.full_name??Fe.username??""),section:Fe.section_name??Fe.section??null}));if(!T)return;m(je.filter(Fe=>Number.isFinite(Fe.id)).sort(YF))}else{const U=await pc(s);if(!T)return;const Z=(U.students||[]).map(me=>({id:Number(me.id),reg_no:String(me.reg_no??""),name:String(me.name??""),section:me.section??null})).filter(me=>Number.isFinite(me.id)).sort(YF);m(Z)}}catch(ie){if(!T)return;m([]),y((ie==null?void 0:ie.message)||"Failed to load roster")}finally{T&&v(!1)}}})(),()=>{T=!1}},[s]),x.useEffect(()=>{let T=!0;return(async()=>{C(!0),q(null);try{const ie=ti(u),U=s??void 0,Z=ie==="TCPL",me=ie==="TCPR",Pe=ie==="LAB"||ie==="PRACTICAL",je=ie==="SPECIAL"&&r.size,Fe=ht=>je?r.has(String(ht).toLowerCase()):!0;B({r1:{},r2:{}}),P({cia1:null,cia2:null,model:null}),G({lab1:null,lab2:null}),oe(null),W({cia1:null,cia2:null}),ae(null);const _e=async ht=>{if(!ie)return null;try{const Lt=await sh({class_type:String(ie).toUpperCase(),question_paper_type:null,exam:ht}),yr=Lt&&Lt.pattern;if(yr&&Array.isArray(yr.marks)&&yr.marks.length)return yr}catch{}try{const Lt=await sh({class_type:String(ie).toUpperCase(),question_paper_type:null,exam:"CIA"}),yr=Lt&&Lt.pattern;if(yr&&Array.isArray(yr.marks)&&yr.marks.length)return yr}catch{}return null};try{const[ht,Lt]=await Promise.all([_e("CIA1"),_e("CIA2")]);T&&W({cia1:ht,cia2:Lt})}catch{T&&W({cia1:null,cia2:null})}let He=null,qe=null,Pt=null,ut=null,Ke=null,lt=null,ve=null,Ae=null,ce=null,be=null,mt=null,et=null,Ue=null,It=null;if(Pe){try{const ht=await ei("cia1",e,U);ht!=null&&ht.draft&&(ce={data:ht.draft.data??ht.draft})}catch{}try{const ht=await ei("cia2",e,U);ht!=null&&ht.draft&&(be={data:ht.draft.data??ht.draft})}catch{}try{const ht=await ei("model",e,U);ht!=null&&ht.draft&&(mt={data:ht.draft.data??ht.draft})}catch{}if(!(ce!=null&&ce.data))try{ce=await Ks("cia1",e,U)}catch{ce=null}if(!(be!=null&&be.data))try{be=await Ks("cia2",e,U)}catch{be=null}if(!(mt!=null&&mt.data))try{mt=await Fm(e,U)}catch{mt=null}if(!T)return;P({cia1:(ce==null?void 0:ce.data)??null,cia2:(be==null?void 0:be.data)??null,model:(mt==null?void 0:mt.data)??null}),R({ssa1:{},ssa2:{},f1:{},f2:{},cia1:null,cia2:null});return}if(Fe("ssa1"))try{const ht=await ei("ssa1",e,U);ht!=null&&ht.draft&&ht.draft.marks&&(He={marks:ht.draft.marks})}catch{}if(Fe("ssa2"))try{const ht=await ei("ssa2",e,U);ht!=null&&ht.draft&&ht.draft.marks&&(qe={marks:ht.draft.marks})}catch{}if(Fe("ssa1")&&!(He!=null&&He.marks))try{He=await ig(e,U)}catch{He=null}if(Fe("ssa2")&&!(qe!=null&&qe.marks))try{qe=await ey(e,U)}catch{qe=null}if(me){try{const ht=await ei("review1",e,U);ht!=null&&ht.draft&&ht.draft.marks&&(ve={marks:ht.draft.marks})}catch{}try{const ht=await ei("review2",e,U);ht!=null&&ht.draft&&ht.draft.marks&&(Ae={marks:ht.draft.marks})}catch{}if(!(ve!=null&&ve.marks))try{ve=await wS(e)}catch{ve=null}if(!(Ae!=null&&Ae.marks))try{Ae=await SS(e)}catch{Ae=null}if(!T)return;B({r1:(ve==null?void 0:ve.marks)||{},r2:(Ae==null?void 0:Ae.marks)||{}})}if(Z){try{const ht=await ei("formative1",e,U);ht!=null&&ht.draft&&(et={data:ht.draft.data??ht.draft})}catch{}try{const ht=await ei("formative2",e,U);ht!=null&&ht.draft&&(Ue={data:ht.draft.data??ht.draft})}catch{}if(!(et!=null&&et.data))try{et=await Ks("formative1",e,U)}catch{et=null}if(!(Ue!=null&&Ue.data))try{Ue=await Ks("formative2",e,U)}catch{Ue=null}if(!T)return;G({lab1:(et==null?void 0:et.data)??null,lab2:(Ue==null?void 0:Ue.data)??null})}else{if(!me&&Fe("formative1")){try{const ht=await ei("formative1",e,U);ht!=null&&ht.draft&&ht.draft.marks&&(Pt={marks:ht.draft.marks})}catch{}if(!(Pt!=null&&Pt.marks))try{Pt=await v0("formative1",e,U)}catch{Pt=null}}if(!me&&Fe("formative2")){try{const ht=await ei("formative2",e,U);ht!=null&&ht.draft&&ht.draft.marks&&(ut={marks:ht.draft.marks})}catch{}if(!(ut!=null&&ut.marks))try{ut=await v0("formative2",e,U)}catch{ut=null}}}if(Fe("cia1")){try{const ht=await ei("cia1",e,U);ht!=null&&ht.draft&&(Ke={data:ht.draft.data??ht.draft})}catch{}if(!(Ke!=null&&Ke.data))try{Ke=await w0("cia1",e,U)}catch{Ke=null}}if(Fe("cia2")){try{const ht=await ei("cia2",e,U);ht!=null&&ht.draft&&(lt={data:ht.draft.data??ht.draft})}catch{}if(!(lt!=null&&lt.data))try{lt=await w0("cia2",e,U)}catch{lt=null}}try{const ht=await ei("model",e,U);ht!=null&&ht.draft&&(It={data:ht.draft.data??ht.draft})}catch{}if(!(It!=null&&It.data))try{It=await Fm(e,U)}catch{It=null}try{const ht=It==null?void 0:It.data,Lt=String((ht==null?void 0:ht.qpType)||"").trim().toUpperCase(),yr=Lt==="QP2"?"QP2":Lt==="QP1"?"QP1":null,Ar=String(ie||"").toUpperCase(),Tt=await sh({class_type:Ar,question_paper_type:Ar==="THEORY"?yr:null,exam:"MODEL"}),Vr=Tt==null?void 0:Tt.pattern;Vr&&Array.isArray(Vr.marks)&&Vr.marks.length&&T&&ae(Vr)}catch{}if(!T)return;R({ssa1:(He==null?void 0:He.marks)||{},ssa2:(qe==null?void 0:qe.marks)||{},f1:(Pt==null?void 0:Pt.marks)||{},f2:(ut==null?void 0:ut.marks)||{},cia1:(Ke==null?void 0:Ke.data)||null,cia2:(lt==null?void 0:lt.data)||null}),oe((It==null?void 0:It.data)||null)}catch(ie){if(!T)return;q((ie==null?void 0:ie.message)||"Failed to load marks")}finally{T&&C(!1)}})(),()=>{T=!1}},[e,u,r,s]);const O=x.useMemo(()=>kOe(u,r),[u,r]),X=x.useMemo(()=>{const I=(Array.isArray(j)&&j.length?j:Pc.weights).slice(0,Pc.weights.length);for(;I.length<Pc.weights.length;)I.push(Pc.weights[I.length]??0);const ie=O.visible.map(U=>I[U]??0);return{header:O.header,weights:ie,cycles:O.cycles,visible:O.visible,labels:O.labels}},[j,O]),F=x.useMemo(()=>X.weights.map(I=>Number(I)||0).reduce((I,ie)=>I+ie,0),[X]),Q=x.useMemo(()=>{var Yr,xn,hr,nr,Mr,an,it,Ye,ct,Ht,fr,Sr,gr,Ze,Kt,nt,bt,St,Ct,$t,Vt,Dt;const T=ti(u),I=new Array(17).fill(0);for(let ze=0;ze<X.visible.length;ze++){const at=X.visible[ze];I[at]=Number(X.weights[ze])||0}const ie=I[0]||0,U=I[1]||0,Z=I[2]||0,me=I[3]||0,Pe=I[4]||0,je=I[5]||0,Fe=I[6]||0,_e=I[7]||0,He=I[8]||0,qe=I[9]||0,Pt=I[10]||0,ut=I[11]||0,Ke=I[12]||0,lt=I[13]||0,ve=I[14]||0,Ae=I[15]||0,ce=I[16]||0,be=A.cia1&&typeof A.cia1=="object"?A.cia1:null,mt=A.cia2&&typeof A.cia2=="object"?A.cia2:null,et=de==null?void 0:de.cia1,Ue=de==null?void 0:de.cia2,It=Array.isArray((xn=(Yr=f==null?void 0:f.assessments)==null?void 0:Yr.cia1)==null?void 0:xn.questions)?f.assessments.cia1.questions.map(ze=>({key:String((ze==null?void 0:ze.key)||""),max:Number((ze==null?void 0:ze.max)??(ze==null?void 0:ze.maxMarks)??0),co:wk(ze==null?void 0:ze.co)})).filter(ze=>ze.key):[],ht=Array.isArray((nr=(hr=f==null?void 0:f.assessments)==null?void 0:hr.cia2)==null?void 0:nr.questions)?f.assessments.cia2.questions.map(ze=>({key:String((ze==null?void 0:ze.key)||""),max:Number((ze==null?void 0:ze.max)??(ze==null?void 0:ze.maxMarks)??0),co:Sk(ze==null?void 0:ze.co)})).filter(ze=>ze.key):[],Lt=et&&Array.isArray(et.marks)&&et.marks.length?et.marks.map((ze,at)=>{const _t=It[at],Ft=Array.isArray(et.cos)?et.cos[at]:void 0;return{key:`q${at+1}`,max:Number(ze)||0,co:Ft!=null?wk(Ft):(_t==null?void 0:_t.co)??1}}).filter(ze=>!!ze.key):[],yr=Ue&&Array.isArray(Ue.marks)&&Ue.marks.length?Ue.marks.map((ze,at)=>{const _t=ht[at],Ft=Array.isArray(Ue.cos)?Ue.cos[at]:void 0;return{key:`q${at+1}`,max:Number(ze)||0,co:Ft!=null?Sk(Ft):(_t==null?void 0:_t.co)??3}}).filter(ze=>!!ze.key):[],Ar=Array.isArray(be==null?void 0:be.questions)?be.questions.map(ze=>({key:String((ze==null?void 0:ze.key)||""),max:Number((ze==null?void 0:ze.max)??(ze==null?void 0:ze.maxMarks)??0),co:wk(ze==null?void 0:ze.co)})).filter(ze=>ze.key):Lt.length?Lt:It.length?It:vOe,Tt=Array.isArray(mt==null?void 0:mt.questions)?mt.questions.map(ze=>({key:String((ze==null?void 0:ze.key)||""),max:Number((ze==null?void 0:ze.max)??(ze==null?void 0:ze.maxMarks)??0),co:Sk(ze==null?void 0:ze.co)})).filter(ze=>ze.key):yr.length?yr:ht.length?ht:wOe,Vr=be!=null&&be.rowsByStudentId&&typeof be.rowsByStudentId=="object"?be.rowsByStudentId:{},Br=mt!=null&&mt.rowsByStudentId&&typeof mt.rowsByStudentId=="object"?mt.rowsByStudentId:{},Wr=Ar.reduce((ze,at,_t)=>{const Ft=_k(Ar,_t);return ze+at.max*Ft.co1},0),nn=Ar.reduce((ze,at,_t)=>{const Ft=_k(Ar,_t);return ze+at.max*Ft.co2},0),fn=Tt.reduce((ze,at,_t)=>{const Ft=jk(Tt,_t);return ze+at.max*Ft.co3},0),Ir=Tt.reduce((ze,at,_t)=>{const Ft=jk(Tt,_t);return ze+at.max*Ft.co4},0),dn=((Mr=f==null?void 0:f.assessments)==null?void 0:Mr.ssa1)||{},Te=((an=f==null?void 0:f.assessments)==null?void 0:an.ssa2)||{},tt=((it=f==null?void 0:f.assessments)==null?void 0:it.formative1)||{},st=((Ye=f==null?void 0:f.assessments)==null?void 0:Ye.formative2)||{},kt=((ct=f==null?void 0:f.assessments)==null?void 0:ct.cia1)||{},jt=((Ht=f==null?void 0:f.assessments)==null?void 0:Ht.cia2)||{},ar=Number((fr=dn==null?void 0:dn.coMax)==null?void 0:fr.co1),tr=Number((Sr=dn==null?void 0:dn.coMax)==null?void 0:Sr.co2),Er=Number(((gr=Te==null?void 0:Te.coMax)==null?void 0:gr.co3)??((Ze=Te==null?void 0:Te.coMax)==null?void 0:Ze.co1)),se=Number(((Kt=Te==null?void 0:Te.coMax)==null?void 0:Kt.co4)??((nt=Te==null?void 0:Te.coMax)==null?void 0:nt.co2)),ue=Number((bt=kt==null?void 0:kt.coMax)==null?void 0:bt.co1),J=Number((St=kt==null?void 0:kt.coMax)==null?void 0:St.co2),fe=Number(((Ct=jt==null?void 0:jt.coMax)==null?void 0:Ct.co3)??(($t=jt==null?void 0:jt.coMax)==null?void 0:$t.co1)),ye=Number(((Vt=jt==null?void 0:jt.coMax)==null?void 0:Vt.co4)??((Dt=jt==null?void 0:jt.coMax)==null?void 0:Dt.co2)),Ce=Number(tt==null?void 0:tt.maxCo),wt=Number(st==null?void 0:st.maxCo),Qe=T==="TCPL",Ie={ssa1:{co1:Number.isFinite(ar)?Math.max(0,ar):10,co2:Number.isFinite(tr)?Math.max(0,tr):10},ssa2:{co3:Number.isFinite(Er)?Math.max(0,Er):10,co4:Number.isFinite(se)?Math.max(0,se):10},cia1:{co1:Qe?Wr>0?Wr:Number.isFinite(ue)?Math.max(0,ue):30:Number.isFinite(ue)?Math.max(0,ue):Wr,co2:Qe?nn>0?nn:Number.isFinite(J)?Math.max(0,J):30:Number.isFinite(J)?Math.max(0,J):nn},cia2:{co3:Qe?fn>0?fn:Number.isFinite(fe)?Math.max(0,fe):30:Number.isFinite(fe)?Math.max(0,fe):fn,co4:Qe?Ir>0?Ir:Number.isFinite(ye)?Math.max(0,ye):30:Number.isFinite(ye)?Math.max(0,ye):Ir},f1:{co1:Number.isFinite(Ce)?Math.max(0,Ce):10,co2:Number.isFinite(Ce)?Math.max(0,Ce):10},f2:{co3:Number.isFinite(wt)?Math.max(0,wt):10,co4:Number.isFinite(wt)?Math.max(0,wt):10},review1:{co1:15,co2:15},review2:{co3:15,co4:15}},Re=T==="TCPL",xt=T==="TCPR",Gt=Re||xt,qt=Array.isArray(V==null?void 0:V.marks)?V.marks:null,Wt=(()=>{if(Array.isArray(qt)&&qt.length)return qt.map((ze,at)=>({key:`q${at+1}`,max:Number(ze)||0}));if(Gt){const ze=xt?12:15,at=xt?8:10;return Array.from({length:ze},(_t,Ft)=>{const pr=Ft+1;return{key:`q${pr}`,max:pr<=at?2:16}})}return SOe})(),vt=(()=>{const ze=Array.isArray(V==null?void 0:V.cos)?V.cos:null;if(Array.isArray(ze)&&ze.length===Wt.length)return ze.map(at=>{const _t=Number(at);if(Number.isFinite(_t))return ui(Math.round(_t),1,5);const pr=String(at??"").toUpperCase().match(/\d+/);return pr?ui(Number(pr[0]),1,5):1});if(xt){const at=[1,1,2,2,3,3,4,4,1,2,3,4];return Wt.length===at.length?at:Array.from({length:Wt.length},(_t,Ft)=>at[Ft%at.length])}if(Re){const at=[1,1,2,2,3,3,4,4,5,5,1,2,3,4,5];return Wt.length===at.length?at:Array.from({length:Wt.length},(_t,Ft)=>at[Ft%at.length])}return Wt.length===vv.length?[...vv]:Array.from({length:Wt.length},(at,_t)=>vv[_t%vv.length])})(),Rt=(()=>{const ze={co1:0,co2:0,co3:0,co4:0,co5:0};for(let at=0;at<Wt.length;at++){const _t=Wt[at],Ft=vt[at]??1;Ft===1?ze.co1+=_t.max:Ft===2?ze.co2+=_t.max:Ft===3?ze.co3+=_t.max:Ft===4?ze.co4+=_t.max:Ft===5&&(ze.co5+=_t.max)}return ze})(),Zt=(()=>{const ze={...Rt};return xt?{...ze,co5:ze.co5+30}:Re?{co1:ze.co1+6,co2:ze.co2+6,co3:ze.co3+6,co4:ze.co4+6,co5:ze.co5+6}:ze})(),wr=String(s??"none"),br=H&&typeof H=="object"?H:null,cr=(()=>{if(br){const Le=ti(br==null?void 0:br.classType),Et=Le==="TCPL"||Le==="TCPR"?br==null?void 0:br.tcplSheet:br==null?void 0:br.theorySheet;if(Et&&typeof Et=="object")return Et}const ze=`model_theory_sheet_${e}_${wr}`,at=`model_theory_sheet_${e}_none`,_t=`model_tcpl_sheet_${e}_${wr}`,Ft=`model_tcpl_sheet_${e}_none`,pr=`model_tcpr_sheet_${e}_${wr}`,or=`model_tcpr_sheet_${e}_none`,Xt=`model_sheet_${e}`,xe=Qn(ze);if(xe&&typeof xe=="object")return xe;const Ee=Qn(at);if(Ee&&typeof Ee=="object")return Ee;const De=Qn(_t);if(De&&typeof De=="object")return De;const gt=Qn(Ft);if(gt&&typeof gt=="object")return gt;const vr=Qn(pr);if(vr&&typeof vr=="object")return vr;const Je=Qn(or);if(Je&&typeof Je=="object")return Je;const Ut=Qn(Xt);return Ut&&typeof Ut=="object"?Ut:null})(),Tr=ze=>{const at=Zt;if(!cr)return{co1:null,co2:null,co3:null,co4:null,co5:null,max:at};const _t=`id:${String(ze.id)}`,Ft=ze.reg_no?`reg:${String(ze.reg_no).trim()}`:"",pr=cr[_t]||(Ft?cr[Ft]:null)||null;if(!pr||typeof pr!="object")return{co1:null,co2:null,co3:null,co4:null,co5:null,max:at};const or=!!pr.absent,Xt=String(pr.absentKind||"AL").toUpperCase(),xe=pr.q&&typeof pr.q=="object"?pr.q:{},Ee=Po(pr.lab);let De=!1;const gt={co1:0,co2:0,co3:0,co4:0,co5:0};for(let vr=0;vr<Wt.length;vr++){const Je=Wt[vr],Ut=xe[Je.key],Le=Po(Ut);if(Le==null)continue;De=!0;const Be=ui(Le,0,Je.max),Et=vt[vr]??1;Et===1?gt.co1+=Be:Et===2?gt.co2+=Be:Et===3?gt.co3+=Be:Et===4?gt.co4+=Be:Et===5&&(gt.co5+=Be)}if(Gt&&Ee!=null){De=!0;const vr=ui(Ee,0,30);if(xt)gt.co5+=vr;else{const Je=vr/5;gt.co1+=Je,gt.co2+=Je,gt.co3+=Je,gt.co4+=Je,gt.co5+=Je}}return De?or&&Xt==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:at}:{co1:ui(gt.co1,0,at.co1),co2:ui(gt.co2,0,at.co2),co3:ui(gt.co3,0,at.co3),co4:ui(gt.co4,0,at.co4),co5:ui(gt.co5,0,at.co5),max:at}:or&&Xt==="AL"?{co1:0,co2:0,co3:0,co4:0,co5:0,max:at}:{co1:null,co2:null,co3:null,co4:null,co5:null,max:at}},Kr=(ze,at,_t)=>ze==null||!at||!Number.isFinite(at)?null:ui(ze/at*_t,0,_t);if(T==="LAB"||T==="PRACTICAL"){const at=(Xt,xe,Ee)=>{const De=Xt!=null&&Xt.sheet&&typeof Xt.sheet=="object"?Xt.sheet:{},gt=De!=null&&De.rowsByStudentId&&typeof De.rowsByStudentId=="object"?De.rowsByStudentId:{},vr=ui(Number((De==null?void 0:De.expCountA)??0),0,12),Je=ui(Number((De==null?void 0:De.expCountB)??0),0,12),Ut=!!(De!=null&&De.coAEnabled),Le=!!(De!=null&&De.coBEnabled),Be=!!(De!=null&&De.ciaExamEnabled),Et=De!=null&&De.coConfigs&&typeof De.coConfigs=="object"?De.coConfigs:null,pt=Et?Et[String(xe)]:null,yt=Ee!=null&&Et?Et[String(Ee)]:null,ft=pt?!!pt.enabled:Ut,he=Ee!=null?yt?!!yt.enabled:Le:!1,Ne=pt?ui(Number(pt.expCount??0),0,12):vr,Xe=Ee!=null?yt?ui(Number(yt.expCount??0),0,12):Je:0,At=pt&&Number.isFinite(Number(pt.expMax))?Number(pt.expMax):Number.isFinite(Number(De==null?void 0:De.expMaxA))?Number(De.expMaxA):25,Lr=Ee!=null?yt&&Number.isFinite(Number(yt.expMax))?Number(yt.expMax):Number.isFinite(Number(De==null?void 0:De.expMaxB))?Number(De.expMaxB):25:0,xr=At+(Be?15:0),$r=Ee!=null?Lr+(Be?15:0):0,Dr=(yn,sn)=>Array.isArray(yn)?yn.map(ir=>typeof ir=="number"&&Number.isFinite(ir)?ir:null):yn==null?[]:[],cn=yn=>{const sn=(yn||[]).filter(ir=>typeof ir=="number"&&Number.isFinite(ir));return sn.length?sn.reduce((ir,Qr)=>ir+Qr,0)/sn.length:null};return{get:yn=>{const sn=gt[String(yn)]||{},ir=sn!=null&&sn.marksByCo&&typeof sn.marksByCo=="object"?sn.marksByCo:{},Qr=(ir==null?void 0:ir[String(xe)])??sn.marksA,vn=Ee!=null?(ir==null?void 0:ir[String(Ee)])??sn.marksB:[],Kn=Dr(Qr).slice(0,ft?Ne:0),Bn=Dr(vn).slice(0,he?Xe:0),ri=cn(Kn),on=cn(Bn),Un=sn==null?void 0:sn.ciaExam,L=typeof Un=="number"&&Number.isFinite(Un)?Un:null,le=ri!=null||on!=null||L!=null,Oe=le?(ri??0)+(Be?(L??0)/2:0):null,dt=le?(on??0)+(Be?(L??0)/2:0):null;return{a:Oe==null?null:ui(Oe,0,xr),b:dt==null?null:ui(dt,0,$r)}},CO_MAX_A:xr,CO_MAX_B:$r}},_t=at(E.cia1,1,2),Ft=at(E.cia2,3,4),pr=at(E.model,5,null),or=(Xt,xe,Ee)=>Xt==null||!xe||!Number.isFinite(xe)?null:ui(Xt/xe*Ee,0,Ee);return h.map((Xt,xe)=>{const Ee=_t.get(Xt.id),De=Ft.get(Xt.id),gt=pr.get(Xt.id),vr=null,Je=or(Ee.a,_t.CO_MAX_A,U),Ut=null,Le=null,Be=or(Ee.b,_t.CO_MAX_B,Pe),Et=null,pt=null,yt=or(De.a,Ft.CO_MAX_A,_e),ft=null,he=null,Ne=or(De.b,Ft.CO_MAX_B,Pt),Xe=null,At=null,Lr=null,xr=null,$r=null,Dr=or(gt.a,pr.CO_MAX_A,ce),cn=[vr,Je,Ut,Le,Be,Et,pt,yt,ft,he,Ne,Xe,At,Lr,xr,$r,Dr],hn=X.visible.map(Qr=>cn[Qr]),sn=hn.some(Qr=>typeof Qr=="number"&&Number.isFinite(Qr))?Wf(hn.reduce((Qr,vn)=>Qr+(typeof vn=="number"&&Number.isFinite(vn)?vn:0),0)):null,ir=sn==null||!F?null:Wf(sn/F*100);return{sno:xe+1,...Xt,cells:hn,total:sn,pct:ir}})}return h.map((ze,at)=>{const _t=Po(A.ssa1[String(ze.id)]),Ft=Po(A.ssa2[String(ze.id)]),pr=_t==null?null:Number(_t)/2,or=Ft==null?null:Number(Ft)/2,Xt=pr==null?null:ui(pr,0,Ie.ssa1.co1),xe=pr==null?null:ui(pr,0,Ie.ssa1.co2),Ee=or==null?null:ui(or,0,Ie.ssa2.co3),De=or==null?null:ui(or,0,Ie.ssa2.co4),gt=(A.f1||{})[String(ze.id)]||{},vr=(A.f2||{})[String(ze.id)]||{},Je=Po(gt==null?void 0:gt.skill1)!=null&&Po(gt==null?void 0:gt.att1)!=null?ui(Number(gt.skill1)+Number(gt.att1),0,Ie.f1.co1):null,Ut=Po(gt==null?void 0:gt.skill2)!=null&&Po(gt==null?void 0:gt.att2)!=null?ui(Number(gt.skill2)+Number(gt.att2),0,Ie.f1.co2):null,Le=Po(vr==null?void 0:vr.skill1)!=null&&Po(vr==null?void 0:vr.att1)!=null?ui(Number(vr.skill1)+Number(vr.att1),0,Ie.f2.co3):null,Be=Po(vr==null?void 0:vr.skill2)!=null&&Po(vr==null?void 0:vr.att2)!=null?ui(Number(vr.skill2)+Number(vr.att2),0,Ie.f2.co4):null,Et=Po(M.r1[String(ze.id)]),pt=Po(M.r2[String(ze.id)]),yt=Et==null?null:Number(Et)/2,ft=pt==null?null:Number(pt)/2,he=yt==null?null:ui(yt,0,Ie.review1.co1),Ne=yt==null?null:ui(yt,0,Ie.review1.co2),Xe=ft==null?null:ui(ft,0,Ie.review2.co3),At=ft==null?null:ui(ft,0,Ie.review2.co4),Lr=(Or,Gr,zr)=>{const Qt=Or!=null&&Or.sheet&&typeof Or.sheet=="object"?Or.sheet:{},mn=Qt!=null&&Qt.rowsByStudentId&&typeof Qt.rowsByStudentId=="object"?Qt.rowsByStudentId:{},ln=30/2,_n=Qt!=null&&Qt.coConfigs&&typeof Qt.coConfigs=="object"?Qt.coConfigs:null,wn=_n?_n[String(Gr)]:null,pn=zr!=null&&_n?_n[String(zr)]:null,oi=ui(Number((Qt==null?void 0:Qt.expCountA)??0),0,12),Fn=ui(Number((Qt==null?void 0:Qt.expCountB)??0),0,12),pi=(Qt==null?void 0:Qt.coAEnabled)!==!1,Xn=zr!=null?(Qt==null?void 0:Qt.coBEnabled)!==!1:!1,ca=wn?!!wn.enabled:pi,Rl=zr!=null?pn?!!pn.enabled:Xn:!1,Ko=wn?ui(Number(wn.expCount??0),0,12):oi,wo=zr!=null?pn?ui(Number(pn.expCount??0),0,12):Fn:0,So=wn&&Number.isFinite(Number(wn.expMax))?Number(wn.expMax):Number.isFinite(Number(Qt==null?void 0:Qt.expMaxA))?Number(Qt.expMaxA):25,ws=zr!=null?pn&&Number.isFinite(Number(pn.expMax))?Number(pn.expMax):Number.isFinite(Number(Qt==null?void 0:Qt.expMaxB))?Number(Qt.expMaxB):25:0,ba=(Qt==null?void 0:Qt.ciaExamEnabled)!==!1,cs=So+(ba?ln:0),Bi=zr!=null?ws+(ba?ln:0):0,Aa=Ci=>Array.isArray(Ci)?Ci.map($n=>typeof $n=="number"&&Number.isFinite($n)?$n:null):[],to=Ci=>{const $n=(Ci||[]).filter(Yi=>typeof Yi=="number"&&Number.isFinite(Yi));return $n.length?$n.reduce((Yi,Ss)=>Yi+Ss,0)/$n.length:null};return{get:Ci=>{const $n=mn[String(Ci)]||{},Yi=$n!=null&&$n.marksByCo&&typeof $n.marksByCo=="object"?$n.marksByCo:{},Ss=(Yi==null?void 0:Yi[String(Gr)])??($n==null?void 0:$n.marksA),hd=zr!=null?(Yi==null?void 0:Yi[String(zr)])??($n==null?void 0:$n.marksB):[],Xc=Aa(Ss).slice(0,ca?Ko:0),gc=Aa(hd).slice(0,Rl?wo:0),xc=to(Xc),Yo=to(gc),ro=$n==null?void 0:$n.ciaExam,pl=typeof ro=="number"&&Number.isFinite(ro)?ro:null,yc=xc!=null||Yo!=null||pl!=null,Fl=yc?(xc??0)+(ba?(pl??0)/2:0):null,Bl=yc?(Yo??0)+(ba?(pl??0)/2:0):null;return{a:Fl==null?null:ui(Fl,0,cs),b:Bl==null?null:ui(Bl,0,Bi)}},CO_MAX_A:cs,CO_MAX_B:Bi}},xr=T==="TCPL"?Lr(D.lab1,1,2):null,$r=T==="TCPL"?Lr(D.lab2,3,4):null,Dr=xr?xr.get(ze.id):null,cn=$r?$r.get(ze.id):null,hn=(Dr==null?void 0:Dr.a)??null,yn=(Dr==null?void 0:Dr.b)??null,sn=(cn==null?void 0:cn.a)??null,ir=(cn==null?void 0:cn.b)??null,Qr=Vr[String(ze.id)]||{},vn=Br[String(ze.id)]||{},Kn=!!(Qr!=null&&Qr.absent),Bn=!!(vn!=null&&vn.absent);let ri=null,on=null;if(!Kn){const Or=Qr!=null&&Qr.q&&typeof Qr.q=="object"?Qr.q:{};let Gr=!1,zr=0,Qt=0;for(let mn=0;mn<Ar.length;mn++){const ln=Ar[mn],_n=Po(Or==null?void 0:Or[ln.key]);if(_n==null)continue;Gr=!0;const wn=ui(_n,0,ln.max||_n),pn=_k(Ar,mn);zr+=wn*pn.co1,Qt+=wn*pn.co2}Gr&&(ri=ui(zr,0,Ie.cia1.co1),on=ui(Qt,0,Ie.cia1.co2))}let Un=null,L=null;if(!Bn){const Or=vn!=null&&vn.q&&typeof vn.q=="object"?vn.q:{};let Gr=!1,zr=0,Qt=0;for(let mn=0;mn<Tt.length;mn++){const ln=Tt[mn],_n=Po(Or==null?void 0:Or[ln.key]);if(_n==null)continue;Gr=!0;const wn=ui(_n,0,ln.max||_n),pn=jk(Tt,mn);zr+=wn*pn.co3,Qt+=wn*pn.co4}Gr&&(Un=ui(zr,0,Ie.cia2.co3),L=ui(Qt,0,Ie.cia2.co4))}const le=Kr(Xt,Ie.ssa1.co1,ie),Oe=Kr(ri,Ie.cia1.co1,U),dt=T==="TCPR"?Kr(he,Ie.review1.co1,Z):T==="TCPL"?Kr(hn,(xr==null?void 0:xr.CO_MAX_A)??Ie.f1.co1,Z):Kr(Je,Ie.f1.co1,Z),rt=Kr(xe,Ie.ssa1.co2,me),Mt=Kr(on,Ie.cia1.co2,Pe),lr=T==="TCPR"?Kr(Ne,Ie.review1.co2,je):T==="TCPL"?Kr(yn,(xr==null?void 0:xr.CO_MAX_B)??Ie.f1.co2,je):Kr(Ut,Ie.f1.co2,je),en=Kr(Ee,Ie.ssa2.co3,Fe),bn=Kr(Un,Ie.cia2.co3,_e),Dn=T==="TCPR"?Kr(Xe,Ie.review2.co3,He):T==="TCPL"?Kr(sn,($r==null?void 0:$r.CO_MAX_A)??Ie.f2.co3,He):Kr(Le,Ie.f2.co3,He),zn=Kr(De,Ie.ssa2.co4,qe),hi=Kr(L,Ie.cia2.co4,Pt),Ni=T==="TCPR"?Kr(At,Ie.review2.co4,ut):T==="TCPL"?Kr(ir,($r==null?void 0:$r.CO_MAX_B)??Ie.f2.co4,ut):Kr(Be,Ie.f2.co4,ut),bi=Tr(ze),Se=Kr(bi.co1,bi.max.co1,Ke),$e=Kr(bi.co2,bi.max.co2,lt),ot=Kr(bi.co3,bi.max.co3,ve),We=Kr(bi.co4,bi.max.co4,Ae),Nt=Kr(bi.co5,bi.max.co5,ce),ur=[le,Oe,dt,rt,Mt,lr,en,bn,Dn,zn,hi,Ni,Se,$e,ot,We,Nt],zt=X.visible.map(Or=>ur[Or]),jr=zt.some(Or=>typeof Or=="number"&&Number.isFinite(Or))?Wf(zt.reduce((Or,Gr)=>Or+(typeof Gr=="number"&&Number.isFinite(Gr)?Gr:0),0)):null,Ur=jr==null||!F?null:Wf(jr/F*100);return{sno:at+1,...ze,cells:zt,total:jr,pct:Ur}})},[X,A,M,E,D,H,h,w,F,e,s,f,u,de,V]),K=X.header,ne=X.cycles,re=X.weights;return a.jsxs("div",{style:{padding:12},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:12,flexWrap:"wrap",marginBottom:12},children:[a.jsxs("div",{children:[a.jsx("h3",{style:{margin:0},children:"INTERNAL MARK"}),a.jsx("div",{style:{color:"#6b7280",marginTop:4},children:"Summative + Formative (based on IQAC mapping)"})]}),a.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:a.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[a.jsx("span",{style:{color:"#374151",fontWeight:700},children:"Section"}),a.jsxs("select",{value:s??"",onChange:T=>o(T.target.value?Number(T.target.value):null),style:{padding:8,borderRadius:8,border:"1px solid #d1d5db"},children:[a.jsx("option",{value:"",disabled:!0,children:""}),n.map(T=>{const I=T.department,ie=(I==null?void 0:I.short_name)||(I==null?void 0:I.code)||(I==null?void 0:I.name)||T.department_name||"",U=T.semester,Z=`${T.section_name||`TA ${T.id}`} ${U?` Sem ${U}`:""} ${ie?` ${ie}`:""}`;return a.jsx("option",{value:T.id,children:Z},T.id)})]})]})})]}),l?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:l}):null,g?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:g}):null,Y?a.jsx("div",{style:{color:"#b91c1c",marginBottom:8},children:Y}):null,b||ee?a.jsx("div",{style:{color:"#6b7280",marginBottom:8},children:"Loading"}):null,a.jsx("div",{style:{overflowX:"auto",border:"1px solid #e5e7eb",borderRadius:10},children:a.jsxs("table",{style:{borderCollapse:"collapse",width:"100%",fontSize:12},children:[a.jsxs("thead",{children:[a.jsxs("tr",{children:[a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"S.No"}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Register No."}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"Name"}),K.map((T,I)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:String(T)},I)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:Wf(F)}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f9fafb"},children:"100"})]}),a.jsxs("tr",{children:[a.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"internal weightage"}),re.map((T,I)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#f3f4f6"},children:Number(T).toFixed(1)},`w-${I}`)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]}),a.jsxs("tr",{children:[a.jsx("th",{colSpan:3,style:{border:"1px solid #e5e7eb",padding:8,background:"#fff",textAlign:"left",fontWeight:800},children:"cycle"}),ne.map((T,I)=>a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"},children:String(T)},`c-${I}`)),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}}),a.jsx("th",{style:{border:"1px solid #e5e7eb",padding:8,background:"#fff"}})]})]}),a.jsx("tbody",{children:Q.map(T=>a.jsxs("tr",{children:[a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:T.sno}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:T.reg_no}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6},children:T.name}),(Array.isArray(T.cells)?T.cells:[]).map((I,ie)=>a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:I==null?"":Number(I).toFixed(2)},ie)),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center",fontWeight:800},children:T.total==null?"":Number(T.total).toFixed(2)}),a.jsx("td",{style:{border:"1px solid #e5e7eb",padding:6,textAlign:"center"},children:T.pct==null?"":Number(T.pct).toFixed(2)})]},T.id))})]})})]})}function NOe(){const{code:e}=U0(),t=bo(),r=hl(),n=e?decodeURIComponent(e):"",[i,s]=Jr.useState(()=>"marks"),[o,l]=Jr.useState(null),[c,u]=Jr.useState(null),[d,f]=Jr.useState(!1),[p,h]=Jr.useState(()=>{if(!n)return"QP1";try{const b=localStorage.getItem(`obe_course_qp_${n}`);return String(b||"").trim().toUpperCase()==="QP2"?"QP2":"QP1"}catch{return"QP1"}}),[m,g]=Jr.useState(null);Jr.useEffect(()=>{if(!r||!r.pathname)return;const b=r.pathname.toLowerCase();b.includes("/lca/instructions")||b.includes("/lca_instructions")||b.includes("/lca")||b.includes("/cdap")||b.includes("/articulation")?s("lca_instructions"):b.includes("/marks")?s("marks"):b.includes("/co_attainment")?s("co_attainment"):b.includes("/internal_mark")||b.includes("/internal-mark")?s("internal_mark"):b.includes("/cqi")?s("cqi"):s("marks")},[r]);const y=Jr.useMemo(()=>{const b=String((r==null?void 0:r.pathname)||"").toLowerCase();return b.includes("/cdap")?"cdap":b.includes("/articulation")?"articulation":b.includes("/lca")&&!(b.includes("/lca/instructions")||b.includes("/lca_instructions"))?"lca":"instructions"},[r==null?void 0:r.pathname]);return Jr.useEffect(()=>{if(!n)return;let b=!0;return(async()=>{try{b&&f(!1);const v=await hc();if(!b)return;const w=(v||[]).filter(R=>String(R.subject_code)===String(n)),S=w[0]||null;S&&l(S.subject_name||null);let j=null;try{const R=localStorage.getItem(`markEntry_selectedTa_${n}`),M=R==null?NaN:Number(R);j=Number.isFinite(M)?M:null}catch{j=null}const k=j!=null&&w.find(R=>Number(R.id)===Number(j))||w.find(R=>String((R==null?void 0:R.class_type)||"").trim())||S,A=String((k==null?void 0:k.class_type)||"").trim();A&&(u(A),f(!0))}catch{}})(),()=>{b=!1}},[n]),Jr.useEffect(()=>{if(!n)return;let b=!0;return(async()=>{try{const v=await Sl();if(!b)return;const w=String(n),S=w.toUpperCase(),j=(v||[]).filter(B=>String((B==null?void 0:B.course_code)||"").trim()===w||String((B==null?void 0:B.course_code)||"").trim().toUpperCase()===S),k=B=>String(B||"").trim().toUpperCase(),A=j.find(B=>{const E=k(B==null?void 0:B.question_paper_type);return E&&E!=="QP1"})||j.find(B=>k(B==null?void 0:B.question_paper_type))||j.find(B=>String((B==null?void 0:B.class_type)||"").trim())||j[0];if(!d&&A&&A.class_type){const B=String(A.class_type||"").trim();u(B||null)}else if(!d)try{const B=await fm();if(!b)return;const E=(Array.isArray(B)?B:B.results||[]).find(P=>String(P.course_code||"").trim().toUpperCase()===S);E&&E.class_type&&(u(String(E.class_type||"").trim()||null),Array.isArray(E.enabled_assessments)&&E.enabled_assessments.length&&g(E.enabled_assessments.map(P=>String(P).trim().toLowerCase()).filter(Boolean)))}catch{}let R=null;try{R=localStorage.getItem(`obe_course_qp_${n}`)}catch{R=null}const M=String(R||"").trim().toUpperCase();if(M==="QP1"||M==="QP2")h(M);else{const B=String((A==null?void 0:A.question_paper_type)||"").trim().toUpperCase();h(B==="QP2"?"QP2":"QP1")}if(ti(A==null?void 0:A.class_type)==="SPECIAL"){g([]);try{const B=await yS(w);g(Array.isArray(B)?B:[])}catch{const B=A==null?void 0:A.enabled_assessments;g(Array.isArray(B)?B.map(E=>String(E).trim().toLowerCase()).filter(Boolean):[])}}else g(null)}catch{}})(),()=>{b=!1}},[n]),e?a.jsx("main",{className:"obe-course-page",style:{padding:"32px 48px",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',minHeight:"100vh",background:"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)"},children:a.jsxs("div",{style:{width:"100%",minWidth:0,boxSizing:"border-box"},children:[a.jsx("div",{style:{marginBottom:24,background:"#fff",padding:"28px 32px",borderRadius:16,boxShadow:"0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04)"},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:24,flexWrap:"wrap"},children:[a.jsxs("div",{style:{flex:1},children:[a.jsxs("h2",{style:{margin:0,fontSize:32,fontWeight:700,color:"#0f172a",letterSpacing:"-0.02em"},children:["OBE - ",n]}),a.jsx("div",{style:{color:"#64748b",marginTop:8,fontSize:16},children:"Course OBE workspace"}),o&&a.jsx("div",{style:{color:"#1e293b",marginTop:12,fontWeight:700,fontSize:20},children:o}),a.jsxs("div",{style:{marginTop:16,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[c&&a.jsxs("div",{style:{background:"#eff6ff",color:"#3b82f6",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #bfdbfe"},children:[" Class type: ",a.jsx("strong",{children:String(c).toLowerCase()[0].toUpperCase()+String(c).toLowerCase().slice(1)})]}),a.jsxs("div",{style:{background:"#f8fafc",color:"#475569",padding:"6px 14px",borderRadius:8,fontWeight:600,fontSize:14,border:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:8},children:[a.jsx("span",{children:" QP Type:"}),a.jsxs("select",{value:String(p||"QP1").trim().toUpperCase()==="QP2"?"QP2":"QP1",onChange:b=>{const w=String(b.target.value||"").trim().toUpperCase()==="QP2"?"QP2":"QP1";h(w);try{localStorage.setItem(`obe_course_qp_${n}`,w)}catch{}},style:{padding:"4px 10px",borderRadius:6,border:"1px solid #cbd5e1",fontSize:14,fontWeight:600,color:"#0f172a",background:"#fff",cursor:"pointer"},children:[a.jsx("option",{value:"QP1",children:"QP1"}),a.jsx("option",{value:"QP2",children:"QP2"})]})]})]})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>t("/obe"),onMouseEnter:b=>{b.currentTarget.style.background="#f8fafc",b.currentTarget.style.borderColor="#3b82f6"},onMouseLeave:b=>{b.currentTarget.style.background="#fff",b.currentTarget.style.borderColor="#e2e8f0"},style:{padding:"10px 20px",borderRadius:10,border:"1px solid #e2e8f0",background:"#fff",color:"#475569",cursor:"pointer",fontWeight:600,fontSize:15,transition:"all 0.2s ease",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:" Back to courses"})})]})}),a.jsx("div",{style:{display:"flex",gap:6,marginBottom:24,background:"#fff",padding:"8px",borderRadius:12,boxShadow:"0 1px 3px rgba(0,0,0,0.06)",flexWrap:"wrap"},"aria-label":"OBE Tabs",children:[{key:"lca_instructions",label:" Learner Centric Approach",icon:""},{key:"marks",label:" Mark Entry",icon:""},{key:"co_attainment",label:" CO Attainment",icon:""},{key:"cqi",label:" CQI",icon:""},{key:"internal_mark",label:" Internal Mark",icon:""}].map(b=>{const v=i===b.key;return a.jsx("button",{onClick:()=>{if(s(b.key),e){const w=encodeURIComponent(e),S=b.key==="lca_instructions"?"lca/instructions":String(b.key);t(`/obe/course/${w}/${S}`)}},onMouseEnter:w=>{v||(w.currentTarget.style.background="rgba(59,130,246,0.08)",w.currentTarget.style.color="#3b82f6")},onMouseLeave:w=>{v||(w.currentTarget.style.background="transparent",w.currentTarget.style.color="#64748b")},style:{padding:"10px 24px",borderRadius:8,border:"none",background:v?"linear-gradient(135deg, #3b82f6 0%, #2563eb 100%)":"transparent",color:v?"#fff":"#64748b",cursor:"pointer",fontWeight:v?600:500,fontSize:15,transition:"all 0.2s ease",boxShadow:v?"0 2px 8px rgba(37,99,235,0.2)":"none"},children:b.label},b.key)})}),a.jsxs("div",{children:[i==="marks"&&a.jsx(bOe,{courseId:n,classType:c,questionPaperType:p,enabledAssessments:m}),i==="lca_instructions"&&a.jsx(TK,{courseCode:n,courseName:o,initialTab:y}),i==="co_attainment"&&a.jsx(OK,{courseId:n,enabledAssessments:m,classType:c}),i==="internal_mark"&&a.jsx(AOe,{courseId:n,enabledAssessments:m}),i==="cqi"&&a.jsx(MK,{courseId:n})]})]})}):a.jsxs("div",{style:{padding:24},children:[a.jsx("p",{style:{color:"#666"},children:"No course selected."}),a.jsx("button",{onClick:()=>t("/obe"),className:"obe-btn obe-btn-primary",children:"Back"})]})}function COe(){var G,H,oe,de,W,V,ae,ee,C,Y,q;const e=bo(),[t]=KJ(),r=x.useMemo(()=>{const O=String(t.get("subject_code")||"").trim(),X=String(t.get("assessment")||"").trim().toLowerCase(),F=String(t.get("reason")||"Edit Marks").trim(),Q=t.get("teaching_assignment_id"),K=Q?Number(Q):void 0;return{subject_code:O,assessment:X,reason:F,teaching_assignment_id:Number.isFinite(K)?K:void 0}},[t]),[n,i]=x.useState(r.subject_code),[s,o]=x.useState(r.assessment),[l,c]=x.useState(r.reason),[u,d]=x.useState(String(r.teaching_assignment_id??"")),[f,p]=x.useState(!1),[h,m]=x.useState(null),[g,y]=x.useState(!1),[b,v]=x.useState(!1),[w,S]=x.useState(null),[j,k]=x.useState(null),[A,R]=x.useState(null),[M,B]=x.useState(null),E=x.useMemo(()=>{const O=String(u||"").trim();if(!O)return null;const X=Number(O);return Number.isFinite(X)?X:null},[u]);async function P(){y(!0),v(!0),S(null);try{if(!j){const O=await mr("/api/accounts/me/",{method:"GET"});O.ok&&k(await O.json())}if(E!=null&&M!==E)try{const O=await pc(E);R(O),B(E)}catch(O){R(null),B(null),S((O==null?void 0:O.message)||"Failed to load course details")}}catch(O){S((O==null?void 0:O.message)||"Failed to load profile")}finally{v(!1)}}async function D(){p(!0),m(null);try{const O=(u||"").trim(),X=O?Number(O):void 0;await jh({assessment:s,subject_code:n,reason:l,teaching_assignment_id:Number.isFinite(X)?X:void 0,force:!0}),alert("Edit request sent to IQAC."),e(-1)}catch(O){m((O==null?void 0:O.message)||"Request failed")}finally{p(!1)}}return a.jsxs("div",{style:{maxWidth:720},children:[a.jsx("div",{style:{fontWeight:900,fontSize:16,marginBottom:12},children:"OBE Request"}),a.jsx("div",{className:"obe-card",children:a.jsxs("div",{style:{display:"grid",gap:10},children:[a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Subject Code"}),a.jsx("input",{className:"obe-input",value:n,onChange:O=>i(O.target.value),placeholder:"e.g., GEA1268"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Assessment"}),a.jsx("input",{className:"obe-input",value:s,onChange:O=>o(O.target.value),placeholder:"cia1 | cia2 | model | formative1 | formative2"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Teaching Assignment ID (optional)"}),a.jsx("input",{className:"obe-input",value:u,onChange:O=>d(O.target.value),placeholder:"e.g., 123"})]}),a.jsxs("label",{style:{display:"grid",gap:6},children:[a.jsx("div",{className:"obe-small-muted",style:{fontWeight:800},children:"Reason"}),a.jsx("textarea",{className:"obe-input",value:l,onChange:O=>c(O.target.value),rows:3,placeholder:"Edit Marks",style:{resize:"vertical"}})]}),a.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:a.jsx("button",{className:"obe-btn obe-btn-secondary",type:"button",onClick:P,children:"View Reason"})}),h?a.jsx("div",{className:"obe-danger-pill",children:h}):null,a.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[a.jsx("button",{className:"obe-btn",type:"button",onClick:()=>e(-1),disabled:f,children:"Cancel"}),a.jsx("button",{className:"obe-btn obe-btn-primary",type:"button",onClick:D,disabled:f||!n||!s,children:f?"Requesting":"Request Edit"})]})]})}),g?a.jsx(Va,{children:a.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"flex-start",justifyContent:"center",overflowY:"auto",padding:16,paddingTop:40,paddingBottom:40,zIndex:80},onClick:()=>{b||y(!1)},children:a.jsxs("div",{style:{width:"min(760px, 96vw)",maxHeight:"min(86vh, 900px)",overflowY:"auto",overflowX:"hidden",background:"#fff",borderRadius:14,border:"1px solid #e5e7eb",padding:14},onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:950,fontSize:14,color:"#111827"},children:"View Reason"}),a.jsx("div",{style:{marginLeft:"auto",fontSize:12,color:"#6b7280"},children:String(s||"").toUpperCase()}),a.jsx("button",{type:"button",className:"obe-btn",style:{padding:"6px 10px",minHeight:34},onClick:()=>y(!1),disabled:b,children:"Close"})]}),b?a.jsx("div",{className:"obe-small-muted",style:{marginBottom:10},children:"Loading"}):null,w?a.jsx("div",{className:"obe-danger-pill",style:{marginBottom:10},children:w}):null,a.jsxs("div",{className:"obe-card",style:{padding:12,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:"Staff"}),a.jsxs("div",{style:{fontSize:13,color:"#374151",lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Name:"})," ",String(((G=j==null?void 0:j.profile)==null?void 0:G.name)||(j==null?void 0:j.username)||(j==null?void 0:j.email)||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Staff ID:"})," ",String(((H=j==null?void 0:j.profile)==null?void 0:H.staff_id)||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Department:"})," ",String(((de=(oe=j==null?void 0:j.profile)==null?void 0:oe.department)==null?void 0:de.short_name)||((V=(W=j==null?void 0:j.profile)==null?void 0:W.department)==null?void 0:V.name)||((ee=(ae=j==null?void 0:j.profile)==null?void 0:ae.department)==null?void 0:ee.code)||"")]})]})]}),a.jsxs("div",{className:"obe-card",style:{padding:12,marginBottom:10},children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:"Course"}),a.jsxs("div",{style:{fontSize:13,color:"#374151",lineHeight:1.35},children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Course Code:"})," ",String(((C=A==null?void 0:A.teaching_assignment)==null?void 0:C.subject_code)||n||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Course Name:"})," ",String(((Y=A==null?void 0:A.teaching_assignment)==null?void 0:Y.subject_name)||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Class/Section:"})," ",String(((q=A==null?void 0:A.teaching_assignment)==null?void 0:q.section_name)||"")]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Teaching Assignment ID:"})," ",E!=null?String(E):""]})]})]}),a.jsxs("div",{className:"obe-card",style:{padding:12},children:[a.jsx("div",{style:{fontWeight:900,marginBottom:6},children:"Reason"}),a.jsx("div",{style:{whiteSpace:"pre-wrap",fontSize:13,color:"#111827",lineHeight:1.45},children:String(l||"").trim()?String(l):""})]})]})})}):null]})}function EOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState(new Set);x.useEffect(()=>{m()},[]);async function m(){l(!0);try{const v=await mr("/api/academics/section-advisors/?page_size=0"),w=await mr("/api/academics/sections/?page_size=0"),S=await mr("/api/academics/hod-staff/?page_size=0"),j=await mr("/api/accounts/me/");async function k(A){if(!(A.headers.get("content-type")||"").includes("application/json")){const M=await A.text();throw console.error("Expected JSON but got:",M),new Error("Server returned non-JSON response (see console)")}return A.json()}if(v.ok){const A=await k(v);s(A.results||A)}if(w.ok){const A=await k(w);t(A.results||A)}if(S.ok){const A=await k(S);n(A.results||A)}if(j.ok){const A=await k(j);u(!!(A.permissions&&(A.permissions.includes("academics.assign_advisor")||A.permissions.includes("academics.add_sectionadvisor"))))}}catch(v){console.error(v),alert("Failed to load HOD assignments. Check console for server response.")}finally{l(!1)}}async function g(v,w){l(!0);try{if(!c)return alert("You do not have permission to assign advisors");const j=await mr("/api/academics/section-advisors/",{method:"POST",body:JSON.stringify({section_id:v,advisor_id:w,is_active:!0})});if(j.ok)h(k=>{const A=new Set(k);return A.delete(v),A}),await m();else{const k=await j.text();alert("Error: "+k)}}finally{l(!1)}}function y(v){h(w=>{const S=new Set(w);return S.has(v)?S.delete(v):S.add(v),S})}function b(v){return i.find(w=>w.section_id===v&&w.is_active)}return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(z0,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Advisor Assign"}),a.jsx("p",{className:"text-gray-600",children:"Assign advisors to sections and edit existing assignments"})]})]})}),o&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:a.jsxs("div",{className:"flex items-center justify-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),a.jsx("span",{className:"ml-3 text-gray-600",children:"Loading assignments..."})]})}),!o&&e.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filter by Department"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>v>0).map(v=>{var k,A;const w=e.filter(R=>(R.department_id||0)===v);if(w.length===0)return null;const S=((k=w[0])==null?void 0:k.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Dept ${v}`,j=d===v;return a.jsx("button",{onClick:()=>f(j?null:v),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${j?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S},v)})]})]}),a.jsx("div",{className:"space-y-6",children:Array.from(new Set(e.map(v=>v.department_id||0))).filter(v=>d===null||d===v).map(v=>{var k,A;const w=e.filter(R=>(R.department_id||0)===v);if(w.length===0)return null;const S=((k=w[0])==null?void 0:k.department_short_name)||((A=w[0])==null?void 0:A.department_code)||`Department ${v}`,j=r.filter(R=>(R.department||0)===v);return a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:[S," Department"]}),a.jsx("div",{className:"overflow-x-auto mb-6",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Section"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Select Advisor"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:w.map(R=>{const M=b(R.id),B=p.has(R.id),E=!M||B;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 text-gray-700",children:R.name}),a.jsx("td",{className:"px-4 py-3",children:E?a.jsxs("select",{id:`advisor-${R.id}`,className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",defaultValue:(M==null?void 0:M.advisor_id)||"",children:[a.jsx("option",{value:"",children:"-- Select Advisor --"}),j.map(P=>a.jsxs("option",{value:P.id,children:[P.staff_id," - ",P.user]},P.id))]}):a.jsx("div",{className:"text-gray-900 font-medium",children:(M==null?void 0:M.advisor)||"No advisor assigned"})}),a.jsx("td",{className:"px-4 py-3",children:M&&!B?a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>c&&y(R.id),title:"Edit Assignment",children:a.jsx(dh,{className:"h-4 w-4"})}):a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors ${c?"text-blue-600 hover:bg-blue-50 border border-blue-300":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>{if(!c)return;const D=document.getElementById(`advisor-${R.id}`).value;if(!D)return alert("Select an advisor first");g(R.id,Number(D))},title:"Save Assignment",children:a.jsx(rd,{className:"h-4 w-4"})}),B&&a.jsx("button",{className:"p-2 text-sm font-medium rounded-lg transition-colors text-red-600 hover:bg-red-50 border border-red-300",onClick:()=>y(R.id),title:"Cancel",children:a.jsx(bu,{className:"h-4 w-4"})}),M&&a.jsx("button",{disabled:!c,className:`p-2 text-sm font-medium rounded-lg transition-colors flex items-center justify-center ${c?"bg-red-50 text-red-700 border border-red-300 hover:bg-red-100":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:async()=>{if(c&&confirm("Delete advisor assignment for this section?"))try{const P=await mr(`/api/academics/section-advisors/${M.id}/`,{method:"DELETE"});if(!P.ok){const D=await P.text();return alert("Delete failed: "+D)}await m()}catch(P){console.error(P),alert("Delete failed")}},title:"Delete Assignment",children:a.jsx(Lm,{className:"h-4 w-4"})})]})})]},R.id)})})]})})]},v)})})]}),!o&&e.length===0&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-12",children:a.jsxs("div",{className:"text-center",children:[a.jsx(gs,{className:"mx-auto h-12 w-12 text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sections available"}),a.jsx("p",{className:"text-gray-600",children:"There are no sections available for advisor assignment at this time."})]})})]})})}const QF=e=>{if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id},JF=e=>{if(!e)return"";if(typeof e.user=="string")return e.user;if(e.user&&typeof e.user=="object"){const t=e.user.first_name||"",r=e.user.last_name||"";return`${t} ${r}`.trim()||e.user.username||e.staff_id}return e.staff_id||""};function TOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState([]),[S,j]=x.useState(!0),[k,A]=x.useState(new Set),[R,M]=x.useState(new Set),B=(()=>{try{return JSON.parse(localStorage.getItem("permissions")||"[]")}catch{return[]}})(),E=B.includes("academics.view_elective_teaching"),P=B.includes("academics.assign_elective_teaching");x.useEffect(()=>{D()},[]);async function D(){try{j(!0);const O=await mr("/api/academics/my-students/?page_size=0"),X=E||P?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0";let F=await mr(c&&X.includes("hod-staff")?`${X}&department=${c}`:X);if(F.status===403&&X.includes("hod-staff")){console.warn("hod-staff returned 403  falling back to advisor-staff endpoint");const T=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const I=await mr(T);I.ok&&(F=I)}catch(I){console.error("fallback to advisor-staff failed",I)}}const Q=await mr("/api/curriculum/department/?page_size=0"),K=await mr("/api/curriculum/elective/?page_size=0"),ne=await mr("/api/academics/teaching-assignments/?page_size=0"),re=async T=>{if(!(T.headers.get("content-type")||"").includes("application/json"))throw new Error("non-json");return T.json()};if(O.ok){const T=await re(O),I=(T.results||T).map(ie=>({id:ie.section_id,name:ie.section_name,batch:ie.batch,batch_regulation:ie.batch_regulation,department_id:ie.department_id,semester:ie.semester,department:ie.department}));t(I)}if(F.ok){const T=await re(F);let I=T.results||T;c&&(I=I.filter(ie=>ie.department&&ie.department.id===c||ie.department===c)),n(I)}if(Q.ok){const T=await re(Q),I=T.results||T;h(I),w(I.filter(U=>U.is_elective));const ie=new Map;I.forEach(U=>{U.department&&U.department.id&&ie.set(U.department.id,U.department)}),ie.size>0&&l(Array.from(ie.values()));try{const U=await mr("/api/academics/departments/?page_size=0");if(U.ok){const Z=await re(U),me=Z.results||Z;Array.isArray(me)&&me.length>0&&s(me)}else ie.size>0&&s(Array.from(ie.values()))}catch{ie.size>0&&s(Array.from(ie.values()))}}if(K.ok){const T=await re(K);b(T.results||T)}if(ne.ok){const T=await re(ne);g(T.results||T)}}catch(O){console.error(O),alert("Failed to load teaching assignment data")}finally{j(!1)}}x.useEffect(()=>{async function O(){try{const X=E||P?"/api/academics/hod-staff/?page_size=0":"/api/academics/advisor-staff/?page_size=0",F=c&&X.includes("hod-staff")?`${X}&department=${c}`:X,Q=await mr(F);let K=Q;if(Q.status===403&&X.includes("hod-staff")){console.warn("hod-staff returned 403 in loadStaff  trying advisor-staff");const T=c?`/api/academics/advisor-staff/?page_size=0&department=${c}`:"/api/academics/advisor-staff/?page_size=0";try{const I=await mr(T);if(I.ok)K=I;else if(I.status!==200)return}catch(I){console.error("fallback failed",I);return}}if(!K.ok)return;const ne=await K.json();let re=ne.results||ne;!X.includes("hod-staff")&&c&&(re=re.filter(T=>T.department&&T.department.id===c||T.department===c)),n(re)}catch(X){console.error("loadStaff failed",X)}}O()},[c]);const G=(O,X)=>m.find(F=>{const Q=F.section_details&&F.section_details.id===O||F.section_details&&F.section_details.id===O||F.section===O||F.section_id===O,K=F.curriculum_row_details&&F.curriculum_row_details.id===X||F.curriculum_row_details&&F.curriculum_row_details.id===X||F.curriculum_row&&F.curriculum_row.id===X||F.curriculum_row_id===X;return Q&&K}),H=(O,X)=>`${O}-${X}`,oe=(O,X)=>{const F=H(O,X);A(Q=>new Set(Q).add(F))},de=(O,X)=>{const F=H(O,X);A(Q=>{const K=new Set(Q);return K.delete(F),K})},W=(O,X)=>{const F=H(O,X);return k.has(F)},V=O=>m.find(X=>{const F=X.elective_subject_id||X.elective_subject&&X.elective_subject.id||X.elective_subject_details&&X.elective_subject_details.id||X.elective_subject;return Number(F)===Number(O)}),ae=O=>`elective-${O}`,ee=O=>{const X=ae(O);M(F=>new Set(F).add(X))},C=O=>{const X=ae(O);M(F=>{const Q=new Set(F);return Q.delete(X),Q})},Y=O=>{const X=ae(O);return R.has(X)};async function q(O,X,F){if(!X)return alert("Select staff"),Promise.reject("No staff selected");try{if(F){const Q={staff_id:Number(X),is_active:!0},K=await mr(`/api/academics/teaching-assignments/${F}/`,{method:"PATCH",body:JSON.stringify(Q)});if(K.ok)return alert("Updated successfully"),D(),Promise.resolve();{const ne=await K.text();return alert("Error: "+ne),Promise.reject(ne)}}else{const Q={elective_subject_id:O,staff_id:Number(X),is_active:!0},K=await mr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(Q)});if(K.ok)return alert("Assigned successfully"),D(),Promise.resolve();{const ne=await K.text();return alert("Error: "+ne),Promise.reject(ne)}}}catch(Q){return alert("Error: "+Q),Promise.reject(Q)}}return S?a.jsx("div",{style:{padding:"28px",minHeight:"100vh",background:"linear-gradient(180deg, #f7fbff 0%, #ffffff 60%)"},children:a.jsx("div",{style:{padding:"16px",borderRadius:"8px",background:"#fff",border:"1px solid rgba(15,23,42,0.04)",color:"#6b7280"},children:"Loading teaching assignments"})}):a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(z0,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teaching Assign"}),a.jsx("p",{className:"text-gray-600",children:"Assign faculty to courses and sections"})]})]})}),i.length>0&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filters"}),a.jsx("div",{className:"flex flex-wrap gap-4",children:i.length>0&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Department:"}),a.jsxs("select",{value:c??"",onChange:O=>u(O.target.value?Number(O.target.value):null),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"All Departments"}),i.map(O=>a.jsx("option",{value:O.id,children:O.short_name||O.code||O.name||`Dept ${O.id}`},O.id))]})]})})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(gs,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Course Assignments"})]}),e.length===0?a.jsx("div",{className:"text-center py-8",children:a.jsx("div",{className:"text-gray-500 text-sm",children:"No sections available for the selected filters."})}):a.jsx("div",{className:"space-y-6",children:e.map(O=>{const X=p.filter(F=>(O.semester?F.semester===O.semester:!0)&&(O.batch_regulation?F.regulation===O.batch_regulation.code:!0)&&!F.is_elective);return a.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:"text-lg font-semibold text-blue-900",children:[O.batch," / ",O.name]}),a.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[a.jsxs("p",{className:"text-blue-700 text-sm",children:["Semester: ",O.semester||"Not specified"]}),O.batch_regulation&&a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 border border-indigo-200",children:["Regulation: ",O.batch_regulation.code]})]})]}),a.jsxs("div",{className:"text-blue-600 text-sm font-medium",children:["Section ID: ",O.id]})]})}),X.length===0?a.jsx("div",{className:"text-gray-500 text-sm py-4",children:"No subjects available for this section."}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-50 border-b border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Code"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Assigned Staff"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Action"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:X.map(F=>{var ne,re;const Q=G(O.id,F.id),K=W(O.id,F.id);return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:F.course_code||"-"}),a.jsx("td",{className:"px-4 py-3 text-gray-700",children:F.course_name||"Unnamed"}),a.jsx("td",{className:"px-4 py-3",children:K?a.jsxs("select",{id:`staff-${O.id}-${F.id}`,defaultValue:((ne=Q==null?void 0:Q.staff_details)==null?void 0:ne.id)||(Q==null?void 0:Q.staff)||"",className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"-- select staff --"}),r.map(T=>a.jsxs("option",{value:T.id,children:[T.staff_id," - ",QF(T)]},T.id))]}):Q?a.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(re=Q.staff_details)==null?void 0:re.staff_id," - ",JF(Q.staff_details)]}):a.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),a.jsx("td",{className:"px-4 py-3 text-center",children:a.jsx("div",{className:"flex items-center justify-center gap-2",children:K?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>{const T=document.getElementById(`staff-${O.id}-${F.id}`);if(!(T!=null&&T.value))return alert("Select staff member");if(Q){const I={staff_id:Number(T.value),is_active:!0};mr(`/api/academics/teaching-assignments/${Q.id}/`,{method:"PATCH",body:JSON.stringify(I)}).then(ie=>{ie.ok?(alert("Updated successfully"),de(O.id,F.id),D()):ie.text().then(U=>alert("Error: "+U))})}else{const I={section_id:O.id,staff_id:Number(T.value),curriculum_row_id:F.id,is_active:!0};mr("/api/academics/teaching-assignments/",{method:"POST",body:JSON.stringify(I)}).then(ie=>{ie.ok?(alert("Assigned successfully"),de(O.id,F.id),D()):ie.text().then(U=>alert("Error: "+U))})}},className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors border border-green-300",title:"Save Assignment",children:a.jsx(rd,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>de(O.id,F.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:a.jsx(bu,{className:"h-4 w-4"})}),Q&&a.jsx("button",{onClick:async()=>{if(confirm("Delete teaching assignment for this subject/section?"))try{const T=await mr(`/api/academics/teaching-assignments/${Q.id}/`,{method:"DELETE"});if(T.ok)alert("Deleted"),de(O.id,F.id),D();else{const I=await T.text().catch(()=>null);alert("Failed: "+(I||T.status))}}catch(T){console.error(T),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:a.jsx(Lm,{className:"h-4 w-4"})})]}):a.jsx(a.Fragment,{children:a.jsx("button",{onClick:()=>oe(O.id,F.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:a.jsx(dh,{className:"h-4 w-4"})})})})})]},`${O.id}-${F.id}`)})})]})})]},O.id)})})]}),E&&a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Elective Subject Assignments"}),o.length>1&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Filter by Department"}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsx("button",{onClick:()=>f(null),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===null?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"All Departments"}),o.map(O=>a.jsx("button",{onClick:()=>f(O.id),className:`px-4 py-2 rounded-full text-sm font-medium transition-colors ${d===O.id?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:O.short_name||O.code||O.name||`Dept ${O.id}`},O.id))]})]}),a.jsx("div",{className:"space-y-4",children:v.filter(O=>!d||O.department&&O.department.id===d).length===0?a.jsx("div",{className:"text-gray-500 text-sm",children:"No elective parents found for the selected department."}):v.filter(O=>!d||O.department&&O.department.id===d).map(O=>a.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[a.jsx("div",{className:"flex justify-between items-center mb-4",children:a.jsx("div",{className:"font-semibold text-gray-900",children:O.course_name||O.course_code||"Elective"})}),a.jsx("div",{className:"space-y-3",children:(y&&y.filter(X=>X.parent===O.id)).map(X=>{var K,ne;const F=V(X.id),Q=Y(X.id);return console.log(`Elective ${X.course_code} (ID: ${X.id}):`,{opt:X,existingElectiveAssignment:F,allAssignments:m.filter(re=>re.subject&&(re.subject.includes(X.course_code)||re.subject.includes(X.course_name)))}),a.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border border-gray-200",children:[a.jsxs("div",{className:"flex-1 text-sm font-medium text-gray-900",children:[X.course_code||"-","  ",X.course_name||"-"]}),a.jsx("div",{className:"min-w-[200px]",children:Q?a.jsxs("select",{id:`elective-staff-${X.id}`,defaultValue:((K=F==null?void 0:F.staff_details)==null?void 0:K.id)||(F==null?void 0:F.staff)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-white text-gray-700 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"-- select staff --"}),r.map(re=>a.jsxs("option",{value:re.id,children:[re.staff_id," - ",QF(re)]},re.id))]}):F?a.jsxs("div",{className:"text-sm text-gray-900 font-medium",children:[(ne=F.staff_details)==null?void 0:ne.staff_id," - ",JF(F.staff_details)]}):a.jsx("div",{className:"text-sm text-gray-500 italic",children:"Not assigned"})}),a.jsx("div",{className:"flex items-center gap-2",children:Q?a.jsxs(a.Fragment,{children:[a.jsx("button",{disabled:!P,onClick:()=>{if(!P)return alert("No permission to assign electives");const re=document.getElementById(`elective-staff-${X.id}`);if(!(re!=null&&re.value))return alert("Select staff member");q(X.id,Number(re.value),F==null?void 0:F.id).then(()=>{C(X.id)}).catch(()=>{})},className:`p-2 rounded-lg transition-colors ${P?"text-green-600 hover:bg-green-50 border border-green-300":"text-gray-400 bg-gray-100 cursor-not-allowed border border-gray-300"}`,title:P?"Save Assignment":"No permission",children:a.jsx(rd,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>C(X.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Cancel",children:a.jsx(bu,{className:"h-4 w-4"})}),F&&a.jsx("button",{onClick:async()=>{if(confirm("Delete elective teaching assignment for this option?"))try{const re=await mr(`/api/academics/teaching-assignments/${F.id}/`,{method:"DELETE"});if(re.ok)alert("Deleted"),C(X.id),D();else{const T=await re.text().catch(()=>null);alert("Failed: "+(T||re.status))}}catch(re){console.error(re),alert("Failed to delete")}},className:"p-2 text-red-700 hover:bg-red-50 rounded-lg transition-colors border border-red-300",title:"Delete Assignment",children:a.jsx(Lm,{className:"h-4 w-4"})})]}):a.jsx(a.Fragment,{children:a.jsx("button",{onClick:()=>ee(X.id),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors border border-blue-300",title:"Edit Assignment",children:a.jsx(dh,{className:"h-4 w-4"})})})})]},X.id)})})]},O.id))})]})]})})}function POe(){const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState({});async function c(){t(!0),n(null);try{const m=await w9(),g=Array.isArray(m==null?void 0:m.results)?m.results:[];s(g)}catch(m){n((m==null?void 0:m.message)||"Failed to load requests")}finally{t(!1)}}x.useEffect(()=>{c()},[]);const u=x.useMemo(()=>[...i].sort((m,g)=>String(g.requested_at||"").localeCompare(String(m.requested_at||""))),[i]);function d(m){const g=String(m||"").trim();if(!g)return"?";const y=g.split(/\s+/g).filter(Boolean);return y.length===1?y[0].slice(0,2).toUpperCase():(y[0][0]+y[y.length-1][0]).toUpperCase()}function f(m){if(!m)return"";const g=new Date(m);return Number.isNaN(g.getTime())?String(m):g.toLocaleString()}async function p(m){l(g=>({...g,[m]:!0})),n(null);try{await N9(m),await c()}catch(g){n((g==null?void 0:g.message)||"Forward failed")}finally{l(g=>({...g,[m]:!1}))}}async function h(m){l(g=>({...g,[m]:!0})),n(null);try{await C9(m),await c()}catch(g){n((g==null?void 0:g.message)||"Reject failed")}finally{l(g=>({...g,[m]:!1}))}}return a.jsxs("div",{style:{maxWidth:1200,margin:"0 auto",padding:20},children:[a.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center",marginBottom:20},children:[a.jsx(sc,{size:24,color:"#9a3412"}),a.jsxs("div",{children:[a.jsx("div",{style:{fontSize:24,fontWeight:950,color:"#111827"},children:"HOD: OBE Edit Requests"}),a.jsx("div",{style:{color:"#6b7280",fontSize:14},children:"Approve requests from your department before they go to IQAC"})]}),a.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8,alignItems:"center"},children:a.jsxs("button",{className:"obe-btn obe-btn-secondary",onClick:c,disabled:e,children:[a.jsx(C2,{size:16,style:{marginRight:6}}),e?"Refreshing":"Refresh"]})})]}),r?a.jsxs("div",{style:{background:"#fef2f2",border:"1px solid #ef444433",color:"#991b1b",padding:12,borderRadius:12,marginBottom:20},children:[a.jsx(yN,{size:16,style:{marginRight:8,verticalAlign:"middle"}}),r]}):null,a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:10},children:[a.jsx("div",{style:{fontSize:16,fontWeight:950,color:"#111827"},children:"Pending with HOD"}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["(",u.length,")"]})]}),u.length===0?a.jsxs("div",{style:{textAlign:"center",padding:22,color:"#6b7280",border:"1px dashed #e5e7eb",borderRadius:14,background:"#fff"},children:[a.jsx(xN,{size:34,color:"#10b981",style:{marginBottom:8}}),a.jsx("div",{children:"No pending requests"})]}):a.jsx("div",{style:{display:"grid",gap:10},children:u.map(m=>{var v,w;const g=!!o[m.id],y=String(((v=m.staff)==null?void 0:v.name)||((w=m.staff)==null?void 0:w.username)||"Unknown"),b=m.scope==="MARK_MANAGER"?"Mark Manager":"Mark Entry";return a.jsxs("div",{style:{border:"1px solid #e5e7eb",borderRadius:14,background:"#fff",padding:12,display:"flex",gap:12,alignItems:"center"},children:[a.jsx("div",{style:{width:44,height:44,borderRadius:999,background:"#fff7ed",border:"1px solid #fed7aa",display:"grid",placeItems:"center",fontWeight:950,color:"#9a3412",flex:"0 0 auto"},children:d(y)}),a.jsxs("div",{style:{flex:1,minWidth:240},children:[a.jsx("div",{style:{fontWeight:900,color:"#111827"},children:y}),a.jsxs("div",{style:{fontSize:13,color:"#374151",fontWeight:700},children:[m.subject_code,"  ",a.jsx("span",{style:{color:"#2563eb",fontWeight:800},children:m.subject_name||m.subject_code})]}),a.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:[b,"  ",String(m.assessment||"").toUpperCase(),"  ",f(m.requested_at)]}),m.reason?a.jsxs("div",{style:{marginTop:6,fontSize:12,color:"#374151"},children:[a.jsx("span",{style:{fontWeight:800},children:"Reason:"})," ",String(m.reason)]}):null]}),a.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center",flex:"0 0 auto"},children:[a.jsxs("div",{style:{background:"#fef3c7",color:"#92400e",padding:"4px 8px",borderRadius:999,fontSize:12,fontWeight:800,whiteSpace:"nowrap"},children:[a.jsx(sc,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"Pending"]}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[a.jsxs("button",{className:"obe-btn obe-btn-success",onClick:()=>p(m.id),disabled:g,children:[a.jsx(Mte,{size:16,style:{marginRight:6}}),g?"Forwarding":"Forward to IQAC"]}),a.jsx("button",{className:"obe-btn obe-btn-danger",onClick:()=>h(m.id),disabled:g,children:g?"Rejecting":"Reject"})]})]})]},m.id)})})]})]})}function OOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1),[i,s]=x.useState(null);x.useEffect(()=>{o()},[]),x.useEffect(()=>{e.length>0&&i===null&&s(e[0].section_id)},[e]);async function o(){n(!0);try{const u=await mr("/api/academics/my-students/");if(!u.ok)throw new Error(await u.text());const d=await u.json();t(d.results||[])}catch(u){console.error(u),alert("Failed to load your students. See console for details.")}finally{n(!1)}}const l=e.find(u=>u.section_id===i),c=[...(l==null?void 0:l.students)||[]].sort((u,d)=>u.reg_no.localeCompare(d.reg_no));return r?a.jsx("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Gu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"text-slate-600 text-lg",children:"Loading student information..."})]})}):a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(Om,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Students"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"View and manage your assigned student profiles"})]})]}),a.jsx("div",{className:"px-4 py-2 bg-gradient-to-r from-slate-100 to-indigo-100 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-700"}),a.jsxs("span",{className:"text-sm font-semibold text-indigo-900",children:["Total: ",e.reduce((u,d)=>u+d.students.length,0)]})]})})]})}),e.length===0&&!r&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:a.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(ys,{className:"w-16 h-16 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"No Students Assigned"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned to your sections yet."})]})}),e.length>0&&a.jsx("div",{className:"mb-6 flex flex-wrap gap-3",children:e.map(u=>{const d=i===u.section_id;return a.jsxs("button",{onClick:()=>s(u.section_id),className:`px-5 py-2 rounded-full font-medium text-sm transition-all duration-200 flex items-center gap-2 ${d?"bg-gradient-to-r from-indigo-600 to-cyan-500 text-white shadow-lg shadow-indigo-200":"bg-white text-slate-700 border border-slate-200 hover:border-indigo-300 hover:bg-slate-50"}`,children:[u.section_name,a.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${d?"bg-white/25 text-white":"bg-slate-100 text-slate-700"}`,children:u.students.length})]},u.section_id)})}),c.length>0&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-indigo-50 border-b-2 border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"S.No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Registration No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Student Name"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-indigo-900",children:"Email"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map((u,d)=>a.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-medium text-slate-600",children:d+1})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-semibold text-slate-900",children:u.reg_no})}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xee,{className:"w-5 h-5 text-slate-400"}),a.jsx("span",{className:"text-sm font-medium text-slate-900",children:u.first_name&&u.last_name?`${u.first_name} ${u.last_name}`.trim():u.username})]})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("div",{className:"flex items-center gap-2 text-slate-600",children:u.email?a.jsxs(a.Fragment,{children:[a.jsx(bN,{className:"w-4 h-4 text-slate-400"}),a.jsx("span",{className:"text-sm",children:u.email})]}):a.jsx("span",{className:"text-sm text-slate-400",children:"-"})})})]},u.id))})]})})})]})}const MOe=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function ZF(e){if(!e)return"";if(typeof e=="string"){const i=e.trim();return i.split(/[\s\-\_]+/)[0]||i.slice(0,15)+(i.length>15?"":"")}if(e.course_code)return e.course_code;const t=e.course_name||e.course||e.subject_text||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(i=>i.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function LOe(){const[e,t]=x.useState(null),[r,n]=x.useState([]),[i,s]=x.useState([]),[o,l]=x.useState(!1),[c,u]=x.useState(null);x.useEffect(()=>{d()},[]);async function d(){try{const f=await mr("/api/accounts/me/");if(!f.ok)throw new Error(await f.text());const p=await f.json(),h=p.profile||{};u(p.id),h.section_id&&t(h.section_id)}catch(f){console.error(f)}}return x.useEffect(()=>{e&&(l(!0),(async()=>{try{const f=await mr(`/api/timetable/section/${e}/timetable/`);if(!f.ok)throw new Error(await f.text());let h=(await f.json()).results||[];n(h);const m=[];for(const g of h||[])for(const y of g.assignments||[])m.find(b=>b.id===y.period_id)||m.push({id:y.period_id,index:y.period_index,is_break:y.is_break,label:y.label});m.sort((g,y)=>(g.index||0)-(y.index||0)),s(m)}catch(f){console.error(f)}finally{l(!1)}})())},[e]),a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(xs,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),a.jsx("p",{className:"text-gray-600",children:"View your class schedule for the week"})]})]})}),o&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx(Gu,{className:"animate-spin h-5 w-5 text-indigo-600"}),a.jsx("span",{children:"Loading timetable..."})]})})}),!o&&!e&&a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ed,{className:"h-12 w-12 text-amber-500 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Section Not Assigned"}),a.jsx("p",{className:"text-gray-600",children:"You are not assigned to a section or your profile is incomplete."})]})}),!o&&e&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-slate-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left font-semibold text-gray-700 min-w-[100px] sticky left-0 bg-gradient-to-r from-slate-50 to-blue-50 z-10",children:"Day / Period"}),i.map(f=>a.jsx("th",{className:"px-4 py-3 text-left min-w-[140px]",children:a.jsx("div",{className:"text-sm font-bold text-indigo-700",children:f.is_break||f.is_lunch?f.label||(f.is_break?"Break":"Lunch"):f.label||`${f.start_time||""}${f.start_time&&f.end_time?" - ":""}${f.end_time||""}`})},`period-${f.id}`))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:MOe.map((f,p)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-bold text-gray-900 bg-gray-50 sticky left-0 z-10",children:f}),i.map(h=>{const g=((r.find(b=>b.day===p+1)||{assignments:[]}).assignments||[]).filter(b=>b.period_id===h.id),y=g.some(b=>b.is_special);return a.jsx("td",{className:`px-4 py-3 align-top ${y&&g.some(b=>!b.is_special)?"bg-red-50":""}`,children:h.is_break?a.jsx("div",{className:"flex items-center justify-center py-2",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:h.label||"Break"})}):g&&g.length?a.jsx("div",{className:"space-y-2",children:g.map((b,v)=>{var S,j;const w=y&&!b.is_special;return a.jsxs("div",{className:`rounded-lg p-2.5 ${b.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200"}`,children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight flex items-center gap-1",children:[a.jsx(gs,{className:"h-3 w-3"}),b.is_special?b.timetable_name||"Special":ZF(b.curriculum_row||b.subject_text),b.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",ZF(b.curriculum_row||b.subject_text)]})]}),a.jsxs("div",{className:"text-xs text-gray-700 mt-1 flex items-center gap-1",children:[a.jsx(ys,{className:"h-3 w-3"}),"Staff: ",((S=b.staff)==null?void 0:S.username)||""]}),w&&a.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden by special"}),b.is_special&&a.jsxs("div",{className:"text-xs text-amber-700 mt-1 flex items-center gap-1",children:[a.jsx(xs,{className:"h-3 w-3"}),b.date||"","  ",h.label||""]}),b.subject_batch&&a.jsxs("div",{className:"text-xs text-blue-700 mt-1 font-medium",children:["Batch: ",b.subject_batch.name]}),w&&b.elective_subject&&a.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["Elective: ",b.elective_subject.course_code||b.elective_subject.course_name]})]},`${b.id||((j=b.curriculum_row)==null?void 0:j.id)||v}`)})}):a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("span",{className:"text-gray-300 text-sm",children:""})})},`cell-${p}-${h.id}`)})]},`day-${p}`))})]})})]})]})})}const ROe=["Mon","Tue","Wed","Thu","Fri","Sat"];function eB(e){if(!e)return"";if(typeof e=="string"){const i=e.trim();return i.split(/[\s\-\_]+/)[0]||i.slice(0,15)+(i.length>15?"":"")}const t=(e==null?void 0:e.course_name)||(e==null?void 0:e.course)||(e==null?void 0:e.subject_text)||(e==null?void 0:e.course_code)||"",r=String(t).trim();if(!r)return"";const n=r.split(/[\s\-\_]+/).filter(i=>i.length>0);return n.length>0?n[0]:r.slice(0,15)+(r.length>15?"":"")}function FOe(e){var i,s;if(Array.isArray(e)){const o=[],l=new Set;for(const c of e){const u=c.section,d=c.subject_batch||(u==null?void 0:u.batch);let f="";d!=null&&d.name&&(f+=d.name),u!=null&&u.name&&(f+=(f?" / ":"")+u.name),f||(u!=null&&u.id?f="Sec "+u.id:(i=c.subject_batch)!=null&&i.name&&(f=c.subject_batch.name)),f&&!l.has(f)&&(o.push(f),l.add(f))}return o.length?o.join(" + "):""}const t=e.section,r=e.subject_batch||(t==null?void 0:t.batch);let n="";return r!=null&&r.name&&(n+=r.name),t!=null&&t.name&&(n+=(n?" / ":"")+t.name),n||(t!=null&&t.id?n="Sec "+t.id:(s=e.subject_batch)!=null&&s.name&&(n=e.subject_batch.name)),n||""}function BOe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState(!1);x.useEffect(()=>{o()},[]);async function o(){s(!0);try{const l=new Date().toISOString().slice(0,10),c=await mr(`/api/timetable/staff/?date=${l}`);if(!c.ok)throw new Error(await c.text());const u=await c.json();t(u.results||[]);const d=await mr("/api/timetable/templates/");if(d.ok){const f=await d.json(),p=f.find(h=>h.is_active)||f[0];if(p&&p.periods)n(p.periods);else{const h=[];for(const m of u.results||[])for(const g of m.assignments||[])h.find(y=>y.id===g.period_id)||h.push({id:g.period_id,index:g.period_index,is_break:g.is_break,is_lunch:g.is_lunch,label:g.label,start_time:g.start_time,end_time:g.end_time});h.sort((m,g)=>(m.index||0)-(g.index||0)),n(h)}}}catch(l){console.error(l)}finally{s(!1)}}return a.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:a.jsx(xs,{className:"h-6 w-6 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Timetable"}),a.jsx("p",{className:"text-gray-600",children:"View your assigned teaching schedule"})]})]})}),i?a.jsx("div",{className:"bg-white rounded-lg shadow-sm p-8",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),a.jsx("span",{children:"Loading timetable..."})]})})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(sc,{className:"h-5 w-5 text-blue-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Weekly Schedule"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700",children:"Day / Period"}),r.map(l=>a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-blue-700 min-w-[120px]",children:l.label||`${l.start_time||""}${l.start_time&&l.end_time?" - ":""}${l.end_time||""}`},l.id))]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:ROe.map((l,c)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3 font-semibold text-gray-900 bg-gray-50",children:l}),r.map(u=>{const f=((e.find(h=>h.day===c+1)||{assignments:[]}).assignments||[]).filter(h=>h.period_id===u.id),p=f.some(h=>h.is_special);return a.jsx("td",{className:`px-4 py-3 ${p&&f.some(h=>!h.is_special)?"bg-red-50":""}`,children:u.is_break||u.is_lunch?a.jsx("div",{className:"flex items-center justify-center",children:a.jsx("span",{className:"text-sm text-gray-500 italic",children:u.label||(u.is_break?"Break":"Lunch")})}):f&&f.length?a.jsx("div",{className:"space-y-2",children:(()=>{var m;const h={};for(const g of f){let y="";g.is_special?y=`special_${g.timetable_name||g.id}`:g.curriculum_row&&g.curriculum_row.id?y=`curr_${g.curriculum_row.id}`:g.subject_batch&&g.subject_batch.id?y=`batch_${g.subject_batch.id}`:g.elective_subject&&g.elective_subject.id?y=`elective_${g.elective_subject.id}`:g.subject_text?y=`subj_${(g.subject_text||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:y=`section_${((m=g.section)==null?void 0:m.id)||Math.random()}`,h[y]=h[y]||[],h[y].push(g)}return Object.keys(h).map((g,y)=>{const b=h[g],v=b[0],w=p&&!v.is_special,S=v.is_special?"bg-amber-50 border border-amber-200":w?"bg-red-50 border border-red-200":"bg-blue-50 border border-blue-200";return a.jsxs("div",{className:`rounded-lg p-2.5 ${S}`,children:[a.jsxs("div",{className:"font-semibold text-gray-900 text-xs leading-tight",children:[v.is_special?v.timetable_name||"Special":eB(v.elective_subject||v.curriculum_row||v.subject_text),v.is_special&&a.jsxs("span",{className:"text-amber-600 ml-1",children:[" ",eB(v.elective_subject||v.curriculum_row||v.subject_text)]})]}),a.jsx("div",{className:"text-xs text-blue-700 font-medium mt-1",children:FOe(b)}),w&&a.jsx("div",{className:"text-xs text-red-600 mt-1 font-medium",children:"Overridden"}),v.is_special&&a.jsx("div",{className:"text-xs text-amber-700 mt-1",children:v.date||""})]},y)})})()}):a.jsx("div",{className:"flex items-center justify-center py-4",children:a.jsx("span",{className:"text-gray-300 text-sm",children:""})})},u.id)})]},l))})]})})]})]})})}async function IOe(e){const t=e?`/api/academics/staff/${e}/assigned-subjects/`:"/api/academics/staff/assigned-subjects/",r=await mr(t);if(!r.ok)throw new Error("Failed to fetch assigned subjects");const n=await r.json();return n.results||n}async function wv(){const e=await mr("/api/academics/subject-batches/?page_size=0");if(!e.ok)throw new Error("Failed to fetch subject batches");const t=await e.json();return t.results||t}async function DOe(e){var i;const t=await mr("/api/academics/subject-batches/",{method:"POST",body:JSON.stringify(e)}),r=t.headers.get("content-type")||"",n=await t.text();if(!t.ok){const s=r.includes("application/json")&&((i=JSON.parse(n))==null?void 0:i.detail)||n;throw new Error(s)}return r.includes("application/json")?JSON.parse(n):n}function $Oe(){const[e,t]=x.useState([]),[r,n]=x.useState([]),[i,s]=x.useState({}),[o,l]=x.useState(!0),[c,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(""),[m,g]=x.useState([]),[y,b]=x.useState([]),[v,w]=x.useState(null),[S,j]=x.useState([]),[k,A]=x.useState(!1),[R,M]=x.useState([]),[B,E]=x.useState(null),[P,D]=x.useState([]);x.useEffect(()=>{G()},[]);async function G(){l(!0),u(null);try{const O=await IOe(),X=await wv();t(O),n(X)}catch(O){console.error(O),u((O==null?void 0:O.message)||"Failed to load assigned subjects")}finally{l(!1)}}async function H(O){var F;console.log("openPickerForAssignment clicked",O),u(null);const X=i[O.id]||`Batch for ${O.subject_code||O.subject_name||O.id}`;E(O),s(Q=>({...Q,[O.id]:X}));try{const Q=await mr(`/api/academics/sections/${O.section_id}/students/`);if(!Q.ok){const T=await Q.text();throw new Error(T||"Failed to load students")}const K=await Q.json();let ne=K.results||K;const re=O.curriculum_row_id||((F=O.curriculum_row)==null?void 0:F.id);if(re){const T=new Set;for(const I of r)if(I.curriculum_row&&I.curriculum_row.id===re)for(const ie of I.students||[])T.add(ie.id);ne=ne.filter(I=>!T.has(I.id))}M(ne),D(ne.map(T=>T.id)),A(!0)}catch(Q){console.error("openPickerForAssignment error",Q),u((Q==null?void 0:Q.message)||String(Q)),alert("Failed to load students: "+((Q==null?void 0:Q.message)||Q))}}async function oe(O){u(null),E(O),M([]),D([]);try{let X;if(O.section_id){const K=await mr(`/api/academics/sections/${O.section_id}/students/`);if(!K.ok)throw new Error(await K.text());X=await K.json()}else if(O.elective_subject_id){const K=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${O.elective_subject_id}`);if(!K.ok)throw new Error(await K.text());X=await K.json()}else throw new Error("No student mapping available for this assignment");const Q=(X.results||X||[]).map(K=>({id:Number(K.id),reg_no:String(K.reg_no??K.regno??""),name:String(K.username??K.name??K.full_name??""),section:K.section_name??K.section??null,section_id:K.section_id??null}));M(Q),D(Q.map(K=>K.id)),A(!0)}catch(X){console.error("openListStudents error",X),u((X==null?void 0:X.message)||String(X)),alert("Failed to load students: "+((X==null?void 0:X.message)||X))}}function de(O){D(X=>X.includes(O)?X.filter(F=>F!==O):[...X,O])}async function W(){if(!B)return;const O=r.map(K=>{const ne=String(K.name||"").match(/Batch\s*(\d+)/i);return ne?parseInt(ne[1],10):null}).filter(Boolean),Q={name:`Batch ${(O.length?Math.max(...O):0)+1}`,student_ids:P};B.curriculum_row_id&&(Q.curriculum_row_id=B.curriculum_row_id);try{await DOe(Q);const K=await wv();n(K),A(!1),M([]),E(null),alert("Batch created for subject")}catch(K){console.error(K),alert("Failed to create batch: "+((K==null?void 0:K.message)||K))}}async function V(O){if(f(O.id),h(O.name||""),w(O),b((O.students||[]).map(X=>X.id)),O.curriculum_row&&O.curriculum_row.id)try{const X=e.find(F=>F.curriculum_row_id===O.curriculum_row.id);if(X&&X.section_id){const F=await mr(`/api/academics/sections/${X.section_id}/students/`);if(F.ok){const Q=await F.json(),K=Q.results||Q;g(K)}}}catch(X){console.error("Failed to load students for batch editing:",X),g(O.students||[])}else g(O.students||[])}async function ae(){if(d)try{const O={name:p,student_ids:y},X=await mr(`/api/academics/subject-batches/${d}/`,{method:"PATCH",body:JSON.stringify(O)});if(!X.ok)throw new Error(await X.text());const F=await wv();n(F),ee(),alert("Batch updated successfully")}catch(O){console.error("saveBatchEdit failed",O),alert("Failed to update batch: "+((O==null?void 0:O.message)||O))}}function ee(){f(null),h(""),w(null),g([]),b([])}function C(O){b(X=>X.includes(O)?X.filter(F=>F!==O):[...X,O])}async function Y(O){if(confirm("Delete this batch?"))try{const X=await mr(`/api/academics/subject-batches/${O}/`,{method:"DELETE"});if(!X.ok)throw new Error(await X.text());const F=await wv();n(F),alert("Batch deleted")}catch(X){console.error("deleteBatch failed",X),alert("Failed to delete: "+((X==null?void 0:X.message)||X))}}const q={};return r.forEach(O=>{const X=O.curriculum_row&&O.curriculum_row.id?String(O.curriculum_row.id):"___no_cr";q[X]||(q[X]=[]),q[X].push(O)}),a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 via-white to-gray-50 p-6",children:[a.jsx("div",{className:"bg-gradient-to-r from-white to-blue-50 rounded-xl shadow-lg p-6 mb-6",children:a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-100 to-indigo-200 rounded-xl flex items-center justify-center",children:a.jsx(gs,{className:"w-6 h-6 text-blue-700"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Assigned Subjects"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View all subjects assigned to you for the current academic session"})]})]}),!o&&!c&&e.length>0&&a.jsxs("div",{className:"flex items-center gap-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white px-4 py-2 rounded-full",children:[a.jsx("span",{className:"text-sm font-medium",children:"Total Subjects"}),a.jsx("span",{className:"bg-white/20 text-white px-3 py-1 rounded-full text-sm font-semibold",children:e.length})]})]})}),o&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-16",children:[a.jsx("div",{className:"w-8 h-8 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin mb-4"}),a.jsx("p",{className:"text-gray-600 font-medium",children:"Loading your assigned subjects..."})]}),c&&!o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(ed,{className:"w-8 h-8 text-red-600"})}),a.jsx("p",{className:"text-red-600 font-medium mb-4",children:c}),a.jsx("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",onClick:G,children:"Try Again"})]}),!o&&!c&&e.length===0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(ote,{className:"w-8 h-8 text-gray-400"})}),a.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Subjects Assigned"}),a.jsx("p",{className:"text-gray-600",children:"You don't have any subjects assigned for the current session."})]}),!o&&!c&&e.length>0&&a.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gradient-to-r from-gray-50 to-blue-50 border-b-2 border-gray-200",children:[a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"S.No"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Section"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Batch"}),a.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-blue-700",children:"Semester"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:e.map((O,X)=>a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4",children:a.jsx("span",{className:"text-sm font-medium text-gray-900",children:X+1})}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-semibold text-gray-900",children:O.subject_name||"Unnamed Subject"}),O.subject_code&&a.jsx("div",{className:"text-sm text-blue-600 font-medium",children:O.subject_code})]}),a.jsx("div",{className:"flex flex-wrap gap-2",children:O.section_id?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>H(O),children:"Create Batch"}),a.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>oe(O),children:"List Students"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-1.5 rounded-lg text-xs font-medium transition-colors",onClick:()=>oe(O),children:"List Students"}),a.jsx("span",{className:"text-xs text-gray-500 px-2 py-1",children:"Department-wide elective"})]})})]})}),a.jsx("td",{className:"px-6 py-4",children:O.section_name?a.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 text-blue-700 px-3 py-1 rounded-full w-fit",children:[a.jsx(ys,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:O.section_name})]}):a.jsx("span",{className:"text-gray-400",children:""})}),a.jsx("td",{className:"px-6 py-4",children:O.batch?a.jsxs("div",{className:"flex items-center gap-2 bg-green-50 text-green-700 px-3 py-1 rounded-full w-fit",children:[a.jsx(xs,{className:"w-4 h-4"}),a.jsx("span",{className:"text-sm font-medium",children:O.batch})]}):a.jsx("span",{className:"text-gray-400",children:""})}),a.jsx("td",{className:"px-6 py-4",children:O.semester!=null?a.jsxs("span",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold",children:["Sem ",O.semester]}):a.jsx("span",{className:"text-gray-400",children:""})})]},O.id))})]})})}),a.jsx("div",{className:"mt-6",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[a.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-blue-600"}),"Student Subject Batches"]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Existing Batches"}),r.length===0&&a.jsxs("div",{className:"text-center py-8 text-gray-500",children:[a.jsx(ys,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No batches created yet"})]}),e.map(O=>{const X=O.curriculum_row_id?String(O.curriculum_row_id):null,F=X?q[X]||[]:[];return!F||F.length===0?null:a.jsxs("div",{className:"mb-6 border-b border-gray-100 pb-4 last:border-b-0",children:[a.jsx("div",{className:"font-bold text-gray-900 mb-3",children:O.subject_name||O.subject_code||"Unnamed Subject"}),a.jsx("div",{className:"space-y-3",children:F.map(Q=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:Q.name}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsxs("span",{className:"font-medium",children:[(Q.students||[]).length," students"]})})]}),a.jsxs("div",{className:"ml-4 flex gap-2",children:[a.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>V(Q),children:"Edit"}),a.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>Y(Q.id),children:"Delete"})]})]})},Q.id))})]},`subject-${O.id}`)}),(()=>{const O=r.filter(X=>{const F=X.curriculum_row&&X.curriculum_row.id?X.curriculum_row.id:null;return!F||!e.some(Q=>Q.curriculum_row_id===F)});return O.length===0?null:a.jsxs("div",{className:"mt-6",children:[a.jsx("div",{className:"font-bold text-gray-900 mb-3",children:"Other Batches"}),a.jsx("div",{className:"space-y-3",children:O.map(X=>a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:X.name}),a.jsx("div",{className:"text-sm text-gray-600",children:a.jsxs("span",{className:"font-medium",children:[(X.students||[]).length," students"]})})]}),a.jsxs("div",{className:"ml-4 flex gap-2",children:[a.jsx("button",{className:"bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>V(X),children:"Edit"}),a.jsx("button",{className:"bg-red-100 hover:bg-red-200 text-red-700 px-3 py-1.5 rounded-lg text-sm font-medium transition-colors",onClick:()=>Y(X.id),children:"Delete"})]})]})},`other-${X.id}`))})]})})()]})]})}),k&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:i[(B==null?void 0:B.id)||""]||"Create Batch"}),a.jsx("div",{className:"text-sm text-gray-600",children:(B==null?void 0:B.subject_name)||(B==null?void 0:B.subject_code)})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:()=>{A(!1),M([]),E(null)},children:"Cancel"}),a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:W,children:"Create Batch"})]})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-2",children:["Students (",R.length,")"]}),a.jsx("p",{className:"text-sm text-gray-600",children:"Select students to include in this batch"})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:R.map(O=>a.jsxs("label",{className:"flex items-center gap-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:P.includes(O.id),onChange:()=>de(O.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:O.username||O.full_name||O.reg_no}),O.reg_no&&a.jsx("div",{className:"text-xs text-gray-500",children:O.reg_no})]})]},O.id))})})]})]})}),d&&v&&a.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-200",children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-1",children:"Edit Batch"}),a.jsx("div",{className:"text-sm text-gray-600",children:"Modify batch name and student assignments"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium transition-colors",onClick:ee,children:"Cancel"}),a.jsx("button",{type:"button",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors",onClick:ae,children:"Save Changes"})]})]})}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-900 mb-2",children:"Batch Name"}),a.jsx("input",{type:"text",value:p,onChange:O=>h(O.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter batch name"})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center justify-between",children:[a.jsxs("span",{children:["Students (",y.length," selected)"]}),a.jsx("div",{className:"text-sm text-gray-600",children:"Click to add/remove students"})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:m.length===0?a.jsxs("div",{className:"text-center text-gray-500 py-4",children:[a.jsx(ys,{className:"w-8 h-8 mx-auto mb-2 text-gray-300"}),a.jsx("p",{children:"No students available for this batch"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:m.map(O=>a.jsxs("label",{className:`flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-colors ${y.includes(O.id)?"border-blue-300 bg-blue-50":"border-gray-200 hover:bg-gray-50"}`,children:[a.jsx("input",{type:"checkbox",checked:y.includes(O.id),onChange:()=>C(O.id),className:"w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:O.username||O.full_name||O.reg_no}),O.reg_no&&a.jsx("div",{className:"text-xs text-gray-500",children:O.reg_no})]})]},O.id))})})]})]})]})})]})}function UOe(){const[e,t]=x.useState(new Date().toISOString().slice(0,10)),[r,n]=x.useState([]),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState([]),[d,f]=x.useState({}),[p,h]=x.useState(!1),[m,g]=x.useState(!1),[y,b]=x.useState(!1),[v,w]=x.useState(new Date().toISOString().slice(0,7)),[S,j]=x.useState([]),[k,A]=x.useState({}),[R,M]=x.useState([]),[B,E]=x.useState(!1),[P,D]=x.useState({}),[G,H]=x.useState({}),[oe,de]=x.useState({}),[W,V]=x.useState(!1),[ae,ee]=x.useState(null),[C,Y]=x.useState(null);x.useEffect(()=>{O()},[e]);function q(Z){const me={};for(const Pe of Z){let je="";if(Pe.period&&Pe.period.index!==void 0){const Fe=Pe.period.index;Pe.subject_batch_id?je=`batch_${Fe}_${Pe.subject_batch_id}`:Pe.elective_subject_id?je=`elective_${Fe}_${Pe.teaching_assignment_id||Pe.elective_subject_id}`:Pe.subject?je=`subj_${Fe}_${String(Pe.subject||"").replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:je=`section_${Fe}_${Pe.section_id}`}else Pe.subject_batch_id?je=`batch_${Pe.subject_batch_id}`:Pe.elective_subject_id?je=`elective_${Pe.teaching_assignment_id||Pe.elective_subject_id}`:Pe.subject?je=`subj_${String(Pe.subject).replace(/[^A-Za-z0-9]/g,"").toLowerCase()}`:je=`section_${Pe.section_id}`;if(!me[je])me[je]={...Pe,section_ids:[Pe.section_id],section_names:[Pe.section_name],attendance_session_ids:[Pe.attendance_session_id]};else{const Fe=me[je];Fe.section_ids.includes(Pe.section_id)||Fe.section_ids.push(Pe.section_id),Pe.section_name&&!Fe.section_names.includes(Pe.section_name)&&Fe.section_names.push(Pe.section_name),Fe.attendance_session_ids=Array.from(new Set([...Fe.attendance_session_ids||[],Pe.attendance_session_id]))}}return Object.keys(me).map(Pe=>({...me[Pe],id:Pe}))}async function O(){s(!0);try{const Z=await mr(`/api/academics/staff/periods/?date=${e}`);if(!Z.ok)throw new Error("Failed to load periods");const me=await Z.json();n(me.results||[])}catch(Z){console.error("fetchPeriods",Z),n([])}finally{s(!1)}}function X(Z){var Pt;const me=Z.section_ids&&Array.isArray(Z.section_ids)&&Z.section_ids.length?Z.section_ids:[Z.section_id],Pe=r.filter(ut=>!ut||ut.attendance_session_locked||!me.includes(ut.section_id)||Z.id&&ut.id===Z.id?!1:!!(Z.subject_batch_id&&ut.subject_batch_id===Z.subject_batch_id||Z.teaching_assignment_id&&ut.teaching_assignment_id===Z.teaching_assignment_id||Z.elective_subject_id&&ut.elective_subject_id===Z.elective_subject_id||Z.subject&&ut.subject===Z.subject));if(Pe.length===0)return null;const je=[...Pe].sort((ut,Ke)=>ut.period.index-Ke.period.index),Fe=((Pt=Z.period)==null?void 0:Pt.index)||Z.period&&Z.period.index||0,_e=je.find(ut=>ut.period.index>Fe),He=[...je].reverse().find(ut=>ut.period.index<Fe),qe=4;return _e&&_e.period.index-Fe<=qe?_e:He&&Fe-He.period.index<=qe?He:null}function F(Z){const me=X(Z);me?(ee(Z),Y(me),V(!0)):Q(Z)}async function Q(Z){l(Z),u([]),f({}),s(!0);try{let me=[];if(Z.section_ids&&Array.isArray(Z.section_ids)&&Z.section_ids.length>1)if(Z.elective_subject_id){const _e=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${Z.elective_subject_id}`);_e.ok&&(me=(await _e.json()).results||[])}else{const _e=[];for(const qe of Z.section_ids)_e.push(mr(`/api/academics/sections/${qe}/students/`).then(Pt=>Pt.ok?Pt.json():{results:[]}).catch(()=>({results:[]})));const He=await Promise.allSettled(_e);for(const qe of He)if(qe.status==="fulfilled"){const Pt=qe.value||{},ut=Pt.results||Pt.students||[];me=me.concat(ut)}}else if(Z.elective_subject_id){const _e=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${Z.elective_subject_id}`);_e.ok&&(me=(await _e.json()).results||[])}else if(Z.subject_batch_id){const _e=await mr(`/api/academics/subject-batches/${Z.subject_batch_id}/`);if(_e.ok){const He=await _e.json();me=He.students||He.results||[]}}else{const _e=await mr(`/api/academics/sections/${Z.section_id}/students/`);_e.ok&&(me=(await _e.json()).results||[])}const Pe={};for(const _e of me||[])_e&&_e.id&&(Pe[_e.id]=_e);const je=Object.values(Pe);u((je||[]).map(_e=>({id:Number(_e.id),reg_no:String(_e.reg_no||_e.regno||String(_e.id)),name:String(_e.name??_e.full_name??_e.username??""),username:String(_e.username??_e.name??""),section:_e.section_name??_e.section??null,section_id:_e.section_id??null})));const Fe={};if((je||[]).forEach(_e=>Fe[_e.id]="P"),f(Fe),Z.attendance_session_id||Z.attendance_session_ids&&Z.attendance_session_ids.length)try{const He=(Z.attendance_session_ids&&Z.attendance_session_ids.length?Z.attendance_session_ids:[Z.attendance_session_id]).map(ut=>mr(`/api/academics/period-attendance/${ut}/`).then(Ke=>Ke.ok?Ke.json():null).catch(()=>null)),qe=await Promise.allSettled(He),Pt={...Fe};for(const ut of qe){if(ut.status!=="fulfilled"||!ut.value)continue;(ut.value.records||[]).forEach(ve=>{const Ae=ve.student_pk||ve.student&&ve.student.id||null;Ae&&(Pt[Ae]=ve.status||Pt[Ae]||"A")})}f(Pt)}catch(_e){console.error("load session records",_e)}}catch(me){console.error("openPeriod",me)}finally{s(!1)}}function K(Z,me){f(Pe=>({...Pe,[Z]:me}))}async function ne(){if(o){h(!0);try{const Z=c.map(He=>({student_id:He.id,status:d[He.id]||"P"})),me=o.consecutive_periods&&Array.isArray(o.consecutive_periods)&&o.consecutive_periods.length>0?o.consecutive_periods.map(He=>He.period_id):[o.period.id],Pe=o.section_ids&&Array.isArray(o.section_ids)&&o.section_ids.length>0?o.section_ids:[o.section_id],je={};for(const He of Pe){const qe=c.filter(Pt=>(Pt.section_id||null)===He).map(Pt=>({student_id:Pt.id,status:d[Pt.id]||"P"}));if(qe.length===0&&o.section_name){const Pt=new Set(String(o.section_name).split(" + ").map(Ke=>Ke.trim())),ut=c.filter(Ke=>Pt.has(String(Ke.section_name||Ke.section||"").trim())).map(Ke=>({student_id:Ke.id,status:d[Ke.id]||"P"}));je[He]=ut.length?ut:c.map(Ke=>({student_id:Ke.id,status:d[Ke.id]||"P"}))}else je[He]=qe.length?qe:c.map(Pt=>({student_id:Pt.id,status:d[Pt.id]||"P"}))}const Fe=[];for(const He of me)for(const qe of Pe){const Pt={section_id:qe,period_id:He,teaching_assignment_id:o.teaching_assignment_id??null,date:e,records:je[qe]||[]};console.log("Saving attendance for section",qe,"period",He,Pt);const ut=await mr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify(Pt)}),Ke=await(ut.ok?ut.json().catch(()=>null):ut.json().catch(()=>null));Fe.push({section:qe,period:He,ok:ut.ok,data:Ke})}const _e=Fe.filter(He=>!He.ok);if(_e.length)console.error("Some saves failed:",_e),alert("Attendance saved for some sections/periods, but failed for others. Check console for details.");else{await O();const He=o.combined_period_label||o.period&&(o.period.label||`Period ${o.period.index}`);alert(`Attendance saved successfully!

Date: ${e}
Period(s): ${He}
Sections: ${Pe.length}
Students: ${c.length}`),l(null)}}catch(Z){console.error("saveMarks error:",Z),alert("Failed to save attendance: "+(Z instanceof Error?Z.message:String(Z)))}finally{h(!1)}}}async function re(){var Z,me,Pe,je,Fe,_e;if(!(!ae||!C)){V(!1);try{const He=ae;let qe=[];if(He.section_ids&&Array.isArray(He.section_ids)&&He.section_ids.length>1){const Ae=He.section_ids.map(ce=>mr(`/api/academics/sections/${ce}/students/`).then(be=>be.ok?be.json():{results:[]}).catch(()=>({results:[]})));if(He.elective_subject_id){const ce=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${He.elective_subject_id}`);ce.ok&&(qe=(await ce.json()).results||[])}else{const ce=await Promise.allSettled(Ae);for(const be of ce)if(be.status==="fulfilled"){const mt=be.value||{};qe=qe.concat(mt.results||mt.students||[])}}}else if(He.elective_subject_id){const Ae=await mr(`/api/curriculum/elective-choices/?elective_subject_id=${He.elective_subject_id}`);Ae.ok&&(qe=(await Ae.json()).results||[])}else if(He.subject_batch_id){const Ae=await mr(`/api/academics/subject-batches/${He.subject_batch_id}/`);if(Ae.ok){const ce=await Ae.json();qe=ce.students||ce.results||[]}}else{const Ae=await mr(`/api/academics/sections/${He.section_id}/students/`);Ae.ok&&(qe=(await Ae.json()).results||[])}const Pt={};for(const Ae of qe||[])Ae&&Ae.id&&(Pt[Ae.id]=Ae);let ut=Object.values(Pt).map(Ae=>({id:Number(Ae.id),reg_no:String(Ae.reg_no||Ae.regno||String(Ae.id)),username:Ae.username||Ae.name||"",section_id:Ae.section_id||Ae.sectionId||null,section_name:Ae.section_name||Ae.section||""}));if((!ut||ut.length===0)&&He.section_ids&&Array.isArray(He.section_ids)&&He.section_ids.length>0){const Ae=He.section_ids.map(et=>mr(`/api/academics/sections/${et}/students/`).then(Ue=>Ue.ok?Ue.json():{results:[]}).catch(()=>({results:[]}))),ce=await Promise.allSettled(Ae),be=[];for(const et of ce)if(et.status==="fulfilled"){const Ue=et.value||{},It=Ue.results||Ue.students||[];be.push(...It)}const mt={};for(const et of be)et&&et.id&&(mt[et.id]=et);ut=Object.values(mt).map(et=>({id:Number(et.id),reg_no:String(et.reg_no||et.regno||String(et.id)),username:et.username||et.name||"",section_id:et.section_id||et.sectionId||null,section_name:et.section_name||et.section||""}))}const Ke={};ut.forEach(Ae=>Ke[Ae.id]="P"),u(ut),f(Ke);const lt=`${((Z=ae.period)==null?void 0:Z.label)||`Period ${(me=ae.period)==null?void 0:me.index}`} & ${((Pe=C.period)==null?void 0:Pe.label)||`Period ${(je=C.period)==null?void 0:je.index}`}`,ve=He.section_names&&He.section_names.length?He.section_names.join(" + "):He.section_name||"";l({...ae,consecutive_periods:[{period_id:ae.period.id,label:((Fe=ae.period)==null?void 0:Fe.label)||""},{period_id:C.period.id,label:((_e=C.period)==null?void 0:_e.label)||""}],combined_period_label:lt,section_name:ve,section_ids:He.section_ids||[He.section_id]})}catch(He){console.error("markBothPeriods error:",He),alert("Failed to prepare marking for both periods: "+(He instanceof Error?He.message:String(He)))}finally{V(!1),ee(null),Y(null)}}}function T(){ae&&(V(!1),Q(ae),ee(null),Y(null))}async function I(){var je;if(!o||!o.attendance_session_id){alert("No active attendance session to lock/unlock");return}const Z=o.attendance_session_locked,me=o.attendance_session_id;if(window.confirm(Z?"Are you sure you want to request an unlock for this attendance session? Unlocking requires approval.":"Are you sure you want to lock this attendance session? This will prevent any further changes to attendance records.")){g(!0);try{if(Z){const Fe=await mr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:o.attendance_session_id,note:""})});if(Fe.ok){const _e=await Fe.json();console.log("Unlock request created:",_e),alert('Unlock request submitted successfully! Check the "My Requests" button in the Analytics page to view the status.');try{l(He=>He&&{...He,unlock_request_status:_e.status,unlock_request_id:_e.id}),n(He=>He.map(qe=>qe.attendance_session_id&&me&&qe.attendance_session_id===me?{...qe,unlock_request_status:_e.status,unlock_request_id:_e.id}:qe))}catch(He){console.warn("Failed to update local unlock status",He)}}else{const _e=await Fe.json().catch(()=>({}));if(Fe.status===400&&((je=_e.detail)!=null&&je.includes("already pending")))alert("An unlock request for this session already exists and is pending approval. Please check the Requests section for status.");else throw new Error(_e.detail||"Failed to create unlock request")}}else{const Fe=await mr(`/api/academics/period-attendance/${o.attendance_session_id}/lock/`,{method:"POST"});if(!Fe.ok){const He=await Fe.json().catch(()=>({}));throw new Error(He.detail||"Failed to lock session")}const _e=await Fe.json();console.log("Session locked successfully:",_e),l({...o,attendance_session_locked:_e.is_locked}),await O(),alert("Attendance session locked successfully!")}}catch(Fe){console.error("toggleLock error:",Fe),alert("Failed to perform lock/unlock: "+(Fe instanceof Error?Fe.message:String(Fe)))}finally{g(!1)}}}async function ie(){try{const Z=await mr("/api/timetable/staff/");if(!Z.ok)throw new Error("Failed to load assignments");const me=await Z.json(),Pe=[];for(const je of me.results||[]){const Fe=je.day;for(const _e of je.assignments||[])Pe.push({..._e,_day:Fe})}await U(v,Pe),j(Pe),b(!0),A({}),D({}),H({})}catch(Z){console.error("openBulkModal",Z),alert("Failed to open bulk modal")}}async function U(Z,me){var Pe,je;try{const[Fe,_e]=Z.split("-").map(ve=>parseInt(ve)),He=new Date(Fe,_e-1,1).toISOString().slice(0,10),qe=new Date(Fe,_e,0).toISOString().slice(0,10),Pt=await mr(`/api/academics/period-attendance/?date_after=${He}&date_before=${qe}`);if(!Pt.ok){console.warn("Failed to load existing sessions"),de({});return}const Ke=(await Pt.json()).results||[],lt={};for(const ve of Ke){const Ae=ve.date,ce=((Pe=ve.section)==null?void 0:Pe.id)||ve.section_id,be=((je=ve.period)==null?void 0:je.id)||ve.period_id;if(!Ae||!ce||!be)continue;const mt=new Date(Ae),et=mt.getDay()===0?7:mt.getDay(),Ue=me.find(It=>{var ht,Lt;return It._day===et&&(It.period_id===be||((ht=It.period)==null?void 0:ht.id)===be)&&(It.section_id===ce||((Lt=It.section)==null?void 0:Lt.id)===ce)});if(Ue){const It=Ue.id?String(Ue.id):`${Ue._day}_${be}_${ce}`;lt[It]||(lt[It]=new Set),lt[It].add(Ae)}}de(lt),console.log("Loaded marked sessions:",lt)}catch(Fe){console.error("Error loading marked sessions:",Fe),de({})}}return x.useEffect(()=>{y&&S.length>0&&U(v,S)},[v]),x.useEffect(()=>{async function Z(){var Pe,je,Fe,_e;if(!Object.keys(k).filter(He=>k[He]).length){M([]);return}E(!0);try{const He=[];for(const ut of S){const Ke=ut.id?String(ut.id):`${ut._day}_${ut.period_id}_${ut.section_id}`;if(k[Ke]){if(ut.elective_subject_id)He.push(mr(`/api/curriculum/elective-choices/?elective_subject_id=${ut.elective_subject_id}`).then(lt=>lt.ok?lt.json():{results:[]}));else if(ut.subject_batch_id||(Pe=ut.subject_batch)!=null&&Pe.id){const lt=ut.subject_batch_id||((je=ut.subject_batch)==null?void 0:je.id);He.push(mr(`/api/academics/subject-batches/${lt}/`).then(ve=>ve.ok?ve.json():{students:[]}))}else if(ut.section_id||(Fe=ut.section)!=null&&Fe.id){const lt=ut.section_id||((_e=ut.section)==null?void 0:_e.id);He.push(mr(`/api/academics/sections/${lt}/students/`).then(ve=>ve.ok?ve.json():{results:[]}))}}}const qe=await Promise.allSettled(He),Pt=[];for(const ut of qe){if(ut.status!=="fulfilled")continue;const Ke=ut.value||{},lt=Ke.results||Ke.students||[];for(const ve of lt)!ve||!ve.id||Pt.find(Ae=>Ae.id===ve.id)||Pt.push({id:ve.id,reg_no:ve.reg_no||ve.regno||String(ve.id),username:ve.username||ve.name||""})}M(Pt),H(ut=>{const Ke={...ut};for(const lt of Pt)Ke[lt.id]===void 0&&(Ke[lt.id]=!1);return Ke})}catch(He){console.error("loadAgg",He),M([])}finally{E(!1)}}Z()},[k,S]),a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(xs,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mark Attendance"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Record student attendance for periods"})]})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-4 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("label",{className:"text-sm font-medium text-slate-700 flex items-center gap-2",children:[a.jsx(sc,{className:"w-4 h-4 text-indigo-600"}),"Select Date:"]}),a.jsx("input",{type:"date",value:e,onChange:Z=>t(Z.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-600"}),"Assigned Periods"]})}),a.jsx("div",{className:"p-6",children:i?a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx(Gu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"ml-3 text-slate-600",children:"Loading periods..."})]}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[q(r).map(Z=>a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 bg-white hover:shadow-md transition-shadow",children:[a.jsx("div",{className:"flex items-start justify-between mb-2",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:Z.period.label||`Period ${Z.period.index}`}),a.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-slate-600 mb-1",children:[a.jsx(sc,{className:"w-4 h-4"}),Z.period.start_time||"",Z.period.start_time&&Z.period.end_time?`  ${Z.period.end_time}`:""]}),a.jsx("div",{className:"text-sm text-slate-700 mb-1",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-md bg-blue-100 text-blue-800 font-medium",children:Z.section_names&&Z.section_names.length?Z.section_names.join(" + "):Z.section_name})}),a.jsx("div",{className:"text-sm italic text-slate-600",children:Z.subject_display||Z.subject||"No subject"}),Z.unlock_request_status&&a.jsxs("div",{className:"mt-2",children:[Z.unlock_request_status==="PENDING"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-amber-100 text-amber-800 border border-amber-300 rounded-md text-xs font-medium",children:"Pending"}),Z.unlock_request_status==="APPROVED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-green-100 text-green-800 border border-green-300 rounded-md text-xs font-medium",children:"Approved"}),Z.unlock_request_status==="REJECTED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 bg-red-100 text-red-800 border border-red-300 rounded-md text-xs font-medium",children:"Rejected"})]})]})}),a.jsx("div",{className:"mt-3",children:Z.attendance_session_locked?a.jsxs("button",{onClick:()=>Q(Z),className:"w-full px-3 py-2 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium hover:bg-amber-200 flex items-center justify-center gap-2",children:[a.jsx(a0,{className:"w-4 h-4"}),Z.attendance_session_id?"View Locked Session":"View Locked Period"]}):a.jsx("button",{onClick:()=>F(Z),className:"w-full px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-2",children:Z.attendance_session_id?a.jsxs(a.Fragment,{children:[a.jsx(Md,{className:"w-4 h-4"}),"Open Session"]}):a.jsxs(a.Fragment,{children:[a.jsx(xs,{className:"w-4 h-4"}),"Take Attendance"]})})})]},Z.id)),!r.length&&a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(xs,{className:"w-12 h-12 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Periods Found"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"No periods assigned for this date"})]}),a.jsx("div",{className:"col-span-full mt-2",children:a.jsx("button",{onClick:ie,className:"w-full px-4 py-3 border-2 border-dashed border-indigo-300 text-indigo-600 rounded-lg font-medium hover:bg-indigo-50 transition-colors",children:"Bulk Mark (All Assignments)"})})]})})]}),o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 mb-6",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("h3",{className:"text-lg font-semibold text-slate-900",children:[o.combined_period_label||o.period.label||`Period ${o.period.index}`,"  ",o.section_name,a.jsxs("span",{className:"ml-3 inline-flex items-center px-2 py-0.5 rounded-md bg-slate-100 text-slate-700 text-sm font-medium",children:[c.length," student",c.length!==1?"s":""]})]}),o.attendance_session_locked&&a.jsxs(a.Fragment,{children:[a.jsxs("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-100 text-amber-800 border border-amber-300 rounded-lg text-sm font-medium",children:[a.jsx(a0,{className:"w-3.5 h-3.5"}),"Locked"]}),o.unlock_request_status==="PENDING"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-amber-50 text-amber-800 border border-amber-200 rounded-lg text-sm font-medium ml-3",children:"Pending"}),o.unlock_request_status==="APPROVED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-green-50 text-green-800 border border-green-200 rounded-lg text-sm font-medium ml-3",children:"Approved"}),o.unlock_request_status==="REJECTED"&&a.jsx("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 bg-red-50 text-red-800 border border-red-200 rounded-lg text-sm font-medium ml-3",children:"Rejected"})]})]}),a.jsxs("button",{onClick:()=>l(null),className:"px-3 py-1.5 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[a.jsx(bu,{className:"w-4 h-4"}),"Close"]})]}),a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Student"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Status"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:c.map(Z=>{const me=d[Z.id]||"P",Pe={P:"bg-green-50 text-green-800 border-green-300",A:"bg-red-50 text-red-800 border-red-300",LEAVE:"bg-amber-50 text-amber-800 border-amber-300",OD:"bg-blue-50 text-blue-800 border-blue-300",LATE:"bg-indigo-50 text-indigo-800 border-indigo-300"},je={P:"bg-green-600",A:"bg-red-600",LEAVE:"bg-amber-600",OD:"bg-blue-600",LATE:"bg-indigo-600"},Fe=Pe[me]||Pe.P,_e=je[me]||je.P;return a.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4 text-sm font-medium text-slate-900",children:Z.reg_no}),a.jsx("td",{className:"py-3 px-4 text-sm text-slate-700",children:Z.username}),a.jsx("td",{className:"py-3 px-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:`inline-block w-3 h-3 rounded-full mr-2 ${_e}`}),a.jsxs("div",{className:"relative inline-block",children:[a.jsxs("select",{value:d[Z.id]||"P",onChange:He=>K(Z.id,He.target.value),disabled:o.attendance_session_locked,className:`appearance-none px-3 py-1.5 pr-8 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent ${Fe} ${o.attendance_session_locked?"disabled:bg-slate-100 disabled:text-slate-500 disabled:cursor-not-allowed":""}`,children:[a.jsx("option",{value:"P",children:"Present"}),a.jsx("option",{value:"A",children:"Absent"}),a.jsx("option",{value:"LEAVE",children:"Leave"}),a.jsx("option",{value:"OD",children:"On Duty"}),a.jsx("option",{value:"LATE",children:"Late"})]}),a.jsx(Hee,{className:"w-4 h-4 text-slate-400 absolute right-2 top-1/2 -translate-y-1/2 pointer-events-none"})]})]})})]},Z.id)})})]})}),a.jsxs("div",{className:"mt-6 flex flex-wrap gap-3",children:[a.jsx("button",{onClick:ne,disabled:p||o.attendance_session_locked,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-300 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:p?a.jsxs(a.Fragment,{children:[a.jsx(Gu,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(rd,{className:"w-4 h-4"}),"Save Attendance"]})}),o.attendance_session_id&&a.jsx("button",{onClick:I,disabled:m,className:`px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 ${o.attendance_session_locked?"bg-amber-600 hover:bg-amber-700 disabled:bg-amber-300 text-white":"bg-slate-600 hover:bg-slate-700 disabled:bg-slate-300 text-white"}`,children:m?a.jsxs(a.Fragment,{children:[a.jsx(Gu,{className:"w-4 h-4 animate-spin"}),o.attendance_session_locked?"Unlocking...":"Locking..."]}):a.jsx(a.Fragment,{children:o.attendance_session_locked?a.jsxs(a.Fragment,{children:[a.jsx(mte,{className:"w-4 h-4"}),"Unlock Session"]}):a.jsxs(a.Fragment,{children:[a.jsx(a0,{className:"w-4 h-4"}),"Lock Session"]})})})]})]})]}),y&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-3xl max-h-[85vh] overflow-y-auto shadow-2xl",children:[a.jsx("div",{className:"sticky top-0 bg-white border-b border-slate-200 px-6 py-4 rounded-t-xl",children:a.jsx("h3",{className:"text-xl font-bold text-slate-900",children:"Bulk Mark Attendance"})}),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2 flex items-center gap-2",children:[a.jsx(xs,{className:"w-4 h-4 text-indigo-600"}),"Select Month:"]}),a.jsx("input",{type:"month",value:v,onChange:Z=>w(Z.target.value),className:"px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Assignments"}),a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-60 overflow-y-auto bg-slate-50",children:[a.jsxs("label",{className:"flex items-center gap-2 mb-3 text-sm font-medium text-slate-700",children:[a.jsx("input",{type:"checkbox",checked:Object.keys(k).length>0&&Object.values(k).every(Boolean),onChange:Z=>{const me=Z.target.checked,Pe={};for(const je of S){const Fe=je.id?String(je.id):`${je._day}_${je.period_id}_${je.section_id}`;Pe[Fe]=me}A(Pe)},className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),"Select / Deselect all"]}),a.jsx("div",{className:"space-y-2",children:(()=>{const Z=S.filter(me=>{const Pe=me.id?String(me.id):`${me._day}_${me.period_id}_${me.section_id}`,je=oe[Pe];if(!je)return!0;try{const[Fe,_e]=v.split("-").map(Pt=>parseInt(Pt)),He=new Date(Fe,_e,0).getDate();let qe=0;for(let Pt=1;Pt<=He;Pt++){const ut=new Date(Fe,_e-1,Pt);(ut.getDay()===0?7:ut.getDay())===me._day&&qe++}return je.size<qe}catch{return!0}});return Z.length===0?a.jsxs("div",{className:"text-center py-8 text-slate-600",children:[a.jsx(Md,{className:"w-12 h-12 text-green-500 mx-auto mb-2"}),a.jsx("p",{className:"font-medium",children:"All assignments are fully marked for this month!"})]}):Z.map(me=>{var _e;const Pe=me.id?String(me.id):`${me._day}_${me.period_id}_${me.section_id}`,je=oe[Pe],Fe=je?je.size:0;return a.jsxs("label",{className:"flex items-start gap-3 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:!!k[Pe],onChange:()=>A(He=>({...He,[Pe]:!He[Pe]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500 mt-0.5"}),a.jsxs("div",{className:"flex-1 text-sm",children:[a.jsxs("div",{className:"font-medium text-slate-900",children:[me.label||`Period ${me.period_index}`,"  ",["Mon","Tue","Wed","Thu","Fri","Sat"][me._day-1]||`Day ${me._day}`,me.start_time?` ${me.start_time}${me.end_time?" - "+me.end_time:""}`:""]}),a.jsxs("div",{className:"text-xs text-slate-600 mt-0.5",children:[me.section_name||((_e=me.section)==null?void 0:_e.name)||(me.section_id?`Section ${me.section_id}`:""),"  ",me.subject_display||me.subject_text||"",Fe>0&&a.jsxs("span",{className:"ml-2 text-green-600 font-medium",children:["(",Fe," day",Fe!==1?"s":""," marked)"]})]})]})]},Pe)})})()})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:"Dates (month view for selected assignments)"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{try{const[Z,me]=v.split("-").map(qe=>parseInt(qe)),Pe=new Date(Z,me,0),je=new Set;for(const qe of S){const Pt=qe.id?String(qe.id):`${qe._day}_${qe.period_id}_${qe.section_id}`;k[Pt]&&je.add(qe._day)}const Fe=[];for(let qe=1;qe<=Pe.getDate();qe++){const Pt=new Date(Z,me-1,qe),ut=Pt.getDay()===0?7:Pt.getDay();je.size>0&&je.has(ut)&&Fe.push(Pt.toISOString().slice(0,10))}const _e=Object.keys(k).filter(qe=>k[qe]),He=Fe.filter(qe=>_e.length===0?!0:_e.some(Pt=>{const ut=oe[Pt];return!ut||!ut.has(qe)}));return He.length===0&&_e.length>0?a.jsxs("div",{className:"text-center py-4 text-slate-600",children:[a.jsx(Md,{className:"w-8 h-8 text-green-500 mx-auto mb-2"}),a.jsx("p",{className:"text-sm",children:"All dates are already marked for selected assignments"})]}):He.map(qe=>{const Pt=_e.filter(ut=>{const Ke=oe[ut];return Ke&&Ke.has(qe)}).length;return a.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-1.5 border border-slate-300 rounded-lg text-sm hover:bg-slate-100 cursor-pointer transition-colors",children:[a.jsx("input",{type:"checkbox",checked:!!P[qe],onChange:()=>D(ut=>({...ut,[qe]:!ut[qe]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),a.jsxs("span",{children:[qe,Pt>0&&_e.length>1&&a.jsxs("span",{className:"ml-1 text-xs text-amber-600",children:["(",Pt,"/",_e.length," marked)"]})]})]},qe)})}catch{return a.jsx("div",{})}})()})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-semibold text-slate-900 mb-3",children:["Students (derived from selected assignments)",a.jsxs("span",{className:"ml-2 text-sm text-slate-600",children:["(",R.length," student",R.length!==1?"s":"",")"]})]}),a.jsxs("div",{className:"border border-slate-200 rounded-lg p-4 max-h-64 overflow-y-auto bg-slate-50",children:[B&&a.jsxs("div",{className:"flex items-center justify-center py-8 text-slate-600",children:[a.jsx(Gu,{className:"w-6 h-6 animate-spin mr-2"}),"Loading students..."]}),!B&&R.length===0&&a.jsx("div",{className:"text-center py-8 text-slate-600",children:"No students for selected assignments"}),!B&&R.length>0&&a.jsx("div",{className:"space-y-1",children:R.map(Z=>a.jsxs("label",{className:"flex items-center gap-2 p-2 hover:bg-white rounded-lg transition-colors cursor-pointer",children:[a.jsx("input",{type:"checkbox",checked:!!G[Z.id],onChange:me=>H(Pe=>({...Pe,[Z.id]:!Pe[Z.id]})),className:"w-4 h-4 text-indigo-600 border-slate-300 rounded focus:ring-indigo-500"}),a.jsxs("span",{className:"text-sm text-slate-900",children:[Z.reg_no,"  ",Z.username]})]},Z.id))})]})]})]}),a.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-slate-200 px-6 py-4 flex gap-3 rounded-b-xl",children:[a.jsxs("button",{onClick:async()=>{var je,Fe,_e,He;const Z=Object.keys(P).filter(qe=>P[qe]);if(!Z.length){alert("Select at least one date");return}const me=[];for(const qe of S){const Pt=qe.id?String(qe.id):`${qe._day}_${qe.period_id}_${((je=qe.section)==null?void 0:je.id)||qe.section_id}`;if(!k[Pt])continue;const ut=qe.section_id||qe.section&&(qe.section.id||qe.section.pk)||((Fe=qe.section)==null?void 0:Fe.pk)||((_e=qe.section)==null?void 0:_e.id),Ke=qe.period_id||qe.period&&(qe.period.id||qe.period_id)||((He=qe.period)==null?void 0:He.id)||qe.period_id,lt=Number(ut),ve=Number(Ke);!Number.isFinite(lt)||!Number.isFinite(ve)||me.push({section_id:lt,period_id:ve})}const Pe=Object.keys(G).filter(qe=>G[Number(qe)]).map(qe=>Number(qe));if(!me.length){alert("No assignments selected");return}if(!Pe.length){alert("No students selected");return}try{const qe=await mr("/api/academics/period-attendance/bulk-mark/",{method:"POST",body:JSON.stringify({assignments:me,dates:Z,student_ids:Pe})});if(!qe.ok){let Pt="Failed";try{const ut=await qe.json();Pt=JSON.stringify(ut)}catch{try{Pt=await qe.text()}catch{}}alert("Failed: "+Pt);return}alert("Bulk attendance saved"),b(!1)}catch(qe){console.error("bulk save",qe),alert("Failed to save bulk attendance")}},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2",children:[a.jsx(rd,{className:"w-4 h-4"}),"Save Bulk"]}),a.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Close"})]})]})}),W&&ae&&C&&a.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md shadow-2xl",children:[a.jsx("div",{className:"bg-gradient-to-br from-amber-500 to-orange-600 px-6 py-4 rounded-t-xl",children:a.jsxs("div",{className:"flex items-center gap-3 text-white",children:[a.jsx(ed,{className:"w-6 h-6"}),a.jsx("h3",{className:"text-xl font-bold",children:"Consecutive Periods Detected"})]})}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[a.jsxs("p",{className:"text-sm text-slate-700 mb-3",children:["The same subject has consecutive periods",Math.abs(C.period.index-ae.period.index)>1?" (with break/lunch in between)":"",":"]}),a.jsxs("div",{className:"space-y-2 mb-3",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:ae.period.label||`Period ${ae.period.index}`}),a.jsxs("span",{className:"text-slate-600",children:["(",ae.period.start_time," - ",ae.period.end_time,")"]})]}),Math.abs(C.period.index-ae.period.index)>1&&a.jsx("div",{className:"flex items-center gap-2 text-sm pl-4",children:a.jsxs("span",{className:"text-slate-500 italic",children:[" ",Math.abs(C.period.index-ae.period.index)-1," period(s) in between (break/lunch)"]})}),a.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[a.jsx("div",{className:"w-2 h-2 rounded-full bg-indigo-600"}),a.jsx("span",{className:"font-semibold text-slate-900",children:C.period.label||`Period ${C.period.index}`}),a.jsxs("span",{className:"text-slate-600",children:["(",C.period.start_time," - ",C.period.end_time,")"]})]})]}),a.jsxs("p",{className:"text-sm font-medium text-slate-900",children:["Subject: ",a.jsx("span",{className:"text-indigo-600",children:ae.subject||ae.subject_display||"Same Subject"})]})]}),a.jsx("p",{className:"text-sm text-slate-600",children:"Would you like to mark attendance for both periods at once (all students Present), or just the selected period?"})]}),a.jsxs("div",{className:"px-6 pb-6 flex flex-col gap-3",children:[a.jsxs("button",{onClick:re,className:"w-full px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[a.jsx(Md,{className:"w-5 h-5"}),"Mark Both Periods (All Present)"]}),a.jsx("button",{onClick:T,className:"w-full px-4 py-3 bg-slate-200 hover:bg-slate-300 text-slate-700 rounded-lg font-medium transition-colors",children:"Single Period Only"}),a.jsx("button",{onClick:()=>{V(!1),ee(null),Y(null)},className:"w-full px-4 py-2 text-slate-600 hover:text-slate-800 text-sm font-medium transition-colors",children:"Cancel"})]})]})})]})}const zOe=()=>{const[e,t]=x.useState(!1),[r,n]=x.useState(null),[i,s]=x.useState(!1),[o,l]=x.useState([]),[c,u]=x.useState(!1),[d,f]=x.useState([]),[p,h]=x.useState(null),[m,g]=x.useState("overall"),[y,b]=x.useState(!1),[v,w]=x.useState(null),[S,j]=x.useState([]),[k,A]=x.useState([]),[R,M]=x.useState(null),[B,E]=x.useState({}),[P,D]=x.useState(!1);x.useEffect(()=>{H()},[]),x.useEffect(()=>{oe()},[]),x.useEffect(()=>{de()},[]),x.useEffect(()=>{G()},[]),x.useEffect(()=>{p&&(p==="all"||p==="department"?g("overall"):p==="class"&&g("assigned"))},[p]);async function G(){try{const ee=await mr("/api/academics/analytics/filters/");if(!ee.ok)return h(null);const C=await ee.json().catch(()=>null);h((C==null?void 0:C.permission_level)||null),j((C==null?void 0:C.departments)||[]),A((C==null?void 0:C.sections)||[]),((C==null?void 0:C.departments)||[]).length>0&&M((C.departments[0]||{}).id||null)}catch(ee){console.error("Failed to load analytics filters",ee),h(null)}}async function H(){t(!0);try{const ee=await mr("/api/academics/analytics/today-periods/"),C=await ee.json().catch(()=>null);ee.ok?n(C):n(null)}catch(ee){console.error("Failed to load today periods",ee),n(null)}finally{t(!1)}}async function oe(){s(!0);try{const ee=new Date().toISOString().split("T")[0],C=await mr(`/api/academics/staff/periods/?date=${ee}`),Y=await C.json().catch(()=>({results:[]}));C.ok?l(Y.results||[]):l([])}catch(ee){console.error("Failed to load assigned periods",ee),l([])}finally{s(!1)}}async function de(){u(!0);try{const ee=new Date().toISOString().split("T")[0],C=await mr(`/api/academics/analytics/overall-section/?date=${ee}`);if(!C.ok){f([]),u(!1);return}const Y=await C.json().catch(()=>({sections:[]}));f(Y.sections||[])}catch(ee){console.error("Failed to load overall sections",ee),f([])}finally{u(!1)}}async function W(ee){if(!ee)return;D(!0);const C=new Date().toISOString().split("T")[0],Y=k.filter(O=>String(O.batch__course__department__id)===String(ee)),q={};try{await Promise.all(Y.map(async O=>{try{const X=await mr(`/api/academics/analytics/class-report/?section_id=${O.id}&date=${C}&period_index=1`);if(!X.ok)return;const F=await X.json().catch(()=>null);F&&(q[O.id]=F)}catch{}})),E(O=>({...O,...q}))}finally{D(!1)}}const V=async ee=>{if(!ee)return alert("No session available");if(confirm("Request unlock for this session?"))try{const C=await mr("/api/academics/attendance-unlock-requests/",{method:"POST",body:JSON.stringify({session:ee,note:""})});if(!C.ok){const Y=await C.json().catch(()=>({}));C.status===400&&Y.detail&&String(Y.detail).includes("already pending")?alert("An unlock request for this session is already pending."):alert("Failed to create unlock request: "+(Y.detail||C.status));return}alert("Unlock request submitted successfully")}catch(C){console.error(C),alert("Failed to submit request")}};async function ae(ee){if(ee){b(!0),w(null);try{const C=new Date().toISOString().split("T")[0],Y=await mr(`/api/academics/analytics/class-report/?section_id=${ee}&date=${C}`);if(!Y.ok){const O=await Y.json().catch(()=>({}));alert("Failed to load section report: "+(O.detail||Y.status)),b(!1);return}const q=await Y.json().catch(()=>null);w(q),g("section")}catch(C){console.error("Failed to load section report",C),alert("Failed to load section report")}finally{b(!1)}}}return a.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Attendance Unlock Requests"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Request unlock for a locked attendance session from the list below."})]}),e&&a.jsx("div",{className:"py-6 text-gray-600",children:"Loading today's periods"}),a.jsxs("div",{className:"mb-4 flex items-center gap-2",children:[(p==="all"||p==="department")&&a.jsx("button",{onClick:()=>g("overall"),className:`px-3 py-1 rounded ${m==="overall"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"Overall"}),a.jsx("button",{onClick:()=>g("assigned"),className:`px-3 py-1 rounded ${m==="assigned"?"bg-indigo-600 text-white":"bg-gray-100 text-gray-700"}`,children:"My Assigned"})]}),m==="overall"&&!c&&a.jsx("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"text-sm text-gray-700",children:"Overall sections (permissioned)"}),S&&S.length>0&&a.jsxs("select",{value:R??"",onChange:ee=>{const C=ee.target.value,Y=C?Number(C):null;M(Y),Y&&W(Y)},className:"px-2 py-1 border rounded",children:[a.jsx("option",{value:"",children:"-- Select department --"}),S.map(ee=>a.jsx("option",{value:ee.id,children:ee.short_name||ee.name},ee.id))]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("button",{onClick:de,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[a.jsx(C2,{className:"w-4 h-4"})," Refresh"]}),R&&a.jsx("button",{onClick:()=>R&&W(R),className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:"Load Dept Sections"})]})]}),a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R?k.filter(ee=>String(ee.batch__course__department__id)===String(R)).map(ee=>{const C=B[ee.id];return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ee.name}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:(C==null?void 0:C.present)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:(C==null?void 0:C.absent)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:(C==null?void 0:C.on_duty)??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:(C==null?void 0:C.total_strength)??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:C!=null&&C.is_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(a0,{className:"w-3 h-3 mr-1"}),"Locked"]}):C!=null&&C.total_marked?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>ae(ee.id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},ee.id)}):d.map(ee=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:(ee.department_short||ee.department_name?`${ee.department_short||ee.department_name} - `:"")+(ee.section_name||"")}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:ee.present??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:ee.absent??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:ee.on_duty??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:ee.total_strength??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:ee.is_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(a0,{className:"w-3 h-3 mr-1"}),"Locked"]}):ee.marked_at?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>ae(ee.section_id),className:"px-3 py-1 rounded text-sm bg-gray-100 text-gray-700 hover:bg-gray-200",children:"View"})})]},ee.section_id))})]})]})}),m==="section"&&v&&a.jsxs("div",{className:"mb-6 bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-lg font-medium",children:v.section_name}),a.jsxs("div",{className:"text-sm text-gray-600",children:["Date: ",v.date]})]}),a.jsx("div",{children:a.jsx("button",{onClick:()=>g("overall"),className:"px-3 py-1 rounded bg-gray-100",children:"Back"})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Present",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.present})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["Absent",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.absent})]}),a.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:["OD",a.jsx("br",{}),a.jsx("strong",{className:"text-2xl",children:v.on_duty})]})]})]}),!i&&o&&o.length>0&&a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a.jsxs("div",{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("div",{className:"text-sm text-gray-700"}),a.jsxs("button",{onClick:oe,className:"flex items-center gap-2 px-3 py-1 text-sm bg-gray-100 rounded hover:bg-gray-200",children:[a.jsx(C2,{className:"w-4 h-4"})," Refresh"]})]}),a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Period"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Subject"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Section"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Present"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Absent"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"OD"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Total"}),a.jsx("th",{className:"px-4 py-2 text-left text-sm font-medium text-gray-600",children:"Status"}),a.jsx("th",{className:"px-4 py-2 text-right text-sm font-medium text-gray-600",children:"Action"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(ee=>{var C,Y;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:((C=ee.period)==null?void 0:C.label)||((Y=ee.period)==null?void 0:Y.index)||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:ee.subject_display||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:ee.section_name||"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-green-600 font-semibold",children:ee.present??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-red-600 font-semibold",children:ee.absent??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-600",children:ee.on_duty??"-"}),a.jsx("td",{className:"px-4 py-3 text-right text-sm text-gray-900",children:ee.total_strength??"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:ee.attendance_session_locked?a.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-red-100 text-red-700",children:[a.jsx(a0,{className:"w-3 h-3 mr-1"}),"Locked"]}):ee.present!==null?a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-50 text-green-700",children:"Saved"}):a.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-50 text-gray-700",children:"Not saved"})}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx("button",{onClick:()=>{var q;return V(ee.attendance_session_id||((q=ee.attendance_session)==null?void 0:q.id)||ee.session_id)},className:`px-3 py-1 rounded text-sm ${ee.attendance_session_locked?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-100 text-gray-600 cursor-not-allowed"}`,disabled:!ee.attendance_session_locked,children:"Request Unlock"})})]},ee.id||ee.session_id)})})]})]})}),!e&&(!r||r.periods.length===0)&&a.jsx("div",{className:"text-gray-600 py-6",children:"No periods available for today."})]})};function WOe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[i,s]=x.useState([]),[o,l]=x.useState(null),[c,u]=x.useState(!1);x.useEffect(()=>{const h=new Date,m=h.toISOString().slice(0,10),g=new Date(h.getTime()-1e3*60*60*24*30).toISOString().slice(0,10);t(g),n(m)},[]),x.useEffect(()=>{e&&r&&d()},[e,r]);async function d(){u(!0);try{const h=`?start_date=${e}&end_date=${r}`;console.log("Fetching student attendance:",{startDate:e,endDate:r,url:`/api/academics/student/attendance/${h}`});const m=await mr(`/api/academics/student/attendance/${h}`);if(!m.ok){const y=await m.text();throw console.error("Failed to fetch attendance:",m.status,y),new Error(`Failed to fetch (${m.status})`)}const g=await m.json();console.log("Student attendance response:",{recordCount:(g.results||[]).length,summary:g.summary,records:g.results}),s(g.results||[]),l(g.summary||null)}catch(h){console.error("fetchRecords error:",h),s([]),alert("Failed to load attendance records: "+(h instanceof Error?h.message:String(h)))}finally{u(!1)}}function f(h){switch(h){case"P":return"bg-green-100 text-green-800 border-green-200";case"A":return"bg-red-100 text-red-800 border-red-200";case"LEAVE":return"bg-blue-100 text-blue-800 border-blue-200";case"OD":return"bg-purple-100 text-purple-800 border-purple-200";case"LATE":return"bg-amber-100 text-amber-800 border-amber-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}}function p(h){switch(h){case"P":return a.jsx(Md,{className:"h-3.5 w-3.5"});case"A":return a.jsx(yN,{className:"h-3.5 w-3.5"});default:return a.jsx(ed,{className:"h-3.5 w-3.5"})}}return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"p-3 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl",children:a.jsx(Md,{className:"h-6 w-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Attendance"}),a.jsx("p",{className:"text-gray-600",children:"View your attendance records and statistics"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(xs,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Date Range"})]}),a.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-[200px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"From Date"}),a.jsx("input",{type:"date",value:e,onChange:h=>t(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsxs("div",{className:"flex-1 min-w-[200px]",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1.5",children:"To Date"}),a.jsx("input",{type:"date",value:r,onChange:h=>n(h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),a.jsx("button",{onClick:d,disabled:c,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-indigo-300 transition-colors font-medium flex items-center gap-2",children:c?a.jsxs(a.Fragment,{children:[a.jsx(Gu,{className:"h-4 w-4 animate-spin"}),"Loading..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xs,{className:"h-4 w-4"}),"Refresh"]})})]}),!c&&i.length>0&&a.jsxs("div",{className:"mt-3 text-sm text-gray-600 flex items-center gap-2",children:[a.jsx(Md,{className:"h-4 w-4 text-green-600"}),"Showing ",i.length," attendance record",i.length!==1?"s":""," from ",e," to ",r]})]}),c?a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsx("div",{className:"text-center",children:a.jsxs("div",{className:"inline-flex items-center gap-2 text-gray-600",children:[a.jsx(Gu,{className:"animate-spin h-5 w-5 text-indigo-600"}),a.jsx("span",{children:"Loading attendance records..."})]})})}):a.jsx("div",{children:i.length===0?a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-8 border border-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx(ed,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Records Found"}),a.jsx("p",{className:"text-gray-600",children:"No attendance records found for the selected date range."})]})}):a.jsxs("div",{className:"space-y-6",children:[o&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(Dte,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Overall Attendance"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4 border border-green-200",children:[a.jsx("div",{className:"text-sm text-green-700 font-medium mb-1",children:"Attendance Rate"}),a.jsx("div",{className:"text-3xl font-bold text-green-900",children:o.overall.percentage!=null?`${o.overall.percentage.toFixed(1)}%`:"N/A"})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-200",children:[a.jsx("div",{className:"text-sm text-blue-700 font-medium mb-1",children:"Present"}),a.jsx("div",{className:"text-3xl font-bold text-blue-900",children:o.overall.present})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 rounded-lg p-4 border border-purple-200",children:[a.jsx("div",{className:"text-sm text-purple-700 font-medium mb-1",children:"Total Periods"}),a.jsx("div",{className:"text-3xl font-bold text-purple-900",children:o.overall.total_marked_periods})]})]})]}),o&&o.by_subject&&o.by_subject.length>0&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[a.jsx(gs,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Subject-wise Breakdown"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.by_subject.map(h=>{const m=h.percentage!=null?h.percentage:0,g=h.counts||{};return a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[a.jsxs("div",{className:"flex justify-between items-start mb-3",children:[a.jsx("div",{className:"font-semibold text-gray-900",children:h.subject_display||h.subject_key}),a.jsx("div",{className:"text-lg font-bold text-indigo-600",children:m!=null?`${m.toFixed(1)}%`:"N/A"})]}),a.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full overflow-hidden mb-3",children:a.jsx("div",{className:`h-full transition-all ${m>=75?"bg-green-500":m>=50?"bg-amber-500":"bg-red-500"}`,style:{width:`${Math.max(0,Math.min(100,m))}%`}})}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded border border-green-200",children:["P: ",g.P||0]}),a.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded border border-red-200",children:["A: ",g.A||0]}),a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded border border-blue-200",children:["LEAVE: ",g.LEAVE||0]}),a.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded border border-purple-200",children:["OD: ",g.OD||0]}),a.jsxs("span",{className:"px-2 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded border border-amber-200",children:["LATE: ",g.LATE||0]})]})]},h.subject_key)})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:[a.jsx("div",{className:"p-6 border-b border-gray-100",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(sc,{className:"h-5 w-5 text-indigo-600"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Attendance Records"})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Date"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Period"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Section"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Subject"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Status"}),a.jsx("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-700",children:"Marked By"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-100",children:i.map(h=>{var m,g,y;return a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(xs,{className:"h-4 w-4 text-gray-400"}),h.date]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((m=h.period)==null?void 0:m.label)||((g=h.period)!=null&&g.index?`Period ${h.period.index}`:"")}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:((y=h.section)==null?void 0:y.name)||""}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-900 font-medium",children:h.subject_display||""}),a.jsx("td",{className:"px-6 py-4 text-sm",children:a.jsxs("span",{className:`inline-flex items-center gap-1 px-2.5 py-1 rounded-md text-xs font-medium border ${f(h.status)}`,children:[p(h.status),h.status]})}),a.jsx("td",{className:"px-6 py-4 text-sm text-gray-700",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(z0,{className:"h-3.5 w-3.5 text-gray-400"}),h.marked_by||""]})})]},h.id)})})]})})]})]})})]})})}function qOe(){const[e,t]=x.useState(null),[r,n]=x.useState(!0);return x.useEffect(()=>{let i=!0;return Dd().then(s=>{i&&t(s)}).catch(()=>{i&&t(null)}).finally(()=>{i&&n(!1)}),()=>{i=!1}},[]),a.jsx("div",{className:"p-6",children:a.jsxs("div",{className:"max-w-4xl",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Academics"}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Overview of academic information for the logged-in student."}),a.jsx("div",{className:"mt-6 bg-white shadow rounded p-4",children:r?a.jsx("div",{className:"text-gray-600",children:"Loading..."}):a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Student:"}),a.jsx("div",{className:"text-gray-700",children:e?`${e.username||e.email||"Student"}`:"Unknown"})]})})]})})}const Ag="";async function HOe(){const e=await mr(`${Ag}/api/academics/mentor/staff/`);return e.ok?e.json():{results:[]}}async function VOe(e){const t=await mr(`${Ag}/api/academics/mentor/staff/${e}/students/`);return t.ok?t.json():{results:[]}}async function GOe(e,t){return await mr(`${Ag}/api/academics/mentor/map/`,{method:"POST",body:JSON.stringify({mentor_id:e,student_ids:t})})}async function tB(){const e=await mr(`${Ag}/api/academics/my-students/`);return e.ok?e.json():{results:[]}}async function KOe(e,t){const r={student_ids:[e]};return t&&(r.mentor_id=t),await mr(`${Ag}/api/academics/mentor/unmap/`,{method:"POST",body:JSON.stringify(r)})}async function YOe(){const e=await mr(`${Ag}/api/academics/mentor/my-mentees/`);return e.ok?e.json():{results:[]}}function XOe(){const[e,t]=x.useState([]),[r,n]=x.useState(null),[i,s]=x.useState([]),[o,l]=x.useState([]),[c,u]=x.useState(!1);x.useEffect(()=>{d()},[]);async function d(){const y=await HOe();t(y.results||[])}async function f(){const b=(await tB()).results||[],v=[];b.forEach(w=>{(w.students||[]).forEach(j=>v.push(j))}),s(v)}async function p(y){n(y),l([]),s([]);const v=(await VOe(y)).results||[],S=(await tB()).results||[],j=[];S.forEach(R=>{(R.students||[]).forEach(B=>j.push(B))});const k=new Set(v.map(R=>R.id)),A=j.filter(R=>!k.has(R.id)&&!R.has_mentor);l(v),s(A)}async function h(y){if(!r)return alert("Select a mentor first");u(!0);const b=await GOe(r,[y]);if(b.ok)await f(),r&&await p(r);else{const v=await b.json().catch(()=>null);alert("Failed: "+(v&&v.detail?v.detail:b.statusText))}u(!1)}async function m(y){if(!r)return;u(!0);const b=await KOe(y,r);if(b.ok)await f(),r&&await p(r);else{const v=await b.json().catch(()=>null);alert("Failed to remove: "+(v&&v.detail?v.detail:b.statusText))}u(!1)}const g=e.find(y=>y.id===r);return a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(Iv,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"Mentor Assignment"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Assign and manage mentor mappings for your students"})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsxs("h3",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-indigo-600"}),"Staff Members",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})}),a.jsx("div",{className:"p-4 max-h-[600px] overflow-y-auto",children:e.length===0?a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No staff members available"}):a.jsx("div",{className:"space-y-2",children:e.map(y=>a.jsx("div",{className:`p-4 rounded-lg border transition-all cursor-pointer ${r===y.id?"bg-gradient-to-r from-indigo-50 to-blue-50 border-indigo-300 shadow-md":"bg-white border-slate-200 hover:border-indigo-200 hover:shadow-sm"}`,onClick:()=>p(y.id),children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:`font-medium ${r===y.id?"text-indigo-900":"text-slate-900"}`,children:y.username}),a.jsx("div",{className:"text-sm text-slate-600 mt-1",children:a.jsx("span",{className:"font-mono",children:y.staff_id||"N/A"})})]}),a.jsxs("button",{onClick:b=>{b.stopPropagation(),p(y.id)},className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5 ${r===y.id?"bg-indigo-600 text-white":"bg-indigo-100 text-indigo-700 hover:bg-indigo-200"}`,children:[a.jsx(i9,{className:"w-4 h-4"}),"View"]})]})},y.id))})})]})}),a.jsx("div",{className:"lg:col-span-3",children:r?a.jsxs("div",{className:"space-y-6",children:[g&&a.jsx("div",{className:"bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl p-4 shadow-lg",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Iv,{className:"w-6 h-6"}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-semibold",children:["Selected Mentor: ",g.username]}),a.jsxs("div",{className:"text-sm opacity-90",children:["Staff ID: ",g.staff_id||"N/A"]})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-green-50",children:a.jsxs("h4",{className:"text-base font-semibold text-green-900 flex items-center gap-2",children:[a.jsx(Om,{className:"w-5 h-5 text-green-700"}),"Assigned Students",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-green-200 text-green-800 text-xs font-medium rounded-full",children:o.length})]})}),a.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:o.length>0?a.jsx("div",{className:"space-y-2",children:o.map(y=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[y.reg_no,"  ",y.username]}),a.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:y.section_name})]}),a.jsxs("button",{className:"px-3 py-1.5 bg-red-600 hover:bg-red-700 disabled:bg-red-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>m(y.id),disabled:c,children:[a.jsx(Hte,{className:"w-4 h-4"}),"Remove"]})]},y.id))}):a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No students currently assigned to this mentor"})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-blue-50",children:a.jsxs("h4",{className:"text-base font-semibold text-blue-900 flex items-center gap-2",children:[a.jsx(ys,{className:"w-5 h-5 text-blue-700"}),"Available to Assign",a.jsx("span",{className:"ml-auto px-2.5 py-0.5 bg-blue-200 text-blue-800 text-xs font-medium rounded-full",children:i.length})]})}),a.jsx("div",{className:"p-4 max-h-[300px] overflow-y-auto",children:i.length>0?a.jsx("div",{className:"space-y-2",children:i.map(y=>a.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"text-sm font-medium text-slate-900",children:[y.reg_no,"  ",y.username]}),a.jsx("div",{className:"text-xs text-slate-600 mt-0.5",children:y.section_name})]}),a.jsxs("button",{className:"px-3 py-1.5 bg-green-600 hover:bg-green-700 disabled:bg-green-300 text-white rounded-lg text-sm font-medium transition-colors flex items-center gap-1.5",onClick:()=>h(y.id),disabled:c||!r,children:[c?a.jsx(Gu,{className:"w-4 h-4 animate-spin"}):a.jsx(Wte,{className:"w-4 h-4"}),"Assign"]})]},y.id))}):a.jsx("div",{className:"text-center py-8 text-slate-500",children:"No available students to assign"})})]})]}):a.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-12",children:a.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(Iv,{className:"w-16 h-16 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"Select a Staff Member"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Click on a staff member to view and manage their mentee assignments"})]})})})]})]})}function QOe(){const[e,t]=x.useState([]),[r,n]=x.useState(!1);x.useEffect(()=>{i()},[]);async function i(){n(!0);try{const s=await YOe();t(s.results||[])}catch(s){console.error(s),alert("Failed to load mentees")}finally{n(!1)}}return a.jsxs("div",{className:"min-h-screen p-4 md:p-6 bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm mb-6 p-6 border border-slate-200",children:a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"bg-gradient-to-br from-indigo-500 to-purple-600 p-3 rounded-xl shadow-lg",children:a.jsx(ys,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-1",children:"My Mentees"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"Students assigned to you as mentor"})]})]})}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200",children:[a.jsx("div",{className:"px-6 py-4 border-b border-slate-200 bg-slate-50",children:a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("h2",{className:"text-lg font-semibold text-slate-900 flex items-center gap-2",children:[a.jsx(Iv,{className:"w-5 h-5 text-indigo-600"}),"Mentees List",!r&&e.length>0&&a.jsx("span",{className:"ml-2 px-2.5 py-0.5 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:e.length})]})})}),a.jsxs("div",{className:"p-6",children:[r&&a.jsxs("div",{className:"flex items-center justify-center py-12",children:[a.jsx(Gu,{className:"w-8 h-8 text-indigo-600 animate-spin"}),a.jsx("span",{className:"ml-3 text-slate-600",children:"Loading mentees..."})]}),!r&&e.length===0&&a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"bg-slate-100 p-4 rounded-full mb-4",children:a.jsx(ys,{className:"w-12 h-12 text-slate-400"})}),a.jsx("h3",{className:"text-lg font-medium text-slate-900 mb-1",children:"No Mentees Assigned"}),a.jsx("p",{className:"text-slate-600 text-sm",children:"You don't have any students assigned as mentees yet."})]}),!r&&e.length>0&&a.jsx("div",{children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b border-slate-200",children:[a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Reg No"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4 text-sm font-semibold text-slate-700 bg-slate-50",children:"Section"})]})}),a.jsx("tbody",{className:"divide-y divide-slate-200",children:e.map(s=>a.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm font-medium text-slate-900",children:s.reg_no})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"text-sm text-slate-700",children:s.username})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:s.section_name||"N/A"})})]},s.id))})]})})]})]})]})}async function JOe(){var t;return((t=(await Uo.get("notification-templates/")).data)==null?void 0:t.templates)||[]}async function ZOe(e){return(await Uo.put("notification-templates/",{templates:e})).data}const Sv=[{label:"{otp}",value:"{otp}",description:"Auto-generated OTP code",category:"auth"},{label:"{username}",value:"{username}",description:"User's username",category:"user"},{label:"{email}",value:"{email}",description:"User's email",category:"user"},{label:"{mobile}",value:"{mobile}",description:"Mobile number",category:"user"},{label:"{name}",value:"{name}",description:"Full name",category:"user"},{label:"{expiry}",value:"{expiry}",description:"OTP/time expiry",category:"time"},{label:"{subject}",value:"{subject}",description:"Subject/course name",category:"academic"},{label:"{assessment}",value:"{assessment}",description:"Assessment type (CIA1, CIA2, etc.)",category:"academic"},{label:"{percentage}",value:"{percentage}",description:"Percentage value",category:"academic"},{label:"{time}",value:"{time}",description:"Timestamp",category:"time"},{label:"{date}",value:"{date}",description:"Date",category:"time"}],kk=[{id:"mobile_verify",name:"Mobile Number Verification OTP",template:"Your OTP is {otp}. It is valid for {expiry} minutes. - IQAC",enabled:!0,expiry_minutes:5},{id:"password_reset",name:"Password Reset OTP",template:"Hello {username}, your password reset OTP is {otp}. Valid for {expiry} minutes. - IQAC",enabled:!1,expiry_minutes:10},{id:"login_alert",name:"Login Alert Notification",template:"Hello {name}, a login was detected on your account from a new device at {time}.",enabled:!1},{id:"obe_approval",name:"OBE Edit Request Approved",template:"Your OBE edit request for {subject} ({assessment}) has been approved. Edit until: {expiry}",enabled:!1},{id:"attendance_alert",name:"Low Attendance Alert",template:"Dear {name}, your attendance is {percentage}% in {subject}. Please improve to meet requirements.",enabled:!1}];function eMe(){const[e,t]=x.useState(kk),[r,n]=x.useState("mobile_verify"),[i,s]=x.useState(null),[o,l]=x.useState(!0),[c,u]=x.useState(null),d=e.find(S=>S.id===r),f=x.useMemo(()=>{const S=d==null?void 0:d.expiry_minutes;return typeof S=="number"&&Number.isFinite(S)&&S>0?String(S):"5"},[d]);x.useEffect(()=>{let S=!0;return l(!0),u(null),JOe().then(j=>{var k;if(S&&j&&j.length){const A=new Map(j.map(P=>[P.code,{id:P.code,name:P.name,template:P.template,enabled:!!P.enabled,expiry_minutes:P.expiry_minutes??null,updated_at:P.updated_at}])),R=kk.map(P=>A.get(P.id)||P),M=j.filter(P=>!kk.some(D=>D.id===P.code)).map(P=>A.get(P.code)).filter(Boolean),B=[...R,...M];t(B);const E=B.some(P=>P.id==="mobile_verify")?"mobile_verify":((k=B[0])==null?void 0:k.id)||null;n(E)}}).catch(j=>{var k,A;S&&u(String(((A=(k=j==null?void 0:j.response)==null?void 0:k.data)==null?void 0:A.detail)||(j==null?void 0:j.message)||j||"Failed to load templates"))}).finally(()=>{S&&l(!1)}),()=>{S=!1}},[]);const p=S=>{r&&t(j=>j.map(k=>k.id===r?{...k,template:k.template+" "+S}:k))},h=(S,j)=>{t(k=>k.map(A=>A.id===S?{...A,template:j}:A))},m=S=>{t(j=>j.map(k=>k.id===S?{...k,enabled:!k.enabled}:k))},g=async()=>{var S,j;s("saving");try{await ZOe(e.map(k=>({code:k.id,name:k.name,template:k.template,enabled:!!k.enabled,expiry_minutes:k.expiry_minutes??null,updated_at:k.updated_at}))),s("saved"),setTimeout(()=>s(null),2e3)}catch(k){s("error"),setTimeout(()=>s(null),2500),alert(String(((j=(S=k==null?void 0:k.response)==null?void 0:S.data)==null?void 0:j.detail)||(k==null?void 0:k.message)||k||"Failed to save"))}},y=()=>{const S=`template_${Date.now()}`,j={id:S,name:"New Message Template",template:"Enter your message here...",enabled:!1,expiry_minutes:null};t(k=>[...k,j]),n(S)},b=S=>{var j;confirm("Are you sure you want to delete this template?")&&(t(k=>k.filter(A=>A.id!==S)),r===S&&n(((j=e[0])==null?void 0:j.id)||null))},v=(S,j)=>{t(k=>k.map(A=>A.id===S?{...A,name:j}:A))},w=(S,j)=>{const k=String(j??"").trim(),A=k===""?null:Number(k);t(R=>R.map(M=>M.id!==S?M:A===null?{...M,expiry_minutes:null}:!Number.isFinite(A)||A<=0?M:{...M,expiry_minutes:Math.floor(A)}))};return a.jsx(t0,{children:a.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[a.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Cx,{className:"w-8 h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Notification Templates"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Configure message templates for OTP, alerts, and notifications"})]})]}),a.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(Mm,{className:"w-4 h-4"}),"Add Template"]})]}),c?a.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-800 rounded-lg p-3 text-sm",children:c}):null,a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[a.jsx("div",{className:"lg:col-span-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[a.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:a.jsx("h2",{className:"font-semibold text-gray-900",children:"Message Templates"})}),a.jsx("div",{className:"divide-y divide-gray-200",children:e.map(S=>a.jsx("div",{onClick:()=>n(S.id),className:`p-4 cursor-pointer transition-colors ${r===S.id?"bg-blue-50 border-l-4 border-blue-600":"hover:bg-gray-50"}`,children:a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-gray-900 truncate",children:S.name}),a.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-2",children:S.template})]}),a.jsx("div",{className:"ml-2 flex items-center gap-2",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded ${S.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:S.enabled?"Active":"Inactive"})})]})},S.id))})]})}),a.jsx("div",{className:"lg:col-span-8",children:o?a.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 text-gray-600",children:"Loading templates"}):d?a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[a.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("input",{type:"text",value:d.name,onChange:S=>v(d.id,S.target.value),className:"text-lg font-semibold text-gray-900 bg-transparent border-none focus:outline-none focus:ring-2 focus:ring-blue-500 rounded px-2 -mx-2"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>m(d.id),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ${d.enabled?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:d.enabled?"Enabled":"Disabled"}),a.jsx("button",{onClick:()=>b(d.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete template",children:a.jsx(bu,{className:"w-5 h-5"})})]})]})}),a.jsxs("div",{className:"p-6 space-y-6",children:[d.template.includes("{expiry}")?a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-semibold text-blue-900",children:"Validity Time"}),a.jsxs("div",{className:"text-xs text-blue-800",children:["Controls ","{expiry}"," and OTP expiry minutes."]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"number",min:1,value:String(d.expiry_minutes??""),onChange:S=>w(d.id,S.target.value),className:"w-24 px-3 py-2 border border-blue-200 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"5"}),a.jsx("span",{className:"text-sm text-blue-900",children:"minutes"})]})]})}):null,a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Template"}),a.jsx("textarea",{value:d.template,onChange:S=>h(d.id,S.target.value),rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"Enter your message template here..."}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Use placeholders from the buttons below to insert dynamic values"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Insert Placeholders"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"User Information"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Sv.filter(S=>S.category==="user").map(S=>a.jsxs("button",{onClick:()=>p(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Authentication"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Sv.filter(S=>S.category==="auth").map(S=>a.jsxs("button",{onClick:()=>p(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Academic"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Sv.filter(S=>S.category==="academic").map(S=>a.jsxs("button",{onClick:()=>p(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"Date & Time"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Sv.filter(S=>S.category==="time").map(S=>a.jsxs("button",{onClick:()=>p(S.value),className:"group relative px-3 py-2 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg text-sm font-medium text-gray-700 hover:text-blue-700 transition-all text-left",title:S.description,children:[a.jsx("span",{className:"font-mono",children:S.label}),a.jsxs("div",{className:"hidden group-hover:block absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gray-900 text-white text-xs rounded-lg whitespace-nowrap z-10",children:[S.description,a.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})]})]},S.value))})]})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Preview (valid for ",f," minutes)"]}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:a.jsx("div",{className:"text-sm text-gray-700 font-mono whitespace-pre-wrap",children:d.template.replace(/{otp}/g,"123456").replace(/{username}/g,"john_doe").replace(/{email}/g,"john@example.com").replace(/{mobile}/g,"+91XXXXXXXXXX").replace(/{name}/g,"John Doe").replace(/{expiry}/g,f).replace(/{subject}/g,"Mathematics").replace(/{assessment}/g,"CIA1").replace(/{percentage}/g,"75").replace(/{time}/g,new Date().toLocaleTimeString()).replace(/{date}/g,new Date().toLocaleDateString())})}),a.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"This is how your message will look with sample data"})]}),a.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[a.jsx("div",{className:"text-sm text-gray-600",children:i==="saved"&&a.jsx("span",{className:"text-green-600 font-medium",children:" Template saved successfully"})}),a.jsxs("button",{onClick:g,disabled:i==="saving",className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[a.jsx(rd,{className:"w-4 h-4"}),i==="saving"?"Saving...":"Save Template"]})]})]})]}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[a.jsx(Cx,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Select a template from the list or create a new one"})]})})]})]})})}function tMe(){const[e,t]=x.useState(null),[r,n]=x.useState(!0),{collapsed:i}=vN();return x.useEffect(()=>{Dd().then(o=>{const l={...o,roles:Array.isArray(o.roles)?o.roles.map(c=>typeof c=="string"?c:c.name):[],permissions:Array.isArray(o.permissions)?o.permissions:[],profile_type:o.profile_type||null,profile:o.profile||null};t(l)}).catch(()=>t(null)).finally(()=>n(!1))},[]),r?a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx("p",{className:"text-gray-600",children:"Loading..."})}):((Array.isArray(e==null?void 0:e.permissions)?e==null?void 0:e.permissions:[]).map(o=>String(o||"").toLowerCase()),a.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-x-hidden",children:[a.jsx(s9,{user:e}),e?a.jsxs("div",{className:"flex",children:[a.jsx(_re,{}),a.jsx("main",{className:`flex-1 min-w-0 transition-all duration-300 pt-20 overflow-x-hidden ${i?"lg:pl-20":"lg:pl-64"}`,children:a.jsx("div",{className:"app-main-zoom",children:a.jsxs(b4,{children:[a.jsx(Jn,{path:"/",element:a.jsx(Qp,{to:"/dashboard",replace:!0})}),a.jsx(Jn,{path:"/dashboard",element:a.jsx(sOe,{})}),a.jsx(Jn,{path:"/profile",element:a.jsx(lOe,{user:e})}),a.jsx(Jn,{path:"/notifications",element:a.jsx(eMe,{})}),a.jsx(Jn,{path:"/import/questions",element:a.jsx(yOe,{})}),a.jsx(Jn,{path:"/curriculum/master",element:a.jsx(cOe,{})}),a.jsx(Jn,{path:"/curriculum/master/:id",element:a.jsx(VF,{})}),a.jsx(Jn,{path:"/curriculum/master/new",element:a.jsx(VF,{})}),a.jsx(Jn,{path:"/curriculum/department",element:a.jsx(uOe,{})}),a.jsx(Jn,{path:"/curriculum/elective-import",element:a.jsx(da,{user:e,requiredPermissions:["curriculum.import_elective_choices"],element:a.jsx(dOe,{})})}),a.jsx(Jn,{path:"/obe",element:a.jsx(LK,{})}),a.jsx(Jn,{path:"/obe/course/:code/lca/cotarget",element:a.jsx(rMe,{})}),a.jsx(Jn,{path:"/obe/course/:code/*",element:a.jsx(NOe,{})}),a.jsx(Jn,{path:"/obe/request",element:a.jsx(da,{user:e,requiredProfile:"STAFF",element:a.jsx(COe,{})})}),a.jsx(Jn,{path:"/obe/master/requests",element:a.jsx(da,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(iOe,{})})}),a.jsx(Jn,{path:"/obe/master/due-dates",element:a.jsx(da,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(jN,{})})}),a.jsx(Jn,{path:"/academic",element:a.jsx(gOe,{})}),a.jsx(Jn,{path:"/hod/advisors",element:a.jsx(da,{user:e,requiredRoles:["HOD"],requiredPermissions:["academics.assign_advisor"],element:a.jsx(EOe,{})})}),a.jsx(Jn,{path:"/hod/obe-requests",element:a.jsx(da,{user:e,requiredRoles:["HOD"],requiredPermissions:["academics.assign_advisor"],element:a.jsx(POe,{})})}),a.jsx(Jn,{path:"/advisor/teaching",element:a.jsx(da,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_teaching"],element:a.jsx(TOe,{})})}),a.jsx(Jn,{path:"/iqac/timetable",element:a.jsx(da,{user:e,requiredPermissions:["timetable.manage_templates"],element:a.jsx(Nre,{})})}),a.jsx(Jn,{path:"/iqac/academic-controller",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(ine,{})})}),a.jsx(Jn,{path:"/iqac/academic-controller/course/:courseCode",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(one,{})})}),a.jsx(Jn,{path:"/iqac/academic-controller/course/:courseCode/marks/:taId",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(NPe,{})})}),a.jsx(Jn,{path:"/iqac/academic-controller/course/:courseCode/internal-mark/:taId",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(nOe,{})})}),a.jsx(Jn,{path:"/iqac/academic-controller/course/:courseCode/obe/:taId/*",element:a.jsx(da,{user:e,requiredRoles:["IQAC"],requiredPermissions:["obe.master.manage"],element:a.jsx(rOe,{})})}),a.jsx(Jn,{path:"/iqac/obe-requests",element:a.jsx(da,{user:e,requiredPermissions:["obe.master.manage"],element:a.jsx(B9,{})})}),a.jsx(Jn,{path:"/advisor/timetable",element:a.jsx(da,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["timetable.assign"],element:a.jsx(Are,{})})}),a.jsx(Jn,{path:"/advisor/students",element:a.jsx(da,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.view_my_students"],element:a.jsx(OOe,{})})}),a.jsx(Jn,{path:"/advisor/mentor",element:a.jsx(da,{user:e,requiredRoles:["ADVISOR"],requiredPermissions:["academics.assign_mentor"],element:a.jsx(XOe,{})})}),a.jsx(Jn,{path:"/student/timetable",element:a.jsx(da,{user:e,requiredProfile:"STUDENT",requiredPermissions:["timetable.view"],element:a.jsx(LOe,{})})}),a.jsx(Jn,{path:"/student/attendance",element:a.jsx(da,{user:e,requiredProfile:"STUDENT",element:a.jsx(WOe,{})})}),a.jsx(Jn,{path:"/student/academics",element:a.jsx(da,{user:e,requiredProfile:"STUDENT",element:a.jsx(qOe,{})})}),a.jsx(Jn,{path:"/staff/timetable",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["timetable.view"],element:a.jsx(BOe,{})})}),a.jsx(Jn,{path:"/staff/assigned-subjects",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_assigned_subjects"],element:a.jsx($Oe,{})})}),a.jsx(Jn,{path:"/staff/period-attendance",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.mark_attendance"],element:a.jsx(UOe,{})})}),a.jsx(Jn,{path:"/staff/analytics",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_all_attendance","academics.view_attendance_overall","academics.view_all_departments","academics.view_department_attendance","academics.view_class_attendance","academics.view_section_attendance"],element:a.jsx(zOe,{})})}),a.jsx(Jn,{path:"/staff/mentees",element:a.jsx(da,{user:e,requiredProfile:"STAFF",requiredPermissions:["academics.view_mentees"],element:a.jsx(QOe,{})})}),a.jsx(Jn,{path:"*",element:e?a.jsx(Qp,{to:"/dashboard",replace:!0}):a.jsx(bk,{user:e})})]})})})]}):a.jsx("div",{className:"pt-16",children:a.jsxs(b4,{children:[a.jsx(Jn,{path:"/",element:e?a.jsx(Qp,{to:"/dashboard",replace:!0}):a.jsx(bk,{user:e})}),a.jsx(Jn,{path:"*",element:e?a.jsx(Qp,{to:"/dashboard",replace:!0}):a.jsx(bk,{user:e})})]})})]}))}function rMe(){const{code:e}=U0(),t=e?decodeURIComponent(e):void 0;return a.jsx(EK,{courseCode:t})}function nMe(){const[e,t]=x.useState(""),[r,n]=x.useState(""),[i,s]=x.useState(!1),[o,l]=x.useState(null),[c,u]=x.useState(!1),d=bo();function f(h){if(typeof h!="object"||h===null)return null;const g=h.response;if(!g)return null;const y=g.data;if(!y)return null;const b=y.non_field_errors;return Array.isArray(b)&&b.length>0?String(b[0]):typeof y.detail=="string"?y.detail:null}const p=async h=>{h.preventDefault(),l(null),u(!0);try{await XD(e,r),d("/dashboard")}catch(m){const g=f(m)||"Login failed";l(g)}finally{u(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx(s9,{user:null}),a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsx("div",{className:"max-w-md w-full",children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 sm:p-10",children:[a.jsxs("div",{className:"mb-8 text-center",children:[a.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),a.jsx("p",{className:"text-gray-600",children:"Sign in to access your account"})]}),a.jsxs("form",{className:"space-y-6",onSubmit:p,children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"identifier",children:"Email or Register No"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(bN,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"identifier",type:"text",className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"College Email or Reg. No.",value:e,onChange:h=>t(h.target.value),required:!0,disabled:c})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",htmlFor:"password",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(a0,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{id:"password",type:i?"text":"password",className:"block w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed",placeholder:"Enter your password",value:r,onChange:h=>n(h.target.value),required:!0,disabled:c}),a.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",onClick:()=>s(!i),"aria-label":i?"Hide password":"Show password",children:i?a.jsx(rte,{className:"h-5 w-5"}):a.jsx(i9,{className:"h-5 w-5"})})]})]}),a.jsx("div",{className:"flex items-center justify-end",children:a.jsx(es,{to:"/forgot-password",className:"text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:"Forgot Password?"})}),o&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[a.jsx(ed,{className:"h-5 w-5 text-red-600 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-red-800",children:o})]}),a.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-60 disabled:cursor-not-allowed transform hover:scale-[1.02] active:scale-[0.98]",disabled:c,children:c?a.jsxs("span",{className:"flex items-center justify-center gap-2",children:[a.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Signing In..."]}):"Sign In"}),a.jsx("div",{className:"text-center pt-4",children:a.jsx(es,{to:"/",className:"text-sm text-gray-600 hover:text-gray-900 font-medium transition-colors",children:" Back to Home"})})]})]})})})]})}mD(document.getElementById("root")).render(a.jsx(Jr.StrictMode,{children:a.jsx(qJ,{children:a.jsx(Zte,{children:a.jsxs(b4,{children:[a.jsx(Jn,{path:"/login",element:a.jsx(nMe,{})}),a.jsx(Jn,{path:"/*",element:a.jsx(tMe,{})})]})})})}));export{Hi as _,aMe as c,sf as g};
